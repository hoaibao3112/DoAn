/*! For license information please see owl.460f4a478ba4f9c5048c.js.LICENSE.txt */
var Microsoft;(()=>{var e,t,n,i,r={5878:(e,t,n)=>{e.exports=n(3702)},5225:(e,t,n)=>{"use strict";var i=n(716),r=n(7076),o=n(111),s=n(9064),a=n(7165),c=n(8480),u=n(3818),l=n(1542),d=n(4609),h=n(9837);e.exports=function(e){return new Promise((function(t,n){var f,p=e.data,v=e.headers,m=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}i.isFormData(p)&&delete v["Content-Type"];var w=new XMLHttpRequest;if(e.auth){var y=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";v.Authorization="Basic "+btoa(y+":"+_)}var C=a(e.baseURL,e.url);function S(){if(w){var i="getAllResponseHeaders"in w?c(w.getAllResponseHeaders()):null,o={data:m&&"text"!==m&&"json"!==m?w.response:w.responseText,status:w.status,statusText:w.statusText,headers:i,config:e,request:w};r((function(e){t(e),g()}),(function(e){n(e),g()}),o),w=null}}if(w.open(e.method.toUpperCase(),s(C,e.params,e.paramsSerializer),!0),w.timeout=e.timeout,"onloadend"in w?w.onloadend=S:w.onreadystatechange=function(){w&&4===w.readyState&&(0!==w.status||w.responseURL&&0===w.responseURL.indexOf("file:"))&&setTimeout(S)},w.onabort=function(){w&&(n(l("Request aborted",e,"ECONNABORTED",w)),w=null)},w.onerror=function(){n(l("Network Error",e,null,w)),w=null},w.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",i=e.transitional||d;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,i.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",w)),w=null},i.isStandardBrowserEnv()){var k=(e.withCredentials||u(C))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;k&&(v[e.xsrfHeaderName]=k)}"setRequestHeader"in w&&i.forEach(v,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete v[t]:w.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(w.withCredentials=!!e.withCredentials),m&&"json"!==m&&(w.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&w.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&w.upload&&w.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){w&&(n(!e||e&&e.type?new h("canceled"):e),w.abort(),w=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),p||(p=null),w.send(p)}))}},3702:(e,t,n)=>{"use strict";var i=n(716),r=n(801),o=n(8455),s=n(5964),a=function e(t){var n=new o(t),a=r(o.prototype.request,n);return i.extend(a,o.prototype,n),i.extend(a,n),a.create=function(n){return e(s(t,n))},a}(n(261));a.Axios=o,a.Cancel=n(9837),a.CancelToken=n(75),a.isCancel=n(2423),a.VERSION=n(2472).version,a.all=function(e){return Promise.all(e)},a.spread=n(4886),a.isAxiosError=n(2944),e.exports=a,e.exports.default=a},9837:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},75:(e,t,n)=>{"use strict";var i=n(9837);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._){var t,i=n._.length;for(t=0;t<i;t++)n._[t](e);n._=null}})),this.promise.then=function(e){var t,i=new Promise((function(e){n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(e){this.reason?e(this.reason):this._?this._.push(e):this._=[e]},r.prototype.unsubscribe=function(e){if(this._){var t=this._.indexOf(e);-1!==t&&this._.splice(t,1)}},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},e.exports=r},2423:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},8455:(e,t,n)=>{"use strict";var i=n(716),r=n(9064),o=n(1025),s=n(3863),a=n(5964),c=n(3642),u=c.validators;function l(e){this.defaults=e,this.interceptors={request:new o,response:new o}}l.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&c.assertOptions(n,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var i=[],r=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(r=r&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));var o,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!r){var d=[s,void 0];for(Array.prototype.unshift.apply(d,i),d=d.concat(l),o=Promise.resolve(t);d.length;)o=o.then(d.shift(),d.shift());return o}for(var h=t;i.length;){var f=i.shift(),p=i.shift();try{h=f(h)}catch(e){p(e);break}}try{o=s(h)}catch(e){return Promise.reject(e)}for(;l.length;)o=o.then(l.shift(),l.shift());return o},l.prototype.getUri=function(e){return e=a(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,i){return this.request(a(i||{},{method:e,url:t,data:n}))}})),e.exports=l},1025:(e,t,n)=>{"use strict";var i=n(716);function r(){this.handlers=[]}r.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=r},7165:(e,t,n)=>{"use strict";var i=n(7304),r=n(7892);e.exports=function(e,t){return e&&!i(t)?r(e,t):t}},1542:(e,t,n)=>{"use strict";var i=n(7900);e.exports=function(e,t,n,r,o){var s=new Error(e);return i(s,t,n,r,o)}},3863:(e,t,n)=>{"use strict";var i=n(716),r=n(8276),o=n(2423),s=n(261),a=n(9837);function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a("canceled")}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=r.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return c(e),t.data=r.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(c(e),t&&t.response&&(t.response.data=r.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},7900:e=>{"use strict";e.exports=function(e,t,n,i,r){return e.config=t,n&&(e.code=n),e.request=i,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},5964:(e,t,n)=>{"use strict";var i=n(716);e.exports=function(e,t){t=t||{};var n={};function r(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function o(n){return i.isUndefined(t[n])?i.isUndefined(e[n])?void 0:r(void 0,e[n]):r(e[n],t[n])}function s(e){if(!i.isUndefined(t[e]))return r(void 0,t[e])}function a(n){return i.isUndefined(t[n])?i.isUndefined(e[n])?void 0:r(void 0,e[n]):r(void 0,t[n])}function c(n){return n in t?r(e[n],t[n]):n in e?r(void 0,e[n]):void 0}var u={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return i.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||o,r=t(e);i.isUndefined(r)&&t!==c||(n[e]=r)})),n}},7076:(e,t,n)=>{"use strict";var i=n(1542);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},8276:(e,t,n)=>{"use strict";var i=n(716),r=n(261);e.exports=function(e,t,n){var o=this||r;return i.forEach(n,(function(n){e=n.call(o,e,t)})),e}},261:(e,t,n)=>{"use strict";var i=n(716),r=n(9443),o=n(7900),s=n(4609),a={"Content-Type":"application/x-www-form-urlencoded"};function c(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,l={transitional:s,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(u=n(5225)),u),transformRequest:[function(e,t){return r(t,"Accept"),r(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(c(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(c(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||l.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||r&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){l.headers[e]=i.merge(a)})),e.exports=l},4609:e=>{"use strict";e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},2472:e=>{e.exports={version:"0.26.1"}},801:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},9064:(e,t,n)=>{"use strict";var i=n(716);function r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(i.isURLSearchParams(t))o=t.toString();else{var s=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))})))})),o=s.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},7892:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},111:(e,t,n)=>{"use strict";var i=n(716);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,r,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(r)&&a.push("path="+r),i.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},7304:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},2944:(e,t,n)=>{"use strict";var i=n(716);e.exports=function(e){return i.isObject(e)&&!0===e.isAxiosError}},3818:(e,t,n)=>{"use strict";var i=n(716);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=i.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},9443:(e,t,n)=>{"use strict";var i=n(716);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},8480:(e,t,n)=>{"use strict";var i=n(716),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,s={};return e?(i.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=i.trim(e.substr(0,o)).toLowerCase(),n=i.trim(e.substr(o+1)),t){if(s[t]&&r.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},4886:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},3642:(e,t,n)=>{"use strict";var i=n(2472).version,r={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){r[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var o={};r.transitional=function(e,t,n){return function(r,s,a){if(!1===e)throw new Error(function(e,t){return"[Axios v"+i+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}(s," has been removed"+(t?" in "+t:"")));return t&&!o[s]&&(o[s]=!0),!e||e(r,s,a)}},e.exports={assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),r=i.length;r-- >0;){var o=i[r],s=t[o];if(s){var a=e[o],c=void 0===a||s(a,o,e);if(!0!==c)throw new TypeError("option "+o+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:r}},716:(e,t,n)=>{"use strict";var i=n(801),r=Object.prototype.toString;function o(e){return Array.isArray(e)}function s(e){return void 0===e}function a(e){return"[object ArrayBuffer]"===r.call(e)}function c(e){return null!==e&&"object"==typeof e}function u(e){if("[object Object]"!==r.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===r.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:o,isArrayBuffer:a,isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===r.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&a(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:c,isPlainObject:u,isUndefined:s,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:l,isStream:function(e){return c(e)&&l(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===r.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function n(n,i){u(t[i])&&u(n)?t[i]=e(t[i],n):u(n)?t[i]=e({},n):o(n)?t[i]=n.slice():t[i]=n}for(var i=0,r=arguments.length;i<r;i++)d(arguments[i],n);return t},extend:function(e,t,n){return d(t,(function(t,r){e[r]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},8182:(e,t,n)=>{"use strict";n.d(t,{y:()=>u});var i=n(6899),r=n(6030),o=n(598),s=n(377);function a(e){return e}var c=n(1745),u=function(){function e(e){this.P=!1,e&&(this.O=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var s=this.operator,a=function(e,t,n){if(e){if(e instanceof i.L)return e;if(e[r.b])return e[r.b]()}return e||t||n?new i.L(e,t,n):new i.L(o.c)}(e,t,n);if(s?a.add(s.call(a,this.source)):a.add(this.source||c.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this.O(a):this.F(a)),c.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},e.prototype.F=function(e){try{return this.O(e)}catch(t){c.v.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,o=t.isStopped;if(n||o)return!1;e=r&&r instanceof i.L?r:null}return!0}(e)&&e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=l(t))((function(t,i){var r;r=n.subscribe((function(t){try{e(t)}catch(e){i(e),r&&r.unsubscribe()}}),i,t)}))},e.prototype.O=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[s.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:(0===(n=e).length?a:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=l(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function l(e){if(e||(e=c.v.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},598:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var i=n(1745),r=n(7691),o={closed:!0,next:function(e){},error:function(e){if(i.v.useDeprecatedSynchronousErrorHandling)throw e;(0,r.z)(e)},complete:function(){}}},4153:(e,t,n)=>{"use strict";n.d(t,{xQ:()=>d});var i=n(2701),r=n(8182),o=n(6899),s=n(1057),a=n(2214),c=function(e){function t(t,n){var i=e.call(this)||this;return i.subject=t,i.subscriber=n,i.closed=!1,i}return i.ZT(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(s.w),u=n(6030),l=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return i.ZT(t,e),t}(o.L),d=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return i.ZT(t,e),t.prototype[u.b]=function(){return new l(this)},t.prototype.lift=function(e){var t=new h(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new a.N;if(!this.isStopped)for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].next(e)},t.prototype.error=function(e){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new a.N;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),i=0;i<t;i++)n[i].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype.F=function(t){if(this.closed)throw new a.N;return e.prototype.F.call(this,t)},t.prototype.O=function(e){if(this.closed)throw new a.N;return this.hasError?(e.error(this.thrownError),s.w.EMPTY):this.isStopped?(e.complete(),s.w.EMPTY):(this.observers.push(e),new c(this,e))},t.prototype.asObservable=function(){var e=new r.y;return e.source=this,e},t.create=function(e,t){return new h(e,t)},t}(r.y),h=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return i.ZT(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype.O=function(e){return this.source?this.source.subscribe(e):s.w.EMPTY},t}(d)},6899:(e,t,n)=>{"use strict";n.d(t,{L:()=>l});var i=n(2701),r=n(810),o=n(598),s=n(1057),a=n(6030),c=n(1745),u=n(7691),l=function(e){function t(n,i,r){var s=e.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=o.c;break;case 1:if(!n){s.destination=o.c;break}if("object"==typeof n){n instanceof t?(s.syncErrorThrowable=n.syncErrorThrowable,s.destination=n,n.add(s)):(s.syncErrorThrowable=!0,s.destination=new d(s,n));break}default:s.syncErrorThrowable=!0,s.destination=new d(s,n,i,r)}return s}return i.ZT(t,e),t.prototype[a.b]=function(){return this},t.create=function(e,n,i){var r=new t(e,n,i);return r.syncErrorThrowable=!1,r},t.prototype.next=function(e){this.isStopped||this.$(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this.X(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.Z())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype.$=function(e){this.destination.next(e)},t.prototype.X=function(e){this.destination.error(e),this.unsubscribe()},t.prototype.Z=function(){this.destination.complete(),this.unsubscribe()},t.prototype.ee=function(){var e=this.te;return this.te=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.te=e,this},t}(s.w),d=function(e){function t(t,n,i,s){var a,c=e.call(this)||this;c.ne=t;var u=c;return(0,r.m)(n)?a=n:n&&(a=n.next,i=n.error,s=n.complete,n!==o.c&&(u=Object.create(n),(0,r.m)(u.unsubscribe)&&c.add(u.unsubscribe.bind(u)),u.unsubscribe=c.unsubscribe.bind(c))),c.ie=u,c.$=a,c.X=i,c.Z=s,c}return i.ZT(t,e),t.prototype.next=function(e){if(!this.isStopped&&this.$){var t=this.ne;c.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this.$,e)&&this.unsubscribe():this.__tryOrUnsub(this.$,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this.ne,n=c.v.useDeprecatedSynchronousErrorHandling;if(this.X)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this.X,e),this.unsubscribe()):(this.__tryOrUnsub(this.X,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):(0,u.z)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;(0,u.z)(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this.ne;if(this.Z){var n=function(){return e.Z.call(e.ie)};c.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this.ie,t)}catch(e){if(this.unsubscribe(),c.v.useDeprecatedSynchronousErrorHandling)throw e;(0,u.z)(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!c.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this.ie,n)}catch(t){return c.v.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):((0,u.z)(t),!0)}return!1},t.prototype.re=function(){var e=this.ne;this.ie=null,this.ne=null,e.unsubscribe()},t}(l)},1057:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var i=n(20),r=n(3559),o=n(810),s=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),a=function(){function e(e){this.closed=!1,this.te=null,this.oe=null,e&&(this.se=!0,this.re=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,a=n.te,u=n.se,l=n.re,d=n.oe;if(this.closed=!0,this.te=null,this.oe=null,a instanceof e)a.remove(this);else if(null!==a)for(var h=0;h<a.length;++h)a[h].remove(this);if((0,o.m)(l)){u&&(this.re=void 0);try{l.call(this)}catch(e){t=e instanceof s?c(e.errors):[e]}}if((0,i.k)(d)){h=-1;for(var f=d.length;++h<f;){var p=d[h];if((0,r.K)(p))try{p.unsubscribe()}catch(e){t=t||[],e instanceof s?t=t.concat(c(e.errors)):t.push(e)}}}if(t)throw new s(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var i=n;(n=new e).oe=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var r=n.te;if(null===r)n.te=this;else if(r instanceof e){if(r===this)return n;n.te=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}var o=this.oe;return null===o?this.oe=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this.oe;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function c(e){return e.reduce((function(e,t){return e.concat(t instanceof s?t.errors:t)}),[])}},1745:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var i=!1,r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){i=e},get useDeprecatedSynchronousErrorHandling(){return i}}},377:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});var i=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},6030:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});var i=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},2214:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var i=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},7691:(e,t,n)=>{"use strict";function i(e){setTimeout((function(){throw e}),0)}n.d(t,{z:()=>i})},20:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var i=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}()},810:(e,t,n)=>{"use strict";function i(e){return"function"==typeof e}n.d(t,{m:()=>i})},3559:(e,t,n)=>{"use strict";function i(e){return null!==e&&"object"==typeof e}n.d(t,{K:()=>i})},2701:(e,t,n)=>{"use strict";n.d(t,{ZT:()=>r});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}},7425:(e,t,n)=>{"use strict";n.d(t,{CR:()=>a,Jh:()=>o,XA:()=>s,ev:()=>c,mG:()=>r,pi:()=>i});var i=function(){return i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)};function r(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function o(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function c(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}Object.create,Object.create},4734:(e,t,n)=>{"use strict";var i;n.d(t,{L8:()=>d}),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(i||(i={}));var r,o,s=n(6266),a=n(5823),c=function(){function e(e){var t=this;this.ae=3e4,this.ce=30,this.ue=0,this.le=[],this.de=(0,a.Ks)(),this.he=[],this.fe="",this.pe=0,this.flushOnClose=function(){t.ve(!1,!1)},this.flush=function(){t.me()},this.flushAndSetNewEndpoint=function(e,n){var i,r=t.ge(e);r.localeCompare(null!==(i=t.we)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(t.he.push((function(){t.we=r,n&&n()})),t.ve(!0,!0))},this.ge=function(e){return e+"?usid="+t.fe+"&officeserverversion="+function(){try{return __VERSION_PLACEHOLDER__}catch(e){return"###VERSION###"}}()},this.me=function(){window.setTimeout((function(){return t.ve(!0,!0)}),0)},this.ve=function(e,n){var i,r,o,s,c,u,l,d=(0,a.u3)();window.clearTimeout(t.ye),t.we&&(t.le.length>0&&(t.ue+=1,function(e,t,n){if(t){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(t,e)}catch(e){}!function(e,t,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}(e,t,n)}}((i=t.le.splice(0,e?t.ce:t.le.length),r=t.fe,o=t.ue,s=t.de,c=[],u=i.map((function(e){return function(e,t,n){var i={};if(i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category,e.correlationId){var r=n.findIndex((function(t){return t===e.correlationId}));r<0&&(r=n.push(e.correlationId)-1),i.I=r}var o=1e3*e.type+e.level;return i.D=o,i}(e,s,c)})),l=function(e,t,n,i,r){var o={};return o.T=e,o.L=t,o.S=n,o.I=i,r&&r.length>0&&(o.W=r),o.V=1,o}(s,u,r,o,c),JSON.stringify(l)),t.we,n),t.de=(0,a.Ks)()),0===t.le.length&&t.he.length>0&&(t.he.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.he=[]),e&&(t.ye=window.setTimeout((function(){t.me()}),t.le.length>t.ce||t.he.length>0?1e3:t.ae)),t.pe+=(0,a.u3)()-d)},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.pe},e.prototype.addLoggingTime=function(e){this.pe+=e},e.prototype.configure=function(e){var t=this,n=(0,a.u3)();if(e.uploadCadenceInMs&&(this.ae=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.ce=e.uploadTriggerSize),e.sessionId&&(this.fe=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.we)throw new Error("Remote ULS endpoint is already set");this.we=this.ge(e.remoteUlsEndpoint),this.de=(0,a.Ks)(),window.setTimeout((function(){return t.ve(!0,!0)}),0)}this.pe+=(0,a.u3)()-n},e.prototype.handleTrace=function(e){var t=(0,a.u3)();e.message.length>3072&&(e.message=e.message.substring(0,3059)+"... [Trimmed]"),this.le.push(e),(this.le.length>this.ce||e.level===s.G.Error)&&this.me(),this.pe+=(0,a.u3)()-t},e.prototype.getUserSessionId=function(){return this.fe},e}(),u=[];!function(e){e._e="BootstrapperMaxUlsHeartbeatTime",e.Ce="BootstrapperNoCompleteWarning1Time",e.Se="BootstrapperNoCompleteWarning2Time",e.ke="RemoteUlsETag",e.be="RemoteUlsSuppressions",e.Te="BootstrapperSettingsFetchPeriod",e.Ae="timestamp",e.Ie="BootstrapperUlsHeartbeatIntervalMs",e.Ee="BootstrapperUlsHeartBeatIsEnabled",e.Re="BootstrapperUlsUploadCadenceMs",e.Ne="WordConsumptionViewToEditRedirectIsEnabled",e.Pe="RequestedCallThrottlingDefaultToViewMinimumValue",e.He="BulsEndpointUrl",e.Oe="EnableCommonHostDiagnosticsParams",e.Ue="EnableOnSubmitCallbackForWacFrame"}(o||(o={}));var l=6e4;function d(e){var t=new c(e);function n(e,n,r,o){var s=(0,a.u3)();if(!function(e){return 1===u[e]}(e)){var c={timestamp:(0,a.Ks)(),category:n,tag:e,level:r,type:i.Trace,message:o,correlationId:""};t.addLoggingTime((0,a.u3)()-s),t.handleTrace(c)}}return{ULS:{sendTraceTag:function(e,t,i,r){n(e,t,i,r)},shipAssertTag:function(e,t,i,r){i&&n(e,t,s.G.Error,r)},debugAssertTag:function(e,t,n,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var n,i;n=e.Me.getValue(o.be,""),i=e.Me.getValue(o.ke,""),r&&i===r||(u=[],r=i,n&&n.split(",").forEach((function(e){var t=parseInt(e,10);t&&(u[t]=1)}))),t.configure({uploadCadenceInMs:e.Me.getValue(o.Re,l)});var s=e.Me.getValue(o.He,"").toString();""!==s&&t.flushAndSetNewEndpoint(s)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,n){t.flushAndSetNewEndpoint(e,n)}}}},8093:(e,t,n)=>{"use strict";function i(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}n.d(t,{n:()=>o});var r=n(5823);function o(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(i(e)))}}t.perfNow=r.Xm;for(var o=0;o<e.length;o+=1){try{if(r.Xm){var s=Math.floor(100*window.performance.now())%10;(s<0||s>9)&&(s=0);for(var a=0;a<s;a+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(i(e)))}e[o]=Math.floor(16*Math.random())}return t}(e),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=15&e[n];return n+=1,("x"===t?i:3&i|8).toString(16)})),t]}},5823:(e,t,n)=>{"use strict";n.d(t,{Ks:()=>s,Xm:()=>r,u3:()=>o});var i,r=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function o(){return r?window.performance.now():Date.now()}function s(){if(!i){var e=window.performance;i=r&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return i()}},2009:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});var i,r=n(2957),o=n(7425),s=function(){function e(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return e.prototype.isEventBlocked=function(e){var t=this.blockedEvents.get(e);return!!t&&(Date.now()>=t?(this.unblockEvent(e),!1):(this.aggregateEventCount(e),!0))},e.prototype.blockEvent=function(e,t){var n=Date.now()+t;this.blockedEvents.set(e,n),this.updateEventHitCount(e,0),this.eventDurations.delete(e),this.eventDurationsTotal.delete(e)},e.prototype.unblockEvent=function(e){this.blockedEvents.delete(e)},e.prototype.getEventHitCount=function(e){return this.eventHitCounts.get(e)},e.prototype.updateEventHitCount=function(e,t){this.eventHitCounts.set(e,t)},e.prototype.aggregateEventCount=function(e){var t=this.getEventHitCount(e);"number"==typeof t&&this.updateEventHitCount(e,++t)},e.prototype.getEventDurations=function(e){return this.eventDurations.get(e)},e.prototype.aggregateEventDuration=function(e,t){var n,i=(null!==(n=this.getEventHitCount(e))&&void 0!==n?n:0)+1,r=this.eventDurationsTotal.get(e),s=this.eventDurations.get(e);if(void 0!==s){var a=(0,o.ev)([],s,!0);s[0]>t&&(a[0]=t),s[1]<t&&(a[1]=t);var c=void 0;void 0!==r&&r.length<10?(r.push(t),c=r.reduce((function(e,t){return e+t}),0)/i):(c=s[2]+(t-s[2])/i,this.eventDurationsTotal.delete(e)),a[2]=c,this.eventDurations.set(e,a)}else this.eventDurations.set(e,[t,t,t]),this.eventDurationsTotal.set(e,[t])},e}(),a=function(){function e(e,t,n,i,r){this.healthLogger=e,this.featureConfig=t,this.kpiUsageEventBlocker=n,this.kpiFailureEventBlocker=i,this.kpiSuccessEventBlocker=r}return e.prototype.logKpiUsage=function(t,n,i,r){var o=this.getKpiKey(t+e.USAGE_KPI,null==i?void 0:i.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(o))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(i),this.recordKpiUsage(t,n,i,o),0!==r){var s=null!=r?r:3e5;this.kpiUsageEventBlocker.blockEvent(o,s)}return!0},e.prototype.logKpiFailure=function(t,n,i,r,o){var s,a,c,u=this.getKpiKey(t+e.FAILURE_KPI+n,null===(s=null==i?void 0:i.additionalValues)||void 0===s?void 0:s.extendedProperties);if("number"==typeof(null===(a=null==i?void 0:i.additionalValues)||void 0===a?void 0:a.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(u,i.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(u))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(t,n,i,u),r&&this.recordQosError(null!==(c=r.errorNameOverride)&&void 0!==c?c:n,r.name,r),0!==o){var l=null!=o?o:3e5;this.kpiFailureEventBlocker.blockEvent(u,l)}return!0},e.prototype.logKpiSuccess=function(t,n,i){var r,o,s=this.getKpiKey(t+e.SUCCESS_KPI,null===(r=null==n?void 0:n.additionalValues)||void 0===r?void 0:r.extendedProperties);if("number"==typeof(null===(o=null==n?void 0:n.additionalValues)||void 0===o?void 0:o.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(s,n.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(s))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(t,n,s),0!==i){var a=null!=i?i:3e5;this.kpiSuccessEventBlocker.blockEvent(s,a)}return!0},e.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(t){var n,r=this.featureConfig.topLevelKpiName,o=this.getKpiKey(this.featureConfig.topLevelKpiName,null==t?void 0:t.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=o?o:"")){this.recordKpiUsage(r,i.FailureBased,t);var s=null!==(n=this.featureConfig.vetoPillar)&&void 0!==n?n:this.featureConfig.areaName;s&&e.QOS_PILLARS_LIST.includes(s)&&this.healthLogger.addQosPillar(s),this.kpiUsageEventBlocker.blockEvent(null!=o?o:"",864e5)}},e.prototype.recordKpiUsage=function(e,t,n,i){var r;void 0===n&&(n={});var o=(r=n||{}).extendedProperties,s=r.isForAlertableKpi,a=this.createExtendedPropertiesWithMoreFields(o,i);s?this.healthLogger.recordKpiUsageForAlertableKpi(e,this.featureConfig.crewAlias,a):this.healthLogger.recordKpiUsage(e,t,this.featureConfig.crewAlias,a)},e.prototype.getKpiKey=function(e,t){var n=this.getKpiAreaName(t),i=this.getKpiFeatureName(t),r=this.getKpiPivot(t);return"".concat(n,".").concat(i,".").concat(null!=e?e:"").concat(r&&0===r.length?"."+r:"")},e.prototype.getKpiAreaName=function(t){var n,i,r;return null!==(r=null!==(i=null!==(n=null==t?void 0:t.get(e.AREA_NAME_COLUMN_KEY))&&void 0!==n?n:this.featureConfig.areaName)&&void 0!==i?i:this.featureConfig.vetoPillar)&&void 0!==r?r:""},e.prototype.getKpiFeatureName=function(t){var n,i;return null!==(i=null!==(n=null==t?void 0:t.get(e.FEATURE_NAME_COLUMN_KEY))&&void 0!==n?n:this.featureConfig.featureName)&&void 0!==i?i:""},e.prototype.getKpiPivot=function(t){var n=null==t?void 0:t.get(e.PIVOT_TYPE_COLUMN_KEY),i=null==t?void 0:t.get(e.PIVOT_VALUE_COLUMN_KEY);return n&&0!==n.length&&i&&0!==i.length?"".concat(n,"=").concat(i):""},e.prototype.recordKpiFailure=function(e,t,n,i){var r;void 0===n&&(n={});var o=(r=n||{}).isIntentional,s=r.isInternal,a=r.additionalValues,c=r.hasImpliedUsage,u=this.createAdditionalValuesWithMoreFields(a,i);!1===c?this.healthLogger.recordKpiFailure(e,t,o,s,u):this.healthLogger.recordKpiImpliedFailure(e,t,o,s,this.featureConfig.crewAlias,u)},e.prototype.recordKpiSuccess=function(e,t,n){var i;void 0===t&&(t={});var r=(i=t||{}).additionalValues,o=i.hasImpliedUsage,s=this.createAdditionalValuesWithMoreFields(r,n);!1===o?this.healthLogger.recordKpiSuccess(e,s):this.healthLogger.recordKpiImpliedSuccess(e,this.featureConfig.crewAlias,s)},e.prototype.recordQosError=function(e,t,n){void 0===n&&(n={});var i=n.isIntentional,r=n.isInternal,o=n.alertOnPillar,s=n.isSessionEndingError,a=n.additionalValues,c=this.createAdditionalValuesWithMoreFields(a);this.healthLogger.recordQosError(e,[t],i,r,o,s,c)},e.prototype.createExtendedPropertiesWithMoreFields=function(t,n){var i=new Map(t||new Map);if(i.get(e.FEATURE_NAME_COLUMN_KEY)||i.set(e.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(t)),i.set(e.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(i)),i.has(e.SKIP_ARIA_COLUMN_KEY)||i.has("skipAria")||i.set(e.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&n){var r=this.getEventBlocker(n);if(r){var o=r.getEventHitCount(n);if(o){i.set(e.AGGREGATED_COUNT_COLUMN_KEY,o.toString());var s=r.getEventDurations(n);o>1&&s&&i.set(e.AGGREGATED_DURATION_COLUMN_KEY,s.map((function(e){return Math.round(100*e)/100})).toString())}}}return i},e.prototype.createAdditionalValuesWithMoreFields=function(e,t){var n={};return(n=(0,o.pi)({},e)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==e?void 0:e.extendedProperties,t),n},e.prototype.getEventBlocker=function(t){return t.endsWith(e.USAGE_KPI)?this.kpiUsageEventBlocker:t.includes(e.FAILURE_KPI)?this.kpiFailureEventBlocker:t.endsWith(e.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},e.FEATURE_NAME_COLUMN_KEY="FeatureName",e.AREA_NAME_COLUMN_KEY="AreaName",e.AGGREGATED_COUNT_COLUMN_KEY="AggCount",e.AGGREGATED_DURATION_COLUMN_KEY="AggMs",e.SKIP_ARIA_COLUMN_KEY="SkipAria",e.PIVOT_TYPE_COLUMN_KEY="PivotType",e.PIVOT_VALUE_COLUMN_KEY="PivotValue",e.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],e.USAGE_KPI=".Usage",e.SUCCESS_KPI=".Success",e.FAILURE_KPI=".Failure.",e}(),c=function(){function e(t,n,r,s,c){var u,l,d,h=this;this.healthLogger=t,this.featureConfig=n,this.kpiUsageEventBlocker=r,this.kpiFailureEventBlocker=s,this.kpiSuccessEventBlocker=c,this.featureUsageAndHealthLogger=new a(this.healthLogger,this.featureConfig,null!==(u=this.kpiUsageEventBlocker)&&void 0!==u?u:e.kpiUsageBlocker,null!==(l=this.kpiSuccessEventBlocker)&&void 0!==l?l:e.kpiFailureBlocker,null!==(d=this.kpiFailureEventBlocker)&&void 0!==d?d:e.kpiSuccessBlocker),this.executeCallbackWithLogging=function(e,t){var n,r,s,a=function(e){return"VetoFailureLoggingParams".includes(e)};(null==t?void 0:t.kpiUsageLoggingParams)?(r="Usage",s=null==t?void 0:t.kpiUsageLoggingParams):(null==t?void 0:t.kpiSuccessLoggingParams)?(r="UsageWithSuccess",s=null==t?void 0:t.kpiSuccessLoggingParams):(null==t?void 0:t.kpiFailureLoggingParams)?(r="UsageWithFailure",s=null==t?void 0:t.kpiFailureLoggingParams):(r="UsageWithVetoFailure",s=null==t?void 0:t.vetoFailureLoggingParams);var c=null==s?void 0:s.usageName,u=null==s?void 0:s.usageKpiType;h.logKpiUsage({kpiName:c,kpiType:null!=u?u:i.FailureBased});try{null==e||e(),"UsageWithSuccess"===r&&"KpiSuccessLoggingParams".includes(s)&&h.logKpiSuccess({kpiName:c,optionalProperties:s.successOptionalProperties})}catch(e){if("UsageWithFailure"===r&&"KpiFailureLoggingParams".includes(s)||"UsageWithVetoFailure"===r&&a(s)){var l=void 0;a(s)&&(l=(0,o.pi)({name:null!==(n=s.vetoName)&&void 0!==n?n:""},s.vetoOptionalProperties)),h.logKpiFailure({kpiName:s.usageName,errorName:s.failureErrorName,optionalProperties:s.failureOptionalProperties,optionalVeto:l})}throw e}}}return e.getInstance=function(t,n,i,r,o){return new e(t,n,i,r,o)},e.prototype.logKpiUsage=function(e){var t;return!(!e||!e.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(e.kpiName,null!==(t=e.kpiType)&&void 0!==t?t:i.FailureBased,e.optionalProperties,e.blockFutureEmissionDurationInMs)},e.prototype.logKpiFailure=function(e){return!!(e&&e.kpiName&&e.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(e.kpiName,e.errorName,e.optionalProperties,e.optionalVeto,e.blockFutureEmissionDurationInMs)},e.prototype.logKpiSuccess=function(e){return!(!e||!e.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(e.kpiName,e.optionalProperties,e.blockFutureEmissionDurationInMs)},e.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(e){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(e)},e.kpiUsageBlocker=new s,e.kpiFailureBlocker=new s,e.kpiSuccessBlocker=new s,e}(),u=function(){function e(){}return e.prototype.getHealthInstance=function(e){if(e)return r.S.getInstance().initialize(e),r.S.getInstance()},e.prototype.getExtendedHealthInstance=function(e,t){if(e&&t)return c.getInstance(e,t)},e}();!function(e){e[e.FailureBased=0]="FailureBased",e[e.SuccessBased=1]="SuccessBased"}(i||(i={})),new u},2957:(e,t,n)=>{"use strict";n.d(t,{S:()=>a});var i=n(7425);function r(e){if(e){var t={};return e.forEach((function(e,n){n&&(t[n]=e)})),t}}function o(e,t){var n=[],i=new Set;return e.concat(t).forEach((function(e){return i.add(e)})),i.forEach((function(e){return n.push(e)})),n}var s=n(2009),a=function(){function e(){var e=this;this.De={},this.Fe={},this.xe=[],this.qe={},this.Be=0,this.Le={We:3e5,je:!1,Ke:!1,$e:!1,ze:3e4,Je:25,Ve:"",Qe:864e5,Xe:"",Ye:"",Ze:3,et:3,tt:15e3,nt:new Set},this.it=!1,this.rt=-1,this.ot=!1,this.st=0,this.ct=!0,this.ut=function(){return!1},this.lt={},this.ht=[],this.ft=0,this.vt=0,this.gt=void 0,this.wt=[],this.yt=[],this._t=[],this.Ct=[],this.St=0,this.kt=0,this.bt=0,this.Tt=[],this.At=!1,this.It=0,this.Et=!1,this.Rt=function(){e.St&&(window.clearTimeout(e.St),e.St=0)},this.Nt=function(){e.ht=[],e.wt=[],e.yt=[],e.gt=void 0,e._t=[],e.Ct=[],e.ft=0,e.vt=0},this.Pt=function(){try{if(e.ft<=0)return;var t=e.Ht();e.Ot(t,e.Be,e.Le.et),e.Nt()}catch(e){}},this.Ht=function(){return{d:e.qe,a:e.Mt(),b:e.ht,e:e.yt,h:e.gt,q:e._t,k:e.wt,l:e.Ct,type:"h_v2"}},this.Mt=function(){return e.Le.$e&&(e.ht&&e.ht.length>0||e.yt&&e.yt.length>0)&&Object.keys(e.Fe).length>0?(0,i.pi)((0,i.pi)({},e.De),e.Fe):e.De},this.Dt=function(t,n,i,r){var o;if(void 0===r&&(r=!1),n&&!e.Le.nt.has(i))if(e.ct){switch(t){case 0:e.ht.push(n);break;case 1:e.wt.push(n);break;case 2:e.yt.push(n);break;case 3:-1===e._t.map((function(e){return e.n})).indexOf(n.n)&&e._t.push(n);break;case 4:e.Ct.push(n)}if(e.ft+=1,4!==t&&3!==t&&(e.vt+=1),e.ut()&&!r)return void e.Pt();e.ft>=e.Le.Je&&(e.Rt(),e.Ft())}else n.o=(new Date).toJSON(),null===(o=e.xt)||void 0===o||o.postMessage({t,k:"".concat(e.qe.w,".").concat(e.Be),m:e.qe,c:e.Mt(),v:n})},this.qt=function(){e.Rt(),e.St=window.setTimeout((function(){e.Ft()}),e.Le.ze)},this.Ft=function(t){void 0===t&&(t=!1),t&&e.vt<=0||(e.Pt(),e.qt())},this.Bt=function(){if(e.Tt||e.lt){e.gt&&-1!==e.rt||(e.rt=(e.rt+1)%1e3),e.gt||(e.ft+=1);var t={p:e.gt?o(e.gt.p,e.Tt):e.Tt,k:e.gt?o(e.gt.k,e.xe):e.xe,i:e.Le.We,o:e.rt};e.gt=t}},this.Lt=function(t,n,i,o,s,a,c,u,l,d){if(t&&(!n||e.lt[t])){n||e.Wt(t,u,l,d);var h=e.lt[t],f={n:h.k,e:i,t:h.t,a:h.a,f:h.o,d:null==o?void 0:o.durationMs,p:r(null==o?void 0:o.extendedProperties)};if(s){var p={n:s,x:c,z:a};f.k=p}e.Dt(1,f,t)}},this.jt=function(){var t,n,i,r,o,s,a,c,u,l,d,h,f,p,v,m,g,w,y,_,C,S,k,b,T,A,I,E,R,N,P,H,O,U,M,D,F,x=e.Le.qe;x&&(e.qe={a:null!==(t=x.application)&&void 0!==t?t:void 0,b:null!==(n=x.applicationLcid)&&void 0!==n?n:void 0,c:null!==(i=x.applicationMode)&&void 0!==i?i:void 0,d:null!==(r=x.applicationModeExtended)&&void 0!==r?r:void 0,e:null!==(o=x.arrVersion)&&void 0!==o?o:void 0,f:null!==(s=x.browser)&&void 0!==s?s:void 0,g:null!==(a=x.browserLcid)&&void 0!==a?a:void 0,h:null!==(c=x.browserMajorVersion)&&void 0!==c?c:void 0,i:null!==(u=x.browserVersion)&&void 0!==u?u:void 0,j:null!==(l=x.clientVersion)&&void 0!==l?l:void 0,k:null!==(d=x.datacenter)&&void 0!==d?d:void 0,l:null!==(h=x.dataCulture)&&void 0!==h?h:void 0,m:null!==(f=x.flightsImpressionId)&&void 0!==f?f:void 0,n:null!==(p=x.host)&&void 0!==p?p:void 0,o:null!==(v=x.isAnonymousUser)&&void 0!==v?v:void 0,p:null!==(m=x.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(g=x.isEduUser)&&void 0!==g?g:void 0,r:null!==(w=x.isSynthetic)&&void 0!==w?w:void 0,s:null!==(y=x.loggableUserId)&&void 0!==y?y:void 0,t:null!==(_=x.loggableUserIdSpace)&&void 0!==_?_:void 0,u:null!==(C=x.ring)&&void 0!==C?C:void 0,v:null!==(S=x.serverDocId)&&void 0!==S?S:void 0,w:null!==(k=x.session_id)&&void 0!==k?k:void 0,x:null!==(b=x.sessionOrigin)&&void 0!==b?b:void 0,y:null!==(T=x.tenantId)&&void 0!==T?T:void 0,z:null!==(A=x.uiHost)&&void 0!==A?A:void 0,aa:null!==(I=x.wfeVersion)&&void 0!==I?I:void 0,ab:null!==(E=x.fileExtension)&&void 0!==E?E:void 0,ac:null!==(R=x.uiHostIntegrationType)&&void 0!==R?R:void 0,ad:null!==(N=x.osVersion)&&void 0!==N?N:void 0,af:null!==(P=x.networkDownlink)&&void 0!==P?P:void 0,ag:null!==(H=x.networkDownlinkMax)&&void 0!==H?H:void 0,ah:null!==(O=x.networkEffectiveType)&&void 0!==O?O:void 0,ai:null!==(U=x.networkRTT)&&void 0!==U?U:void 0,aj:null!==(M=x.networkSaveData)&&void 0!==M?M:void 0,ak:null!==(D=x.networkType)&&void 0!==D?D:void 0,al:null!==(F=x.userLicenseType)&&void 0!==F?F:void 0})},this.Kt=function(){e.Bt(),e.st=window.setTimeout((function(){e.Kt()}),e.Le.We)},this.Gt=function(){e.Tt&&e.Tt.forEach((function(t){t&&e.$t(t,!0)}))},this.$t=function(t,n){var i={};i.n=t,e.Dt(3,i,t,n)},this.zt=function(){e.Tt&&(e.kt=Date.now(),e.Gt()),e.Jt()},this.Jt=function(t){void 0===t&&(t=e.Le.Qe),e.bt=window.setTimeout((function(){e.zt()}),t)},this.Vt=function(){e.it||(e.it=!0,e.ot=!0,e.Kt())},this.Qt=function(){0!==e.bt&&(window.clearTimeout(e.bt),e.bt=0)},this.Xt=function(){if(e.Le.je&&e.Le.Ke&&e.Le.Ye&&""!==e.Le.Ye&&e.Le.Ve&&""!==e.Le.Ve)try{if("undefined"==typeof Worker)return void e.Yt(1);if(!e.Le.Ve)return void e.Yt(2);e.Yt(3);var t=new Blob(["try{importScripts('".concat(encodeURI(e.Le.Ve),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});e.xt=new Worker(URL.createObjectURL(t)),e.xt.onmessage=function(t){try{var n=t.data;e.Yt(n.i,n.r)}catch(t){e.Yt(5,t.toString())}},e.xt.postMessage({t:5,v:e.Le.Ye}),e.xt.postMessage({t:6})}catch(t){e.Yt(6,t.toString())}},this.Zt=function(t,n){var i;if(t.b.length>0||t.e.length>0||t.q.length>0||t.k.length>0||t.l.length>0)try{return null===(i=e.xt)||void 0===i||i.postMessage({t:7,k:"".concat(t.d.w,".").concat(n),v:t}),0}catch(t){var r=e.en(t);return e.Yt(15,r),1}return 2},this.Wt=function(t,n,i,r){t&&void 0!==n&&(e.lt[t]||(e.lt[t]={k:t,t:n,a:!0===i,o:null!=r?r:void 0},i&&(e.xe.push(t),e.Bt())))},this.tn=function(t){e.rt=-1,t?(e.kt=Date.now(),e.Jt(),e.Vt()):e.Bt()},this.nn=function(t){return!!e.Et||(e.Yt(0,null==t?void 0:t.toString()),!1)},this.Ot=function(t,n,r){if(t){var o=e.Le.Xe;if(e.At&&(r<=0||!e.ct)&&1!==e.Zt(t,n))return;if(!(r<=0)){var s=e.rn(t,!1);if(null!==s){if(e.ut())try{if(void 0!==navigator.sendBeacon){if(s.length>=65536&&e.Le.$e){var a=(0,i.pi)((0,i.pi)({},t),{a:e.De}),c=e.rn(a,!0);if(null===c)return;navigator.sendBeacon(o,c)}else navigator.sendBeacon(o,s);return}}catch(e){}var u=new XMLHttpRequest;u.open("POST",o,!0),u.onreadystatechange=function(){u.readyState===XMLHttpRequest.DONE&&(200===u.status?e.At||(e.At=!0):e.It<e.Le.Ze?(e.It+=1,window.setTimeout((function(){e.It-=1,e.Ot(t,n,r-1)}),e.Le.tt)):e.At&&e.Zt(t,n))},u.send(s)}}}},this.Yt=function(t,n){var i={i:t,r:n};e.Dt(4,i,t.toString())},this.en=function(e){var t=void 0;return"string"==typeof e?t=e:e instanceof Error&&(t=e.name+" "+e.message,e.stack&&(t+=" "+e.stack)),t},this.rn=function(t,n){try{return r=t,JSON.stringify(r)}catch(t){var i=e.en(t);return i="ModifiedPayload: "+n+" | "+i,e.Yt(16,i),null}var r}}return e.getInstance=function(){return e.sn||(e.sn=new e),this.sn},e.prototype.initialize=function(e){if(e)try{return this.Le=function(e){var t,n,i,r,o,s,a,c,u,l,d,h,f,p,v;return{qe:null!==(t=e.dimensions)&&void 0!==t?t:void 0,We:null!==(n=e.heartbeatIntervalMs)&&void 0!==n?n:3e5,je:null!==(i=e.isHealthEnabled)&&void 0!==i&&i,Ke:null!==(r=e.isOfflineEnabled)&&void 0!==r&&r,$e:null!==(o=e.isErrorPartCEnabled)&&void 0!==o&&o,ze:null!==(s=e.loggerMaxIntervalMs)&&void 0!==s?s:3e4,Je:null!==(a=e.loggerMaxQueueSize)&&void 0!==a?a:25,Ve:null!==(c=e.offlineWorkerUrl)&&void 0!==c?c:"",Ye:null!==(u=e.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==u?u:"",Qe:null!==(l=e.recordPillarToWarmPipelineIntervalMs)&&void 0!==l?l:864e5,Xe:null!==(d=e.remoteTelemetryUrl)&&void 0!==d?d:"",Ze:null!==(h=e.maxConcurrentRetries)&&void 0!==h?h:3,et:null!==(f=e.retryMaxAttempts)&&void 0!==f?f:3,tt:null!==(p=e.retryDelayMs)&&void 0!==p?p:15e3,nt:null!==(v=e.disabledHealthEvents)&&void 0!==v?v:new Set}}(e),this.jt(),this.qt(),this.Xt(),this.Et=!0,void this.Yt(7)}catch(e){}this.Et=!1},e.prototype.addOrUpdatePartCDimension=function(e,t){this.nn(0)&&e&&(this.De.hasOwnProperty(e)&&this.De[e]===t||(this.Ft(!0),this.De[e]=t,this.Be+=1,this.Bt(),this.Gt()))},e.prototype.addOrUpdateErrorPartCDimension=function(e,t){this.Le.$e&&e&&(this.Fe[e]=t)},e.prototype.addQosPillar=function(e){if(e){var t=0===this.Tt.length;-1===this.Tt.indexOf(e)&&(this.Tt.push(e),this.$t(e,!1),this.tn(t))}},e.prototype.recordBsqmQosError=function(e,t,n){if(this.nn(1)&&(this.an(!1),this.Gt(),e)){var i={b:e,v:t,d:null==n?void 0:n.durationMs,p:r(null==n?void 0:n.extendedProperties),s:this.Tt,i:null==n?void 0:n.inStaging};this.Dt(0,i,e),this.shutdown(!0)}},e.prototype.recordKpiFailure=function(e,t,n,i,r){this.Lt(e,!0,0,r,t,i,n)},e.prototype.recordKpiImpliedFailure=function(e,t,n,i,r,o){this.Lt(e,!1,1,o,t,i,n,s.o.FailureBased,!1,r)},e.prototype.recordKpiImpliedSuccess=function(e,t,n){this.Lt(e,!1,2,n,void 0,void 0,void 0,s.o.FailureBased,!1,t)},e.prototype.recordKpiSuccess=function(e,t){this.Lt(e,!0,3,t)},e.prototype.recordKpiUsage=function(e,t,n,i){this.Lt(e,!1,4,{extendedProperties:i},void 0,void 0,void 0,t,!1,n)},e.prototype.recordKpiUsageForAlertableKpi=function(e,t,n){if(e){var i=!0,r=this.lt[e];r&&(i=r.t===s.o.FailureBased),this.Lt(e,!1,4,{extendedProperties:n},void 0,void 0,void 0,s.o.FailureBased,!0,t),i&&this.Vt()}},e.prototype.recordQosError=function(e,t,n,i,o,s,a){if((!s||this.nn(2))&&e&&t){var c={n:e,x:n,z:i,l:o,v:t,e:s,d:null==a?void 0:a.durationMs,p:r(null==a?void 0:a.extendedProperties),s:this.Tt,i:null==a?void 0:a.inStaging};this.Dt(2,c,e),s&&(this.an(!1),this.Gt(),this.shutdown(!0))}},e.prototype.removeQosPillar=function(e){if(e){var t=this.Tt.indexOf(e);t>-1&&(this.Tt.splice(t,1),this.tn(!1)),0===this.Tt.length&&this.Qt()}},e.prototype.resumeAllHealthTimers=function(){if(this.it&&!this.ot&&this.Kt(),0===this.bt&&0!==this.kt){var e=Date.now()-this.kt;e>=this.Le.Qe||e<=0?this.zt():this.Jt(this.Le.Qe-e)}},e.prototype.setHandlerForIsAppShuttingDown=function(e){e&&(this.ut=e)},e.prototype.setIsAppOnline=function(e){var t;this.nn(3)&&(!this.ct&&e&&(null===(t=this.xt)||void 0===t||t.postMessage({t:6,v:this.ut()})),this.ct=e)},e.prototype.shutdown=function(e){var t;void 0===e&&(e=!1),this.Le.je&&(this.Rt(),this.an(!1),this.ut=function(){return!0},this.Pt(),(!e||e&&this.ct)&&(null===(t=this.xt)||void 0===t||t.terminate()))},e.prototype.stopAllHealthTimers=function(){this.an(!0)},e.prototype.an=function(e){this.ot=!1,this.rt=-1,0!==this.st&&(window.clearTimeout(this.st),this.st=0),this.Qt(),e&&this.Pt()},e.prototype.updatePartADimensions=function(e){var t=this;if(e&&this.nn(4)){var n=!1;Object.keys(e).forEach((function(i){void 0!==e[i]&&null!==e[i]&&""!==e[i]&&t.Le.qe[i]!==e[i]&&(t.Le.qe[i]=e[i],n=!0)})),n&&(this.Ft(),this.jt(),this.Be+=1,this.Bt(),this.Gt())}},e.prototype.flushAndSetNewEndpoint=function(e,t){var n;e.localeCompare(null!==(n=this.Le.Xe)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(this.Ft(!1),this.Le.Xe=e,t&&t())},e}()},4629:(e,t,n)=>{"use strict";var i;n.d(t,{W:()=>i}),function(e){e[e.cn=0]="msoulscat_ES_EWAJS",e[e.un=1]="msoulscat_ES_EWAJSGrid",e[e.ln=6]="msoulscat_ES_EWAJSChart",e[e.dn=202]="msoulscat_MSOSP_FileMenuCommands",e[e.hn=225]="msoulscat_MSOSP_OTelJS",e[e.pn=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.vn=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.mn=301]="msoulscat_Wac_WordViewer",e[e.gn=306]="msoulscat_Wac_BrowserGeneral",e[e.wn=320]="msoulscat_Wac_TaskPane",e[e.yn=339]="msoulscat_Wac_OneNoteGeneral",e[e._n=340]="msoulscat_Wac_Ribbon",e[e.Cn=356]="msoulscat_Wac_WacFeedback",e[e.Sn=379]="msoulscat_Wac_WopiPendingApplication",e[e.kn=383]="msoulscat_Wac_Telemetry",e[e.bn=391]="msoulscat_Wac_WacCatchUpActivities",e[e.Tn=394]="msoulscat_Wac_Dictation",e[e.An=395]="msoulscat_Wac_OneNoteSync",e[e.In=700]="msoulscat_Wac_VisioApp",e[e.En=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.Rn=800]="msoulscat_Wac_PptAnimation",e[e.Nn=833]="msoulscat_Wac_PptLive",e[e.Pn=834]="msoulscat_Wac_PptMWeb",e[e.Hn=844]="msoulscat_Wac_PptDataSync",e[e.On=848]="msoulscat_Wac_PptFluidRuntime",e[e.Un=815]="msoulscat_Wac_PptShape",e[e.Mn=817]="msoulscat_Wac_PptSession",e[e.Dn=830]="msoulscat_Wac_PptSlideshow",e[e.Fn=822]="msoulscat_Wac_PptView",e[e.xn=846]="msoulscat_Wac_PptVideos",e[e.qn=2300]="msoulscat_Wac_VersionHistory",e[e.Bn=302]="msoulscat_Wac_WordPresence",e[e.Ln=3e3]="msoulscat_Wac_OAuth",e[e.Wn=3005]="msoulscat_Wac_WordVersionHistory",e[e.jn=3006]="msoulscat_Wac_LivePersonaCard",e[e.Kn=3012]="msoulscat_Wac_CatchUpFlyout",e[e.Gn=3016]="msoulscat_Wac_WordDesigner",e[e.$n=3021]="msoulscat_Wac_ModernFontPicker",e[e.zn=3027]="msoulscat_Wac_UnifiedUiHost",e[e.Jn=3033]="msoulscat_Wac_EquationTools",e[e.Vn=1401]="msoulscat_Osf_Latency",e[e.Qn=1402]="msoulscat_Osf_Notification",e[e.Xn=1403]="msoulscat_Osf_Runtime",e[e.Yn=3041]="msoulscat_Wac_AiMaker",e[e.Zn=3043]="msoulscat_Wac_AiRewrite",e[e.ei=3044]="msoulscat_Wac_AiInsert",e[e.ti=3047]="msoulscat_Wac_AiSummarize",e[e.ni=3048]="msoulscat_Wac_CopilotCompose",e[e.ii=3049]="msoulscat_Wac_Skittles"}(i||(i={}))},6266:(e,t,n)=>{"use strict";var i;n.d(t,{G:()=>i}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={}))},5461:(e,t,n)=>{"use strict";n.d(t,{o:()=>a});var i=n(4629),r=n(6266),o=n(7702),s=n(531);function a(e,t,n,c,u,l,d){void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===l&&(l=!0),void 0===d&&(d=!1);var h=(0,s.a)();return(0,s.l)("wopiDataStartTime"),t(e,c,u,n).then((function(t){var a,c,u,l;if(!t){var d="Graph call failed";return null==n||n.ULS.sendTraceTag(553726284,i.W.zn,r.G.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(d,"]")),Promise.reject(d)}var f={docUrl:null!==(a=t.webDavUrl)&&void 0!==a?a:e.docUrl,driveId:null!==(u=null===(c=null==t?void 0:t.parentReference)||void 0===c?void 0:c.driveId)&&void 0!==u?u:e.driveId,docId:null!==(l=null==t?void 0:t.id)&&void 0!==l?l:e.docId,fileName:t.name};null==n||n.ULS.sendTraceTag(553726285,i.W.zn,r.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!f,"]"));var p=Promise.resolve(f);null==n||n.ULS.sendTraceTag(553726286,i.W.zn,r.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!p,"]"));var v=(0,o.YI)(t,n);null==n||n.ULS.sendTraceTag(553726287,i.W.zn,r.G.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!v,"]"));var m={startTime:h,endTime:(0,s.a)()};return(0,s.l)("wopiDataEndTime"),{fetchedDocumentIdentifier:p,wopiHostData:v,fetchDiagnostics:m}})).catch((function(o){return null==n||n.ULS.sendTraceTag(520729472,i.W.zn,r.G.Warning,"GetWopiData: General getWopiData error. [Error: ".concat(JSON.stringify(o),"][FailureReason: ").concat(null==o?void 0:o.failure,"]")),l&&(null==o?void 0:o.retry)?(null==n||n.ULS.sendTraceTag(544306772,i.W.zn,r.G.Error,"GetWopiData: Retrying getWopiData. [Error: ".concat(JSON.stringify(o),"][FailureReason: ").concat(null==o?void 0:o.failure,"]")),a(e,t,n,c,u,!1)):l&&d&&"accessDenied"===(null==o?void 0:o.errorCode)?new Promise((function(e){setTimeout(e,3e3),null==n||n.ULS.sendTraceTag(523269073,i.W.zn,r.G.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(o),"][FailureReason: ").concat(null==o?void 0:o.failure,"]"))})).then((function(){return a(e,t,n,c,u,!1)})):(null==n||n.ULS.sendTraceTag(544306773,i.W.zn,r.G.Error,"GetWopiData: Not retrying getWopiData. [Error: ".concat(JSON.stringify(o),"][ShouldRetry: ").concat(l,"][FailureReason: ").concat(null==o?void 0:o.failure,"]")),Promise.reject(o))}))}},7702:(e,t,n)=>{"use strict";n.d(t,{YI:()=>c,q_:()=>a});var i=n(7425),r=n(4629),o=n(6266),s=n(559);function a(e){return e.shareUrl?e.shareUrl:e.docId&&e.driveId?"".concat(e.driveId,"_").concat(e.docId):e.docUrl?e.docUrl:e.isNewFile&&e.fileName?"".concat(e.fileName,"_").concat(s.T[e.fileType]):e.baseUrl&&e.fileId?"".concat(e.baseUrl,"_").concat(e.fileId):void 0}function c(e,t){var n,s,a,c,u,l,d,h=!!(null==e?void 0:e.openWith),f=!!(null===(n=null==e?void 0:e.openWith)||void 0===n?void 0:n.wac);return null==t||t.ULS.sendTraceTag(553916429,r.W.zn,o.G.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(h,"][ValidWac: ").concat(f,"]")),{bundleStaleness:e.officeBundle?e.officeBundle.bundleStaleness:0,bundleUrl:e.officeBundle?e.officeBundle.url:"",bundleVersion:e.officeBundle?e.officeBundle.version:"",sharepointSiteUrl:e.sharepointIds?e.sharepointIds.siteUrl:"",downloadUrl:e["@content.downloadUrl"]||e["@microsoft.graph.downloadUrl"],eTag:e.eTag,fileName:e.name,fileSize:e.size,irmEnabled:(null===(s=e.file)||void 0===s?void 0:s.contentSensitivityLabelProtected)||(null===(a=e.file)||void 0===a?void 0:a.irmEffectivelyEnabled)||(null===(c=e.sensitivityLabel)||void 0===c?void 0:c.protectionEnabled)||(null===(u=e.file)||void 0===u?void 0:u.irmEnabled),isNewFile:!1,readOnly:e.currentUserRole&&e.currentUserRole.readOnly,blocksDownload:e.currentUserRole&&e.currentUserRole.blocksDownload,wac:e.openWith.wac,sharePointInfo:(0,i.pi)({},e.sharepointIds),webUrl:e.webUrl,preSeededSessionKey:null===(l=null==e?void 0:e.wacSession)||void 0===l?void 0:l.preSeededSessionKey,preSeededWacSessionId:null===(d=null==e?void 0:e.wacSession)||void 0===d?void 0:d.preSeededWacSessionId,webDavUrl:e.webDavUrl}}},4301:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i,r=n(4629),o=n(6266),s=n(872);function a(e,t,n,a,c){if(a){var u=function(e){switch(e){case s.KX.PostMessage_RefreshSessionInfo:return i.sendSessionInfo;case s.KX.PostMessage_GrantPermissions:return i.sendUserAccessAndPermissions;case s.KX.PostMessage_SetAuthToken:return i.sendAuthToken;case s.KX.PostMessage_HostAccessibilityLoopComplete:return i.continueAccessibilityLoop;case s.KX.PostMessage_SetHostWopiInfoFromUrl:return i.sendWopiInfo;case s.KX.PostMessage_MoveToFolderCompleted:return i.moveToFolder;case s.KX.PostMessage_CompleteFilePicker:return i.completeSharedFilePicker;case s.KX.PostMessage_SendCustomAuthConfig:return i.sendCustomAuthConfig;case s.KX.PostMessage_SetDavUrlFromIds:return i.sendDavUrl;case s.KX.PostMessage_BlurFocus:return i.blurFocus;case s.KX.PostMessage_PopState:return i.popState;case s.KX.PostMessage_GrabFocus:return i.grabFocus;case s.KX.PostMessage_HostGetClientUrl:return i.getClientUrl;case s.KX.PostMessage_HostGetWebUrl:return i.getWebUrl;case s.KX.PostMessage_OwlFrameDiagnostics:return i.sendOwlFrameDiagnostics;default:return}}(e);if(u){var l=u;a.run(l,t).catch((function(e){return null==c?void 0:c.ULS.sendTraceTag(512337544,r.W.zn,o.G.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(e))}))}}else n?n.then((function(n){n?function(e,t,n,i){var s,a=null;try{a=new URL(e)}catch(t){return void(null==i||i.ULS.sendTraceTag(541180047,r.W.zn,o.G.Warning,"Failed to send post message. could not create url from ".concat(e," with error: ").concat(t)))}var c=a.origin,u={MessageId:t,SendTime:(new Date).getTime(),Values:n},l=JSON.stringify(u),d=document.getElementById("WebApplicationFrame");d?null===(s=null==d?void 0:d.contentWindow)||void 0===s||s.postMessage(l,c):null==i||i.ULS.sendTraceTag(541180048,r.W.zn,o.G.Warning,"Failed to send post message. Could not find iframe")}(n,e,t,c):null==c||c.ULS.sendTraceTag(541180045,r.W.zn,o.G.Warning,"Failed to send post message. appUrl is null")})).catch((function(e){return null==c?void 0:c.ULS.sendTraceTag(512337543,r.W.zn,o.G.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(e))})):null==c||c.ULS.sendTraceTag(541180046,r.W.zn,o.G.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}!function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared"}(i||(i={}))},1921:(e,t,n)=>{"use strict";var i;function r(e){var t=e.toUpperCase();return"CHC"===t||"DEC"===t||"EUC"===t||"EURPPC"===t||"FRC"===t||"SEC"===t||"NOC"===t?i.EuropeanUnion:i.RestOfWorld}n.d(t,{U:()=>i,g:()=>r}),function(e){e[e.RestOfWorld=0]="RestOfWorld",e[e.EuropeanUnion=1]="EuropeanUnion"}(i||(i={}))},1240:(e,t,n)=>{"use strict";n.d(t,{A8:()=>c,PO:()=>u,S$:()=>s,XQ:()=>a,Y6:()=>d,fy:()=>o,tf:()=>h,w8:()=>l,wl:()=>r});var i=n(1921);function r(e,t){switch(e){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return t===i.U.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function o(e,t){return r(e,t)+"RemoteUls.ashx"}function s(e,t,n){var i=r(e,n)+"RemoteTelemetry.ashx";return t&&(i+="?usid="+t),i}function a(e,t){return"".concat(r(e),"OpenDocument.ashx").concat(t?"?corrid=".concat(t,"&usid=").concat(t):"")}function c(e){switch(e){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function u(e){switch(e){case"TRAILBLAZER":return"https://admin.onedrive.us/share";case"PATHFINDER":return"https://od.apps.mil/share";case"AIRGAP08":return"https://odweba.svc.ms.eaglex.ic.gov";case"AIRGAP09":return"https://odweba.svc.ms.microsoft.scloud";default:return"https://www.odwebp.svc.ms/share"}}function l(){return"res.cdn.office.net/officehub"}function d(){return"https://microsoft-my.sharepoint.com"}function h(){return"https://microsoft.sharepoint.com"}},2661:(e,t,n)=>{"use strict";var i;n.d(t,{W:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.NoContent=204]="NoContent",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.Locked=423]="Locked",e[e.Throttled=429]="Throttled",e[e.InternalServiceError=500]="InternalServiceError",e[e.NotImplemented=501]="NotImplemented",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.UnexpectedResponse=700]="UnexpectedResponse",e[e.TokenRefreshFailed=701]="TokenRefreshFailed",e[e.TokenUnavailable=702]="TokenUnavailable",e[e.RetryFailed=703]="RetryFailed",e[e.AlternateResponse=704]="AlternateResponse",e[e.Cancelled=705]="Cancelled",e[e.Offline=706]="Offline",e[e.Timeout=707]="Timeout",e[e.DecryptionError=708]="DecryptionError",e[e.CacheMiss=709]="CacheMiss"}(i||(i={}))},872:(e,t,n)=>{"use strict";var i,r,o,s;n.d(t,{Dm:()=>r,E_:()=>i,KX:()=>o}),function(e){e.Event_DocumentReboot="DocReboot",e.Event_SetOverlayContent="SetOverlayContent",e.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",e.Event_Unloaded="Unloaded",e.Event_MoveToFolder="MoveToFolder",e.Event_SharedFilePicker="FilePicker",e.Event_GetCustomAuthConfig="GetCustomAuthConfig",e.Event_GetDavUrlFromIds="DavUrlFromIds"}(i||(i={})),function(e){e.PostMessage_FileRenamed="File_Rename",e.PostMessage_Close="UI_Close",e.PostMessage_EditModeSwitch="UI_Edit",e.PostMessage_FileVersion="UI_FileVersions",e.PostMessage_SaveStatus="UI_SaveStatus",e.PostMessage_Share="UI_Sharing",e.PostMessage_Workflow="UI_Workflow",e.PostMessage_UserActivity="User_Activity",e.PostMessage_EditNotification="Edit_Notification",e.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",e.PostMessage_PostMessageDocReboot="App_DocReboot",e.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",e.PostMessage_AppCreateNewDocument="App_CreateNewDocument",e.PostMessage_GetAuthToken="App_GetAuthToken",e.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",e.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",e.PostMessage_ActionComplete="Wac_ActionComplete",e.PostMessage_OpenInBrowser="UI_OpenInBrowser",e.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",e.PostMessage_AppPushState="App_PushState",e.PostMessage_CAAEMessage="CAAEMessage",e.PostMessage_FileEmbed="UI_FileEmbed"}(r||(r={})),function(e){e.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",e.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",e.PostMessage_SetOverlayContent="SetOverlayContent",e.PostMessage_SetAuthToken="Host_SetAuthToken",e.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",e.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.PostMessage_HostGetClientUrl="Host_GetClientUrl",e.PostMessage_HostGetWebUrl="Host_GetWebUrl",e.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",e.PostMessage_CompleteFilePicker="Host_FilePicker",e.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",e.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",e.PostMessage_BlurFocus="Blur_Focus",e.PostMessage_PopState="App_PopState",e.PostMessage_GrabFocus="Grab_Focus",e.PostMessage_OwlFrameDiagnostics="OwlFrameDiagnostics"}(o||(o={})),function(e){e.AccessToken="AccessToken",e.FileGetUrl="FileGetUrl"}(s||(s={}))},2738:(e,t,n)=>{"use strict";n.d(t,{G2:()=>a,pb:()=>u,vb:()=>l,zP:()=>c});var i=n(7425),r=n(4734),o=n(2957),s=n(1240),a=function(){function e(e,t){var n;"string"==typeof e?this.sessionId=e:(n=(0,i.CR)(e,1),this.sessionId=n[0]),this.environment=t,this.logger=this.setUlsLogger(this.sessionId)}return e.prototype.setUlsLogger=function(e){var t=(0,s.fy)(this.environment);return(0,r.L8)({remoteUlsEndpoint:t,sessionId:e})},e}(),c=function(e,t,n,i,r,a){var c,u=(0,s.S$)(n,e),l={application:t.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:e,clientVersion:null!=i?i:"n/a",isSynthetic:a};this.health=o.S.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:u,dimensions:l}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",t.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",n.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(c=null==r?void 0:r.toString())&&void 0!==c?c:"n/a")};function u(e){var t,n=performance.getEntriesByType("navigation"),i=e?null===(t=n[0])||void 0===t?void 0:t.toJSON():n[0].toJSON();return{connectEnd:i.connectEnd,connectStart:i.connectStart,decodedBodySize:i.decodedBodySize,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,domComplete:i.domComplete,domContentLoadedEventEnd:i.domContentLoadedEventEnd,domContentLoadedEventStart:i.domContentLoadedEventStart,domInteractive:i.domInteractive,duration:i.duration,encodedBodySize:i.encodedBodySize,entryType:i.entryType,fetchStart:i.fetchStart,initiatorType:i.initiatorType,loadEventEnd:i.loadEventEnd,loadEventStart:i.loadEventStart,nextHopProtocol:i.nextHopProtocol,redirectCount:i.redirectCount,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,serverTiming:i.serverTiming,startTime:i.startTime,transferSize:i.transferSize,type:i.type,unloadEventEnd:i.unloadEventEnd,unloadEventStart:i.unloadEventStart,workerStart:i.workerStart}}function l(){var e=window.performance.timing,t=window.performance.navigation,n={};return e&&(n.timing={navigationStart:e.navigationStart,redirectStart:e.redirectStart,redirectEnd:e.redirectEnd,fetchStart:e.fetchStart,domainLookupStart:e.domainLookupStart,domainLookupEnd:e.domainLookupEnd,connectStart:e.connectStart,connectEnd:e.connectEnd,secureConnectionStart:e.secureConnectionStart,requestStart:e.requestStart,responseStart:e.responseStart,responseEnd:e.responseEnd,domLoading:e.domLoading,domInteractive:e.domInteractive,domContentLoadedEventStart:e.domContentLoadedEventStart,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domComplete:e.domComplete,loadEventStart:e.loadEventStart,loadEventEnd:e.loadEventEnd}),t&&(n.navigation={type:t.type,redirectCount:t.redirectCount}),n}},5157:(e,t,n)=>{"use strict";var i,r,o,s,a,c;n.d(t,{$c:()=>i,AU:()=>a,DG:()=>s,I$:()=>c,J4:()=>u,c:()=>l,cS:()=>o,yv:()=>r}),function(e){e.DriveId="drive",e.ItemId="item",e.DocUrl="file",e.ContentUri="contenturi",e.Nav="nav"}(i||(i={})),function(e){e.ri="DavUrlFromIds",e.oi="WopiAuthRefresh",e.si="WopiAuthFetch",e.ci="WopiInfoFromUrl"}(r||(r={})),function(e){e.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",e.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",e.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",e.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",e.QosVeto_FilePickerFailed="FilePickerFailed",e.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",e.QosVeto_OwlFrameExperienceFailed="OwlFrameExperienceFailed"}(o||(o={})),function(e){e.QosError_VroomWopiFailure="VroomWopiFailure",e.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",e.QosError_EncounteredJsApiError="EncounteredJsApiError",e.QosError_FailedToLoadDocument="FailedToLoadDocument",e.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",e.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",e.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",e.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",e.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",e.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",e.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",e.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",e.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",e.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",e.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",e.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",e.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",e.QosError_FilePickerBootFailed="FilePickerBootFailed",e.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",e.QosError_SelectedItemNotReturned="SelectedItemNotReturned",e.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",e.QosError_UrlNotProvided="UrlNotProvided",e.QosError_CallbackNotDefined="CallbackNotDefined",e.QosError_OwlFrameCreationFailure="OwlFrameCreationFailure"}(s||(s={})),function(e){e.li="Bootstrapfile_WacDocumentVroomError",e.di="LoadDocument_WacDocumentVroomError",e.hi="WacDocumentBootstrapperLoadError",e.fi="WacInitializeWopiPendingError",e.vi="WacDocumentGenericBootError",e.mi="WacDocumentJsApiV1Error",e.gi="WacDocumentJsApiV2Error"}(a||(a={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(c||(c={}));var u,l={};!function(e){e.New="NEW",e.BackstageMru="BACKSTAGE-MRU",e.Reboot="REBOOT"}(u||(u={}))},2124:(e,t,n)=>{"use strict";n.d(t,{Fh:()=>f,vJ:()=>g,i0:()=>w,dt:()=>m});var i=n(4629),r=n(6266),o=function(){function e(){}return e.toFeatureGateConfig=function(e,t){if(null==e||""===e||"null"===e)return[];try{return function(e,t,n){return u(e,t,a,n)}(JSON.parse(e),l(d("FeatureGateConfig")),t)}catch(n){return null==t||t.ULS.sendTraceTag(521413921,i.W.zn,r.G.Error,'Unable to parse JSON string: "'.concat(e,'", due to expection: ').concat(n)),[]}},e.featureGateConfigToJson=function(e,t){return JSON.stringify(function(e,t,n){return u(e,t,c,n)}(e,l(d("FeatureGateConfig")),t),null,2)},e}();function s(e,t,n,o){if(void 0===o&&(o=""),o?null==n||n.ULS.sendTraceTag(521414033,i.W.zn,r.G.Error,'Invalid value for key "'.concat(o,'". Expected type ').concat(JSON.stringify(e)," but got ").concat(JSON.stringify(t))):null==n||n.ULS.sendTraceTag(521414034,i.W.zn,r.G.Error,"Invalid value ".concat(JSON.stringify(t)," for type ").concat(JSON.stringify(e))),"boolean"==typeof e){if("string"==typeof t){var s=function(e){try{var t=JSON.parse(e.toLowerCase());return"boolean"==typeof t&&t}catch(e){return!1}}(t);if("boolean"==typeof s)return s}return!1}return"string"==typeof e?"":"number"==typeof e?0:typeof e==typeof[]?[]:"Date"===e?new Date:"array"===e?[]:"object"===e?{}:void 0}function a(e){if(void 0===e.jsonToJS){var t={};e.props.forEach((function(e){return t[e.json]={key:e.js,typ:e.typ}})),e.jsonToJS=t}return e.jsonToJS}function c(e){if(void 0===e.jsToJSON){var t={};e.props.forEach((function(e){return t[e.js]={key:e.json,typ:e.typ}})),e.jsToJSON=t}return e.jsToJSON}function u(e,t,n,i,r){void 0===r&&(r="");var o=t;if("any"===o)return e;if(null===o)return null===e?e:s(o,e,i);if(!1===o)return s(o,e,i);for(;"object"==typeof o&&void 0!==o.ref;)o=p[o.ref];return Array.isArray(o)?function(e,t){return-1!==e.indexOf(t)?t:s(e,t,i)}(o,e):"object"==typeof o?o.hasOwnProperty("unionMembers")?function(e,t){for(var r=e.length,o=0;o<r;o++){var a=e[o];try{return u(t,a,n,i)}catch(e){}}return s(e,t,i)}(o.unionMembers,e):o.hasOwnProperty("arrayItems")?function(e,t){return Array.isArray(t)?t.map((function(t){return u(t,e,n,i)})):s("array",t,i)}(o.arrayItems,e):o.hasOwnProperty("props")?function(e,t,r){if(null===r||"object"!=typeof r||Array.isArray(r))return s("object",r,i);var o={};return Object.getOwnPropertyNames(e).forEach((function(t){var s=e[t],a=Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0;o[s.key]=u(a,s.typ,n,i,s.key)})),Object.getOwnPropertyNames(r).forEach((function(s){Object.prototype.hasOwnProperty.call(e,s)||(o[s]=u(r[s],t,n,i,s))})),o}(n(o),o.additional,e):s(o,e,i):o===Date&&"number"!=typeof e?function(e){if(null===e)return null;var t=new Date(e);return isNaN(t.valueOf())?s("Date",e,i):t}(e):function(e,t){return typeof e==typeof t?t:s(e,t,i,r)}(o,e)}function l(e){return{arrayItems:e}}function d(e){return{ref:e}}var h,f,p={FeatureGateConfig:(h=[{json:"ConfigId",js:"ConfigId",typ:""},{json:"IsEnabled",js:"IsEnabled",typ:!0},{json:"SettingsRings",js:"SettingsRings",typ:""}],{props:h,additional:!1})},v=n(1806);function m(e,t,n){null==n||n.ULS.sendTraceTag(521164238,i.W.zn,r.G.Info,"".concat(e,": ").concat(t?"Enabled":"Disabled"))}function g(e,t){if(!t)return!1;if(!t.has(e))return!1;var n=t.get(e);return null!=n&&"boolean"==typeof n&&n}function w(e,t,n){var s,a=[];null==t||t.ULS.sendTraceTag(522299220,i.W.zn,r.G.Verbose,'Attempting to parse Feature Gate Config String: "'.concat(e,'"'));try{a=null!==(s=o.toFeatureGateConfig(e,t))&&void 0!==s?s:[]}catch(n){return null==t||t.ULS.sendTraceTag(524814532,i.W.zn,r.G.Error,'Unable to parse Feature Gate Config string: "'.concat(e,'", due to Exception: ').concat(n)),new Map}null==t||t.ULS.sendTraceTag(522299221,i.W.zn,r.G.Verbose,"Successfully parsed Feature Gate Config String to JSON: ".concat(JSON.stringify(a)));var c=new Map,u=n;return u=u?null==n?void 0:n.toLocaleLowerCase():"",a.forEach((function(e){var t,n=(null!==(t=e.SettingsRings)&&void 0!==t?t:"").replace(/\s+/g,"").toLocaleLowerCase().split(",");u&&n.includes(u)&&c.set(e.ConfigId,e.IsEnabled)})),null==t||t.ULS.sendTraceTag(522299222,i.W.zn,r.G.Info,"Successfully filtered Feature Gate Config JSON: ".concat(JSON.stringify(a),", to ring id: ").concat(u,", with result map: ").concat((0,v.z)(c))),c}!function(e){e.FeatureGate_EcsHootGate="EcsHootGate",e.FeatureGate_VisioJsApiV2Gate="VisioJsApiV2Gate",e.FeatureGate_HideCloseButtonGate="HideCloseButtonGate",e.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",e.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",e.FeatureGate_BlurAndGrabFocusForShareDialogGate="BlurAndGrabFocusForShareDialogGate",e.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",e.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",e.FeatureGate_DisableEUDBBrowserULSRouting="DisableEUDBBrowserULSRouting",e.FeatureGate_DisableEUDBHealthTelemetryRouting="DisableEUDBHealthTelemetryRouting",e.FeatureGate_ESSForXLGate="ESSForXL",e.FeatureGate_iOSNullCheckFeatureGate="iOSNullCheckFeatureGate",e.FeatureGate_Locale1JSGate="Locale1JSGate",e.FeatureGate_BypassOPTIONSCall="BypassOPTIONSCall",e.FeatureGate_EnableOwlFrameExperiment="IsOwlIFrameExperimentEnabled",e.FeatureGate_EnableOwlFrameExperimentTreatment="IsOwlIFrameExperimentTreatment",e.FeatureGate_EnableOwlFrameBoot="IsOwlIFrameBootEnabled",e.FeatureGate_EnableOwlFrameBootTreatment="IsOwlIFrameBootTreatment",e.FeatureGate_Vroom21ForWord="Vroom21ForWord",e.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",e.FeatureGate_ManifestCachingGate="ManifestCachingGate",e.FeatureGate_ManualRedirectOnTenantChangeGate="ManualRedirectOnTenantChangeGate",e.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled="IsOwlWacOAuthExperimentTreatment"}(f||(f={}))},1811:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});var i=n(531);function r(){var e=(0,i.a)();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},1806:(e,t,n)=>{"use strict";n.d(t,{d:()=>o,z:()=>r});var i=n(7425);function r(e){var t,n,r="{ ";try{for(var o=(0,i.XA)(e.entries()),s=o.next();!s.done;s=o.next()){var a=s.value;r+="{ key: ".concat(a[0],", value: ").concat(a[1]," },")}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r.substring(0,r.length-1)+" }"}function o(e){var t,n,r={};try{for(var o=(0,i.XA)(e.entries()),s=o.next();!s.done;s=o.next()){var a=(0,i.CR)(s.value,2),c=a[0],u=a[1];r[String(c)]=u}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return JSON.stringify(r)}},2967:(e,t,n)=>{"use strict";n.d(t,{J:()=>c});var i,r,o,s=n(1240),a=function(e){var t=document.getElementById("unified-ui-host-config"),n=t&&t.textContent;if(n)return JSON.parse(n)}(),c={version:"v1",officeHomeCdnDomain:null!==(i=null==a?void 0:a.officeHomeCdnDomain)&&void 0!==i?i:(0,s.w8)(),genericFeatureGates:null!==(r=null==a?void 0:a.genericFeatureGates)&&void 0!==r?r:null,deploymentEnvironment:null!==(o=null==a?void 0:a.deploymentEnvironment)&&void 0!==o?o:"Not_specified"}},1432:(e,t,n)=>{"use strict";n.d(t,{JK:()=>c,Th:()=>g,VJ:()=>o,XU:()=>a,Y$:()=>v,aE:()=>m,bM:()=>d,gG:()=>p,k$:()=>f,o4:()=>i,pK:()=>s,sj:()=>h});var i,r=n(7425),o=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,s=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,a=/http[s]?:\/\/d\.docs\.live\.net/,c=/https:\/\/[\S]*?graph\.[\S]/,u="https://graph.microsoft.com",l=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function d(e){if(!e)return"";try{return decodeURIComponent(e)}catch(e){return""}}function h(e){return e?e.substring(0,e.lastIndexOf("/")):""}function f(e){if(e&&e.length){var t=e.match(l);if(t)return{href:e,protocol:t[1],host:t[2],hostname:t[3],port:t[4],path:t[5],search:t[6],hash:t[7]}}}function p(e){if(e&&e.length){if(e.match(s)||e.match(a))return"OneDrive";if(e.match(o))return"SharePoint";if(e.startsWith(u))return"Graph"}}function v(e,t,n){var i=e,o="",s=!0;for(var a in t&&(i=(0,r.pi)((0,r.pi)({},t),i)),i){var c,u=i[a];if(!n||"object"!=typeof u&&u||"object"==typeof u&&u&&u.uriValue||"number"==typeof u||"boolean"==typeof u)s?s=!1:o+="&",c="object"==typeof u&&u&&u.uriValue?u.uriValue:encodeURIComponent("".concat(u)),o+="".concat(a,"=").concat(c)}return o}function m(e){if(e&&e.length){if(e.match(s)||e.match(a))return i.OneDrive;if(e.match(o))return i.SharePoint}}function g(e,t){var n=e.toLowerCase(),i=function(e){var t=f(e);return t&&t.hostname||""}(t),r=function(e){var t=e.toLowerCase();return!t||t.startsWith("http:")||t.startsWith("https:")||t.startsWith("mailto:")||t.startsWith("sip:")||t.startsWith("tel:")||t.startsWith("im:")?t:"https://"+t}(i),o=h(t);return 0===n.indexOf("https://")||0===n.indexOf("http://")?n:"/"===n.charAt(0)?"".concat(r).concat(n):"".concat(o,"/").concat(n)}!function(e){e.OneDrive="Documents",e.SharePoint="Sites"}(i||(i={}))},4617:(e,t,n)=>{"use strict";var i,r,o,s;n.d(t,{J7:()=>i,L5:()=>o,hx:()=>r}),function(e){e.CacheOnly="cache-only",e.NetworkFirst="network-first",e.NetworkOnly="network-only"}(i||(i={})),function(e){e.Delete="DELETE",e.Get="GET",e.Head="HEAD",e.Options="OPTIONS",e.Post="POST",e.Put="PUT",e.Patch="PATCH"}(r||(r={})),function(e){e.CorrelationId="X-OfficeHome-CorrelationId",e.Mock="ohp-mock",e.TestTraffic="X-OfficeHome-TestTraffic"}(o||(o={})),function(e){e.Json="json",e.Text="text",e.ArrayBuffer="arraybuffer",e.Blob="blob"}(s||(s={}))},5506:(e,t,n)=>{"use strict";n.d(t,{Ko:()=>p,sm:()=>v});var i=n(7425),r=n(4629),o=n(6266),s=n(5878),a=n.n(s),c=n(2661),u=n(4617),l=3e5,d=-1,h=a().create(),f=function(e,t){return t===u.J7.CacheOnly?Promise.reject("Cache unsupported"):Promise.resolve(e)};function p(e,t,n,s,p,v,y,_,C,S,k){void 0===C&&(C={});var b=_;return S===u.J7.CacheOnly&&(b="None"),function(e,t,n,i,s,a,l,d,h,f,p,v){return new Promise((function(g,y){var _=s||"None",C="None"===_||"OfficeHome"===_&&!n,S=h||new Set;S.add(401);var k=function(e){var t=e.status,n=Number.NaN;!C&&S.has(t)?n=c.W.TokenRefreshFailed:f&&f(t)&&(n=c.W.RetryFailed),n!==Number.NaN&&(null==v||v.ULS.sendTraceTag(509723938,r.W.zn,o.G.Error,"requestWithAuthAndRetry failed with status ".concat(t," and customErrorCode ").concat(n))),y({httpResponse:e})};if(a){var b=w(a);b&&(t.headers||(t.headers={}),t.headers[u.L5.Mock]=b)}(C?Promise.resolve(void 0):i(_,!1,l)).then((function(n){if(!C){if(!n||!n.success){var s=n?n.error:"";return null==v||v.ULS.sendTraceTag(509723937,r.W.zn,o.G.Error,"requestWithAuthAndRetry failed on get token with error ".concat(s)),void y({httpResponse:{data:"CAP_Error"===s?s:null,status:c.W.TokenUnavailable,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}m(t,n,d,p)}e(t).then(g,(function(n){var s,a;!C&&S.has(n.status)?i(_,!0,l).then((function(i){i.success?(m(t,i,d,p),e(t).then(g,k)):k(n)})).catch((function(e){null==v||v.ULS.sendTraceTag(509723936,r.W.zn,o.G.Error,"getAccessToken failed with error ".concat(e))})):f&&f(n.status)?(s=t,setTimeout((function(){e(s).then(g,k)}),(a=[0,11,22,33])[Math.floor(1e3*Math.random())%a.length])):y({httpResponse:n})}))})).catch((function(e){null==v||v.ULS.sendTraceTag(509723935,r.W.zn,o.G.Error,"getAccessToken failed with error ".concat(e))}))}))}((function(e){return function(e,t,n,s,p,v,m,y,_){var C="".concat(t,"/");return e.url.startsWith("http")&&!C.startsWith("http")&&(C="".concat(window.location.origin,"/").concat(C)),0===e.url.lastIndexOf(C,0)&&function(e,t){e.headers||(e.headers={}),e.headers[u.L5.CorrelationId]=t;var n=w("testtraffic");n&&(e.headers[u.L5.TestTraffic]=n)}(e,n),function(e,t,n,s,p,v,m){var w=t===u.J7.CacheOnly,y=function(e,t,n,s,l,p,v){var m=this;return new Promise((function(w,y){return(0,i.mG)(m,void 0,void 0,(function(){var m,_,C,S,k;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(m=n===u.J7.CacheOnly,_={url:e.url,method:e.method,headers:e.headers,params:e.params,data:e.body,timeout:t,responseType:e.responseType,onUploadProgress:s,onDownloadProgress:l},p&&(C=a().CancelToken,S=C.source(),_.cancelToken=S.token,p.onCancel((function(){return S.cancel()})).catch((function(e){null==v||v.ULS.sendTraceTag(509723933,r.W.zn,o.G.Error,"getResponse failed with error ".concat(e))}))),!f)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f(_,n||u.J7.NetworkOnly)];case 2:return i.sent(),[3,4];case 3:return k=i.sent(),y(g(c.W.NotImplemented,m,k)),[2];case 4:return h.request(_).then((function(e){w({data:e.data,status:e.status,headers:e.headers,ok:!0,statusText:e.statusText,fromCache:m})}),(function(e){a().isCancel(e)?y(g(c.W.Cancelled,m)):"ECONNABORTED"===e.code?y(g(c.W.Timeout,m)):e.response?y({data:e.response.data,status:e.response.status,headers:e.response.headers,ok:!1,statusText:e.response.statusText,fromCache:!1}):window.navigator&&"boolean"==typeof window.navigator.onLine&&!window.navigator.onLine?y(g(c.W.Offline,m)):y(g(d,m))})),[2]}}))}))}))}(e,v||l,t,n,s,p,m),_=p?p.onCancel((function(){return Promise.resolve(g(c.W.Cancelled,w))})):new Promise((function(){}));return Promise.race([y,_]).catch((function(e){null==m||m.ULS.sendTraceTag(509723934,r.W.zn,o.G.Error,"requestWithInstrumentation failed with error ".concat(e))})),y}(e,s,p,v,m,y,_)}(e,v,y,S,C.onUploadProgress,C.onDownloadProgress,C.cancellationToken,C.timeoutInMs,k)}),(0,i.pi)((0,i.pi)({},n),{url:e,method:u.hx.Post,body:t}),s,p,b,C.mockParam,C.resourceUrl,C.rpsHeaderPrefix,C.additionalAuthErrors,C.isRetriableError,C.updateRequestWithAuth,k)}function v(e,t,n){var i=t;if(!e||!e.success)return null!=i?i:{};i||(i={});var r="RPSCompact"===e.format?n||"":"Bearer ";return i.Authorization="".concat(r).concat(e.token).trim(),i}function m(e,t,n,i){e&&(e.headers=v(t,e.headers,n),i&&i(e,t))}function g(e,t,n){return{data:void 0,status:e,headers:{},ok:!1,statusText:n&&"string"==typeof n?n:e.toString(),fromCache:t}}function w(e){return new URLSearchParams(window.location.search).get(e)}},559:(e,t,n)=>{"use strict";var i;n.d(t,{T:()=>i}),function(e){e.Excel="Excel",e.None="None",e.OneNote="OneNote",e.PowerPoint="PowerPoint",e.Visio="Visio",e.Word="Word"}(i||(i={}))},531:(e,t,n)=>{"use strict";function i(e){window.performance&&window.performance.mark&&(Array.isArray(e)?e.forEach((function(e){window.performance.mark(e)})):window.performance.mark(e))}function r(){var e,t,n;return(null===(t=null===(e=window.performance)||void 0===e?void 0:e.now)||void 0===t?void 0:t.call(e))+(null===(n=window.performance)||void 0===n?void 0:n.timeOrigin)||Date.now()}n.d(t,{a:()=>r,l:()=>i})},5980:(e,t,n)=>{"use strict";n.d(t,{Is:()=>_,_7:()=>k});var i=n(9930),r=n(5760),o=n(9744),s=n(7593),a=n(3697),c=n(4696);const u={sendGetRequestAsync:()=>Promise.reject(c.l.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface.")),sendPostRequestAsync:()=>Promise.reject(c.l.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))};var l=n(9616);class d{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class h{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{wi:this.generateId(),status:l.$L.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new d}}startPerformanceMeasurement(){return new d}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var f=n(8207),p=n(7237);class v{navigateInternal(e,t){return v.defaultNavigateWindow(e,t)}navigateExternal(e,t){return v.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}var m=n(1416),g=n(913);class w{async sendGetRequestAsync(e,t){let n;try{n=await fetch(e,{method:p.EC.GET,headers:this.getFetchHeaders(t)})}catch(e){throw window.navigator.onLine?(0,m.Z_)(g.C8):(0,m.Z_)(g.Mq)}try{return{headers:this.getHeaderDict(n.headers),body:await n.json(),status:n.status}}catch(e){throw(0,m.Z_)(g.w6)}}async sendPostRequestAsync(e,t){const n=t&&t.body||i.gT.EMPTY_STRING;let r;try{r=await fetch(e,{method:p.EC.POST,headers:this.getFetchHeaders(t),body:n})}catch(e){throw window.navigator.onLine?(0,m.Z_)(g.Dc):(0,m.Z_)(g.Mq)}try{return{headers:this.getHeaderDict(r.headers),body:await r.json(),status:r.status}}catch(e){throw(0,m.Z_)(g.w6)}}getFetchHeaders(e){const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.keys(n).forEach((e=>{t.append(e,n[e])})),t}getHeaderDict(e){const t={};return e.forEach(((e,n)=>{t[n]=e})),t}}const y=6e4,_=6e3,C=3e4,S=2e3;function k({auth:e,cache:t,system:n,telemetry:c},l){const d={clientId:i.gT.EMPTY_STRING,authority:`${i.gT.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:i.gT.EMPTY_STRING,authorityMetadata:i.gT.EMPTY_STRING,redirectUri:i.gT.EMPTY_STRING,postLogoutRedirectUri:i.gT.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:r.A.AAD,OIDCOptions:{serverResponseType:i.rg.FRAGMENT,defaultScopes:[i.gT.OPENID_SCOPE,i.gT.PROFILE_SCOPE,i.gT.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:o.z.None,tenant:i.gT.EMPTY_STRING},skipAuthorityMetadataCache:!1},m={cacheLocation:p.Ix.SessionStorage,temporaryCacheLocation:p.Ix.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!t||t.cacheLocation!==p.Ix.LocalStorage),claimsBasedCachingEnabled:!1},g={loggerCallback:()=>{},logLevel:s.i.Info,piiLoggingEnabled:!1},k={...a.z,loggerOptions:g,networkClient:l?new w:u,navigationClient:new v,loadFrameTimeout:0,windowHashTimeout:n?.loadFrameTimeout||y,iframeHashTimeout:n?.loadFrameTimeout||_,navigateFrameWait:0,redirectNavigationTimeout:C,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:n?.nativeBrokerHandshakeTimeout||S,pollIntervalMilliseconds:p.qx.DEFAULT_POLL_INTERVAL_MS},b={...n,loggerOptions:n?.loggerOptions||g},T={application:{appName:i.gT.EMPTY_STRING,appVersion:i.gT.EMPTY_STRING},client:new h};if(r.A.OIDC,e?.protocolMode&&e.protocolMode!==r.A.AAD&&b?.allowNativeBroker)throw f.r.createCannotAllowNativeBrokerError();return{auth:{...d,...e,OIDCOptions:{...d.OIDCOptions,...e?.OIDCOptions}},cache:{...m,...t},system:{...k,...b},telemetry:{...T,...c}}}},4073:(e,t,n)=>{"use strict";n.r(t),n.d(t,{StandardController:()=>at});var i=n(9616),r=n(4696);class o extends r.l{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,o.prototype)}static createMissingKidError(){return new o("missing_kid_error","The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.")}static createMissingAlgError(){return new o("missing_alg_error","The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided.")}}var s=n(9930);class a{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw o.createMissingKidError();if(!e.alg)throw o.createMissingAlgError();const t=new a({typ:e.typ||s.L.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}function c(e){return encodeURIComponent(l(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function u(e){return d(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function l(e){return d((new TextEncoder).encode(e))}function d(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function h(e){return(new TextDecoder).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}var f=n(1416),p=n(913);class v{constructor(e){this.cryptoObj=e}async generateCodes(){const e=this.generateCodeVerifier();return{verifier:e,challenge:await this.generateCodeChallengeFromVerifier(e)}}generateCodeVerifier(){try{const e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),u(e)}catch(e){throw(0,f.Z_)(p.vD)}}async generateCodeChallengeFromVerifier(e){try{const t=await this.cryptoObj.sha256Digest(e);return u(new Uint8Array(t))}catch(e){throw(0,f.Z_)(p.vD)}}}class m{static stringToUtf8Arr(e){let t,n=0;const i=e.length;for(let r=0;r<i;r++)t=e.charCodeAt(r),n+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;const r=new Uint8Array(n);for(let i=0,o=0;i<n;o++)t=e.charCodeAt(o),t<128?r[i++]=t:t<2048?(r[i++]=192+(t>>>6),r[i++]=128+(63&t)):t<65536?(r[i++]=224+(t>>>12),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t)):t<2097152?(r[i++]=240+(t>>>18),r[i++]=128+(t>>>12&63),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t)):t<67108864?(r[i++]=248+(t>>>24),r[i++]=128+(t>>>18&63),r[i++]=128+(t>>>12&63),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t)):(r[i++]=252+(t>>>30),r[i++]=128+(t>>>24&63),r[i++]=128+(t>>>18&63),r[i++]=128+(t>>>12&63),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t));return r}static utf8ArrToString(e){let t=s.gT.EMPTY_STRING;for(let n,i=e.length,r=0;r<i;r++)n=e[r],t+=String.fromCharCode(n>251&&n<254&&r+5<i?1073741824*(n-252)+(e[++r]-128<<24)+(e[++r]-128<<18)+(e[++r]-128<<12)+(e[++r]-128<<6)+e[++r]-128:n>247&&n<252&&r+4<i?(n-248<<24)+(e[++r]-128<<18)+(e[++r]-128<<12)+(e[++r]-128<<6)+e[++r]-128:n>239&&n<248&&r+3<i?(n-240<<18)+(e[++r]-128<<12)+(e[++r]-128<<6)+e[++r]-128:n>223&&n<240&&r+2<i?(n-224<<12)+(e[++r]-128<<6)+e[++r]-128:n>191&&n<224&&r+1<i?(n-192<<6)+e[++r]-128:n);return t}static getSortedObjectString(e){return JSON.stringify(e,Object.keys(e).sort())}}var g=n(7237);class w{getRandomValues(e){return window.crypto.getRandomValues(e)}async generateKey(e,t,n){return window.crypto.subtle.generateKey(e,t,n)}async exportKey(e){return window.crypto.subtle.exportKey(g.Mm,e)}async importKey(e,t,n,i){return window.crypto.subtle.importKey(g.Mm,e,t,n,i)}async sign(e,t,n){return window.crypto.subtle.sign(e,t,n)}async digest(e,t){return window.crypto.subtle.digest(e,t)}}const y="SHA-256",_=new Uint8Array([1,0,1]);class C{constructor(e){if(this.logger=e,!this.hasBrowserCrypto())throw this.logger.error("BrowserCrypto: crypto interface is unavailable"),(0,f.Z_)(p.TR);this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new w,this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:y,modulusLength:2048,publicExponent:_}}hasBrowserCrypto(){return"crypto"in window}async sha256Digest(e){const t=m.stringToUtf8Arr(e);return this.subtleCrypto.digest({name:y},t)}getRandomValues(e){return this.subtleCrypto.getRandomValues(e)}async generateKeyPair(e,t){return this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)}async exportJwk(e){return this.subtleCrypto.exportKey(e)}async importJwk(e,t,n){return this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,n)}async sign(e,t){return this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)}}class S{constructor(){this.dbName=g.H4,this.version=g.kd,this.tableName=g.Gv,this.dbOpen=!1}async open(){return new Promise(((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),n.addEventListener("success",(t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()})),n.addEventListener("error",(()=>t((0,f.Z_)(p.Pi))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return await this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise(((t,n)=>{if(!this.db)return n((0,f.Z_)(p.IL));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);i.addEventListener("success",(e=>{const n=e;this.closeConnection(),t(n.target.result)})),i.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Promise(((n,i)=>{if(!this.db)return i((0,f.Z_)(p.IL));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);r.addEventListener("success",(()=>{this.closeConnection(),n()})),r.addEventListener("error",(e=>{this.closeConnection(),i(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Promise(((t,n)=>{if(!this.db)return n((0,f.Z_)(p.IL));const i=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);i.addEventListener("success",(()=>{this.closeConnection(),t()})),i.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((e,t)=>{if(!this.db)return t((0,f.Z_)(p.IL));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",(t=>{const n=t;this.closeConnection(),e(n.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Promise(((t,n)=>{if(!this.db)return n((0,f.Z_)(p.IL));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);i.addEventListener("success",(e=>{const n=e;this.closeConnection(),t(1===n.target.result)})),i.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((e,t)=>{const n=window.indexedDB.deleteDatabase(g.H4);n.addEventListener("success",(()=>e(!0))),n.addEventListener("blocked",(()=>e(!0))),n.addEventListener("error",(()=>t(!1)))}))}}class k{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,n)=>{e.push(n)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class b{constructor(e,t){this.inMemoryCache=new k,this.indexedDBCache=new S,this.logger=e,this.storeName=t}handleDatabaseAccessError(e){if(!(e instanceof f.Ut&&e.errorCode===p.Pi))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose(`Deleting in-memory keystore ${this.storeName}`),this.inMemoryCache.clear(),this.logger.verbose(`In-memory keystore ${this.storeName} deleted`)}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class T{constructor(e){this.logger=e,this.asymmetricKeys=new b(this.logger,"asymmetricKeys"),this.symmetricKeys=new b(this.logger,"symmetricKeys")}async clear(){this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory();try{return await this.asymmetricKeys.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}}class A{constructor(e,t){this.logger=e,this.browserCrypto=new C(this.logger),this.pkceGenerator=new v(this.browserCrypto),this.cache=new T(this.logger),this.performanceClient=t}createNewGuid(){return window.crypto.randomUUID()}base64Encode(e){return l(e)}base64Decode(e){return h(e)}async generatePkceCodes(){return this.pkceGenerator.generateCodes()}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(i.Ak.CryptoOptsGetPublicKeyThumbprint,e.correlationId),n=await this.browserCrypto.generateKeyPair(A.EXTRACTABLE,A.POP_KEY_USAGES),r=await this.browserCrypto.exportJwk(n.publicKey),o={e:r.e,kty:r.kty,n:r.n},s=m.getSortedObjectString(o),a=await this.hashString(s),c=await this.browserCrypto.exportJwk(n.privateKey),u=await this.browserCrypto.importJwk(c,!1,["sign"]);return await this.cache.asymmetricKeys.setItem(a,{privateKey:u,publicKey:n.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.asymmetricKeys.removeItem(e),!await this.cache.asymmetricKeys.containsKey(e)}async clearKeystore(){return await this.cache.clear()}async signJwt(e,t,n){const r=this.performanceClient?.startMeasurement(i.Ak.CryptoOptsSignJwt,n),o=await this.cache.asymmetricKeys.getItem(t);if(!o)throw(0,f.Z_)(p.XM);const s=await this.browserCrypto.exportJwk(o.publicKey),l=m.getSortedObjectString(s),d=c(JSON.stringify({kid:t})),h=c(a.getShrHeaderString({kid:d,alg:s.alg}));e.cnf={jwk:JSON.parse(l)};const v=`${h}.${c(JSON.stringify(e))}`,g=m.stringToUtf8Arr(v),w=await this.browserCrypto.sign(o.privateKey,g),y=`${v}.${u(new Uint8Array(w))}`;return r&&r.end({success:!0}),y}async hashString(e){const t=await this.browserCrypto.sha256Digest(e);return u(new Uint8Array(t))}}A.POP_KEY_USAGES=["sign","verify"],A.EXTRACTABLE=!0;var I=n(669);const E=(e,t,n,i,r)=>(...o)=>{n.trace(`Executing function ${t}`);const s=i?.startMeasurement(t,r);return i?.setPreQueueTime(t,r),e(...o).then((e=>(n.trace(`Returning result from ${t}`),s?.end({success:!0}),e))).catch((e=>{n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw s?.end({success:!1}),e}))};var R=n(8207),N=n(5536),P=n(5153);class H{get urlString(){return this.yi}constructor(e){if(this.yi=e,!this.yi)throw R.r.createUrlEmptyError();this.getHash()||(this.yi=H.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return P.x.endsWith(t,"?")?t=t.slice(0,-1):P.x.endsWith(t,"?/")&&(t=t.slice(0,-2)),P.x.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw R.r.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw R.r.createUrlParseError(`Given url string: ${this.urlString}`);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw R.r.createInsecureAuthorityUriError(this.urlString)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return H.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==s.Nb.COMMON&&n[0]!==s.Nb.ORGANIZATIONS||(n[0]=e),H.constructAuthorityUriFromObject(t)}getHash(){return H.parseHash(this.urlString)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw R.r.createUrlParseError(`Given url string: ${this.urlString}`);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let i=n.AbsolutePath.split("/");return i=i.filter((e=>e&&e.length>0)),n.PathSegments=i,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw R.r.createUrlParseError(`Given url string: ${e}`);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===s.gT.FORWARD_SLASH){const n=new H(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static parseHash(e){const t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):s.gT.EMPTY_STRING}static parseQueryString(e){const t=e.indexOf("?"),n=e.indexOf("/?");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):s.gT.EMPTY_STRING}static parseQueryServerResponse(e){const t=e.indexOf("?code"),n=e.indexOf("/?code"),i=e.indexOf("#");return n>-1&&i>-1?e.substring(n+2,i):n>-1?e.substring(n+2):t>-1&&i>-1?e.substring(t+1,i):t>-1?e.substring(t+1):s.gT.EMPTY_STRING}static constructAuthorityUriFromObject(e){return new H(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static getDeserializedHash(e){if(!e)return{};const t=H.parseHash(e),n=P.x.queryStringToObject(t||e);if(!n)throw N.e.createHashNotDeserializedError(JSON.stringify(n));return n}static getDeserializedQueryString(e){if(!e)return{};const t=H.parseQueryString(e),n=P.x.queryStringToObject(t||e);if(!n)throw N.e.createHashNotDeserializedError(JSON.stringify(n));return n}static getDeserializedCodeResponse(e,t){const n=new H(t);let i;return i=e===s.rg.QUERY?H.getDeserializedQueryString(t):H.getDeserializedHash(n.getHash()),i}static hashContainsKnownProperties(e){if(!e||e.indexOf("=")<0)return!1;const t=H.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)}}var O=n(9920),U=n(6919);class M extends r.l{constructor(e,t,n){super(e,t,n),this.name="ServerError",Object.setPrototypeOf(this,M.prototype)}}var D=n(8939);class F{generateAccountId(){return F.generateAccountIdForCacheKey(this.homeAccountId,this.environment)}generateCredentialId(){return F.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)}generateTarget(){return F.generateTargetForCacheKey(this.target)}generateCredentialKey(){return F.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)}generateType(){switch(this.credentialType){case s.d3.ID_TOKEN:return s.LL.ID_TOKEN;case s.d3.ACCESS_TOKEN:case s.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:return s.LL.ACCESS_TOKEN;case s.d3.REFRESH_TOKEN:return s.LL.REFRESH_TOKEN;default:throw N.e.createUnexpectedCredentialTypeError()}}static generateCredentialCacheKey(e,t,n,i,r,o,a,c,u){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(n,i,r,a),this.generateTargetForCacheKey(o),this.generateClaimsHashForCacheKey(u),this.generateSchemeForCacheKey(c)].join(s.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static generateAccountIdForCacheKey(e,t){return[e,t].join(s.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static generateCredentialIdForCacheKey(e,t,n,i){return[e,e===s.d3.REFRESH_TOKEN&&i||t,n||s.gT.EMPTY_STRING].join(s.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static generateTargetForCacheKey(e){return(e||s.gT.EMPTY_STRING).toLowerCase()}static generateClaimsHashForCacheKey(e){return(e||s.gT.EMPTY_STRING).toLowerCase()}static generateSchemeForCacheKey(e){return e&&e.toLowerCase()!==s.hO.BEARER.toLowerCase()?e.toLowerCase():s.gT.EMPTY_STRING}}class x extends F{static createIdTokenEntity(e,t,n,i,r){const o=new x;return o.credentialType=s.d3.ID_TOKEN,o.homeAccountId=e,o.environment=t,o.clientId=i,o.secret=n,o.realm=r,o}static isIdTokenEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===s.d3.ID_TOKEN}}class q{static nowSeconds(){return Math.round((new Date).getTime()/1e3)}static isTokenExpired(e,t){const n=Number(e)||0;return q.nowSeconds()+t>n}static wasClockTurnedBack(e){return Number(e)>q.nowSeconds()}static delay(e,t){return new Promise((n=>setTimeout((()=>n(t)),e)))}}var B=n(9362);class L extends F{static createAccessTokenEntity(e,t,n,i,r,o,a,c,u,l,d,h,f,p,v){const m=new L;m.homeAccountId=e,m.credentialType=s.d3.ACCESS_TOKEN,m.secret=n;const g=q.nowSeconds();if(m.cachedAt=g.toString(),m.expiresOn=a.toString(),m.extendedExpiresOn=c.toString(),l&&(m.refreshOn=l.toString()),m.environment=t,m.clientId=i,m.realm=r,m.target=o,m.userAssertionHash=h,m.tokenType=d||s.hO.BEARER,p&&(m.requestedClaims=p,m.requestedClaimsHash=v),m.tokenType?.toLowerCase()!==s.hO.BEARER.toLowerCase())switch(m.credentialType=s.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case s.hO.POP:const e=(0,B.Z_)(n,u.base64Decode);if(!e?.cnf?.kid)throw N.e.createTokenClaimsRequiredError();m.keyId=e.cnf.kid;break;case s.hO.SSH:m.keyId=f}return m}static isAccessTokenEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===s.d3.ACCESS_TOKEN||e.credentialType===s.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME)}}class W extends F{static createRefreshTokenEntity(e,t,n,i,r,o){const a=new W;return a.clientId=i,a.credentialType=s.d3.REFRESH_TOKEN,a.environment=t,a.homeAccountId=e,a.secret=n,a.userAssertionHash=o,r&&(a.familyId=r),a}static isRefreshTokenEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===s.d3.REFRESH_TOKEN}}class j{generateAppMetadataKey(){return j.generateAppMetadataCacheKey(this.environment,this.clientId)}static generateAppMetadataCacheKey(e,t){return[s.dg,e,t].join(s.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAppMetadataEntity(e,t,n){const i=new j;return i.clientId=e,i.environment=t,n&&(i.familyId=n),i}static isAppMetadataEntity(e,t){return!!t&&0===e.indexOf(s.dg)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")}}class K{constructor(){this.failedRequests=[],this.errors=[],this.cacheHits=0}static isServerTelemetryEntity(e,t){const n=0===e.indexOf(s.HN.CACHE_KEY);let i=!0;return t&&(i=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&i}}class G{constructor(){this.expiresAt=q.nowSeconds()+s.QU.REFRESH_TIME_SECONDS}updateCloudDiscoveryMetadata(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t}updateEndpointMetadata(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri}updateCanonicalAuthority(e){this.canonical_authority=e}resetExpiresAt(){this.expiresAt=q.nowSeconds()+s.QU.REFRESH_TIME_SECONDS}isExpired(){return this.expiresAt<=q.nowSeconds()}static isAuthorityMetadataEntity(e,t){return!!t&&0===e.indexOf(s.QU.CACHE_KEY)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}}class ${static isThrottlingEntity(e,t){let n=!1;e&&(n=0===e.indexOf(s.bb.THROTTLING_PREFIX));let i=!0;return t&&(i=t.hasOwnProperty("throttleTime")),n&&i}}class z{static setRequestState(e,t,n){const i=z.generateLibraryState(e,n);return t?`${i}${s.gT.RESOURCE_DELIM}${t}`:i}static generateLibraryState(e,t){if(!e)throw N.e.createNoCryptoObjectError("generateLibraryState");const n={id:e.createNewGuid()};t&&(n.meta=t);const i=JSON.stringify(n);return e.base64Encode(i)}static parseRequestState(e,t){if(!e)throw N.e.createNoCryptoObjectError("parseRequestState");if(!t)throw N.e.createInvalidStateError(t,"Null, undefined or empty state");try{const n=t.split(s.gT.RESOURCE_DELIM),i=n[0],r=n.length>1?n.slice(1).join(s.gT.RESOURCE_DELIM):s.gT.EMPTY_STRING,o=e.base64Decode(i),a=JSON.parse(o);return{userRequestState:r||s.gT.EMPTY_STRING,libraryState:a}}catch(e){throw N.e.createInvalidStateError(t,e)}}}const J="home_account_id",V="UPN";class Q{constructor(e,t,n,i,r){this.account=e||null,this.idToken=t||null,this.accessToken=n||null,this.refreshToken=i||null,this.appMetadata=r||null}}class X extends r.l{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,X.prototype)}static createRedirectUriEmptyError(){return new X("redirect_uri_empty","A redirect URI is required for all calls, and none has been set.")}static createPostLogoutRedirectUriEmptyError(){return new X("post_logout_uri_empty","A post logout redirect has not been set.")}static createStorageNotSupportedError(e){return new X("storage_not_supported",`Given storage configuration option was not supported. Given Location: ${e}`)}static createRedirectCallbacksNotSetError(){return new X("no_redirect_callbacks","No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")}static createStubPcaInstanceCalledError(){return new X("stubbed_public_client_application_called","Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors")}static createInMemoryRedirectUnavailableError(){return new X("in_mem_redirect_unavailable","Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true.")}static createEntropyNotProvided(){return new X("entropy_not_provided","The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option.")}}class Y{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==g.Ix.LocalStorage&&e!==g.Ix.SessionStorage)throw X.createStorageNotSupportedError(e);if(!window[e])throw X.createStorageNotSupportedError(e)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}class Z{static extractBrowserRequestState(e,t){if(!t)return null;try{return z.parseRequestState(e,t).libraryState.meta}catch(e){throw N.e.createInvalidStateError(t,e)}}static parseServerResponseFromHash(e){if(!e)return{};const t=new H(e);return H.getDeserializedHash(t.getHash())}}class ee extends D.L{constructor(e,t,n,i){super(e,n,i),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=t,this.logger=i,this.internalStorage=new k,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps())}setupBrowserStorage(e){switch(e){case g.Ix.LocalStorage:case g.Ix.SessionStorage:try{return new Y(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=g.Ix.MemoryStorage,new k}setupTemporaryCacheStorage(e,t){switch(t){case g.Ix.LocalStorage:case g.Ix.SessionStorage:try{return new Y(e||g.Ix.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case g.Ix.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){const e=`${s.gT.CACHE_PREFIX}.${s.Vi.ID_TOKEN}`,t=`${s.gT.CACHE_PREFIX}.${s.Vi.CLIENT_INFO}`,n=`${s.gT.CACHE_PREFIX}.${s.Vi.ERROR}`,i=`${s.gT.CACHE_PREFIX}.${s.Vi.ERROR_DESC}`,r=[this.browserStorage.getItem(e),this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(i)];[s.Vi.ID_TOKEN,s.Vi.CLIENT_INFO,s.Vi.ERROR,s.Vi.ERROR_DESC].forEach(((e,t)=>this.migrateCacheEntry(e,r[t])))}migrateCacheEntry(e,t){t&&this.setTemporaryCache(e,t,!0)}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(g.Oq.ACCOUNT_KEYS),t=this.getItem(`${g.Oq.TOKEN_KEYS}.${this.clientId}`);e&&t?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((e=>{if(this.isCredentialKey(e)){const t=this.getItem(e);if(t){const n=this.validateAndParseJson(t);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case s.d3.ID_TOKEN:if(x.isIdTokenEntity(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${e} found, saving key to token key map`);const t=D.L.toObject(new x,n),i=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(i,s.d3.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${e}`);break;case s.d3.ACCESS_TOKEN:case s.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(L.isAccessTokenEntity(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${e} found, saving key to token key map`);const t=D.L.toObject(new L,n),i=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(i,s.d3.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${e}`);break;case s.d3.REFRESH_TOKEN:if(W.isRefreshTokenEntity(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${e} found, saving key to token key map`);const t=D.L.toObject(new W,n),i=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(i,s.d3.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${e}`)}}}if(this.isAccountKey(e)){const t=this.getItem(e);if(t){const n=this.validateAndParseJson(t);n&&U.r.isAccountEntity(n)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${e} found, saving key to account key map`),this.addAccountKeyToMap(e))}}}))}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const n=this.validateAndParseJson(t);return n&&U.r.isAccountEntity(n)?D.L.toObject(new U.r,n):(this.removeAccountKeyFromMap(e),null)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(g.Oq.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(g.Oq.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(g.Oq.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,s.d3.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,s.d3.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,s.d3.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${g.Oq.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const n=this.getTokenKeys();switch(t){case s.d3.ID_TOKEN:-1===n.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case s.d3.ACCESS_TOKEN:-1===n.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case s.d3.REFRESH_TOKEN:-1===n.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),N.e.createUnexpectedCredentialTypeError()}this.setItem(`${g.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const n=this.getTokenKeys();switch(t){case s.d3.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const i=n.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case s.d3.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const r=n.accessToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case s.d3.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const o=n.refreshToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),N.e.createUnexpectedCredentialTypeError()}this.setItem(`${g.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,s.d3.ID_TOKEN),null;const n=this.validateAndParseJson(t);return n&&x.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),D.L.toObject(new x,n)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,s.d3.ID_TOKEN),null)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,s.d3.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,s.d3.ACCESS_TOKEN),null;const n=this.validateAndParseJson(t);return n&&L.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),D.L.toObject(new L,n)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,s.d3.ACCESS_TOKEN),null)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,s.d3.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,s.d3.REFRESH_TOKEN),null;const n=this.validateAndParseJson(t);return n&&W.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),D.L.toObject(new W,n)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,s.d3.REFRESH_TOKEN),null)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,s.d3.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&j.isAppMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),D.L.toObject(new j,n)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&K.isServerTelemetryEntity(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),D.L.toObject(new K,n)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&G.isAuthorityMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),D.L.toObject(new G,n)):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(g.Bs.WRAPPER_SKU,e),this.internalStorage.setItem(g.Bs.WRAPPER_VER,t)}getWrapperMetadata(){return[this.internalStorage.getItem(g.Bs.WRAPPER_SKU)||s.gT.EMPTY_STRING,this.internalStorage.getItem(g.Bs.WRAPPER_VER)||s.gT.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(s.Vi.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const e=this.generateCacheKey(s.Vi.ACTIVE_ACCOUNT),t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const n=this.getAccountInfoByFilter({localAccountId:t})[0]||null;return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(n),n):null}const n=this.validateAndParseJson(t);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(s.Vi.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(s.Vi.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(i)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)}getAccountInfoByFilter(e){const t=this.getAllAccounts();return this.logger.trace(`BrowserCacheManager.getAccountInfoByFilter: total ${t.length} accounts found`),t.filter((t=>!(e.username&&e.username.toLowerCase()!==t.username.toLowerCase()||e.homeAccountId&&e.homeAccountId!==t.homeAccountId||e.localAccountId&&e.localAccountId!==t.localAccountId||e.tenantId&&e.tenantId!==t.tenantId||e.environment&&e.environment!==t.environment)))}getAccountInfoByHints(e,t){const n=this.getAllAccounts().filter((n=>{if(t){const e=n.idTokenClaims&&n.idTokenClaims.sid;return t===e}return!!e&&e===n.username}));if(1===n.length)return n[0];if(n.length>1)throw N.e.createMultipleMatchingAccountsInCacheError();return null}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&$.isThrottlingEntity(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),D.L.toObject(new $,n)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.getItemCookie(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const i=this.temporaryCacheStorage.getItem(n);if(!i){if(this.cacheConfig.cacheLocation===g.Ix.LocalStorage){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i}setTemporaryCache(e,t,n){const i=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(i,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,t))}removeItem(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}containsKey(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)}getKeys(){return[...this.browserStorage.getKeys(),...this.temporaryCacheStorage.getKeys()]}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((e=>{!this.browserStorage.containsKey(e)&&!this.temporaryCacheStorage.containsKey(e)||-1===e.indexOf(s.gT.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(){const e=this.getTokenKeys(),t=[];e.accessToken.forEach((e=>{const n=this.getAccessTokenCredential(e);n?.requestedClaimsHash&&e.includes(n.requestedClaimsHash.toLowerCase())&&t.push(this.removeAccessToken(e))})),await Promise.all(t),t.length>0&&this.logger.warning(`${t.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(e,t,n){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;n&&(i+=`expires=${this.getCookieExpirationTime(n)};`),this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i}getItemCookie(e){const t=`${encodeURIComponent(e)}=`,n=document.cookie.split(";");for(let e=0;e<n.length;e++){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return s.gT.EMPTY_STRING}clearMsalCookies(){const e=`${s.gT.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach((t=>{for(;" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(e)){const e=t.split("=")[0];this.clearItemCookie(e)}}))}clearItemCookie(e){this.setItemCookie(e,s.gT.EMPTY_STRING,-1)}getCookieExpirationTime(e){const t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}getCache(){return this.browserStorage}setCache(){}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):P.x.startsWith(e,s.gT.CACHE_PREFIX)||P.x.startsWith(e,s.Vi.ADAL_ID_TOKEN)?e:`${s.gT.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=z.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${g.c4.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=z.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${g.c4.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=z.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${g.c4.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;const i=this.generateAuthorityKey(n);return this.getTemporaryCache(i)}updateCacheEntries(e,t,n,i,r){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const o=this.generateStateKey(e);this.setTemporaryCache(o,e,!1);const s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);const a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,n,!1),r){const e={credential:r.homeAccountId,type:J};this.setTemporaryCache(g.c4.CCS_CREDENTIAL,JSON.stringify(e),!0)}else if(i){const e={credential:i,type:V};this.setTemporaryCache(g.c4.CCS_CREDENTIAL,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.getKeys().forEach((t=>{-1!==t.indexOf(e)&&this.removeItem(t)})),this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(g.c4.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(g.c4.ORIGIN_URI)),this.removeItem(this.generateCacheKey(g.c4.URL_HASH)),this.removeItem(this.generateCacheKey(g.c4.CORRELATION_ID)),this.removeItem(this.generateCacheKey(g.c4.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(g.c4.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||s.gT.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((t=>{if(-1===t.indexOf(g.c4.REQUEST_STATE))return;const n=this.temporaryCacheStorage.getItem(t);if(!n)return;const i=Z.extractBrowserRequestState(this.cryptoImpl,n);i&&i.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))})),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=l(JSON.stringify(e));this.setTemporaryCache(g.c4.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(g.c4.REQUEST_PARAMS,!0);if(!t)throw(0,f.Z_)(p.QO);let n;try{n=JSON.parse(h(t))}catch(e){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${e}`),(0,f.Z_)(p.e$)}if(this.removeItem(this.generateCacheKey(g.c4.REQUEST_PARAMS)),!n.authority){const t=this.generateAuthorityKey(e),i=this.getTemporaryCache(t);if(!i)throw(0,f.Z_)(p.dT);n.authority=i}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(g.c4.NATIVE_REQUEST,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${s.gT.CACHE_PREFIX}.${g.c4.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${s.gT.CACHE_PREFIX}.${g.c4.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw(0,f.Z_)(p.Ck);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(s.Vi.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(s.Vi.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(s.Vi.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(s.Vi.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=t||e;if(n){const e=B.Z_(n,h);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const n=t.generateCredentialKey();if(e!==n){const i=this.getItem(e);if(i)return this.removeItem(e),this.setItem(n,i),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}getRedirectRequestContext(){return this.getTemporaryCache(g.c4.REDIRECT_CONTEXT,!0)}setRedirectRequestContext(e){this.setTemporaryCache(g.c4.REDIRECT_CONTEXT,e,!0)}async hydrateCache(e,t){const n=x.createIdTokenEntity(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let i;t.claims&&(i=await this.cryptoImpl.hashString(t.claims));const r=L.createAccessTokenEntity(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?.getTime()||0,e.extExpiresOn?.getTime()||0,this.cryptoImpl,void 0,e.tokenType,void 0,t.sshKid,t.claims,i),o=new Q(void 0,n,r);return this.saveCacheRecord(o)}}class te{static clearHash(e){e.location.hash=s.gT.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,s.gT.EMPTY_STRING,`${e.location.origin}${e.location.pathname}${e.location.search}`)}static replaceHash(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):s.gT.EMPTY_STRING}static isInIframe(){return window.parent!==window}static isInPopup(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${g.qx.POPUP_NAME_PREFIX}.`)}static getCurrentUri(){return window.location.href.split("?")[0].split("#")[0]}static getHomepage(){const e=new H(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}static blockReloadInHiddenIframes(){if(H.hashContainsKnownProperties(window.location.hash)&&te.isInIframe())throw(0,f.Z_)(p.xO)}static blockRedirectInIframe(e,t){const n=te.isInIframe();if(e===g.s_.Redirect&&n&&!t)throw(0,f.Z_)(p.b_)}static blockAcquireTokenInPopups(){if(te.isInPopup())throw(0,f.Z_)(p.bj)}static blockNonBrowserEnvironment(e){if(!e)throw(0,f.Z_)(p.Dx)}static blockAPICallsBeforeInitialize(e){if(!e)throw(0,f.Z_)(p.al)}}const ne="msal:loginStart",ie="msal:loginSuccess",re="msal:loginFailure",oe="msal:acquireTokenStart",se="msal:acquireTokenSuccess",ae="msal:acquireTokenFailure",ce="msal:acquireTokenByCodeFailure",ue="msal:handleRedirectEnd",le="msal:popupOpened",de="msal:logoutStart",he="msal:logoutSuccess",fe="msal:logoutFailure",pe="msal:logoutEnd";class ve{constructor(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if("undefined"!=typeof window){const t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose(`Event callback registered with id: ${t}`),t}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}enableAccountStorageEvents(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,t,n,i){if("undefined"!=typeof window){const r={eventType:e,interactionType:t||null,payload:n||null,error:i||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${e}`),this.eventCallbacks.forEach(((t,n)=>{this.logger.verbose(`Emitting event to callback ${n}: ${e}`),t.apply(null,[r])}))}}handleAccountCacheChange(e){try{const t=e.newValue||e.oldValue;if(!t)return;const n=JSON.parse(t);if("object"!=typeof n||!U.r.isAccountEntity(n))return;const i=D.L.toObject(new U.r,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent("msal:accountAdded",void 0,i)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent("msal:accountRemoved",void 0,i))}catch(e){return}}}class me{static generateThrottlingStorageKey(e){return`${s.bb.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){const n=me.generateThrottlingStorageKey(t),i=e.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now())return void e.removeItem(n);throw new M(i.errorCodes?.join(" ")||s.gT.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n){if(me.checkResponseStatus(n)||me.checkResponseForRetryAfter(n)){const i={throttleTime:me.calculateThrottleTime(parseInt(n.headers[s.SZ.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(me.generateThrottlingStorageKey(t),i)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(s.SZ.RETRY_AFTER)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||s.bb.DEFAULT_THROTTLE_TIME_SECONDS),n+s.bb.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,n,i){const r={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:i,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},o=this.generateThrottlingStorageKey(r);e.removeItem(o)}}var ge=n(5760),we=n(3697);class ye{constructor(e,t){this.networkClient=e,this.cacheManager=t}async sendPostRequest(e,t,n){let i;me.preProcess(this.cacheManager,e);try{i=await this.networkClient.sendPostRequestAsync(t,n)}catch(e){throw e instanceof r.l?e:N.e.createNetworkError(t,e)}return me.postProcess(this.cacheManager,e,i),i}}var _e=n(7593),Ce=n(7678),Se=n(5263),ke=n(2480);class be{static validateRedirectUri(e){if(!e)throw R.r.createRedirectUriEmptyError()}static validatePrompt(e){const t=[];for(const e in s.NJ)t.push(s.NJ[e]);if(t.indexOf(e)<0)throw R.r.createInvalidPromptError(e)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw R.r.createInvalidClaimsRequestError()}}static validateCodeChallengeParams(e,t){if(!e||!t)throw R.r.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([s.VX.PLAIN,s.VX.S256].indexOf(e)<0)throw R.r.createInvalidCodeChallengeMethodError()}static sanitizeEQParams(e,t){return e?(t.forEach(((t,n)=>{e[n]&&delete e[n]})),Object.fromEntries(Object.entries(e).filter((e=>""!==e[1])))):{}}}class Te{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(s.Fo.RESPONSE_TYPE,encodeURIComponent(s.gT.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(s.Fo.RESPONSE_TYPE,encodeURIComponent(`${s.gT.TOKEN_RESPONSE_TYPE} ${s.gT.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(s.Fo.RESPONSE_MODE,encodeURIComponent(e||s.vw.QUERY))}addNativeBroker(){this.parameters.set(s.Fo.NATIVE_BROKER,encodeURIComponent("1"))}addScopes(e,t=!0,n=s.f_){!t||n.includes("openid")||e.includes("openid")||n.push("openid");const i=t?[...e||[],...n]:e||[],r=new ke.i(i);this.parameters.set(s.Fo.SCOPE,encodeURIComponent(r.printScopes()))}addClientId(e){this.parameters.set(s.Fo.CLIENT_ID,encodeURIComponent(e))}addRedirectUri(e){be.validateRedirectUri(e),this.parameters.set(s.Fo.REDIRECT_URI,encodeURIComponent(e))}addPostLogoutRedirectUri(e){be.validateRedirectUri(e),this.parameters.set(s.Fo.POST_LOGOUT_URI,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(s.Fo.ID_TOKEN_HINT,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(s.VO.DOMAIN_HINT,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(s.VO.LOGIN_HINT,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(s.SZ.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(s.SZ.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(s.VO.SID,encodeURIComponent(e))}addClaims(e,t){const n=this.addClientCapabilitiesToClaims(e,t);be.validateClaims(n),this.parameters.set(s.Fo.CLAIMS,encodeURIComponent(n))}addCorrelationId(e){this.parameters.set(s.Fo.CLIENT_REQUEST_ID,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(s.Fo.X_CLIENT_SKU,e.sku),this.parameters.set(s.Fo.X_CLIENT_VER,e.version),e.os&&this.parameters.set(s.Fo.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(s.Fo.X_CLIENT_CPU,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(s.Fo.X_APP_NAME,e.appName),e?.appVersion&&this.parameters.set(s.Fo.X_APP_VER,e.appVersion)}addPrompt(e){be.validatePrompt(e),this.parameters.set(`${s.Fo.PROMPT}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(s.Fo.STATE,encodeURIComponent(e))}addNonce(e){this.parameters.set(s.Fo.NONCE,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(be.validateCodeChallengeParams(e,t),!e||!t)throw R.r.createInvalidCodeChallengeParamsError();this.parameters.set(s.Fo.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(s.Fo.CODE_CHALLENGE_METHOD,encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set(s.Fo.CODE,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(s.Fo.DEVICE_CODE,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(s.Fo.REFRESH_TOKEN,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(s.Fo.CODE_VERIFIER,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(s.Fo.CLIENT_SECRET,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(s.Fo.CLIENT_ASSERTION,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(s.Fo.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(s.Fo.OBO_ASSERTION,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(s.Fo.REQUESTED_TOKEN_USE,encodeURIComponent(e))}addGrantType(e){this.parameters.set(s.Fo.GRANT_TYPE,encodeURIComponent(e))}addClientInfo(){this.parameters.set(s.sR,"1")}addExtraQueryParameters(e){const t=be.sanitizeEQParams(e,this.parameters);Object.keys(t).forEach((t=>{this.parameters.set(t,e[t])}))}addClientCapabilitiesToClaims(e,t){let n;if(e)try{n=JSON.parse(e)}catch(e){throw R.r.createInvalidClaimsRequestError()}else n={};return t&&t.length>0&&(n.hasOwnProperty(s.As.ACCESS_TOKEN)||(n[s.As.ACCESS_TOKEN]={}),n[s.As.ACCESS_TOKEN][s.As.XMS_CC]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(s.Ge.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(s.Ge.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(s.Fo.TOKEN_TYPE,s.hO.POP),this.parameters.set(s.Fo.REQ_CNF,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(s.Fo.TOKEN_TYPE,s.hO.SSH),this.parameters.set(s.Fo.REQ_CNF,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(s.Fo.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(s.Fo.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(s.Fo.X_MS_LIB_CAPABILITY,s.bb.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(s.Fo.LOGOUT_HINT,encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach(((t,n)=>{e.push(`${n}=${t}`)})),e.join("&")}}class Ae{constructor(e,t){this.config=(0,we.j6)(e),this.logger=new _e.Y(this.config.loggerOptions,Ce.u,Ce.i),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new ye(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[s.SZ.CONTENT_TYPE]=s.gT.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case J:try{const n=(0,Se.j)(e.credential);t[s.SZ.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case V:t[s.SZ.CCS_HEADER]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,n,r,o){this.performanceClient?.addQueueMeasurement(i.Ak.BaseClientCreateTokenRequestHeaders,o);const a=await this.networkManager.sendPostRequest(r,e,{body:t,headers:n});return this.performanceClient?.addFields({refreshTokenSize:a.body.refresh_token?.length||0,httpVerToken:a.headers?.[s.SZ.X_MS_HTTP_VERSION]||""},o),this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}updateAuthority(e){if(!e.discoveryComplete())throw N.e.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e}createTokenQueryParameters(e){const t=new Te;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}}class Ie{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e){this.performanceClient?.addQueueMeasurement(i.Ak.PopTokenGenerateCnf,e.correlationId),this.performanceClient?.setPreQueueTime(i.Ak.PopTokenGenerateKid,e.correlationId);const t=await this.generateKid(e),n=this.cryptoUtils.base64Encode(JSON.stringify(t));return{kid:t.kid,reqCnfString:n,reqCnfHash:await this.cryptoUtils.hashString(n)}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(i.Ak.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,i){const{resourceRequestMethod:r,resourceRequestUri:o,shrClaims:s,shrNonce:a}=n,c=o?new H(o):void 0,u=c?.getUrlComponents();return await this.cryptoUtils.signJwt({at:e,ts:q.nowSeconds(),m:r?.toUpperCase(),u:u?.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0,...i},t,n.correlationId)}}class Ee{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Re{constructor(e,t,n,i,r,o,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=i,this.serializableCache=r,this.persistencePlugin=o,this.performanceClient=s}validateServerAuthorizationCodeResponse(e,t,n){if(!e.state||!t)throw e.state?N.e.createStateNotFoundError("Cached State"):N.e.createStateNotFoundError("Server State");let i,r;try{i=decodeURIComponent(e.state)}catch(t){throw N.e.createInvalidStateError(e.state,"Server response hash URI could not be decoded")}try{r=decodeURIComponent(t)}catch(t){throw N.e.createInvalidStateError(e.state,"Cached state URI could not be decoded")}if(i!==r)throw N.e.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(O.Yo.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new O.Yo(e.error||s.gT.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||s.gT.EMPTY_STRING,e.trace_id||s.gT.EMPTY_STRING,e.correlation_id||s.gT.EMPTY_STRING,e.claims||s.gT.EMPTY_STRING);throw new M(e.error||s.gT.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&(0,Se.B)(e.client_info,n)}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const n=`${e.error_codes} - [${e.timestamp}]: ${e.error_description} - Correlation ID: ${e.correlation_id} - Trace ID: ${e.trace_id}`,i=new M(e.error,n,e.suberror);if(t&&e.status&&e.status>=s.oj.SERVER_ERROR_RANGE_START&&e.status<=s.oj.SERVER_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${i}`);if(t&&e.status&&e.status>=s.oj.CLIENT_ERROR_RANGE_START&&e.status<=s.oj.CLIENT_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${i}`);if(O.Yo.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new O.Yo(e.error,e.error_description,e.suberror,e.timestamp||s.gT.EMPTY_STRING,e.trace_id||s.gT.EMPTY_STRING,e.correlation_id||s.gT.EMPTY_STRING,e.claims||s.gT.EMPTY_STRING);throw i}}async handleServerTokenResponse(e,t,n,r,o,a,c,u,l){let d,h;if(this.performanceClient?.addQueueMeasurement(i.Ak.HandleServerTokenResponse,e.correlation_id),e.id_token){if(d=(0,B.Z_)(e.id_token||s.gT.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&d.nonce!==o.nonce)throw N.e.createNonceMismatchError();if(r.maxAge||0===r.maxAge){const e=d.auth_time;if(!e)throw N.e.createAuthTimeNotFoundError();(0,B.ky)(e,r.maxAge)}}this.homeAccountIdentifier=U.r.generateHomeAccountId(e.client_info||s.gT.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,d),o&&o.state&&(h=z.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||r.sshKid||void 0;const f=this.generateCacheRecord(e,t,n,r,d,a,o);let p;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new Ee(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(p)),c&&!u&&f.account){const e=f.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),Re.generateAuthenticationResult(this.cryptoObj,t,f,!1,r,d,h,void 0,l)}await this.cacheStorage.saveCacheRecord(f,r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&p&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(p))}return Re.generateAuthenticationResult(this.cryptoObj,t,f,!1,r,d,h,e,l)}generateCacheRecord(e,t,n,i,r,o,a){const c=t.getPreferredCache();if(!c)throw N.e.createInvalidCacheEnvironmentError();let u,l;e.id_token&&r&&(u=x.createIdTokenEntity(this.homeAccountIdentifier,c,e.id_token,this.clientId,r.tid||""),l=U.r.createAccount({homeAccountId:this.homeAccountIdentifier,idTokenClaims:r,clientInfo:e.client_info,cloudGraphHostName:a?.cloud_graph_host_name,msGraphHost:a?.msgraph_host},t));let d=null;if(e.access_token){const a=e.scope?ke.i.fromString(e.scope):new ke.i(i.scopes||[]),u=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,h=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,f=n+u,p=f+l,v=h&&h>0?n+h:void 0;d=L.createAccessTokenEntity(this.homeAccountIdentifier,c,e.access_token||s.gT.EMPTY_STRING,this.clientId,r?.tid||t.tenant,a.printScopes(),f,p,this.cryptoObj,v,e.token_type,o,e.key_id,i.claims,i.requestedClaimsHash)}let h=null;e.refresh_token&&(h=W.createRefreshTokenEntity(this.homeAccountIdentifier,c,e.refresh_token||s.gT.EMPTY_STRING,this.clientId,e.foci,o));let f=null;return e.foci&&(f=j.createAppMetadataEntity(this.clientId,c,e.foci)),new Q(l,u,d,h,f)}static async generateAuthenticationResult(e,t,n,i,r,o,a,c,u){let l,d,h=s.gT.EMPTY_STRING,f=[],p=null,v=s.gT.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===s.hO.POP){const t=new Ie(e),{secret:i,keyId:o}=n.accessToken;if(!o)throw N.e.createKeyIdMissingError();h=await t.signPopToken(i,o,r)}else h=n.accessToken.secret;f=ke.i.fromString(n.accessToken.target).asArray(),p=new Date(1e3*Number(n.accessToken.expiresOn)),l=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),n.accessToken.refreshOn&&(d=new Date(1e3*Number(n.accessToken.refreshOn)))}n.appMetadata&&(v=n.appMetadata.familyId===s.ch?s.ch:"");const m=o?.oid||o?.sub||"",g=o?.tid||"";return c?.spa_accountid&&n.account&&(n.account.nativeAccountId=c?.spa_accountid),{authority:t.canonicalAuthority,uniqueId:m,tenantId:g,scopes:f,account:n.account?n.account.getAccountInfo():null,idToken:n?.idToken?.secret||"",idTokenClaims:o||{},accessToken:h,fromCache:i,expiresOn:p,extExpiresOn:l,refreshOn:d,correlationId:r.correlationId,requestId:u||s.gT.EMPTY_STRING,familyId:v,tokenType:n.accessToken?.tokenType||s.gT.EMPTY_STRING,state:a?a.userRequestState:s.gT.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||s.gT.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||s.gT.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}}}class Ne extends Ae{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(i.Ak.GetAuthCodeUrl,e.correlationId);const t=await E(this.createAuthCodeUrlQueryString.bind(this),i.Ak.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return H.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientAcquireToken,e.correlationId),!e.code)throw N.e.createTokenRequestCannotBeMadeError();const n=q.nowSeconds(),r=await E(this.executeTokenRequest.bind(this),i.Ak.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=r.headers?.[s.SZ.X_MS_REQUEST_ID],a=new Re(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(r.body),E(a.handleServerTokenResponse.bind(a),i.Ak.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,t,void 0,void 0,void 0,o)}handleFragmentResponse(e,t){const n=new Re(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),i=H.getDeserializedCodeResponse(this.config.authOptions.authority.options.OIDCOptions?.serverResponseType,e);if(n.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),!i.code)throw N.e.createNoAuthCodeInServerResponseError();return{...i,code:i.code}}getLogoutUri(e){if(!e)throw R.r.createEmptyLogoutRequestError();const t=this.createLogoutUrlQueryString(e);return H.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientExecuteTokenRequest,t.correlationId);const n=this.createTokenQueryParameters(t),r=H.appendQueryString(e.tokenEndpoint,n),o=await E(this.createTokenRequestBody.bind(this),i.Ak.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let a;if(t.clientInfo)try{const e=(0,Se.B)(t.clientInfo,this.cryptoUtils);a={credential:`${e.uid}${s.Bv.CLIENT_INFO_SEPARATOR}${e.utid}`,type:J}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const c=this.createTokenRequestHeaders(a||t.ccsCredential),u={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return E(this.executePostToTokenEndpoint.bind(this),i.Ak.BaseClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(r,o,c,u,t.correlationId)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Te;if(t.addClientId(e.tokenBodyParameters?.[s.Fo.CLIENT_ID]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):be.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!(0,we.lh)(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const e=this.config.clientCredentials.clientAssertion;t.addClientAssertion(e.assertion),t.addClientAssertionType(e.assertionType)}if(t.addGrantType(s.qJ.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===s.hO.POP){const n=new Ie(this.cryptoUtils,this.performanceClient);this.performanceClient?.setPreQueueTime(i.Ak.PopTokenGenerateCnf,e.correlationId);const r=await n.generateCnf(e);t.addPopToken(r.reqCnfString)}else if(e.authenticationScheme===s.hO.SSH){if(!e.sshJwk)throw R.r.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}const n=e.correlationId||this.config.cryptoInterface.createNewGuid();let r;if(t.addCorrelationId(n),(!P.x.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=(0,Se.B)(e.clientInfo,this.cryptoUtils);r={credential:`${t.uid}${s.Bv.CLIENT_INFO_SEPARATOR}${t.utid}`,type:J}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case J:try{const e=(0,Se.j)(r.credential);t.addCcsOid(e)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case V:t.addCcsUpn(r.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[s.Fo.RETURN_SPA_CODE]||t.addExtraQueryParameters({[s.Fo.RETURN_SPA_CODE]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientCreateQueryString,e.correlationId);const t=new Te;t.addClientId(e.extraQueryParameters?.[s.Fo.CLIENT_ID]||this.config.authOptions.clientId);const n=[...e.scopes||[],...e.extraScopesToConsent||[]];t.addScopes(n,!0,this.oidcDefaultScopes),t.addRedirectUri(e.redirectUri);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),(0,we.lh)(this.config)||t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==s.NJ.SELECT_ACCOUNT)if(e.sid&&e.prompt===s.NJ.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){const n=this.extractAccountSid(e.account),i=this.extractLoginHint(e.account);if(i){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),t.addLoginHint(i);try{const n=(0,Se.j)(e.account.homeAccountId);t.addCcsOid(n)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(n&&e.prompt===s.NJ.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(n);try{const n=(0,Se.j)(e.account.homeAccountId);t.addCcsOid(n)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{const n=(0,Se.j)(e.account.homeAccountId);t.addCcsOid(n)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(t.addNativeBroker(),e.authenticationScheme===s.hO.POP)){const n=new Ie(this.cryptoUtils),i=await n.generateCnf(e);t.addPopToken(i.reqCnfHash)}return t.createQueryString()}createLogoutUrlQueryString(e){const t=new Te;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}var Pe=n(3570);const He={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},Oe={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Ue=new Set;for(const e in Oe)for(const t of Oe[e].metadata)for(const e of t.aliases)Ue.add(e);var Me=n(9744);class De{constructor(e,t,n){this.networkInterface=e,this.performanceClient=t,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(i.Ak.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=s.W.ENVIRONMENT_VARIABLE;else{const e=De.IMDS_OPTIONS;try{this.performanceClient?.setPreQueueTime(i.Ak.RegionDiscoveryGetRegionFromIMDS,this.correlationId);const r=await this.getRegionFromIMDS(s.gT.IMDS_VERSION,e);if(r.status===s.YY.httpSuccess&&(n=r.body,t.region_source=s.W.IMDS),r.status===s.YY.httpBadRequest){this.performanceClient?.setPreQueueTime(i.Ak.RegionDiscoveryGetCurrentVersion,this.correlationId);const r=await this.getCurrentVersion(e);if(!r)return t.region_source=s.W.FAILED_AUTO_DETECTION,null;this.performanceClient?.setPreQueueTime(i.Ak.RegionDiscoveryGetRegionFromIMDS,this.correlationId);const o=await this.getRegionFromIMDS(r,e);o.status===s.YY.httpSuccess&&(n=o.body,t.region_source=s.W.IMDS)}}catch(e){return t.region_source=s.W.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=s.W.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(i.Ak.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${s.gT.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,s.gT.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(i.Ak.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${s.gT.IMDS_ENDPOINT}?format=json`,e);return t.status===s.YY.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}De.IMDS_OPTIONS={headers:{Metadata:"true"}};class Fe{constructor(e,t,n,i,r,o,s){this.canonicalAuthority=e,this._i.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=r,this.performanceClient=o,this.correlationId=s,this.regionDiscovery=new De(t,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(s.gT.CIAM_AUTH_URL))return Pe.a.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case s.gT.ADFS:return Pe.a.Adfs;case s.gT.DSTS:return Pe.a.Dsts}return Pe.a.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._i.urlString}set canonicalAuthority(e){this._i=new H(e),this._i.validateAsUri(),this.Ci=null}get canonicalAuthorityUrlComponents(){return this.Ci||(this.Ci=this._i.getUrlComponents()),this.Ci}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw N.e.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}canReplaceTenant(e){return 1===e.PathSegments.length&&!Fe.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Pe.a.Default&&this.protocolMode===ge.A.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new H(this.metadata.canonical_authority).getUrlComponents(),i=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,r)=>{let o=i[r];if(0===r&&this.canReplaceTenant(n)){const e=new H(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];o!==e&&(this.logger.verbose(`Replacing tenant domain name ${o} with id ${e}`),o=e)}e!==o&&(t=t.replace(`/${o}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.authorityType===Pe.a.Adfs||this.protocolMode!==ge.A.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);e||(e=new G,e.updateCanonicalAuthority(this.canonicalAuthority)),this.performanceClient?.setPreQueueTime(i.Ak.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=await this.updateCloudDiscoveryMetadata(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),this.performanceClient?.setPreQueueTime(i.Ak.AuthorityUpdateEndpointMetadata,this.correlationId);const n=await this.updateEndpointMetadata(e);t!==s.pQ.CACHE&&n!==s.pQ.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority));const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityUpdateEndpointMetadata,this.correlationId),this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),e.updateEndpointMetadata(t,!1),s.pQ.CONFIG;if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let t=this.getEndpointMetadataFromHardcodedValues();if(t)return this.logger.verbose("Found endpoint metadata from hardcoded values."),this.authorityOptions.azureRegionConfiguration?.azureRegion&&(this.performanceClient?.setPreQueueTime(i.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),this.logger.verbose("Found azure region configuration. Updating endpoints with regional information."),t=await this.updateMetadataWithRegionalInformation(t)),e.updateEndpointMetadata(t,!1),s.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=e.isExpired();if(this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n)return this.logger.verbose("Found endpoint metadata in the cache."),s.pQ.CACHE;if(n&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cached endpoint metadata... Attempting to get endpoint metadata from the network."),this.performanceClient?.setPreQueueTime(i.Ak.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t=await this.getEndpointMetadataFromNetwork(),t)return this.logger.verbose("Endpoint metadata was successfully returned from getEndpointMetadataFromNetwork()"),this.authorityOptions.azureRegionConfiguration?.azureRegion&&(this.performanceClient?.setPreQueueTime(i.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),this.logger.verbose("Found azure region configuration. Updating endpoints with regional information."),t=await this.updateMetadataWithRegionalInformation(t)),e.updateEndpointMetadata(t,!0),s.pQ.NETWORK;throw this.logger.error("Did not find endpoint metadata from network... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),N.e.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}isAuthoritySameType(e){return new H(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw R.r.createInvalidAuthorityMetadataError()}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e=this.performanceClient?.startMeasurement(i.Ak.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${n}`);try{const i=await this.networkInterface.sendGetRequestAsync(n,t),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(i.body);return r?(e?.end({success:!0}),i.body):(e?.end({success:!1,errorCode:"invalid_response"}),this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(t){return e?.end({success:!1,errorCode:"request_failure"}),this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${t}`),null}}getEndpointMetadataFromHardcodedValues(){return this.canonicalAuthority in He?He[this.canonicalAuthority]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==s.gT.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=s.ki.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,Fe.replaceWithRegionalInformation(e,t);this.performanceClient?.setPreQueueTime(i.Ak.RegionDiscoveryDetectRegion,this.correlationId);const n=await this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=s.ki.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,Fe.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=s.ki.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||s.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||s.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||s.gT.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),e.updateCloudDiscoveryMetadata(t,!1),s.pQ.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=this.getCloudDiscoveryMetadataFromHardcodedValues();if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(t,!1),s.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const n=e.isExpired();if(this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n)return this.logger.verbose("Found cloud discovery metadata in the cache."),s.pQ.CACHE;if(n&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),this.performanceClient?.setPreQueueTime(i.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),t=await this.getCloudDiscoveryMetadataFromNetwork(),t)return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(t,!0),s.pQ.NETWORK;throw this.logger.error("Did not find cloud discovery metadata from network... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),R.r.createUntrustedAuthorityError()}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Pe.a.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Fe.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Fe.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),R.r.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Fe.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${s.gT.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let n=null;try{const i=await this.networkInterface.sendGetRequestAsync(e,t);let r,o;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(i.body))r=i.body,o=r.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${r.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),r=i.body,r.error===s.gT.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${r.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${r.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=Fe.getCloudDiscoveryMetadataFromNetworkResponse(o,this.hostnameAndPort)}catch(e){if(e instanceof r.l)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=Fe.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}getCloudDiscoveryMetadataFromHardcodedValues(){if(this.canonicalAuthority in Oe){const e=Oe[this.canonicalAuthority];return Fe.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort)}return null}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>H.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Me.z.None){const e=t.tenant?t.tenant:s.gT.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${e}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}static getCloudDiscoveryMetadataFromNetworkResponse(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.aliases.indexOf(t)>-1)return i}return null}getPreferredCache(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw N.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Ue.has(e)}static isPublicCloudAuthority(e){return s.gT.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const i=new H(e);i.validateAsUri();const r=i.getUrlComponents();let o=`${t}.${r.HostNameAndPort}`;this.isPublicCloudAuthority(r.HostNameAndPort)&&(o=`${t}.${s.gT.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=H.constructAuthorityUriFromObject({...i.getUrlComponents(),HostNameAndPort:o}).urlString;return n?`${a}?${n}`:a}static replaceWithRegionalInformation(e,t){const n={...e};return n.authorization_endpoint=Fe.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=Fe.buildRegionalAuthorityString(n.token_endpoint,t,s.gT.REGIONAL_AUTH_NON_MSI_QUERY_STRING),n.end_session_endpoint&&(n.end_session_endpoint=Fe.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e.endsWith(s.gT.FORWARD_SLASH)?e:`${e}${s.gT.FORWARD_SLASH}`;const n=new H(e).getUrlComponents();return 0===n.PathSegments.length&&n.HostNameAndPort.endsWith(s.gT.CIAM_AUTH_URL)&&(t=`${t}${n.HostNameAndPort.split(".")[0]}${s.gT.AAD_TENANT_DOMAIN_SUFFIX}`),t}}Fe.reservedTenantDomains=new Set(["{tenant}","{tenantid}",s.Nb.COMMON,s.Nb.CONSUMERS,s.Nb.ORGANIZATIONS]);class xe{static async createDiscoveredInstance(e,t,n,r,o,s,a){s?.addQueueMeasurement(i.Ak.AuthorityFactoryCreateDiscoveredInstance,a);const c=Fe.transformCIAMAuthority(e),u=xe.createInstance(c,t,n,r,o,s,a);try{return s?.setPreQueueTime(i.Ak.AuthorityResolveEndpointsAsync,a),await u.resolveEndpointsAsync(),u}catch(e){throw N.e.createEndpointDiscoveryIncompleteError(e)}}static createInstance(e,t,n,i,r,o,s){if(!e)throw R.r.createUrlEmptyError();return new Fe(e,t,n,i,r,o,s)}}class qe{constructor(e,t){this.cacheOutcome=s.To.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||s.gT.EMPTY_STRING,this.wrapperVer=e.wrapperVer||s.gT.EMPTY_STRING,this.telemetryCacheKey=s.HN.CACHE_KEY+s.Bv.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${s.HN.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer].join(s.HN.VALUE_SEPARATOR),n=[e,this.getRegionDiscoveryFields()].join(s.HN.VALUE_SEPARATOR);return[s.HN.SCHEMA_VERSION,n,t].join(s.HN.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=qe.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(s.HN.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(s.HN.VALUE_SEPARATOR),r=e.errors.length,o=[r,t<r?s.HN.OVERFLOW_TRUE:s.HN.OVERFLOW_FALSE].join(s.HN.VALUE_SEPARATOR);return[s.HN.SCHEMA_VERSION,e.cacheHits,n,i,o].join(s.HN.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=s.HN.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof r.l?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(s.HN.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e=new K;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=qe.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const n=new K;n.failedRequests=e.failedRequests.slice(2*t),n.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}}static maxErrorsToSend(e){let t,n=0,i=0;const r=e.errors.length;for(t=0;t<r;t++){const r=e.failedRequests[2*t]||s.gT.EMPTY_STRING,o=e.failedRequests[2*t+1]||s.gT.EMPTY_STRING,a=e.errors[t]||s.gT.EMPTY_STRING;if(i+=r.toString().length+o.toString().length+a.length+3,!(i<s.HN.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||s.gT.EMPTY_STRING),e.push(this.regionSource||s.gT.EMPTY_STRING),e.push(this.regionOutcome||s.gT.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}}var Be=n(1464);class Le{constructor(e,t,n,i,r,o,s,a,c){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=r,this.navigationClient=o,this.nativeMessageHandler=a,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=i.clone(g.qx.MSAL_SKU,Be.i,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e){if(e){U.r.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(U.r.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}async initializeBaseRequest(e,t){this.performanceClient.addQueueMeasurement(i.Ak.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest");const n=e.authority||this.config.auth.authority;t&&await this.validateRequestAuthority(n,t);const r=[...e&&e.scopes||[]],o={...e,correlationId:this.correlationId,authority:n,scopes:r};if(o.authenticationScheme){if(o.authenticationScheme===s.hO.SSH){if(!e.sshJwk)throw R.r.createMissingSshJwkError();if(!e.sshKid)throw R.r.createMissingSshKidError()}this.logger.verbose(`Authentication Scheme set to "${o.authenticationScheme}" as configured in Auth request`)}else o.authenticationScheme=s.hO.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!P.x.isEmptyObj(e.claims)&&(o.requestedClaimsHash=await this.browserCrypto.hashString(e.claims)),o}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri||te.getCurrentUri();return H.getAbsoluteUrl(t,te.getCurrentUri())}async validateRequestAuthority(e,t){if(!(await this.getDiscoveredAuthority(e)).isAlias(t.environment))throw R.r.createAuthorityMismatchError()}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new qe(n,this.browserStorage)}async getDiscoveredAuthority(e){this.logger.verbose("getDiscoveredAuthority called");const t={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata};return e?(this.logger.verbose("Creating discovered authority with request authority"),await xe.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)):(this.logger.verbose("Creating discovered authority with configured authority"),await xe.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger))}}class We extends Le{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId);const t=await this.browserCrypto.generatePkceCodes(),n={...e,redirectUri:e.redirectUri,code:s.gT.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=s.gT.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||this.browserCrypto.createNewGuid(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=H.getAbsoluteUrl(e.postLogoutRedirectUri,te.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=H.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,te.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=H.getAbsoluteUrl(te.getCurrentUri(),te.getCurrentUri())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e,t,n){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientGetClientConfiguration,this.correlationId);const r=await this.getClientConfiguration(e,t,n);return new Ne(r,this.performanceClient)}async getClientConfiguration(e,t,n){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const r=await this.getDiscoveredAuthority(t,n),o=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:r,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:g.qx.MSAL_SKU,version:Be.i,cpu:s.gT.EMPTY_STRING,os:s.gT.EMPTY_STRING},telemetry:this.config.telemetry}}validateAndExtractStateFromHash(e,t,n){if(this.logger.verbose("validateAndExtractStateFromHash called",n),!e.state)throw(0,f.Z_)(p.Xk);const i=Z.extractBrowserRequestState(this.browserCrypto,e.state);if(!i)throw(0,f.Z_)(p.$P);if(i.interactionType!==t)throw(0,f.Z_)(p.yK);return this.logger.verbose("Returning state from hash",n),e.state}async getDiscoveredAuthority(e,t){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId);const n=this.performanceClient?.startMeasurement(i.Ak.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e||this.config.auth.authority,s=Fe.generateAuthority(o,t||this.config.auth.azureCloudOptions);return this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(i.Ak.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),await xe.createDiscoveredInstance(s,this.config.system.networkClient,this.browserStorage,r,this.logger,this.performanceClient,this.correlationId).then((e=>(n.end({success:!0}),e))).catch((e=>{throw n.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},o=z.setRequestState(this.browserCrypto,e&&e.state||s.gT.EMPTY_STRING,r);this.performanceClient.setPreQueueTime(i.Ak.InitializeBaseRequest,this.correlationId);const a={...await this.initializeBaseRequest(e),redirectUri:n,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:this.config.auth.OIDCOptions.serverResponseType},c=e.account||this.browserStorage.getActiveAccount();if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),a.account=c),!a.loginHint&&!c){const e=this.browserStorage.getLegacyLoginHint();e&&(a.loginHint=e)}return a}}class je extends r.l{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,je.prototype),this.name="NativeAuthError",this.ext=n}isFatal(){return!(!this.ext||!this.ext.status||"PERSISTENT_ERROR"!==this.ext.status&&"DISABLED"!==this.ext.status)||!(!this.ext||!this.ext.error||-2147186943!==this.ext.error)||"ContentError"===this.errorCode}static createError(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return O.Yo.createNativeAccountUnavailableError();case"USER_INTERACTION_REQUIRED":return new O.Yo(e,t);case"USER_CANCEL":return(0,f.Z_)(p.h7);case"NO_NETWORK":return(0,f.Z_)(p.Mq)}return new je(e,t,n)}static createUserSwitchError(){return new je("user_switch","User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again.")}static createTokensNotFoundInCacheError(){return new je("tokens_not_found_in_internal_memory_cache","Tokens not cached in MSAL JS internal memory, please make the WAM request")}}class Ke extends Ae{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientAcquireToken,e.correlationId);const t=this.performanceClient?.startMeasurement(i.Ak.RefreshTokenClientAcquireToken,e.correlationId);this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId);const n=q.nowSeconds();this.performanceClient?.setPreQueueTime(i.Ak.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=await this.executeTokenRequest(e,this.authority),o=r.headers?.[s.SZ.X_MS_REQUEST_ID],a=new Re(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(r.body),this.performanceClient?.setPreQueueTime(i.Ak.HandleServerTokenResponse,e.correlationId),a.handleServerTokenResponse(r.body,this.authority,n,e,void 0,void 0,!0,e.forceCache,o).then((e=>(t?.end({success:!0}),e))).catch((n=>{throw this.logger.verbose("Error in fetching refresh token",e.correlationId),t?.end({errorCode:n.errorCode,subErrorCode:n.subError,success:!1}),n}))}async acquireTokenByRefreshToken(e){if(!e)throw R.r.createEmptyTokenRequestError();if(this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw N.e.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return this.performanceClient?.setPreQueueTime(i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.acquireTokenWithCachedRefreshToken(e,!0)}catch(t){const n=t instanceof O.Yo&&t.errorCode===O.Zy.noTokensFoundError.code,r=t instanceof M&&t.errorCode===s.D1.INVALID_GRANT_ERROR&&t.subError===s.D1.CLIENT_MISMATCH_ERROR;if(n||r)return this.performanceClient?.setPreQueueTime(i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.acquireTokenWithCachedRefreshToken(e,!1);throw t}return this.performanceClient?.setPreQueueTime(i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.acquireTokenWithCachedRefreshToken(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const n=this.performanceClient?.startMeasurement(i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId);const r=this.cacheManager.getRefreshToken(e.account,t);if(!r)throw n?.discard(),O.Yo.createNoTokensFoundError();n?.end({success:!0});const o={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||s.hO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:J}};return this.performanceClient?.setPreQueueTime(i.Ak.RefreshTokenClientAcquireToken,e.correlationId),this.acquireToken(o)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientExecuteTokenRequest,e.correlationId);const n=this.performanceClient?.startMeasurement(i.Ak.RefreshTokenClientExecuteTokenRequest,e.correlationId);this.performanceClient?.setPreQueueTime(i.Ak.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const r=this.createTokenQueryParameters(e),o=H.appendQueryString(t.tokenEndpoint,r),s=await this.createTokenRequestBody(e),a=this.createTokenRequestHeaders(e.ccsCredential),c={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return this.executePostToTokenEndpoint(o,s,a,c,e.correlationId).then((e=>(n?.end({success:!0}),e))).catch((e=>{throw n?.end({success:!1}),e}))}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,n=this.performanceClient?.startMeasurement(i.Ak.BaseClientCreateTokenRequestHeaders,t),r=new Te;if(r.addClientId(this.config.authOptions.clientId),r.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),r.addGrantType(s.qJ.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!(0,we.lh)(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addCorrelationId(t),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const e=this.config.clientCredentials.clientAssertion;r.addClientAssertion(e.assertion),r.addClientAssertionType(e.assertionType)}if(e.authenticationScheme===s.hO.POP){const t=new Ie(this.cryptoUtils,this.performanceClient);this.performanceClient?.setPreQueueTime(i.Ak.PopTokenGenerateCnf,e.correlationId);const n=await t.generateCnf(e);r.addPopToken(n.reqCnfString)}else if(e.authenticationScheme===s.hO.SSH){if(!e.sshJwk)throw n?.end({success:!1}),R.r.createMissingSshJwkError();r.addSshJwk(e.sshJwk)}if((!P.x.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case J:try{const t=(0,Se.j)(e.ccsCredential.credential);r.addCcsOid(t)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case V:r.addCcsUpn(e.ccsCredential.credential)}return n?.end({success:!0}),r.createQueryString()}}class Ge extends Ae{constructor(e,t){super(e,t)}async acquireToken(e){try{return await this.acquireCachedToken(e)}catch(t){if(t instanceof N.e&&t.errorCode===N.A.tokenRefreshRequired.code)return new Ke(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw t}}async acquireCachedToken(e){if(!e)throw R.r.createEmptyTokenRequestError();if(e.forceRefresh)throw this.serverTelemetryManager?.setCacheOutcome(s.To.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),N.e.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!P.x.isEmptyObj(e.claims))throw this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),N.e.createRefreshRequiredError();if(!e.account)throw N.e.createNoAccountInSilentRequestError();const t=e.authority||this.authority.getPreferredCache(),n=this.cacheManager.readCacheRecord(e.account,e,t);if(!n.accessToken)throw this.serverTelemetryManager?.setCacheOutcome(s.To.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),N.e.createRefreshRequiredError();if(q.wasClockTurnedBack(n.accessToken.cachedAt)||q.isTokenExpired(n.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(s.To.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),N.e.createRefreshRequiredError();if(n.accessToken.refreshOn&&q.isTokenExpired(n.accessToken.refreshOn,0))throw this.serverTelemetryManager?.setCacheOutcome(s.To.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),N.e.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),await this.generateResultFromCacheRecord(n,e)}async generateResultFromCacheRecord(e,t){let n;if(e.idToken&&(n=(0,B.Z_)(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=n?.auth_time;if(!e)throw N.e.createAuthTimeNotFoundError();(0,B.ky)(e,t.maxAge)}return await Re.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}}class $e extends We{async acquireToken(e){const t=this.performanceClient.startMeasurement(i.Ak.SilentCacheClientAcquireToken,e.correlationId),n=this.initializeServerTelemetryManager(g.WN.acquireTokenSilent_silentFlow),o=await this.createSilentFlowClient(n,e.authority,e.azureCloudOptions);this.logger.verbose("Silent auth client created");try{const n=await o.acquireCachedToken(e);return t.end({success:!0,fromCache:!0}),n}catch(e){throw e instanceof f.Ut&&e.errorCode===p.XM&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.end({errorCode:e instanceof r.l&&e.errorCode||void 0,subErrorCode:e instanceof r.l&&e.subError||void 0,success:!1}),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}async createSilentFlowClient(e,t,n){this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientGetClientConfiguration,this.correlationId);const r=await this.getClientConfiguration(e,t,n);return new Ge(r,this.performanceClient)}async initializeSilentRequest(e,t){return this.performanceClient.addQueueMeasurement(i.Ak.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(i.Ak.InitializeBaseRequest,this.correlationId),{...e,...await this.initializeBaseRequest(e,t),account:t,forceRefresh:e.forceRefresh||!1}}}const ze="brk_redirect_uri";class Je extends Le{constructor(e,t,n,i,r,o,s,a,c,u,l,d){super(e,t,n,i,r,o,a,c,d),this.apiId=s,this.accountId=u,this.nativeMessageHandler=c,this.nativeStorageManager=l,this.silentCacheClient=new $e(e,this.nativeStorageManager,n,i,r,o,a,c,d)}async acquireToken(e){this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(i.Ak.NativeInteractionClientAcquireToken,e.correlationId),n=q.nowSeconds(),r=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,r);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const o={method:g.Ky.GetToken,request:r},s=await this.nativeMessageHandler.sendMessage(o),a=this.validateNativeResponse(s);return this.handleNativeResponse(a,r,n).then((e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),e))).catch((e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:ke.i.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),N.e.createNoAccountFoundError();const n=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e});if(!n)throw N.e.createNoAccountFoundError();try{const e=this.createSilentCacheRequest(t,n);return{...await this.silentCacheClient.acquireToken(e),account:n}}catch(e){throw e}}async acquireTokenRedirect(e){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const t=await this.initializeNativeRequest(e),n={method:g.Ky.GetToken,request:t};try{const e=await this.nativeMessageHandler.sendMessage(n);this.validateNativeResponse(e)}catch(e){if(e instanceof je&&e.isFatal())throw e}this.browserStorage.setTemporaryCache(g.c4.NATIVE_REQUEST,JSON.stringify(t),!0);const i={apiId:g.WN.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},r=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);await this.navigationClient.navigateExternal(r,i)}async handleRedirectPromise(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const e=this.browserStorage.getCachedNativeRequest();if(!e)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),null;const{prompt:t,...n}=e;t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(g.c4.NATIVE_REQUEST));const i={method:g.Ky.GetToken,request:n},r=q.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,n,r);return this.browserStorage.setInteractionInProgress(!1),t}catch(e){throw this.browserStorage.setInteractionInProgress(!1),e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw je.createUserSwitchError();const i=await this.getDiscoveredAuthority(t.authority),r=B.Z_(e.id_token,h),o=this.createHomeAccountIdentifier(e,r),s=U.r.createAccount({homeAccountId:o,idTokenClaims:r,clientInfo:e.client_info,nativeAccountId:e.account.id},i),a=await this.generateAuthenticationResult(e,t,r,s,i.canonicalAuthority,n);return this.cacheAccount(s),this.cacheNativeTokens(e,t,o,r,a.accessToken,a.tenantId,n),a}createHomeAccountIdentifier(e,t){return U.r.generateHomeAccountId(e.client_info||s.gT.EMPTY_STRING,Pe.a.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?ke.i.fromString(e.scope):ke.i.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===s.hO.POP){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new Ie(this.browserCrypto),i={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw N.e.createKeyIdMissingError();return await n.signPopToken(e.access_token,t.keyId,i)}return e.access_token}async generateAuthenticationResult(e,t,n,i,r,o){const a=this.addTelemetryFromNativeResponse(e),c=e.scope?ke.i.fromString(e.scope):ke.i.fromString(t.scope),u=e.account.properties||{},l=u.UID||n.oid||n.sub||s.gT.EMPTY_STRING,d=u.TenantId||n.tid||s.gT.EMPTY_STRING,h=await this.generatePopAccessToken(e,t),f=t.tokenType===s.hO.POP?s.hO.POP:s.hO.BEARER;return{authority:r,uniqueId:l,tenantId:d,scopes:c.asArray(),account:i.getAccountInfo(),idToken:e.id_token,idTokenClaims:n,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:new Date(1e3*Number(o+e.expires_in)),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,n,i,r,o,a){const c=x.createIdTokenEntity(n,t.authority,e.id_token||"",t.clientId,i.tid||""),u=a+(t.tokenType===s.hO.POP?s.gT.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),d=L.createAccessTokenEntity(n,t.authority,r,t.clientId,i.tid||o,l.printScopes(),u,0,this.browserCrypto),h=new Q(void 0,c,d);this.nativeStorageManager.saveCacheRecord(h,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw je.createUnexpectedError("Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.validateRequestAuthority(t,e.account);const n=new H(t);n.validateAsUri();const{scopes:i,...r}=e,o=new ke.i(i||[]);o.appendScopes(s.f_);const a={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case g.WN.ssoSilent:case g.WN.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),s.NJ.NONE}if(e.prompt)switch(e.prompt){case s.NJ.NONE:case s.NJ.CONSENT:case s.NJ.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),(0,f.Z_)(p.o9)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1};if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry=g.BD.MATS_TELEMETRY,e.authenticationScheme===s.hO.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new Ie(this.browserCrypto),i=await n.generateCnf(t);a.reqCnf=i.reqCnfHash,a.keyId=i.kid}return a}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty("brk_client_id")&&e.extraParameters.hasOwnProperty(ze)&&e.extraParameters.hasOwnProperty(s.Fo.CLIENT_ID)){const t=e.extraParameters[s.Fo.CLIENT_ID],n=e.redirectUri,i=e.extraParameters[ze];e.extraParameters={child_client_id:t,child_redirect_uri:n},e.redirectUri=i}}}class Ve{constructor(e,t,n,r,o){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(i.Ak.NativeMessageHandlerHandshake),this.crypto=r}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:g.BD.CHANNEL_ID,extensionId:this.extensionId,responseId:this.crypto.createNewGuid(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise(((e,n)=>{this.resolvers.set(t.responseId,{resolve:e,reject:n})}))}static async createProvider(e,t,n,i){e.trace("NativeMessageHandler - createProvider called.");try{const r=new Ve(e,t,n,i,g.BD.PREFERRED_EXTENSION_ID);return await r.sendHandshakeRequest(),r}catch(r){const o=new Ve(e,t,n,i);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:g.BD.CHANNEL_ID,extensionId:this.extensionId,responseId:this.crypto.createNewGuid(),body:{method:g.Ky.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise(((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n((0,f.Z_)(p.hR)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===g.BD.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===g.Ky.HandshakeRequest){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject((0,f.Z_)(p.Wb))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===g.Ky.Response){if(!n)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)n.reject(je.createError(e.code,e.description,e.ext));else{if(!e.result)throw r.l.createUnexpectedError("Event does not contain result.");e.result.code&&e.result.description?n.reject(je.createError(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===g.Ky.HandshakeResponse){if(!i)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(t):i&&i.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case s.hO.BEARER:case s.hO.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class Qe{constructor(e,t,n,i,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=i,this.performanceClient=r}async handleCodeResponseFromHash(e,t,n,r){if(this.performanceClient.addQueueMeasurement(i.Ak.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),!e)throw(0,f.Z_)(p.nF);const o=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(o);if(!s)throw N.e.createStateNotFoundError("Cached State");let a;try{a=this.authModule.handleFragmentResponse(e,s)}catch(e){throw e instanceof M&&e.subError===p.h7?(0,f.Z_)(p.h7):e}return this.performanceClient.setPreQueueTime(i.Ak.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.handleCodeResponseFromServer(a,t,n,r)}async handleCodeResponseFromServer(e,t,n,r,o=!0){this.performanceClient.addQueueMeasurement(i.Ak.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called");const s=this.browserStorage.generateStateKey(t),a=this.browserStorage.getTemporaryCache(s);if(!a)throw N.e.createStateNotFoundError("Cached State");const c=this.browserStorage.generateNonceKey(a),u=this.browserStorage.getTemporaryCache(c);if(this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(this.performanceClient.setPreQueueTime(i.Ak.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),await this.updateTokenEndpointAuthority(e.cloud_instance_host_name,n,r)),o&&(e.nonce=u||void 0),e.state=a,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const l=await E(this.authModule.acquireToken.bind(this.authModule),i.Ak.AuthClientAcquireToken,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(this.authCodeRequest,e);return this.browserStorage.cleanRequestByState(t),l}async updateTokenEndpointAuthority(e,t,n){this.performanceClient.addQueueMeasurement(i.Ak.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId);const r=`https://${e}/${t.tenant}/`,o=await xe.createDiscoveredInstance(r,n,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId);this.authModule.updateAuthority(o)}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(g.c4.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}class Xe extends We{constructor(e,t,n,i,r,o,s,a,c,u){super(e,t,n,i,r,o,s,c,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=a}acquireToken(e){try{const t=this.generatePopupName(e.scopes||s.f_,e.authority||this.config.auth.authority),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,n);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");const i=this.openSizedPopup("about:blank",t,n);return this.acquireTokenPopupAsync(e,t,n,i)}}catch(e){return Promise.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),n=this.generateLogoutPopupName(t),i=e&&e.authority,r=e&&e.mainWindowRedirectUri,o=e?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,o,i,void 0,r);{this.logger.verbose("asyncPopup set to false, opening popup");const e=this.openSizedPopup("about:blank",n,o);return this.logoutPopupAsync(t,n,o,i,e,r)}}catch(e){return Promise.reject(e)}}async acquireTokenPopupAsync(e,t,n,o){this.logger.verbose("acquireTokenPopupAsync called");const a=this.initializeServerTelemetryManager(g.WN.acquireTokenPopup);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId);const c=await this.initializeAuthorizationRequest(e,g.s_.Popup);this.browserStorage.updateCacheEntries(c.state,c.nonce,c.authority,c.loginHint||s.gT.EMPTY_STRING,c.account||null);try{this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId);const r=await this.initializeAuthorizationCodeRequest(c);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,e.correlationId);const s=await this.createAuthCodeClient(a,c.authority,c.azureCloudOptions);this.logger.verbose("Auth code client created");const u=Ve.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let l;u&&(l=this.performanceClient.startMeasurement(i.Ak.FetchAccountIdWithNativeBroker,e.correlationId));const d=await s.getAuthCodeUrl({...c,nativeBroker:u}),h=new Qe(s,this.browserStorage,r,this.logger,this.performanceClient),v={popup:o,popupName:t,popupWindowAttributes:n},m=this.initiateAuthRequest(d,v);this.eventHandler.emitEvent(le,g.s_.Popup,{popupWindow:m},null);const w=await this.monitorPopupForHash(m),y=H.getDeserializedHash(w),_=this.validateAndExtractStateFromHash(y,g.s_.Popup,c.correlationId);if(me.removeThrottle(this.browserStorage,this.config.auth.clientId,r),y.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),l&&l.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw(0,f.Z_)(p.V7);const e=new Je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,g.WN.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,y.accountId,this.nativeStorage,c.correlationId),{userRequestState:t}=z.parseRequestState(this.browserCrypto,_);return e.acquireToken({...c,state:t,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(_)}))}return await h.handleCodeResponseFromHash(w,_,s.authority,this.networkClient)}catch(e){throw o&&o.close(),e instanceof r.l&&(e.setCorrelationId(this.correlationId),a.cacheFailedRequest(e)),this.browserStorage.cleanRequestByState(c.state),e}}async logoutPopupAsync(e,t,n,o,s,a){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(de,g.s_.Popup,e);const c=this.initializeServerTelemetryManager(g.WN.logoutPopup);try{await this.clearCacheOnLogout(e.account),this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,e.correlationId);const r=await this.createAuthCodeClient(c,o);this.logger.verbose("Auth code client created");try{r.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&r.authority.protocolMode===ge.A.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(he,g.s_.Popup,e),a){const e={apiId:g.WN.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=H.getAbsoluteUrl(a,te.getCurrentUri());await this.navigationClient.navigateInternal(t,e)}return void(s&&s.close())}}const u=r.getLogoutUri(e);this.eventHandler.emitEvent(he,g.s_.Popup,e);const l=this.openPopup(u,{popupName:t,popupWindowAttributes:n,popup:s});if(this.eventHandler.emitEvent(le,g.s_.Popup,{popupWindow:l},null),await this.waitForLogoutPopup(l),a){const e={apiId:g.WN.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=H.getAbsoluteUrl(a,te.getCurrentUri());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw s&&s.close(),e instanceof r.l&&(e.setCorrelationId(this.correlationId),c.cacheFailedRequest(e)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(fe,g.s_.Popup,null,e),this.eventHandler.emitEvent(pe,g.s_.Popup),e}this.eventHandler.emitEvent(pe,g.s_.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),(0,f.Z_)(p.Si)}monitorPopupForHash(e){return new Promise(((t,n)=>{const i=this.config.system.windowHashTimeout/this.config.system.pollIntervalMilliseconds;let r=0;this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const o=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),this.cleanPopup(),clearInterval(o),void n((0,f.Z_)(p.h7));let a=s.gT.EMPTY_STRING,c=s.gT.EMPTY_STRING;try{a=e.location.href,c=this.extractServerResponseStringFromPopup(e,a)}catch(e){}a&&"about:blank"!==a&&(this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r++,c?(this.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(o),this.cleanPopup(e),H.hashContainsKnownProperties(c)?(this.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),t(c)):(this.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),this.logger.errorPii(`PopupHandler.monitorPopupForHash - hash found: ${c}`),n((0,f.Z_)(p.S_)))):r>i&&(this.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(o),n((0,f.Z_)(p.ZT))))}),this.config.system.pollIntervalMilliseconds)}))}waitForLogoutPopup(e){return new Promise((t=>{this.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");const n=setInterval((()=>{e.closed&&(this.logger.error("PopupHandler.waitForLogoutPopup - window closed"),this.cleanPopup(),clearInterval(n),t());let i=s.gT.EMPTY_STRING;try{i=e.location.href}catch(e){}i&&"about:blank"!==i&&(this.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),this.cleanPopup(e),t())}),this.config.system.pollIntervalMilliseconds)}))}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!n)throw(0,f.Z_)(p.H);return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),(0,f.Z_)(p.E)}}openSizedPopup(e,t,n){const i=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let a=n.popupSize?.width,c=n.popupSize?.height,u=n.popupPosition?.top,l=n.popupPosition?.left;return(!a||a<0||a>o)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),a=g.qx.POPUP_WIDTH),(!c||c<0||c>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),c=g.qx.POPUP_HEIGHT),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-g.qx.POPUP_HEIGHT/2+r)),(!l||l<0||l>o)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),l=Math.max(0,o/2-g.qx.POPUP_WIDTH/2+i)),window.open(e,t,`width=${a}, height=${c}, top=${u}, left=${l}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(g.s_.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${g.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${g.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}extractServerResponseStringFromPopup(e,t){let n;return n=this.config.auth.OIDCOptions?.serverResponseType===s.rg.QUERY?H.parseQueryServerResponse(t):e.location.hash,n}}class Ye extends Qe{constructor(e,t,n,i,r,o){super(e,t,n,i,o),this.browserCrypto=r}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(g.c4.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(g.c4.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const n={apiId:g.WN.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};return"function"==typeof t.onRedirectNavigate?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,n))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),(0,f.Z_)(p.Si)}async handleCodeResponseFromHash(e,t,n,i){if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),!e)throw(0,f.Z_)(p.nF);this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),o=this.browserStorage.getTemporaryCache(r);if(!o)throw N.e.createStateNotFoundError("Cached State");let s;try{s=this.authModule.handleFragmentResponse(e,o)}catch(e){throw e instanceof M&&e.subError===p.h7?(0,f.Z_)(p.h7):e}const a=this.browserStorage.generateNonceKey(o),c=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=s.code,s.cloud_instance_host_name&&await this.updateTokenEndpointAuthority(s.cloud_instance_host_name,n,i),s.nonce=c||void 0,s.state=o,s.client_info)this.authCodeRequest.clientInfo=s.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const u=await this.authModule.acquireToken(this.authCodeRequest,s);return this.browserStorage.cleanRequestByState(t),u}}class Ze extends We{constructor(e,t,n,i,r,o,s,a,c,u){super(e,t,n,i,r,o,s,c,u),this.nativeStorage=a}async acquireToken(e){this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId);const t=await this.initializeAuthorizationRequest(e,g.s_.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||s.gT.EMPTY_STRING,t.account||null);const n=this.initializeServerTelemetryManager(g.WN.acquireTokenRedirect),o=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent("msal:restoreFromBFCache",g.s_.Redirect))};try{this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId);const r=await this.initializeAuthorizationCodeRequest(t);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,e.correlationId);const s=await this.createAuthCodeClient(n,t.authority,t.azureCloudOptions);this.logger.verbose("Auth code client created");const a=new Ye(s,this.browserStorage,r,this.logger,this.browserCrypto,this.performanceClient),c=await s.getAuthCodeUrl({...t,nativeBroker:Ve.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),u=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",o),await a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate})}catch(e){throw e instanceof r.l&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(t.state),e}}async handleRedirectPromise(e){const t=this.initializeServerTelemetryManager(g.WN.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.getRedirectResponseHash(e||window.location.hash);if(!n)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(g.s_.Redirect),null;let i;try{const e=H.getDeserializedHash(n);i=this.validateAndExtractStateFromHash(e,g.s_.Redirect),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info(`handleRedirectPromise was unable to extract state due to: ${e}`),this.browserStorage.cleanRequestByInteractionType(g.s_.Redirect),null}const r=this.browserStorage.getTemporaryCache(g.c4.ORIGIN_URI,!0)||s.gT.EMPTY_STRING;if(H.removeHashFromUrl(r)===H.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling hash");const e=await this.handleHash(n,i,t);return r.indexOf("#")>-1&&te.replaceHash(r),e}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),this.handleHash(n,i,t);if(!te.isInIframe()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(g.c4.URL_HASH,n,!0);const e={apiId:g.WN.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let o=!0;if(r&&"null"!==r)this.logger.verbose(`Navigating to loginRequestUrl: ${r}`),o=await this.navigationClient.navigateInternal(r,e);else{const t=te.getHomepage();this.browserStorage.setTemporaryCache(g.c4.ORIGIN_URI,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),o=await this.navigationClient.navigateInternal(t,e)}if(!o)return this.handleHash(n,i,t)}return null}catch(e){throw e instanceof r.l&&(e.setCorrelationId(this.correlationId),t.cacheFailedRequest(e)),this.browserStorage.cleanRequestByInteractionType(g.s_.Redirect),e}}getRedirectResponseHash(e){if(this.logger.verbose("getRedirectResponseHash called"),H.hashContainsKnownProperties(e))return te.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;const t=this.browserStorage.getTemporaryCache(g.c4.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(g.c4.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t}async handleHash(e,t,n){const r=this.browserStorage.getCachedRequest(t);this.logger.verbose("handleHash called, retrieved cached request");const o=H.getDeserializedHash(e);if(o.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw(0,f.Z_)(p.V7);const e=new Je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,g.WN.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,o.accountId,this.nativeStorage,r.correlationId),{userRequestState:n}=z.parseRequestState(this.browserCrypto,t);return e.acquireToken({...r,state:n,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(t)}))}const s=this.browserStorage.getCachedAuthority(t);if(!s)throw(0,f.Z_)(p.dT);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,r.correlationId);const a=await this.createAuthCodeClient(n,s);this.logger.verbose("Auth code client created"),me.removeThrottle(this.browserStorage,this.config.auth.clientId,r);const c=new Ye(a,this.browserStorage,r,this.logger,this.browserCrypto,this.performanceClient);return await c.handleCodeResponseFromHash(e,t,a.authority,this.networkClient)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(g.WN.logout);try{this.eventHandler.emitEvent(de,g.s_.Redirect,e),await this.clearCacheOnLogout(t.account);const r={apiId:g.WN.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1};this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,t.correlationId);const o=await this.createAuthCodeClient(n,e&&e.authority);if(this.logger.verbose("Auth code client created"),o.authority.protocolMode===ge.A.OIDC)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(he,g.s_.Redirect,t)}const s=o.getLogoutUri(t);if(this.eventHandler.emitEvent(he,g.s_.Redirect,t),!e||"function"!=typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(s,r);if(!1!==e.onRedirectNavigate(s))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(s,r);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof r.l&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),this.eventHandler.emitEvent(fe,g.s_.Redirect,null,e),this.eventHandler.emitEvent(pe,g.s_.Redirect),e}this.eventHandler.emitEvent(pe,g.s_.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return H.getAbsoluteUrl(t,te.getCurrentUri())}}var et=n(5980);class tt extends Qe{constructor(e,t,n,i,r,o){super(e,t,n,i,o),this.navigateFrameWait=r.navigateFrameWait,this.pollIntervalMilliseconds=r.pollIntervalMilliseconds}async initiateAuthRequest(e){if(this.performanceClient.addQueueMeasurement(i.Ak.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),!e)throw this.logger.info("Navigate url is empty"),(0,f.Z_)(p.Si);return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(i.Ak.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),await this.loadFrame(e)):this.loadFrameSync(e)}monitorIframeForHash(e,t){return this.performanceClient.addQueueMeasurement(i.Ak.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise(((n,i)=>{t<et.Is&&this.logger.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (${et.Is}ms). This may result in timeouts.`);const r=window.performance.now()+t,o=setInterval((()=>{if(window.performance.now()>r)return this.removeHiddenIframe(e),clearInterval(o),void i((0,f.Z_)(p.JA));let t=s.gT.EMPTY_STRING;const a=e.contentWindow;try{t=a?a.location.href:s.gT.EMPTY_STRING}catch(e){}if(!t||"about:blank"===t)return;const c=a?a.location.hash:s.gT.EMPTY_STRING;return c?H.hashContainsKnownProperties(c)?(this.removeHiddenIframe(e),clearInterval(o),void n(c)):(this.logger.error("SilentHandler:monitorIFrameForHash - a hash is present in the iframe but it does not contain known properties. It's likely that the hash has been replaced by code running on the redirectUri page."),this.logger.errorPii(`SilentHandler:monitorIFrameForHash - the url detected in the iframe is: ${t}`),this.removeHiddenIframe(e),clearInterval(o),void i((0,f.Z_)(p.S_))):(this.logger.error("SilentHandler:monitorIFrameForHash - the request has returned to the redirectUri but a hash is not present in the iframe. It's likely that the hash has been removed or the page has been redirected by code running on the redirectUri page."),this.logger.errorPii(`SilentHandler:monitorIFrameForHash - the url detected in the iframe is: ${t}`),this.removeHiddenIframe(e),clearInterval(o),void i((0,f.Z_)(p.nF)))}),this.pollIntervalMilliseconds)}))}loadFrame(e){return this.performanceClient.addQueueMeasurement(i.Ak.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise(((t,n)=>{const i=this.createHiddenIframe();setTimeout((()=>{i?(i.src=e,t(i)):n("Unable to load iframe")}),this.navigateFrameWait)}))}loadFrameSync(e){const t=this.createHiddenIframe();return t.src=e,t}createHiddenIframe(){const e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e}removeHiddenIframe(e){document.body===e.parentNode&&document.body.removeChild(e)}}class nt extends We{constructor(e,t,n,i,r,o,s,a,c,u,l){super(e,t,n,i,r,o,a,u,l),this.apiId=s,this.nativeStorage=c}async acquireToken(e){if(this.performanceClient.addQueueMeasurement(i.Ak.SilentIframeClientAcquireToken,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==s.NJ.NONE&&e.prompt!==s.NJ.NO_SESSION)throw(0,f.Z_)(p.WQ);const t=await E(this.initializeAuthorizationRequest.bind(this),i.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)({...e,prompt:e.prompt||s.NJ.NONE},g.s_.Silent);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||s.gT.EMPTY_STRING,t.account||null);const n=this.initializeServerTelemetryManager(this.apiId);try{const r=await E(this.createAuthCodeClient.bind(this),i.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)(n,t.authority,t.azureCloudOptions);return await E(this.silentTokenHelper.bind(this),i.Ak.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(r,t)}catch(e){throw e instanceof r.l&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),this.browserStorage.cleanRequestByState(t.state),e}}logout(){return Promise.reject((0,f.Z_)(p.I9))}async silentTokenHelper(e,t){this.performanceClient.addQueueMeasurement(i.Ak.SilentIframeClientTokenHelper,t.correlationId);const n=await E(this.initializeAuthorizationCodeRequest.bind(this),i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,t.correlationId)(t),r=await E(e.getAuthCodeUrl.bind(e),i.Ak.GetAuthCodeUrl,this.logger,this.performanceClient,t.correlationId)({...t,nativeBroker:Ve.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),o=new tt(e,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),a=await E(o.initiateAuthRequest.bind(o),i.Ak.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,t.correlationId)(r),c=await E(o.monitorIframeForHash.bind(o),i.Ak.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,t.correlationId)(a,this.config.system.iframeHashTimeout),u=H.getDeserializedHash(c),l=this.validateAndExtractStateFromHash(u,g.s_.Silent,n.correlationId);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw(0,f.Z_)(p.V7);const e=new Je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,this.correlationId),{userRequestState:n}=z.parseRequestState(this.browserCrypto,l);return E(e.acquireToken.bind(e),i.Ak.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,t.correlationId)({...t,state:n,prompt:t.prompt||s.NJ.NONE}).finally((()=>{this.browserStorage.cleanRequestByState(l)}))}return E(o.handleCodeResponseFromHash.bind(o),i.Ak.HandleCodeResponseFromHash,this.logger,this.performanceClient,t.correlationId)(c,l,e.authority,this.networkClient)}}class it extends We{async acquireToken(e){this.performanceClient.addQueueMeasurement(i.Ak.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(i.Ak.InitializeBaseRequest,e.correlationId);const t={...e,...await this.initializeBaseRequest(e,e.account)},n=this.performanceClient.startMeasurement(i.Ak.SilentRefreshClientAcquireToken,t.correlationId),r=this.initializeServerTelemetryManager(g.WN.acquireTokenSilent_silentFlow),o=await this.createRefreshTokenClient(r,t.authority,t.azureCloudOptions);return this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(i.Ak.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),o.acquireTokenByRefreshToken(t).then((e=>e)).then((e=>(n.end({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e))).catch((e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),n.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))}logout(){return Promise.reject((0,f.Z_)(p.I9))}async createRefreshTokenClient(e,t,n){this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientGetClientConfiguration,this.correlationId);const r=await this.getClientConfiguration(e,t,n);return new Ke(r,this.performanceClient)}}class rt{constructor(e,t,n,i){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=i}loadExternalTokens(e,t,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw(0,f.Z_)(p.Jd);const i=B.Z_(t.id_token,h);let r,o,s;if(e.account)s=U.r.createFromAccountInfo(e.account),r=new Q(s,this.loadIdToken(t.id_token,s.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,s.homeAccountId,e.account.environment,e.account.tenantId,n),this.loadRefreshToken(e,t,s.homeAccountId,e.account.environment));else{if(!e.authority)throw(0,f.Z_)(p.Jd);{const a=Fe.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(o=new Fe(a,this.config.system.networkClient,this.storage,c,this.logger),n.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),s=this.loadAccount(i,o,n.clientInfo),r=new Q(s,this.loadIdToken(t.id_token,s.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,s.homeAccountId,o.hostnameAndPort,o.tenant,n),this.loadRefreshToken(e,t,s.homeAccountId,o.hostnameAndPort));else{if(!t.client_info)throw(0,f.Z_)(p.Jd);this.logger.trace("TokenCache - homeAccountId from response"),s=this.loadAccount(i,o,t.client_info),r=new Q(s,this.loadIdToken(t.id_token,s.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,s.homeAccountId,o.hostnameAndPort,o.tenant,n),this.loadRefreshToken(e,t,s.homeAccountId,o.hostnameAndPort))}}}return this.generateAuthenticationResult(e,i,r,s,o)}loadAccount(e,t,n,i){let r;if(i?r=i:void 0!==t.authorityType&&n&&(r=U.r.generateHomeAccountId(n,t.authorityType,this.logger,this.cryptoObj,e)),!r)throw(0,f.Z_)(p.Jd);const o=U.r.createAccount({homeAccountId:r,idTokenClaims:e,clientInfo:n,environment:t.hostnameAndPort},t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(o),o;throw(0,f.Z_)(p.Jd)}loadIdToken(e,t,n,i){const r=x.createIdTokenEntity(t,n,e,this.config.auth.clientId,i);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(r),r;throw(0,f.Z_)(p.Jd)}loadAccessToken(e,t,n,i,r,o){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw(0,f.Z_)(p.Jd);if(!o.extendedExpiresOn)throw(0,f.Z_)(p.Jd);const s=new ke.i(e.scopes).printScopes(),a=o.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=o.extendedExpiresOn,u=L.createAccessTokenEntity(n,i,t.access_token,this.config.auth.clientId,r,s,a,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw(0,f.Z_)(p.Jd)}loadRefreshToken(e,t,n,i){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;const r=W.createRefreshTokenEntity(n,i,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(r),r;throw(0,f.Z_)(p.Jd)}generateAuthenticationResult(e,t,n,i,r){let o,a=s.gT.EMPTY_STRING,c=[],u=null;n?.accessToken&&(a=n.accessToken.secret,c=ke.i.fromString(n.accessToken.target).asArray(),u=new Date(1e3*Number(n.accessToken.expiresOn)),o=new Date(1e3*Number(n.accessToken.extendedExpiresOn)));const l=t.oid||t.sub||s.gT.EMPTY_STRING,d=t.tid||s.gT.EMPTY_STRING;return{authority:r?r.canonicalAuthority:s.gT.EMPTY_STRING,uniqueId:l,tenantId:d,scopes:c,account:i.getAccountInfo(),idToken:n.idToken?.secret||"",idTokenClaims:t||{},accessToken:a,fromCache:!0,expiresOn:u,correlationId:e.correlationId||s.gT.EMPTY_STRING,requestId:s.gT.EMPTY_STRING,extExpiresOn:o,familyId:s.gT.EMPTY_STRING,tokenType:n?.accessToken?.tokenType||s.gT.EMPTY_STRING,state:s.gT.EMPTY_STRING,cloudGraphHostName:i.cloudGraphHostName||s.gT.EMPTY_STRING,msGraphHost:i.msGraphHost||s.gT.EMPTY_STRING,code:void 0,fromNativeBroker:!1}}}class ot extends Ne{constructor(e){super(e),this.includeRedirectUri=!1}}class st extends We{constructor(e,t,n,i,r,o,s,a,c,u){super(e,t,n,i,r,o,a,c,u),this.apiId=s}async acquireToken(e){if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw(0,f.Z_)(p.Aj);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId);const t=await this.initializeAuthorizationRequest(e,g.s_.Silent);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||s.gT.EMPTY_STRING,t.account||null);const n=this.initializeServerTelemetryManager(this.apiId);try{const r={...t,code:e.code};this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientGetClientConfiguration,e.correlationId);const o=await this.getClientConfiguration(n,t.authority),s=new ot(o);return this.logger.verbose("Auth code client created"),new tt(s,this.browserStorage,r,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,s.authority,this.networkClient,!1)}catch(e){throw e instanceof r.l&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),this.browserStorage.cleanRequestByState(t.state),e}}logout(){return Promise.reject((0,f.Z_)(p.I9))}}class at{constructor(e){this.atsAsyncMeasurement=void 0,this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new A(this.logger,this.performanceClient):I.d,this.eventHandler=new ve(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new ee(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):((e,t)=>{const n={cacheLocation:g.Ix.MemoryStorage,temporaryCacheLocation:g.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new ee(e,n,I.d,t)})(this.config.auth.clientId,this.logger);const t={cacheLocation:g.Ix.MemoryStorage,temporaryCacheLocation:g.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new ee(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new rt(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e){const t=new at(e);return await t.initialize(),t}trackPageVisibility(){this.atsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.atsAsyncMeasurement.increment({visibilityChangeCount:1}))}async initialize(){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");const e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(i.Ak.InitializeClientApplication);if(this.eventHandler.emitEvent("msal:initializeStart"),e)try{this.nativeExtensionProvider=await Ve.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient,this.browserCrypto)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await E(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),i.Ak.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient)()),this.initialized=!0,this.eventHandler.emitEvent("msal:initializeEnd"),t.end({allowNativeBroker:e,success:!0})}async handleRedirectPromise(e){this.logger.verbose("handleRedirectPromise called"),te.blockAPICallsBeforeInitialize(this.initialized);let t=e;if(this.config.auth.OIDCOptions?.serverResponseType===s.rg.QUERY){const e=window.location.href;t=H.parseQueryServerResponse(e)}const n=this.getAllAccounts();if(this.isBrowserEnvironment){const e=t||s.gT.EMPTY_STRING;let i=this.redirectResponse.get(e);if(void 0===i){this.eventHandler.emitEvent("msal:handleRedirectStart",g.s_.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise");const r=this.browserStorage.getCachedNativeRequest();let o;if(r&&Ve.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t)this.logger.trace("handleRedirectPromise - acquiring token from native platform"),o=new Je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,g.WN.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId).handleRedirectPromise();else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const e=this.browserStorage.getTemporaryCache(g.c4.CORRELATION_ID,!0)||s.gT.EMPTY_STRING;o=this.createRedirectClient(e).handleRedirectPromise(t)}i=o.then((e=>(e&&(n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ie,g.s_.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(se,g.s_.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success"))),this.eventHandler.emitEvent(ue,g.s_.Redirect),e))).catch((e=>{throw n.length>0?this.eventHandler.emitEvent(ae,g.s_.Redirect,null,e):this.eventHandler.emitEvent(re,g.s_.Redirect,null,e),this.eventHandler.emitEvent(ue,g.s_.Redirect),e})),this.redirectResponse.set(e,i)}else this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call");return i}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(g.s_.Redirect);const n=this.getAllAccounts().length>0;let i;return n?this.eventHandler.emitEvent(oe,g.s_.Redirect,e):this.eventHandler.emitEvent(ne,g.s_.Redirect,e),i=this.nativeExtensionProvider&&this.canUseNative(e)?new Je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,g.WN.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireTokenRedirect(e).catch((t=>{if(t instanceof je&&t.isFatal())return this.nativeExtensionProvider=void 0,this.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof O.Yo)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(e.correlationId).acquireToken(e);throw this.getBrowserStorage().setInteractionInProgress(!1),t})):this.createRedirectClient(e.correlationId).acquireToken(e),i.catch((e=>{throw n?this.eventHandler.emitEvent(ae,g.s_.Redirect,null,e):this.eventHandler.emitEvent(re,g.s_.Redirect,null,e),e}))}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(i.Ak.AcquireTokenPopup,t);try{this.logger.verbose("acquireTokenPopup called",t),this.preflightBrowserEnvironmentCheck(g.s_.Popup)}catch(e){return Promise.reject(e)}const r=this.getAllAccounts();let o;return r.length>0?this.eventHandler.emitEvent(oe,g.s_.Popup,e):this.eventHandler.emitEvent(ne,g.s_.Popup,e),o=this.canUseNative(e)?this.acquireTokenNative(e,g.WN.acquireTokenPopup).then((e=>(this.getBrowserStorage().setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),e))).catch((t=>{if(t instanceof je&&t.isFatal())return this.nativeExtensionProvider=void 0,this.createPopupClient(e.correlationId).acquireToken(e);if(t instanceof O.Yo)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(e.correlationId).acquireToken(e);throw this.getBrowserStorage().setInteractionInProgress(!1),t})):this.createPopupClient(e.correlationId).acquireToken(e),o.then((e=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ie,g.s_.Popup,e):this.eventHandler.emitEvent(se,g.s_.Popup,e),n.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.end({success:!0,requestId:e.requestId}),e))).catch((e=>(r.length>0?this.eventHandler.emitEvent(ae,g.s_.Popup,null,e):this.eventHandler.emitEvent(re,g.s_.Popup,null,e),n.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e))))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:t};let r;return this.preflightBrowserEnvironmentCheck(g.s_.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(i.Ak.SsoSilent,t),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent("msal:ssoSilentStart",g.s_.Silent,n),r=this.canUseNative(n)?this.acquireTokenNative(n,g.WN.ssoSilent).catch((e=>{if(e instanceof je&&e.isFatal())return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):this.createSilentIframeClient(n.correlationId).acquireToken(n),r.then((e=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",g.s_.Silent,e),this.ssoSilentMeasurement?.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",g.s_.Silent,null,e),this.ssoSilentMeasurement?.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(g.s_.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",g.s_.Silent,e);const n=this.performanceClient.startMeasurement(i.Ak.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw(0,f.Z_)(p.LL);if(e.code){const i=e.code;let r=this.hybridAuthCodeResponses.get(i);return r?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),r=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",g.s_.Silent,e),this.hybridAuthCodeResponses.delete(i),n.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(i),this.eventHandler.emitEvent(ce,g.s_.Silent,null,e),n.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(i,r)),r}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return this.acquireTokenNative(e,g.WN.acquireTokenByCode,e.nativeAccountId).catch((e=>{throw e instanceof je&&e.isFatal()&&(this.nativeExtensionProvider=void 0),e}));throw(0,f.Z_)(p.KA)}throw(0,f.Z_)(p.Dy)}catch(e){throw this.eventHandler.emitEvent(ce,g.s_.Silent,null,e),n.end({errorCode:e instanceof r.l&&e.errorCode||void 0,subErrorCode:e instanceof r.l&&e.subError||void 0,success:!1}),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(i.Ak.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t,n){switch(this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenFromCache,t.correlationId),n.cacheLookupPolicy){case g.lu.Default:case g.lu.AccessToken:case g.lu.AccessTokenAndRefreshToken:return e.acquireToken(t);default:throw N.e.createRefreshRequiredError()}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case g.lu.Default:case g.lu.AccessTokenAndRefreshToken:case g.lu.RefreshToken:case g.lu.RefreshTokenAndNetwork:const t=this.createSilentRefreshClient(e.correlationId);return this.performanceClient.setPreQueueTime(i.Ak.SilentRefreshClientAcquireToken,e.correlationId),t.acquireToken(e);default:throw N.e.createRefreshRequiredError()}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return E(t.acquireToken.bind(t),i.Ak.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(g.s_.Redirect),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(g.s_.Popup),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}}async clearCache(e){const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]}getAccountByUsername(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)}getAccountByHomeId(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)}getAccountByLocalId(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)}setActiveAccount(e){this.browserStorage.setActiveAccount(e)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=U.r.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}preflightBrowserEnvironmentCheck(e,t=!1){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),te.blockNonBrowserEnvironment(this.isBrowserEnvironment),te.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),te.blockReloadInHiddenIframes(),te.blockAcquireTokenInPopups(),te.blockAPICallsBeforeInitialize(this.initialized),e===g.s_.Redirect&&this.config.cache.cacheLocation===g.Ix.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw X.createInMemoryRedirectUnavailableError();e!==g.s_.Redirect&&e!==g.s_.Popup||this.preflightInteractiveRequest(!t)}preflightInteractiveRequest(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),te.blockReloadInHiddenIframes(),e&&this.getBrowserStorage().setInteractionInProgress(!0)}async acquireTokenNative(e,t,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw(0,f.Z_)(p.V7);return new Je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Ve.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case s.NJ.NONE:case s.NJ.CONSENT:case s.NJ.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Xe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Ze(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new nt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,g.WN.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new $e(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new it(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new st(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,g.WN.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}getBrowserStorage(){return this.browserStorage}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():s.gT.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||g.yo})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||g.yo})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(i.Ak.AcquireTokenSilent,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(g.s_.Silent),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw(0,f.Z_)(p.wH);const o={clientId:this.config.auth.clientId,authority:e.authority||s.gT.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:r.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},a=JSON.stringify(o),c=this.activeSilentTokenRequests.get(a);if(void 0===c){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(i.Ak.AcquireTokenSilentAsync,t);const o=this.acquireTokenSilentAsync({...e,correlationId:t},r).then((t=>(this.activeSilentTokenRequests.delete(a),n.add({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),n.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t))).catch((e=>{throw this.activeSilentTokenRequests.delete(a),n.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}));return this.activeSilentTokenRequests.set(a,o),o}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),c}async acquireTokenSilentAsync(e,t){let n;if(this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(oe,g.s_.Silent,e),this.atsAsyncMeasurement=this.performanceClient.startMeasurement(i.Ak.AcquireTokenSilentAsync,e.correlationId),this.atsAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),Ve.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId){this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform");const i={...e,account:t};n=this.acquireTokenNative(i,g.WN.acquireTokenSilent_silentFlow).catch((async t=>{if(t instanceof je&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,this.createSilentIframeClient(e.correlationId).acquireToken(e);throw t}))}else{this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow");const r=this.createSilentCacheClient(e.correlationId);this.performanceClient.setPreQueueTime(i.Ak.InitializeSilentRequest,e.correlationId);const o=await r.initializeSilentRequest(e,t),s={...e,cacheLookupPolicy:e.cacheLookupPolicy||g.lu.Default};this.performanceClient.setPreQueueTime(i.Ak.AcquireTokenFromCache,o.correlationId),n=this.acquireTokenFromCache(r,o,s).catch((t=>{if(s.cacheLookupPolicy===g.lu.AccessToken)throw t;return te.blockReloadInHiddenIframes(),this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",g.s_.Silent,o),this.performanceClient.setPreQueueTime(i.Ak.AcquireTokenByRefreshToken,o.correlationId),this.acquireTokenByRefreshToken(o,s).catch((t=>{const n=t instanceof M,r=t instanceof O.Yo,a=t.errorCode===g.qx.INVALID_GRANT_ERROR;if((!n||!a||r||s.cacheLookupPolicy===g.lu.AccessTokenAndRefreshToken||s.cacheLookupPolicy===g.lu.RefreshToken)&&s.cacheLookupPolicy!==g.lu.Skip)throw t;return this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),this.performanceClient.setPreQueueTime(i.Ak.AcquireTokenBySilentIframe,o.correlationId),this.acquireTokenBySilentIframe(o)}))}))}return n.then((e=>(this.eventHandler.emitEvent(se,g.s_.Silent,e),this.atsAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.eventHandler.emitEvent(ae,g.s_.Silent,null,e),this.atsAsyncMeasurement?.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibility)}))}}},1416:(e,t,n)=>{"use strict";n.d(t,{Ut:()=>a,Z_:()=>c});var i=n(4696),r=n(913);const o="For more visit: aka.ms/msaljs/browser-errors",s={[r.vD]:"The PKCE code challenge and verifier could not be generated.",[r.TR]:"The crypto object or function is not available.",[r.Si]:"Navigation URI is empty. Please check stack trace for more info.",[r.nF]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${o}`,[r.Xk]:"Hash does not contain state. Please verify that the request originated from msal.",[r.S_]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${o}`,[r.$P]:"Unable to parse state. Please verify that the request originated from msal.",[r.yK]:"Hash contains state but the interaction type does not match the caller.",[r.Ck]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${o}`,[r.E]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[r.H]:"window.open returned null or undefined window object.",[r.h7]:"User cancelled the flow.",[r.ZT]:`Token acquisition in popup failed due to timeout.  ${o}`,[r.JA]:`Token acquisition in iframe failed due to timeout.  ${o}`,[r.b_]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[r.xO]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${o}`,[r.bj]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[r.h8]:"The iframe being monitored was closed prematurely.",[r.I9]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[r.wH]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[r.WQ]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[r.QO]:"No token request found in cache.",[r.e$]:"The cached token request could not be parsed.",[r.dT]:"No cached authority found.",[r.BO]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[r.Ut]:"Invalid cache type",[r.Dx]:"Login and token requests are not supported in non-browser environments.",[r.IL]:"Database is not open!",[r.Mq]:"No network connectivity. Check your internet connection.",[r.Dc]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[r.C8]:"Network request failed. Please check the network trace to determine root cause.",[r.w6]:"Failed to parse network response. Check network trace.",[r.Jd]:"Error loading token to cache.",[r.XM]:"Cryptographic Key or Keypair not found in browser storage.",[r.Aj]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[r.Dy]:"An authorization code or nativeAccountId must be provided to this flow.",[r.LL]:"Request cannot contain both spa code and native account id.",[r.Pi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[r.KA]:`Unable to acquire token from native platform.  ${o}`,[r.hR]:"Timed out while attempting to establish connection to browser extension",[r.Wb]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[r.V7]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${o}`,[r.al]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${o}`,[r.o9]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."};r.vD,r.vD,r.TR,r.TR,r.Si,r.Si,r.nF,r.nF,r.Xk,r.Xk,r.S_,r.S_,r.$P,r.$P,r.yK,r.yK,r.Ck,r.Ck,r.E,r.E,r.H,r.H,r.h7,r.h7,r.ZT,r.ZT,r.JA,r.JA,r.b_,r.b_,r.xO,r.xO,r.bj,r.bj,r.h8,r.h8,r.I9,r.I9,r.wH,r.wH,r.WQ,r.WQ,r.QO,r.QO,r.e$,r.e$,r.dT,r.dT,r.BO,r.BO,r.Ut,r.Ut,r.Dx,r.Dx,r.IL,r.IL,r.Mq,r.Mq,r.Dc,r.Dc,r.C8,r.C8,r.w6,r.w6,r.Jd,r.Jd,r.XM,r.XM,r.Aj,r.Aj,r.Dy,r.Dy,r.LL,r.LL,r.Pi,r.Pi,r.KA,r.KA,r.hR,r.hR,r.Wb,r.Wb,r.V7,r.V7,r.al,r.al,r.o9,r.o9;class a extends i.l{constructor(e){super(e,s[e]),Object.setPrototypeOf(this,a.prototype),this.name="BrowserAuthError"}}function c(e){return new a(e)}},913:(e,t,n)=>{"use strict";n.d(t,{$P:()=>u,Aj:()=>F,BO:()=>I,C8:()=>O,Ck:()=>d,Dc:()=>H,Dx:()=>R,Dy:()=>x,E:()=>h,H:()=>f,I9:()=>C,IL:()=>N,JA:()=>m,Jd:()=>M,KA:()=>L,LL:()=>q,Mq:()=>P,Pi:()=>B,QO:()=>b,S_:()=>c,TR:()=>r,Ut:()=>E,V7:()=>K,WQ:()=>k,Wb:()=>j,XM:()=>D,Xk:()=>a,ZT:()=>v,Si:()=>o,al:()=>G,b_:()=>g,bj:()=>y,dT:()=>A,e$:()=>T,h7:()=>p,h8:()=>_,hR:()=>W,nF:()=>s,o9:()=>$,vD:()=>i,w6:()=>U,wH:()=>S,xO:()=>w,yK:()=>l});const i="pkce_not_created",r="crypto_nonexistent",o="empty_navigate_uri",s="hash_empty_error",a="no_state_in_hash",c="hash_does_not_contain_known_properties",u="unable_to_parse_state",l="state_interaction_type_mismatch",d="interaction_in_progress",h="popup_window_error",f="empty_window_error",p="user_cancelled",v="monitor_popup_timeout",m="monitor_window_timeout",g="redirect_in_iframe",w="block_iframe_reload",y="block_nested_popups",_="iframe_closed_prematurely",C="silent_logout_unsupported",S="no_account_error",k="silent_prompt_value_error",b="no_token_request_cache_error",T="unable_to_parse_token_request_cache_error",A="no_cached_authority_error",I="auth_request_not_set_error",E="invalid_cache_type",R="non_browser_environment",N="database_not_open",P="no_network_connectivity",H="post_request_failed",O="get_request_failed",U="failed_to_parse_response",M="unable_to_load_token",D="crypto_key_not_found",F="auth_code_required",x="auth_code_or_nativeAccountId_required",q="spa_code_and_nativeAccountId_present",B="database_unavailable",L="unable_to_acquire_token_from_native_platform",W="native_handshake_timeout",j="native_extension_not_installed",K="native_connection_not_established",G="uninitialized_public_client_application",$="native_prompt_not_supported"},1464:(e,t,n)=>{"use strict";n.d(t,{i:()=>r,u:()=>i});const i="@azure/msal-browser",r="3.1.0"},7237:(e,t,n)=>{"use strict";n.d(t,{BD:()=>o,Bs:()=>d,EC:()=>c,Gv:()=>w,H4:()=>m,Ix:()=>a,Ky:()=>s,Mm:()=>v,Oq:()=>l,WN:()=>h,c4:()=>u,kd:()=>g,lu:()=>y,qx:()=>r,s_:()=>f,yo:()=>p});var i=n(9930);const r={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},o={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},s={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},a={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},c={GET:"GET",POST:"POST"},u={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},l={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},d={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},h={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var f;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(f||(f={}));const p={scopes:i.f_},v="jwk",m="msal.db",g=1,w=`${m}.keys`,y={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5}},9362:(e,t,n)=>{"use strict";n.d(t,{Z_:()=>r,ky:()=>o});var i=n(5536);function r(e,t){const n=function(e){if(!e)throw i.e.createTokenNullOrEmptyError(e);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw i.e.createTokenParsingError(`Given token is malformed: ${JSON.stringify(e)}`);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(e){throw i.e.createTokenParsingError(e)}}function o(e,t){if(0===t||Date.now()-3e5>e+t)throw i.e.createMaxAgeTranspiredError()}},5263:(e,t,n)=>{"use strict";n.d(t,{B:()=>o,j:()=>s});var i=n(5536),r=n(9930);function o(e,t){if(!e)throw i.e.createClientInfoEmptyError();try{const n=t.base64Decode(e);return JSON.parse(n)}catch(e){throw i.e.createClientInfoDecodingError(e.message)}}function s(e){if(!e)throw i.e.createClientInfoDecodingError("Home account ID was empty.");const t=e.split(r.Bv.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?r.gT.EMPTY_STRING:t[1]}}},9744:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"}},3570:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i={Default:0,Adfs:1,Dsts:2,Ciam:3}},5760:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i={AAD:"AAD",OIDC:"OIDC"}},8939:(e,t,n)=>{"use strict";n.d(t,{L:()=>l,w:()=>d});var i=n(9930),r=n(2480),o=n(6919),s=n(4696),a=n(5536),c=n(9362),u=n(7678);class l{constructor(e,t,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(u.u,u.i)}getAllAccounts(){const e=this.getAccountKeys();if(e.length<1)return[];const t=e.reduce(((e,t)=>{const n=this.getAccount(t);return n?(e.push(n),e):e}),[]);return t.length<1?[]:t.map((e=>this.getAccountInfoFromEntity(e)))}getAccountInfoFilteredBy(e){const t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null}getAccountInfoFromEntity(e){const t=e.getAccountInfo(),n=this.getIdToken(t);return n&&(t.idToken=n.secret,t.idTokenClaims=(0,c.Z_)(n.secret,this.cryptoImpl.base64Decode)),t}async saveCacheRecord(e,t){if(!e)throw a.e.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&!1!==t?.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&!1!==t?.accessToken&&await this.saveAccessToken(e.accessToken),e.refreshToken&&!1!==t?.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),i=r.i.fromString(e.target),o=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!1))return;const n=this.getAccessTokenCredential(e);n&&this.credentialMatchesFilter(n,t)&&r.i.fromString(n.target).intersectingScopeSets(i)&&o.push(this.removeAccessToken(e))})),await Promise.all(o),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),n=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId,e.realm))return;const i=this.getAccount(t);i&&(e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.localAccountId&&!this.matchLocalAccountId(i,e.localAccountId)||e.username&&!this.matchUsername(i,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||n.push(i))})),n}isAccountKey(e,t,n){return!(e.split(i.Bv.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(i.Bv.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(i.d3.ID_TOKEN.toLowerCase())&&-1===t.indexOf(i.d3.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(i.d3.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(i.d3.REFRESH_TOKEN.toLowerCase())>-1){const e=`${i.d3.REFRESH_TOKEN}${i.Bv.CACHE_KEY_SEPARATOR}${this.clientId}${i.Bv.CACHE_KEY_SEPARATOR}`,n=`${i.d3.REFRESH_TOKEN}${i.Bv.CACHE_KEY_SEPARATOR}${i.ch}${i.Bv.CACHE_KEY_SEPARATOR}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===i.hO.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)}getAppMetadataFilteredByInternal(e,t){const n=this.getKeys(),i={};return n.forEach((n=>{if(!this.isAppMetadata(n))return;const r=this.getAppMetadata(n);r&&(e&&!this.matchEnvironment(r,e)||t&&!this.matchClientId(r,t)||(i[n]=r))})),i}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const i=this.getAuthorityMetadata(t);i&&-1!==i.aliases.indexOf(e)&&(n=i)})),n}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),n=e.generateAccountId(),i=[];t.idToken.forEach((e=>{0===e.indexOf(n)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(n)&&i.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(n)&&this.removeRefreshToken(e)})),await Promise.all(i)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===i.hO.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw a.e.createBindingKeyNotRemovedError()}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readCacheRecord(e,t,n){const i=this.getTokenKeys(),r=this.readAccountFromCache(e),o=this.getIdToken(e,i),s=this.getAccessToken(e,t,i),a=this.getRefreshToken(e,!1,i),u=this.readAppMetadataFromCache(n);return r&&o&&(r.idTokenClaims=(0,c.Z_)(o.secret,this.cryptoImpl.base64Decode)),{account:r,idToken:o,accessToken:s,refreshToken:a,appMetadata:u}}readAccountFromCache(e){const t=o.r.generateAccountCacheKey(e);return this.getAccount(t)}getIdToken(e,t){this.commonLogger.trace("CacheManager - getIdToken called");const n={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:i.d3.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},r=this.getIdTokensByFilter(n,t),o=r.length;return o<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):o>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),r.forEach((e=>{this.removeIdToken(e.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),r[0])}getIdTokensByFilter(e,t){const n=t&&t.idToken||this.getTokenKeys().idToken,i=[];return n.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const n=this.getIdTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&i.push(n)})),i}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return!(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n){this.commonLogger.trace("CacheManager - getAccessToken called");const o=r.i.createSearchScopes(t.scopes),s=t.authenticationScheme||i.hO.BEARER,a=s&&s.toLowerCase()!==i.hO.BEARER.toLowerCase()?i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:i.d3.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:e.tenantId,target:o,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,l=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,c,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,c)&&l.push(t)}}));const d=l.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),l.forEach((e=>{this.removeAccessToken(e.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),l[0])}accessTokenKeyMatchesFilter(e,t,n){const i=e.toLowerCase();if(t.clientId&&-1===i.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===i.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===i.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===i.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!i.includes(e[t].toLowerCase()))return!1;if(!n&&i.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),n=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const i=this.getAccessTokenCredential(t);i&&this.credentialMatchesFilter(i,e)&&n.push(i)})),n}getRefreshToken(e,t,n){this.commonLogger.trace("CacheManager - getRefreshToken called");const r=t?i.ch:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:i.d3.REFRESH_TOKEN,clientId:this.clientId,familyId:r},s=n&&n.refreshToken||this.getTokenKeys().refreshToken,a=[];return s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,o)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,o)&&a.push(t)}})),a.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),a[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return!(t.familyId&&-1===n.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),i=Object.keys(n).map((e=>n[e])),r=i.length;if(r<1)return null;if(r>1)throw a.e.createMultipleMatchingAppMetadataInCacheError();return i[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==i.ch)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountId(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)}matchUsername(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(!e.realm||t!==e.realm)}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchTarget(e,t){return!(e.credentialType!==i.d3.ACCESS_TOKEN&&e.credentialType!==i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&r.i.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(i.dg)}isAuthorityMetadata(e){return-1!==e.indexOf(i.QU.CACHE_KEY)}generateAuthorityMetadataCacheKey(e){return`${i.QU.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class d extends l{setAccount(){throw s.l.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")}getAccount(){throw s.l.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")}setIdTokenCredential(){throw s.l.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")}getIdTokenCredential(){throw s.l.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")}setAccessTokenCredential(){throw s.l.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")}getAccessTokenCredential(){throw s.l.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")}setRefreshTokenCredential(){throw s.l.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")}getRefreshTokenCredential(){throw s.l.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")}setAppMetadata(){throw s.l.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")}getAppMetadata(){throw s.l.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")}setServerTelemetry(){throw s.l.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")}getServerTelemetry(){throw s.l.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")}setAuthorityMetadata(){throw s.l.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")}getAuthorityMetadata(){throw s.l.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")}getAuthorityMetadataKeys(){throw s.l.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")}setThrottlingCache(){throw s.l.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")}getThrottlingCache(){throw s.l.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")}removeItem(){throw s.l.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")}containsKey(){throw s.l.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")}getKeys(){throw s.l.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")}getAccountKeys(){throw s.l.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")}getTokenKeys(){throw s.l.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")}async clear(){throw s.l.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}updateCredentialCacheKey(){throw s.l.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")}}},6919:(e,t,n)=>{"use strict";n.d(t,{r:()=>c});var i=n(9930),r=n(5263),o=n(5536),s=n(3570),a=n(5760);class c{generateAccountId(){return[this.homeAccountId,this.environment].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return c.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType}}static generateAccountCacheKey(e){return[e.homeAccountId,e.environment||i.gT.EMPTY_STRING,e.tenantId||i.gT.EMPTY_STRING].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t){const n=new c;t.authorityType===s.a.Adfs?n.authorityType=i.iR.ADFS_ACCOUNT_TYPE:t.protocolMode===a.A.AAD?n.authorityType=i.iR.MSSTS_ACCOUNT_TYPE:n.authorityType=i.iR.GENERIC_ACCOUNT_TYPE,n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const r=e.environment||t&&t.getPreferredCache();if(!r)throw o.e.createInvalidCacheEnvironmentError();n.environment=r,n.realm=e.idTokenClaims.tid||i.gT.EMPTY_STRING,n.idTokenClaims=e.idTokenClaims,n.localAccountId=e.idTokenClaims.oid||e.idTokenClaims.sub||i.gT.EMPTY_STRING;const u=e.idTokenClaims.preferred_username||e.idTokenClaims.upn,l=e.idTokenClaims.emails?e.idTokenClaims.emails[0]:null;return n.username=u||l||i.gT.EMPTY_STRING,n.name=e.idTokenClaims.name,n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,n}static createFromAccountInfo(e,t,n){const r=new c;return r.authorityType=e.authorityType||i.iR.GENERIC_ACCOUNT_TYPE,r.homeAccountId=e.homeAccountId,r.localAccountId=e.localAccountId,r.nativeAccountId=e.nativeAccountId,r.realm=e.tenantId,r.environment=e.environment,r.username=e.username,r.name=e.name,r.idTokenClaims=e.idTokenClaims,r.cloudGraphHostName=t,r.msGraphHost=n,r}static generateHomeAccountId(e,t,n,o,a){const c=a?.sub?a.sub:i.gT.EMPTY_STRING;if(t===s.a.Adfs||t===s.a.Dsts)return c;if(e)try{const t=(0,r.B)(e,o);if(t.uid&&t.utid)return`${t.uid}${i.Bv.CLIENT_INFO_SEPARATOR}${t.utid}`}catch(e){}return n.verbose("No client info in response"),c}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let i=!0;if(n){const n=e.idTokenClaims||{},r=t.idTokenClaims||{};i=n.iat===r.iat&&n.nonce===r.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i}}},3697:(e,t,n)=>{"use strict";n.d(t,{j6:()=>y,lh:()=>_,z:()=>d});var i=n(669),r=n(4696),o=n(7593),s=n(9930),a=n(7678),c=n(9744),u=n(8939),l=n(5760);const d={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},h={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:o.i.Info,correlationId:s.gT.EMPTY_STRING},f={claimsBasedCachingEnabled:!1},p={async sendGetRequestAsync(){throw r.l.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")},async sendPostRequestAsync(){throw r.l.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}},v={sku:s.gT.SKU,version:a.i,cpu:s.gT.EMPTY_STRING,os:s.gT.EMPTY_STRING},m={clientSecret:s.gT.EMPTY_STRING,clientAssertion:void 0},g={azureCloudInstance:c.z.None,tenant:`${s.gT.DEFAULT_COMMON_TENANT}`},w={application:{appName:"",appVersion:""}};function y({authOptions:e,systemOptions:t,loggerOptions:n,cacheOptions:r,storageInterface:s,networkInterface:a,cryptoInterface:c,clientCredentials:l,libraryInfo:y,telemetry:_,serverTelemetryManager:C,persistencePlugin:S,serializableCache:k}){const b={...h,...n};return{authOptions:(T=e,{clientCapabilities:[],azureCloudOptions:g,skipAuthorityMetadataCache:!1,...T}),systemOptions:{...d,...t},loggerOptions:b,cacheOptions:{...f,...r},storageInterface:s||new u.w(e.clientId,i.d,new o.Y(b)),networkInterface:a||p,cryptoInterface:c||i.d,clientCredentials:l||m,libraryInfo:{...v,...y},telemetry:{...w,..._},serverTelemetryManager:C||null,persistencePlugin:S||null,serializableCache:k||null};var T}function _(e){return e.authOptions.authority.options.protocolMode===l.A.OIDC}},669:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var i=n(4696);const r={createNewGuid:()=>{throw i.l.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:()=>{throw i.l.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:()=>{throw i.l.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},async generatePkceCodes(){throw i.l.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")},async getPublicKeyThumbprint(){throw i.l.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")},async removeTokenBindingKey(){throw i.l.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")},async clearKeystore(){throw i.l.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")},async signJwt(){throw i.l.createUnexpectedError("Crypto interface - signJwt() has not been implemented")},async hashString(){throw i.l.createUnexpectedError("Crypto interface - hashString() has not been implemented")}}},4696:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(9930);class r extends Error{constructor(e,t,n){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||i.gT.EMPTY_STRING,this.errorMessage=t||i.gT.EMPTY_STRING,this.subError=n||i.gT.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}static createUnexpectedError(e){return new r("unexpected_error",`Unexpected error in authentication.: ${e}`)}static createPostRequestFailed(e){return new r("post_request_failed",`Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details.: ${e}`)}}},5536:(e,t,n)=>{"use strict";n.d(t,{A:()=>r,e:()=>o});var i=n(4696);const r={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."},missingTenantIdError:{code:"missing_tenant_id_error",desc:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow."}};class o extends i.l{constructor(e,t){super(e,t),this.name="ClientAuthError",Object.setPrototypeOf(this,o.prototype)}static createClientInfoDecodingError(e){return new o(r.clientInfoDecodingError.code,`${r.clientInfoDecodingError.desc} Failed with error: ${e}`)}static createClientInfoEmptyError(){return new o(r.clientInfoEmptyError.code,`${r.clientInfoEmptyError.desc}`)}static createTokenParsingError(e){return new o(r.tokenParsingError.code,`${r.tokenParsingError.desc} Failed with error: ${e}`)}static createTokenNullOrEmptyError(e){return new o(r.nullOrEmptyToken.code,`${r.nullOrEmptyToken.desc} Raw Token Value: ${e}`)}static createEndpointDiscoveryIncompleteError(e){return new o(r.endpointResolutionError.code,`${r.endpointResolutionError.desc} Detail: ${e}`)}static createNetworkError(e,t){return new o(r.networkError.code,`${r.networkError.desc} | Fetch client threw: ${t} | Attempted to reach: ${e.split("?")[0]}`)}static createUnableToGetOpenidConfigError(e){return new o(r.unableToGetOpenidConfigError.code,`${r.unableToGetOpenidConfigError.desc} Attempted to retrieve endpoints from: ${e}`)}static createHashNotDeserializedError(e){return new o(r.hashNotDeserialized.code,`${r.hashNotDeserialized.desc} Given Object: ${e}`)}static createInvalidStateError(e,t){return new o(r.invalidStateError.code,`${r.invalidStateError.desc} Invalid State: ${e}, Root Err: ${t}`)}static createStateMismatchError(){return new o(r.stateMismatchError.code,r.stateMismatchError.desc)}static createStateNotFoundError(e){return new o(r.stateNotFoundError.code,`${r.stateNotFoundError.desc}:  ${e}`)}static createNonceMismatchError(){return new o(r.nonceMismatchError.code,r.nonceMismatchError.desc)}static createAuthTimeNotFoundError(){return new o(r.authTimeNotFoundError.code,r.authTimeNotFoundError.desc)}static createMaxAgeTranspiredError(){return new o(r.maxAgeTranspiredError.code,r.maxAgeTranspiredError.desc)}static createNonceNotFoundError(e){return new o(r.nonceNotFoundError.code,`${r.nonceNotFoundError.desc}:  ${e}`)}static createMultipleMatchingTokensInCacheError(){return new o(r.multipleMatchingTokens.code,`${r.multipleMatchingTokens.desc}.`)}static createMultipleMatchingAccountsInCacheError(){return new o(r.multipleMatchingAccounts.code,r.multipleMatchingAccounts.desc)}static createMultipleMatchingAppMetadataInCacheError(){return new o(r.multipleMatchingAppMetadata.code,r.multipleMatchingAppMetadata.desc)}static createTokenRequestCannotBeMadeError(){return new o(r.tokenRequestCannotBeMade.code,r.tokenRequestCannotBeMade.desc)}static createAppendEmptyScopeToSetError(e){return new o(r.appendEmptyScopeError.code,`${r.appendEmptyScopeError.desc} Given Scope: ${e}`)}static createRemoveEmptyScopeFromSetError(e){return new o(r.removeEmptyScopeError.code,`${r.removeEmptyScopeError.desc} Given Scope: ${e}`)}static createAppendScopeSetError(e){return new o(r.appendScopeSetError.code,`${r.appendScopeSetError.desc} Detail Error: ${e}`)}static createEmptyInputScopeSetError(){return new o(r.emptyInputScopeSetError.code,`${r.emptyInputScopeSetError.desc}`)}static createDeviceCodeCancelledError(){return new o(r.DeviceCodePollingCancelled.code,`${r.DeviceCodePollingCancelled.desc}`)}static createDeviceCodeExpiredError(){return new o(r.DeviceCodeExpired.code,`${r.DeviceCodeExpired.desc}`)}static createDeviceCodeUnknownError(){return new o(r.DeviceCodeUnknownError.code,`${r.DeviceCodeUnknownError.desc}`)}static createNoAccountInSilentRequestError(){return new o(r.NoAccountInSilentRequest.code,`${r.NoAccountInSilentRequest.desc}`)}static createNullOrUndefinedCacheRecord(){return new o(r.invalidCacheRecord.code,r.invalidCacheRecord.desc)}static createInvalidCacheEnvironmentError(){return new o(r.invalidCacheEnvironment.code,r.invalidCacheEnvironment.desc)}static createNoAccountFoundError(){return new o(r.noAccountFound.code,r.noAccountFound.desc)}static createCachePluginError(){return new o(r.CachePluginError.code,`${r.CachePluginError.desc}`)}static createNoCryptoObjectError(e){return new o(r.noCryptoObj.code,`${r.noCryptoObj.desc}${e}`)}static createInvalidCacheTypeError(){return new o(r.invalidCacheType.code,`${r.invalidCacheType.desc}`)}static createUnexpectedAccountTypeError(){return new o(r.unexpectedAccountType.code,`${r.unexpectedAccountType.desc}`)}static createUnexpectedCredentialTypeError(){return new o(r.unexpectedCredentialType.code,`${r.unexpectedCredentialType.desc}`)}static createInvalidAssertionError(){return new o(r.invalidAssertion.code,`${r.invalidAssertion.desc}`)}static createInvalidCredentialError(){return new o(r.invalidClientCredential.code,`${r.invalidClientCredential.desc}`)}static createRefreshRequiredError(){return new o(r.tokenRefreshRequired.code,r.tokenRefreshRequired.desc)}static createUserTimeoutReachedError(){return new o(r.userTimeoutReached.code,r.userTimeoutReached.desc)}static createTokenClaimsRequiredError(){return new o(r.tokenClaimsRequired.code,r.tokenClaimsRequired.desc)}static createNoAuthCodeInServerResponseError(){return new o(r.noAuthorizationCodeFromServer.code,r.noAuthorizationCodeFromServer.desc)}static createBindingKeyNotRemovedError(){return new o(r.bindingKeyNotRemovedError.code,r.bindingKeyNotRemovedError.desc)}static createLogoutNotSupportedError(){return new o(r.logoutNotSupported.code,r.logoutNotSupported.desc)}static createKeyIdMissingError(){return new o(r.keyIdMissing.code,r.keyIdMissing.desc)}static createNoNetworkConnectivityError(){return new o(r.noNetworkConnectivity.code,r.noNetworkConnectivity.desc)}static createUserCanceledError(){return new o(r.userCanceledError.code,r.userCanceledError.desc)}static createMissingTenantIdError(){return new i.l(r.missingTenantIdError.code,r.missingTenantIdError.desc)}}},8207:(e,t,n)=>{"use strict";n.d(t,{r:()=>r});var i=n(5536);class r extends i.e{constructor(e,t){super(e,t),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}static createRedirectUriEmptyError(){return new r("redirect_uri_empty","A redirect URI is required for all calls, and none has been set.")}static createPostLogoutRedirectUriEmptyError(){return new r("post_logout_uri_empty","A post logout redirect has not been set.")}static createClaimsRequestParsingError(e){return new r("claims_request_parsing_error",`Could not parse the given claims request object. Given value: ${e}`)}static createInsecureAuthorityUriError(e){return new r("authority_uri_insecure",`Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options Given URI: ${e}`)}static createUrlParseError(e){return new r("url_parse_error",`URL could not be parsed into appropriate segments. Given Error: ${e}`)}static createUrlEmptyError(){return new r("empty_url_error","URL was empty or null.")}static createEmptyScopesArrayError(){return new r("empty_input_scopes_error","Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.")}static createClientIdSingleScopeError(e){return new r("clientid_input_scopes_error",`Client ID can only be provided as a single scope. Given Scopes: ${e}`)}static createInvalidPromptError(e){return new r("invalid_prompt_value",`Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest Given value: ${e}`)}static createInvalidClaimsRequestError(){return new r("invalid_claims","Given claims parameter must be a stringified JSON object.")}static createEmptyLogoutRequestError(){return new r("logout_request_empty","The logout request was null or undefined.")}static createEmptyTokenRequestError(){return new r("token_request_empty","Token request was empty and not found in cache.")}static createInvalidCodeChallengeMethodError(){return new r("invalid_code_challenge_method",'code_challenge_method passed is invalid. Valid values are "plain" and "S256".')}static createInvalidCodeChallengeParamsError(){return new r("pkce_params_missing","Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request")}static createInvalidCloudDiscoveryMetadataError(){return new r("invalid_cloud_discovery_metadata","Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields")}static createInvalidAuthorityMetadataError(){return new r("invalid_authority_metadata","Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.")}static createUntrustedAuthorityError(){return new r("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.")}static createInvalidAzureCloudInstanceError(){return new r("invalid_azure_cloud_instance","Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values")}static createMissingSshJwkError(){return new r("missing_ssh_jwk","Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.")}static createMissingSshKidError(){return new r("missing_ssh_kid","Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.")}static createMissingNonceAuthenticationHeadersError(){return new r("missing_nonce_authentication_header","Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.")}static createInvalidAuthenticationHeaderError(e,t){return new r("invalid_authentication_header",`Invalid authentication header provided. Invalid header: ${e}. Details: ${t}`)}static createCannotSetOIDCOptionsError(){return new r("cannot_set_OIDCOptions","Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.")}static createCannotAllowNativeBrokerError(){return new r("cannot_allow_native_broker","Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.")}static createAuthorityMismatchError(){return new r("authority_mismatch","Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.")}}},9920:(e,t,n)=>{"use strict";n.d(t,{Yo:()=>c,Zy:()=>a});var i=n(9930),r=n(4696);const o=["interaction_required","consent_required","login_required"],s=["message_only","additional_action","basic_action","user_password_expired","consent_required"],a={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}};class c extends r.l{constructor(e,t,n,r,o,s,a){super(e,t,n),Object.setPrototypeOf(this,c.prototype),this.timestamp=r||i.gT.EMPTY_STRING,this.traceId=o||i.gT.EMPTY_STRING,this.correlationId=s||i.gT.EMPTY_STRING,this.claims=a||i.gT.EMPTY_STRING,this.name="InteractionRequiredAuthError"}static isInteractionRequiredError(e,t,n){const i=!!e&&o.indexOf(e)>-1,r=!!n&&s.indexOf(n)>-1,a=!!t&&o.some((e=>t.indexOf(e)>-1));return i||a||r}static createNoTokensFoundError(){return new c(a.noTokensFoundError.code,a.noTokensFoundError.desc)}static createNativeAccountUnavailableError(){return new c(a.native_account_unavailable.code,a.native_account_unavailable.desc)}}},7593:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o,i:()=>i});var i,r=n(9930);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(i||(i={}));class o{constructor(e,t,n){this.level=i.Info;const s=e||o.createDefaultLoggerOptions();this.localCallback=s.loggerCallback||(()=>{}),this.piiLoggingEnabled=s.piiLoggingEnabled||!1,this.level="number"==typeof s.logLevel?s.logLevel:i.Info,this.correlationId=s.correlationId||r.gT.EMPTY_STRING,this.packageName=t||r.gT.EMPTY_STRING,this.packageVersion=n||r.gT.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:i.Info}}clone(e,t,n){return new o({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${i[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,n,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:i.Error,containsPii:!1,correlationId:t||r.gT.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:i.Error,containsPii:!0,correlationId:t||r.gT.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:i.Warning,containsPii:!1,correlationId:t||r.gT.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:i.Warning,containsPii:!0,correlationId:t||r.gT.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:i.Info,containsPii:!1,correlationId:t||r.gT.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:i.Info,containsPii:!0,correlationId:t||r.gT.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:i.Verbose,containsPii:!1,correlationId:t||r.gT.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:i.Verbose,containsPii:!0,correlationId:t||r.gT.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:i.Trace,containsPii:!1,correlationId:t||r.gT.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:i.Trace,containsPii:!0,correlationId:t||r.gT.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},7678:(e,t,n)=>{"use strict";n.d(t,{i:()=>r,u:()=>i});const i="@azure/msal-common",r="14.0.3"},2480:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var i=n(8207),r=n(5153),o=n(5536),s=n(9930);class a{constructor(e){const t=e?r.x.trimArrayEntries([...e]):[],n=t?r.x.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||s.gT.EMPTY_STRING).split(" ");return new a(t)}static createSearchScopes(e){const t=new a(e);return t.containsOnlyOIDCScopes()?t.removeScope(s.gT.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw i.r.createEmptyScopesArrayError()}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new a(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return s.$f.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw o.e.createAppendScopeSetError(e)}}removeScope(e){if(!e)throw o.e.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())}removeOIDCScopes(){s.$f.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw o.e.createEmptyInputScopeSetError();const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw o.e.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),i=this.getScopeCount();return t.size<i+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){return this.scopes?this.asArray().join(" "):s.gT.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}},9616:(e,t,n)=>{"use strict";n.d(t,{$L:()=>r,Ak:()=>i,x0:()=>o});const i={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",BaseClientExecutePostToTokenEndpoint:"baseClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponseFromHash:"handleCodeResponseFromHash",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromiseMeasurement",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims"},r={NotStarted:0,InProgress:1,Completed:2},o=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"])},9930:(e,t,n)=>{"use strict";n.d(t,{$f:()=>s,As:()=>d,Bv:()=>y,D1:()=>N,Fo:()=>l,Ge:()=>P,HN:()=>I,L:()=>D,LL:()=>C,NJ:()=>h,Nb:()=>u,QU:()=>T,SZ:()=>a,To:()=>M,VO:()=>f,VX:()=>p,Vi:()=>c,W:()=>O,YY:()=>H,bb:()=>R,ch:()=>b,d3:()=>_,dg:()=>S,f_:()=>o,gT:()=>i,hO:()=>E,iR:()=>w,ki:()=>U,oj:()=>r,pQ:()=>A,qJ:()=>g,rg:()=>v,sR:()=>k,vw:()=>m});const i={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},r={SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},o=[i.OPENID_SCOPE,i.PROFILE_SCOPE,i.OFFLINE_ACCESS_SCOPE],s=[...o,i.EMAIL_SCOPE],a={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},c={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},u={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},l={CLIENT_ID:"client_id",REDIRECT_URI:"redirect_uri",RESPONSE_TYPE:"response_type",RESPONSE_MODE:"response_mode",GRANT_TYPE:"grant_type",CLAIMS:"claims",SCOPE:"scope",ERROR:"error",ERROR_DESCRIPTION:"error_description",ACCESS_TOKEN:"access_token",ID_TOKEN:"id_token",REFRESH_TOKEN:"refresh_token",EXPIRES_IN:"expires_in",STATE:"state",NONCE:"nonce",PROMPT:"prompt",SESSION_STATE:"session_state",CLIENT_INFO:"client_info",CODE:"code",CODE_CHALLENGE:"code_challenge",CODE_CHALLENGE_METHOD:"code_challenge_method",CODE_VERIFIER:"code_verifier",CLIENT_REQUEST_ID:"client-request-id",X_CLIENT_SKU:"x-client-SKU",X_CLIENT_VER:"x-client-VER",X_CLIENT_OS:"x-client-OS",X_CLIENT_CPU:"x-client-CPU",X_CLIENT_CURR_TELEM:"x-client-current-telemetry",X_CLIENT_LAST_TELEM:"x-client-last-telemetry",X_MS_LIB_CAPABILITY:"x-ms-lib-capability",X_APP_NAME:"x-app-name",X_APP_VER:"x-app-ver",POST_LOGOUT_URI:"post_logout_redirect_uri",ID_TOKEN_HINT:"id_token_hint",DEVICE_CODE:"device_code",CLIENT_SECRET:"client_secret",CLIENT_ASSERTION:"client_assertion",CLIENT_ASSERTION_TYPE:"client_assertion_type",TOKEN_TYPE:"token_type",REQ_CNF:"req_cnf",OBO_ASSERTION:"assertion",REQUESTED_TOKEN_USE:"requested_token_use",ON_BEHALF_OF:"on_behalf_of",FOCI:"foci",CCS_HEADER:"X-AnchorMailbox",RETURN_SPA_CODE:"return_spa_code",NATIVE_BROKER:"nativebroker",LOGOUT_HINT:"logout_hint"},d={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},h={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},f={ACCOUNT:"account",SID:"sid",LOGIN_HINT:"login_hint",ID_TOKEN:"id_token",DOMAIN_HINT:"domain_hint",ORGANIZATIONS:"organizations",CONSUMERS:"consumers",ACCOUNT_ID:"accountIdentifier",HOMEACCOUNT_ID:"homeAccountIdentifier"},p={PLAIN:"plain",S256:"S256"},v={QUERY:"query",FRAGMENT:"fragment"},m={...v,FORM_POST:"form_post"},g={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},w={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},y={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},_={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},C={ADFS:1001,MSA:1002,MSSTS:1003,GENERIC:1004,ACCESS_TOKEN:2001,REFRESH_TOKEN:2002,ID_TOKEN:2003,APP_METADATA:3001,UNDEFINED:9999},S="appmetadata",k="client_info",b="1",T={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},A={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},I={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},E={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},R={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},N={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},P={username:"username",password:"password"},H={httpSuccess:200,httpBadRequest:400},O={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},U={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},M={NO_CACHE_HIT:"0",FORCE_REFRESH:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",REFRESH_CACHED_ACCESS_TOKEN:"4"},D={Jwt:"JWT",Jwk:"JWK",Pop:"pop"}},5153:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});class i{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),i=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach((e=>{if(e.trim()){const[n,r]=e.split(/=(.+)/g,2);n&&r&&(t[i(n)]=i(r))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,exports:{}};return r[e](n,n.exports,s),n.exports}s.m=r,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var r=Object.create(null);s.r(r);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,s.d(r,o),r},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>({36:"hi-in-owl-strings-json",98:"sd-arab-pk-owl-strings-json",399:"lb-lu-owl-strings-json",666:"sr-cyrl-ba-owl-strings-json",712:"ga-ie-owl-strings-json",856:"gd-gb-owl-strings-json",921:"zh-tw-owl-strings-json",1e3:"el-gr-owl-strings-json",1029:"sl-si-owl-strings-json",1102:"ms-my-owl-strings-json",1105:"ca-es-owl-strings-json",1133:"be-by-owl-strings-json",1350:"bn-in-owl-strings-json",1406:"ca-es-valencia-owl-strings-json",1489:"et-ee-owl-strings-json",1532:"uk-ua-owl-strings-json",1608:"nl-nl-owl-strings-json",1635:"es-mx-owl-strings-json",1771:"ne-np-owl-strings-json",1791:"ar-sa-owl-strings-json",1825:"kk-kz-owl-strings-json",1993:"kok-in-owl-strings-json",2046:"ta-in-owl-strings-json",2129:"quz-pe-owl-strings-json",2281:"ur-pk-owl-strings-json",2289:"ha-latn-ng-owl-strings-json",2394:"te-in-owl-strings-json",2772:"ro-ro-owl-strings-json",2792:"pt-br-owl-strings-json",2811:"km-kh-owl-strings-json",2855:"pa-in-owl-strings-json",2902:"lt-lt-owl-strings-json",3041:"fr-fr-owl-strings-json",3075:"en-gb-owl-strings-json",3102:"cy-gb-owl-strings-json",3247:"da-dk-owl-strings-json",3268:"id-id-owl-strings-json",3395:"tt-ru-owl-strings-json",3622:"lo-la-owl-strings-json",3787:"qps-ploc-owl-strings-json",3872:"ky-kg-owl-strings-json",4051:"fi-fi-owl-strings-json",4144:"ja-jp-owl-strings-json",4335:"it-it-owl-strings-json",4525:"kn-in-owl-strings-json",4628:"mk-mk-owl-strings-json",4630:"owl.handlers",4654:"fr-ca-owl-strings-json",4809:"tk-tm-owl-strings-json",5167:"af-za-owl-strings-json",5383:"as-in-owl-strings-json",5467:"nn-no-owl-strings-json",5760:"fa-ir-owl-strings-json",5848:"mi-nz-owl-strings-json",5874:"am-et-owl-strings-json",6099:"si-lk-owl-strings-json",6233:"vi-vn-owl-strings-json",6251:"sq-al-owl-strings-json",6338:"bn-bd-owl-strings-json",6664:"cs-cz-owl-strings-json",6727:"hr-hr-owl-strings-json",6774:"nb-no-owl-strings-json",6795:"hy-am-owl-strings-json",6798:"bs-latn-ba-owl-strings-json",6832:"tr-tr-owl-strings-json",6974:"pl-pl-owl-strings-json",7e3:"sw-ke-owl-strings-json",7027:"chr-cher-us-owl-strings-json",7332:"or-in-owl-strings-json",7335:"mt-mt-owl-strings-json",7447:"zh-cn-owl-strings-json",7610:"ml-in-owl-strings-json",7681:"ka-ge-owl-strings-json",7805:"az-latn-az-owl-strings-json",7986:"sv-se-owl-strings-json",8102:"es-es-owl-strings-json",8217:"gl-es-owl-strings-json",8225:"bg-bg-owl-strings-json",8253:"hu-hu-owl-strings-json",8294:"prs-af-owl-strings-json",8342:"ko-kr-owl-strings-json",8361:"fil-ph-owl-strings-json",8438:"en-us-owl-strings-json",8507:"ru-ru-owl-strings-json",8530:"sr-latn-rs-owl-strings-json",8660:"gu-in-owl-strings-json",8692:"ug-cn-owl-strings-json",8793:"pt-pt-owl-strings-json",8904:"eu-es-owl-strings-json",9054:"lv-lv-owl-strings-json",9173:"th-th-owl-strings-json",9264:"mr-in-owl-strings-json",9275:"de-de-owl-strings-json",9355:"qps-plocm-owl-strings-json",9545:"he-il-owl-strings-json",9660:"mn-mn-owl-strings-json",9729:"sr-cyrl-rs-owl-strings-json",9743:"sk-sk-owl-strings-json",9754:"is-is-owl-strings-json",9779:"uz-latn-uz-owl-strings-json",9894:"qps-ploca-owl-strings-json"}[e]+"."+{36:"ef5791183931dd6a43a4",98:"cac8d0d413bc56fa3a68",399:"eba2b17f6dea77de9d3e",666:"1d0c674c73ac2215b56f",712:"cffcf0f45e207f677abf",856:"59e37ef89fb5b27a8c9a",921:"b3b7560c62f8fd5e5dfb",1e3:"d9d10cd1c72efd53c958",1029:"bd26a879f1dd01df442c",1102:"734f140c6f91cb93d267",1105:"98967ee1666fc6a41c58",1133:"83f215a964e288f04de1",1350:"ede0a576407461480049",1406:"ff09e486c5ee39f7df24",1489:"8e2236f212cc19d7bd87",1532:"005f95a3977a4493e059",1608:"f822ba4035d6eec2a375",1635:"27ce7b20450d411f9598",1771:"0fe5abea35ff68fbc2ca",1791:"c002c6c419902f26240f",1825:"e4c4f0b2826c7c36acbd",1993:"30fad92db8ae06b97fde",2046:"9038e3055f98e1342df9",2129:"58aff344dd5e6ffeb6e7",2281:"b88871b2dd34af7081b6",2289:"97443f629587404e0b2b",2394:"6f2cc8eba5b9393ede83",2772:"38129b1b1a487c219c76",2792:"45cc0dd5f7d26683555c",2811:"8f5da644656338149d19",2855:"fe41fe5564fa2e59cb73",2902:"347b85448a468565565f",3041:"1f84748e3d7f5045e9bf",3075:"49edf1abde6492220dae",3102:"d1cf19047099481153eb",3247:"f71a2d4c5da5d36947f4",3268:"78141ab8414fd2dca295",3395:"ad6388e2842a4550a9ec",3622:"906cf46f60b42ea3a45e",3787:"f1ed99628877cd4311b3",3872:"8b952f8d57a25355cee1",4051:"1336cbdd3431eb722f66",4144:"514e24f69fa87e1c9054",4335:"ef7a6b37b49f22c7d290",4525:"f14d7f3e7162eab87ddc",4628:"ce17da5f2a33e28e5766",4630:"0a2b1a5f8a95352e1b09",4654:"38cd0b2feaec41890ae8",4809:"8074601cb42683208e1d",5167:"44ab6693f8aa5c89bcde",5383:"e7d74d788bbfbb870a96",5467:"080e251c13b8659b3af1",5760:"848566bf511071e3ec30",5848:"0853243634f625f617c4",5874:"853392adab14d8627fd8",6099:"549bab3037fe6a581534",6233:"a28df423be00acd37a64",6251:"7dc656ab1214f6bd7f5a",6338:"a6686996985fcf7b9b89",6664:"7ebfe9747c96e2f5ac4b",6727:"e079339d052f8b2ece29",6774:"e18c878c6d54a0b53797",6795:"cd70eba7fd5889f006d4",6798:"d674a884de2341bff534",6832:"b03415fb45b6592fc9d7",6974:"e09a8a11e5fe58968d9a",7e3:"6f9b41085e6b3ed610c5",7027:"dd1d170124c046261857",7332:"1f1b16ab96c1e44d05b0",7335:"fa366736e59bd742fd89",7447:"70280f6c28feab8ab783",7610:"8f6ae209960b812f9efd",7681:"eb35bf2e44293f4049ef",7805:"d4358330767c1476a5be",7986:"28fdd208e3228067e62c",8102:"3fd331f58acb5bcea597",8217:"e8a6ce48f1a6691bee28",8225:"e0ef3286edcc5d990448",8253:"1d2e44ed2f4a027a2b5c",8294:"4b137508a0706c3046b0",8342:"d73e816c282e68eff888",8361:"743b18839bbb8c48d366",8438:"c051618b49d3b05d6f16",8507:"268a7dc252bbe481c71d",8530:"cc4ed66be54d8ae9ead3",8660:"fe1088d32a51f8f6311e",8692:"c247b10bdc439fe309a7",8793:"a9e1f06bcb6de2e3aa5f",8904:"ddf62b8a12f1450afac0",9054:"b754a35872be60e57424",9173:"20442e8e3e963a686152",9264:"b9009ec0817b759581f6",9275:"cf7c8778f9727706102b",9355:"39fd547cfe2d0e5f1920",9545:"826ca93497f65f3d827a",9660:"a7b190e605304b1319a5",9729:"af59bb50612a68ab1c98",9743:"80c8053e4bb4ad67e8ec",9754:"b261eea5a2aefa2189bc",9779:"61bddde822565ecc5931",9894:"a1bb75c2c7f4dafb684c"}[e]+".js"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},i="Microsoft.Office.OWL:",s.l=(e,t,r,o)=>{if(n[e])n[e].push(t);else{var a,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+r){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+r),a.src=e,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),a.integrity=s.sriHashes[o],a.crossOrigin="anonymous"),n[e]=[t];var h=(t,i)=>{a.onerror=a.onload=null,clearTimeout(f);var r=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(i))),t)return t(i)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&!e;)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),s.sriHashes={36:"sha384-Q/4l14q+ZOPEur5x/fjqwD+rOmU2zbDUgQEQIlw3EJuUtob8KOp7sjkSVyE9k/OG",98:"sha384-nk7mjZ9kHUXVo+BW85/nntHy90IdZliHNnIhFu3fQShGHoYHnFY6gVpCaCd+FNQ7",399:"sha384-at7TDVkyfylq8JLk1RXsel4i9FepzBh7AfJG2/7pQ8mw/A3iWkVcfNVHGH9aYEfY",666:"sha384-OYkxvwvBObzcioIBNvuvCqJbHhhjOYatLR4S/EM0+gyKFKJSuo5aIRU+K5eqnq7m",712:"sha384-21YHr8xxXw2sWcDGC1dxZuYvF3yzxmrabf7SAKK99T78WFIBRCWlzAiqFj1/BZ01",856:"sha384-omhm9Ngpns2uYyiAuN05Wv1k83fT4iAukEpikOGD1b17o2bCQ79PCGg7Y0Vy5Tm+",921:"sha384-hASwpVUHX0+dBwj3zYYYCtJp5fnP9Fxp80C5coHkE0rYu1jQfx/mRxmU0PwpNFEI",1e3:"sha384-/b3aTZQSlODkKNkDrET1jqD223pbpt1HXkuu8LBPB4Kyi/ocXK10Gh2XUYO+G8l9",1029:"sha384-hTw7kIoWWlWVVshTxffjW6ImXBtcG+JyPzy4qNJQdhAYS8Ljz2DF76DZCA+oUDaI",1102:"sha384-Y0hACzgJvOJ5p2VE8QDhOgTqsflUuTOb1TlGC6KHefbxGZhQF9drRE/jbcTEdR83",1105:"sha384-mpDT3L4FojuZDH8R6AkVO7sxIQ5HoOWlhjmK5VdZCNL/Fgfo2NzO40xSHf0i4Hej",1133:"sha384-QrXU6MhpBYUmS/hjCLbzsA6iFpkP1AmRXmHgtSIuKA9ZDMKNviGnzD99vH/J7WIv",1350:"sha384-VroymWy1NXCUQqF737/KHRXAc82e6ZlE0XBV73Lj7ix8IBlwH4IIjSLumi84JG6h",1406:"sha384-ybZPxEDBE3z+LU6wZrQJvkEhCyZdizeEar7sVJ4KZjRfJeVxwVSwcr4j3jfrhKSH",1489:"sha384-ZKf55rLl9ICx2T7KNda2Ij45yb4r7uD9iJP8TwoHv1P2W9p1kHAXINLrvQPkCoUr",1532:"sha384-hCQIpBDEHMwy2RHxbotkuLJ6HddkSpS8YiZ5gSJZFiAIvDPHUx/YGJcqF/iOITl1",1608:"sha384-/O/ahZKvntJAXpNCjoBFx07dk38MBdNKyAJ1A+bAs2oO2O20dTg79t6B/PMoStcE",1635:"sha384-m7U4ObPuaUwbWfauSrzD/4wdJUGQk2ktD6FUGTIqsBm5/3cO+keu3qcP8KTPvs+Q",1771:"sha384-+1nTK2mPSNbHfdHpkFHEgmCd5YksoU9EWS4f470srRg37E2ZKS1q3Qp5psMkuw7u",1791:"sha384-jAE2SQXYShcWj/PKm1+zWNd3LiN2Up8rWDOrrvDN6vK4xJowy4rZ1NBjHbZFtZEo",1825:"sha384-2WqgOK6ewktCibrvZL+1E3u6aHV4/gatDf1xuHsam5PfhKwZ0SUHaIBTztFU6rBk",1993:"sha384-hajf0RmMecoDtbcOLS3eTEV9X/vJShLhAqZ2AUzaRIJEtLHyF57MlnB7t1a6NRcn",2046:"sha384-QAUqhAvvgZSUX3Dop0dUQQCNtYpEN72E+vSyg/oSqy4FrdVGldVAEWYFO5Hn4vbx",2129:"sha384-wrA9sTN2MegHU5tYxxxXK6BFxjp1WQTbHFKXMfWvwi3hFSfsqq+uV2gjgl1A2uh/",2281:"sha384-k/537csEpyoAkLdhSZCqrSrfWJuGj3T3hrzKN9y6q0qZN+ffk8p7TrcgwcUlNJ+n",2289:"sha384-PhrVaHfbjnlc2i95/BNZMyd06W2dLh0TLahU7MSwc5zFVoNgBf2YBjnq9d64rUJD",2394:"sha384-Ecp9zPsqc5/SnrNiTmvaWSULm/vbQyvCRvZbKRUTauzaZGP57V+3z/L3t/3Pdcii",2772:"sha384-DJZAPxOR1vV/DrrYrAy9VbET1WetwbaTOX1YFnc1YmL1AXfOh0MlXCm6uaLs3vfq",2792:"sha384-OvkehA3pZRP9LQ29Hvw3HNLyk8imOsG5aezixc4ri/qc0YoEfZKWRJDVgioZTqh3",2811:"sha384-RRLw6b8+L9Oi+Ak+CFthHEExB1apdYP1C4rWrfF0qHrtE2/r0AtXTNFfRoocISfE",2855:"sha384-nV1+t8zHAEDjoZ4rJJ9dSR6Q6BkkIFMvICMJzIrb0YQCb89dUD0WAOBjQ1jTu+gx",2902:"sha384-d3eej2zlNIHAX5Vo2fsgR/DIOu+cOh/swFkPE8cvdDa6c3Y0QKnTlnF/mXYw9Tm3",3041:"sha384-Kc7EWX3ScAyata5crZNpBRINkQg2J+jbmlg7r8AUMG9hjpMGYcEqdSfbVJkIaNeq",3075:"sha384-WcCWfQjc+qwfNwhtcNXWXUNo1FUxJsHjriC8TzdxgqgL9pr1bPTzm1b7GjyZ6Mzj",3102:"sha384-qpizynRTv1lu2tIW7l40fh9wt4AZMF+4qohbHDxmeoUVALKAViSvLf2RafmNqz06",3247:"sha384-Va3AEx39IzkO8bYf0HiiJpfw1OYnURiupikqyNfEI+EmifFEIR7dQEZCthOZSuI8",3268:"sha384-GzIXFQt5wCY2ZXa+SmPLSvUTS8KvbFZS2dD6jZlwRtDcGlSDc7LAI53LlGn8b7R/",3395:"sha384-u238GRvKmKAtoegRgNg57FaZ2PvAe8CLdpuBPmquFKLMp409vrrAmL3iiNI2hTrd",3622:"sha384-TrK0jM+ppliJB0ogSXbJFjZZsNRnD7/5yLKbvBJkhhTDUhH+PiwgXyzqF0yG64Ln",3787:"sha384-1M4Pso4uuS/lbVsSsFs5gy6kSLdai6pDJOdbd7KXmo08B1PnCR33UIuawR4yHgex",3872:"sha384-yB+/hYhNzKp+UIvk8+ysm6ueJ7qklZwLiBUUgc1OsatUWzMfpza9jwGKseu5co/r",4051:"sha384-ZYcy75Ukl8Lqhs7SFKXYkuciBPwm3rxVUrmEF45Z3c3ZsNZFBz22d2gDL25mSnQY",4144:"sha384-SXmXcXUBgedgiC4Y0kK5utwGnur68KgPoHClK2lPm+WCR2cG0JIo68E6LD3foYQ+",4335:"sha384-uTym7k5SBCC5QFlT5Jxf83JMB40hJc6mbeToxTGn7RNajC2BdWRPR55jVtC5EunU",4525:"sha384-t8Do4QPvviwqOPisMSVX4UhmlC3Mql/9wb7+M1FcS4jnGhvzvS3oDX7h77zMewX4",4628:"sha384-zsyWtzhgSmzmRSWFs+CmJv63pqSoHitIKj4Jjn536JYhNtLspWZY85BmLxta5hfB",4630:"sha384-e95lJVwiHIcvTBvHHJF3i7QzlnR6rfEMNUB2JK2HgAisxmV39+x04g17LGSPAmxb",4654:"sha384-VttVnqrOlc6vCrruruJMQGNL7T++2+dBaHYyccn3akdxgw69XbLqWDDgEMrYUJ6f",4809:"sha384-HxVvF2wO1XhyDZEIgFetKSJ3iSHKBUpmxEfzQLEe+Mu3nFh8sMf+MbKse0jLMndr",5167:"sha384-h0GJgTUEOiRbm6jdN8anze37ibk24xixfnfgFqv4o8rW6v0eWFvoecjcadKbCUeL",5383:"sha384-XuxqOkYWOowd5nRq7gZMZtkKt2tf4vIi/RTuUIB3rz3eSqBxgN8oU2LLxJ/s7dDR",5467:"sha384-9vtfCTyLpzBJuFdF9JaTWGHNBDchQ8wsGe2YPsRAvk53OT3LNyjG/aOL8kkGVLwY",5760:"sha384-zW+dpSMj4/6FQsq9mTxmKrQMchrWY/zZXVZhbRfzJHRmwsBi1UHR9MOPnxjT0QhN",5848:"sha384-fWHT8BQ8dVQo+Bu6+wV/7PUXnKICjI4vqbVf5xNBjdFjKN/tst1zhCFgNyh+GWf6",5874:"sha384-ef16GGOMEgjbvh3kknzPc1vFCDW3WxqkgbxCSkoRPl6Du7Q8UjI8INFAz4OmvVIh",6099:"sha384-322vu4d8xd9P77BufL85zcjrKcB3ilMiUYkuBfd0IEIw5v0BjnJQvPVVbyNVir+r",6233:"sha384-xhtexaiLZY1tfKcYga+DG7IRqObBN/7kiJkceTMJXXhjzMSSUe1KCGmt2IbLxgsJ",6251:"sha384-UQDV+KMgWH6Umk9huDFrSBoor6+qlfDfEZSeg0p4x7vm/cnQv0kDLxLHEiws13G6",6338:"sha384-ZaAU6Wwmm5chYBpiZioGDaal+c5QsIlELOIHqBFSHf9NZOXk7OE69SlLOx/oJG5C",6664:"sha384-dQ59qJOcNXCJzh5IJE1UIl3FVQPMvu4nQDkH9To8q+qp32bhhaiqhnYFxJeuR4JS",6727:"sha384-/XI0fyV/3V5gjuKrHH56TmpTJjPzBHKxmayWWNnYMjmMvAdWxxnEkeZ7hxX3dlNn",6774:"sha384-ExeqP024ei/9nBTdHwOBZ9WjxZpdqcOBcVfjYnXY/rIR4W2l/tEjSutjFH4aR8BZ",6795:"sha384-63hb8nVq1U6kBtgEK0X9p3sDmsqkr223SYD11DgiHLUPxYOMYFVB8EBmoRBGy5zT",6798:"sha384-Jxm8FU6SVcE0ybhTIydo8XjQWcRns2TA7XbudHMABfqPlCX1DJJ8yz7xLGy/8MeO",6832:"sha384-+kSo+jk6aHXM6/h8oxeQmAktGDfYKaRPDzSHas4Mr99Zg4CXHzP2FJxeekLvgCgl",6974:"sha384-ZFGYXZsFRA7MsgKqTpMGSQNWacQAuyPiA3XABMERVgd9HER39VqGlawMmAt76LJZ",7e3:"sha384-Kbjnc60hkd4NEpciMcdhTR/BKVoTykTES9MGmQxevXBQ7QpmV2gp+iMRzgWH1Bgd",7027:"sha384-SCpx5ktI8/ZhvcFLJDlRXg4e5v9iksembh+3bXczk/5TPHpJEemh3DgNeG1XV6nl",7332:"sha384-VbeB1dO6/2F7I+MCqSDUah5fscfF/VQEwtJdRa+kku9EG+n3ecGpmPotBfeWrsB1",7335:"sha384-aImKOzUOH144iuXYNu+dp+sRmmSZf/0nqQmAUJJNs7S4KErZ/AfF6F/RRyvC6l63",7447:"sha384-S76GgSW/rv2hqtwbyN6WfmABeBtcUwjETt2HvmpYVGpzcRwmrQFeCtGi40QYPBuA",7610:"sha384-IM4ngF2yDRf6v4VWKDgE7Wh0xicUafPVoEuIuAnmdjEbofsYqZEts9j4swcJE6+k",7681:"sha384-avJNa8nh/jW9nSEPVYvvILh1PIg9UDVUEM4dv/nyUKIZWv1l9CVM9YJlH9A00kER",7805:"sha384-OchCStT5TwXpFFMjDEM78U9c7Dc/SzHZlB7GQayX8Se3YPWG9gOnk9ICUBk+qiG7",7986:"sha384-R9qYiSnBPgeG+I9mz/1HbSUSmI5psJLXLmZIrAmh61LQx8Xp5CwVxcCf+w2HPzKO",8102:"sha384-nxnjIvQxPMFRRGu3ZuhJUQyL7Y1jW6xnQiomX10nTd86mBR4FdYYeHCy7vAGjx80",8217:"sha384-B7J2iD/2XCE7oVmNfN/Vh81/l1mSTrvMnU4h/BT0FxdFN0FNTshnvdWAQdEkOUK1",8225:"sha384-1COXh2LooAbhy3BGNmkEzsaeqlTJCYt+RMqVcRs6a7aPaoz6wj+YTo3Phy3uA6uW",8253:"sha384-48DO13FlJ+uMIAq+eIH0aGX9RxeAq8captvYYbLO5ciTyq0ogIRny7xDZpxOTrGw",8294:"sha384-V8r6IfNOW+ygDEFD5LuUVLfC+dcQm34q39aeJZB1hAIn7+VvizJssFKPB8gURcE9",8342:"sha384-vxwhU0wVfAjBlvlt0xICDfSI/SuhdVCvnhYRh5xrV6dd4sM6uvOtu36mpD/zctlZ",8361:"sha384-5ld53Pfg98+6jZjuAdm3y8VcudWjdvB5US0eeC4IOdmUUqm5HpVeAciljWuYJ20i",8438:"sha384-nx0NeMRWjw95xPyCBtKTEuOC2esZKcgF+10HaHL/+YbNZJ5621+khbF4LAF6JmFj",8507:"sha384-u0dArgonFO8CGIOm1C0eujF6ixbgPe6M/VeeB8CpgpdX1HksW4vc5rFNbcYGBChP",8530:"sha384-rv4wKSNZ2Nvs8moJXN6PzGyMRaoN65OdVN0NFVr5z90U9TxBIsBEgtjr+m/0hens",8660:"sha384-DBSRce2Hh+cNvbP3AkfUS7YP5vzVjNwaq72lXUSx8+JksxSq0tHTKTP++ZZrmjJK",8692:"sha384-Aep98rupg1oOZFXhPcH5TrH0qLDG/eQTMnzKkTVtPKjlSjoGp/c9eHtWdbcTMH1T",8793:"sha384-mZbHAiS4JQNm0STBBMMeZX7utClbRzC3wccpieJ57RnSVtCleG7y4Afcd0trDWnp",8904:"sha384-Wqu5m+EbL8ENDaT5jqj84PwLKRzX6na9MTeaEROnQhH5sg3gjfIK46yQOO+bu+nq",9054:"sha384-2VcQW0DJ2yBOLxoagz8z4ph2stD0B8zT6ODt80Wnk638/lLkoVUySc53ooJhpjtd",9173:"sha384-js4ocydzsE82QQvio3Z1ZuXGFqfc4PpNk+BFg7FbDKsh6eSM8V743P7a9VDFRWZy",9264:"sha384-xWyPsMybIG8KtXaKp3eWeK7h8N7cZox6V3pCUL8Rzh/U9ESBzn7MQ3uyNalTWnKE",9275:"sha384-VEswPy3FafKT89ClgfRN05T3t+/Y69/Vwj1rchE2knKbpawhmCZCEM5b9DdgvPVs",9355:"sha384-tW92wypvimREYimW3lBAH0zZ30sH5e15CJg///o4X9NE3iMAFOwQR9/5RAq+tROG",9545:"sha384-jckIlPPid2WaZXE92BysEgdvzf8uWf/vWCdc8j64XE64oXG9eNOJ9MnTcLl4xLyo",9660:"sha384-+5Ovh9vlbYNUvmzEPzFP3p/U4sa15pAVyOWM3GXEpAOgCzJDY5FGnWp2xlA4C/HI",9729:"sha384-gNo5fUfFYRt09snOXD+dIur9VZT/MHXJAefDFd+lcNgyPnO3nL/qp16uGiJSftdB",9743:"sha384-jc1/9JdVs3RzObGJ8b3vPhI95Jua+qPUW6szJb++pZFYENHidxZjfQmimUR7oDSR",9754:"sha384-SsxrI3Xcs2b7hURf0evqlD/1noLTN6IDJ3a2ORUbGe1qu60uBPgQAyMKp06dEjWA",9779:"sha384-2BlRGa594E3B7zD+K8Umk2exo0JXszpmZ4Iwn/sFJliNXgZMzXe/TF4JV/dBca2J",9894:"sha384-hTlFUBgka1tsKW/kLJPrMTqtq4Vi78hRFxRfB+Tt50u6R7Mo2a9gcy3QFd/l7vOJ"},(()=>{if(void 0!==s){var e=s.u,t=s.e,n={},i={};s.u=function(t){return e(t)+(n.hasOwnProperty(t)?"?"+n[t]:"")},s.e=function(r){return t(r).catch((function(t){var o=i.hasOwnProperty(r)?i[r]:5;if(o<1){var a=e(r);throw t.message="Loading chunk "+r+" failed after 5 retries.\n("+a+")",t.request=a,t}return new Promise((function(e){var t=5-o+1;setTimeout((function(){var a="cache-bust=true&retry-attempt="+t;n[r]=a,i[r]=o-1,e(s.e(r))}),0)}))}))}}})(),(()=>{var e={9520:0};s.f.j=(t,n)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=r);var o=s.p+s.u(t),a=new Error;s.l(o,(n=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,r,o=n[0],a=n[1],c=n[2],u=0;if(o.some((t=>0!==e[t]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);c&&c(s)}for(t&&t(n);u<o.length;u++)r=o[u],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var a={};(()=>{"use strict";s.r(a),s.d(a,{DocRebootSupportMode:()=>pf,ExpectedFailureReason:()=>me.I$,FeatureGateConstants:()=>T.Fh,FileType:()=>k.T,Health:()=>gf.S,HealthLogger:()=>b.zP,KpiType:()=>S.o,LogCategory:()=>f.W,QosErrorName:()=>me.DG,TraceLevel:()=>p.G,UlsLogger:()=>b.G2,WacErrorName:()=>me.AU,bootDiagnostics:()=>me.c,bootDocument:()=>zh,bootDocumentWithCustomFunctions:()=>Jh,createNewGuid:()=>g.n,forceEndSession:()=>jh,getClientUrlForOpenInMobileApp:()=>Gh,getDefaultResourceString:()=>Bh,getDocumentInfoFromWindow:()=>wf,getExpectedFailureReason:()=>gt,getFeatureGateConfigByName:()=>T.vJ,getFeatureGatesFromString:()=>T.i0,getFetchAccessToken:()=>Vh,getFetchItemFromNetwork:()=>Qh,getFileTypeFromExtension:()=>yf,getFileTypeFromPath:()=>_f,getHootEndpoint:()=>m.XQ,getOwlVersion:()=>qh,getPrebootSessionId:()=>Me,getShareEndpoint:()=>m.PO,getWebUrlForCopyLinkToPage:()=>$h,getWiseEnvironmentFromTeamsRing:()=>Ne,initPackage:()=>Fh,isExpectedError:()=>mt,isMobilePhone:()=>ff,isNetworkError:()=>vt,localStorage:()=>we,logFeatureGateUsage:()=>T.dt,notifyHostAccessibilityLoopComplete:()=>Kh,prebootApplication:()=>Oe,prebootDocument:()=>Ue,removePrebootSessionId:()=>De,setWacDataCenterValueToCache:()=>Ed,unifiedUiHostConfigs:()=>bd.J});var e,t,n=s(7425);!function(e){e.bi="App_AccessibilityLoopComplete",e.Ti="Wac_ActionComplete",e.Ai="WacInitialize_Ready",e.Ii="Wac_AppFailed",e.Ei="Wac_AppBootState",e.Ri="Wac_AppCompleted",e.Ni="BrowserEvent",e.Hi="UI_Close",e.Oi="App_CloseTab",e.Ui="UI_Conversation",e.Mi="UI_CopyAndEdit",e.Di="App_CreateNewDocument",e.Fi="Wac_AppDataSavedStatus",e.xi="UI_Download",e.qi="UI_Edit",e.Bi="Error",e.Li="UI_FileEmbed",e.Wi="UI_FileProperties",e.ji="File_Rename",e.Ki="File_RenameFailed",e.Gi="UI_FileVersions",e.$i="StateChanged",e.zi="App_IsFrameTrusted",e.Ji="GetAccessToken",e.Qi="App_GetAuthToken",e.Xi="App_GetCustomAuthConfig",e.Yi="App_GetHostKeyValue",e.Zi="App_WopiInfoFromUrl",e.er="App_DavUrlFromIds",e.tr="App_LoadingStatus",e.nr="App_SwitchMode",e.ir="App_MoveToFolder",e.rr="UI_OpenInMobileApp",e.sr="UI_OpenInBrowser",e.ar="UI_OpenInClient",e.cr="PageChanged",e.ur="App_PushCommentContext",e.lr="App_PushState",e.dr="App_DocReboot",e.hr="UI_RedeemForCommenting",e.pr="App_RefreshSessionInfo",e.vr="UI_ReplyWithChanges",e.mr="UI_ReportAbuse",e.gr="App_FilePicker",e.wr="UI_SaveStatus",e.yr="WopiSession_Complete_Ack",e._r="SetOverlayContent",e.Cr="UI_Sharing",e.Sr="UI_ShareForm",e.kr="UI_SignIn",e.Tr="App_StoreHostKeyValue",e.Ar="App_Unloaded",e.Ir="App_UlsLog",e.Er="Wac_UnloadingApp",e.Rr="App_UpdateBootComplete",e.Nr="PageCount",e.Pr="UI_CheckUserAccessAndGrantPermissions",e.Hr="User_Activity",e.Or="Edit_Notification",e.Ur="UI_Workflow",e.Mr="ZoomChanged",e.Dr="CAAEMessage",e.Fr="Excel_HostFrameCacheSave",e.qr="Excel_HostFrameCacheEvict",e.Br="Excel_RegenerateFileBundle",e.Lr="App_SwitchToWacFrame",e.Wr="App_SaveSSRData",e.jr="App_PurgeDataInHostCache",e.Kr="App_SaveHostRenderingV2Data",e.Gr="App_SaveHostUtilsData",e.$r="AcquireOAuthTokenTeams",e.zr="App_SwitchNotebook",e.Jr="FailedBoot_CheckFileInfo",e.Vr="GetTeamsUsers",e.Qr="SendTeamsUserMention",e.Xr="NavigateBackToHost",e.Yr="App_GetClientUrlComplete",e.Zr="App_GetWebUrlComplete",e.eo="App_CopyLinkComplete",e.no="App_SendConversationId",e.io="CloseTeamsConversation",e.ro="PageLoaded",e.oo="Visio_BRS",e.so="Visio_SendLicenseInfo",e.ao="Visio_Consumption_CLTComplete",e.co="Visio_SwitchMode_FromViewFrame",e.uo="Visio_ModeSwitch_ToHost_Ack",e.lo="Visio_UpdateEditUrl",e.do="Visio_PageViewLoaded",e.ho="Visio_ActiveAppFrameLoadFailed",e.fo="Visio_DisposeBkgFrame",e.po="Visio_ReadyToReceiveDocData",e.vo="Visio_DocReboot_HostNav",e.mo="Visio_SwitchToVisioFrame",e.wo="WacAppPerfMetric",e._o="App_ModifyURLState"}(e||(e={})),function(e){e.Co="Ack",e.So="WacInitialize_Ready_Ack",e.ko="Wac_BeforeUnloadApp",e.bo="Blur_Focus",e.Ao="Wac_AppFailed_Ack",e.Io="Wac_AppCompleted_Ack",e.Eo="WopiStartSession_Complete",e.Ro="WopiPendingSession_Complete",e.No="Host_AccessibilityLoopComplete",e.zi="Host_IsFrameTrusted",e.Po="Grab_Focus",e.Ho="HostCacheDiagnostic",e.Oo="Host_KeyValue",e.Uo="JsApiDiagnostics",e.ir="Host_MoveToFolder",e.Mo="PageChanged_Ack",e.Do="App_PopState",e.xo="Host_SendChannelId",e.qo="Host_SendConversationId",e.Bo="GetTeamsUsers_Reply",e.Lo="SendTeamsUserMention_Reply",e.Wo="Host_BackButtonPressed",e.jo="Host_GetClientUrl",e.Go="Host_GetWebUrl",e.$o="OwlFrameDiagnostics",e.zo="File_Rename",e.gr="Host_FilePicker",e.Jo="PostAccessToken",e.Vo="Host_SetAuthToken",e.Qo="Host_SetCustomAuthConfig",e.Xo="App_PushCommentContext",e.Zo="CanEmbed",e.es="Host_RefreshSessionInfo",e.rs="CheckUserAccessAndGrantPermissions_Result",e.ss="Host_WopiInfoFromUrl",e.cs="Host_DavUrlFromIds",e.us="SetCurrentPage",e.ls="SetZoomLevel",e.ds="WopiPendingSession_Fail",e.hs="SetOverlayContent",e.fs="WopiPendingApplicationComplete_Received",e.ps="Host_SwitchMode",e.vs="Host_Unload",e.gs="PageCount_Ack",e.ws="ZoomChanged_Ack",e.ys="Host_ShareUI",e._s="Host_Telemetry",e.Cs="Visio_ConsumptionCLTComplete_Ack",e.Ss="Visio_SwitchMode_FromHF_Ack",e.ks="Visio_SwitchMode_FromHostFrame",e.bs="Visio_FallbackToLegacySwitch",e.Ts="Visio_DocumentData"}(t||(t={}));var i,r,o,c,u,l,d=function(){function i(i,r,o,s){void 0===s&&(s=!1),this.Es=new Map,this.Rs=i,this.Ns=r,this.Ps=new Set(this.enumValues(e)),this.Hs=new Set(this.enumValues(t)),this.Os=s,this.Us="",o?"string"==typeof o?this.Ms=new Set([r,o]):Array.isArray(o)?this.Ms=new Set((0,n.ev)([r],o,!0)):"function"==typeof o?(this.Ms=new Set([this.Ns]),this.Ds=o):("string"==typeof o.validOrigins?this.Ms=new Set([r,o.validOrigins]):this.Ms=new Set((0,n.ev)([r],o.validOrigins,!0)),this.Ds=o.validateOrigin):this.Ms=new Set([r]),this.Fs=this.receiveMessage.bind(this),window.addEventListener("message",this.Fs)}return i.prototype.registerHandler=function(e,t){var n=this.Es.get(e);n?n.push(t):this.Es.set(e,[t])},i.prototype.sendMessage=function(e,t){var i,r,o=null!==(i=null==t?void 0:t.window)&&void 0!==i?i:this.Rs,s=null!==(r=null==t?void 0:t.origin)&&void 0!==r?r:this.Ns;if(this.validateOrigin(s)){var a=void 0;try{a=crypto.randomUUID()}catch(e){a=crypto.getRandomValues(new Uint8Array(16)).join("")}var c=(0,n.pi)((0,n.pi)({},e),{correlationId:a,sendTime:Date.now()});return o.postMessage(JSON.stringify(c),s),a}return!1},i.prototype.dispose=function(){window.removeEventListener("message",this.Fs)},i.prototype.receiveMessage=function(e){if(e.data&&"string"==typeof e.data&&this.validateOrigin(e.origin))try{var t=JSON.parse(e.data);if("MessageId"in t&&"SendTime"in t&&"CorrelationId"in t&&"Values"in t)this.Os&&this.handleCrossDocumentMessage(e.data,t,e.origin);else if(t.id){var n=this.Es.get(t.id);null==n||n.forEach((function(e){return e(t)}))}}catch(e){}},i.prototype.validateOrigin=function(e){var t,n=!1;return this.Ms.has(e)?n=!0:(null===(t=this.Ds)||void 0===t?void 0:t.call(this,e))&&(this.Ms.add(e),n=!0),n},i.prototype.handleCrossDocumentMessage=function(e,t,n){if(t.MessageId){if(n===this.Ns&&this.Hs.has(t.MessageId))return window.parent.postMessage(e,this.Us),!0;if(n.endsWith("officeapps.live.com")&&this.Ps.has(t.MessageId))return this.Us||(this.Us=n),this.Rs.postMessage(e,this.Ns),!0}return!1},i.prototype.enumValues=function(e){return Object.keys(e).map((function(t){return e[t]}))},i}(),h=s(4734),f=s(4629),p=s(6266),v=s(531),m=s(1240),g=s(8093);!function(e){e[e.external=0]="external",e[e.msa=1]="msa",e[e.aad=2]="aad"}(i||(i={})),function(e){e.init="SharedAuth_Init",e.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons",e.tryGetToken="SharedAuth_TryGetToken",e.tryLogin="SharedAuth_TryLogin"}(r||(r={})),function(e){e.closeDialog="SharedAuth_CloseDialog",e.getTokenResponse="SharedAuth_GetTokenResponse",e.hideDialog="SharedAuth_HideDialog",e.interactiveFlowReady="SharedAuth_InteractiveFlowReady",e.loginResponse="SharedAuth_LoginResponse",e.scriptInitialized="SharedAuth_ScriptInitialized",e.scriptLoaded="SharedAuth_ScriptLoaded"}(o||(o={})),function(e){e.registerPrimary="SharedAuthWorker_RegisterPrimary",e.unregisterPrimary="SharedAuthWorker_UnregisterPrimary",e.getToken="SharedAuthWorker_GetToken",e.postToken="SharedAuthWorker_PostToken"}(c||(c={})),function(e){e.registrationResponse="SharedAuthWorker_RegistrationResponse",e.brokerToken="SharedAuthWorker_BrokerToken",e.tokenReady="SharedAuthWorker_TokenReady",e.noPrimaryReady="SharedAuthWorker_NoPrimaryReady"}(u||(u={})),function(e){e.timeout="Timeout",e.general="Token Renewal Failed",e.renewal="token_renewal_error"}(l||(l={}));var w=new URL(window.location.href),y=function(){function e(){var e=this;this.startTime=0,this.xs=function(){},this.qs=function(){},this.promise=new Promise((function(t,n){e.xs=t,e.qs=n}))}return e.prototype.resolve=function(e){this.xs(e)},e.prototype.reject=function(e){this.qs(e)},e}();!function(){function e(e,t){var i=this;this.Ls=0,this.Ws=0,this.initAuthLibrary=function(e){return(0,n.mG)(i,void 0,void 0,(function(){var t,i;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:t=this.storePromiseWrapper("initAuthLibrary"),n.label=1;case 1:return n.trys.push([1,3,,4]),this.Gs=e,[4,this.$s];case 2:return n.sent(),this.zs.contentWindow&&this.zs.contentWindow.postMessage(JSON.stringify({MessageId:r.init,Values:{upn:this.Gs.upn,authority:this.Gs.authority,interactive:this.Gs.interactive,authorityType:this.Gs.authorityType,appIds:this.Gs.appIds,enableConsoleLogging:this.Gs.enableConsoleLogging,enablePopupFlash:this.Gs.enablePopupFlash,skipUpnCheck:this.Gs.skipUpnCheck,correlationId:this.Js.getUserSessionId()}}),"*"),[3,4];case 3:throw i=n.sent(),this.Js.ULS.sendTraceTag(508929187,f.W.Ln,p.G.Error,"[AUTH-BOOTSTRAPPER] Error when initializing authLibrary: ".concat(i)),i;case 4:return[2,t]}}))}))},this.tryGetToken=function(e){return(0,n.mG)(i,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(n){t=this.storePromiseWrapper("tryGetToken");try{this.Vs=e,this.zs.contentWindow&&this.zs.contentWindow.postMessage(JSON.stringify({MessageId:r.tryGetToken,Values:{appId:this.Vs.appId,target:this.Vs.target,claims:this.Vs.claims,withPopup:this.Vs.withPopup,messageCorrelationId:this.Vs.messageCorrelationId}}),"*")}catch(e){this.Js.ULS.sendTraceTag(508929186,f.W.Ln,p.G.Error,"[AUTH-BOOTSTRAPPER] Error when trying to get token")}return[2,t]}))}))},this.receiveMessage=function(e){return(0,n.mG)(i,void 0,void 0,(function(){var t,i,r,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(e.origin!==this.Qs)return[2];t=JSON.parse(e.data),n.label=1;case 1:switch(n.trys.push([1,9,,10]),t.MessageId){case o.scriptLoaded:return[3,2];case o.scriptInitialized:return[3,3];case o.getTokenResponse:return[3,5]}return[3,7];case 2:return i=t.Values,r=performance.now()-this.Xs,this.Ys.scriptLoaded.resolve(),this.Js.ULS.sendTraceTag(508934364,f.W.Ln,p.G.Info,"[AUTH-BOOTSTRAPPER] WacOAuth.aspx loaded in ".concat(r," [success: ").concat(i.Success,"] [authLibrary: ").concat(i.AuthLibrary,"]")),[3,8];case 3:return[4,this.libraryInit(t.Values)];case 4:return n.sent(),this.Js.ULS.sendTraceTag(508859403,f.W.Ln,p.G.Info,"[AUTH-BOOTSTRAPPER] Script initialized"),[3,8];case 5:return[4,this.handleTokenResponse(t.Values)];case 6:return n.sent(),this.Js.ULS.sendTraceTag(508859402,f.W.Ln,p.G.Info,"[AUTH-BOOTSTRAPPER] getToken response received"),[3,8];case 7:this.Js.ULS.sendTraceTag(508934362,f.W.Ln,p.G.Info,"[AUTH-BOOTSTRAPPER] Unsupported Message ID, ".concat(t.MessageId)),n.label=8;case 8:return[3,10];case 9:return s=n.sent(),this.Js.ULS.sendTraceTag(508934361,f.W.Ln,p.G.Error,"[AUTH-BOOTSTRAPPER] Caught error trying to process PostMessage, ".concat(t.MessageId,": ").concat((a=s)instanceof Error?"".concat(a.name,": ").concat(a.message):"string"==typeof a?a:JSON.stringify(a))),[3,10];case 10:return[2]}var a}))}))},this.Js=null!=t?t:this.createLogger(e),this.Ys={},this.$s=this.storePromiseWrapper("scriptLoaded");var s="".concat(this.getAuthUrlForEnvironment(e),"?replyUrl=&webworker=1&standalone=1&usid=").concat(this.Js.getUserSessionId());if(this.zs=document.createElement("iframe"),this.Qs=new URL(s).origin,this.zs.src=s,this.zs.style.cssText="height:0; width:0; display:none;",window.addEventListener("message",this.receiveMessage),this.Xs=performance.now(),document.body.appendChild(this.zs),!this.zs.contentWindow)throw this.Js.ULS.sendTraceTag(508934363,f.W.Ln,p.G.Error,"[AUTH-BOOTSTRAPPER] The shared auth iframe has no contentWindow"),new Error("iframe has no contentWindow")}e.prototype.createLogger=function(e){var t,n={remoteUlsEndpoint:this.getLogUrlForEnvironment(e),sessionId:null!==(t=w.searchParams.get("usid"))&&void 0!==t?t:void 0};return(0,h.L8)(n)},e.prototype.libraryInit=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(n){return t=this.Ys.initAuthLibrary,e.isSuccess?(t.resolve(!0),this.Ls=performance.now()-t.startTime,this.Js.ULS.sendTraceTag(508569551,f.W.Ln,p.G.Info,"[AUTH-BOOTSTRAPPER] Auth library init succeeded, ".concat(this.Ls)),[2,e.response]):(t.reject(!1),this.Js.ULS.sendTraceTag(508934360,f.W.Ln,p.G.Error,"[AUTH-BOOTSTRAPPER] Auth library init failed"),[2])}))}))},e.prototype.handleTokenResponse=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(n){if(t=this.Ys.tryGetToken,e.isSuccess){if(t.resolve(!0),this.Ws=performance.now()-t.startTime,this.Js.ULS.sendTraceTag(508569550,f.W.Ln,p.G.Info,"[AUTH-BOOTSTRAPPER] Get token time, ".concat(this.Ws)),i=window.location.href,new Array("https://www.office.com").includes(i))return[2,e.response];this.Js.ULS.sendTraceTag(508934359,f.W.Ln,p.G.Warning,"[AUTH-BOOTSTRAPPER] Untrusted frame, cannot send token back")}else t.reject(!1),this.Js.ULS.sendTraceTag(508934358,f.W.Ln,p.G.Error,"[AUTH-BOOTSTRAPPER] Get token failed");var i;return[2]}))}))},e.prototype.storePromiseWrapper=function(e){var t=new y;return t.startTime=performance.now(),this.Ys[e]=t,t.promise},e.prototype.getAuthUrlForEnvironment=function(e){switch(e){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/WacOAuth.aspx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/WacOAuth.aspx";case"PRODUCTION":return"https://oauth.online.office.com/oa/WacOAuth.aspx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/WacOAuth.aspx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/WacOauth.aspx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/WacOauth.aspx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/WacOAuth.aspx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/WacOAuth.aspx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/WacOAuth.aspx"}},e.prototype.getLogUrlForEnvironment=function(e){switch(e){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/RemoteUls.ashx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/RemoteUls.ashx";case"PRODUCTION":return"https://oauth.online.office.com/oa/RemoteUls.ashx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/RemoteUls.ashx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/RemoteUls.ashx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/RemoteUls.ashx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/RemoteUls.ashx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/RemoteUls.ashx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/RemoteUls.ashx"}}}();var _,C,S=s(2009),k=s(559),b=s(2738),T=s(2124),A=s(1806),I=new RegExp("(^| )".concat("OwlFrameMode","=([^;]+)")),E="/suite/WebLoader.aspx",R="",N=function(){function e(){}return Object.defineProperty(e,"isOwlFrame",{get:function(){return"boolean"==typeof e.Zs?e.Zs:"https:"===location.protocol&&location.origin.indexOf("common.online.office.com")>-1&&location.pathname===E},enumerable:!1,configurable:!0}),e.isOwlFrameExperimentEnabled=function(t,n){return"boolean"==typeof e.ea?e.ea:t?(e.ea=!e.isOwlFrame&&(0,T.vJ)(T.Fh.FeatureGate_EnableOwlFrameExperimentTreatment,t),(0,T.dt)(T.Fh.FeatureGate_EnableOwlFrameExperimentTreatment,e.ea,n),e.ea):(e.ea=!1,e.ea)},e.isOwlFrameBootEnabled=function(t,n){return void 0!==e.ta?e.ta:t?(e.ta=!e.isOwlFrame&&(0,T.vJ)(T.Fh.FeatureGate_EnableOwlFrameBootTreatment,t),(0,T.dt)(T.Fh.FeatureGate_EnableOwlFrameBootTreatment,e.ta,n),e.ta):(e.ta=!1,e.ta)},e.showOwlFrame=function(t,n){return e.isOwlFrameExperimentEnabled(t,n)&&e.isOwlFrameBootEnabled(t,n)},e.checkOwlFrameCookie=function(e,t){if(t&&"FASTFOOD"===e){var n=document.cookie.match(I);if(n){var i=n[2];"0"===i?(t.delete(T.Fh.FeatureGate_EnableOwlFrameExperiment),t.delete(T.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),t.delete(T.Fh.FeatureGate_EnableOwlFrameBoot),t.delete(T.Fh.FeatureGate_EnableOwlFrameBootTreatment)):"1"===i?(t.delete(T.Fh.FeatureGate_EnableOwlFrameExperiment),t.set(T.Fh.FeatureGate_EnableOwlFrameExperimentTreatment,!0),t.delete(T.Fh.FeatureGate_EnableOwlFrameBoot),t.delete(T.Fh.FeatureGate_EnableOwlFrameBootTreatment)):"2"===i?(t.delete(T.Fh.FeatureGate_EnableOwlFrameExperiment),t.delete(T.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),t.delete(T.Fh.FeatureGate_EnableOwlFrameBoot),t.set(T.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0)):"3"===i&&(t.delete(T.Fh.FeatureGate_EnableOwlFrameExperiment),t.delete(T.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),t.delete(T.Fh.FeatureGate_EnableOwlFrameBoot),t.set(T.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0),t.set(T.Fh.FeatureGate_EcsHootGate,!0),R="https://login.microsoftonline.com/")}}},e}();function P(e,t,n,i,r,o){return"Frame Experiment Status: ".concat(N.isOwlFrameExperimentEnabled(n,o)?"TREATMENT":"CONTROL",", Boot Experiment Status: ").concat(N.isOwlFrameBootEnabled(n,o)?"TREATMENT":"CONTROL",", FileType: ").concat(e,", Environment: ").concat(t,", Feature Gates: ").concat(n?(0,A.d)(n):"{}",", UiHost: ").concat(i,", Integration Type: ").concat(r)}!function(e){e.OwlBootAppMessageSend="owlBootAppMessageSend",e.OwlBootAppMessageReceive="owlBootAppMessageReceive",e.OwlLoadedMessageSend="owlLoadedMessageSend",e.OwlLoadedMessageReceive="owlLoadedMessageReceive",e.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",e.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",e.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",e.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",e.OwlStart="owlStart",e.OwlEnd="owlEnd",e.OwlHostTimeOrigin="owlHostTimeOrigin",e.OwlFrameTimeOrigin="owlFrameTimeOrigin",e.OwlWacBootStart="owlWacBootStart",e.OwlOnBootComplete="owlOnBootComplete",e.OwlCreateFrameStart="owlCreateFrameStart",e.OwlCreateFrameEnd="owlCreateFrameEnd",e.OwlTokenFetchingExperimentMessageSend="owlTokenFetchingExperimentMessageSend",e.OwlTokenFetchingExperimentMessageReceived="owlTokenFetchingExperimentMessageReceived",e.OwlMsalInitStart="owlMsalInitStart",e.OwlMsalInitEnd="owlMsalInitEnd",e.OwlMsalSsoSilentStart="owlMsalSsoSilentStart",e.OwlMsalSsoSilentEnd="owlMsalSsoSilentEnd",e.OwlMsalLoginPopupStart="owlMsalLoginPopupStart",e.OwlMsalLoginPopupEnd="owlMsalLoginPopupEnd",e.OwlGetDriveItemWithMsalStart="owlGetDriveItemWithMsalStart",e.OwlGetDriveItemWithMsalEnd="owlGetDriveItemWithMsalEnd",e.OwlTryGetWacTokenStart="owlTryGetWacTokenStart",e.OwlTryGetWacTokenEnd="owlTryGetWacTokenEnd",e.OwlTryGetWacTokenPopupStart="owlTryGetWacTokenPopupStart",e.OwlTryGetWacTokenPopupEnd="owlTryGetWacTokenPopupEnd",e.OwlTryGetWacTokenFromCacheEnd="owlTryGetWacTokenFromCacheEnd",e.OwlGetDriveItemStart="owlGetDriveItemStart",e.OwlGetDriveItemEnd="owlGetDriveItemEnd",e.OwlAddFrameToDOM="owlAddFrameToDOM",e.OwlFrameScriptExecutionStart="owlFrameScriptExecutionStart",e.OwlGetAccountByUsernameStart="owlGetAccountByUsernameStart",e.OwlGetAccountByUsernameEnd="owlGetAccountByUsernameEnd"}(_||(_={})),function(e){e.OwlCreateFrame="OwlCreateFrame",e.OwlTokenFetchingExperimentMessage="OwlTokenFetchingExperimentMessage",e.OwlMsalInit="OwlMsalInit",e.OwlMsalSsoSilent="OwlMsalSsoSilent",e.OwlGetDriveItemWithMsal="OwlGetDriveItemWithMsal",e.OwlTryGetWacToken="OwlTryGetWacToken",e.OwlTryGetWacTokenFromCache="OwlTryGetWacTokenFromCache",e.OwlGetDriveItem="OwlGetDriveItem",e.OwlGetAccountByUsername="OwlGetAccountByUsername"}(C||(C={}));var H,O,U=[{measureName:C.OwlCreateFrame,measureStart:_.OwlCreateFrameStart,measureEnd:_.OwlCreateFrameEnd}],M=[{measureName:C.OwlTokenFetchingExperimentMessage,measureStart:_.OwlTokenFetchingExperimentMessageSend,measureEnd:_.OwlTokenFetchingExperimentMessageReceived},{measureName:C.OwlMsalInit,measureStart:_.OwlMsalInitStart,measureEnd:_.OwlMsalInitEnd},{measureName:C.OwlMsalSsoSilent,measureStart:_.OwlMsalSsoSilentStart,measureEnd:_.OwlMsalSsoSilentEnd},{measureName:C.OwlGetDriveItemWithMsal,measureStart:_.OwlGetDriveItemWithMsalStart,measureEnd:_.OwlGetDriveItemWithMsalEnd},{measureName:C.OwlTryGetWacToken,measureStart:_.OwlTryGetWacTokenStart,measureEnd:_.OwlTryGetWacTokenEnd},{measureName:C.OwlGetDriveItem,measureStart:_.OwlGetDriveItemStart,measureEnd:_.OwlGetDriveItemEnd},{measureName:C.OwlTryGetWacTokenFromCache,measureStart:_.OwlTryGetWacTokenStart,measureEnd:_.OwlTryGetWacTokenFromCacheEnd},{measureName:C.OwlGetAccountByUsername,measureStart:_.OwlGetAccountByUsernameStart,measureEnd:_.OwlGetAccountByUsernameEnd}];function D(){var e,t,i=N.isOwlFrame?M:U;try{for(var r=(0,n.XA)(i),o=r.next();!o.done;o=r.next()){var s=o.value;F(s.measureName,s.measureStart,s.measureEnd)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}function F(e,t,n){var i,r,o;(null===(i=null===performance||void 0===performance?void 0:performance.getEntriesByName)||void 0===i?void 0:i.call(performance,t).length)>0&&(null===(r=null===performance||void 0===performance?void 0:performance.getEntriesByName)||void 0===r?void 0:r.call(performance,n).length)>0&&(null===(o=performance.measure)||void 0===o||o.call(performance,e,t,n))}function x(e){var t,n,i,r,o,s,a,c;void 0===e&&(e="");var u=N.isOwlFrame?null===(i=null===(n=null===(t=null===window||void 0===window?void 0:window.performance)||void 0===t?void 0:t.getEntriesByName)||void 0===n?void 0:n.call(t,_.OwlFrameTimeOrigin)[0])||void 0===i?void 0:i.detail:null===(s=null===(o=null===(r=null===window||void 0===window?void 0:window.performance)||void 0===r?void 0:r.getEntriesByName)||void 0===o?void 0:o.call(r,_.OwlHostTimeOrigin)[0])||void 0===s?void 0:s.detail;return null===(c=null===(a=null===window||void 0===window?void 0:window.performance)||void 0===a?void 0:a.getEntriesByType)||void 0===c?void 0:c.call(a,"mark").filter((function(t){return t.name.startsWith(e)})).reduce((function(e,t){return t.name!==_.OwlFrameTimeOrigin&&t.name!==_.OwlHostTimeOrigin?e[t.name]=u+t.startTime:e[t.name]=u,e}),{})}function q(e){var t;try{t=JSON.stringify((0,b.pb)())}catch(e){t="[]"}var i=(0,n.pi)({},x("owl"));return e&&(e.owlVersion&&(i.version=e.owlVersion),e.wiseEnvironment&&(i.environment=e.wiseEnvironment),e.exposure&&(i.exposure=e.exposure)),{bootTelemetryData:t,owlTelemetryData:JSON.stringify(i)}}function B(){var e,t;window.performance&&!((null===(e=window.performance.getEntriesByName(_.OwlHostTimeOrigin))||void 0===e?void 0:e.length)>0||(null===(t=window.performance.getEntriesByName(_.OwlFrameTimeOrigin))||void 0===t?void 0:t.length)>0)&&window.performance.mark("".concat(N.isOwlFrame?_.OwlFrameTimeOrigin:_.OwlHostTimeOrigin),{startTime:0,detail:window.performance.timeOrigin})}function L(e){var t,i,r,o,s,a,c,u,l,d,h,f,p,v,m,g,w,y,_,C,S,k,T,A,I,E,R,N,P,H,O,U,M,D,F,x,q;return{documentIdentifier:e.documentIdentifier,sessionConfig:{hostCorrelationId:e.sessionConfig.hostCorrelationId,isMsa:e.sessionConfig.isMsa,tenantId:e.sessionConfig.tenantId,organizationName:e.sessionConfig.organizationName,sessionId:e.sessionConfig.sessionId,isESSEnabled:e.sessionConfig.isESSEnabled,experiments:e.sessionConfig.experiments,highContrastMode:e.sessionConfig.highContrastMode,additionalApplicationParameters:e.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(t=e.sessionConfig.bootDiagnostics)||void 0===t?void 0:t.tabsCacheHit,packageEntryTime:null===(i=e.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime,isTestMode:null===(r=e.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isTestMode,isManifestCachingEnabled:null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(s=e.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isOwlBootstrapperEnabled,isPrebooted:null===(a=e.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(c=e.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.isVroom21,ringId:null===(u=e.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.ringId,teamsContextStartTime:null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.teamsContextStartTime,teamsContextEndTime:null===(d=e.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(h=e.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.wopiDataStartTime,wopiDataEndTime:null===(f=e.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataEndTime,bootStrapStartTime:null===(p=e.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapStartTime,bootStrapEndTime:null===(v=e.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.bootStrapEndTime,driveItemStartTime:null===(m=e.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(g=e.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemEndTime,driveItemFromWacStartTime:null===(w=e.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(y=e.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.driveItemFromWacEndTime,accessTokenStartTime:null===(_=e.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.accessTokenStartTime,accessTokenEndTime:null===(C=e.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.accessTokenEndTime,isCookieBlocked:null===(S=e.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.isCookieBlocked,meetingLiveDiagnostics:null===(k=e.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.meetingLiveDiagnostics,spRequestGuid:null===(T=e.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.spRequestGuid,createNewStartTime:null===(A=e.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.createNewStartTime,createNewEndTime:null===(I=e.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.createNewEndTime,loadManifestStartTime:null===(E=e.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.loadManifestStartTime,loadManifestEndTime:null===(R=e.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.loadManifestEndTime,loadOwlStartTime:null===(N=e.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.loadOwlStartTime,loadOwlEndTime:null===(P=e.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.loadOwlEndTime,owlBootstrapperStartTime:null===(H=e.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(O=e.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.owlBootstrapperEndTime,isOdcMigrated:null===(U=e.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.isOdcMigrated,perfNavigationTiming:(null===(M=e.sessionConfig.bootDiagnostics)||void 0===M?void 0:M.perfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:(null===(F=null===(D=e.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.legacyPerformanceData)||void 0===F?void 0:F.host)||(0,b.vb)()}},uiHostTabId:e.sessionConfig.uiHostTabId,upn:e.sessionConfig.upn,meeting:e.sessionConfig.meeting,customAuthConfigValue:e.sessionConfig.customAuthConfigValue,wiseEnvironment:e.sessionConfig.wiseEnvironment,isSynthetic:e.sessionConfig.isSynthetic,hostUrl:e.sessionConfig.hostUrl,owlVersion:e.sessionConfig.owlVersion,owlRollout:e.sessionConfig.owlRollout,fileType:e.sessionConfig.fileType,clickTime:e.sessionConfig.clickTime,uiCulture:e.sessionConfig.uiCulture,dataCulture:e.sessionConfig.dataCulture,puid:e.sessionConfig.puid,isNewFile:e.sessionConfig.isNewFile,wdValue:e.sessionConfig.wdValue,sessionOrigin:e.sessionConfig.sessionOrigin,intent:e.sessionConfig.intent,hostClientType:e.sessionConfig.hostClientType,isPopOut:e.sessionConfig.isPopOut,teamType:e.sessionConfig.teamType,initPackageParams:e.sessionConfig.initPackageParams&&(0,n.pi)((0,n.pi)({},e.sessionConfig.initPackageParams),{jsApiUrlInfos:(null===(x=e.sessionConfig.initPackageParams)||void 0===x?void 0:x.jsApiUrlInfos)&&ue(null===(q=e.sessionConfig.initPackageParams)||void 0===q?void 0:q.jsApiUrlInfos)})},uiHostConfig:(0,n.pi)((0,n.pi)({},e.uiHostConfig),{featureGates:e.uiHostConfig.featureGates&&ue(e.uiHostConfig.featureGates)})}}function W(e){var t,i,r,o,s,a,c,u;return(0,n.mG)(this,void 0,void 0,(function(){var l,d,h,f,p,v,m;return(0,n.Jh)(this,(function(g){switch(g.label){case 0:return null===(r=null===(i=null===(t=e.sharingLinkTokenProvider)||void 0===t?void 0:t.TokenPromise)||void 0===i?void 0:i.then)||void 0===r||r.call(i,(function(e){l=e})).catch((function(e){d=e})).finally((function(){return null==ef?void 0:ef.sendMessage({id:O.SharingLinkTokenProvider,data:{token:l,error:d}})})),v={documentBootInfo:e.documentBootInfo},h=[(0,n.pi)({},e.sessionConfig)],m={},"string"!=typeof e.sessionConfig.customAuthConfigValue?[3,1]:(f=e.sessionConfig.customAuthConfigValue,[3,3]);case 1:return[4,e.sessionConfig.customAuthConfigValue];case 2:f=g.sent(),g.label=3;case 3:return m.customAuthConfigValue=f,"string"!=typeof e.sessionConfig.hostUrl?[3,4]:(p=e.sessionConfig.hostUrl,[3,6]);case 4:return[4,e.sessionConfig.hostUrl];case 5:p=g.sent(),g.label=6;case 6:return[2,(v.sessionConfig=n.pi.apply(void 0,h.concat([(m.hostUrl=p,m.bootDiagnostics=(0,n.pi)((0,n.pi)({},e.sessionConfig.bootDiagnostics),{perfNavigationTiming:(null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.perfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:(null===(s=e.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.legacyPerformanceData)||{host:(0,b.vb)()}}),m.logger=void 0,m.health=void 0,m)])),v.uiHostConfig=(0,n.pi)((0,n.pi)({},e.uiHostConfig),{featureGates:(null===(a=e.uiHostConfig)||void 0===a?void 0:a.featureGates)&&ue(e.uiHostConfig.featureGates)}),v.additionalApplicationParameters=e.additionalApplicationParameters,v.sharingLinkTokenProvider=!!e.sharingLinkTokenProvider,v.initPackageParams=e.initPackageParams&&(0,n.pi)((0,n.pi)({},e.initPackageParams),{jsApiUrlInfos:(null===(c=e.initPackageParams)||void 0===c?void 0:c.jsApiUrlInfos)&&ue(null===(u=e.initPackageParams)||void 0===u?void 0:u.jsApiUrlInfos)}),v)]}}))}))}function j(e,t){(0,v.l)(_.OwlOnBootComplete),null==tf||tf.sendMessage({id:H.BootComplete,data:{docInfo:e,wacBootDiagnostics:t}}),function(){var e=q(),t=e.bootTelemetryData,n=e.owlTelemetryData;null==tf||tf.sendMessage({id:H.TelemetryData,data:{bootTelemetryData:t,owlTelemetryData:n}})}()}function K(e,t){null==tf||tf.sendMessage({id:H.BootFailure,data:{errorInfo:e,docInfo:t}})}function G(e){null==tf||tf.sendMessage({id:H.ReturnFocus,data:{navigateForward:e}})}function $(){null==tf||tf.sendMessage({id:H.DocumentClose,data:{}})}function z(){null==tf||tf.sendMessage({id:H.SuccessNotification,data:{}})}function J(e,t){null==tf||tf.sendMessage({id:H.OpenInMobileApp,data:{openInAppUrl:e,storeUrl:t}})}function V(e,t,i,r){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,nf.getMessagePromise(O.FetchItemFromNetworkResponse,{id:H.FetchItemFromNetwork,data:{docBootInfo:e,forceRefresh:t,zeroByte:i}})]}))}))}function Q(e,t,i,r,o,s,a){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,nf.getMessagePromise(O.FetchAccessTokenResponse,{id:H.FetchAccessToken,data:{tokenConsumer:e,forceFetch:t,resourceUrl:i,scope:r,isBoot:o,claims:s,silent:a}})]}))}))}function X(e,t){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,nf.getMessagePromise(O.OpenShareControlResponse,{id:H.OpenShareControl,data:{shareProps:e,isShareDialogueZoomEnabled:t}})]}))}))}function Y(e,t){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,nf.getMessagePromise(O.CreateDocumentResponse,{id:H.CreateDocument,data:{createNewInfo:e,template:t}})]}))}))}function Z(e){null==tf||tf.sendMessage({id:H.SetTitle,data:{title:e}})}function ee(){null==tf||tf.sendMessage({id:H.UserActivity,data:{}})}function te(){var e=document.createElement("div");return e.id="owl-container",e}function ne(e){null==tf||tf.sendMessage({id:H.UserActivity,data:e})}function ie(e){null==tf||tf.sendMessage({id:H.UserAccess,data:e})}function re(e){null==tf||tf.sendMessage({id:H.MoveToFolder,data:e})}function oe(e){null==tf||tf.sendMessage({id:H.SharedFilePicker,data:e})}function se(e){null==tf||tf.sendMessage({id:H.Rename,data:{newName:e}})}function ae(e){null==tf||tf.sendMessage({id:H.FrameChange,data:e})}function ce(){null==tf||tf.sendMessage({id:H.FileEmbed,data:{}})}function ue(e){return JSON.stringify(Array.from(e.entries()))}function le(e){if(e)try{return new Map(JSON.parse(e))}catch(e){return}}!function(e){e.FrameLoaded="Frame_FrameLoaded",e.GetAuthToken="Frame_GetAuthToken",e.BootComplete="Frame_BootComplete",e.SuccessNotification="Frame_OnSuccessNotification",e.BootFailure="Frame_BootFailure",e.ReturnFocus="Frame_ReturnFocus",e.DocumentClose="Frame_DocumentClose",e.OpenInMobileApp="Frame_OpenInMobileApp",e.FetchItemFromNetwork="Frame_FetchItemFromNetwork",e.FetchAccessToken="Frame_FetchAccessToken",e.OpenShareControl="Frame_OpenShareControl",e.CreateDocument="Frame_CreateDocument",e.SetTitle="Frame_SetTitle",e.UserActivity="Frame_UserActivity",e.CAAEMessage="Frame_CAAEMessage",e.UserAccess="Frame_UserAccess",e.MoveToFolder="Frame_MoveToFolder",e.SharedFilePicker="Frame_SharedFilePicker",e.Rename="Frame_Rename",e.FrameChange="Frame_FrameChange",e.InvokeSessionRefreshInfoPopupBlockedDialog="Frame_InvokeSessionRefreshInfoPopupBlockedDialog",e.FileEmbed="Frame_FileEmbed",e.EndSessionResponse="Frame_EndSessionResponse",e.EndSessionObservable="Frame_EndSessionObservable",e.TelemetryData="Frame_TelemetryData"}(H||(H={})),function(e){e.BootApplication="Host_BootApplication",e.BootApplicationWithCustomFunctions="Host_BootApplicationWithCustomFunctions",e.GetAuthTokenResponse="Host_GetAuthTokenResponse",e.EndSession="Host_EndSession",e.HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.GetClientUrl="Host_GetClientUrl",e.GetWebUrl="Host_GetWebUrl",e.FetchItemFromNetworkResponse="Host_FetchItemFromNetworkResponse",e.FetchAccessTokenResponse="Host_FetchAccessTokenResponse",e.OpenShareControlResponse="Host_OpenShareControlResponse",e.CreateDocumentResponse="Host_CreateDocumentResponse",e.SessionRefreshInfoDialogHandleRefresh="Host_SessionRefreshInfoDialogHandleRefresh",e.SessionRefreshInfoDialogHandleCancel="Host_SessionRefreshInfoDialogHandleCancel",e.SessionRefreshInfoDialogOnDismiss="Host_SessionRefreshInfoDialogOnDismiss",e.SharingLinkTokenProvider="Host_SharingLinkTokenProvider",e.TelemetryData="Host_TelemetryData",e.TokenFetchingExperiment="Host_TokenFetchingExperiment"}(O||(O={}));var de,he=s(4153);function fe(e,t,n,i,r){var o=e.onBootComplete,s=e.onBootFailure,a=e.onSuccessNotification,c=e.onReturnFocus,u=e.onDocumentClose,l=e.onOpenInMobileApp,d=new he.xQ;return null==ef||ef.registerHandler(H.EndSessionObservable,(function(e){d.next(e.data.rebootInfo),d.complete()})),null==ef||ef.registerHandler(H.BootComplete,(function(e){var t=e.data,n=t.docInfo,i=t.wacBootDiagnostics;null==o||o(n,i)})),null==ef||ef.registerHandler(H.BootFailure,(function(e){return null==s?void 0:s(e.data.errorInfo,e.data.docInfo)})),null==ef||ef.registerHandler(H.ReturnFocus,(function(e){return null==c?void 0:c(e.data.navigateForward)})),null==ef||ef.registerHandler(H.SuccessNotification,(function(e){return null==a?void 0:a()})),null==ef||ef.registerHandler(H.DocumentClose,(function(e){return null==u?void 0:u()})),null==ef||ef.registerHandler(H.OpenInMobileApp,(function(e){var t;return null==l?void 0:l(e.data.openInAppUrl,null!==(t=e.data.storeUrl)&&void 0!==t?t:"")})),null==ef||ef.registerHandler(H.EndSessionResponse,(function(e){rf.getHandler(H.EndSessionResponse,de.Result)(e),lf()})),null==ef||ef.registerHandler(H.TelemetryData,(function(e){!function(e,t,n,i,r){var o=q(),s=o.bootTelemetryData,a=o.owlTelemetryData;null==ef||ef.sendMessage({id:O.TelemetryData,data:{context:P(t,n,null==i?void 0:i.featureGates,null==i?void 0:i.uiHostName,null==i?void 0:i.uiHostIntegrationType,r),hostData:{bootTelemetryData:s,owlTelemetryData:a},frameData:e}})}(e.data,t.fileType,n,i,r)})),d.asObservable()}!function(e){e.Item="item",e.Response="response",e.Result="result",e.Token="token",e.URL="url"}(de||(de={}));var pe=s(7702),ve=s(5461),me=s(5157),ge=s(1432),we=function(){var e=void 0;try{e=window.localStorage}catch(e){}return e}(),ye="officecom";function _e(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function Ce(e){switch((0,ge.aE)(e)){case ge.o4.OneDrive:return"OneDrive";case ge.o4.SharePoint:return"SharePoint Online";default:return"Unknown"}}function Se(e,t,i,r,o,s,a){void 0===r&&(r={startTime:0,endTime:0}),void 0===o&&(o={startTime:0,endTime:0});var c=window.performance.timing,u=window.performance.navigation,l=u.redirectCount||0,d=c.navigationStart||0,h=c.fetchStart||0,f=c.responseEnd||0,p=c.requestStart||0,v=c.responseStart||0,m=c.responseEnd||0,g=c.domComplete||0,w="UNKNOWN";switch(u.type){case 0:w="NAVIGATE";break;case 1:w="RELOAD";break;case 2:w="BACK_FORWARD";break;case 255:w="RESERVED"}return(0,n.pi)((0,n.pi)({},ke(e,t,i,r,o,s,a)),{hostPageNavigationStartTime:d,hostPageFetchStartTime:h,hostPageFetchEndTime:f,hostPageRequestStartTime:p,hostPageResponseStartTime:v,hostPageResponseEndTime:m,hostPageDomCompleteTime:g,hostPageRedirectCount:l,hostPageNavigationType:w})}function ke(e,t,i,r,o,s,a){void 0===r&&(r={startTime:0,endTime:0}),void 0===o&&(o={startTime:0,endTime:0});var c=o.startTime||0,u=o.endTime||0,l=(0,v.a)();(0,v.l)("officeInitializationTime");var d,h,m=null==s?void 0:s.logger,g=(null==s?void 0:s.bootDiagnostics)||{},w=g.tabsCacheHit,y=g.packageEntryTime,_=g.isTestMode,C=g.ringId;e&&(d=l-e),y&&(h=l-y);var S=(0,n.pi)((0,n.pi)((0,n.pi)({},g),me.c),{bootStrapStartTime:(null==o?void 0:o.startTime)||0,bootStrapEndTime:(null==o?void 0:o.endTime)||0,wopiDataStartTime:(null==r?void 0:r.startTime)||0,wopiDataEndTime:(null==r?void 0:r.endTime)||0,isCookieBlocked:!we,createNewEndTime:g.createNewStartTime?(0,v.a)():void 0,owlFeatureGates:a?(0,A.d)(a):void 0});return me.c.accessTokenStartTime=void 0,me.c.accessTokenEndTime=void 0,me.c.driveItemStartTime=void 0,me.c.driveItemEndTime=void 0,me.c.driveItemFromWacStartTime=void 0,me.c.driveItemFromWacEndTime=void 0,me.c.spRequestGuid=void 0,me.c.createNewStartTime=void 0,me.c.createNewEndTime=void 0,me.c.loadManifestStartTime=void 0,me.c.loadManifestEndTime=void 0,me.c.loadOwlStartTime=void 0,me.c.loadOwlEndTime=void 0,me.c.isVroom21=!1,null==m||m.ULS.sendTraceTag(556613895,f.W.zn,p.G.Info,"getDiagnostics: [SessionOrigin: ".concat(i,"][TabsCacheHit: ").concat(w,"][IsTestMode: ").concat(_,"][RingId: ").concat(C,"][TimeElapsedSinceUserClick:").concat(d,"][TimeElapsedSincePackageEntry: ").concat(h,"]")),{entryPoint:i,hostPageFirstFlushTime:t,userClickTime:e,officeBootstrapperStartTime:c,officeBootstrapperEndTime:u,officeInitializationTime:l,unifiedUiHostDiagnostics:S}}function be(e,t){var n="UNKNOWN";switch(null==e?void 0:e.navigation.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}var i="UNKNOWN";switch(null==t?void 0:t.navigation.type){case 0:i="NAVIGATE";break;case 1:i="RELOAD";break;case 2:i="BACK_FORWARD";break;case 255:i="RESERVED"}return{hostPageNavigationStartTime:(null==e?void 0:e.timing.navigationStart)||0,hostPageFetchStartTime:(null==e?void 0:e.timing.fetchStart)||0,hostPageFetchEndTime:(null==e?void 0:e.timing.responseEnd)||0,hostPageRequestStartTime:(null==e?void 0:e.timing.responseEnd)||0,hostPageResponseStartTime:(null==e?void 0:e.timing.responseStart)||0,hostPageResponseEndTime:(null==e?void 0:e.timing.responseEnd)||0,hostPageDomCompleteTime:(null==e?void 0:e.timing.domComplete)||0,hostPageRedirectCount:(null==e?void 0:e.navigation.redirectCount)||0,hostPageNavigationType:n,owlFramePageNavigationStartTime:(null==t?void 0:t.timing.navigationStart)||0,owlFramePageFetchStartTime:(null==t?void 0:t.timing.fetchStart)||0,owlFramePageFetchEndTime:(null==t?void 0:t.timing.responseEnd)||0,owlFramePageRequestStartTime:(null==t?void 0:t.timing.responseEnd)||0,owlFramePageResponseStartTime:(null==t?void 0:t.timing.responseStart)||0,owlFramePageResponseEndTime:(null==t?void 0:t.timing.responseEnd)||0,owlFramePageDomCompleteTime:(null==t?void 0:t.timing.domComplete)||0,owlFramePageRedirectCount:(null==t?void 0:t.navigation.redirectCount)||0,owlFramePageNavigationType:i}}var Te=function(e){var t=new URL(e);return t.searchParams.delete("wopisrc"),t.href};function Ae(e){return function(t){var n=t;switch(t){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":n="unifiedUiHostInTeams"}if((null==e?void 0:e.experiments)&&n in(null==e?void 0:e.experiments))return function(e){switch(e){case 0:return!1;case 1:return!0;default:return}}(null==e?void 0:e.experiments[n])}}function Ie(e,t,n){switch(e){case k.T.Word:case k.T.PowerPoint:case k.T.Excel:return!0;case k.T.Visio:var i=(0,T.vJ)(T.Fh.FeatureGate_VisioJsApiV2Gate,t);return(0,T.dt)(T.Fh.FeatureGate_VisioJsApiV2Gate,i,n),i;default:return!1}}function Ee(e,t,n,i,r){var o,s,a=e?(null===(o=e.wac)||void 0===o?void 0:o.applicationUrl)||(null===(s=e.wac)||void 0===s?void 0:s.editUrl):Te(t);return a?function(e,t,n,i,r,o){var s="".concat(e,"&uih=").concat(t);return(null==o||o)&&(s="".concat(s,"&uiEmbed=1")),i&&(s="".concat(s,"&wdTpl=").concat(i)),r&&(s="".concat(s,"&wdlcid=").concat(r)),n&&(s="".concat(s,"&actNavId=").concat(n)),s}(a,n,i.navId,i.templateId,i.rebootOverrideData?i.rebootOverrideData.lcid:i.uiCulture,r):""}function Re(e){var t;return e?((t={}).wd=encodeURIComponent(e),t):{}}function Ne(e){switch(e){case"ring0":case"ring1":case"ring2":return"FASTFOOD";case"ring3_9":return"MSIT";case"general_gcc":return"USGOV";case"gcchigh":return"TRAILBLAZER";case"dod":return"PATHFINDER";case"ag08":return"AIRGAP08";case"ag09":return"AIRGAP09";case"gallatin":return"GALLATIN";default:return"PRODUCTION"}}var Pe="PrebootDocument",He="owlfc";function Oe(e,t,n){var i=(0,v.a)(),r=(0,h.L8)(),o=(0,pe.q_)(e);if(o)if(we){var s=we.getItem(o);if(s)null==r||r.ULS.sendTraceTag(545036514,f.W.zn,p.G.Verbose,"prebootDocument: Session is already prebooted with sessionid: "+s);else{var a=(0,g.n)()[0];we.setItem(o,a);var c=new b.zP(a,e.fileType,n).health;null==c||c.updatePartADimensions({applicationLcid:e.uiCulture,loggableUserId:e.puid,sessionOrigin:e.wdOrigin}),null==c||c.addOrUpdatePartCDimension("IsNewFile",(!!e.isNewFile).toString());var u=new Map;u.set("StartTime",(new Date).toUTCString()),null==c||c.recordKpiUsage(Pe,S.o.FailureBased,He,u),u.delete("StartTime"),(0,ve.o)(e,t,r).then((function(e){null==r||r.ULS.sendTraceTag(558158863,f.W.zn,p.G.Info,"prebootDocument: Attempting to preboot document with sessionid: "+a),function(e,t){var n;if(!e||!t)return!1;var i="access_token="+encodeURIComponent(t.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(t.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(null!==(n=t.bundleUrl)&&void 0!==n?n:"")+"&user_id="+encodeURIComponent(t.wac.userId),r=function(e){if(!e)return null;var t=(0,ge.k$)(e);if(!t)return null;var n=t.path.substring(0,t.path.lastIndexOf("/"))+"/preboot.ashx";return t.protocol+"//"+t.hostname+n}(t.wac.applicationUrl);if(!r)return!1;var o=encodeURIComponent(t.wac.wopiSrc),s=_e(),a=new XMLHttpRequest;return a.open("POST",r+"?op=preboot&usid="+encodeURI(e)+"&wopisrc="+o+"&sc="+s),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(i),!0}(a,e.wopiHostData)?r.ULS.sendTraceTag(558158864,f.W.zn,p.G.Info,"prebootDocument: Preboot request sent successfully with sessionid: "+a):(null==we||we.removeItem(o),r.ULS.sendTraceTag(545036515,f.W.zn,p.G.Info,"prebootDocument: Preboot request cannot be made with sessionid: "+a),u.set("FailureTime",(new Date).toUTCString()),null==c||c.recordKpiFailure(Pe,"PrebootRequestFailed",!1,!0,{durationMs:(0,v.a)()-i,extendedProperties:u}))})).catch((function(e){r.ULS.sendTraceTag(558158865,f.W.zn,p.G.Warning,"prebootDocument: Failed to send Preboot request with WacDocumentVroomError:"+JSON.stringify(e)),u.set("DriveItemError",JSON.stringify(e)),u.set("FailureTime",(new Date).toUTCString()),null==c||c.recordKpiFailure(Pe,"PrebootDriveItemRequestFailed",!1,!1,{durationMs:(0,v.a)()-i,extendedProperties:u}),null==we||we.removeItem(o)}))}}else null==r||r.ULS.sendTraceTag(527471828,f.W.zn,p.G.Warning,"prebootDocument: 3rd Party Cookie is blocked! Cannot perform preboot. Bail out.");else null==r||r.ULS.sendTraceTag(558158862,f.W.zn,p.G.Verbose,"prebootDocument: Not enough document information was provided. Cannot get unique identifier.")}function Ue(e,t,n){Oe(e,t,Ne(n))}function Me(e){var t=(0,pe.q_)(e);return t&&we?we.getItem(t):null}function De(e,t){if(t){var n=(0,pe.q_)(e);if(n)return null==we||we.removeItem(n),!0}return!1}var Fe=function(){function e(e){var t=this;this.na=!1,this.ia="",this.ra=[],this.oa=function(e){t.na||(t.na=!0,t.ia=e?"timeout":"cancelled",t.ra.map((function(e){return e()})),t.ra=[])},this.sa=e,window.setTimeout((function(){return t.oa(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.na},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.sa},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.ia},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.oa(!1)},e.prototype.subscribe=function(e){this.na?e():this.ra.push(e)},e}(),xe=s(2701),qe=s(2214),Be=function(e){function t(t){var n=e.call(this)||this;return n.ca=t,n}return xe.ZT(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype.O=function(t){var n=e.prototype.O.call(this,t);return n&&!n.closed&&t.next(this.ca),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new qe.N;return this.ca},t.prototype.next=function(t){e.prototype.next.call(this,this.ca=t)},t}(he.xQ),Le=s(8182),We=s(20),je=s(810),Ke=s(6899);function Ge(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new $e(e,t))}}var $e=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new ze(e,this.project,this.thisArg))},e}(),ze=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.project=n,r.count=0,r.thisArg=i||r,r}return xe.ZT(t,e),t.prototype.$=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Ke.L);function Je(e,t,n,i){return(0,je.m)(n)&&(i=n,n=void 0),i?Je(e,t,n).pipe(Ge((function(e){return(0,We.k)(e)?i.apply(void 0,e):i(e)}))):new Le.y((function(i){Ve(e,t,(function(e){arguments.length>1?i.next(Array.prototype.slice.call(arguments)):i.next(e)}),i,n)}))}function Ve(e,t,n,i,r){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var s=e;e.addEventListener(t,n,r),o=function(){return s.removeEventListener(t,n,r)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var a=e;e.on(t,n),o=function(){return a.off(t,n)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var c=e;e.addListener(t,n),o=function(){return c.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var u=0,l=e.length;u<l;u++)Ve(e[u],t,n,i,r)}i.add(o)}var Qe=s(7691);function Xe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var Ye=Xe(),Ze=s(377);var et=s(3559),tt=function(e){if(e&&"function"==typeof e[Ze.L])return o=e,function(e){var t=o[Ze.L]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((t=e)&&"number"==typeof t.length&&"function"!=typeof t)return r=e,function(e){for(var t=0,n=r.length;t<n&&!e.closed;t++)e.next(r[t]);e.complete()};var t;if(function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}(e))return i=e,function(e){return i.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,Qe.z),e};if(e&&"function"==typeof e[Ye])return n=e,function(e){for(var t=n[Ye]();;){var i=void 0;try{i=t.next()}catch(t){return e.error(t),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add((function(){t.return&&t.return()})),e};var n,i,r,o,s=(0,et.K)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+s+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},nt=s(1057),it=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return xe.ZT(t,e),t.prototype.$=function(e){this.parent.notifyNext(e)},t.prototype.X=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype.Z=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Ke.L),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xe.ZT(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Ke.L);function ot(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(i){return i.pipe(ot((function(n,i){return(r=e(n,i),r instanceof Le.y?r:new Le.y(tt(r))).pipe(Ge((function(e,r){return t(n,e,i,r)})));var r}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new st(e,n))})}var st=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new at(e,this.project,this.concurrent))},e}(),at=function(e){function t(t,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var r=e.call(this,t)||this;return r.project=n,r.concurrent=i,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return xe.ZT(t,e),t.prototype.$=function(e){this.active<this.concurrent?this.la(e):this.buffer.push(e)},t.prototype.la=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this.da(t)},t.prototype.da=function(e){var t=new it(this),n=this.destination;n.add(t);var i=function(e,t){if(!t.closed){if(e instanceof Le.y)return e.subscribe(t);var n;try{n=tt(e)(t)}catch(e){t.error(e)}return n}}(e,t);i!==t&&n.add(i)},t.prototype.Z=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this.$(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(rt),ct=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),ut=function(){function e(e){if(this.total=e,this.total<0)throw new ct}return e.prototype.call=function(e,t){return t.subscribe(new lt(e,this.total))},e}(),lt=function(e){function t(t,n){var i=e.call(this,t)||this;return i.total=n,i.count=0,i}return xe.ZT(t,e),t.prototype.$=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(Ke.L);function dt(e,t){return function(n){return n.lift(new ht(e,t))}}var ht=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new ft(e,this.predicate,this.thisArg))},e}(),ft=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.predicate=n,r.thisArg=i,r.count=0,r}return xe.ZT(t,e),t.prototype.$=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Ke.L),pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return xe.ZT(t,e),t.prototype.O=function(t){return this.hasError?(t.error(this.thrownError),nt.w.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),nt.w.EMPTY):e.prototype.O.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(he.xQ);function vt(e){return!(!e||!e.failure)&&"TypeError: Failed to fetch"===e.failure}function mt(e,t){if(t)return!0;if(!e)return!1;switch(e){case 401:case 403:case 404:case 429:return!0;default:return!1}}function gt(e,t){if(t)return me.I$.Offline;switch(e){case 401:case 403:return me.I$.PermissionError;case 404:return me.I$.NotFound;case 429:return me.I$.Throttling;default:return me.I$.Other}}var wt,yt,_t=s(1921);function Ct(e){var t=function(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}(e);return{region:t,dataBoundary:(0,_t.g)(t)}}function St(e){return new Map([["ErrorName","".concat(e.wacErrorName)+(e.errorName?"_".concat(e.errorName):"")],["ErrorMessage",e.errorMessage?e.errorMessage:""],["ErrorStack",e.errorStack?e.errorStack:""],["HttpErrorCode","".concat(e.httpErrorCode)],["NetworkError","".concat(e.networkError)]])}var kt,bt=function(e){return yt?"".concat(e,".").concat(yt.size):e},Tt=s(872);!function(e){e.Unavailable="Service Unavailable",e.UnableToConnect="Unable to connect to service",e.NoData="No data retrieved",e.ManyRequest="Too many requests",e.FailToFetchToken="Failed to fetch access token",e.UrlIsNull="Url is null",e.ItemIdOrDriveIdIsNull="ItemId or DriveId is null"}(kt||(kt={}));var At=s(2661);function It(e){var t={Id:"",Details:""},n=At.W.InternalServiceError,i=At.W.ServiceUnavailable,r=At.W.Unknown,o=e.status,s=e.errorCode,a=e.message;switch(o){case At.W.OK:t="MissingProperty"===s?{Id:n.toString(),Details:kt.NoData}:"ParsingResponseFailed"===s?{Id:n.toString(),Details:a.toString()}:{Id:null!=s?s:n.toString(),Details:a.toString()};break;case At.W.Unknown:t={Id:r.toString(),Details:kt.UnableToConnect};break;case At.W.ServiceUnavailable:t={Id:i.toString(),Details:kt.Unavailable};break;default:t={Id:o.toString(),Details:a.toString()}}return t}var Et,Rt=s(4301);!function(e){e[e.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",e[e.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(Et||(Et={}));var Nt=[],Pt=!1;function Ht(e){switch(e){case Et.GetWopiInfoFromUrl:return Tt.KX.PostMessage_SetHostWopiInfoFromUrl;case Et.GetDavUrlFromIds:return Tt.KX.PostMessage_SetDavUrlFromIds}}function Ot(e){switch(e){case Et.GetWopiInfoFromUrl:return me.yv.ci;case Et.GetDavUrlFromIds:return me.yv.ri}}function Ut(e){switch(e){case Et.GetWopiInfoFromUrl:return me.DG.QosError_WopiInfoFromUrlFailure;case Et.GetDavUrlFromIds:return me.DG.QosError_DavUrlFromIdsFailure}}function Mt(e,t,n,i,r,o,s){var a,c,u,l,d,h=Ot(e),f=Ut(e),p=Ht(e),v={Url:t.Url,ItemId:t.ItemId,DriveId:t.DriveId,Error:n};try{d=JSON.parse(n.Details)}catch(e){d=void 0}null==s||s.recordKpiFailure(h),null==s||s.recordQosError(f,[me.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",null!==(c=null===(a=null==d?void 0:d.error)||void 0===a?void 0:a.code)&&void 0!==c?c:n.Id],["ErrorMessage",null!==(l=null===(u=null==d?void 0:d.error)||void 0===u?void 0:u.message)&&void 0!==l?l:n.Details],["HttpErrorCode",n.Id]])}),(0,Rt.R)(p,v,r,i,o)}function Dt(e,t,n,i,r,o){var s;Pt=!0;var a=Nt.shift();if(a){var c={docUrl:(0,ge.Th)(null!==(s=a.eventArgs.Url)&&void 0!==s?s:"",e.docUrl),docId:a.eventArgs.ItemId,driveId:a.eventArgs.DriveId,fileType:e.fileType,wdOrigin:e.wdOrigin,wdValue:e.wdValue,uiCulture:e.uiCulture,dataCulture:e.dataCulture,puid:e.puid,clickTime:e.clickTime};(0,ve.o)(c,t).then((function(e){!function(e,t,n,i,r,o,s){var a=Ot(e),c=Ut(e),u=Ht(e);n.fetchedDocumentIdentifier.then((function(c){var l,d,h,f,p,v,m,g,w,y={DriveId:null!==(l=t.DriveId)&&void 0!==l?l:c.driveId,ItemId:null!==(d=t.ItemId)&&void 0!==d?d:c.docId,Url:e===Et.GetWopiInfoFromUrl?t.Url:null===(h=n.wopiHostData)||void 0===h?void 0:h.webDavUrl,WopiSrc:null===(p=null===(f=n.wopiHostData)||void 0===f?void 0:f.wac)||void 0===p?void 0:p.wopiSrc,AccessToken:null===(m=null===(v=n.wopiHostData)||void 0===v?void 0:v.wac)||void 0===m?void 0:m.accessToken,AccessTokenExpiry:null===(w=null===(g=n.wopiHostData)||void 0===g?void 0:g.wac)||void 0===w?void 0:w.accessTokenExpiry};null==s||s.recordKpiSuccess(a),(0,Rt.R)(u,y,r,i,o)})).catch((function(e){var t;null==s||s.recordKpiFailure(a),null==s||s.recordQosError(c,[me.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName","Failed to fetch document identifier"],["ErrorMessage",e instanceof Error?"".concat(e.name,": ").concat(e.message):"string"==typeof e?e:JSON.stringify(e)],["HttpErrorCode",null!==(t=e.errorCode)&&void 0!==t?t:"0"]])}),null==o||o.ULS.sendTraceTag(512337542,f.W.zn,p.G.Warning,"Failed to fetch document identifier with error: ".concat(e))}))}(a.eventType,a.eventArgs,e,n,i,r,o)})).catch((function(e){var t={status:(null==e?void 0:e.status)||0,errorCode:(null==e?void 0:e.errorCode)||"",message:(null==e?void 0:e.message)||""};Mt(a.eventType,a.eventArgs,It(t),n,i,r,o)})).finally((function(){Pt=!1,Nt.length>0&&Dt(e,t,n)}))}}function Ft(e,t,i,r,o,s,a,c){return(0,n.mG)(this,void 0,void 0,(function(){var u,l,d,h,f,p;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:null==c||c.addQosPillar("ContentConsumption"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i()];case 2:return u=n.sent(),[3,4];case 3:return l=n.sent(),d={Id:"Failed to get current document info",Details:l instanceof Error?"".concat(l.name,": ").concat(l.message):"string"==typeof l?l:JSON.stringify(l)},[2,Mt(e,t,d,s,o,a,c)];case 4:return e===Et.GetWopiInfoFromUrl?t.Url||(h={Id:"Url is null",Details:kt.UrlIsNull.toString()}):e===Et.GetDavUrlFromIds&&(t.ItemId&&t.DriveId||(h={Id:"ItemId or DriveId is null",Details:kt.ItemIdOrDriveIdIsNull.toString()})),h?[2,Mt(e,t,h,s,o,a,c)]:Nt.length>=100?(f=At.W.Throttled,h={Id:f.toString(),Details:kt.ManyRequest.toString()},[2,Mt(e,t,h,s,o,a,c)]):(p={eventType:e,eventArgs:t},Nt.push(p),Pt||Dt(u,r,s,o,a,c),[2])}}))}))}var xt,qt,Bt=700,Lt=525,Wt=2;function jt(e,t,n){var i,r,o=It({status:t,errorCode:null!==(i=n.errorCode)&&void 0!==i?i:"",message:null!==(r=n.message)&&void 0!==r?r:""});return e.map((function(e){return{Name:e,Errors:[{Id:o.Id.toString(),Details:o.Details}],SPCorrelationId:n.SPRequestGuid}}))}function Kt(e){var t;t=e?"MobileViewer.Label.LinkCopied":"MobileViewer.Label.ErrorCopyingLink";var n=document.createElement("div");n.style.visibility="visible",n.style.position="fixed",n.style.bottom="5px",n.style.backgroundColor="#000000",n.style.color="#fff",n.style.padding="16px",n.style.borderRadius="4px",n.style.height="16px",n.style.left="6px",n.style.right="6px",n.style.fontSize="14px",n.style.fontFamily="-apple-system, Roboto",n.style.display="flex",n.style.alignItems="center",n.textContent=t,document.body.appendChild(n),setTimeout((function(){n.style.visibility="hidden"}),3e3)}!function(e){e[e.Unattempted=0]="Unattempted",e[e.InProgress=1]="InProgress",e[e.NotHandled=2]="NotHandled",e[e.HandleExternally=4]="HandleExternally",e[e.Failed=8]="Failed",e[e.Error=16]="Error",e[e.Succeeded=32]="Succeeded",e[e.Delayed=64]="Delayed"}(xt||(xt={})),function(e){e.android="android",e.ios="ios",e.ipados="ipados"}(qt||(qt={}));var Gt,$t="PushStateHandler";function zt(e){window.history.pushState(e.State,window.document.title,e.Url)}!function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.DismissSplashScreen="DismissSplashScreen",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(Gt||(Gt={}));var Jt="officeapps.live.com",Vt=2e3,Qt=9e3,Xt=9500,Yt=6e5;function Zt(e){var t,i,r,o=(0,v.a)(),a=e.documentBootInfo,c=e.fetchItemFromNetwork,u=e.fetchAccessToken,l=e.sessionConfig,d=e.container,g=e.setTitle,w=e.onBootComplete,y=e.onBootFailure,C=e.onReturnFocus,S=e.onDocumentClose,b=e.onSuccessNotification,A=e.uiHostConfig,I=e.createDocument,E=e.openShareControl,R=e.onOpenInMobileApp,H=e.sharingLinkTokenProvider,O=e.onUserActivity,U=e.onCAAEMessage,M=e.onUserAccess,D=e.onMoveToFolder,F=e.onSharedFilePicker,q=e.onRename,B=e.initPackageParams,L=e.onFrameChange,W=e.invokeSessionRefreshInfoPopupBlockedDialog,j=e.onFileEmbed,K=null==A?void 0:A.supportsExplicitUnload;l.logger||(l.logger=(0,h.L8)());var G=l.hostCorrelationId,$=l.isMsa,z=l.tenantId,J=l.shareApiEndpoint,V=l.organizationName,Q=l.logger,X=l.hostClientType,Y=l.health,Z=Ie(a.fileType,null==A?void 0:A.featureGates,Q);null==Q||Q.ULS.sendTraceTag(576578584,f.W.zn,p.G.Info,"Lean Ui Host: bootApp");var ee,te=new Fe(Yt),ne=[],ie=function(e){return new Promise((function(t){Z&&!te&&t("No active session to close. Return from here.");var i=function(e){null==Q||Q.ULS.sendTraceTag(575411776,f.W.zn,p.G.Info,"Dispose the WAC frame. And reboot: ".concat(e?"true":"false")),Pe.next(e),Pe.complete(),lf(),t("WAC frame disposed")},r=function(){a.fileType===k.T.Excel&&(Nt=[]),null==Te||Te.unsubscribe(),null==Ne||Ne.unsubscribe()};if(!se)return null==Q||Q.ULS.sendTraceTag(529093076,f.W.zn,p.G.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void i(e);if(Z)null==se||se.removeEventListener(ee),null==te||te.cancel(),null==se||se.dispose().catch((function(e){null==Q||Q.ULS.sendTraceTag(527257879,f.W.zn,p.G.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(fe,", Error: ").concat(e))})).finally((function(){r(),i(e)}));else if(ne.forEach((function(e){var t=(0,n.CR)(e,2),i=t[0],r=t[1];se.RemoveEventHandler(i,r)})),null==se||se.Dispose(K,function(e){if(e===k.T.OneNote)return Qt}(a.fileType)),r(),K){se.RegisterEventHandler(Tt.E_.Event_Unloaded,(function(){null==Q||Q.ULS.sendTraceTag(575411777,f.W.zn,p.G.Info,"Receive Unloaded Event from WAC"),fe=!0,clearTimeout(o),i(e)}));var o=window.setTimeout((function(){null==Q||Q.ULS.sendTraceTag(575411778,f.W.zn,p.G.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(fe)),fe||i(e)}),a.fileType===k.T.OneNote?Xt:Vt)}else null==Q||Q.ULS.sendTraceTag(575271647,f.W.zn,p.G.Info,"No Explicit Unload. Tear down the WAC frame to end session."),i(e)}))},re=function(e,t,i){var r,o,h,m,g=Promise.resolve(null===(r=null==e?void 0:e.wac)||void 0===r?void 0:r.applicationUrl),w=function(){return t.asObservable().pipe((function(e){return e.lift(new ut(1))})).toPromise()},y=(0,T.vJ)(T.Fh.FeatureGate_BlurAndGrabFocusForShareDialogGate,null==A?void 0:A.featureGates),_=null!==(o=null==A?void 0:A.sessionOriginPrefix)&&void 0!==o?o:"TEAMS.UNIFIEDUIHOST.",b=function(e){var t=this,i=e.getCurrentDocumentInfo,r=e.getWdOrigin,o=e.reboot;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t,s,a,c,u,l;return(0,n.Jh)(this,(function(d){switch(d.label){case 0:return[4,i()];case 1:if(t=d.sent(),s=e.previousSessionId,a=e.mode,c={},e.queryOverrides&&"string"==typeof e.queryOverrides)try{c=JSON.parse(e.queryOverrides)}catch(e){c={}}else c=e.queryOverrides||{};return u=e.isNewSession,l={previousSessionId:s,mode:a,queryOverrides:c,isNewSession:u},"1"===e.rebootMode?o({docUrl:e.documentUrl,fileType:t.fileType,wdOrigin:r(me.J4.BackstageMru),uiCulture:t.uiCulture,dataCulture:t.dataCulture,puid:t.puid,rebootOverrideData:l,clickTime:(0,v.a)()},!1):o((0,n.pi)((0,n.pi)({},t),{wdOrigin:r(me.J4.Reboot),rebootOverrideData:l,clickTime:(0,v.a)()}),!0),[2]}}))}))}}({getCurrentDocumentInfo:w,health:Y,getWdOrigin:function(e){return"".concat(_).concat(e)},reboot:function(e,t){ie({documentBootInfo:e,navigationRequired:!t}).catch((function(){null==Q||Q.ULS.sendTraceTag(512296464,f.W.zn,p.G.Error,"endSession: endSession error in DocumentReboot")}))}}),N=function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return[4,t.sent().renameHandler(e,i)];case 2:return t.sent(),[2]}}))}))}}({bootedDocumentInfo:t,getCurrentDocumentInfo:w,hostRenameCallback:q,health:Y}),P=function(e){var t=this,i=e.supportsRefreshTokenReauthPopUp,r=e.hostUrl,o=e.documentBootInfo,s=e.fetchItemFromNetwork,a=e.officeDocumentSession,c=e.appUrlPromise,u=e.invokePopupBlockedDialog,l=e.logger,d=e.health,h=0,v=!1,m=!1;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t,g,w,y,_,C,S,k,b,T,A,I,E,R,N,P,H,O;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,11]),null==d||d.addQosPillar("Interruptions"),null==l||l.ULS.sendTraceTag(512247693,f.W.zn,p.G.Info,"Start token refresh: Application : ".concat(o.fileType,", Origin: ").concat(o.wdOrigin)),[4,(0,ve.o)(o,s,l,!0,!1,!1)];case 1:return t=n.sent(),g=null==t?void 0:t.wopiHostData.wac,w=e.Tokens.map((function(e){return t=e,i=(n=g).accessTokenExpiry,(r=n[t.charAt(0).toLowerCase()+t.slice(1)])?{Name:t,Expiry:i,Value:r.toString()}:{Name:t,Errors:[{Id:"404",Details:"Could not find this token"}]};var t,n,i,r})),null==d||d.recordKpiSuccess(me.yv.oi),(0,Rt.R)(Tt.KX.PostMessage_RefreshSessionInfo,{Tokens:w},c,a,l),h>0&&(null==l||l.ULS.sendTraceTag(509441036,f.W.zn,p.G.Info,"Resetting popup retry count to 0 from ".concat(h," after successful token acquistion")),h=0),[3,11];case 2:y=n.sent(),(_=null!==(R=y.status)&&void 0!==R?R:(null===(N=y.httpResponse)||void 0===N?void 0:N.status)===At.W.TokenUnavailable?At.W.Unauthorized:null===(P=y.httpResponse)||void 0===P?void 0:P.status)||(null==l||l.ULS.sendTraceTag(508913162,f.W.zn,p.G.Warning,"Unable to parse status from error: ".concat(JSON.stringify(y,Object.getOwnPropertyNames(y)),"; status: ").concat(_)),_=0),C=It({status:_,errorCode:null!==(H=y.errorCode)&&void 0!==H?H:"",message:null!==(O=y.message)&&void 0!==O?O:""}),n.label=3;case 3:return n.trys.push([3,9,,10]),void 0===_?[3,7]:(null==l||l.ULS.sendTraceTag(512549194,f.W.zn,p.G.Warning,"Error while refreshing token - "+y.status),"string"!=typeof r?[3,4]:(k=r,[3,6]));case 4:return[4,r];case 5:k=n.sent(),n.label=6;case 6:return S=k,i&&e.AllowAADPopup&&S&&function(e,t,n){return t<Wt&&(e===At.W.Unauthorized||e===At.W.Forbidden&&n.indexOf("aadInteractionRequired")>-1)}(_,h,C.Details)?(b=function(){var t=e.Tokens.map((function(e){return{Name:e,Errors:[{Id:"202",Details:"AAD Interaction Required"}],SPCorrelationId:y.SPRequestGuid}}));(0,Rt.R)(Tt.KX.PostMessage_RefreshSessionInfo,{Tokens:t},c,a,l)},T=function(){if(document.hidden&&h>0||m)b();else{var t=h;h++;var n=function(e,t,n){var i=e.concat("?wacreauth=1"),r=void 0!==window.screenLeft?window.screenLeft:screen.left,o=void 0!==window.screenTop?window.screenTop:screen.top,s=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-t/2+r,a=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-n/2+o,c=window.open(i,"","scrollbars=yes, width="+t+", height="+n+", top="+a+", left="+s);try{null==c||c.focus()}catch(e){return null}return c}(S,Bt,Lt);if(n)m=!0,setTimeout((function(){n.close(),m=!1}),2e4),b();else{null==l||l.ULS.sendTraceTag(509646289,f.W.zn,p.G.Warning,"401 - Popup blocked [retry: ".concat(t,"]"));var i=function(){var t=jt(e.Tokens,_,y);null==d||d.recordKpiFailure(me.yv.oi),null==d||d.recordQosError(me.DG.QosError_WopiRefreshAuthTokenFailure,[me.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Supported pop-up did not open."],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),(0,Rt.R)(Tt.KX.PostMessage_RefreshSessionInfo,{Tokens:t},c,a,l)};!u||v||document.hidden?document.hidden?(null==l||l.ULS.sendTraceTag(509084357,f.W.zn,p.G.Warning,"Document is hidden"),b()):i():(v=!0,null==l||l.ULS.sendTraceTag(509136921,f.W.zn,p.G.Info,"Popup blocked dialog invoked"),u({visible:!0,handleRefresh:function(){null==l||l.ULS.sendTraceTag(509136920,f.W.zn,p.G.Info,"Retry button clicked. Resetting retry from ".concat(h," to 0.")),h=0,T()},handleCancel:function(){null==l||l.ULS.sendTraceTag(509136919,f.W.zn,p.G.Info,"Continue button clicked"),i()},onDismiss:function(){null==l||l.ULS.sendTraceTag(509136918,f.W.zn,p.G.Info,"Dialog was dismissed"),i()}}))}}},T()):(A=jt(e.Tokens,_,y),I="",h>=Wt?I="Exceeded maximum 401 reauth retry attempts at ".concat(h):_!==At.W.Unauthorized||i?_!==At.W.Unauthorized||e.AllowAADPopup?_!==At.W.Unauthorized&&(I="Do not retry on status codes other than 401"):I="No reauth pop-up support from the application":I="No reauth pop-up support from the host",null==d||d.recordKpiFailure(me.yv.oi),null==d||d.recordQosError(me.DG.QosError_WopiRefreshAuthTokenFailure,[me.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure.".concat(I?" ".concat(I,"."):"")],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),(0,Rt.R)(Tt.KX.PostMessage_RefreshSessionInfo,{Tokens:A},c,a,l)),[3,8];case 7:null==d||d.recordKpiFailure(me.yv.oi),null==d||d.recordQosError(me.DG.QosError_WopiRefreshAuthTokenFailure,[me.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Status is undefined. This should not happen."],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),null==l||l.ULS.sendTraceTag(512549195,f.W.zn,p.G.Error,"Unexpected error refreshing token ("+JSON.stringify(y)+")"),n.label=8;case 8:return[3,10];case 9:return E=n.sent(),null==d||d.recordKpiFailure(me.yv.oi),null==d||d.recordQosError(me.DG.QosError_WopiRefreshAuthTokenFailure,[me.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Failed to parse error response."],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),null==l||l.ULS.sendTraceTag(510248914,f.W.zn,p.G.Error,"Unexpected error when parsing error ("+E+")"),[3,10];case 10:return[3,11];case 11:return[2]}}))}))}}({hostUrl:null==l?void 0:l.hostUrl,supportsRefreshTokenReauthPopUp:null==A?void 0:A.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:w,documentBootInfo:a,fetchItemFromNetwork:c,officeDocumentSession:i,appUrlPromise:g,invokePopupBlockedDialog:W,logger:Q,health:Y}),x=function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return[4,t.sent().shareHandler(e,i)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:w,sharePointInfo:e.sharePointInfo,shareApiEndPointBase:J,fetchAccessToken:u,openShareControl:E,correlationId:ce,isMsa:$,tenantId:z,organizationName:V,onOpen:function(){(0,T.dt)(T.Fh.FeatureGate_BlurAndGrabFocusForShareDialogGate,y,Q),y&&(0,Rt.R)(Tt.KX.PostMessage_BlurFocus,void 0,de,we,Q)},onClose:function(){(0,T.dt)(T.Fh.FeatureGate_BlurAndGrabFocusForShareDialogGate,y,Q),y&&(0,Rt.R)(Tt.KX.PostMessage_GrabFocus,void 0,de,we,Q)},health:Y,featureGates:null==A?void 0:A.featureGates,logger:Q}),K=null!=M?M:function(e){var t=this,i=e.shareHandler,r=e.officeDocumentSession,o=e.appUrlPromise,s=e.logger;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(n){return t=function(t,n){(0,Rt.R)(Tt.KX.PostMessage_GrantPermissions,{Persons:e.Persons.map((function(e){return{Id:e.Id,Provider:e.Provider,Status:t?0:3,Reason:""}})),DialogCanceled:null!=n&&n,Id:e.Id},o,r,s)},i({wdUserSession:e.wdUserSession,mode:"atMention",onGrantAccessComplete:t,defaultRecipients:e.Persons.map((function(e){return e.Id}))}),[2]}))}))}}({getCurrentDocumentInfo:w,shareHandler:x,officeDocumentSession:i,appUrlPromise:g,logger:Q,health:Y}),G=function(e){var t=this,i=e.onUserActivity;return function(){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){return i&&i(),[2]}))}))}}({getCurrentDocumentInfo:w,onUserActivity:O,health:Y}),Z=function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return[4,t.sent().createNewHandler(e,i)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:w,createDocument:I,getWdOrigin:function(e){return"".concat(_).concat(e)},reboot:function(e,t){ie({documentBootInfo:e,navigationRequired:!t}).catch((function(e){var t=(0,T.vJ)(T.Fh.FeatureGate_CommandingAshaVetoes,null==A?void 0:A.featureGates);(0,T.dt)(T.Fh.FeatureGate_CommandingAshaVetoes,t,Q),t&&(null==Y||Y.recordQosError(me.DG.QosError_CreateNewHandlerEndSessionFailure,[me.cS.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",me.DG.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat(ce)],["Reason",e]])})),null==Q||Q.ULS.sendTraceTag(512296463,f.W.zn,p.G.Error,"endSession: endSession error in DocumentCreate")}))},logger:Q,health:Y,correlationId:ce}),ee=function(e){var t=this,i=e.getCurrentDocumentInfo,r=e.fetchAccessToken,o=e.officeDocumentSession,s=e.appUrlPromise,a=e.logger,c=e.health,u=e.correlationId;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t,l,d,h,f;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return[4,i()];case 1:t=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),p=null!==(f=t.docUrl)&&void 0!==f?f:"",l=(0,ge.aE)(p)===ge.o4.OneDrive?"OneDrive":"SharePoint",[4,r(l,!1,e.Resource)];case 3:return d=n.sent(),null==c||c.recordKpiSuccess(me.yv.si),(0,Rt.R)(Tt.KX.PostMessage_SetAuthToken,{RequestId:e.RequestId,AuthToken:d.token,TokenExpiration:d.expiryMs?new Date(d.expiryMs):void 0},s,o,a),[3,5];case 4:return h=n.sent(),null==c||c.recordKpiFailure(me.yv.si),null==c||c.recordQosError(me.DG.QosError_WopiFetchAuthTokenFailure,[me.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{extendedProperties:new Map([["ErrorName",me.DG.QosError_WopiFetchAuthTokenFailure],["CorrelationId","".concat(u)],["AuthError","".concat(null==h?void 0:h.error)],["ErrorCategory","".concat(null==h?void 0:h.errorCategory)]])}),(0,Rt.R)(Tt.KX.PostMessage_SetAuthToken,{RequestId:e.RequestId,Error:"string"==typeof h?h:JSON.stringify(h)},s,o,a),[3,5];case 5:return[2]}var p}))}))}}({getCurrentDocumentInfo:w,fetchAccessToken:u,officeDocumentSession:i,appUrlPromise:g,logger:Q,health:Y}),te=function(e){var t=this,i=e.onReturnFocus,r=e.logger;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){if(!i)return null==r||r.ULS.sendTraceTag(576217558,f.W.zn,p.G.Error,"Receiving AccessibilityLoopComplete message, but no OnReturnFocus callback is defined!"),[2];switch(e.Direction){case"forward":i(!0);break;case"backward":i(!1);break;default:i()}return[2]}))}))}}({getCurrentDocumentInfo:w,onReturnFocus:C,health:Y}),ne=function(e){var t=this,i=e.getCurrentDocumentInfo,r=e.hostClientType,o=e.logger,s=e.openInMobileAppCallback;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t,a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return null==o||o.ULS.sendTraceTag(526242818,f.W.zn,p.G.Info,"Trying to open the ClientUrl}"),e?e.Status!==xt.Succeeded.toString()?(null==o||o.ULS.sendTraceTag(526242820,f.W.zn,p.G.Error,"Host_GetClientUrl failed with status code ".concat(e.Status)),[2]):(t=e.Url,[4,i()]):(null==o||o.ULS.sendTraceTag(526242819,f.W.zn,p.G.Info,"Response not present"),[2]);case 1:return n.sent().fileType!==k.T.OneNote?(null==o||o.ULS.sendTraceTag(525682274,f.W.zn,p.G.Info,"This handler is not supported for fileType: ".concat(k.T)),[2]):(r===qt.android?a="market://details?id=com.microsoft.office.onenote":r===qt.ios||r===qt.ipados?a="https://itunes.apple.com/us/app/appname/id410395246":(null==o||o.ULS.sendTraceTag(526242821,f.W.zn,p.G.Info,"HostClientType: ".concat(r," not supported.")),a=""),s?(s(t,a),[2]):(null==o||o.ULS.sendTraceTag(512337545,f.W.zn,p.G.Error,"openInMobileApp callback is not defined"),[2]))}}))}))}}({getCurrentDocumentInfo:w,hostClientType:X,logger:Q,openInMobileAppCallback:R,health:Y}),re=function(e){var t=this,i=e.getCurrentDocumentInfo,r=e.hostClientType,o=e.logger;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return null==o||o.ULS.sendTraceTag(508352280,f.W.zn,p.G.Info,"Trying to copy the WebUrl to clipboard for HostClientType: ".concat(r)),e?e.Status!==xt.Succeeded.toString()?(null==o||o.ULS.sendTraceTag(508352279,f.W.zn,p.G.Error,"Host_GetWebUrl failed with status code ".concat(e.Status," for HostClientType: ").concat(r)),[2]):e.Url?[4,i()]:(null==o||o.ULS.sendTraceTag(508352277,f.W.zn,p.G.Info,"Web Url not present in the response for HostClientType: ".concat(r)),[2]):(null==o||o.ULS.sendTraceTag(508352278,f.W.zn,p.G.Info,"Response not present"),[2]);case 1:return n.sent().fileType!==k.T.OneNote?[3,5]:((t=document.createElement("textarea")).style.position="absolute",t.style.opacity="0",t.value=e.Url,document.body.appendChild(t),document.execCommand("RemoveFormat"),s=document.execCommand("copy"),document.body.removeChild(t),s?[3,3]:[4,navigator.clipboard.writeText(e.Url).then((function(){null==o||o.ULS.sendTraceTag(508352276,f.W.zn,p.G.Info,"navigator.clipboard command succeeded for HostClientType: ".concat(r,"!")),Kt(!0)})).catch((function(e){null==o||o.ULS.sendTraceTag(508352275,f.W.zn,p.G.Error,"navigator.clipboard command failed for HostClientType: ".concat(r,", Error: ").concat(e)),Kt(!1)}))]);case 2:return n.sent(),[3,4];case 3:null==o||o.ULS.sendTraceTag(508352274,f.W.zn,p.G.Info,"ExecCommand 'copy' succeeded for HostClientType: ".concat(r,"!")),Kt(!0),n.label=4;case 4:return[3,6];case 5:return null==o||o.ULS.sendTraceTag(508352273,f.W.zn,p.G.Info,"This handler is not supported for fileType: ".concat(k.T)),[2];case 6:return[2]}}))}))}}({getCurrentDocumentInfo:w,hostClientType:X,logger:Q,health:Y}),oe=function(e){var t=this,i=e.getCurrentDocumentInfo,r=e.fetchItemFromNetwork,o=e.officeDocumentSession,s=e.appUrlPromise,a=e.logger,c=e.health;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,Ft(Et.GetWopiInfoFromUrl,e,i,r,s,o,a,c)];case 1:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:w,fetchItemFromNetwork:c,officeDocumentSession:i,appUrlPromise:g,logger:Q,health:Y}),se=function(e){var t=this,i=e.getCurrentDocumentInfo,r=e.fetchItemFromNetwork,o=e.officeDocumentSession,s=e.appUrlPromise,a=e.logger,c=e.health;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,Ft(Et.GetDavUrlFromIds,e,i,r,s,o,a,c)];case 1:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:w,fetchItemFromNetwork:c,officeDocumentSession:i,appUrlPromise:g,logger:Q,health:Y}),ae=function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return[4,t.sent().actionCompleteHandler(e,i)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:w,logger:Q,webUrl:null!==(h=e.webUrl)&&void 0!==h?h:"",health:Y}),ue=function(e){var t=this;return function(){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return t.sent().openInBrowserHandler(e),[2]}}))}))}}({getCurrentDocumentInfo:w,logger:Q,webUrl:null!==(m=e.webUrl)&&void 0!==m?m:"",health:Y,correlationId:ce}),le=function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return t.sent().openInMobileAppHandler(e,i),[2]}}))}))}}({getCurrentDocumentInfo:w,logger:Q,openInMobileAppCallback:R,health:Y,correlationId:ce}),he={appUrlPromise:g,container:d,fetchAccessToken:u,fetchItemFromNetwork:c,getCurrentDocumentInfo:w,host:null==A?void 0:A.uiHostName,health:Y,logger:Q,officeDocumentSession:i,wopiHostData:e,sessionConfig:l,uiHostConfig:A,initPackageParams:B},fe=null!=D?D:function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return[4,t.sent().moveToFolderFilePickerHandler(e,i)];case 2:return t.sent(),[2]}}))}))}}(he),pe=null!=F?F:function(e){var t=this;return function(i){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,9554))];case 1:return[4,t.sent().commonPickerHandler(e,i)];case 2:return t.sent(),[2]}}))}))}}(he),ye=function(e){var t=this,i=e.customAuthConfigValue,r=e.officeDocumentSession,o=e.appUrlPromise,s=e.logger;return function(){return(0,n.mG)(t,void 0,void 0,(function(){var e,t;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return"string"!=typeof i?[3,1]:(t=i,[3,3]);case 1:return[4,i];case 2:t=n.sent(),n.label=3;case 3:return(e=t)&&(0,Rt.R)(Tt.KX.PostMessage_SendCustomAuthConfig,{AuthConfig:e},o,r,s),[2]}}))}))}}({customAuthConfigValue:null==l?void 0:l.customAuthConfigValue,getCurrentDocumentInfo:w,officeDocumentSession:i,appUrlPromise:g,logger:Q,health:Y}),_e=function(e){var t=this,i=e.supportsPopAndPushState,r=e.logger,o=e.sharingLinkTokenProvider;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return i?(o&&o.TokenPromise?(null==r||r.ULS.sendTraceTag(528004815,f.W.zn,p.G.Info,"".concat($t,": Handling push state with sharing link token")),o.TokenPromise.then((function(t){if(t){var n=new URL(e.Url);n.searchParams.set(t.Key,t.Value),e.Url=n.toString()}zt(e)})).catch((function(e){null==r||r.ULS.sendTraceTag(528004816,f.W.zn,p.G.Error,"".concat($t,": Handling push state with sharing link token error ").concat(e))}))):(null==r||r.ULS.sendTraceTag(528004817,f.W.zn,p.G.Info,"".concat($t,": Handling push state without sharing link token")),zt(e)),[2]):[2]}))}))}}({getCurrentDocumentInfo:w,supportsPopAndPushState:null==A?void 0:A.supportsPopAndPushState,logger:Q,sharingLinkTokenProvider:H,health:Y}),Ce=function(e){var t=this,i=e.onCAAEMessage;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return i&&i(e),[2]}))}))}}({getCurrentDocumentInfo:w,onCAAEMessage:U,health:Y}),Se=function(e){var t=e.appUrlPromise,n=e.logger,i=e.officeDocumentSession;return function(e){var r={State:e.state,Url:window.location.href};(0,Rt.R)(Tt.KX.PostMessage_PopState,r,t,i,n)}}({getCurrentDocumentInfo:w,appUrlPromise:g,logger:Q,officeDocumentSession:i,health:Y});!function(e){var t=e.onPopState;e.supportsPopAndPushState&&window.addEventListener("popstate",t)}({getCurrentDocumentInfo:w,onPopState:Se,supportsPopAndPushState:null==A?void 0:A.supportsPopAndPushState,health:Y});var ke=function(e){var t=this,i=e.onFrameChange;return function(e){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return i&&i(e),[2]}))}))}}({getCurrentDocumentInfo:w,onFrameChange:L,health:Y});return{documentRebootHandler:b,renameHandler:N,sessionRefreshInfoHandler:P,shareHandler:x,userAccessHandler:K,userActivityHandler:G,createNewHandler:Z,getAuthTokenHandler:ee,accessibilityLoopCompleteHandler:te,getClientUrlCompleteHandler:ne,getWebUrlCompleteHandler:re,wopiInfoFromUrlHandler:oe,davUrlFromIdsHandler:se,onCloseHandler:function(){null==Q||Q.ULS.sendTraceTag(575545427,f.W.zn,p.G.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(S?"true":"false")),S&&S()},actionCompleteHandler:ae,openInBrowserHandler:ue,openInMobileAppHandler:le,moveToFolderPickerHandler:fe,commonFilePickerHandler:pe,getCustomAuthConfigHandler:ye,pushStateHandler:_e,caaeMessageHandler:Ce,frameChangedHandler:ke,fileEmbedHandler:function(){j&&j()},dismissSplashScreenHandler:function(){var e=document.getElementById("splashscreen-container");e&&(e.style.display="none")}}},oe=(null==B?void 0:B.jsApiUrlInfos)?null==B?void 0:B.jsApiUrlInfos:new Map;0===oe.size&&oe.set(k.T.Word,{jsApiUrl:null===(t=null==B?void 0:B.wordBootstrapperUrlInfo)||void 0===t?void 0:t.url,jsApiSri:null===(i=null==B?void 0:B.wordBootstrapperUrlInfo)||void 0===i?void 0:i.sri,PreloadedInBootStrapper:null===(r=null==B?void 0:B.wordBootstrapperUrlInfo)||void 0===r?void 0:r.wordJsApiPreloadedInBootStrapper});var se,ae=function(e,t,i,r,o,s,a,c,u,l,d){if(void 0===a&&(a=!1),yt||(yt=new Map),!e.isNewFile||!e.createNewInfo){var h=(0,pe.q_)(e);if(!h)return{correlationId:t,bootstrapperObservable:("Not enough document information was provided",new Le.y((function(e){return e.error("Not enough document information was provided")}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var g=yt.get(h);if(g)return g}return function(e,t,i,r,o,s,a,c,u,l,d){void 0===a&&(a=!1);var h=bt(t),g=null==o?void 0:o.logger,w=(0,ve.o)(e,i,g,a,!(!e.isNewFile&&!e.templateId),!0,!!(null==o?void 0:o.meeting)),y=new pt;w.then((function(t){t.fetchedDocumentIdentifier.then((function(i){var a;!function(e,t,i,r,o,s,a,c){var u=this,l=e.loadFunctionSubject,d=e.documentBootInfo,h=e.correlationId,m=e.wopiFetchData,g=void 0===m?{wopiHostData:void 0,fetchDiagnostics:void 0}:m,w=d.fileType,y=d.wdOrigin,C=d.puid,S=d.uiCulture,b=d.dataCulture,T=d.clickTime,A=d.rebootOverrideData,I=g.wopiHostData,E=g.fetchDiagnostics,R=null==i?void 0:i.logger,N=null==i?void 0:i.health;if(!(I&&I.wac&&I.wac.bootstrapperUrl&&I.wac.applicationUrl)){var P=!!I,H=!!(null==I?void 0:I.wac),O=new Map([["WopiHostDataPresent","".concat(P)],["WopiWacDataPresent","".concat(H)]]),U=JSON.stringify(Array.from(O.entries())),M={wacErrorName:me.AU.li,qosErrorName:me.DG.QosError_VroomWopiFailure,errorMessage:U};return null==R||R.ULS.sendTraceTag(554964098,f.W.zn,p.G.Info,"".concat(me.AU.li,": Failed to get wopi data for the item, ").concat(U)),void(r&&r(M))}var D=c||I.wac.bootstrapperUrl,F=I.wac.applicationUrl;I.wac.userId&&(null==N||N.updatePartADimensions({loggableUserId:I.wac.userId}));var x=new Promise((function(e,t){setTimeout((function(){return t("jsApi timed out after 60 seconds")}),6e4)})),q=new Promise((function(e,c){return(0,n.mG)(u,void 0,void 0,(function(){return(0,n.Jh)(this,(function(u){return l.subscribe((function(){return e("jsApi successfully loaded")})),function(e,t,n){wt||(wt=new Map);var i=wt.get(n);if(i)return i;var r=new Promise((function(i,r){var o=(0,v.a)();!function(e,t,n,i,r,o,s){if(void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),!document)return null;if(r){var a=document.getElementById(r);if(null!=a)return t&&t(),a}var c=document.createElement("script");if(c.src=e,r&&(c.id=r),t&&(c.onload=t),n&&(c.onerror=function(){var e;n(),s&&(null===(e=c.parentNode)||void 0===e||e.removeChild(c))}),o&&(c.crossOrigin="anonymous"),i){var u=document.getElementsByTagName("script")[0];if(u&&u.parentNode)return u.parentNode.insertBefore(c,u)}document.body.appendChild(c)}(e,(function(){var n=(0,v.a)();i({bootstrapperUrl:e,applicationUrl:t,performance:{startTime:o,endTime:n}})}),(function(){r("Load bootstrapper script failed")}),!1,"".concat(k.T[n],"_bootstrapper"))}));return wt.set(n,r),r}(D,F,w).then((function(e){var c,u=(0,n.CR)(function(e){var t=window.Microsoft;if(void 0===t)return[void 0,"Microsoft is undefined"];var n=t.Office,i=k.T[e];return n&&n[i]?[n[i],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(i)]}(w),2),m=u[0],g=u[1];if(!g&&m){var P,H,O=Ee(I,e.applicationUrl,null!==(c=null==t?void 0:t.uiHostName)&&void 0!==c?c:"UUIH",d,null==t?void 0:t.uiEmbed);try{H=new URLSearchParams(new URL(O).search).get("sc")||void 0}catch(e){null==R||R.ULS.sendTraceTag(520135565,f.W.zn,p.G.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(e)))}Ie(w,null==t?void 0:t.featureGates,R)?(null==N||N.addOrUpdatePartCDimension("JsApiVersion","V2"),P=function(r){var c=r.container,u=r.flushTime;return new Le.y((function(r){var l,g,w,k,N,P,U,M,F,x,q,B,L,W={host:{storageHostName:Ce(null!==(k=d.docUrl)&&void 0!==k?k:""),capabilities:{isFeatureEnabledCallback:Ae(i),moveToFolder:null==t?void 0:t.supportsMoveToFolder,commonFilePicker:null==t?void 0:t.supportsCommonFilePicker,rebootDoc:null==t?void 0:t.supportsDocumentReboot,createNewDoc:null==t?void 0:t.supportsCreateNewDocument,authToken:null==t?void 0:t.supportsAuthToken,excelExternalLinks:null==t?void 0:t.supportsExcelExternalLinks,refreshAccessToken:null==t?void 0:t.supportsRefreshAccessToken,atMentions:null==t?void 0:t.supportsAtMentions,accessibilityLoop:null==t?void 0:t.supportsAccessibilityLoop,customAuthConfig:null==t?void 0:t.supportsCustomAuthConfig,directPrint:null==t?void 0:t.supportsDirectPrint,directDownload:null==t?void 0:t.supportsDirectDownload},uiHostName:(null==t?void 0:t.uiHostName)||ye,requireExplicitUnload:null==t?void 0:t.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==t?void 0:t.uiHostIntegrationType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout},user:{id:I?I.wac.userId:C,isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:D,ui:{uiEmbed:null===(N=null==t?void 0:t.uiEmbed)||void 0===N||N,controls:(null==t?void 0:t.supportsHostUiControls)?[{id:"close",visibility:(null==t?void 0:t.showCloseButton)?1:0},{id:"share",visibility:(null==t?void 0:t.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==t?void 0:t.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==t?void 0:t.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==t?void 0:t.copyLinkEnabled)?1:0}]:void 0,language:S,hideHeader:null==t?void 0:t.hideHeader,hideAppLauncherInHeader:null==t?void 0:t.hideAppLauncherInHeader,hideSearchInHeader:null==t?void 0:t.hideSearchInHeader,hideMeInHeader:null==t?void 0:t.hideMeInHeader,hideChatInHeader:null==t?void 0:t.hideChatInHeader,hideWorkflowInHeader:null==t?void 0:t.hideWorkflowInHeader,hideSettingsInHeader:null==t?void 0:t.hideSettingsInHeader,showAppIconInHeader:null==t?void 0:t.showAppIconInHeader,useNeutralColorInHeader:null==t?void 0:t.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==t?void 0:t.openLinksInNewWindow,contentAssemblyMode:null==t?void 0:t.contentAssemblyMode}},j=m.createApplication(W),K={hostSessionId:h},G=j.createSession(K);s&&s(j,I,d,G),o&&o();var $={appUrl:O,file:(0,n.pi)({name:I.fileName,getUrl:(null===(P=I.wac)||void 0===P?void 0:P.fileGetUrl)||I.downloadUrl,size:I.fileSize,eTag:I.eTag},d.docId&&{uniqueId:d.docId}),customFontCatalogUrl:I.wac.customFontCatalogUrl,contentBundle:{majorVersion:I.bundleVersion?Number(I.bundleVersion):0,url:null!==(U=I.bundleUrl)&&void 0!==U?U:"",staleness:I.bundleStaleness||0},newFileTemplate:d.newFileTemplate,container:c,wopi:{source:I.wac.wopiSrc,accessToken:I.wac.accessToken,expiry:parseInt(I.wac.accessTokenExpiry,10)},bootParams:{readOnly:I.readOnly,irmEnabled:I.irmEnabled,viewOnly:I.blocksDownload,disableChat:!0,openViewByDefault:"view"===d.intent,dataLanguage:b},diagnostics:(null===(M=null==i?void 0:i.bootDiagnostics)||void 0===M?void 0:M.legacyPerformanceData)?(0,n.pi)((0,n.pi)((0,n.pi)({},be(null===(F=null==i?void 0:i.bootDiagnostics)||void 0===F?void 0:F.legacyPerformanceData.host,null===(x=null==i?void 0:i.bootDiagnostics)||void 0===x?void 0:x.legacyPerformanceData.owlFrame)),ke(T,u,y,E,e.performance,i,null==t?void 0:t.featureGates)),{legacyPerformanceData:null===(q=null==i?void 0:i.bootDiagnostics)||void 0===q?void 0:q.legacyPerformanceData}):Se(T,u,y,E,e.performance,i,null==t?void 0:t.featureGates),sessionContext:H||_e(),preseededSession:{key:I.preSeededSessionKey,id:I.preSeededWacSessionId},wdParams:(0,n.pi)((0,n.pi)((0,n.pi)({},d.templateId&&(l={},l.wdTpl=d.templateId,l)),A&&A.lcid&&(g={},g.wdlcid=A.lcid,g)||d.uiCulture&&(w={},w.wdlcid=d.uiCulture,w)),Re(d.wdValue)),hostGeneratedSessionId:null==i?void 0:i.sessionId,meeting:null==i?void 0:i.meeting,rebootOverride:A,throttling:{protection:null===(B=I.wac)||void 0===B?void 0:B.clientThrottlingProtection,request:null===(L=I.wac)||void 0===L?void 0:L.requestedCallThrottling}};(0,v.l)(_.OwlWacBootStart),G.boot($,a).then((function(e){var t,n,i;if("success"===e.completion)r.next({wopiHostData:I,officeApplication:j,bootedDocumentInfo:new Be(d),officeDocumentSession:G,wacBootDiagnostics:null===(t=null==G?void 0:G.diagnostics)||void 0===t?void 0:t.appInitDiagnostics}),r.complete();else if("cancelled"===e.completion)null==R||R.ULS.sendTraceTag(509646293,f.W.zn,p.G.Info,"User cancelled document session boot");else{var o=void 0,s=void 0;"failure"===e.completion?(o=null===(n=e.error)||void 0===n?void 0:n.message,s=null===(i=e.error)||void 0===i?void 0:i.stack):o="timeout"===e.completion?"operation timed out":"unexpected error";var a={wacErrorName:me.AU.gi,qosErrorName:me.DG.QosError_EncounteredJsApiError,errorMessage:o,errorStack:s,error:e.error},c=St(a),u=JSON.stringify(Array.from(c.entries()));null==R||R.ULS.sendTraceTag(575419404,f.W.zn,p.G.Error,u),r.error(a)}})).catch((function(e){return null==R?void 0:R.ULS.sendTraceTag(512337547,f.W.zn,p.G.Error,"officeDocumentSession.boot threw error: ".concat(e))}))}))}):(null==N||N.addOrUpdatePartCDimension("JsApiVersion","V1"),P=function(r){var s=r.container,a=r.flushTime;return new Le.y((function(r){var c,u=function(e,t,n,i,r,o,s,a){return{HostName:"office.com",HostSessionId:t,UserId:e,OwnerId:void 0,UiLocale:n,DataLocale:i,DisableChat:!0,CookieCompliant:!0,WdParams:s,DisableFocusOnBoot:!1,SessionContext:a||_e(),HighContrastMode:null==o?void 0:o.highContrastMode,HideHeader:null==r?void 0:r.hideHeader,HideAppLauncherInHeader:null==r?void 0:r.hideAppLauncherInHeader,HideSearchInHeader:null==r?void 0:r.hideSearchInHeader,HideMeInHeader:null==r?void 0:r.hideMeInHeader,HideChatInHeader:null==r?void 0:r.hideChatInHeader,HideWorkflowInHeader:null==r?void 0:r.hideWorkflowInHeader,HideSettingsInHeader:null==r?void 0:r.hideSettingsInHeader,ShowAppIconInHeader:null==r?void 0:r.showAppIconInHeader,UseNeutralColorInHeader:null==r?void 0:r.useNeutralColorInHeader,SupportsDocReboot:null==r?void 0:r.supportsDocumentReboot,SupportsCreateNewDocument:null==r?void 0:r.supportsCreateNewDocument,SupportsAuthToken:null==r?void 0:r.supportsAuthToken,SupportsAtMentions:null==r?void 0:r.supportsAtMentions,SupportsMoveToFolder:null==r?void 0:r.supportsMoveToFolder,SupportsCommonFilePicker:null==r?void 0:r.supportsCommonFilePicker,SupportsDirectPrint:null==r?void 0:r.supportsDirectPrint,SupportsDirectDownload:null==r?void 0:r.supportsDirectDownload,MetaUiHostVersion:null==o?void 0:o.metaUiHostVersion,SupportsAccessibilityLoop:null==r?void 0:r.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==r?void 0:r.supportsExcelExternalLinks,UiHostIntegrationType:null==r?void 0:r.uiHostIntegrationType,OpenLinksInNewWindow:null==r?void 0:r.openLinksInNewWindow,UiHostTabId:null==o?void 0:o.uiHostTabId,Upn:null==o?void 0:o.upn,TenantId:null==o?void 0:o.tenantId,Meeting:null==o?void 0:o.meeting,SupportsCustomAuthConfig:null==r?void 0:r.supportsCustomAuthConfig,ContentAssemblyMode:null==r?void 0:r.contentAssemblyMode,SupportsRefreshAccessToken:null==r?void 0:r.supportsRefreshAccessToken,IsSynthetic:null==o?void 0:o.isSynthetic,OwlVersion:null==o?void 0:o.owlVersion,OwlRollout:null==o?void 0:o.owlRollout}}(I?I.wac.userId:C,h,S,b,t,i,Re(d.wdValue),H),l=function(e,t){var i,r,o,s=e.docId,a=e.isNewFile,c=e.fileName,u=e.intent;return t?(0,n.pi)((0,n.pi)({FileName:t.fileName,FileGetUrl:(null===(i=t.wac)||void 0===i?void 0:i.fileGetUrl)||t.downloadUrl,CustomFontCatalogUrl:t.wac.customFontCatalogUrl,FileSize:t.fileSize,BundleInfo:{Url:t.bundleUrl,MajorVersion:t.bundleVersion,BundleStaleness:t.bundleStaleness},ReadOnly:t.readOnly,IrmEnabled:t.irmEnabled,ViewOnly:t.blocksDownload,ETag:t.eTag,ClientThrottlingProtection:null===(r=t.wac)||void 0===r?void 0:r.clientThrottlingProtection,RequestedCallThrottling:null===(o=t.wac)||void 0===o?void 0:o.requestedCallThrottling,IsNewFile:!!a||t.isNewFile},s&&{DocUniqueId:s}),{OpenViewByDefault:"view"===u}):(0,n.pi)({FileName:c,IsNewFile:!0},s&&{DocUniqueId:s})}(d,I),g=Se(T,a,y,E,e.performance,i,null==t?void 0:t.featureGates),w=null==t?void 0:t.uiHostName,_={WopiSrc:(c=I.wac).wopiSrc,AccessToken:c.accessToken,AccessTokenExpiry:new Date(parseInt(c.accessTokenExpiry,10))},k=function(e,t,i,o,s,a,c,u,l,d,h,v,m,g,w,y,_,C,S){var k=t.applicationUrl,b=t.bootstrapperUrl;void 0===l&&(l="officecom"),void 0===S&&(S={});var T={HostUIControls:C?[{id:"close",visibility:v?1:0},{id:"share",visibility:m?1:0},{id:"ellipsisOpenInBrowser",visibility:g?1:0},{id:"ellipsisDownload",visibility:w?1:0},{id:"copyLink",visibility:y?1:0}]:void 0,additionalApplicationParameters:S},A=Ee(h,k,l,d,_);return(0,n.pi)({BootstrapperUrl:b,Container:e,SessionInformation:o,ApplicationUrl:A,WopiPrecheckInfo:s,ApplicationCustomSettings:T,Diagnostics:a,FnOnInitializeSuccess:c,FnOnInitializeFailure:function(e){var t=e.errorObject.message,n=e.errorObject.stack,i={wacErrorName:me.AU.mi,qosErrorName:me.DG.QosError_EncounteredJsApiError,errorName:e.errorType,errorMessage:t,errorStack:n,error:e},o=St(i),s=JSON.stringify(Array.from(o.entries()));null==R||R.ULS.sendTraceTag(575419405,f.W.zn,p.G.Error,s),r.error(i)},FnIsFeatureEnabled:Ae(),RebootOverrideData:d.rebootOverrideData},i?{WopiInfo:i}:{})}(s,e,_,u,l,g,(function(e,t){r.next({wopiHostData:I,officeApplication:e,bootedDocumentInfo:new Be(d),wacBootDiagnostics:t}),r.complete()}),0,w,d,I,null==t?void 0:t.showCloseButton,null==t?void 0:t.supportsShare,null==t?void 0:t.openInBrowserEnabled,null==t?void 0:t.ellipsisDownloadACopyButtonEnabled,null==t?void 0:t.copyLinkEnabled,null==t?void 0:t.uiEmbed,null==t?void 0:t.supportsHostUiControls,null==i?void 0:i.additionalApplicationParameters),A=(0,v.a)();null==R||R.ULS.sendTraceTag(576578583,f.W.zn,p.G.Info,"BootStrapFile: About to call InitializeWopiPending");var N=m.Application.InitializeWopiPending(k,void 0,null==i?void 0:i.sessionId),P=(0,v.a)()-A;null==R||R.ULS.sendTraceTag(570775769,f.W.zn,p.G.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!N,"][TimeElapsed: ").concat(P,"]"));var O=(0,v.a)();if(N){o&&o(),N.Complete(_);var U=(0,v.a)(),M=U-O,D=U-A;null==R||R.ULS.sendTraceTag(570775770,f.W.zn,p.G.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(M,"][TimeElapsedSinceInitializeWopiPending: ").concat(D,"]"))}else{var F={wacErrorName:me.AU.fi,qosErrorName:me.DG.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"},x=St(F),q=JSON.stringify(Array.from(x.entries()));r.error(F),null==R||R.ULS.sendTraceTag(575419406,f.W.zn,p.G.Error,q)}}))}),l.next(P),l.complete()}else{var U=null!=g?g:"Error message undefined. BootStrapped not loaded: ".concat(!m);null==R||R.ULS.sendTraceTag(575419403,f.W.zn,p.G.Error,U);var M={wacErrorName:me.AU.hi,qosErrorName:me.DG.QosError_OfficeBootstrapperNotLoaded,errorMessage:U,error:g,inStaging:!1};r&&r(M)}})).catch((function(e){c(e)})),[2]}))}))}));Promise.race([x,q]).catch((function(e){var t=(null!=e?e:"Failed to load the document")+", bootstrapperUrl: ".concat(D.replace(/^https?:\/\//,"")),n={wacErrorName:me.AU.fi,qosErrorName:me.DG.QosError_FailedToLoadDocument,errorMessage:t,error:e,inStaging:!1};null==R||R.ULS.sendTraceTag(575419407,f.W.zn,p.G.Error,"".concat(me.AU.fi,": ").concat(t)),r&&r(n)}))}({documentBootInfo:(0,n.pi)((0,n.pi)({},e),i),correlationId:h,loadFunctionSubject:y,wopiFetchData:t},r,o,s,c,u,l,null===(a=null==d?void 0:d.get(e.fileType))||void 0===a?void 0:a.jsApiUrl)})).catch((function(e){null==g||g.ULS.sendTraceTag(509723932,f.W.zn,p.G.Error,"Failed to fetch document identifier for document with error: ".concat(e))}))})).catch((function(t){if(s){var n=JSON.stringify(t),i={wacErrorName:me.AU.di,qosErrorName:me.DG.QosError_VroomWopiFailure,errorMessage:n,error:t,httpErrorCode:t.status,networkError:vt(t)};s(i,e)}}));var C={correlationId:h,bootstrapperObservable:y.asObservable(),fileNamePromise:e.fileName?Promise.resolve(e.fileName):w.then((function(e){return e.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(e,t){w.then((function(t){var n,i;return e(null===(i=null===(n=null==t?void 0:t.wopiHostData)||void 0===n?void 0:n.wac)||void 0===i?void 0:i.applicationUrl)})).catch((function(e){t(e)}))}))};return o&&o.wiseEnvironment&&function(e,t,n,i,r,o){if(n){var s=(0,T.vJ)(T.Fh.FeatureGate_DisableEUDBBrowserULSRouting,r);e.then((function(e){if(e&&((0,T.dt)(T.Fh.FeatureGate_DisableEUDBBrowserULSRouting,s,n),!s)){var i=Ct(e),r=(0,m.fy)(t,i.dataBoundary);n.flushAndSetNewEndpoint(r,(function(){null==n||n.ULS.sendTraceTag(509612803,f.W.zn,p.G.Info,"Updated ULS endpoint. Environment: ".concat(t,", DataBoundary: ").concat(i.dataBoundary,", Region: ").concat(i.region))}))}})).catch((function(e){null==n||n.ULS.sendTraceTag(509875042,f.W.zn,p.G.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(e.message))}))}if(i){var a=(0,T.vJ)(T.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,r);e.then((function(e){if(e&&((0,T.dt)(T.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,a,n),!a)){var r=Ct(e),s=(0,m.S$)(t,o,r.dataBoundary);i.flushAndSetNewEndpoint(s,(function(){null==n||n.ULS.sendTraceTag(509612802,f.W.zn,p.G.Info,"Updated Health endpoint. Environment: ".concat(t,", DataBoundary: ").concat(r.dataBoundary,", Region: ").concat(r.region))}))}})).catch((function(e){null==n||n.ULS.sendTraceTag(509875041,f.W.zn,p.G.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(e.message))}))}}(C.applicationUrlPromise,o.wiseEnvironment,g,o.health,null==r?void 0:r.featureGates,o.sessionId),C}(e,t,i,r,o,s,a,c,(function(e,t,n,i){se=e;var r=new Be(n),o=re(t,r,i),s=o.documentRebootHandler,a=o.renameHandler,c=o.sessionRefreshInfoHandler,u=o.shareHandler,l=o.userAccessHandler,d=o.userActivityHandler,h=o.createNewHandler,f=o.getAuthTokenHandler,p=o.accessibilityLoopCompleteHandler,v=o.getClientUrlCompleteHandler,m=o.wopiInfoFromUrlHandler,g=o.davUrlFromIdsHandler,w=o.onCloseHandler,y=o.actionCompleteHandler,_=o.openInBrowserHandler,C=o.openInMobileAppHandler,S=o.moveToFolderPickerHandler,k=o.commonFilePickerHandler,b=o.getCustomAuthConfigHandler,T=o.pushStateHandler,A=o.caaeMessageHandler,I=o.frameChangedHandler,E=o.fileEmbedHandler,R=o.dismissSplashScreenHandler;ee=function(e){var t=e.data;switch(e.type){case Gt.Reboot:s(t);break;case Gt.FileRenamed:a(t);break;case Gt.UserAccessAndPermissions:l(t);break;case Gt.Share:u(t);break;case Gt.UserActivity:d(t);break;case Gt.CreateNewDocument:h(t);break;case Gt.RefreshSessionInfo:c(t);break;case Gt.GetAuthToken:f(t);break;case Gt.AccessibilityLoopCompleted:p(t);break;case Gt.GetClientUrlComplete:v(t);break;case Gt.GetWopiInfoFromUrl:m(t);break;case Gt.Close:w();break;case Gt.ActionCompleted:y(t);break;case Gt.OpenInBrowser:_(t);break;case Gt.OpenInMobileApp:C(t);break;case Gt.MoveToFolder:S(t);break;case Gt.SharedFilePicker:k(t);break;case Gt.GetCustomAuthConfig:b(t);break;case Gt.GetDavUrlFromIds:g(t);break;case Gt.PushState:T(t);break;case Gt.CAAEMessage:A(t);break;case Gt.FrameChanged:I(t);break;case Gt.FileEmbed:E();break;case Gt.DismissSplashScreen:R()}},se.addEventListener(ee)}),l,d)}(a,G,c,A,l,y,!1,b,0,te,oe),ce=ae.correlationId,ue=ae.bootstrapperObservable,le=ae.fileNamePromise,de=ae.applicationUrlPromise;null==Q||Q.ULS.sendTraceTag(546182048,f.W.zn,p.G.Info,"BootApp: Load document returned"),le.then((function(e){return null==g?void 0:g(e)})).catch((function(){return"obligatory catch"}));var fe,we=void 0,Te=void 0,Ne=void 0,Pe=new he.xQ;return Te=function(e,t,n){return e.pipe(ot((function(e){return e({container:t,flushTime:n})}),void 0,1))}(ue,d,o).subscribe((function(e){var t=e.officeApplication,i=e.bootedDocumentInfo,r=e.wopiHostData,o=e.officeDocumentSession,s=e.wacBootDiagnostics;se=t,we=o;var c=Je(window,"message").pipe(dt((function(e){return!!e.data&&!!e.origin&&e.origin.endsWith(Jt)})),Ge((function(e){return JSON.parse(e.data)})),dt((function(e){return!(!e||!e.MessageId)})));if(!Z){var u=re(r,i,o),d=u.documentRebootHandler,h=u.renameHandler,m=u.sessionRefreshInfoHandler,g=u.shareHandler,y=u.userAccessHandler,C=u.userActivityHandler,S=u.createNewHandler,b=u.getAuthTokenHandler,T=u.accessibilityLoopCompleteHandler,I=u.getClientUrlCompleteHandler,E=u.getWebUrlCompleteHandler,R=u.wopiInfoFromUrlHandler,H=u.davUrlFromIdsHandler,O=u.onCloseHandler,U=u.actionCompleteHandler,M=u.openInBrowserHandler,D=u.moveToFolderPickerHandler,F=u.commonFilePickerHandler,q=u.getCustomAuthConfigHandler,B=u.pushStateHandler,L=u.caaeMessageHandler,W=u.fileEmbedHandler;ne=[[Tt.Dm.PostMessage_AccessibilityLoopComplete,T],[Tt.Dm.PostMessage_GetClientUrlComplete,I],[Tt.E_.Event_DocumentReboot,d],[Tt.Dm.PostMessage_FileRenamed,h],[Tt.Dm.PostMessage_CheckUserAccess,y],[Tt.Dm.PostMessage_Share,g],[Tt.Dm.PostMessage_UserActivity,C],[Tt.Dm.PostMessage_AppCreateNewDocument,S],[Tt.Dm.PostMessage_OpenInBrowser,M],[Tt.E_.Event_MoveToFolder,D],[Tt.E_.Event_SharedFilePicker,F],[Tt.E_.Event_GetCustomAuthConfig,q],[Tt.Dm.PostMessage_CAAEMessage,L]],a.fileType===k.T.Excel&&(ne.push([Tt.E_.Event_GetWopiInfoFromUrl,R]),ne.push([Tt.E_.Event_GetDavUrlFromIds,H])),ne.forEach((function(e){var i=(0,n.CR)(e,2),r=i[0],o=i[1];t.RegisterEventHandler(r,o)})),Ne=c.subscribe((function(e){switch(e.MessageId){case Tt.Dm.PostMessage_AppRefreshSessionInfo:m(e.Values);break;case Tt.Dm.PostMessage_GetAuthToken:b(e.Values);break;case Tt.Dm.PostMessage_Close:O();break;case Tt.Dm.PostMessage_ActionComplete:U(e.Values);break;case Tt.Dm.PostMessage_AppPushState:B(e.Values);break;case Tt.Dm.PostMessage_GetClientUrlComplete:I(e.values);break;case Tt.Dm.PostMessage_GetWebUrlComplete:E(e.values);break;case Tt.Dm.PostMessage_FileEmbed:W()}}))}if(w){if(null==Q||Q.ULS.sendTraceTag(546182049,f.W.zn,p.G.Info,"BootApp: About to execute OnBootComplete"),(0,v.l)(_.OwlOnBootComplete),!N.isOwlFrame&&!N.isOwlFrameExperimentEnabled(null==A?void 0:A.featureGates,Q)){var j=function(e){var t,i=e[_.OwlStart]||e[_.OwlWithCustomFunctionsStart],r=e[_.OwlOnBootComplete];return{totalTime:r-i,owlPerformanceTimeline:(0,n.pi)((0,n.pi)({},e),((t={})[_.OwlStart]=i,t[_.OwlEnd]=r,t))}}(x("owl"));null==Q||Q.ULS.sendTraceTag(508568928,f.W.zn,p.G.Important,P(a.fileType,l.wiseEnvironment,null==A?void 0:A.featureGates,null==A?void 0:A.uiHostName,null==A?void 0:A.uiHostIntegrationType,Q)+", OwlTraditional Telemetry Data: "+JSON.stringify(j))}w(a,s)}}),(function(e){y&&(null==Q||Q.ULS.sendTraceTag(546182050,f.W.zn,p.G.Info,"BootApp: About to execute OnBootFailure"),y(e)),null==Te||Te.unsubscribe(),null==Ne||Ne.unsubscribe()})),{endSession:ie,sessionEndObservable:Pe.asObservable(),hostAccessibilityLoopComplete:function(e){return(0,Rt.R)(Tt.KX.PostMessage_HostAccessibilityLoopComplete,{Direction:e?"forward":"backward"},de,we,Q),!0},hostGetClientUrl:function(){(0,Rt.R)(Tt.KX.PostMessage_HostGetClientUrl,{},de,we,Q)},hostGetWebUrl:function(){(0,Rt.R)(Tt.KX.PostMessage_HostGetWebUrl,{},de,we,Q)},postFrameDiagnostics:function(e){(0,Rt.R)(Tt.KX.PostMessage_OwlFrameDiagnostics,{FrameDiagnostics:e},de,we,Q)}}}var en=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference"];function tn(e,t,n,i,r,o,s,a,c,u,l,d,h,f,p,v){var m=new b.zP(e,n,t,c,a,u).health;return null==m||m.addQosPillar("Open"),null==m||m.updatePartADimensions({applicationLcid:i,loggableUserId:r,tenantId:o,uiHost:l,uiHostIntegrationType:d,sessionOrigin:h}),null==m||m.addOrUpdatePartCDimension("HostCorrelationId",s),null==m||m.addOrUpdatePartCDimension("AppSessionId",e),null==m||m.addOrUpdatePartCDimension("HostRingId",null!=f?f:"n/a"),null==m||m.addOrUpdatePartCDimension("IsNewFile",(!!p).toString()),null==m||m.addOrUpdatePartCDimension("isOdcMigrated",(!!v).toString()),null==m||m.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),m}var nn=s(9920),rn=s(7593),on=s(5980),sn=s(1464);class an{constructor(e){this.browserEnvironment="undefined"!=typeof window,this.config=(0,on._7)(e,this.browserEnvironment),this.logger=new rn.Y(this.config.system.loggerOptions,sn.u,sn.i),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class cn extends an{getModuleName(){return cn.MODULE_NAME}getId(){return cn.ID}async initialize(){return!1}}cn.MODULE_NAME="",cn.ID="TeamsAppOperatingContext";class un extends an{getModuleName(){return un.MODULE_NAME}getId(){return un.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}un.MODULE_NAME="",un.ID="StandardOperatingContext";class ln{constructor(e){this.config=e,this.logger=new rn.Y({loggerCallback:void 0,piiLoggingEnabled:!1,logLevel:void 0,correlationId:void 0},sn.u,sn.i)}async createController(){const e=new un(this.config),t=new cn(this.config),n=[e.initialize(),t.initialize()];return Promise.all(n).then((async()=>{if(t.isAvailable()){const t=await Promise.resolve().then(s.bind(s,4073));return await t.StandardController.createController(e)}if(e.isAvailable()){const t=await Promise.resolve().then(s.bind(s,4073));return await t.StandardController.createController(e)}throw new Error("No controller found.")}))}}var dn=s(4073);class hn{static async createPublicClientApplication(e){const t=new ln(e),n=await t.createController();return new hn(e,n)}constructor(e,t){if(t)this.controller=t;else{const t=new un(e);this.controller=new dn.StandardController(t)}}async initialize(){return this.controller.initialize()}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(){return this.controller.getAllAccounts()}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var fn=s(9616);class pn{constructor(e,t,n,i,r,o,s){this.authority=t,this.libraryName=i,this.libraryVersion=r,this.applicationTelemetry=o,this.clientId=e,this.logger=n,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=s||new Set;for(const e of fn.x0)this.intFields.add(e)}startPerformanceMeasurement(e,t){return{}}getPreQueueTime(e,t){const n=this.preQueueTimeByCorrelationId.get(t);if(n){if(n.name===e)return n.time;this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${e}, unable to add queue measurement`)}else this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${t}, unable to add queue measurement`)}calculateQueuedTime(e,t){return e<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${e}`),0):t<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${t}`),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e}addQueueMeasurement(e,t,n,i){if(!t)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${e}, cannot add queue measurement`);if(0===n)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${e} is ${n}`);else if(!n)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${e}`);const r={eventName:e,queueTime:n,manuallyCompleted:i},o=this.queueMeasurements.get(t);if(o)o.push(r),this.queueMeasurements.set(t,o);else{this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${t} to queue measurements`);const e=[r];this.queueMeasurements.set(t,e)}this.preQueueTimeByCorrelationId.delete(t)}startMeasurement(e,t){const n=t||this.generateId();t||this.logger.info(`PerformanceClient: No correlation id provided for ${e}, generating`,n),this.logger.trace(`PerformanceClient: Performance measurement started for ${e}`,n);const i=this.startPerformanceMeasurement(e,n);i.startMeasurement();const r={wi:this.generateId(),status:fn.$L.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:n,appName:this.applicationTelemetry?.appName,appVersion:this.applicationTelemetry?.appVersion};return this.cacheEventByCorrelationId(r),{end:e=>this.endMeasurement({...r,...e},i),discard:()=>this.discardMeasurements(r.correlationId),add:e=>this.addFields(e,r.correlationId),increment:e=>this.incrementFields(e,r.correlationId),measurement:i,event:r}}endMeasurement(e,t){const n=this.eventsByCorrelationId.get(e.correlationId);if(!n)return this.logger.trace(`PerformanceClient: Measurement not found for ${e.wi}`,e.correlationId),null;const i=e.wi===n.wi;let r={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};i?(r=this.getQueueInfo(e.correlationId),this.discardCache(n.correlationId)):n.incompleteSubMeasurements?.delete(e.wi),t?.endMeasurement();const o=t?.flushMeasurement();if(!o)return this.logger.trace("PerformanceClient: Performance measurement not taken",n.correlationId),null;if(this.logger.trace(`PerformanceClient: Performance measurement ended for ${e.name}: ${o} ms`,e.correlationId),!i)return n[e.name+"DurationMs"]=Math.floor(o),{...n};let s={...n,...e},a=0;return s.incompleteSubMeasurements?.forEach((t=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${t.name} found for ${e.name}`,s.correlationId),a++})),s.incompleteSubMeasurements=void 0,s={...s,durationMs:Math.round(o),queuedTimeMs:r.totalQueueTime,queuedCount:r.totalQueueCount,queuedManuallyCompletedCount:r.manuallyCompletedCount,status:fn.$L.Completed,incompleteSubsCount:a},this.truncateIntegralFields(s),this.emitEvents([s],e.correlationId),s}addFields(e,t){this.logger.trace("PerformanceClient: Updating static fields");const n=this.eventsByCorrelationId.get(t);n?this.eventsByCorrelationId.set(t,{...n,...e}):this.logger.trace("PerformanceClient: Event not found for",t)}incrementFields(e,t){this.logger.trace("PerformanceClient: Updating counters");const n=this.eventsByCorrelationId.get(t);if(n)for(const t in e){if(n.hasOwnProperty(t)){if(isNaN(Number(n[t])))return}else n[t]=0;n[t]+=e[t]}else this.logger.trace("PerformanceClient: Event not found for",t)}cacheEventByCorrelationId(e){const t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} added/updated`,e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.wi,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} started`,e.correlationId),this.eventsByCorrelationId.set(e.correlationId,{...e}))}getQueueInfo(e){const t=this.queueMeasurements.get(e);t||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${e}`);let n=0,i=0,r=0;return t?.forEach((e=>{n+=e.queueTime,i++,r+=e.manuallyCompleted?1:0})),{totalQueueTime:n,totalQueueCount:i,manuallyCompletedCount:r}}discardMeasurements(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)}discardCache(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)}addPerformanceCallback(e){const t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${t}`),t}removePerformanceCallback(e){const t=this.callbacks.delete(e);return t?this.logger.verbose(`PerformanceClient: Performance callback ${e} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${e} not removed.`),t}emitEvents(e,t){this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(((n,i)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${i}`,t),n.apply(null,[e])}))}truncateIntegralFields(e){this.intFields.forEach((t=>{t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))}}var vn=s(9930);class mn{constructor(e,t){this.correlationId=t,this.measureName=mn.makeMeasureName(e,t),this.startMark=mn.makeStartMark(e,t),this.endMark=mn.makeEndMark(e,t)}static makeMeasureName(e,t){return`msal.measure.${e}.${t}`}static makeStartMark(e,t){return`msal.start.${e}.${t}`}static makeEndMark(e,t){return`msal.end.${e}.${t}`}static supportsBrowserPerformance(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName}static flushMeasurements(e,t){if(mn.supportsBrowserPerformance())try{t.forEach((t=>{const n=mn.makeMeasureName(t.name,e);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(mn.makeStartMark(n,e)),window.performance.clearMarks(mn.makeEndMark(n,e)))}))}catch(e){}}startMeasurement(){if(mn.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}}endMeasurement(){if(mn.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}}flushMeasurement(){if(mn.supportsBrowserPerformance())try{const e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){const t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch(e){}return null}}class gn extends pn{constructor(e,t){super(e.auth.clientId,e.auth.authority||`${vn.gT.DEFAULT_AUTHORITY}`,new rn.Y(e.system?.loggerOptions||{},sn.u,sn.i),sn.u,sn.i,e.telemetry?.application||{appName:"",appVersion:""},t)}startPerformanceMeasurement(e,t){return new mn(e,t)}generateId(){return window.crypto.randomUUID()}getPageVisibility(){return document.visibilityState?.toString()||null}deleteIncompleteSubMeasurements(e){const t=this.eventsByCorrelationId.get(e.event.correlationId),n=t&&t.wi===e.event.wi,i=[];n&&t?.incompleteSubMeasurements&&t.incompleteSubMeasurements.forEach((e=>{i.push({...e})})),i.length>0&&mn.flushMeasurements(e.event.correlationId,i)}supportsBrowserPerformanceNow(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now}startMeasurement(e,t){const n=this.getPageVisibility(),i=super.startMeasurement(e,t);return{...i,end:e=>{const t=i.end({startPageVisibility:n,endPageVisibility:this.getPageVisibility(),...e});return this.deleteIncompleteSubMeasurements(i),t},discard:()=>{i.discard(),this.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}}}setPreQueueTime(e,t){if(!this.supportsBrowserPerformanceNow())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${e}`);if(!t)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to set telemetry queue time`);const n=this.preQueueTimeByCorrelationId.get(t);n&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${n.name} found`,t),this.addQueueMeasurement(n.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}addQueueMeasurement(e,t,n,i){if(!this.supportsBrowserPerformanceNow())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${e}`);if(!t)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to add queue measurement`);const r=super.getPreQueueTime(e,t);if(!r)return;const o=window.performance.now(),s=n||super.calculateQueuedTime(r,o);return super.addQueueMeasurement(e,t,s,i)}}var wn=s(9744),yn="function",_n="object",Cn="undefined",Sn="prototype",kn="hasOwnProperty",bn=Object,Tn=bn[Sn],An=bn.assign,In=bn.create,En=bn.defineProperty,Rn=Tn[kn],Nn=null;function Pn(e){void 0===e&&(e=!0);var t=!1===e?null:Nn;return t||(typeof globalThis!==Cn&&(t=globalThis),t||typeof self===Cn||(t=self),t||typeof window===Cn||(t=window),t||typeof s.g===Cn||(t=s.g),Nn=t),t}function Hn(e){throw new TypeError(e)}function On(e){if(In)return In(e);if(null==e)return{};var t=typeof e;function n(){}return t!==_n&&t!==yn&&Hn("Object prototype may only be an Object:"+e),n[Sn]=e,new n}(Pn()||{}).Symbol,(Pn()||{}).Reflect;var Un,Mn=function(e,t){return Mn=bn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[kn](n)&&(e[n]=t[n])},Mn(e,t)};function Dn(e,t){function n(){this.constructor=e}typeof t!==yn&&null!==t&&Hn("Class extends value "+String(t)+" is not a constructor or null"),Mn(e,t),e[Sn]=null===t?On(t):(n[Sn]=t[Sn],new n)}function Fn(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}var xn,qn="undefined",Bn="constructor",Ln="prototype",Wn="function",jn="_dynInstFuncs",Kn="_isDynProxy",Gn="_dynClass",$n="_dynInstChk",zn=$n,Jn="_dfOpts",Vn="_unknown_",Qn="__proto__",Xn="_dyn"+Qn,Yn="__dynProto$Gbl",Zn="_dynInstProto",ei="useBaseInst",ti="setInstFuncs",ni=Object,ii=ni.getPrototypeOf,ri=ni.getOwnPropertyNames,oi=(typeof globalThis!==qn&&(xn=globalThis),xn||typeof self===qn||(xn=self),xn||typeof window===qn||(xn=window),xn||typeof s.g===qn||(xn=s.g),xn||{}),si=oi[Yn]||(oi[Yn]={o:(Un={},Un[ti]=!0,Un[ei]=!0,Un),n:1e3});function ai(e,t){return e&&ni[Ln].hasOwnProperty.call(e,t)}function ci(e){return e&&(e===ni[Ln]||e===Array[Ln])}function ui(e){return ci(e)||e===Function[Ln]}function li(e){var t;if(e){if(ii)return ii(e);var n=e[Qn]||e[Ln]||(e[Bn]?e[Bn][Ln]:null);t=e[Xn]||n,ai(e,Xn)||(delete e[Zn],t=e[Xn]=e[Zn]||e[Xn],e[Zn]=n)}return t}function di(e,t){var n=[];if(ri)n=ri(e);else for(var i in e)"string"==typeof i&&ai(e,i)&&n.push(i);if(n&&n.length>0)for(var r=0;r<n.length;r++)t(n[r])}function hi(e,t,n){return t!==Bn&&typeof e[t]===Wn&&(n||ai(e,t))}function fi(e){throw new TypeError("DynamicProto: "+e)}function pi(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function vi(e,t){return ai(e,Ln)?e.name||t||Vn:((e||{})[Bn]||{}).name||t||Vn}function mi(e,t,n,i){ai(e,Ln)||fi("theClass is an invalid class definition.");var r=e[Ln];(function(e,t){if(ii){for(var n=[],i=li(t);i&&!ui(i)&&!pi(n,i);){if(i===e)return!0;n.push(i),i=li(i)}return!1}return!0})(r,t)||fi("["+vi(e)+"] not in hierarchy of ["+vi(t)+"]");var o=null;ai(r,Gn)?o=r[Gn]:(o="_dynCls$"+vi(e,"_")+"$"+si.n,si.n++,r[Gn]=o);var s=mi[Jn],a=!!s[ei];a&&i&&void 0!==i[ei]&&(a=!!i[ei]);var c=function(e){var t={};return di(e,(function(n){!t[n]&&hi(e,n,!1)&&(t[n]=e[n])})),t}(t),u=function(e,t,n,i){function r(e,t,n){var r=t[n];if(r[Kn]&&i){var o=e[jn]||{};!1!==o[zn]&&(r=(o[t[Gn]]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var o={};di(n,(function(e){o[e]=r(t,n,e)}));for(var s=li(e),a=[];s&&!ui(s)&&!pi(a,s);)di(s,(function(e){!o[e]&&hi(s,e,!ii)&&(o[e]=r(t,s,e))})),a.push(s),s=li(s);return o}(r,t,c,a);n(t,u);var l=!!ii&&!!s[ti];l&&i&&(l=!!i[ti]),function(e,t,n,i,r){if(!ci(e)){var o=n[jn]=n[jn]||{},s=o[t]=o[t]||{};!1!==o[zn]&&(o[zn]=!!r),di(n,(function(t){hi(n,t,!1)&&n[t]!==i[t]&&(s[t]=n[t],delete n[t],(!ai(e,t)||e[t]&&!e[t][Kn])&&(e[t]=function(e,t){var n=function(){var i=function(e,t,n,i){var r=null;if(e&&ai(n,Gn)){var o=e[jn]||{};if((r=(o[n[Gn]]||{})[t])||fi("Missing ["+t+"] "+Wn),!r[$n]&&!1!==o[zn]){for(var s=!ai(e,t),a=li(e),c=[];s&&a&&!ui(a)&&!pi(c,a);){var u=a[t];if(u){s=u===i;break}c.push(a),a=li(a)}try{s&&(e[t]=r),r[$n]=1}catch(e){o[zn]=!1}}}return r}(this,t,e,n)||function(e,t,n){var i=t[e];return i===n&&(i=li(t)[e]),typeof i!==Wn&&fi("["+e+"] is not a "+Wn),i}(t,e,n);return i.apply(this,arguments)};return n[Kn]=1,n}(e,t)))}))}}(r,o,t,c,!1!==l)}mi[Jn]=si.o;var gi="initialize",wi="name",yi="getNotifyMgr",_i="identifier",Ci="push",Si="isInitialized",ki="config",bi="instrumentationKey",Ti="logger",Ai="length",Ii="time",Ei="processNext",Ri="getProcessTelContext",Ni="addNotificationListener",Pi="removeNotificationListener",Hi="stopPollingInternalLogs",Oi="onComplete",Ui="getPlugin",Mi="flush",Di="_extensions",Fi="splice",xi="teardown",qi="messageId",Bi="message",Li="isAsync",Wi="_doTeardown",ji="update",Ki="getNext",Gi="diagLog",$i="setNextPlugin",zi="createNew",Ji="cookieCfg",Vi="indexOf",Qi="substring",Xi="userAgent",Yi="split",Zi="setEnabled",er="substr",tr="nodeType",nr="apply",ir="replace",rr="enableDebugExceptions",or="toLowerCase",sr="call",ar="type",cr="handler",ur="listeners",lr="isChildEvt",dr="getCtx",hr="setCtx",fr="complete",pr="traceId",vr="spanId",mr="traceFlags",gr="",wr="channels",yr="core",_r="createPerfMgr",Cr="disabled",Sr="extensionConfig",kr="processTelemetry",br="priority",Tr="eventsSent",Ar="eventsDiscarded",Ir="eventsSendRequest",Er="perfEvent",Rr="errorToConsole",Nr="warnToConsole",Pr="getPerfMgr",Hr="toISOString",Or="endsWith",Ur="startsWith",Mr="indexOf",Dr="trim",Fr="toString",xr="__proto__",qr="constructor",Br=En,Lr=bn.freeze,Wr=(bn.seal,bn.keys),jr=String[Sn],Kr=jr[Dr],Gr=jr[Or],$r=jr[Ur],zr=Date[Sn][Hr],Jr=Array.isArray,Vr=Tn[Fr],Qr=Rn[Fr],Xr=Qr[sr](bn),Yr=/-([a-z])/g,Zr=/([^\w\d_$])/g,eo=/^(\d+[\w\d_$])/,to=Object.getPrototypeOf;function no(e){return void 0===e||typeof e===Cn}function io(e){return null===e||no(e)}function ro(e){return!io(e)}function oo(e){return!(!e||typeof e!==_n)}function so(e){return!(!e||typeof e!==yn)}function ao(e){var t=e;return t&&fo(t)&&(t=(t=(t=t[ir](Yr,(function(e,t){return t.toUpperCase()})))[ir](Zr,"_"))[ir](eo,(function(e,t){return"_"+t}))),t}function co(e,t){if(e)for(var n in e)Rn[sr](e,n)&&t[sr](e,n,e[n])}function uo(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=$r?e[Ur](t):function(e,t){var n=!1,i=t?t[Ai]:0;if(e&&i&&e[Ai]>=i&&!(n=e===t)){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;n=!0}return n}(e,t)),n}function lo(e,t){return!(!e||!t)&&-1!==e[Vi](t)}var ho=Jr||function(e){return!(!e||"[object Array]"!==Vr[sr](e))};function fo(e){return"string"==typeof e}function po(e){return"number"==typeof e}function vo(e){return"boolean"==typeof e}function mo(e){var t=!1;if(e&&"object"==typeof e){var n=to?to(e):function(e){if(e){if(to)return to(e);var t=e[xr]||e[Sn]||e[qr];if(t)return t}return null}(e);n?(n[qr]&&Rn[sr](n,qr)&&(n=n[qr]),t=typeof n===yn&&Qr[sr](n)===Xr):t=!0}return t}function go(e){if(e)return zr?e[Hr]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[Ai]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function wo(e,t,n){var i=e[Ai];try{for(var r=0;r<i&&(!(r in e)||-1!==t[sr](n||e,e[r],r,e));r++);}catch(e){}}function yo(e,t,n){if(e){if(e[Mr])return e[Mr](t,n);var i=e[Ai],r=n||0;try{for(var o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function _o(e){return e&&(e=Kr&&e[Dr]?e[Dr]():e[ir]?e[ir](/^\s+|(?=\s)\s+$/g,gr):e),e}var Co=!{toString:null}.propertyIsEnumerable("toString"),So=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function ko(e){var t=typeof e;if(t===yn||t===_n&&null!==e||Hn("objKeys called on non-object"),!Co&&Wr)return Wr(e);var n=[];for(var i in e)e&&Rn[sr](e,i)&&n[Ci](i);if(Co)for(var r=So[Ai],o=0;o<r;o++)e&&Rn[sr](e,So[o])&&n[Ci](So[o]);return n}function bo(e,t,n,i){if(Br)try{var r={enumerable:!0,configurable:!0};return n&&(r.get=n),i&&(r.set=i),Br(e,t,r),!0}catch(e){}return!1}function To(e){return Lr&&co(e,(function(e,t){(ho(t)||oo(t))&&Lr(t)})),Ao(e)}var Ao=Lr||function(e){return e};function Io(){var e=Date;return e.now?e.now():(new e).getTime()}function Eo(e){return(t=e)&&"[object Error]"===Vr[sr](t)?e[wi]:gr;var t}function Ro(e,t,n,i,r){var o=n;return e&&((o=e[t])===n||r&&!r(o)||i&&!i(n)||(o=n,e[t]=o)),o}function No(e,t,n){var i;return e?!(i=e[t])&&io(i)&&(i=no(n)?{}:n,e[t]=i):i=no(n)?{}:n,i}function Po(e,t){return io(e)?t:e}function Ho(e){return!!e}function Oo(e){throw new Error(e)}function Uo(e,t,n,i,r){e&&t&&n&&(!1!==r||no(e[t]))&&(e[t]=function(e,t){var n=null,i=null;return so(e)?n=e:i=e,function(){var e=arguments;if(n&&(i=n()),i)return i[t][nr](i,e)}}(n,i))}function Mo(e){return e&&An&&(e=bn(An({},e))),e}function Do(e,t,n,i,r,o){var s=arguments,a=s[0]||{},c=s[Ai],u=!1,l=1;for(c>0&&vo(a)&&(u=a,a=s[l]||{},l++),oo(a)||(a={});l<c;l++){var d=s[l],h=ho(d),f=oo(d);for(var p in d)if(h&&p in d||f&&Rn[sr](d,p)){var v=d[p],m=void 0;if(u&&v&&((m=ho(v))||mo(v))){var g=a[p];m?ho(g)||(g=[]):mo(g)||(g={}),v=Do(u,g,v)}void 0!==v&&(a[p]=v)}}return a}var Fo="ctx",xo="ParentContextKey",qo="ChildrenContextKey",Bo=function(){function e(t,n,i){var r,o=this,s=!1;o.start=Io(),o[wi]=t,o[Li]=i,o[lr]=function(){return!1},so(n)&&(s=bo(o,"payload",(function(){return!r&&so(n)&&(r=n(),n=null),r}))),o[dr]=function(t){return t?t===e[xo]||t===e[qo]?o[t]:(o[Fo]||{})[t]:null},o[hr]=function(t,n){t&&(t===e[xo]?(o[t]||(o[lr]=function(){return!0}),o[t]=n):t===e[qo]?o[t]=n:(o[Fo]=o[Fo]||{})[t]=n)},o[fr]=function(){var t=0,i=o[dr](e[qo]);if(ho(i))for(var r=0;r<i[Ai];r++){var a=i[r];a&&(t+=a[Ii])}o[Ii]=Io()-o.start,o.exTime=o[Ii]-t,o[fr]=function(){},!s&&so(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Lo=function(){function e(t){this.ctx={},mi(e,this,(function(e){e.create=function(e,t,n){return new Bo(e,t,n)},e.fire=function(e){e&&(e[fr](),t&&so(t[Er])&&t[Er](e))},e[hr]=function(t,n){t&&((e[Fo]=e[Fo]||{})[t]=n)},e[dr]=function(t){return(e[Fo]||{})[t]}}))}return e.__ieDyn=1,e}(),Wo="CoreUtils.doPerf";function jo(e,t,n,i,r){if(e){var o=e;if(o[Pr]&&(o=o[Pr]()),o){var s=void 0,a=o[dr](Wo);try{if(s=o.create(t(),i,r)){if(a&&s[hr]&&(s[hr](Bo[xo],a),a[dr]&&a[hr])){var c=a[dr](Bo[qo]);c||(c=[],a[hr](Bo[qo],c)),c[Ci](s)}return o[hr](Wo,s),n(s)}}catch(e){s&&s[hr]&&s[hr]("exception",e)}finally{s&&o.fire(s),o[hr](Wo,a)}}}return n()}var Ko="window",Go="document",$o="navigator",zo="location",Jo="JSON",Vo="crypto",Qo="msCrypto",Xo="msie",Yo="trident/",Zo="XMLHttpRequest",es=null,ts=null,ns=!1,is=null,rs=null;function os(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[Sn];i&&(n=t in i)}}catch(e){}if(!n)try{n=!no((new e)[t])}catch(e){}}return n}function ss(e){var t=Pn();return t&&t[e]?t[e]:e===Ko&&as()?window:null}function as(){return Boolean(typeof window===_n&&window)}function cs(){return as()?window:ss(Ko)}function us(){return Boolean(typeof document===_n&&document)}function ls(){return us()?document:ss(Go)}function ds(){return Boolean(typeof navigator===_n&&navigator)}function hs(){return ds()?navigator:ss($o)}function fs(e){if(e&&ns){var t=ss("__mockLocation");if(t)return t}return typeof location===_n&&location?location:ss(zo)}function ps(){return Boolean(typeof JSON===_n&&JSON||null!==ss(Jo))}function vs(){return ps()?JSON||ss(Jo):null}function ms(){var e=hs();return!(!e||!e.product)&&"ReactNative"===e.product}function gs(){var e=hs();if(e&&(e[Xi]!==ts||null===es)){var t=((ts=e[Xi])||gr)[or]();es=lo(t,Xo)||lo(t,Yo)}return es}function ws(e){var t=Object[Sn].toString[sr](e),n=gr;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[wi]+"'":ps()&&(n=vs().stringify(e)),t+n}function ys(){return null===rs&&(rs=ds()&&Boolean(hs().sendBeacon)),rs}function _s(e){var t=!1;try{t=!!ss("fetch");var n=ss("Request");t&&e&&n&&(t=os(n,"keepalive"))}catch(e){}return t}function Cs(){var e=!1;try{e=!!ss(Zo)}catch(e){}return e}var Ss,ks=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],bs=null;function Ts(e,t){return function(){var n=arguments,i=As(t);if(i){var r=i.listener;r&&r[e]&&r[e][nr](r,n)}}}function As(e){var t,n=bs;return n||!0===e.disableDbgExt||(n=bs||((t=ss("Microsoft"))&&(bs=t.ApplicationInsights),bs)),n?n.ChromeDbgExt:null}function Is(e){if(!Ss){Ss={};for(var t=0;t<ks[Ai];t++)Ss[ks[t]]=Ts(ks[t],e)}return Ss}function Es(e){return e?'"'+e[ir](/\"/g,gr)+'"':gr}function Rs(e,t){var n=typeof console!==Cn?console:ss("console");if(n){var i="log";n[e]&&(i=e),so(n[i])&&n[i](t)}}var Ns=function(){function e(e,t,n,i){void 0===n&&(n=!1);var r=this;r[qi]=e,r[Bi]=(n?"AI: ":"AI (Internal): ")+e;var o=gr;ps()&&(o=vs().stringify(i));var s=(t?" message:"+Es(t):gr)+(i?" props:"+Es(o):gr);r[Bi]+=s}return e.dataType="MessageData",e}();function Ps(e,t){return(e||{})[Ti]||new Hs(t)}var Hs=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,i,r,o,s=0,a={};mi(e,this,(function(e){function c(t,n){if(!(s>=r)){var o=!0,c="AITR_"+n[qi];if(a[c]?o=!1:a[c]=!0,o&&(t<=i&&(e.queue[Ci](n),s++,u(1===t?"error":"warn",n)),s===r)){var l="Internal events throttle limit per PageView reached for this app.",d=new Ns(23,l,!1);e.queue[Ci](d),1===t?e[Rr](l):e[Nr](l)}}}function u(e,n){var i=As(t||{});i&&i[Gi]&&i[Gi](e,n)}!function(e){n=Po(e.loggingLevelConsole,0),i=Po(e.loggingLevelTelemetry,1),r=Po(e.maxMessageLimit,25),o=Po(e.enableDebug,Po(e[rr],!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return i},e.maxInternalMessageLimit=function(){return r},e[rr]=function(){return o},e.throwInternal=function(t,i,r,s,l){void 0===l&&(l=!1);var d=new Ns(i,r,l,s);if(o)throw ws(d);var h=1===t?Rr:Nr;if(no(d[Bi]))u("throw"+(1===t?"Critical":"Warning"),d);else{if(l){var f=+d[qi];!a[f]&&n>=t&&(e[h](d[Bi]),a[f]=!0)}else n>=t&&e[h](d[Bi]);c(t,d)}},e[Nr]=function(e){Rs("warn",e),u("warning",e)},e[Rr]=function(e){Rs("error",e),u("error",e)},e.resetInternalMessageCount=function(){s=0,a={}},e.logInternalMessage=c}))}return e.__ieDyn=1,e}();function Os(e){return e||new Hs}function Us(e,t,n,i,r,o){void 0===o&&(o=!1),Os(e).throwInternal(t,n,i,r,o)}function Ms(e,t){Os(e)[Nr](t)}var Ds=4294967296,Fs=4294967295,xs=!1,qs=123456789,Bs=987654321;function Ls(e){var t=0,n=ss(Vo)||ss(Qo);return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Fs),0===t&&gs()&&(xs||function(){try{var e=2147483647&Io();(t=(Math.random()*Ds^e)+e)<0&&(t>>>=0),qs=123456789+t&Fs,Bs=987654321-t&Fs,xs=!0}catch(e){}var t}(),t=function(e){var t=((Bs=36969*(65535&Bs)+(Bs>>16)&Fs)<<16)+(65535&(qs=18e3*(65535&qs)+(qs>>16)&Fs))>>>0&Fs|0;return t>>>=0}()&Fs),0===t&&(t=Math.floor(Ds*Math.random()|0)),e||(t>>>=0),t}function Ws(e){void 0===e&&(e=22);for(var t=Ls()>>>0,n=0,i=gr;i[Ai]<e;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Ls()<<2&4294967295|3&t)>>>0,n=0);return i}var js=En,Ks="2.8.14",Gs="."+Ws(6),$s=0;function zs(e){return 1===e[tr]||9===e[tr]||!+e[tr]}function Js(e,t){return void 0===t&&(t=!1),ao(e+$s+++(t?"."+Ks:gr)+Gs)}function Vs(e){var t={id:Js("_aiData-"+(e||gr)+"."+Ks),accept:function(e){return zs(e)},get:function(e,n,i,r){var o=e[t.id];return o?o[ao(n)]:(r&&((o=function(e,t){var n=t[e.id];if(!n){n={};try{zs(t)&&(function(e,t,n){if(js)try{return js(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[ao(n)]=i),i)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}function Qs(e,t,n){return!(!e||e[Ai]!==t||e===n||!e.match(/^[\da-f]*$/))}function Xs(e){return Qs(e,32,"00000000000000000000000000000000")}function Ys(e){return Qs(e,16,"0000000000000000")}var Zs=Vs("plugin");function ea(e){return Zs.get(e,"state",{},!0)}function ta(e,t){for(var n,i=[],r=null,o=e[Ki]();o;){var s=o[Ui]();s&&(r&&so(r[$i])&&so(s[kr])&&r[$i](s),(so(s[Si])?s[Si]():(n=ea(s))[Si])||i[Ci](s),r=s,o=o[Ki]())}wo(i,(function(i){var r=e[yr]();i[gi](e.getCfg(),r,t,e[Ki]()),n=ea(i),i[yr]||n[yr]||(n[yr]=r),n[Si]=!0,delete n[xi]}))}function na(e){return e.sort((function(e,t){var n=0;if(t){var i=so(t[kr]);so(e[kr])?n=i?e[br]-t[br]:1:i&&(n=-1)}else n=e?1:-1;return n}))}var ia="TelemetryPluginChain",ra="_hasRun",oa="_getTelCtx",sa=0;function aa(e,t,n,i){var r=null,o=[];null!==i&&(r=i?function(e,t,n){for(;e;){if(e[Ui]()===n)return e;e=e[Ki]()}return da([n],t[ki]||{},t)}(e,n,i):e);var s={$:function(){var e=r;if(r=e?e[Ki]():null,!e){var t=o;t&&t[Ai]>0&&(wo(t,(function(e){try{e.func[sr](e.self,e.args)}catch(e){Us(n[Ti],2,73,"Unexpected Exception during onComplete - "+ws(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return Ps(n,t)},getCfg:function(){return t},getExtCfg:a,getConfig:function(e,n,i){void 0===i&&(i=!1);var r,o=a(e,null);return o&&!io(o[n])?r=o[n]:t&&!io(t[n])&&(r=t[n]),io(r)?i:r},hasNext:function(){return!!r},getNext:function(){return r},setNext:function(e){r=e},iterate:function(e){for(var t;t=s.$();){var n=t[Ui]();n&&e(n)}},onComplete:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e&&o[Ci]({func:e,self:no(t)?s.ctx:t,args:n})}}};function a(e,n,i){var r;if(void 0===n&&(n={}),void 0===i&&(i=0),t){var o=t[Sr];o&&e&&(r=o[e])}if(r){if(oo(n)&&0!==i){var s=Do(!0,n,r);t&&2===i&&co(n,(function(e){if(io(s[e])){var n=t[e];io(n)||(s[e]=n)}})),r=s}}else r=n;return r}return s}function ca(e,t,n,i){var r=aa(e,t,n,i),o=r.ctx;return o[Ei]=function(e){var t=r.$();return t&&t[kr](e,o),!t},o[zi]=function(e,i){return void 0===e&&(e=null),ho(e)&&(e=da(e,t,n,i)),ca(e||o[Ki](),t,n,i)},o}function ua(e,t,n){var i=t[ki]||{},r=aa(e,i,t,n),o=r.ctx;return o[Ei]=function(e){var t=r.$();return t&&t.unload(o,e),!t},o[zi]=function(e,n){return void 0===e&&(e=null),ho(e)&&(e=da(e,i,t,n)),ua(e||o[Ki](),t,n)},o}function la(e,t,n){var i=t[ki]||{},r=aa(e,i,t,n).ctx;return r[Ei]=function(e){return r.iterate((function(t){so(t[ji])&&t[ji](r,e)}))},r[zi]=function(e,n){return void 0===e&&(e=null),ho(e)&&(e=da(e,i,t,n)),la(e||r[Ki](),t,n)},r}function da(e,t,n,i){var r=null,o=!i;if(ho(e)&&e[Ai]>0){var s=null;wo(e,(function(e){if(o||i!==e||(o=!0),o&&e&&so(e[kr])){var a=function(e,t,n){var i,r=null,o=so(e[kr]),s=so(e[$i]),a={getPlugin:function(){return e},getNext:function(){return r},processTelemetry:function(i,u){c(u=u||function(){var i;return e&&so(e[oa])&&(i=e[oa]()),i||(i=ca(a,t,n)),i}(),(function(t){if(!e||!o)return!1;var n=ea(e);return!n[xi]&&!n[Cr]&&(s&&e[$i](r),e[kr](i,t),!0)}),"processTelemetry",(function(){return{item:i}}),!i.sync)||u[Ei](i)},unload:function(t,n){c(t,(function(){var i=!1;if(e){var r=ea(e),o=e[yr]||r[yr];!e||o&&o!==t.core()||r[xi]||(r[yr]=null,r[xi]=!0,r[Si]=!1,e[xi]&&!0===e[xi](t,n)&&(i=!0))}return i}),"unload",(function(){}),n[Li])||t[Ei](n)},update:function(t,n){c(t,(function(){var i=!1;if(e){var r=ea(e),o=e[yr]||r[yr];!e||o&&o!==t.core()||r[xi]||e[ji]&&!0===e[ji](t,n)&&(i=!0)}return i}),"update",(function(){}),!1)||t[Ei](n)},ha:i=e?e[_i]+"-"+e[br]+"-"+sa++:"Unknown-0-"+sa++,fa:function(e){r=e}};function c(t,n,o,s,a){var c=!1,u=e?e[_i]:ia,l=t[ra];return l||(l=t[ra]={}),t.setNext(r),e&&jo(t[yr](),(function(){return u+":"+o}),(function(){l[i]=!0;try{var e=r?r.ha:gr;e&&(l[e]=!1),c=n(t)}catch(e){var s=!r||l[r.ha];s&&(c=!0),r&&s||Us(t[Gi](),1,73,"Plugin ["+u+"] failed during "+o+" - "+ws(e)+", run flags: "+ws(l))}}),s,a),c}return Ao(a)}(e,t,n);r||(r=a),s&&s.fa(a),s=a}}))}return i&&!r?da([i],t,n):r}function ha(e,t,n){t&&ho(t)&&t[Ai]>0&&(wo(t=t.sort((function(e,t){return e[br]-t[br]})),(function(e){e[br]<500&&Oo("Channel has invalid priority - "+e[_i])})),e[Ci]({queue:Ao(t),chain:da(t,n[ki],n)}))}var fa="toGMTString",pa="toUTCString",va="cookie",ma="expires",ga="enabled",wa="isCookieUseDisabled",ya="disableCookiesUsage",_a="_ckMgr",Ca=null,Sa=null,ka=null,ba=ls(),Ta={},Aa={};function Ia(e){return!e||e.isEnabled()}function Ea(e,t){return!!(t&&e&&ho(e.ignoreCookies))&&-1!==e.ignoreCookies[Vi](t)}function Ra(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var i=t[Ji];n=i[_a]?i[_a]:Na(t)}return n||(n=function(e,t){var n=Na[_a]||Aa[_a];return n||(n=Na[_a]=Na(e,t),Aa[_a]=n),n}(t,(e||{})[Ti])),n}function Na(e,t){var n,i=function(e){var t=e[Ji]=e[Ji]||{};if(Ro(t,"domain",e.cookieDomain,ro,io),Ro(t,"path",e.cookiePath||"/",null,io),io(t[ga])){var n=void 0;no(e[wa])||(n=!e[wa]),no(e[ya])||(n=!e[ya]),t[ga]=n}return t}(e||Aa),r=i.path||"/",o=i.domain,s=!1!==i[ga],a=((n={isEnabled:function(){var e=s&&Pa(t),n=Aa[_a];return e&&n&&a!==n&&(e=Ia(n)),e}})[Zi]=function(e){s=!1!==e},n.set=function(e,t,n,s,c){var u=!1;if(Ia(a)&&!function(e,t){return!!(t&&e&&ho(e.blockedCookies)&&-1!==e.blockedCookies[Vi](t))||Ea(e,t)}(i,e)){var l={},d=_o(t||gr),h=d[Vi](";");if(-1!==h&&(d=_o(t[Qi](0,h)),l=Ha(t[Qi](h+1))),Ro(l,"domain",s||o,Ho,no),!io(n)){var f=gs();if(no(l[ma])){var p=Io()+1e3*n;if(p>0){var v=new Date;v.setTime(p),Ro(l,ma,Oa(v,f?fa:pa)||Oa(v,f?fa:pa)||gr,Ho)}}f||Ro(l,"max-age",gr+n,null,no)}var m=fs();m&&"https:"===m.protocol&&(Ro(l,"secure",null,null,no),null===Sa&&(Sa=!function(e){return!(!fo(e)||!lo(e,"CPU iPhone OS 12")&&!lo(e,"iPad; CPU OS 12")&&!(lo(e,"Macintosh; Intel Mac OS X 10_14")&&lo(e,"Version/")&&lo(e,"Safari"))&&(!lo(e,"Macintosh; Intel Mac OS X 10_14")||!function(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Gr?e[Or](t):function(e,t){var n=!1,i=t?t[Ai]:0,r=e?e[Ai]:0;if(i&&r&&r>=i&&!(n=e===t)){for(var o=r-1,s=i-1;s>=0;s--){if(e[o]!=t[s])return!1;o--}n=!0}return n}(e,t)),n}(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!lo(e,"Chrome/5")&&!lo(e,"Chrome/6")&&(!lo(e,"UnrealEngine")||lo(e,"Chrome"))&&!lo(e,"UCBrowser/12")&&!lo(e,"UCBrowser/11"))}((hs()||{})[Xi])),Sa&&Ro(l,"SameSite","None",null,no)),Ro(l,"path",c||r,null,no),(i.setCookie||Da)(e,Ua(d,l)),u=!0}return u},n.get=function(e){var t=gr;return Ia(a)&&!Ea(i,e)&&(t=(i.getCookie||Ma)(e)),t},n.del=function(e,t){var n=!1;return Ia(a)&&(n=a.purge(e,t)),n},n.purge=function(e,n){var r,o=!1;if(Pa(t)){var s=((r={}).path=n||"/",r[ma]="Thu, 01 Jan 1970 00:00:01 GMT",r);gs()||(s["max-age"]="0"),(i.delCookie||Da)(e,Ua(gr,s)),o=!0}return o},n);return a[_a]=a,a}function Pa(e){if(null===Ca){Ca=!1;try{Ca=void 0!==(ba||{})[va]}catch(t){Us(e,2,68,"Cannot access document.cookie - "+Eo(t),{exception:ws(t)})}}return Ca}function Ha(e){var t={};return e&&e[Ai]&&wo(_o(e)[Yi](";"),(function(e){if(e=_o(e||gr)){var n=e[Vi]("=");-1===n?t[e]=null:t[_o(e[Qi](0,n))]=_o(e[Qi](n+1))}})),t}function Oa(e,t){return so(e[t])?e[t]():null}function Ua(e,t){var n=e||gr;return co(t,(function(e,t){n+="; "+e+(io(t)?gr:"="+t)})),n}function Ma(e){var t=gr;if(ba){var n=ba[va]||gr;ka!==n&&(Ta=Ha(n),ka=n),t=_o(Ta[e]||gr)}return t}function Da(e,t){ba&&(ba[va]=e+"="+t)}function Fa(){var e=[];return{add:function(t){t&&e[Ci](t)},run:function(t,n){wo(e,(function(e){try{e(t,n)}catch(e){Us(t[Gi](),2,73,"Unexpected error calling unload handler - "+ws(e))}})),e=[]}}}var xa="getPlugin",qa=function(){function e(){var t,n,i,r,o,s=this;function a(e){void 0===e&&(e=null);var t=e;if(!t){var r=n||ca(null,{},s[yr]);t=i&&i[xa]?r[zi](null,i[xa]):r[zi](null,i)}return t}function c(e,t,r){e&&Ro(e,Sr,[],null,io),!r&&t&&(r=t[Ri]()[Ki]());var o=i;i&&i[xa]&&(o=i[xa]()),s[yr]=t,n=ca(r,e,t,o)}function u(){t=!1,s[yr]=null,n=null,i=null,o=[],r=Fa()}u(),mi(e,s,(function(e){e[gi]=function(e,n,i,r){c(e,n,r),t=!0},e[xi]=function(t,n){var s,a=e[yr];if(a&&(!t||a===t[yr]())){var c,l=!1,d=t||ua(null,a,i&&i[xa]?i[xa]():i),h=n||((s={reason:0})[Li]=!1,s);return e[Wi]&&!0===e[Wi](d,h,f)?c=!0:f(),c}function f(){if(!l){l=!0,r.run(d,n);var e=o;o=[],wo(e,(function(e){e.rm()})),!0===c&&d[Ei](h),u()}}},e[ji]=function(t,n){var r=e[yr];if(r&&(!t||r===t[yr]())){var o,s=!1,a=t||la(null,r,i&&i[xa]?i[xa]():i),u=n||{reason:0};return e.pa&&!0===e.pa(a,u,l)?o=!0:l(),o}function l(){s||(s=!0,c(a.getCfg(),a.core(),a[Ki]()))}},e.va=function(e){e&&(ho(e)?o=o.concat(e):o[Ci](e))},Uo(e,"_addUnloadCb",(function(){return r}),"add")})),s[Gi]=function(e){return a(e)[Gi]()},s[Si]=function(){return t},s.setInitialized=function(e){t=e},s[$i]=function(e){i=e},s[Ei]=function(e,t){t?t[Ei](e):i&&so(i[kr])&&i[kr](e,null)},s.ma=a}return e.__ieDyn=1,e}(),Ba=function(e){function t(){var n,i,r=e.call(this)||this;function o(){n=0,i=[]}return r.identifier="TelemetryInitializerPlugin",r.priority=199,o(),mi(t,r,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return i[Ci](t),{remove:function(){wo(i,(function(e,n){if(e.id===t.id)return i[Fi](n,1),-1}))}}},e[kr]=function(t,n){for(var r=!1,o=i[Ai],s=0;s<o;++s){var a=i[s];if(a)try{if(!1===a.fn[nr](null,[t])){r=!0;break}}catch(e){Us(n[Gi](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Eo(e),{exception:ws(e)},!0)}}r||e[Ei](t,n)},e[Wi]=function(){o()}})),r}return Dn(t,e),t.__ieDyn=1,t}(qa),La="Plugins must provide initialize method",Wa="_notificationManager",ja="SDK is still unloading...",Ka={loggingLevelConsole:1};function Ga(e,t){return new Lo(t)}function $a(e,t){var n=!1;return wo(t,(function(t){if(t===e)return n=!0,-1})),n}var za=function(){function e(){var t,n,i,r,o,s,a,c,u,l,d,h,f,p,v,m,g,w,y,_,C=0,S=!1;mi(e,this,(function(e){function k(n){if(!C&&!S&&(n||e[Ti]&&e[Ti].queue[Ai]>0)){var i=Po(t.diagnosticLogInterval);i&&i>0||(i=1e4),C=setInterval((function(){clearInterval(C),C=0,N()}),i)}return C}function b(){n=!1,t=Do(!0,{},Ka),e[ki]=t,e[Ti]=new Hs(t),e[Di]=[],v=new Ba,i=[],r=null,o=null,s=null,a=null,c=null,l=null,u=[],d=null,h=null,f=null,p=!1,m=null,g=Js("AIBaseCore",!0),w=Fa(),_=null}function T(){var n=ca(E(),t,e);return n[Oi](k),n}function A(n){var i=function(e,t,n){var i,r=[],o={};return wo(n,(function(t){(io(t)||io(t[gi]))&&Oo(La);var n=t[br],i=t[_i];t&&n&&(io(o[n])?o[n]=i:Ms(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+i)),(!n||n<500)&&r[Ci](t)})),(i={all:n})[yr]=r,i}(e[Ti],0,u);l=i[yr],c=null;var r=i.all;if(f=Ao(function(e,t,n){var i=[];if(e&&wo(e,(function(e){return ha(i,e,n)})),t){var r=[];wo(t,(function(e){e[br]>500&&r[Ci](e)})),ha(i,r,n)}return i}(h,r,e)),d){var o=yo(r,d);-1!==o&&r[Fi](o,1),-1!==(o=yo(l,d))&&l[Fi](o,1),d.ga(f)}else d=function(e,t){function n(){return ca(null,t[ki],t,null)}function i(e,t,n,i){var r=e?e[Ai]+1:1;function o(){0==--r&&(i&&i(),i=null)}r>0&&wo(e,(function(e){if(e&&e.queue[Ai]>0){var i=e.chain,s=t[zi](i);s[Oi](o),n(s)}else r--})),o()}var r=!1,o={identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,n,i,o){r=!0,wo(e,(function(e){e&&e.queue[Ai]>0&&ta(ca(e.chain,t,n),i)}))},isInitialized:function(){return r},processTelemetry:function(t,r){i(e,r||n(),(function(e){e[Ei](t)}),(function(){r[Ei](t)}))},update:function(t,n){var r=n||{reason:0};return i(e,t,(function(e){e[Ei](r)}),(function(){t[Ei](r)})),!0},pause:function(){i(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){i(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return i(e,t,(function(e){e[Ei](o)}),(function(){t[Ei](o),r=!1})),!0},getChannel:function(t){var n=null;return e&&e[Ai]>0&&wo(e,(function(e){if(e&&e.queue[Ai]>0&&(wo(e.queue,(function(e){if(e[_i]===t)return n=e,-1})),n))return-1})),n},flush:function(t,r,o,s){var a=1,c=!1,u=null;function l(){a--,c&&0===a&&(u&&(clearTimeout(u),u=null),r&&r(c),r=null)}return s=s||5e3,i(e,n(),(function(e){e.iterate((function(e){if(e[Mi]){a++;var n=!1;e[Mi](t,(function(){n=!0,l()}),o)||n||(t&&null==u?u=setTimeout((function(){u=null,l()}),s):l())}}))}),(function(){c=!0,l()})),!0},ga:function(t){e=t}};return o}(f,e);r[Ci](d),l[Ci](d),e[Di]=na(r),d[gi](t,e,r),ta(T(),r),e[Di]=Ao(na(l||[])).slice(),n&&function(t){var n=la(E(),e);n[Oi](k),e.wa&&!0===e.wa(n,t)||n[Ei](t)}(n)}function I(t){var n,i=null,r=null;return wo(e[Di],(function(e){if(e[_i]===t&&e!==d&&e!==v)return r=e,-1})),!r&&d&&(r=d.getChannel(t)),r&&((n={plugin:r})[Zi]=function(e){ea(r)[Cr]=!e},n.isEnabled=function(){var e=ea(r);return!e[xi]&&!e[Cr]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var i=[r],o=((n={reason:1})[Li]=e,n);R(i,o,(function(e){e&&A({reason:32,removed:i}),t&&t(e)}))},i=n),i}function E(){if(!c){var n=(l||[]).slice();-1===yo(n,v)&&n[Ci](v),c=da(na(n),t,e)}return c}function R(n,i,r){if(n&&n[Ai]>0){var o=ua(da(n,t,e),e);o[Oi]((function(){var e=!1,t=[];wo(u,(function(i,r){$a(i,n)?e=!0:t[Ci](i)})),u=t;var i=[];h&&(wo(h,(function(t,r){var o=[];wo(t,(function(t){$a(t,n)?e=!0:o[Ci](t)})),i[Ci](o)})),h=i),r&&r(e),k()})),o[Ei](i)}else r(!1)}function N(){if(e[Ti]&&e[Ti].queue){var n=e[Ti].queue.slice(0);e[Ti].queue[Ai]=0,wo(n,(function(n){var i,r=((i={})[wi]=m||"InternalMessageId: "+n[qi],i.iKey=Po(t[bi]),i.time=go(new Date),i.baseType=Ns.dataType,i.baseData={message:n[Bi]},i);e.track(r)}))}}function P(e,t,n,i){return d?d[Mi](e,t,n||6,i):(t&&t(!1),!0)}function H(t){var n=e[Ti];n?(Us(n,2,73,t),k()):Oo(t)}var O,U,M;b(),e[Si]=function(){return n},e[gi]=function(i,o,a,c){var l,d;p&&Oo(ja),e[Si]()&&Oo("Core should not be initialized more than once"),t=i||{},e[ki]=t,io(i[bi])&&Oo("Please provide instrumentation key"),r=c,e[Wa]=c,!0===(d=Po(t.disableDbgExt))&&y&&(r[Pi](y),y=null),r&&!y&&!0!==d&&(y=Is(t),r[Ni](y)),!(l=Po(t.enablePerfMgr))&&s&&(s=null),l&&No(t,_r,Ga),No(t,Sr,{}).NotificationManager=r,a&&(e[Ti]=a);var v=No(t,"extensions",[]);(u=[])[Ci].apply(u,Fn(Fn([],o),v)),h=No(t,wr,[]),A(null),f&&0!==f[Ai]||Oo("No "+wr+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return f&&wo(f,(function(t){e[Ci](t.queue)})),Ao(e)},e.track=function(n){n.iKey=n.iKey||t[bi],n[Ii]=n[Ii]||go(new Date),n.ver=n.ver||"4.0",!p&&e[Si]()?T()[Ei](n):i[Ci](n)},e[Ri]=T,e[yi]=function(){return r||(r=function(){var e;return On(((e={})[Ni]=function(e){},e[Pi]=function(e){},e[Tr]=function(e){},e[Ar]=function(e,t){},e[Ir]=function(e,t){},e))}(),e[Wa]=r),r},e[Ni]=function(e){r&&r[Ni](e)},e[Pi]=function(e){r&&r[Pi](e)},e.getCookieMgr=function(){return a||(a=Na(t,e[Ti])),a},e.setCookieMgr=function(e){a=e},e[Pr]=function(){if(!o&&!s&&Po(t.enablePerfMgr)){var n=Po(t[_r]);so(n)&&(s=n(e,e[yi]()))}return o||s||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return i[Ai]},e.releaseQueue=function(){if(n&&i[Ai]>0){var e=i;i=[],wo(e,(function(e){T()[Ei](e)}))}},e.pollInternalLogs=function(e){return m=e||null,S=!1,C&&(clearInterval(C),C=null),k(!0)},e[Hi]=function(){S=!0,C&&(clearInterval(C),C=0,N())},U=function(){return v},M=["addTelemetryInitializer"],(O=e)&&U&&oo(O)&&ho(M)&&wo(M,(function(e){fo(e)&&Uo(O,e,U,e,undefined)})),e.unload=function(t,i,r){var o;void 0===t&&(t=!0),n||Oo("SDK is not initialized"),p&&Oo(ja);var s=((o={reason:50})[Li]=t,o.flushComplete=!1,o),a=ua(E(),e);function c(t){s.flushComplete=t,p=!0,w.run(a,s),e[Hi](),a[Ei](s)}a[Oi]((function(){b(),i&&i(s)}),e),N(),P(t,c,6,r)||c(!1)},e[Ui]=I,e.addPlugin=function(e,t,n,i){if(!e)return i&&i(!1),void H(La);var r=I(e[_i]);if(r&&!t)return i&&i(!1),void H("Plugin ["+e[_i]+"] is already loaded!");var o={reason:16};function s(t){u[Ci](e),o.added=[e],A(o),i&&i(!0)}if(r){var a=[r.plugin];R(a,{reason:2,isAsync:!!n},(function(e){e?(o.removed=a,o.reason|=32,s()):i&&i(!1)}))}else s()},e.evtNamespace=function(){return g},e[Mi]=P,e.getTraceCtx=function(e){var t;return _||(t={},_={getName:function(){return t[wi]},setName:function(e){t[wi]=e},getTraceId:function(){return t[pr]},setTraceId:function(e){Xs(e)&&(t[pr]=e)},getSpanId:function(){return t[vr]},setSpanId:function(e){Ys(e)&&(t[vr]=e)},getTraceFlags:function(){return t[mr]},setTraceFlags:function(e){t[mr]=e}}),_},e.setTraceCtx=function(e){_=e||null},Uo(e,"addUnloadCb",(function(){return w}),"add")}))}return e.__ieDyn=1,e}();function Ja(e,t,n,i){wo(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return i(e)}),0);else try{i(e)}catch(e){}}))}var Va,Qa=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;mi(e,this,(function(e){e[Ni]=function(t){e.listeners[Ci](t)},e[Pi]=function(t){for(var n=yo(e[ur],t);n>-1;)e.listeners[Fi](n,1),n=yo(e[ur],t)},e[Tr]=function(t){Ja(e[ur],Tr,!0,(function(e){e[Tr](t)}))},e[Ar]=function(t,n){Ja(e[ur],Ar,!0,(function(e){e[Ar](t,n)}))},e[Ir]=function(t,n){Ja(e[ur],Ir,n,(function(e){e[Ir](t,n)}))},e[Er]=function(t){t&&(!n&&t[lr]()||Ja(e[ur],Er,!1,(function(e){t[Li]?setTimeout((function(){return e[Er](t)}),0):e[Er](t)})))}}))}return e.__ieDyn=1,e}(),Xa=function(e){function t(){var n=e.call(this)||this;return mi(t,n,(function(e,t){function n(t){var n=e[yi]();n&&n[Ar]([t],2)}e[gi]=function(e,n,i,r){t[gi](e,n,i||new Hs(e),r||new Qa(e))},e.track=function(i){jo(e[Pr](),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),Oo("Invalid telemetry item")),function(e){io(e[wi])&&(n(e),Oo("telemetry name required"))}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)}})),n}return Dn(t,e),t.__ieDyn=1,t}(za),Ya="",Za="version",ec="properties",tc="on",nc="attachEvent",ic="addEventListener",rc="detachEvent",oc="removeEventListener",sc="events",ac="visibilitychange",cc="pagehide",uc="pageshow",lc="unload",dc="beforeunload",hc=Js("aiEvtPageHide"),fc=Js("aiEvtPageShow"),pc=/\.[\.]+/g,vc=/[\.]+$/,mc=1,gc=Vs("events"),wc=/^([^.]*)(?:\.(.+)|)/;function yc(e){return e&&e[ir]?e[ir](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,gr):e}function _c(e,t){var n;if(t){var i=gr;ho(t)?(i=gr,wo(t,(function(e){(e=yc(e))&&("."!==e[0]&&(e="."+e),i+=e)}))):i=yc(t),i&&("."!==i[0]&&(i="."+i),e=(e||gr)+i)}var r=wc.exec(e||gr)||[];return(n={})[ar]=r[1],n.ns=(r[2]||gr).replace(pc,".").replace(vc,gr)[Yi](".").sort().join("."),n}function Cc(e,t,n){void 0===n&&(n=!0);var i=gc.get(e,sc,{},n),r=i[t];return r||(r=i[t]=[]),r}function Sc(e,t,n,i){e&&t&&t[ar]&&(e[oc]?e[oc](t[ar],n,i):e[rc]&&e[rc](tc+t[ar],n))}function kc(e,t,n,i){for(var r=t[Ai];r--;){var o=t[r];o&&(n.ns&&n.ns!==o.evtName.ns||i&&!i(o)||(Sc(e,o.evtName,o[cr],o.capture),t[Fi](r,1)))}}function bc(e,t){return t?_c("xx",ho(t)?[e].concat(t):[e,t]).ns[Yi]("."):e}function Tc(e,t,n,i,r){var o;void 0===r&&(r=!1);var s=!1;if(e)try{var a=_c(t,i);if(s=function(e,t,n,i){var r=!1;return e&&t&&t[ar]&&n&&(e[ic]?(e[ic](t[ar],n,i),r=!0):e[nc]&&(e[nc](tc+t[ar],n),r=!0)),r}(e,a,n,r),s&&gc.accept(e)){var c=((o={guid:mc++,evtName:a})[cr]=n,o.capture=r,o);Cc(e,a.type)[Ci](c)}}catch(e){}return s}function Ac(e,t,n,i,r){if(void 0===r&&(r=!1),e)try{var o=_c(t,i),s=!1;!function(e,t,n){if(t[ar])kc(e,Cc(e,t[ar]),t,n);else{var i=gc.get(e,sc,{});co(i,(function(i,r){kc(e,r,t,n)})),0===ko(i)[Ai]&&gc.kill(e,sc)}}(e,o,(function(e){return!((!o.ns||n)&&e[cr]!==n||(s=!0,0))})),s||Sc(e,o,n,r)}catch(e){}}function Ic(e,t,n,i){var r=!1;return t&&e&&e[Ai]>0&&wo(e,(function(e){e&&(n&&-1!==yo(n,e)||(r=function(e,t,n){var i=!1,r=cs();r&&(i=Tc(r,e,t,n),i=Tc(r.body,e,t,n)||i);var o=ls();return o&&(i=Tc(o,e,t,n)||i),i}(e,t,i)||r))})),r}function Ec(e,t,n){e&&ho(e)&&wo(e,(function(e){e&&function(e,t,n){var i=cs();i&&(Ac(i,e,t,n),Ac(i.body,e,t,n));var r=ls();r&&Ac(r,e,t,n)}(e,t,n)}))}function Rc(e,t,n){var i=bc(hc,n),r=Ic([cc],e,t,i);return t&&-1!==yo(t,ac)||(r=Ic([ac],(function(t){var n=ls();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,i)||r),!r&&t&&(r=Rc(e,null,n)),r}function Nc(e,t,n){var i=bc(fc,n),r=Ic([uc],e,t,i);return!(r=Ic([ac],(function(t){var n=ls();e&&n&&"visible"===n.visibilityState&&e(t)}),t,i)||r)&&t&&(r=Nc(e,null,n)),r}function Pc(){var e=Hc();return e[Qi](0,8)+"-"+e[Qi](8,12)+"-"+e[Qi](12,16)+"-"+e[Qi](16,20)+"-"+e[Qi](20)}function Hc(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=gr,i=0;i<4;i++)n+=t[15&(e=Ls())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var r=t[8+(3&Ls())|0];return n[er](0,8)+n[er](9,4)+"4"+n[er](13,3)+r+n[er](16,3)+n[er](19,12)}var Oc="1DS-Web-JS-3.2.12",Uc="withCredentials",Mc=((Va={})[0]=0,Va[2]=6,Va[1]=1,Va[3]=7,Va[4098]=6,Va[4097]=1,Va[4099]=7,Va);function Dc(e){return!(e===Ya||io(e))}function Fc(e,t,n){var i=-1;if(!no(e))if(t>0&&(32===t?i=8192:t<=13&&(i=t<<5)),function(e){return e>=0&&e<=9}(n))-1===i&&(i=0),i|=n;else{var r=Mc[jc(e)]||-1;-1!==i&&-1!==r?i|=r:6===r&&(i=r)}return i}function xc(e,t,n){var i;return void 0===n&&(n=!0),e&&(i=e.get(t),n&&i&&decodeURIComponent&&(i=decodeURIComponent(i))),i||Ya}function qc(e){void 0===e&&(e="D");var t=Pc();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,Ya)),t}function Bc(e,t,n,i,r){var o={},s=!1,a=0,c=arguments.length,u=arguments;for("[object Boolean]"===Object[Sn].toString.call(u[0])&&(s=u[0],a++);a<c;a++)co(u[a],(function(e,t){s&&t&&oo(t)?ho(t)?(o[e]=o[e]||[],wo(t,(function(t,n){t&&oo(t)?o[e][n]=Bc(!0,o[e][n],t):o[e][n]=t}))):o[e]=Bc(!0,o[e],t):o[e]=t}));return o}Boolean(ls()),Boolean(cs());var Lc=function(){var e=ss("performance");return e&&e.now?e.now():Io()};function Wc(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Lc()}function jc(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===_n&&(t=4,ho(e)?(t=4096,e.length>0&&(t|=jc(e[0]))):Rn.call(e,"value")&&(t=8192|jc(e.value)))}return t}var Kc=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],mi(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new Hs({loggingLevelConsole:1})),e.initialize=function(n,i,r,o){jo(e,(function(){return"AppInsightsCore.initialize"}),(function(){var s=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;!a||a.getProperty&&a.setProperty||Oo("Invalid property storage override passed."),n.channels&&wo(n.channels,(function(e){e&&wo(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;s.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},i&&wo(i,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;s.push(t)}})),e.pluginVersionString=s.join(";"),e.pluginVersionStringArr=s;try{t.initialize(n,i,r,o),e.pollInternalLogs("InternalLog")}catch(t){var c=e.logger,u=ws(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),Us(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:i,logger:r,notificationManager:o}}))},e.track=function(n){jo(e,(function(){return"AppInsightsCore.track"}),(function(){var i,r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=Lc(),(i=r.latency)&&po(i)&&i>=1&&i<=4||(r.latency=1);var o=r.ext=r.ext||{};o.sdk=o.sdk||{},o.sdk.ver=Oc;var s=r.baseData=r.baseData||{};s[ec]=s[ec]||{};var a=s[ec];a[Za]=a[Za]||e.pluginVersionString||Ya}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Dn(t,e),t.__ieDyn=1,t}(Xa);const Gc=Kc;function $c(e){var t={};return co(e,(function(e,n){t[e]=n[1],t[n[0]]=n[1]})),To(t)}var zc,Jc="locale",Vc="ver",Qc="name",Xc=$c({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),Yc=$c({id:[0,"id"],ver:[1,Vc],appName:[2,Qc],locale:[3,Jc],expId:[4,"expId"],env:[5,"env"]}),Zc=$c({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),eu=$c({locale:[0,Jc],localId:[1,"localId"],id:[2,"id"]}),tu=$c({osName:[0,Qc],ver:[1,Vc]}),nu=$c({ver:[0,Vc],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),iu=$c({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),ru=$c({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),ou=$c({tz:[0,"tz"]}),su=$c({sessionId:[0,"sesId"]}),au=$c({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),cu=$c({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),uu=$c({traceId:[0,"traceID"],traceName:[1,Qc],parentId:[2,"parentID"]}),lu=$c({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]});function du(){return void 0===zc&&(zc=!!fu(0)),zc}function hu(){return du()?fu(0):null}function fu(e){var t,n,i=null;try{var r=Pn();if(!r)return null;n=new Date,(i=0===e?r.localStorage:r.sessionStorage)&&so(i.setItem)&&(i.setItem(n,n),t=i.getItem(n)!==n,i.removeItem(n),t&&(i=null))}catch(e){i=null}return i}function pu(){return this.getId()}function vu(e){this.setId(e)}var mu=function(){function e(){mi(e,this,(function(e){e.setId=function(t){e.customId=t},e.getId=function(){return fo(e.customId)?e.customId:e.automaticId}}))}return e.ya=void bo(e.prototype,"id",pu,vu),e}(),gu="ai_session",wu=function(){function e(t,n){var i,r,o=Ps(t),s=Ra(t);mi(e,this,(function(t){var a,c={sessionRenewalMs:(a=n).sessionRenewalMs&&function(){return a.sessionRenewalMs},sessionExpirationMs:a.sessionExpirationMs&&function(){return a.sessionExpirationMs},cookieDomain:a.cookieDomain&&function(){return a.cookieDomain},namePrefix:a.namePrefix&&function(){return a.namePrefix},sessionAsGuid:function(){return a.sessionAsGuid},idLength:function(){return a.idLength?a.idLength:22}};function u(e){var n=t.automaticSession,i=e.split("|");i.length>0&&n.setId(i[0]);try{if(i.length>1){var r=+i[1];n.acquisitionDate=+new Date(r),n.acquisitionDate=n.acquisitionDate>0?n.acquisitionDate:0}if(i.length>2){var s=+i[2];n.renewalDate=+new Date(s),n.renewalDate=n.renewalDate>0?n.renewalDate:0}}catch(e){Us(o,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===n.renewalDate&&Us(o,2,517,"AI session renewal date is 0, session will be reset.")}function l(){var e=t.automaticSession,n=(new Date).getTime(),i=t.config.sessionAsGuid();!no(i)&&i?vo(i)?e.setId(qc()):e.setId(qc(i)):e.setId(Ws(c&&c.idLength?c.idLength():22)),e.acquisitionDate=n,e.renewalDate=n,d(e.getId(),e.acquisitionDate,e.renewalDate),du()||Us(o,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function d(e,n,o){var a=n+t.config.sessionExpirationMs(),c=o+t.config.sessionRenewalMs(),u=new Date,l=[e,n,o];a<c?u.setTime(a):u.setTime(c);var d=t.config.cookieDomain?t.config.cookieDomain():null;s.set(r(),l.join("|")+";expires="+u.toUTCString(),null,d),i=(new Date).getTime()}so(n.sessionExpirationMs)||(c.sessionExpirationMs=function(){return e.acquisitionSpan}),so(n.sessionRenewalMs)||(c.sessionRenewalMs=function(){return e.renewalSpan}),t.config=c,r=function(){return t.config.namePrefix&&t.config.namePrefix()?gu+t.config.namePrefix():gu},t.automaticSession=new mu,t.update=function(){t.automaticSession.getId()||function(){var e=s.get(r());if(e&&so(e.split))u(e);else{var n=function(e,t){var n=hu();if(null!==n)try{return n.getItem(t)}catch(t){zc=!1,Us(e,1,503,"Browser failed read of local storage. "+t)}return null}(o,r());n&&u(n)}t.automaticSession.getId()||l()}();var n=t.automaticSession,a=t.config,c=(new Date).getTime(),h=c-n.acquisitionDate>a.sessionExpirationMs(),f=c-n.renewalDate>a.sessionRenewalMs();h||f?l():(!i||c-i>e.cookieUpdateInterval)&&(n.renewalDate=c,d(n.getId(),n.acquisitionDate,n.renewalDate))},t.backup=function(){var e=t.automaticSession;!function(e,t,n){!function(e,t,n){var i=hu();if(null!==i)try{return i.setItem(t,n),!0}catch(t){zc=!1,Us(e,1,504,"Browser failed write to local storage. "+t)}}(o,r(),[e,t,n].join("|"))}(e.getId(),e.acquisitionDate,e.renewalDate)}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),yu=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function _u(e,t){void 0===t&&(t=yu);var n=null;if(e)for(var i=e.split(","),r=0;r<i.length;r++)Cu(i[r],t)&&(n?n+=","+i[r]:n=i[r]);return n}function Cu(e,t){if(void 0===t&&(t=yu),!e||e.length<4)return!1;for(var n=!1,i=e.substring(0,3).toString().toUpperCase(),r=0;r<t.length;r++)if(t[r]+":"===i&&e.length<=256){n=!0;break}return n}function Su(){return this.getExpId()}var ku=function(){function e(t,n){var i=null,r=yu.slice(0),o=Ra(n),s=t;mi(e,this,(function(e){if(us()){var n=ls().documentElement;n&&(e.locale=n.lang)}function a(e){e!==i&&(i=_u(e,r))}e.env=t.env?t.env:function(e){var t,n={},i=ls();if(i){t=i&&i.querySelectorAll("meta");for(var r=0;r<t.length;r++){var o=t[r];o.name&&0===o.name.toLowerCase().indexOf(e)&&(n[o.name.replace(e,"")]=o.content)}}return n}("awa-").env,e.getExpId=function(){return s.expId?(a(s.expId),i):(a(xc(o,"Treatments")),i)}}))}return e.validateAppExpId=_u,e.ya=void bo(e.prototype,"expId",Su),e}(),bu=function(){},Tu=function(){};function Au(){return this.getMsfpc()}function Iu(){return this.getAnid()}var Eu=function(){function e(t,n){var i=Ra(n);mi(e,this,(function(e){t.serviceName&&(e.serviceName=t.serviceName),e.getMsfpc=function(){return xc(i,"MSFPC")},e.getAnid=function(){return xc(i,"ANON").slice(0,34)}}))}var t;return e.ya=(bo(t=e.prototype,"msfpc",Au),void bo(t,"anid",Iu)),e}(),Ru=function(){var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,i="+";n>0&&(i="-"),n=Math.abs(n),t=Math.abs(t),this.tz=i+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString())},Nu={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},Pu={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Hu="([\\d,_,.]+)",Ou="Unknown",Uu=[{r:Nu.WINPHONE,os:"Windows Phone"},{r:Nu.WINRT,os:"Windows RT"},{r:Nu.WIN,os:"Windows"},{r:Nu.IOS,os:"iOS"},{r:Nu.ANDROID,os:"Android"},{r:Nu.LINUX,os:"Linux"},{r:Nu.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Nu.OSX,os:"Mac OS X"}];function Mu(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?Pu[n[1]]?Pu[n[1]]:n[1]:Ou}function Du(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var Fu=function(e){if(e.populateOperatingSystemInfo){var t=this,n=hs()||{},i=e.userAgent||n.userAgent||"",r=e.userAgentData||n.userAgentData||{};if(i){var o=function(e){for(var t=0;t<Uu.length;t++){var n=Uu[t];if(n.r&&e.match(n.r))return n.os;if(n.s&&-1!==e.indexOf(n.s))return n.os}return Ou}(i.toLowerCase());t.name=o,t.ver=function(e,t){return"Windows"===t?Mu(e,"Windows NT"):"Android"===t?Mu(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X "+Hu));if(t){var n=t[1].replace(/_/g,".");if(n){var i=Du(n);return i?n.split(i)[0]:n}}return Ou}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS "+Hu));if(t){var n=t[1].replace(/_/g,".");if(n){var i=Du(n);return i?n.split(i)[0]:n}}return Ou}(e):Ou}(i,o)}t.name&&t.name!==Ou||!fo(r.platform)||(t.name=r.platform)}},xu="MicrosoftApplicationsTelemetryDeviceId",qu=function(){function e(t,n){var i=0;mi(e,this,(function(e){var r=t.propertyStorageOverride;e.seq=i,e.epoch=Ls(!1).toString();var o=Ra(n,t);if(o.isEnabled()||r){var s=function(e,t,n){return t?t.getProperty(n)||"":xc(e,n)}(o,r,xu);s||(s=Pc()),function(e,t,n,i){t?t.setProperty(n,i):e.set(n,i,31536e3)}(o,r,xu,s),e.installId=s}else o.purge(xu);e.getSequenceId=function(){return++i}}))}return e.__ieDyn=1,e}(),Bu=function(e,t,n,i){var r=this;if(r.traceId=t||Hc(),e.enableDistributedTracing&&!n&&(n=Hc().substring(0,16)),r.parentId=n,e.enableApplicationInsightsTrace){r.name=i;var o=fs();o&&o.pathname&&(r.name=o.pathname)}},Lu="setLocalId";function Wu(){return this.getLocalId()}function ju(e){this[Lu](e)}var Ku=function(){function e(t,n,i){var r,o=n,s=Ra(i,t);mi(e,this,(function(n){if(s&&s.isEnabled()&&(h(),o.enableApplicationInsightsUser)){var i=xc(s,e.userCookieName);if(i){var a=i.split(e.cookieSeparator);a.length>0&&(n.id=a[0])}if(!n.id){n.id=Ws(t&&!no(t.idLength)?t.idLength:22);var c=go(new Date);n.accountAcquisitionDate=c;var u=[n.id,c],l=o.cookieDomain?o.cookieDomain:void 0;s.set(e.userCookieName,u.join(e.cookieSeparator),31536e3,l)}}if("undefined"!=typeof navigator){var d=navigator;n.locale=d.userLanguage||d.language}function h(){if(!o.hashIdentifiers&&!o.dropIdentifiers){var e=xc(s,"MUID");e&&(r="t:"+e)}return r}n.getLocalId=function(){return r||h()},n[Lu]=function(e){r=e}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e.ya=void bo(e.prototype,"localId",Wu,ju),e}(),Gu=function(e){var t=this;t.popSample=100,t.eventFlags=0,e.hashIdentifiers&&(t.eventFlags=1048576|t.eventFlags),e.dropIdentifiers&&(t.eventFlags=2097152|t.eventFlags),e.scrubIpOnly&&(t.eventFlags=4194304|t.eventFlags)},$u=["Required","Analytics","SocialMedia","Advertising"],zu="([\\d,.]+)",Ju="Unknown",Vu="Edg/",Qu=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:Vu,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],Xu=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function Yu(e,t){return t.indexOf(e)>-1}function Zu(e,t){for(var n=0;n<t.length;n++)if(e==t[n].brand)return t[n].version;return null}function el(){return this.getUserConsent()}var tl=function(){function e(t,n){var i=Ra(n),r=t||{};mi(e,this,(function(e){var t=fs();if(t){var n=t.hostname;n&&(e.domain="file:"===t.protocol?"local":n)}if(r.populateBrowserInfo){var o=r.userAgent,s=(r.userAgentData||{}).brands,a=hs();a&&(o=o||a.userAgent||"",s=s||(a.userAgentData||{}).brands),function(t,n){if(ho(n))try{for(var i=0;i<Xu.length;i++){var r=Zu(Xu[i].br,n);if(r)return e.browser=Xu[i].b,void(e.browserVer=r)}}catch(e){}if(t){var o=function(e){if(e)for(var t=0;t<Qu.length;t++)if(Yu(Qu[t].ua,e))return Qu[t].b;return Ju}(t);e.browser=o,e.browserVer=function(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE "+zu));if(t)return t[1];var n=e.match(new RegExp("rv:"+zu));return n?n[1]:void 0}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&Yu(Vu,t)&&(e="Edg");var n=t.match(new RegExp(e+"/"+zu));return n||"Opera"===e&&(n=t.match(new RegExp("OPR/"+zu)))?n[1]:Ju}(t,e)}(t,o)}}(o,s);var c=function(){var e={h:0,w:0},t=cs();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=c.w+"X"+c.h}no(r.gpcDataSharingOptIn)?e.gpcDataSharingOptIn=null:e.gpcDataSharingOptIn=r.gpcDataSharingOptIn,e.getUserConsent=function(){return r.userConsented||!!xc(i,r.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){var t=null;try{var n=r.callback;if(n&&n.userConsentDetails){var i=n.userConsentDetails();if(i){t=r.disableConsentDetailsSanitize?i:{};for(var o=0;o<$u.length;o++){var s=$u[o];t[s]=i[s]||!1}}}var a=e.gpcDataSharingOptIn;return null!==a&&((t=t||{}).GPC_DataSharingOptIn=!!a),t?JSON.stringify(t):null}catch(e){}},bo(e,"userConsent",e.getUserConsent)}))}return e.ya=void bo(e.prototype,"userConsent",el),e}();function nl(e,t,n,i,r){var o=t.ext[Xc[e]];return o&&co(i,(function(e,t){if(fo(t)||po(t)||vo(t)){var i=o[n[e]];!r&&(i||fo(i)||po(i)||vo(i))&&(t=i),o[n[e]]=t}})),o}var il=function(){function e(t,n,i){mi(e,this,(function(e){e.app=new ku(n,i),e.cloud=new bu,e.user=new Ku(t,n,i),e.os=new Fu(n),e.web=new tl(n,i);var r=new qu(t,i),o=new Eu(n,i),s=new Gu(n);e.loc=new Ru,e.device=new Tu;var a=new wu(i,n);e.session=new mu;var c,u,l,d=(c=new Bu(n),u=p(),l=c||{},{getName:function(){return l.name},setName:function(e){u&&u.setName(e),l.name=e},getTraceId:function(){return l.traceId},setTraceId:function(e){u&&u.setTraceId(e),Xs(e)&&(l.traceId=e)},getSpanId:function(){return l.parentId},setSpanId:function(e){u&&u.setSpanId(e),Ys(e)&&(l.parentId=e)},getTraceFlags:function(){return l.traceFlags},setTraceFlags:function(e){u&&u.setTraceFlags(e),l.traceFlags=e}}),h=!(n||{}).eventContainExtFields;function f(){var t=e.session;if(t&&fo(t.customId))return t.customId;a.update();var n=a.automaticSession;if(n){var i=n.getId();i&&fo(i)&&(t.automaticId=i)}return t.automaticId}function p(){var e=d;return i&&i.getTraceCtx&&(e=i.getTraceCtx(!1)||d),e}e.getTraceCtx=function(){return d},e.getSessionId=f,e.applyApplicationContext=function(t){var n,i=e.app;nl(4,t,Yc,((n={})[0]=i.id,n[1]=i.ver,n[2]=i.name,n[3]=i.locale,n[4]=i.getExpId(),n[5]=i.env,n),h)},e.applyUserContext=function(t){var n,i=e.user;nl(0,t,eu,((n={})[1]=i.getLocalId(),n[0]=i.locale,n[2]=i.id,n),h)},e.applyWebContext=function(t){var n,i=e.web;nl(3,t,Zc,((n={})[0]=i.domain,n[1]=i.browser,n[2]=i.browserVer,n[3]=i.screenRes,n[5]=i.getUserConsentDetails(),n[4]=i.getUserConsent(),n),h)},e.applyOsContext=function(t){var n,i=e.os;nl(5,t,tu,((n={})[0]=i.name,n[1]=i.ver,n),h)},e.applySdkContext=function(e){var t;nl(6,e,nu,((t={})[2]=r.installId,t[1]=r.getSequenceId(),t[3]=r.epoch,t),h)},e.applyIntWebContext=function(e){var t;nl(7,e,iu,((t={})[0]=o.getMsfpc(),t[1]=o.getAnid(),t[2]=o.serviceName,t),h)},e.applyUtcContext=function(e){var t,n=((t={})[0]=s.popSample,t);s.eventFlags>0&&(n[1]=s.eventFlags),nl(8,e,ru,n,h)},e.applyLocContext=function(t){var n;nl(9,t,ou,((n={})[0]=e.loc.tz,n),h)},e.applySessionContext=function(e){var t;nl(4,e,su,((t={})[0]=f(),t),h)},e.applyDeviceContext=function(t){var n,i=e.device;nl(1,t,au,((n={})[0]=i.localId,n[2]=i.make,n[3]=i.model,n[1]=i.deviceClass,n),h)},e.applyCloudContext=function(t){var n,i=e.cloud;nl(10,t,cu,((n={})[0]=i.role,n[1]=i.roleInstance,n[2]=i.roleVer,n),h)},e.applyAITraceContext=function(e){var t;if(n.enableApplicationInsightsTrace){var i=p();i&&nl(2,e,uu,((t={})[0]=i.getTraceId(),t[1]=i.getName(),t[2]=i.getSpanId(),t),!1)}},e.applyDistributedTraceContext=function(e){var t,n=p();if(n){var i=((t={})[0]=n.getTraceId(),t[1]=n.getSpanId(),t),r=n.getTraceFlags();io(r)||(i[2]=r),nl(11,e,lu,i,!1)}}}))}return e.__ieDyn=1,e}(),rl=[Xc[4],Xc[0],Xc[3],Xc[5],Xc[6],Xc[7],Xc[8],Xc[9],Xc[1],Xc[2],Xc[11],Xc[10]];const ol=function(e){function t(){var n,i,r,o=e.call(this)||this;return o.identifier="SystemPropertiesCollector",o.priority=3,o.version="3.2.12",mi(t,o,(function(e,t){function o(){n=null,i={}}o(),e.initialize=function(i,o,s){t.initialize(i,o,s),r=e.ma().getExtCfg(e.identifier),n=new il(i,r,o),o&&o.setTraceCtx&&o.setTraceCtx(n.getTraceCtx())},e.processTelemetry=function(t,o){Wc(t,e.identifier),o=e.ma(o);var s,a,c=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},wo(rl,(function(e){c[e]=c[e]||{}})),n&&(n.applyApplicationContext(t),n.applyUserContext(t),n.applyWebContext(t),n.applyOsContext(t),n.applySdkContext(t),n.applyIntWebContext(t),n.applyUtcContext(t),n.applyLocContext(t),n.applySessionContext(t),n.applyDeviceContext(t),r.enableApplicationInsightsTrace&&n.applyAITraceContext(t),r.enableDistributedTracing&&n.applyDistributedTraceContext(t),n.applyCloudContext(t)),wo(ko(c),(function(e){0===ko(c[e]).length&&delete c[e]})),s=i,a=t.data,s&&co(s,(function(e,t){a[e]||(a[e]=t)})),e.processNext(t,o)},e.getPropertiesContext=function(){return n},e.setProperty=function(e,t){i[e]=t},e._a=function(e,t){var i=(e||{}).core();if(i&&i.getTraceCtx&&n){var r=i.getTraceCtx(!1);r&&r===n.getTraceCtx()&&i.setTraceCtx(null)}o()}})),o}return Dn(t,e),t.__ieDyn=1,t}(qa);var sl,al=(sl={},co({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){sl[e]=t,sl[t]=e})),To(sl)),cl="REAL_TIME",ul="",ll="POST",dl="drop",hl="requeue",fl="application/x-json-stream",pl="cache-control",vl="content-type",ml="kill-duration",gl="time-delta-millis",wl="client-version",yl="client-id",_l="time-delta-to-apply-millis",Cl="upload-time",Sl="apikey",kl="AuthMsaDeviceTicket",bl="AuthXToken",Tl="msfpc",Al="trace",Il="user";function El(e){var t=(e.ext||{}).intweb;return t&&Dc(t[Tl])?t[Tl]:null}function Rl(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=El(e[n]);return t}var Nl=function(){function e(t,n){var i=n?[].concat(n):[],r=this,o=Rl(i);r.iKey=function(){return t},r.Msfpc=function(){return o||ul},r.count=function(){return i.length},r.events=function(){return i},r.addEvent=function(e){return!!e&&(i.push(e),o||(o=El(e)),!0)},r.split=function(n,r){var s;if(n<i.length){var a=i.length-n;io(r)||(a=r<a?r:a),s=i.splice(n,a),o=Rl(i)}return new e(t,s)}}return e.create=function(t,n){return new e(t,n)},e}();const Pl=function(){function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",o=!1;mi(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}();var Hl=function(){function e(){var t={};mi(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=function(e){var t=[];return e&&wo(e,(function(e){t.push(_o(e))})),t}(e.split(","));if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),o=0;o<i.length;++o)t[i[o]]=Io()+r}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,i=_o(e);return void 0!==n[i]&&n[i]>Io()||(delete n[i],!1)}}))}return e.__ieDyn=1,e}();const Ol=Hl;function Ul(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var Ml,Dl=2e6,Fl=Math.min(Dl,65e3),xl="metadata",ql="f",Bl=/\./,Ll=function(){function e(t,n,i,r){var o="data",s="baseData",a=!!r,c=n,u={};mi(e,this,(function(e){function n(e,t,r,o,s,l,d){co(e,(function(e,h){var f=null;if(h||Dc(h)){var p=r,v=e,m=s,g=t;if(a&&!o&&Bl.test(e)){var w=e.split("."),y=w.length;if(y>1){m&&(m=m.slice());for(var _=0;_<y-1;_++){var C=w[_];g=g[C]=g[C]||{},p+="."+C,m&&m.push(C)}v=w[y-1]}}var S=o&&function(e,t){var n=u[e];return void 0===n&&(e.length>=7&&(n=uo(e,"ext.metadata")||uo(e,"ext.web")),u[e]=n),n}(p);if(f=!S&&c&&c.handleField(p,v)?c.value(p,v,h,i):function(e,t,n){if(!t&&!Dc(t)||"string"!=typeof e)return null;var i,r=typeof t;if("string"===r||"number"===r||"boolean"===r||ho(t))t={value:t};else if("object"!==r||Rn.call(t,"value")){if(io(t.value)||t.value===Ya||!fo(t.value)&&!po(t.value)&&!vo(t.value)&&!ho(t.value))return null}else t={value:n?JSON.stringify(t):t};if(ho(t.value)&&!(t.value.length>0))return null;if(!io(t.kind)){if(ho(t.value)||!(0===(i=t.kind)||i>0&&i<=13||32===i))return null;t.value=t.value.toString()}return t}(v,h,i)){var k=f.value;if(g[v]=k,l&&l(m,v,f),d&&"object"==typeof k&&!ho(k)){var b=m;b&&(b=b.slice()).push(v),n(h,k,p+"."+v,o,b,l,d)}}}}))}e.createPayload=function(e,t,n,i,r,o){return{apiKeys:[],payloadBlob:ul,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i,sendType:o,sendReason:r}},e.appendPayload=function(n,i,r){var o=n&&i&&!n.overflow;return o&&jo(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),o=n.payloadBlob,s=n.numEvents,a=!1,c=[],u=[],l=n.isBeacon,d=l?65e3:3984588,h=l?Fl:Dl,f=0,p=0;f<t.length;){var v=t[f];if(v){if(s>=r){n.overflow=i.split(f);break}var m=e.getEventBlob(v);if(m&&m.length<=h){var g=m.length;if(o.length+g>d){n.overflow=i.split(f);break}o&&(o+="\n"),o+=m,++p>20&&(o.substr(0,1),p=0),a=!0,s++}else m?c.push(v):u.push(v),t.splice(f,1),f--}f++}if(c&&c.length>0&&n.sizeExceed.push(Nl.create(i.iKey(),c)),u&&u.length>0&&n.failedEvts.push(Nl.create(i.iKey(),u)),a){n.batches.push(i),n.payloadBlob=o,n.numEvents=s;var w=i.iKey();-1===yo(n.apiKeys,w)&&n.apiKeys.push(w)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),o},e.getEventBlob=function(e){try{return jo(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return Ya}(e.iKey);var i={},r=e.ext;r&&(t.ext=i,co(r,(function(e,t){n(t,i[e]={},"ext."+e,!0,null,null,!0)})));var a=t[o]={};a.baseType=e.baseType;var c=a[s]={};return n(e.baseData,c,s,!1,[s],(function(e,t,n){Wl(i,e,t,n)}),!0),n(e.data,a,o,!1,[],(function(e,t,n){Wl(i,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function Wl(e,t,n,i){if(i&&e){var r=Fc(i.value,i.kind,i.propertyType);if(r>-1){var o=e[xl];o||(o=e[xl]={f:{}});var s=o[ql];if(s||(s=o[ql]={}),t)for(var a=0;a<t.length;a++){var c=t[a];s[c]||(s[c]={f:{}});var u=s[c][ql];u||(u=s[c][ql]={}),s=u}s=s[n]={},ho(i.value)?s.a={t:r}:s.t=r}}}var jl="sendAttempt",Kl="&NoResponseBody=true",Gl=((Ml={})[1]=hl,Ml[100]=hl,Ml[200]="sent",Ml[8004]=dl,Ml[8003]=dl,Ml),$l={},zl={};function Jl(e,t,n){$l[e]=t,!1!==n&&(zl[t]=e)}function Vl(e){try{return e.responseText}catch(e){}return ul}function Ql(e,t){var n,i,r=!1;if(e&&t){var o=ko(e);if(o&&o.length>0)for(var s=t.toLowerCase(),a=0;a<o.length;a++){var c=o[a];if(c&&(i=c,(n=t)&&Rn[sr](n,i))&&c.toLowerCase()===s){r=!0;break}}}return r}function Xl(e,t,n,i){t&&n&&n.length>0&&(i&&$l[t]?(e.hdrs[$l[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function Yl(e,t){return t&&(po(t)?e=[t].concat(e):ho(t)&&(e=t.concat(e))),e}Jl(kl,kl,!1),Jl(wl,wl),Jl(yl,"Client-Id"),Jl(Sl,Sl),Jl(_l,_l),Jl(Cl,Cl),Jl(bl,bl);var Zl=function(){function e(t,n,i,r,o){this.Ca=[];var s,a,c,u,l,d,h,f,p,v,m="?cors=true&"+vl.toLowerCase()+"="+fl,g=new Ol,w=!1,y=new Pl,_=!1,C=0,S=!0,k=[],b={},T=[],A=null,I=!1,E=!1,R=!1;mi(e,this,(function(e){var N=!0;function P(e,t){for(var n=0,i=null,r=0;null==i&&r<e.length;)1===(n=e[r])?(null===is&&(is=typeof XDomainRequest!==Cn)&&Cs()&&(is=is&&!os(ss(Zo),"withCredentials")),is?i=H:Cs()&&(i=U)):2===n&&_s(t)&&(!t||t&&!f)?i=O:_&&3===n&&ys()&&(i=D),r++;return i?{Sa:n,ka:t,sendPOST:i}:null}function H(e,t,n){var i=new XDomainRequest;i.open(ll,e.urlString),e.timeout&&(i.timeout=e.timeout),i.onload=function(){var e=Vl(i);M(t,200,{},e),z(e)},i.onerror=function(){M(t,400,{})},i.ontimeout=function(){M(t,500,{})},i.onprogress=function(){},n?i.send(e.data):o.set((function(){i.send(e.data)}),0)}function O(e,t,n){var i,r=e.urlString,s=!1,a=!1,c=((i={body:e.data,method:ll}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);n&&(c.keepalive=!0,2===e.ba&&(s=!0,v&&(r+=Kl))),N&&(c.credentials="include"),e.headers&&ko(e.headers).length>0&&(c.headers=e.headers),fetch(r,c).then((function(e){var n={},i=ul,r=e.headers;r&&r.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),a||(a=!0,M(t,e.status,n,i),z(i))})).catch((function(e){a||(a=!0,M(t,0,{}))})),s&&!a&&(a=!0,M(t,200,{})),!a&&e.timeout>0&&o.set((function(){a||(a=!0,M(t,500,{}))}),e.timeout)}function U(e,t,n){var i=e.urlString;function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=_o(i))}return e}function o(e,n){M(t,e.status,function(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},fo(t)&&wo(_o(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var i=_o(e.substring(0,t)).toLowerCase(),r=_o(e.substring(t+1));n[i]=r}else n[_o(e)]=1}})),i=n):(i=r(i,e,gl),i=r(i,e,ml),i=r(i,e,"kill-duration-seconds")),i}(e),n)}n&&e.disableXhrSync&&(n=!1);var s=function(e,t,n,i,r,o){function s(e,t,n){try{e[t]=n}catch(e){}}void 0===i&&(i=!1),void 0===r&&(r=!1);var a=new XMLHttpRequest;return i&&s(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),n&&s(a,Uc,n),a.open(e,t,!r),n&&s(a,Uc,n),!r&&o&&s(a,"timeout",o),a}(ll,i,N,!0,n,e.timeout);co(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=Vl(s);o(s,e),z(e)},s.onerror=function(){o(s)},s.ontimeout=function(){o(s)},s.send(e.data)}function M(e,t,n,i){try{e(t,n,i)}catch(e){Us(a,2,518,ws(e))}}function D(e,t,n){var i=200,r=e.Ta,o=e.urlString+(v?Kl:ul);try{var s=hs();if(!s.sendBeacon(o,e.data))if(r){var c=[];wo(r.batches,(function(e){if(c&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!s.sendBeacon(o,A.getEventBlob(t[n]))){c.push(e.split(n));break}}else c.push(e.split(0))})),J(c,8003,r.sendType,!0)}else i=0}catch(e){Ms(a,"Failed to send telemetry using sendBeacon API. Ex:"+ws(e)),i=0}finally{M(t,i,{},ul)}}function F(e){return 2===e||3===e}function x(e){return E&&F(e)&&(e=2),e}function q(){return!w&&C<n}function B(){var e=T;return T=[],e}function L(e,t,n){var i=!1;return e&&e.length>0&&!w&&c[t]&&A&&(i=0!==t||q()&&(n>0||y.allowRequestSending())),i}function W(e){var t={};return e&&wo(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function j(e,n,i,r,o){if(e&&0!==e.length)if(w)J(e,1,r);else{r=x(r);try{var s=e,l=0!==r;jo(u,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var a=[],u=null,d=Lc(),h=c[r]||(l?c[1]:c[0]),f=h&&h.Sa,v=p&&(E||F(r)||3===f||h.ka&&2===f);L(e,r,n);){var m=e.shift();m&&m.count()>0&&(g.isTenantKilled(m.iKey())?a.push(m):(u=u||A.createPayload(n,i,l,v,o,r),A.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,G(u,d,Lc(),o),d=Lc(),u=null):(G(u,d,Lc(),o),d=Lc(),e=[m].concat(e),u=null)))}u&&G(u,d,Lc(),o),e.length>0&&(T=e.concat(T)),J(a,8004,r)}),(function(){return{batches:W(s),retryCount:n,isTeardown:i,isSynchronous:l,sendReason:o,useSendBeacon:F(r),sendType:r}}),!l)}catch(e){Us(a,2,48,"Unexpected Exception sending batch: "+ws(e))}}}function K(e,t,n){e[t]=e[t]||{},e[t][s.identifier]=n}function G(t,n,r,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,p=c[t.sendType];!F(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=c[2]||c[3]||p);var v=R;(t.isBeacon||3===p.Sa)&&(v=!1);var w=function(e,t){var n={url:m,hdrs:{},useHdrs:!1};t?(n.hdrs=Bc(n.hdrs,b),n.useHdrs=ko(n.hdrs).length>0):co(b,(function(e,t){zl[e]?Xl(n,zl[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),Xl(n,yl,"NO_AUTH",t),Xl(n,wl,Oc,t);var i=ul;wo(e.apiKeys,(function(e){i.length>0&&(i+=","),i+=e})),Xl(n,Sl,i,t),Xl(n,Cl,Io().toString(),t);var r=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return ul}(e);if(Dc(r)&&(n.url+="&ext.intweb.msfpc="+r),y.shouldAddClockSkewHeaders()&&Xl(n,_l,y.getClockSkewHeaderValue(),t),u.getWParam){var o=u.getWParam();o>=0&&(n.url+="&w="+o)}for(var s=0;s<k.length;s++)n.url+="&"+k[s].name+"="+k[s].value;return n}(t,v);v=v||w.useHdrs;var _=Lc();jo(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var c=0;c<t.batches.length;c++)for(var m=t.batches[c].events(),k=0;k<m.length;k++){var b=m[k];if(I){var T=b.timings=b.timings||{};K(T,"sendEventStart",_),K(T,"serializationStart",n),K(T,"serializationCompleted",r)}b[jl]>0?b[jl]++:b[jl]=1}J(t.batches,1e3+(o||0),t.sendType,!0);var A={data:t.payloadBlob,urlString:w.url,headers:w.hdrs,Ta:t,ba:o,timeout:d,disableXhrSync:h,disableFetchKeepAlive:f};v&&(Ql(A.headers,pl)||(A.headers[pl]="no-cache, no-store"),Ql(A.headers,vl)||(A.headers[vl]=fl));var R=null;p&&(R=function(n){y.firstRequestSent();var r=function(n,r){!function(t,n,r,o){var a=9e3,c=null,u=!1,l=!1;try{var d=!0;if(typeof t!==Cn){if(n){y.setClockSkew(n[gl]);var h=n[ml]||n["kill-duration-seconds"];wo(g.setKillSwitchTenants(n["kill-tokens"],h),(function(e){wo(r.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);r.numEvents-=n.count(),c.push(n)}}))}))}if(200==t||204==t)return void(a=200);(!function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)}(t)||r.numEvents<=0)&&(d=!1),a=9e3+t%1e3}if(d){a=100;var f=r.retryCnt;0===r.sendType&&(f<i?(u=!0,$((function(){0===r.sendType&&C--,j(r.batches,f+1,r.isTeardown,E?2:r.sendType,5)}),E,Ul(f))):(l=!0,E&&(a=8001)))}}finally{u||(y.setClockSkew(),function(t,n,i,r){try{r&&s.Aa(),200===n&&(r||t.isSync||s.Ia(),function(e){if(I){var t=Lc();wo(e,(function(e){e&&e.count()>0&&function(e,t){I&&wo(e,(function(e){K(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),J(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(C--,5!==i&&e.sendQueuedRequests(t.sendType,i))}}(r,a,o,l)),J(c,8004,r.sendType)}}(n,r,t,o)},c=t.isTeardown||t.isSync;try{p.sendPOST(n,r,c),e.sendListener&&e.sendListener(A,n,c,t.isBeacon)}catch(e){Ms(a,"Unexpected exception sending payload. Ex:"+ws(e)),M(r,0,{})}}),jo(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(R)if(0===t.sendType&&C++,l&&!t.isBeacon&&3!==p.Sa){var n={data:A.data,urlString:A.urlString,headers:Bc({},A.headers),timeout:A.timeout,disableXhrSync:A.disableXhrSync,disableFetchKeepAlive:A.disableFetchKeepAlive},i=!1;jo(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,S||e.Ta||(e.Ta=e.Ta||A.Ta,e.ba=e.ba||A.ba),R(e)}),t.isSync||t.isTeardown)}catch(e){i||R(A)}}))}else R(A)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:r,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&J(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&J(t.failedEvts,8002,t.sendType)}function $(e,t,n){t?e():o.set(e,n)}function z(t){var n=e.Ca;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){Us(a,1,519,"Response handler failed: "+e)}if(t){var r=JSON.parse(t);Dc(r.webResult)&&Dc(r.webResult[Tl])&&l.set("MSFPC",r.webResult[Tl],31536e3)}}catch(e){}}function J(e,t,n,i){if(e&&e.length>0&&r){var o=r[(c=t,l=Gl[c],Dc(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l=dl:c>=1e3&&c<=1999&&(l="send")),l)];if(o){var s=0!==n;jo(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){$((function(){try{o.call(r,e,t,s,n)}catch(e){Us(a,1,74,"send request notification failed: "+e)}}),i||s,0)}),(function(){return{batches:W(e),reason:t,isSync:s,sendSync:i,sendType:n}}),!s)}}var c,l}e.initialize=function(e,t,n,i,r){var o;r||(r={}),m=e+m,R=!!no(r.avoidOptions)||!r.avoidOptions,u=t,l=t.getCookieMgr(),I=!u.config.disableEventTimings;var g=!!u.config.enableCompoundKey;a=(s=n).diagLog();var w=r.valueSanitizer,y=r.stringifyObjects;no(r.enableCompoundKey)||(g=!!r.enableCompoundKey),d=r.xhrTimeout,h=!!r.disableXhrSync,f=!!r.disableFetchKeepAlive,v=!1!==r.addNoResponse,_=!ms(),A=new Ll(u,w,y,g),io(r.useSendBeacon)||(_=!!r.useSendBeacon);var C=i,k=r.alwaysUseXhrOverride?i:null,b=r.alwaysUseXhrOverride?i:null,T=[3,2];if(!i){S=!1;var E=fs();E&&E.protocol&&"file:"===E.protocol.toLowerCase()&&(N=!1);var H=[];ms()?(H=[2,1],T=[2,1,3]):H=[1,2,3],(i=P(H=Yl(H,r.transports),!1))||Ms(a,"No available transport to send events"),C=P(H,!0)}k||(k=P(T=Yl(T,r.unloadTransports),!0)),p=!S&&(_&&ys()||!f&&_s(!0)),(o={})[0]=i,o[1]=C||P([1,2,3],!0),o[2]=k||C||P([1],!0),o[3]=b||P([2,3],!0)||C||P([1],!0),c=o},e.Ea=function(){return[c[0],g,A,c]},e.addQueryStringParameter=function(e,t){for(var n=0;n<k.length;n++)if(k[n].name===e)return void(k[n].value=t);k.push({name:e,value:t})},e.addHeader=function(e,t){b[e]=t},e.canSendRequest=function(){return q()&&y.allowRequestSending()},e.sendQueuedRequests=function(e,t){no(e)&&(e=0),E&&(e=x(e),t=2),L(T,e,0)&&j(B(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!w&&0===C&&0===T.length},e.setUnloading=function(e){E=e},e.addBatch=function(e){if(e&&e.count()>0){if(g.isTenantKilled(e.iKey()))return!1;T.push(e)}return!0},e.teardown=function(){T.length>0&&j(B(),0,!0,2,2)},e.pause=function(){w=!0},e.resume=function(){w=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(io(t)&&(t=1),E&&(t=x(t),n=2),j([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function ed(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout(e,t,n)}function td(e){clearTimeout(e)}function nd(e,t){return{set:e||ed,clear:t||td}}var id="eventsDiscarded",rd="overrideInstrumentationKey",od="maxEventRetryAttempts",sd="maxUnloadEventRetryAttempts",ad=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.12";var r,o,s,a,c,u,l,d=!1,h=[],f=null,p=!1,v=0,m=500,g=0,w=1e4,y={},_=cl,C=null,S=null,k=0,b=0,T={},A=-1,I=!0,E=!1,R=6,N=2;return mi(t,i,(function(e,t){function i(e){"beforeunload"!==(e||cs().event).type&&(E=!0,o.setUnloading(E)),q(2,2)}function P(e){E=!1,o.setUnloading(E)}function H(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[Al]&&delete e.ext[Al],e.ext&&e.ext[Il]&&e.ext[Il].id&&delete e.ext[Il].id,I&&(e.ext=Mo(e.ext),e.baseData&&(e.baseData=Mo(e.baseData)),e.data&&(e.data=Mo(e.data))),e.sync)if(k||p)e.latency=3,e.sync=!1;else if(o)return I&&(e=Mo(e)),void o.sendSynchronousBatch(Nl.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,i=g,r=w;4===n&&(i=v,r=m);var s=!1;if(i<r)s=!W(e,t);else{var a=1,c=20;4===n&&(a=4,c=1),s=!0,function(e,t,n,i){for(;n<=t;){var r=B(e,t,!0);if(r&&r.count()>0){var o=r.split(0,i),s=o.count();if(s>0)return 4===n?v-=s:g-=s,X(id,[o],al.QueueFull),!0}n++}return j(),!1}(e.iKey,e.latency,a,c)&&(s=!W(e,t))}s&&Q(id,[e],al.QueueFull)}function O(e,t,n){var i=K(e,t,n);return o.sendQueuedRequests(t,n),i}function U(){return g>0}function M(){if(A>=0&&K(A,0,c)&&o.sendQueuedRequests(0,c),v>0&&!S&&!p){var e=y[_][2];e>=0&&(S=F((function(){S=null,O(4,0,1),M()}),e))}var t=y[_][1];!C&&!f&&t>=0&&!p&&(U()?C=F((function(){C=null,O(0===b?3:1,0,1),b++,b%=2,M()}),t):b=0)}function D(){n=null,d=!1,h=[],f=null,p=!1,v=0,m=500,g=0,w=1e4,y={},_=cl,C=null,S=null,k=0,b=0,r=null,T={},s=void 0,a=0,A=-1,c=null,I=!0,E=!1,R=6,N=2,u=null,l=nd(),o=new Zl(500,2,1,{requeue:J,send:Y,sent:Z,drop:ee,rspFail:te,oth:ne},l),z(),T[4]={batches:[],iKeyMap:{}},T[3]={batches:[],iKeyMap:{}},T[2]={batches:[],iKeyMap:{}},T[1]={batches:[],iKeyMap:{}},ie()}function F(e,t){0===t&&k&&(t=1);var n=1e3;return k&&(n=Ul(k-1)),l.set(e,t*n)}function x(){return null!==C&&(l.clear(C),C=null,b=0,!0)}function q(e,t){x(),f&&(l.clear(f),f=null),p||O(1,e,t)}function B(e,t,n){var i=T[t];i||(i=T[t=1]);var r=i.iKeyMap[e];return!r&&n&&(r=Nl.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function L(t,n){o.canSendRequest()&&!k&&(s>0&&g>s&&(n=!0),n&&null==f&&e.flush(t,null,20))}function W(e,t){I&&(e=Mo(e));var n=e.latency,i=B(e.iKey,n,!0);return!!i.addEvent(e)&&(4!==n?(g++,t&&0===e.sendAttempt&&L(!e.sync,a>0&&i.count()>=a)):v++,!0)}function j(){for(var e=0,t=0,n=function(n){var i=T[n];i&&i.batches&&wo(i.batches,(function(i){4===n?e+=i.count():t+=i.count()}))},i=1;i<=4;i++)n(i);g=t,v=e}function K(t,n,i){var r=!1,s=0===n;return!s||o.canSendRequest()?jo(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var i=T[n];i&&i.batches&&i.batches.length>0&&(wo(i.batches,(function(t){o.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),4===n?v-=t.count():g-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&Q(id,e,al.KillSwitch),r&&A>=t&&(A=-1,c=0)}),(function(){return{latency:t,sendType:n,sendReason:i}}),!s):(A=A>=0?Math.min(A,t):t,c=Math.max(c,i)),r}function G(e,t){O(1,0,t),j(),$((function(){e&&e(),h.length>0?f=F((function(){f=null,G(h.shift(),t)}),0):(f=null,M())}))}function $(e){o.isCompletelyIdle()?e():f=F((function(){f=null,$(e)}),.25)}function z(){(y={})[cl]=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function J(t,n){var i=[],r=R;E&&(r=N),wo(t,(function(t){t&&t.count()>0&&wo(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<r?(Wc(t,e.identifier),H(t,!1)):i.push(t))}))})),i.length>0&&Q(id,i,al.NonRetryableStatus),E&&q(2,2)}function V(t,n){var i=e.Ra||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){Us(e.diagLog(),1,74,t+" notification failed: "+n)}}function Q(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&V(e,[t].concat(n))}function X(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&wo(t,(function(t){t&&t.count()>0&&V(e,[t.events()].concat(n))}))}function Y(e,t,n){e&&e.length>0&&V("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function Z(e,t){X("eventsSent",e,t),M()}function ee(e,t){X(id,e,t>=8e3&&t<=8999?t-8e3:al.Unknown)}function te(e){X(id,e,al.NonRetryableStatus),M()}function ne(e,t){X(id,e,al.Unknown),M()}function ie(){a=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,w/6)}D(),e.Ea=function(){return[o]},e.initialize=function(a,c,d){jo(c,(function(){return"PostChannel:initialize"}),(function(){var h,f,p,v,g=c;t.initialize(a,c,d);try{c.addUnloadCb,u=bc(Js(e.identifier),c.evtNamespace&&c.evtNamespace());var y=e.ma();a.extensionConfig[e.identifier]=a.extensionConfig[e.identifier]||{},n=y.getExtCfg(e.identifier),l=nd(n.setTimeoutOverride,n.clearTimeoutOverride),I=!n.disableOptimizeObj&&!!ss("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(g),n.eventsLimitInMem>0&&(w=n.eventsLimitInMem),n.immediateEventLimit>0&&(m=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(s=n.autoFlushEventsLimit),po(n[od])&&(R=n[od]),po(n[sd])&&(N=n[sd]),ie(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(r=n.httpXHROverride),Dc(a.anonCookieName)&&o.addQueryStringParameter("anoncknm",a.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var _=n.overrideEndpointUrl?n.overrideEndpointUrl:a.endpointUrl;e.Ra=c.getNotifyMgr(),o.initialize(_,e.core,e,r,n);var C=a.disablePageUnloadEvents||[];h=[dc,lc,cc],p=C,v=u,(f=i)&&h&&ho(h)&&!Ic(h,f,p,v)&&p&&p[Ai]>0&&Ic(h,f,null,v),Rc(i,C,u),Nc(P,a.disablePageShowEvents,u)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:a,core:c,extensions:d}}))},e.processTelemetry=function(t,i){Wc(t,e.identifier);var r=(i=e.ma(i)).getExtCfg(e.identifier),o=!!n.disableTelemetry;r&&(o=o||!!r.disableTelemetry);var s=t;o||d||(n[rd]&&(s.iKey=n[rd]),r&&r[rd]&&(s.iKey=r[rd]),H(s,!0),E?q(2,2):M()),e.processNext(s,i)},e._a=function(e,t){var n;q(2,2),d=!0,o.teardown(),Ec([dc,lc,cc],null,u),n=bc(hc,u),Ec([cc],null,n),Ec([ac],null,n),function(e,t){var n=bc(fc,t);Ec([uc],null,n),Ec([ac],null,n)}(0,u),D()},e.setEventQueueLimits=function(e,t){w=e>0?e:1e4,s=t>0?t:0,ie();var n=g>e;if(!n&&a>0)for(var i=1;!n&&i<=3;i++){var r=T[i];r&&r.batches&&wo(r.batches,(function(e){e&&e.count()>=a&&(n=!0)}))}L(!0,n)},e.pause=function(){x(),p=!0,o.pause()},e.resume=function(){p=!1,o.resume(),M()},e.addResponseHandler=function(e){o.Ca.push(e)},e.Na=function(e){x(),z(),_=cl,M(),co(e,(function(e,t){var n=t.length;if(n>=2){var i=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var r=t[0]/t[1];t[0]=Math.ceil(r)*t[1]}i>=0&&t[1]>=0&&i>t[1]&&(i=t[1]),t.push(i),y[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!p)if(n=n||1,e)null==f?(x(),K(1,0,n),f=F((function(){f=null,G(t,n)}),0)):h.push(t);else{var i=x();O(1,1,n),null!=t&&t(),i&&M()}},e.setMsaAuthTicket=function(e){o.addHeader(kl,e)},e.hasEvents=U,e.Pa=function(e){_!==e&&void 0!==y[e]&&(x(),_=e,M())},e.Aa=function(){k<4&&(k++,x(),M())},e.Ia=function(){k&&(k=0,x(),M())},bo(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=nd(e,l.clear)})),bo(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=nd(l.set,e)}))})),i}return Dn(t,e),t.__ieDyn=1,t}(qa);const cd=ad;var ud=function(e){function t(){var n,i,r=e.call(this)||this;return mi(t,r,(function(e,t){e.initialize=function(e,o){var s=r;jo(r,(function(){return"ApplicationInsights:initialize"}),(function(){n=new cd;var r=[i=new ol];o&&(r=r.concat(o)),e||Oo("You must provide a config object!");var a=e.channels;if(a&&a.length>0){for(var c=!1,u=0;u<a[0].length;u++)if(a[0][u].identifier===n.identifier){c=!0;break}c||a[0].push(n)}else e.channels=[[n]];var l=e.extensionConfig=e.extensionConfig||[];l[n.identifier]=l[n.identifier]||e&&e.channelConfiguration||{},l[i.identifier]=l[i.identifier]||e&&e.propertyConfiguration||{};try{t.initialize(e,r)}catch(e){Us(s.logger,1,514,"Failed to initialize SDK."+ws(e))}}),(function(){return{config:e,extensions:o}}))},e.getPropertyManager=function(){return i},e.getPostChannel=function(){return n}})),r}return Dn(t,e),t.__ieDyn=1,t}(Gc);const ld=ud,dd={...fn.Ak,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedClientApplicationSendSSOSilentRequest",EmbeddedClientApplicationSendPopupRequest:"embeddedClientApplicationSendPopupRequest",EmbeddedClientApplicationSendRedirectRequest:"embeddedClientApplicationSendRedirectRequest",EmbeddedClientApplicationHandleRedirectRequest:"embeddedClientApplicationHandleRedirectRequest",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedClientApplicationSendSilentRefreshRequest"},hd=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);class fd{constructor(e,t){this.logger=e,this.isSampled=!t?.disabled&&this.calculateSampling(t?.samplingPercentage),this.logger.verbose(`PerformanceTelemetryReporter: Sampled for 1p telemetry: ${this.isSampled.toString()}`),this.eventsToEmit=t?.eventsToEmit||[dd.AcquireTokenSilent,dd.SsoSilent,dd.AcquireTokenByCode,dd.InitializeClientApplication],this.logger.verbose(`PerformanceTelemetryReporter: Events to be tracked include : ${this.eventsToEmit}`),this.logger.verbose(`PerformanceTelemetryReporter: Events passed in the PerformanceTelemetryConfiguration are: ${t?.eventsToEmit}`);const n={instrumentationKey:fd.instrumentationKey,extensions:[]};this.appInsights=new ld,this.appInsights.initialize(n,[]),this.logger.verbose("PerformanceTelemetryReporter: Initialized")}calculateSampling(e){return 0===e?(this.logger.verbose(" PerformanceTelemetryReporter: No sampling rate configured."),!1):(this.logger.verbose(`PerformanceTelemetryReporter: Configured sampling rate = ${e} `),this.logger.verbose(`PerformanceTelemetryReporter: DEFAULT sampling rate = ${fd.DEFAULT_SAMPLING_RATE}`),Math.random()<=(e||fd.DEFAULT_SAMPLING_RATE))}sendCustomEvent(e){const t={...e,appName:void 0},n={name:e.name,data:t};this.logger.verbose(`PerformanceTelemetryReporter: Sending ${n.name} for tracking`),this.appInsights.track(n)}canSendEvent(e){const t=!this.eventsToEmit||this.eventsToEmit?.indexOf(e.name)>-1,n=fd.DEFAULT_ALLOWED_CLOUDS.some((t=>0===e.authority.indexOf(t.toString())));return this.isSampled&&t&&n}getPerformanceTelemetryCallback(){return this.logger.trace("PerformanceTelemetryReporter: Attaching callback to send custom metrics."),this.logger.verbose(" PerformanceTelemetryReporter: Returning callback as telemetry emitted."),e=>{e.forEach((e=>{this.canSendEvent(e)?(this.logger.verbose(`PerformanceTelemetryReporter: Emitting telemetry for ${e.name}`,e.correlationId),this.sendCustomEvent(e)):this.logger.verbose(`PerformanceTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId)}))}}}fd.DEFAULT_SAMPLING_RATE=.1,fd.DEFAULT_ALLOWED_CLOUDS=[wn.z.AzurePublic,wn.z.AzurePpe],fd.instrumentationKey="d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725";class pd extends hn{constructor(e,t){t?.disabled||e.telemetry?.client||(e.telemetry={...e.telemetry,client:e.telemetry?.client||new gn(e,hd)}),super(e);const n=new fd(this.getLogger(),t);this.addPerformanceCallback(n.getPerformanceTelemetryCallback())}}var vd,md,gd=null===(vd=document.getElementById("owl"))||void 0===vd?void 0:vd.dataset,wd="6a2a0a9e-6f11-4d59-b8a1-afd8bfd2401c";function yd(e,t,i,r){return(0,n.mG)(this,void 0,void 0,(function(){var o,s,a,c,u,l,d,h,m,w,y=this;return(0,n.Jh)(this,(function(C){switch(C.label){case 0:return[4,e];case 1:return o=C.sent(),s=null===t?(0,g.n)()[0]:t,(0,v.l)(_.OwlGetAccountByUsernameStart),a=(0,v.a)(),null!==(c=i?o.getAccountByUsername(i):null)?[3,3]:[4,Cd(o,s,i,r)];case 2:return(u=C.sent())?[2,u.accessToken]:[2,Promise.reject("SsoSilent login failed")];case 3:return(0,v.l)(_.OwlGetAccountByUsernameEnd),l=(0,v.a)(),null==r||r.ULS.sendTraceTag(508053090,f.W.zn,p.G.Warning,"[OWL] Msal get user account from cache succeed, take time: ".concat(l-a)),d={correlationId:t,account:c,scopes:["e03a13ee-9730-4cae-8525-47559c8cf18a/.default"]},(0,v.l)(_.OwlTryGetWacTokenStart),h=(0,v.a)(),m=o.acquireTokenSilent(d),w="",[4,m.then((function(e){if(e.fromCache){(0,v.l)(_.OwlTryGetWacTokenFromCacheEnd);var t=(0,v.a)();null==r||r.ULS.sendTraceTag(508122775,f.W.zn,p.G.Warning,"[OWL] Msal get wac token silently from cache succeed, take time: ".concat(t-h))}else{(0,v.l)(_.OwlTryGetWacTokenEnd);var n=(0,v.a)();null==r||r.ULS.sendTraceTag(508155349,f.W.zn,p.G.Info,"[OWL] Msal get wac token silently succeed, take time: ".concat(n-h))}w=e.accessToken})).catch((function(e){return(0,n.mG)(y,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return T.Fh.FeatureGate_EcsHootGate&&e instanceof nn.Yo?[4,kd(o,d,r)]:[3,2];case 1:return t=n.sent(),w=t.accessToken,[3,3];case 2:null==r||r.ULS.sendTraceTag(508123353,f.W.zn,p.G.Warning,"[OWL] Msal failed to get wac token silently: error ".concat(e)),n.label=3;case 3:return[2]}}))}))}))];case 4:return C.sent(),[2,w]}}))}))}function _d(e,t){var i=this,r=function(e){var t,n;return{appIds:[wd],authority:null!==(t=R||(null==gd?void 0:gd.authority))&&void 0!==t?t:"",authorityType:e.isMsa?"msa":"aad",upn:null!==(n=e.loginHint||e.upn)&&void 0!==n?n:"string"==typeof e.customAuthConfigValue?JSON.parse(e.customAuthConfigValue).login_Hint:""}}(e);return new Promise((function(e){return(0,n.mG)(i,void 0,void 0,(function(){var i,o,s,a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return r.authority&&(r.authority=r.authority.replace(md.ProdLegacy,md.Prod)),"msa"===r.authorityType.toLowerCase()?r.authority=md.Prod+md.MsaSuffix:(r.authority||(r.authority=md.Prod+md.AadSuffix),r.authority.indexOf(md.AadSuffix)<0&&("/"===r.authority.charAt(r.authority.length-1)?r.authority+=md.AadSuffix:r.authority+="/"+md.AadSuffix)),i={auth:{authority:r.authority,clientId:wd,redirectUri:"/suite/OAuth.html"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},o={disabled:!1,samplingPercentage:1},(0,v.l)(_.OwlMsalInitStart),s=new pd(i,o),a=(0,v.a)(),[4,s.initialize()];case 1:return n.sent(),(0,v.l)(_.OwlMsalInitEnd),c=(0,v.a)(),null==t||t.ULS.sendTraceTag(508143306,f.W.zn,p.G.Info,"[OWL] Msal init time: ".concat(c-a)),e(s),[2]}}))}))}))}function Cd(e,t,i,r){return(0,n.mG)(this,void 0,void 0,(function(){var o,s,a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:o={loginHint:i,correlationId:t,scopes:["e03a13ee-9730-4cae-8525-47559c8cf18a/.default"]},n.label=1;case 1:return n.trys.push([1,3,,6]),(0,v.l)(_.OwlMsalSsoSilentStart),s=(0,v.a)(),[4,e.ssoSilent(o)];case 2:return(a=n.sent())&&(c=(0,v.a)(),(0,v.l)(_.OwlMsalSsoSilentEnd),null==r||r.ULS.sendTraceTag(508143305,f.W.zn,p.G.Info,"[OWL] Msal ssoSilent succeed, take time: ".concat(s-c))),[2,a];case 3:return u=n.sent(),T.Fh.FeatureGate_EcsHootGate&&u instanceof nn.Yo?[4,Sd(e,o,r)]:[3,5];case 4:return[2,n.sent()];case 5:return null==r||r.ULS.sendTraceTag(508143303,f.W.zn,p.G.Warning,"[OWL] Msal ssoSilent failed, error: ".concat(u)),[2,Promise.reject(u)];case 6:return[2]}}))}))}function Sd(e,t,i){return(0,n.mG)(this,void 0,void 0,(function(){var r,o,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return(0,v.l)(_.OwlMsalLoginPopupStart),r=(0,v.a)(),[4,e.loginPopup(t)];case 1:return(o=n.sent())?(s=(0,v.a)(),(0,v.l)(_.OwlMsalLoginPopupEnd),null==i||i.ULS.sendTraceTag(508123352,f.W.zn,p.G.Info,"[OWL] Msal loginPopup succeed, take time: ".concat(s-r))):null==i||i.ULS.sendTraceTag(508123351,f.W.zn,p.G.Warning,"[OWL] Msal loginPopup failed"),[2,o]}}))}))}function kd(e,t,i){return(0,n.mG)(this,void 0,void 0,(function(){var r=this;return(0,n.Jh)(this,(function(o){return[2,new Promise((function(o){return(0,n.mG)(r,void 0,void 0,(function(){var r,s,a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),(0,v.l)(_.OwlTryGetWacTokenPopupStart),r=(0,v.a)(),[4,e.acquireTokenPopup(t)];case 1:return(s=n.sent())&&(a=(0,v.a)(),(0,v.l)(_.OwlTryGetWacTokenPopupEnd),null==i||i.ULS.sendTraceTag(508123355,f.W.zn,p.G.Info,"[OWL] Msal get wac token through popup succeed, take time: ".concat(a-r)),o(s)),[3,3];case 2:return c=n.sent(),null==i||i.ULS.sendTraceTag(508123354,f.W.zn,p.G.Warning,"[OWL] Msal failed to get wac token through popup: error ".concat(c)),[3,3];case 3:return[2]}}))}))}))]}))}))}!function(e){e.Prod="https://login.microsoftonline.com/",e.ProdLegacy="https://login.windows.net/",e.Ppe="https://login.windows-ppe.net/",e.AadSuffix="organizations",e.MsaSuffix="consumers"}(md||(md={}));var bd=s(2967),Td="WacDataCenter";function Ad(e){switch(e){case k.T.Word:case k.T.PowerPoint:case k.T.Excel:case k.T.OneNote:case k.T.Visio:return"".concat(e.toString()).concat(Td);default:return}}function Id(e){var t,n=Ad(e),i=n?null===localStorage||void 0===localStorage?void 0:localStorage.getItem(n):void 0;return null!==(t=null!=i?i:null===localStorage||void 0===localStorage?void 0:localStorage.getItem(Td))&&void 0!==t?t:void 0}function Ed(e,t){if(t){null===localStorage||void 0===localStorage||localStorage.setItem(Td,t);var n=Ad(e);n&&(null===localStorage||void 0===localStorage||localStorage.setItem(n,t))}}var Rd,Nd,Pd,Hd=s(4617),Od=s(1811);function Ud(e,t,i,r,o){var s=this;void 0===i&&(i=!1),me.c.driveItemStartTime=(0,v.a)(),(0,v.l)("driveItemStartTime"),Rd||(Rd=new Map);var a=Rd.get(e);if(!i&&a&&a.promise&&(!a.expiryTime||a.expiryTime>new Date))return me.c.driveItemEndTime=(0,v.a)(),(0,v.l)("driveItemEndTime"),null==r||r.ULS.sendTraceTag(553726288,f.W.zn,p.G.Info,"GetDriveItem: Returning drive item from the cache"),a.promise;null==r||r.ULS.sendTraceTag(553726289,f.W.zn,p.G.Info,"GetDriveItem: Invalidating the cache"),Rd.delete(e),null==r||r.ULS.sendTraceTag(546182045,f.W.zn,p.G.Info,"GetDriveItem: About to make the fetch call to get drive item");var c=e,u={method:Hd.hx.Get,headers:t.headers};if((0,T.dt)(T.Fh.FeatureGate_BypassOPTIONSCall,o,r),o){c=e.concat("&ump=1");var l=function(e){var t=(0,Od.c)(),i=[];return i.push("--".concat(t)),void 0!==e&&Object.entries(e).forEach((function(e){var t=(0,n.CR)(e,2),r=t[0],o=t[1];void 0!==o&&i.push("".concat(r,": ").concat(o))})),i.push("X-HTTP-Method-Override: GET"),i.push("\r\n--".concat(t,"--")),{body:i.join("\r\n"),headers:{"Content-Type":"multipart/form-data;boundary=".concat(t)}}}(t.headers),d=l.body,h=l.headers;u={method:Hd.hx.Post,headers:h,body:d},null==r||r.ULS.sendTraceTag(508961629,f.W.zn,p.G.Info,"GetDriveItem: POST request to get drive item: content-length : ".concat(d.length))}var m=fetch(c,u).catch((function(e){return Promise.reject({api:"getItem",failure:e,message:"Fetch call failed",retry:!0})})).then((function(t){return(0,n.mG)(s,void 0,void 0,(function(){var i,o,s,a,c,u,l,d,h,v;return(0,n.Jh)(this,(function(g){switch(g.label){case 0:if(200===t.status)return i=t.json().then((function(e){return e||Promise.reject({api:"getItem",status:t.status,message:"Ok httpStatus, invalid response"})})),o=new Map,a=null===(c=null==t?void 0:t.headers)||void 0===c?void 0:c.get("SPRequestGuid"),me.c.spRequestGuid=null!=a?a:void 0,o.set("SPRequestGuid",a),null==r||r.ULS.sendTraceTag(554964099,f.W.zn,p.G.Info,"GetDriveItem:  [VroomResponseHeaders: ".concat(JSON.stringify(o),"]")),Rd.set(e,{promise:m,expiryTime:(w=new Date,new Date(w.getFullYear(),w.getMonth(),w.getDate(),w.getHours()+24,w.getMinutes(),w.getSeconds(),w.getMilliseconds()))}),[2,i];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,t.json()];case 2:return s=g.sent(),a=null===(u=null==t?void 0:t.headers)||void 0===u?void 0:u.get("SPRequestGuid"),me.c.spRequestGuid=null!=a?a:void 0,[2,Promise.reject((0,n.pi)({api:"getItem",SPRequestGuid:a,status:t.status,errorCode:null===(l=null==s?void 0:s.error)||void 0===l?void 0:l.code,innerErrorCode:null===(h=null===(d=null==s?void 0:s.error)||void 0===d?void 0:d.innerError)||void 0===h?void 0:h.code,message:null===(v=null==s?void 0:s.error)||void 0===v?void 0:v.message,redirectLocation:(null==s?void 0:s.error)?null==s?void 0:s.error["@error.redirectLocation"]:void 0},Md(t)))];case 3:return g.sent(),[2,Promise.reject({api:"getItem",status:t.status,message:"request failed, could not retrieve error object."})];case 4:return[2]}var w}))}))})).finally((function(){me.c.driveItemEndTime=(0,v.a)(),(0,v.l)("driveItemEndTime")}));return m}function Md(e){var t,i,r,o=null===(r=null==e?void 0:e.headers)||void 0===r?void 0:r.get("www-authenticate"),s=void 0,a=void 0;if(o){var c=o.split(",");if(c)try{for(var u=(0,n.XA)(c),l=u.next();!l.done;l=u.next()){var d=l.value,h=d&&d.trim();h&&h.startsWith("error=")?s=h.split('"')[1]:h&&h.startsWith("claims=")&&(a=[h.split('"')[1]])}}catch(e){t={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(t)throw t.error}}}return{claimsError:s,claims:a}}var Dd="getItemFromWac",Fd="x-behind-service-response-status",xd="GetDriveItem",qd=new Map,Bd="owlfc";function Ld(e,t,i){return(0,n.mG)(this,void 0,void 0,(function(){var r;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:Nd=(0,v.a)(),qd.set("StartTime",Nd.toString()),i||null==t||t.ULS.sendTraceTag(526951836,f.W.zn,p.G.Info,"GetDriveItem: Health object not initialized"),null==i||i.recordKpiUsage(xd,S.o.FailureBased,Bd,qd),qd.delete("StartTime"),me.c.driveItemFromWacStartTime=(0,v.a)(),(0,v.l)("driveItemFromWacStartTime"),n.label=1;case 1:return n.trys.push([1,3,4,5]),null==t||t.ULS.sendTraceTag(523867683,f.W.zn,p.G.Info,"GetDriveItem: About to make the fetch call to get drive item"),[4,fetch(e.url,{method:e.method,headers:e.headers,body:JSON.stringify(e.body)})];case 2:return[2,Wd(n.sent(),t,i)];case 3:return r=n.sent(),Pd=(0,v.a)(),qd.set("DriveItemError",JSON.stringify(r)),qd.set("FailureTime",Pd.toString()),null==i||i.recordKpiFailure(xd,"GetDriveItemFromHootFailed",!1,!1,{durationMs:Pd-Nd,extendedProperties:qd}),[2,Promise.reject({api:Dd,failure:r,message:"Failed to post request to Hoot"})];case 4:return me.c.driveItemFromWacEndTime=(0,v.a)(),(0,v.l)("driveItemFromWacEndTime"),[7];case 5:return[2]}}))}))}function Wd(e,t,i){var r,o,s;return(0,n.mG)(this,void 0,void 0,(function(){var a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(e.status===At.W.OK)return[2,jd(e,t)];Pd=(0,v.a)(),qd.set("FailureTime",Pd.toString()),null==i||i.recordKpiFailure(xd,"WacHootServiceNotAvailable",!1,!0,{durationMs:Pd-Nd,extendedProperties:qd}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.json()];case 2:return a=n.sent(),c=null===(r=null==e?void 0:e.headers)||void 0===r?void 0:r.get("SPRequestGuid"),me.c.spRequestGuid=null!=c?c:void 0,[2,Promise.reject({api:Dd,SPRequestGuid:c,status:e.status,errorCode:null===(o=null==a?void 0:a.error)||void 0===o?void 0:o.code,message:null===(s=null==a?void 0:a.error)||void 0===s?void 0:s.message})];case 3:return n.sent(),[2,Promise.reject({api:Dd,status:e.status,message:"Request to Hoot failed, could not reach out Hoot for retrieving object."})];case 4:return[2]}}))}))}function jd(e,t){var i,r,o=null===(i=null==e?void 0:e.headers)||void 0===i?void 0:i.get(Fd),s=o?parseInt(o,10):At.W.InternalServiceError,a=new Map,c=null===(r=null==e?void 0:e.headers)||void 0===r?void 0:r.get("SPRequestGuid");return me.c.spRequestGuid=null!=c?c:void 0,a.set("SPRequestGuid",c),null==t||t.ULS.sendTraceTag(526951837,f.W.zn,p.G.Info,"GetDriveItemFromWac: [VroomResponseHeaders: ".concat(JSON.stringify(a),"]. The http response status code from downstream service to Hoot: ").concat(s.toString())),s===At.W.OK?e.json().then((function(t){return t||Promise.reject({api:Dd,SPRequestGuid:c,status:e.status,message:"Ok httpStatus, invalid response"})})):Promise.reject((0,n.pi)({api:Dd,SPRequestGuid:c,status:e.status,sharePointCallStatus:s,message:"Post request to Hoot succeed, Hoot failed to retrieve object from downstream service."},Md(e)))}var Kd="Failed to parse stringified drive item.";function Gd(e,t,i,r,o,s,a,c){return(0,n.mG)(this,void 0,void 0,(function(){var u,l,d,h,g,w,y,C,S,k;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return u={docBootInfo:e,essOptions:t},l=(0,m.XQ)(r,o),[4,yd(i,o,s,a)];case 1:if(!(d=n.sent()))return[2,Promise.reject("Failed to fetch necessary Wac token.")];g=$d(h={accept:"application/json"},u,l,o,d),n.label=2;case 2:return n.trys.push([2,4,,8]),(0,v.l)(_.OwlGetDriveItemStart),[4,Ld(g,a,c)];case 3:if(S=n.sent(),(0,v.l)(_.OwlGetDriveItemEnd),!(k=zd(S,a)))throw new SyntaxError(Kd);return[2,k];case 4:return(w=n.sent())instanceof SyntaxError||null==a||a.ULS.sendTraceTag(508155348,f.W.zn,p.G.Warning,"Failed to get vroom data from Hoot. [Error: ".concat(JSON.stringify(w),"] [Reason: ").concat(null==w?void 0:w.failure,"]")),w&&401===w.sharePointCallStatus&&"insufficient_claims"===w.claimsError&&w.claims?(null==a||a.ULS.sendTraceTag(508155347,f.W.zn,p.G.Warning,"Hoot Vroom call failed with claims challenge, retrying with claims."),[4,Ld($d(h,u,l,o,d),a,c)]):[3,6];case 5:return y=n.sent(),(C=zd(y,a))?[2,C]:[2,Promise.reject(Kd)];case 6:return[4,Ld(g,a,c)];case 7:return S=n.sent(),(k=zd(S,a))?[2,k]:[2,Promise.reject(Kd)];case 8:return[2]}}))}))}function $d(e,t,i,r,o){var s,a={Authorization:null!==(s=Jd(o).Authorization)&&void 0!==s?s:"",SessionId:r},c=(0,n.pi)((0,n.pi)({},t),{optionsHttpRequestHeaders:a});return{url:i,method:Hd.hx.Post,headers:e,body:c}}function zd(e,t){try{return JSON.parse(e.graphDriveItem)}catch(e){return null==t||t.ULS.sendTraceTag(508155346,f.W.zn,p.G.Error,"Failed to parse Vroom response from JSON string. [".concat(e.name,": ").concat(e.message,"]")),null}}function Jd(e,t){var n=null!=t?t:{};return e?(n.Authorization="Bearer ".concat(e).trim(),n):n}var Vd=s(5506);function Qd(e){if(e&&e.length){if(e.match(ge.pK)||e.match(ge.XU))return"OneDrive";if(e.match(ge.VJ))return"SharePoint";if(e.match(ge.JK))return"Graph"}}var Xd=function(e){return"action=".concat(e)},Yd=function(e){return(null==e?void 0:e.isESSEnabled)&&(null==e?void 0:e.wacDataCenter)?[Zd(null==e?void 0:e.wacDataCenter),eh(null==e?void 0:e.sessionId),th(null==e?void 0:e.hostCorrelationId)]:[]},Zd=function(e){return e?"WacDataCenter=".concat(e):void 0},eh=function(e){return e?"usid=".concat(e):void 0},th=function(e){return e?"hid=".concat(e):void 0},nh=function(e){return e&&e.length?"$select="+e.join(","):void 0};function ih(e){return(0,Vd.sm)(e,{accept:"application/json",prefer:"allow-zerobyte"})}function rh(e,t,i,r,o,s,a,c){return void 0===o&&(o=!1),void 0===c&&(c=ih),(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return e?[2,t(i,o,r,void 0,!0).then(c).then((function(t){return Ud(e,{headers:t},o,s,a)})).catch((function(n){return null==s||s.ULS.sendTraceTag(512255580,f.W.zn,p.G.Warning,"GetDriveItemWithUrl: error when trying to getDriveItem: ".concat(n)),n&&401===n.status&&"insufficient_claims"===n.claimsError&&"authChallengeRequired"===n.innerErrorCode&&n.claims?(null==s||s.ULS.sendTraceTag(523076960,f.W.zn,p.G.Warning,"GetDriveItemWithUrl: vroom call failed with claims challenge. Retry with claims"),t(i,o,r,void 0,!0,n.claims).then(c).then((function(t){return Ud(e,{headers:t},o,s,a)}))):Promise.reject(n)}))]:[2,Promise.reject("No api endpoint given")]}))}))}function oh(e){var t={accept:"application/json",prefer:"redeemSharingLink,allow-zerobyte,manualRedirect"};return(0,Vd.sm)(e,t),t}var sh,ah=function(e){return e?"expand=thumbnails":""};function ch(e,t,i,r,o,s,a,c,u){void 0===r&&(r=!1),void 0===o&&(o="open"),void 0===s&&(s=!1);var l=i.inMockMode,d=i.getAccessToken,h=function(e,t){try{null==t||t.ULS.sendTraceTag(541870043,f.W.zn,p.G.Info,"getSharesUrl: Start constructing shares Url");for(var n=e.replace(/[,@+$#]/g,(function(e){return encodeURIComponent(e)})),i=window.btoa((s=encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})),a=void 0,(a=s)&&(a=a.replace(/#/g,"%23")),a)),r=i.length-1;"="===i.charAt(r);)--r;var o=i.slice(0,r+1).replace(/\+/g,"-").replace(/\//g,"_");return"shares/u!".concat(o,"/driveItem")}catch(e){return void(null==t||t.ULS.sendTraceTag(541872152,f.W.zn,p.G.Error,"getSharesUrl: Failed to get Share Url. ".concat(e)))}var s,a}(e,a);if(!h)return Promise.reject("No shareUrl");var v=function(e,t,n){var i,r=t.isConsumer,o=t.oneDriveResourceId,s=new URL(e);if(s&&s.protocol&&s.host){var a=r?o:"".concat(s.protocol,"//").concat(s.host),c=r?function(e){return e.inMockMode?e.officeHomeApiRoot:e.oneDriveConsumerApi}(t):function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var r=t.inMockMode?t.officeHomeApiRoot:e;return"".concat(r,n?"/_api":i?"/_api/v2.1":"/_api/v2.0")}(a||"",t),u=r?"OneDrive":null!==(i=Qd(a||""))&&void 0!==i?i:"None";if(a&&c&&u)return{baseUrl:c,tokenType:u,resourceUrl:a,hostname:s.hostname};null==n||n.ULS.sendTraceTag(542492316,f.W.zn,p.G.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!a,"][InvalidBaseUrl: ").concat(!c,"][InvalidTokenType: ").concat(!u,"]"))}else null==n||n.ULS.sendTraceTag(542492315,f.W.zn,p.G.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!s,"][InvalidProtocol: ").concat(!(null==s?void 0:s.protocol),"][Invalidhost: ").concat(!(null==s?void 0:s.host),"]"))}(e,i,a);if(!v)return Promise.reject("No apiInfo");var m=new Date;m.setSeconds(0,0);var g=(0,n.ev)([nh(t),Xd(o),ah(s)],(0,n.CR)(Yd(c)),!1).filter((function(e){return!!e})).join("&"),w=l?"shares?itemUrl=".concat(encodeURIComponent(h),"&currentDate=").concat(m.toISOString()):"".concat(h,"?").concat(g);return rh("".concat(v.baseUrl,"/").concat(w),d,v.tokenType,v.resourceUrl,r,a,u,oh)}function uh(e,t,i,r,o,s,a,c,u){var l;void 0===r&&(r=!1),void 0===o&&(o="open");var d=e.driveId,h=e.docId,v=e.baseUrl,g=e.docUrl;if(!d||!h)return Promise.reject("Not enough document information was given to retrieve the item");var w,y,_=(0,n.ev)([nh(t),Xd(o)],(0,n.CR)(Yd(c)),!1).filter((function(e){return!!e})).join("&"),C=function(e){if(!e)return null;var t=new URL(e);return t.protocol+"//"+t.host}(null!=v?v:g);C?(y=C,w="".concat(v||C,"/_api/v2.0"),null==a||a.ULS.sendTraceTag(543958855,f.W.zn,p.G.Info,"making vroom service call with driveId+docId")):(y=(0,m.A8)(s),w="".concat(y,"/v1.0"),null==a||a.ULS.sendTraceTag(543958856,f.W.zn,p.G.Info,"making graph service call with driveId+docId"));var S="".concat(w,"/drives/").concat(encodeURIComponent(d),"/items/").concat(encodeURIComponent(h),"/?").concat(_),k=null!==(l=Qd(y))&&void 0!==l?l:"None";return rh(S,i.getAccessToken,k,y,r,a,u)}function lh(e){var t={accept:"application/json",prefer:"allow-zerobyte,manualRedirect"};return(0,Vd.sm)(e,t),t}function dh(e,t,i,r,o,s,a,c,u,l){var d;if(void 0===o&&(o=!1),void 0===s&&(s="open"),!e||!t)return Promise.reject("Not enough document information was given to retrieve the item");var h,f=new URL(t),p="".concat(f.protocol,"//").concat(f.host),v=(0,n.ev)([nh(i),Xd(s)],(0,n.CR)(Yd(c)),!1).filter((function(e){return!!e})).join("&");(0,T.dt)(T.Fh.FeatureGate_Vroom21SupportGate,u,a),me.c.isVroom21=u,h=u?"".concat(t,"/_api/v2.1/sites/root/items/").concat(encodeURIComponent(e),"/driveItem?").concat(v):"".concat(t,"/_api/v2.0/sites/root/items/").concat(encodeURIComponent(e),"/driveItem?").concat(v);var m=null!==(d=Qd(t))&&void 0!==d?d:"None";return rh(h,r.getAccessToken,m,p,o,a,l,lh)}var hh,fh,ph,vh,mh,gh,wh,yh,_h,Ch,Sh,kh,bh="e03a13ee-9730-4cae-8525-47559c8cf18a",Th="getItemFromWac";function Ah(e,t,i,r){var o={Authorization:(0,Vd.sm)(r).Authorization,SessionId:i},s=(0,n.pi)((0,n.pi)({},t),{optionsHttpRequestHeaders:o});return{url:sh,method:Hd.hx.Post,headers:e,body:s}}function Ih(e,t){if(e&&e.KMSI){var n={token:t,expiryTime:e.wacTokenExpTime};null==we||we.setItem(bh,JSON.stringify(n))}}function Eh(e,t){if(e)try{return JSON.parse(e.graphDriveItem)}catch(e){null==t||t.ULS.sendTraceTag(520439698,f.W.zn,p.G.Error,"GetDriveItemFromWacWithUrl: Failed to parse vroom response from string to JSON. [Error: ".concat(JSON.stringify(e),"]"))}return Promise.reject({api:Th,message:"Failed to parse response data from string to JSON due to invalid data or format"})}var Rh,Nh,Ph=!1,Hh=!1,Oh=!1,Uh="owl-container",Mh="PrebootDocumentOpen",Dh="owlfc";function Fh(e){var t,n,i;if(!(null===(t=null==e?void 0:e.clientVersion)||void 0===t?void 0:t.trim()))throw new Error("invalid clientVersion");if(!e.exposure||e.exposure<=0||e.exposure>100)throw new Error("invalid exposure ("+(null!==(n=e.exposure)&&void 0!==n?n:"undefined")+")");e.wiseEnvironment=null===(i=e.wiseEnvironment)||void 0===i?void 0:i.toLocaleUpperCase(),hh=e}function xh(e){var t;return null!==(t=document.getElementById(Uh))&&void 0!==t?t:Wh(e,Uh)}function qh(){if(hh)return hh.clientVersion;null==wh||wh.ULS.sendTraceTag(508060617,f.W.zn,p.G.Error,"You must call initPackage before calling getOwlVersion")}function Bh(e){switch(e){case"Graph":return(0,m.A8)(kh);case"OneDrive":return(0,m.Y6)();case"SharePoint":return(0,m.tf)();default:return""}}function Lh(e){var t;if(e){var n;try{n=new URL(e)}catch(e){return}return null!==(t=new URLSearchParams(n.search).get("nav"))&&void 0!==t?t:void 0}}function Wh(e,t){var n=document.createElement("div");return n.id=t,e.appendChild(n)}function jh(e){return fh?fh(e):Promise.reject("endSession not defined")}function Kh(e){return ph?ph(e):(null==wh||wh.ULS.sendTraceTag(555872272,f.W.zn,p.G.Error,"hostAccessibilityLoopComplete no defined"),!1)}function Gh(){if(vh)return null==wh||wh.ULS.sendTraceTag(508355844,f.W.zn,p.G.Info,"Trying to get hostGetClientUrl."),void vh();null==wh||wh.ULS.sendTraceTag(526152082,f.W.zn,p.G.Error,"hostGetClientUrl not defined")}function $h(){if(mh)return null==wh||wh.ULS.sendTraceTag(508352272,f.W.zn,p.G.Info,"Trying to get WebUrl"),void mh();null==wh||wh.ULS.sendTraceTag(508352271,f.W.zn,p.G.Error,"hostGetWebUrl not defined")}function zh(e){var t,i,r,o,a=this,c=(0,v.a)();B(),(0,v.l)([_.OwlStart,"packageEntryTime"]);var u=e.documentIdentifier,l=e.sessionConfig,d=e.uiHostConfig,h=e.getAuthToken,w=e.eventHandlers,y=e.container;kh=null!==(t=null==hh?void 0:hh.wiseEnvironment)&&void 0!==t?t:l.wiseEnvironment;var C=(0,n.pi)((0,n.pi)({},u),{fileType:l.fileType,wdOrigin:null!==(i=l.sessionOrigin)&&void 0!==i?i:"TEAMS.UNIFIEDUIHOST.OPEN",wdValue:l.wdValue,uiCulture:l.uiCulture,dataCulture:l.dataCulture,puid:l.puid,clickTime:l.clickTime,isNewFile:l.isNewFile,navId:Lh(null!==(r=u.shareUrl)&&void 0!==r?r:u.docUrl),templateId:u.templateId,intent:null!==(o=l.intent)&&void 0!==o?o:"open"}),A=Me(C),I=l.sessionId||A||(0,g.n)()[0];l.bootDiagnostics=l.bootDiagnostics||{};var E=l.bootDiagnostics.ringId;l.bootDiagnostics.packageEntryTime=l.bootDiagnostics.packageEntryTime||c,wh=new b.G2(I,kh).logger,l.logger=wh;var R=I===A,P=null==l?void 0:l.isNewFile;if(l.bootDiagnostics.isPrebooted=R,function(e,t,n,i,r,o){var s,a,c,u,l=e.wiseEnvironment;e.health=null!==(s=e.health)&&void 0!==s?s:tn(t,l,e.fileType,e.uiCulture,e.puid,e.tenantId,e.hostCorrelationId,null==o?void 0:o.exposure,null==o?void 0:o.clientVersion,e.isSynthetic,n.uiHostName,n.uiHostIntegrationType,e.sessionOrigin,i,r),e.hostClientType&&(null===(a=e.health)||void 0===a||a.addOrUpdatePartCDimension("HostClientType",e.hostClientType)),e.teamType&&(null===(c=e.health)||void 0===c||c.addOrUpdatePartCDimension("TeamType",e.teamType)),e.isPopOut&&(null===(u=e.health)||void 0===u||u.addOrUpdatePartCDimension("IsPopOut",(!!e.isPopOut).toString()))}(l,I,d,E,P,hh),yh=l.health,N.checkOwlFrameCookie(kh,d.featureGates),N.isOwlFrameBootEnabled(d.featureGates,wh)&&(Hh=!0,cf(kh,l.fileType,y,!0,I).then((function(t){(0,v.l)(_.OwlCreateFrameEnd),t.status===Yh.Success?(e.sessionConfig.initPackageParams=hh,(0,v.l)(_.OwlBootAppMessageSend),null==ef||ef.sendMessage({id:O.BootApplication,data:L(e)}),null==wh||wh.ULS.sendTraceTag(508432458,f.W.zn,p.G.Info,"CreateOwlFrame: Succeeded and now booting document")):(null==yh||yh.recordQosError(me.DG.QosError_OwlFrameCreationFailure,[me.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==wh||wh.ULS.sendTraceTag(508432456,f.W.zn,p.G.Error,"CreateOwlFrame: Failed to create frame"))})).catch((function(e){null==yh||yh.recordQosError(me.DG.QosError_OwlFrameCreationFailure,[me.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(e)]])}),null==wh||wh.ULS.sendTraceTag(508432455,f.W.zn,p.G.Error,"CreateOwlFrame: Exception: ".concat(e))})),N.isOwlFrameBootEnabled(d.featureGates,wh))){var U=function(e,t){var i=this;return null==ef||ef.registerHandler(H.GetAuthToken,(function(t){return(0,n.mG)(i,void 0,void 0,(function(){var i,r,o,s,a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),o=t.data,s=o.resourceUrl,a=o.claims,[4,e.getAuthToken(s,a)];case 1:return i=n.sent(),[3,4];case 2:return c=n.sent(),r=c,[3,4];case 3:return null==ef||ef.sendMessage({id:O.GetAuthTokenResponse,data:{token:i,error:r,correlationId:t.correlationId}}),[7];case 4:return[2]}}))}))})),fe(e.eventHandlers,t,e.sessionConfig.wiseEnvironment,e.uiHostConfig,e.sessionConfig.logger)}(e,C),M=uf();return fh=M.endSession,ph=M.hostAccessibilityLoopComplete,vh=M.hostGetClientUrl,mh=M.hostGetWebUrl,(0,n.pi)((0,n.pi)({},M),{sessionEndObservable:U})}if(Ch=(0,T.vJ)(T.Fh.FeatureGate_EcsHootGate,d.featureGates),N.isOwlFrame&&Ch&&!l.isAnonymous&&(l.loginHint||l.upn)&&(Nh||(Nh=_d(l,wh))),hh||(hh=l.initPackageParams),Sh=function(e,t){switch(e){case k.T.PowerPoint:return(0,T.vJ)(T.Fh.FeatureGate_Vroom21SupportGate,t.featureGates);case k.T.Word:return(0,T.vJ)(T.Fh.FeatureGate_Vroom21ForWord,t.featureGates);case k.T.Excel:return(0,T.vJ)(T.Fh.FeatureGate_Vroom21ForExcel,t.featureGates);default:return!1}}(l.fileType,d),Ph=(0,T.vJ)(T.Fh.FeatureGate_iOSNullCheckFeatureGate,d.featureGates),Rh=(0,T.vJ)(T.Fh.FeatureGate_BypassOPTIONSCall,d.featureGates),Oh=(0,T.vJ)(T.Fh.FeatureGate_ManualRedirectOnTenantChangeGate,d.featureGates),R){var D=new Map;D.set("StartTime",(new Date).toUTCString()),De(C,I),null==yh||yh.recordKpiUsage(Mh,S.o.FailureBased,Dh,D)}if(_h=xh(y),u.docUrl||u.driveId&&u.docId||u.shareUrl||u.baseUrl&&u.fileId){var F,x=Vh(h),q={correlationId:l.hostCorrelationId,officeHomeApiRoot:"",getAccessToken:x},W=(0,n.pi)((0,n.pi)({},l),{shareApiEndpoint:(0,m.PO)(kh),metaUiHostVersion:bd.J.version,logger:wh,sessionId:I}),j={isESSEnabled:W.isESSEnabled,wacDataCenter:W.isESSEnabled?Id(l.fileType):void 0,sessionId:W.sessionId,hostCorrelationId:W.hostCorrelationId};(0,T.dt)(T.Fh.FeatureGate_EcsHootGate,Ch,wh),Ch&&N.isOwlFrame?(null==wh||wh.ULS.sendTraceTag(520757324,f.W.zn,p.G.Info,"FetchItemFromWac: Hoot endpoint enabled in ECS, fetch driveItem from Wac"),F=Xh(C)?Qh(q,kh,j,Sh,Rh):function(e,t,i,r){return function(o,s,a,c){return void 0===s&&(s=!1),void 0===a&&(a=!1),null==c||c.ULS.sendTraceTag(526951838,f.W.zn,p.G.Info,"Item to be fetched through wac service"),function(e,t,i,r,o,s,a){var c=this,u={docBootInfo:i,essOptions:o};return sh=(0,m.XQ)(r,t),function(e,t){return(0,n.mG)(this,void 0,void 0,(function(){var i,r;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(i=null==we?void 0:we.getItem(bh))try{if((r=JSON.parse(i))&&r.token&&r.expiryTime&&parseInt(r.expiryTime,10)>(new Date).getTime()/1e3)return null==t||t.ULS.sendTraceTag(524821017,f.W.zn,p.G.Info,"GetDriveItemFromWacWithUrl: Fetched valid access token from the windows local storage cache"),[2,r.token];null==we||we.removeItem(bh)}catch(e){null==we||we.removeItem(bh)}return[4,e("None",!0,bh,void 0,!0)];case 1:return[2,n.sent()]}}))}))}(e,s).then((function(i){var r={accept:"application/json"},o=Ah(r,u,t,i);return Ld(o,s,a).then((function(e){return Ih(e,i),Eh(e,s)})).catch((function(l){return(0,n.mG)(c,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return null==s||s.ULS.sendTraceTag(526471961,f.W.zn,p.G.Error,"GetDriveItemFromWacWithUrl: Retrying getDriveItemFromWac. [Error: ".concat(JSON.stringify(l),"][FailureReason: ").concat(null==l?void 0:l.failure,"]")),l&&401===l.sharePointCallStatus&&"insufficient_claims"===l.claimsError&&l.claims?(null==s||s.ULS.sendTraceTag(512492100,f.W.zn,p.G.Warning,"GetDriveItemFromWacWithUrl: Wac call vroom failed with claims challenge. Retry with claims"),[2,e("None",!0,bh,void 0,!0,l.claims).then((function(e){return Ld(Ah(r,u,t,e),s,a).then((function(t){return Ih(t,e),Eh(t,s)}))}))]):[2,Ld(o,s,a).then((function(e){return Ih(e,i),Eh(e,s)}))]}))}))}))}))}(e.getAccessToken,t,o,i,r,c,yh)}}(q,I,kh,j)):(null==wh||wh.ULS.sendTraceTag(520757325,f.W.zn,p.G.Info,"FetchItemFromVroom: Hoot endpoint disabled in ECS, fetch driveItem from Vroom"),F=Qh(q,kh,j,Sh,Rh));var K={documentBootInfo:C,fetchItemFromNetwork:F,fetchAccessToken:x,openShareControl:function(e){return(0,n.mG)(a,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,s.e(4630).then(s.bind(s,8798))];case 1:return[2,t.sent().openVanillaJsShareControl(e,{},_h)]}}))}))},sessionConfig:W,onBootComplete:w.onBootComplete,onBootFailure:w.onBootFailure,onReturnFocus:w.onReturnFocus,onDocumentClose:function(){w.onDocumentClose&&w.onDocumentClose(),null==yh||yh.shutdown()},onSuccessNotification:w.onSuccessNotification,onOpenInMobileApp:w.onOpenInMobileApp,onRename:w.onRename,uiHostConfig:d,createDocument:function(e){return(0,n.mG)(a,void 0,void 0,(function(){var t,i;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return[4,s.e(4630).then(s.bind(s,8520))];case 1:return t=n.sent(),i={fileType:e.fileType,wdOrigin:"TEAMS.UNIFIEDUIHOST.NEW",uiCulture:l.uiCulture,dataCulture:l.dataCulture,puid:l.puid,clickTime:e.clickTime,isNewFile:!0},[2,t.createNewDocument(q,i,e,kh,wh)]}}))}))},container:y};return Jh(K)}null==wh||wh.ULS.sendTraceTag(576217559,f.W.zn,p.G.Error,"No document url is found. Exit")}function Jh(e){var t,i,r,o,s,a,c,u,l=this,d=(0,v.a)();(0,v.l)(_.OwlWithCustomFunctionsStart),B();var h=null!==(t=null==hh?void 0:hh.wiseEnvironment)&&void 0!==t?t:e.sessionConfig.wiseEnvironment,m=!!e.sessionConfig.health,w=function(e,t){var i,r,o,s,a,c,u,l,d,h,f,p=null!==(i=null==t?void 0:t.wiseEnvironment)&&void 0!==i?i:e.sessionConfig.wiseEnvironment,v=e.sessionConfig.sessionId||(0,g.n)();(e.sessionConfig.logger||(e.sessionConfig.logger=new b.G2(v,p).logger),e.sessionConfig.owlRollout="".concat(p,".").concat(null==t?void 0:t.exposure),e.sessionConfig.owlVersion=null==t?void 0:t.clientVersion,e.sessionConfig.health)||(f="string"==typeof v?v:(0,n.CR)(v,1)[0],e.sessionConfig.health=tn(f,p,null===(r=e.documentBootInfo)||void 0===r?void 0:r.fileType,null===(o=e.documentBootInfo)||void 0===o?void 0:o.uiCulture,null===(s=e.documentBootInfo)||void 0===s?void 0:s.puid,e.sessionConfig.tenantId,e.sessionConfig.hostCorrelationId,null==t?void 0:t.exposure,null==t?void 0:t.clientVersion,e.sessionConfig.isSynthetic,null===(a=e.uiHostConfig)||void 0===a?void 0:a.uiHostName,null===(c=e.uiHostConfig)||void 0===c?void 0:c.uiHostIntegrationType,null===(u=e.documentBootInfo)||void 0===u?void 0:u.wdOrigin,null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.ringId,null===(d=e.documentBootInfo)||void 0===d?void 0:d.isNewFile,null===(h=e.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.isOdcMigrated));return e}(e,hh),y=null!==(i=w.sessionConfig.sessionId)&&void 0!==i?i:(0,g.n)()[0];e.sessionConfig.sessionId=y,N.checkOwlFrameCookie(h,null===(r=e.uiHostConfig)||void 0===r?void 0:r.featureGates),Ch||(Ch=(0,T.vJ)(T.Fh.FeatureGate_EcsHootGate,null===(o=w.uiHostConfig)||void 0===o?void 0:o.featureGates)),N.isOwlFrame&&Ch&&!e.sessionConfig.isAnonymous&&(e.sessionConfig.loginHint||e.sessionConfig.upn)&&(Nh||(Nh=_d(e.sessionConfig,wh)),Xh(e.documentBootInfo)||(e.fetchItemFromNetwork=function(t,n,i,r){return void 0===n&&(n=!1),void 0===i&&(i=!1),Gd(t,{isESSEnabled:e.sessionConfig.isESSEnabled,wacDataCenter:e.sessionConfig.isESSEnabled?Id(e.documentBootInfo.fileType):void 0,sessionId:e.sessionConfig.sessionId,hostCorrelationId:e.sessionConfig.hostCorrelationId},Nh,e.sessionConfig.wiseEnvironment,y,e.sessionConfig.upn,r,yh)})),m||(yh=w.sessionConfig.health),wh||(wh=w.sessionConfig.logger);var C=(0,T.vJ)(T.Fh.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled,null===(s=e.uiHostConfig)||void 0===s?void 0:s.featureGates);if(null==wh||wh.ULS.sendTraceTag(508121308,f.W.zn,p.G.Important,"OAuth Feature Gate: ".concat(C?"Enabled":"Disabled")),function(e,t){var n,i,r,o;e.sessionConfig.bootDiagnostics=e.sessionConfig.bootDiagnostics||{},e.sessionConfig.bootDiagnostics.packageEntryTime=e.sessionConfig.bootDiagnostics.packageEntryTime||t,e.sessionConfig.bootDiagnostics.perfNavigationTiming=e.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,b.pb)(Ph),N.isOwlFrameExperimentEnabled()&&N.isOwlFrameBootEnabled()&&(e.sessionConfig.bootDiagnostics.legacyPerformanceData=e.sessionConfig.bootDiagnostics.legacyPerformanceData||{host:(0,b.vb)()},N.isOwlFrame&&(e.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming=e.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming||(0,b.pb)(Ph),e.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame=e.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame||(0,b.vb)())),e.sessionConfig.bootDiagnostics.loadManifestStartTime=e.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(n=null==hh?void 0:hh.owlBootstrapperDiagnostics)||void 0===n?void 0:n.loadManifestStartTime),e.sessionConfig.bootDiagnostics.loadManifestEndTime=e.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(i=null==hh?void 0:hh.owlBootstrapperDiagnostics)||void 0===i?void 0:i.loadManifestEndTime),e.sessionConfig.bootDiagnostics.loadOwlStartTime=e.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(r=null==hh?void 0:hh.owlBootstrapperDiagnostics)||void 0===r?void 0:r.loadOwlStartTime),e.sessionConfig.bootDiagnostics.loadOwlEndTime=e.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(o=null==hh?void 0:hh.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadOwlEndTime)}(w,d),!Hh&&N.isOwlFrameBootEnabled(null===(a=e.uiHostConfig)||void 0===a?void 0:a.featureGates,wh)&&(Hh=!0,cf(h,e.documentBootInfo.fileType,e.container,!0,y).then((function(t){return(0,n.mG)(l,void 0,void 0,(function(){var i,r,o;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return(0,v.l)(_.OwlCreateFrameEnd),t.status!==Yh.Success?[3,4]:(e.sessionConfig.initPackageParams=hh,(0,v.l)(_.OwlBootAppWithCustomFunctionsMessageSend),null!=ef?[3,1]:[3,3]);case 1:return r=(i=ef).sendMessage,o={id:O.BootApplicationWithCustomFunctions},[4,W(e)];case 2:r.apply(i,[(o.data=n.sent(),o)]),n.label=3;case 3:return null==wh||wh.ULS.sendTraceTag(508432454,f.W.zn,p.G.Info,"CreateOwlFrame: Succeeded and now booting document"),[3,5];case 4:null==yh||yh.recordQosError(me.DG.QosError_OwlFrameCreationFailure,[me.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==wh||wh.ULS.sendTraceTag(508432452,f.W.zn,p.G.Error,"CreateOwlFrame: Failed to create frame"),n.label=5;case 5:return[2]}}))}))})).catch((function(e){null==yh||yh.recordQosError(me.DG.QosError_OwlFrameCreationFailure,[me.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(e)]])}),null==wh||wh.ULS.sendTraceTag(508432451,f.W.zn,p.G.Error,"CreateOwlFrame: Exception: ".concat(e))})),N.isOwlFrameBootEnabled(null===(c=e.uiHostConfig)||void 0===c?void 0:c.featureGates,wh))){var S=function(e){var t=this,i=fe(e,e.documentBootInfo,e.sessionConfig.wiseEnvironment,e.uiHostConfig,e.sessionConfig.logger);return null==ef||ef.registerHandler(H.FetchItemFromNetwork,(function(i){return(0,n.mG)(t,void 0,void 0,(function(){var t,r,o,s,a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),o=i.data,s=o.docBootInfo,a=o.forceRefresh,c=o.zeroByte,[4,e.fetchItemFromNetwork(s,a,c)];case 1:return t=n.sent(),[3,4];case 2:return u=n.sent(),r=u,[3,4];case 3:return null==ef||ef.sendMessage({id:O.FetchItemFromNetworkResponse,data:{correlationId:i.correlationId,item:t,error:r}}),[7];case 4:return[2]}}))}))})),null==ef||ef.registerHandler(H.FetchAccessToken,(function(i){return(0,n.mG)(t,void 0,void 0,(function(){var t,r,o,s,a,c,u,l,d;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return t=i.data,r=t.tokenConsumer,o=t.forceFetch,s=t.resourceUrl,a=t.scope,c=t.isBoot,u=t.claims,l=t.silent,[4,e.fetchAccessToken(r,o,s,a,c,u,l)];case 1:return d=n.sent(),null==ef||ef.sendMessage({id:O.FetchAccessTokenResponse,data:{correlationId:i.correlationId,response:d}}),[2]}}))}))})),null==ef||ef.registerHandler(H.OpenShareControl,(function(i){return(0,n.mG)(t,void 0,void 0,(function(){var t,r,o;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return t=i.data,r=t.shareProps,o=t.isShareDialogueZoomEnabled,[4,e.openShareControl(r,o)];case 1:return n.sent(),null==ef||ef.sendMessage({id:O.OpenShareControlResponse,data:{correlationId:i.correlationId}}),[2]}}))}))})),null==ef||ef.registerHandler(H.CreateDocument,(function(i){return(0,n.mG)(t,void 0,void 0,(function(){var t,r,o,s,a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return t=i.data,r=t.createNewInfo,o=t.template,[4,null===(a=e.createDocument)||void 0===a?void 0:a.call(e,r,o)];case 1:return(s=n.sent())?null==ef||ef.sendMessage({id:O.CreateDocumentResponse,data:{correlationId:i.correlationId,url:s}}):null==ef||ef.sendMessage({id:O.CreateDocumentResponse,data:{correlationId:i.correlationId,error:"Failed to create document"}}),[2]}}))}))})),null==ef||ef.registerHandler(H.UserActivity,(function(t){var n;return null===(n=e.onUserActivity)||void 0===n?void 0:n.call(e)})),null==ef||ef.registerHandler(H.CAAEMessage,(function(t){var n;return null===(n=e.onCAAEMessage)||void 0===n?void 0:n.call(e,t.data)})),null==ef||ef.registerHandler(H.UserAccess,(function(t){var n;return null===(n=e.onUserAccess)||void 0===n?void 0:n.call(e,t.data)})),null==ef||ef.registerHandler(H.MoveToFolder,(function(t){var n;return null===(n=e.onMoveToFolder)||void 0===n?void 0:n.call(e,t.data)})),null==ef||ef.registerHandler(H.SharedFilePicker,(function(t){var n;return null===(n=e.onSharedFilePicker)||void 0===n?void 0:n.call(e,t.data)})),null==ef||ef.registerHandler(H.Rename,(function(t){var n;return null===(n=e.onRename)||void 0===n?void 0:n.call(e,t.data.newName)})),null==ef||ef.registerHandler(H.FrameChange,(function(t){var n;return null===(n=e.onFrameChange)||void 0===n?void 0:n.call(e,t.data)})),null==ef||ef.registerHandler(H.InvokeSessionRefreshInfoPopupBlockedDialog,(function(t){var n;null===(n=e.invokeSessionRefreshInfoPopupBlockedDialog)||void 0===n||n.call(e,{visible:t.data.visible,handleRefresh:function(){return null==tf?void 0:tf.sendMessage({id:O.SessionRefreshInfoDialogHandleRefresh,data:{}})},handleCancel:function(){return null==tf?void 0:tf.sendMessage({id:O.SessionRefreshInfoDialogHandleCancel,data:{}})},onDismiss:function(){return null==tf?void 0:tf.sendMessage({id:O.SessionRefreshInfoDialogOnDismiss,data:{}})}})})),null==ef||ef.registerHandler(H.FileEmbed,(function(t){var n;return null===(n=e.onFileEmbed)||void 0===n?void 0:n.call(e)})),i}(e),k=uf();return fh=k.endSession,ph=k.hostAccessibilityLoopComplete,vh=k.hostGetClientUrl,mh=k.hostGetWebUrl,(0,n.pi)((0,n.pi)({},k),{sessionEndObservable:S})}var A=w.container;_h=xh(w.container),w.container=_h;var I=Me(w.documentBootInfo),E=y===I,R=w.onBootFailure;if(w.onBootFailure=function(e,t){var n,i,r,o=e.httpErrorCode,s=function(e){switch(e){case me.AU.li:case me.AU.di:return!1;default:return!0}}(e.wacErrorName),a=null!==(n=e.networkError)&&void 0!==n&&n;if(null==yh||yh.recordQosError(e.qosErrorName,["UnifiedUiHostBootstrappingFailed"],mt(o,a),s,!0,!0,{inStaging:null===(i=e.inStaging)||void 0===i||i,extendedProperties:St(e)}),E){var c=new Map;c.set("FailureTime",(new Date).toUTCString()),c.set("Error",e.error),t&&c.set("DocumentBootInfo",JSON.stringify(t)),o&&c.set("HttpErrorCode",o),null==yh||yh.recordKpiFailure(Mh,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,v.a)()-((null===(r=w.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.packageEntryTime)||d),extendedProperties:c})}R&&R(e,t),null==yh||yh.shutdown()},N.isOwlFrameExperimentEnabled(null===(u=w.uiHostConfig)||void 0===u?void 0:u.featureGates,wh)){var P=e.onBootComplete;e.onBootComplete=function(e,t){(function(e,t,i){return(0,n.mG)(this,void 0,void 0,(function(){var r,o,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),(0,v.l)(_.OwlCreateFrameStart),[4,cf(i.sessionConfig.wiseEnvironment,t,e,!1,i.sessionConfig.sessionId)];case 1:return r=n.sent(),(0,v.l)(_.OwlCreateFrameEnd),r.status===Yh.Success&&((0,v.l)(_.OwlTokenFetchingExperimentMessageSend),null==ef||ef.sendMessage({id:O.TokenFetchingExperiment,data:{bootParams:i}})),o=q({owlVersion:(null==hh?void 0:hh.clientVersion)||i.sessionConfig.owlVersion,wiseEnvironment:(null==hh?void 0:hh.wiseEnvironment)||i.sessionConfig.wiseEnvironment,exposure:null==hh?void 0:hh.exposure}).owlTelemetryData,null==wh||wh.ULS.sendTraceTag(508168084,f.W.zn,p.G.Important,"[Auth Token Experiment Data (Host)]: ".concat(o)),[3,4];case 2:return s=n.sent(),r={status:Yh.Error,error:"Caught unexpected exception: ".concat(s)},null==yh||yh.recordQosError(me.DG.QosError_OwlFrameCreationFailure,[me.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(s)]])}),[3,4];case 3:return D(),[7];case 4:return null==wh||wh.ULS.sendTraceTag(508168083,f.W.zn,p.G.Info,JSON.stringify(r)),[2]}}))}))})(w.container,w.documentBootInfo.fileType,w).catch((function(e){return null==wh?void 0:wh.ULS.sendTraceTag(508168085,f.W.zn,p.G.Error,"Caught unexpected error running HOOT experiment: ".concat(e))})),null==P||P(e,t)}}var U=Zt((0,n.pi)((0,n.pi)({},w),{initPackageParams:hh}));fh=U.endSession,ph=U.hostAccessibilityLoopComplete,vh=U.hostGetClientUrl,mh=U.hostGetWebUrl,gh=U.postFrameDiagnostics,N.isOwlFrame&&function(e,t,i,r,o,s){var a=this;null==tf||tf.registerHandler(O.EndSession,(function(t){return(0,n.mG)(a,void 0,void 0,(function(){var i,r,o;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,e()];case 1:return i=n.sent(),[3,4];case 2:return o=n.sent(),r=o,[3,4];case 3:return null==tf||tf.sendMessage({id:H.EndSessionResponse,data:{result:i,error:r,correlationId:t.correlationId}}),[7];case 4:return[2]}}))}))})),null==tf||tf.registerHandler(O.HostAccessibilityLoopComplete,(function(e){return t(e.data.navigateForward)})),null==tf||tf.registerHandler(O.GetClientUrl,(function(e){return i()})),null==tf||tf.registerHandler(O.GetWebUrl,(function(e){return r()})),null==tf||tf.registerHandler(O.GetAuthTokenResponse,nf.getHandler(O.GetAuthTokenResponse,de.Token)),null==tf||tf.registerHandler(O.FetchItemFromNetworkResponse,nf.getHandler(O.FetchItemFromNetworkResponse,de.Item)),null==tf||tf.registerHandler(O.FetchAccessTokenResponse,nf.getHandler(O.FetchAccessTokenResponse,de.Response)),null==tf||tf.registerHandler(O.OpenShareControlResponse,nf.getHandler(O.OpenShareControlResponse)),null==tf||tf.registerHandler(O.CreateDocumentResponse,nf.getHandler(O.CreateDocumentResponse,de.URL)),null==tf||tf.registerHandler(O.TelemetryData,(function(e){var t=e.data,i=t.context,r=t.hostData,a=t.frameData,c=function(e,t){var i,r=e[_.OwlStart]||e[_.OwlWithCustomFunctionsStart],o=(e[_.OwlBootAppMessageSend]||e[_.OwlBootAppWithCustomFunctionsMessageSend])-r,s=t[_.OwlBootAppMessageReceive]||t[_.OwlBootAppWithCustomFunctionsMessageReceive],a=t[_.OwlOnBootComplete];return{hostTime:o,frameTime:a-s,totalTime:a-r,owlPerformanceTimeline:(0,n.pi)((0,n.pi)((0,n.pi)({},e),t),((i={})[_.OwlStart]=r,i[_.OwlEnd]=a,i))}}(JSON.parse(r.owlTelemetryData),JSON.parse(a.owlTelemetryData));o&&o(c.owlPerformanceTimeline),null==s||s.ULS.sendTraceTag(508614159,f.W.zn,p.G.Important,i+", OwlFrame Telemetry Data: "+JSON.stringify(c)),null==s||s.ULS.sendTraceTag(508614158,f.W.zn,p.G.Important,i+", Boot Telemetry Data: "+JSON.stringify({hostBoot:r.bootTelemetryData,frameBoot:a.bootTelemetryData}))}))}(fh,ph,vh,mh,gh,wh);var M=function(e){var t=e.subscribe((function(e){var i,r;if(e&&(null===(i=w.uiHostConfig)||void 0===i?void 0:i.supportsInternalReboot)){var o=(0,g.n)(),s=new b.G2(o,h);w.sessionConfig.sessionId=s.sessionId,w.sessionConfig.logger=s.logger,w.sessionConfig.bootDiagnostics=(r=w.sessionConfig.bootDiagnostics,(0,T.dt)(T.Fh.FeatureGate_iOSNullCheckFeatureGate,Ph,wh),{tabsCacheHit:!0,packageEntryTime:(0,v.a)(),isTestMode:null==r?void 0:r.isTestMode,isPrebooted:!1,ringId:null==r?void 0:r.ringId,teamsContextStartTime:0,teamsContextEndTime:0,perfNavigationTiming:(0,b.pb)(Ph),owlFramePerfNavigationTiming:(0,b.pb)(Ph),meetingLiveDiagnostics:void 0}),w.sessionConfig.highContrastMode=e.theme,A&&_h&&_h.parentNode===A&&A.removeChild(_h),_h=Wh(A,Uh);var a=Zt((0,n.pi)((0,n.pi)({},w),{container:_h,documentBootInfo:e.documentBootInfo,initPackageParams:hh}));fh=a.endSession,ph=a.hostAccessibilityLoopComplete,vh=a.hostGetClientUrl,mh=a.hostGetWebUrl,t.unsubscribe(),M(a.sessionEndObservable)}else A&&_h&&_h.parentNode===A&&A.removeChild(_h),t.unsubscribe();null==yh||yh.shutdown()}))};return M(U.sessionEndObservable),N.isOwlFrame&&U.sessionEndObservable.subscribe((function(e){null==tf||tf.sendMessage({id:H.EndSessionObservable,data:{rebootInfo:e}})})),(0,v.l)([_.OwlEnd,_.OwlWithCustomFunctionsEnd]),U}function Vh(e){return function(t,n,i,r,o,s){return null==wh||wh.ULS.sendTraceTag(546182046,f.W.zn,p.G.Info,"FetchAccessToken: Start"),o&&(me.c.accessTokenStartTime=(0,v.a)(),(0,v.l)("accessTokenStartTime")),e(i||Bh(t),s).then((function(e){return{success:!0,token:e,format:"JWT",source:"OfficeHome"}})).catch((function(e){return Promise.reject({api:"getAuthToken",failure:e,message:"Failed to retrieve auth token"})})).finally((function(){null==wh||wh.ULS.sendTraceTag(546182047,f.W.zn,p.G.Info,"FetchAccessToken: End"),o&&(me.c.accessTokenEndTime=(0,v.a)(),(0,v.l)("accessTokenEndTime"))}))}}function Qh(e,t,i,r,o){var s=this;return function(a,c,u,l){return void 0===c&&(c=!0),void 0===u&&(u=!1),(0,n.mG)(s,void 0,void 0,(function(){var s,c,d;return(0,n.Jh)(this,(function(n){return s=!0,c=u?"editnew":"view"===a.intent?"view":"edit"===a.intent?"edit":"open",(null==i?void 0:i.isESSEnabled)&&i.wacDataCenter&&!en.includes("wacSession")&&en.push("wacSession"),a.shareUrl?(null==l||l.ULS.sendTraceTag(572634827,f.W.zn,p.G.Info,"Item to be fetched using shareUrl"),[2,ch(a.shareUrl,en,e,s,c,!1,l,i,o).catch((function(t){if(t&&404===t.status&&"The site has been moved to a new location."===t.message&&t.redirectLocation&&a.shareUrl){null==l||l.ULS.sendTraceTag(546120988,f.W.zn,p.G.Info,"Get item failed due to site move. Retry with the redirect location");var n=new URL(t.redirectLocation),r=new URL(a.shareUrl);return a.shareUrl=a.shareUrl.replace(r.hostname,n.hostname),ch(a.shareUrl,en,e,s,c,!1,l,i,o)}throw t}))]):a.driveId&&a.docId?(null==l||l.ULS.sendTraceTag(572634828,f.W.zn,p.G.Info,"Item to be fetched using driveId and docId"),[2,uh(a,en,e,s,c,t,l,i,o)]):a.fileId&&a.baseUrl?(null==l||l.ULS.sendTraceTag(572343521,f.W.zn,p.G.Info,"Item to be fetched using fileId and baseUrl"),[2,dh(a.fileId,a.baseUrl,en,e,s,c,l,i,r,o).catch((function(t){if(Oh&&t&&404===t.status&&t.redirectLocation){if(null==l||l.ULS.sendTraceTag(508380358,f.W.zn,p.G.Important,"Get item failed due to site move. Retry with the redirect location"),a.baseUrl){var n=new URL(a.baseUrl),u=new URL(t.redirectLocation);a.baseUrl=a.baseUrl.replace(n.hostname,u.hostname)}return dh(a.fileId||"",a.baseUrl||"",en,e,s,c,l,i,r,o)}throw t}))]):(null==l||l.ULS.sendTraceTag(572634829,f.W.zn,p.G.Info,"Item to be fetched using docUrl"),[2,ch(null!==(d=a.docUrl)&&void 0!==d?d:"",en,e,s,c,!1,l,i,o).catch((function(e){throw e}))])}))}))}}function Xh(e){return!(e.shareUrl||!e.docId||!e.driveId||e.baseUrl||e.docUrl)}var Yh,Zh=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.Ha=e,this.Oa=new Map(t.map((function(e){return[e,new Map]})))}return e.prototype.registerHandlers=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){return e.Oa.set(t,new Map)}))},e.prototype.getHandler=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n="error");var i=this.Oa.get(e);return function(e){if(i){var r=i.get(e.data.correlationId);r&&(i.delete(e.data.correlationId),t?e.data[t]?r.resolve(e.data[t]):r.reject(e.data[n]||n):r.resolve())}}},e.prototype.getMessagePromise=function(e,t){var n=this,i=this.Oa.get(e);return i?new Promise((function(e,r){var o;n.Ha||r("frameToHostMessenger does not exist");var s=null===(o=n.Ha)||void 0===o?void 0:o.sendMessage(t);s?i.set(s,{resolve:e,reject:r}):r("Encountered error sending message to host")})):Promise.reject("No registered handlers ")},e}();!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Timeout=2]="Timeout"}(Yh||(Yh={}));var ef,tf,nf,rf,of,sf="OwlFrame",af=3e4;function cf(e,t,i,r,o){return(0,n.mG)(this,void 0,void 0,(function(){var s,a,c,u;return(0,n.Jh)(this,(function(n){return s=function(e){return new URL((0,m.wl)(e)).origin}(e),(a=document.createElement("iframe")).src="".concat(s).concat(E).concat(window.location.search?window.location.search+"&":"?","filetype=").concat(t,"&hostorigin=").concat(encodeURIComponent(window.location.origin),"&env=").concat(e).concat(o?"&corrid=".concat(o,"&usid=").concat(o):""),a.id=sf,a.allowFullscreen=!0,a.allow="microphone ".concat(s,"; autoplay ").concat(s,"; camera ").concat(s,"; clipboard-read ").concat(s,"; clipboard-write ").concat(s,"; keyboard-map ").concat(s,"; display-capture ").concat(s),a.setAttribute("style","inset: 0px; height: ".concat(r?"100%":"0px","; width: ").concat(r?"100%":"0px","; display: block; position: absolute; background-color: transparent; border: none; visibility: ").concat(r?"visible":"hidden",";")),(0,v.l)(_.OwlAddFrameToDOM),i.appendChild(a),c=new Promise((function(e){a.contentWindow&&(ef=new d(a.contentWindow,s),rf=new Zh(ef,H.EndSessionResponse),ef.registerHandler(H.FrameLoaded,(function(t){(0,v.l)(_.OwlLoadedMessageReceive),e(t.data.success?{status:Yh.Success}:{status:Yh.Error,error:t.data.error})})))})),u=new Promise((function(e){return setTimeout((function(){return e({status:Yh.Timeout,error:"Timed out waiting for OWL frame to load after ".concat(af," ms.")})}),af)})),[2,Promise.race([c,u])]}))}))}function uf(){return{endSession:function(e){return rf.getMessagePromise(H.EndSessionResponse,{id:O.EndSession,data:{rebootInfo:e}})},hostAccessibilityLoopComplete:function(e){return null==ef||ef.sendMessage({id:O.HostAccessibilityLoopComplete,data:{navigateForward:e}}),!0},hostGetClientUrl:function(){null==ef||ef.sendMessage({id:O.GetClientUrl,data:{}})},hostGetWebUrl:function(){null==ef||ef.sendMessage({id:O.GetWebUrl,data:{}})}}}function lf(){tf&&tf.dispose(),ef&&ef.dispose(),window.performance&&window.performance.getEntriesByType&&window.performance.clearMarks&&window.performance.getEntriesByType("mark").filter((function(e){return e.name.startsWith("owl")})).forEach((function(e){return window.performance.clearMarks(e.name)}));var e=document.getElementById(sf);e&&e.remove()}!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(of||(of={}));var df=window.navigator,hf=df?df.userAgent:void 0;function ff(){return!!hf&&hf.indexOf("iPhone")>=0||/android.+mobile/i.test(df.userAgent)}var pf,vf,mf,gf=s(2957);function wf(){var e=window.location.search,t=new URLSearchParams(e),n=t.get(me.$c.ItemId),i=t.get(me.$c.DriveId),r=t.get(me.$c.DocUrl);return{docId:null!=n?n:void 0,driveId:null!=i?i:void 0,docUrl:null!=r?r:void 0}}function yf(e){return mf||(mf=function(){vf||((vf={})[k.T[k.T.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],vf[k.T[k.T.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],vf[k.T[k.T.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],vf[k.T[k.T.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],vf[k.T[k.T.OneNote]]=["one"]),mf={};var e=function(e){if(!vf.hasOwnProperty(e))return"continue";var t=vf[e];if(!t)return"continue";t.forEach((function(t){mf[t]=k.T[e]}))};for(var t in vf)e(t);return mf}()),e&&mf[e.toLowerCase()]||k.T.None}function _f(){var e=window.location.pathname.split("/");if(4===e.length||5===e.length)return function(e){switch(e){case"word":return k.T.Word;case"excel":return k.T.Excel;case"powerpoint":return k.T.PowerPoint;case"onenote":return k.T.OneNote;case"visio":return k.T.Visio;default:return}}(e[2].toLowerCase())}!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(pf||(pf={})),function(){var e,t;if(N.isOwlFrame){(0,v.l)(_.OwlFrameScriptExecutionStart);var i=new URLSearchParams(location.search),r=document.getElementById("owl"),o=i.get("hostorigin"),s="true"===(null===(t=null===(e=null==r?void 0:r.dataset)||void 0===e?void 0:e.validHost)||void 0===t?void 0:t.toLowerCase());o&&s&&function(e){var t=this;tf=new d(window.parent,e),nf=new Zh(tf,O.GetAuthTokenResponse,O.FetchItemFromNetworkResponse,O.FetchAccessTokenResponse,O.OpenShareControlResponse,O.CreateDocumentResponse),tf.registerHandler(O.BootApplication,(function(e){(0,v.l)(_.OwlBootAppMessageReceive),zh(function(e){var t,i,r,o,s,a,c,u,l,d,h,f,p,v,m,g,w,y,_,C,S,k,T,A,I,E,R,N,P,U,M,D,F,x,q,B,L,W,V;return{documentIdentifier:e.documentIdentifier,sessionConfig:{hostCorrelationId:e.sessionConfig.hostCorrelationId,isMsa:e.sessionConfig.isMsa,tenantId:e.sessionConfig.tenantId,organizationName:e.sessionConfig.organizationName,sessionId:e.sessionConfig.sessionId,isESSEnabled:e.sessionConfig.isESSEnabled,experiments:e.sessionConfig.experiments,highContrastMode:e.sessionConfig.highContrastMode,additionalApplicationParameters:e.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(t=e.sessionConfig.bootDiagnostics)||void 0===t?void 0:t.tabsCacheHit,packageEntryTime:null===(i=e.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime,isTestMode:null===(r=e.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isTestMode,isManifestCachingEnabled:null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(s=e.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isOwlBootstrapperEnabled,isPrebooted:null===(a=e.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(c=e.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.isVroom21,ringId:null===(u=e.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.ringId,teamsContextStartTime:null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.teamsContextStartTime,teamsContextEndTime:null===(d=e.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(h=e.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.wopiDataStartTime,wopiDataEndTime:null===(f=e.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataEndTime,bootStrapStartTime:null===(p=e.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapStartTime,bootStrapEndTime:null===(v=e.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.bootStrapEndTime,driveItemStartTime:null===(m=e.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(g=e.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemEndTime,driveItemFromWacStartTime:null===(w=e.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(y=e.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.driveItemFromWacEndTime,accessTokenStartTime:null===(_=e.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.accessTokenStartTime,accessTokenEndTime:null===(C=e.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.accessTokenEndTime,isCookieBlocked:null===(S=e.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.isCookieBlocked,meetingLiveDiagnostics:null===(k=e.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.meetingLiveDiagnostics,spRequestGuid:null===(T=e.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.spRequestGuid,createNewStartTime:null===(A=e.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.createNewStartTime,createNewEndTime:null===(I=e.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.createNewEndTime,loadManifestStartTime:null===(E=e.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.loadManifestStartTime,loadManifestEndTime:null===(R=e.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.loadManifestEndTime,loadOwlStartTime:null===(N=e.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.loadOwlStartTime,loadOwlEndTime:null===(P=e.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.loadOwlEndTime,owlBootstrapperStartTime:null===(U=e.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(M=e.sessionConfig.bootDiagnostics)||void 0===M?void 0:M.owlBootstrapperEndTime,isOdcMigrated:null===(D=e.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.isOdcMigrated,perfNavigationTiming:null===(F=e.sessionConfig.bootDiagnostics)||void 0===F?void 0:F.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(x=e.sessionConfig.bootDiagnostics)||void 0===x?void 0:x.owlFramePerfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:null===(B=null===(q=e.sessionConfig.bootDiagnostics)||void 0===q?void 0:q.legacyPerformanceData)||void 0===B?void 0:B.host,owlFrame:(null===(W=null===(L=e.sessionConfig.bootDiagnostics)||void 0===L?void 0:L.legacyPerformanceData)||void 0===W?void 0:W.owlFrame)||(0,b.vb)()}},uiHostTabId:e.sessionConfig.uiHostTabId,upn:e.sessionConfig.upn,meeting:e.sessionConfig.meeting,customAuthConfigValue:e.sessionConfig.customAuthConfigValue,wiseEnvironment:e.sessionConfig.wiseEnvironment,isSynthetic:e.sessionConfig.isSynthetic,hostUrl:e.sessionConfig.hostUrl,owlVersion:e.sessionConfig.owlVersion,owlRollout:e.sessionConfig.owlRollout,fileType:e.sessionConfig.fileType,clickTime:e.sessionConfig.clickTime,uiCulture:e.sessionConfig.uiCulture,dataCulture:e.sessionConfig.dataCulture,puid:e.sessionConfig.puid,isNewFile:e.sessionConfig.isNewFile,wdValue:e.sessionConfig.wdValue,sessionOrigin:e.sessionConfig.sessionOrigin,intent:e.sessionConfig.intent,hostClientType:e.sessionConfig.hostClientType,isPopOut:e.sessionConfig.isPopOut,teamType:e.sessionConfig.teamType,initPackageParams:e.sessionConfig.initPackageParams&&(0,n.pi)((0,n.pi)({},e.sessionConfig.initPackageParams),{jsApiUrlInfos:le(null===(V=e.sessionConfig.initPackageParams)||void 0===V?void 0:V.jsApiUrlInfos)})},uiHostConfig:(0,n.pi)((0,n.pi)({},e.uiHostConfig),{featureGates:e.uiHostConfig.featureGates?le(e.uiHostConfig.featureGates):void 0}),getAuthToken:function(e,t){return nf.getMessagePromise(O.GetAuthTokenResponse,{id:H.GetAuthToken,data:{resourceUrl:e,claims:t}})},eventHandlers:{onBootComplete:j,onBootFailure:K,onReturnFocus:G,onDocumentClose:$,onSuccessNotification:z,onOpenInMobileApp:J},container:document.getElementById("owl-container")||te()}}(e.data))})),tf.registerHandler(O.BootApplicationWithCustomFunctions,(function(t){(0,v.l)(_.OwlBootAppWithCustomFunctionsMessageReceive),Jh(function(e,t){var i,r,o,s,a,c,u,l;return{documentBootInfo:e.documentBootInfo,fetchItemFromNetwork:V,fetchAccessToken:Q,openShareControl:X,sessionConfig:(0,n.pi)((0,n.pi)({},e.sessionConfig),{bootDiagnostics:(0,n.pi)((0,n.pi)({},e.sessionConfig.bootDiagnostics),{perfNavigationTiming:null===(i=e.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(r=e.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.owlFramePerfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:null===(s=null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.legacyPerformanceData)||void 0===s?void 0:s.host,owlFrame:(null===(c=null===(a=e.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.legacyPerformanceData)||void 0===c?void 0:c.owlFrame)||(0,b.vb)()}})}),container:document.getElementById("owl-container")||te(),createDocument:Y,setTitle:Z,onBootComplete:j,onBootFailure:K,onReturnFocus:G,onDocumentClose:$,onSuccessNotification:z,onOpenInMobileApp:J,onUserActivity:ee,uiHostConfig:(0,n.pi)((0,n.pi)({},e.uiHostConfig),{featureGates:(null===(u=e.uiHostConfig)||void 0===u?void 0:u.featureGates)?le(e.uiHostConfig.featureGates):void 0}),additionalApplicationParameters:e.additionalApplicationParameters,sharingLinkTokenProvider:e.sharingLinkTokenProvider?{TokenPromise:new Promise((function(e,t){null==tf||tf.registerHandler(O.SharingLinkTokenProvider,(function(n){n.data.token?e(n.data.token):t(n.data.error)}))}))}:void 0,onCAAEMessage:ne,onUserAccess:ie,onMoveToFolder:re,onSharedFilePicker:oe,onRename:se,initPackageParams:e.initPackageParams&&(0,n.pi)((0,n.pi)({},e.initPackageParams),{jsApiUrlInfos:le(null===(l=e.initPackageParams)||void 0===l?void 0:l.jsApiUrlInfos)}),onFrameChange:ae,invokeSessionRefreshInfoPopupBlockedDialog:function(e){var n=new d(window.parent,t);n.registerHandler(O.SessionRefreshInfoDialogHandleRefresh,(function(){n.dispose(),e.handleRefresh()})),n.registerHandler(O.SessionRefreshInfoDialogHandleCancel,(function(){n.dispose(),e.handleCancel()})),n.registerHandler(O.SessionRefreshInfoDialogOnDismiss,(function(){n.dispose(),e.onDismiss()})),null==tf||tf.sendMessage({id:H.InvokeSessionRefreshInfoPopupBlockedDialog,data:{visible:e.visible}})},onFileEmbed:ce}}(t.data,e))})),tf.registerHandler(O.TokenFetchingExperiment,(function(e){return(0,n.mG)(t,void 0,void 0,(function(){var t,i,r,o,s,a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:B(),(0,v.l)(_.OwlTokenFetchingExperimentMessageReceived),t=e.data.bootParams,i=(0,h.L8)({remoteUlsEndpoint:(0,m.fy)(t.sessionConfig.wiseEnvironment),sessionId:t.sessionConfig.sessionId}),r=_d(t.sessionConfig,i),o={isESSEnabled:t.sessionConfig.isESSEnabled,wacDataCenter:t.sessionConfig.isESSEnabled?Id(t.documentBootInfo.fileType):void 0,sessionId:t.sessionConfig.sessionId,hostCorrelationId:t.sessionConfig.hostCorrelationId},n.label=1;case 1:return n.trys.push([1,3,4,5]),(0,v.l)(_.OwlGetDriveItemWithMsalStart),[4,Gd(t.documentBootInfo,o,r,t.sessionConfig.wiseEnvironment,t.sessionConfig.sessionId,t.sessionConfig.upn,i)];case 2:return n.sent(),(0,v.l)(_.OwlGetDriveItemWithMsalEnd),[3,5];case 3:return s=n.sent(),null==i||i.ULS.sendTraceTag(508168087,f.W.zn,p.G.Error,"Failed to get drive item with shared auth, error: ".concat(s)),[3,5];case 4:return D(),[7];case 5:return a=q({owlVersion:null==hh?void 0:hh.clientVersion,wiseEnvironment:null==hh?void 0:hh.wiseEnvironment,exposure:null==hh?void 0:hh.exposure}).owlTelemetryData,null==i||i.ULS.sendTraceTag(508168086,f.W.zn,p.G.Important,"[Auth Token Experiment Data (Frame)]: ".concat(a)),[2]}}))}))})),(0,v.l)(_.OwlLoadedMessageSend),tf.sendMessage({id:H.FrameLoaded,data:{success:!0}})}(o)}}()})(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=a})();