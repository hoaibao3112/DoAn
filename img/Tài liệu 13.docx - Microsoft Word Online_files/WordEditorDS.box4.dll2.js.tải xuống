'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1399:function(I,J,d){I=d(0);var m=d(13),f=d(39),a=d(5),l=d(103),w=d(177),z=d(817),x=d(224),u=d(616),v=d(2),D=d(364),y=d(19),H=d(109),F=d(272),G=d(1),K=d(1551);class R{constructor(X,V){this.Nuk=X;this.MB=V}K(X){return this.Nuk.P2(X,this.MB)}}Object(I.a)(R,"PropertyMergeStrategies",null,[]);var E=d(1616),N=d(1549);class O extends N.a{constructor(){super();this.ded=this.fje=this.Ao=null;this.Lqe=0}get afa(){return"Property"}TPb(){this.detail.W("Type",
this.afa);this.detail.W("ComplexMerger",null!=this.Ao?this.Ao:-1);this.detail.W("Strategy",null!=this.fje?this.fje:-1);this.detail.W("ClassId",null!=this.ded?this.ded:-1);this.detail.W("PropId",this.Lqe);return this.detail}}Object(I.a)(O,"PropertyMergeFailureDetail",N.a,[]);d.d(J,"a",function(){return U});class U{constructor(X=null){this.tAh=this.rc=null;this.b9b=X||this.E3c()}get Ao(){return 1}get avb(){return this.b9b}E3c(){return[Object(H.a)(this,this.zrp,"tryPreProcessFavoredRevision"),Object(H.a)(this,
this.wtl,"cloneObjectAndRemoveNeededProperties"),Object(H.a)(this,this.lrp,"tryMergeNodeInternal")]}get MB(){return 5}get Nqe(){return this.tAh||(this.tAh=new R(this.hl(),this.MB))}HD(X,V){const Q=X.hh.value.Lf;w.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",Q.id,Q.sc);X.Hu.logger.Oi(Object.assign(new O,{Ao:this.Ao,ded:Q.sc,Lqe:V}));return!1}UIg(X){const V=X.hh.value;w.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",V.Lf.id,V.Lf.sc);for(let Q=0;Q<this.avb.length;Q++)if(!(0,this.avb[Q])(X))return w.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",V.Lf.id,V.Lf.sc,Q),X.Hu.logger.Uhe("GraphNodeComplexMerge.GetMergeFunctions()",Q),this.DEn(X),X.Rl=null,!1;w.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",V.Lf.id,V.Lf.sc);
return!0}DEn(X){X.XMg||(X.XMg=!0,E.a(X.hh.value.Sv,"Base",1),E.a(X.hh.value.Lf,"Favored",1),E.a(X.Ro.value.Lf,"Conflict",1))}zrp(X){const V=X.hh.value,Q=this.Nqe;if(!V.e3)return!0;let T=!0;V.SMa.forEach((ba,W)=>{if(!W.e3||X.Yg.contains(ba))return!0;W=Q.K(ba);if(5===W){const aa=V.Sv.sc;w.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",aa,ba,W);X.Hu.logger.Oi(Object.assign(new O,
{Ao:this.Ao,ded:aa,Lqe:ba,fje:W}));return T=!1}6===W&&X.Amg.add(ba);return!0});return T}wtl(X){X.Rl=X.hh.value.Lf.GO();const V=X.Amg,Q=X.Rl;V&&V.forEach(T=>{Q.removeProperty(z.a.s_(T));return!0});return!0}lrp(X){const V=X.Ro.value,Q=V.Sv.sc,T=this.Nqe;let ba=!0;V.SMa.forEach((W,aa)=>{const Y=T.K(W);ba=this.mrp(X,aa,W,Y);ba||(X.Rl=null,w.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",Q,W,Y),X.Hu.logger.Oi(Object.assign(new O,{Ao:this.Ao,
ded:Q,Lqe:W,fje:Y})));return ba});return ba}mrp(X,V,Q,T){const ba=X.Rl;if(!V.e3&&8!==T||2===T||7===T||X.Yg.contains(Q))return!0;if(5===T)return!1;if(4===T||3===T){let W;if(({value:W}=X.hh.value.SMa.Ec(Q)).returnValue&&W.e3)return 4!==T;T=0}8===T&&(T=0);if(0===T){if(!V.isDeleted)return X=z.a.s_(Q),(U.$Ep(V,Q,X)||U.c5o())&&ba.Udb(X,V.newValue),!0;T=6}return 6===T?(ba.removeProperty(z.a.s_(Q)),!0):1===T?this.HD(X,Q):!1}kNn(X,V,Q,T,ba,W){X=X||new x.a;V=V||new x.a;Q=Q||new x.a;var aa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
X.length,V.length,Q.length),Y=X.length<=V.length&&X.length<=Q.length;this.FZi()&&Y&&w.a.instance.Ua(541181455,1,1,aa);if(!Y&&this.EXi(W.runtime.rc))return null;if(this.FZi())for(aa=0;aa<X.length;aa++){Y=X.ug(aa);var da=V.ug(aa);let ka=Q.ug(aa);Y=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",Y,da,ka,aa,X.length);w.a.instance.Ua(541181457,1,1,Y)}if(this.EXi(W.runtime.rc))for(W=0;W<
X.length;W++)if(aa=X.ug(W),Y=V.ug(W),da=Q.ug(W),!T(aa,Y)||!T(aa,da))return null;X=X.ONa();T=new u.a;W=X.length;for(aa=W;aa<V.length;aa++)Y=V.ug(aa),X.add(Y),T.add(Y);for(;W<Q.length;W++)V=Q.ug(W),T.contains(V)?w.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",V):(X.add(V),ba(V));return X}FZi(){return!!v.AFrameworkApplication.J&&v.AFrameworkApplication.J.$("LogMPALErrors")}EXi(X){if(!X)return!1;X.L9d(1000008);
return X.xrb(1000008)}Usn(X){if(!X)return!1;X.L9d(1000009);return X.xrb(1000009)}Ddj(X,V,Q,T){return K.a(X,V,Q,T)}WLa(X,V,Q){X=X||new x.a;V=V||new x.a;Q=Q||new x.a;const T=X.vS(),ba=V.vS(),W=Q.vS();X=U.filter(X,aa=>ba.contains(aa)&&W.contains(aa));X.vS();X.SA(X.length,U.filter(V,aa=>!T.contains(aa)));X.SA(X.length,U.filter(Q,aa=>!T.contains(aa)&&!ba.contains(aa)));return X}dNn(X,V){const Q=z.a.s_(V),T=X.tf;var ba=T.getPropertyObjectIds(X.hh.value.Sv,Q),W=T.getPropertyObjectIds(X.hh.value.Lf,Q);const aa=
T.getPropertyObjectIds(X.Ro.value.Lf,Q);ba=this.WLa(ba,W,aa);W=X.Rl;0<ba.length?T.setPropertyObjectIds(W,Q,ba):W.removeProperty(Q);X.Yg.add(V)}Wnb(X,V,Q){X.hasProperty(Q)?V.Udb(Q,X.HF(Q)):V.removeProperty(Q)}vEo(X,V){var Q=V.Zj();for(const T of Q)V.removeProperty(T);Q=X.Zj();for(const T of Q)V.Udb(T,X.HF(T))}z1f(X,V,Q,T,ba){V=X.getPropertyInt32(V,ba);Q=X.getPropertyInt32(Q,ba);Q=null!=V&&null!=Q?Math.max(V,Q):null!=Q?Q:null!=V?V:null;null!=Q?X.setPropertyInt32(T,ba,Q):T.removeProperty(ba)}xnf(X,V,
Q,T,ba,W){V=X(V,ba);Q=X(Q,ba);X=X(T,ba);T=V.vS();let aa=!1;W&&(aa=W(V,Q,X));aa?(W=!0,T=!1):(W=T.h6h(Q),T=T.h6h(X));w.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",z.a.yb(ba),V.Qr(),Q.Qr(),X.Qr(),W,T);return{mWc:X,L$a:W,C$a:T}}epl(X,V,Q,T,ba){let W;V=X(V,ba);Q=X(Q,ba);X=X(T,ba);T=this.h2i(V,Q);W=this.h2i(V,X);w.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
z.a.yb(ba),V.Qr(),Q.Qr(),X.Qr(),T,W);return{mWc:X,L$a:T,C$a:W}}h2i(X,V){if(!X&&!V)return!0;if(!X||!V)return!1;if(!X.count&&!V.count)return!0;let Q=!1;V.forEach((T,ba)=>Q=X.tb(T)&&ba==X.K(T));return Q}hl(){let X;X=this.Usn(this.rc)?U.pDk.value:U.oDk.value;const V=new D.a(0);for(let Q=0;Q<X.length;Q++)V.W(X[Q],7);return V}static laa(){return new U}static get instance(){return U._instance.value}static c5o(){return y.a.instance.Oa("Box4.IFeatureHelper").isFeatureEnabled(69)}static $Ep(X,V,Q){if(void 0!==
X.newValue&&null!==X.newValue||G.a.u_i(Q.type))return!0;U.BFn(X,V,Q);return!1}static BFn(X,V,Q){Q=Q.type===G.a.string;V=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",V);Q||(V+=String.format(" [NewValue: {0}] [OldValue: {1}]",X.newValue,X.oldValue));w.a.instance.Ua(19145822,1,2,V)}static Q7f(X,V,Q){const T=z.a.yb(Q),ba=X.tf;var W=ba.getPropertyObjectIds(X.hh.value.Sv,Q);const aa=ba.getPropertyObjectIds(X.hh.value.Lf,Q);var Y=ba.getPropertyObjectIds(X.Ro.value.Lf,Q);Y=U.$Qm(Y,
X.Hu.runtime.cyc);V=V.WLa(W,aa,Y);W=X.Rl;0<V.length?ba.setPropertyObjectIds(W,Q,V):W.removeProperty(Q);X.Yg.add(T);return!0}static $Qm(X,V){const Q=new x.a;X.forEach(T=>{V.contains(T,(ba,W)=>ba.equals(W))||Q.add(T);return!0});return Q}static filter(X,V){const Q=new x.a;X.forEach(T=>{V(T)&&Q.add(T);return!0});return Q}static Vvm(){return[z.a.yb(m.a.L0d),z.a.yb(m.a.lastModifiedTime),z.a.yb(m.a.QL),z.a.yb(m.a.Vld),z.a.yb(m.a.uug),z.a.yb(f.a.bed),z.a.yb(a.a.MWd),z.a.yb(a.a.Uob),z.a.yb(l.a.QIj)]}static Wvm(){return[z.a.yb(m.a.L0d),
z.a.yb(m.a.lastModifiedTime),z.a.yb(m.a.QL),z.a.yb(m.a.Vld),z.a.yb(m.a.uug),z.a.yb(f.a.bed),z.a.yb(a.a.MWd),z.a.yb(l.a.QIj)]}}U._instance=new F.a(U.laa);U.oDk=new F.a(U.Vvm);U.pDk=new F.a(U.Wvm);Object(I.a)(U,"GraphNodeComplexMerge",null,[1085])},1401:function(I,J,d){d.r(J);I=d(0);var m=d(253),f=d(1429),a=d(1409),l=d(1618),w=d(1619);class z{constructor(u,v){this.Zib=!1;this.vma=null;if(!u)throw Error.argumentNull("annotations");if(!u.opc(v))throw Error.argument("structTypeID","Invalid struct type ID");
this.Lx=u;this.Uqc=this.Lx.yCi(v);this.bPk=v}get Occ(){return this.Lx}get isReadOnly(){return this.Zib}get L_a(){return this.bPk}Mqb(u){if(0>u||u>=this.Uqc)throw Error.argument("iField","Invalid field index");return this.vma&&null!=this.vma[u]?this.vma[u]:this.Lx.$Gi(this.L_a,u)}Wxg(u,v){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.Uqc)throw Error.argument("iField","Invalid field index");if(!this.Lx.koc(this.Lx.UQb(this.L_a,
u),v))throw Error.argument("value","Value is not of the correct type for the specified field");(this.vma||(this.vma=Array(this.Uqc)))[u]=v}bia(){const {Annotations:u}=d(1401);let v="[";if(this.vma){let D=!0;for(let y=0;y<this.Uqc;++y){if(null==this.vma[y])continue;const H=this.Lx.UQb(this.L_a,y);if(u.UAb(H,this.vma[y],this.Lx.$Gi(this.L_a,y)))continue;D?D=!1:v+=", ";v+=this.Lx.aHi(this.L_a,y);v+="=";const F=this.Lx.bia(H,this.vma[y]);H===u.Qca?(v+='"',v+=f.a.CAf(F),v+='"'):v+=F}}return v+"]"}isEqual(u){const {Annotations:v}=
d(1401);if(this===u)return!0;if(!u||this.Lx!==u.Occ||this.L_a!==u.L_a)return!1;for(let D=0;D<this.Uqc;++D)if(!v.UAb(this.Lx.UQb(this.L_a,D),this.Mqb(D),u.Mqb(D)))return!1;return!0}clone(){const u=new z(this.Lx,this.L_a);this.vma&&(u.vma=Array.clone(this.vma));return u}HW(){return this.isReadOnly?this.clone():this}U4f(){const {Annotations:u}=d(1401);if(!this.isReadOnly&&(this.Zib=!0,this.vma))for(let v=0;v<this.Uqc;++v){const D=this.vma[v];null!=D&&u.$Ub(D)}}toString(){return this.bia()}}Object(I.a)(z,
"StructValue",null,[1824,1821]);d.d(J,"Annotations",function(){return x});class x{constructor(u,v){if(!u)throw Error.argumentNull("initData");if(!v)throw Error.argumentNull("objectFetcher");this.HIn=v.rYl;let D=0;var y=v.xqb(u.K(D));++D;this.K6f=new l.a(new w.a(y));this.Juk=u.K(D);++D;this.Waj=Array(this.h1d);this.wcd=Array(this.h1d);this.Pub=Array(this.h1d);for(y=0;y<this.h1d;++y){this.Waj[y]=v.iD(u.K(D));++D;this.wcd[y]=u.K(D);++D;var H=u.K(D);++D;this.Pub[y]=Array(H);for(var F=0;F<H;++F)this.Pub[y][F]=
v.iD(u.K(D)),++D}this.aPk=u.K(D);++D;this.Dbj=Array(this.pqd);this.yie=Array(this.pqd);this.zie=Array(this.pqd);this.xie=Array(this.pqd);for(y=0;y<this.pqd;++y)for(this.Dbj[y]=v.iD(u.K(D)),++D,H=u.K(D),++D,this.yie[y]=Array(H),this.zie[y]=Array(H),this.xie[y]=Array(H),F=0;F<H;++F)this.yie[y][F]=v.iD(u.K(D)),++D,this.zie[y][F]=u.K(D),++D,this.xie[y][F]=({Fla:D}=this.uUa(this.zie[y][F],u,D,null,null,null)).returnValue,x.$Ub(this.xie[y][F]);this.mok=u.K(D);++D;this.o6f=Array(this.ldc);this.p6f=Array(this.ldc);
this.n6f=Array(this.ldc);for(y=0;y<this.ldc;++y)this.o6f[y]=v.iD(u.K(D)),++D,this.p6f[y]=u.K(D),++D,this.n6f[y]=({Fla:D}=this.uUa(this.p6f[y],u,D,null,null,null)).returnValue,x.$Ub(this.n6f[y])}Q1c(u){for(let v=0;v<this.ldc;++v)if(this.o6f[v]===u)return v;return-1}jti(u){if(!this.jpc(u))throw Error.argument("attrID","Invalid attribute ID");return this.o6f[u]}getAttributeType(u){if(!this.jpc(u))throw Error.argument("attrID","Invalid attribute ID");return this.p6f[u]}UQb(u,v){if(!this.opc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.zie[x.qqd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}bia(u,v){if(!this.V0f(u))throw Error.argument("typeID","Invalid type ID");if(!this.koc(u,v))throw Error.argument("value","Value is not of the correct type");switch(u){case x.Qca:return v;case x.sEa:return v?"True":"False";case x.LOa:case x.Jva:return v.toString();case x.yY:return v.bia();default:if(!x.nK(u)&&x.wsd(u)){u=x.pAf(u);const H=this.Pub[u].length;switch(this.wcd[u]){case 0:return this.Pub[u][v];
case 1:if(v){var D="";for(var y=1;y<H;++y)v&1<<y-1&&(0<D.length&&(D+=" & "),D+=this.Pub[u][y]);return D}return this.Pub[u][0];case 2:D="";for(y=0;y<H;++y)v&1<<y&&(0<D.length&&(D+=" & "),D+=this.Pub[u][y]);return D;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.wcd[u]);}}else return v.bia()}}V0f(u){switch(u){case x.Qca:case x.sEa:case x.LOa:case x.Jva:case x.yY:return!0;default:return x.nK(u)?this.V0f(x.h9a(u)):x.wsd(u)?this.gvn(u):this.opc(u)}}gvn(u){u=x.pAf(u);return 0<=
u&&u<this.Waj.length}opc(u){u=x.qqd(u);return 0<=u&&u<this.Dbj.length}jpc(u){return 0<=u&&u<this.ldc}koc(u,v){if(null==v)return!1;switch(u){case x.Qca:return"string"===typeof v;case x.sEa:return"boolean"===typeof v;case x.LOa:return"number"===typeof v;case x.Jva:return"number"===typeof v;case x.yY:return Object(m.a)(1820,v);default:if(x.nK(u))return Object(m.a)(1823,v)&&v.U7===x.h9a(u);if(x.wsd(u)){if("number"!==typeof v)return!1;u=x.pAf(u);const D=this.Pub[u].length;switch(this.wcd[u]){case 0:return 0<=
v&&v<D;case 1:return!(v&-1<<D-1);case 2:return!!v&&!(v&-1<<D);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.wcd[u]);}}else return Object(m.a)(1824,v)&&v.L_a===u}}get ldc(){return this.mok}get h1d(){return this.Juk}get pqd(){return this.aPk}Dim(u){if(!this.jpc(u))throw Error.argument("attrID","Invalid attribute ID");return this.n6f[u]}yCi(u){if(!this.opc(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.yie[x.qqd(u)].length}aHi(u,v){if(!this.opc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.yie[x.qqd(u)][v]}$Gi(u,v){if(!this.opc(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.xie[x.qqd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}uUa(u,v,D,y,H,F){if(!v)throw Error.argumentNull("initData");if(x.nK(u)){var G=v.K(D);++D;u=x.h9a(u);var K=new a.a(this,u);for(var R=0;R<G;++R)Array.add(K.items,({Fla:D}=this.uUa(u,v,D,y,H,F)).returnValue);return{returnValue:K,Fla:D}}switch(u){case x.Qca:return{returnValue:(y||
this.K6f).iD(v.K(D++)),Fla:D};case x.sEa:return{returnValue:1===v.K(D++),Fla:D};case x.LOa:return{returnValue:v.K(D++),Fla:D};case x.Jva:return{returnValue:(H||this.HIn)[v.K(D++)],Fla:D};case x.yY:u=v.K(D++);G=new f.a(this);for(K=0;K<u;++K)R=v.K(D),++D,F&&(R=F[R]),G.eA(R,({Fla:D}=this.uUa(this.getAttributeType(R),v,D,y,H,F)).returnValue);return{returnValue:G,Fla:D};default:if(x.wsd(u))return{returnValue:v.K(D++),Fla:D};if(x.I4j(u)){G=v.K(D++);K=new z(this,u);for(R=0;R<G;++R){const E=v.K(D);++D;K.Wxg(E,
({Fla:D}=this.uUa(this.UQb(u,E),v,D,y,H,F)).returnValue)}return{returnValue:K,Fla:D}}throw Error.argument("typeID","Invalid type ID");}}static wsd(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static I4j(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static nK(u){return 32768===(u&32768)}static izm(u){if(x.nK(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static h9a(u){if(!x.nK(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static UAb(u,v,D){switch(u){case x.Qca:case x.sEa:case x.LOa:case x.Jva:return v===D;case x.yY:return v.isEqual(D);default:return x.nK(u)?v.isEqual(D):x.wsd(u)?v===D:v.isEqual(D)}}static $Ub(u){Object(m.a)(1821,u)&&u.U4f()}static HW(u){return Object(m.a)(1821,u)?u.HW():u}static pAf(u){return u-16}static qqd(u){return(u&-16385)-16}}x.Qca=1;x.sEa=2;x.LOa=3;x.Jva=5;x.yY=9;Object(I.a)(x,"Annotations",null,[1825])},1406:function(I,J,d){I=d(0);var m=d(354);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(I.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(I.a)(a,"InsightsParameters",null,[]);var l=d(1756),w=d(1757),z=d(1759),x=d(1760),u=d(2),v=d(1490),D=d(1508),y=d(29),H=d(17),F=d(16),G=d(1393),K=d(1758);d.d(J,"a",function(){return R});class R{static get jVf(){return"Insights_16x16x32"}static get e9l(){return"Find_16x16x32"}static get urj(){return"-Parameterized"}static get ICg(){return"Parameterized"}static get yDe(){return"bTryQuery"}static get aJg(){return"TellMeSuggestion_"}static get i4j(){return"bTryQueryAlternate"}static get qGg(){return"MenuTellMe"}static get pbo(){const E=
{},N=[];Array.add(N,{Term:{PeopleType:"Person"}});E.And=N;return E}static ztf(E){return E+R.urj}static getParameter(E){let N="",O="";if(E)for(let U=0;U<E.hni;++U)"Type"===E.EIf(U)?N=E.getValue(U):"Value"===E.EIf(U)&&(O=E.getValue(U));return new m.a(N,O)}static ZMb(E){E=Object.assign(new a,{neighborhood:E,mentionStart:0,mentionLength:E.length});return y.c(E)}static Fai(E,N,O){E=Object.assign(new f,{displayName:E,email:N,userId:O});return y.c(E)}static jUa(E,N,O=null){return y.c(R.HGi(E,N,O,null))}static HGi(E,
N,O=null,U=null){E=Object.assign(new D.a,{neighborhood:E,mentionStart:0,mentionLength:E?E.length:0});return Object.assign(new v.a,{selection:E,userIntent:U,entryPoint:N,launchData:O})}static CIo(E,N){return R.jUa(E,R.WGj(N))}static WGj(E){switch(E){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static jln(){return!!u.AFrameworkApplication.J&&u.AFrameworkApplication.J.$("IsGoLocalEnvironment")}static Woc(){const E=
u.AFrameworkApplication.J?u.AFrameworkApplication.J.jb("SovereignEnvironmentName"):null;return!!E&&0<E.length}static isEnterpriseUser(){const E=u.AFrameworkApplication.J?u.AFrameworkApplication.J.jb("HostAuthType"):null;return!!E&&"aad"===E.toLowerCase()||"external"===E&&R.nXf()}static zAg(E){return E.Ljp&&!R.Woc()}static $rn(){const E=u.AFrameworkApplication.J?u.AFrameworkApplication.J.jb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.J&&"UnifiedUiHostTeams"===E&&u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static yAg(E){return E.V_a&&E.a7l&&(E.$qd||E.Yqd||E.Ztb)&&!R.$rn()&&R.isEnterpriseUser()&&!R.Woc()}static ota(){return u.AFrameworkApplication.J?u.AFrameworkApplication.reb||u.AFrameworkApplication.J.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.reb}static yU(E){return!E||R.c2i(E.Vg)}static c2i(E){return!E||!E.trim().length}static kDe(E){if(!E)return 0;const N=Math.pow(10,5);return Math.round(E*N)/N}static emp(){var E=new Date;return E?new Date(E.getUTCFullYear(),E.getUTCMonth(),E.getUTCDate(),
E.getUTCHours(),E.getUTCMinutes(),E.getUTCSeconds(),E.getUTCMilliseconds()):null}static bOf(E){E=new Date(E);return(R.emp().getTime()-E.getTime())/1E3}static L2i(E){switch(E){case l.a.QRf:case w.a.Qoi:case K.a.QSi:case z.a.Ogj:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return E.startsWith(R.yDe)||
E.startsWith(R.aJg)||E.startsWith(R.i4j)||E.startsWith("PeopleSuggestion")||E.startsWith("FileSuggestion")||E.startsWith("FindInDocumentSuggestion")||E.startsWith("NotesSuggestion")||E.startsWith("OnenoteNotesSuggestion")||E.startsWith("SmartLookupFromTellMe")||E.startsWith("GetHelpFromTellMe")||E.startsWith("GetHelpWithDescriptionFromTellMe")||E.startsWith("AddinSuggestion")||E.startsWith("OfficeScripts")?!0:!1}static bJf(E,N){const O=[];Array.add(O,new x.a(400,E));Array.add(O,new x.a(200,N));E=
{};E.parts=O;return JSON.stringify(E)}static tqb(E){const N=E.indexOf("<b0>"),O=E.lastIndexOf("</b0>"),U=[];Array.add(U,new x.a(400,E.substring(0,N)));Array.add(U,new x.a(600,E.substring(N+4,O)));Array.add(U,new x.a(400,E.substring(O+5,E.length)));E={};E.parts=U;return JSON.stringify(E)}static yIi(E){const N=R.bOf(E);return 60>N?CommonUIStrings.l_TimeSince_SecsAgo:3600>N?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(N/60).toString()):86400>N?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(N/3600).toString()):172800>N?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(E)).localeFormat("MMMM dd, yyyy"))}static smm(E){const N=Array(E.length);for(let O=0;O<E.length;O++)N[O]=E[O].commandId;return N}static nXf(){if("Dev Box"===u.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse"))return!0;let E=u.AFrameworkApplication.J.jb("UserPrincipalName");E=G.c(E)?"":F.a.xh(E);const N=u.AFrameworkApplication.J.my("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.J.hD("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(N,E)&&"inner"===u.AFrameworkApplication.J.jb("Microsoft365Ring")}static Rvm(E){switch(R.W5d(E)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static yLm(E){E=R.W5d(E);switch(E){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return E}}static W5d(E){switch(E.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Wfa(){return H.a.B7&&!H.a.Nr}}R.Veb=9E5;Object(I.a)(R,"TellMeUtils",null,[])},1407:function(I,J,d){d.r(J);I=d(0);var m=d(524),f=d(280),a=d(109),l=d(253),w=d(80),z=d(1647),x=d(1033);class u{constructor(ia,La,Mb,Ha,zb,ac){this.groupType=ia;this.resultType=La;this.BEg=Mb;this.Xaa=Ha;this.dxf=zb;this.resultIndex=
ac}}Object(I.a)(u,"ClickLoggingInfo",null,[]);const v=ia=>{const La=[];for(;ia;)Array.add(La,"{ContextId:"+ia.contextId+", IsGraphNodeContext:"+ia.Al+"}"),ia=ia.Lk;La.reverse();return"{"+La.join(", ")+"}"};class D{constructor(){this.Usa=this.sessionId=null}}Object(I.a)(D,"CorrelationRecord",null,[1801]);var y=d(1442);class H{constructor(ia,La){this.provider=ia;this.jfb=La}}Object(I.a)(H,"ExternalResultProvider",null,[]);class F{constructor(ia,La){this.Id=null;this.TimeStamp=0;this.Id=ia;this.TimeStamp=
La}}Object(I.a)(F,"MRUControl",null,[]);var G=d(1620),K=d(1406),R=d(2),E=d(1272);class N{constructor(ia,La){this.HEk=10;this.h$=[];this.pGa=[];this.qph=this.pph=!1;this.OLc=this.NLc="";this.Z8b=La;this.kc=ia}v2c(){!this.pph&&this.kc&&(this.NLc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.kc.application,this.h$=this.cui(),this.pph=!0);return this.h$}BHm(){!this.qph&&this.kc&&(this.OLc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.kc.application,this.pGa=this.cui(!0),this.qph=!0);return this.pGa}hun(ia){return ia.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===ia||"TryOfficeUpsell"===ia}UWf(ia){return this.nfn(ia)||this.hun(ia)||K.a.L2i(ia)?!1:!0}r5a(ia){ia=ia.ControlId;this.UWf(ia)&&(ia=this.trg(ia),this.xAo(ia),this.AJn(),Array.insert(this.h$,0,new F(ia,Date.now())),this.NLc.length&&(ia=JSON.stringify(this.h$),E.a.instance.setItem(this.NLc,ia)))}NG(ia){this.zJn();Array.insert(this.pGa,0,new F(G.a[ia],Date.now()));this.OLc.length&&(ia=JSON.stringify(this.pGa),E.a.instance.setItem(this.OLc,ia))}cui(ia=!1){if(!this.h$.length){var La=
ia?E.a.instance.getItem(this.OLc):E.a.instance.getItem(this.NLc);if(!La||""===La)return ia?this.pGa:this.h$;let Mb=null;try{Mb=JSON.parse(La)}catch(Ha){this.zrl(ia),Mb=null}if(!Mb||!Mb.length||10<Mb.length)return ia?this.pGa:this.h$;La=0;for(const Ha of Mb)if(ia||this.kc.bge(Ha.Id)&&this.UWf(Ha.Id))if(ia?Array.insert(this.pGa,La++,Ha):Array.insert(this.h$,La++,Ha),La===this.Z8b)break}return ia?this.pGa:this.h$}qqf(ia){ia=this.trg(ia);for(const La of this.h$)if(La.Id===ia)return!0;return!1}zrl(ia=
!1){E.a.instance.setItem(ia?this.OLc:this.NLc,"")}Khn(ia){ia=this.trg(ia.ControlId);return this.UWf(ia)?this.qqf(ia):!1}xAo(ia){if(0<this.h$.length){let La=0;for(const Mb of this.h$){if(Mb.Id===ia){Array.removeAt(this.h$,La);break}La++}}}trg(ia){return"Excel"===this.kc.application&&ia.startsWith("m_excelWebRenderer_ewaCtl_")?ia.substr(26,ia.length):ia}AJn(){this.h$.length===this.Z8b&&Array.removeAt(this.h$,this.h$.length-1)}zJn(){this.pGa.length===this.HEk&&Array.removeAt(this.pGa,this.pGa.length-
1)}nfn(ia){ia=ia.split("|");let La="";if(6<=ia.length)La=ia[0];else if(3<=ia.length){if("3"===ia[0])return!0;La=ia[1]}return La.startsWith("WA")}static createInstance(ia){let La=3;R.AFrameworkApplication.J&&(La=R.AFrameworkApplication.J.jc("TellMeMaxRecommendedResultsToReturn",3));return new N(ia,La)}}Object(I.a)(N,"MruControlsManager",null,[1800]);class O{constructor(ia){this.bHb=ia}Aka(ia,La){let Mb;return ia.BE&&(Mb=this.bHb[ia.value])?Mb.Aka(ia,La):(Mb=this.cvi(ia.value))?Mb.Aka(Mb.dPn,La):null}cFm(ia,
La){if(ia=this.bHb[ia])for(const Mb of La)if(La=K.a.getParameter(Mb),La.key===ia.tig)return La.value;return null}yTn(ia){(ia=this.cvi(ia))&&ia.vTn()}cvi(ia){const La=ia.indexOf(K.a.urj);return 0<La?this.bHb[ia.substring(0,La)]:null}}Object(I.a)(O,"ParameterizedCommandManager",null,[1799]);var U=d(1465);class X{constructor(ia,La){this.Vg=ia;this.Swb=La}}Object(I.a)(X,"TellMeQuery",null,[]);var V=d(1617);class Q{constructor(ia,La){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=ia;this.TimeElapsedSinceClick=
La}}Object(I.a)(Q,"CommandClickedEvent",null,[]);var T=d(1393);class ba{constructor(ia,La){this.bHk=ia;this.Exa=La}Kt(ia){this.bHk(T.c(ia.query)?"":ia.query.Vg,ia.ep,ia.attributes,this.Exa,ia.Boc)}}Object(I.a)(ba,"ResultsUpdatedCallback",null,[1798]);class W{constructor(ia,La,Mb,Ha,zb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=ia;this.TimeElapsedSinceClick=Mb;this.CommandSurface=Ha;this.CommandId=La;this.TerminalParentControlId=
zb}}Object(I.a)(W,"UserActionEvent",null,[]);var aa=d(71);class Y{constructor(ia,La){this.menuModel=ia;this.UGj=La}}Object(I.a)(Y,"GeneratedMenuModel",null,[]);var da=d(650);class ka{constructor(ia,La,Mb){this.kc=ia;this.bHb=La;this.Eja=Mb}Afm(ia,La,Mb){const {TellMeActor:Ha}=d(1407);let zb=0;const ac=new da.a,nc=[];let Gb="";ac.sections=[];let tc=new aa.a;const Qb=!!this.kc&&this.kc.xab;var Yb=!!this.kc&&this.kc.Oyb||R.AFrameworkApplication.ua.Gb.Oyb;for(const ib of ia){ia=0;Qb||(tc=new aa.a);const Jc=
new aa.a;let jd=ib.displayName;for(const Wc of ib.results){if(0<=Wc.value.indexOf(K.a.ICg)){if(Wc.BE){var fc=this.bHb[Wc.value];if(fc&&Wc.value.endsWith(K.a.ICg)){if("FindParameterized"!==Wc.value&&!Yb){const Ad=[];Ad.push(appChrome.actions.setControlLabel(Wc.value,fc.M6d(Wc)));Ad.push(appChrome.actions.setButtonCommandValueId(Wc.value,fc.YGf(Wc)));appChrome.api.dispatch(Ad)}fc=Wc.value.replace(K.a.ICg,"");tc.remove(fc)?ia--:Jc.add(fc);tc.add(Wc.value);ia++}}}else switch(Wc.type){case 5:Jc.contains(Wc.value)||
(tc.add(Wc.value),ia++);break;case 7:tc.add(Wc.BE);ia++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:tc.add(Wc.value),ia++}13===ib.groupType&&(jd=K.a.ota()?0<La.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,La):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,La));21===ib.groupType&&
(jd=CommonUIStrings.l_LearningUILiveText)}zb+=ia;""!==jd&&0<ia&&(Gb+=" , "+ia.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+jd+" , ");0<tc.count&&!Qb&&(ia=appChrome.api.menuSection(tc.toArray(),ib.displayName,null,U.a[ib.groupType]),nc.push(ia))}Yb=null;0<zb&&(Yb=0<La.length?1!==zb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,zb,La):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,La):1!==zb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,
zb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Qb?(La=appChrome.api.menuSection(tc.toArray(),"",null,null),nc.push(La)):Yb+=Gb);Mb&&(this.kc.TAa?Ha.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Yb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Yb)));ac.sections=nc;return new Y(ac,zb,[])}static get fzf(){return ka.ggh||(ka.ggh=new Y(Object.assign(new da.a,{sections:[]}),0,[]))}}ka.ggh=null;Object(I.a)(ka,"TellMeMenuDefintionGenerator",
null,[]);var qa;(function(ia){ia[ia.aSp=0]="TellMeControlActivated";ia[ia.cSp=1]="TellMeQueryExecuted";ia[ia.eSp=2]="TellMeResultsRendered";ia[ia.bSp=3]="TellMeControlDeactivated"})(qa||(qa={}));Object(I.b)("PerformanceMarker",qa);var ua;(function(ia){ia[ia.gSp=0]="TellMeTimeToRender";ia[ia.fSp=1]="TellMeSessionLength";ia[ia.dSp=2]="TellMeResultTriageTime"})(ua||(ua={}));Object(I.b)("PerformanceMeasure",ua);class Pa{mark(ia){window.performance.mark(qa[ia])}measure(ia,La,Mb){const {TellMeActor:Ha}=
d(1407);try{window.performance.measure(ua[ia],qa[La],qa[Mb])}catch(zb){Ha.instance.Ye.onError("TellMePerformance:Measure","error measuring "+ua[ia])}}t5f(ia,La,Mb){const {TellMeActor:Ha}=d(1407);Ha.instance.Ye.D5f(La,Mb,ia,this.Wzm(ia))}csl(){var ia=[0,1,2,3];for(const La of ia)window.performance.clearMarks(qa[La])}clearMeasures(ia){for(const La of ia)window.performance.clearMeasures(ua[La])}Wzm(ia){let La=0;(ia=this.ohm(ia))&&0<ia.length&&(La=ia[ia.length-1].duration);return La}ohm(ia){return window.performance.getEntriesByName(ua[ia],
"measure")}}Object(I.a)(Pa,"TellMePerformance",null,[]);var Ja=d(1513),Ca=d(1512),ra=d(29);class Ea{constructor(ia){this.bQk=ia}Ifd(ia,La,Mb){const {TellMeActor:Ha}=d(1407);Ha.instance.Ye.Lba(La,Ca.a.ruc,ia.data.He.toString(),Math.round(window.performance.now()-Mb),Ca.a.ruc,!0,Ja.a.iWa);ia=ra.b(ia.data.Pe);La=-1;ia.Index&&(La=ia.Index);Ha.instance.Ye.HGn(La,this.bQk)}Yed(ia,La,Mb){const {TellMeActor:Ha}=d(1407);Ha.instance.Ye.Lba(La,Ca.a.ruc,ia.data.He.toString(),Math.round(window.performance.now()-
Mb),Ca.a.ruc,!1,Ja.a.iWa)}HHm(ia){if(ia&&""!==ia.trim()){const Mb=window.performance.now(),Ha=R.AFrameworkApplication.L_j;var La={};La.Text=ia;La.IsFileHash="false";La=ra.c(La);R.AFrameworkApplication.Fe.Xj(Ha,2,La,{"Content-Type":"application/json",Accept:"application/json"},!1,0,zb=>{this.Ifd(zb,ia.length,Mb)},zb=>{this.Yed(zb,ia.length,Mb)},null,null,!1,4E3,6E3)}}}Object(I.a)(Ea,"TellMeQueryIndexCallback",null,[]);var xa=d(1411);class Ma{constructor(ia,La,Mb){this.xml=ia;this.UGj=La;this.cWl=Mb}}
Object(I.a)(Ma,"GeneratedMenuXml",null,[]);var ha=d(1756),la=d(16);class Fa{constructor(ia,La){this.wyd=ia||{};this.G3a=La}get AZb(){return 5}Aka(ia,La=null){return this.G3a.Aka(ia,La)||this.egl(ia.value)}egl(ia){return Fa.olf(ia,this.wyd[ia]||null)}static olf(ia,La=null){ia=String.format('<ClonedControl Id="{0}" ',ia);for(const zb in La){var Mb=zb,Ha=La[zb];Ha=Ha?la.a.yf(Ha.toString()):"";ia+=String.format('{0}="{1}" ',Mb,Ha)}return ia+"/>"}}Object(I.a)(Fa,"CommandMenuItemFactory",null,[1784]);var Ga=
d(228);class va{constructor(){this.Hvk=CommonUIStrings.l_FindInDocumentText}get AZb(){return 8}Aka(ia){var La=ia.BE;ia=la.a.yf(ia.value);const Mb=la.a.yf(La);La=la.a.yf(String.format(this.Hvk,La));return this.Sem(ia,Mb,La)}Sem(ia,La,Mb){return Ga.a(ia,"1540292897",Mb,K.a.e9l,null,La,Mb,null,null)}}Object(I.a)(va,"FindInDocumentMenuItemFactory",null,[1784]);var pa=d(1757),Oa=d(1758);class Ra{constructor(ia=null){this.Rzk=ia||CommonUIStrings.l_InsightsButtonText}get AZb(){return 10}Aka(ia){var La=ia.BE;
ia=K.a.ota()?K.a.jUa(La,1):K.a.ZMb(La);La=String.format(this.Rzk,La);return this.afm(ia,La)}afm(ia,La){return Ga.a(Oa.a.QSi,K.a.ota()?"1914896509":"3317204163",la.a.yf(La),K.a.jVf,null,la.a.yf(ia),la.a.yf(La),null,null)}}Object(I.a)(Ra,"InsightsMenuItemFactory",null,[1784]);var fb=d(1759);class qb{get AZb(){return 7}Aka(ia){const La=Object(w.a)(V.a,ia);return this.Hfm(la.a.yf(ia.value),La.id)}Hfm(ia,La){return Ga.a(La,"1404166600",ia,null,null,ia,ia,null,null)}}Object(I.a)(qb,"TryQueryMenuItemFactory",
null,[1784]);class mb{constructor(ia){this.NS=[];this.kc=ia}asm(ia){for(const La of this.NS)if(La.AZb===ia)return La;return null}ia(ia){this.NS.push(ia)}uuo(ia){this.ia(new Fa(this.kc.$Al,ia));this.ia(new fb.a(this.kc.gSn));this.ia(new ha.a(this.kc.QNo,this.kc.PNo,this.kc.Wjp,this.kc.r0m,this.kc.a4o));this.ia(new Ra);this.ia(new va);this.ia(new pa.a);this.ia(new qb)}}Object(I.a)(mb,"MenuItemFactoryRegistry",null,[]);var eb=d(1413);class bb{constructor(ia,La){this.kc=ia;this.Auh=new mb(this.kc);this.Auh.uuo(La)}Bfm(ia,
La){let Mb=0;const Ha=[],zb=[];for(const nc of ia){ia=K.a.qGg;var ac=[];for(const Gb of nc.results){const tc=this.Auh.asm(Gb.type).Aka(Gb,La);ia=K.a.qGg;ac.push(tc);if(13===Gb.type||14===Gb.type)ia="Menu32";17===Gb.type&&(ia="MenuTellMeExtended");Gb.groupType=nc.groupType;zb.push(Object(w.a)(eb.a,Gb))}Mb=Mb?Mb:ac.length;ac=Ga.d("TellMeDropdownControls",ac);ia=Ga.g("TellMeDropdownMenuSection",ac,ia,nc.displayName);Ha.push(ia)}La=Ga.h(Ha,"LookupDropdownMenu");return new Ma(La,Mb,zb)}static get z0d(){return bb.hgh||
(bb.hgh=new Ma(Ga.h([],"LookupDropdownMenu"),0,[]))}}bb.hgh=null;Object(I.a)(bb,"TellMeXmlGenerator",null,[]);class Wa{}Wa.XPn="MRU";Wa.test="Test";Object(I.a)(Wa,"ActionType",null,[]);var Za=d(1495),Na;(function(ia){ia[ia.qRp=0]="Service";ia[ia.n3b=1]="Local";ia[ia.wPp=2]="MRU";ia[ia.Ujk=3]="TestResult";ia[ia.Unknown=4]="Unknown"})(Na||(Na={}));Object(I.b)("SubResultType",Na);var Db=d(81);class nb{constructor(ia,La,Mb,Ha,zb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=
this.ResultType=null;this.CommandId=ia;this.IsEnabled=La;this.ResultType=G.a[Mb];this.SubResultType=Na[Ha];this.OptionalData=zb?Db.a.toJSON(zb):null}}Object(I.a)(nb,"ResultInfo",null,[]);var Ta=d(122),cb=d(185),sb=d(302);class pb{constructor(ia,La=null){this.IDd="TellMeWAC.";this.DIk=ia;this.hRk=La}ENa(ia,La,Mb){La=Ta.a.iI(La);ia=Ta.a.ttf(ia,this.DIk,this.hRk,Mb,La);cb.a.ENa(ia,this.IDd)}DNa(ia,La,Mb=0){La=Ta.a.iI(La);cb.a.DNa(Object.assign(new sb.a,{name:ia,dataFields:La,durationMs:Mb}),this.IDd)}}
Object(I.a)(pb,"TellMeOtelLogger",null,[1810]);var tb=d(118);class wb{constructor(ia,La,Mb,Ha,zb,ac,nc){this.k$=this.Vda=this.Gbh=null;this.vPa=ia;this.ohb=La;this.jSa=Mb;this.Yib=Ha;this.Q2a=zb;this.uCk=ac;this.k$=nc?nc:new pb(this.Yib?x.a.HCg:x.a.RBe)}get Bs(){return this.Yib}get Aua(){return this.jSa}Exe(ia){this.Gbh=ia;switch(ia){case xa.a.contextMenu:this.Vda=xa.a.contextMenu;break;default:this.Vda=xa.a.mu}}Mcl(ia,La){this.jSa.Usa||(this.jSa.Usa=tb.a.create().toString(),this.H9i(ia,!0,La))}xji(ia,
La=!0){this.jSa.Usa&&this.rEn(ia,La);this.Yib&&appChrome.api.updateTellMeCorrelationId("");this.jSa.Usa=null}H9i(ia,La,Mb){const {TellMeActor:Ha}=d(1407),zb=this.oaa(y.a.v$a);zb[Za.a.culture]=this.ohb;zb[Za.a.appName]=this.vPa;zb[Za.a.context]=ia;zb[Za.a.gfe]=this.Q2a;zb[Za.a.fun]=this.uCk;zb[Za.a.Msn]=Mb;zb[Za.a.vmn]=La;zb[Za.a.contentType]=Ha.instance.XYd;this.k$.ENa(y.a.v$a,zb,this.Gbh);this.Yib&&appChrome.api.updateTellMeCorrelationId(this.jSa.Usa)}rEn(ia,La){const Mb=this.oaa(y.a.CSb);Mb[Za.a.cZl]=
ia;Mb[Za.a.umn]=La;this.k$.DNa(y.a.CSb,Mb)}GGn(ia,La,Mb){let Ha=0;!Mb&&0<ia.length&&(Ha=ia.trim().split(" ").length);const zb=this.oaa(y.a.query);zb[Za.a.query]="!";zb[Za.a.nYb]=La;zb[Za.a.fxj]=ia.length;zb[Za.a.j4i]=Mb;zb[Za.a.aLp]=Ha;this.k$.ENa(y.a.query,zb,this.Vda)}IFn(ia,La,Mb,Ha,zb,ac,nc,Gb=null){const tc=this.oaa(y.a.latency);tc[Za.a.culture]=this.ohb;tc[Za.a.fxj]=ia;tc[Za.a.N4j]=La;tc[Za.a.statusCode]=Mb;tc[Za.a.service]=zb;tc[Za.a.isSuccess]=ac;tc[Za.a.Dyn]=nc;Gb&&(tc[Za.a.Kmp]=Gb);this.k$.DNa(y.a.latency,
tc,Ha)}D5f(ia,La,Mb,Ha){const zb=this.oaa(y.a.performance);zb[Za.a.culture]=this.ohb;zb[Za.a.Qcl]=qa[ia];zb[Za.a.C0l]=qa[La];zb[Za.a.Jbo]=ua[Mb];this.k$.DNa(y.a.performance,zb,Ha)}PGn(ia,La){var {TellMeActor:Mb}=d(1407);const {CommandResultsUtility:Ha}=d(1477);if(ia.results.length){var zb=this.oaa(y.a.BEj);zb[Za.a.Xaa]=La.toString();zb[Za.a.groupType]=U.a[ia.groupType];16===ia.groupType&&(zb[Za.a.hsn]=Mb.instance.ztd);La=[];Mb=[];var ac=[];for(const nc of ia.results)zb[Za.a.resultType]||(zb[Za.a.resultType]=
G.a[nc.type]),ia={},27===nc.type&&(ia.AssetId=nc.TK),Mb.push(Ha.G8c(nc.value)),La.push(nc.value),ac.push(new nb(nc.value,Ha.G8c(nc.value),nc.type,nc.subType,ia));0<La.length&&(zb[Za.a.EIo]="{"+La.join(", ")+"}",zb[Za.a.$_l]="{"+Mb.join(", ")+"}",zb[Za.a.zIo]=ra.c(ac));this.k$.ENa(y.a.BEj,zb,this.Vda)}}pgm(ia,La){if(4===ia)return Wa.XPn;switch(La){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G.a[La]}VDn(ia,
La,Mb,Ha,zb){const ac=this.oaa(y.a.click);ac[Za.a.N4j]=ia;ac[Za.a.C$n]=La;ac[Za.a.commandId]=Mb;ac[Za.a.w6]=Ha;ac[Za.a.actionType]=this.pgm(zb.groupType,zb.resultType);ac[Za.a.resultType]=G.a[zb.resultType];ac[Za.a.BEg]=Na[zb.BEg];ac[Za.a.groupType]=U.a[zb.groupType];ac[Za.a.Xaa]=zb.Xaa.toString();ac[Za.a.dxf]=zb.dxf.toString();ac[Za.a.resultIndex]=zb.resultIndex.toString();this.k$.ENa(y.a.click,ac,this.Vda)}aEn(ia,La){this.jSa.Usa||(this.jSa.Usa=tb.a.create().toString(),this.H9i("",!1,La));La=this.oaa(y.a.j7h);
La[Za.a.nYb]=ia;this.k$.DNa(y.a.j7h,La)}a$i(ia,La,Mb){if(ia){if(Mb)for(const Ha in Mb)ia[Ha]=Mb[Ha];this.k$.DNa(y.a.events,ia,La)}}DI(ia,La,Mb=null){const Ha=this.oaa(y.a.events);Ha[Za.a.event]=ia;this.a$i(Ha,Math.round(La),Mb)}iga(ia,La,Mb=null){const Ha=this.oaa(y.a.events);Ha[Za.a.event]=y.a.error;Ha[Za.a.module]=ia;Ha[Za.a.errorMessage]=La;Ha[Za.a.message]=La;this.a$i(Ha,Math.round(window.performance.now()),Mb)}TDn(ia){const La=this.oaa(y.a.f4h);La[Za.a.value]=ia;La[Za.a.Lse]=this.Yib;this.k$.ENa(y.a.f4h,
La,this.Vda)}kDn(ia){const La=this.oaa(y.a.KLh);La[Za.a.value]=ia;La[Za.a.Lse]=this.Yib;this.k$.ENa(y.a.KLh,La,this.Vda)}NEn(ia){const La=this.oaa(y.a.Gni);La[Za.a.value]=ia;La[Za.a.Lse]=this.Yib;this.k$.ENa(y.a.Gni,La,this.Vda)}EGn(ia){const La=this.oaa(y.a.ywj);La[Za.a.value]=ia;La[Za.a.Lse]=this.Yib;this.k$.ENa(y.a.ywj,La,this.Vda)}yDn(ia){const La=this.oaa(y.a.dMj);La[Za.a.value]=ia;this.k$.ENa(y.a.dMj,La,this.Vda)}IGn(ia,La){const Mb=this.oaa(y.a.axj);Mb[Za.a.ruc]=ia;La&&(Mb[Za.a.Usa]=La);this.k$.DNa(y.a.axj,
Mb)}oaa(ia){return{["SessionID"]:this.jSa.sessionId,["CorrelationID"]:this.jSa.Usa,["Time"]:(new Date).getTime(),["Event"]:ia,["Scenario"]:this.Vda}}}Object(I.a)(wb,"UsageLogger",null,[1797]);var gc=d(83),vc=d(1707),Pc=d(1181),ld=d(1474),Dc=d(91),ic=d(74),mc=d(1180),Rc=d(607),rb=d(17),Cb=d(633),Kb=d(87),$b=d(12);d.d(J,"TellMeActor",function(){return ab});class ab{constructor(){this.G3a=this.G5=this.Zb=this.Aa=this.ES=this.uv=this.Jb=this.ga=this.Ye=this.GM=this.M_e=this.VKh=this.Ppa=this.kc=null;
this.q8b=!1;this.OMe=[];this.Cbh=[];this.EJh=[];this.jvh=[];this.kvh=[];this.eqh=!1;this.b5b=this.Eja=null;this.LJc=this.Q2a=!1;this.ZGd=!0;this.Q1=this.LIc=this.Yjh=this.a0e=this.Wuh=null;this.X0=[];this.qhb=this.K5b=this.vFa=this.VJd=this.fFh=null;this.D7b=!1;this.U_e=0;this.z4b=null;this.Exa=-1;this.Cuh=0;this.TJc=!1;this.Uhb=null;this.zJh=!1;this.B4b=this.vr=null;this.s_d=(ia,La,Mb,Ha,zb)=>{if(La.contextId===Kb.a.frame)switch(ia){case $b.a.mu:return this.mu(ia,La,Mb,Ha,zb);case $b.a.pGg:return this.wYh(ia,
La,Mb,Ha,zb);case $b.a.uGg:return this.s$i(ia,La,Mb,Ha,zb);case $b.a.xGg:return this.S9i(ia,La,Mb,Ha,zb);case $b.a.wGg:return this.o$i(ia,La,Mb,Ha,zb);case $b.a.sGg:return this.v$a(ia,La,Mb,Ha,zb);case $b.a.zGg:return this.pIo(Mb);case $b.a.vGg:return this.n$i(ia,La,Mb,Ha,zb);case $b.a.yGg:return this.R9i(ia,La,Mb,Ha,zb);case $b.a.Zqd:return this.Gpi(ia,La,Mb,Ha,zb);case $b.a.oGg:return this.Y5h(ia,La,Mb,Ha,zb);case $b.a.AGg:case $b.a.O2f:return this.eVf(ia,La,Mb,Ha,zb);case $b.a.aCf:case $b.a.bCf:case $b.a.cCf:case $b.a.dCf:case $b.a.eCf:case $b.a.Hgg:case $b.a.Igg:case $b.a.Jgg:case $b.a.BGg:return this.AYa(ia,
La,Mb,Ha,zb);case $b.a.fjg:case $b.a.gjg:case $b.a.hjg:return this.q$a(ia,La,Mb,Ha,zb);case $b.a.rGg:return this.ppj(ia,La,Mb,Ha,zb);case $b.a.fgf:case $b.a.ggf:case $b.a.hgf:return this.Lge(ia,La,Mb,Ha,zb);case $b.a.D0b:return this.D0b(ia,La,Mb,Ha,zb);case $b.a.m2f:return this.I5i(ia,La,Mb,Ha,zb);case $b.a.fog:return this.Cxj(ia,La,Mb,Ha,zb);case $b.a.kFf:return this.Xri(ia,La,Mb,Ha,zb)}return 2};this.Cxj=(ia,La,Mb,Ha,zb)=>{if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:QuickActionOnFileHandler",
"actiondata comes null"),16;this.Zb.zDf();if(ia=zb.TerminalParentControlId){ia=this.B4b.K(ia);if(!ia)return 16;La=[];Array.add(La,ia);if(!this.X5i(La))return 8}return 32};this.Xri=()=>{if(!this.B4b.count)return 16;const ia=[];for(const La of this.B4b.values)Array.add(ia,La);return this.X5i(ia)?32:8};this.q$a=(ia,La,Mb,Ha,zb)=>{if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:InsertMention","actiondata comes null"),16;ia=zb.UILocation;let ac;zb=zb.CommandValueId;try{ac=ra.a(zb)}catch(nc){return this.Ye.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return T.c(ac)?(this.Ye.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):T.c(this.LIc)?(this.Ye.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==ia?(this.Ye.onError("TellMeActor:InsertMention","location "+ia+" is unexpected"),16):this.LIc.q$a(ac.displayName,ac.email,ac.userId)?32:(this.Ye.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.AYa=(ia,La,Mb,Ha,zb)=>1===Mb?32:
T.c(zb)?(this.Ye.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===zb.UILocation?this.gcn(Mb,zb):this.YWb(ia,La,Mb,Ha,zb);this.ppj=(ia,La,Mb,Ha,zb)=>{if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.vr&&window.setTimeout(()=>{this.vr.execute(ac=>{ac.meb("TellMeSurvey",null)})},ab.t6l);return 32};this.ECa=(ia,La,Mb,Ha,zb)=>{Mb=window.performance.now();this.Hdo(La);this.Ye.sWo(La);this.kc.Bs?(this.qhb=this.M_e.Afm(La,
ia,zb),this.kc.TAa?(this.X0.push(appChrome.actions.updateTellMeSearchResults(this.qhb.menuModel,ia,zb)),appChrome.api.dispatch(this.X0)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.qhb.menuModel,ia,zb)),this.kc.eFe&&this.D7b&&(T.c(this.Q1)||this.Q1.Location!==xa.a.contextMenu)&&(this.GM.mark(2),this.GM.measure(0,1,2))):this.vFa=this.VKh.Bfm(La,this.Ye.Aua);this.z4b&&this.Jb.$b(this.z4b);zb={};zb.GroupsCount=La.length;zb.QueryID=Ha;zb.QueryLength=ia.length;this.Ye.gC(y.a.LJl,
window.performance.now()-Mb,zb)};this.I5i=(ia,La,Mb,Ha,zb)=>{if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){ia={};ia.SourceControlId=zb.SourceControlId;ia.Query=zb.CommandValueId;zb=this.ga.Qb($b.a.Zad,2,ia);if(32!==zb)this.Ye.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+zb+".");
return zb}return this.ga.Qb($b.a.Zad,2,zb)};this.Lge=(ia,La,Mb,Ha,zb)=>{({AddinResultsProvider:ia}=d(1648));if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Mb=zb.CommandValueId;if(T.b(Mb))return this.Ye.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!ia.AKb[Mb])return this.Ye.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Mb+" doesn't not exist in entitlements"),16;zb=d(1648).AddinResultsProvider.AKb[Mb];ia={};
ia.solutionId=zb.id;ia.version=zb.appVersion;ia.storeType=zb.storeType;ia.storeId=zb.storeId;ia.assetId=zb.assetId;ia.assetStoreId=zb.assetStoreId;ia.displayName=zb.displayName;ia.targetType=zb.targetType;ia.height=zb.height;ia.width=zb.width;zb=this.ga.Qb($b.a.QUf,2,ia);if(32!==zb)this.Ye.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+zb+". AssetId: "+Mb);return zb};this.D0b=()=>{if(!T.c(this.vr))for(const ia of z.a.instance.hqb()){if("ShowContextMenuWithFloatie"===
ia.commandId)return this.vr.execute(La=>{La.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(ia.commandId&&-1===ia.commandId.indexOf("Tab"))break}return 8}}get XYd(){return this.ES?this.ES.contentType:ab.unknown}get actions(){return this.X0}set actions(ia){this.X0=ia}Z8d(){return this.Ye?this.Ye.Aua.Usa:null}yR(){return this.kc}get KOn(){return this.ZGd}get AGp(){return this.Wuh}performance(){return this.GM}get yCg(){return this.fFh}set yCg(ia){this.fFh=ia}get ztd(){return this.zJh}set ztd(ia){this.zJh=
ia}eJ(ia){const La=window.performance.now();this.Eja&&!T.c(ia)&&(this.Eja(ia),this.Ye.gC(y.a.eJ,window.performance.now()-La))}initialize(ia,La=null,Mb=null,Ha=null,zb=null,ac=null,nc=null,Gb=null,tc=null,Qb=null,Yb=null){const {InteractionLogger:fc}=d(2028),{GroupsPlacementInfo:ib}=d(2026),{AggregatorResultsProvider:Jc}=d(1788);this.kc=ia;this.Q2a=!!R.AFrameworkApplication.ua&&R.AFrameworkApplication.ua.Gb.Roc;this.Ye=Ha;if(!Ha){Ha=new D;Ha.sessionId=R.AFrameworkApplication.userSessionId;const jd=
Cb.a.Eg(R.AFrameworkApplication.lcid)||Cb.a.i8c;this.Ye=new fc(new wb(this.kc.application,jd.name,Ha,this.kc.Bs,this.Q2a,ia.V_a,null),this.kc.dBl,this.kc)}this.G3a=new O(this.kc.parameterData);this.VKh=Mb||new bb(this.kc,this.G3a);this.Eja=nc;this.M_e=this.M_e||new ka(this.kc,this.kc.parameterData,nc);this.Zb=gc.FocusManager.instance();this.G5=N.createInstance(this.kc);this.Yjh=new ib(ia);this.ga=zb||R.AFrameworkApplication.va;this.Jb=ac||R.AFrameworkApplication.pc;this.uv=tc;this.Ppa=La;this.vr=
Yb;this.GM=new Pa;this.B4b=new m.a(f.a.vh());this.VJd=[];tc?tc.execute(jd=>{jd.isFeatureEnabled(ab.Kjp,!0).then(Wc=>{const {AggregatorResultsProvider:Ad}=d(1788);this.TJc=Wc;this.Ppa=this.Ppa||Ad.createInstance(this.G5,this.kc,this.G3a,this.TJc);for(const Yd of this.VJd)this.Ppa.NG(Yd.provider,Yd.jfb);this.VJd=[];return null})}):(this.TJc=!0,this.Ppa=this.Ppa||Jc.createInstance(this.G5,this.kc,this.G3a,this.TJc));this.Aa=Gb;this.vFa=bb.z0d;this.Wuh=new Promise(jd=>{this.a0e=jd});Qb&&Qb.execute(jd=>
{this.ES=jd})}Xb(){this.p_k()}Rvo(ia){this.LIc=ia}p_k(){this.ga.fb($b.a.mu,Kb.a.frame,Object(a.a)(this,this.mu,"tellMe"),96);this.ga.fb($b.a.pGg,Kb.a.frame,Object(a.a)(this,this.wYh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb($b.a.uGg,Kb.a.frame,Object(a.a)(this,this.s$i,"logItemExecuted"),96);this.ga.fb($b.a.xGg,Kb.a.frame,Object(a.a)(this,this.S9i,"logControlDeactivation"),96);this.ga.fb($b.a.wGg,Kb.a.frame,Object(a.a)(this,this.o$i,"logInputFocus"),96);this.ga.fb($b.a.sGg,Kb.a.frame,Object(a.a)(this,
this.v$a,"interactionBegin"),96);this.ga.fb($b.a.zGg,Kb.a.frame,Object(a.a)(this,this.v$a,"interactionBegin"),96);this.ga.fb($b.a.vGg,Kb.a.frame,Object(a.a)(this,this.n$i,"logInputBlur"),96);this.ga.fb($b.a.yGg,Kb.a.frame,Object(a.a)(this,this.R9i,"logControlActivated"),96);this.ga.fb($b.a.Zqd,Kb.a.frame,Object(a.a)(this,this.Gpi,"focusSearchBox"),96);this.ga.fb($b.a.oGg,Kb.a.frame,Object(a.a)(this,this.Y5h,"constructLiveNotificationForMenu"),96);this.ga.fb($b.a.AGg,Kb.a.frame,Object(a.a)(this,this.eVf,
"insertTryQuery"),96);this.ga.fb($b.a.O2f,Kb.a.frame,Object(a.a)(this,this.eVf,"insertTryQuery"),96);this.ga.fb($b.a.aCf,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.bCf,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.cCf,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.dCf,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.eCf,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.Hgg,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.Igg,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.Jgg,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.fjg,Kb.a.frame,this.q$a,96);this.ga.fb($b.a.gjg,
Kb.a.frame,this.q$a,96);this.ga.fb($b.a.hjg,Kb.a.frame,this.q$a,96);this.ga.fb($b.a.rGg,Kb.a.frame,this.ppj,96);this.ga.fb($b.a.BGg,Kb.a.frame,this.AYa,96);this.ga.fb($b.a.fgf,Kb.a.frame,this.Lge,96);this.ga.fb($b.a.ggf,Kb.a.frame,this.Lge,96);this.ga.fb($b.a.hgf,Kb.a.frame,this.Lge,96);this.ga.fb($b.a.D0b,Kb.a.frame,this.D0b,96);this.ga.fb($b.a.m2f,Kb.a.frame,this.I5i,96);this.ga.fb($b.a.fog,Kb.a.frame,this.Cxj,96);this.ga.fb($b.a.kFf,Kb.a.frame,this.Xri,96)}Gto(ia){this.ZGd=!1;const La=window.performance.now();
ia.Uab.isCompleted?(this.ZGd=!0,this.a0e(!0)):ia.Z1(()=>{this.ZGd=!0;this.a0e(!0);this.Ye.gC(y.a.ARl,window.performance.now()-La)});this.zuo(ia)}zuo(ia){Rc.a.ate(this.s_d);Rc.a.m_c([new mc.a($b.a.mu,Kb.a.frame,96),new mc.a($b.a.pGg,Kb.a.frame,96),new mc.a($b.a.uGg,Kb.a.frame,96),new mc.a($b.a.xGg,Kb.a.frame,96),new mc.a($b.a.wGg,Kb.a.frame,96),new mc.a($b.a.sGg,Kb.a.frame,96),new mc.a($b.a.zGg,Kb.a.frame,96),new mc.a($b.a.vGg,Kb.a.frame,96),new mc.a($b.a.yGg,Kb.a.frame,96),new mc.a($b.a.Zqd,Kb.a.frame,
96),new mc.a($b.a.oGg,Kb.a.frame,96),new mc.a($b.a.AGg,Kb.a.frame,96),new mc.a($b.a.O2f,Kb.a.frame,96),new mc.a($b.a.aCf,Kb.a.frame,96),new mc.a($b.a.bCf,Kb.a.frame,96),new mc.a($b.a.cCf,Kb.a.frame,96),new mc.a($b.a.dCf,Kb.a.frame,96),new mc.a($b.a.eCf,Kb.a.frame,96),new mc.a($b.a.Hgg,Kb.a.frame,96),new mc.a($b.a.Igg,Kb.a.frame,96),new mc.a($b.a.Jgg,Kb.a.frame,96),new mc.a($b.a.fjg,Kb.a.frame,96),new mc.a($b.a.gjg,Kb.a.frame,96),new mc.a($b.a.hjg,Kb.a.frame,96),new mc.a($b.a.rGg,Kb.a.frame,96),new mc.a($b.a.BGg,
Kb.a.frame,96),new mc.a($b.a.fgf,Kb.a.frame,96),new mc.a($b.a.ggf,Kb.a.frame,96),new mc.a($b.a.hgf,Kb.a.frame,96),new mc.a($b.a.D0b,Kb.a.frame,96),new mc.a($b.a.m2f,Kb.a.frame,96),new mc.a($b.a.fog,Kb.a.frame,96),new mc.a($b.a.kFf,Kb.a.frame,96)],ia)}Gpi(ia,La,Mb){if(1===Mb)return 32;this.OPj();ia=!1;(this.kc.V_a||this.Q2a)&&(La=document.getElementById("SearchButton"))&&La.click();if(!this.kc.V_a&&this.Q2a)for(La=document.getElementsByClassName("ms-suiteux-search-box"),Mb=0;Mb<La.length;Mb++){const Ha=
La[Mb].querySelector("input[type=search]");Ha&&(ia=gc.FocusManager.LN(Ha))}else ia=gc.FocusManager.LN($get(this.kc.Bs?x.a.HCg:x.a.RBe));this.LJc=!0;return ia?32:8}eVf(ia,La,Mb,Ha,zb){if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.OPj();ia=zb.CommandValueId;La=this.kc.Bs?x.a.HCg:x.a.RBe;this.kc.Bs&&!T.c(zb[Pc.a.t_a])&&(zb[Pc.a.t_a]=!1);if(ia){if(this.kc.Bs)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ia)),
this.Uhb=[19],32;if(zb=$get(La))zb.value=ia}return gc.FocusManager.LN($get(La))?32:8}OPj(){this.Zb.EN(this.kc.V_a||this.Q2a?this.kc.CRb:this.kc.pdb,!1)}ggm(ia,La){switch(ia){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,La);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,La);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,La);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
La)}return La}Y5h(ia,La,Mb,Ha,zb){if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;ia=this.vFa?this.vFa.UGj:0;zb.Value=1!==ia?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,ia):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.vFa)for(const ac of this.vFa.cWl)zb=Object(l.a)(V.a,ac)?ac.id:la.a.replaceAll(ac.value,'"',""),(zb=$get(zb+"-"+K.a.qGg))&&ic.a.Is(zb,ic.a.Wja,la.a.yf(this.ggm(ac.groupType,
zb.innerText)));return 32}wYh(ia,La,Mb,Ha,zb){if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.z4b=new Dc.a(2,1,0,()=>{zb[vc.a.Callback]()},97);this.vFa&&this.Jb.$b(this.z4b);return 32}s$i(ia,La,Mb,Ha,zb){if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;zb.CloseAllMenus&&(ia=void 0===zb.ParentControlId||null===zb.ParentControlId?"<NA>":zb.ParentControlId,
La=this.b5b?this.b5b[zb.ControlId]:null,!La&&this.b5b&&"<NA>"!==ia&&(La=this.b5b[ia]),La||(La=this.q8b&&this.G5.Khn(zb),La=this.WSl(La,zb.ControlId),La=new u(La,32,4,-1,-1,-1),this.Ye.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+zb.ControlId+" determined group:"+U.a[La.groupType])),this.Ye.yXn(zb.ControlId,ia,zb.CommandId,zb.CloseAllMenus,La),this.G3a.yTn(zb.ControlId),zb.Location!==xa.a.contextMenu&&(this.G5.r5a(zb),this.G5.NG(La.resultType),this.kc.Hye&&this.Ppa.$Xk(zb.CommandId)));
return 32}S9i(ia,La,Mb,Ha,zb){if(1===Mb)return 32;(new Ea(this.Z8d())).HHm(this.K5b);ia=this.K5b;La=this.Exa;Mb=this.Ye.Xyd;if(T.c(zb))return this.Ye.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;zb=zb.UILocation;ia&&0<ia.length&&this.TJc&&K.a.zAg(this.kc)&&this.kc.Jfe&&19!==zb&&La>Mb&&!this.kc.oS&&(this.Ye.F5f(ia),this.Ye.Mxg(La));this.Ye.cHo();this.kc.eFe&&19!==zb&&(this.GM.mark(3),this.GM.measure(1,0,3),this.GM.measure(2,2,3),this.GM.t5f(0,1,2),this.GM.t5f(2,2,3),this.GM.t5f(1,
0,3),this.GM.csl(),this.GM.clearMeasures([0,2,1]));this.Ye.$Xn(window.performance.now()-this.U_e);this.kc.Bs&&(this.qhb=null,this.Ye.xCa());this.LJc=this.D7b=!1;this.K5b="";return 32}o$i(ia,La,Mb){if(1===Mb)return 32;this.Ye.Wvb(v(La),this.LJc);return 32}n$i(ia,La,Mb){if(1===Mb)return 32;this.Ye.xCa();this.D7b=!1;return 32}R9i(ia,La,Mb,Ha,zb){if(1===Mb)return 32;this.Q1=null;zb&&(this.Q1=zb);this.kc.eFe&&(T.c(this.Q1)||this.Q1.Location!==xa.a.contextMenu)&&this.GM.mark(0);this.Ye.Exe(T.c(this.Q1)||
T.c(this.Q1.Location)?xa.a.unknown:this.Q1.Location);this.Ye.ZXn(this.Cuh,this.LJc);this.D7b||this.Rbb();return 32}N9h(ia,La){const Mb=[],Ha=Date.now();for(const zb of ia)ia=(Ha-zb.timeStamp)/1E3,ia=K.a.kDe(ia),Array.add(Mb,new Q(La?zb.commandId:zb.controlId,ia));return Mb}ULl(ia){const La=[],Mb=Date.now();for(const Ha of ia)if(Ha.controlId||"keyboardShortcut"===Ha.commandSurface)ia=(Mb-Ha.timeStamp)/1E3,ia=K.a.kDe(ia),Array.add(La,new W(Ha.controlId,Ha.commandId,ia,Ha.commandSurface,Ha.VBe));return La}C$h(ia=
!1){var La=ia?this.G5.BHm():this.G5.v2c();ia=[];const Mb=Date.now();for(const Ha of La)La=(Mb-Ha.TimeStamp)/1E3,La=K.a.kDe(La),Array.add(ia,new Q(Ha.Id,La));return ia}Rbb(){if(!this.D7b){this.q8b=this.D7b=!0;if(!this.eqh){this.eqh=!0;const ia={};ia.IsMLREnabled=this.kc.fon;ia.IsReactRibbonEnabled=this.kc.Bs;ia.IsSharedHeaderEnabled=!!R.AFrameworkApplication.ua&&R.AFrameworkApplication.ua.Gb.tN;ia.IsSearchUxEnabled=this.Q2a;ia.IsTellMeInHeaderEnabled=this.kc.V_a;ia.IsGoLocalEnv=K.a.jln();ia.IsSovereignEnvironment=
K.a.Woc();ia.IsTellMeServiceResultsEnabled=K.a.zAg(this.kc);ia.IsSubstrateProviderEnabled=K.a.yAg(this.kc);ia.ShouldFetchTokens=!!R.AFrameworkApplication.ua&&R.AFrameworkApplication.ua.Gb.l0b;ia.IsSerpletEnabled=K.a.ota();ia.FirstOnClickTimeInMS=Math.round(window.performance.now());ia.IsHeaderHidden=R.AFrameworkApplication.hideHeader||R.AFrameworkApplication.K_;ia.IsSearchInHeaderHidden=R.AFrameworkApplication.g6c;void 0!==window.performance.timing&&null!==window.performance.timing&&(ia.TimeSinceFetchStart=
Math.round(Date.now()-window.performance.timing.fetchStart));ia.IsFindWithMatchesEnabled=this.kc.M2d;ia.HelpShowsTopSearchResult=this.kc.Uod;ia.HelpShowsNumberOfMatches=this.kc.Tod;R.AFrameworkApplication.J&&(ia.UiHost=R.AFrameworkApplication.J.jb("UiHostIntegrationType"));this.Ye.$Gn(JSON.stringify(ia))}this.OMe=this.N9h(z.a.instance.l2c(),!1);this.Cbh=this.N9h(z.a.instance.hqb(),!0);this.EJh=this.ULl(z.a.instance.hqb());this.jvh=this.C$h();this.kvh=this.C$h(!0);this.Ye.Rbb()}}v$a(ia,La,Mb,Ha,zb){if(1===
Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(rb.a.A9c)return 32;this.U_e=window.performance.now();this.Rbb();ia=new ba(this.ECa,0);this.Exa++;this.Ye.beginQuery("",this.Exa,this.q8b);this.rKg(!0,null);this.vFa=bb.z0d;this.qhb=ka.fzf;if(this.Ppa)ab.instance.actions=[],this.Ppa.XJ(new X("",this.Exa),ia,this.kc.Bs);else this.Ye.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.z4b&&this.Jb.$b(this.z4b);
return 32}pIo(ia){if(1===ia)return 32;this.Zb.bV(this.kc.V_a||this.Q2a?this.kc.CRb:this.kc.pdb,!1);return 32}mu(ia,La,Mb,Ha,zb){if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:TellMe","actiondata comes null"),16;this.Q1=zb;this.Ye.Exe(T.c(this.Q1.Location)?xa.a.unknown:this.Q1.Location);ia=this.Q1.Value;this.kc.Bs||ia&&""!==ia.trim()?(!this.qhb&&this.kc.Bs&&(this.Ye.Wvb(v(La),this.LJc),this.Rbb()),this.h4l(ia,this.Q1.Location),this.Q1.PopulationXML=this.vFa.xml):this.q8b?this.Q1.PopulationXML=
this.vFa.xml:(this.Q1.PopulationXML=bb.z0d.xml,this.qhb=ka.fzf,this.K5b="");return 32}h4l(ia,La){this.U_e=window.performance.now();this.kc.eFe&&La!==xa.a.contextMenu&&this.GM.mark(1);this.kc.Bs&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ia));ia&&0<ia.trim().length&&(this.q8b=!1);this.kc.B2l();La=T.c(La)?xa.a.mu:La;if(ia!==this.K5b||this.kc.Bs){this.Exa++;this.Ye.beginQuery(ia,this.Exa,this.q8b);this.rKg(!0,null);const Mb=new X(ia,this.Exa),Ha=new ba(this.ECa,this.Exa);this.vFa=
bb.z0d;this.qhb=ka.fzf;if(this.Ppa)ab.instance.actions=[],this.Ppa.XJ(Mb,Ha,this.kc.Bs,La,this.Uhb),this.Uhb=null;else this.Ye.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Cuh=this.Exa;this.K5b=ia}}Cyp(ia){if(this.kc.Bs){var La=appChrome.selectors.getActiveControlStates();if(La=Object(w.a)(Object,La[ia.value])){ia.label=La.label;let Mb=null;"description"in La&&(Mb=La.description);Mb&&Object.getType(Mb)===String?ia.description=Mb:"secondaryText"in La?ia.description=
La.secondaryText:"fullDescriptionLabel"in La&&(ia.description=La.fullDescriptionLabel)}}}Hdo(ia){this.b5b={};let La=0,Mb=0;for(const Ha of ia){ia=0;for(const zb of Ha.results)this.b5b[zb.value]=new u(zb.groupType,zb.type,zb.subType,La,ia,Mb),ia++,Mb++,zb.label||5!==zb.type||this.Cyp(zb);0<ia&&La++}}YWb(ia,La,Mb,Ha,zb){if(1===Mb)return 32;if(T.c(zb))return this.Ye.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(ia=zb.CommandValueId)&&window.open(ia,"_blank");return 32}X5i(ia){const La=
{};La.token=this.yCg;La.files=ra.c(ia);La.type="MultiFilesDeckGeneration";if(R.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb($b.a.Wyn,2,La),!0;ia=K.a.HGi("",K.a.WGj("GenerateDeckFromFile"),Object.assign(new ld.a,{landingTab:"All",data:La}));ia=this.ga.Qb($b.a.bba,2,ia);return 32!==ia?(this.Ye.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+ia+"."),!1):!0}gcn(ia,La){if(1===ia)return 32;
if(T.c(La))return this.Ye.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(T.c(this.LIc))return this.Ye.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;ia=La.CommandValueId;return T.c(ia)?(this.Ye.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.LIc.insertHtmlText(ia)?32:(this.Ye.onError("TellMeActor:InsertUrl","url is not inserted"),16)}WSl(ia,La){return La.startsWith(this.kc.Bs?K.a.aJg:K.a.yDe)?5:ia?4:"bSearchHelp"===La||La.startsWith("GetHelpFromTellMe")?
8:"bInsights"===La||La.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===La?24:La===this.kc.rCf?2:0}NG(ia,La){this.Ppa?this.Ppa.NG(ia,La):Array.add(this.VJd,new H(ia,La))}rKg(ia,La="",Mb=null){ia?this.B4b=new m.a(f.a.vh()):La&&Mb&&this.B4b.add(La,Mb)}static get instance(){return ab._instance||(ab._instance=new ab)}}ab._instance=null;ab.Kjp="mso_tellMeService";ab.unknown="Unknown";ab.t6l=500;Object(I.a)(ab,"TellMeActor",null,[])},1409:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);
var m=d(1429);class f{constructor(a,l){this.Zib=!1;const {Annotations:w}=d(1401);if(!a)throw Error.argumentNull("annotations");if(!a.V0f(l))throw Error.argument("memberTypeID","Invalid type ID");if(w.nK(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Lx=a;this.QEk=l;this.iq=[]}get Occ(){return this.Lx}get isReadOnly(){return this.Zib}get U7(){return this.QEk}get items(){return this.iq}bia(){const {Annotations:a}=d(1401);let l="[";for(let w=0,z=this.items.length;w<z;++w){0<
w&&(l+=", ");const x=this.Lx.bia(this.U7,this.items[w]);this.U7===a.Qca?(l+='"',l+=m.a.CAf(x),l+='"'):l+=x}return l+"]"}isEqual(a){const {Annotations:l}=d(1401);if(this===a)return!0;if(!a||a.Occ!==this.Lx||a.U7!==this.U7||a.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!l.UAb(this.U7,this.items[w],a.items[w]))return!1;return!0}clone(){const a=new f(this.Lx,this.U7);Array.addRange(a.items,this.items);return a}HW(){return this.isReadOnly?this.clone():this}U4f(){const {Annotations:a}=
d(1401);if(!this.isReadOnly){this.Zib=!0;for(const l of this.items)a.$Ub(l)}}toString(){return this.bia()}}Object(I.a)(f,"ListValue",null,[1823,1821])},1411:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.mu="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(I.a)(m,"TellMeScenario",null,[])},1413:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a,l=null,w=null,z=4,x=-99999,u=0){this.TK="";this.JRd=-1;this.value=f;this.type=a;this.subType=
z;this.label=this.BE=l;this.groupType=30;this.description=w;this.score=x;this.count=u}}Object(I.a)(m,"ResultBinding",null,[])},1416:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f){this.attributes=null;this.query=f;this.ep=[]}gw(f){this.ep.push(f)}SCj(f){const a=[];for(const l of this.ep)l.groupType!==f&&a.push(l);this.ep.length!==a.length&&(this.ep=a)}get Boc(){return!1}}Object(I.a)(m,"SimpleResultsUpdatedEventArgs",null,[1809])},1417:function(I,J,d){d.d(J,"a",function(){return m});
I=d(0);class m{constructor(f=30,a=""){this.qO=[];this.groupType=f;this.displayName=a}get results(){return this.qO}jy(f){f.groupType=this.groupType;Array.add(this.results,f)}hrg(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(I.a)(m,"SimpleResultGroup",null,[1783])},1429:function(I,J,d){I=d(0);class m{constructor(a,l){this.wmb=a;this.value=l}}Object(I.a)(m,"AttrValuePair",null,[]);d.d(J,"a",function(){return f});class f{constructor(a){this.Zib=
!1;if(!a)throw Error.argumentNull("annotations");this.Lx=a;this.m0=[]}get Occ(){return this.Lx}get isReadOnly(){return this.Zib}get ZQf(){return 0<this.m0.length}mr(a){if(!this.Lx.jpc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const l of this.m0)if(a===l.wmb)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}eA(a,l){var {Annotations:w}=d(1401);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Lx.jpc(a))throw Error.argument("attributeID",
"Invalid attribute ID");if(!this.Lx.koc(this.Lx.getAttributeType(a),l))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.$Ub(l);for(w=0;w<this.m0.length;++w){const z=this.m0[w];if(a===z.wmb){z.value=l;return}}Array.add(this.m0,new m(a,l))}CZa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Lx.jpc(a))throw Error.argument("attributeID","Invalid attribute ID");for(let l=0;l<this.m0.length;++l)if(a===
this.m0[l].wmb){Array.removeAt(this.m0,l);break}}L3d(a){if(!a)throw Error.argumentNull("action");for(const l of this.m0)a(l.wmb,l.value)}clone(){const a=new f(this.Lx);a.R6a(this);return a}R6a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.Occ!==this.Lx)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.m0);a.L3d((l,w)=>{this.eA(l,w)})}bia(){const {Annotations:a}=
d(1401);let l="[",w=!0;for(const z of this.m0){w?w=!1:l+=", ";l+=this.Lx.jti(z.wmb);l+="=";const x=this.Lx.getAttributeType(z.wmb),u=this.Lx.bia(x,z.value);x===a.Qca?(l+='"',l+=f.CAf(u),l+='"'):l+=u}return l+"]"}isEqual(a){const {Annotations:l}=d(1401);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Lx!==a.Occ||this.ZQf!==a.ZQf)return!1;let w=0,z=null,x=!1;a.L3d((u,v)=>{++w;if(!x){var D=-1;for(let y=0,H=this.m0.length;y<H;++y)if(this.m0[y].wmb===u){D=y;break}0>D?x=!0:(z||
(z=Array(this.m0.length)),z[D]=v)}});if(this.m0.length!==w||x)return!1;for(let u=0,v=this.m0.length;u<v;++u)if(!l.UAb(this.Lx.getAttributeType(this.m0[u].wmb),this.m0[u].value,z[u]))return!1;return!0}HW(){return this.isReadOnly?this.clone():this}U4f(){const {Annotations:a}=d(1401);if(!this.isReadOnly){this.Zib=!0;for(const l of this.m0)a.$Ub(l.value)}}toString(){return this.bia()}static CAf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(I.a)(f,"FeatureBundle",
null,[1820,1821])},1442:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.click="Click";m.v$a="InteractionBegin";m.CSb="InteractionEnd";m.j7h="ControlActivated";m.query="Query";m.axj="QueryIndexRecorded";m.f4h="Clicks";m.KLh="ActionEvents";m.Gni="FilteredActionEvents";m.dMj="SessionContext";m.latency="Latency";m.performance="Performance";m.BEj="RenderedResults";m.events="Events";m.LJl="CreateResultsMenu";m.eJ="UpdateRibbonControls";m.DIo="ResultsAggregation";m.XJ="IssueQuery";m.Qvl=
"CommandSuggestions";m.error="Error";m.C4f="LoadModelData";m.ARl="DepsResolveTime";m.LOn="ModelDataWaitTime";m.jHg="TimedOut";m.q3k="AddinQueryCommandReady";m.Lgm="GetAddinEntitlements";m.ywj="ProviderMRUEvents";m.R_l="EnableAddinSearchCommands";Object(I.a)(m,"EventNames",null,[])},1452:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.H6f=null;this.kga=this.J6f=0}zEf(f,a,l){if(!f)throw Error.argumentNull("referenceList");if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");
if(0>l||l>f.length)throw Error.argumentOutOfRange("length");if(a+l>f.length)throw Error.argument("Invalid start-length range");this.H6f=f;this.J6f=a;this.kga=l}$pb(f,a,l){this.zEf(f.H6f,f.J6f+a,l)}K(f){if(0>f||f>=this.kga)throw Error.argumentOutOfRange("index");return this.H6f[this.J6f+f]}get count(){return this.kga}static $sf(f){const a=new m;a.zEf(f,0,f.length);return a}}Object(I.a)(m,"ReadOnlyList",null,[1838])},1465:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.YMp=
0]="Classifier";f[f.yMp=1]="AppsForOffice";f[f.hHe=2]="FindInDocument";f[f.sOp=3]="FindInDocumentScopedSearch";f[f.MQp=4]="RecentlyUsed";f[f.jkk=5]="TryQuery";f[f.Empty=6]="Empty";f[f.nSp=7]="TryCommand";f[f.wdk=8]="Assistance";f[f.ndk=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.Zkk=12]="WolframAnswer";f[f.mgk=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.NQp=16]="Recommended";f[f.rRp=17]="ServiceClassifier";f[f.sRp=18]="ServiceRecommended";f[f.Image=
19]="Image";f[f.Notes=20]="Notes";f[f.Tgk=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.ddk=24]="ActionAI";f[f.edk=25]="ActionAICommand";f[f.pjk=26]="SummarizeDeck";f[f.ldk=27]="Addin";f[f.Xhk=28]="OfficeScript";f[f.mdk=29]="AddinStoreEntry";f[f.None=30]="None";f[f.DPp=31]="MergedActions";f[f.EPp=32]="MergedScopedSearches";f[f.FPp=33]="MergedSuggestedSearches"})(m||(m={}));Object(I.b)("ResultGroupType",m)},1475:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=
d(1549);class m extends d.a{constructor(){super();this.info=this.gk=this.eventId=null}get afa(){return"Misc"}TPb(){this.detail.W("Type",this.afa);this.detail.W("EventId",this.eventId);this.detail.W("Func",this.gk);this.detail.W("Info",this.info);return this.detail}}Object(I.a)(m,"BasicMergeFailureDetail",d.a,[])},1476:function(I,J,d){d.d(J,"a",function(){return l});I=d(0);var m=d(616),f=d(817),a=d(1499);class l{constructor(w,z=!0){this.zm=z&&w?w.GO():w;this.Zac=new m.a}KM(w){this.Zac.add(f.a.yb(w))}T_o(w){this.Zac=
w}Hdj(w){this.zm&&(new a.a(this.zm,w)).SMa.forEach((z,x)=>{x.e3&&!this.Zac.contains(z)&&(this.Zac.add(z),x.isDeleted?(x=this.zm,x.hasProperty(f.a.s_(z))&&x.removeProperty(f.a.s_(z))):this.zm.Udb(f.a.s_(z),x.newValue));return!0})}}Object(I.a)(l,"PartialMergeResult",null,[])},1477:function(I,J,d){d.r(J);d.d(J,"CommandResultsUtility",function(){return v});I=d(0);var m=d(1495),f=d(1442),a=d(1496),l=d(1413),w=d(1417),z=d(1407),x=d(1406),u=d(2);class v{static Hsd(D,y){if(y&&y.Bs){const H={};for(const F of D)y.bge(F)&&
(H[F]=appChrome.selectors.getModelType(F));z.TellMeActor.instance.eJ(H)}}static Xjp(D){return D.startsWith("btnTellMeOfficeAddIn")}static G8c(D){const y=z.TellMeActor.instance.yR();return!!y&&y.Bs&&!appChrome.selectors.isControlDisabled(D)}static Jhe(D,y,H,F){if(z.TellMeActor.instance.Ye&&D){const G=[];for(const K of D)G.push(String.format('{{"Id":"{0}","Score":{1}}}',K.commandId,K.score));D={};D[m.a.suggestions]="[{"+G.join(",")+"}]";D[m.a.j4i]=y;D[m.a.groupType]=H;D[m.a.provider]=F;z.TellMeActor.instance.Ye.gC(f.a.Qvl,
window.performance.now(),D)}}static eom(D,y){const H=[],F=[];for(const G of y){y=G.commandId;let K=G;G.commandId in D&&(y=D[G.commandId],K=new a.a(y,G.score));Array.contains(F,y)||(H.push(K),F.push(y))}return H}static o4c(D,y,H,F,G,K,R,E){var N;H.xHf&&(y=v.eom(H.xHf,y));var O=x.a.smm(y);v.Hsd(O,H);var U=[],X=[];O=[];const V=new w.a(R);R=16===R||18===R||7===R||4===R?u.AFrameworkApplication.J?u.AFrameworkApplication.J.jc("TellMeMaxRecommendedResultsToReturn",3):3:0===R||17===R||25===R?5:0;for(const T of y)if(!v.Ihn(T.commandId)){y=
v.Xjp(T.commandId);if(H.bge(T.commandId)&&!y){if(x.a.L2i(T.commandId))continue;y=null;G&&K&&(y=G.cFm(T.commandId,K));v.G8c(T.commandId)?Array.add(U,new l.a(T.commandId,5,y,null,E,T.score)):Array.add(X,new l.a(T.commandId,5,y,null,E,T.score))}else H.MKb&&y&&F&&Array.add(O,T.commandId.substr(21));if(U.length+O.length>=R)break}H=0;for(G=0;G<U.length&&H<R;G++,H++)V.jy(U[G]);var Q=(N=(U=null===(N=u.AFrameworkApplication.J)||void 0===N?void 0:N.getBooleanFeatureGate("Microsoft.Office.WordOnline.disabledButtonsInTellMeShouldHide",
!1))?null===(Q=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===Q?void 0:Q.getSharedUxSettings():void 0)?N.commonSettings:void 0;if(!U||!Q||!Q().shouldHideDisabledButtonsFromTellMe())for(Q=0;Q<X.length&&H<R;Q++,H++)V.jy(X[Q]);for(X=0;X<O.length&&H<R;X++,H++)F.Jqq(D,O[X],V);return V}static Ihn(D){v.WVh||(u.AFrameworkApplication.J&&u.AFrameworkApplication.J.my("TellMeControlPredictionBlockList")&&u.AFrameworkApplication.J.hD("TellMeControlPredictionBlockList").forEach(y=>{Array.add(v.VVh,
y.toLowerCase())}),v.WVh=!0);return Array.contains(v.VVh,D.toLowerCase())}static IWf(D){return 2<D.length&&";"===D.charAt(0)&&";"===D.charAt(D.length-1)&&!!u.AFrameworkApplication.J&&(u.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static evi(D){const y=new w.a(0);var H=D.split(";");D=z.TellMeActor.instance.yR();for(const F of H)if(0<F.length){H=F.split(":");const G=2===H.length?
H[0]:F;if(!D.bge(G))break;if(1===H.length)H=new l.a(G,5,null,null,1),y.jy(H);else if(2===H.length)H=new l.a(G,5,H[1],null,1),y.jy(H);else break}return y}static gXk(D,y,H){if(!(y&&y.results&&D&&D.results&&D.results.length))return{returnValue:!1,Mdf:D,Jef:y};const F=[];for(var G of y.results)Array.add(F,G.value);G=0;const K=0<y.results.length?y.results[0].score:0;for(const R of D.results)if(R.score>H&&!Array.contains(F,R.value)&&v.G8c(R.value)&&(0<K&&(R.score=K),Array.insert(y.results,G,R),G++),2===
G)break;return 0<G?(H=y.results.length-5,0<H&&y.hrg(H),{returnValue:!0,Mdf:D,Jef:y}):{returnValue:!1,Mdf:D,Jef:y}}}v.WVh=!1;v.VVh=[];Object(I.a)(v,"CommandResultsUtility",null,[])},1494:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{static Vlp(f){return f.toString().charCodeAt(0)}static Itn(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static MTh(f,a){if(f===a)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static LTh(f,a){if(f===a)return!0;if(!f||
!a||f.length!==a.length)return!1;f=m.JEj(f);a=m.JEj(a);return f===a}static JEj(f){return f.replace(m.Mcd," ")}static vzb(f,a,l){return f.substring(a,a+l)}}m.Mcd=RegExp("\u00a0","g");Object(I.a)(m,"CharUtils",null,[])},1495:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.appName="AppName";m.w6="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture="Culture";m.message="Message";m.errorMessage="ErrorMessage";m.event="Event";m.Usa="CorrelationID";m.C$n="ParentUiElement";
m.query="Input";m.nYb="QueryID";m.fxj="QueryLength";m.ruc="QueryIndex";m.EIo="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source="Source";m.timeStamp="Time";m.N4j="UiElement";m.Lse="ReactUx";m.value="Val";m.statusCode="StatusCode";m.service="Service";m.isSuccess="IsSuccess";m.Kmp="TokenAcquired";m.Dyn="LatencyType";m.groupName="GroupName";m.Xaa="GroupIndex";m.groupType="GroupType";m.zIo="ResultInfoList";m.resultType="ResultType";m.BEg="SubResultType";m.umn=
"IsInputBlur";m.vmn="IsInputFocus";m.Msn="IsShortCutUsed";m.actionType="ActionType";m.count="Count";m.cZl="DwellTime";m.j4i="IsZeroTerm";m.aLp="WordsCount";m.gfe="IsSearchUxEnabled";m.fun="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.dxf="DisplayIndex";m.$_l="EnableList";m.provider="Provider";m.contentType="ContentType";m.hsn="IsSelectionBased";m.Qcl="BeginPerformanceMarker";m.C0l="EndPerformanceMarker";m.Jbo="PerformanceMeasure";Object(I.a)(m,"Columns",null,[])},1496:function(I,
J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.commandId=f;this.score=a}}Object(I.a)(m,"CommandSuggestion",null,[])},1499:function(I,J,d){I=d(0);var m=d(364),f=d(817),a=d(272),l=d(109);class w{constructor(x,u,v){this.TJk=x;this.jGk=u;this.EFk=v;this.bWe=new a.a(Object(l.a)(this,this.rpl,"checkIfDifferent"))}get Bmg(){return this.TJk}get oldValue(){return this.jGk}get newValue(){return this.EFk}get Psb(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||
null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get e3(){return this.Psb||this.isDeleted||this.bWe.value}rpl(){return this.Psb||this.isDeleted?!0:!f.a.UTh(this.Bmg,this.oldValue,this.newValue)}}Object(I.a)(w,"PropertyDiff",null,[]);d.d(J,"a",function(){return z});class z{constructor(x,u){this.gGk=x;this.BFk=u;this.bWe=new a.a(()=>this.R8c());this.VJk=new a.a(Object(l.a)(this,this.n3l,"evaluatePropertyDiffs"))}get Sv(){return this.gGk}get Lf(){return this.BFk}get Psb(){return!!this.Lf&&
!this.Sv}get isDeleted(){return!this.Lf&&!!this.Sv}get e3(){return this.Psb||this.isDeleted||this.bWe.value}get SMa(){return this.VJk.value}R8c(x=null){let u=!1;this.SMa.forEach((v,D)=>{u=D.e3&&(!x||7!==x.K(v));return!u});return u}n3l(){const x=new m.a;var u=this.Lf,v=this.Sv;if(this.Psb){v=u.Zj();for(var D=0;D<v.length;D++){var y=v[D];x.W(f.a.yb(y),new w(y,null,u.HF(y)))}}else if(this.isDeleted)for(u=v.Zj(),D=0;D<u.length;D++)y=u[D],x.W(f.a.yb(y),new w(y,v.HF(y),null));else{D=v.Zj();for(y=0;y<D.length;y++){var H=
D[y],F=f.a.yb(H),G=v.HF(H);const K=u.hasProperty(H)?u.HF(H):null;x.W(F,new w(H,G,K))}D=u.Zj();for(y=0;y<D.length;y++)H=D[y],v.hasProperty(H)||(F=f.a.yb(H),G=u.HF(H),x.W(F,new w(H,null,G)))}return x}}Object(I.a)(z,"MergeableObjectDiff",null,[])},1511:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(48);class f{constructor(){this.cp=0;this.id=m.a.create()}}Object(I.a)(f,"LcsUpdateHint",null,[1178,172])},1512:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.mu="TellMe";
m.lIn="Loki";m.XYj="Substrate";m.ruc="QueryIndex";m.M_j="TellMeRanker";m.N_j="TellMeRankerLogging";Object(I.a)(m,"Services",null,[])},1513:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.iWa="HttpRequest";m.provider="Provider";Object(I.a)(m,"LatencyTypes",null,[])},1519:function(I,J,d){I=d(0);var m=d(59),f=d(13),a=d(5),l=d(33),w=d(224),z=d(177),x=d(219),u=d(48),v=d(616),D=d(109),y=d(241),H=d(1549);class F extends H.a{constructor(){super();this.cB=null}get afa(){return"CreateMergeBlock"}TPb(){this.detail.W("Type",
this.afa);this.detail.W("Revision",this.cB);return this.detail}}Object(I.a)(F,"CreateMergeBlockFailureDetail",H.a,[]);var G=d(1614),K=d(1616),R=d(1744),E=d(1550),N=d(1476),O=d(1810),U=d(586);d.d(J,"a",function(){return X});class X{static mYd(V,Q,T,ba,W,aa,Y){let da;da="";const ka=new w.a;for(let ua=0;ua<T.length;ua++){var qa=void 0;let Pa;qa=G.a.uom(Q,T.K(ua),ba,W,aa,Y,V);if(!qa)return{returnValue:null,obb:da};({P7f:Pa,obb:qa}=qa.GBi());if(!Pa)return{returnValue:null,obb:da};da+=qa;ka.SA(ka.length,
Pa)}return{returnValue:ka,obb:da}}static E$h(V,Q,T,ba,W,aa,Y,da){let ka,qa,ua,Pa,Ja,Ca;Ca=Ja=Pa=ua=qa=ka=null;({obb:Pa,returnValue:ka}=X.mYd(Q,ra=>V.runtime.Gn.K(ra),T,1,aa,Y,da));if(!ka)return z.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),V.logger.Oi(Object.assign(new F,{cB:"Base"})),{returnValue:!1,OM:ka,c0c:qa,Asd:ua,VSd:Pa,e2d:Ja,WDe:Ca};({obb:Ja,returnValue:qa}=X.mYd(Q,ra=>
V.runtime.JA.K(ra)||V.runtime.Gn.K(ra),ba,2,aa,Y,da));if(!qa)return z.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),V.logger.Oi(Object.assign(new F,{cB:"Favored"})),{returnValue:!1,OM:ka,c0c:qa,Asd:ua,VSd:Pa,e2d:Ja,WDe:Ca};({obb:Ca,returnValue:ua}=X.mYd(Q,ra=>V.runtime.sv.K(ra)||V.runtime.Gn.K(ra),W,4,aa,Y,da));return ua?{returnValue:!0,OM:ka,c0c:qa,Asd:ua,VSd:Pa,e2d:Ja,WDe:Ca}:
(z.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),V.logger.Oi(Object.assign(new F,{cB:"Unfavored"})),{returnValue:!1,OM:ka,c0c:qa,Asd:ua,VSd:Pa,e2d:Ja,WDe:Ca})}static d4h(V,Q=!1){const T=new w.a;let ba=0;for(;ba<V.length;){var W=V.K(ba);if(1===W.type||4===W.type||2===W.type)T.add(W),ba++;else if(3===W.type){let Y="";Y+=W.character;ba++;let da=W.dXa,ka=!1;for(;ba<V.length;ba++){var aa=
V.K(ba);3===aa.type?W.runId===aa.runId&&W.oL.equals(aa.oL)&&(W.wfa===aa.wfa||W.wKa===aa.wKa)&&W.dA.aC(aa.dA)&&(!Q||W.$u&&W.$u.equals(aa.$u))?(Y+=aa.character,aa.dXa&&(da=!0)):ka=!0:ka=!0;if(ka){W=new O.a(null,W.source,W.xk,W.Rg,W.runId,W.oL,Y,W.tvb,!0,da,W.wfa,W.wKa,W.jZa,W.dA,W.$u);T.add(W);break}}}}z.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",T.Qr());return T}static Gvl(V,Q=!1){const T=new w.a;let ba=0;for(;ba<V.length;){var W=V.K(ba);
if(1===W.type||4===W.type||2===W.type)T.add(W),ba++;else if(3===W.type){let Y=W.character.toString();ba++;let da=W.dXa;for(;ba<V.length;ba++){var aa=V.K(ba);if(3===aa.type&&X.j4o(W,aa,Q))Y+=aa.character,aa.dXa&&(da=!0);else break}W=new O.a(null,W.source,W.xk,W.Rg,W.runId,W.oL,Y,W.tvb,!0,da,W.wfa,W.wKa,W.jZa,W.dA,W.$u);T.add(W)}}z.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",T.Qr());return T}static j4o(V,Q,T){return V.runId===Q.runId&&V.oL.equals(Q.oL)&&
(V.wfa===Q.wfa||V.wKa===Q.wKa)&&V.dA.aC(Q.dA)&&(!T||!!V.$u&&V.$u.equals(Q.$u))}static CYo(V,Q,T,ba,W,aa,Y,da,ka,qa,ua,Pa,Ja,Ca,ra,Ea){V.setPropertyString(T.zm,f.a.zn,W);V.setPropertyUint32(T.zm,a.a.ed,ba);V.setPropertyUint32s(T.zm,a.a.Iq,aa);V.setPropertyUint32s(T.zm,a.a.It,Y);V.setPropertyObjectIds(T.zm,f.a.Sn,ka);V.hasProperty(T.zm,a.a.Vj)&&V.setPropertyUint32(T.zm,a.a.Vj,X.ffm());Q&&Q(7)&&V.setPropertyObjectIds(T.zm,a.a.Kw,Ea);ba=!1;for(W=0;W<qa.length;W++)if(qa.K(W)){ba=!0;break}ba&&V.setPropertyBools(T.zm,
a.a.Xag,qa);X.Bjl(Q,V,T,ua,Pa,Ja,Ca);X.Cjl(V,T,ra);T.KM(f.a.zn);T.KM(a.a.ed);T.KM(a.a.Iq);T.KM(a.a.It);T.KM(f.a.Sn);T.KM(a.a.Xag);T.KM(f.a.An);T.KM(f.a.hzb);T.KM(a.a.QVa);T.KM(a.a.RMa);T.KM(f.a.pCa);T.KM(a.a.Kw);V.hasProperty(T.zm,a.a.Vj)&&T.KM(a.a.Vj);0<da.length?V.setPropertyUint32s(T.zm,f.a.An,da):T.zm.removeProperty(f.a.An)}static Bjl(V,Q,T,ba,W,aa,Y){if(V(92)){V=ba.contains(!0,(da,ka)=>ka);X.Syg(Q,T,f.a.pCa,V?ba:null);X.Syg(Q,T,f.a.hzb,X.qGj(ba,W));X.Syg(Q,T,a.a.QVa,X.qGj(ba,aa));ba=!1;for(W=
0;W<Y.length;W++)0!==Y.K(W)&&(ba=!0);ba?Q.setPropertyUint32s(T.zm,a.a.RMa,Y):T.zm.removeProperty(a.a.RMa)}}static Cjl(V,Q,T){const ba=Y=>Y;var W=Object(D.a)(V,V.setPropertyBools,"setPropertyBools");X.CTa(Q,T.Dsb,ba,W,a.a.UKa);X.CTa(Q,T.zob,ba,W,a.a.Hka);X.CTa(Q,T.Acb,ba,W,a.a.QMa);W=Y=>0<Y.length;var aa=Object(D.a)(V,V.setPropertyStrings,"setPropertyStrings");X.CTa(Q,T.Csb,W,aa,a.a.VKa);X.CTa(Q,T.yob,W,aa,a.a.bJa);X.CTa(Q,T.Kwb,W,aa,a.a.COa);W=Y=>!!Y;aa=Object(D.a)(V,V.setPropertyListOfMilliseconds,
"setPropertyListOfMilliseconds");X.CTa(Q,T.Esb,W,aa,a.a.WKa);X.CTa(Q,T.q7a,W,aa,a.a.cJa);X.CTa(Q,T.Mwb,W,aa,a.a.DOa);W=Y=>!!Y;aa=Object(D.a)(V,V.EYo,"setPropertyList");X.Ylf(Q,T.xWa,W,aa,l.a.yWa);X.Ylf(Q,T.ENb,W,aa,l.a.sUa);X.Ylf(Q,T.TXb,W,aa,l.a.h0a);T.Acb.any(ba)?X.CTa(Q,T.Lwb,()=>!0,Object(D.a)(V,V.setPropertyObjectIds,"setPropertyObjectIds"),a.a.qEa):Q.zm.removeProperty(a.a.qEa)}static qGj(V,Q){const T=new w.a;let ba=!1;for(let W=0;W<V.length;W++){const aa=Q.K(W)&&!V.K(W);T.add(aa);ba=aa||ba}return ba?
T:null}static Syg(V,Q,T,ba){ba?V.setPropertyBools(Q.zm,T,ba):Q.zm.removeProperty(T)}static ffm(){return x.a.wD()}static ECi(V,Q){return V.runtime.JA.P2(Q,V.runtime.Gn.K(Q)||V.runtime.sv.get(Q))}static F3c(V,Q,T,ba,W){let aa;aa=new w.a;const Y=!!T&&T(7),da=!!T&&T(109);if(V.runtime.rc.isFeatureEnabled(68)){var ka=X.Gvl(ba,Y);var qa=X.d4h(ba,Y);ka.length!==qa.length&&V.runtime.rc.LL(68)}else ka=X.d4h(ba,Y);qa=0;let ua="",Pa=new w.a,Ja=new w.a,Ca=new w.a,ra=new w.a,Ea=new w.a,xa=new w.a,Ma=new w.a,ha=
new w.a,la=new w.a;const Fa=new R.a;let Ga=new w.a;var va=ka.K(ka.length-1);if(2!==va.type&&4!==va.type)return z.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",va.type),V.logger.Oi(Object.assign(new E.a,{gk:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",va.type)})),{returnValue:!1,jpe:aa};var pa=0;for(va=0;va<ka.length;va++){var Oa=ka.K(va),Ra=null;
if(1===Oa.type||3===Oa.type)Ra=Oa,ua+=Ra.text;else if(4===Oa.type){Oa=X.ECi(V,Oa.xk);Oa=new N.a(Oa);aa.add(Oa);continue}Ra?(Pa.add(Ra.runId),Ja.add(Ra.Rg),pa+=Ra.text.length,Ca.add(pa),ra.add(Ra.oL),Ea.add(Ra.tvb),xa.add(Ra.dXa),Ma.add(Ra.wfa),ha.add(Ra.wKa),la.add(Ra.jZa),Fa.Dsb.add(Ra.dA.nZm),Fa.zob.add(Ra.dA.OYm),Fa.Acb.add(Ra.dA.TZm),Fa.Csb.add(Ra.dA.Fsb.author),Fa.yob.add(Ra.dA.Aob.author),Fa.Kwb.add(Ra.dA.vua.author),Fa.Esb.add(Ra.dA.Fsb.tdd),Fa.q7a.add(Ra.dA.Aob.tdd),Fa.Mwb.add(Ra.dA.vua.tdd),
Fa.Lwb.add(Ra.dA.vua.glg),da&&(Fa.xWa.push(new U.a(!1,"",null,null!=Ra.dA.Fsb.XLa?Q.Pxg(Ra.dA.Fsb.XLa):null)),Fa.xWa.push(new U.a(!1,"",null,null!=Ra.dA.Aob.XLa?Q.Pxg(Ra.dA.Aob.XLa):null)),Fa.xWa.push(new U.a(!1,"",null,null!=Ra.dA.vua.XLa?Q.Pxg(Ra.dA.vua.XLa):null))),Y&&Ga.add(Ra.$u)):Pa.length||(Pa.add(0),Ja.add(0),Ca.add(0),ra.add(u.a.nil),Ea.add(!1),xa.add(!1),Ma.add(!1),ha.add(!1),la.add(0),Fa.Dsb.add(!1),Fa.zob.add(!1),Fa.Acb.add(!1),Fa.Csb.add(""),Fa.yob.add(""),Fa.Kwb.add(""),Fa.Esb.add(0),
Fa.q7a.add(0),Fa.Mwb.add(0),Fa.Lwb.add(u.a.nil),da&&(Fa.xWa.push(new U.a(!1,"",null,null)),Fa.ENb.push(new U.a(!1,"",null,null)),Fa.TXb.push(new U.a(!1,"",null,null))));if(2===Oa.type){pa=Oa;Oa=pa.ed;Ca.fI(Ca.length-1);Ra=W.K(qa);if(!Ra)return z.a.instance.Ua(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",qa,W.length,ba.length,va,ka.length),
V.logger.Oi(Object.assign(new E.a,{gk:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),z.a.instance.Sna(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",W.Qr()),z.a.instance.Sna(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",ba.Qr()),z.a.instance.Sna(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ka.Qr()),{returnValue:!1,jpe:aa};if(Ra=X.ECi(V,Ra))Ra=new N.a(Ra.GO()),X.CYo(Q,T,Ra,pa.ed,ua,Pa,Ja,Ca,ra,Ea,xa,Ma,ha,la,
Fa,Ga),aa.add(Ra);z.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",pa.xk,Oa,Pa.Qr(),Ja.Qr(),Ca.Qr(),xa.Qr(),Ma.Qr(),ha.Qr(),ra.Qr(),"",la.Qr());qa++;ua="";Pa=new w.a;Ja=new w.a;Ca=new w.a;ra=new w.a;Ea=new w.a;xa=new w.a;Ma=new w.a;ha=new w.a;la=new w.a;Fa.reset();pa=0;Ga=new w.a}}return{returnValue:!0,
jpe:aa}}static vHo(V,Q){const T=V.runtime.Sq.K(y.a.MN),ba=Q.getPropertyObjectIds(T.zm,a.a.AY);for(let W=0;W<ba.length;W++)V.runtime.Sq.remove(ba.K(W));Q.setPropertyObjectIds(T.zm,a.a.AY,new w.a);Q.setPropertyString(T.zm,a.a.yEa,u.a.nil.toString());T.KM(a.a.AY);T.KM(a.a.yEa)}static M9m(V,Q){if(V.runtime.Sq.tb(y.a.MN))return null;const T=new N.a(V.runtime.Gn.K(y.a.MN).GO());Q.setPropertyString(T.zm,a.a.yEa,V.output.NL.last().id.toString());Q.setPropertyObjectIds(T.zm,a.a.AY,new w.a);T.KM(a.a.AY);T.KM(a.a.yEa);
V.runtime.Sq.W(y.a.MN,T);return T}static EKf(V){const Q=new w.a;V.forEach(T=>{Q.add(T.id);return!0});return Q}static Iqc(V,Q,T,ba){let W=0;T.forEach(aa=>{K.a(aa,Q+W++,1);aa.sc===m.a.paragraphNode&&V.getPropertyObjectIds(aa,f.a.Sn).forEach(Y=>{ba.add(Y);return!0});return!0})}static CEn(V,Q){const T=new v.a;let ba=0;Q.forEach(W=>{if(T.contains(W))return!0;T.add(W);if(({index:ba}=X.n5f("BaseFormatting_",ba,W,aa=>V.runtime.Gn.K(aa))).returnValue||({index:ba}=X.n5f("FavoredFormatting_",ba,W,aa=>V.runtime.JA.K(aa))).returnValue||
({index:ba}=X.n5f("ConflictingFormatting_",ba,W,aa=>V.runtime.sv.K(aa))).returnValue)return!0;ba++;return!0})}static n5f(V,Q,T,ba){if(T=ba(T))if(K.a(T,V+Q,1),T.sc===m.a.s_a)return Q++,{returnValue:!0,index:Q};return{returnValue:!1,index:Q}}static Nxf(V){return!!V.runtime.Gn.K(y.a.MN)}static CTa(V,Q,T,ba,W){Q.any(T)?(ba(V.zm,W,Q),V.KM(W)):V.zm.removeProperty(W)}static Ylf(V,Q,T,ba,W){Q.some(T)?(ba(V.zm,W,Q),V.KM(W)):V.zm.removeProperty(W)}static rPj(V,Q){const T=new w.a;T.add(0);const ba=V?V.length:
0;for(let W=0;W<ba;W++)T.insert(W+1,V.ug(W));T.insert(T.length,Q);return T}}Object(I.a)(X,"ParagraphMergeUtils",null,[])},1547:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(224);class f{constructor(a,l,w){this.Dn=null;this.Rk=a;this.source=l;this.xk=w}get type(){return this.Rk}get Deb(){return!1}get $kn(){return 1===(this.source&1)}get aln(){return 2===(this.source&2)}get bln(){return 4===(this.source&4)}J7(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.qjm(),
this.ejc())}qjm(){let a="";this.$kn&&(a+="Base");this.aln&&(a+="FavoredUpdate");this.bln&&(a+="UnfavoredUpdate");return a}ejc(){return""}aC(a){return this.type===a.type}Wpd(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(I.a)(f,"AMergeBlock",null,[70,71])},1548:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1547);class m extends d.a{constructor(f,a,l){super(2,f,a);this.ed=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.ed,
this.xk)}ejc(){return"Eop"}clone(){return new m(this.source,this.xk,this.ed)}aC(f,a,l,w=!1,z=!0){return super.aC(f,a,l,w)?z?f.ed===this.ed:f.xk===this.xk&&f.ed===this.ed:!1}get length(){return 1}}Object(I.a)(m,"EopMergeBlock",d.a,[])},1549:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(364);class f{constructor(){this.detail=new m.a}}Object(I.a)(f,"AMergeFailureDetail",null,[1137])},1550:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1475);class m extends d.a{constructor(){super()}get afa(){return"ParagraphMerge"}}
Object(I.a)(m,"ParagraphMergeFailureDetail",d.a,[])},1551:function(I,J,d){d.d(J,"b",function(){return w});d.d(J,"a",function(){return x});var m=d(224),f=d(364),a=d(616),l=d(1745);const w=(v,D,y)=>{const H=z(v,D,y);let F=0,G=0,K=0,R=new l.a;const E=new m.a;for(let N=0;N<H.length;N++){const O=H.ug(N+1);R.ZRd(v.ug(F));R.aSd(D.ug(G));R.eSd(y.ug(K));F++;G++;for(K++;F<v.length&&(!O||!O.equals(v.ug(F)));)R.ZRd(v.ug(F)),F++;for(;G<D.length&&(!O||!O.equals(D.ug(G)));)R.aSd(D.ug(G)),G++;for(;K<y.length&&(!O||
!O.equals(y.ug(K)));)R.eSd(y.ug(K)),K++;E.add(R);R=new l.a}for(;F<v.length;)R.ZRd(v.ug(F)),F++;for(;G<D.length;)R.aSd(D.ug(G)),G++;for(;K<y.length;)R.eSd(y.ug(K)),K++;R.isEmpty||E.add(R);return E},z=(v,D,y)=>{const H=new m.a,F=D.vS(),G=y.vS();v.forEach(K=>{F.contains(K)&&G.contains(K)&&H.add(K);return!0});return H},x=(v,D,y)=>{v=v||new m.a;D=D||new m.a;y=y||new m.a;const H=new m.a,F=new f.a(0),G=new a.a;for(var K=0;K<v.length;K++){var R=v.ug(K);F.W(R,K)}for(v=K=0;K<D.length&&v<y.length;){R=D.ug(K);
let E=y.ug(v),N=F.P2(R,-1),O=F.P2(E,-1);-1===N?(u(G,H,R),K++):-1===O?(u(G,H,E),v++):N===O?(u(G,H,R),K++,v++):N<O?K++:v++}for(;K<D.length;K++)R=D.ug(K),-1===F.P2(R,-1)&&u(G,H,R);for(;v<y.length;v++)D=y.ug(v),-1===F.P2(D,-1)&&u(G,H,D);return H},u=(v,D,y)=>{v.contains(y)||(D.add(y),v.add(y))}},1552:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1475);class m extends d.a{constructor(){super()}get afa(){return"RdOpLcs"}}Object(I.a)(m,"ReducedOpsLcsFailureDetail",d.a,[])},1558:function(I,J,
d){I=d(0);class m{constructor(){this.tokenFilter=this.F7c=null;this.x7f=this.score=this.Pcd=0}zig(H,F,G){this.score=H.K(F);++F;this.F7c=H.K(F)?G.nsa(H.K(F)):null;++F;this.tokenFilter=H.K(F)?G.nsa(H.K(F)):null;++F;this.Pcd=H.K(F);++F;this.x7f=H.K(F);++F;return F}}Object(I.a)(m,"TokenStringGeneratorInit",null,[]);class f{constructor(H,F,G,K,R){this.Opb=H;this.count=F;this.g3d=G;this.kR=K;this.depth=R}}Object(I.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=d(1646),l=d(1765);class w{constructor(H=null,
F=0,G=0,K=0){this.gRk=H||new l.a;this.gAa=F;this.kR=G;this.depth=K}get Z8(){return this.gRk}getKey(){return this.Z8.Zy.toString()+":"+this.gAa.toString()}}Object(I.a)(w,"TrieBookmark",null,[]);class z{constructor(H,F){this.RXa=H;this.B6f=F}mIn(H){if(null==H)throw Error.argumentNull("prefix");let F={};var G=F[""]=new w;this.kae(G,F);for(G=0;G<H.length;++G){const K=H.charCodeAt(G),R={};for(let E in F)this.i4k(K,F[E],R);F=R}return this.Kop(F)}kae(H,F){if(!(H.kR>=this.B6f)&&(H=new w(a.a.xof(H.Z8),H.gAa,
H.kR+1,H.depth),H.Z8.AH&a.a.$fb&&(H.gAa+=1),this.RXa.R1b(H.Z8))){H.depth+=1;let G=!0;for(;G;)z.FEe(H,F),this.kae(H,F),H.gAa+=this.RXa.sjc(H.Z8,!0)+(H.Z8.AH&a.a.$fb?1:0),G=this.RXa.Yrd(H.Z8)}}i4k(H,F,G){F.kR+1<=this.B6f&&(F.kR+=1,z.FEe(F,G),--F.kR);F.Z8.AH&a.a.$fb&&(F.gAa+=1);if(this.RXa.R1b(F.Z8)){F.depth+=1;let K=!0;for(;K;)F.Z8.Z2b===H?(z.FEe(F,G),this.kae(F,G)):F.kR+1<=this.B6f&&(F.kR+=1,z.FEe(F,G),this.kae(F,G),--F.kR),F.gAa+=this.RXa.sjc(F.Z8,!0)+(F.Z8.AH&a.a.$fb?1:0),K=this.RXa.Yrd(F.Z8)}}Kop(H){const F=
[];for(var G in H){const K=H[G];if(!K.Z8.Zy)continue;const R=!!(K.Z8.AH&a.a.$fb),E=this.RXa.sjc(K.Z8,!1)+(R?1:0);Array.add(F,new f(K.gAa,E,R,K.kR,K.depth))}F.sort((K,R)=>{let E=K.Opb-R.Opb;return E||(E=-(K.count-R.count))?E:E=K.depth-R.depth});if(2>F.length)return F;H=[];for(G=0;G<F.length;)G+=z.w2j(G,F,H);return H}static FEe(H,F){const G=H.getKey();G in F?(F=F[G],F.kR=Math.min(F.kR,H.kR)):F[G]=new w(a.a.xof(H.Z8),H.gAa,H.kR,H.depth)}static w2j(H,F,G){const K=F[H];let R=K.Opb;const E=R+K.count;let N=
1,O=K.g3d;for(;H+N<F.length&&F[H+N].Opb<E;){const U=F[H+N];U.Opb>R&&(Array.add(G,new f(R,U.Opb-R,O,K.kR,K.depth)),O=!1);N+=z.w2j(H+N,F,G);R=U.Opb+U.count}R<E&&Array.add(G,new f(R,E-R,O,K.kR,K.depth));return N}}Object(I.a)(z,"ErrorTolerantTrieLookupEngine",null,[1886]);class x extends m{constructor(H,F,G){super();this.fQi=this.fpj=!1;this.$ki=null;if(H){var K=0;try{K=this.zig(H,K,F);this.fpj=1===H.K(K);++K;this.fQi=1===H.K(K);++K;const R=H.K(K);this.$ki=this.W$n(G,R)}catch(R){throw Error.argument("initData");
}}}W$n(H,F){return new z(H,F)}}Object(I.a)(x,"FuzzyMatchTokenStringGeneratorInit",m,[]);class u extends m{constructor(H,F){super();this.query=this.name=null;if(H){this.annotations=F.annotations;var G=0;try{G=this.zig(H,G,F),this.name=F.iD(H.K(G)),++G,this.query=F.bN(H.K(G))}catch(K){throw Error.argument("initData");}}}}Object(I.a)(u,"QueryTokenStringGeneratorInit",m,[]);class v extends m{constructor(H,F){super();if(H)try{this.zig(H,0,F)}catch(G){throw Error.argument("initData");}}}Object(I.a)(v,"SurfaceStringTokenStringGeneratorInit",
m,[]);var D=d(1452);d.d(J,"a",function(){return y});class y{constructor(H){this.r6f=H}get F7c(){return this.r6f.F7c}get tokenFilter(){return this.r6f.tokenFilter}get Pcd(){return this.r6f.Pcd}static create(H,F,G){const {SurfaceStringTokenStringGenerator:K}=d(1943),{QueryTokenStringGenerator:R}=d(1944),{FuzzyMatchTokenStringGenerator:E}=d(1945);let N=0;try{if(H.K(N)!==y.yLb)throw Error.argument("initData","Input does not represent a token string generator");++N;const O=H.K(N);++N;const U=new D.a;U.$pb(H,
N,H.count-N);switch(O){case K.tUc:return new K(new v(U,F));case R.tUc:return new R(new u(U,F));case E.tUc:return new E(new x(U,F,G));default:throw Error.argument("initData");}}catch(O){throw Error.argument("initData");}}static DOh(H,F,G,K,R,E){H=H.Qmp.getId(F,null);if(0>H)return++E,E;y.EOh(H,G,K,R);return E}static EOh(H,F,G,K){Array.add(K.nEg,H);Array.add(K.CYj,F);++K.Qzc[G]}}y.yLb=1099767983;Object(I.a)(y,"TokenStringGenerator",null,[1854])},1613:function(I,J,d){d.d(J,"a",function(){return a});I=
d(0);var m=d(224);J=d(1547);var f=d(1494);class a extends J.a{constructor(l,w,z){super(l,w,z)}ncp(l){let w;w=null;if(!this.text||!this.Deb||0>=l||l>=this.length)return{returnValue:!1,VWj:w};w=new m.a;const z=this.clone();z.Eod(f.a.vzb(this.text,0,l));const x=this.clone();x.Eod(f.a.vzb(this.text,l,this.length-l));w.add(z);w.add(x);return{returnValue:!0,VWj:w}}J7(){return!0}get length(){return this.text.length}}Object(I.a)(a,"ATextMergeBlock",J.a,[])},1614:function(I,J,d){d.d(J,"a",function(){return a});
I=d(0);var m=d(59),f=d(177);class a{phf(l,w){return l+("[Block: "+w+"] ")}static uom(l,w,z,x,u,v,D){const {ParagraphMergeBlockCreator:y}=d(2034),{TableMergeBlockCreator:H}=d(2040);if(w.sc===m.a.paragraphNode)return new y(l,w,z,u,v,x(7),D,x(109));if(w.sc===m.a.Bp)return new H(w,z);f.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",w.sc);return null}}Object(I.a)(a,"MergeBlockCreator",null,[])},1615:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=
d(59),f=d(5),a=d(48);J=d(1613);var l=d(1499);class w extends J.a{constructor(z,x,u,v,D,y,H,F,G,K,R,E,N,O){super(x,u,v);this.Rg=D;this.runId=y;this.tvb=F;this.swk=H;this.JJe=z;this.dXa=G;this.wfa=K;this.wKa=R;this.jZa=E;this.dA=N;this.$u=O}get LSc(){return this.JJe}get oL(){return this.swk}get jPb(){return this.LSc(this.oL)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Rg,this.runId,this.tvb,
this.xk,this.oL.toString(),this.$u?this.$u.toString():"NULL")}aC(z,x,u,v=!1){if(!super.aC(z,x,u,v))return!1;if(v)return!0;if(!this.dA.aC(z.dA)||this.$u&&!this.$u.equals(z.$u))return!1;if(this.oL.equals(z.oL)||this.oL.equals(a.a.nil)||z.oL.equals(a.a.nil))return!0;z=new l.a(this.jPb,z.jPb);x=x.d$h(this.jPb,u);return z.R8c(x.Nqe)?!1:!0}get xfn(){return this.J7()&&"\ufffc"===this.text&&this.jPb?this.jPb.hasProperty(f.a.jt)||this.jPb.sc!==m.a.uwb?!0:!1:!1}}Object(I.a)(w,"AUserRunMergeBlock",J.a,[])},
1616:function(I,J,d){d.d(J,"a",function(){return f});var m=d(177);const f=(a,l,w=4)=>{a?m.a.instance.Sna(4273285,w,4,l,a.Mzc()):m.a.instance.Ua(4293845,w,1,l,"{0}: Node was null.",l)}},1617:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1413);class m extends d.a{constructor(f,a,l,w,z=null){super(f,a,z,null,l);this.id=w}}Object(I.a)(m,"TryQueryResultBinding",d.a,[])},1618:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f){this.Bb=f}get Hbb(){return this.Bb.Hbb}get Fgp(){return 4!==
this.Bb.style}get Hgp(){return!0}get trie(){return this.Bb.trie}getId(f,a){if(!this.Fgp)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.Tvm(f,a);default:throw Error.notImplemented();}}iD(f){if(!this.Hgp)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.Hbb)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.kMm(f);case 4:return this.jMm(f);
default:throw Error.notImplemented();}}Tvm(f,a){f=this.Bb.trie.raj(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.fAc||f.fAc>=this.Bb.Hbb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.Zrd?this.Bb.vjd.cA(this.Bb.Zrd+4*f.fAc,4):f.fAc}kMm(f){if(this.Bb.Zrd){let a=0;for(;a<this.Bb.Hbb&&this.Bb.vjd.cA(this.Bb.Zrd+4*a,4)!==f;++a);if(a>=this.Bb.Hbb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.ZGi(a)}return this.Bb.trie.ZGi(f)}jMm(f){const a=
this.Bb.vjd.cA(this.Bb.zYj+4*f,4);f=this.Bb.vjd.cA(this.Bb.AYj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let w=0;w<a;++w)l[w]=({O3m:f}=this.npo(f)).returnValue;return String.fromCharCode.apply(null,l)}npo(f){let a=0;for(let l=0;3>l;++l){const w=this.Bb.vjd.K(this.Bb.z0h+f)^182;++f;a|=(w&127)<<7*l;if(!(w&128))break}return{returnValue:a,O3m:f}}}Object(I.a)(m,"StringTable",null,[1839])},1619:function(I,J,d){d.d(J,"a",function(){return f});
I=d(0);var m=d(1646);class f{constructor(a){this.trie=null;this.z0h=this.zYj=this.AYj=this.Zrd=0;if(a){this.vjd=a;var l=0;if(a.cA(l,4)!==f.yLb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.Hbb=a.cA(l,4);l+=4;this.style=a.cA(l,4);l+=4;switch(this.style){case 0:const w=1===a.cA(l,4);l+=4;w||(this.Zrd=l,l+=4*this.Hbb);a.cA(l,4);this.trie=this.Aao(a,l+4);break;case 4:this.AYj=l;this.zYj=l+=4*this.Hbb;l+=4*this.Hbb;a.cA(l,4);this.z0h=l+4;break;default:throw Error.argument("bytes");
}}}Aao(a,l){return new m.a(a,l)}}f.yLb=1025118440;Object(I.a)(f,"StringTableInit",null,[])},1620:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.ndk=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.Zkk=3]="WolframAnswer";f[f.wdk=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.jkk=7]="TryQuery";f[f.hHe=8]="FindInDocument";f[f.MOp=9]="HelpAction";f[f.mgk=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";f[f.uOp=13]=
"FirstRunResult";f[f.VPp=14]="NoCommandsFoundResult";f[f.Ujk=15]="TestResult";f[f.zMp=16]="AppsForOffice_Installed";f[f.BMp=17]="AppsForOffice_Recommandation";f[f.AMp=18]="AppsForOffice_Query";f[f.$Pp=19]="Notes_Onenote";f[f.aQp=20]="Notes_Samsung";f[f.bQp=21]="Notes_Sticky";f[f.Tgk=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.ddk=25]="ActionAI";f[f.edk=26]="ActionAICommand";f[f.ldk=27]="Addin";f[f.Xhk=28]="OfficeScript";f[f.mdk=29]="AddinStoreEntry";f[f.FOp=30]="GenerateSlides";
f[f.pjk=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(m||(m={}));Object(I.b)("ResultType",m)},1644:function(I,J,d){I=d(0);var m=d(5),f=d(616),a=d(177),l=d(224),w=d(48),z=d(364),x=d(80),u;(function(Ta){Ta[Ta.none=0]="none";Ta[Ta.ndd=1]="mergeConflict";Ta[Ta.lXp=2]="containerBaseIdValidationFailure";Ta[Ta.Q0p=3]="failedToApplyHints";Ta[Ta.xFe=4]="validateUpdateHintsAreComplete";Ta[Ta.other=5]="other"})(u||(u={}));Object(I.b)("ParagraphMergeUsingHintsFailureReason",u);var v=d(1051),D=d(241),y=d(738);
const H=Ta=>{const cb=new l.a;Ta.forEach(sb=>{cb.add(sb);return!0});return cb};var F=d(1548),G=d(1551),K=d(1552);const R=(Ta,cb)=>{if(Ta.length!==cb.length)return!1;for(let sb=0;sb<Ta.length;sb++)Ta.K(sb).Dn=cb.K(sb),cb.K(sb).Dn=Ta.K(sb);return!0},E=(Ta,cb,sb)=>{let pb,tb,wb;pb=0;tb=!1;wb=0;var gc;if(!({idx:gc}=V(Ta,cb)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Ta.Qr()),{returnValue:!1,c5c:pb,
qvb:tb,Tdd:wb};if(!sb&&2===Ta.K(gc).type)return{returnValue:!0,c5c:gc,qvb:tb,Tdd:wb};if(!Ta.K(gc).J7())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",gc,sb,Ta.Qr()),{returnValue:!1,c5c:pb,qvb:tb,Tdd:wb};let vc=!1,Pc=0;for(;gc<Ta.length&&Ta.K(gc).xk.equals(cb);gc++){if(sb===Pc){vc=!0;break}if(sb>Pc&&sb<Pc+Ta.K(gc).length){tb=vc=!0;wb=sb-Pc;break}Pc+=Ta.K(gc).length}vc||sb!==Pc||(vc=!0);vc&&(pb=gc);return{returnValue:vc,
c5c:pb,qvb:tb,Tdd:wb}},N=(Ta,cb,sb)=>{let pb,tb,wb;wb=tb=0;pb=!1;let gc=0,vc=!1;for(;tb<Ta.length;tb++){if(cb===gc){vc=!0;break}if(cb>gc&&cb<gc+Ta.K(tb).length){pb=vc=!0;wb=cb-gc;break}gc+=Ta.K(tb).length}vc||cb!==gc||(vc=!0);vc||(Ta=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Ta.length,gc,cb),a.a.instance.Ua(573178201,1,2,Ta),sb.Oi(Object.assign(new K.a,{eventId:"8k6fz",info:Ta})));return{returnValue:vc,qvb:pb,TVh:tb,SVh:wb}},O=(Ta,cb,sb)=>{let pb;
if(Ta.K(cb).J7()&&({VWj:pb}=Ta.K(cb).ncp(sb)).returnValue)return Ta.SA(cb+1,pb),Ta.fI(cb),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",cb,sb,Ta.Qr());return!1},U=(Ta,cb,sb)=>{let pb,tb;if(!({c5c:sb,qvb:tb,Tdd:pb}=E(Ta,cb,sb)).returnValue)return{returnValue:!1,index:0};if(!tb)return{returnValue:!0,index:sb};if(O(Ta,sb,pb))return{returnValue:!0,index:sb+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
cb,pb,Ta.Qr());return{returnValue:!1,index:0}},X=(Ta,cb,sb)=>{let pb;if(!({qvb:pb,TVh:cb,SVh:sb}=N(Ta,cb,sb)).returnValue)return{returnValue:!1,index:0};if(!pb)return{returnValue:!0,index:cb};if(O(Ta,cb,sb))return{returnValue:!0,index:cb+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",sb,Ta.Qr());return{returnValue:!1,index:0}},V=(Ta,cb)=>{let sb;sb=0;for(let pb=0;pb<Ta.length;pb++)if(Ta.K(pb).xk.equals(cb))return sb=pb,{returnValue:!0,
idx:sb};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Ta.Qr());return{returnValue:!1,idx:sb}},Q=(Ta,cb)=>{let sb;sb=-1;for(let pb=cb;pb<Ta.length;pb++)if(2===Ta.K(pb).type)return sb=pb,{returnValue:!0,Wka:sb};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",cb,Ta.Qr());return{returnValue:!1,Wka:sb}},T=(Ta,cb,sb)=>{let pb;pb=-1;for(let tb=sb;tb<Ta.length;tb++)if(2===
Ta.K(tb).type&&Ta.K(tb).xk.equals(cb))return pb=tb,{returnValue:!0,Wka:pb};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",cb,sb,Ta.Qr());return{returnValue:!1,Wka:pb}},ba=(Ta,cb)=>{let sb;sb=0;var pb;if(!({idx:pb}=V(Ta,cb)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Ta),{returnValue:!1,length:sb};for(;pb<Ta.length;pb++)if(6!==Ta.K(pb).type){if(2===Ta.K(pb).type)return{returnValue:!0,
length:sb};a.a.instance.shipAssertTag(17342617,1,Ta.K(pb).J7(),"We found something other than text with type "+Ta.K(pb).type);a.a.instance.shipAssertTag(17877021,1,Ta.K(pb).xk.equals(cb),"Unexpected GraphNodeId {0} for ParaId {1}",Ta.K(pb).xk,cb);sb+=Ta.K(pb).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Ta);return{returnValue:!1,length:sb}},W=Ta=>{const cb=new l.a;for(let sb=0;sb<Ta.length;sb++)cb.add(Ta.K(sb).clone());return cb};var aa=d(1550),Y=d(1494);
class da{constructor(Ta,cb,sb=null,pb=null){this.xk=Ta;this.type=cb;this.text=sb;this.ed=pb}isEqual(Ta){return Ta.xk.equals(this.xk)&&this.type===Ta.type&&this.ed===Ta.ed&&Y.a.LTh(this.text,Ta.text)}toString(){let Ta=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.xk,this.ed,this.type);this.text&&(Ta+=String.format(" [TextLength: {0}]",this.text.length));return Ta}}Object(I.a)(da,"MergeBlockValidationState",null,[]);var ka=d(253),qa=d(888),ua=d(889),Pa=d(485),Ja=d(486),
Ca=d(887),ra=d(886),Ea=d(1475),xa=d(1753),Ma;(function(Ta){Ta[Ta.Rj=1]="base";Ta[Ta.c1p=2]="favoredUpdate";Ta[Ta.bqq=4]="unfavoredUpdate";Ta[Ta.min=1]="min";Ta[Ta.max=7]="max"})(Ma||(Ma={}));Object(I.b)("MergeBlockSource",Ma);class ha{constructor(Ta,cb,sb,pb){this.Rg=Ta;this.cp=cb;this.USd=sb;this.ktd=pb}}Object(I.a)(ha,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var la=d(1547);class Fa extends la.a{constructor(Ta,cb){super(6,Ta,cb);this.ed=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.xk)}ejc(){return"Selection"}clone(){return new Fa(this.source,this.xk)}aC(){return!1}get length(){return 0}}Object(I.a)(Fa,"SelectionMergeBlock",la.a,[]);var Ga;(function(Ta){Ta[Ta.success=0]="success";Ta[Ta.Elq=1]="selfSplit";Ta[Ta.veq=2]="noSecondaryBlockToSplit";Ta[Ta.$pq=3]="unexpected"})(Ga||(Ga={}));Object(I.b)("SplitTwinListResult",Ga);var va=d(1613);class pa extends va.a{constructor(Ta,cb,sb,pb){super(5,Ta,cb);this._text=null;this.Eod(sb);this.KRk=pb}get text(){return this._text}Eod(Ta){this._text=
Ta}get Rsd(){return this.KRk}clone(){return new pa(this.source,this.xk,this.text,this.Rsd)}get Deb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(I.a)(pa,"UpdateHintTextMergeBlock",va.a,[]);class Oa{constructor(Ta,cb,sb,pb){this.F5=!1;this.skb=new z.a;this.fe=Ta;this.cJh=pb;this.dah=sb;this._base=cb;this.SOe=W(cb);if(!R(this.Rj,this.ef))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Ta.logger.Oi(Object.assign(new Ea.a,
{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get Rj(){return this._base}get ef(){return this.SOe}get ndd(){return this.F5}eif(Ta,cb){switch(Ta.type){case 1:return this.v8k(Ta,cb);case 2:return this.Dhf(Ta,cb);case 3:return this.w9k(Ta,cb);case 4:return this.Q8k(Ta);case 5:return this.M7k(Ta,cb);case 6:return this.Bhf(Ta);default:return!1}}dif(Ta,cb){switch(Ta.type){case 1:return this.Hhf(Ta,cb);case 2:return this.Chf(Ta,cb);case 3:return this.v9k(Ta,cb);case 4:return this.P8k(Ta);
case 5:return this.L7k(Ta,cb);case 6:return this.Ahf(Ta);default:return{returnValue:!1,tv:null}}}v8k(Ta,cb){let sb;const pb=({Ila:sb}=this.bOa(Ta.Rg,cb,!1,Ta.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==pb&&1!==pb)return 3!==pb&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",Ma[cb],Ga[pb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.F5=
!1;cb=new pa(cb,Ta.Rg,Ta.text,Ta.id);this.CUf(Ta,sb,cb);return!0}Dhf(Ta,cb){let sb,pb=({Ila:sb}=this.bOa(Ta.Rg,cb,!1,Ta.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==pb&&1!==pb)return 3!==pb&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",Ma[cb],Ga[pb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let tb;({Ila:tb,returnValue:pb}=
this.bOa(Ta.Rg,cb,!1,Ta.cp+Ta.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==pb&&1!==pb)return 3!==pb&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",Ma[cb],Ga[pb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.F5=!1;this.lvf(Ta,sb,tb);return!0}w9k(Ta,cb){let sb;const pb=({TSf:sb}=this.Lzi(Ta,cb,!1)).returnValue;if(0!==pb&&1!==pb)return 3!==
pb&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",Ma[cb],Ga[pb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.F5=!1;cb=new F.a(cb,Ta.Xu,Ta.mya);this.CUf(Ta,sb,cb);return!0}Q8k(Ta){let cb;if(!({qae:cb}=this.Mzi(Ta,this.ef,"Derived")).returnValue)return!1;this.lvf(Ta,cb,cb+1);return!0}M7k(Ta,cb){let sb;if(!({O7f:cb,SSf:sb}=this.FBi(Ta,!1,cb)).returnValue)return!1;
this.CUf(Ta,sb,cb);return!0}Bhf(Ta){let cb;if(!({pae:cb}=this.Czi(Ta,this.ef,"Derived")).returnValue)return!1;this.lvf(Ta,cb,cb+1);return!0}TSh(Ta,cb,sb){const pb=({Ila:cb}=this.bOa(Ta,sb,!1,cb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==pb&&1!==pb)return 3!==pb&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",Ma[sb],Ga[pb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vz"}))),!1;this.F5=!1;Ta=new Fa(sb,Ta);this.ef.insert(cb,Ta);return!0}Hhf(Ta,cb){var sb=null;if(Oa.qXi(Ta.text.length))return{returnValue:!1,tv:sb};let pb,tb,wb;var gc=({Ila:pb,iBa:tb,xka:wb}=this.bOa(Ta.Rg,cb,!0,Ta.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==gc&&2!==gc)return 3!==gc&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",Ma[cb],Ga[gc]),this.fe.logger.Oi(Object.assign(new xa.a,
{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,tv:sb};this.F5=!1;({Wka:gc}=Q(this.ef,tb));gc=this.ef.K(gc).xk;sb=new pa(cb,Ta.Rg,Ta.text,Ta.id);cb=new pa(cb,gc,Ta.text,Ta.id);sb.Dn=cb;cb.Dn=sb;this.Rj.insert(pb,sb);this.ef.insert(tb,cb);sb=new l.a;sb.add(new Ja.a(gc,wb,Ta.text,Ta.id,Ta.Ov));return{returnValue:!0,tv:sb}}Chf(Ta,cb){let sb;sb=null;if(Oa.qXi(Ta.text.length))return{returnValue:!1,tv:sb};let pb;var tb,wb=({Ila:pb,iBa:gc,xka:tb}=this.bOa(Ta.Rg,cb,!0,Ta.cp,!1,
"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==wb){if(2!==wb)return 3!==wb&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",Ma[cb],Ga[wb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,tv:sb};var gc=0;for({idx:tb}=V(this.Rj,Ta.Rg);tb<this.Rj.length&&gc<Ta.cp;tb++)gc+=this.Rj.K(tb).length;gc-=this.Rj.K(tb-1).length;
({iBa:gc,xka:tb,returnValue:wb}=this.bOa(Ta.Rg,cb,!0,gc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==wb)return 3!==wb&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",Ma[cb],Ga[wb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,tv:sb};this.F5=!1}var vc,Pc;({Ila:vc,iBa:Pc,xka:ld,returnValue:wb}=this.bOa(Ta.Rg,
cb,!0,Ta.cp+Ta.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==wb){if(2!==wb)return 3!==wb&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",Ma[cb],Ga[wb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,tv:sb};var ld=0;for({idx:Pc}=V(this.Rj,Ta.Rg);Pc<this.Rj.length&&ld<Ta.cp+Ta.text.length;Pc++)ld+=this.Rj.K(Pc).length;
({iBa:Pc,xka:ld,returnValue:wb}=this.bOa(Ta.Rg,cb,!0,ld,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==wb)return 3!==wb&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",Ma[cb],Ga[wb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,tv:sb};this.F5=!1}cb="";sb=new l.a;for(--Pc;Pc>=gc;Pc--)if(6!==this.ef.K(Pc).type)if(this.ef.K(Pc).Dn)cb=
this.ef.K(Pc).text+cb,this.ef.fI(Pc);else{if(5===this.ef.K(Pc).type)wb=ld-cb.length;else if(2===this.ef.K(Pc).type){if(wb=0,!({length:ld}=ba(this.ef,this.ef.K(Pc).xk)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,tv:sb}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),
this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,tv:sb};if(!({Wka:Dc}=Q(this.ef,Pc+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,tv:sb};var Dc=this.ef.K(Dc).xk;sb.add(new Pa.a(Dc,wb,cb));cb=""}for(--vc;vc>=pb;vc--)this.Rj.fI(vc);if(!({Wka:Dc}=Q(this.ef,
gc)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,tv:sb};Dc=this.ef.K(Dc).xk;cb&&cb.length&&sb.add(new Pa.a(Dc,tb,cb,Ta.id,Ta.Ov));return{returnValue:!0,tv:sb}}v9k(Ta,cb){var sb=null;let pb,tb,wb;var gc=({TSf:pb,sPi:tb,xka:wb}=this.Lzi(Ta,cb,!0)).returnValue;if(0!==gc)return 3!==gc&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",
Ma[cb],Ga[gc]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,tv:sb};var vc;if(!({Wka:vc}=Q(this.ef,tb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,tv:sb};gc=this.ef.K(vc).xk;const Pc=this.ef.K(vc).ed;let ld,Dc,ic;({Xu:vc,S$:ld,mya:Dc,pea:ic}=this.wBm(Ta,vc));this.t0h(this.ef,vc,ld,ic,tb);sb=new F.a(cb,Ta.Xu,Ta.mya);cb=
new F.a(cb,vc,Dc);sb.Dn=cb;cb.Dn=sb;this.Rj.insert(pb,sb);this.ef.insert(tb,cb);sb=new l.a;sb.add(new ra.a(gc,Pc,wb,vc,Dc,ld,ic,Ta.id,Ta.Ov));return{returnValue:!0,tv:sb}}P8k(Ta){let cb;cb=null;let sb,pb;var tb;if(!({qae:sb}=this.Mzi(Ta,this.Rj,"Base")).returnValue)return{returnValue:!1,tv:cb};if(!this.Rj.K(sb).Dn||!({Wka:pb}=T(this.ef,this.Rj.K(sb).Dn.xk,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),
this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.F5=!0,{returnValue:!1,tv:cb};if(!({Wka:tb}=Q(this.ef,pb+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.F5=!0,{returnValue:!1,tv:cb};let wb,gc,vc,Pc,ld,Dc;({pbb:tb,qbb:vc,Nag:wb,
KRn:Pc,vRn:gc,wRn:ld}=this.Som(Ta,pb,tb));if(!({length:Dc}=ba(this.ef,tb)).returnValue)return{returnValue:!1,tv:cb};this.s0h(this.ef,tb,vc,pb);this.ef.fI(pb);this.Rj.fI(sb);cb=new l.a;cb.add(new Ca.a(wb,Pc,Dc,gc,ld,tb,vc,Ta.id,Ta.Ov));return{returnValue:!0,tv:cb}}L7k(Ta,cb){var sb=null;let pb,tb,wb;if(!({O7f:wb,SSf:pb}=this.FBi(Ta,!0,cb)).returnValue)return{returnValue:!1,tv:sb};if(!({dsb:tb}=this.s3c(this.Rj,this.ef,pb,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),
{returnValue:!1,tv:sb};if(0<tb&&2!==this.ef.K(tb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.F5=!0,{returnValue:!1,tv:sb};let gc;if(!({Xu:gc}=this.msi(tb)).returnValue)return{returnValue:!1,tv:sb};cb=new F.a(cb,Ta.Rg,Ta.ed);sb=wb;sb.Dn=cb;cb.Dn=sb;this.Rj.insert(pb,wb);this.ef.insert(tb,cb);sb=new l.a;
sb.add(new qa.a(Ta.Rg,Ta.ed,gc,Ta.id,Ta.Ov));return{returnValue:!0,tv:sb}}Ahf(Ta){let cb;cb=null;let sb;var pb;if(!({pae:pb}=this.Czi(Ta,this.Rj,"Base")).returnValue)return{returnValue:!1,tv:cb};if(!this.Rj.K(pb).Dn||!this.Rj.K(pb).Dn.xk.equals(Ta.Rg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),
this.F5=!0,{returnValue:!1,tv:cb};if(!({dsb:sb}=this.s3c(this.Rj,this.ef,pb,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,tv:cb};if(0<sb&&2!==this.ef.K(sb).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.F5=!0,{returnValue:!1,
tv:cb};const tb=this.ef.K(sb).xk,wb=this.ef.K(sb).ed;this.ef.fI(sb);this.Rj.fI(pb);({Xu:pb}=this.msi(sb));0<sb&&6===this.ef.K(sb-1).type&&this.Deo(sb-1,pb);cb=new l.a;cb.add(new ua.a(tb,wb,pb,Ta.id,Ta.Ov));return{returnValue:!0,tv:cb}}SSh(Ta,cb,sb){let pb;var tb=({Ila:cb,iBa:pb}=this.bOa(Ta,sb,!0,cb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==tb)return 3!==tb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
Ma[sb],Ga[tb]),this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({Wka:tb}=Q(this.ef,pb));tb=this.ef.K(tb).xk;Ta=new Fa(sb,Ta);sb=new Fa(sb,tb);Ta.Dn=sb;sb.Dn=Ta;this.Rj.insert(cb,Ta);this.ef.insert(pb,sb);return!0}Som(Ta,cb,sb){let pb,tb,wb;pb=Ta.pbb.equals(Ta.Rg)?this.ef.K(cb).xk:this.ef.K(sb).xk;Ta=Ta.qbb===Ta.ed?this.ef.K(cb).ed:this.ef.K(sb).ed;tb=this.ef.K(cb).xk;cb=this.ef.K(cb).ed;wb=this.ef.K(sb).xk;sb=this.ef.K(sb).ed;return{pbb:pb,qbb:Ta,
Nag:tb,KRn:cb,vRn:wb,wRn:sb}}wBm(Ta,cb){let sb;var pb=Ta.Rg.equals(Ta.Xu)?Ta.S$:Ta.Xu;const tb=Ta.ed===Ta.mya?Ta.pea:Ta.mya;Ta.Rg.equals(Ta.Xu)?sb=this.ef.K(cb).xk:(sb=pb,pb=this.ef.K(cb).xk);Ta.ed===Ta.mya?(Ta=this.ef.K(cb).ed,cb=tb):(Ta=tb,cb=this.ef.K(cb).ed);return{Xu:sb,S$:pb,mya:Ta,pea:cb}}u0h(Ta,cb,sb,pb){for(;pb<Ta.length;pb++){if(!Ta.K(pb).J7()&&6!==Ta.K(pb).type&&2!==Ta.K(pb).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Ta.K(pb).type);break}Ta.K(pb).xk=cb;
if(2===Ta.K(pb).type){Ta.K(pb).ed=sb;break}}}t0h(Ta,cb,sb,pb,tb){this.u0h(Ta,sb,pb,tb);Oa.v0h(Ta,cb,tb)}s0h(Ta,cb,sb,pb){this.u0h(Ta,cb,sb,pb+1);Oa.v0h(Ta,cb,pb)}Mzi(Ta,cb,sb){let pb,tb=-1;if(!({Wka:pb}=T(cb,Ta.Rg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+sb+"for GraphNodeId "+Ta.Rg),{returnValue:!1,qae:pb};if(!({Wka:tb}=Q(cb,pb+1)).returnValue||!cb.K(tb).xk.equals(Ta.S$))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
pb+1+" in "+sb+" of length "+cb.length),{returnValue:!1,qae:pb};this.s0h(cb,Ta.pbb,Ta.qbb,pb);return{returnValue:!0,qae:pb}}Lzi(Ta,cb,sb){let pb;const tb=sb?this.Rj:this.ef,wb=sb?"Base":"Derived",gc=({Ila:cb,iBa:sb,xka:pb}=this.bOa(Ta.Rg,cb,sb,Ta.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===gc||2===gc)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+wb),{returnValue:gc,TSf:cb,sPi:sb,xka:pb};this.t0h(tb,Ta.Xu,Ta.S$,Ta.pea,cb);return{returnValue:gc,
TSf:cb,sPi:sb,xka:pb}}Czi(Ta,cb,sb){return({idx:Ta}=V(cb,Ta.Rg)).returnValue?2!==cb.K(Ta).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+sb),{returnValue:!1,pae:-1}):{returnValue:!0,pae:Ta}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+sb),{returnValue:!1,pae:-1})}Deo(Ta,cb){var sb=this.ef.K(Ta);if(cb){let pb;({Wka:pb}=T(this.ef,cb,0));sb=sb.clone();sb.xk=cb;this.ef.fI(Ta);this.ef.insert(pb,
sb)}else this.ef.length>Ta&&(this.ef.K(Ta+1).J7()||2===this.ef.K(Ta+1).type)&&(sb.xk=this.ef.K(Ta+1).xk)}FBi(Ta,cb,sb){var pb=cb?this.Rj:this.ef;cb=cb?"Base":"Derived";sb=new F.a(sb,Ta.Rg,Ta.ed);if(Ta.Xu){if(!({Wka:pb}=T(pb,Ta.Xu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Ta.Xu,cb),{returnValue:!1,O7f:sb,SSf:pb};pb+=1}else pb=0;return{returnValue:!0,O7f:sb,SSf:pb}}msi(Ta){let cb;cb=null;let sb=Ta-1;if(-1===
sb)return{returnValue:!0,Xu:cb};6===this.ef.K(sb).type&&sb--;if(2===this.ef.K(sb).type||4===this.ef.K(sb).type)return cb=this.ef.K(sb).xk,{returnValue:!0,Xu:cb};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.ef.K(Ta-1).type);return{returnValue:!1,Xu:cb}}s3c(Ta,cb,sb,pb){let tb,wb=!0;tb=-1;if(sb>Ta.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,dsb:tb};
if(sb<Ta.length){if(-1<sb&&sb<Ta.length&&!Ta.K(sb).Dn){wb=!1;for(var gc=sb+1;gc<Ta.length;gc++)if(Ta.K(gc).Dn){sb=gc;wb=!0;break}}if(!wb)return{returnValue:!1,dsb:tb};wb=!1;for(gc=0;Ta.K(sb)&&gc<cb.length;gc++)if(cb.K(gc).Dn===Ta.K(sb)){tb=gc;wb=!0;break}if(!wb)return{returnValue:!1,dsb:tb}}else tb=cb.length;if(0<tb&&pb&&!cb.K(tb-1).Dn){for(Ta=tb-1;0<=Ta&&!cb.K(Ta).Dn;Ta--);tb=Ta+1;6===cb.K(tb).type&&5!==this.fe.input.source&&tb++}return{returnValue:!0,dsb:tb}}bOa(Ta,cb,sb,pb,tb,wb){let gc;var vc;
let Pc;var ld=this.Rj;let Dc=this.ef,ic=!1;sb||(ld=this.ef,Dc=this.Rj);Pc=vc=gc=0;let mc,Rc,rb=0;if(!({c5c:pb,qvb:mc,Tdd:Rc}=E(ld,Ta,pb)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Ila:gc,iBa:vc,xka:Pc};0<=pb&&pb<ld.length&&!ld.K(pb).Dn&&mc&&!tb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
wb),this.F5=!0,rb=cb===ld.K(pb).source?1:2,ic=!0);tb&&!ld.K(pb)&&pb--;tb&&mc&&!ld.K(pb).Dn&&(mc=!1,Rc=0);if(!sb&&!({idx:Ta}=V(Dc,Ta)).returnValue&&!mc)return{returnValue:0,Ila:pb,iBa:vc,xka:Pc};if(!({dsb:Ta}=this.s3c(ld,Dc,pb,sb&&!mc)).returnValue&&!ic&&(cb=!1,1===this.cJh&&0<pb&&!Rc&&(pb--,{dsb:Ta,returnValue:cb}=this.s3c(ld,Dc,pb,sb&&!mc),cb&&(pb++,Ta<Dc.length-1?Ta++:cb=!1)),!cb))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.fe.logger.Oi(Object.assign(new xa.a,{gk:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.F5=!0,{returnValue:3,Ila:gc,iBa:vc,xka:Pc};if(mc&&(!O(ld,pb,Rc)||!ic&&!O(Dc,Ta,Rc)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Ila:gc,iBa:vc,xka:Pc};gc=pb;vc=Ta;mc&&(gc=pb+1,ic||(vc=ld.K(pb),sb=Dc.K(Ta),vc.Dn=sb,sb.Dn=vc,ld=ld.K(pb+1),vc=Dc.K(Ta+1),ld.Dn=vc,vc.Dn=
ld,vc=Ta+1));if(vc>=Dc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+vc+" secondaryList length was "+Dc.length),{returnValue:3,Ila:gc,iBa:vc,xka:Pc};for(ld=0;ld<vc;ld++)Dc.K(ld).xk.equals(Dc.K(vc).xk)&&(Pc+=Dc.K(ld).length);return{returnValue:rb,Ila:gc,iBa:vc,xka:Pc}}lvf(Ta,cb,sb){this.dah.contains(Ta.id)&&this.skb.W(Ta.id,new l.a);for(--sb;sb>=cb;sb--)this.dah.contains(Ta.id)?this.skb.K(Ta.id).insert(this.skb.K(Ta.id).length,
this.ef.K(sb)):this.ef.K(sb).Dn&&(this.ef.K(sb).Dn.Dn=null),this.ef.fI(sb)}CUf(Ta,cb,sb){if(this.skb.tb(Ta.Ov)){const pb=this.skb.K(Ta.Ov);for(let tb=0;tb<pb.length;tb++)pb.K(tb).xk=sb.xk,Object(ka.a)(F.a,sb)&&Object(ka.a)(F.a,pb.K(tb))&&(pb.K(tb).ed=sb.ed);this.ef.SA(cb,this.skb.K(Ta.Ov));this.skb.remove(Ta.Ov)}else this.ef.insert(cb,sb)}YPm(Ta){let cb,sb;sb=cb=-1;if(!Ta.Dn)return{returnValue:!1,ngc:cb,Ivf:sb};var pb;let tb=0,wb=!1;if(!({idx:pb}=V(this.ef,Ta.Dn.xk)).returnValue)return{returnValue:!1,
ngc:cb,Ivf:sb};for(;pb<this.ef.length;pb++){if(Ta.Dn===this.ef.K(pb)){cb=pb;sb=tb;wb=!0;break}tb+=this.ef.K(pb).length}return{returnValue:wb,ngc:cb,Ivf:sb}}uCf(Ta){let cb;cb=new l.a;let sb=0,pb=0;for(;sb<Ta.length;){if(pb>=this.Rj.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,CAc:cb};if(Ta.K(sb).length>this.Rj.K(pb).length){if(!O(Ta,sb,this.Rj.K(pb).length))return a.a.instance.Ua(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",
sb,this.Rj.K(pb).length),{returnValue:!1,CAc:cb}}else if(Ta.K(sb).length<this.Rj.K(pb).length){var tb=!!this.Rj.K(pb).Dn,wb=0;if(tb&&!({dsb:wb}=this.s3c(this.Rj,this.ef,pb,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",pb),{returnValue:!1,CAc:cb};if(!O(this.Rj,pb,Ta.K(sb).length)||tb&&!O(this.ef,wb,Ta.K(sb).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,CAc:cb};if(tb){tb=this.Rj.K(pb);var gc=this.ef.K(wb);tb.Dn=gc;gc.Dn=tb;tb=this.Rj.K(pb+1);wb=this.ef.K(wb+1);tb.Dn=wb;wb.Dn=tb}}if(this.Rj.K(pb).Dn&&5!==this.Rj.K(pb).type&&this.Rj.K(pb).J7()&&(wb=this.Rj.K(pb),tb=Ta.K(sb),!wb.oL.equals(tb.oL)||!wb.dA.aC(tb.dA))){let vc;if(!({ngc:gc,Ivf:vc}=this.YPm(this.Rj.K(pb))).returnValue)return{returnValue:!1,CAc:cb};cb.add(new ha(this.ef.K(gc).xk,vc,wb,tb))}sb++;pb++}return{returnValue:!0,CAc:cb}}static v0h(Ta,cb,sb){for(--sb;0<=sb;sb--){if(!Ta.K(sb).J7()&&
6!==Ta.K(sb).type){a.a.instance.shipAssertTag(17311187,1,2===Ta.K(sb).type||4===Ta.K(sb).type,"Found merge block of type "+Ta.K(sb).type);break}Ta.K(sb).xk=cb}}static qXi(Ta){return Ta?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(I.a)(Oa,"ParagraphMergeUsingHintsTwinList",null,[1086]);var Ra=d(1751),fb=d(1752),qb=d(1748),mb=d(1750),eb=d(1749);class bb{constructor(Ta,cb,sb,pb){this.cp=Ta;this.length=
cb;this.USd=sb;this.ktd=pb}}Object(I.a)(bb,"UpdateFormattingIdsPosInfo",null,[]);class Wa{constructor(Ta,cb,sb){this.F5=!1;this.skb=new z.a;this.Huh=!1;this.fe=Ta;this.cJh=sb;this._base=cb;this.SOe=W(cb);if(!R(this.Rj,this.ef))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Ta.logger.Oi(Object.assign(new K.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.fe.runtime.rc.xrb(1000010)&&(this.Huh=!0)}get Rj(){return this._base}get ef(){return this.SOe}get ndd(){return this.F5}eif(Ta,
cb){switch(Ta.type){case 11:return this.t8k(Ta,cb);case 8:return this.Dhf(Ta,cb);case 10:return this.Bhf(Ta);default:return!1}}dif(Ta,cb){switch(Ta.type){case 11:return this.s8k(Ta,cb);case 8:return this.Chf(Ta,cb);case 10:return this.Ahf(Ta);default:return{returnValue:!1,tv:null}}}TSh(){a.a.instance.Ua(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}SSh(){a.a.instance.Ua(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}uCf(Ta){let cb;cb=new l.a;let sb=0,pb=0,tb=0;for(;sb<Ta.length;){if(pb>=this.Rj.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,jtd:cb};if(Ta.K(sb).length>this.Rj.K(pb).length){if(!O(Ta,sb,this.Rj.K(pb).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,jtd:cb}}else if(Ta.K(sb).length<this.Rj.K(pb).length&&!this.xeb(tb+Ta.K(sb).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),
this.fe.logger.Oi(Object.assign(new K.a,{gk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,jtd:cb};if(this.Rj.K(pb).Dn&&5!==this.Rj.K(pb).type&&this.Rj.K(pb).J7()){const wb=this.Rj.K(pb),gc=Ta.K(sb);if(!wb.oL.equals(gc.oL)||!wb.dA.aC(gc.dA)){let vc,Pc;if(({ngc:vc,Dei:Pc}=this.ZPm(this.Rj.K(pb))).returnValue)cb.add(new bb(Pc,this.ef.K(vc).length,wb,gc));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),
this.fe.logger.Oi(Object.assign(new K.a,{gk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,jtd:cb}}}tb+=this.Rj.K(pb).length;sb++;pb++}return{returnValue:!0,jtd:cb}}t8k(Ta,cb){let sb;if(!({dJa:sb}=this.xeb(Ta.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let tb=0;tb<Ta.W2.length;tb++)switch(Ta.W2.K(tb).type){case 7:var pb=
Ta.W2.K(tb);this.ef.insert(sb,new pa(cb,null,pb.text,pb.id));break;case 9:pb=Ta.W2.K(tb);this.ef.insert(sb,new F.a(cb,pb.Rg,pb.ed));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Dhf(Ta,cb){let sb,pb;if(!({dJa:sb}=this.xeb(Ta.cp,!0)).returnValue||!({dJa:pb}=this.xeb(Ta.cp+Ta.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),
this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Ta=pb;Ta>=sb;Ta--)this.ef.K(Ta).source!==cb&&this.GZd(this.ef,Ta);return!0}Bhf(Ta){let cb;if(!({dJa:cb}=this.xeb(Ta.cp,!0)).returnValue)return a.a.instance.Ua(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.ovf(this.ef,Ta,cb);return!0}s8k(Ta,cb){let sb;sb=null;let pb,tb;if(!({VKb:pb,dJa:tb}=this.xeb(Ta.cp,
!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,tv:sb};var wb=this.zHf(this.ef,tb-1);wb=new eb.a(wb);for(let gc=0;gc<Ta.W2.length;gc++)switch(Ta.W2.K(gc).type){case 7:wb.W2.add(this.Hhf(Ta.W2.K(gc),cb,pb,tb));break;case 9:wb.W2.add(this.u8k(Ta.W2.K(gc),cb,pb,tb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),
this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,tv:sb}}sb=new l.a;sb.add(wb);return{returnValue:!0,tv:sb}}Hhf(Ta,cb,sb,pb){const tb=new pa(cb,Ta.Rg,Ta.text,Ta.id);cb=new pa(cb,Ta.Rg,Ta.text,Ta.id);tb.Dn=cb;cb.Dn=tb;this.Rj.insert(sb,tb);this.ef.insert(pb,cb);sb=new mb.a(Ta.Rg,Ta.text);sb.id=Ta.id;return sb}u8k(Ta,cb,sb,pb){const tb=new F.a(cb,Ta.Rg,Ta.ed);cb=new F.a(cb,Ta.Rg,Ta.ed);tb.Dn=cb;cb.Dn=tb;this.Rj.insert(sb,tb);this.ef.insert(pb,
cb);return new qb.a(Ta.Rg,Ta.ed)}Chf(Ta){let cb;cb=new l.a;let sb;var pb;let tb;if(!({VKb:sb,dJa:pb}=this.xeb(Ta.cp,!0)).returnValue||!({VKb:tb,dJa:wb}=this.xeb(Ta.cp+Ta.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,tv:cb};this.fe.runtime.rc.L9d(1000010);for(Ta=wb;Ta>=pb;Ta--)if(this.ef.K(Ta).Dn){var wb=Ta;const gc=({Iag:Ta}=
this.I8l(Ta,pb)).returnValue;gc&&(cb.add(gc),this.GZd(this.ef,Ta,wb))}for(pb=tb;pb>=sb;pb--)this.GZd(this.Rj,pb);return{returnValue:!0,tv:cb}}Ahf(Ta){let cb;cb=null;let sb,pb;if(!({VKb:sb,dJa:pb}=this.xeb(Ta.cp,!0)).returnValue)return a.a.instance.Ua(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,tv:cb};if(!this.ovf(this.Rj,Ta,sb))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),
this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,tv:cb};this.ovf(this.ef,Ta,pb)&&(cb=new l.a,cb.add(new Ra.a(this.zHf(this.ef,pb-1),Ta.Rg,Ta.ed)));return{returnValue:!0,tv:cb}}xeb(Ta,cb){var sb;var pb=sb=-1;let tb,wb;if(!({qvb:wb,TVh:Ta,SVh:tb}=N(this.Rj,Ta,this.fe.logger)).returnValue)return{returnValue:!1,VKb:sb,dJa:pb};const gc=Ta>=this.Rj.length;gc&&Ta--;if(this.Rj.K(Ta).Dn){const vc=this.h$l(this.ef,this.Rj.K(Ta));if(wb){if(0>
vc||!O(this.Rj,Ta,tb)||!O(this.ef,vc,tb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,VKb:sb,dJa:pb};sb=this.Rj.K(Ta);pb=this.ef.K(vc);sb.Dn=pb;pb.Dn=sb;sb=this.Rj.K(Ta+1);pb=this.ef.K(vc+1);sb.Dn=pb;pb.Dn=sb;sb=cb?Ta+1:Ta;pb=cb?vc+1:vc}else cb?(sb=gc?Ta+1:Ta,pb=gc?vc+1:vc):(sb=gc?Ta:Ta-1,pb=gc?vc:vc-1)}else if(wb){if(O(this.Rj,Ta,tb))sb=cb?Ta+1:Ta;else return a.a.instance.Ua(575706445,
1,2,"SplitTwinListAndFindIdx"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,VKb:sb,dJa:pb};cb?(pb=({TRb:pb}=this.eic(this.Rj,this.ef,Ta,!1)).returnValue?pb+1:0,pb=pb>=this.ef.length?this.ef.length-1:pb):(pb=({TRb:pb}=this.eic(this.Rj,this.ef,Ta,!0)).returnValue?pb-1:this.ef.length-1,pb=0>pb?0:pb)}else cb?(({TRb:pb}=this.eic(this.Rj,this.ef,Ta,!0)).returnValue||(({TRb:pb}=this.eic(this.Rj,this.ef,Ta,!1)).returnValue?pb+=1:(pb=gc?this.ef.length-
1:0,pb=0>pb?0:pb)),sb=gc?Ta+1:Ta):(({TRb:pb}=this.eic(this.Rj,this.ef,Ta,!1)).returnValue||(({TRb:pb}=this.eic(this.Rj,this.ef,Ta,!0)).returnValue?--pb:(pb=Ta?this.ef.length-1:0,pb=0>pb?0:pb)),sb=gc?Ta:Ta-1);return{returnValue:!0,VKb:sb,dJa:pb}}eic(Ta,cb,sb,pb){let tb=null;if(pb)for(;sb<Ta.length;sb++){if(Ta.K(sb).Dn){tb=Ta.K(sb).Dn;break}}else for(;0<=sb;sb--)if(Ta.K(sb).Dn){tb=Ta.K(sb).Dn;break}if(tb)for(Ta=0;Ta<cb.length;Ta++)if(cb.K(Ta)===tb)return cb=Ta,{returnValue:!0,TRb:cb};return{returnValue:!1,
TRb:-1}}h$l(Ta,cb){for(let sb=0;sb<Ta.length;sb++)if(Ta.K(sb).Dn===cb)return sb;return-1}GZd(Ta,cb,sb=-1){for(sb=0>sb?cb:sb;sb>=cb;sb--)Ta.K(sb).Dn&&(Ta.K(sb).Dn.Dn=null),Ta.fI(sb)}zHf(Ta,cb){let sb=0;for(;0<=cb;cb--)sb+=Ta.K(cb).length;return sb}sOm(Ta){Ta=Object(x.a)(va.a,Ta);Ta||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"GetTextBlock",eventId:"8ujvq"})));return Ta}I8l(Ta,cb){let sb="",pb=Ta;for(;pb>=cb&&this.ef.K(pb).Dn&&2!==this.ef.K(pb).type;)sb=
this.sOm(this.ef.K(pb)).text+sb,pb--;cb=0>pb?0:this.zHf(this.ef,pb);return!this.Huh||pb<Ta?(Ta=pb+1,{returnValue:new fb.a(cb,sb),Iag:Ta}):{returnValue:null,Iag:pb}}ZPm(Ta){let cb,sb,pb=!1;sb=cb=0;if(!Ta.Dn)return{returnValue:!1,ngc:cb,Dei:sb};for(cb=0;cb<this.ef.length;cb++){if(this.ef.K(cb).Dn===Ta){pb=!0;break}sb+=this.ef.K(cb).length}return{returnValue:pb,ngc:cb,Dei:sb}}ovf(Ta,cb,sb){sb=sb===Ta.length?--sb:sb;sb>Ta.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.fe.logger.Oi(Object.assign(new K.a,
{gk:"DeleteEopInList",eventId:"8ffwf"})));if(2===Ta.K(sb).type){const pb=Ta.K(sb);if(pb.xk!==cb.Rg||pb.ed!==cb.ed)return!1;this.GZd(Ta,sb);return!0}return!1}}Object(I.a)(Wa,"ParagraphMergeUsingHintsTwinListLcs",null,[1086]);var Za=d(1519),Na=d(1476),Db=d(1747);d.d(J,"a",function(){return nb});class nb{constructor(Ta,cb,sb,pb,tb,wb,gc=null,vc=null,Pc=null){this.eT=this.fya=this.AQa=this.gwa=null;this._initialized=!1;this.fe=Ta;this.BH=cb;this.hHa=pb;this.NFa=sb;this.Jwa=tb;this.PKe=new f.a;for(Ta=
0;Ta<this.BH.length;Ta++)this.PKe.add(this.BH.K(Ta).id);this.khh=new f.a;for(Ta=0;Ta<this.NFa.length;Ta++)this.khh.add(this.NFa.K(Ta).id);this.QIh=new f.a;for(Ta=0;Ta<this.hHa.length;Ta++)this.QIh.add(this.hHa.K(Ta).id);this.xg=wb;this.ebf=gc||y.a.instance;this.GK=vc;this.IZ=Pc;this.mFb=1===(this.GK&&this.IZ&&1===this.GK.UOa&&1===this.IZ.UOa?1:0);this.Iwa=0}get dug(){return 1!==this.Iwa}L9m(){var Ta=!0;if(this.GK&&this.IZ)return Ta;if(this.GK||this.IZ)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.fe.runtime.JA.tb(D.a.MN)&&(Ta=this.fe.runtime.JA.K(D.a.MN),Ta=this.mMg(Ta,this.fe.runtime.qIa.id,"favored")&&({pK:this.GK}=this.xRi(Ta,this.PKe,this.khh,this.fe.runtime.JA,"favored")).returnValue);Ta&&this.fe.runtime.sv.tb(D.a.MN)&&(Ta=this.fe.runtime.sv.K(D.a.MN),Ta=this.mMg(Ta,this.fe.runtime.qIa.id,"unfavored")&&({pK:this.IZ}=this.xRi(Ta,this.PKe,this.QIh,this.fe.runtime.sv,"unfavored")).returnValue);this.GK=this.GK?this.GK:new Db.a(new l.a,0);this.IZ=this.IZ?this.IZ:new Db.a(new l.a,0);
Ta&&this.fe.input.VRb&&(Ta=this.fe.input.Oca.last().jKa(D.a.MN),Ta=this.mMg(Ta,this.fe.input.Oca.last().DJ.id,"alreadyMerged"));return Ta}Q7m(){const Ta=new f.a;if(this.mFb)return Ta;const cb=this.GK?this.GK.pK.ONa():new l.a;let sb=0;for(;sb<cb.length-1;){const pb=cb.K(sb);let tb,wb=!1;for(tb=sb+1;tb<cb.length;tb++){const gc=cb.K(tb);if(pb.cZi(gc)){Ta.add(pb.id);cb.fI(tb);cb.fI(sb);wb=!0;break}}wb||sb++}return Ta}mMg(Ta,cb,sb){Ta=this.xg.getPropertyString(Ta,m.a.yEa);Ta=w.a.Bf(Ta);return cb.equals(Ta)?
!0:(this.Pnd(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.fe.runtime.qIa.id,Ta,sb),!1)}xRi(Ta,cb,sb,pb,tb){let wb;wb=new Db.a(new l.a,0);Ta=this.xg.getPropertyObjectIds(Ta,m.a.AY).ONa();for(let vc=0;vc<Ta.length;vc++){if(!pb.tb(Ta.K(vc)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Ta.K(vc),tb),{returnValue:!1,pK:wb};const Pc=pb.K(Ta.K(vc));var gc=w.a.Bf(this.xg.getPropertyString(Pc,m.a.Xna));if(cb.contains(gc)||sb.contains(gc)){gc=this.ebf.blc(Pc);if(!gc)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Pc.id,tb),{returnValue:!1,pK:wb};wb.pK.add(gc)}}0<Ta.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
tb,Ta.Qr(),wb.pK.Qr());return{returnValue:!0,pK:wb}}W8m(){return({OM:this.gwa,c0c:this.AQa,Asd:this.fya}=Za.a.E$h(this.fe,this.xg,this.BH,this.NFa,this.hHa,this.Jwa,!0,!0)).returnValue?!0:!1}J9m(Ta){const cb=Za.a.mYd(this.xg,sb=>this.fe.runtime.Gn.K(sb),this.BH,1,this.Jwa,!0,!0).returnValue;if(!cb)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.eT=this.mFb?new Wa(this.fe,cb,1):new Oa(this.fe,cb,Ta,this.GK?this.GK.UOa:
0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.L9m()||!this.W8m())return!1;const Ta=this.Q7m();return this.J9m(Ta)?!0:!1}HBi(Ta){const cb=new l.a;let sb="";for(let pb=0;pb<Ta.length;pb++){const tb=Ta.K(pb);tb.J7()?sb+=Ta.K(pb).text:2===tb.type?(cb.add(new da(tb.xk,tb.type,sb,tb.ed)),sb=""):4===tb.type&&(cb.add(new da(tb.xk,tb.type)),sb="")}return cb}xFe(Ta,cb,sb){cb=this.HBi(cb);Ta=this.HBi(Ta);let pb=cb.length===Ta.length;if(pb)for(let tb=0;tb<cb.length;tb++)if(!cb.K(tb).isEqual(Ta.K(tb))){pb=
!1;break}pb||(this.Pnd(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",sb,Ta.Qr(),cb.Qr()));return pb}zTh(Ta,cb,sb){(cb=({tfb:Ta}=this.f$k(Ta,cb,sb)).returnValue)||this.Pnd(this.eT.ndd?1:3);return{returnValue:cb,tfb:Ta}}f$k(Ta,cb,sb){let pb;pb=new l.a;let tb=!0;var wb=0;let gc=null,vc=this.GK?this.GK.pK.length:0;for(var Pc=0;Pc<vc&&tb;Pc++)gc=this.GK.pK.K(Pc),
wb<this.IZ.pK.length&&gc.id.equals(this.IZ.pK.K(wb).id)&&5!==this.fe.input.source?({returnValue:tb}=this.eT.dif(gc,2),wb++):tb=this.eT.eif(gc,2);if(!tb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",gc.toString()),{returnValue:!1,tfb:pb};if(!this.xFe(this.eT.ef,this.AQa,"Favored"))return{returnValue:!1,tfb:pb};if(Ta&&1===this.fe.input.zma&&!this.eT.TSh(cb,sb,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
cb,sb),{returnValue:!1,tfb:pb};tb=!0;Pc=new l.a;for(vc=this.IZ?this.IZ.pK.length:0;wb<vc&&tb;wb++){gc=this.IZ.pK.K(wb);let ld;({tv:ld,returnValue:tb}=this.eT.dif(gc,4));tb&&ld&&Pc.SA(Pc.length,ld)}return tb?this.xFe(this.eT.Rj,this.fya,"Unfavored")?Ta&&2===this.fe.input.zma&&!this.eT.SSh(cb,sb,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",cb,sb),{returnValue:!1,tfb:pb}):{returnValue:!0,tfb:Pc}:{returnValue:!1,tfb:pb}:(a.a.instance.Ua(17044291,
1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",gc.id,gc.type),{returnValue:!1,tfb:pb})}$zm(){let Ta,cb=0;let sb=0,pb=w.a.nil;for(Ta=new z.a;sb<this.eT.Rj.length;){const gc=this.eT.Rj.K(sb);pb.equals(gc.xk)||(cb=0,pb=gc.xk);if(5===gc.type){var tb=cb+gc.length;var wb=void 0;let vc;const Pc=W(this.fya);if(!({index:wb}=U(Pc,gc.xk,cb)).returnValue||!({index:vc}=U(Pc,gc.xk,tb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",
gc.Rsd),{returnValue:!1,udj:Ta};for(tb=new l.a;wb<vc;wb++)tb.add(Pc.K(wb));Ta.W(gc.Rsd,tb)}cb+=gc.length;sb++}return{returnValue:!0,udj:Ta}}aAm(){let Ta;Ta=new z.a;let cb=0;for(let pb=0;pb<this.eT.Rj.length;pb++){const tb=this.eT.Rj.K(pb);if(5===tb.type){var sb=void 0;let wb;const gc=W(this.fya);if(!({index:sb}=X(gc,cb,this.fe.logger)).returnValue||!({index:wb}=X(gc,cb+tb.length,this.fe.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),
{returnValue:!1,vdj:Ta};const vc=new l.a;for(;sb<wb;sb++)vc.add(gc.K(sb));Ta.W(tb.Rsd,vc)}cb+=tb.length}return{returnValue:!0,vdj:Ta}}R8k(Ta){let cb;cb=new l.a;let sb;if(this.mFb){if(!({vdj:sb}=this.aAm()).returnValue)return{returnValue:!1,sdd:cb}}else if(!({udj:sb}=this.$zm()).returnValue)return{returnValue:!1,sdd:cb};let pb;pb=this.mFb?new Wa(this.fe,W(this.AQa),1):new Oa(this.fe,W(this.AQa),new f.a,this.GK?this.GK.UOa:0);for(var tb=0;tb<Ta.length;tb++)if(!pb.eif(Ta.K(tb),4))return{returnValue:!1,
sdd:cb};for(Ta=pb.ef.length-1;0<=Ta;Ta--)5===pb.ef.K(Ta).type&&(tb=pb.ef.K(Ta).Rsd,pb.ef.fI(Ta),pb.ef.SA(Ta,sb.K(tb)));this.mFb&&(this.Gci(pb.ef),this.Gci(this.eT.ef));if(!this.xFe(this.eT.ef,pb.ef,"Merged"))return{returnValue:!1,sdd:cb};cb=pb.ef;return{returnValue:!0,sdd:cb}}Gci(Ta){const cb=new z.a;for(let sb=Ta.length-1;0<=sb;sb--){const pb=Object(x.a)(F.a,Ta.K(sb));pb&&(cb.tb(pb.ed)?cb.K(pb.ed).source!==pb.source&&Ta.fI(sb):cb.add(pb.ed,pb))}}e$k(Ta){let cb;if(!({jtd:cb}=this.eT.uCf(W(this.fya))).returnValue)return!1;
for(let pb=0;pb<cb.length;pb++){const tb=cb.K(pb);let wb,gc;if(!({index:wb}=X(Ta,tb.cp,this.fe.logger)).returnValue||!({index:gc}=X(Ta,tb.cp+tb.length,this.fe.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var sb=!1;for(let vc=wb;vc<gc&&!sb;vc++)sb=!tb.USd.oL.equals(Ta.K(vc).oL);if(!sb){for(sb=wb;sb<gc;sb++)Ta.fI(wb);Ta.insert(wb,
tb.ktd)}}return!0}d$k(Ta){let cb;if(!({CAc:cb}=this.eT.uCf(W(this.fya))).returnValue)return!1;for(let tb=0;tb<cb.length;tb++){var sb=cb.K(tb);let wb,gc;if(({index:wb}=U(Ta,sb.Rg,sb.cp)).returnValue&&({index:gc}=U(Ta,sb.Rg,sb.cp+sb.ktd.length)).returnValue){var pb=!1;for(let vc=wb;vc<gc&&!pb;vc++)pb=!sb.USd.oL.equals(Ta.K(vc).oL)||!sb.USd.dA.aC(Ta.K(vc).dA);if(pb){if(this.GK&&1===this.GK.UOa||this.IZ&&1===this.IZ.UOa)return!1}else{for(pb=wb;pb<gc;pb++)Ta.fI(wb);Ta.insert(wb,sb.ktd)}}else if(sb=sb.ktd.xfn,
a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",sb),sb||this.GK&&1===this.GK.UOa||this.IZ&&1===this.IZ.UOa)return!1}return!0}qFm(Ta){let cb,sb;sb=new l.a;cb=this.fe.runtime.Sq.K(D.a.MN);let pb;({X7f:pb}=nb.Msi(this.fe,this.xg));const tb=new l.a;for(let gc=0;gc<Ta.length;gc++){if(pb.contains(Ta.K(gc).id,(Pc,ld)=>Pc.equals(ld)))continue;if(this.fe.runtime.Sq.tb(Ta.K(gc).id))return a.a.instance.shipAssertTag(17044293,
1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Ta.K(gc).id),{returnValue:!1,lpe:cb,kpe:sb};tb.add(Ta.K(gc).id);var wb=Ta.K(gc).EVa();const vc=new Na.a(wb);wb=wb.Zj();for(const Pc of wb)vc.KM(Pc);sb.add(vc)}Ta=this.xg.getPropertyObjectIds(cb.zm,m.a.AY);Ta.SA(Ta.length,tb);this.xg.setPropertyObjectIds(cb.zm,m.a.AY,Ta);return{returnValue:!0,lpe:cb,kpe:sb}}Q5d(Ta){return String.format("Name: {0}, Message: {1}, Stack: {2}",Ta.name,Ta.message,Ta.stack)}Pnd(Ta){0===this.Iwa&&(this.Iwa=
Ta)}oAc(){let Ta;Ta=null;let cb,sb;var pb;try{if({Sq:Ta,lpe:cb,kpe:sb,returnValue:pb}=this.fqp(),pb){if(cb&&sb){this.fe.runtime.Sq.W(cb.zm.id,cb);for(pb=0;pb<sb.length;pb++){const vc=sb.K(pb);this.fe.runtime.Sq.W(vc.zm.id,vc)}const tb=cb.zm,wb=this.xg.getPropertyObjectIds(tb,m.a.AY),gc=this.xg.getPropertyString(tb,m.a.yEa);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",wb.Qr(),gc)}else a.a.instance.Ua(593826831,
1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Sq:Ta}}}catch(tb){a.a.instance.Ua(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.Q5d(tb))}this.Pnd(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Iwa,this.dug);this.Zab();this.GK&&1===this.GK.UOa&&this.fe.logger.Oi(Object.assign(new aa.a,{eventId:"bc04c",
gk:"ParagraphMergeUsingHints.TryDoMerge",info:u[this.Iwa]+"/LCS"}));return{returnValue:!1,Sq:Ta}}fqp(){let Ta,cb,sb;sb=cb=Ta=null;let pb;pb=this.initialize();this.fe.logger.KX("PMUH Initialize");let tb=null;pb=pb&&({tfb:tb}=this.zTh(!1,w.a.nil,0)).returnValue;this.fe.logger.KX("PMUH ApplyUpdateHints");let wb=new l.a;pb=pb&&({sdd:wb}=this.R8k(tb)).returnValue;this.fe.logger.KX("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");pb=this.mFb?pb&&this.e$k(wb):pb&&this.d$k(wb);this.fe.logger.KX("PMUH ApplyUnfavoredFormattingChanges");
this.mFb&&!this.pJo(wb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.fe.logger.Oi(Object.assign(new K.a,{gk:"ReuseParaIdsIfPossible",eventId:"8ettb"})),pb=!1);const gc=this.z7d(wb);pb=pb&&({jpe:Ta}=Za.a.F3c(this.fe,this.xg,this.Jwa,wb,gc)).returnValue;this.fe.logger.KX("PMUH GetMergeableObjectsFromMergeBlocks");this.GK&&1===this.GK.UOa&&this.IZ&&1===this.IZ.UOa||(pb=pb&&({lpe:cb,kpe:sb}=this.qFm(H(tb))).returnValue,this.fe.logger.KX("PMUH GetPartialMergeResultForUpdateHintNodes"));
return{returnValue:pb,ndd:!!this.eT&&this.eT.ndd,Sq:Ta,lpe:cb,kpe:sb}}z7d(Ta){const cb=new l.a;for(let sb=0;sb<Ta.length;sb++)2===Ta.K(sb).type&&cb.add(Ta.K(sb).xk);return cb}vIf(Ta){const cb=new l.a;for(let sb=0;sb<Ta.length;sb++)2===Ta.K(sb).type&&cb.add(Ta.K(sb));return cb}pJo(Ta){var cb=this.vIf(this.gwa),sb=this.vIf(this.AQa),pb=this.vIf(this.fya),tb=this.z7d(cb),wb=this.z7d(sb),gc=this.z7d(pb);wb=G.b(tb,wb,gc);tb=new l.a;for(gc=0;gc<wb.length;gc++)tb.SA(tb.length,wb.K(gc).j$l());wb=this.o$l(Ta);
cb=this.k$l(wb,tb,cb,sb,pb);sb=0;pb=new f.a;for(tb=0;tb<Ta.length;tb++)if(wb=Ta.K(tb),2===wb.type)if(pb.contains(wb.xk))if(sb<cb.length)Ta.fI(tb),Ta.insert(tb,cb.K(sb)),sb++;else return!1;else pb.add(wb.xk);0<Ta.length&&2!==Ta.K(Ta.length-1).type&&sb<cb.length&&Ta.insert(Ta.length,cb.K(sb));return!0}o$l(Ta){const cb=new f.a;for(let sb=0;sb<Ta.length;sb++)2===Ta.K(sb).type&&cb.add(Ta.K(sb).xk);return cb}k$l(Ta,cb,sb,pb,tb){const wb=new l.a;for(let gc=0;gc<cb.length;gc++){const vc=cb.K(gc);if(!Ta.contains(vc)){let Pc;
(({block:Pc}=this.mCf(pb,vc)).returnValue||({block:Pc}=this.mCf(tb,vc)).returnValue||({block:Pc}=this.mCf(sb,vc)).returnValue)&&Pc&&wb.add(Pc)}}return wb}mCf(Ta,cb){for(let sb=0;sb<Ta.length;sb++)if(2===Ta.K(sb).type&&Ta.K(sb).xk===cb)return Ta=Ta.K(sb),{returnValue:!0,block:Ta};return{returnValue:!1,block:null}}Zab(){const Ta=new l.a;Za.a.Iqc(this.xg,"BaseObjects_",this.BH,Ta);Za.a.Iqc(this.xg,"FavoredObjects_",this.NFa,Ta);Za.a.Iqc(this.xg,"ConflictObjects_",this.hHa,Ta)}rkl(){let Ta,cb;Ta=w.a.nil;
cb=-1;let sb=0;for(let pb=0;pb<this.eT.ef.length;pb++){const tb=this.eT.ef.K(pb);if(tb.J7())sb+=tb.length;else if(6!==tb.type)sb=0;else return Ta=tb.xk,cb=sb,{returnValue:!0,objectId:Ta,cp:cb}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Ta,cp:cb}}Msd(Ta,cb){let sb,pb;pb=cb;sb=Ta;try{let tb=this.initialize();if(tb=(tb=tb&&this.zTh(!0,Ta,cb).returnValue)&&({objectId:sb,cp:pb}=this.rkl()).returnValue)return a.a.instance.Ua(17409924,
1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",sb,pb),{returnValue:!0,jdb:sb,Nua:pb}}catch(tb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.Q5d(tb))}this.Pnd(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Iwa,this.dug);this.Zab();return{returnValue:!1,jdb:sb,Nua:pb}}static Msi(Ta,
cb){let sb;sb=new l.a;if(!Ta.input.VRb)return{returnValue:!0,X7f:sb};Ta=Ta.input.Oca.last().jKa(D.a.MN);sb=cb.getPropertyObjectIds(Ta,m.a.AY);return{returnValue:!0,X7f:sb}}static mfo(Ta){if(!Za.a.Nxf(Ta))return!0;const cb=new v.a;Ta.runtime.Sq.W(D.a.MN,Za.a.M9m(Ta,cb));return!0}static Qeo(Ta){if(!Ta.runtime.Sq.tb(D.a.MN)||!Ta.runtime.sv.tb(D.a.MN))return!0;const cb=new v.a,sb=Ta.runtime.Sq.K(D.a.MN);var pb=cb.getPropertyString(sb.zm,m.a.yEa);if(w.a.Bf(pb).equals(w.a.nil))return!0;pb=cb.getPropertyObjectIds(sb.zm,
m.a.AY);const tb=cb.getPropertyObjectIds(Ta.runtime.sv.K(D.a.MN),m.a.AY);let wb;({X7f:wb}=nb.Msi(Ta,cb));for(let gc=0;gc<tb.length;gc++)pb.contains(tb.K(gc),(vc,Pc)=>vc.equals(Pc))||wb.contains(tb.K(gc),(vc,Pc)=>vc.equals(Pc))||(pb.add(tb.K(gc)),Ta.runtime.Sq.W(tb.K(gc),new Na.a(Ta.runtime.sv.K(tb.K(gc)).GO())));cb.setPropertyObjectIds(sb.zm,m.a.AY,pb);return!0}}Object(I.a)(nb,"ParagraphMergeUsingHints",null,[1063])},1646:function(I,J,d){I=d(0);class m{constructor(x){this.Bgj=x;this.succeeded=!1;
this.fAc=x?x.fAc:0;this.$tn=!1;this.length=this.Rip=0}}Object(I.a)(m,"TrieResult",null,[]);class f{constructor(x,u,v){this.Rub=new m(null);this.PIn=x;this.ycd=u;this.Vaj=u+v-1}get result(){return this.Rub}bCi(){let x;return this.ycd<=this.Vaj?(x=this.PIn.charAt(this.ycd),++this.ycd,{returnValue:!0,ch:x}):{returnValue:!1,ch:"\x00"}}jqg(x,u,v){x&&(this.Rub.$tn=!0,this.Rub.Rip=u);this.Rub.length=this.ycd;this.Rub.succeeded=!0;this.Rub.fAc=v;this.ycd!==this.Vaj+1&&(this.Rub=new m(this.Rub))}}Object(I.a)(f,
"LookUpStringVisitor",null,[1853]);var a=d(1765);class l{constructor(){this.X_h=this.rYh=this.tYh=this.qYh=this.sYh=this.Mlf=this.Klf=this.Olf=this.Jlf=0}}Object(I.a)(l,"TRIESTATS",null,[]);class w{constructor(){this.fOa=this.med=0}}Object(I.a)(w,"TrieSymbol",null,[]);d.d(J,"a",function(){return z});class z{constructor(x,u){this.R7=null;this.sie=this.jbj=this.hbj=this.lbj=this.dbj=this.kbj=this.ibj=this.mbj=this.ebj=0;this.ML=x;if(x.cA(u,4)!==z.yLb)throw Error.argument("Input does not represent a trie");
u+=4;this.Xaj=1===x.cA(u,4);u+=4;this.MIn=1===x.cA(u,4);u+=4;this.IIn=x.cA(u,4);u+=4;if(x.cA(u,4)){x=u+4;this.R7=this.vpo(x);this.ebj=u=x+z.Xil;this.mbj=u+=z.NTd*(this.R7.Jlf+(this.R7.Jlf%2?1:0));this.ibj=u+=z.NTd*(this.R7.Olf+(this.R7.Olf%2?1:0));this.kbj=u+=z.NTd*(this.R7.Klf+(this.R7.Klf%2?1:0));this.dbj=u+=z.NTd*(this.R7.Mlf+(this.R7.Mlf%2?1:0));this.lbj=u+=z.Qlf*this.R7.qYh;this.hbj=u+=z.Rlf*this.R7.tYh;this.jbj=u+=z.Rlf*this.R7.rYh;u+=z.Rlf*this.R7.sYh;if(u!==x+this.R7.X_h)throw Error.argument("Corrupted trie binary");
this.sie=u}else this.R7=null}raj(x,u,v,D){x=new f(x,u,v);this.Kak(x,D);return x.result}ZGi(x){if(this.Xaj)if(x)--x;else return"";if(!this.R7)throw Error.argument("Invalid trieID");const u=new a.a;u.AH=0;this.R1b(u);const v=[];for(;;){if(u.AH&z.$fb)if(x)--x;else return Array.add(v,u.Z2b),String.fromCharCode.apply(null,v);const D=!!(u.AH&z.bIe),y=this.sjc(u,!0);if(D||x<y){if(Array.add(v,u.Z2b),!this.R1b(u))throw Error.argument("Invalid trieID");}else if(x-=y,!this.Yrd(u))throw Error.argument("Invalid trieID");
}}Kak(x,u){let v=0;this.Xaj&&(x.jqg(this.MIn,this.IIn,0),++v);if(this.R7){var D=new a.a;D.AH=0;if(this.R1b(D))for(;;){var y=void 0;if(!({ch:y}=x.bCi()).returnValue)break;u&&(y=u(y));y=y.toString().charCodeAt(0);let H=!1;for(;!H;){const F=!!(D.AH&z.$fb);if(D.Z2b===y){if(H=!0,F&&x.jqg(!!(D.AH&z.PQg),D.FBe,v),!this.R1b(D))return}else if(v+=this.sjc(D,!0),!this.Yrd(D))return;F&&++v}}}}R1b(x){if(!x.AH)return this.wIg(x),!0;if(!(x.AH&z.aIe))return!1;x.lWa=0;x.Zy=x.csb;this.wIg(x);return!0}Yrd(x){if(x.AH&
z.bIe)return!1;this.wIg(x);return!0}sjc(x,u){return x.AH&z.OQg?x.MTd:x.AH&z.aIe?!u&&x.AH&z.bIe?this.iom(x):1:0}iom(x){x=z.xof(x);if(!this.R1b(x))return 0;let u=0;do x.AH&z.$fb&&++u,u+=this.sjc(x,!1);while(this.Yrd(x));return u}wIg(x){x.AH||(x.lWa=0,x.Zy=this.sie);var u=this.nZd(this.ebj,x.Zy),v=u.fOa;x.Zy+=u.med;u=this.ML.cA(this.dbj+z.Qlf*v,z.Qlf);x.Z2b=u&65535;x.AH=u>>16;x.AH&z.OQg&&(x.MTd=this.QNl(x));x.AH&z.PQg&&(u=this.nZd(this.mbj,x.Zy),v=u.fOa,x.Zy+=u.med,x.FBe=this.ML.cA(this.lbj+4*v,4));
x.AH&z.Kjk?(x.csb=this.sie+((this.ML.K(x.Zy)<<8|this.ML.K(x.Zy+1))<<8|this.ML.K(x.Zy+2)),x.Zy+=3):x.AH&z.Ljk?(x.csb=x.Zy,x.lWa=x.csb):x.AH&z.Mjk?(u=this.nZd(this.ibj,x.Zy),v=u.fOa,x.Zy+=u.med,x.csb=this.sie+this.ML.cA(this.hbj+4*v,4)):x.AH&z.aIe&&(u=this.nZd(this.kbj,x.Zy),v=u.fOa,x.Zy+=u.med,x.lWa||(x.lWa=x.Zy),x.lWa+=this.ML.cA(this.jbj+4*v,4),x.csb=x.lWa)}nZd(x,u){const v=new w;let D=0;for(;;){D+=this.ML.K(u);++u;++v.med;const y=this.ML.cA(x,2);if(D<y)break;v.fOa+=y;D-=y;x+=2;D<<=8}v.fOa+=D;return v}QNl(x){let u=
this.ML.K(x.Zy);192<=u?(u=(u&63)<<15|(this.ML.K(x.Zy+1)&127)<<8,u|=this.ML.K(x.Zy+2),x.Zy+=3):128<=u?(u=(u&127)<<8|this.ML.K(x.Zy+1),x.Zy+=2):x.Zy+=1;return u}vpo(x){const u=new l;u.Jlf=this.ML.cA(x+12,2);u.Olf=this.ML.cA(x+14,2);u.Klf=this.ML.cA(x+16,2);u.Mlf=this.ML.cA(x+18,2);u.sYh=this.ML.cA(x+24,4);u.qYh=this.ML.cA(x+28,4);u.tYh=this.ML.cA(x+32,4);u.rYh=this.ML.cA(x+36,4);u.X_h=this.ML.cA(x+40,4);return u}static xof(x){const u=new a.a;u.Z2b=x.Z2b;u.AH=x.AH;u.MTd=x.MTd;u.Zy=x.Zy;u.csb=x.csb;u.lWa=
x.lWa;u.FBe=x.FBe;return u}}z.yLb=1654263084;z.Xil=48;z.NTd=2;z.Rlf=4;z.Qlf=4;z.$fb=1;z.bIe=2;z.OQg=4;z.PQg=8;z.aIe=16;z.Ljk=64;z.Mjk=128;z.Kjk=256;Object(I.a)(z,"Trie",null,[1852])},1648:function(I,J,d){d.r(J);I=d(0);d(1411);var m=d(1442);class f{}f.mcj=0;f.Lml=1;f.yqe=10;Object(I.a)(f,"AppsForOfficeStoreType",null,[]);var a=d(1407),l=d(2),w=d(91),z=d(12);class x{constructor(){this.T8e=0}gng(K,R){this.T8e=window.performance.now();this.J0a(()=>{const E=window.performance.now(),N={},O=l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);R.r3k&&(N.callback=U=>{K(U,f.mcj,E)},O&&(N.storeType=f.mcj),l.AFrameworkApplication.va.Qb(z.a.lYb,2,N));R.s3k&&(N.callback=U=>{K(U,f.yqe,E)},O?N.storeType=f.yqe:l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?N.storeType=10:N.storeType=f.yqe,l.AFrameworkApplication.va.Qb(z.a.lYb,2,N))},0,()=>{if(a.TellMeActor.instance.Ye)a.TellMeActor.instance.Ye.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.T8e)+" ms")})}J0a(K,R=0,E=null){2!==l.AFrameworkApplication.va.Ob(z.a.lYb,1)?(a.TellMeActor.instance.Ye&&a.TellMeActor.instance.Ye.gC(m.a.q3k,window.performance.now()-this.T8e),K()):R<x.ZLn?l.AFrameworkApplication.pc.$b(new w.a(2,1,x.EGp,()=>{this.J0a(K,R+1,E)})):E&&E()}static get instance(){x._instance||(x._instance=new x);return x._instance}}x._instance=null;x.ZLn=20;x.EGp=500;Object(I.a)(x,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=this.id=
this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.H1f=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(I.a)(u,"AddinInfo",null,[]);var v=d(1413),D=d(1417),y=d(1416),H=d(1406),F=d(151);d.d(J,"AddinResultsProvider",function(){return G});class G{constructor(K){this.f5e=[];this.kc=K;this.QZn=(R,E,N)=>{if(R){const O=R.errorCode;if(a.TellMeActor.instance.Ye){const U={};U.StoreType=E;U.ErrorCode=O;U.AddinCount=
R.value?R.value.length:0;a.TellMeActor.instance.Ye.gC(m.a.Lgm,window.performance.now()-N,U)}if(0===O&&R.value){G.AKb=G.AKb||{};R=R.value;for(const U of R)R=new u,R.displayName=U[0],R.id=U[1],R.description=U[2],R.targetType=U[3],R.appVersion=4<U.length?U[4]:"",R.assetId=5<U.length?U[5]:"",R.assetStoreId=6<U.length?U[6]:"",R.width=7<U.length?U[7]:0,R.height=8<U.length?U[8]:0,R.iconUrl=9<U.length?U[9]:"",R.providerName=10<U.length?U[10]:"",R.storeId=11<U.length?U[11]:"",R.storeType=12<U.length?U[12]:
"",R.H1f=this.Bxm(R),G.AKb[R.id]=R,0<R.iconUrl.length&&(E="AddinIcon_"+R.id,l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.LAj(E,R.iconUrl):appChrome.addInApi.registerAddinIcon(E,R.iconUrl))}}};x.instance.gng(this.QZn,this.kc)}lN(){return"Add-ins"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(K,R,E,N,O=null){E=new y.a(K);O&&!Array.contains(O,27)||H.a.yU(K)||(O=new D.a(27),O.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.dxm(K.Vg,O),E.gw(O));R.Kt(E)}dxm(K,R){if((K=this.NNo(K))&&0<K.length){let E=0;K.forEach(N=>{if(!(3<++E)){var O="AddinSuggestion"+E,U={};if(l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var X="AddinIcon_"+N.id;0>Array.indexOf(this.f5e,X)&&0<N.iconUrl.length&&this.LAj(X,N.iconUrl);U["default"]=0<=Array.indexOf(this.f5e,X)?X:"AppForOfficeLogo_20"}else U["default"]=0<N.iconUrl.length?"AddinIcon_"+N.id:"AppForOfficeLogo_20";X=[];
X.push(appChrome.actions.setControlLabel(O,N.displayName));X.push(appChrome.actions.setControlIconSet(O,U));X.push(appChrome.actions.setCompoundButtonCommandValueId(O,N.id));X.push(appChrome.actions.updateCompoundButtonDescription(O,N.description));l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(U=window.performance.now(),X.push(appChrome.actions.updateControlEnabledDisabledState(O,!1)),a.TellMeActor.instance.Ye&&a.TellMeActor.instance.Ye.gC(m.a.R_l,
window.performance.now()-U));appChrome.api.dispatch(X);O=new v.a(O,27,void 0,void 0,1);O.TK=Telemetry.PrivacyRules.GetPrivacyCompliantId(N.id,N.storeType,N.assetId,null,null,N.storeId);R.jy(O)}})}}LAj(K,R){F.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(K,R),Array.add(this.f5e,K))}NNo(K){if(!G.AKb)return null;const R=[],E=G.AKb;for(const O in E){var N=E[O];N&&G.aLn(K,N)&&Array.add(R,N)}return R}Bxm(K){return G.Ncp(K.displayName)}static aLn(K,R){if(!R.H1f)return!1;
for(const E of K.split(" ")){K=!1;for(const N of R.H1f)if(N.toLowerCase().startsWith(E.toLowerCase())){K=!0;break}if(!K)return!1}return!0}static Ncp(K){const R=[];for(const E of K.split(" ")){K=0;for(let N=0;N<E.length;N++){const O=E.charAt(N);O.toString().toUpperCase()===O.toString()&&N>K&&(Array.add(R,E.substring(K,N)),K=N)}Array.add(R,E.substring(K,E.length));K&&Array.add(R,E.substring(0,E.length))}return R}}G.AKb=null;Object(I.a)(G,"AddinResultsProvider",null,[85])},1744:function(I,J,d){d.d(J,
"a",function(){return f});I=d(0);var m=d(224);class f{constructor(){this.TXb=this.ENb=this.xWa=this.Lwb=this.Mwb=this.q7a=this.Esb=this.Kwb=this.yob=this.Csb=this.Acb=this.zob=this.Dsb=null;this.reset()}reset(){this.Dsb=new m.a;this.zob=new m.a;this.Acb=new m.a;this.Csb=new m.a;this.yob=new m.a;this.Kwb=new m.a;this.Esb=new m.a;this.q7a=new m.a;this.q7a=new m.a;this.Mwb=new m.a;this.Lwb=new m.a;this.xWa=[];this.ENb=[];this.TXb=[]}aFp(a){return this.ZVa(this.Dsb,a)&&this.ZVa(this.zob,a)&&this.ZVa(this.Acb,
a)&&this.ZVa(this.Csb,a)&&this.ZVa(this.yob,a)&&this.ZVa(this.Kwb,a)&&this.ZVa(this.Esb,a)&&this.ZVa(this.q7a,a)&&this.ZVa(this.Mwb,a)&&this.ZVa(this.Lwb,a)}ZVa(a,l){return!a||!a.length||a.length===l}}Object(I.a)(f,"MergeableTrackedChangesProperties",null,[])},1745:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(224),f=d(616);class a{constructor(){this.yPa=new m.a;this.zQa=new m.a;this.SSa=new m.a}get TKb(){return this.yPa}get IBf(){return this.zQa}get yAb(){return this.SSa}get isEmpty(){return!this.yPa.length&&
!this.zQa.length&&!this.SSa.length}get Yub(){return Math.max(Math.max(this.yPa.length,this.zQa.length),this.SSa.length)}get yOn(){return Math.min(Math.min(this.yPa.length,this.zQa.length),this.SSa.length)}ZRd(l){this.yPa.add(l)}aSd(l){this.zQa.add(l)}eSd(l){this.SSa.add(l)}j$l(){const l=new f.a,w=new m.a;let z=0;for(;z<this.yPa.length||z<this.zQa.length||z<this.SSa.length;)z<this.yPa.length&&!l.contains(this.yPa.K(z))&&(w.add(this.yPa.K(z)),l.add(this.yPa.K(z))),z<this.zQa.length&&!l.contains(this.zQa.K(z))&&
(w.add(this.zQa.K(z)),l.add(this.zQa.K(z))),z<this.SSa.length&&!l.contains(this.SSa.K(z))&&(w.add(this.SSa.K(z)),l.add(this.SSa.K(z))),z++;return w}}Object(I.a)(a,"ObjectCollection",null,[])},1746:function(I,J,d){d.d(J,"a",function(){return F});I=d(0);var m=d(59),f=d(13),a=d(364),l=d(224);d(48);d(817);var w=d(616),z=d(177),x=d(183),u=d(1051),v=d(1297),D=d(1796),y=d(1551),H=d(1793);class F{constructor(G){this.DC=new u.a;this.kZ=new a.a;this.THh=new a.a(0);this.lwd=new l.a;this.elh=new l.a;this.rvh=
new l.a;this.Osh=new l.a;this.Guh="";this.l2a=null;this.qt=this.bZe=0;this.LId=new a.a(0);this.tRe=this.Lyh=this.CFd=0;const {MarkerValidation:K}=d(1941);this._state=G;this.uEk=new K}get Lcd(){return this.uEk}get Ewj(){return this.l2a}a_o(G){this.bZe=G}Uhe(G,K){this.Guh=String.format("{0}-{1}",G,K)}txe(G){this.Mrl();this.tRe=G}Byg(){this.tRe=0}Mrl(){this.l2a&&this.lwd.add(this.l2a);this.l2a=null}Oi(G){this.l2a||(this.l2a=G);switch(this.tRe){case 1:this.elh.add(G);break;case 2:this.rvh.add(G);break;
case 3:this.Osh.add(G);break;default:this.l2a&&this.lwd.add(G)}}F9i(G){this.lwd.add(G)}TFn(){this.qt=this.ZJa();this.bbb("MergeEnd")}bbb(G){const K=this.ZJa();this.THh.W(G,K-this.bZe);this.bZe=K}YXo(){this.CFd=this.ZJa();this.Lyh++}KX(G){const K=this.ZJa();let R;({value:R}=this.LId.Ec(G)).returnValue?(R+=K-this.CFd,this.LId.W(G,R)):this.LId.W(G,K-this.CFd);this.CFd=K}dAm(){this.kZ.W("Id",this._state.input.IVb.toString());this.kZ.W("Source",v.a[this._state.input.source]);this.kZ.W("RevSummary",F.O0a(this.RIm()));
this.kZ.W("NodesRolledBackIfFailed",F.O0a(this.lCm()));if(!this._state.output.succeeded){let G,K,R,E,N;({wcl:G,l6l:K,itp:R,Bcl:E,ktp:N}=this.q8l(this._state.runtime));this.kZ.W("CharactersLost",this.rlm(G,K,R));this.kZ.W("CharactersLostInComments",this.Amm());this.kZ.W("CharactersLostInTables",this.Fhm(N,E))}this.kZ.W("FuncStep",this.Guh);this.kZ.W("FailureDetail",F.O0a(this.TPb()));this.kZ.W("FailDetailHints",this.S5d(this.elh));this.kZ.W("FailDetailNaiveMerge",this.S5d(this.rvh));this.kZ.W("FailDetailLcs",
this.S5d(this.Osh));this.kZ.W("ExtraDetails",this.S5d(this.lwd));this.kZ.W("Timeline",F.O0a(this.THh));this.kZ.W("ParagraphMergesCount",this.Lyh);this.kZ.W("ParagraphMergeDurations",F.O0a(this.LId));this.kZ.W("MarkerInfo",F.O0a(this.Lcd.Iwi()));this.kZ.W("Result",F.O0a(this.fAm()));return JSON.stringify(F.O0a(this.kZ))}ZJa(){return(new Date).getTime()}RIm(){const G=new a.a;let K,R,E;({WGg:K,$Ng:R,qIa:E}=this.ZJf(this._state,this._state.input.Oca,this._state.input.Q0a,this._state.input.VRb));G.W("hasBase",
E?"true":"false");if(E){let N=0,O=0;for(;K&&!K.id.equals(E.id);)N++,K=K.DJ;for(;R&&!R.id.equals(E.id);)O++,R=R.DJ;G.W("lenToBaseTheirs",K?N:-1);G.W("lenToBaseYours",R?O:-1)}return G}ZJf(G,K,R,E){G=K.ug(K.length-1-(E?1:0));K=(R=R.ug(R.length-1))&&G?G.kVa(R):null;return{WGg:G,$Ng:R,qIa:K}}lCm(){if(!this._state.runtime.ARi)return null;const G=this._state.runtime.sv,K=new a.a(0);G.forEach((R,E)=>{({value:R}=K.Ec(E.sc.toString()));K.W(E.sc.toString(),R+1);return!0});return K}rlm(G,K,R){let E=null,N=null,
O=null;const U=this._state.runtime.sv;let X=0;try{O=new H.a(this.DC,this._state);E=y.b(G,K,R);N=new w.a;for(G=0;G<E.length;G++)if(!E.K(G).TKb.hw(E.K(G).yAb,(V,Q)=>V.equals(Q))){const V=this.Kfi(E.K(G),O);X+=V;N.add(E.K(G))}E&&U.forEach((V,Q)=>{if(Q.sc===m.a.paragraphNode){Q=null;for(let T=0;T<E.length;T++)if(!N.contains(E.K(T))&&E.K(T).yAb.contains(V,(ba,W)=>ba===W)){Q=E.K(T);break}Q&&(V=this.Kfi(Q,O),N.add(Q),X+=V)}return!0});return X}catch(V){return z.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+
V.toString()),-1}}q8l(G){let K,R,E,N,O;G.$I=X=>{if(750<this.ZJa()-this._state.input.J_a)throw z.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",X),x.a.invalidOperation(X);};K=new l.a;R=new l.a;E=new l.a;N=new l.a;const U=new l.a;O=new l.a;try{if(G.Gn){const X=G.Gn.K(D.ChildNodeListMerge.Doe);let V,Q;V=G.JA.K(D.ChildNodeListMerge.Doe)||X;Q=G.sv.K(D.ChildNodeListMerge.Doe)||X;this.kCf(X,T=>G.Gn.K(T),K,N);this.kCf(V,T=>G.JA.K(T)||G.Gn.K(T),R,U);this.kCf(Q,T=>G.sv.K(T)||
G.Gn.K(T),E,O)}}catch(X){z.a.instance.Ua(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+X.toString())}return{wcl:K,l6l:R,itp:E,Bcl:N,ktp:O}}Fhm(G,K){try{let E=0;const N=this._state.runtime;var R=X=>N.sv.K(X)||N.Gn.K(X);const O=new w.a,U=this.d$l(G,N,R,O);for(G=0;G<U.count;G++){let X=U.keys.K(G);const V=U.K(X);if(!O.contains(X)){let Q=this.yHi(N,R,O,X,V);if(-1!==Q)E+=Q;else return z.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(R=
0;R<K.length;R++){let X=K.K(0);if(!O.contains(X)){let V=this.a9d(N.Gn.K(X));if(-1===V)return z.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;E+=V}}return E}catch(E){return z.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+E.toString()),-1}}yHi(G,K,R,E,N){G.$I("GetTableCharactersLost");let O=0;N=this.DC.getPropertyObjectIds(N,f.a.rg);for(let T=0;T<N.length;T++){var U=K(N.K(T));U=this.DC.getPropertyObjectIds(U,f.a.rg);for(let ba=
0;ba<U.length;ba++){var X=K(U.K(ba));if(G.Gn.K(N.K(T))&&G.Gn.K(U.K(ba))){var V=G.Gn.K(U.K(ba));if(!V)return z.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;X=this.DC.getPropertyObjectIds(V,f.a.rg);var Q=G.JA.K(U.K(ba))||G.Gn.K(U.K(ba));Q=this.DC.getPropertyObjectIds(Q,f.a.rg);V=this.DC.getPropertyObjectIds(V,f.a.rg);X=y.b(X,Q,V);for(V=0;V<X.length;V++){Q=X.K(V);const W=this.ENm(G,K,R,Q);if(-1===W)return z.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",
Q.toString()),-1;O+=W}}else{V=this.zOm(K,X,R);if(-1===V)return z.a.instance.Ua(573089736,1,2,"Error getting text length of cell {0}",X.id.toString()),-1;O+=V}}}R.add(E);return O}ENm(G,K,R,E){let N=0;var O=new l.a,U=new l.a;const X=new a.a;new a.a;for(var V=0;V<E.TKb.length;V++){var Q=G.Gn.K(E.TKb.K(V));Q=this.DC.getPropertyObjectIds(Q,f.a.VG);if(1!==Q.length)return z.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",Q.length),-1;var T=G.Gn.K(Q.K(0));T.sc===m.a.paragraphNode?O.add(T):
T.sc===m.a.Bp&&X.add(Q.K(0),T)}for(V=0;V<E.yAb.length;V++){Q=K(E.yAb.K(V));Q=this.DC.getPropertyObjectIds(Q,f.a.VG);if(1!==Q.length)return z.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",Q.length),-1;T=K(Q.K(0));if(T.sc===m.a.paragraphNode)U.add(T);else if(T.sc===m.a.Bp){T=this.yHi(G,K,R,Q.K(0),T);if(-1===T)return z.a.instance.Ua(573089741,1,2,"Error diffing table {0}",Q.K(0).toString()),-1;N+=T}}V=new H.a(this.DC,this._state);if(0<O.length&&0<U.length){O=V.Rni(O,ba=>G.Gn.K(ba),
U,ba=>K(ba));if(-1===O)return z.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",E.toString()),-1;N+=O}else if(0<O.length)for(E=0;E<O.length;E++)N+=this.DC.getPropertyString(O.K(E),f.a.zn).length+1;else if(0<U.length)for(E=0;E<U.length;E++)N+=this.DC.getPropertyString(U.K(E),f.a.zn).length+1;for(E=0;E<X.count;E++)if(O=X.keys.K(E),!R.contains(O)){U=this.a9d(X.K(O));if(-1===U)return z.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",O.toString()),-1;N+=U}return N}zOm(G,
K,R){let E=0;K=this.DC.getPropertyObjectIds(K,f.a.rg);for(let U=0;U<K.length;U++){var N=G(K.K(U));N=this.DC.getPropertyObjectIds(N,f.a.VG);if(1!==N.length)return z.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;var O=G(N.K(0));if(O.sc===m.a.paragraphNode)E+=this.DC.getPropertyString(O,f.a.zn).length+1;else if(O.sc===m.a.Bp){O=this.a9d(O);if(-1===O)return z.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",N.K(0).toString()),-1;E+=O;R.add(N.K(0))}}return E}a9d(G){this._state.runtime.$I("GetTextLengthOfTable");
let K=0;const R=X=>this._state.runtime.sv.K(X)||this._state.runtime.Gn.K(X);G=this.DC.getPropertyObjectIds(G,f.a.rg);for(let X=0;X<G.length;X++){var E=R(G.K(X));E=this.DC.getPropertyObjectIds(E,f.a.rg);for(let V=0;V<E.length;V++){var N=R(E.K(V));N=this.DC.getPropertyObjectIds(N,f.a.rg);for(let Q=0;Q<N.length;Q++){var O=R(N.K(Q));O=this.DC.getPropertyObjectIds(O,f.a.VG);if(1!==O.length)return z.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var U=R(O.K(0));if(U.sc===
m.a.paragraphNode)K+=this.DC.getPropertyString(U,f.a.zn).length+1;else if(U.sc===m.a.Bp){U=this.a9d(U);if(-1===U)return z.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",O.K(0)),-1;K+=U}}}}return K}d$l(G,K,R,E){const N=new a.a;for(let O=0;O<G.length;O++){let U=!1;K.sv.K(G.K(O))&&(U=!0);const X=R(G.K(O)),V=this.DC.getPropertyObjectIds(X,f.a.rg);if(!U)for(let Q=0;Q<V.length;Q++)if(K.sv.K(V.K(Q))){U=!0;break}U?N.add(G.K(O),X):E.add(G.K(O))}return N}Kfi(G,K){return this.Jfi(G.TKb,
G.yAb,K)}Jfi(G,K,R){const E=new l.a;for(var N=0;N<G.length;N++)E.add(this._state.runtime.Gn.K(G.K(N)));G=new l.a;for(N=0;N<K.length;N++)G.add(this._state.runtime.sv.K(K.K(N))||this._state.runtime.Gn.K(K.K(N)));return R.Rni(E,O=>this._state.runtime.Gn.K(O),G,O=>this._state.runtime.sv.K(O)||this._state.runtime.Gn.K(O))}kCf(G,K,R,E){if(G.sc===m.a.Oh){G=this.DC.getPropertyObjectIds(G,f.a.rg);for(let N=0;N<G.length;N++){const O=this.DC.getPropertyObjectIds(K(G.K(N)),f.a.rg);for(let U=0;U<O.length;U++){const X=
this.DC.getPropertyObjectIds(K(O.K(U)),f.a.rg);for(let V=0;V<X.length;V++){const Q=this.DC.getPropertyObjectIds(K(X.K(V)),f.a.VG);if(1!==Q.length)return;const T=K(Q.K(0));T.sc===m.a.paragraphNode?R.add(Q.K(0)):T.sc===m.a.Bp?E.add(Q.K(0)):z.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+m.a[T.sc])}}}}}lCf(G,K){G=this.DC.getPropertyObjectIds(G,f.a.rg);const R=new l.a;for(let E=0;E<G.length;E++){const N=this.DC.getPropertyObjectIds(K(G.K(E)),f.a.VG);if(1!==N.length)return null;
R.add(N.K(0))}return R}Amm(){let G=0;const K=this._state.runtime,R=K.sv,E=O=>K.sv.K(O)||K.Gn.K(O);let N=null;K.$I=O=>{if(750<this.ZJa()-this._state.input.J_a)throw z.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",O),x.a.invalidOperation(O);};try{R.forEach((O,U)=>{if(U.sc===m.a.ZK){O=this.lCf(U,E);var X=K.Gn.K(U.id);if(X)X=this.lCf(X,Q=>K.Gn.K(Q)),N||(N=new H.a(this.DC,this._state)),G+=this.Jfi(X,O,N);else for(X=0;X<O.length;X++)G+=this.DC.getPropertyString(K.sv.K(O.K(X)),
f.a.zn).length+1}if(U.sc===m.a.mka&&(O=this.DC.getPropertyObjectIds(U,f.a.rg).vS(),U=K.Gn.K(U.id)))for(U=this.DC.getPropertyObjectIds(U,f.a.rg),X=0;X<U.length;X++)if(!O.contains(U.K(X))){var V=K.Gn.K(U.K(X));V=this.lCf(V,Q=>K.Gn.K(Q));for(let Q=0;Q<V.length;Q++)G+=this.DC.getPropertyString(K.Gn.K(V.K(Q)),f.a.zn).length+1}return!0})}catch(O){return z.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+O.toString()),-1}return G}TPb(){return this.l2a?this.l2a.TPb():null}S5d(G){const K=
new l.a;G.forEach(R=>{K.add(F.O0a(R.TPb()));return!0});return K.toArray()}fAm(){const G=new a.a;G.W("Succeeded",this._state.output.succeeded);G.W("Timeout",this._state.output.timeout);G.W("Crash",this._state.output.pza);G.W("MergedRevisions",this._state.output.NL?this._state.output.NL.length:-1);G.W("Duration",this.qt-this._state.input.J_a);return G}static O0a(G){if(!G)return null;const K={};G.forEach((R,E)=>{K[R.toString()]=E;return!0});return K}}Object(I.a)(F,"MergeLogger",null,[])},1747:function(I,
J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.UOa=a;this.pK=f}}Object(I.a)(m,"UpdateHintCollection",null,[])},1748:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1511);class m extends d.a{constructor(f,a){super();this.Rg=f;this.ed=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Rg,this.ed)}}Object(I.a)(m,"LcsInsertParaUpdateHint",d.a,[])},1749:function(I,J,d){d.d(J,"a",function(){return f});
I=d(0);var m=d(224);d=d(1511);class f extends d.a{constructor(a){super();this.W2=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.W2.length;l++)a+=String.format("({0}), ",this.W2.K(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(I.a)(f,"LcsInsertUpdateHint",d.a,[])},1750:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1511);class m extends d.a{constructor(f,a){super();this.text=a;this.Rg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Rg,this.text)}}Object(I.a)(m,"LcsInsertTextUpdateHint",d.a,[])},1751:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1511);class m extends d.a{constructor(f,a,l){super();this.cp=f;this.Rg=a;this.ed=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Rg,this.ed)}}Object(I.a)(m,"LcsDeleteParaUpdateHint",d.a,[])},1752:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1511);class m extends d.a{constructor(f,
a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(I.a)(m,"LcsDeleteTextUpdateHint",d.a,[])},1753:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1475);class m extends d.a{constructor(){super()}get afa(){return"Conflict"}}Object(I.a)(m,"ConflictMergeFailureDetail",d.a,[])},1754:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1475);class m extends d.a{constructor(){super()}get afa(){return"TableMerge"}}
Object(I.a)(m,"TableMergeFailureDetail",d.a,[])},1756:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(228),f=d(16);class a{constructor(l,w,z,x,u){this.P6e=l;this.O6e=w;this.fQk=z;this.ryk=x;this.Olh=u}get AZb(){return 4}Aka(l,w=null){w=w.sessionId+"|"+w.Usa+"|"+l.BE;if(this.Olh||this.ryk){let z=this.Olh||f.a.tC(CommonUIStrings.l_HelpTooltip)===f.a.tC(l.BE.trim());if(this.fQk&&2<l.BE.length){const x=l.BE;";"===x.charAt(0)&&";"===x.charAt(x.length-1)&&x.substring(1,x.length-1)===a.QRf&&
(z=!0)}l=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.BE);return this.Wri(w,f.a.yf(l),z)}return this.Wri(w,f.a.yf(String.format(CommonUIStrings.l_TextWithQuotation,l.BE)),!1)}Wri(l,w,z){return m.a(a.QRf,z?this.O6e:this.P6e,w,"OfficeAssistant_16x16x32","A0",f.a.yf(l),w,null,null)}}a.QRf="bSearchHelp";Object(I.a)(a,"AssistanceMenuItemFactory",null,[1784])},1757:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=d(2),f=d(228),a=d(98),l=
d(16);class w{get AZb(){return 13}Aka(){return w.ygl()}static ygl(){return f.b(w.Qoi,"798637440",l.a.yf(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.Lr,a.getImageClass("Info_32x32x32"),null,null,l.a.yf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.yf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.Qoi="bTellMeFirstRun";Object(I.a)(w,"FirstRunMenuItemFactory",null,[1784])},1758:function(I,J,d){d.d(J,"a",function(){return m});
I=d(0);class m{}m.QSi="bInsights";Object(I.a)(m,"InsightsMenuItemFactoryStatic",null,[])},1759:function(I,J,d){d.d(J,"a",function(){return l});I=d(0);var m=d(2),f=d(228),a=d(16);class l{constructor(w=null,z=null){this.Svh=w;this.MFk=z||CommonUIStrings.l_LookupNoResultsDescription}get AZb(){return 14}Aka(w){w=String.format(this.MFk,w.BE);return this.khl(w)}khl(w){return f.b(l.Ogj,"798637440",a.a.yf(CommonUIStrings.l_LookupNoResultsTitle),this.Svh?m.AFrameworkApplication.Lr:null,this.Svh,null,null,
a.a.yf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.yf(w),null,null)}}l.Ogj="lookupNoResults";Object(I.a)(l,"NoCommandsFoundMenuItemFactory",null,[1784])},1760:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(I.a)(m,"LabelFormatted",null,[])},1761:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);d(1411);var m=d(1413),f=d(1417),a=d(1416),l=d(1406),w=d(16);class z{constructor(x){this.kc=
x}lN(){return"Assistance"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:this.kc.Sfd?3:2}XJ(x,u,v=!1,D,y=null){D=new a.a(x);if((!y||Array.contains(y,8))&&!l.a.yU(x)){y=new f.a(8);if(v){v=w.a.tC(CommonUIStrings.l_HelpTooltip)===w.a.tC(x.Vg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.Vg);const H=[];this.kc.xab&&(this.kc.Pye||H.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),v=this.sCi(x.Vg));const F=
"||"+x.Vg;H.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",v));H.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",F));appChrome.api.dispatch(H);x=new m.a("GetHelpFromTellMe",4,x.Vg,null,1)}else x=new m.a("bSearchHelp",4,x.Vg,null,1);y.jy(x);y.displayName=CommonUIStrings.l_HelpButtonTitle;D.gw(y)}u.Kt(D)}Frb(x,u=null){const v=new f.a(8),D=w.a.tC(CommonUIStrings.l_HelpTooltip)===w.a.tC(x.Vg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
x.Vg);for(let H=0;H<u.length&&2>H;H++){var y=[];let F="GetHelpWithDescriptionFromTellMe"+(H+1).toString(),G=4;if(this.kc.Tod)y.push(appChrome.actions.setControlLabel(F,D)),y.push(appChrome.actions.setCompoundButtonCommandValueId(F,x.Vg)),y.push(appChrome.actions.updateCompoundButtonDescription(F,this.iOf(u.length)));else if(this.kc.Uod){let K=this.JIi(u[H]);F="GetHelpFromTellMe"+(H+1).toString();this.kc.xab&&(K=this.sCi(K));G=9;y.push(appChrome.actions.setControlLabel(F,K));y.push(appChrome.actions.setButtonCommandValueId(F,
this.oPm(u[H])))}appChrome.api.dispatch(y);y=new m.a(F,G,null,null,0);y.label=this.JIi(u[H]);y.description=this.nPm(u[H]);v.jy(y);if(this.kc.Uod)break}v.displayName=CommonUIStrings.l_HelpButtonTitle;return v}iOf(x){return 1===x?String.format(CommonUIStrings.l_SearchResultText,x):String.format(CommonUIStrings.l_SearchResultsText,x)}sCi(x){return this.kc.d0f?l.a.bJf(x,CommonUIStrings.l_HelpScopedButtonText):x+CommonUIStrings.l_HelpScopedButtonText}JIi(x){return x.name?x.name:""}nPm(x){return x.description?
x.description:""}oPm(x){return x.id?"AssetID="+x.id:""}}Object(I.a)(z,"AssistanceResultsProvider",null,[85])},1762:function(I,J,d){d.d(J,"a",function(){return x});I=d(0);d(1411);var m=d(1413),f=d(1417),a=d(1416),l=d(1407),w=d(1406),z=d(1474);class x{constructor(u){this.kc=u}lN(){return"Image"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:3===this.kc.kw?3:2}XJ(u,v,D,y,H=null){D=new a.a(u);(!H||Array.contains(H,19))&&w.a.yU(u)&&this.kc.oS&&this.Frb(u,D,1);v.Kt(D)}Frb(u,v,D,y=null){var H=[];let F;l.TellMeActor.instance.yR()&&
l.TellMeActor.instance.yR().xab?(F=this.kc.d0f?w.a.bJf(u.Vg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Vg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.kc.Pye||H.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):F=this.kc.oS?w.a.yU(u)?this.kc.tmb?w.a.tqb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.kc.tmb?w.a.tqb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Vg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Vg):this.kc.vxc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Vg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.kc.TAa?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",F)),H=w.a.jUa(u.Vg,9,Object.assign(new z.a,{landingTab:"Image"})),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",H))):(H.push(appChrome.actions.setControlLabel("ImageForSearch",
F)),u=w.a.jUa(u.Vg,9,Object.assign(new z.a,{landingTab:"Image"})),H.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(H));D=new m.a("ImageForSearch",12,null,null,D);y&&(D.score=y.ConfidenceScore);y=new f.a(19,this.kc.vxc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);y.jy(D);v.gw(y)}}Object(I.a)(x,"ImageResultsProvider",null,[85])},1763:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);d(1411);var m=d(1413),f=d(1417),a=d(1416),
l=d(1406),w=d(2);class z{constructor(x){this.kc=x}lN(){return"Template"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:3}XJ(x,u){x=new a.a(x);u.Kt(x)}Frb(x,u,v){var D=[];let y;y=this.kc.oS?this.kc.tmb?l.a.tqb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,x.Vg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,x.Vg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,x.Vg);D.push(appChrome.actions.setControlLabel("TemplateForSearch",y));D.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(w.AFrameworkApplication.J.jb("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,x.Vg)));appChrome.api.dispatch(D);x=new f.a(23);x.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;D=new m.a("TemplateForSearch",24,null,null,0);D.label=v[0].Title?v[0].Title:"";D.description=v[0].Description?v[0].Description:"";x.jy(D);u.gw(x)}}Object(I.a)(z,"TemplateResultsProvider",null,[85])},1764:function(I,J,d){d.d(J,"a",function(){return v});I=d(0);d(1411);var m=d(1477),f=d(1413),
a=d(1417),l=d(1416),w=d(1617),z=d(1407),x=d(1406),u=d(16);class v{constructor(D,y,H,F){this.G5=D;this.tlb=y;this.zIh=F;this.Rvk=H;this.kc=z.TellMeActor.instance.yR()}lN(){return"EmptyQuery"}gX(){return 1===this.kc.kw?1:0}XJ(D,y,H=!1,F,G=null){F=new l.a(D);if((!G||Array.contains(G,5)||Array.contains(G,6)||Array.contains(G,4))&&x.a.yU(D)){this.G5.v2c().length||!this.Rvk||this.zIh||(D=new a.a(6),G=new f.a(null,13,void 0,void 0,1),D.jy(G),F.gw(D));D=new a.a(4);if(0<this.G5.v2c().length){D.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;G=this.G5.v2c();var K=[];for(var R of G)K.push(R.Id);m.CommandResultsUtility.Hsd(K,this.kc);for(var E of G)m.CommandResultsUtility.G8c(E.Id)&&D.jy(new f.a(E.Id,5,null,null,2));F.gw(D)}if(this.zIh&&0<this.tlb.length&&this.G5.v2c().length<v.maxResults){R=new a.a(5);R.displayName=CommonUIStrings.l_TellMeTryQueryTitle;E=v.maxResults-D.results.length;D=[];for(G=0;G<this.tlb.length&&G<E;++G){if(H){K=x.a.aJg+(G+1);const N=this.tlb[G].key,O=u.a.replaceAll(N,'"',"");
D.push(appChrome.actions.setControlLabel(K,N));D.push(appChrome.actions.setButtonCommandValueId(K,O));K=new w.a(N,7,0,O,K)}else K=new w.a(this.tlb[G].key,7,0,this.tlb[G].value);R.jy(K)}0<D.length&&appChrome.api.dispatch(D);F.gw(R)}}y.Kt(F)}}v.maxResults=5;Object(I.a)(v,"EmptyQueryResultsProvider",null,[85])},1765:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.FBe=this.lWa=this.csb=this.Zy=this.MTd=this.AH=this.Z2b=0}}Object(I.a)(m,"TRIESCAN",null,[])},1788:function(I,
J,d){d.r(J);var m=d(0),f=d(1411),a=d(1495),l=d(1442),w=d(1413),z=d(1417),x=d(1416),u=d(1407),v=d(1406),D=d(1474);class y{constructor(ob){this.kc=ob}lN(){return"ActionAI"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc=!1,Lc,Uc=null){Lc=new x.a(ob);if(!Uc||Array.contains(Uc,24))if(this.t5o()||!v.a.yU(ob)){Uc=new z.a(24);var sd=v.a.yU(ob);cc&&(cc=null,v.a.ota()&&(cc=v.a.jUa(sd?"":ob.Vg,1,Object.assign(new D.a,{landingTab:"ActionAI"}))),this.kc.TAa?cc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
cc)):(ob=[],cc&&ob.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",cc)),appChrome.api.dispatch(ob)));Uc.jy(new w.a("ActionAIFromTellMe",25,null,null,1));Lc.gw(Uc)}Nb.Kt(Lc)}t5o(){return v.a.ota()&&this.kc.bWf}}Object(m.a)(y,"ActionAIResultsProvider",null,[85]);var H=d(1648);class F{constructor(ob,Nb){this.TEa=ob;this.El=Nb}Kt(ob){this.TEa.YYo(this.El,ob)}}Object(m.a)(F,"AggregatorResultsProviderCallback",null,[1798]);class G{constructor(ob){this.bwa=null;this.kc=ob;this.kc.MKb&&
(this.bwa=null)}lN(){return"AppsForOffice"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc,Lc,Uc=null){cc=new x.a(ob);if(!Uc||Array.contains(Uc,1))Uc=new z.a(1),this.bwa.aUp(Uc,ob.Vg),cc.gw(Uc);Nb.Kt(cc)}}Object(m.a)(G,"AppsForOfficeRecommendationResultsProvider",null,[85]);var K=d(1761),R=d(1401),E=d(1429),N=d(253);class O{constructor(ob,Nb){this.Bb=ob;this.LIn=Nb}isMatch(ob,Nb){if(!Object(N.a)(1820,ob))throw Error.argument("objToTest","Expected feature bundle");let cc;return({value:cc}=
ob.mr(this.Bb.Hya)).returnValue?this.Bb.qMg.isMatch(cc,Nb):this.LIn}}Object(m.a)(O,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1837]);class U{constructor(ob,Nb){this.Bb=ob;this.x6f=Nb}isMatch(ob){if(!Object(N.a)(1820,ob))throw Error.argument("objToTest","Expected feature bundle");return!!(this.x6f^ob.mr(this.Bb.Hya).returnValue)}}Object(m.a)(U,"AnnotatedWithAnnotationFilter",null,[1837]);class X{constructor(ob){this.Bb=ob}isMatch(ob,Nb){if(!Object(N.a)(1824,ob))throw Error.argument("objToTest",
"Expected struct value");return this.Bb.qMg.isMatch(ob.Mqb(this.Bb.XUa),Nb)}}Object(m.a)(X,"FieldValueMatchesStructFilter",null,[1837]);class V{constructor(ob,Nb){ob&&(this.XUa=ob.K(0),this.qMg=Nb.nsa(ob.K(1)))}}Object(m.a)(V,"FieldValueMatchesStructFilterInit",null,[]);class Q{constructor(ob){this.x6f=ob}isMatch(ob){if(!Object(N.a)(1820,ob))throw Error.argument("objToTest","Expected feature bundle");return!!(this.x6f^ob.ZQf)}}Object(m.a)(Q,"HasAnnotationsAnnotationFilter",null,[1837]);class T{constructor(ob,
Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob,Nb){if(!Object(N.a)(1823,ob))throw Error.argument("objToTest","Expected list value");switch(this.Dba){case 0:for(const cc of ob.items)if(this.Bb.filter.isMatch(cc,Nb))return!0;return!1;case 1:for(const cc of ob.items)if(!this.Bb.filter.isMatch(cc,Nb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(T,"ItemTestListFilter",null,[1837]);class ba{constructor(ob){this.Bb=ob}isMatch(ob,Nb){if(!Object(N.a)(1823,ob))throw Error.argument("objToTest",
"Expected list value");return this.Bb.filter.isMatch(ob.items.length,Nb)}}Object(m.a)(ba,"LengthMatchesListFilter",null,[1837]);class W{constructor(ob,Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob,Nb,cc=null){let Lc=0===this.Dba;for(const Uc of this.Bb.K1h)if((Lc=Uc.isMatch(ob,Nb,cc))?1===this.Dba:0===this.Dba)return Lc;2===this.Dba&&(Lc=!Lc);return Lc}}Object(m.a)(W,"NonterminalFilter",null,[1837]);class aa{constructor(ob,Nb){if(ob){var cc=ob.K(0);this.K1h=Array(cc);for(let Lc=0;Lc<cc;++Lc)this.K1h[Lc]=
Nb.nsa(ob.K(1+Lc))}}}Object(m.a)(aa,"NonterminalFilterInit",null,[]);class Y{constructor(ob,Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob,Nb){if("number"!==typeof ob)throw Error.argument("objToTest","Expected number value");let cc=this.Bb.number;if(this.Bb.query){Nb=this.Bb.query.Fu(null,Nb);if("number"!==typeof Nb)throw Error.invalidOperation("Query did not return number");cc+=Nb}switch(this.Dba){case 0:return ob===cc;case 1:return ob<cc;case 2:return ob<=cc;case 3:return ob>cc;case 4:return ob>=cc;default:throw Error.notImplemented();
}}}Object(m.a)(Y,"NumberFilter",null,[1837]);class da{constructor(ob,Nb){ob&&(this.number=ob.K(0),this.query=ob.K(1)?Nb.bN(ob.K(1)):null)}}Object(m.a)(da,"NumberFilterInit",null,[]);class ka{constructor(ob,Nb,cc){this.T5d=this.gsm;this.RIn=ob;this.abj=Nb;this.$aj=cc}dnf(ob){this.abj=ob}gsm(ob){if(!ob)throw Error.argument("name","Invalid named feature bundle reference");const Nb=ob.substr(1);return 1===ob.charCodeAt(0)&&Nb===this.RIn?this.abj:this.$aj?this.$aj.T5d(ob):null}}Object(m.a)(ka,"SimpleNamedFeatureBundleResolver",
null,[1856]);class qa{constructor(ob){this.Bb=ob}isMatch(ob,Nb){if(!Object(N.a)(1820,ob))throw Error.argument("objToTest","Expected feature bundle");ob=this.Bb.query.Fu(null,new ka(this.Bb.zFe,ob,Nb));if("boolean"!==typeof ob)throw Error.invalidOperation("Query did not return bool");return ob}}Object(m.a)(qa,"PredicateAnnotationFilter",null,[1837]);class ua{constructor(ob,Nb){ob&&(this.zFe=Nb.iD(ob.K(0)),this.query=Nb.bN(ob.K(1)))}}Object(m.a)(ua,"PredicateAnnotationFilterInit",null,[]);class Pa{constructor(ob){this.Bb=
ob}isMatch(ob,Nb){if("boolean"!==typeof ob)throw Error.argument("objToTest","Expected bool value");Nb=this.Bb.query.Fu(null,Nb);if("boolean"!==typeof Nb)throw Error.invalidOperation("Query did not return bool");return ob===Nb}}Object(m.a)(Pa,"QueryBooleanFilter",null,[1837]);class Ja{constructor(ob,Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob,Nb){if("number"!==typeof ob)throw Error.argument("objToTest","Expected integer");Nb=this.Bb.query.Fu(null,Nb);if("number"!==typeof Nb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.Dba){case 0:return ob===Nb;case 1:return 0!==(ob&Nb);case 2:return ob===(ob&Nb);case 3:return Nb===(ob&Nb);default:throw Error.notImplemented();}}}Object(m.a)(Ja,"QueryEnumFilter",null,[1837]);class Ca{constructor(ob,Nb){ob&&(this.uee=1===ob.K(0),this.query=Nb.bN(ob.K(1)))}}Object(m.a)(Ca,"QueryEnumFilterInit",null,[]);class ra{constructor(ob,Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob,Nb){if(!Object(N.a)(1823,ob))throw Error.argument("objToTest","Expected list value");Nb=this.Bb.query.Fu(null,
Nb);if(!Object(N.a)(1823,Nb))throw Error.invalidOperation("Query did not return list value");if(ob.U7!==Nb.U7)return!1;switch(this.Dba){case 0:return R.Annotations.UAb(R.Annotations.izm(ob.U7),ob,Nb);case 1:for(const cc of ob.items)for(const Lc of Nb.items)if(R.Annotations.UAb(ob.U7,cc,Lc))return!0;return!1;case 2:for(const cc of ob.items)for(const Lc of Nb.items)if(!R.Annotations.UAb(ob.U7,cc,Lc))return!1;return!0;case 3:for(const cc of Nb.items)for(const Lc of ob.items)if(!R.Annotations.UAb(ob.U7,
cc,Lc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(ra,"QueryListFilter",null,[1837]);class Ea{constructor(ob,Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob,Nb){if("string"!==typeof ob)throw Error.argument("objToTest","Expected string");Nb=this.Bb.query.Fu(null,Nb);if("string"!==typeof Nb)throw Error.invalidOperation("Query did not return string");this.Bb.CWf&&(ob=ob.toUpperCase(),Nb=Nb.toUpperCase());switch(this.Dba){case 0:return ob===Nb;case 1:return 0<=ob.indexOf(Nb);case 2:return ob.startsWith(Nb);
case 3:return ob.endsWith(Nb);case 4:return 0<=Nb.indexOf(ob);case 5:return Nb.startsWith(ob);case 6:return Nb.endsWith(ob);default:throw Error.notImplemented();}}}Object(m.a)(Ea,"QueryStringFilter",null,[1837]);class xa{constructor(ob,Nb){ob&&(this.query=Nb.bN(ob.K(0)),this.CWf=1===ob.K(1))}}Object(m.a)(xa,"QueryStringFilterInit",null,[]);class Ma{constructor(ob){this.Bb=ob}isMatch(ob,Nb){if(!Object(N.a)(1824,ob))throw Error.argument("objToTest","Expected struct value");Nb=this.Bb.query.Fu(null,
Nb);if(!Object(N.a)(1824,Nb))throw Error.invalidOperation("Query did not return struct value");return ob.isEqual(ob)}}Object(m.a)(Ma,"QueryStructFilter",null,[1837]);class ha{constructor(ob){this.Bb=ob}isMatch(ob,Nb){ob=this.Bb.query.Fu(null,Nb);if("boolean"!==typeof ob)throw Error.invalidOperation("Query did not return bool");return ob}}Object(m.a)(ha,"QueryWhereConstraintFilter",null,[1837]);class la{constructor(ob){this.Bb=ob}isMatch(ob){if("string"!==typeof ob)throw Error.argument("objToTest",
"Expected string");return this.Bb.Qjd.test(ob)}}Object(m.a)(la,"RegexStringFilter",null,[1837]);class Fa{constructor(ob,Nb){ob&&(this.Qjd=Nb.Bkc(ob.K(0)))}}Object(m.a)(Fa,"RegexStringFilterInit",null,[]);class Ga{constructor(ob,Nb){ob&&(this.filter=Nb.nsa(ob.K(0)))}}Object(m.a)(Ga,"SingleFilterFilterInit",null,[]);class va{constructor(ob,Nb){ob&&(this.query=Nb.bN(ob.K(0)))}}Object(m.a)(va,"SingleQueryFilterInit",null,[]);class pa{constructor(ob){this.Bb=ob}isMatch(ob){if("boolean"!==typeof ob)throw Error.argument("objToTest",
"Expected bool value");return ob===this.Bb.value}}Object(m.a)(pa,"StoredValueBooleanFilter",null,[1837]);class Oa{constructor(ob){ob&&(this.value=1===ob.K(0))}}Object(m.a)(Oa,"StoredValueBooleanFilterInit",null,[]);class Ra{constructor(ob,Nb){this.Bb=ob;this.Dba=Nb}isMatch(ob){if("number"!==typeof ob)throw Error.argument("objToTest","Expected integer");switch(this.Dba){case 0:return this.Bb.uee?this.Bb.value?!!(ob&this.Bb.value):!ob:ob===this.Bb.value;case 1:return this.Bb.uee?(ob&this.Bb.value)===
this.Bb.value:32>ob&&(1<<ob&this.Bb.value)===this.Bb.value;case 2:return this.Bb.uee?!!(ob&this.Bb.value):32>ob&&!!(1<<ob&this.Bb.value);default:throw Error.notImplemented();}}}Object(m.a)(Ra,"StoredValueEnumFilter",null,[1837]);class fb{constructor(ob){ob&&(this.uee=1===ob.K(0),this.value=ob.K(1))}}Object(m.a)(fb,"StoredValueEnumFilterInit",null,[]);class qb{constructor(){this.B$n=null;this.Plf=this.RRb=0}}Object(m.a)(qb,"WHEREConstraintData",null,[]);class mb{constructor(ob){this.Bb=ob}isMatch(ob,
Nb){if(!Object(N.a)(qb,ob))throw Error.argument("objToTest","Expected WHERE constraint data");let cc=-1,Lc=-1;const Uc=ob.B$n;switch(this.Bb.Pmf){case 4:cc=Uc.L0c;Lc=Uc.VCg;break;case 5:cc=ob.RRb;Lc=Uc.L0c-ob.RRb;break;case 6:cc=Uc.L0c+Uc.VCg;Lc=ob.RRb+ob.Plf-cc;break;case 1:case 2:case 3:let sd=!1;for(let id=Uc.gWp;id;id=id.next)if(this.Bb.FDp===id.name){sd=!0;1===this.Bb.Pmf?(cc=id.L0c,Lc=id.VCg):2===this.Bb.Pmf?(cc=ob.RRb,Lc=id.L0c-ob.RRb):(cc=id.L0c+id.VCg,Lc=ob.RRb+ob.Plf-cc);break}if(!sd)return!1;
break;case 7:cc=ob.RRb;Lc=ob.Plf;break;default:throw Error.notImplemented();}return null!==this.Bb.Ocp.c3p(Uc.Unq,cc,Lc,cc,!0,2,Nb)}}Object(m.a)(mb,"SubSreWhereConstraintFilter",null,[1837]);class eb{constructor(ob,Nb){if(ob){var cc=Nb.iD(ob.K(0));this.Pmf=cc.charCodeAt(0);this.FDp=cc.substr(1);this.Ocp=Nb.BJm(ob.K(1))}}}Object(m.a)(eb,"SubSreWhereConstraintFilterInit",null,[]);class bb{constructor(ob){this.Bb=ob}isMatch(ob,Nb,cc=null){if(!Object(N.a)(1820,ob))throw Error.argument("objToTest","Expected feature bundle");
if(null==cc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.oRh&&!this.Bb.oRh.isMatch(ob,Nb))return!1;if(this.Bb.JGg){let Lc;if(({value:Lc}=ob.mr(this.Bb.Hbp)).returnValue){if(!this.Bb.JGg.isMatch(Lc,Nb))return!1}else{let Uc,sd;if(!({value:Uc}=ob.mr(this.Bb.wWj)).returnValue||!({value:sd}=ob.mr(this.Bb.vWj)).returnValue||0>Uc||0>sd||Uc+sd>cc.length||!this.Bb.JGg.isMatch(cc.substr(Uc,sd),Nb))return!1}}if(this.Bb.nXj){let Lc;if(!({value:Lc}=ob.mr(this.Bb.wWj)).returnValue||!this.Bb.nXj.isMatch(Lc,
Nb))return!1}if(this.Bb.t6i){let Lc;if(!({value:Lc}=ob.mr(this.Bb.vWj)).returnValue||!this.Bb.t6i.isMatch(Lc,Nb))return!1}return!0}}Object(m.a)(bb,"TextSpanFilter",null,[1837]);class Wa{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.wWj=ob.K(0),this.vWj=ob.K(1),this.Hbp=ob.K(2),this.JGg=ob.K(3)?Nb.nsa(ob.K(3)):null,this.oRh=ob.K(4)?Nb.nsa(ob.K(4)):null,this.nXj=ob.K(5)?Nb.nsa(ob.K(5)):null,this.t6i=ob.K(6)?Nb.nsa(ob.K(6)):null)}}Object(m.a)(Wa,"TextSpanFilterInit",null,[]);class Za{constructor(ob,
Nb){ob&&(this.annotations=Nb.annotations,this.Hya=ob.K(0),this.qMg=ob.K(1)?Nb.nsa(ob.K(1)):null)}}Object(m.a)(Za,"ValueFilterAnnotationFilterInit",null,[]);var Na=d(1452);class Db{nsa(ob,Nb){const cc=ob.K(0),Lc=new Na.a;Lc.$pb(ob,1,ob.count-1);switch(cc){case 1:return new W(new aa(Lc,Nb),0);case 2:return new W(new aa(Lc,Nb),1);case 3:return new W(new aa(Lc,Nb),2);case 101:return new la(new Fa(Lc,Nb));case 103:return new Ea(new xa(Lc,Nb),0);case 104:return new Ea(new xa(Lc,Nb),1);case 105:return new Ea(new xa(Lc,
Nb),2);case 106:return new Ea(new xa(Lc,Nb),3);case 107:return new Ea(new xa(Lc,Nb),4);case 108:return new Ea(new xa(Lc,Nb),5);case 109:return new Ea(new xa(Lc,Nb),6);case 201:return new pa(new Oa(Lc));case 202:return new Pa(new va(Lc,Nb));case 301:return new Y(new da(Lc,Nb),0);case 302:return new Y(new da(Lc,Nb),1);case 303:return new Y(new da(Lc,Nb),2);case 304:return new Y(new da(Lc,Nb),3);case 305:return new Y(new da(Lc,Nb),4);case 401:return new Ra(new fb(Lc),0);case 402:return new Ra(new fb(Lc),
1);case 403:return new Ra(new fb(Lc),2);case 404:return new Ja(new Ca(Lc,Nb),0);case 405:return new Ja(new Ca(Lc,Nb),1);case 406:return new Ja(new Ca(Lc,Nb),2);case 407:return new Ja(new Ca(Lc,Nb),3);case 501:return new X(new V(Lc,Nb));case 502:return new Ma(new va(Lc,Nb));case 601:return new T(new Ga(Lc,Nb),0);case 602:return new T(new Ga(Lc,Nb),1);case 603:return new ba(new Ga(Lc,Nb));case 604:return new ra(new va(Lc,Nb),0);case 605:return new ra(new va(Lc,Nb),1);case 606:return new ra(new va(Lc,
Nb),2);case 607:return new ra(new va(Lc,Nb),3);case 701:return new Q(!1);case 702:return new Q(!0);case 703:return new U(new Za(Lc,Nb),!1);case 704:return new U(new Za(Lc,Nb),!0);case 705:return new O(new Za(Lc,Nb),!1);case 706:return new O(new Za(Lc,Nb),!0);case 707:return new qa(new ua(Lc,Nb));case 901:return new bb(new Wa(Lc,Nb));case 1002:return new ha(new va(Lc,Nb));case 1001:return new mb(new eb(Lc,Nb));default:throw Error.argument("initData");}}}Object(m.a)(Db,"FilterFactory",null,[1819]);
var nb=d(1409);class Ta{constructor(ob){this.Bb=ob}get MF(){return this.Bb.MF}get s8(){return this.Bb.s8}get $Ae(){return this.Bb.$Ae}get $ce(){return this.Bb.$ce}load(ob,Nb){return this.Fu(ob,ob?new ka("root",ob,Nb):Nb)}store(ob,Nb,cc){this.wyc(ob,Nb,ob?new ka("root",ob,cc):cc,null)}Fu(ob,Nb){if(!this.$ce&&!this.Bb.annotations.koc(this.MF,ob))throw Error.argument("input","Input value not of expected type");let cc=this.Bb.Toi;for(;cc;)ob=cc.load(ob,Nb),cc=cc.next;return ob}wyc(ob,Nb,cc,Lc){if(!this.$Ae)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.$ce&&!this.Bb.annotations.koc(this.MF,ob))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.koc(this.s8,Nb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.Toi.store(ob,Nb,cc,Lc)}static S3h(ob,Nb,cc,Lc){if(cc===Lc)return Nb;if(R.Annotations.nK(cc)&&R.Annotations.nK(Lc)){cc=R.Annotations.h9a(cc);Lc=R.Annotations.h9a(Lc);const Uc=new nb.a(ob,Lc);for(const sd of Nb.items)Array.add(Uc.items,Ta.S3h(ob,sd,cc,Lc));return Uc}if(cc===
R.Annotations.LOa){if(Lc===R.Annotations.Jva)return Nb;if(Lc===R.Annotations.Qca)return Nb.toString()}else if(cc===R.Annotations.Jva){if(Lc===R.Annotations.LOa)return Math.floor(Nb);if(Lc===R.Annotations.Qca)return Nb.toString()}else if(cc===R.Annotations.Qca){if(Lc===R.Annotations.LOa)return parseInt(Nb);if(Lc===R.Annotations.Jva)return parseFloat(Nb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(m.a)(Ta,"AnnotationQuery",null,[1847]);class cb{constructor(){this.s8=
this.MF=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}l9a(ob){if(this.next)return{returnValue:this.next,cOa:ob};if(ob){const Nb=ob.g7h;ob=ob.Xuj;return{returnValue:Nb,cOa:ob}}return{returnValue:null,cOa:ob}}}Object(m.a)(cb,"AnnotationQueryStep",null,[1864]);class sb extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){Nb=this.Bb.query.Fu(ob,Nb);if(R.Annotations.nK(this.MF)){var cc=R.Annotations.h9a(this.MF);let Uc=new nb.a(this.Bb.annotations,cc);if(R.Annotations.nK(this.Bb.query.s8)){if(ob.items.length!==
Nb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let sd=0,id=ob.items.length;sd<id;++sd)Array.add(Uc.items,this.VTd(ob.items[sd],Nb.items[sd],cc===R.Annotations.Jva))}else for(var Lc of ob.items)Array.add(Uc.items,this.VTd(Lc,Nb,cc===R.Annotations.Jva));return Uc}if(R.Annotations.nK(this.Bb.query.s8)){Lc=new nb.a(this.Bb.annotations,this.MF);for(cc of Nb.items)Array.add(Lc.items,this.VTd(ob,cc,this.MF===R.Annotations.Jva));return Lc}return this.VTd(ob,
Nb,this.MF===R.Annotations.Jva)}VTd(ob,Nb,cc){ob=this.Ydc(ob,Nb);return cc?ob:Math.floor(ob)}}Object(m.a)(sb,"NumericAnnotationQueryStep",cb,[]);class pb extends sb{constructor(ob){super(ob)}Ydc(ob,Nb){return ob+Nb}}Object(m.a)(pb,"AddAnnotationQueryStep",sb,[]);class tb extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){if(this.MF===R.Annotations.sEa&&this.Bb.query.s8===R.Annotations.sEa){let Uc;if(({result:Uc}=this.e_h(ob)).returnValue)return Uc}if(R.Annotations.nK(this.MF)){var cc=new nb.a(this.Bb.annotations,
R.Annotations.sEa);Nb=this.Bb.query.Fu(ob,Nb);if(R.Annotations.nK(this.Bb.query.s8)){if(ob.items.length!==Nb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Uc=0,sd=ob.items.length;Uc<sd;++Uc)Array.add(cc.items,this.jWc(Nb.items[Uc],ob.items[Uc]))}else for(var Lc of ob.items)Array.add(cc.items,this.jWc(Nb,Lc));return cc}Lc=this.Bb.query.Fu(ob,Nb);if(R.Annotations.nK(this.Bb.query.s8)){Nb=new nb.a(this.Bb.annotations,R.Annotations.sEa);for(cc of Lc.items)Array.add(Nb.items,
this.jWc(cc,ob));return Nb}return this.jWc(Lc,ob)}}Object(m.a)(tb,"BinaryBooleanAnnotationQueryStep",cb,[]);class wb extends tb{constructor(ob){super(ob)}e_h(ob){return{returnValue:!ob,result:!1}}jWc(ob,Nb){return ob&&Nb}}Object(m.a)(wb,"AndAnnotationQueryStep",tb,[]);class gc{constructor(ob){ob&&(this.annotations=ob)}}Object(m.a)(gc,"AnnotationsOnlyQueryStepInit",null,[]);class vc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){Nb=this.Bb.query.Fu(ob,Nb);ob=ob.clone();R.Annotations.nK(this.Bb.query.s8)?
Array.addRange(ob.items,Nb.items):Array.add(ob.items,Nb);return ob}}Object(m.a)(vc,"AppendAnnotationQueryStep",cb,[]);class Pc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){if(this.MF===R.Annotations.yY)return this.P_c(ob,Nb);const cc=new nb.a(this.Bb.annotations,R.Annotations.yY);for(const Lc of ob.items)Array.add(cc.items,this.P_c(Lc,Nb));return cc}P_c(ob,Nb){const cc=new E.a(this.Bb.annotations);cc.R6a(ob);ob=new E.a(this.Bb.annotations);this.Bb.script.QUa(null,new ka("Input",cc,new ka("Output",
ob,Nb)));return ob}}Object(m.a)(Pc,"ApplyAnnotationQueryStep",cb,[]);class ld extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){if(this.MF===R.Annotations.yY)return Nb=this.P_c(ob,Nb),Nb.mr(this.Bb.mRh).returnValue||new nb.a(this.Bb.annotations,R.Annotations.yY),Nb;const cc=new nb.a(this.Bb.annotations,R.Annotations.yY);for(const Lc of ob.items)if(ob=this.P_c(Lc,Nb),({value:ob}=ob.mr(this.Bb.mRh)).returnValue)for(const Uc of ob.items)Array.add(cc.items,Uc);return cc}P_c(ob,Nb){const cc=new E.a(this.Bb.annotations);
cc.R6a(ob);ob=new E.a(this.Bb.annotations);this.Bb.script.QUa(null,new ka("Input",cc,new ka("Output",ob,Nb)));return ob}}Object(m.a)(ld,"ApplyExpandAnnotationQueryStep",cb,[]);class Dc{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.script=Nb.tPb(ob.K(0)),this.mRh=ob.K(1))}}Object(m.a)(Dc,"ApplyExpandQueryStepInit",null,[]);class ic{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.script=Nb.tPb(ob.K(0)))}}Object(m.a)(ic,"ApplyQueryStepInit",null,[]);class mc extends cb{constructor(ob){super();
this.Bb=ob}load(ob){if(this.MF===R.Annotations.yY)return this.vhe(ob);const Nb=new nb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Hya));for(const cc of ob.items)Array.add(Nb.items,this.vhe(cc));return Nb}store(ob,Nb,cc,Lc){if(this.MF===R.Annotations.yY){var Uc=Nb,sd=({cOa:Lc}=this.l9a(Lc)).returnValue;sd&&(Uc=sd.store(R.Annotations.HW(this.vhe(ob)),Nb,cc,Lc));ob.eA(this.Bb.Hya,Uc)}else{var id=Nb;if(Uc=({cOa:Lc}=this.l9a(Lc)).returnValue){id=new nb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Hya));
for(sd of ob.items)Array.add(id.items,this.vhe(sd));id=Uc.store(id,Nb,cc,Lc)}Nb=id;if(Nb.items.length!==ob.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ld=0,ne=ob.items.length;Ld<ne;++Ld)cc=ob.items[Ld],cc.isReadOnly&&(cc=cc.clone(),ob.items[Ld]=cc),cc.eA(this.Bb.Hya,Nb.items[Ld])}return ob}vhe(ob){({value:ob}=ob.mr(this.Bb.Hya)).returnValue||(ob=this.Bb.annotations.Dim(this.Bb.Hya));return ob}}Object(m.a)(mc,"AttrAnnotationQueryStep",cb,
[]);class Rc{constructor(ob,Nb){ob&&(this.annotations=Nb,this.Hya=ob.K(0))}}Object(m.a)(Rc,"AttrQueryStepInit",null,[]);class rb extends cb{constructor(ob){super();this.Bb=ob}load(ob){const Nb=new E.a(this.Bb.annotations);Nb.R6a(ob);return this.Bb.module.execute(Nb)}}Object(m.a)(rb,"CallModuleAnnotationQueryStep",cb,[]);class Cb{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.module=Nb.JKf(ob.K(0)))}}Object(m.a)(Cb,"CallModuleQueryStepInit",null,[]);class Kb extends cb{constructor(ob){super();
this.Bb=ob}load(ob,Nb){if(R.Annotations.nK(this.MF)){var cc=this.Bb.query.Fu(ob,Nb);Nb=new nb.a(this.Bb.annotations,R.Annotations.Qca);let sd="string"===typeof cc;for(var Lc of ob.items)if(sd)Array.add(Nb.items,Lc+cc);else for(var Uc of cc.items)Array.add(Nb.items,Lc+Uc);return Nb}Lc=this.Bb.query.Fu(ob,Nb);if("string"===typeof Lc)return ob+Lc;Uc=new nb.a(this.Bb.annotations,R.Annotations.Qca);for(cc of Lc.items)Array.add(Uc.items,ob+cc);return Uc}}Object(m.a)(Kb,"ConcatAnnotationQueryStep",cb,[]);
class $b extends cb{constructor(ob){super();this.Bb=ob}load(ob){return Ta.S3h(this.Bb.annotations,ob,this.MF,this.s8)}}Object(m.a)($b,"ConvertAnnotationQueryStep",cb,[]);class ab extends cb{constructor(){super()}load(ob){return ob.items.length}}Object(m.a)(ab,"CountAnnotationQueryStep",cb,[]);class ia extends sb{constructor(ob){super(ob)}Ydc(ob,Nb){return ob/Nb}}Object(m.a)(ia,"DivideAnnotationQueryStep",sb,[]);class La extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){Nb=new ka(this.Bb.zFe,
null,Nb);for(const cc of ob.items)if(Nb.dnf(cc),this.Bb.query.Fu(cc,Nb))return!0;return!1}}Object(m.a)(La,"ExistsAnnotationQueryStep",cb,[]);class Mb extends sb{constructor(ob){super(ob)}Ydc(ob,Nb){return Math.pow(ob,Nb)}}Object(m.a)(Mb,"ExpAnnotationQueryStep",sb,[]);class Ha{constructor(ob,Nb){ob&&(this.WUa=Nb.iD(ob.K(0)))}}Object(m.a)(Ha,"FeatureBundleNameQueryStepInit",null,[]);class zb extends cb{constructor(ob){super();this.Bb=ob}load(ob){if(R.Annotations.nK(this.MF)){const Nb=new nb.a(this.Bb.annotations,
this.Bb.annotations.UQb(R.Annotations.h9a(this.MF),this.Bb.XUa));for(const cc of ob.items)Array.add(Nb.items,cc.Mqb(this.Bb.XUa));return Nb}return ob.Mqb(this.Bb.XUa)}store(ob,Nb,cc,Lc){if(R.Annotations.nK(this.MF)){var Uc=Nb,sd=({cOa:Lc}=this.l9a(Lc)).returnValue;if(sd){Uc=new nb.a(this.Bb.annotations,this.Bb.annotations.UQb(R.Annotations.h9a(this.MF),this.Bb.XUa));for(var id of ob.items)Array.add(Uc.items,id.Mqb(this.Bb.XUa));Uc=sd.store(Uc,Nb,cc,Lc)}Nb=Uc;if(Nb.items.length!==ob.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let Ld=0,ne=ob.items.length;Ld<ne;++Ld)cc=ob.items[Ld],cc.isReadOnly&&(cc=cc.clone(),ob.items[Ld]=cc),cc.Wxg(this.Bb.XUa,Nb.items[Ld])}else sd=Nb,(id=({cOa:Lc}=this.l9a(Lc)).returnValue)&&(sd=id.store(R.Annotations.HW(ob.Mqb(this.Bb.XUa)),Nb,cc,Lc)),ob.Wxg(this.Bb.XUa,sd);return ob}}Object(m.a)(zb,"FieldAnnotationQueryStep",cb,[]);class ac{constructor(ob,Nb){ob&&(this.annotations=Nb,this.XUa=ob.K(0))}}Object(m.a)(ac,"FieldQueryStepInit",null,[]);class nc extends cb{constructor(ob){super();this.Bb=
ob}load(ob,Nb){for(const cc of ob.items)if(this.Bb.filter.isMatch(cc,Nb))return cc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ob,Nb,cc,Lc){let Uc=Nb,sd=-1;for(let Ld=0,ne=ob.items.length;Ld<ne;Ld++)if(this.Bb.filter.isMatch(ob.items[Ld],cc)){sd=Ld;break}if(0>sd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const id=({cOa:Lc}=this.l9a(Lc)).returnValue;id&&(Uc=id.store(R.Annotations.HW(ob.items[sd]),Nb,cc,Lc));
ob.items[sd]=Uc;return ob}}Object(m.a)(nc,"FirstItemMatchingAnnotationQueryStep",cb,[]);class Gb extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){Nb=new ka(this.Bb.zFe,null,Nb);for(const cc of ob.items)if(Nb.dnf(cc),!this.Bb.query.Fu(cc,Nb))return!1;return!0}}Object(m.a)(Gb,"ForAllAnnotationQueryStep",cb,[]);class tc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){ob=Nb?Nb.T5d(this.Bb.WUa):null;if(!ob)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.WUa+
'"');return ob}store(ob,Nb,cc,Lc){ob=cc?cc.T5d(this.Bb.WUa):null;if(!ob)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.WUa+'"');let Uc=Nb;const sd=({cOa:Lc}=this.l9a(Lc)).returnValue;sd&&(Uc=sd.store(ob,Nb,cc,Lc));ob!==Uc&&ob.R6a(Uc);return ob}}Object(m.a)(tc,"GetAnnotationQueryStep",cb,[]);class Qb{constructor(ob,Nb){this.dsk=ob;this.xJk=Nb}get g7h(){return this.dsk}get Xuj(){return this.xJk}}Object(m.a)(Qb,"AnnotationQueryStoreContinuation",null,[1871]);class Yb extends cb{constructor(ob){super();
this.Bb=ob}load(ob,Nb){return this.Bb.XBe.Fu(ob,Nb)?this.Bb.k3j.Fu(ob,Nb):this.Bb.b2d?this.Bb.b2d.Fu(ob,Nb):ob}store(ob,Nb,cc,Lc){var Uc=this.Bb.XBe.Fu(ob,cc);this.next&&(Lc=new Qb(this.next,Lc));if(Uc)return this.Bb.k3j.wyc(ob,Nb,cc,Lc);if(this.Bb.b2d)return this.Bb.b2d.wyc(ob,Nb,cc,Lc);Uc=Nb;let sd=null;Lc&&(sd=Lc.g7h,Lc=Lc.Xuj);sd&&(Uc=sd.store(R.Annotations.HW(ob),Nb,cc,Lc));return Uc}}Object(m.a)(Yb,"IfAnnotationQueryStep",cb,[]);class fc{constructor(ob,Nb){ob&&(this.XBe=Nb.bN(ob.K(0)),this.k3j=
Nb.bN(ob.K(1)),this.b2d=ob.K(2)?Nb.bN(ob.K(2)):null)}}Object(m.a)(fc,"IfQueryStepInit",null,[]);class ib{constructor(ob,Nb){ob&&(this.g6m=Nb.bN(ob.K(0)),this.m4i=Nb.bN(ob.K(1)))}}Object(m.a)(ib,"IndexAndItemQueryStepInit",null,[]);class Jc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){const cc=this.Bb.g6m.Fu(ob,Nb);Nb=this.Bb.m4i.Fu(ob,Nb);ob=ob.clone();if(0>cc||cc>ob.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(R.Annotations.nK(this.Bb.m4i.s8))for(let Lc=
0;Lc<Nb.items.length;++Lc)Array.insert(ob.items,cc+Lc,Nb.items[Lc]);else Array.insert(ob.items,cc,Nb);return ob}}Object(m.a)(Jc,"InsertAtAnnotationQueryStep",cb,[]);class jd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){return!(!Nb||!Nb.T5d(this.Bb.WUa))}}Object(m.a)(jd,"IsDefinedAnnotationQueryStep",cb,[]);class Wc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){Nb=this.sL(ob,Nb);return ob.items[Nb]}store(ob,Nb,cc,Lc){const Uc=this.sL(ob,cc);let sd=Nb;const id=({cOa:Lc}=this.l9a(Lc)).returnValue;
id&&(sd=id.store(R.Annotations.HW(ob.items[Uc]),Nb,cc,Lc));ob.items[Uc]=sd;return ob}sL(ob,Nb){Nb=this.Bb.query.Fu(ob,Nb);if(0>Nb||Nb>=ob.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Nb}}Object(m.a)(Wc,"ItemAnnotationQueryStep",cb,[]);class Ad extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){const cc=new nb.a(this.Bb.annotations,R.Annotations.h9a(this.MF));for(const Lc of ob.items)this.Bb.filter.isMatch(Lc,Nb)&&Array.add(cc.items,Lc);return cc}}
Object(m.a)(Ad,"ItemsMatchingAnnotationQueryStep",cb,[]);class Yd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){Nb=this.sL(ob,Nb);return ob.items[ob.items.length-Nb-1]}store(ob,Nb,cc,Lc){const Uc=this.sL(ob,cc);let sd=Nb;const id=({cOa:Lc}=this.l9a(Lc)).returnValue;id&&(sd=id.store(R.Annotations.HW(ob.items[ob.items.length-Uc-1]),Nb,cc,Lc));ob.items[ob.items.length-Uc-1]=sd;return ob}sL(ob,Nb){Nb=this.Bb.query?this.Bb.query.Fu(ob,Nb):0;if(0>Nb||Nb>=ob.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Nb}}Object(m.a)(Yd,"LastItemAnnotationQueryStep",cb,[]);class ke extends cb{constructor(ob){super();this.Bb=ob}load(ob){if(R.Annotations.nK(this.MF)){const Nb=new nb.a(this.Bb.annotations,R.Annotations.LOa);for(const cc of ob.items)Array.add(Nb.items,cc.length);return Nb}return ob.length}}Object(m.a)(ke,"LengthAnnotationQueryStep",cb,[]);class bf extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){if(R.Annotations.nK(this.MF)){const cc=new nb.a(this.Bb.annotations,R.Annotations.sEa);
for(const Lc of ob.items)Array.add(cc.items,this.Bb.filter.isMatch(Lc,Nb));return cc}return this.Bb.filter.isMatch(ob,Nb)}}Object(m.a)(bf,"MatchesAnnotationQueryStep",cb,[]);class od extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){return this.Bb.filter.isMatch(ob,Nb)}}Object(m.a)(od,"MatchesAsListAnnotationQueryStep",cb,[]);class Vf extends sb{constructor(ob){super(ob)}Ydc(ob,Nb){return ob%Nb}}Object(m.a)(Vf,"ModuloAnnotationQueryStep",sb,[]);class ah extends sb{constructor(ob){super(ob)}Ydc(ob,
Nb){return ob*Nb}}Object(m.a)(ah,"MultiplyAnnotationQueryStep",sb,[]);class Bf extends cb{constructor(ob){super();this.Bb=ob}load(ob){if(R.Annotations.nK(this.MF)){const Nb=new nb.a(this.Bb.annotations,R.Annotations.sEa);for(const cc of ob.items)Array.add(Nb.items,!cc);return Nb}return!ob}}Object(m.a)(Bf,"NotAnnotationQueryStep",cb,[]);class Of extends tb{constructor(ob){super(ob)}e_h(ob){return{returnValue:ob,result:!0}}jWc(ob,Nb){return ob||Nb}}Object(m.a)(Of,"OrAnnotationQueryStep",tb,[]);class Qf extends cb{constructor(ob){super();
this.Bb=ob}load(ob,Nb){const cc=this.Bb.RDg.Fu(ob,Nb);ob=this.Bb.cXc.Fu(ob,Nb);Nb=new nb.a(this.Bb.annotations,R.Annotations.LOa);for(let Lc=0;Lc<ob;++Lc)Array.add(Nb.items,cc+Lc);return Nb}}Object(m.a)(Qf,"RangeAnnotationQueryStep",cb,[]);class Jg{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.filter=Nb.nsa(ob.K(0)))}}Object(m.a)(Jg,"SingleFilterQueryStepInit",null,[]);class jf{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.query=ob.K(0)?Nb.bN(ob.K(0)):null)}}Object(m.a)(jf,
"SingleOptionalQueryQueryStepInit",null,[]);class $i{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.query=Nb.bN(ob.K(0)))}}Object(m.a)($i,"SingleQueryQueryStepInit",null,[]);class Vd{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.RDg=Nb.bN(ob.K(0)),this.cXc=ob.K(1)?Nb.bN(ob.K(1)):null)}}Object(m.a)(Vd,"StartAndCountOrLengthQueryStepInit",null,[]);class eh extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){let cc;({startIndex:Nb,length:cc}=this.E8d(ob,Nb));const Lc=
new nb.a(this.Bb.annotations,ob.U7);for(let Uc=0;Uc<cc;++Uc)Array.add(Lc.items,ob.items[Nb+Uc]);return Lc}store(ob,Nb,cc,Lc){let Uc,sd;({startIndex:Uc,length:sd}=this.E8d(ob,cc));var id=Nb;const Ld=({cOa:Lc}=this.l9a(Lc)).returnValue;if(Ld){id=new nb.a(this.Bb.annotations,ob.U7);for(let ne=0;ne<sd;++ne)Array.add(id.items,ob.items[Uc+ne]);id=Ld.store(id,Nb,cc,Lc)}Nb=id;for(cc=0;cc<sd;++cc)Array.removeAt(ob.items,Uc);for(let ne=0,kf=Nb.items.length;ne<kf;++ne)Array.insert(ob.items,Uc+ne,Nb.items[ne]);
return ob}E8d(ob,Nb){let cc;cc=this.Bb.RDg.Fu(ob,Nb);if(0>cc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Nb=this.Bb.cXc?this.Bb.cXc.Fu(ob,Nb):ob.items.length-cc;if(0>Nb||cc+Nb>ob.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:cc,length:Nb}}}Object(m.a)(eh,"SublistAnnotationQueryStep",cb,[]);class rd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Nb){if(R.Annotations.nK(this.MF)){const cc=
new nb.a(this.Bb.annotations,R.Annotations.Qca);for(let Lc=0,Uc=ob.items.length;Lc<Uc;++Lc)Array.add(cc.items,this.lHi(ob.items[Lc],Nb));return cc}return this.lHi(ob,Nb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}lHi(ob,Nb){let cc;({startIndex:Nb,length:cc}=this.E8d(ob,Nb));return ob.substr(Nb,cc)}E8d(ob,Nb){let cc;cc=this.Bb.RDg.Fu(ob,Nb);if(0>cc)throw Error.invalidOperation("Invalid start index in Substring() query step");Nb=this.Bb.cXc?this.Bb.cXc.Fu(ob,
Nb):ob.length-cc;if(0>Nb||cc+Nb>ob.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:cc,length:Nb}}}Object(m.a)(rd,"SubstringAnnotationQueryStep",cb,[]);class Gc extends sb{constructor(ob){super(ob)}Ydc(ob,Nb){return ob-Nb}}Object(m.a)(Gc,"SubtractAnnotationQueryStep",sb,[]);class Wd extends cb{constructor(ob){super();this.Bb=ob}load(ob){const Nb=new nb.a(this.Bb.annotations,R.Annotations.Qca);for(let cc=0;cc<ob.length;++cc)Array.add(Nb.items,
ob.charAt(cc).toString());return Nb}}Object(m.a)(Wd,"ToCharListAnnotationQueryStep",cb,[]);class Ye extends cb{constructor(ob){super();this.Bb=ob}load(ob){const Nb=new nb.a(this.Bb.annotations,this.MF);Array.add(Nb.items,ob);return Nb}}Object(m.a)(Ye,"ToListAnnotationQueryStep",cb,[]);class yg extends cb{constructor(ob){super();this.Bb=ob}load(){return this.Bb.value}}Object(m.a)(yg,"ValueAnnotationQueryStep",cb,[]);class yf{constructor(ob,Nb){if(ob){var cc=ob.K(0),Lc=1;this.value=({Fla:Lc}=Nb.uUa(cc,
ob,Lc,null,null,null)).returnValue;R.Annotations.$Ub(this.value)}}}Object(m.a)(yf,"ValueQueryStepInit",null,[]);class re{constructor(ob,Nb){ob&&(this.zFe=Nb.iD(ob.K(0)),this.query=Nb.bN(ob.K(1)))}}Object(m.a)(re,"VarNameAndQueryQueryStepInit",null,[]);class Xe{constructor(ob,Nb){this.aih=null;if(ob){this.annotations=Nb.annotations;var cc=0;this.MF=ob.K(cc);++cc;this.s8=ob.K(cc);++cc;this.$Ae=1===ob.K(cc);++cc;this.$ce=1===ob.K(cc);++cc;var Lc=ob.K(cc);++cc;if(Lc){var Uc=cc,sd=cc+Lc,id=cc+2*Lc;cc+=
3*Lc;var Ld=ob.count-cc,ne=null;for(let vg=0;vg<Lc;++vg){var kf=cc+ob.K(id+vg);const Sh=(vg===Lc-1?Ld:ob.K(id+vg+1))-ob.K(id+vg),Ei=new Na.a;Ei.$pb(ob,kf,Sh);kf=Xe.yBm(ob.K(sd+vg),Ei,Nb);kf.MF=ob.K(Uc+vg);kf.s8=vg===Lc-1?this.s8:ob.K(Uc+vg+1);ne?ne.next=kf:this.aih=kf;ne=kf}}}}get Toi(){return this.aih}static yBm(ob,Nb,cc){switch(ob){case 1:return new tc(new Ha(Nb,cc));case 2:return new jd(new Ha(Nb,cc));case 3:return new mc(new Rc(Nb,cc.annotations));case 4:return new zb(new ac(Nb,cc.annotations));
case 5:return new Yb(new fc(Nb,cc));case 6:return new bf(new Jg(Nb,cc));case 43:return new od(new Jg(Nb,cc));case 45:return new Pc(new ic(Nb,cc));case 49:return new ld(new Dc(Nb,cc));case 46:return new yg(new yf(Nb,cc.annotations));case 51:return new rb(new Cb(Nb,cc));case 52:return new Qf(new Vd(Nb,cc));case 53:return new $b(new gc(cc.annotations));case 13:return new Wc(new $i(Nb,cc));case 14:return new Yd(new jf(Nb,cc));case 15:return new ab;case 18:return new nc(new Jg(Nb,cc));case 16:return new Gb(new re(Nb,
cc));case 17:return new La(new re(Nb,cc));case 22:return new Jc(new ib(Nb,cc));case 24:return new vc(new $i(Nb,cc));case 26:return new eh(new Vd(Nb,cc));case 27:return new Ad(new Jg(Nb,cc));case 30:return new Ye(new gc(cc.annotations));case 31:return new rd(new Vd(Nb,cc));case 32:return new Kb(new $i(Nb,cc));case 47:return new ke(new gc(cc.annotations));case 48:return new Wd(new gc(cc.annotations));case 34:return new pb(new $i(Nb,cc));case 35:return new Gc(new $i(Nb,cc));case 36:return new ah(new $i(Nb,
cc));case 37:return new ia(new $i(Nb,cc));case 38:return new Vf(new $i(Nb,cc));case 39:return new Mb(new $i(Nb,cc));case 40:return new wb(new $i(Nb,cc));case 41:return new Of(new $i(Nb,cc));case 42:return new Bf(new gc(cc.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(Xe,"AnnotationQueryInit",null,[]);class dc{constructor(ob){this.Bb=ob}execute(ob,Nb){this.QUa(ob,ob?new ka("root",ob,Nb):Nb)}QUa(ob,Nb){for(const cc of this.Bb.commands)Nb=cc.execute(ob,Nb)}}Object(m.a)(dc,
"AnnotationScript",null,[1843]);class Ac{constructor(ob){this.Bb=ob}execute(ob,Nb){const cc=this.Bb.H$m.Fu(ob,Nb),Lc=this.Bb.k8n.Fu(ob,Nb);this.Bb.script.QUa(ob,new ka("Input",cc,new ka("Output",Lc,Nb)));return Nb}}Object(m.a)(Ac,"ApplyAnnotationScriptCommand",null,[1858]);class dd{constructor(ob,Nb){ob&&(this.H$m=Nb.bN(ob.K(0)),this.k8n=Nb.bN(ob.K(1)),this.script=Nb.tPb(ob.K(2)))}}Object(m.a)(dd,"ApplyScriptCommandInit",null,[]);class fd{constructor(ob){this.Bb=ob}execute(ob,Nb){const cc=this.Bb.avg.Fu(ob,
Nb);this.Bb.jie.wyc(ob,cc,Nb,null);return Nb}}Object(m.a)(fd,"AssignAnnotationScriptCommand",null,[1858]);class Fd{constructor(ob){this.Bb=ob}execute(ob,Nb){const cc=this.Bb.jie.Fu(ob,Nb);ob=this.Bb.avg.Fu(ob,Nb);cc!==ob&&cc.R6a(ob);return Nb}}Object(m.a)(Fd,"CopyAnnotationScriptCommand",null,[1858]);class cf{constructor(ob){this.Bb=ob}execute(ob,Nb){let cc=this.Bb.s3f.Fu(ob,Nb);if(this.Bb.s3f.$Ae){cc=R.Annotations.HW(cc);var Lc=new ka(this.Bb.WUa,null,Nb);for(let sd=0,id=cc.items.length;sd<id;++sd){var Uc=
this.Ali(ob,cc.items[sd],Lc);if(0>this.Bb.Kue)cc.items[sd]=Uc;else if(({value:Uc}=Uc.mr(this.Bb.Kue)).returnValue)cc.items[sd]=Uc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.s3f.wyc(ob,cc,Nb,null)}else{Lc=new ka(this.Bb.WUa,null,Nb);for(let sd=0,id=cc.items.length;sd<id;++sd)this.Ali(ob,cc.items[sd],Lc)}return Nb}Ali(ob,Nb,cc){let Lc;0>this.Bb.Kue?Lc=R.Annotations.HW(Nb):(Lc=new E.a(this.Bb.annotations),Lc.eA(this.Bb.Kue,Nb));cc.dnf(Lc);
this.Bb.Rdl.QUa(ob,cc);return Lc}}Object(m.a)(cf,"EnumerateAnnotationScriptCommand",null,[1858]);class Bg{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.WUa=Nb.iD(ob.K(0)),this.s3f=Nb.bN(ob.K(1)),this.Rdl=Nb.tPb(ob.K(2)),this.Kue=ob.K(3))}}Object(m.a)(Bg,"EnumerateScriptCommandInit",null,[]);class me{constructor(ob){this.Bb=ob}execute(ob,Nb){this.Bb.XBe.Fu(ob,Nb)?this.Bb.Kpp.QUa(ob,Nb):this.Bb.Emi&&this.Bb.Emi.QUa(ob,Nb);return Nb}}Object(m.a)(me,"IfAnnotationScriptCommand",null,[1858]);
class mf{constructor(ob,Nb){ob&&(this.XBe=Nb.bN(ob.K(0)),this.Kpp=Nb.tPb(ob.K(1)),this.Emi=ob.K(2)?Nb.tPb(ob.K(2)):null)}}Object(m.a)(mf,"IfScriptCommandInit",null,[]);class ug{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.jie=Nb.bN(ob.K(0)),this.avg=Nb.bN(ob.K(1)))}}Object(m.a)(ug,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Bi{constructor(ob){this.Bb=ob}execute(ob,Nb){const cc=this.Bb.avg.Fu(this.Bb.jie.Fu(ob,Nb),Nb);this.Bb.jie.wyc(ob,cc,Nb,null);return Nb}}Object(m.a)(Bi,
"ModifyAnnotationScriptCommand",null,[1858]);class Zf{constructor(ob){this.Bb=ob}execute(ob,Nb){const cc=new E.a(this.Bb.annotations);this.Bb.query&&cc.R6a(this.Bb.query.Fu(ob,Nb));return Nb=new ka(this.Bb.WUa,cc,Nb)}}Object(m.a)(Zf,"NewAnnotationScriptCommand",null,[1858]);class zf{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.WUa=Nb.iD(ob.K(0)),this.query=ob.K(1)?Nb.bN(ob.K(1)):null)}}Object(m.a)(zf,"NewScriptCommandInit",null,[]);class xh{constructor(ob){this.Bb=ob}execute(ob,Nb){ob=
this.Bb.query.Fu(ob,Nb);if(this.Bb.query.s8===R.Annotations.yY)ob.CZa(this.Bb.Hya);else for(const cc of ob.items)cc.CZa(this.Bb.Hya);return Nb}}Object(m.a)(xh,"RemoveAnnotationScriptCommand",null,[1858]);class Vj{constructor(ob,Nb){ob&&(this.annotations=Nb.annotations,this.query=Nb.bN(ob.K(0)),this.Hya=ob.K(1))}}Object(m.a)(Vj,"RemoveScriptCommandInit",null,[]);class Ui{constructor(ob,Nb){if(ob){var cc=0,Lc=ob.K(cc);++cc;if(Lc){var Uc=cc,sd=cc+Lc;cc+=2*Lc;var id=ob.count-cc;this.commands=Array(Lc);
for(let Ld=0;Ld<Lc;++Ld){const ne=cc+ob.K(sd+Ld),kf=(Ld===Lc-1?id:ob.K(sd+Ld+1))-ob.K(sd+Ld),vg=new Na.a;vg.$pb(ob,ne,kf);this.commands[Ld]=Ui.oBm(ob.K(Uc+Ld),vg,Nb)}}}}static oBm(ob,Nb,cc){switch(ob){case 1:return new fd(new ug(Nb,cc));case 2:return new Bi(new ug(Nb,cc));case 3:return new xh(new Vj(Nb,cc));case 6:return new Zf(new zf(Nb,cc));case 7:return new cf(new Bg(Nb,cc));case 8:return new me(new mf(Nb,cc));case 9:return new Fd(new ug(Nb,cc));case 10:return new Ac(new dd(Nb,cc));default:throw Error.argument("initData");
}}}Object(m.a)(Ui,"AnnotationScriptInit",null,[]);var Bb=d(1646);class Pb{constructor(ob){this.T4=ob;this.wz=0}dca(){const ob=this.T4.cA(this.wz,4);this.wz+=4;return ob}get Yja(){return this.T4}get offset(){return this.wz}set offset(ob){this.wz=ob}}Object(m.a)(Pb,"ByteArrayReader",null,[]);class zc{constructor(){this.ML=null;this.fbj=this.kga=0}K(ob){if(0>ob||ob>=this.kga)throw Error.argumentOutOfRange("index");return this.ML.cA(this.fbj+4*ob,4)}get count(){return this.kga}static iGl(ob,Nb,cc){const Lc=
new zc;Lc.ML=ob;Lc.fbj=Nb;Lc.kga=cc;return Lc}}Object(m.a)(zc,"ReadOnlyListOverByteArray",null,[1838]);class $c{constructor(ob,Nb){this.Zaj=this.Yaj=!1;this.Lx=this.RXa=this.m6f=this.bbj=null;try{this.Lx=Nb.annotations;const cc=Nb.xqb(ob.K(0)),Lc=new Pb(cc);if(-914743053!==Lc.dca())throw Error.argument("Input does not represent a flat lexicon");this.Yaj=1===Lc.dca();this.Zaj=1===Lc.dca();const Uc=Lc.dca();Lc.offset+=Uc;const sd=Lc.dca();this.m6f=$c.G$n(Lc,sd,this.Lx);const id=Lc.dca();this.bbj=$c.X$n(Lc,
id);const Ld=Lc.dca();this.RXa=new Bb.a(Lc.Yja,Lc.offset);Lc.offset+=Ld}catch(cc){throw Error.argument("initData");}}get trie(){return this.RXa}Kkm(ob){return"i"===ob&&this.Zaj?"\u0130":ob.toUpperCase()}CWf(){return this.Yaj}Ohm(ob){let Nb;Nb=new nb.a(this.Lx,R.Annotations.yY);if(1!==ob)if(0===ob)ob=new E.a(this.Lx),Array.add(Nb.items,ob);else if(ob&1073741824){ob=this.bbj[ob&-1073741825];for(let Lc=0;Lc<ob.length;++Lc){var cc=ob[Lc];cc=0===cc?new E.a(this.Lx):this.m6f[cc-2];Array.add(Nb.items,cc)}}else Array.add(Nb.items,
this.m6f[ob-2]);return{returnValue:!0,jAn:Nb}}static G$n(ob,Nb,cc){if(Nb%4)throw Error.argument("reader");const Lc=zc.iGl(ob.Yja,ob.offset,Nb/4);ob.offset+=Nb;ob=[];for(Nb=0;Nb<Lc.count;){const Uc=({Fla:Nb}=cc.uUa(R.Annotations.yY,Lc,Nb,null,null,null)).returnValue;Array.add(ob,Uc)}return ob}static X$n(ob,Nb){Nb=ob.offset+Nb;const cc=[];for(;ob.offset<Nb;){const Lc=ob.dca(),Uc=Array(Lc);for(let sd=0;sd<Lc;++sd){const id=ob.dca();Uc[sd]=id}Array.add(cc,Uc)}return cc}}Object(m.a)($c,"RawFlatLexicon",
null,[1842]);var Ae=d(1618),Gf=d(1619);class jg{constructor(ob){if(null==ob)throw Error.argumentNull("base64String");const Nb=ob.length;if(Nb%4)throw Error.argument("base64String's length must be a multiple of 4");this.kga=.75*Nb;this.mVb=Array(Math.ceil(this.kga/4));ob.endsWith("==")?this.kga-=2:ob.endsWith("=")&&--this.kga;let cc=0;for(let Lc=0;Lc<Nb;Lc+=4){const Uc=jg.wve[ob.charCodeAt(Lc)-43]<<18|jg.wve[ob.charCodeAt(Lc+1)-43]<<12|jg.wve[ob.charCodeAt(Lc+2)-43]<<6|jg.wve[ob.charCodeAt(Lc+3)-43];
let sd=Uc>>16&255;this.mVb[Math.floor(cc/4)]|=sd<<cc%4*8;++cc;sd=Uc>>8&255;this.mVb[Math.floor(cc/4)]|=sd<<cc%4*8;++cc;sd=Uc&255;this.mVb[Math.floor(cc/4)]|=sd<<cc%4*8;++cc}}get length(){return this.kga}K(ob){if(0>ob||ob>=this.kga)throw Error.argumentOutOfRange("i");return this.Xti(ob)}cA(ob,Nb){if(0>ob||0>Nb||ob+Nb>this.kga)throw Error.argument("Bad range");let cc=0;for(let Lc=0;Lc<Nb;++Lc)cc|=this.Xti(ob+Lc)<<8*Lc;return cc}ypo(ob,Nb){let cc=0,Lc=0,Uc=Math.floor(ob/8);for(ob%=8;Lc<Nb;){const sd=
8-ob>Nb-Lc?Nb-Lc:8-ob,id=this.K(Uc);cc|=(id>>ob&~(255<<sd))<<Lc;Lc+=sd;++Uc;ob=0}return cc}Xti(ob){return this.mVb[Math.floor(ob/4)]>>ob%4*8&255}}jg.wve=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(jg,"ByteArray",null,[]);class hi{constructor(ob,Nb,cc){this.XF=ob;this.NIn=Nb;this.QIn=cc;this.nbj=Array(ob.b?ob.b.length:
0);this.K6f=new Ae.a(new Gf.a(this.xqb(this.XF.s)));this.Bba=Array(ob.t.length);this.LD=new R.Annotations(this.sqb(0),this)}get annotations(){return this.LD}get rYl(){return this.XF.d}FAm(){if(!(""in this.XF.m))throw Error.argument("name","Unrecognized module");return this.JKf(this.XF.m[""])}xqb(ob){if(0>ob||!this.XF.b||ob>=this.XF.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.nbj[ob]||(this.nbj[ob]=new jg(this.XF.b[ob]))}iD(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not a string");if(null==this.Bba[ob]){const Nb=this.sqb(ob).K(0);this.Bba[ob]=this.K6f.iD(Nb)}return this.Bba[ob]}Bkc(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.Bba[ob]){var Nb=this.sqb(ob);const cc=this.iD(Nb.K(0));Nb=1===Nb.K(1);this.Bba[ob]=new RegExp(cc,Nb?"i":"")}return this.Bba[ob]}BJm(ob){if(1>ob||
ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}JKf(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not an NL module");return this.Bba[ob]||(this.Bba[ob]=this.QIn.bBm(this.sqb(ob),this))}bN(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.XF.t[ob])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.Bba[ob]||(this.Bba[ob]=new Ta(new Xe(this.sqb(ob),this)))}tPb(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not an annotation script");return this.Bba[ob]||(this.Bba[ob]=new dc(new Ui(this.sqb(ob),this)))}nsa(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not a filter");
return this.Bba[ob]||(this.Bba[ob]=this.NIn.nsa(this.sqb(ob),this))}OHm(ob){if(1>ob||ob>=this.XF.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.XF.t[ob])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.Bba[ob]||(this.Bba[ob]=new $c(this.sqb(ob),this))}sqb(ob){const Nb=this.XF.n[ob];ob=(ob<this.XF.t.length-1?this.XF.n[ob+1]:this.XF.n.length)-Nb;if(0>Nb||0>ob||Nb+ob>this.XF.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Nb+","+ob+")");const cc=new Na.a;cc.zEf(this.XF.n,Nb,ob);return cc}}Object(m.a)(hi,"ObjectFetcher",null,[1818]);class xj{constructor(ob,Nb,cc){if(!ob)throw Error.argumentNull("prediction");if(!Nb)throw Error.argumentNull("fieldNames");if(!cc)throw Error.argumentNull("values");if(Nb.length!==cc.length)throw Error.argument("values","fieldNames and values do not have same length");this.mJk=ob;this.nVb=Nb;this.Ccd=cc}get prediction(){return this.mJk}get hni(){return this.nVb.length}EIf(ob){return 0<=
ob&&ob<this.nVb.length?this.nVb[ob]:null}getValue(ob){return 0<=ob&&ob<this.Ccd.length?this.Ccd[ob]:null}}Object(m.a)(xj,"PredictionData",null,[]);class xg{constructor(ob,Nb){if(!ob)throw Error.argumentNull("predictions");if(!Nb)throw Error.argumentNull("tokenAttributes");this.TIn=ob;this.XIn=Nb}NLf(){return this.TIn}Ksi(){return this.XIn}}Object(m.a)(xg,"PredictionDataWithTokenAttributes",null,[]);class fj{constructor(ob,Nb){this.prediction=null;this.score=0;this.prediction=ob;this.score=Nb}}Object(m.a)(fj,
"PredictionWithScore",null,[]);class dg{constructor(ob,Nb){if(!ob)throw Error.argumentNull("predictions");if(!Nb)throw Error.argumentNull("attributes");this.nJk=ob;this.ook=Nb}NLf(){return this.nJk}Ksi(){return this.ook}}Object(m.a)(dg,"PredictionsWithTokenAttributes",null,[]);class Nf{constructor(ob,Nb,cc){if(!ob)throw Error.argumentNull("attributeName");if(!Nb)throw Error.argumentNull("fieldNames");if(!cc)throw Error.argumentNull("values");if(Nb.length!==cc.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.nok=ob;this.nVb=Nb;this.Ccd=cc}get attributeName(){return this.nok}get hni(){return this.nVb.length}EIf(ob){return 0<=ob&&ob<this.nVb.length?this.nVb[ob]:null}getValue(ob){return 0<=ob&&ob<this.Ccd.length?this.Ccd[ob]:null}}Object(m.a)(Nf,"TokenAttributes",null,[]);var pg=d(109),ye=d(139);class qh{constructor(ob,Nb,cc,Lc,Uc){this.Cud=0;this.dOg=null;this.Dud=this.JBc=0;this.EGe=this.h3b=this.Yva=this.KBc=null;this.eOg=0;this.B0e=this.MD=null;this._state=
-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.DV=ob;this.Nck=this.Rck=Nb;this.Mck=this.Pck=cc;this.Aud=this.Ock=Lc;this.Bud=this.Qck=Uc}Sck(){this.Dud=0;return this.bOg}bOg(){if(!(this.Dud<this.Aud))return this.cOg;this.KBc=this.Nck.items[this.Dud+this.Mck];this.Yva=new E.a(this.DV.Bb.annotations);1!==this.Aud&&this.DV.Bb.C8c||this.Yva.R6a(this.KBc);if(0<=this.DV.Bb.dke){({value:this.h3b}=this.Yva.mr(this.DV.Bb.dke)).returnValue?this.h3b=
this.h3b.HW():this.h3b=new nb.a(this.DV.Bb.annotations,R.Annotations.yY);this.EGe=this.Bud.items;this.eOg=this.EGe.length;for(this.Cud=0;this.Cud<this.eOg;++this.Cud)this.dOg=this.EGe[this.Cud],Array.add(this.h3b.items,this.dOg);this.Yva.eA(this.DV.Bb.dke,this.h3b)}else 0<=this.DV.Bb.JCg?this.Yva.eA(this.DV.Bb.JCg,this.Bud.items[0]):0<=this.DV.Bb.ckf?this.Yva.eA(this.DV.Bb.ckf,!0):this.DV.Bb.K_i?this.Bud.items[0].L3d((ob,Nb)=>this.Yva.eA(ob,Nb)):(this.Yva.R6a(this.Bud.items[0]),1!==this.Aud&&this.DV.Bb.C8c||
(({value:this.JBc}=this.KBc.mr(this.DV.Bb.l6)).returnValue&&this.Yva.eA(this.DV.Bb.l6,this.JBc),({value:this.JBc}=this.KBc.mr(this.DV.Bb.P$)).returnValue&&this.Yva.eA(this.DV.Bb.P$,this.JBc),this.KBc.mr(this.DV.Bb.xmb).returnValue&&this.Yva.eA(this.DV.Bb.xmb,this.JBc)));this.MD=this.Yva;this._state=2;return this.Uck}cOg(){this._state=3}Tck(){this.Dud++;return this.bOg}Uck(){return 1<this.Aud&&this.DV.Bb.C8c?this.cOg:this.Tck}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new qh(this.DV,
this.Rck,this.Pck,this.Ock,this.Qck)).getEnumerator()}[Symbol.iterator](){return Object(ye.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.B0e=this.Sck());for(;1===this._state;)this.B0e=this.B0e();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.MD}}Object(m.a)(qh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[10,15,36]);class qg{constructor(ob,Nb,cc){this.zcd=this.gbj=0;this.Vqc=null;this.L6f=this.s6f=this.Tqc=this.qie=this.v6f=0;this.rie=!1;this.F6f=ob;this.N6f=Nb;this.SIn=cc}bCi(){null===this.Vqc&&({d0j:this.Vqc,jPi:this.v6f,length:this.qie,M5l:ob}=this.F6f.GIi(this.N6f.items[this.zcd],this.SIn),this.rie=ob||this.rie);if(this.Tqc<this.qie){var ob=this.Vqc.charAt(this.v6f+this.Tqc);++this.Tqc;return{returnValue:!0,ch:ob}}if(this.zcd===this.N6f.items.length-1)return{returnValue:!1,ch:"\x00"};++this.zcd;
this.Tqc=0;this.Vqc=null;return{returnValue:!0,ch:" "}}jqg(ob,Nb){this.Tqc===this.qie&&this.Vqc&&(this.L6f=Nb,this.s6f=this.zcd-this.gbj+1)}pHo(ob){if(0>ob||ob>=this.N6f.items.length)throw Error.argumentOutOfRange("iToken");this.zcd=this.gbj=ob;this.Vqc=null;this.s6f=this.Tqc=this.qie=this.v6f=0;this.L6f=-1;this.rie=!1}Dzm(){return{Vil:this.s6f,sxn:this.L6f,L5l:this.rie}}}Object(m.a)(qg,"TriePrefixVisitor",null,[1853]);class dl{constructor(ob){this.Bb=ob}execute(ob){if(!({value:cc}=ob.mr(this.Bb.vTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Nb;({value:Nb}=ob.mr(this.Bb.Q5a)).returnValue||(Nb=null);var cc=this.Ugm(cc,Nb);ob=R.Annotations.HW(ob);ob.eA(this.Bb.vTa,cc);return ob}Ugm(ob,Nb){let cc=null;const Lc=this.Bb.flatLexicon.trie,Uc=new qg(this,ob,Nb);let sd=null;this.Bb.flatLexicon.CWf()&&(sd=Object(pg.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.Kkm,"getCaseInsensitiveForm"));let id=0,Ld;var ne;let kf;for(;id<ob.items.length;){const vg=ob.items[id];Uc.pHo(id);Lc.Kak(Uc,sd);({Vil:Ld,sxn:ne,L5l:kf}=Uc.Dzm());if(0<Ld){({jAn:ne}=this.Bb.flatLexicon.Ohm(ne));
for(let Sh of this.kIl(ob,id,Ld,ne)){1<Ld&&this.Bb.C8c&&this.hJl(ob,Nb,id,vg,Ld,kf,Sh);if(!cc)for(cc=new nb.a(this.Bb.annotations,R.Annotations.yY),ne=0;ne<id;++ne)Array.add(cc.items,ob.items[ne]);Array.add(cc.items,Sh)}id+=Ld}else cc&&Array.add(cc.items,vg),++id}return cc||ob}hJl(ob,Nb,cc,Lc,Uc,sd,id){if(sd)sd=!0;else if(this.Bb.s_i){sd=!1;var Ld=-1;for(var ne=0;ne<Uc;ne++){var kf=ob.items[cc+ne];let pj;var vg=void 0;if(!({value:pj}=kf.mr(this.Bb.l6)).returnValue||!({value:vg}=kf.mr(this.Bb.P$)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<ne){if(pj>Ld+1){sd=!0;break}if(0>Ld||null===Nb||Ld>=Nb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Nb.charAt(Ld)){sd=!0;break}}Ld=pj+vg}}else sd=!1;if(sd){vg=new Sys.StringBuilder;for(sd=0;sd<Uc;++sd)({d0j:Ld,jPi:ne,length:kf}=this.GIi(ob.items[cc+sd],Nb)),0<sd&&vg.append(" "),vg.append(Ld.substr(ne,kf));id.eA(this.Bb.xmb,vg.toString())}ob=ob.items[cc+Uc-1];let Sh,Ei;({value:Lc}=Lc.mr(this.Bb.l6)).returnValue&&
({value:Sh}=ob.mr(this.Bb.l6)).returnValue&&({value:Ei}=ob.mr(this.Bb.P$)).returnValue?(id.eA(this.Bb.l6,Lc),id.eA(this.Bb.P$,Sh+Ei-Lc)):(id.CZa(this.Bb.l6),id.CZa(this.Bb.P$))}kIl(ob,Nb,cc,Lc){return new qh(this,ob,Nb,cc,Lc)}GIi(ob,Nb){let cc,Lc;if(({value:cc}=ob.mr(this.Bb.xmb)).returnValue)Lc=!0,Nb=0,ob=cc.length;else{Lc=!1;if(null===Nb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");cc=Nb;if(!({value:Nb}=ob.mr(this.Bb.l6)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ob}=ob.mr(this.Bb.P$)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Nb||0>ob||Nb+ob>cc.length)throw Error.argument("Token start/length values out of range","token");}return{d0j:cc,jPi:Nb,length:ob,M5l:Lc}}}Object(m.a)(dl,"FlatLexiconNLModule",null,[1840]);class Jk{constructor(ob,Nb){this.ckf=this.dke=this.JCg=this.xmb=this.P$=this.l6=this.Q5a=this.vTa=0;this.K_i=this.s_i=this.C8c=!1;this.flatLexicon=null;this.annotations=Nb.annotations;
let cc=0;try{this.vTa=ob.K(cc),++cc,this.Q5a=ob.K(cc),++cc,this.l6=ob.K(cc),++cc,this.P$=ob.K(cc),++cc,this.xmb=ob.K(cc),++cc,this.JCg=ob.K(cc),++cc,this.dke=ob.K(cc),++cc,this.ckf=ob.K(cc),++cc,this.C8c=1===ob.K(cc),++cc,this.s_i=1===ob.K(cc),++cc,this.K_i=1===ob.K(cc),++cc,this.flatLexicon=Nb.OHm(ob.K(cc))}catch(Lc){throw Error.argument("initData");}}}Object(m.a)(Jk,"FlatLexiconNLModuleInit",null,[]);class Ni{constructor(){this.A6c=0;this.iCf=null;this.Amd=0}}Object(m.a)(Ni,"FeatureGenStackRec",
null,[]);class Wh{constructor(ob){this.HHg=Array(ob);this.Qzc=Array(ob);this.nEg=[];this.CYj=[]}}Object(m.a)(Wh,"TokenStringLattice",null,[]);const gh=(ob,Nb,cc)=>{for(let Lc=0;Lc<ob.length;Lc++)cc=Nb(cc,ob[Lc]);return cc},th=(ob,Nb)=>{const cc=Array(ob.length);for(let Lc=0;Lc<ob.length;Lc++)cc[Lc]=Nb(ob[Lc]);return cc},li=(ob,Nb)=>{Nb=Array(Math.min(Nb,ob.length));for(let cc=0;cc<Nb.length;cc++)Nb[cc]=ob[cc];return Nb},rg=(ob,Nb)=>{const cc=[];for(const Lc of ob)Nb(Lc)&&Array.add(cc,Lc);return cc};
class jj{constructor(ob,Nb){this.key=ob;this.value=Nb}}Object(m.a)(jj,"KeyValuePair",null,[]);const Jl=(ob,Nb)=>({returnValue:Nb in ob,value:ob[Nb]}),Af=ob=>{const Nb=[];for(let cc in ob){const Lc=new jj(cc,ob[cc]);Array.add(Nb,Lc)}return Nb};class kl{constructor(ob){this.FIi=this.cPm;this.Bb=ob;this.uie=this.C6f=this.D6f=0;for(const Nb of this.Bb.i2d)this.D6f=Math.max(this.D6f,Nb.Bkg),this.C6f=Math.max(this.C6f,Nb.vkg),this.uie=Math.max(this.uie,Nb.dzb.length)}get g8l(){return this.Bb.OCe.trie}execute(ob){if(!ob)throw Error.argumentNull("input");
let Nb,cc;({tokens:Nb,Fyn:cc}=this.dPm(ob));let Lc=null,Uc=null,sd={};if(this.Bb.k9c){Nb=R.Annotations.HW(Nb);for(var id=0;id<Nb.items.length;++id)Nb.items[id]=R.Annotations.HW(Nb.items[id])}else({Mmi:Uc,returnValue:Lc}=this.RCi(ob,sd));id=Array(this.uie);const Ld=Array(this.uie);for(var ne=0;ne<Ld.length;++ne)Ld[ne]=new Ni;for(ne=-this.D6f;ne<Nb.items.length+this.C6f;++ne){let kf=null;this.Bb.k9c&&(kf=Nb.items[ne],sd={},{Mmi:Uc,returnValue:Lc}=this.RCi(kf,sd));for(const vg of this.Bb.i2d){if(0>ne&&
-ne>vg.Bkg||ne>=Nb.items.length&&ne-Nb.items.length+1>vg.vkg)continue;let Sh=!0;for(let Ei=0;Ei<vg.dzb.length;++Ei){const pj=ne+vg.dzb[Ei];id[Ei]=pj;if(0>pj?0>this.Bb.Ckg:pj>=Nb.items.length?0>this.Bb.wkg:!cc.Qzc[pj]){Sh=!1;break}}Sh&&({BMl:Lc,CMl:Uc}=this.vcn(vg,cc,Lc,Uc,sd,Ld,id))}this.Bb.k9c&&(kf.eA(this.Bb.Q$a?this.Bb.kdc:this.Bb.idc,Lc),this.Bb.Q$a&&kf.eA(this.Bb.jdc,Uc))}ob=R.Annotations.HW(ob);this.Bb.k9c?ob.eA(this.Bb.vTa,Nb):(ob.eA(this.Bb.Q$a?this.Bb.kdc:this.Bb.idc,Lc),this.Bb.Q$a&&ob.eA(this.Bb.jdc,
Uc));return ob}dPm(ob){let Nb,cc;if(!ob||!({value:Nb}=ob.mr(this.Bb.vTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Lc;({value:Lc}=ob.mr(this.Bb.Q5a)).returnValue||(Lc="");cc=new Wh(Nb.items.length);const Uc=rg(this.Bb.KHg,sd=>!sd.F7c||sd.F7c.isMatch(ob,null));for(let sd=0;sd<Nb.items.length;++sd){const id=Nb.items[sd];let Ld=null;cc.HHg[sd]=cc.nEg.length;let ne=cc.Qzc[sd]=0;for(const kf of Uc)0<kf.Pcd&&cc.Qzc[sd]+ne>=kf.Pcd||kf.tokenFilter&&!kf.tokenFilter.isMatch(id,
null)||({Erd:Ld,sUc:ne}=kf.apply(this,id,sd,cc,Lc,Ld,ne))}return{tokens:Nb,Fyn:cc}}vcn(ob,Nb,cc,Lc,Uc,sd,id){let Ld=0;sd[0].A6c=-1;for(sd[0].iCf=ob.eIj;;){var ne=id[Ld],kf=0>ne||ne>=Nb.Qzc.length?1:Nb.Qzc[ne];let Ei=!1;for(;sd[Ld].A6c<kf-1;){++sd[Ld].A6c;var vg=void 0,Sh=void 0;0>ne?(vg=this.Bb.Ckg,Sh=1):ne>=Nb.HHg.length?(vg=this.Bb.wkg,Sh=1):(Sh=Nb.HHg[ne]+sd[Ld].A6c,vg=Nb.nEg[Sh],Sh=Nb.CYj[Sh]);sd[Ld].Amd=Sh*(Ld?sd[Ld-1].Amd:ob.score);if(({value:vg}=Jl(sd[Ld].iCf,vg.toString())).returnValue){Ld===
ob.dzb.length-1?(ne=vg,sd[Ld].Amd&&(({value:kf}=Jl(Uc,ne.toString())).returnValue||(kf=-1),0>kf&&(cc=R.Annotations.HW(cc),Array.add(cc.items,ne)),this.Bb.Q$a&&(Lc=R.Annotations.HW(Lc),0>kf?Array.add(Lc.items,sd[Ld].Amd):Lc.items[kf]+=sd[Ld].Amd),0>kf&&(this.Bb.u3i||this.Bb.Q$a)&&(Uc[ne.toString()]=cc.items.length-1))):(++Ld,sd[Ld].A6c=-1,sd[Ld].iCf=vg);Ei=!0;break}}if(!Ei&&(--Ld,0>Ld))break}return{BMl:cc,CMl:Lc}}RCi(ob,Nb){let cc;if(({value:cc}=ob.mr(this.Bb.Q$a?this.Bb.kdc:this.Bb.idc)).returnValue)for(let Lc=
0;Lc<cc.items.length;++Lc)Nb[cc.items[Lc].toString()]=Lc;else cc=new nb.a(this.Bb.annotations,R.Annotations.LOa);if(this.Bb.Q$a){if(({value:Nb}=ob.mr(this.Bb.jdc)).returnValue||(Nb=new nb.a(this.Bb.annotations,R.Annotations.Jva)),Nb.items.length!==cc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.bia(R.Annotations.yY,ob));}else Nb=null;return{returnValue:cc,Mmi:Nb}}get Qmp(){return this.Bb.OCe}cPm(ob,
Nb){var cc;if(({value:cc}=Nb.mr(this.Bb.xmb)).returnValue)ob=cc;else{if(!({value:cc}=Nb.mr(this.Bb.l6)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Nb}=Nb.mr(this.Bb.P$)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>cc||0>Nb||cc+Nb>ob.length)throw Error.argument("Token indices are out of range");ob=ob.substr(cc,Nb)}return ob}}Object(m.a)(kl,"NGramNLModule",null,[1840,1841]);class xi{constructor(ob){this.dzb=null;this.score=this.vkg=this.Bkg=
0;this.eIj=null;if(ob){var Nb=0;try{if(ob.K(Nb)!==xi.yLb)throw Error.argument("initData","Input does not represent a feature template");++Nb;const cc=ob.K(Nb);++Nb;this.dzb=Array(cc);for(let Lc=0;Lc<cc;++Lc)this.dzb[Lc]=ob.K(Nb),++Nb;this.Bkg=ob.K(Nb);++Nb;this.vkg=ob.K(Nb);++Nb;this.score=ob.K(Nb);++Nb;this.eIj=({dPi:Nb}=xi.Jyj(ob,Nb)).returnValue}catch(cc){throw Error.argument("initData");}}}static Jyj(ob,Nb){const cc=ob.K(Nb);++Nb;const Lc={};for(let Uc=0;Uc<cc;++Uc){const sd=ob.K(Nb);++Nb;ob.K(Nb)?
Lc[sd.toString()]=({dPi:Nb}=xi.Jyj(ob,Nb)).returnValue:(++Nb,Lc[sd.toString()]=ob.K(Nb),++Nb)}return{returnValue:Lc,dPi:Nb}}}xi.yLb=240803228;Object(m.a)(xi,"FeatureTemplate",null,[1855]);var Eh=d(1558);class Kj{constructor(ob,Nb){this.Q$a=this.u3i=this.k9c=!1;this.xmb=this.P$=this.l6=this.vTa=this.Q5a=this.jdc=this.kdc=this.idc=0;this.OCe=null;this.wkg=this.Ckg=0;this.i2d=this.KHg=null;if(ob){this.annotations=Nb.annotations;var cc=0;try{this.k9c=1===ob.K(cc);++cc;this.u3i=1===ob.K(cc);++cc;this.Q$a=
1===ob.K(cc);++cc;this.idc=ob.K(cc);++cc;this.kdc=ob.K(cc);++cc;this.jdc=ob.K(cc);++cc;this.Q5a=ob.K(cc);++cc;this.vTa=ob.K(cc);++cc;this.l6=ob.K(cc);++cc;this.P$=ob.K(cc);++cc;this.xmb=ob.K(cc);++cc;this.OCe=this.vao(Nb.xqb(ob.K(cc)));++cc;this.Ckg=ob.K(cc);++cc;this.wkg=ob.K(cc);++cc;const Lc=ob.K(cc);++cc;this.KHg=Array(Lc);for(let sd=0;sd<Lc;++sd){const id=ob.K(cc);++cc;const Ld=this.OCe.trie,ne=new Na.a;ne.$pb(ob,cc,id);this.KHg[sd]=this.zao(ne,Nb,Ld);cc+=id}const Uc=ob.K(cc);++cc;this.i2d=Array(Uc);
for(Nb=0;Nb<Uc;++Nb){const sd=ob.K(cc);++cc;const id=new Na.a;id.$pb(ob,cc,sd);this.i2d[Nb]=this.Y$n(id);cc+=sd}}catch(Lc){throw Error.argument("initData");}}}vao(ob){return new Ae.a(new Gf.a(ob))}zao(ob,Nb,cc){return Eh.a.create(ob,Nb,cc)}Y$n(ob){return new xi(ob)}}Object(m.a)(Kj,"NGramNLModuleInit",null,[]);class Vi{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");ob=ob.clone();this.Bb.script.execute(ob,null);return ob}}Object(m.a)(Vi,"ScriptNLModule",null,[1840]);
class Qh{constructor(ob,Nb){ob&&(this.script=Nb.tPb(ob.K(0)))}}Object(m.a)(Qh,"ScriptNLModuleInit",null,[]);const Mh=ob=>{ob=th(ob,Nb=>Nb*Nb);return Math.sqrt(gh(ob,(Nb,cc)=>Nb+cc,0))},Ch=ob=>gh(ob,(Nb,cc)=>Nb>cc?Nb:cc,ob[0]);class Al{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");var Nb=[],cc=[];this.Yul(ob,Nb,cc);this.E3k(Nb,cc);const Lc={};for(let sd=0;sd<Nb.length;++sd){var Uc=Nb[sd];const id=this.Bb.rTi.K(Uc);Uc=this.Bb.sTi.K(Uc);for(let Ld=0;Ld<Uc;++Ld){const ne=
this.Bb.caa.K(this.Bb.V1h.K(id+Ld)),kf=this.Bb.W1h.K(id+Ld);let vg;({value:vg}=Jl(Lc,ne)).returnValue||(vg=0);Lc[ne]=vg+cc[sd]*kf}}cc=Af(Lc);cc.sort((sd,id)=>{var Ld=sd.value,ne=id.value;(Ld=-(Ld>ne?1:Ld<ne?-1:0))||(Ld=sd.key.localeCompare(id.key));return Ld});Nb=new nb.a(this.Bb.annotations,R.Annotations.yY);for(const sd of li(cc,this.Bb.rLn))cc=new E.a(this.Bb.annotations),cc.eA(this.Bb.Tal,sd.key),cc.eA(this.Bb.Val,sd.value),Array.add(Nb.items,cc);ob.eA(this.Bb.Ual,Nb);return ob}Yul(ob,Nb,cc){if(({value:ob}=
ob.mr(this.Bb.Sal)).returnValue){let Lc;if(({value:Lc}=ob.mr(this.Bb.kdc)).returnValue){let Uc;if(!({value:Uc}=ob.mr(this.Bb.jdc)).returnValue||Lc.items.length!==Uc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.YVd(Lc,Uc,Nb,cc)}if(({value:Lc}=ob.mr(this.Bb.Xal)).returnValue){let Uc;if(!({value:Uc}=ob.mr(this.Bb.Yal)).returnValue||Lc.items.length!==Uc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.YVd(Lc,Uc,Nb,cc)}({value:Lc}=ob.mr(this.Bb.idc)).returnValue&&this.YVd(Lc,null,Nb,cc);({value:Lc}=ob.mr(this.Bb.Wal)).returnValue&&this.YVd(Lc,null,Nb,cc)}}YVd(ob,Nb,cc,Lc){for(let sd=0;sd<ob.items.length;++sd){var Uc=void 0;ob.U7===R.Annotations.Qca?({value:Uc}=Jl(this.Bb.hii,ob.items[sd])).returnValue||(Uc=-1):(Uc=ob.items[sd],Uc=Uc>=this.Bb.m8f&&Uc<=this.Bb.ULn?this.Bb.obg?this.Bb.obg.K(Uc-this.Bb.m8f)-1:Uc-this.Bb.m8f:-1);if(0<=Uc){let id;id=Nb?Nb.items[sd]:1;0<id&&(Array.add(cc,Uc),Array.add(Lc,
id))}}}E3k(ob,Nb){if(ob.length){switch(this.Bb.blo){case 0:break;case 1:for(var cc=0;cc<Nb.length;++cc)Nb[cc]=1+Math.log(Nb[cc]);break;case 2:cc=Ch(Nb);for(let Lc=0;Lc<Nb.length;++Lc)Nb[Lc]=.5+Nb[Lc]/cc*.5;break;case 3:for(cc=0;cc<Nb.length;++cc)Nb[cc]=1;break;default:throw Error.notImplemented();}if(this.Bb.Xbe)for(cc=0;cc<Nb.length;++cc)Nb[cc]*=this.Bb.Xbe.K(ob[cc]);ob=Mh(Nb);for(cc=0;cc<Nb.length;++cc)Nb[cc]/=ob}}}Object(m.a)(Al,"TfIdfRankerNLModule",null,[1840]);class Rj{constructor(ob,Nb=0){if(!ob)throw Error.argumentNull("byteArray");
this.vie=Nb;if(604662927!==ob.cA(this.vie+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Pk=ob.cA(this.vie+4,4);this.Qaj=ob.cA(this.vie+8,4);this.GIn=ob}K(ob){if(0>ob||ob>=this.count)throw Error.argumentOutOfRange("index");return this.GIn.ypo(8*this.vie+96+ob*this.Qaj,this.Qaj)}get count(){return this.Pk}}Object(m.a)(Rj,"CompactIntArray",null,[1838]);const qk=(ob,Nb)=>{Nb=Array(Nb);for(let sd=0;sd<Nb.length;sd++){var cc=sd,Lc=ob.dca(),Uc=1===(Lc>>31&1)?
-1:1;const id=Lc&8388607;Lc=Lc>>23&255;256===Lc+1?Uc=id?Number.NaN:1===Uc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Lc?(Lc-=127,Uc=Uc*eg(id,1)*Math.pow(2,Lc)):Uc=Uc*eg(id,0)*Math.pow(2,-126);Nb[cc]=Uc}return Nb},eg=(ob,Nb)=>{let cc=0;for(let Lc=0;23>Lc;Lc++)cc+=(ob>>22-Lc&1)/Math.pow(2,Lc+1);return Nb+cc};class qf{constructor(ob,Nb){this.obg=null;this.Nhj=0;this.sTi=this.rTi=this.Xbe=null;this.Mhj=0;this.W1h=this.V1h=null;this.annotations=Nb.annotations;let cc=0;this.Wal=ob.K(cc);++cc;this.idc=
ob.K(cc);++cc;this.Xal=ob.K(cc);++cc;this.Yal=ob.K(cc);++cc;this.kdc=ob.K(cc);++cc;this.jdc=ob.K(cc);++cc;this.Sal=ob.K(cc);++cc;this.Ual=ob.K(cc);++cc;this.Tal=ob.K(cc);++cc;this.Val=ob.K(cc);++cc;var Lc=ob.K(cc);++cc;var Uc=Array(Lc);for(var sd=0;sd<Lc;++sd)Uc[sd]=Nb.iD(ob.K(cc)),++cc;this.caa=Na.a.$sf(Uc);this.rLn=ob.K(cc);++cc;this.blo=ob.K(cc);++cc;Lc=ob.K(cc);++cc;this.hii={};for(Uc=0;Uc<Lc;++Uc){sd=Nb.iD(ob.K(cc));++cc;const id=ob.K(cc);++cc;this.hii[sd]=id}this.m8f=ob.K(cc);++cc;this.ULn=
ob.K(cc);++cc;Lc=ob.K(cc);++cc;0<Lc&&(Lc=Nb.xqb(ob.K(cc)),++cc,this.obg=this.cpe(new Pb(Lc)));++cc;ob=Nb.xqb(ob.K(cc));this.gao(ob)}cpe(ob){return new Rj(ob.Yja,ob.offset)}gao(ob){try{const Nb=new Pb(ob);this.Nhj=Nb.dca();1===Nb.dca()?this.Xbe=Na.a.$sf(qk(Nb,this.Nhj)):this.Xbe=null;const cc=Nb.dca();this.rTi=this.cpe(Nb);Nb.offset+=cc;const Lc=Nb.dca();this.sTi=this.cpe(Nb);Nb.offset+=Lc;this.Mhj=Nb.dca();const Uc=Nb.dca();this.V1h=this.cpe(Nb);Nb.offset+=Uc;this.W1h=Na.a.$sf(qk(Nb,this.Mhj))}catch(Nb){throw Error.argument("byteReader");
}}}Object(m.a)(qf,"TfIdfRankerNLModuleInit",null,[]);class kg{constructor(ob,Nb,cc,Lc){this.wig=ob;this.Koi=cc;this.tokens=Lc;this.vra=Nb;this.wwc=-1;this.nwe=0}}Object(m.a)(kg,"TokenizerData",null,[]);class Wi{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");if(!({value:Lc}=ob.mr(this.Bb.Q5a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Nb;({value:Nb}=ob.mr(this.Bb.l6)).returnValue||(Nb=0);let cc;({value:cc}=
ob.mr(this.Bb.P$)).returnValue||(cc=Lc.length-Nb);if(0>Nb||Nb>Lc.length)throw Error.argument("input","Start index out of range");if(0>cc||cc>Lc.length)throw Error.argument("input","Length out of range");if(Nb+cc>Lc.length)throw Error.argument("input","Bad start-length range");var Lc=new kg(Lc,Nb,Nb+cc,new nb.a(this.Bb.annotations,R.Annotations.yY));this.Rmp(Lc);ob=ob.isReadOnly?ob.clone():ob;ob.eA(this.Bb.vTa,Lc.tokens);return ob}Rmp(ob){for(;ob.vra<ob.Koi;){if(this.Bb.sPf){var Nb=this.Bb.sPf.raj(ob.wig,
ob.vra,ob.Koi-ob.vra,null);!Nb.succeeded&&Nb.Bgj&&(Nb=Nb.Bgj);if(Nb.succeeded){this.Plj(ob,Nb.length,this.Bb.fLi);ob.vra+=Nb.length;continue}}Nb=ob.wig.substr(ob.vra);let cc=-1,Lc=-1,Uc=-1;for(let sd=0;sd<this.Bb.lve.length;++sd){const id=this.Bb.lve[sd].exec(Nb);id&&0<id[1].length&&(0>cc||id[0].length>Lc)&&(cc=sd,Lc=id[0].length,Uc=id[1].length)}0<=cc?(this.Plj(ob,Uc,this.Bb.Wug[cc]),ob.vra+=Uc):ob.vra+=1}}Plj(ob,Nb,cc){if(this.Bb.C1i)cc!==Wi.djl&&(0>ob.wwc&&(ob.wwc=ob.vra),ob.nwe=ob.vra+Nb-ob.wwc,
cc===Wi.cjl&&(0<=ob.wwc&&0<ob.nwe&&(Nb=new E.a(this.Bb.annotations),Nb.eA(this.Bb.l6,ob.wwc),Nb.eA(this.Bb.P$,ob.nwe),Nb.eA(this.Bb.Rif,Wi.ejl),Nb.eA(this.Bb.Q5a,ob.wig),Array.add(ob.tokens.items,Nb)),ob.wwc=-1,ob.nwe=0));else{let Lc=new E.a(this.Bb.annotations);Lc.eA(this.Bb.l6,ob.vra);Lc.eA(this.Bb.P$,Nb);Lc.eA(this.Bb.Rif,cc);Array.add(ob.tokens.items,Lc)}}}Wi.djl="GAP";Wi.cjl="EOS_CHUNK";Wi.ejl="SENTENCE";Object(m.a)(Wi,"TokenizerNLModule",null,[1840]);class ql{constructor(ob,Nb){this.P$=this.l6=
this.Rif=this.vTa=this.Q5a=0;this.C1i=!1;this.Wug=this.lve=this.fLi=this.sPf=null;if(ob){this.annotations=Nb.annotations;var cc=0;try{this.Q5a=ob.K(cc);++cc;this.vTa=ob.K(cc);++cc;this.Rif=ob.K(cc);++cc;this.l6=ob.K(cc);++cc;this.P$=ob.K(cc);++cc;this.C1i=1===ob.K(cc);++cc;var Lc=ob.K(cc);++cc;0<Lc&&(this.sPf=Nb.JKf(Lc).g8l);this.fLi=ob.K(cc)?Nb.iD(ob.K(cc)):"";++cc;const Uc=ob.K(cc);++cc;this.lve=Array(Uc);this.Wug=Array(Uc);for(Lc=0;Lc<Uc;++Lc)this.lve[Lc]=new RegExp(Nb.iD(ob.K(cc))),++cc,this.Wug[Lc]=
Nb.iD(ob.K(cc)),++cc}catch(Uc){throw Error.argument("initData");}}}}Object(m.a)(ql,"TokenizerNLModuleInit",null,[]);class hg{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");let Nb;if(!({value:Nb}=ob.mr(this.Bb.PUh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const cc of this.Bb.yDg)Nb=cc.apply(Nb);ob=R.Annotations.HW(ob);ob.eA(this.Bb.QUh,Nb);return ob}static cif(ob,Nb){const cc=new Sys.StringBuilder;for(let Lc=
0;Lc<ob.length;++Lc)cc.append(Nb(ob.substr(Lc,1)));return cc.toString()}}Object(m.a)(hg,"TransliteratorNLModule",null,[1840]);class Km{constructor(ob){ob&&(this.style=ob.K(0))}apply(ob){return hg.cif(ob,Nb=>Km.Nnl(Nb,this.style))}static Nnl(ob,Nb){switch(Nb){case 0:return ob.toLowerCase();case 1:return"I"===ob?"\u0131":ob.toLowerCase();case 2:return ob.toUpperCase();case 3:return"i"===ob?"\u0130":ob.toUpperCase();default:throw Error.invalidOperation();}}}Km.zLb=0;Object(m.a)(Km,"ChangeCaseTransliterationStage",
null,[1851]);class zg{apply(ob){return hg.cif(ob,zg.sop)}static sop(ob){const Nb=ob.charCodeAt(0);return 65281<=Nb&&65374>=Nb?String.fromCharCode(Nb-65248):ob}}zg.zLb=4;Object(m.a)(zg,"LatinFullWidthToHalfWidthTransliterationStage",null,[1851]);class Kd{constructor(ob,Nb){ob&&(this.Qjd=Nb.Bkc(ob.K(0)),this.aFo=Nb.iD(ob.K(1)))}apply(ob){return ob.replace(this.Qjd,this.aFo)}}Kd.zLb=1;Object(m.a)(Kd,"RegexReplaceTransliterationStage",null,[1851]);class Cg{constructor(ob,Nb){if(ob){var cc=ob.K(0),Lc=
Nb.iD(ob.K(1)),Uc=new Rj(Nb.xqb(ob.K(2)));ob=0>ob.K(3)?null:new Rj(Nb.xqb(ob.K(3)));this.GEg={};for(Nb=0;Nb<cc;++Nb)this.GEg[Lc.charAt(Nb).toString()]=Lc.substr(Uc.K(Nb),ob?ob.K(Nb):1)}}apply(ob){return hg.cif(ob,Nb=>Nb in this.GEg?this.GEg[Nb]:Nb)}}Cg.zLb=2;Object(m.a)(Cg,"SingleCharSubstitutionsTransliterationStage",null,[1851]);class wl{constructor(ob,Nb){this.QUh=this.PUh=0;this.yDg=null;if(ob){this.annotations=Nb.annotations;var cc=0;try{this.PUh=ob.K(cc);++cc;this.QUh=ob.K(cc);++cc;const Lc=
ob.K(cc);++cc;this.yDg=Array(Lc);for(let Uc=0;Uc<Lc;++Uc){const sd=ob.K(cc);++cc;const id=ob.K(cc);++cc;const Ld=new Na.a;Ld.$pb(ob,cc,id);cc+=id;this.yDg[Uc]=this.uao(sd,Ld,Nb)}}catch(Lc){throw Error.argument("initData");}}}uao(ob,Nb,cc){switch(ob){case Km.zLb:return new Km(Nb);case Kd.zLb:return new Kd(Nb,cc);case Cg.zLb:return new Cg(Nb,cc);case zg.zLb:return new zg;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(wl,"TransliteratorNLModuleInit",
null,[]);class Kl{bBm(ob,Nb){const cc=ob.K(0),Lc=new Na.a;Lc.$pb(ob,1,ob.count-1);switch(cc){case 0:return new Vi(new Qh(Lc,Nb));case 2:return new Wi(new ql(Lc,Nb));case 3:return new kl(new Kj(Lc,Nb));case 5:return new dl(new Jk(Lc,Nb));case 9:return new hg(new wl(Lc,Nb));case 10:return new Al(new qf(Lc,Nb));default:throw Error.notImplemented();}}}Object(m.a)(Kl,"NLModuleFactory",null,[1822]);class ae{constructor(ob){this.ajl=";";if(!ob)throw Error.argumentNull("resource");this.wma=new hi(ob,new Db,
new Kl);this.F6f=this.wma.FAm();this.Paj=this.wma.annotations.Q1c("Text.Text");this.Naj=this.wma.annotations.Q1c("Classification.Predictions");this.q6f=this.wma.annotations.Q1c("Classification.PredictionString");this.Oaj=this.wma.annotations.Q1c("Classification.Probability");this.FIn=this.wma.annotations.Q1c("NLMod.Tokens");if(0>this.Paj||0>this.Naj||0>this.q6f||0>this.Oaj)throw Error.argument("resourceObj","Resource does not represent a ranker");}bjm(){const ob=[];this.PAf(void 0,this.xti(ob),null);
return ob}djm(ob,Nb){const cc=[],Lc=[];this.PAf(ob,this.xti(cc),(Uc,sd)=>{const id=this.wma.annotations.jti(Uc),Ld=[],ne=[];Nb&&Nb.length&&-1===Array.indexOf(Nb,id)||(Uc=this.wma.annotations.getAttributeType(Uc),this.Ltj(Uc,sd,Ld,ne),sd=new Nf(id,Ld,ne),Array.add(Lc,sd))});return new dg(cc,Lc)}cjm(ob){const Nb=[];this.PAf(ob,cc=>{let Lc;if(({value:Lc}=cc.mr(this.q6f)).returnValue){let Uc;({value:Uc}=cc.mr(this.Oaj)).returnValue&&Array.add(Nb,new fj(Lc,Uc))}},null);return Nb}PAf(ob,Nb,cc){var Lc=new E.a(this.wma.annotations);
Lc.eA(this.Paj,ob);ob=this.F6f.execute(Lc);if(({value:Lc}=ob.mr(this.Naj)).returnValue)for(const Uc of Lc.items)Nb(Uc);if(cc&&({value:Nb}=ob.mr(this.FIn)).returnValue)for(const Uc of Nb.items)Uc.L3d(cc)}Ltj(ob,Nb,cc,Lc){if(R.Annotations.nK(ob))for(var Uc of Nb.items)this.Ltj(Nb.U7,Uc,cc,Lc);else if(R.Annotations.I4j(ob)){Uc=this.wma.annotations.yCi(ob);for(let sd=0;sd<Uc;sd++)Array.add(cc,this.wma.annotations.aHi(ob,sd)),Array.add(Lc,this.wma.annotations.bia(this.wma.annotations.UQb(ob,sd),Nb.Mqb(sd)))}else Array.add(cc,
"VALUE"),Array.add(Lc,this.wma.annotations.bia(ob,Nb))}xti(ob){return Nb=>{let cc;({value:cc}=Nb.mr(this.q6f)).returnValue&&Array.add(ob,this.mGm(cc))}}mGm(ob){const Nb=ob.indexOf(this.ajl);return 0>Nb?ob:ob.substring(0,Nb)}}Object(m.a)(ae,"Ranker",null,[]);var pd=d(1477),el=d(1496),Yg=d(2);class rh{constructor(ob,Nb){this.Yrh="";this.F4e=null;this.G4e=!1;this.bwa=null;this.qok=["TellMe.TellMeParamCollection"];this.kc=ob;this.G3a=Nb;this.kc.MKb&&(this.bwa=null)}get Gre(){if(!this.F4e&&!this.G4e){let ob=
null;try{ob=window.TellMeModel}catch(Nb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("QueryRanker","TellMeModel not found. Exception: "+Nb)}if(ob){try{this.F4e=new ae(ob)}catch(Nb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Nb)}this.G4e=!0}else if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("QueryRanker","Classifier model not found")}return this.F4e}lN(){return"Command"}gX(){return 0===
this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc=!1,Lc=f.a.mu,Uc=null){const sd=new x.a(ob);if((!Uc||Array.contains(Uc,0))&&!v.a.yU(ob)){if(!this.Gre&&this.G4e){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.kc.MKb&&this.bwa&&this.bwa.initialize();if(pd.CommandResultsUtility.IWf(ob.Vg)&&(Uc=pd.CommandResultsUtility.evi(ob.Vg),0<Uc.results.length)){Uc.displayName=
"Classifier Debug";sd.gw(Uc);Nb.Kt(sd);return}Uc=ob?this.Yrh=ob.Vg:this.Yrh;if(Yg.AFrameworkApplication.J.$("TellMeParameterizedQueriesEnabled")){Uc=this.oGm(Uc);var id=this.a5d(Uc.NLf());Uc=Uc.Ksi()}else Uc=this.nGm(Uc),id=this.vmm(Uc),Uc=[];pd.CommandResultsUtility.Jhe(id,!1,"Classifier","TFIDF");id=pd.CommandResultsUtility.o4c(ob,id,this.kc,this.bwa,this.G3a,Uc,0,1);0<id.results.length&&Lc!==f.a.contextMenu&&(id.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);cc||id.results.length||this.kc.Y2||
this.kc.reb||(ob=new w.a("lookupNoResults",14,ob.Vg,null,1),id.jy(ob));0<id.results.length&&sd.gw(id);sd.attributes=Uc}Nb.Kt(sd)}NLf(){let ob=[];try{ob=this.Gre.bjm()}catch(Nb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictions","Exception: "+Nb)}return ob}nGm(ob){let Nb=[];try{Nb=this.Gre.cjm(ob)}catch(cc){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictionsWithScore","Exception: "+cc)}return Nb}oGm(ob){try{return this.Gre.djm(ob,this.qok)}catch(Nb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Nb)}return new dg([],[])}a5d(ob){const Nb=[];if(ob)for(const cc of ob)Nb.push(new el.a(cc,-99999));return Nb}vmm(ob){const Nb=[];if(ob)for(const cc of ob)Nb.push(new el.a(cc.prediction,cc.score));return Nb}}Object(m.a)(rh,"CommandResultsProvider",null,[85]);var Mf=d(1764);class mi{constructor(ob){this.kc=ob}lN(){return"Feedback"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc,Lc,Uc=null){ob=new x.a(ob);if(!Uc||Array.contains(Uc,21))Uc=[],Uc.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Uc),Uc=new z.a(22),Uc.displayName="",Uc.jy(new w.a("TellMeFeedback",23,null,null,1)),ob.gw(Uc);Nb.Kt(ob)}}Object(m.a)(mi,"FeedbackResultsProvider",null,[85]);class Ag{constructor(ob,Nb,cc,Lc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ob;this.CommandId=Nb;this.CommandValueId=cc;this.InputText=Lc}}Object(m.a)(Ag,"FindInDocumentProp",null,[]);var Hf=d(16);class Pg{constructor(ob){this.A_e=2;this.lGb=[];this.Cjb=
[];this.kc=ob;Pg.FJa=ob.rCf;Pg.goi="FindInDocumentSuggestion";Pg.Rsj="FindInDocumentSuggestion3";this.AZe=Object.assign(new D.a,{landingTab:"Indoc",data:null});this.bNk=this.kc.Oyb||!!Yg.AFrameworkApplication.ua&&Yg.AFrameworkApplication.ua.Gb.Oyb}lN(){return"FindInDocument"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:3===this.kc.kw?this.kc.QVj?2:3:2}XJ(ob,Nb,cc=!1,Lc,Uc=null){const sd=new x.a(ob);if(Uc&&!Array.contains(Uc,2))Nb.Kt(sd);else if(Array.clear(this.lGb),v.a.yU(ob)){if(cc&&this.iTj()){cc=
new z.a(2);cc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Uc=1;Lc="";if(0<this.Cjb.length&&!this.kc.vxc)for(var id of this.Cjb)if(""!==id.Label.toLowerCase()){if(Uc>=this.A_e)break;this.K8j(cc,id.Label,id.CommandValueId,Pg.goi+Uc,id.InputText);Uc++}id="";this.kc.oS?(sd.gw(cc),cc=new z.a(3),id=this.kc.tmb?v.a.tqb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):id=CommonUIStrings.l_TellMeOpenFindPaneText;Lc=this.dvi("");this.K8j(cc,id,Lc,
Pg.Rsj,"");sd.gw(cc)}Nb.Kt(sd)}else id="",cc&&(cc=this.dvi(ob.Vg),Lc=[],this.kc.xab?(this.kc.Pye&&Lc.push(appChrome.actions.setControlIconSet(Pg.FJa,{"default":"FindInDocument_20"})),id=this.kc.d0f?v.a.bJf(ob.Vg,CommonUIStrings.l_FindInDocumentScopedButtonText):ob.Vg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.kc.oS?(id=this.kc.tmb?v.a.tqb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,ob.Vg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,ob.Vg),
Lc.push(appChrome.actions.setControlIconSet(Pg.FJa,{"default":"FindInDocument_20"}))):id=this.kc.vxc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ob.Vg),this.kc.TAa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Pg.FJa,id)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Pg.FJa,cc))):(Lc.push(appChrome.actions.setControlLabel(Pg.FJa,id)),Lc.push(appChrome.actions.setButtonCommandValueId(Pg.FJa,cc)),
appChrome.api.dispatch(Lc)),this.IOj(id,Pg.FJa,cc,ob.Vg)),this.kc.QVj?(id=new w.a(Pg.FJa,8,ob.Vg),cc=new z.a(2),cc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,cc.jy(id),sd.gw(cc),Nb.Kt(sd)):this.kc.X5d(ob.Vg).then(Ld=>{const ne=new w.a(Pg.FJa,8,ob.Vg,null,1);ne.count=Ld;Ld=new z.a(2);Ld.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ld.jy(ne);sd.gw(Ld);Nb.Kt(sd)},Ld=>{u.TellMeActor.instance.Ye.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+
Ld);Ld=new w.a(Pg.FJa,8,ob.Vg,null,1);const ne=new z.a(2);ne.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ne.jy(Ld);sd.gw(ne);Nb.Kt(sd)})}iTj(){return!!this.kc&&this.kc.Hye}K8j(ob,Nb,cc,Lc,Uc=null){const sd=[];Nb&&sd.push(appChrome.actions.setControlLabel(Lc,Nb));this.kc.oS&&sd.push(appChrome.actions.setControlIconSet(Lc,{"default":"FindInDocument_20"}));sd.push(appChrome.actions.setButtonCommandValueId(Lc,cc));appChrome.api.dispatch(sd);this.IOj(Nb,Lc,cc,"");ob.jy(new w.a(Lc,8,Uc,null,
1,-99999))}dvi(ob){return this.bNk?v.a.jUa(ob,15,this.AZe):Hf.a.yf(ob)}IOj(ob,Nb,cc,Lc){this.iTj()&&this.lGb.length<this.A_e&&(ob=new Ag(ob,Nb,cc,Lc),Array.add(this.lGb,ob))}ZWo(ob){for(let Nb=0;Nb<this.lGb.length;Nb++)if(this.lGb[Nb].CommandId===ob){const cc=this.lGb[Nb].Label;let Lc=!1;if(0<this.Cjb.length){let Uc=0;for(const sd of this.Cjb){if(sd.Label===cc){Array.removeAt(this.Cjb,Uc);Lc=!0;break}Uc++}}!Lc&&this.Cjb.length>=this.A_e-1&&Array.removeAt(this.Cjb,1);Array.insert(this.Cjb,0,this.lGb[Nb])}}}
Pg.FJa=null;Pg.goi=null;Pg.Rsj=null;Object(m.a)(Pg,"FindInDocumentResultsProvider",null,[85]);var bk=d(1762);class Sj{constructor(ob){this.kc=ob}lN(){return"Insights"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc=!1,Lc,Uc=null){Lc=new x.a(ob);if(!Uc||Array.contains(Uc,13))if(this.H5o()||!v.a.yU(ob)){Uc=new z.a(13);var sd=""===ob.Vg.trim(),id=sd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ld=new w.a(id,10,ob.Vg,null,1);cc&&(cc=null,v.a.ota()?sd?sd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:
(sd=this.kc.vxc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ob.Vg),cc=v.a.jUa(ob.Vg,1)):(sd=String.format(CommonUIStrings.l_InsightsButtonText,ob.Vg),cc=v.a.ZMb(ob.Vg)),this.kc.TAa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(id,sd)),cc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",cc))):(ob=[],ob.push(appChrome.actions.setControlLabel(id,sd)),
cc&&ob.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",cc)),appChrome.api.dispatch(ob)),Ld.label=sd);Uc.jy(Ld);Lc.gw(Uc)}Nb.Kt(Lc)}H5o(){return v.a.ota()&&this.kc.Jjp&&!this.kc.Rka}}Object(m.a)(Sj,"InsightsResultsProvider",null,[85]);var gj=d(1760);class Yi{constructor(ob){this.kc=ob}lN(){return"Learning"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc,Lc,Uc=null){cc=new x.a(ob);Uc&&!Array.contains(Uc,21)||!v.a.yU(ob)||(Uc=[],Lc=this.kc.Qzn,Uc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",
Lc)),Lc=Yi.cum(Lc),Uc.push(appChrome.actions.setControlLabel("LearningForSearch",Lc)),appChrome.api.dispatch(Uc),ob=new w.a("LearningForSearch",22,ob.Vg,null,1),Uc=new z.a(21),Uc.jy(ob),cc.gw(Uc));Nb.Kt(cc)}static cum(ob){const Nb=[];Array.add(Nb,new gj.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Nb,new gj.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Nb,new gj.a(600,ob));Array.add(Nb,new gj.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ob={};ob.parts=
Nb;return JSON.stringify(ob)}}Object(m.a)(Yi,"LearningProvider",null,[85]);var Bl=d(617);class Ll{constructor(ob,Nb){this.t8b=this.jbc=this.fkb=this.YGd=null;this.Oy=!1;this.d9b=ob;this.Isk=Nb;ob&&this.omi(ob)}uDe(){this.d9b.uDe()&&this.omi(this.d9b)}pNf(ob){let Nb=[];var cc=[];ob=Ll.NSn(ob);var Lc="";Array.clear(cc);for(let Uc=0;Uc<ob.length;Uc++){const sd=ob.charAt(Uc);-1!==" ".indexOf(sd)?(Lc.length&&Array.add(cc,Lc),Lc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(sd)?(Lc.length&&Array.add(cc,
Lc),Lc=sd,Array.add(cc,Lc),Lc=""):Lc+=sd}Lc.length&&Array.add(cc,Lc);for(ob=0;ob<cc.length;ob++)Lc=this.umm(cc[ob]),Lc=this.RBl(Lc),Nb=Ll.PMn(Nb,Lc);return Nb=this.cZk(Nb)}lZf(){this.Oy||this.uDe();return this.Oy}mZd(ob){return this.YGd[ob.toString()]}cZk(ob){for(let Nb=0;Nb<ob.length;Nb++){const cc=this.fkb[Nb];if(ob[Nb].commandId!==this.mZd(cc[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Lc;(Lc=ob[Nb]).score=Lc.score+cc[1]}return ob}RBl(ob){const Nb=[];for(var cc=0;cc<this.fkb.length;cc++)Nb.push(new el.a(this.mZd(this.fkb[cc][0]),
-5));cc=new Bl.a;for(var Lc=0;Lc<ob.length;Lc++)cc.add(this.mZd(ob[Lc][0]));for(Lc=0;Lc<Nb.length;Lc++){const sd=Nb[Lc];for(let id=0;id<ob.length;id++){var Uc=ob[id];const Ld=this.mZd(Uc[0]);Uc=Uc[1];if(Ld===sd.commandId){sd.score=Uc;cc.remove(Ld);break}}if(!cc.count)break}return Nb}umm(ob){const Nb=1>ob.length;for(let id=0;2>=id;id++){const Ld=this.t8b;for(const ne in Ld){var cc=Ld[ne],Lc=ob,Uc=ne;const kf=Uc.length+1,vg=Array((Lc.length+1)*kf);for(var sd=0;sd<=Lc.length;sd++)vg[sd*kf]=sd;for(sd=
0;sd<=Uc.length;sd++)vg[sd]=sd;for(sd=0;sd<Uc.length;sd++)for(let Sh=0;Sh<Lc.length;Sh++)vg[(Sh+1)*kf+(sd+1)]=Lc.charAt(Sh)===Uc.charAt(sd)?vg[Sh*kf+sd]:Math.min(Math.min(vg[Sh*kf+(sd+1)]+1,vg[(Sh+1)*kf+sd]+1),vg[Sh*kf+sd]+1);Lc=vg[Lc.length*kf+Uc.length];if((!Lc||!Nb)&&Lc<=id)return cc}}return this.jbc}omi(ob){this.YGd=ob.IKf();this.fkb=ob.ZGm();this.jbc=ob.jQm();this.t8b=ob.Dxm();if(this.Oy=!!this.YGd&&!!this.fkb&&!!this.t8b&&!!this.jbc)this.Oy=0<this.fkb.length&&Ll.nWf(this.fkb);this.Oy&&(this.Oy=
0<this.jbc.length&&Ll.nWf(this.jbc));this.Oy&&(this.t8b=Ll.ZQm(this.t8b));this.Oy||(this.t8b=this.jbc=this.fkb=this.YGd=null)}pPm(ob){ob=this.pNf(ob);return this.T7l(ob,this.Isk)}T7l(ob,Nb){let cc=[];for(let Lc=0;Lc<ob.length;Lc++)ob[Lc].score>=Nb&&cc.push(ob[Lc]);cc.sort((Lc,Uc)=>Lc.score<Uc.score?1:Lc.score>Uc.score?-1:0);0<cc.length-10&&(cc=cc.slice(0,10));return cc}static PMn(ob,Nb){if(!ob.length)return Nb;if(ob.length!==Nb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let cc=0;cc<ob.length;cc++){if(ob[cc].commandId!==Nb[cc].commandId)throw Error.create("Incorrect CommandId");let Lc;(Lc=ob[cc]).score=Lc.score+Nb[cc].score}return ob}static NSn(ob){return Hf.a.xh(ob)}static nWf(ob){for(let Nb=0;Nb<ob.length;Nb++)if(2!==ob[Nb].length)return!1;return!0}static ZQm(ob){const Nb={};for(const Uc in ob){var cc=Uc,Lc=ob[Uc];const sd=Lc;sd.length&&Ll.nWf(sd)&&(Nb[cc]=Lc)}return Nb}}Object(m.a)(Ll,"NaiveBayesClassifierModel",null,[]);class fn{constructor(ob,Nb){this.bwa=
null;this.kc=ob;this.ILc=new Ll(Nb,ob.cBm);this.kc.MKb&&(this.bwa=null)}lN(){return"NBCommand"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc=!1,Lc=f.a.mu,Uc=null){const sd=new x.a(ob);if((!Uc||Array.contains(Uc,0))&&!v.a.yU(ob)){if(pd.CommandResultsUtility.IWf(ob.Vg)&&(Uc=pd.CommandResultsUtility.evi(ob.Vg),0<Uc.results.length)){Uc.displayName="Classifier Debug";sd.gw(Uc);Nb.Kt(sd);return}if(!this.ILc.lZf()){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");
throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.kc.MKb&&this.bwa&&this.bwa.initialize();Uc=this.ILc.pPm(ob.Vg);pd.CommandResultsUtility.Jhe(Uc,!1,"Classifier","NaiveBayesian");Uc=pd.CommandResultsUtility.o4c(ob,Uc,this.kc,this.bwa,null,null,0,1);0<Uc.results.length&&Lc!==f.a.contextMenu&&(Uc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);cc||Uc.results.length||this.kc.Y2||this.kc.reb||(ob=new w.a("lookupNoResults",14,ob.Vg,null,1),Uc.jy(ob));0<Uc.results.length&&
sd.gw(Uc)}Nb.Kt(sd)}}Object(m.a)(fn,"NaiveBayesCommandProvider",null,[85]);class Yn{constructor(){this.iGb=null;this.Oy=!1;this.uDe()}uDe(){this.Oy||(this.iGb=window.NBCRM)&&4===this.iGb.length&&(this.Oy=!0);return this.Oy}ZGm(){return this.Oy?this.iGb[1]:null}jQm(){return this.Oy?this.iGb[2]:null}Dxm(){return this.Oy?this.iGb[3][0]:null}IKf(){return this.Oy?this.iGb[0][0]:null}}Object(m.a)(Yn,"NaiveBayesModelAdapter",null,[1812]);var Tl=d(134);class jm{constructor(ob){this.kc=ob}lN(){return"OfficeScript"}gX(){return 0===
this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb){const cc=new x.a(ob);if(!v.a.yU(ob)){ob=Tl.d(ob.Vg);var Lc=new z.a(28);Lc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Lc=this.cOh(ob,jm.ntp,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Lc);Lc=this.cOh(ob,jm.Ydm,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Lc);cc.gw(Lc)}Nb.Kt(cc)}cOh(ob,Nb,cc,Lc,Uc,sd){const id=[];for(const Ld of Nb)if(Tl.a(ob,Ld)){this.kc.TAa?
(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(cc,Uc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(cc,Lc))):(id.push(appChrome.actions.setControlLabel(cc,Uc)),id.push(appChrome.actions.setButtonCommandValueId(cc,Lc)),appChrome.api.dispatch(id));sd.jy(new w.a(cc,28,null,null,1));break}return sd}}jm.ntp="unhide row rows col cols column columns".split(" ");jm.Ydm=["freeze","selection","pane","panes"];Object(m.a)(jm,"OfficeScriptsSamplesProvider",
null,[85]);var Kk=d(71),gn=d(354),io=d(1513),rl=d(1465),vm=d(1512),Lj=d(29),wm=d(118),aj=d(1393);class sl{constructor(ob){this.gT=null;this.i5=-1;this.y7f=14;this.B7f=12;this.attributes=this.Qaf=this.query=null;this.Boc=!1;this.l$b=[];this.If=Yg.AFrameworkApplication.Fe;Yg.AFrameworkApplication.J&&(this.y7f=Yg.AFrameworkApplication.J.jc("TellMeMaxTermedResults",this.y7f),this.B7f=Yg.AFrameworkApplication.J.jc("TellMeMaxZeroTermResults",this.B7f));this.IU=ob}get ep(){return this.l$b}get $De(){return this.Qaf}gw(ob){let Nb=
!1;for(let cc=0;cc<this.ep.length;cc++)if(30!==this.ep[cc].groupType&&this.ep[cc].groupType===ob.groupType){this.uef(this.ep[cc],ob);Nb=!0;break}Nb||this.ep.push(ob)}uef(ob,Nb){for(let cc=0;cc<Nb.results.length;cc++)ob.jy(Nb.results[cc])}SCj(ob){const Nb=[];for(const cc of this.ep)cc.groupType!==ob&&Nb.push(cc);this.ep.length!==Nb.length&&(this.l$b=Nb)}kAo(ob){let Nb=null,cc=null,Lc=null;for(let Uc=0;Uc<ob.length;Uc++){const sd=ob[Uc];if(sd&&sd.ep&&sd.ep.length)for(const id of sd.ep)if(17===id.groupType||
18===id.groupType)Nb=id;else if(0===id.groupType||16===id.groupType)cc=id,Lc=sd}Nb&&cc&&0<cc.results.length&&(17===Nb.groupType&&({Mdf:cc,Jef:Nb}=pd.CommandResultsUtility.gXk(cc,Nb,this.IU.yR()?this.IU.yR().Olm:-.6)),Lc.SCj(cc.groupType))}kbp(){this.IU&&(new Kk.a,this.Opd(this.IU.vbj))}R$c(ob,Nb){return this.query.Vg.length>this.IU.yR().IHm&&this.tqn(ob,Nb)||this.query.Vg.length>this.IU.yR().JHm&&this.utn(ob,Nb)?!0:!1}utn(ob,Nb){return ob&&ob.length&&Nb&&Nb.length?-1===Nb.toLowerCase().indexOf(ob.toLowerCase())?
!1:!0:!1}tqn(ob,Nb){return ob&&ob.length&&Nb&&Nb.length?Nb.toLowerCase().startsWith(ob.toLowerCase()):!1}e8l(ob){const Nb=[];for(const cc of this.IU.yR().oS?this.$De:this.ep)ob.contains(cc.groupType)||Nb.push(cc);this.IU.yR().oS?this.Qaf=Nb:this.l$b=Nb}tAp(ob,Nb){const cc=[];for(const Lc of this.ep){const Uc=Lc;if(13!==Uc.groupType||24!==Uc.groupType){const sd=ob[rl.a[Uc.groupType].toLowerCase()];let id="False";sd<Nb&&(id="True");Uc.displayName=Uc.displayName+" ("+id+": "+sd+")"}cc.push(Uc)}this.l$b=
cc}Opd(ob,Nb=!1,cc=null){if(this.IU.yR().oS){if(!Nb)for(this.Qaf=Array(this.ep.length),Nb=0;Nb<this.ep.length;Nb++)this.$De[Nb]=this.ep[Nb];this.IU.Bbj.Opd(this.ep,this.$De,this.query,ob,cc)}else{for(cc=new Kk.a;this.ep.length;){Nb=this.ep.pop();const Lc=rl.a[Nb.groupType].toLowerCase(),Uc=ob[Lc];if(aj.c(Uc))throw Error.create("GroupId "+Lc+" missed from group SortingOrder");cc.add(new gn.a(Uc,Nb))}cc.Sc((Lc,Uc)=>Lc.key<Uc.key?-1:1);for(ob=0;ob<cc.count;ob++)Nb=cc.K(ob).value,this.ep.push(Nb)}}lbp(){var ob=
!1;let Nb=!1,cc=!1;for(let Uc=0;Uc<this.ep.length;Uc++){var Lc=this.ep[Uc];const sd=Lc.groupType;if(8===sd||15===sd||14===sd){Lc=Lc.results;for(let id=0;id<Lc.length;id++){if(8===sd&&this.R$c(this.query.Vg,Lc[id].label)){ob=!0;break}if(15===sd&&this.R$c(this.query.Vg,Lc[id].label)){Nb=!0;break}if(14===sd){if(this.R$c(this.query.Vg,Lc[id].label)||this.R$c(this.query.Vg,Lc[id].description)){cc=!0;break}const Ld=Lc[id].label.split(" ");for(const ne of Ld)if(this.R$c(this.query.Vg,ne)){cc=!0;break}}}}}ob=
this.IU.wJm(ob,Nb,cc);this.Opd(ob)}RWb(ob,Nb,cc,Lc,Uc,sd){if(Uc===this.gT){var id=ob.data.Pe;Uc=null;try{Uc=Lj.b(id)}catch(ni){u.TellMeActor.instance.Ye.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+ni);return}if("RankerResults"in Uc&&Uc.RankerResults){this.iIa();var Ld=Uc.RankerResults,ne=new Kk.a,kf=new Kk.a;id=0;for(var vg of Ld){Ld=vg.ProviderId;var Sh=vg.Score;id+=Sh;ne.add(new gn.a(Ld,Sh))}ne.Sc((Ee,hh)=>Ee.value>hh.value?-1:1);Sh=sd?sd.pGi:1E-6;
vg={};Ld={};let ni=0;for(var Ei=0;Ei<ne.count;Ei++){const Ee=parseInt(ne.K(Ei).key),hh=ne.K(Ei).value/id;1===Ee&&(Ld.answer=ni++,Ld.entity=ni++,Ld.definition=ni++,Ld.wolframanswer=ni++,hh<Sh&&(kf.add(9),kf.add(11),kf.add(10),kf.add(12)),vg.answer=hh,vg.entity=hh,vg.definition=hh,vg.wolframanswer=hh);2===Ee&&(Ld.assistance=ni++,hh<Sh&&kf.add(8),vg.assistance=hh);3===Ee&&(Ld.classifier=ni++,Ld.serviceclassifier=ni++,hh<Sh&&(kf.add(0),kf.add(17)),vg.classifier=hh,vg.serviceclassifier=hh);4===Ee&&(Ld.people=
ni++,hh<Sh&&kf.add(14),vg.people=hh);5===Ee&&(Ld.document=ni++,hh<Sh&&kf.add(15),vg.document=hh);6===Ee&&(Ld.findindocument=ni++,hh<Sh&&kf.add(2),vg.findindocument=hh);7===Ee&&(Ld.notes=ni++,hh<Sh&&kf.add(20),vg.notes=hh);8===Ee&&(Ld.image=ni++,hh<Sh&&kf.add(19),vg.image=hh)}ne=new Kk.a;ne.add("classifier");ne.add("serviceclassifier");ne.add("appsforoffice");ne.add("addin");ne.add("findindocument");ne.add("assistance");ne.add("document");ne.add("people");ne.add("answer");ne.add("wolframanswer");ne.add("definition");
ne.add("entity");ne.add("image");ne.add("template");ne.add("officescript");for(Ei=0;Ei<ne.count;Ei++)ne.K(Ei)in Ld||(Ld[ne.K(Ei)]=ni++);Ld.learning=ni++;Ld.insights=ni++;Ld.actionai=ni++;Ld.actionaicommand=ni++;Ld.feedback=ni++;sd&&sd.WZi&&this.tAp(vg,Sh);sd&&sd.XZi&&this.e8l(kf);kf={};for(var pj in vg)kf[pj]=vg[pj]*id;this.Opd(Ld,!0,kf)}if(sd.ofe&&"Intents"in Uc&&Uc.Intents){pj=Uc.Intents;for(var Ed of pj)if(this.P0f(Ed)&&"Serplet"===Ed.GroupType&&Ed.ConfidenceScore>Ed.ConfidenceThreshold){pj=!1;
Uc=0;if(sd.pfe){id=new w.a("",32);for(kf=0;kf<this.ep.length;kf++)if((ne=this.ep[kf].results)&&0<ne.length){Uc=kf;id=ne[0];break}2===id.groupType&&(pj=!0)}id=new z.a(13);pj&&sd.pfe&&(id=new z.a(13,CommonUIStrings.l_TellMeWebTitle));kf=new w.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Vg,null,0);ne=[];vg=null;vg=v.a.ota()?v.a.jUa(this.query.Vg,1):v.a.ZMb(this.query.Vg);ne.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",vg));vg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,
this.query.Vg);ne.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",vg));appChrome.api.dispatch(ne);id.jy(kf);kf=[];if(pj&&sd.pfe)for(kf.push(this.ep[Uc]),kf.push(id),pj=Uc+1;pj<this.ep.length;pj++)(Uc=this.ep[pj].results)&&0<Uc.length&&kf.push(this.ep[pj]);else for(kf.push(id),pj=0;pj<this.ep.length;pj++)(Uc=this.ep[pj].results)&&0<Uc.length&&kf.push(this.ep[pj]);this.l$b=kf}}if(sd.aad&&!sd.oS){Ed=pj=-1;for(Uc=0;Uc<this.ep.length;Uc++)switch(this.ep[Uc].groupType){case 23:pj=
Uc;break;case 0:case 17:case 2:-1===Ed&&(Ed=Uc)}if(-1!==pj){Ed=-1===Ed?0:pj>Ed?Ed+1:Ed;pj=this.ep[pj];Uc=Array(this.ep.length);id=0;for(kf=0;kf<Uc.length;kf++)kf===Ed?Uc[kf]=pj:(23===this.ep[id].groupType&&id++,Uc[kf]=this.ep[id],id++);this.l$b=Uc}}Lc.Kt(this);Lc=u.TellMeActor.instance.Ye;Lc.Lba(Nb.length,"RankerInference",ob.data.He.toString(),Math.round(window.performance.now()-cc),vm.a.M_j,!0,io.a.iWa);this.Boc&&Lc&&(ob=this.query.Swb,Nb=Lc.Xyd,sd.Jfe&&ob>Nb&&!sd.oS&&(Lc.F5f(this.query.Vg),Lc.Mxg(ob)))}}P0f(ob){if("GroupType"in
ob&&ob.GroupType&&"ConfidenceScore"in ob&&"ConfidenceThreshold"in ob)return!0;u.TellMeActor.instance.Ye.onError("IsValidIntentGroup","Invalid intents found");return!1}EWb(ob,Nb,cc,Lc,Uc){Lc===this.gT&&(this.iIa(),u.TellMeActor.instance.Ye.Lba(Nb.length,"RankerInference",ob.data.He.toString(),Math.round(window.performance.now()-cc),vm.a.M_j,!1,io.a.iWa));Uc.Kt(this)}iIa(){-1!==this.i5&&(window.clearTimeout(this.i5),this.i5=-1)}mbp(ob){let Nb;Nb=this.IU.yR().oS?u.TellMeActor.instance.Ye.nNf(this.$De,
this.query.Vg):u.TellMeActor.instance.Ye.nNf(this.ep,this.query.Vg);var cc=this.IU.yR().oGi;""!==cc&&(cc="_"+cc);let Lc="";this.IU.yR().ree&&(Lc="RankerInference"+cc+",");this.IU.yR().ofe&&(Lc+="SerpletClassifier");","===Lc.charAt(Lc.length-1)&&(Lc=Lc.substring(0,Lc.length-1));cc=u.TellMeActor.instance.Ye.bIi(Lc);const Uc=this.gT=wm.a.create().toString();cc["Client-Request-Id"]=Uc;const sd=window.performance.now(),id=this.IU.yR()?this.IU.yR().qGi:600;this.iIa();this.i5=window.setTimeout(()=>{if(Uc===
this.gT){this.gT="";this.i5=-1;ob.Kt(this);const Ld={};Ld[a.a.provider]="Ranker";Ld[a.a.nYb]=this.query.Swb;u.TellMeActor.instance.Ye.gC(l.a.jHg,id,Ld)}},id);this.If.Xj(u.TellMeActor.instance.Ye.cIi(),2,Nb,cc,!1,0,Ld=>{this.RWb(Ld,this.query.Vg,sd,ob,Uc,this.IU.yR())},Ld=>{this.EWb(Ld,this.query.Vg,sd,Uc,ob)},null,null,!1,4E3,6E3)}xpp(){var ob=0,Nb=new Kk.a,cc=this.IU.tbj,Lc=this.IU.ubj;for(var Uc=0;Uc<this.ep.length;Uc++){var sd=this.ep[Uc],id=rl.a[sd.groupType].toLowerCase(),Ld=cc[id];ob+=sd.results.length;
sd.results.length>Ld&&(id=Lc[id],aj.c(id)||Nb.add(new gn.a(id,sd)))}Lc=!this.query||""===this.query.Vg.trim();Uc=ob-(Lc?this.B7f:this.y7f);if(!(0>=Uc)){Lc=window.performance.now();ob=ob.toString()+" total,"+Uc.toString()+" to remove.";if(0<Nb.count)for(Nb.Sc((ne,kf)=>ne.key>kf.key?-1:1),sd=0;sd<Nb.count&&0<Uc;sd++){id=Nb.K(sd).value;Ld=rl.a[id.groupType].toLowerCase();let ne=id.results.length-cc[Ld];ne>Uc&&(ne=Uc);0<ne&&(id.hrg(ne),ob+=Ld+": "+ne.toString()+" results removed.",Uc-=ne)}if(0<Uc){ob+=
Uc.toString()+" results left after trimming.";Nb=new Kk.a;cc=this.IU.ybj;for(sd=0;sd<this.ep.length;sd++)id=this.ep[sd],Ld=cc[rl.a[id.groupType].toLowerCase()],aj.c(Ld)||Nb.add(new gn.a(Ld,id));Nb.Sc((ne,kf)=>ne.key<kf.key?-1:1);for(cc=0;0<Uc;)sd=Nb.K(cc++).value,Uc>=sd.results.length?(Array.remove(this.ep,sd),ob+=rl.a[sd.groupType]+": "+sd.results.length.toString()+" results force removed.",Uc-=sd.results.length):(sd.hrg(Uc),ob+=rl.a[sd.groupType]+": "+Uc.toString()+" results force removed.",Uc=
0)}u.TellMeActor.instance.Ye&&(Nb={},Nb[a.a.message]=ob,u.TellMeActor.instance.Ye.gC("ShowOptimal",window.performance.now()-Lc,Nb))}}}Object(m.a)(sl,"CombineResultsUpdatedEventArgs",null,[1809]);class yi{constructor(ob,Nb,cc,Lc=!1,Uc=""){this.Z2e=this.P5e=!1;this.ww=ob;this.THb=[];this.xAh=Nb.length;this.kc=u.TellMeActor.instance.yR();this.$Ed=Lc;this.Dja=Uc;this.Dac={};for(ob=0;ob<Nb.length;++ob)this.Dac[ob.toString()]=cc?0:Nb[ob].gX()}YYo(ob,Nb){Nb&&Nb.query&&Nb.query.Swb<u.TellMeActor.instance.Exa||
(this.THb[ob]=Nb,this.Z2e?this.P5e=!0:(!this.kc||3!==this.kc.kw||3!==this.Dac[ob.toString()]||this.Hfi())&&this.ISb())}cbo(){this.Z2e=!0}Ftp(){this.Z2e=!1;this.P5e&&(this.P5e=!1,this.ISb())}Hfi(){if(this.THb.length<this.xAh)return!1;for(let ob=0;ob<this.xAh;++ob)if(!this.THb[ob])return!1;return!0}ISb(){var ob=this.Hfi();const Nb=window.performance.now(),cc=new sl(u.TellMeActor.instance.Yjh);cc.kAo(this.THb);for(var Lc=0;Lc<this.THb.length;++Lc){var Uc=this.THb[Lc];if(Uc&&Uc.ep&&Uc.ep.length&&(cc.query=
Uc.query,Uc.attributes&&0<Uc.attributes.length&&(cc.attributes=Uc.attributes),Uc&&Uc.ep&&(ob||this.nql(Lc,this.THb))))for(const sd of Uc.ep)cc.gw(sd)}cc.ep&&cc.ep.length&&(cc.Boc=ob,this.kc&&this.kc.gDe&&cc.xpp(),this.kc&&this.kc.Krn&&cc.query.Vg&&0<cc.query.Vg.length?cc.lbp():cc.kbp(),this.kc&&(this.kc.ree||this.kc.ofe)&&this.$Ed&&cc.query.Vg&&0<cc.query.Vg.length&&cc.Boc&&this.Dja!==f.a.contextMenu?(3===this.kc.kw&&ob||this.ww.Kt(cc),cc.mbp(this.ww)):this.ww.Kt(cc),ob=u.TellMeActor.instance.Ye,
cc.Boc&&ob&&(Lc=cc.query.Swb,Uc=ob.Xyd,cc.query.Vg&&0<cc.query.Vg.length&&this.$Ed&&this.kc.Jfe&&this.Dja!==f.a.contextMenu&&Lc>Uc&&!this.kc.ree&&!this.kc.oS&&(ob.F5f(cc.query.Vg),ob.Mxg(Lc)),ob.gC(l.a.DIo,window.performance.now()-Nb)))}nql(ob,Nb){if(!(this.Dac&&ob.toString()in this.Dac)||Nb.length<=ob||!Nb[ob])return!1;if(!Nb[ob].ep.length)return!0;const cc=this.Dac[ob.toString()];if(0===cc)return!0;const Lc=this.Dac;for(const sd in Lc){var Uc=Lc[sd];const id=Number.parseInvariant(sd);if(id!==ob&&
Uc===cc&&!(Nb.length>id&&Nb[id]))return!1}return!0}}Object(m.a)(yi,"ResultsAggregator",null,[]);var Dk=d(1797);class fi{constructor(){this.Izc=this.Jzc=this.Hzc=this.Wbd=this.Oqc=this.Vmc=0}NWk(ob,Nb){switch(ob){case 1:this.Vmc=Nb;break;case 3:this.Oqc=Nb;break;case 2:this.Wbd=Nb;break;case 5:this.Hzc=Nb;break;case 4:this.Jzc=Nb;break;case 6:this.Izc=Nb}}}Object(m.a)(fi,"CommandFeatures",null,[]);class Dg{constructor(ob){this.phh=0;this.nGa=ob;this.Tqk={}}get modelId(){return this.nGa}get p6l(){return this.phh}get MVc(){return this.Tqk}EVk(ob,
Nb,cc){0===Nb?this.phh=cc:(this.MVc[ob]||(this.MVc[ob]=new fi),this.MVc[ob].NWk(Nb,cc))}}Object(m.a)(Dg,"CoefficientsModel",null,[]);const yk=(ob,Nb)=>Math.pow(10,-Nb/(60*Math.LN10/Math.LN2*ob));class Ym{constructor(ob,Nb){this.Pk=1;this.uvk=new fi;this.features.Wbd=1+Math.log(this.count)/Math.LN2;this.features.Vmc=ob?1/ob:0;this.features.Oqc=2/Math.pow(2,ob);this.features.Hzc=yk(10,Nb);this.features.Jzc=yk(2,Nb);this.features.Izc=yk(1,Nb)}get count(){return this.Pk}get features(){return this.uvk}nQi(){this.Pk=
this.count+1;this.features.Wbd=1+Math.log(this.count)/Math.LN2}iAp(ob){const Nb=2/Math.pow(2,ob);this.features.Vmc=Math.max(this.features.Vmc,ob?1/ob:0);this.features.Oqc=Math.max(this.features.Oqc,Nb)}FBp(ob){const Nb=yk(10,ob),cc=yk(2,ob);ob=yk(1,ob);this.features.Hzc=Math.max(this.features.Hzc,Nb);this.features.Jzc=Math.max(this.features.Jzc,cc);this.features.Izc=Math.max(this.features.Izc,ob)}}Object(m.a)(Ym,"CommandModel",null,[]);class we{constructor(ob){this.MEc=null;if(!ob&&u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("PredictionEngine",
"IModelAdapter can't be null");this.d9b=ob;this.XGd=this.C4f()}C4f(){const ob=this.d9b.wAm(),Nb=this.d9b.IKf();if(void 0===ob||null===ob||void 0===Nb||null===Nb)return!1;try{window.performance.now();this.MEc={};for(let cc=0;cc<ob.length;cc++){const Lc=ob[cc],Uc=Nb[Lc[0].toString()].trim(),sd=Lc[1],id=0!==sd?Nb[Lc[2].toString()].trim():"",Ld=Lc[3];Uc in this.MEc||(this.MEc[Uc]=new Dg(Uc));this.MEc[Uc].EVk(id,sd,Ld)}}catch(cc){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("LoadModelData",
"Error Loading Suggestions Model: "+cc);return!1}return!0}$em(){const ob=this.d9b.Vwm(),Nb={};if(!ob)return Nb;let cc=1;for(let Lc=0;Lc<ob.length;Lc++){const Uc=ob[Lc];Uc.Id in Nb?(Nb[Uc.Id].nQi(),Nb[Uc.Id].iAp(cc),Nb[Uc.Id].FBp(Uc.TimeElapsedSinceClick)):Nb[Uc.Id]=new Ym(cc,Uc.TimeElapsedSinceClick);cc++}return Nb}lZf(){this.XGd||(this.XGd=this.C4f());return this.XGd}lGm(){let ob=[];if(!this.XGd){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictedCommands","IModelAdapter returned no data");
return ob}const Nb=this.$em(),cc=this.MEc;for(const Uc in cc){const sd=cc[Uc],id=sd.modelId;let Ld=0;for(const ne in Nb){var Lc=ne;const kf=Nb[ne].features;(Lc=Lc in sd.MVc?sd.MVc[Lc]:null)&&(Ld+=kf.Vmc*Lc.Vmc+kf.Oqc*Lc.Oqc+kf.Wbd*Lc.Wbd+kf.Hzc*Lc.Hzc+kf.Jzc*Lc.Jzc+kf.Izc*Lc.Izc)}Ld+=sd.p6l;ob.push(new el.a(id,Ld))}ob.sort((Uc,sd)=>Uc.score<sd.score?1:Uc.score>sd.score?-1:0);0<ob.length-10&&(ob=ob.slice(0,10));return ob}}Object(m.a)(we,"PredictionEngine",null,[]);class ri{constructor(){this.DDh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}a5d(ob,Nb){return Nb&&"word"===Nb.application.toLowerCase()&&
ob in this.DDh?this.DDh[ob]:[]}}Object(m.a)(ri,"SuggestionResultsUtility",null,[]);class Tj{constructor(ob,Nb,cc){this.kc=Nb;this.ILc=new we(ob);this.G5=cc;this.yGh=new ri}lN(){return"Suggestion"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:2}XJ(ob,Nb,cc,Lc=f.a.mu,Uc=null){cc=new x.a(ob);u.TellMeActor.instance.ztd=!1;if((!Uc||Array.contains(Uc,16))&&v.a.yU(ob)){if(!this.ILc.lZf()){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.hfe()&&0<this.yGh.a5d(u.TellMeActor.instance.XYd,this.kc).length){const id=this.yGh.a5d(u.TellMeActor.instance.XYd,this.kc);Uc=[];for(var sd of id)this.kc.Hye&&"Find"===sd||Uc.push(new el.a(sd,0));u.TellMeActor.instance.ztd=!0}else Uc=this.ILc.lGm();pd.CommandResultsUtility.Jhe(Uc,!0,"Recommended","LRE");sd=[];for(const id of Uc)this.G5&&this.G5.qqf(id.commandId)||sd.push(id);ob=pd.CommandResultsUtility.o4c(ob,
sd,this.kc,null,null,null,16,1);0<ob.results.length&&Lc!==f.a.contextMenu&&(ob.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ob.results.length&&cc.gw(ob)}Nb.Kt(cc)}hfe(){return!!this.kc&&(this.kc.hfe||this.kc.lwn)}}Object(m.a)(Tj,"SuggestionResultsProvider",null,[85]);class vf{Vwm(){return u.TellMeActor.instance.OMe}wAm(){return window.TellMeSuggestionModel}IKf(){return window.CoefficientModelIdMap}}Object(m.a)(vf,"SuggestionsModelAdapter",null,[1811]);var ff=d(1808),Kf=d(1763);d.d(J,"AggregatorResultsProvider",
function(){return Rg});class Rg{constructor(ob=!1){this.Z9b={};this.Z9b[f.a.mu]=[];this.Z9b[f.a.contextMenu]=[];this.$Ed=ob}l4i(ob,Nb,cc,Lc,Uc=null){let sd;var id=!1;switch(Lc){case f.a.contextMenu:sd=this.Z9b[f.a.contextMenu];id=!0;break;default:sd=this.Z9b[f.a.mu]}Nb=new yi(Nb,sd,id,this.$Ed,Lc);Nb.cbo();for(let Ld=0;Ld<sd.length;++Ld){const ne=window.performance.now(),kf=new F(Nb,Ld);(id=u.TellMeActor.instance.yR())&&id.kfl?window.setTimeout(()=>{sd[Ld].XJ(ob,kf,cc,Lc,Uc);if(u.TellMeActor.instance.Ye){const vg=
{};vg[a.a.provider]=sd[Ld].lN();vg[a.a.nYb]=ob.Swb;u.TellMeActor.instance.Ye.gC(l.a.XJ,window.performance.now()-ne,vg)}},0):(sd[Ld].XJ(ob,kf,cc,Lc,Uc),u.TellMeActor.instance.Ye&&(id={},id[a.a.provider]=sd[Ld].lN(),id[a.a.nYb]=ob.Swb,u.TellMeActor.instance.Ye.gC(l.a.XJ,window.performance.now()-ne,id)))}Nb.Ftp()}lN(){return"Aggregator"}gX(){return 0}XJ(ob,Nb,cc=!1,Lc=f.a.mu,Uc=null){if(u.TellMeActor.instance.KOn)this.l4i(ob,Nb,cc,Lc,Uc);else{const sd=window.performance.now();u.TellMeActor.instance.AGp.then(()=>
{u.TellMeActor.instance.Ye&&u.TellMeActor.instance.Ye.gC(l.a.LOn,window.performance.now()-sd);this.l4i(ob,Nb,cc,Lc,Uc);return!0})}}NG(ob,Nb){this.Z9b[Nb].push(ob)}$Xk(ob){switch(ob){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Nb=this.Z9b[f.a.mu];for(const cc of Nb)if("FindInDocument"===cc.lN()){cc.ZWo(ob);break}}}static createInstance(ob,Nb,cc,Lc){const Uc=Nb.Rka;var sd=Lc&&v.a.zAg(Nb),id=sd&&Nb.Kgg&&!Uc;const Ld=Nb.w0f&&!v.a.Woc()&&!Uc,ne=Nb.BZf&&
!Uc,kf=new Rg(sd);if(Nb.I5o&&!Uc){var vg=new Yi(Nb);kf.NG(vg,f.a.mu)}vg=Nb.Bs?Yg.AFrameworkApplication.J.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):Yg.AFrameworkApplication.J.$("TellMeSuggestionsIsEnabled");const Sh=!vg&&Yg.AFrameworkApplication.J.$("TellMeFirstRunExperienceIsEnabled");kf.NG(new Mf.a(ob,Nb.Drp,Sh,!1),f.a.mu);vg&&!Uc&&kf.NG(new Tj(new vf,Nb,ob),f.a.mu);ob=Yg.AFrameworkApplication.ua.Gb.M2i?new fn(Nb,new Yn):new rh(Nb,cc);kf.NG(ob,f.a.contextMenu);(sd&&Nb.Lgg||id)&&kf.NG(ff.a.Xai(Nb,
!0),f.a.mu);kf.NG(ob,f.a.mu);!Nb.boi||Uc||"Word"===Nb.application&&Nb.M2d||kf.NG(new Pg(Nb),f.a.mu);Nb.MKb&&!Uc&&(id=new G(Nb),kf.NG(id,f.a.mu),kf.NG(id,f.a.contextMenu));!Nb.QKb||Nb.Uod||Nb.Tod||Uc||kf.NG(new K.a(Nb),f.a.mu);Lc&&(Nb.Y2||v.a.ota())&&(id=new Sj(Nb),kf.NG(id,f.a.mu),kf.NG(id,f.a.contextMenu));sd&&kf.NG(ff.a.Xai(Nb,!1),f.a.mu);Lc&&!Nb.IEg&&v.a.yAg(Nb)&&!Uc&&(kf.NG(new Dk.a(Nb),f.a.mu),Nb.YYj&&kf.NG(new Dk.a(Nb),f.a.contextMenu));Ld&&kf.NG(new mi(Nb),f.a.mu);!Nb.Bxc&&!Nb.oS||Uc||kf.NG(new bk.a(Nb),
f.a.mu);Nb.aad&&!Uc&&kf.NG(new Kf.a(Nb),f.a.mu);Nb.bWf&&(sd=new y(Nb),kf.NG(sd,f.a.mu),kf.NG(sd,f.a.contextMenu));Lc&&Nb.yce&&!Uc&&kf.NG(new H.AddinResultsProvider(Nb),f.a.mu);ne&&"Excel"===Nb.application&&!Uc&&kf.NG(new jm(Nb),f.a.mu);return kf}}Object(m.a)(Rg,"AggregatorResultsProvider",null,[85])},1793:function(I,J,d){I=d(0);var m=d(59),f=d(13),a=d(5),l=d(177),w=d(224),z=d(364);d(48);var x=d(80);d(888);d(889);var u=d(485);d(486);var v=d(1751),D=d(1752),y=d(1748),H=d(1750),F=d(1749);d(887);d(886);
class G{constructor(aa,Y,da){this.tem=aa;this.rcl=Y;this.hol=da}}Object(I.a)(G,"BacktraceAndMakeUpdateHintsInput",null,[]);var K=d(1494),R;(function(aa){aa[aa.YNp=0]="EOP";aa[aa.character=1]="character";aa[aa.x_p=2]="embeddedMarker"})(R||(R={}));Object(I.b)("LCSBlockType",R);class E{toString(){return String.format("[Type: {0}]",R[this.type])}}Object(I.a)(E,"ALCSBlock",null,[]);class N extends E{constructor(aa,Y){super();this.WLe=Y;this.J2e=aa}get type(){return 1}get character(){return this.WLe}get TYa(){return this.J2e}aC(aa){return 1===
aa.type&&K.a.MTh(aa.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(I.a)(N,"CharacterLCSBlock",E,[]);class O extends E{constructor(aa,Y,da){super();this.J2e=aa;this.mcf=Y;this.wG=da}get type(){return 0}get ed(){return this.mcf}get length(){return this.wG}get TYa(){return this.J2e}aC(aa){return 0!==aa.type?!1:aa.TYa===this.TYa&&aa.ed===this.ed}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),
this.TYa.toString(),this.ed,this.length)}}Object(I.a)(O,"EOPLCSBlock",E,[]);class U extends N{constructor(aa,Y,da){super(aa,"\ufffc");this.tEk=Y;this.DBd=da}get type(){return 2}get pe(){return this.tEk}get Hk(){return this.DBd}aC(aa){return 2!==aa.type?!1:aa.pe===this.pe&&this.Hk.equals(aa.Hk)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.pe,this.Hk)}}Object(I.a)(U,"EmbeddedMarkerLCSBlock",N,[]);class X{constructor(aa,Y){this.x=aa;this.y=Y}equals(aa){return aa.x===
this.x&&aa.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(I.a)(X,"IntPair",null,[1133]);var V=d(1550),Q=d(1519),T=d(1552),ba=d(1747);d.d(J,"a",function(){return W});class W{constructor(aa,Y){this.xg=aa;this.fe=Y}gbi(aa,Y,da,ka,qa,ua,Pa){return this.xLl(aa,Y,da,ka,qa,ua,Pa)}xLl(aa,Y,da,ka,qa,ua,Pa){let Ja;Ja=null;({returnValue:aa}=this.L6d(aa,Y));if(!aa)return l.a.instance.Ua(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.fe.logger.KX("GetLCSBlocksFromObject"),
{returnValue:!1,pK:Ja};({returnValue:da}=this.L6d(da,ka));if(!da)return l.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.fe.logger.KX("GetLCSBlocksFromObject"),{returnValue:!1,pK:Ja};this.fe.logger.KX("GetLCSBlocksFromObject");Ja=this.wLl(aa,da,qa,ua,Pa);return Ja?{returnValue:!0,pK:Ja}:(l.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,pK:Ja})}Rni(aa,Y,da,ka){({returnValue:aa}=this.L6d(aa,Y));if(!aa)return-1;({returnValue:da}=this.L6d(da,
ka));if(!da)return-1;({yuf:da}=this.Vni(aa,da));return da}L6d(aa,Y){let da;const ka=new w.a;da=new w.a;if(!aa.length)return l.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.fe.logger.Oi(Object.assign(new V.a,{gk:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,rAf:da};for(let Pa=0;Pa<aa.length;Pa++)if(this.fe.runtime.$I("GetLCSBlocksFromObject: paraObjs#"+Pa),aa.K(Pa).sc===m.a.paragraphNode){const Ja=this.xg.getPropertyString(aa.K(Pa),f.a.zn),Ca=this.xg.getPropertyUint32(aa.K(Pa),
a.a.ed);if(null==Ca)return l.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.fe.logger.Oi(Object.assign(new V.a,{gk:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,rAf:da};let ra=this.xg.getPropertyUint32s(aa.K(Pa),f.a.An);ra=Q.a.rPj(ra,Ja.length);const Ea=this.xg.getPropertyObjectIds(aa.K(Pa),f.a.Sn);let xa;for(xa=0;xa<ra.length-1;xa++){var qa=Y(Ea.ug(xa)),ua=void 0;ua=qa?(ua=this.xg.getPropertyBool(qa,f.a.Mca))?ua:!1:!1;if(ua)ka.add(this.CFl(aa.K(Pa).id,qa));
else for(qa=ra.ug(xa);qa<ra.ug(xa+1);qa++)ka.add(new N(aa.K(Pa).id,K.a.charAt(Ja,qa)))}ka.add(new O(aa.K(Pa).id,Ca,ra.K(xa)));da.add(ka.length-1)}else return l.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",aa.K(Pa).sc),this.fe.logger.Oi(Object.assign(new V.a,{gk:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,rAf:da};this.fe.runtime.$I("LCS: GetLCSBlocks for base");return{returnValue:ka,rAf:da}}CFl(aa,Y){const da=null==this.xg.getPropertyInt32(Y,
a.a.jt)?0:this.xg.getPropertyInt32(Y,a.a.jt);return new U(aa,da,Y.id)}wLl(aa,Y,da,ka,qa){ka=({yuf:da}=this.Vni(aa,Y,da,ka,qa)).returnValue;this.fe.logger.KX("FindFurthestPaths");aa=new G(ka,aa,Y);aa=new ba.a(this.gcl(aa,da),1);this.fe.logger.KX("BacktraceAndMakeUpdateHints");return aa}Vni(aa,Y,da=-1,ka=-1,qa=-1){let ua;if(-1===da||-1===ka||-1===qa)qa=ka=da=-1;ua=-1;const Pa=new z.a;Pa.W(new X(-1,1),new X(0,-1));if(-1!==da){Pa.W(new X(0,0),new X(da,da));var Ja=1}else Ja=0,ka=aa.length,qa=Y.length;
for(da=0;Ja<=aa.length+Y.length;Ja++){let Ca=!1;for(let ra=-Ja;ra<=Ja;ra+=2){let Ea,xa;ra===-Ja?(Ea=Pa.K(new X(Ja-1,ra+1)).x,xa=Pa.K(new X(Ja-1,ra+1)).y+1):ra===Ja?(Ea=Pa.K(new X(Ja-1,ra-1)).x+1,xa=Pa.K(new X(Ja-1,ra-1)).y):Pa.K(new X(Ja-1,ra-1)).x>=Pa.K(new X(Ja-1,ra+1)).x?(Ea=Pa.K(new X(Ja-1,ra-1)).x+1,xa=Pa.K(new X(Ja-1,ra-1)).y):(Ea=Pa.K(new X(Ja-1,ra+1)).x,xa=Pa.K(new X(Ja-1,ra+1)).y+1);for(;Ea<ka&&xa<qa&&aa.K(Ea).aC(Y.K(xa));)Ea++,xa++;Pa.W(new X(Ja,ra),new X(Ea,xa));if(Ea===ka&&xa===qa){Ca=
!0;ua=Ja;da=ra;break}}if(Ca)break;this.fe.runtime.$I("LCS FindFurthestPaths")}if(da!==ka-qa)return{returnValue:null,yuf:ua};Pa.W(new X(ua,da),new X(ka+1,qa+1));l.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",aa.length,Y.length,ua);return{returnValue:Pa,yuf:ua}}gcl(aa,Y){const da=aa.tem,ka=aa.rcl;aa=aa.hol;const qa=new w.a;let ua=ka.length,Pa=aa.length;for(;0<ua||0<Pa;){var Ja=ua-1,Ca=Pa-1;if(this.bbo(da,Y,ua,Pa)){Ja=aa.K(Ca);
if(1===Ja.type||2===Ja.type)this.acn(qa,ua,Ja);else if(0===Ja.type)this.wbn(qa,ua,Ja);else return l.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Ja.type),this.fe.logger.Oi(Object.assign(new T.a,{gk:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Pa--;Y--}else if(this.abo(da,Y,ua,Pa)){Ca=ka.K(Ja);if(1===Ca.type||2===Ca.type)this.rRl(qa,Ja,Ca);else if(0===Ca.type)this.YQl(qa,Ja,Ca);else return l.a.instance.Ua(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",
Ca.type),this.fe.logger.Oi(Object.assign(new T.a,{gk:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;ua--;Y--}else if(ua&&Pa&&ka.K(Ja).aC(aa.K(Ca)))ua--,Pa--;else return l.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.fe.logger.Oi(Object.assign(new T.a,{gk:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.fe.runtime.$I("LCS: CreateUpdateHintsFromLCSBlocks");return qa}abo(aa,Y,da,ka){Y=new X(Y-1,da-ka-1);return aa.tb(Y)&&aa.K(Y).x===da-1&&aa.K(Y).y===
ka}bbo(aa,Y,da,ka){Y=new X(Y-1,da-ka+1);return aa.tb(Y)&&aa.K(Y).x===da&&aa.K(Y).y===ka-1}wbn(aa,Y,da){da=new y.a(da.TYa,da.ed);let ka=!1;if(0<aa.length&&11===aa.ug(aa.length-1).type){const qa=aa.ug(aa.length-1);qa.cp===Y&&(ka=!0,qa.W2.add(da))}ka||(Y=new F.a(Y),Y.W2.add(da),aa.add(Y))}acn(aa,Y,da){var ka=!1;if(0<aa.length&&11===aa.ug(aa.length-1).type){const qa=aa.ug(aa.length-1);qa.cp===Y&&((ka=Object(x.a)(H.a,qa.W2.K(qa.W2.length-1)))?ka.text=da.character.toString()+ka.text:qa.W2.add(new H.a(da.TYa,
da.character.toString())),ka=!0)}ka||(Y=new F.a(Y),Y.W2.add(new H.a(da.TYa,da.character.toString())),aa.add(Y))}YQl(aa,Y,da){Y=new v.a(Y,da.TYa,da.ed);aa.add(Y)}IYc(aa,Y){let da=!1;if(0<aa.pK.length&&2===aa.pK.ug(aa.pK.length-1).type){const ka=aa.pK.ug(aa.pK.length-1);ka.Rg.equals(Y.TYa)&&ka.cp===Y.Poe&&(ka.cp=Y.Poe-1,ka.text=(void 0).character.toString()+ka.text,da=!0)}da||aa.pK.add(new u.a(Y.TYa,Y.Poe-1,(void 0).character.toString()));--Y.Poe}rRl(aa,Y,da){let ka=!1;if(0<aa.length&&8===aa.ug(aa.length-
1).type){const qa=aa.ug(aa.length-1);qa.cp===Y+1&&(qa.text=da.character.toString()+qa.text,--qa.cp,ka=!0)}ka||aa.add(new D.a(Y,da.character.toString()))}}Object(I.a)(W,"LCSUpdateHintGenerator",null,[])},1796:function(I,J,d){d.r(J);I=d(0);var m=d(59),f=d(13),a=d(5),l=d(177),w=d(364),z=d(616),x=d(224),u=d(48),v=d(109),D=d(1475);class y extends D.a{constructor(){super()}get afa(){return"ChildNodeListMerge"}}Object(I.a)(y,"ChildNodeListMergeFailureDetail",D.a,[]);class H{tAb(ba,W,aa){return W.P2(ba,aa.K(ba))}H3j(ba,
W,aa,Y){let da;return({value:da}=W.Ec(ba)).returnValue||({value:da}=aa.Ec(ba)).returnValue?da:Y.K(ba)}}Object(I.a)(H,"ChildNodeListMergeUtils",null,[1203]);var F=d(1551),G=d(1811),K=d(1616);class R{constructor(ba,W){this.classId=ba;this.esp=W}}Object(I.a)(R,"NodeChildrenTransformation",null,[]);var E=d(817),N=d(1499);class O{constructor(ba,W,aa){this.NM=ba;this.uEa=aa;this.bsa=W}Mqe(ba){let W,aa;return({twj:W}=this.M3j(this.uEa,ba)).returnValue&&W.e3||({twj:aa}=this.M3j(this.bsa,ba)).returnValue&&
aa.e3}M3j(ba,W){let aa;return{returnValue:({value:aa}=(new N.a(this.NM,ba)).SMa.Ec(E.a.yb(W))).returnValue,twj:aa}}}Object(I.a)(O,"NodeTriplet",null,[]);var U=d(1745);class X{constructor(ba,W,aa){this.fe=ba;this.xg=W;this.Z5=aa;this.uGh=!0}get Hu(){return this.fe}get tf(){return this.xg}get FEa(){return this.Z5}get success(){return this.uGh}pFm(){l.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");const ba=new w.a;this.wlf(ba,W=>this.Hu.runtime.Gn.K(W));this.wlf(ba,W=>this.FEa.tAb(W,this.Hu.runtime.JA,
this.Hu.runtime.Gn));this.wlf(ba,W=>this.FEa.tAb(W,this.Hu.runtime.sv,this.Hu.runtime.Gn));return ba}wlf(ba,W){const aa=W(d(1796).ChildNodeListMerge.Doe);this.tf.getPropertyObjectIds(aa,f.a.rg).forEach(Y=>{this.tf.getPropertyObjectIds(W(Y),f.a.rg).forEach(da=>{ba.tb(da)&&!Y.equals(ba.K(da))&&(this.uGh=!1,l.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",da,Y,ba.K(da)));ba.W(da,Y);return!0});return!0})}}Object(I.a)(X,"OutlineGroupParentFinder",
null,[]);var V=d(1476),Q=d(1754);d.d(J,"ChildNodeListMerge",function(){return T});class T{constructor(ba,W=null,aa=null,Y=null,da=null){this.xg=ba;this.m$n=W||G.a.f4j;this.Fke=aa||this.eCm();this.FEa=Y||new H;this.ydj=da||this.bAm()}get tf(){return this.xg}eCm(){return[new R(m.a.Oh,Object(v.a)(this,this.Q8n,"pageContentNodeThreewayChildMerge")),new R(m.a.eia,Object(v.a)(this,this.NKp,"wordSectionNodeThreewayChildMerge")),new R(m.a.KCa,Object(v.a)(this,this.voe,"outlineElementContainerThreewayChildMerge")),
new R(m.a.Ica,Object(v.a)(this,this.Shp,"tableCellThreewayChildMerge")),new R(m.a.Faa,Object(v.a)(this,this.voe,"outlineElementContainerThreewayChildMerge")),new R(m.a.Glc,Object(v.a)(this,this.voe,"outlineElementContainerThreewayChildMerge")),new R(m.a.ZK,Object(v.a)(this,this.voe,"outlineElementContainerThreewayChildMerge"))]}bAm(){return[Object(v.a)(this,this.cgo,"prepareObjectGroupings"),Object(v.a)(this,this.kWm,"handleInterOutlineGroupMerge"),Object(v.a)(this,this.Ibo,"performThreewayChildMerge")]}OMn(ba){let W=
0;for(;W<this.ydj.length;W++)if(!(0,this.ydj[W])(ba))return l.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",W),ba.logger.Uhe("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",W),!1;return!0}cgo(ba){const W=new w.a,aa=new w.a,Y=new z.a;ba.runtime.JA.forEach((da,ka)=>T.Rrj(ka,W));ba.runtime.sv.forEach((da,ka)=>T.Rrj(ka,aa));for(let da=0;da<this.Fke.length;da++){const ka=this.Fke[da].classId;ba.runtime.yvb.W(ka,new w.a);W.tb(ka)&&W.K(ka).forEach(qa=>{var ua=ba.runtime.Gn.K(qa.id);
ua&&(ua=new O(ua,qa,ba.runtime.sv.P2(qa.id,ua)),ba.runtime.yvb.K(ka).add(qa.id,ua),Y.add(qa.id));return!0});aa.tb(ka)&&aa.K(ka).forEach(qa=>{if(Y.contains(qa.id))return!0;const ua=ba.runtime.Gn.K(qa.id);ua&&ba.runtime.yvb.K(ka).add(qa.id,new O(ua,ua,qa));return!0})}ba.runtime.$I("PrepareObjectGroupings");ba.logger.bbb("PrepareObjectGroupings");return!0}Ibo(ba){let W=!0;for(let aa=0;W&&aa<this.Fke.length;aa++){const Y=this.Fke[aa];ba.runtime.$I("Before function#"+aa);const da=Y.classId;ba.runtime.yvb.K(da).forEach((ka,
qa)=>{ba.runtime.ITa.contains(qa.NM.id)||(W=Y.esp(ba,qa)&&W);W||(l.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",da,qa.NM.id),ba.logger.Oi(Object.assign(new y,{gk:"PerformThreewayChildMerge",eventId:"aqtsr"})));return W});ba.runtime.$I("PerformThreewayChildMerge"+aa)}ba.logger.bbb("PerformThreewayChildMerge");return W}Q8n(ba,W){if(W.Mqe(f.a.rg)){var aa=this.tf.getPropertyObjectIds(W.NM,f.a.rg);const Y=this.tf.getPropertyObjectIds(W.bsa,f.a.rg);
W=this.tf.getPropertyObjectIds(W.uEa,f.a.rg);aa=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",aa.length,Y.length,W.length,ba.input.source);l.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",aa);ba.logger.Oi(Object.assign(new y,{gk:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:aa}));return!1}return!0}NKp(ba,W){if(W.Mqe(f.a.rg)){const Pa=new z.a,Ja=new z.a,Ca=new z.a,ra=new z.a;var aa=
this.tf.getPropertyObjectIds(W.NM,f.a.rg),Y=aa.vS(),da,ka=({D8h:da}=this.rak(W.bsa,Y,Pa,"Favored")).returnValue,qa=({D8h:ua}=this.rak(W.uEa,Y,Ja,"Unfavored")).returnValue;if(!ka||!qa)return aa=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",Y.count,Pa.count,Ja.count,da,ua),ba.logger.Oi(Object.assign(new y,{gk:"WordSectionNodeThreewayChildMerge",info:aa})),!1;aa.forEach(Ea=>
{Pa.contains(Ea)||Ca.add(Ea);Ja.contains(Ea)||ra.add(Ea);return!0});W=W.NM.GO();Y=new x.a;for(da=0;da<aa.length;da++){var ua=aa.ug(da);if(Ca.contains(ua)||ra.contains(ua)){if(ba.runtime.ITa.add(ua),Y.length&&(ka=Y.ug(Y.length-1),ka=ba.runtime.yvb.K(m.a.KCa).K(ka),qa=ba.runtime.yvb.K(m.a.KCa).K(ua),ka&&qa))Ca.contains(ua)?ra.contains(ua)||(ka.NM=ka.NM.GO(),ka.uEa=ka.uEa.GO(),this.$Rd(ka.NM,qa.NM),this.$Rd(ka.uEa,qa.uEa)):(ka.NM=ka.NM.GO(),ka.bsa=ka.bsa.GO(),this.$Rd(ka.NM,qa.NM),this.$Rd(ka.bsa,qa.bsa))}else Y.add(ua)}this.tf.setPropertyObjectIds(W,
f.a.rg,Y);aa=new V.a(W);aa.KM(f.a.rg);ba.runtime.Sq.W(W.id,aa)}return!0}$Rd(ba,W){const aa=this.tf.getPropertyObjectIds(ba,f.a.rg);W=this.tf.getPropertyObjectIds(W,f.a.rg);const Y=aa.ONa();W.forEach(da=>{Y.add(da);return!0});this.tf.setPropertyObjectIds(ba,f.a.rg,Y)}rak(ba,W,aa,Y){let da=0,ka=!0;this.tf.getPropertyObjectIds(ba,f.a.rg).forEach(qa=>{W.contains(qa)?aa.add(qa):(ka=!1,l.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",Y,qa),da++);return!0});
return{returnValue:ka,D8h:da}}kWm(ba){let W=!0;ba.runtime.yvb.K(m.a.KCa).forEach((aa,Y)=>{if(this.Fmn(Y)){l.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",Y.NM.id);let da;const ka=new X(ba,this.tf,this.FEa);if(({bqj:aa,jck:da}=this.pqp(ba,ka.pFm(),Y)).returnValue)return l.a.instance.Ua(4220303,1,4,"Merging WordSection {0} as a unit.",da),W=ka.success&&this.GNn(ba,da,aa)&&W,W||(l.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
Y.NM.id,ka.success),ba.logger.Oi(Object.assign(new y,{gk:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ka.success)}))),W}return!0});return W}Fmn(ba){if(!ba.Mqe(f.a.rg))return!1;const W=this.tf.getPropertyObjectIds(ba.NM,f.a.rg).K(0),aa=this.tf.getPropertyObjectIds(ba.bsa,f.a.rg);ba=this.tf.getPropertyObjectIds(ba.uEa,f.a.rg);return!aa.contains(W,(Y,da)=>Y.equals(da))||!ba.contains(W,(Y,da)=>Y.equals(da))}pqp(ba,W,aa){W=
W.K(aa.NM.id);l.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",aa.NM.id,W);if(ba.runtime.ITa.contains(W))return l.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",W),{returnValue:!1,bqj:null,jck:W};const Y=new U.a;aa=ba.runtime.Gn.K(W);this.tf.getPropertyObjectIds(aa,f.a.rg).forEach(da=>
{Y.ZRd(da);return!0});aa=this.FEa.tAb(W,ba.runtime.JA,ba.runtime.Gn);this.tf.getPropertyObjectIds(aa,f.a.rg).forEach(da=>{Y.aSd(da);return!0});ba=this.FEa.tAb(W,ba.runtime.sv,ba.runtime.Gn);this.tf.getPropertyObjectIds(ba,f.a.rg).forEach(da=>{Y.eSd(da);return!0});return{returnValue:!0,bqj:Y,jck:W}}Tkg(ba,W,aa,Y,da){let ka=!0;ba.forEach(qa=>{const ua=W(qa);this.tf.getPropertyObjectIds(ua,f.a.rg).forEach(Pa=>{aa.add(Pa);if(Y.tb(Pa))return(ka=Y.K(Pa).equals(qa)&&ka)||l.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",
da,Pa,qa,Y.K(Pa)),ka;Y.W(Pa,qa);return!0});return!0});return ka}HDm(ba,W){let aa,Y,da,ka;aa=new x.a;Y=new x.a;da=new x.a;ka=new w.a;const qa=ba.runtime.Gn;return this.Tkg(W.TKb,ua=>qa.K(ua),aa,ka,"Base")&&this.Tkg(W.IBf,ua=>this.FEa.tAb(ua,ba.runtime.JA,qa),Y,ka,"Favored")&&this.Tkg(W.yAb,ua=>this.FEa.tAb(ua,ba.runtime.sv,qa),da,ka,"Unfavored")?{returnValue:!0,uVh:aa,Gmi:Y,d5j:da,cij:ka}:{returnValue:!1,uVh:aa,Gmi:Y,d5j:da,cij:ka}}t$l(ba,W,aa,Y){let da=!0;const ka=ba.runtime.Gn,qa=ba.runtime.JA,ua=
ba.runtime.sv,Pa=ba.runtime.Sq,Ja=new x.a,Ca=new w.a;aa.forEach(ra=>{const Ea=Y.K(ra);if(!Ea)return l.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ra),ba.logger.Oi(Object.assign(new y,{gk:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),da=!1;Ea.equals(Ja.last())||(Ja.add(Ea),Ca.add(Ea,new x.a));Ca.K(Ea).add(ra);ba.runtime.ITa.add(ra);return!0});if(!da)return!1;Ca.forEach((ra,Ea)=>{const xa=this.FEa.H3j(ra,qa,ua,ka).GO();this.tf.setPropertyObjectIds(xa,
f.a.rg,Ea);Pa.W(ra,new V.a(xa));Pa.K(ra).KM(f.a.rg);ba.runtime.ITa.add(ra);return da});aa=this.FEa.H3j(W,qa,ua,ka).GO();this.tf.setPropertyObjectIds(aa,f.a.rg,Ja);Pa.W(W,new V.a(aa));Pa.K(W).KM(f.a.rg);ba.runtime.ITa.add(W);return da}GNn(ba,W,aa){let Y,da;if(!({uVh:ka,Gmi:Y,d5j:da,cij:aa}=this.HDm(ba,aa)).returnValue)return!1;var ka=F.b(ka,Y,da);ka=this.Ypj(ba,ka);return!!ka&&this.t$l(ba,W,ka,aa)}voe(ba,W){return this.Zpj(ba,W)}Zpj(ba,W){if(W.Mqe(f.a.rg)){var aa=this.DDm(W);aa=this.Ypj(ba,aa);if(!aa)return l.a.instance.Ua(4220308,
1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",W.NM.id),ba.logger.Oi(Object.assign(new y,{gk:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),K.a(W.NM,"OutlineElementContainerThreewayChildMerge_Base",1),K.a(W.bsa,"OutlineElementContainerThreewayChildMerge_Favored",1),K.a(W.uEa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var Y=this.tf.getPropertyObjectIds(W.NM,
f.a.rg);const da=aa.vS();Y.forEach(ka=>{da.contains(ka)||(ka=this.tf.getPropertyObjectIds(W.NM,f.a.VG),0<ka.length&&ba.runtime.Zhg.add(ka.K(0)));return!0});Y=W.bsa.GO();this.tf.setPropertyObjectIds(Y,f.a.rg,aa);ba.runtime.Sq.W(Y.id,new V.a(Y));ba.runtime.Sq.K(Y.id).KM(f.a.rg)}return!0}Shp(ba,W){let aa=W.bsa.hasProperty(f.a.rg),Y=W.uEa.hasProperty(f.a.rg);aa&&(aa=!!this.tf.getPropertyObjectIds(W.bsa,f.a.rg).length);Y&&(Y=!!this.tf.getPropertyObjectIds(W.uEa,f.a.rg).length);if(aa!==Y)if(this.Ptn(ba.runtime.rc))ba.logger.F9i(Object.assign(new Q.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return ba.logger.Oi(Object.assign(new Q.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.Zpj(ba,W)}DDm(ba){let W,aa;({scl:ba,i6l:W,ftp:aa}=this.drm(ba));return F.b(ba,W,aa)}Ypj(ba,W){l.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",W.length);const aa=new x.a;let Y=!0;W.forEach(da=>{if(!da)return l.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
ba.logger.Oi(Object.assign(new y,{gk:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),Y=!1;if(1===da.yOn&&1===da.Yub){const xa=da.TKb.K(0),Ma=da.IBf.K(0),ha=da.yAb.K(0);if(xa&&xa.equals(Ma)&&xa.equals(ha))return aa.add(xa),!0;if(1!==W.length)return l.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",xa,Ma,ha,W.length),
ba.logger.Oi(Object.assign(new y,{gk:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),Y=!1}const ka=new w.a,qa=new x.a,ua=new x.a,Pa=new x.a,Ja=new x.a,Ca=new x.a,ra=new x.a,Ea=ba.runtime.Gn;da.TKb.forEach(xa=>Y=this.Vlg(ba,xa,Ma=>Ea.K(Ma),qa,Ja,ka,"Base"));if(!Y)return l.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ba.logger.Oi(Object.assign(new y,{gk:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;
da.IBf.forEach(xa=>Y=this.Vlg(ba,xa,Ma=>this.FEa.tAb(Ma,ba.runtime.JA,Ea),ua,Ca,ka,"Favored"));if(!Y)return l.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),ba.logger.Oi(Object.assign(new y,{gk:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;da.yAb.forEach(xa=>Y=this.Vlg(ba,xa,Ma=>this.FEa.tAb(Ma,ba.runtime.sv,Ea),Pa,ra,ka,"Unfavored"));if(!Y)return l.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
ba.logger.Oi(Object.assign(new y,{gk:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ba.runtime.rc&&ba.runtime.rc.xrb(1000005)&&(Ca.length&&this.h6l(Ca,ba.runtime.JA)?(this.COh(Ca,ba,aa,ka),this.dRd(ba,ka,ra)):this.COh(ra,ba,aa,ka));if(qa.length){da=null;if(!({Sq:da}=this.m$n(ba,qa,ua,Pa,da)).returnValue||!da)return Y=!1;da.forEach(xa=>{0<xa.Zac.count&&ba.runtime.Sq.W(xa.zm.id,xa);aa.add(ka.K(xa.zm.id));return!0})}return!0});return Y?aa:null}h6l(ba,W){for(let aa=0;aa<ba.length;aa++)if(W.get(ba.ug(aa).id))return!0;
return!1}dRd(ba,W,aa){aa.length&&(aa.forEach(Y=>{ba.runtime.cyc.add(Y.id);ba.runtime.cyc.add(W.K(Y.id));return!0}),G.a.dRd(ba,this.tf,aa.K(0)))}COh(ba,W,aa,Y){ba.forEach(da=>{const ka=new V.a(da.GO());W.runtime.Sq.W(da.id,ka);aa.add(Y.K(da.id));return!0})}Vlg(ba,W,aa,Y,da,ka,qa){var ua=aa(W);if(!ua)return l.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",qa,W),ba.logger.Oi(Object.assign(new y,{gk:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",
qa)})),!1;const Pa=this.tf.getPropertyObjectIds(ua,f.a.VG);if(!Pa||!Pa.length)return l.a.instance.Ua(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",qa,W),ba.logger.Oi(Object.assign(new y,{gk:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",qa)})),K.a(ua,"ProcessOutlineElement_"+qa,1),!1;ua=Pa.ug(0);aa=aa(ua);if(!aa)return l.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",
qa,ua,W),ba.logger.Oi(Object.assign(new y,{gk:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",qa)})),!1;if((qa=this.tf.getPropertyString(aa,a.a.gQ))&&""!==qa&&ba.runtime.rc&&(ba.runtime.rc.L9d(1000005),ba.runtime.rc.xrb(1000005)))return da.add(aa),ka.add(ua,W),ba.runtime.ITa.add(ua),!0;Y.add(aa);ka.add(ua,W);ba.runtime.ITa.add(ua);return!0}drm(ba){let W,aa;W=this.tf.getPropertyObjectIds(ba.NM,f.a.rg);aa=this.tf.getPropertyObjectIds(ba.bsa,
f.a.rg);ba=this.tf.getPropertyObjectIds(ba.uEa,f.a.rg);return{scl:W,i6l:aa,ftp:ba}}Ptn(ba){if(!ba)return l.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;ba.LL(97);return ba.isFeatureEnabled(97)}static Rrj(ba,W){W.tb(ba.sc)||W.W(ba.sc,new x.a);W.K(ba.sc).add(ba);return!0}}T.Doe=u.a.Bf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(I.a)(T,"ChildNodeListMerge",null,[1066])},1797:function(I,J,d){I=d(0);var m=d(1411),f=d(1609),a=d(1495),l=d(1442),w=d(1734),z=d(1513);class x{constructor(W,
aa){this.DimensionValue=this.DimensionName=null;this.DimensionName=W;this.DimensionValue=aa}}Object(I.a)(x,"Dimension",null,[]);class u{constructor(W,aa,Y,da,ka){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=W;this.Query=aa;this.From=Y;this.Size=da;ka&&(this.Filter=ka)}}Object(I.a)(u,"EntityRequest",null,[]);class v{constructor(W){this.QueryString=null;this.QueryString=W}}Object(I.a)(v,"Query",null,[]);var D=d(1413);class y{constructor(W,aa){this.Dimensions=
this.Name=null;this.Name=W;this.Dimensions=aa}}Object(I.a)(y,"Scenario",null,[]);var H=d(1417),F=d(1416);class G{constructor(W,aa,Y,da){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=W;this.TimeZone=aa;this.Cvid=Y;this.Scenario=da}}Object(I.a)(G,"SubstrateBody",null,[]);var K=d(1512),R=d(1407),E=d(1406),N=d(2),O=d(1728),U=d(1727),X=d(1474),V=d(29),Q=d(16),T=d(118);d.d(J,"a",function(){return ba});class ba{constructor(W){this.NMc=this.Dkb=this.tHd=this.uHc=this.vNc=
0;this.Yvh=this.qzh=this.gT=null;this.qZe=0;this.i5=-1;this.oQc="";this.CSe=!1;this.If=N.AFrameworkApplication.Fe;this.kc=W;this.lNd=this.oNf();this.hIb=new f.a;this.puh=this.kc.gDe?3:2;this.j$e=this.kc.gDe&&this.kc.IUj?5:3;this.Acf=this.kc.Hye?2:3;this.WKh=1;this.zGd=this.kc.BCi;this.vFh=this.kc.Xsn;this.xOc=W.FGi;N.AFrameworkApplication.J&&(this.qzh=N.AFrameworkApplication.J.jb("AppCatalogUrl")+N.AFrameworkApplication.J.jb("SearchPersonaPhotoBaseUrl"),this.CSe=this.kc.mhc||this.kc.Rka||this.kc.D0d);
this.kc.Rka&&(this.Acf=this.j$e=5)}lN(){return"Substrate"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:3}XJ(W,aa,Y,da=m.a.mu,ka=null){const qa=new F.a(W);if(!ka||Array.contains(ka,14)||Array.contains(ka,15)||Array.contains(ka,20))if(!this.qZe||window.performance.now()-this.qZe>=E.a.Veb)if(Y=this.hIb.jHi())this.qZe=window.performance.now(),Y.then(ua=>{ua&&""!==ua?(this.oQc=ua,""!==this.gT&&this.iHi(W,da,this.oQc,aa,ka)):(R.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),
aa.Kt(qa))},ua=>{R.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+ua);aa.Kt(qa)});else{if(R.TellMeActor.instance.Ye)R.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");aa.Kt(qa)}else this.oQc&&""!==this.oQc?this.iHi(W,da,this.oQc,aa,ka):(aa.Kt(qa),R.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else aa.Kt(qa)}vDa(){this.Dkb=this.NMc=this.tHd=
this.uHc=this.vNc=0}iHi(W,aa,Y,da,ka){this.vDa();const qa=new F.a(W),ua=this.gT=T.a.create().toString();this.iIa();this.i5=window.setTimeout(()=>{if(ua===this.gT){this.gT="";this.i5=-1;da.Kt(qa);const Ca={};Ca[a.a.provider]=this.lN();Ca[a.a.nYb]=W.Swb;R.TellMeActor.instance.Ye.gC(l.a.jHg,this.xOc,Ca)}},this.xOc);const Pa={"Content-Type":"application/json",Accept:"application/json"};Pa.Authorization="Bearer "+Y;Pa["X-Office-Version"]=N.AFrameworkApplication.buildVersion;Pa["X-Office-Application"]=
N.AFrameworkApplication.J.jb("Application");Pa["X-Office-Platform"]="WAC";Pa["X-TellMe-SessionId"]=R.TellMeActor.instance.Z8d();Pa["X-TellMe-Culture"]=N.AFrameworkApplication.uiCulture;Pa["X-TellMe-ProcessSessionId"]=N.AFrameworkApplication.userSessionId;Pa["Client-Request-Id"]=ua;const Ja=window.performance.now();this.If.Xj(this.FMm(),2,this.GMm(W.Vg,this.kc.application,R.TellMeActor.instance.Z8d(),E.a.yU(W)),Pa,!1,0,Ca=>{this.RWb(Ca,W,da,ua,Ja,aa,ka)},Ca=>{this.EWb(Ca,W,da,ua,Ja)},null,null,!1,
4E3,6E3)}iIa(){-1!==this.i5&&(window.clearTimeout(this.i5),this.i5=-1)}RWb(W,aa,Y,da,ka,qa,ua){R.TellMeActor.instance.Ye.Lba(aa.Vg.length,this.lNd.join(","),W.data.He.toString(),Math.round(window.performance.now()-ka),K.a.XYj,!0,z.a.iWa);const Pa=E.a.yU(aa),Ja=new F.a(aa);if(da===this.gT){this.iIa();W=V.b(W.data.Pe);if(W.Groups){W=W.Groups;for(const Ca of W)"People"===Ca.Type&&this.kc.$qd&&(ua?Array.contains(ua,14):1)?(W=this.MDi(Ca.Suggestions,Pa,qa),0<W.results.length&&Ja.gw(W)):"File"===Ca.Type&&
this.kc.Yqd&&(ua?Array.contains(ua,15):1)?(W=this.IIf(Ca.Suggestions,Pa,qa),0<W.results.length&&(this.Mde()&&(da=new D.a("GenerateSlidesFromTellMe",30,"",null,1),W.jy(da)),Ja.gw(W))):"Notes"===Ca.Type&&this.kc.Ztb&&qa!==m.a.contextMenu&&(ua?Array.contains(ua,20):1)&&(W=this.xCi(Ca.Suggestions,Pa,aa),0<W.results.length&&Ja.gw(W))}Y.Kt(Ja);R.TellMeActor.instance.Ye.Lba(aa.Vg.length,this.lNd.join(","),"",Math.round(window.performance.now()-ka),"",!0,z.a.provider)}else Y.Kt(Ja)}xCi(W,aa,Y){const da=new H.a(20);
da.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ka of W)this.rvn(ka)&&(W=ka.NotesType,W=Q.a.xh(W),W=this.vCm(W,ka.LastModifiedTime,ka.BodyPreview,ka.Subject,aa,Y,ka))&&(W.groupType=20,da.jy(W));return da}MDi(W,aa,Y){const da=new H.a(14);da.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const qa of W)if(this.svn(qa)){var ka=qa.Id.split("@")[0];W=qa.EmailAddresses[0];let ua=qa.Type;if(void 0===ua||null===ua)ua="User";if(ka=this.EFm(ua,qa.DisplayName,qa.JobTitle,W,ka,
Y,aa))ka.description=W,W=qa.JobTitle,"Department"in qa&&"CompanyName"in qa&&(W+="@"+qa.Department+"@"+qa.CompanyName),ka.TK=W,da.jy(ka)}return da}IIf(W,aa,Y){const da=new H.a(15);da.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ca of W)if(this.ivn(Ca)){var ka=Ca.FileName;W=Ca.FileExtension;var qa=ka;ka.length>W.length&&qa.endsWith(W)&&(qa=ka.substr(0,ka.length-W.length-1));var ua=void 0,Pa=0;"DateCreated"in Ca&&Ca.DateCreated?(Pa=E.a.bOf(Ca.DateCreated),ua=E.a.yIi(Ca.DateCreated),
ua=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ca.Author,ua)):ua=Ca.Author;var Ja=Ca.AccessUrl+"?web=1";const ra=Q.a.Ylc(Ja);ka=String.format('<a href="{0}">{1}</a>',ra,Q.a.P_(ka));if(Y!==m.a.contextMenu||Q.a.GX(Ja))if(qa=this.usm(qa,Y===m.a.contextMenu?ka:Ja,ua,Ca.FileExtension,Ca.Text,aa))qa.description=Ca.Author,qa.JRd=Pa,da.jy(qa),this.CSe&&(Pa=Ca.AccessUrl,ka=E.a.W5d(W),ua=Ca.DateModified?Ca.DateModified:Ca.DateCreated,Ja=Ca.Size?Ca.Size:Ca.FileSize,this.D4o()&&(Pa=Pa.replace(RegExp("%20",
"g")," "),ka=E.a.yLm(W)),W=new w.a(ka,Pa,Ca.SPWebUrl,Ca.Id,Ja,ua),R.TellMeActor.instance.rKg(!1,qa.value,W))}return da}EWb(W,aa,Y,da,ka){da===this.gT&&(this.iIa(),R.TellMeActor.instance.Ye.Lba(aa.Vg.length,this.lNd.join(","),W.data.He.toString(),Math.round(window.performance.now()-ka),K.a.XYj,!1,z.a.iWa));W=new F.a(aa);Y.Kt(W)}EFm(W,aa,Y,da,ka,qa,ua){ua=ua?this.WKh:this.puh;if(!window.LPC&&!E.a.nXf()||this.vNc===ua)return null;this.vNc+=1;ua="PeopleSuggestion"+this.vNc.toString();var Pa=this.qzh+
"?size=1&accountName="+da;W=Object.assign(new O.a,{PersonaType:W,Smtp:da,ProfilePictureUrl:Pa,AadObjectId:ka});const Ja=Object.assign(new U.a,{identifiers:W,displayName:aa});W=qa===m.a.contextMenu;this.kc.TAa?(R.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(ua,Ja,aa,Y)),qa===m.a.contextMenu&&(Y=E.a.Fai(aa,da,ka),R.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ua,Y))),R.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ua,
W))):(Pa=[],Pa.push(appChrome.actions.setPersonaButtonCoauthor(ua,Ja,aa,Y)),qa===m.a.contextMenu&&(Y=E.a.Fai(aa,da,ka),Pa.push(appChrome.actions.setButtonCommandValueId(ua,Y))),Pa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ua,W)),appChrome.api.dispatch(Pa));return new D.a(ua,11,aa,da,0)}vCm(W,aa,Y,da,ka,qa,ua){if(ka&&!this.kc.Q2i||this.tHd===this.zGd||this.NMc===this.zGd||this.Dkb===this.zGd)return null;var Pa=null;this.tHd+=1;ka="";const Ja=[],Ca={};ua.type="Notes";this.Yvh=
Object.assign(new X.a,{landingTab:"Notes",data:ua});qa=E.a.jUa(qa.Vg,33,this.Yvh);if("onenotepagepreviews"===W){if(!("ClickthroughUrl"in ua&&ua.ClickthroughUrl)||""===ua.ClickthroughUrl)return null;this.NMc+=1;ka="OnenoteNotesSuggestion"+this.NMc.toString();Ca["default"]="SaveAsonetoc2_20";Pa=ua.ClickthroughUrl;Ja.push(appChrome.actions.setControlIconSet(ka,Ca));Ja.push(appChrome.actions.setCompoundButtonCommandValueId(ka,Pa));Pa=new D.a(ka,19,null,null,0)}else if("stickynote"===W){if(!this.vFh)return null;
this.Dkb+=1;ka="NotesSuggestion"+this.Dkb.toString();Ca["default"]="ShowAllNotes_20";Ja.push(appChrome.actions.setControlIconSet(ka,Ca));Ja.push(appChrome.actions.setCompoundButtonCommandValueId(ka,qa));Pa=new D.a(ka,21,null,null,0)}else if("samsung"===W){if(!this.vFh)return null;this.Dkb+=1;ka="NotesSuggestion"+this.Dkb.toString();Ca["default"]="CategoryCollapsed_20";Ja.push(appChrome.actions.setControlIconSet(ka,Ca));Ja.push(appChrome.actions.setCompoundButtonCommandValueId(ka,qa));Pa=new D.a(ka,
20,null,null,0)}""!==ka&&(W=E.a.yIi(aa),W=String.format(CommonUIStrings.l_LastModifiedString,W),Pa.label=da,Pa.JRd=E.a.bOf(aa),Ja.push(appChrome.actions.setControlLabel(ka,da)),Ja.push(appChrome.actions.updateCompoundButtonDescription(ka,W)),Ja.push(appChrome.actions.setControlCustomTooltip(ka,Y)),appChrome.api.dispatch(Ja));return Pa}usm(W,aa,Y,da,ka,qa){if(this.uHc===(qa?this.Acf:this.j$e)||this.CSe&&"Word"!==E.a.W5d(da))return null;this.uHc+=1;qa="FileSuggestion"+this.uHc.toString();const ua=[],
Pa={};Pa["default"]=E.a.Rvm(da);this.kc.TAa?(R.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa,W)),R.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(qa,Pa)),R.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa,Y)),R.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa,aa)),R.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(qa,ka)),this.kc.mhc&&R.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(qa,
"QuickActionOnFile"))):(ua.push(appChrome.actions.setControlLabel(qa,W)),ua.push(appChrome.actions.setControlIconSet(qa,Pa)),ua.push(appChrome.actions.updateCompoundButtonDescription(qa,Y)),ua.push(appChrome.actions.setCompoundButtonCommandValueId(qa,aa)),ua.push(appChrome.actions.setControlCustomTooltip(qa,ka)),this.kc.mhc&&ua.push(appChrome.actions.setCompoundButtonSecondaryButtonId(qa,"QuickActionOnFile")),appChrome.api.dispatch(ua));return new D.a(qa,6,W,Y,0)}oNf(){const W=[];this.kc.$qd&&Array.add(W,
"People");this.kc.Yqd&&Array.add(W,"File");this.kc.Ztb&&Array.add(W,"Notes");return W}GMm(W,aa,Y,da){var ka=new v(W);W=new u("File",ka,0,da?this.Acf:this.j$e,null);da=new u("People",ka,0,da?this.WKh:this.puh,E.a.pbo);ka=new u("Notes",ka,0,this.zGd,null);(this.kc.mhc||this.kc.D0d)&&"powerpoint"===aa.toLowerCase()&&(aa="word");aa=new x("app",aa.toLowerCase());var qa=[];Array.add(qa,aa);aa=new y("tellmesearch",qa);qa=[];this.kc.Yqd&&Array.add(qa,W);this.kc.$qd&&Array.add(qa,da);this.kc.Ztb&&Array.add(qa,
ka);Y=new G(qa,"UTC",Y,aa);return V.c(Y)}FMm(){let W=this.kc.hgp;this.kc.Ztb&&(W+="?&setflight=NotesFrom3S");""!==this.kc.kHi&&(W=W+"&"+this.kc.kHi);return W}svn(W){return"DisplayName"in W&&"Id"in W&&"EmailAddresses"in W&&!!W.Id&&!!W.EmailAddresses}ivn(W){return"FileExtension"in W&&!!W.FileExtension&&"FileName"in W&&!!W.FileName&&""!==W.FileName&&"AccessUrl"in W&&!!W.AccessUrl&&""!==W.AccessUrl}rvn(W){return"Id"in W&&!!W.Id&&"NotesType"in W&&!!W.NotesType&&"Subject"in W&&!!W.Subject&&""!==W.Subject}Mde(){return!!N.AFrameworkApplication.J&&
N.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}D4o(){return!!N.AFrameworkApplication.J&&N.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(I.a)(ba,"SubstrateResultsProvider",null,[85])},1799:function(I,J,d){I=d(0);var m=d(59),f=d(33),a=d(5),l=d(13),w=d(177),z=d(85),x=d(183),u=d(224),v=d(616),D=d(48),y=d(364),H=d(2),F=d(1353),G=d(967),K=d(1351);class R{constructor(ka,
qa=0){this.lsf=null;this.Iig=0;this.NL=ka;this.U7f=qa}}Object(I.a)(R,"GraphMergerResponse",null,[]);var E=d(109),N=d(1),O=d(93),U=d(894),X=d(1475),V=d(1549);class Q extends V.a{constructor(){super();this.dXj=null;this.rbk=!1}get afa(){return"Crash"}TPb(){this.detail.W("Type",this.afa);this.detail.W("Trace",this.Lpp(this.dXj));this.detail.W("Continue",this.rbk);return this.detail}Lpp(ka){ka=ka.split("\n");const qa=4<ka.length?4:ka.length,ua=new Sys.StringBuilder;for(let Pa=0;Pa<qa;Pa++)Pa===qa-1?ua.append(String.format("{0}...",
ka[Pa])):ua.append(String.format("{0}\n",ka[Pa]));return ua.toString()}}Object(I.a)(Q,"CrashMergeFailureDetail",V.a,[]);var T=d(2029),ba=d(1499),W=d(1644),aa=d(1476);class Y{constructor(){this.eel=new y.a;this.Pwl=new y.a;this.gAl=new y.a}}Object(I.a)(Y,"RangeMarkers",null,[]);d.d(J,"a",function(){return da});class da{constructor(){this.K9d=0;this.Qjh=this.qib=this.b9b=this.xg=this.pCh=this.o$b=null;this.nuh=0;this.Vqh=50;this.ohh=this.Pah=null}get ndb(){return this.o$b}get BJo(){return this.pCh}get tf(){return this.xg}get avb(){return this.b9b}get XKi(){return this.qib}get FTm(){return this.Qjh}get frc(){return this.nuh}get L1h(){return this.Pah}get e0c(){return this.ohh}GVb(ka,
qa,ua,Pa,Ja,Ca,ra){ua=this.PHl(ka,qa,Pa,Ja,Ca,ra,this.e0c);Pa=0;const Ea=ua.runtime.Mye;let xa=null;try{this.ZFn(Ea,ua,ra,ka,qa,Ja,Ca);let Ma=K.a.success;for(;Pa<this.avb.length;Pa++)if(!(0,this.avb[Pa])(ua)){Ma=K.a.Gj;ua.logger.Uhe("GraphMerger.GetMergeFunctions()",Pa);break}return xa=new R(ua.output.NL,Ma)}catch(Ma){const ha=!ua.output.timeout;ua.output.pza=ha;const la=this.Q5d(Ma),Fa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",ha?"Crashed":"Timed Out",
ua.input.IVb,!!ua.output.NL,la);ha?(w.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Fa),ua.logger.Oi(Object.assign(new Q,{dXj:la,rbk:!!ua.output.NL}))):w.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Fa);if(ua.output.NL)return xa=new R(ua.output.NL,K.a.Gj);throw Ma;}finally{ua.output.succeeded?this.WFn(Ea,ua,Pa):ua.output.timeout?this.YFn(ua,Pa):ua.output.pza?ua.output.NL?this.XFn(ua,Pa):this.VFn(ua,Pa):this.UFn(ua,Pa);ua.logger.TFn();w.a.instance.Sna(42350232,1,ua.output.succeeded?
4:2,"MergeLogger",ua.logger.dAm());ua.logger.Lcd.$Mi()&&w.a.instance.Sna(559015903,1,2,"MarkerInfo",ua.logger.Lcd.toString());if(ua.runtime.rc&&ua.runtime.rc.isFeatureEnabled(65))try{this.oDn(ua)}catch(Ma){w.a.instance.Ua(571619421,1,4,"Error logging references: {0}",Ma.toString())}this.FGn(ua);xa.Iig|=(ua.output.succeeded?2:1)<<2*(ra-1);if(xa)try{xa.lsf=this.Jfo(ua)}catch(Ma){w.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",Ma)}}}FGn(ka){if(!ka.output.succeeded){ka=ka.output.timeout?
"Timeout":ka.logger.Ewj?ka.logger.Ewj.afa:"Unknown";const qa=new O.a;z.Health.instance.recordQosError(ka,["MergeFailure"],!0,!0,!1,!1,qa)}}oDn(ka){const qa=Ja=>{const Ca=this.ZJa()-ka.input.J_a>this.frc;if(0<this.frc&&Ca)throw w.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ja),x.a.invalidOperation(Ja);};let ua=ka.runtime.JA.keys,Pa=Ja=>ka.runtime.JA.K(Ja);this.Z4f(ka,qa,ua,Pa,"Favored");ua=ka.runtime.sv.keys;Pa=Ja=>ka.runtime.sv.K(Ja);this.Z4f(ka,qa,ua,Pa,
"Unfavored");ua=ka.runtime.Sq.keys;Pa=Ja=>{const Ca=ka.runtime.Sq.K(Ja);return Ca?Ca.zm:ka.runtime.JA.K(Ja)};this.Z4f(ka,qa,ua,Pa,"Merged")}Z4f(ka,qa,ua,Pa,Ja){var Ca=new u.a;const ra=new u.a;for(let Ea=0;Ea<ua.length;Ea++){qa("LogAddedAndDeletedNodes");const xa=Pa(ua.K(Ea));if(xa.sc===m.a.Yna)continue;const Ma=ka.runtime.Gn.K(xa.id);Ma&&this.pDn(Ca,ra,xa,Ma)}this.y$i(ra,Ea=>ka.runtime.Gn.K(Ea),qa);this.y$i(Ca,Pa,qa);qa=new Sys.StringBuilder;for(ua=0;ua<Ca.length;ua++)qa.append(Ca.K(ua).toString()+
",");Ca=new Sys.StringBuilder;for(ua=0;ua<ra.length;ua++)Ca.append(ra.K(ua).toString()+",");w.a.instance.Sna(571619423,1,4,Ja+" revision: Added references",qa.toString());w.a.instance.Sna(571619424,1,4,Ja+" revision: Deleted references",Ca.toString())}pDn(ka,qa,ua,Pa){const Ja=ua.Zj();for(let ra=0;ra<Ja.length;ra++){const Ea=Ja[ra];if(this.OUi(Ea)){var Ca=this.tf.getPropertyObjectIds(ua,Ea);this.dFn(ka,qa,Pa,Ea,Ca)}else this.y_i(Ea)&&(Ca=this.tf.getPropertyObjectId(ua,Ea),this.cFn(ka,qa,Pa,Ea,Ca))}}y$i(ka,
qa,ua){ua("LogNestedReferences");ua=new u.a;const Pa=new v.a;for(let Ja=0;Ja<ka.length;Ja++){const Ca=ka.K(Ja);this.B5f(Ca,ua,Pa,qa)}for(qa=0;qa<ua.length;qa++)ka.add(ua.K(qa))}B5f(ka,qa,ua,Pa){const Ja=Pa(ka);if(Ja){const ra=Ja.Zj();for(let Ea=0;Ea<ra.length;Ea++){var Ca=ra[Ea];if(this.OUi(Ca)){Ca=this.tf.getPropertyObjectIds(Ja,Ca);for(let xa=0;xa<Ca.length;xa++)ua.contains(Ca.K(xa))||(qa.add(Ca.K(xa)),ua.add(Ca.K(xa)),this.B5f(Ca.K(xa),qa,ua,Pa))}else this.y_i(Ca)&&(Ca=this.tf.getPropertyObjectId(Ja,
Ca),ua.contains(Ca)||(qa.add(Ca),ua.add(Ca),this.B5f(ka,qa,ua,Pa)))}}}dFn(ka,qa,ua,Pa,Ja){if(this.tf.hasProperty(ua,Pa)){ua=this.tf.getPropertyObjectIds(ua,Pa);const Ca=ua.vS();Pa=Ja.vS();for(let ra=0;ra<Ja.length;ra++)Ca.contains(Ja.K(ra))||ka.add(Ja.K(ra));for(ka=0;ka<ua.length;ka++)Pa.contains(ua.K(ka))||qa.add(ua.K(ka))}else for(qa=0;qa<Ja.length;qa++)ka.add(Ja.K(qa))}cFn(ka,qa,ua,Pa,Ja){Ja&&(this.tf.hasProperty(ua,Pa)?(ua=this.tf.getPropertyObjectId(ua,Pa),Ja.equals(ua)||(ka.add(Ja),qa.add(ua))):
ka.add(Ja))}SFn(ka){w.a.instance.Ua(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ka.input.IVb,ka.output.pza,ka.output.timeout)}ZFn(ka,qa,ua,Pa,Ja,Ca,ra){if(ka){ka=Pa.length?Pa.ug(Pa.length-1):null;var Ea=Ja.length?Ja.ug(Ja.length-1):null;ua=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",
qa.input.IVb,Pa.length,ka?ka.id:D.a.nil,ka?ka.DJ?ka.DJ.id:D.a.nil:D.a.nil,Ja.length,Ea?Ea.id:D.a.nil,Ea?Ea.DJ?Ea.DJ.id:D.a.nil:D.a.nil,Ca,ra,this.frc,ua);switch(qa.input.source){case 5:w.a.instance.Ua(51663493,1,4,ua);break;default:w.a.instance.Ua(4051606,1,4,ua)}}}WFn(ka,qa,ua){if(ka)switch(ka=this.M2c(qa,ua,"Succeeded"),qa.input.source){case 5:w.a.instance.Ua(51663494,1,4,ka);break;default:w.a.instance.Ua(4059162,1,4,ka)}}YFn(ka,qa){qa=this.M2c(ka,qa,"Timeout");switch(ka.input.source){case 5:w.a.instance.Ua(51663495,
1,4,qa);break;default:w.a.instance.Ua(4059163,1,2,qa)}}UFn(ka,qa){qa=this.M2c(ka,qa,"Rejection");switch(ka.input.source){case 5:w.a.instance.Ua(51663496,1,4,qa);break;default:w.a.instance.Ua(4059164,1,2,qa)}}XFn(ka,qa){qa=this.M2c(ka,qa,"Crash - Rejection");switch(ka.input.source){case 5:w.a.instance.Ua(51663497,1,4,qa);break;default:w.a.instance.Ua(4059165,1,2,qa)}}VFn(ka,qa){qa=this.M2c(ka,qa,"Crash - Failed");switch(ka.input.source){case 5:w.a.instance.Ua(51663498,1,4,qa);break;default:w.a.instance.Ua(4059166,
1,2,qa)}}M2c(ka,qa,ua){const Pa=ka.output.NL,Ja=Pa&&Pa.length?Pa.ug(Pa.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",ka.input.IVb,ua,this.ZJa()-ka.input.J_a,qa,Pa?Pa.length:0,Ja?Ja.id:D.a.nil,Ja?Ja.DJ?Ja.DJ.id:D.a.nil:D.a.nil,ka.input.source)}PHl(ka,qa,ua,Pa,Ja,Ca,ra){const Ea=new T.a,xa=Ea.input;xa.Oca=ka;xa.Q0a=qa;xa.il=ua;xa.zma=Pa;xa.VRb=Ja;xa.source=
Ca;xa.e0c=ra;xa.J_a=this.ZJa();Ea.logger.a_o(xa.J_a);ka=Ea.runtime;ka.cpd=w.a.instance.k4(1,5);ka.Mye=w.a.instance.k4(1,4);let Ma="";ka.$I=ha=>{if(this.frc){var la=this.ZJa()-xa.J_a,Fa=la>this.frc;Ma+=String.format(" ({0}: {1})",ha,la);Fa&&(Ea.output.timeout=!0,ha=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",xa.IVb,this.frc,ha,la,Ma),w.a.instance.Ua(528061012,1,2,ha),this.flp(ha))}};return Ea}E3c(){return[Object(E.a)(this,
this.H7n,"otherAuthorsHaveChangesToMerge"),Object(E.a)(this,this.wmn,"isInputValid"),Object(E.a)(this,this.a9m,"initializeOutputMergeState"),Object(E.a)(this,this.mbe,"initializeRuntimeMergeState"),W.a.mfo,Object(E.a)(this.L1h,this.L1h.OMn,"mergeChildNodeLists"),Object(E.a)(this,this.rrp,"tryObjectMerge"),W.a.Qeo,Object(E.a)(this,this.k8l,"finalizeObjectMerge"),Object(E.a)(this,this.PEp,"validateMarkers"),Object(E.a)(this,this.cYk,"addMergeResultsToOutput")]}H7n(ka){const qa=ka.input.Oca;ka=ka.output;
return qa?qa.length?!0:(w.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ka.NL=qa,ka.succeeded=!0,!1):(w.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ka.NL=qa,ka.succeeded=!0,!1)}wmn(ka){var qa=ka.input;const ua=qa.Oca,Pa=qa.Q0a,Ja=qa.il,Ca=qa.zma;qa=qa.VRb;ka=ka.output;if(!Pa||!Pa.length)return w.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),ka.NL=ua,ka.succeeded=
!0,!1;let ra=!0;if(2!==Ca&&1!==Ca)return ka.NL=ua,!1;Ja&&Ja!==D.a.nil||(ra=!1);ua.length<(qa?2:1)&&(w.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",qa),ra=!1);ra||(ka.NL=2===Ca?ua:Pa);return ra}mbe(ka){var qa=ka.input,ua=qa.Oca,Pa=qa.Q0a,Ja=qa.zma,Ca;let ra;({WGg:Ca,$Ng:ra,qIa:qa}=this.ZJf(ka,ua,Pa,qa.VRb));if(!qa)return w.a.instance.Ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
Ca.id,ra.id),ka.logger.Oi(Object.assign(new X.a,{gk:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.P$i(Ca,ua.length,"TheirChanges"),this.P$i(ra,Pa.length,"YourChanges"),ka.output.NL=2===Ja?ua:Pa,!1;ka.runtime.qIa=qa;({gtp:ua,j6l:Pa}=this.oTl(Ja,Ca,ra));({htp:qa,k6l:Ja,vcl:Ca}=this.BAm(ka,ua,Pa,qa));ka.runtime.Gn=Ca;ka.runtime.sv=qa;ka.runtime.JA=Ja;ka.runtime.Sq=new y.a;ka.runtime.d2d=Pa.id;ka.runtime.VDe=ua.id;ka.runtime.yvb=new y.a;ka.runtime.ITa=
new v.a;ka.runtime.fvf=new y.a;ka.runtime.Wxl=new y.a;ka.runtime.aip=new y.a;ka.runtime.Jse=new Y;ka.runtime.hje=new u.a;ka.runtime.Zhg=new v.a;ka.runtime.cyc=new u.a;ka.runtime.rc=ka.input.e0c(ka);ka.runtime.rc.vSc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.Zjp);ka.runtime.rc.vSc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.imp);ka.runtime.rc.vSc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",
f.a.S5l);ka.runtime.rc.vSc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",f.a.Azo);ka.runtime.rc.vSc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix","79ee6190;i588c310",f.a.cNn);ka.runtime.ARi=!0;H.AFrameworkApplication.J&&(this.Vqh=H.AFrameworkApplication.J.jc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}P$i(ka,qa,ua){const Pa=new u.a;for(;ka;)Pa.add(ka),ka=ka.DJ;const Ja=new Sys.StringBuilder;Ja.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
ua,qa,Pa.length));let Ca=Pa.length,ra=0;Pa.forEach(Ea=>({iPi:Ca,naj:ra}=this.UZk(Ja,Ea,Pa,Ca,ra)).returnValue);w.a.instance.Ua(4273302,1,4,Ja.toString())}UZk(ka,qa,ua,Pa,Ja){ka.append(String.format(" [{0} {1} {2}]",Pa,qa.ima?"S":"B",qa.id));Pa--;Ja++;return 50<Ja&&ua.length!==Ja?(ka.append(" ...Truncated."),{returnValue:!1,iPi:Pa,naj:Ja}):{returnValue:!0,iPi:Pa,naj:Ja}}ZJf(ka,qa,ua,Pa){qa=qa.ug(qa.length-1-(Pa?1:0));ua=ua.ug(ua.length-1);Pa=qa.kVa(ua);ka.runtime.$I("GetCommonBase");ka.logger.bbb("GetCommonBase");
return{WGg:qa,$Ng:ua,qIa:Pa}}BAm(ka,qa,ua,Pa){let Ja,Ca;({result:Ja}=qa.JVb(Pa));ka.runtime.$I("GetUnfavoredChanges");ka.logger.bbb("GetUnfavoredChanges");({result:Ca}=ua.JVb(Pa));5===ka.input.source&&(ka.runtime.n6l=U.a.gFi(ua),ka.runtime.jtp=U.a.gFi(qa));ka.runtime.$I("GetFavoredChanges");ka.logger.bbb("GetFavoredChanges");qa=new F.a(Object(E.a)(Pa,Pa.jKa,"getMergeableObject"));ka.runtime.$I("GetModifiedObjects");ka.logger.bbb("GetModifiedObjects");return{htp:Ja,k6l:Ca,vcl:qa}}oTl(ka,qa,ua){2===
ka?(ka=qa,qa=ua):ka=ua;return{gtp:qa,j6l:ka}}a9m(ka){const qa=ka.input,ua=qa.Oca,Pa=qa.Q0a;ka.output.NL=(2===qa.zma?ua:Pa).ONa();ka.runtime.$I("InitializeOutputMergeState");ka.logger.bbb("InitializeOutputMergeState");return!0}cYk(ka){var qa=ka.input.il;const ua=ka.runtime.Sq,Pa=ka.output.NL;qa=this.QHl(ka,Pa.ug(Pa.length-1),qa,D.a.create());this.I7l(ka,qa,ua);Pa.add(qa);return ka.output.succeeded=!0}QHl(ka,qa,ua,Pa){ka.runtime.Mye&&w.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
ua,Pa);ka=this.BJo(Pa);ka.IVh(qa,ua);return ka}I7l(ka,qa,ua){ka.runtime.Mye&&w.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",ua.count);ua.forEach((Pa,Ja)=>{qa.kcc(Ja.zm);return!0})}rrp(ka){return this.b4j(ka,!1)}k8l(ka){return this.b4j(ka,!0)}b4j(ka,qa){const ua=ka.runtime,Pa=ua.Gn,Ja=ua.JA,Ca=qa?ua.fvf:ua.sv,ra=ua.Sq;let Ea=!0;const xa=ka.runtime.cpd;let Ma=0,ha=0,la=0;Ca.forEach((Fa,Ga)=>{xa&&w.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
Fa,Ga.sc,qa);ha++;this.Vqh===ha&&(Ma++,ka.runtime.$I(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",Ma,la,qa)),ha=0);if(ka.runtime.rc&&ka.runtime.rc.xrb(1000005)&&ka.runtime.cyc.contains(Ga.id,(Oa,Ra)=>Oa.equals(Ra))||this.pap(Ga.sc))return!0;if(!qa&&this.MPl(Ga.sc,ka.runtime.rc))return ua.fvf.W(Fa,Ga),!0;var va=Ja.get(Fa);if(!va)return ra.tb(Fa)?ra.K(Fa).Hdj(Ga):ra.W(Fa,new aa.a(Ga,!1)),!0;if(!Pa.K(Fa)&&!this.FNn(va.sc)){var pa=!!ka.input.Oca&&!!ka.input.Oca.last()&&
ka.input.Oca.last().k3(Fa);const Oa=!!ka.input.Q0a&&!!ka.input.Q0a.last()&&ka.input.Q0a.last().k3(Fa),Ra=new ba.a(va,Ga);if(!Ra.e3)return ra.W(Fa,new aa.a(va,!1)),!0;w.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",Fa,Ga.sc,qa,pa,Oa,!Ra.e3,ka.input.source);ka.logger.Oi(Object.assign(new X.a,{gk:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return Ea=!1}pa=ra.P2(Fa,new aa.a(Pa.K(Fa)));({Rl:va,returnValue:Ea}=this.FTm.merge(ka,this.XKi,this.tf,pa,va,Ga));la++;Ea&&(ka.runtime.$I(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Fa,Ga.sc,la,Ma,qa)),va&&(ra.tb(va.zm.id)?ra.K(va.zm.id).Hdj(va.zm):ra.W(va.zm.id,va)));return Ea});ka.logger.bbb("ObjectMerge");xa&&w.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Ca.count,
la,qa);return Ea}PEp(ka){try{for(let qa=0;qa<ka.runtime.hje.length;qa++){const ua=ka.runtime.hje.K(qa);if(ka.runtime.Sq.K(ua)){if(!this.Pnn(ka,ua))return!1}else w.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.$I("Validate markers taking too long")}}catch(qa){w.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",qa)}return ka.logger.Lcd.$Mi()?!1:!0}Y5o(ka){return 38===ka||39===ka||40===ka||41===ka||44===ka||45===ka||33===ka||34===ka?!1:
!0}Ozm(ka){switch(ka){case 38:case 39:case 40:case 41:return a.a.se;case 44:case 45:return a.a.mTd;case 33:case 34:return a.a.pk}return G.CommonProperties.nil}OEp(ka,qa){const ua=this.tf.getPropertyUint32(ka,a.a.jt);if(!ua||this.Y5o(ua))return!0;ka=this.tf.getPropertyObjectId(ka,this.Ozm(ua));return da.Jjc(qa,ka)?!0:(qa.logger.Lcd.$be=ua,!1)}Pnn(ka,qa){if(ka.runtime.Zhg.contains(qa))return!1;if(qa=da.Jjc(ka,qa)){qa=this.tf.getPropertyObjectIds(qa,l.a.Sn);for(let ua=0;ua<qa.length;ua++){const Pa=da.Jjc(ka,
qa.ug(ua));if(Pa&&!this.OEp(Pa,ka))return!1}}return!0}pap(ka){switch(ka){case m.a.KHa:case m.a.Tcc:case m.a.BKb:case m.a.Pcc:case m.a.xEa:case m.a.Yna:return!0}return!1}MPl(ka,qa){let ua=!1;if(ka===m.a.Xd)return!0;qa&&qa.LL(115);qa&&qa.isFeatureEnabled(115)&&ka===m.a.Hmb&&(ua=!0);return ua}FNn(ka){switch(ka){case m.a.izc:return!0}return!1}jKl(ka,qa){const ua=new u.a,Pa=new u.a,Ja=new u.a;var Ca=ka.runtime.qIa;const ra=Ca?Ca.id:D.a.nil;this.u3f(Ca).forEach(Ea=>{ua.add(qa(Ea));return!0});Ca=ka.input.Oca.ug(ka.input.Oca.length-
1);this.u3f(Ca,ra).forEach(Ea=>{Pa.add(qa(Ea));return!0});ka=ka.input.Q0a.ug(ka.input.Q0a.length-1);this.u3f(ka,ra).forEach(Ea=>{Ja.add(qa(Ea));return!0});return{ucl:ua,Gkp:Pa,GLp:Ja}}u3f(ka,qa=null){const ua=new u.a;qa||(qa=D.a.nil);for(;ka&&!qa.equals(ka.id);)ua.add(ka),ka=ka.DJ;ua.reverse();return ua}Ggp(ka){const qa=3===this.K9d;let ua=!1;!ka.output.succeeded&&(2===this.K9d||ka.output.pza&&1===this.K9d)&&(ua=!0);let Pa=!1;ka.input.Oca&&0<ka.input.Oca.length&&(qa||ua)&&ka.runtime.JA&&ka.runtime.Gn&&
ka.runtime.rc&&(Pa=ka.runtime.rc.isFeatureEnabled(44));return Pa}OUi(ka){return 9===N.a.jrb(N.a.DEf(ka))}y_i(ka){return 8===N.a.jrb(N.a.DEf(ka))}static wum(ka){return ka.output.pza?2:ka.output.succeeded?3:1}static Jjc(ka,qa){if(!qa||qa===D.a.nil)return null;const ua=ka.runtime.Sq.K(qa);return ua?ua.zm:ka.runtime.Gn.K(qa)}}da.I9d=D.a.Bf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(I.a)(da,"GraphMergerBase",null,[866])},1808:function(I,J,d){I=d(0);var m=d(71),f=d(1411),a=d(1609),l=d(1495),w=
d(1442),z=d(1513),x=d(1413),u=d(1417),v=d(1416),D=d(1407),y=d(1406);class H{constructor(T){this.kc=T;this.lNd=this.oNf()}lN(){return"Add-ins"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:3}XJ(T,ba){T=new v.a(T);ba.Kt(T)}Frb(T,ba,W){let aa;aa=this.kc.oS?new u.a(29):new u.a(27);aa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;W&&this.U9o(T.Vg,ba,aa)}U9o(T,ba,W){const aa=[];let Y;Y=this.kc.Qen?this.kc.oS&&this.kc.tmb?y.a.tqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
T)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,T):this.kc.Ren?this.kc.oS&&this.kc.tmb?y.a.tqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,T)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,T):this.kc.oS&&this.kc.tmb?y.a.tqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,T)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,T);this.kc.TAa?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
Y)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",T))):(aa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Y)),aa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",T)),appChrome.api.dispatch(aa));W.jy(new x.a("LaunchAddinDialogFromTellMe",29));ba.gw(W)}oNf(){const T=[];this.kc.yce&&Array.add(T,"Addin");return T}}Object(I.a)(H,"AddinStoreResultsProvider",null,[85]);var F=d(1761),G=d(1477),
K=d(1496),R=d(1762),E=d(1797),N=d(1763),O=d(1512),U=d(2),X=d(29),V=d(118);d.d(J,"a",function(){return Q});class Q{constructor(T,ba,W){this.Tkb=this.IPc=this.JPc=this.sMd=!1;this.gT=null;this.i5=-1;this.H4a=this.DQc=this.Dja=this.RIb=null;this.ish=this.rsh=0;this.kc=T;const aa=y.a.ota();this.Uhb=ba||[];this.If=U.AFrameworkApplication.Fe;this.QEh=T.Lgg;this.KPc=T.Kgg;this.qMd=aa&&this.q0b();this.rMd=aa&&this.r0b();this.SEh=aa&&this.s0b();this.uMd=this.t0b();this.R7e=this.Bxc();if((ba=T.IEg&&y.a.yAg(T))||
T.Rka)this.RIb=new E.a(T),this.sMd=T.Yqd;ba&&(this.JPc=T.$qd,this.IPc=T.Ztb,this.Tkb=this.sMd&&this.Ay("File")||this.JPc&&this.Ay("People")||this.IPc&&this.Ay("Notes"));this.pMd=this.v5o();this.MPc=T.Sfd;this.tMd=this.P5o();this.Q7e=this.u5o();this.cac=this.Gye();this.cda=this.mOm();this.n9g=new F.a(T);this.jzk=new R.a(T);this.dQk=new N.a(T);this.Umk=new H(T);this.xOc=W;this.hIb=new a.a;this.MPc&&(this.n9g=new F.a(T));T.Rka&&(this.Q7e=this.tMd=this.MPc=this.Tkb=this.IPc=this.JPc=this.R7e=this.uMd=
this.SEh=this.rMd=this.qMd=this.KPc=!1,U.AFrameworkApplication.J&&this.Ay("File")&&this.yTj()||this.cac)&&(T=this.hIb.eOf("Search",U.AFrameworkApplication.J.jb("TellMeServiceAuthEndpointForSearch")),this.g0c(T,"TellMeService",!0),T=this.hIb.eOf("SmartLookup",U.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint")),this.g0c(T,"Shredder",!1));U.AFrameworkApplication.J&&this.Tkb&&this.Ay("File")&&this.yTj()&&(T=this.hIb.eOf("Search",U.AFrameworkApplication.J.jb("TellMeServiceAuthEndpointForSearch")),
this.g0c(T,"TellMeService",!0))}Ay(T){return Array.contains(this.Uhb,T)?!0:!1}lN(){return"TellMeService"}gX(){return 0===this.kc.kw?0:1===this.kc.kw?1:this.Ay("Command")||this.Ay("Recommended")?2:3}jOm(T){let ba="";if(!T&&this.Ay("Command")&&this.kc.nZf){ba+="CommandSearch_DLIS,";var W=this.kc.Q_j;0<W.length&&(ba+=W+",")}T&&this.Ay("Recommended")&&this.KPc&&(W=this.vSm(),0<W.length&&(ba+=W+","));!T&&this.Ay("Help")&&(T=this.kc.P_j,0<T.length&&(ba+=T+","));this.kc.Rka&&this.H4a&&0<this.H4a.length&&
(ba+="IsRecallEnabled_true,");(this.kc.mhc||this.kc.D0d||this.kc.Rka)&&this.Tkb&&(ba+="IsGenerateSlidesEnabled_true,");0<ba.length&&(ba=ba.substr(0,ba.length-1));return ba}g0c(T,ba,W){const aa=W?this.rsh:this.ish;if(!aa||window.performance.now()-aa>=y.a.Veb)if(T)W?this.rsh=window.performance.now():this.ish=window.performance.now(),T.then(Y=>{W?this.DQc=Y:(this.H4a=Y,D.TellMeActor.instance.yCg=Y)},Y=>{D.TellMeActor.instance.Ye.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"tellMeServiceToken promise rejected: "+
Y)});else if(D.TellMeActor.instance.Ye)D.TellMeActor.instance.Ye.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"undefined token promise")}XJ(T,ba,W,aa=f.a.mu,Y=null){const da=new v.a(T);W=y.a.yU(T);this.Ay("File")&&(this.Tkb||this.kc.Rka)&&this.g0c(this.hIb.nOm(),"TellMeService",!0);(this.Ay("File")&&this.kc.Rka||this.Ay("ActionAI")&&this.cac)&&this.g0c(this.hIb.lLm(),"Shredder",!1);var ka=this.Tkb&&!!this.DQc;const qa=this.kc.Rka&&!!this.H4a;var ua=ka||qa||W&&this.Ay("Recommended")&&this.KPc;
ka=ka||qa||!W&&(this.QEh&&this.Ay("Command")||this.qMd&&this.Ay("Answer")||this.rMd&&this.Ay("Definition")||this.R7e&&this.Ay("Image")||this.MPc&&this.Ay("Help")||this.uMd&&this.Ay("WolframAnswer")||this.tMd&&this.Ay("Template")||this.Q7e&&this.Ay("Addin"));if(ua||ka)if(this.Dja=aa,aa={"Content-Type":"application/json",Accept:"application/json"},aa["X-Office-Version"]=U.AFrameworkApplication.buildVersion,aa["X-Office-Application"]=U.AFrameworkApplication.J.jb("Application"),aa["X-Office-Platform"]=
"WAC",aa["X-TellMe-SqmUserId"]=U.AFrameworkApplication.J.jb("LoggableUserId")||"",aa["X-TellMe-SessionId"]=D.TellMeActor.instance.Z8d(),this.DQc&&(aa.Authorization="Bearer "+this.DQc),this.H4a&&0<this.H4a.length&&(aa["X-TellMe-ShredderToken"]="Bearer "+this.H4a),ua=this.jOm(W),0<ua.length&&(aa["X-TellMe-Flights"]=ua),ua=[],!W&&this.Ay("Answer")&&this.qMd&&(Y?Array.contains(Y,9):1)&&Array.add(ua,"Answer"),!W&&this.Ay("Command")&&this.QEh&&!G.CommandResultsUtility.IWf(T.Vg)&&(Y?Array.contains(Y,17):
1)&&Array.add(ua,"Command"),!W&&this.Ay("Definition")&&this.rMd&&(Y?Array.contains(Y,10):1)&&Array.add(ua,"Definition"),!W&&this.Ay("Help")&&this.MPc&&(Y?Array.contains(Y,8):1)&&Array.add(ua,"Help"),!W&&this.Ay("WolframAnswer")&&this.uMd&&(Y?Array.contains(Y,12):1)&&Array.add(ua,"WolframAnswer"),W&&this.Ay("Recommended")&&this.KPc&&!D.TellMeActor.instance.ztd&&(Y?Array.contains(Y,18):1)&&Array.add(ua,"Recommended"),!W&&this.Ay("Image")&&this.R7e&&(Y?Array.contains(Y,19):1)&&Array.add(ua,"Image"),
this.DQc&&this.Tkb&&(Y?Array.contains(Y,14)||Array.contains(Y,15)||Array.contains(Y,20):1)&&(this.RIb.vDa(),this.sMd&&this.Ay("File")&&Array.add(ua,"File"),this.JPc&&this.Ay("People")&&Array.add(ua,"People"),this.IPc&&this.Ay("Notes")&&Array.add(ua,"Notes")),this.H4a&&0<this.H4a.length&&this.kc.Rka&&(Y?Array.contains(Y,15):1)&&(this.RIb.vDa(),this.Ay("File")&&Array.add(ua,"File")),!W&&this.Ay("Template")&&this.tMd&&(Y?Array.contains(Y,23):1)&&Array.add(ua,"Template"),!W&&this.Ay("Addin")&&this.Q7e&&
(Y?Array.contains(Y,27):1)&&Array.add(ua,"Addin"),!W&&this.Ay("ActionAI")&&this.cac&&(Y?Array.contains(Y,25):1)&&Array.add(ua,"ActionAI"),ua.length){aa["X-TellMe-SuggestionTypes"]=ua.join(",");aa["X-TellMe-Culture"]=U.AFrameworkApplication.uiCulture;aa["X-TellMe-ProcessSessionId"]=U.AFrameworkApplication.userSessionId;var Pa=this.gT=V.a.create().toString();aa["Client-Request-Id"]=Pa;var Ja=window.performance.now();this.iIa();this.i5=window.setTimeout(()=>{if(Pa===this.gT){this.gT="";this.i5=-1;ba.Kt(da);
const Ca={};Ca[l.a.provider]=this.lN();Ca[l.a.nYb]=T.Swb;D.TellMeActor.instance.Ye.gC(w.a.jHg,this.xOc,Ca)}},this.xOc);this.If.Xj(this.cda,2,this.lOm(T.Vg),aa,!1,0,Ca=>{this.RWb(Ca,T,ba,Pa,Ja,Y)},Ca=>{this.EWb(Ca,T,ba,Pa,Ja)},null,null,!1,4E3,this.cac?3E4:6E3)}else D.TellMeActor.instance.Ye.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ba.Kt(da);else ba.Kt(da)}iIa(){-1!==this.i5&&(window.clearTimeout(this.i5),this.i5=-1)}RWb(T,ba,W,aa,Y,da){const ka=new v.a(ba);if(aa===
this.gT){this.iIa();D.TellMeActor.instance.Ye.Lba(ba.Vg.length,this.Uhb.join(","),T.data.He.toString(),Math.round(window.performance.now()-Y),O.a.mu,!0,z.a.iWa);aa=T.data.Pe;T=null;try{T=X.b(aa)}catch(ra){D.TellMeActor.instance.Ye.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ra);return}aa=y.a.yU(ba);if("Groups"in T&&T.Groups){var qa=T.Groups;for(var ua of qa)if("GroupType"in ua&&"Suggestions"in ua&&ua.Suggestions)if("Commands"===ua.GroupType&&(da?Array.contains(da,
17):1)||"Recommended"===ua.GroupType&&(da?Array.contains(da,18):1)){var Pa=(qa="Recommended"===ua.GroupType)?"DLIS":"NaiveBayes";"Source"in ua&&ua.Source&&(Pa=ua.Source);var Ja=ua.Suggestions;new m.a;var Ca=[];for(const ra of Ja)this.bvn(ra)&&(Ja=ra.Type,("Command"===Ja||qa&&"Recommended"===Ja)&&Ca.push(new K.a(ra.CommandId,ra.Score)));G.CommandResultsUtility.Jhe(Ca,!ba.Vg.trim().length,ua.GroupType,Pa);Pa=D.TellMeActor.instance.G5;Ja=[];for(const ra of Ca)qa&&Pa&&Pa.qqf(ra.commandId)||Ja.push(ra);
Ca=G.CommandResultsUtility.o4c(ba,Ja,this.kc,null,null,null,qa?18:17,0);0<Ca.results.length&&(this.Dja!==f.a.contextMenu&&(Ca.displayName=qa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ka.gw(Ca))}else if("Answer"===ua.GroupType){Ja=ua.Suggestions;qa=null;Ca=2147483647;Pa="";for(const ra of Ja)if(this.avn(ra))if(Pa=ra.Type,Ja=this.XGm(Pa),"Answer"===Pa&&this.qMd){qa=this.tai(Pa,ra,ba.Vg);break}else Ja&&Ja<Ca&&(Ca=Ja,qa=this.tai(Pa,ra,ba.Vg));Ca=y.a.CIo(ba.Vg,
Pa);qa&&(da?Array.contains(da,qa.type):1)&&(Pa=[],this.pMd?this.kc.TAa?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa.value,qa.BE)),D.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa.value,qa.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa.value,Ca))):(Pa.push(appChrome.actions.setControlLabel(qa.value,qa.BE)),Pa.push(appChrome.actions.updateCompoundButtonDescription(qa.value,qa.description)),
Pa.push(appChrome.actions.setCompoundButtonCommandValueId(qa.value,Ca)),appChrome.api.dispatch(Pa)):this.kc.TAa?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa.value,qa.BE+" - "+qa.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(qa.value,Ca))):(Pa.push(appChrome.actions.setControlLabel(qa.value,qa.BE+" - "+qa.description)),Pa.push(appChrome.actions.setButtonCommandValueId(qa.value,Ca)),appChrome.api.dispatch(Pa)),Ca=this.sKl(qa.type),
Ca.jy(qa),ka.gw(Ca))}else"Help"===ua.GroupType&&ua.Suggestions.length&&(da?Array.contains(da,8):1)?this.MPc&&(qa=this.n9g.Frb(ba,ua.Suggestions))&&0<qa.results.length&&ka.gw(qa):"Template"===ua.GroupType&&(da?Array.contains(da,23):1)?(qa=ua.Suggestions)&&0<qa.length&&this.dQk.Frb(ba,ka,qa):"Addin"===ua.GroupType&&(da?Array.contains(da,27):1)?(qa=ua.Suggestions)&&0<qa.length&&this.Umk.Frb(ba,ka,qa):"ActionAI"===ua.GroupType&&(da?Array.contains(da,25):1)?(Ca=ua.Suggestions,qa=[],new u.a(25),Ca&&1===
Ca.length&&(Pa=Ca[0])&&Pa.CommandId&&(Ca=Pa.CommandId,qa.push(new K.a(Ca,"Score"in Pa?Pa.Score:0)),qa=G.CommandResultsUtility.o4c(ba,qa,this.kc,null,null,null,25,0),qa.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ka.gw(qa))):"Substrate"===ua.GroupType&&this.Tkb&&"Type"in ua?"File"===ua.Type&&this.sMd&&(da?Array.contains(da,15):1)?(qa=this.RIb.IIf(ua.Suggestions,aa,this.Dja))&&0<qa.results.length&&(this.Mde()&&(Ca=new x.a("GenerateSlidesFromTellMe",30,"",null,1),qa.jy(Ca)),ka.gw(qa)):
"People"===ua.Type&&this.JPc&&(da?Array.contains(da,14):1)?(qa=this.RIb.MDi(ua.Suggestions,aa,this.Dja))&&0<qa.results.length&&ka.gw(qa):"Notes"===ua.Type&&this.IPc&&(da?Array.contains(da,14):1)&&(qa=this.RIb.xCi(ua.Suggestions,aa,ba))&&0<qa.results.length&&ka.gw(qa):"Recall"===ua.GroupType&&this.kc.Rka&&"Type"in ua&&"IntentService"===ua.Type&&(da?Array.contains(da,15):1)&&(qa=this.RIb.IIf(ua.Suggestions,aa,this.Dja))&&0<qa.results.length&&(this.Mde()&&(Ca=new x.a("GenerateSlidesFromTellMe",30,"",
null,1),qa.jy(Ca)),ka.gw(qa));else D.TellMeActor.instance.Ye.onError("OnSuccessCallBack","GroupType"in ua?"Invalid group suggestions found for "+ua.GroupType:"Invalid group found")}if(T.Intents){ua=T.Intents;for(const ra of ua)this.P0f(ra)&&("Image"===ra.GroupType&&ra.ConfidenceScore>ra.ConfidenceThreshold&&(da?Array.contains(da,19):1)?this.jzk.Frb(ba,ka,0,ra):"Commands"===ra.GroupType&&ra.ConfidenceScore<ra.ConfidenceThreshold&&(da?Array.contains(da,17):1)&&(ua=new u.a(17),ka.gw(ua)))}W.Kt(ka);D.TellMeActor.instance.Ye.Lba(ba.Vg.length,
this.Uhb.join(","),"",Math.round(window.performance.now()-Y),"",!0,z.a.provider)}}EWb(T,ba,W,aa,Y){const da=new v.a(ba);aa===this.gT&&(this.iIa(),D.TellMeActor.instance.Ye.Lba(ba.Vg.length,this.Uhb.join(","),T.data.He.toString(),Math.round(window.performance.now()-Y),O.a.mu,!1,z.a.iWa));W.Kt(da)}XGm(T){switch(T){case "Entity":return this.SEh?3:0;case "Definition":return this.rMd?5:0;case "WolframAnswer":return this.uMd?2:0;default:return 0}}tai(T,ba,W){switch(T){case "Answer":return new x.a(this.pMd?
"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ba.Title?W:ba.Title,ba.Description,0);case "Entity":return new x.a(this.pMd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ba.Title?W:ba.Title,ba.Description,0);case "Definition":return new x.a(this.pMd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ba.Title?W:ba.Title,ba.Description,0);case "WolframAnswer":return new x.a("WolframForSearch",3,""===ba.Title?W:ba.Title,ba.Description,0);default:return null}}sKl(T){switch(T){case 0:return new u.a(9,
CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.kc.vxc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}avn(T){return"Type"in T&&!!T.Type&&""!==T.Type&&"Description"in T&&!!T.Description&&""!==T.Description}bvn(T){return"Type"in T&&!!T.Type&&""!==
T.Type&&"CommandId"in T&&!!T.CommandId&&""!==T.CommandId&&"Score"in T&&!!T.Score}P0f(T){if("GroupType"in T&&T.GroupType&&"ConfidenceScore"in T&&"ConfidenceThreshold"in T)return!0;D.TellMeActor.instance.Ye.onError("IsValidIntentGroup","Invalid intents found");return!1}lOm(T){const ba=y.a.c2i(T),W={};W.Query=T;ba&&this.KPc&&(this.won()?W.UserActionEvents=D.TellMeActor.instance.EJh:(W.CommandClickedEvents=D.TellMeActor.instance.OMe,W.CommandActionEvents=D.TellMeActor.instance.Cbh),W.TellMeCommandClickMruEvents=
D.TellMeActor.instance.jvh,W.ContentType=D.TellMeActor.instance.XYd);this.tMd&&(T={},T.Application=this.kc.application,W.TemplateInfo=T);return X.c(W)}q0b(){return!!this.kc&&this.kc.q0b||!!U.AFrameworkApplication.ua&&U.AFrameworkApplication.ua.Gb.q0b}r0b(){return!!this.kc&&this.kc.r0b||!!U.AFrameworkApplication.ua&&U.AFrameworkApplication.ua.Gb.r0b}s0b(){return!!this.kc&&this.kc.s0b||!!U.AFrameworkApplication.ua&&U.AFrameworkApplication.ua.Gb.s0b}t0b(){return!!this.kc&&this.kc.t0b||!!U.AFrameworkApplication.ua&&
U.AFrameworkApplication.ua.Gb.t0b}Bxc(){return!!this.kc&&(this.kc.Bxc||this.kc.oS)}v5o(){return!!this.kc&&!this.kc.xab}P5o(){return!!this.kc&&this.kc.aad}u5o(){return!!this.kc&&this.kc.Sen&&this.kc.Pen}Gye(){return!!this.kc&&this.kc.Gye}N2i(){return!!U.AFrameworkApplication.J&&U.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}O2i(){return!!U.AFrameworkApplication.J&&U.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",
!1)}won(){return!!U.AFrameworkApplication.J&&U.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}Mde(){return!!U.AFrameworkApplication.J&&U.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}yTj(){return!!U.AFrameworkApplication.J&&U.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}vSm(){return U.AFrameworkApplication.J?
U.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}mOm(){if(!U.AFrameworkApplication.J)return"";if(this.O2i())return U.AFrameworkApplication.J.jb("TellMeServiceProdEndpointForSearch");if(this.N2i())return U.AFrameworkApplication.J.jb("TellMeServiceEdogEndpointForSearch");if(y.a.nXf())return U.AFrameworkApplication.J.jb("TellMeServiceIntEndpointForSearch");let T=U.AFrameworkApplication.J.jb("TellMeServiceSearchEndpoint");T&&""!==T||(T=U.AFrameworkApplication.O_j);
return T}static Xai(T,ba){if(ba)return new Q(T,["Command","Recommended"],T.dsm);ba=y.a.ota()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new Q(T,ba,T.FGi)}}Object(I.a)(Q,"TellMeServiceProvider",null,[85])},1810:function(I,J,d){I=d(0);var m=d(224),f=d(1615),a=d(183),l=d(1494);class w extends f.a{constructor(x,u,v,D,y,H,F,G,K,R,E,N,O,U){super(x,3,u,v,D,y,H,G,K,R,E,N,
O,U);this.WLe=F}get character(){return this.WLe}get text(){return this.character.toString()}Eod(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}ejc(){return"CharRun"}clone(){return new w(this.LSc,this.source,this.xk,this.Rg,this.runId,this.oL,this.character,this.tvb,this.dXa,this.wfa,this.wKa,this.jZa,this.dA,this.$u)}aC(x,u,v,D=!1){return super.aC(x,u,v,D)?x.character===this.character?!0:l.a.MTh(x.character,this.character):!1}}Object(I.a)(w,"CharRunMergeBlock",
f.a,[]);d.d(J,"a",function(){return z});class z extends f.a{constructor(x,u,v,D,y,H,F,G,K,R,E,N,O,U,X){super(x,1,u,v,D,y,H,G,R,E,N,O,U,X);this._text=F;this.B9e=K}get text(){return this._text}Eod(x){this._text=x}get Deb(){return this.B9e&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.B9e)}ejc(){return"TextRun"}clone(){return new z(this.LSc,this.source,this.xk,this.Rg,this.runId,this.oL,this._text,this.tvb,this.B9e,this.dXa,this.wfa,
this.wKa,this.jZa,this.dA,this.$u)}aC(x,u,v,D=!1){return super.aC(x,u,v,D)?l.a.LTh(this._text,x._text):!1}Wpd(){const x=new m.a;for(let v=0;v<this.text.length;v++){var u=l.a.charAt(this._text,v);if(l.a.Itn(l.a.Vlp(u))){let D="";D+=u;u=l.a.charAt(this._text,++v);D+=u;u=new z(this.LSc,this.source,this.xk,this.Rg,this.runId,this.oL,D,this.tvb,!1,this.dXa,this.wfa,this.wKa,this.jZa,this.dA,this.$u);x.add(u)}else u=new w(this.LSc,this.source,this.xk,this.Rg,this.runId,this.oL,u,this.tvb,this.dXa,this.wfa,
this.wKa,this.jZa,this.dA,this.$u),x.add(u)}return x}}Object(I.a)(z,"TextRunMergeBlock",f.a,[])},1811:function(I,J,d){I=d(0);var m=d(272),f=d(33),a=d(13),l=d(5),w=d(103),z=d(817),x=d(177),u=d(224),v=d(364),D=d(1399);class y{constructor(G,K,R){this.position=G;this.leader=K;this.val=R}equals(G){return this.position===G.position&&this.leader===G.leader&&this.val===G.val}toString(){return this.position.toString()}}Object(I.a)(y,"TabStop",null,[]);var H=d(1942);d.d(J,"a",function(){return F});class F extends D.a{constructor(){super();
this.COd=null}get Ao(){return 20}get Knp(){return this.COd?this.COd:this.COd=new Set([z.a.yb(f.a.yWa),z.a.yb(f.a.sUa),z.a.yb(f.a.h0a)])}get MB(){return 0}hl(){const G=super.hl();G.W(z.a.yb(a.a.zn),1);G.W(z.a.yb(a.a.Sn),1);G.W(z.a.yb(a.a.An),1);G.W(z.a.yb(l.a.It),1);G.W(z.a.yb(l.a.Iq),1);G.W(z.a.yb(l.a.ed),1);G.W(z.a.yb(a.a.hzb),1);G.W(z.a.yb(l.a.QVa),1);G.W(z.a.yb(l.a.RMa),1);G.W(z.a.yb(a.a.pCa),1);G.W(z.a.yb(l.a.UKa),1);G.W(z.a.yb(l.a.Hka),1);G.W(z.a.yb(l.a.VKa),1);G.W(z.a.yb(l.a.bJa),1);G.W(z.a.yb(l.a.WKa),
1);G.W(z.a.yb(l.a.cJa),1);G.W(z.a.yb(l.a.QMa),1);G.W(z.a.yb(l.a.COa),1);G.W(z.a.yb(l.a.DOa),1);G.W(z.a.yb(l.a.qEa),1);G.W(z.a.yb(l.a.Kw),1);G.W(z.a.yb(f.a.yWa),1);G.W(z.a.yb(f.a.sUa),1);G.W(z.a.yb(f.a.h0a),1);G.W(z.a.yb(l.a.hC),1);G.W(z.a.yb(l.a.iC),1);G.W(z.a.yb(l.a.Dy),1);G.W(z.a.yb(w.a.ena),6);G.W(z.a.yb(w.a.ZJ),6);G.W(z.a.yb(w.a.K0a),6);G.W(z.a.yb(l.a.YLb),7);G.W(z.a.yb(w.a.ZJ),6);G.W(z.a.yb(l.a.WVj),2);G.W(z.a.yb(w.a.Kzl),2);G.W(z.a.yb(w.a.W9n),2);G.W(z.a.yb(l.a.cAc),2);G.W(z.a.yb(l.a.Trd),2);
G.W(z.a.yb(l.a.Q1b),2);G.W(z.a.yb(l.a.bfb),2);G.W(z.a.yb(l.a.Urd),2);G.W(z.a.yb(l.a.Vrd),2);G.W(z.a.yb(l.a.V4f),2);G.W(z.a.yb(l.a.listID),3);G.W(z.a.yb(l.a.listLevel),3);return G}HD(G,K){var R=G.Hu.runtime.rc,E=R.isFeatureEnabled(109);if(K===z.a.yb(a.a.zn)||K===z.a.yb(a.a.Sn)||K===z.a.yb(a.a.An)||K===z.a.yb(l.a.It)||K===z.a.yb(l.a.Iq)||K===z.a.yb(l.a.ed)||K===z.a.yb(a.a.hzb)||K===z.a.yb(l.a.QVa)||K===z.a.yb(l.a.RMa)||K===z.a.yb(a.a.pCa)||K===z.a.yb(l.a.UKa)||K===z.a.yb(l.a.Hka)||K===z.a.yb(l.a.VKa)||
K===z.a.yb(l.a.bJa)||K===z.a.yb(l.a.WKa)||K===z.a.yb(l.a.cJa)||K===z.a.yb(l.a.QMa)||K===z.a.yb(l.a.COa)||K===z.a.yb(l.a.DOa)||K===z.a.yb(l.a.qEa)||K===z.a.yb(l.a.Kw)||K===z.a.yb(l.a.gQ)||this.xNn(K,E)){var N=G.Ro.value.Sv;E=G.Ro.value.Lf;K=G.hh.value.Lf;if(G.Hu.runtime.ITa.contains(N.id))return x.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",N.id),!0;if(R.xrb(1000005)&&this.xap(G,K,E))return G.Rl=K.GO(),
F.tNh(G),F.dRd(G.Hu,G.tf,E),!0;R=new u.a;R.add(N);N=new u.a;N.add(E);E=new u.a;E.add(K);if(!({Sq:K}=F.f4j(G.Hu,R,E,N)).returnValue)return G.XMg=!0,G.Rl=null,!1;F.tNh(G);G.Rl=K.ug(0).zm;return!0}return K===z.a.yb(l.a.hC)||K===z.a.yb(l.a.iC)||K===z.a.yb(l.a.Dy)?(this.aqp(G),G.Yg.add(z.a.yb(l.a.hC)),G.Yg.add(z.a.yb(l.a.iC)),G.Yg.add(z.a.yb(l.a.Dy)),!0):!1}xap(G,K,R){K=G.tf.getPropertyString(K,l.a.gQ);G=G.tf.getPropertyString(R,l.a.gQ);return K||G?!0:!1}aqp(G){const K=G.tf,R=G.Rl;var E=G.Ro.value.Lf,
N=G.hh.value.Lf;G=this.PHf(G.Ro.value.Sv,K);N=this.PHf(N,K);E=this.PHf(E,K);({KNn:E,LNn:G,MNn:N}=this.hAm(G,N,E));E.length?(K.setPropertyUint32s(R,l.a.Dy,E),K.setPropertyUint32s(R,l.a.hC,G),K.setPropertyUint32s(R,l.a.iC,N)):this.nzo(R)}PHf(G,K){const R=K.getPropertyUint32s(G,l.a.Dy),E=K.getPropertyUint32s(G,l.a.hC);G=K.getPropertyUint32s(G,l.a.iC);K=new u.a;if(!R)return K;for(let N=0;N<R.length;++N)K.add(new y(R.K(N),E.K(N),G.K(N)));return K}hAm(G,K,R){({Rpj:K,Spj:U,Tpj:O}=this.nwi(G,K));let E,N;
({Rpj:R,Spj:E,Tpj:N}=this.nwi(G,R));G=this.kVm(G,U,O,E,N);var O=this.jVm(G,K,R);G=new u.a;K=new u.a;var U=new u.a;for(R=0;R<O.length;++R)G.add(O.K(R).position),K.add(O.K(R).leader),U.add(O.K(R).val);return{KNn:G,LNn:K,MNn:U}}nwi(G,K){let R,E,N;R=new u.a;E=new v.a;N=new v.a;let O,U;for(O=U=0;O<G.length&&U<K.length;)G.K(O).position===K.K(U).position?(G.K(O).equals(K.K(U))||N.W(G.K(O).position,K.K(U)),++O,++U):G.K(O).position<K.K(U).position?(E.W(G.K(O).position,G.K(O)),++O):(R.add(K.K(U)),++U);for(;O<
G.length;)E.W(G.K(O).position,G.K(O)),++O;for(;U<K.length;)R.add(K.K(U)),++U;return{Rpj:R,Spj:E,Tpj:N}}kVm(G,K,R,E,N){const O=new u.a;for(let U=0;U<G.length;++U){const X=G.K(U).position;K.tb(X)||(R.tb(X)?O.add(R.K(X)):E.tb(X)||(N.tb(X)?O.add(N.K(X)):O.add(G.K(U))))}return O}jVm(G,K,R){K=this.Fdj(K,R);return this.Fdj(G,K)}Fdj(G,K){const R=new u.a;let E,N;for(E=N=0;E<G.length&&N<K.length;)G.K(E).position<=K.K(N).position?(R.add(G.K(E)),G.K(E).position===K.K(N).position&&++N,++E):R.add(K.K(N++));for(;E<
G.length;)R.add(G.K(E++));for(;N<K.length;)R.add(K.K(N++));return R}nzo(G){G.removeProperty(l.a.Dy);G.removeProperty(l.a.hC);G.removeProperty(l.a.iC)}static Ih(){return new F}static get instance(){return F.gh.value}static tNh(G){G.Yg.add(z.a.yb(a.a.zn));G.Yg.add(z.a.yb(a.a.Sn));G.Yg.add(z.a.yb(a.a.An));G.Yg.add(z.a.yb(l.a.It));G.Yg.add(z.a.yb(l.a.Iq));G.Yg.add(z.a.yb(l.a.ed));G.Yg.add(z.a.yb(a.a.hzb));G.Yg.add(z.a.yb(l.a.QVa));G.Yg.add(z.a.yb(l.a.RMa));G.Yg.add(z.a.yb(a.a.pCa));G.Yg.add(z.a.yb(l.a.UKa));
G.Yg.add(z.a.yb(l.a.Hka));G.Yg.add(z.a.yb(l.a.VKa));G.Yg.add(z.a.yb(l.a.bJa));G.Yg.add(z.a.yb(l.a.WKa));G.Yg.add(z.a.yb(l.a.cJa));G.Yg.add(z.a.yb(l.a.QMa));G.Yg.add(z.a.yb(l.a.COa));G.Yg.add(z.a.yb(l.a.DOa));G.Yg.add(z.a.yb(l.a.qEa));G.Yg.add(z.a.yb(l.a.Kw));G.Yg.add(z.a.yb(l.a.gQ))}static f4j(G,K,R,E){return(new H.a(G,K,R,E)).oAc()}static dRd(G,K,R){R=K.getPropertyObjectIds(R,a.a.Sn);for(let N=0;N<R.length;N++){var E=G.runtime.sv.K(R.ug(N));if(E&&(E=K.getPropertyObjectId(E,l.a.se))){G.runtime.cyc.add(E);
break}}}xNn(G,K){return K?this.Knp.has(G)?!0:!1:!1}}F.gh=new m.a(F.Ih);Object(I.a)(F,"ParagraphNodeComplexMerge",D.a,[])},1941:function(I,J,d){d.r(J);d.d(J,"MarkerValidation",function(){return a});I=d(0);var m=d(364),f=d(1746);class a{constructor(){this.$be=this.ETi=this.DTi=this.CTi=0}Iwi(){const l=new m.a(0);l.W("InvalidBookmarks",this.CTi);l.W("InvalidComments",this.DTi);l.W("InvalidContentControls",this.ETi);0!==this.$be&&l.W("InvalidMarkerType",this.$be);return l}$Mi(){return 0<this.CTi||0<this.DTi||
0<this.ETi||0!==this.$be?!0:!1}toString(){return JSON.stringify(f.a.O0a(this.Iwi()))}}Object(I.a)(a,"MarkerValidation",null,[])},1942:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);var m=d(177),f=d(1051),a=d(241),l=d(1644),w=d(1519);class z{constructor(x,u,v,D,y=null,H=null,F=null,G=null){this.fe=x;this.BH=u;this.NFa=v;this.hHa=D;this.UEk=y;this.pvk=H;this.yRk=F;this.Jwa=G||this.Zrf()}Zrf(){return x=>!!this.fe.runtime.rc&&this.fe.runtime.rc.isFeatureEnabled(x)}RFl(){return()=>this.fe.runtime.rc}Nxf(){return!!this.fe.runtime.Gn.K(a.a.MN)}oWj(){let x;
if(1===this.fe.input.source||2===this.fe.input.source)x=72;else if(4===this.fe.input.source||3===this.fe.input.source)x=33;else if(5===this.fe.input.source)x=110;else return!1;return this.Nxf()&&this.Jwa(x)}yYj(x,...u){return String.format.apply(null,[x].concat(u))}B7d(x){const {ParagraphMerge:u}=d(2030);let v=this.fe,D=this.NFa,y=this.hHa;x||(v=this.UEk||this.fe,D=this.pvk||D,y=this.yRk||y);var H=w.a.EKf(this.BH);const F=w.a.EKf(D),G=w.a.EKf(y);H=this.yYj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
v.input.source,v.runtime.qIa.id,v.runtime.d2d,v.runtime.VDe,H.Qr(),F.Qr(),G.Qr());return x?{returnValue:new l.a(v,this.BH,D,y,this.Zrf(),new f.a),Qr:H}:{returnValue:new u(v,this.BH,D,y,this.Zrf(),this.RFl(),new f.a),Qr:H}}oAc(){this.fe.logger.YXo();var x=this.oWj();var u=({Qr:D}=this.B7d(x)).returnValue;m.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",x,D);this.fe.logger.KX("ParagraphMergeSelector initialization");x?this.fe.logger.txe(1):this.fe.logger.txe(2);
let v=({Sq:u}=u.oAc()).returnValue;this.fe.logger.Byg();var D=!v;x=!!this.fe.runtime.Gn.K(a.a.MN)&&(x&&!v||!x);D&&({Qr:D,returnValue:u}=this.B7d(!1),{Sq:u,returnValue:v}=u.oAc(),m.a.instance.Ua(18994390,1,v?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",v,D));x&&(D=new f.a,w.a.vHo(this.fe,D));this.fe.logger.KX("ParagraphMergeSelector finalization");return{returnValue:v,Sq:u}}Msd(x,u){let v,D,y;const H=this.oWj()&&this.Jwa(111);let F=({Qr:y}=this.B7d(H)).returnValue,G=({jdb:v,
Nua:D}=F.Msd(x,u)).returnValue;m.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",H,y);H&&!G&&F.dug&&({Qr:y,returnValue:F}=this.B7d(!1),{jdb:v,Nua:D,returnValue:G}=F.Msd(x,u),m.a.instance.Ua(18994392,1,G?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",G,y));return{returnValue:G,jdb:v,Nua:D}}}Object(I.a)(z,"ParagraphMergeSelector",null,[1063])},1943:function(I,J,d){d.r(J);d.d(J,"SurfaceStringTokenStringGenerator",
function(){return f});I=d(0);var m=d(1558);class f extends m.a{constructor(a){super(a);this.Bb=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.FIi(x,l));v=m.a.DOh(a,u,this.Bb.score,w,z,v);return{Erd:u,sUc:v}}}f.tUc=0;Object(I.a)(f,"SurfaceStringTokenStringGenerator",m.a,[])},1944:function(I,J,d){d.r(J);d.d(J,"QueryTokenStringGenerator",function(){return a});I=d(0);var m=d(1558),f=d(1401);class a extends m.a{constructor(l){super(l);this.Bb=l}apply(l,w,z,x,u,v,D){w=this.Bb.query.load(w,null);u=0;let y=null;this.Bb.query.s8===
f.Annotations.sEa?w&&(y=this.Bb.name):((y=this.Bb.name)&&(y+="_"),y+=this.Bb.annotations.bia(this.Bb.query.s8,w));null!=y&&(u=m.a.DOh(l,y,this.Bb.score,z,x,u));return{Erd:v,sUc:D+u}}}a.tUc=1;Object(I.a)(a,"QueryTokenStringGenerator",m.a,[])},1945:function(I,J,d){d.r(J);d.d(J,"FuzzyMatchTokenStringGenerator",function(){return f});I=d(0);var m=d(1558);class f extends m.a{constructor(a){super(a);this.Bb=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.FIi(x,l));a=this.Bb.$ki.mIn(u);if(this.Bb.fpj)for(var D of a)if(!D.kR&&
D.g3d)return{Erd:u,sUc:v};D=0;for(const y of a)if(y.kR&&!({Nlf:D}=this.BTh(y,!0,w,z,D)).returnValue)return{Erd:u,sUc:v};if(this.Bb.fQi)for(const y of a)if(!({Nlf:D}=this.BTh(y,!1,w,z,D)).returnValue)break;return{Erd:u,sUc:v}}BTh(a,l,w,z,x){let u;l?(l=0,u=a.g3d?1:0):(l=a.g3d?1:0,u=a.count-l);for(let v=0;v<u;++v)if(m.a.EOh(a.Opb+l+v,this.Bb.score,w,z),++x,0<this.Bb.x7f&&x>=this.Bb.x7f)return{returnValue:!1,Nlf:x};return{returnValue:!0,Nlf:x}}}f.tUc=2;Object(I.a)(f,"FuzzyMatchTokenStringGenerator",m.a,
[])},2020:function(I,J,d){I=d(0);var m=d(59),f=d(5),a=d(39),l=d(272),w=d(1399);class z extends w.a{constructor(){super()}get Ao(){return 2}get MB(){return 7}static Ih(){return new z}static get instance(){return z.gh.value}}z.gh=new l.a(z.Ih);Object(I.a)(z,"AppBindingNodeComplexMerge",w.a,[]);var x=d(13),u=d(817),v=d(177),D=d(1476);class y extends w.a{constructor(){super()}get Ao(){return 3}get MB(){return 7}hl(){const Ha=super.hl();Ha.W(u.a.yb(x.a.DU),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(x.a.DU)){const nc=
Ha.Rl;var ac=Ha.tf;v.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nc.id,nc.sc,zb);zb=ac.getPropertyMilliseconds(Ha.hh.value.Lf,x.a.DU);ac=ac.getPropertyMilliseconds(Ha.Ro.value.Lf,x.a.DU);zb<ac&&this.bnm(Ha);Ha.Yg.add(u.a.yb(x.a.DU));return!0}v.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}bnm(Ha){this.vEo(Ha.Ro.value.Lf,
Ha.Rl);this.eHf(Ha,f.a.WRd);this.eHf(Ha,f.a.jhf);this.eHf(Ha,f.a.ahf)}eHf(Ha,zb){var ac=Ha.tf,nc=Ha.Rl;if(ac.hasProperty(nc,zb)&&(zb=ac.getPropertyObjectIds(nc,zb))&&zb.length)for(ac=Ha.Hu.runtime.sv,Ha=Ha.Hu.runtime.Sq,nc=0;nc<zb.length;nc++){const Gb=zb.K(nc);if(!ac.tb(Gb))continue;const tc=ac.K(Gb).GO();Ha.add(Gb,new D.a(tc,!1))}}static Ih(){return new y}static get instance(){return y.gh.value}}y.gh=new l.a(y.Ih);Object(I.a)(y,"AppNodeComplexMerge",w.a,[]);class H extends w.a{constructor(){super()}get Ao(){return 4}get MB(){return 7}static Ih(){return new H}static get instance(){return H.gh.value}}
H.gh=new l.a(H.Ih);Object(I.a)(H,"AppPropNodeComplexMerge",w.a,[]);class F extends w.a{constructor(){super()}get Ao(){return 5}get MB(){return 7}static Ih(){return new F}static get instance(){return F.gh.value}}F.gh=new l.a(F.Ih);Object(I.a)(F,"AppRefNodeComplexMerge",w.a,[]);var G=d(364),K=d(616),R=d(224),E=d(16);class N{constructor(Ha,zb){this.id=Ha;this.adp=zb}}Object(I.a)(N,"IdAndTime",null,[]);class O extends w.a{constructor(){super()}get Ao(){return 6}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.nTa),
1);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.nTa)){const ac=Ha.Rl,nc=Ha.tf;v.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ac.id,ac.sc,zb);zb=nc.getPropertyObjectIds(Ha.hh.value.Sv,f.a.nTa);const Gb=nc.getPropertyObjectIds(Ha.hh.value.Lf,f.a.nTa),tc=nc.getPropertyObjectIds(Ha.Ro.value.Lf,f.a.nTa);zb=this.EMn(Ha,zb,Gb,tc);0<zb.length?nc.setPropertyObjectIds(ac,f.a.nTa,zb):ac.removeProperty(f.a.nTa);Ha.Yg.add(u.a.yb(f.a.nTa));
return!0}v.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}EMn(Ha,zb,ac,nc){const Gb=this.WLa(zb,ac,nc),tc=zb.vS(),Qb=ac.vS(),Yb=nc.vS();zb=w.a.filter(Gb,Jc=>!tc.contains(Jc)&&Qb.contains(Jc));ac=w.a.filter(Gb,Jc=>!tc.contains(Jc)&&Yb.contains(Jc));if(!zb.length||!ac.length)return Gb;const fc=new G.a;zb.forEach(Jc=>{const jd=new N(Jc,this.gti(Ha,Jc,!1));this.cti(Ha,Jc,!1).forEach(Wc=>
{fc.add(Wc,jd);return!0});return!0});const ib=new K.a;ac.forEach(Jc=>{const jd=this.gti(Ha,Jc,!0);this.cti(Ha,Jc,!0).forEach(Wc=>fc.tb(Wc)?(ib.add(fc.K(Wc).adp>=jd?Jc:fc.K(Wc).id),!1):!0);return!0});return w.a.filter(Gb,Jc=>!ib.contains(Jc))}gti(Ha,zb,ac){return(zb=this.tla(Ha,zb,ac))?Ha.tf.getPropertyMilliseconds(zb,x.a.DU):0}tla(Ha,zb,ac){Ha=ac?Ha.Hu.runtime.sv:Ha.Hu.runtime.JA;return Ha.tb(zb)?Ha.K(zb):null}cti(Ha,zb,ac){const nc=new R.a,Gb=new K.a,tc=Ha.tf;zb=this.tla(Ha,zb,ac);var Qb=this.YEi(tc,
zb);if(Qb)for(nc.add(Qb),Gb.add(Qb),zb=tc.getPropertyObjectIds(zb,f.a.WRd),Qb=0;zb&&Qb<zb.length;Qb++){const Yb=this.YEi(tc,this.tla(Ha,zb.K(Qb),ac));if(!Yb)break;Gb.contains(Yb)||(nc.add(Yb),Gb.add(Yb))}return nc}YEi(Ha,zb){if(!Ha.hasProperty(zb,f.a.oTa)||!Ha.hasProperty(zb,f.a.mmb)||!Ha.hasProperty(zb,f.a.CKb))return null;const ac=Ha.getPropertyString(zb,f.a.oTa),nc=Ha.getPropertyString(zb,f.a.mmb);Ha=Ha.getPropertyString(zb,f.a.CKb);return E.a.tC(ac+";"+nc+";"+Ha)}static Ih(){return new O}static get instance(){return O.gh.value}}
O.gh=new l.a(O.Ih);Object(I.a)(O,"AppsNodeComplexMerge",w.a,[]);class U extends w.a{constructor(){super()}get Ao(){return 36}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.qKg),1);Ha.W(u.a.yb(f.a.Pyg),1);return Ha}HD(Ha,zb){v.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",zb);if(zb===u.a.yb(f.a.qKg)||zb===u.a.yb(f.a.Pyg)){const tc=u.a.s_(zb);var ac=Ha.hh.value.Lf,nc=Ha.Ro.value.Lf;const Qb=Ha.Rl;var Gb=Ha.tf.getPropertyStrings(Ha.hh.value.Sv,tc);ac=Ha.tf.getPropertyStrings(ac,
tc);nc=Ha.tf.getPropertyStrings(nc,tc);Gb=this.WLa(Gb,ac,nc);Ha.tf.setPropertyStrings(Qb,tc,Gb);Ha.Yg.add(zb);return!0}return!1}static Ih(){return new U}static get instance(){return U.gh.value}}U.gh=new l.a(U.Ih);Object(I.a)(U,"AutoSaveParametersNodeComplexMerge",w.a,[]);class X extends w.a{constructor(){super()}get Ao(){return 44}hl(){const Ha=super.hl();Ha.W(u.a.yb(x.a.rg),1);return Ha}HD(Ha,zb){const ac=Ha.Hu.runtime.rc;if(zb===u.a.yb(x.a.rg))return v.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ha.Rl.id,Ha.Rl.sc,zb),ac.LL(115),ac.isFeatureEnabled(115)?this.HMn(Ha,zb):this.dNn(Ha,zb),!0;v.a.instance.Ua(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}HMn(Ha,zb){const ac=u.a.s_(zb),nc=Ha.tf;var Gb=nc.getPropertyObjectIds(Ha.hh.value.Sv,ac),tc=nc.getPropertyObjectIds(Ha.hh.value.Lf,ac),Qb=nc.getPropertyObjectIds(Ha.Ro.value.Lf,ac);Qb=X.hQm(Ha,tc,Qb);Gb=this.WLa(Gb,tc,
Qb);tc=Ha.Rl;0<Gb.length?nc.setPropertyObjectIds(tc,ac,Gb):tc.removeProperty(ac);Ha.Yg.add(zb)}static Ih(){return new X}static get instance(){return X.gh.value}static hQm(Ha,zb,ac){const nc=new R.a,Gb=new G.a;zb.forEach(tc=>{const Qb=Ha.Hu.runtime.JA.K(tc);Qb&&Gb.add(Qb.HF(f.a.tu).toString(),tc);return!0});ac.forEach(tc=>{var Qb=Ha.Hu.runtime.sv.K(tc);Qb?(Qb=Qb.HF(f.a.tu).toString(),Gb.tb(Qb)&&Gb.get(Qb)!==tc?v.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
nc.add(tc)):nc.add(tc);return!0});return nc}}X.gh=new l.a(X.Ih);Object(I.a)(X,"BookmarkContainerNodeComplexMerge",w.a,[]);class V extends w.a{constructor(){super()}get Ao(){return 41}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.$Kb),1);Ha.W(u.a.yb(f.a.tu),1);return Ha}HD(Ha,zb){return zb===u.a.yb(f.a.$Kb)?(Ha.Yg.add(u.a.yb(f.a.$Kb)),!0):zb===u.a.yb(f.a.tu)?(Ha.Yg.add(u.a.yb(f.a.tu)),!0):!1}Qf(Ha){return Ha&&Ha.length?!1:!0}static Ih(){return new V}static get instance(){return V.gh.value}}V.gh=new l.a(V.Ih);
Object(I.a)(V,"BookmarkNodeComplexMerge",w.a,[]);class Q extends w.a{constructor(){super();this.Pce=!1}get Ao(){return 7}hl(){const Ha=super.hl();Ha.W(u.a.yb(x.a.rg),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(x.a.rg)){const Gb=Ha.Rl,tc=Ha.tf;var ac=Ha.Hu.runtime.rc;ac&&(this.Pce=ac.isFeatureEnabled(66));v.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gb.id,Gb.sc,zb);zb=tc.getPropertyObjectIds(Ha.hh.value.Sv,x.a.rg);
ac=tc.getPropertyObjectIds(Ha.hh.value.Lf,x.a.rg);var nc=tc.getPropertyObjectIds(Ha.Ro.value.Lf,x.a.rg);zb=this.QMn(zb,ac,nc);if(this.Pce&&0<zb.length){ac=new Sys.StringBuilder;for(nc=0;nc<zb.length;nc++)ac.append(zb.K(nc).toString()+",");v.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Gb.id,ac.toString())}0<zb.length?tc.setPropertyObjectIds(Gb,x.a.rg,zb):Gb.removeProperty(x.a.rg);Ha.Yg.add(u.a.yb(x.a.rg));return!0}v.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ha.hh.value.Lf.id,zb);return!1}QMn(Ha,zb,ac){const nc=new R.a,Gb=new G.a(0);this.G7l(Ha,ac,nc,Gb);return this.dTl(zb,Gb,nc)}G7l(Ha,zb,ac,nc){Ha=Ha||new R.a;zb=zb||new R.a;Ha.forEach(Gb=>{nc.W(Gb,1);return!0});zb.forEach(Gb=>{nc.Ec(Gb).returnValue?nc.W(Gb,2):(nc.W(Gb,0),ac.add(Gb));return!0})}dTl(Ha,zb,ac){Ha=Ha||new R.a;const nc=new R.a,Gb=new R.a,tc=new R.a;Ha.forEach(Qb=>{let Yb=!0,fc;({value:fc}=zb.Ec(Qb)).returnValue&&(0===fc?zb.W(Qb,2):1===fc&&(Yb=!1));Yb?nc.add(Qb):this.Pce&&Gb.add(Qb);return!0});
ac.forEach(Qb=>{let Yb=!1,fc;({value:fc}=zb.Ec(Qb)).returnValue?0===fc&&(Yb=!0,zb.W(Qb,2)):v.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Qb);Yb?nc.add(Qb):this.Pce&&tc.add(Qb);return!0});this.M$i(Gb,"Favored");this.M$i(tc,"Unfavored");return nc}M$i(Ha,zb){if(Ha.length){var ac=new Sys.StringBuilder;for(let nc=0;nc<Ha.length;nc++)ac.append(Ha.K(nc).toString()+",");v.a.instance.Ua(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",zb,ac.toString())}}static Ih(){return new Q}static get instance(){return Q.gh.value}}Q.gh=new l.a(Q.Ih);Object(I.a)(Q,"CommentContentNodeComplexMerge",w.a,[]);var T=d(80),ba=d(29);class W extends w.a{constructor(){super();this.EGh=[1];this.M4e=new G.a}get Ao(){return 8}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Bea),3);Ha.W(u.a.yb(f.a.ZG),3);Ha.W(u.a.yb(f.a.wnb),2);Ha.W(u.a.yb(f.a.commentId),2);Ha.W(u.a.yb(f.a.ZVc),2);Ha.W(u.a.yb(f.a.nIa),
2);Ha.W(u.a.yb(f.a.VTa),1);Ha.W(u.a.yb(f.a.Mrb),1);Ha.W(u.a.yb(f.a.Xsb),1);Ha.W(u.a.yb(f.a.y6),1);Ha.W(u.a.yb(f.a.yI),1);Ha.W(u.a.yb(f.a.XVc),2);Ha.W(u.a.yb(f.a.gWd),2);Ha.W(u.a.yb(f.a.F6a),2);Ha.W(u.a.yb(f.a.rpf),2);Ha.W(u.a.yb(f.a.HO),1);Ha.W(u.a.yb(x.a.rg),0);Ha.W(u.a.yb(f.a.GJ),0);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.HO)){var ac=Ha.tf.getPropertyString(Ha.Ro.value.Lf,f.a.HO);this.Qf(ac)?Ha.Rl.removeProperty(f.a.HO):Ha.Rl.Udb(f.a.HO,ac);return!0}if(zb!==u.a.yb(f.a.VTa)&&zb!==u.a.yb(f.a.Mrb)&&
zb!==u.a.yb(f.a.Xsb)&&zb!==u.a.yb(f.a.yI)&&zb!==u.a.yb(f.a.y6))return!1;const nc=Ha.hh.value.Sv,Gb=Ha.hh.value.Lf;var tc=Ha.Ro.value.Lf;ac=Ha.Rl;if(zb===u.a.yb(f.a.VTa)){zb=Ha.tf.getPropertyString(Gb,f.a.VTa);tc=Ha.tf.getPropertyString(tc,f.a.VTa);tc=this.Qf(zb)?tc:this.Qf(tc)?zb:null;if(this.Qf(tc))return!0;Ha.tf.setPropertyString(ac,f.a.VTa,tc);Ha.Yg.add(u.a.yb(f.a.VTa));return!0}if(zb===u.a.yb(f.a.Xsb))return zb=Ha.tf.getPropertyBool(Gb,f.a.Xsb),tc=Ha.tf.getPropertyBool(tc,f.a.Xsb),zb=null!=zb?
zb:!1,zb=(null!=tc?tc:!1)||zb,Ha.tf.setPropertyBool(ac,f.a.Xsb,zb),Ha.Yg.add(u.a.yb(f.a.Xsb)),!0;if(zb===u.a.yb(f.a.Mrb)){zb=Ha.tf.getPropertyBool(Gb,f.a.Mrb);tc=Ha.tf.getPropertyBool(tc,f.a.Mrb);if(zb===tc)return!0;zb=null!=zb?zb:!1;zb=(null!=tc?tc:!1)||zb;Ha.tf.setPropertyBool(ac,f.a.Mrb,zb);return!0}if(zb===u.a.yb(f.a.yI)){zb=Ha.tf.getPropertyBool(Gb,f.a.yI);tc=Ha.tf.getPropertyBool(tc,f.a.yI);if(zb===tc)return!0;zb=null!=zb?zb:!1;zb=(null!=tc?tc:!1)||zb;Ha.tf.setPropertyBool(ac,f.a.yI,zb);Ha.Yg.add(u.a.yb(f.a.yI));
return!0}return zb===u.a.yb(f.a.y6)?this.Twl(Ha,nc,Gb,tc,ac):!1}Twl(Ha,zb,ac,nc,Gb){ac=Ha.tf.getPropertyString(ac,f.a.y6);nc=Ha.tf.getPropertyString(nc,f.a.y6);if(ac===nc)return!0;zb=Ha.tf.getPropertyString(zb,f.a.y6);const tc={};for(let Yb=0;Yb<this.EGh.length;Yb++){const fc=this.EGh[Yb];var Qb=this.YLf(zb,fc,0);const ib=this.YLf(ac,fc,1),Jc=this.YLf(nc,fc,2);Qb=this.lNn(Qb,ib,Jc);tc[fc.toString()]=Qb.toArray()}Ha.tf.setPropertyString(Gb,f.a.y6,this.wRo(tc));Ha.Yg.add(u.a.yb(f.a.y6));return!0}lNn(Ha,
zb,ac){const nc=new G.a,Gb=new G.a(0);for(var tc=0;tc<zb.length;tc++){const Yb=zb[tc].UserId;nc.add(Yb,zb[tc]);Gb.add(Yb,0)}for(zb=0;zb<ac.length;zb++)tc=ac[zb].UserId,Gb.tb(tc)?Gb.W(tc,2):(nc.add(tc,ac[zb]),Gb.add(tc,0));for(ac=0;ac<Ha.length;ac++)zb=Ha[ac].UserId,Gb.tb(zb)&&2!==Gb.K(zb)&&Gb.W(zb,1);const Qb=new R.a;Gb.forEach((Yb,fc)=>{if(1===fc)return!0;Qb.add(nc.K(Yb));return!0});return Qb}YLf(Ha,zb,ac){Ha=Object(T.a)(Object,this.UHm(Ha,ac));return zb.toString()in Ha?Array.isArray(Ha[zb.toString()])?
Ha[zb.toString()]:null:[]}UHm(Ha,zb){if(this.M4e.tb(zb))return Object(T.a)(Object,this.M4e.K(zb));Ha=Object(T.a)(Object,this.ORl(Ha));this.M4e.add(zb,Ha);return Ha}ORl(Ha){return Object(T.a)(Object,ba.b(Ha))}wRo(Ha){return ba.c(Ha)}Qf(Ha){return Ha&&Ha.length?!1:!0}static Ih(){return new W}static get instance(){return W.gh.value}}W.gh=new l.a(W.Ih);Object(I.a)(W,"CommentNodeComplexMerge",w.a,[]);class aa extends w.a{constructor(){super()}get Ao(){return 46}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Xd),
1);Ha.W(u.a.yb(x.a.lastModifiedTime),0);Ha.W(u.a.yb(f.a.BWc),2);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.Xd))return v.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ha.Rl.id,Ha.Rl.sc,zb),w.a.Q7f(Ha,this,f.a.Xd);v.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Ha.hh.value.Lf.id,
zb);return!1}static Ih(){return new aa}static get instance(){return aa.gh.value}}aa.gh=new l.a(aa.Ih);Object(I.a)(aa,"ContentControlContainerNodeComplexMerge",w.a,[]);var Y=d(33),da=d(48),ka=d(1799);class qa extends w.a{constructor(){super()}get Ao(){return 37}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.gaa),1);Ha.W(u.a.yb(f.a.fAb),1);Ha.W(u.a.yb(f.a.dXd),2);Ha.W(u.a.yb(f.a.tMb),2);Ha.W(u.a.yb(f.a.Xd),1);Ha.W(u.a.yb(f.a.eba),1);Ha.W(u.a.yb(f.a.tka),1);Ha.W(u.a.yb(f.a.cfc),1);Ha.W(u.a.yb(f.a.Onb),1);
Ha.W(u.a.yb(f.a.Lnb),1);Ha.W(u.a.yb(f.a.Knb),1);Ha.W(u.a.yb(f.a.aUa),2);Ha.W(u.a.yb(f.a.vMb),1);Ha.W(u.a.yb(f.a.eXd),1);Ha.W(u.a.yb(f.a.faa),1);Ha.W(u.a.yb(f.a.DL),2);Ha.W(u.a.yb(f.a.Gza),2);Ha.W(u.a.yb(f.a.Cra),2);Ha.W(u.a.yb(f.a.i3),1);Ha.W(u.a.yb(f.a.Rsa),1);Ha.W(u.a.yb(f.a.Ssa),1);this.rc.isFeatureEnabled(16)&&(Ha.W(u.a.yb(Y.a.Hqf),2),Ha.W(u.a.yb(Y.a.G6h),2),Ha.W(u.a.yb(Y.a.F6h),2),Ha.W(u.a.yb(Y.a.O6h),2),Ha.W(u.a.yb(Y.a.N6h),2));return Ha}HD(Ha,zb){var ac=Ha.hh.value.Lf,nc=Ha.Ro.value.Lf;const Gb=
Ha.Rl;if(zb===u.a.yb(f.a.Xd))return w.a.Q7f(Ha,this,f.a.Xd);if(zb===u.a.yb(f.a.eba)){zb=Ha.tf.getPropertyBool(ac,f.a.eba);nc=Ha.tf.getPropertyBool(nc,f.a.eba);if(null!=zb&&zb||null!=nc&&nc)Ha.tf.setPropertyBool(Gb,f.a.eba,!0),Ha.Yg.add(u.a.yb(f.a.eba));return!0}if(zb===u.a.yb(f.a.tka))return zb=Ha.tf.getPropertyBool(ac,f.a.tka),nc=Ha.tf.getPropertyBool(nc,f.a.tka),Ha.tf.setPropertyBool(Gb,f.a.tka,null!=zb&&!!zb&&null!=nc&&!!nc),Ha.Yg.add(u.a.yb(f.a.tka)),!0;if(zb===u.a.yb(f.a.cfc))return zb=Ha.tf.getPropertyUint32(nc,
f.a.cfc),null!=zb&&(Ha.tf.setPropertyUint32(Gb,f.a.cfc,zb),Ha.Yg.add(u.a.yb(f.a.cfc))),!0;if(zb===u.a.yb(f.a.Onb)||zb===u.a.yb(f.a.Lnb)||zb===u.a.yb(f.a.Knb))return(nc=Ha.tf.getPropertyString(nc,u.a.s_(zb)))&&0<nc.length&&(Ha.tf.setPropertyString(Gb,u.a.s_(zb),nc),Ha.Yg.add(zb)),!0;if(zb===u.a.yb(f.a.vMb)||zb===u.a.yb(f.a.eXd)){ac=Ha.tf.getPropertyObjectId(ac,u.a.s_(zb));if(ka.a.Jjc(Ha.Hu,ac))return!0;if((nc=Ha.tf.getPropertyObjectId(nc,u.a.s_(zb)))&&nc!==da.a.nil)return Ha.tf.setPropertyObjectId(Gb,
u.a.s_(zb),nc),Ha.Yg.add(zb),!0;Gb.removeProperty(u.a.s_(zb));Ha.Yg.add(zb);return!0}if(zb===u.a.yb(f.a.faa)){ac=Ha.tf.getPropertyObjectId(ac,f.a.faa);if((ac=ka.a.Jjc(Ha.Hu,ac))&&Ha.tf.getPropertyObjectIds(ac,f.a.Xd).vS().contains(Ha.Rl.id))return!0;nc=Ha.tf.getPropertyObjectId(nc,f.a.faa);return(ac=ka.a.Jjc(Ha.Hu,nc))&&Ha.tf.getPropertyObjectIds(ac,f.a.Xd).vS().contains(Ha.Rl.id)?(Ha.tf.setPropertyObjectId(Gb,f.a.faa,nc),Ha.Yg.add(zb),!0):!1}if(zb===u.a.yb(f.a.gaa))return zb=Ha.tf.getPropertyBool(nc,
f.a.gaa),null==zb||zb||(Ha.tf.setPropertyBool(Gb,f.a.gaa,!1),Ha.Yg.add(u.a.yb(f.a.gaa))),!0;if(zb===u.a.yb(f.a.fAb)){zb=Ha.tf.getPropertyObjectId(ac,f.a.fAb);nc=Ha.tf.getPropertyObjectId(nc,f.a.fAb);if(zb&&!zb.equals(nc))return!1;if(zb=zb||nc)Ha.tf.setPropertyObjectId(Gb,f.a.fAb,zb),Ha.Yg.add(u.a.yb(f.a.fAb));return!0}zb!==u.a.yb(f.a.i3)&&zb!==u.a.yb(f.a.Rsa)&&zb!==u.a.yb(f.a.Ssa)||v.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",
zb);return!1}static Ih(){return new qa}static get instance(){return qa.gh.value}}qa.gh=new l.a(qa.Ih);Object(I.a)(qa,"ContentControlNodeComplexMerge",w.a,[]);class ua extends w.a{constructor(){super()}get Ao(){return 10}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.cR),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.cR)){zb=Ha.Rl;const nc=Ha.tf;var ac=nc.getPropertyObjectIds(Ha.hh.value.Sv,f.a.cR);const Gb=nc.getPropertyObjectIds(Ha.hh.value.Lf,f.a.cR),tc=nc.getPropertyObjectIds(Ha.Ro.value.Lf,f.a.cR);ac=this.UMn(ac,
Gb,tc);0<ac.length?nc.setPropertyObjectIds(zb,f.a.cR,ac):zb.removeProperty(f.a.cR);Ha.Yg.add(u.a.yb(f.a.cR));return!0}return!1}UMn(Ha,zb,ac){return this.WLa(Ha,zb,ac)}static Ih(){return new ua}static get instance(){return ua.gh.value}}ua.gh=new l.a(ua.Ih);Object(I.a)(ua,"CustomXmlPartContainerNodeComplexMerge",w.a,[]);class Pa extends w.a{constructor(){super()}get Ao(){return 9}get MB(){return 0}static Ih(){return new Pa}static get instance(){return Pa.gh.value}}Pa.gh=new l.a(Pa.Ih);Object(I.a)(Pa,
"CustomXmlPartNodeComplexMerge",w.a,[]);class Ja extends w.a{constructor(){super()}get Ao(){return 29}get MB(){return 3}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Qka),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.Qka)){zb=Ha.tf;var ac=zb.getPropertyObjectIds(Ha.hh.value.Sv,f.a.Qka),nc=zb.getPropertyObjectIds(Ha.hh.value.Lf,f.a.Qka);const Gb=zb.getPropertyObjectIds(Ha.Ro.value.Lf,f.a.Qka);ac=this.WLa(ac,nc,Gb);nc=Ha.Rl;0<ac.length?zb.setPropertyObjectIds(nc,f.a.Qka,ac):nc.removeProperty(f.a.Qka);Ha.Yg.add(u.a.yb(f.a.Qka));
return!0}return!1}static Ih(){return new Ja}static get instance(){return Ja.gh.value}}Ja.gh=new l.a(Ja.Ih);Object(I.a)(Ja,"EmbeddedFontContainerNodeComplexMerge",w.a,[]);class Ca extends w.a{constructor(){super()}get Ao(){return 30}get MB(){return 3}static Ih(){return new Ca}static get instance(){return Ca.gh.value}}Ca.gh=new l.a(Ca.Ih);Object(I.a)(Ca,"EmbeddedFontNodeComplexMerge",w.a,[]);class ra extends w.a{constructor(){super()}get Ao(){return 11}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Y6),4);
Ha.W(u.a.yb(f.a.QJa),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.QJa)){const ac=Ha.Rl,nc=Ha.tf;v.a.instance.Ua(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ac.id,ac.sc,zb);zb=nc.getPropertyObjectIds(Ha.hh.value.Sv,f.a.QJa);const Gb=nc.getPropertyObjectIds(Ha.hh.value.Lf,f.a.QJa),tc=nc.getPropertyObjectIds(Ha.Ro.value.Lf,f.a.QJa);zb=this.Ddj(zb,Gb,tc,(Qb,Yb)=>Qb.equals(Yb));0<zb.length?nc.setPropertyObjectIds(ac,f.a.QJa,
zb):ac.removeProperty(f.a.QJa);Ha.Yg.add(u.a.yb(f.a.QJa));return!0}v.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}static Ih(){return new ra}static get instance(){return ra.gh.value}}ra.gh=new l.a(ra.Ih);Object(I.a)(ra,"FootnoteEndnoteContainerNodeComplexMerge",w.a,[]);class Ea extends w.a{constructor(){super()}get Ao(){return 12}get MB(){return 3}hl(){const Ha=
super.hl();Ha.W(u.a.yb(f.a.fsa),1);return Ha}HD(Ha,zb){const ac=Ha.Rl,nc=Ha.tf;if(zb===u.a.yb(f.a.fsa)){let Gb=-1;v.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ac.id,ac.sc,zb);const tc=nc.getPropertyInt32(Ha.hh.value.Lf,f.a.fsa),Qb=nc.getPropertyInt32(Ha.Ro.value.Lf,f.a.fsa);null!=tc&&-1!==tc?Gb=tc:null!=Qb&&(Gb=Qb);nc.setPropertyInt32(ac,f.a.fsa,Gb);Ha.Yg.add(zb);return!0}v.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ha.hh.value.Sv.id,zb);return!1}static Ih(){return new Ea}static get instance(){v.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Ea.gh.value}}Ea.gh=new l.a(Ea.Ih);Object(I.a)(Ea,"FootnoteEndnoteNodeComplexMerge",w.a,[]);class xa extends w.a{constructor(){super()}get Ao(){return 47}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.OVa),1);return Ha}HD(Ha,zb){return zb===u.a.yb(f.a.OVa)?(v.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ha.Rl.id,Ha.Rl.sc,zb),w.a.Q7f(Ha,this,f.a.OVa)):!1}static Ih(){return new xa}static get instance(){return xa.gh.value}}xa.gh=new l.a(xa.Ih);Object(I.a)(xa,"GlossaryPageManifestNodeComplexMerge",w.a,[]);class Ma extends w.a{constructor(){super()}get Ao(){return 13}get MB(){return 3}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Wua),4);return Ha}static Ih(){return new Ma}static get instance(){return Ma.gh.value}}Ma.gh=new l.a(Ma.Ih);Object(I.a)(Ma,"HeaderFooterContainerNodeComplexMerge",w.a,[]);class ha extends w.a{constructor(){super()}get Ao(){return 14}get MB(){return 3}hl(){const Ha=
super.hl();Ha.W(u.a.yb(f.a.runId),3);Ha.W(u.a.yb(f.a.ed),3);Ha.W(u.a.yb(f.a.AUi),3);Ha.W(u.a.yb(f.a.oX),1);Ha.W(u.a.yb(a.a.U_),1);Ha.W(u.a.yb(x.a.imageAltText),1);Ha.W(u.a.yb(f.a.R_),1);Ha.W(u.a.yb(x.a.Zba),1);Ha.W(u.a.yb(a.a.Kfb),1);Ha.W(u.a.yb(f.a.lTa),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(x.a.imageAltText)||zb===u.a.yb(f.a.R_)||zb===u.a.yb(f.a.oX)||zb===u.a.yb(f.a.S_)||zb===u.a.yb(x.a.bsb)||zb===u.a.yb(x.a.Zba)||zb===u.a.yb(a.a.U_)||zb===u.a.yb(a.a.Kfb)||zb===u.a.yb(f.a.lTa)){const nc=Ha.Rl;var ac=
Ha.tf;v.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nc.id,nc.sc,zb);const Gb=ac.getPropertyInt32(Ha.hh.value.Lf,a.a.U_);ac=ac.getPropertyInt32(Ha.Ro.value.Lf,a.a.U_);if(null!=Gb&&(0===Gb||2===Gb))return!0;if(null!=ac&&(0===ac||2===ac))return zb=Ha.Ro.value.Lf,this.Wnb(zb,nc,x.a.imageAltText),this.Wnb(zb,nc,f.a.R_),this.Wnb(zb,nc,f.a.S_),zb.hasProperty(f.a.oX)&&this.Wnb(zb,nc,f.a.oX),this.Wnb(zb,nc,x.a.bsb),this.Wnb(zb,
nc,x.a.Zba),this.Wnb(zb,nc,a.a.U_),this.Wnb(zb,nc,a.a.Kfb),Ha.Yg.add(u.a.yb(x.a.imageAltText)),Ha.Yg.add(u.a.yb(f.a.R_)),Ha.Yg.add(u.a.yb(f.a.S_)),Ha.Yg.add(u.a.yb(f.a.oX)),Ha.Yg.add(u.a.yb(x.a.bsb)),Ha.Yg.add(u.a.yb(x.a.Zba)),Ha.Yg.add(u.a.yb(a.a.U_)),Ha.Yg.add(u.a.yb(a.a.Kfb)),Ha.Yg.add(u.a.yb(f.a.lTa)),!0}v.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Sv.id,zb);return!1}static Ih(){return new ha}static get instance(){return ha.gh.value}}
ha.gh=new l.a(ha.Ih);Object(I.a)(ha,"ImageNodeComplexMerge",w.a,[]);class la extends w.a{constructor(){super()}get Ao(){return 40}get MB(){return 0}static Ih(){return new la}static get instance(){return la.gh.value}}la.gh=new l.a(la.Ih);Object(I.a)(la,"IntelligenceAnnotationNodeComplexMerge",w.a,[]);class Fa extends w.a{constructor(){super()}get Ao(){return 32}get MB(){return 0}static Ih(){return new Fa}static get instance(){return Fa.gh.value}}Fa.gh=new l.a(Fa.Ih);Object(I.a)(Fa,"IntelligenceContentLocatorNodeComplexMerge",
w.a,[]);class Ga extends w.a{constructor(){super()}get Ao(){return 34}get MB(){return 0}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.AWa),1);return Ha}HD(Ha,zb){const ac=Ha.Rl,nc=Ha.tf;if(zb===u.a.yb(f.a.AWa)){zb=nc.getPropertyObjectIds(Ha.hh.value.Sv,f.a.AWa);const Gb=nc.getPropertyObjectIds(Ha.hh.value.Lf,f.a.AWa),tc=nc.getPropertyObjectIds(Ha.Ro.value.Lf,f.a.AWa);zb=this.WLa(zb,Gb,tc);nc.setPropertyObjectIds(ac,f.a.AWa,zb);Ha.Yg.add(u.a.yb(f.a.AWa));return!0}return!1}static Ih(){return new Ga}static get instance(){return Ga.gh.value}}
Ga.gh=new l.a(Ga.Ih);Object(I.a)(Ga,"IntelligenceRegionNodeComplexMerge",w.a,[]);class va extends w.a{constructor(){super()}get Ao(){return 35}get MB(){return 0}static Ih(){return new va}static get instance(){return va.gh.value}}va.gh=new l.a(va.Ih);Object(I.a)(va,"IntelligenceRejectionNodeComplexMerge",w.a,[]);class pa extends w.a{constructor(){super()}get Ao(){return 39}get MB(){return 0}static Ih(){return new pa}static get instance(){return pa.gh.value}}pa.gh=new l.a(pa.Ih);Object(I.a)(pa,"IntelligenceReviewedNodeComplexMerge",
w.a,[]);class Oa extends w.a{constructor(){super()}get Ao(){return 33}get MB(){return 0}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Nmc),1);Ha.W(u.a.yb(f.a.Mmc),1);Ha.W(u.a.yb(f.a.Pbe),1);Ha.W(u.a.yb(f.a.Rbe),1);return Ha}HD(Ha,zb){const ac=Ha.Rl,nc=Ha.tf;if(zb===u.a.yb(f.a.Nmc)||zb===u.a.yb(f.a.Mmc)||zb===u.a.yb(f.a.Pbe)||zb===u.a.yb(f.a.Rbe)){zb=zb===u.a.yb(f.a.Nmc)?f.a.Nmc:f.a.Mmc;var Gb=nc.getPropertyObjectIds(Ha.hh.value.Sv,zb);const tc=nc.getPropertyObjectIds(Ha.hh.value.Lf,zb),Qb=nc.getPropertyObjectIds(Ha.Ro.value.Lf,
zb);Gb=this.WLa(Gb,tc,Qb);nc.setPropertyObjectIds(ac,zb,Gb);Ha.Yg.add(u.a.yb(zb));return!0}return!1}static Ih(){return new Oa}static get instance(){return Oa.gh.value}}Oa.gh=new l.a(Oa.Ih);Object(I.a)(Oa,"IntelligenceRootNodeComplexMerge",w.a,[]);class Ra extends w.a{constructor(){super()}get Ao(){return 42}get MB(){return 0}static Ih(){return new Ra}static get instance(){return Ra.gh.value}}Ra.gh=new l.a(Ra.Ih);Object(I.a)(Ra,"IntelligenceSettingNodeComplexMerge",w.a,[]);class fb extends w.a{constructor(){super()}get Ao(){return 45}get MB(){return 0}static Ih(){return new fb}static get instance(){return fb.gh.value}}
fb.gh=new l.a(fb.Ih);Object(I.a)(fb,"IntelligenceWorkflowNodeComplexMerge",w.a,[]);class qb extends w.a{constructor(){super()}get Ao(){return 15}get MB(){return 3}static Ih(){return new qb}static get instance(){return qb.gh.value}}qb.gh=new l.a(qb.Ih);Object(I.a)(qb,"NumberListNodeComplexMerge",w.a,[]);var mb=d(103);class eb extends w.a{constructor(){super()}get Ao(){return 16}get MB(){return 0}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.LKb),1);Ha.W(u.a.yb(mb.a.xpf),7);Ha.W(u.a.yb(mb.a.vpf),7);return Ha}HD(Ha,
zb){const ac=Ha.Rl,nc=Ha.tf;if(zb===u.a.yb(f.a.LKb))return this.z1f(nc,Ha.hh.value.Lf,Ha.Ro.value.Lf,ac,f.a.LKb),Ha.Yg.add(zb),!0;v.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Sv.id,zb);return!1}static Ih(){return new eb}static get instance(){return eb.gh.value}}eb.gh=new l.a(eb.Ih);Object(I.a)(eb,"OutlineElementNodeComplexMerge",w.a,[]);class bb extends w.a{constructor(){super()}get Ao(){return 17}hl(){const Ha=
super.hl();Ha.W(u.a.yb(f.a.LKb),1);Ha.W(u.a.yb(f.a.Kra),1);Ha.W(u.a.yb(mb.a.D2),1);Ha.W(u.a.yb(mb.a.Upc),1);Ha.W(u.a.yb(mb.a.FYa),8);return Ha}HD(Ha,zb){const ac=Ha.Rl,nc=Ha.tf;if(zb===u.a.yb(f.a.LKb))return this.z1f(nc,Ha.hh.value.Lf,Ha.Ro.value.Lf,ac,f.a.LKb),Ha.Yg.add(zb),!0;if(zb===u.a.yb(f.a.Kra)){var Gb=nc.getPropertyBool(Ha.hh.value.Lf,f.a.Kra),tc=nc.getPropertyBool(Ha.Ro.value.Lf,f.a.Kra);nc.setPropertyBool(ac,f.a.Kra,null==Gb?!1:Gb&&null==tc?!1:tc);Ha.Yg.add(zb);return!0}if(zb===u.a.yb(mb.a.Upc))return this.z1f(nc,
Ha.hh.value.Lf,Ha.Ro.value.Lf,ac,mb.a.Upc),Ha.Yg.add(zb),!0;if(zb===u.a.yb(mb.a.D2))return Gb=nc.getPropertyBool(Ha.hh.value.Lf,mb.a.D2),tc=nc.getPropertyBool(Ha.Ro.value.Lf,mb.a.D2),nc.setPropertyBool(ac,mb.a.D2,null==Gb?!0:Gb||null==tc?!0:tc),Ha.Yg.add(zb),!0;v.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Sv.id,zb);return!1}static Ih(){return new bb}static get instance(){return bb.gh.value}}
bb.gh=new l.a(bb.Ih);Object(I.a)(bb,"OutlineGroupNodeComplexMerge",w.a,[]);var Wa=d(109);class Za extends w.a{constructor(){super()}get Ao(){return 18}get MB(){return 2}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.q$d),3);Ha.W(u.a.yb(x.a.fS),this.MB);Ha.W(u.a.yb(f.a.$s),1);Ha.W(u.a.yb(f.a.h8),1);Ha.W(u.a.yb(f.a.Rq),1);Ha.W(u.a.yb(Y.a.VF),1);Ha.W(u.a.yb(Y.a.lYa),1);return Ha}HD(Ha,zb){const ac=Ha.tf;if(Ha.Hu.runtime.rc.isFeatureEnabled(63)){if(zb===u.a.yb(f.a.$s)||zb===u.a.yb(f.a.h8)||zb===u.a.yb(Y.a.lYa)||
zb===u.a.yb(f.a.Rq)||zb===u.a.yb(Y.a.VF))return this.Yrp(ac,Ha)}else if(zb===u.a.yb(f.a.$s)||zb===u.a.yb(f.a.Rq)){let nc,Gb;({mWc:zb,L$a:nc,C$a:Gb}=this.xnf(Object(Wa.a)(ac,ac.getPropertyUint32s,"getPropertyUint32s"),Ha.hh.value.Sv,Ha.hh.value.Lf,Ha.Ro.value.Lf,f.a.$s,null));if(!Gb&&!nc)return v.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Ha.hh.value.Lf.id,u.a.yb(f.a.$s)),!0;let tc,Qb,Yb;({mWc:tc,
L$a:Qb,C$a:Yb}=this.xnf(Object(Wa.a)(ac,ac.getPropertyObjectIds,"getPropertyObjectIds"),Ha.hh.value.Sv,Ha.hh.value.Lf,Ha.Ro.value.Lf,f.a.Rq,null));if(!Qb&&!Yb)return v.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Ha.hh.value.Lf.id,u.a.yb(f.a.Rq)),!0;const fc=Qb&&!Yb;if((nc&&!Gb)!==fc)return v.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Ha.hh.value.Lf.id,u.a.yb(f.a.$s),u.a.yb(f.a.Rq)),!1;fc&&(ac.setPropertyObjectIds(Ha.Rl,f.a.Rq,tc),ac.setPropertyUint32s(Ha.Rl,f.a.$s,zb));v.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Ha.hh.value.Lf.id,u.a.yb(f.a.$s),nc,Gb,u.a.yb(f.a.Rq),Qb,Yb);Ha.Yg.add(u.a.yb(f.a.Rq));Ha.Yg.add(u.a.yb(f.a.$s));
return!0}v.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}DNi(Ha,zb,ac,nc){let Gb;({mWc:zb,L$a:nc,C$a:Gb}=this.xnf(zb,ac.hh.value.Sv,ac.hh.value.Lf,ac.Ro.value.Lf,Ha,nc));return Gb||nc?{returnValue:!0,$pf:zb,L$a:nc,C$a:Gb}:(v.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
ac.hh.value.Lf.id.toString(),u.a.yb(Ha)),{returnValue:!1,$pf:zb,L$a:nc,C$a:Gb})}CMi(Ha,zb,ac,nc,Gb){let tc;let Qb,Yb,fc,ib;({$pf:tc,L$a:Jc,C$a:Qb,returnValue:fc}=this.DNi(Ha,Object(Wa.a)(ac,ac.getPropertyUint32s,"getPropertyUint32s"),nc,null));({$pf:ac,L$a:Gb,C$a:Yb,returnValue:ib}=this.DNi(zb,Object(Wa.a)(ac,ac.getPropertyObjectIds,"getPropertyObjectIds"),nc,Gb));var Jc=Jc&&!Qb;return fc&&ib?Jc!==(Gb&&!Yb)?(v.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
nc.hh.value.Lf.id.toString(),u.a.yb(Ha),u.a.yb(zb)),{returnValue:2,OWd:tc,NWd:ac,GBe:Jc}):{returnValue:0,OWd:tc,NWd:ac,GBe:Jc}:{returnValue:1,OWd:tc,NWd:ac,GBe:Jc}}GXf(Ha){let zb=!0;Ha.forEach(ac=>ac!==da.a.nil?zb=!1:!0);return zb}Urm(Ha,zb,ac){return this.GXf(Ha)&&this.GXf(zb)&&this.GXf(ac)?!0:!1}Yrp(Ha,zb){let ac,nc,Gb,tc,Qb,Yb;var fc=({OWd:tc,NWd:Qb,GBe:nc}=this.CMi(Y.a.lYa,f.a.Rq,Ha,zb,null)).returnValue;if(2===fc||1===fc)return!0;({OWd:Gb,NWd:Yb,GBe:ac,returnValue:fc}=this.CMi(f.a.$s,f.a.h8,
Ha,zb,Object(Wa.a)(this,this.Urm,"getExtendedGuidEquivalence")));if(2===fc||1===fc)return!0;let ib;({mWc:fc,L$a:Jc,C$a:ib}=this.epl(Object(Wa.a)(Ha,Ha.getPropertyDictionary,"getPropertyDictionary"),zb.hh.value.Sv,zb.hh.value.Lf,zb.Ro.value.Lf,Y.a.VF));if(!ib&&!Jc)return v.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",zb.hh.value.Lf.id.toString(),u.a.yb(Y.a.VF)),!0;var Jc=Jc&&!ib;if(ac!==nc||ac!==
Jc)return v.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",zb.hh.value.Lf.id.toString(),u.a.yb(f.a.$s),u.a.yb(Y.a.lYa),u.a.yb(Y.a.VF),nc,ac,Jc),!0;ac&&(Ha.setPropertyObjectIds(zb.Rl,f.a.Rq,Qb),Ha.setPropertyUint32s(zb.Rl,Y.a.lYa,tc),Ha.setPropertyObjectIds(zb.Rl,f.a.h8,
Yb),Ha.setPropertyUint32s(zb.Rl,f.a.$s,Gb),Ha.setPropertyDictionary(zb.Rl,Y.a.VF,fc));v.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",zb.hh.value.Lf.id.toString(),nc,ac,Jc);zb.Yg.add(u.a.yb(Y.a.lYa));zb.Yg.add(u.a.yb(f.a.Rq));zb.Yg.add(u.a.yb(f.a.$s));zb.Yg.add(u.a.yb(f.a.h8));zb.Yg.add(u.a.yb(Y.a.VF));return!0}static Ih(){return new Za}static get instance(){return Za.gh.value}}
Za.gh=new l.a(Za.Ih);Object(I.a)(Za,"PageContentNodeComplexMerge",w.a,[]);class Na extends w.a{constructor(){super()}get Ao(){return 19}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.UDa),1);Ha.W(u.a.yb(f.a.rTa),2);Ha.W(u.a.yb(f.a.Fka),2);Ha.W(u.a.yb(f.a.s7),1);return Ha}HD(Ha,zb){const ac=Ha.tf;if(zb===u.a.yb(f.a.UDa)){var nc=ac.getPropertyObjectIds(Ha.hh.value.Sv,f.a.UDa),Gb=ac.getPropertyObjectIds(Ha.hh.value.Lf,f.a.UDa),tc=ac.getPropertyObjectIds(Ha.Ro.value.Lf,f.a.UDa);if((nc=this.kNn(nc,Gb,tc,(Qb,
Yb)=>Qb.equals(Yb),Qb=>{let Yb;({value:Yb}=Ha.Hu.runtime.sv.Ec(Qb)).returnValue?Ha.Hu.runtime.Sq.W(Qb,new D.a(Yb,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Ha.Hu))&&0<nc.length)return ac.setPropertyObjectIds(Ha.Rl,f.a.UDa,nc),Ha.Yg.add(u.a.yb(f.a.UDa)),!0}if(zb===u.a.yb(f.a.s7))return nc=ac.getPropertyObjectIds(Ha.hh.value.Sv,f.a.s7),Gb=ac.getPropertyObjectIds(Ha.hh.value.Lf,f.a.s7),tc=ac.getPropertyObjectIds(Ha.Ro.value.Lf,
f.a.s7),nc=this.WLa(nc,Gb,tc),ac.setPropertyObjectIds(Ha.Rl,f.a.s7,nc),Ha.Yg.add(zb),!0;v.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}static Ih(){return new Na}static get instance(){return Na.gh.value}}Na.gh=new l.a(Na.Ih);Object(I.a)(Na,"PageManifestNodeComplexMerge",w.a,[]);class Db extends w.a{constructor(){super()}get Ao(){return 43}hl(){const Ha=super.hl();
Ha.W(u.a.yb(f.a.Aqa),0);Ha.W(u.a.yb(f.a.CXb),0);Ha.W(u.a.yb(f.a.OTb),0);Ha.W(u.a.yb(f.a.Dsa),1);Ha.W(u.a.yb(f.a.sessionId),3);Ha.W(u.a.yb(f.a.buildVersion),3);Ha.W(u.a.yb(f.a.VBa),1);Ha.W(u.a.yb(f.a.eYi),1);Ha.W(u.a.yb(f.a.qw),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(f.a.VBa)||zb===u.a.yb(f.a.eYi)||zb===u.a.yb(f.a.qw)){var ac=Ha.Ro.value.Lf,nc=Ha.hh.value.Lf,Gb=u.a.s_(zb);nc=Ha.tf.getPropertyBool(nc,Gb);ac=Ha.tf.getPropertyBool(ac,Gb);Ha.tf.setPropertyBool(Ha.Rl,Gb,null==nc?!1:nc&&null==ac?!1:ac);Ha.Yg.add(zb);
return!0}if(zb===u.a.yb(f.a.Dsa)){zb=Ha.tf;ac=Ha.hh.value.Sv;nc=Ha.Ro.value.Lf;Gb=Ha.hh.value.Lf;ac=ac?zb.getPropertyObjectId(ac,f.a.Dsa):null;nc=nc?zb.getPropertyObjectId(nc,f.a.Dsa):null;Gb=Gb?zb.getPropertyObjectId(Gb,f.a.Dsa):null;v.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",ac?ac.toString():"NULL",nc?nc.toString():"NULL",Gb?Gb.toString():"NULL");if(nc){if(Gb&&nc.equals(Gb))return Ha.Yg.add(u.a.yb(f.a.Dsa)),zb.setPropertyObjectId(Ha.Rl,
f.a.Dsa,nc),!0;if(ka.a.I9d.equals(nc))return Ha.Yg.add(u.a.yb(f.a.Dsa)),zb.setPropertyObjectId(Ha.Rl,f.a.Dsa,ka.a.I9d),!0}if(Gb&&ka.a.I9d.equals(Gb))return Ha.Yg.add(u.a.yb(f.a.Dsa)),zb.setPropertyObjectId(Ha.Rl,f.a.Dsa,ka.a.I9d),!0;v.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",ac?ac.toString():"NULL",nc?nc.toString():"NULL",Gb?Gb.toString():"NULL")}return!1}static Ih(){return new Db}static get instance(){return Db.gh.value}}Db.gh=new l.a(Db.Ih);
Object(I.a)(Db,"PageMetadataNodeComplexMerge",w.a,[]);var nb=d(1811),Ta=d(157);class cb extends w.a{constructor(){super()}get Ao(){return 31}hl(){const Ha=super.hl();Ha.W(u.a.yb(Ta.a.cC),1);Ha.W(u.a.yb(f.a.listID),3);Ha.W(u.a.yb(f.a.listLevel),1);Ha.W(u.a.yb(f.a.Te),3);Ha.W(u.a.yb(f.a.ydc),3);Ha.W(u.a.yb(f.a.runId),3);Ha.W(u.a.yb(f.a.k1d),3);Ha.W(u.a.yb(x.a.fontColor),3);Ha.W(u.a.yb(f.a.M5h),3);Ha.W(u.a.yb(f.a.ed),1);Ha.W(u.a.yb(Ta.a.Kce),3);Ha.W(u.a.yb(Ta.a.o1f),3);Ha.W(u.a.yb(Ta.a.D9c),3);Ha.W(u.a.yb(f.a.jcm),
3);Ha.W(u.a.yb(mb.a.G5j),3);for(let zb=0;zb<cb.Qab.length;zb++)Ha.W(cb.Qab[zb],1);return Ha}HD(Ha,zb){var ac=Ha.tf;const nc=Ha.Rl;u.a.s_(zb);if(zb===u.a.yb(f.a.ed)){ac=Ha.tf.getPropertyInt32(Ha.Ro.value.Lf,f.a.ed);if(null==ac||!ac)return!0;Ha.tf.setPropertyInt32(nc,f.a.ed,ac);Ha.Yg.add(zb);return!0}if(zb===u.a.yb(Ta.a.cC)){const Gb=ac.getPropertyUint32(Ha.hh.value.Lf,Ta.a.cC),tc=ac.getPropertyUint32(Ha.Ro.value.Lf,Ta.a.cC);if(null!=Gb&&null!=tc&&Gb===tc)return ac.setPropertyUint32(nc,Ta.a.cC,Gb),
Ha.Yg.add(zb),!0;if(null==Gb&&null==tc)return nc.removeProperty(Ta.a.cC),Ha.Yg.add(u.a.yb(Ta.a.cC)),!0;if(null!=Gb&&null==tc)return ac.setPropertyUint32(nc,Ta.a.cC,Gb),Ha.Yg.add(zb),!0;if(null==Gb&&null!=tc)return ac.setPropertyUint32(nc,Ta.a.cC,tc),Ha.Yg.add(zb),!0}else{if(zb===u.a.yb(f.a.listLevel))return this.krp(ac,Ha);if(Array.contains(cb.Qab,zb))return this.jrp(Ha)}return!1}jrp(Ha){let zb=!0,ac=!0,nc,Gb;({bkn:zb,ihn:ac,m6l:nc,Myl:Gb}=this.fpl(Ha));v.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",
Ha.hh.value.Lf.id.toString(),zb,ac);return zb&&!ac?(this.qej(Gb,Ha),!0):zb?!1:(this.qej(nc,Ha),!0)}fpl(Ha){let zb,ac,nc,Gb;const tc=Ha.Ro.value;let Qb;const Yb=Ha.hh.value;let fc;ac=zb=!0;nc=new G.a;Gb=new G.a;for(let ib=0;ib<cb.Qab.length;ib++){const Jc=cb.Qab[ib],jd=({value:Qb}=tc.SMa.Ec(Jc)).returnValue;({value:fc}=Yb.SMa.Ec(Jc)).returnValue&&(zb=this.L3j(Ha.hh,nc,fc,Jc)&&zb);jd&&(ac=this.L3j(Ha.Ro,Gb,Qb,Jc)&&ac)}return{bkn:zb,ihn:ac,m6l:nc,Myl:Gb}}L3j(Ha,zb,ac,nc){const Gb=u.a.s_(nc);Ha=Ha.value.Lf;
zb.W(nc,Ha.hasProperty(Gb)?Ha.HF(Gb):null);return!ac.e3}qej(Ha,zb){const ac=zb.Rl;for(let Gb=0;Gb<cb.Qab.length;Gb++){var nc=cb.Qab[Gb];const tc=u.a.s_(nc);(nc=Ha.K(nc))?ac.Udb(tc,nc):ac.removeProperty(tc)}for(Ha=0;Ha<cb.Qab.length;Ha++)zb.Yg.add(cb.Qab[Ha]);v.a.instance.Ua(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",zb.hh.value.Lf.id.toString())}krp(Ha,zb){const ac=zb.Rl,nc=Ha.getPropertyInt32(zb.hh.value.Lf,f.a.listLevel),Gb=Ha.getPropertyInt32(zb.Ro.value.Lf,
f.a.listLevel);return null!=nc&&null!=Gb&&nc===Gb?(Ha.setPropertyInt32(ac,f.a.listLevel,nc),zb.Yg.add(u.a.yb(f.a.listLevel)),!0):null==nc&&null==Gb?(ac.removeProperty(f.a.listLevel),zb.Yg.add(u.a.yb(f.a.listLevel)),!0):null!=nc&&null==Gb?(Ha.setPropertyInt32(ac,f.a.listLevel,nc),zb.Yg.add(u.a.yb(f.a.listLevel)),!0):null==nc&&null!=Gb?(Ha.setPropertyInt32(ac,f.a.listLevel,Gb),zb.Yg.add(u.a.yb(f.a.listLevel)),!0):!1}static Ih(){return new cb}static get instance(){return cb.gh.value}}cb.gh=new l.a(cb.Ih);
cb.Qab=[u.a.yb(f.a.ke),u.a.yb(f.a.Jt),u.a.yb(x.a.W7),u.a.yb(f.a.gga),u.a.yb(f.a.$w),u.a.yb(f.a.at),u.a.yb(x.a.GU),u.a.yb(f.a.ujf),u.a.yb(x.a.font),u.a.yb(mb.a.Lub),u.a.yb(a.a.gx)];Object(I.a)(cb,"PersistablePropertySetComplexMerge",w.a,[]);class sb extends w.a{constructor(){super()}get Ao(){return 21}get MB(){return 0}static Ih(){return new sb}static get instance(){return sb.gh.value}}sb.gh=new l.a(sb.Ih);Object(I.a)(sb,"RevisionMetadataNodeComplexMerge",w.a,[]);class pb extends w.a{constructor(){super()}get Ao(){return 48}hl(){const Ha=
super.hl();Ha.W(u.a.yb(f.a.vqe),3);return Ha}static Ih(){return new pb}static get instance(){return pb.gh.value}}pb.gh=new l.a(pb.Ih);Object(I.a)(pb,"ShadowNumberListNodeComplexMerge",w.a,[]);class tb extends w.a{constructor(){super()}get Ao(){return 22}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.Gab),7);Ha.W(u.a.yb(f.a.l$c),2);return Ha}static Ih(){return new tb}static get instance(){return tb.gh.value}}tb.gh=new l.a(tb.Ih);Object(I.a)(tb,"SharedPersistablePropertySetComplexMerge",w.a,[]);class wb extends w.a{constructor(){super()}get Ao(){return 38}get MB(){return 3}static Ih(){return new wb}static get instance(){return wb.gh.value}}
wb.gh=new l.a(wb.Ih);Object(I.a)(wb,"StylePropertySetComplexMerge",w.a,[]);class gc extends w.a{constructor(){super()}get Ao(){return 23}get MB(){return 0}hl(){const Ha=super.hl();Ha.W(u.a.yb(x.a.rg),4);Ha.W(u.a.yb(f.a.rowSpan),1);Ha.W(u.a.yb(f.a.colSpan),1);Ha.W(u.a.yb(f.a.ghostCell),1);Ha.W(u.a.yb(Y.a.vMerge),1);Ha.W(u.a.yb(Y.a.gridSpan),1);Ha.W(u.a.yb(f.a.cfb),2);Ha.W(u.a.yb(f.a.oAb),2);Ha.W(u.a.yb(f.a.mOa),2);return Ha}TBa(Ha){if(!Ha)return v.a.instance.Ua(540120285,1,2,"Feature helper is null"),
!1;Ha.LL(98);return Ha.isFeatureEnabled(98)}HD(Ha,zb){Ha.Hu.runtime.$I("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+zb);let ac=zb===u.a.yb(f.a.rowSpan)||zb===u.a.yb(f.a.colSpan)||zb===u.a.yb(f.a.ghostCell);this.TBa(Ha.Hu.runtime.rc)&&(ac=ac||zb===u.a.yb(Y.a.vMerge)||zb===u.a.yb(Y.a.gridSpan));return!ac}static Ih(){return new gc}static get instance(){return gc.gh.value}}gc.gh=new l.a(gc.Ih);Object(I.a)(gc,"TableCellNodeComplexMerge",w.a,[]);var vc=d(1754);class Pc extends w.a{constructor(){super()}get Ao(){return 24}get MB(){return 0}hl(){const Ha=
super.hl();Ha.W(u.a.yb(x.a.rg),1);Ha.W(u.a.yb(x.a.P8),1);Ha.W(u.a.yb(x.a.Lha),1);Ha.W(u.a.yb(f.a.Syc),1);Ha.W(u.a.yb(f.a.Kca),1);Ha.W(u.a.yb(f.a.cfb),2);Ha.W(u.a.yb(f.a.oAb),2);Ha.W(u.a.yb(f.a.mOa),2);return Ha}HD(Ha,zb){Ha.Hu.runtime.$I("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+zb);if(zb===u.a.yb(x.a.rg)||zb===u.a.yb(x.a.P8)||zb===u.a.yb(f.a.Syc)||zb===u.a.yb(f.a.Kca)||zb===u.a.yb(x.a.Lha)){const nc=Ha.Rl,Gb=Ha.tf;v.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
nc.id,nc.sc,zb);if(this.CWl(Ha))return!1;var ac=Gb.getPropertyObjectIds(Ha.hh.value.Sv,x.a.rg);const tc=Gb.getPropertyObjectIds(Ha.hh.value.Lf,x.a.rg),Qb=Gb.getPropertyObjectIds(Ha.Ro.value.Lf,x.a.rg);ac=this.Ddj(ac,tc,Qb,(Yb,fc)=>Yb.equals(fc));if(0<ac.length)return Gb.setPropertyObjectIds(nc,x.a.rg,ac),Gb.setPropertyInt32(nc,x.a.Lha,ac.length),Ha.Yg.add(u.a.yb(x.a.rg)),Ha.Yg.add(u.a.yb(x.a.P8)),Ha.Yg.add(u.a.yb(x.a.Lha)),Ha.Yg.add(u.a.yb(f.a.Syc)),Ha.Yg.add(u.a.yb(f.a.Kca)),!0}v.a.instance.Ua(4018189,
1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}CWl(Ha){const zb=Ha.Ro.value,ac=Ha.hh.value;let nc,Gb;({value:nc}=zb.SMa.Ec(u.a.yb(x.a.P8)));({value:Gb}=ac.SMa.Ec(u.a.yb(x.a.P8)));return nc.e3||Gb.e3?nc.e3&&Gb.e3?(v.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",nc.oldValue,Gb.newValue,nc.newValue),
Ha.Hu.logger.Oi(Object.assign(new vc.a,{gk:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Pc.Igi(Ha.Hu,nc,ac,"BaseConflict")||Pc.Igi(Ha.Hu,Gb,zb,"BaseFavored")?!0:!1:!1}static Ih(){return new Pc}static get instance(){return Pc.gh.value}static Igi(Ha,zb,ac,nc){return zb.e3&&({value:zb}=ac.SMa.Ec(u.a.yb(x.a.rg)),zb.e3)?(v.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",nc),Ha.logger.Oi(Object.assign(new vc.a,
{gk:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Pc.gh=new l.a(Pc.Ih);Object(I.a)(Pc,"TableNodeComplexMerge",w.a,[]);class ld extends w.a{constructor(){super()}get Ao(){return 25}get MB(){return 0}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.ed),3);Ha.W(u.a.yb(x.a.rg),4);Ha.W(u.a.yb(f.a.cfb),2);Ha.W(u.a.yb(f.a.oAb),2);Ha.W(u.a.yb(f.a.mOa),2);Ha.W(u.a.yb(Y.a.PFg),2);Ha.W(u.a.yb(Y.a.OFg),2);return Ha}static Ih(){return new ld}static get instance(){return ld.gh.value}}ld.gh=new l.a(ld.Ih);Object(I.a)(ld,
"TableRowNodeComplexMerge",w.a,[]);class Dc extends w.a{constructor(){super()}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.mjp),2);Ha.W(u.a.yb(x.a.rg),1);return Ha}HD(Ha,zb){if(zb===u.a.yb(x.a.rg)){const nc=Ha.Rl,Gb=Ha.tf;v.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nc.id,nc.sc,zb);var ac=Gb.getPropertyObjectIds(Ha.hh.value.Sv,x.a.rg);const tc=Gb.getPropertyObjectIds(Ha.hh.value.Lf,x.a.rg),Qb=Gb.getPropertyObjectIds(Ha.Ro.value.Lf,
x.a.rg);if(ac=this.vNn(ac,tc,Qb))return 0<ac.length?Gb.setPropertyObjectIds(nc,x.a.rg,ac):nc.removeProperty(x.a.rg),Ha.Yg.add(u.a.yb(x.a.rg)),!0}v.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb);return!1}vNn(Ha,zb,ac){const nc=new G.a(0);Ha.forEach(tc=>{nc.W(tc,0);return!0});zb.forEach(tc=>{nc.tb(tc)?nc.W(tc,1):nc.W(tc,3);return!0});ac.forEach(tc=>{let Qb;({value:Qb}=nc.Ec(tc)).returnValue?
1===Qb?nc.W(tc,5):3===Qb?(v.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),nc.W(tc,3)):nc.W(tc,2):nc.W(tc,4);return!0});const Gb=new R.a;nc.forEach((tc,Qb)=>{0!==Qb&&2!==Qb&&1!==Qb&&Gb.add(tc);return!0});return Gb}static Ih(){return new Dc}static get instance(){return Dc.gh.value}}Dc.gh=new l.a(Dc.Ih);Object(I.a)(Dc,"TaskContentNodeComplexMerge",w.a,[]);class ic{equals(Ha,zb){return Ha&&zb?Ha.UserId===zb.UserId&&Ha.Provider===zb.Provider&&Ha.DisplayName===zb.DisplayName&&
Ha.Email===zb.Email:!Ha&&!zb}eN(){return 0}}Object(I.a)(ic,"CommentTaskPersonComparer",null,[12]);class mc{equals(Ha,zb){return Ha&&zb?Ha.startDate?Ha.endDate?Ha.startDate.getTime()===zb.startDate.getTime()&&Ha.endDate.getTime()===zb.endDate.getTime():!zb.endDate:!zb.startDate:!Ha&&!zb}eN(){return 0}}Object(I.a)(mc,"CommentTaskScheduleEqualityComparer",null,[12]);class Rc{equals(Ha,zb){if(!Ha||!zb)return!Ha&&!zb;if(!Ha.extensions&&!zb.extensions)return!0;if(!Ha.extensions||!zb.extensions||Ha.extensions.count!==
zb.extensions.count)return!1;let ac=!0;Ha.extensions.forEach((nc,Gb)=>{let tc;return({value:tc}=zb.extensions.Ec(nc)).returnValue&&Gb===tc?!0:ac=!1});return ac}eN(){return 0}}Object(I.a)(Rc,"ExtensionListEqualityComparer",null,[12]);class rb{R2l(Ha,zb){return Ha&&zb?Ha.recordId===zb.recordId&&rb.Pbh.equals(Ha.user,zb.user)&&rb.Pbh.equals(Ha.assignee,zb.assignee)&&Ha.type===zb.type&&Ha.title===zb.title&&Ha.priority===zb.priority&&Ha.isLossy===zb.isLossy&&Ha.completion===zb.completion&&Ha.commentId===
zb.commentId&&Ha.time===zb.time&&rb.grk.equals(Ha.schedule,zb.schedule):!Ha&&!zb}equals(Ha,zb){return this.R2l(Ha,zb)}eN(){return 0}}rb.Pbh=new ic;rb.grk=new mc;new Rc;Object(I.a)(rb,"HistoryRecordEqualityComparer",null,[12]);var Cb=d(2181),Kb=d(1499);class $b extends w.a{constructor(Ha){super();this.ISa=Ha}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.p1b),5);Ha.W(u.a.yb(f.a.taskId),2);Ha.W(u.a.yb(f.a.Yip),2);Ha.W(u.a.yb(f.a.cjp),2);Ha.W(u.a.yb(f.a.iEa),1);return Ha}UIg(Ha){if(!Ha.Ro.value.Sv&&!Ha.hh.value.Sv){const zb=
Ha.hh.value.Lf.GO();zb.removeProperty(f.a.iEa);const ac=Ha.hh.value.Lf,nc=Ha.Ro.value.Lf;Ha.hh=new l.a(()=>new Kb.a(zb,ac));Ha.Ro=new l.a(()=>new Kb.a(zb,nc))}return super.UIg(Ha)}HD(Ha,zb){if(zb!==u.a.yb(f.a.iEa))return v.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ha.hh.value.Lf.id,zb),!1;const ac=Ha.Rl,nc=Ha.tf;v.a.instance.Ua(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
ac.id,ac.sc,zb);zb=nc.getPropertyString(Ha.hh.value.Sv,f.a.iEa);const Gb=nc.getPropertyString(Ha.hh.value.Lf,f.a.iEa),tc=nc.getPropertyString(Ha.Ro.value.Lf,f.a.iEa);zb=this.uNn(zb,Gb,tc);if(!zb)return!1;0<zb.length?nc.setPropertyString(ac,f.a.iEa,zb):ac.removeProperty(f.a.iEa);Ha.Yg.add(u.a.yb(f.a.iEa));return!0}uNn(Ha,zb,ac){Ha=this.ISa.ogc(Ha);zb=this.ISa.ogc(zb);ac=this.ISa.ogc(ac);if(!$b.s0i(Ha,zb))return v.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),
null;if(!$b.s0i(Ha,ac))return v.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;ac=$b.Ivl(Ha.length,zb,ac);return this.ISa.Ywg(ac)}static Ih(){const Ha=new Cb.a;return new $b(Ha)}static get instance(){return $b.gh.value}static Ivl(Ha,zb,ac){const nc=new R.a;for(let Gb=0;Gb<zb.length;Gb++)nc.add(zb.K(Gb));for(;Ha<ac.length;Ha++)nc.add(ac.K(Ha));return nc}static s0i(Ha,zb){const ac=Ha.length;if(ac>zb.length)return!1;for(let nc=0;nc<ac;nc++)if(!$b.Ayk.equals(zb.K(nc),
Ha.K(nc)))return zb.K(nc).recordId===Ha.K(nc).recordId&&v.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}$b.gh=new l.a($b.Ih);$b.Ayk=new rb;Object(I.a)($b,"TaskSingleNodeComplexMerge",w.a,[]);class ab extends w.a{constructor(){super()}get Ao(){return 26}hl(){const Ha=super.hl();Ha.W(u.a.yb(x.a.rg),1);return Ha}HD(Ha,zb){const ac=x.a.rg;if(zb===u.a.yb(ac)){zb=Ha.Rl;const Gb=Ha.tf;var nc=Gb.getPropertyObjectIds(Ha.hh.value.Sv,
ac);const tc=Gb.getPropertyObjectIds(Ha.hh.value.Lf,ac),Qb=Gb.getPropertyObjectIds(Ha.Ro.value.Lf,ac);nc=this.CNn(nc,tc,Qb);Gb.setPropertyObjectIds(zb,ac,nc);Ha.Yg.add(u.a.yb(ac));return!0}return!1}CNn(Ha,zb,ac){return this.WLa(Ha,zb,ac)}static Ih(){return new ab}static get instance(){return ab.gh.value}}ab.gh=new l.a(ab.Ih);Object(I.a)(ab,"VectorClockContainerNodeComplexMerge",w.a,[]);class ia extends w.a{constructor(){super()}get Ao(){return 27}hl(){const Ha=super.hl();Ha.W(u.a.yb(f.a.R0),1);return Ha}HD(Ha,
zb){const ac=f.a.R0;if(zb===u.a.yb(ac)){zb=Ha.Rl;const nc=Ha.tf,Gb=nc.getPropertyUint32(Ha.hh.value.Lf,ac)||0,tc=nc.getPropertyUint32(Ha.Ro.value.Lf,ac)||0;nc.setPropertyUint32(zb,ac,this.Uzm(Gb,tc));Ha.Yg.add(u.a.yb(ac));return!0}return!1}Uzm(Ha,zb){return Ha>zb?Ha:zb}static Ih(){return new ia}static get instance(){return ia.gh.value}}ia.gh=new l.a(ia.Ih);Object(I.a)(ia,"VectorClockNodeComplexMerge",w.a,[]);class La extends w.a{constructor(){super()}get Ao(){return 28}get MB(){return 0}hl(){const Ha=
super.hl();Ha.W(u.a.yb(f.a.Bxf),3);Ha.W(u.a.yb(f.a.ed),3);Ha.W(u.a.yb(f.a.chi),5);Ha.W(u.a.yb(f.a.kje),5);Ha.W(u.a.yb(f.a.Wua),5);return Ha}static Ih(){return new La}static get instance(){return La.gh.value}}La.gh=new l.a(La.Ih);Object(I.a)(La,"WordSectionNodeComplexMerge",w.a,[]);d.d(J,"a",function(){return Mb});class Mb{d$h(Ha,zb){switch(Ha.sc){case m.a.Rma:return Ha.hasProperty(f.a.imageType)||Ha.hasProperty(a.a.U_)?this.$p(ha.instance,zb):this.$p(cb.instance,zb);case m.a.Pcc:return this.$p(z.instance,
zb);case m.a.KHa:return this.$p(y.instance,zb);case m.a.BKb:return this.$p(H.instance,zb);case m.a.Tcc:return this.$p(F.instance,zb);case m.a.rTa:return this.$p(O.instance,zb);case m.a.RHa:return this.$p(U.instance,zb);case m.a.Kya:return this.$p(X.instance,zb);case m.a.Hmb:return this.$p(V.instance,zb);case m.a.mka:return this.$p(Q.instance,zb);case m.a.ZK:return this.$p(W.instance,zb);case m.a.Xd:return this.$p(qa.instance,zb);case m.a.kra:return this.$p(aa.instance,zb);case m.a.Fka:return this.$p(ua.instance,
zb);case m.a.cR:return this.$p(Pa.instance,zb);case m.a.rJa:return this.$p(Ja.instance,zb);case m.a.Qka:return this.$p(Ca.instance,zb);case m.a.PJa:return this.$p(ra.instance,zb);case m.a.Faa:return this.$p(Ea.instance,zb);case m.a.bBa:return this.$p(Ma.instance,zb);case m.a.nWa:return this.$p(ha.instance,zb);case m.a.sI:return this.$p(ha.instance,zb);case m.a.nVf:return this.$p(la.instance,zb);case m.a.pVf:return this.$p(Fa.instance,zb);case m.a.Obe:return this.$p(Ga.instance,zb);case m.a.qVf:return this.$p(va.instance,
zb);case m.a.rVf:return this.$p(pa.instance,zb);case m.a.s7:return this.$p(Oa.instance,zb);case m.a.Obb:return this.$p(qb.instance,zb);case m.a.UX:return this.$p(eb.instance,zb);case m.a.KCa:return this.$p(bb.instance,zb);case m.a.Oh:return this.$p(Za.instance,zb);case m.a.fXb:return this.$p(Db.instance,zb);case m.a.NCa:return this.$p(Na.instance,zb);case m.a.paragraphNode:return this.$p(nb.a.instance,zb);case m.a.Mvc:return this.$p(sb.instance,zb);case m.a.s_a:return this.$p(tb.instance,zb);case m.a.tzb:return this.$p(wb.instance,
zb);case m.a.Ica:return this.$p(gc.instance,zb);case m.a.Bp:return this.$p(Pc.instance,zb);case m.a.Lna:return this.$p(ld.instance,zb);case m.a.R2b:return this.$p(ab.instance,zb);case m.a.pOa:return this.$p(Dc.instance,zb);case m.a.izc:return this.$p($b.instance,zb);case m.a.BFe:return this.$p(ia.instance,zb);case m.a.eia:return this.$p(La.instance,zb);case m.a.wVf:return this.$p(fb.instance,zb);case m.a.tVf:return this.$p(Ra.instance,zb);case m.a.PAa:return this.$p(xa.instance,zb);case m.a.Fod:return this.$p(pb.instance,
zb)}return this.$p(w.a.instance,zb)}$p(Ha,zb){Ha.rc=zb?zb():null;return Ha}}Object(I.a)(Mb,"GraphNodeComplexMergeFactory",null,[1065])},2026:function(I,J,d){d.r(J);I=d(0);var m=d(1465),f=d(71),a=d(354),l=d(80),w=d(1417);class z{constructor(K,R,E,N=0){this.oLi=K;this.groupType=R;this.sQf=N;this.Ild=E}}Object(I.a)(z,"SortingGroup",null,[]);class x{constructor(K,R,E,N){this.order=K;this.Xaa=R;this.dUm=E;this.groupType=N}}Object(I.a)(x,"SortingProp",null,[]);var u=d(1407),v=d(1411),D=d(1406),y=d(1393);
class H{constructor(K,R){this.xbj={};this.wbj={};this.sbj=this.Ebj=1;this.PXh(K,R)}nbp(K,R,E){var N=D.a.yU(E)?this.xbj:this.wbj;E=new f.a;for(var O of R)R=Object(l.a)(x,N[m.a[O.groupType].toLowerCase()]),y.c(R)||E.add(new a.a(R,O));E.Sc((X,V)=>X.key.order<V.key.order?-1:1);Array.clear(K);O=u.TellMeActor.instance.Q1;for(R=0;R<E.count;){N=E.K(R).key.Xaa;var U=E.K(R).value;const X=new w.a(E.K(R).key.groupType);y.c(O)||O.Location===v.a.contextMenu||(X.displayName=E.K(R).key.dUm);for(const V of U.results)X.jy(V);
for(U=++R;U<E.count&&E.K(U).key.Xaa===N;)this.uef(X,E.K(U).value),U=++R;K.push(X)}}VAp(K,R){this.sbj=this.Ebj=1;this.PXh(K,R)}PXh(K,R){this.kWj(K);for(var E=0;E<K.length;E++){const N=K[E];for(const O of N.Ild)this.eXk(O,E,N.oLi,N.groupType)}this.kWj(R);for(K=0;K<R.length;K++){E=R[K];for(const N of E.Ild)this.dXk(N,K,E.oLi,E.groupType)}}kWj(K){K.sort((R,E)=>Object(l.a)(z,R).sQf>Object(l.a)(z,E).sQf?-1:1)}eXk(K,R,E,N){this.xbj[m.a[K].toLowerCase()]=new x(this.Ebj++,R,E,N)}dXk(K,R,E,N){this.wbj[m.a[K].toLowerCase()]=
new x(this.sbj++,R,E,N)}uef(K,R){for(let E=0;E<R.results.length;E++)K.jy(R.results[E])}}Object(I.a)(H,"BaseGroupingSorter",null,[]);class F{constructor(){this.Bie=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.wie=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,
31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13]),new z("",22,[22])];this.cbj=new H(this.Bie,this.wie)}Opd(K,R,E,N=null,O=null){let U=!1;if(N){for(const X of D.a.yU(E)?this.Bie:this.wie)this.Coo(X,N);U=!0}if(O){for(const X of D.a.yU(E)?this.Bie:this.wie)this.WAp(R,X,O);U=!0}U&&this.cbj.VAp(this.Bie,this.wie);this.cbj.nbp(K,R,E)}Coo(K,R){const E=new f.a;
for(var N of K.Ild){const O=R[m.a[N].toLowerCase()];E.add(new a.a(y.c(O)?Number.MAX_VALUE:O,N))}if(E.count){E.Sc((O,U)=>O.key<U.key?-1:1);R=Array(E.count);for(N=0;N<E.count;N++)R[N]=E.K(N).value;K.Ild=R}}WAp(K,R,E){let N=0;for(const O of R.Ild)if(m.a[O].toLowerCase()in E&&E[m.a[O].toLowerCase()])for(const U of K)if(U.groupType===O){N+=E[m.a[O].toLowerCase()];break}R.sQf=N}}Object(I.a)(F,"SimplifiedGroupingSorterImpl",null,[]);d.d(J,"GroupsPlacementInfo",function(){return G});class G{constructor(K){this.vbj=
{};this.tbj={};this.ubj={};this.ybj={};this.I6f={};this.zbj=this.ZIn=this.UIn=this.WIn=1;this.Bbj=null;this.Mx=K;this.Uhl();this.heo();this.Ihl();this.Ngl();K.oS&&(this.Bbj=new F)}LG(K){this.vbj[m.a[K].toLowerCase()]=this.WIn++}BJ(K,R){this.tbj[m.a[K].toLowerCase()]=R}$Sa(K){this.ubj[m.a[K].toLowerCase()]=this.UIn++}e6(K){this.ybj[m.a[K].toLowerCase()]=this.ZIn++}oF(K){this.I6f[m.a[K].toLowerCase()]=this.zbj++}Uhl(){const K=!!this.Mx&&this.Mx.xab,R=!!this.Mx&&this.Mx.Sfd,E=!!this.Mx&&this.Mx.Ztb,
N=!!this.Mx&&this.Mx.w0f&&!D.a.Woc(),O=!!this.Mx&&this.Mx.aad,U=!!this.Mx&&this.Mx.yce,X=!!this.Mx&&this.Mx.BZf,V=!!this.Mx&&this.Mx.bWf;this.Mx&&(this.Mx.mhc||this.Mx.Rka||this.Mx.D0d)&&this.LG(26);V&&this.LG(24);this.LG(4);this.LG(18);this.LG(16);this.LG(7);this.LG(17);this.LG(0);this.LG(1);X&&this.LG(28);O&&this.LG(23);K||this.LG(2);K&&!R||this.LG(8);this.LG(15);E&&this.LG(20);this.LG(14);this.LG(9);this.LG(12);this.LG(10);this.LG(11);K&&this.LG(2);K&&!R&&this.LG(8);this.LG(19);U&&this.LG(27);
this.LG(21);this.LG(13);N&&this.LG(22);this.LG(30)}heo(){this.BJ(21,1);this.BJ(4,3);this.BJ(18,3);this.BJ(16,3);this.BJ(7,3);this.BJ(17,5);this.BJ(0,5);this.BJ(1,1);this.BJ(28,2);this.BJ(2,1);this.BJ(8,2);this.BJ(15,3);this.BJ(14,2);this.BJ(27,3);this.BJ(9,1);this.BJ(12,1);this.BJ(10,1);this.BJ(11,1);this.BJ(19,1);this.BJ(23,1);this.BJ(13,1);this.BJ(24,1);this.BJ(25,1);this.BJ(20,2);this.BJ(22,1);this.BJ(26,1)}Ihl(){this.$Sa(4);this.$Sa(0);this.$Sa(17);this.$Sa(7);this.$Sa(16);this.$Sa(18);this.$Sa(15);
this.$Sa(20);this.$Sa(8);this.$Sa(14)}Ngl(){this.e6(14);this.e6(10);this.e6(12);this.e6(9);this.e6(11);this.e6(20);this.e6(15);this.e6(8);this.e6(2);this.e6(1);this.e6(27);this.e6(7);this.e6(18);this.e6(16);this.e6(17);this.e6(0);this.e6(4)}mHo(){this.I6f={};this.zbj=1}wJm(K,R,E){this.mHo();const N=!!this.Mx&&this.Mx.xab,O=!!this.Mx&&this.Mx.Sfd,U=!!this.Mx&&this.Mx.Ztb,X=!!this.Mx&&this.Mx.w0f&&!D.a.Woc(),V=!!this.Mx&&this.Mx.aad,Q=!!this.Mx&&this.Mx.yce,T=!!this.Mx&&this.Mx.BZf,ba=!!this.Mx&&this.Mx.Gye;
K=K&&O;ba&&this.oF(25);this.oF(4);this.oF(18);this.oF(16);this.oF(7);this.oF(17);this.oF(0);this.oF(1);T&&this.oF(28);V&&this.oF(23);N&&!O||!K||this.oF(8);R&&this.oF(15);N||this.oF(2);Q&&this.oF(27);E&&this.oF(14);N&&!O||K||this.oF(8);R||this.oF(15);U&&this.oF(20);E||this.oF(14);this.oF(9);this.oF(12);this.oF(10);this.oF(11);N&&this.oF(2);N&&!O&&this.oF(8);this.oF(19);this.oF(21);this.oF(13);X&&this.oF(22);return this.I6f}yR(){return this.Mx}}Object(I.a)(G,"GroupsPlacementInfo",null,[])},2028:function(I,
J,d){d.r(J);I=d(0);var m=d(1647),f=d(1513),a=d(1465),l=d(1808),w=d(1512);class z{constructor(G="",K="",R="",E=-99999,N=-1,O=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=G?G:"";this.Description=K?K:"";this.Type=R?R:"";this.Score=E;this.Age=N;this.Count=O}}Object(I.a)(z,"Suggestion",null,[]);class x{constructor(G,K){this.GroupType=this.Suggestions=null;this.Suggestions=G;this.GroupType=K}}Object(I.a)(x,"SuggestionGroup",null,[]);class u{}u.Hlc="help";u.l6k=
"answer";u.commands="commands";u.ERo="servicecommands";u.template="template";Object(I.a)(u,"SuggestionGroupType",null,[]);var v=d(1407),D=d(1406),y=d(2),H=d(29);d.d(J,"InteractionLogger",function(){return F});class F{constructor(G,K,R){this.lQe=0;this.g$e=this.AKc=null;this.Jc=G;this.m8e=this.DNe=this.ZUe=!1;this.isk=K;this.If=y.AFrameworkApplication.Fe;this.kc=R;this.Xyd=this.P2e=0}get Aua(){return this.Jc.Aua}Exe(G){this.Jc.Exe(G)}N$i(){if(this.AKc){var G=0;for(const K of this.AKc)this.Jc.PGn(K,
G++);this.AKc=null}}beginQuery(G,K,R){this.Jc.GGn(G,K,R)}Wvb(G,K){this.Jc.Mcl(G,K);this.ZUe=!0;this.m8e=!1}xCa(){this.ZUe=!1;this.DNe||(this.N$i(),this.Jc.xji(this.lQe))}HGn(G,K){this.Jc.IGn(G,K)}yXn(G,K,R,E,N){for(const O of this.isk)if(G.startsWith(O)){this.m8e=!0;break}this.Jc.VDn(G,K,R,E,N)}$Xn(G){this.DNe=!1;this.lQe=G;this.ZUe||this.m8e||(this.N$i(),this.Jc.xji(this.lQe,!1))}ZXn(G,K){this.Jc.aEn(G,K);this.DNe=!0}YEf(G,K){if(!G.count)return"";let R="";const E=Date.now();for(const N of G)G=(E-
N.timeStamp)/1E3,G=D.a.kDe(G),0<R.length&&(R+=";"),R+=K?N.commandId:N.controlId,R+=":",R+=G.toString();return R}Rbb(){var G=this.YEf(m.a.instance.l2c(),!1);0<G.length&&this.Jc.TDn(G);G=this.YEf(m.a.instance.hqb(),!0);0<G.length&&this.Jc.kDn(G);G=this.YEf(m.a.instance.vHc,!0);0<G.length&&this.Jc.NEn(G);G=v.TellMeActor.instance.kvh;0<G.length&&this.Jc.EGn(H.c(G))}$Gn(G){this.Jc.yDn(G)}Lba(G,K,R,E,N,O,U,X=null){this.Jc.IFn(G,K,R,E,N,O,U,X)}D5f(G,K,R,E){this.Jc.D5f(G,K,R,E)}gC(G,K,R=null){this.Jc.DI(G,
K,R)}onError(G,K,R=null){this.Jc.iga(G,K,R)}sWo(G){this.AKc=G}KMm(G){const K=[];if(!G)return K;for(let R=0;R<G.length;R++){const E=a.a[G[R].groupType].toLowerCase(),N=[],O=G[R].results;if(O){for(let U=0;U<O.length;U++)"findindocument"===E?Array.add(N,new z("","",E,O[U].score,O[U].JRd,O[U].count)):Array.add(N,new z(O[U].label,O[U].description,E,O[U].score,O[U].JRd,O[U].count));"answer"===E||"definition"===E||"wolframanswer"===E||"entity"===E?Array.add(K,new x(N,u.l6k)):"classifier"===E||"appsforoffice"===
E?Array.add(K,new x(N,u.commands)):"serviceclassifier"===E?Array.add(K,new x(N,u.ERo)):"assistance"===E?Array.add(K,new x(N,u.Hlc)):("document"===E||"people"===E||"findindocument"===E||"notes"===E||"image"===E||"template"===E)&&Array.add(K,new x(N,E))}}return K}nNf(G,K){const R={};R.Query=K;R.SuggestionGroups=H.c(this.KMm(G));return H.c(R)}bIi(G){const K={"Content-Type":"application/json",Accept:"application/json"};K["X-Office-Version"]=y.AFrameworkApplication.buildVersion;K["X-Office-Application"]=
y.AFrameworkApplication.J.jb("Application");K["X-Office-Platform"]="WAC";K["X-TellMe-SqmUserId"]=y.AFrameworkApplication.J.jb("LoggableUserId")||"";K["X-TellMe-SessionId"]=this.Jc.Aua.Usa;K["X-TellMe-SuggestionTypes"]="Ranker";K["X-TellMe-Culture"]=y.AFrameworkApplication.uiCulture;K["X-TellMe-ProcessSessionId"]=y.AFrameworkApplication.userSessionId;K["X-TellMe-Flights"]=G;K["X-TellMe-PartialQueryIndex"]=this.P2e;return K}RWb(G,K,R){this.Lba(K.length,"RankerLogging",G.data.He.toString(),Math.round(window.performance.now()-
R),w.a.N_j,!0,f.a.iWa)}EWb(G,K,R){this.Lba(K.length,"RankerLogging",G.data.He.toString(),Math.round(window.performance.now()-R),w.a.N_j,!1,f.a.iWa)}cIi(){this.g$e||(this.g$e=new l.a(this.kc,null,6E3));return this.g$e.cda}F5f(G){const K=this.nNf(this.AKc,G),R=this.bIi("RankerLogging"),E=window.performance.now();this.If.Xj(this.cIi(),2,K,R,!1,0,N=>{this.RWb(N,G,E)},N=>{this.EWb(N,G,E)},null,null,!1,4E3,6E3);this.P2e++}cHo(){this.P2e=0}Mxg(G){this.Xyd=G}}Object(I.a)(F,"InteractionLogger",null,[])},2029:function(I,
J,d){I=d(0);var m=d(1746),f=d(48);class a{constructor(){this.source=0;this.il=this.Q0a=this.Oca=null;this.zma=0;this.VRb=!1;this.mode=this.J_a=0;this.e0c=null;this.IVb=f.a.create()}}Object(I.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.pza=!1;this.NL=null}}Object(I.a)(l,"OutputState",null,[]);class w{constructor(){this.ARi=this.Mye=this.cpd=!1;this.rc=this.hje=this.Zhg=this.Jse=this.aip=this.Wxl=this.ITa=this.$I=this.yvb=this.cyc=this.jtp=this.n6l=this.Sq=this.fvf=
this.sv=this.JA=this.Gn=this.VDe=this.d2d=this.qIa=null}}Object(I.a)(w,"RuntimeState",null,[]);d.d(J,"a",function(){return z});class z{constructor(){this.input=new a;this.runtime=new w;this.output=new l;this.logger=new m.a(this)}}Object(I.a)(z,"MergeState",null,[])},2030:function(I,J,d){d.r(J);I=d(0);var m=d(616),f=d(224),a=d(177),l=d(253),w=d(1615),z=d(1753),x=d(1793),u=d(5),v=d(2020);class D{constructor(E,N){this.start=E;this.end=N}}Object(I.a)(D,"MergeDiffIdx",null,[]);class y{constructor(E,N,
O,U=!1,X=null,V=null,Q=!0){this.Fzd=this.Ezd=this.Neh=this.yLc=0;this.lbc=this.NKe=null;this.qib=X||new v.a;this.xg=O;this.gwa=E.ONa();this.RRk=N.ONa();this.GS=new D(0,0);this.uW=new D(0,0);this.CUe=U;this.QIc=Q;this.Kwa=V;this.Sjl();this.gXo()}get OM(){return this.gwa}get kM(){return this.RRk}get XA(){return this.yLc}get NB(){return this.Neh}get Iza(){return this.Ezd}get Fra(){return this.Fzd}get hUl(){const E=new f.a;for(let N=this.NKe.start;N<this.NKe.end;N++)E.add(this.OM.ug(N));return E}get xwf(){const E=
new f.a;for(let N=this.lbc.start;N<this.lbc.end;N++)E.add(this.kM.ug(N));return E}Mxf(E){if(this.NB<E.NB){if(this.NB+this.Iza>E.NB)return!0}else if(this.NB>E.NB){if(E.NB+E.Iza>this.NB)return!0}else if(2===this.XA&&3===E.XA||3===this.XA&&2===E.XA||2===this.XA&&2===E.XA||3===this.XA&&3===E.XA)return!0;return!1}HEj(E,N,O,U){E.fI(N);E.SA(N,O);return U+=O.length-1}KWj(E,N,O,U,X){let V=this.OM.ug(E),Q=this.kM.ug(N);if(!V||!Q||!V.Deb&&!Q.Deb)return{returnValue:!1,SHa:U,TOa:X};let T=new f.a,ba=new f.a;V.Deb&&
(T=V.Wpd(),V=T.ug(O?0:T.length-1));Q.Deb&&(ba=Q.Wpd(),Q=ba.ug(O?0:ba.length-1));if(!V.aC(Q,this.qib,this.Kwa,this.CUe,this.QIc))return{returnValue:!1,SHa:U,TOa:X};T.length&&(U=this.HEj(this.OM,E,T,U));ba.length&&(X=this.HEj(this.kM,N,ba,X));return{returnValue:!0,SHa:U,TOa:X}}X8l(E,N,O,U,X,V){for(;X<=O&&V<=U;){const Q=E.ug(X),T=N.ug(V);if(!Q.aC(T,this.qib,this.Kwa,this.CUe,this.QIc))break;this.GS.start+=Q.length;this.uW.start+=T.length;X++;V++}return{tjf:X,iKg:V}}V8l(E,N,O,U,X,V){for(;X>=O&&V>=U;){const Q=
E.ug(X),T=N.ug(V);if(!Q.aC(T,this.qib,this.Kwa,this.CUe,this.QIc))return{returnValue:!0,SHa:X,TOa:V};X--;V--}return{returnValue:!1,SHa:X,TOa:V}}W8l(E,N,O,U){let X=!1;do({tjf:E,iKg:N}=this.X8l(this.OM,this.kM,O,U,E,N)),{SHa:O,TOa:U,returnValue:X}=this.KWj(E,N,!0,O,U);while(X);return{tjf:E,iKg:N,SHa:O,TOa:U}}U8l(E,N,O,U){let X=!1;do{if(!({SHa:O,TOa:U}=this.V8l(this.OM,this.kM,E,N,O,U)).returnValue)break;({SHa:O,TOa:U,returnValue:X}=this.KWj(O,U,!1,O,U))}while(X);return{SHa:O,TOa:U}}Sjl(){var E=0,N=
0,O=this.OM.length-1,U=this.kM.length-1;0<=O&&this.OM.ug(O);0<=U&&this.kM.ug(U);({tjf:E,iKg:N,SHa:O,TOa:U}=this.W8l(E,N,O,U));if(E<O||N<U)({SHa:O,TOa:U}=this.U8l(E,N,O,U));O++;U++;this.NKe=new D(E,O);this.lbc=new D(N,U);this.GS.end=this.GS.start;this.uW.end=this.uW.start;for(var X=E;X<O;X++){var V=this.OM.ug(X);this.GS.end+=V.length}for(X=N;X<U;X++)V=this.kM.ug(X),this.uW.end+=V.length;a.a.instance.Ua(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
E,O,N,U);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.GS.start,this.GS.end,this.uW.start,this.uW.end);this.GS.start<=this.GS.end&&this.uW.start<=this.uW.end&&(E=this.OM.ug(E),N=this.kM.ug(N),X=this.OM.ug(O),V=this.kM.ug(U),O=this.OM.ug(O-1),U=this.kM.ug(U-1),a.a.instance.Ua(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",
E,X,N,V,O,U))}gXo(){this.Neh=this.GS.start;this.Ezd=this.Fzd=0;this.GS.start===this.GS.end&&this.uW.start===this.uW.end?this.yLc=0:this.GS.start===this.GS.end&&this.uW.start<this.uW.end?(this.yLc=1,this.Fzd=this.uW.end-this.uW.start):this.uW.start===this.uW.end&&this.GS.start<this.GS.end?(this.yLc=2,this.Ezd=this.GS.end-this.GS.start):(this.yLc=3,this.Ezd=this.GS.end-this.GS.start,this.Fzd=this.uW.end-this.uW.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",
this.XA,this.NB,this.Iza,this.Fra)}Snn(E,N){return E.J7()&&N.J7()?E.runId===N.runId&&E.Rg===N.Rg:!1}Atn(E){if(!E.J7()||"\ufffc"!==E.text)return!1;E=E.jPb;return E?E.hasProperty(u.a.pk)||E.hasProperty(u.a.mTd)||E.hasProperty(u.a.oyf)||E.hasProperty(u.a.Y6)||E.hasProperty(u.a.imageType)||E.hasProperty(u.a.lXa)||E.hasProperty(u.a.STb)||E.hasProperty(u.a.jt)&&(E=this.xg.getPropertyInt32(E,u.a.jt))&&(36===E||35===E||24===E||23===E||33===E||34===E||44===E||45===E||42===E||43===E)?!0:!1:!1}M9c(E){return E.J7()&&
!this.Atn(E)}jll(){if(2===this.XA)return!1;var E=this.lbc.start;if(!E)return!1;let N=null;for(var O=this.lbc.start;O<this.lbc.end;O++){const U=this.kM.ug(O);if(this.M9c(U)){N=U;break}}if(!N)return!1;--E;for(O=this.kM.ug(E);O&&!this.M9c(O);)E--,O=this.kM.ug(E);return O&&this.Snn(O,N)?!0:!1}zyi(E){const N=new f.a;for(let O=0;O<E.length;O++)E.K(O).Deb?N.SA(N.length,E.K(O).Wpd()):N.insert(N.length,E.K(O));return N}Unn(){if(3!==this.XA||this.Iza!==this.Fra)return!1;const E=this.zyi(this.hUl),N=this.zyi(this.xwf);
if(E.length!==N.length)return!1;for(let O=0;O<E.length;O++)if(!E.K(O).aC(N.K(O),this.qib,this.Kwa,!0,this.QIc))return!1;return!0}Tnn(){if(0!==this.XA&&3!==this.XA||this.OM.length!==this.kM.length)return!1;let E=!1;for(let N=0;N<this.OM.length;N++){if(!this.OM.K(N).aC(this.kM.K(N),this.qib,this.Kwa,!0,this.QIc))return!1;if(3===this.OM.K(N).type||1===this.OM.K(N).type){const O=this.OM.K(N),U=this.kM.K(N);E=O.runId!==U.runId||O.Rg!==U.Rg||E}}return E}}Object(I.a)(y,"MergeBlockDiff",null,[]);var H=d(1550);
class F{constructor(E,N){this.id=E;this.index=N}}Object(I.a)(F,"ParagraphStartIndex",null,[]);var G=d(1644),K=d(1519);d.d(J,"ParagraphMerge",function(){return R});class R{constructor(E,N,O,U,X,V,Q){this.m$b=this.YGb=this.Rp=this.My=null;this.vi=!1;this.RIh=this.lhh=this.O9g=this.fya=this.AQa=this.gwa=null;this.fe=E;this.BH=N;this.hHa=U;this.NFa=O;this.Jwa=X;this.Kwa=V;this.xg=Q}fFi(E){const N=new m.a;E.OM.forEach(O=>{2===O.type&&N.add(O.xk);return!0});E.kM.forEach(O=>{2===O.type&&N.remove(O.xk);return!0});
return N}IBi(E){const N=new f.a;E.kM.forEach(O=>{2===O.type&&N.add(O.xk);return!0});return N}x5h(E){const N=new f.a;let O=0,U=0;E.kM.forEach(X=>{2===X.type&&(N.add(new F(X.xk,O<E.NB?O:O<E.NB+E.Fra?E.NB:O-E.Fra+E.Iza)),O=U);U+=X.length;return!0});return N}jyl(E,N){var O=this.x5h(E);const U=this.x5h(N);E=this.fFi(E);const X=this.fFi(N);N=new f.a;const V=new m.a;let Q=0;for(let T=0;T<O.length;T++){const ba=O.K(T);if(Q<U.length){let W=U.K(Q);for(;Q<U.length&&W.index<=ba.index;){if(W.id.equals(ba.id)){Q++;
break}E.contains(W.id)||V.contains(W.id)||(N.add(W.id),V.add(W.id));Q++;W=U.K(Q)}}X.contains(ba.id)||(N.add(ba.id),V.add(ba.id))}for(;Q<U.length;)O=U.K(Q),E.contains(O.id)||V.contains(O.id)||(N.add(O.id),V.add(O.id)),Q++;return N}initialize(){if(this.vi){const E=!!this.My&&!!this.Rp;this.fe.logger.Oi(Object.assign(new H.a,{gk:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return E}this.vi=!0;if(!({OM:this.gwa,c0c:this.AQa,Asd:this.fya,VSd:this.O9g,e2d:this.lhh,WDe:this.RIh}=
K.a.E$h(this.fe,this.xg,this.BH,this.NFa,this.hHa,this.Jwa,!1,!1)).returnValue)return!1;this.My=new y(this.gwa,this.AQa,this.xg,void 0,void 0,this.Kwa);this.Rp=new y(this.gwa,this.fya,this.xg,void 0,void 0,this.Kwa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.My.Iza,this.My.Fra,this.Rp.Iza,this.Rp.Fra));return!0}EOa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let E=!1;
const N=new x.a(this.xg,this.fe);let O=null,U=null;var X=null;const V=T=>this.fe.runtime.Gn.K(T),Q=T=>this.fe.runtime.sv.K(T)||this.fe.runtime.Gn.K(T);this.My=new y(this.gwa,this.AQa,this.xg,void 0,void 0,this.Kwa,!1);this.Rp=new y(this.gwa,this.fya,this.xg,void 0,void 0,this.Kwa,!1);({pK:O}=N.gbi(this.BH,V,this.NFa,T=>this.fe.runtime.JA.K(T)||this.fe.runtime.Gn.K(T),this.My.NB,this.My.NB+this.My.Iza,this.My.NB+this.My.Fra)).returnValue&&({pK:U}=N.gbi(this.BH,V,this.hHa,Q,this.Rp.NB,this.Rp.NB+this.Rp.Iza,
this.Rp.NB+this.Rp.Fra)).returnValue&&(E=!0);E||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),E=!1);E&&(X=new G.a(this.fe,this.BH,this.NFa,this.hHa,T=>this.fe.runtime.rc?this.fe.runtime.rc.isFeatureEnabled(T):!1,this.xg,null,O,U),({Sq:X}=X.oAc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.fe.logger.Oi(Object.assign(new H.a,{gk:"TryLCSMerge",eventId:"9zrqs"})),E=!1));a.a.instance.Ua(593826833,1,E?4:2,"TryLCSMerge: [Success: {0}]",
E);return{returnValue:E,Sq:X}}oAc(){let E;E=null;if(!this.initialize())return this.fe.logger.KX("ParagraphMerge Initialize"),this.Zab(),{returnValue:!1,Sq:E};this.fe.logger.KX("ParagraphMerge Initialize");let N;this.fe.logger.txe(2);let O=({EOa:N}=this.PWl()).returnValue;O=O&&({Sq:E,EOa:N}=this.F3c(this.fe,this.xg,this.Jwa,this.m$b,this.YGb)).returnValue;this.fe.logger.Byg();if(!O){this.fe.logger.KX("ParagraphMerge DoMergeInteral");if(N){this.fe.logger.txe(3);({Sq:E,returnValue:O}=this.EOa());this.fe.logger.Byg();
if(O)return{returnValue:!0,Sq:E};this.Zab();return{returnValue:!1,Sq:E}}this.Zab();return{returnValue:!1,Sq:E}}if(!({Sq:E,EOa:N}=this.F3c(this.fe,this.xg,this.Jwa,this.m$b,this.YGb)).returnValue)return this.fe.logger.KX("ParagraphMerge DoMergeInteral"),this.Zab(),{returnValue:!1,Sq:E};this.fe.logger.KX("ParagraphMerge DoMergeInteral");return{returnValue:!0,Sq:E}}F3c(){let E;if(!({jpe:E}=K.a.F3c(this.fe,this.xg,this.Jwa,this.m$b,this.YGb)).returnValue)return this.fe.logger.KX("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.Zab(),{returnValue:!1,Sq:E,EOa:!0};this.fe.logger.KX("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Sq:E,EOa:!1}}Zab(E=!1){a.a.instance.Sna(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+E+"] BaseRevisionMergeBlocksList: {0}",this.O9g);a.a.instance.Sna(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.lhh);a.a.instance.Sna(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.RIh);E=new f.a;K.a.Iqc(this.xg,"BaseObjects_",this.BH,E);K.a.Iqc(this.xg,"FavoredObjects_",
this.NFa,E);K.a.Iqc(this.xg,"ConflictObjects_",this.hHa,E);K.a.CEn(this.fe,E)}oZh(E){let N,O;O=N=0;if(0===this.My.XA)N=this.Rp.NB;else if(1===this.My.XA)N=this.Rp.NB<this.My.NB?this.Rp.NB:this.Rp.NB===this.My.NB?E||1!==this.Rp.XA?this.Rp.NB+this.My.Fra:this.Rp.NB:this.Rp.NB+this.My.Fra;else if(2===this.My.XA||3===this.My.XA)N=this.Rp.NB<=this.My.NB?this.Rp.NB:this.Rp.NB+(this.My.Fra-this.My.Iza);if(2===this.Rp.XA||3===this.Rp.XA)O=N+this.Rp.Iza;return{SKi:N,sTm:O}}joi(E,N){let O;O=0;if(!N)return{returnValue:!0,
fed:O};let U=0,X=0;for(;U<E.length;){let V;for(let Q=U;Q<E.length;Q++){U=Q;V=E.K(Q);const T=V.length;X+=T;if(!(X<N)){if(X>N)if(V.Deb)E.fI(U),E.SA(U,V.Wpd()),X-=T;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",N),this.fe.logger.Oi(Object.assign(new H.a,{gk:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,fed:O};break}}if(X===N)return U++,
O=U,{returnValue:!0,fed:O}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",N);this.fe.logger.Oi(Object.assign(new H.a,{gk:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,fed:O}}F9k(E,N,O){let U=0;var X=0,V=!1;const Q=this.Rp.xwf.ONa();if(this.Rp.jll())for(--N;0<=N;N--){let T=E.K(N);if(this.Rp.M9c(T)){X=E.K(N);U=X.runId;X=X.Rg;V=!0;break}}V||((X=E.K(O))&&this.Rp.M9c(X)?
(U=X.runId,X=X.Rg):X=U=0);for(E=0;E<Q.length;E++)O=Q.K(E),O.J7()&&(V=O,this.Rp.M9c(O)?(V.runId=U,V.Rg=X):(V.runId=0,V.Rg=0));return Q}B_i(E){if(2===E.length){const N=1===E.K(0).type?E.K(0):null;E=2===E.K(1).type;if(N&&E&&""===N.text)return!0}return!1}PWl(){const E=this.My.Tnn();if(!E&&0===this.My.XA)return this.m$b=this.Rp.kM.ONa(),this.YGb=this.IBi(this.Rp),{returnValue:!0,EOa:!1};if(0===this.Rp.XA)return this.m$b=this.My.kM.ONa(),this.YGb=this.IBi(this.My),{returnValue:!0,EOa:!1};(this.B_i(this.My.kM)||
this.B_i(this.Rp.kM))&&this.fe.logger.F9i(Object.assign(new H.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!E){var N=this.My.Mxf(this.Rp);N&&this.Jwa(47)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.My=new y(this.gwa,this.AQa,this.xg,!0,void 0,this.Kwa),this.Rp=new y(this.gwa,this.fya,this.xg,!0,void 0,this.Kwa),N=this.My.Mxf(this.Rp));if(N)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.fe.logger.Oi(Object.assign(new z.a,{gk:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,EOa:!0}}var O;N=0;this.YGb=this.jyl(this.My,this.Rp);({SKi:O,sTm:X}=this.oZh(!1));const U=this.My.kM.ONa();if(!({fed:O}=this.joi(U,O)).returnValue||(2===this.Rp.XA||3===this.Rp.XA)&&!({fed:N}=this.joi(U,X)).returnValue)return{returnValue:!1,EOa:!1};if(2===this.Rp.XA||3===this.Rp.XA){this.Dwc(U,N);this.Dwc(U,O-1);var X=null;for(var V=N-1;V>=O;V--)2===U.K(V).type&&(X=U.K(V)),U.fI(V);0<U.length&&(V=U.K(U.length-
1),2!==V.type&&4!==V.type&&X&&(this.fe.runtime.rc.LL(68),this.fe.runtime.rc.isFeatureEnabled(68)&&(U.add(X),this.YGb.add(X.xk))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",N-O-1,O)}if(1===this.Rp.XA||3===this.Rp.XA)X=this.Rp.xwf,E&&(X=this.F9k(U,O,N)),this.Dwc(U,O-1),this.Dwc(U,O),this.Dwc(X,0),this.Dwc(X,X.length-1),U.SA(O,X),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
O,E,X.Qr());this.m$b=U;return{returnValue:!0,EOa:!1}}Dwc(E,N){0>N||N>=E.length||(E=E.K(N),Object(l.a)(w.a,E)&&(E.dXa=!0))}Msd(E,N){let O;O=N;if(!this.initialize())return{returnValue:!1,jdb:E,Nua:O};if(this.Rp.Mxf(this.My))return this.Zab(!0),this.fe.logger.Oi(Object.assign(new z.a,{gk:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,jdb:E,Nua:O};if(0===this.Rp.XA||3===this.Rp.XA&&this.Rp.Unn())return{returnValue:!0,jdb:E,Nua:N};let U;({SKi:U}=this.oZh(!0));N<U||N===U&&(1!==this.Rp.XA||1===
this.Rp.XA&&1===this.My.XA&&N===this.My.NB+this.My.Fra)?O=N:(O=N+this.Rp.Fra-this.Rp.Iza,O<U&&(O=U));return{returnValue:!0,jdb:E,Nua:O}}}Object(I.a)(R,"ParagraphMerge",null,[1063])},2034:function(I,J,d){d.r(J);I=d(0);var m=d(13),f=d(5),a=d(33),l=d(177),w=d(224),z=d(48),x=d(1744),u=d(1614),v=d(1548),D=d(1519);class y{constructor(K,R,E=null,N=null){this.author=K;this.tdd=R;this.glg=E||z.a.nil;this.XLa=N}aC(K){return K?this.author===K.author&&this.tdd===K.tdd&&this.glg===K.glg&&this.XLa===K.XLa:!1}}
Object(I.a)(y,"RunMergeBlockTrackedChangeAttribute",null,[]);class H{constructor(K,R,E){this.Fsb=K||H.czf;this.Aob=R||H.czf;this.vua=E||H.czf}get nZm(){return 0<this.Fsb.author.length}get OYm(){return 0<this.Aob.author.length}get TZm(){return 0<this.vua.author.length}aC(K){return K?this.Fsb.aC(K.Fsb)&&this.Aob.aC(K.Aob)&&this.vua.aC(K.vua):!1}}H.czf=new y("",0);Object(I.a)(H,"RunMergeBlockTrackedChangeInfo",null,[]);var F=d(1810);d.d(J,"ParagraphMergeBlockCreator",function(){return G});class G extends u.a{constructor(K,
R,E,N,O,U,X,V){super();this.maxValue=Number.MAX_VALUE;this.Qt=new x.a;this.J4b=null;this.CG=0;this.roh=!1;this.xLc="";this.JJe=K;this.Kq=R;this.yv=E;this.pOk=N;this.yBd=O;this.Bnh=U;this.n8b=V;this.xg=X;if(this.xg.hasProperty(this.Kq,m.a.zn))if(this.xg.hasProperty(this.Kq,f.a.ed))if(this.xg.hasProperty(this.Kq,f.a.Iq))if(this.xg.hasProperty(this.Kq,f.a.It))if(this.xg.hasProperty(this.Kq,m.a.Sn))if(this.H5=this.xg.getPropertyString(this.Kq,m.a.zn),this.mcf=this.xg.getPropertyUint32(this.Kq,f.a.ed),
this.tt=this.xg.getPropertyUint32s(this.Kq,f.a.Iq),this.GId=this.xg.getPropertyUint32s(this.Kq,f.a.It),this.pSe=this.xg.getPropertyObjectIds(this.Kq,m.a.Sn),this.H5||""===this.H5)if(this.H5.length||1!==this.pSe.length||(this.tt.length||(this.tt.add(0),l.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.GId.length||(this.GId.add(0),l.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.FFk=this.E4d(this.Kq,f.a.Xag,this.tt.length),this.rNc=this.E4d(this.Kq,m.a.pCa,this.tt.length),this.Vpa=this.E4d(this.Kq,m.a.hzb,this.tt.length),this.hpa=this.E4d(this.Kq,f.a.QVa,this.tt.length),this.Ipa=this.bQm(this.Kq,f.a.RMa,this.tt.length),this.o7m(),K=this.xg.hasProperty(this.Kq,m.a.An)?this.xg.getPropertyUint32s(this.Kq,m.a.An):new w.a,this.mLd=D.a.rPj(K,this.H5.length),this.tt.length!==this.GId.length)l.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
R.id);else if(this.tt.length!==this.pSe.length)l.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",R.id);else{this.Bnh&&(this.xg.hasProperty(this.Kq,f.a.Kw)?this.J4b=this.xg.getPropertyObjectIds(this.Kq,f.a.Kw):(l.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",R.id),this.J4b=this.s2(this.tt.length,z.a.nil)),this.tt.length!==this.J4b.length&&(l.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
R.id,this.tt.length,this.J4b.length),this.J4b=this.s2(this.tt.length,z.a.nil)));if(this.tt.length!==this.rNc.length||this.tt.length!==this.Vpa.length||this.tt.length!==this.hpa.length||this.tt.length!==this.Ipa.length)this.tt.length===this.rNc.length||this.yBd||l.a.instance.Ua(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",R.id,this.tt.length,this.rNc.length),this.tt.length===this.Vpa.length||
this.yBd||l.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",R.id,this.tt.length,this.Vpa.length),this.tt.length===this.hpa.length||this.yBd||l.a.instance.Ua(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",R.id,this.tt.length,this.hpa.length),this.tt.length===this.Ipa.length||
this.yBd||l.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",R.id,this.tt.length,this.Ipa.length),K=this.xg.getPropertyBool(this.Kq,m.a.xqf),l.a.instance.Ua(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",R.id,O,null==K?!1:K),this.rNc=this.s2(this.tt.length,!0),this.Vpa=this.s2(this.tt.length,!1),this.hpa=this.s2(this.tt.length,
!1),this.Ipa=this.s2(this.tt.length,0),this.xg.setPropertyBool(this.Kq,m.a.xqf,!1);this.Qt.aFp(this.tt.length)?(this.mLd.length!==this.tt.length+1&&l.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",R.id,this.tt.length,this.mLd.length),this.HCk=!0):l.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",R.id)}else l.a.instance.Ua(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",R.id)}o7m(){this.xg.hasProperty(this.Kq,f.a.UKa)?this.Qt.Dsb=this.xg.getPropertyBools(this.Kq,f.a.UKa):this.Qt.Dsb=this.s2(this.tt.length,!1);this.xg.hasProperty(this.Kq,f.a.Hka)?this.Qt.zob=this.xg.getPropertyBools(this.Kq,f.a.Hka):this.Qt.zob=this.s2(this.tt.length,!1);this.xg.hasProperty(this.Kq,f.a.VKa)?this.Qt.Csb=this.xg.getPropertyStrings(this.Kq,f.a.VKa):this.Qt.Csb=this.s2(this.tt.length,"");this.xg.hasProperty(this.Kq,
f.a.bJa)?this.Qt.yob=this.xg.getPropertyStrings(this.Kq,f.a.bJa):this.Qt.yob=this.s2(this.tt.length,"");this.xg.hasProperty(this.Kq,f.a.WKa)?this.Qt.Esb=this.xg.getPropertyListOfMilliseconds(this.Kq,f.a.WKa):this.Qt.Esb=this.s2(this.tt.length,0);this.n8b&&this.xg.hasProperty(this.Kq,a.a.yWa)?this.Qt.xWa=this.xg.RLf(this.Kq,a.a.yWa):this.Qt.xWa=null;this.xg.hasProperty(this.Kq,f.a.cJa)?this.Qt.q7a=this.xg.getPropertyListOfMilliseconds(this.Kq,f.a.cJa):this.Qt.q7a=this.s2(this.tt.length,0);this.n8b&&
this.xg.hasProperty(this.Kq,a.a.sUa)?this.Qt.ENb=this.xg.RLf(this.Kq,a.a.sUa):this.Qt.ENb=null;this.xg.hasProperty(this.Kq,f.a.QMa)?this.Qt.Acb=this.xg.getPropertyBools(this.Kq,f.a.QMa):this.Qt.Acb=this.s2(this.tt.length,!1);this.xg.hasProperty(this.Kq,f.a.COa)?this.Qt.Kwb=this.xg.getPropertyStrings(this.Kq,f.a.COa):this.Qt.Kwb=this.s2(this.tt.length,"");this.xg.hasProperty(this.Kq,f.a.DOa)?this.Qt.Mwb=this.xg.getPropertyListOfMilliseconds(this.Kq,f.a.DOa):this.Qt.Mwb=this.s2(this.tt.length,0);this.n8b&&
this.xg.hasProperty(this.Kq,a.a.h0a)?this.Qt.TXb=this.xg.RLf(this.Kq,a.a.h0a):this.Qt.TXb=null;this.xg.hasProperty(this.Kq,f.a.qEa)?this.Qt.Lwb=this.xg.getPropertyObjectIds(this.Kq,f.a.qEa):this.Qt.Lwb=this.s2(this.tt.length,z.a.nil)}E4d(K,R,E){return this.xg.hasProperty(K,R)?this.xg.getPropertyBools(K,R):this.s2(E,!1)}bQm(K,R,E){return this.xg.hasProperty(K,R)?this.xg.getPropertyUint32s(K,R):this.s2(E,0)}s2(K,R){const E=new w.a;for(let N=0;N<K;N++)E.add(R);return E}vOm(K){const R=this.mLd.ug(K);
K=this.mLd.ug(K+1);return this.H5.substring(R,K)}aCi(){if(this.roh)return null;var K=this.CG<this.tt.length?this.tt.ug(this.CG):this.maxValue;if(K===this.maxValue||this.pOk&&!this.H5.length)return this.roh=!0,K=new v.a(this.yv,this.Kq.id,this.mcf),this.xLc=this.phf(this.xLc,K.toString()),K;const R=this.GId.ug(this.CG),E=this.pSe.ug(this.CG),N=this.FFk.ug(this.CG),O=this.rNc.ug(this.CG),U=this.Vpa.ug(this.CG),X=this.hpa.ug(this.CG),V=this.Ipa.ug(this.CG),Q=this.Bnh?this.J4b.ug(this.CG):null;var T=
null;this.Qt.Dsb.ug(this.CG)&&(T=new y(this.Qt.Csb.ug(this.CG)||"",this.Qt.Esb.ug(this.CG)));if(this.n8b&&null!=T){var ba=this.Qt.xWa.length<this.CG?this.Qt.xWa[this.CG]:null;null!=ba&&null!=ba.Wca&&(T.XLa=this.xg.THf(new Date(ba.Wca)))}ba=null;this.Qt.zob.ug(this.CG)&&(ba=new y(this.Qt.yob.ug(this.CG)||"",this.Qt.q7a.ug(this.CG)));if(this.n8b&&null!=ba){var W=this.Qt.ENb.length<this.CG?this.Qt.ENb[this.CG]:null;null!=W&&null!=W.Wca&&(ba.XLa=this.xg.THf(new Date(W.Wca)))}W=null;this.Qt.Acb.ug(this.CG)&&
(W=new y(this.Qt.Kwb.ug(this.CG)||"",this.Qt.Mwb.ug(this.CG),this.Qt.Lwb.ug(this.CG)));if(this.n8b&&null!=W){const aa=this.Qt.TXb.length<this.CG?this.Qt.TXb[this.CG]:null;null!=aa&&null!=aa.Wca&&(W.XLa=this.xg.THf(new Date(aa.Wca)))}T=new H(T,ba,W);ba=this.vOm(this.CG);this.CG++;W=ba.startsWith("\ufddfHYPERLINK ");K=new F.a(this.JJe,this.yv,this.Kq.id,R,K,E,ba,N,!W,O,U,X,V,T,Q);this.xLc=this.phf(this.xLc,K.toString());return K}GBi(){let K;K=null;var R="";if(!this.HCk)return{P7f:K,obb:R};if(R=this.aCi())K=
new w.a,K.add(R);for(;R=this.aCi();)K.add(R);R=this.xLc;return{P7f:K,obb:R}}}Object(I.a)(G,"ParagraphMergeBlockCreator",u.a,[])},2040:function(I,J,d){d.r(J);I=d(0);var m=d(224),f=d(1614),a=d(1547);class l extends a.a{constructor(z,x){super(4,z,x)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.xk)}ejc(){return"Table"}clone(){return new l(this.source,this.xk)}aC(z,x,u,v=!1){return super.aC(z,x,u,v)?this.xk.equals(z.xk):!1}get length(){return 1}}Object(I.a)(l,"TableMergeBlock",
a.a,[]);d.d(J,"TableMergeBlockCreator",function(){return w});class w extends f.a{constructor(z,x){super();this.Z9g=new l(x,z.id)}GBi(){let z;z=new m.a;z.add(this.Z9g);return{P7f:z,obb:this.phf("",this.Z9g.toString())}}}Object(I.a)(w,"TableMergeBlockCreator",f.a,[])},2149:function(I,J,d){function m(a){var l=!0,w=[];a.forEach(function(z){var x,u=z.classification;if(u===f.a.POg.LQg||u===f.a.POg.Bfk){u=(x={},x.name=z.name,x.bool=null,x.string=null,x["double"]=null,x.int64=null,x.date=null,x.contract=
null,x);switch(z.dataType){case f.a.Xud.Boolean:u.bool=z.value;break;case f.a.Xud.Double:u["double"]=z.value;break;case f.a.Xud.Int64:u.int64=z.value;break;case f.a.Xud.String:u.string=z.value;break;default:return}w.push(u)}else l=!1});return l?w:[]}d.d(J,"a",function(){return m});var f=d(2150)},2164:function(I,J,d){d.r(J);var m=d(2),f=d(0),a=d(173),l=d(785);class w extends a.a{constructor(ea,Xa){super(!1,!1,!0);this.CZb=(yb,Ub)=>{1===yb&&(this.QEa.FSf=Ub.tooltipPersistenceEnabled,m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",
!1)&&(yb=Ub.textSelectionChangeEnabled,this.QEa.uzc!==yb&&this.oQk.raiseEvent(l.a.yoj),this.QEa.uzc=yb))};this.QEa=ea;this.oQk=Xa}start(){const ea={["tooltipPersistenceEnabled"]:this.QEa.FSf};m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(ea.textSelectionChangeEnabled=this.QEa.uzc);this.Uh("",this.CZb,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:ea})}}Object(f.a)(w,"AccessibilitySettingsDialog",a.a,[]);var z=d(87),x=d(12);
class u{constructor(ea,Xa){this.$6o=()=>{(new w(this.QEa,l.a.instance())).start();return 32};this.ga=ea;this.QEa=Xa}Xb(){this.ga.qa(x.a.Z6o,z.a.frame,this.$6o)}}Object(f.a)(u,"AccessibilitySettingsDialogActor",null,[897]);var v=d(342);const D=ea=>{const Xa=new v.a;m.AFrameworkApplication.Fe.Xj(H(ea),1,null,null,!0,2,yb=>{200===yb.data.He?Xa.gg("true"===yb.data.Pe.toLowerCase()):Xa.gg(!1)},()=>{Xa.gg(!1)},null,void 0,void 0,void 0,void 0,"7");return Xa.task},y=(ea,Xa)=>{m.AFrameworkApplication.Fe.Xj(H(ea),
2,Xa.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},H=ea=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",ea,m.AFrameworkApplication.rm);var F=d(151);class G{constructor(){this.Nac=this.q7b=null}get FSf(){return!!this.q7b}set FSf(ea){ea!==this.q7b&&(this.q7b=ea,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ea),this.afe()&&y("saveHoverableRibbonTooltipIsEnabled",
ea))}get uzc(){return!!this.Nac}set uzc(ea){ea!==this.Nac&&(this.Nac=ea,this.afe()&&y("saveTextSelectionHighlightChangeIsEnabled",ea))}$Bn(){const ea=new v.a;if(this.q7b)ea.gg(this.q7b);else if(this.afe()){const Xa=D("getHoverableRibbonTooltipIsEnabled");Xa.continueWith(()=>{this.q7b=Xa.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Xa.result);ea.gg(Xa.result)},8)}else ea.gg(!1)}ECn(){const ea=new v.a;if(this.Nac)ea.gg(this.Nac);else if(this.afe()){const Xa=
D("getTextSelectionHighlightChangeIsEnabled");Xa.continueWith(()=>{this.Nac=Xa.result;ea.gg(Xa.result)},8)}else ea.gg(!1)}afe(){const ea=m.AFrameworkApplication.J.$("IsRoamingServiceEnabled"),Xa=m.AFrameworkApplication.J.$("IsAnonymousUser");return ea&&!Xa}}Object(f.a)(G,"AccessibilitySettingsInfo",null,[896]);var K=d(178),R=d(25);class E{constructor(){this.Z=null}get name(){return"Common.App.AccessibilitySettings"}wc(ea){this.Z=ea;this.Z.register(G,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ud(()=>
new G).ha();this.Z.register(u,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ud(()=>new u(m.AFrameworkApplication.va,this.Z.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const ea=this.Z.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Xa=this.Z.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");ea&&Xa?(Xa.Xb(),ea.$Bn(),ea.ECn(),R.b(508827098,
200,50,"Text Selection Highlight Change Setting value on boot: {0}",ea.uzc)):R.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){K.a.instance.Mc(new E)}}Object(f.a)(E,"AccessibilitySettingsPackage",null,[0,1]);var N=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",
Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},O=d(109),U=d(86);class X extends Sys.EventArgs{constructor(ea,Xa){super();this.nCe=ea;this.actualValue=Xa}}Object(f.a)(X,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class V{constructor(){this.m5b=[];this.Och=this.QNe=0;this.tk=null;this.sa=new U.a;this.kDl=(ea,Xa)=>{R.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.aYd(Xa.nCe,
Xa.actualValue))}}init(ea,Xa,yb){this.tk=ea;this.QNe=Xa;this.Och=yb;this.tk.mff(Object(O.a)(this,this.Kle,"onCpuMeterFrameAvailable"));this.k1k(this.kDl)}Kle(ea,Xa){Xa.qgj&&(Array.enqueue(this.m5b,Xa.qgj.CP),this.m5b.length>this.Och&&(Array.dequeue(this.m5b),this.Kol()))}Kol(){var ea=this.m5b.length;let Xa=0;for(let yb=0;yb<ea;yb++){const Ub=Array.dequeue(this.m5b);Xa+=Ub;Array.enqueue(this.m5b,Ub)}ea=Xa/ea;ea>this.QNe&&this.sa.raiseEvent("CPTTE",new X(this.QNe,ea))}k1k(ea){this.sa.addHandler("CPTTE",
ea)}aYd(ea,Xa){const yb={};yb.ThresholdValue=ea;yb.ActualValue=Xa;return yb}}Object(f.a)(V,"CpuMeterMonitor",null,[998]);class Q{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(Q,"ProfileInformation",null,[]);var T=d(10),ba=d(35),W=d(219),aa=d(81);class Y{constructor(ea=0,Xa=0){this.GEb=!1;this.fEb={};this.nGd=ea;this.GGd=Xa;this.Maf=0;ba.a.addHandler(window.self,T.a.IQh,()=>{this.GEb=!0});ba.a.addHandler(window.self,T.a.JQh,()=>{this.GEb=!1})}LQh(ea,Xa,yb){const Ub=Y.generateKey(Xa,yb);
Ub in this.fEb?Xa=this.fEb[Ub]:(Xa=new Q,Xa.S=yb?1:0,this.fEb[Ub]=Xa,this.Maf++);Xa.C++;Xa.M=ea>Xa.M?ea:Xa.M;Xa.T+=ea}GHa(ea,Xa){this.LQh(ea,Xa,!1);this.GEb&&this.LQh(ea,Xa,!0)}getData(){if(0<this.GGd&&this.Maf>this.GGd)return this.Fom();const ea=0<this.nGd,Xa={},yb=this.fEb;for(const yc in yb){var Ub=yc;const ad=yb[yc];this.lIj(ad);ea&&ad.T>=this.nGd&&(Xa[Ub]=ad)}return ea?aa.a.Qf(Xa)?null:Xa:this.fEb}Fom(){var ea=0<this.nGd,Xa=[];const yb=this.fEb;for(const Ub in yb){const yc={key:Ub,value:yb[Ub]},
ad=yc.value;(!ea||ad.T>=this.nGd)&&Array.add(Xa,yc)}if(Xa.length>this.GGd)Xa.sort((Ub,yc)=>yc.value.T-Ub.value.T),Xa=Xa.slice(0,this.GGd);else if(!Xa.length)return null;ea={};for(const Ub of Xa)Xa=Ub.value,this.lIj(Xa),ea[Ub.key]=Xa;return ea}lIj(ea){ea.M=W.a.UP(ea.M,0);ea.T=W.a.UP(ea.T,0)}reset(){this.fEb={};this.Maf=0}static generateKey(ea,Xa){return Xa?ea+" [it]":ea}}Object(f.a)(Y,"FunctionCallAggregator",null,[899]);var da=d(1186);class ka{}Object(f.a)(ka,"CpuMeterFrame",null,[]);class qa extends Sys.EventArgs{constructor(ea){super();
this.qgj=ea}}Object(f.a)(qa,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class ua{}Object(f.a)(ua,"MiniTaskItemInfo",null,[]);class Pa{}Object(f.a)(Pa,"TaskItemInfo",null,[]);var Ja=d(1048),Ca=d(1302),ra=d(182);class Ea{constructor(ea,Xa,yb,Ub,yc){this.LIb=0;this.G1=null;this.pLd=this.UFh=0;this.Hxa=!1;this.F6b=0;this.IJc=!1;this.qxa=null;this.HDd=0;this.n1e=new U.a;this.ONd=[];this.nB=ea;this.n_e=Xa;this.uSe=yb;this.Uth=Ub;m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WrapSetTimeoutForTelemetryIsEnabled")&&
this.Fpc();this.$uk=yc;this.vSe=new Y(100);this.oEk=Ja.a.dH(1,5,new Ca.a)}mff(ea){this.n1e.addHandler("OnCpuMeterFrameAvailable",ea)}GDj(ea){this.n1e.removeHandler("OnCpuMeterFrameAvailable",ea)}Nwb(ea,Xa,yb,Ub=null){yb=Ub?Ub.priority:7;const yc=this.nB();this.start(Xa,yb);try{ea()}finally{this.stop(Xa,Ub),ea=this.nB()-yc,this.Uth.track(ea,Xa)}}le(ea,Xa){const yb=this.nB();try{ea()}finally{ea=this.nB()-yb,this.uSe.GHa(ea,Xa),0<this.LIb&&this.vSe.GHa(ea,Xa),this.Uth.track(ea,Xa)}}dgg(ea){const Xa=
new Pa;Xa.TN=ea.a6f;Xa.TP=ea.priority;this.dyj(1,Xa)}brc(ea){this.HDd|=ea}start(ea,Xa){if(!this.LIb){this.vSe.reset();const yb=this.E3i(ea);yb&&this.Jie(1);this.G1=new Pa;this.G1.TN=ea;this.G1.TP=Xa;this.G1.ST=(new Date).toISOString();this.G1.STS=W.a.UP(this.nB(),2);yb?this.G1.UI=1:this.con(ea)?this.G1.UI=2:this.G1.UI=0}this.LIb++}Jie(ea){this.F6b|=ea}pVd(ea=!0,Xa=0){this.F6b=ea?0:this.F6b&~Xa}stop(ea,Xa=null){let yb;this.LIb--;0>=this.LIb&&this.G1&&(yb=this.nB()-this.G1.STS,this.pLd+=yb,this.n_e.GHa(yb,
ea),this.E3i(ea)&&this.pVd(!1,1),this.G1.TRT=W.a.UP(yb,2),Xa&&(this.G1.TQT=W.a.UP(Xa.Umo,2),this.G1.TDT=W.a.UP(Xa.Y4i,2)),this.$uk&&(this.dyj(0,this.G1),this.EFo()),this.LIb=0);0<=ea.indexOf(da.a.osp)&&this.brc(2);0<=ea.indexOf(da.a.PEj)&&this.brc(4);1===(this.F6b&1)&&this.brc(1);2===(this.F6b&2)&&this.brc(8)}EFo(){var ea=this.G1.TRT;if(750<ea){let yb=this.vSe.getData();if(yb){const Ub={};for(const yc in yb){var Xa=yb[yc];const ad=yc;ad.startsWith("SiOp_")||ad.endsWith("[it]")||(Ub[ad]=Math.round(100*
Xa.T/ea))}yb=Ub}ea=Object.assign(new ua,{B:this.G1.STS,T:ea,S:yb});this.oEk.track(ea,this.G1.TN)}}bbp(){var ea=this.nB()-this.UFh,Xa=W.a.UP(this.pLd/ea*100,2);ea=new ka;ea.CP=Xa;ea.II=this.HDd;Xa=this.n_e.getData();aa.a.count(Xa)&&(ea.LRT=Xa);Xa=this.uSe.getData();aa.a.count(Xa)&&(ea.FP=Xa);this.n1e.raiseEvent("OnCpuMeterFrameAvailable",new qa(ea));this.mXj()}mXj(){this.n_e.reset();this.uSe.reset();this.pLd=this.LIb=0;this.UFh=this.nB();this.HDd=0;this.G1=null}run(){this.Hxa?this.bbp():(this.mXj(),
this.Hxa=!0);this.qxa?this.qxa(Object(O.a)(this,this.run,"run"),1E3):window.setTimeout(Object(O.a)(this,this.run,"run"),1E3)}CQd(ea,Xa,yb){const Ub=Array(2);Ub[0]=Xa;Ub[1]=yb;this.ONd[ea]||(this.ONd[ea]=[]);this.ONd[ea].push(Ub)}dyj(ea,Xa){ea=this.ONd[ea];if(!ra.a.Qf(ea))for(let Ub=0;Ub<ea.length;Ub++){var yb=ea[Ub];const yc=yb[0];yb=yb[1];yc&&!yc(Xa)||yb(Xa)}}Fpc(){if(!this.IJc){const ea=window.setTimeout;this.qxa=(Xa,yb)=>ea(Xa,yb);this.IJc=!0}}E3i(ea){return ea.startsWith("key")||ea.startsWith("input")}con(ea){return ea.startsWith("click")||
ea.startsWith("mouse")||ea.startsWith("pointer")}}Object(f.a)(Ea,"CpuMeter",null,[135]);class xa{constructor(ea){this.pFc=null;this.Mq=new v.a;this.nB=ea}initialize(ea,Xa,yb,Ub=!1){this.pFc||(this.pFc=new Ea(this.nB,ea,Xa,yb,Ub),this.Mq.gg(this.pFc));return this.pFc}}Object(f.a)(xa,"CpuMeterProvider",null,[997]);var Ma=d(156);class ha{constructor(ea=1){this.mF=[];this.xzd=[];this.Pk=ea}f9l(){let ea=0;for(let Xa=0;Xa<this.mF.length;Xa++)this.mF[Xa]<this.mF[ea]&&(ea=Xa);return ea}GHa(ea,Xa){ea=W.a.UP(ea,
2);if(this.mF.length<this.Pk)Array.add(this.mF,ea),Array.add(this.xzd,Xa);else{var yb=this.f9l();ea>this.mF[yb]&&(this.mF[yb]=ea,this.xzd[yb]=Xa)}}getData(){return this.mF.length?{["Vals"]:this.mF,["Desc"]:this.xzd}:null}reset(){this.mF=[];this.xzd=[]}}Object(f.a)(ha,"MaxDataAggregator",null,[899]);var la=d(43),Fa=d(19);class Ga{get name(){return"Common.App.CpuMeter"}wc(ea){ea.register(xa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().Ud(()=>new xa(la.a.Je));ea.register(V,
"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().Ud(()=>new V)}init(){const ea=m.AFrameworkApplication.J;if(ea.$("CpuMeterIsEnabled")){const Xa=Fa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");Ma.a.instance.ehf.continueWith(()=>{Ga.e8m(ea,Xa)})}}dispose(){}static e8m(ea,Xa){const yb=Ja.a.dH(10,5,new Y(ea.jc("TaskManagerLoggingThreshold",0),ea.jc("CpuMeterMaximumEntriesToLog",0)));Xa=Xa.initialize(new ha(5),new Y,yb,ea.$("CPUMeterExposeTaskDetailsIsEnabled"));
ea.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(Xa.run(),ea.$("CpuMeterMonitorIsEnabled")&&Fa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Xa,ea.RJ("CpuMeterAverageCpuPercentThreshold",80),ea.jc("CpuMeterRollingAverageFramesCount",15)));R.b(16827671,306,50,"Initializing CpuMeter")}static main(){K.a.instance.Mc(new Ga)}}Object(f.a)(Ga,"CpuMeterPackage",null,[0,1]);var va=d(8),pa=d(85),Oa=d(1072),Ra=d(1058),fb=d(17),qb=d(1303);class mb{constructor(){this.vxa=this.mDc=null;
this.MJb=!0;this.SJc=!1}wc(ea){m.AFrameworkApplication.J.$("EventTimingMeterIsEnabled")&&ea.register(853,"Common.IEventTimingMeter").ha().Ud(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var ea=new Ra.a(m.AFrameworkApplication.J.jc("EventTimingMeterEventSamplingPercent",0)/100);ea=new Oa.a(Object(O.a)(ea,ea.h0b,"shouldBeInSample"));const Xa=Ja.a.dH(16,1,ea);this.vxa=new qb.a("TypingDuration-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.RJ("AshaVetoForTypingThresholdInMS",
150),m.AFrameworkApplication.J.RJ("AshaVetoForTypingThresholdPercentile",95),this.MJb);(this.SJc=!fb.a.mab)&&m.AFrameworkApplication.fG(()=>{this.Cnf()});this.mDc=yb=>{yb=yb.rawEvent.detail;for(const Ub of yb)Xa.track(Ub,"EventTimingData"),"false"!==Ub.metadata.altPressed.toString()||"false"!==Ub.metadata.ctrlPressed.toString()||"false"!==Ub.metadata.repeat.toString()||"CharacterKey"!==Ub.metadata.key.toString()&&"Space"!==Ub.metadata.key.toString()||!this.SJc||this.vxa.eDa(Ub.timeToRequestAnimationFrameMs)};
ba.a.addHandler(window.self,T.a.HQh,this.mDc)}dispose(){this.mDc&&(ba.a.removeHandler(window.self,T.a.HQh,this.mDc),this.mDc=null)}Cnf(){this.vxa.sZa();this.vxa.dqj&&(va.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),pa.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){K.a.instance.Mc(new mb)}}Object(f.a)(mb,"EventTimingMeterPackage",null,[0,1]);var eb=d(71),bb=d(80),Wa=d(29);class Za{constructor(ea,
Xa,yb,Ub=null,yc=null){this.LQb=ad=>{let md=!1,Sd=null;try{if(0<ad.data.Pe.length){const ze=Object(bb.a)(Object,Wa.a(ad.data.Pe)),Ne=ze?ze[this.kO.ghf]:null;Ne&&(Sd=Object(bb.a)(Object,Wa.a(Ne.toString())))}md=!0}catch(ze){this.u9a(null)}md&&this.fIc&&this.fIc(ad.data,Sd)};this.u9a=ad=>{this.$Hc&&this.$Hc(ad?ad.data:null)};this.Teo=ad=>{this.Ezh&&this.Ezh(ad?ad.data:null)};this.wcb=ad=>{this.FNc&&this.FNc(ad?ad.data:null)};this.kO=ea;this.fIc=Xa;this.$Hc=yb;this.Ezh=Ub;this.FNc=yc}VAf(ea){const Xa=
new Sys.StringBuilder(this.kO.Zld);Xa.append("RoamingServiceHandler.ashx?action=");Xa.append("getFirstRunExperienceSettings");Xa.append("&");Xa.append(this.VLf(ea));Xa.append("&");Xa.append(m.AFrameworkApplication.rm);m.AFrameworkApplication.Fe.Xj(Xa.toString(),1,null,null,!0,2,this.LQb,this.u9a,null)}F1d(ea){var Xa=new Sys.StringBuilder(this.kO.Zld);Xa.append("RoamingServiceHandler.ashx?action=");Xa.append("saveFirstRunExperienceSettings");Xa.append("&");Xa.append(m.AFrameworkApplication.rm);Xa=
Xa.toString();ea=Wa.c(ea);m.AFrameworkApplication.Fe.Xj(Xa,2,ea,null,!0,4,this.Teo,this.wcb,null)}VLf(ea){const Xa=new Sys.StringBuilder("requestedsettings=");for(let yb=0;yb<ea.count;yb++)Xa.append(ea.K(yb)),yb<ea.count-1&&Xa.append(";");return Xa.toString()}}Object(f.a)(Za,"FirstRunExperienceRequestHandler",null,[]);var Na=d(251);class Db{constructor(){this.HHc=this.kBd=this.kO=null;this.LQb=(ea,Xa)=>{ea=ea?+ea.IO-+ea.jH:-1;ea>this.kO.YHj?va.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
ea,this.kO.YHj):Xa?this.X6o(Xa)?(va.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.kO.$dj),this.NBg()):(this.Xwf(!1),va.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(va.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.NBg())};this.u9a=ea=>
{this.Xwf(!1);va.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",ea?ea.He:-1)};this.wcb=ea=>{va.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",ea?ea.He:-1)};this.sZn=ea=>{if(ea){var Xa=ea.detail;ea=ea.type;var yb=this.kO&&this.kO.NZh?this.kO.NZh.split("-")[0]:null;if("FRELaunchedEvent"===ea||yb&&Xa&&Xa.id&&-1!==Xa.id.indexOf(yb)){if("FRELaunchedEvent"===
ea||Xa&&Xa.success)va.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.eJj(this.kO.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.HHc,!0),window.removeEventListener("FRELaunchedEvent",this.HHc,!0))}}}}i8o(ea){ea?(this.kO=ea,this.Xnn()&&(va.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),ea=new eb.a,ea.add(this.kO.ghf),this.kBd=new Za(this.kO,
this.LQb,this.u9a,null,this.wcb),this.kBd.VAf(ea)),(this.kO.S2i||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.NBg()):va.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Xnn(){try{if(this.kO.S2i)return!0;if(!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||m.AFrameworkApplication.J.$("IsAnonymousUser"))return!1;if(this.kO.rin||this.kO.epc||m.AFrameworkApplication.J.$("IsO365ConsumerHost"))return!0;
const ea=m.AFrameworkApplication.J.jb("FlightId");return-1!==(ea?ea.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(ea){va.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",ea?ea.toString():null)}return!1}eJj(ea){const Xa={},yb={};yb.FREDisplayedDate=(new Date).toUTCString();yb.VersionDisplayed=ea;yb.RemindMeLater=!1;Xa[this.kO.ghf]=Wa.c(yb);va.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.kBd&&
this.kBd.F1d(Xa)}NBg(){this.Xwf(!0);var ea=Fa.a.instance.Oa("Common.ISystemInitiatedFeedback");ea?this.dUj(ea):(va.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((ea=Fa.a.instance.Ta("Common.ISystemInitiatedFeedback"))?ea.execute(Xa=>{this.dUj(Xa)}):va.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}dUj(ea){if(ea){var Xa=
this.kO.Pam;Xa&&m.AFrameworkApplication.jga(Xa);va.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Xa);ea.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.HHc=this.sZn,window.addEventListener("FGWebSurfaceEvent",this.HHc,!0),window.addEventListener("FRELaunchedEvent",this.HHc,!0)):(va.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.eJj(this.kO.currentVersion))}else va.ULS.sendTraceTag(539494112,
306,50,"Invalid ISystemInitiatedFeedback")}X6o(ea){if("RemindMeLater"in ea&&"FREDisplayedDate"in ea){if("true"===ea.RemindMeLater.toString()&&(+new Date-+new Date(ea.FREDisplayedDate.toString()))/36E5>this.kO.$dj)return!0}else if(m.AFrameworkApplication.J.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in ea&&ea.VersionDisplayed<this.kO.currentVersion)return va.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Xwf(ea){m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Na.a.dispatch("FREDecisionEvent",{["show"]:ea})}}Object(f.a)(Db,"FirstRunExperienceLauncher",null,[851]);class nb{constructor(){this.Z=null}get name(){return"Common.App.FirstRunExperienceLauncher"}wc(ea){this.Z=ea;this.Z.register(851,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().Ud(()=>new Db)}init(){}dispose(){}static main(){K.a.instance.Mc(new nb)}}Object(f.a)(nb,"FirstRunExperienceLauncherPackage",null,[0,1]);class Ta{constructor(){this.y=this.x=0}}Object(f.a)(Ta,"HammerPoint",
null,[]);class cb{constructor(ea,Xa,yb,Ub,yc){this.Zrh=this.F2a=this.uDd=1;this.UOd=this.hRc=this.c5a=0;this.D0e=this.QPa=null;this.GBb=this.MRe=this.QJd=!1;this.Wj=ea;this.wSa=Xa;this.Ikb=yb;this.ga=Ub;yc&&(this.QJd=yc.$("PromoteLayerPinchToZoomIsEnabled"),this.MRe=yc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.GBb=yc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get NI(){return this.wSa}get Hvg(){return this.Ikb}fln(){return!!this.Wj.instance}PZn(ea){this.ga&&this.ga.Ob(x.a.AXj,2);const Xa=
this.Wj.instance;this.QJd&&Xa.Xxj();this.F2a=Xa.nl;this.uDd=ea.z1c.scale;this.Zrh=1;this.D0e=this.uZh();this.QPa=this.wSa.getBounds();if(!this.QPa)return va.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;ea=this.ZDi(ea);this.GBb?this.SOj(this.wSa.scrollWidth,this.QPa.width,ea,this.F2a,Xa):this.c5a=this.wSa.scrollWidth>this.QPa.width?this.yUc(this.Ikb.scrollLeft,ea.x,this.F2a):null;this.UOd=this.wSa.scrollHeight>this.QPa.height?this.yUc(this.Ikb.scrollTop,ea.y,this.F2a):null;return!0}utg(){this.c5a=
null;this.hRc=0}SOj(ea,Xa,yb,Ub,yc){ea>Xa?this.c5a?(ea=yc.T2f,ea!==this.hRc&&(this.c5a-=this.hRc-ea,this.hRc=ea)):(this.c5a=this.yUc(this.Ikb.scrollLeft,yb.x,Ub),this.hRc=yc.T2f):this.utg()}OZn(ea){const Xa=this.ZDi(ea);if(!Xa)return va.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;ea=this.FUo(ea.z1c.scale/this.uDd)*this.F2a;this.GAp(Xa,ea);this.HAp(Xa,ea);return!0}GAp(ea,Xa){const yb=this.wSa.scrollWidth,Ub=this.QPa.width;this.GBb?this.SOj(yb,Ub,ea,Xa,this.Wj.instance):!this.c5a&&
yb>Ub&&(this.c5a=this.yUc(this.Ikb.scrollLeft,ea.x,Xa));if(ea=this.yZh(ea.x,this.c5a,yb,Ub,Xa))this.Ikb.scrollLeft=ea}HAp(ea,Xa){const yb=this.wSa.scrollHeight,Ub=this.QPa.height;!this.UOd&&yb>Ub&&(this.UOd=this.yUc(this.Ikb.scrollTop,ea.y,Xa));if(ea=this.yZh(ea.y,this.UOd,yb,Ub,Xa))this.Ikb.scrollTop=ea}yZh(ea,Xa,yb,Ub,yc){return yb<=Ub||!Xa||!Ub?null:Math.max(0,Math.min(Xa*yc-ea,yb-Ub))}yUc(ea,Xa,yb){return(ea+Xa)/yb}NZn(ea){ea=ea.z1c.scale;this.MRe&&(ea/=this.uDd);this.Hni(ea);this.QJd&&this.Wj.instance.yog();
this.ga&&this.ga.Ob(x.a.Azf,2);this.GBb&&this.utg()}MZn(ea){ea=ea.z1c.scale;this.MRe&&(ea/=this.uDd);this.Hni(ea,!0);this.QJd&&this.Wj.instance.yog();this.ga&&this.ga.Ob(x.a.Azf,2);this.GBb&&this.utg()}FUo(ea){const Xa=this.Wj.instance,yb=new Date>=this.D0e;yb&&(this.D0e=this.uZh());Math.abs(ea-this.Zrh)>=.01*ea&&Xa.H0o(ea*this.F2a,yb);return Xa.nl/this.F2a}Hni(ea,Xa=!1){ea*=this.F2a;this.Wj.instance.Jzg(ea,!1);const yb={};yb.initialScale=this.F2a;yb.finalScale=ea;yb.cancelled=Xa;va.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",yb)}ZDi(ea){return(ea=ea.z1c.center)&&this.QPa?Object.assign(new Ta,{x:ea.x-this.QPa.x,y:ea.y-this.QPa.y}):null}uZh(){const ea=(new Date).getTime();return new Date(ea+1E3)}}Object(f.a)(cb,"PinchZoomAdapter",null,[929]);class sb{constructor(ea){this._element=ea}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)(sb,"ScrollContainerElement",null,
[928]);var pb=d(127);class tb{constructor(ea,Xa,yb,Ub,yc,ad){this.e9e=this.nib=null;this.Z=ea;this.ee=Xa;this.DEd=yb;this.Mph=Ub;this.RBk=yc;this.h7b=ad;this.gyd=new eb.a}register(ea,Xa){this.DEd&&(4===m.AFrameworkApplication.ua.Gb.Mk&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?pb.a.get_instance().Sk(8,()=>{this.AGj(ea,Xa)}):this.AGj(ea,Xa))}AGj(ea,Xa){this.Z.Ta("Common.IGestureInputManager").execute(yb=>{this.Rdp();this.nib=yb;this.gyd.add(ea);
if(this.Mph){if(this.RBk&&0!==yb.rum()){this.gYj();return}var Ub=this.Z.Ta("Common.IZoomManager");this.Z.resolve("Common.IAppSettingsManager");const yc=new sb(ea);Ub=new cb(Ub,yc,Xa,m.AFrameworkApplication.va,m.AFrameworkApplication.J);yb.qvo(ea,Ub)}this.gYj()})}unregister(){if(this.nib&&this.gyd){if(this.Mph){for(const ea of this.gyd)this.nib.Vtp(ea);this.gyd.clear()}this.nib=null}}Rdp(){this.h7b&&(this.ee?this.e9e=this.ee.Xf("Task","Register"):va.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}gYj(){this.h7b&&
(this.e9e?this.e9e.stop():va.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(tb,"GestureInputRegistrar",null,[852]);class wb{constructor(){this.Z=null;this.vi=!1}get name(){return"Common.App.GestureInput"}init(){this.vi||(this.Z.resolve("Common.IGestureInputRegistrar"),this.vi=!0)}dispose(){}wc(ea){this.Z=ea;ea.register(852,"Common.IGestureInputRegistrar").ha().Ud(()=>new tb(ea,m.AFrameworkApplication.ua.Vr,m.AFrameworkApplication.T9c(),m.AFrameworkApplication.n0i(),
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("PinchZoomOnlyPointerEventsIsEnabled"),!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled")))}static main(){K.a.instance.Mc(new wb)}}Object(f.a)(wb,"GestureInputPackage",null,[0,1]);var gc=d(425),vc=d(95);class Pc{constructor(){this.Xwb=this.isi=null}}Object(f.a)(Pc,"GestureAdapterInfo",null,[]);var ld=d(607),Dc=d(304);class ic{constructor(){this.eDb=null}w4f(){if(!this.eDb){var ea="hammer.min.js";m.AFrameworkApplication.J.my("IsServerFlavorDebug")&&
(ea=m.AFrameworkApplication.J.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");ea=m.AFrameworkApplication.mC(String.format("{0}",ea),5);ea=Dc.a.create(ea,null,null);ld.a.m_(ea);this.eDb=ea.Uab}return this.eDb}static get instance(){ic._instance||(ic._instance=new ic);return ic._instance}}ic._instance=null;Object(f.a)(ic,"HammerJsDependencyLoader",null,[948]);const mc=(ea,Xa,yb=null)=>{if(void 0===Xa||null===Xa)throw va.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Ub=null;switch(ea){case T.a.Dpe:Ub=new Hammer.Pinch(yb);break;case T.a.pan:Ub=new Hammer.Pan(yb)}Ub&&(Ub.manager=Xa);return Ub};var Rc;(function(ea){ea[ea.none=-1]="none";ea[ea.Dpe=0]="pinch";ea[ea.pan=1]="pan";ea[ea.mFg=2]="swipe"})(Rc||(Rc={}));Object(f.b)("GestureEvent",Rc);var rb=d(72);class Cb extends rb.a{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){super(ea,yb,Ub,ad);this.GEc=Xa;this.F4a=md;this.uwa=Sd;this.Cwk=yc}get shiftKey(){return this.F4a}get ctrlKey(){return this.uwa}get clientPoint(){return this.GEc}get z1c(){return this.Cwk}static create(ea,
Xa,yb,Ub,yc,ad){if(yb.rawEvent)if(ad){var md=yb.rawEvent;md=new Sys.UI.Point(md.clientX,md.clientY)}else md=rb.a.R4d(yb);else md=new Sys.UI.Point(yb.clientX,yb.clientY);return new Cb(ea,md,Xa,yb,Ub,yc,yb.shiftKey,yb.ctrlKey,ad)}}Object(f.a)(Cb,"GestureEventArgs",rb.a,[]);class Kb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Kb,"GestureManagerData",null,[]);class $b{}$b.Pik=2;$b.Qik=4;$b.Rik=8;$b.Sik=8;Object(f.a)($b,"HammerConstants",null,[]);var ab=d(106),ia=d(128),La=d(16),Mb=d(110);class Ha extends ba.a{constructor(ea,Xa){super();this.fRa=gc.a.Ufm;this.v3e=!!window.PointerEvent;this.gIh=window.hasOwnProperty("ontouchstart");this.jEb=this.AMc=null;this.UQa=
!1;this.Hpa=new vc.a;this.CNc=new vc.a;this.hjh=new eb.a;this.shb=null;this.A4b=this.h7b=this.Dah=this.bMe=this.e_e=this.QBh=this.Vah=this.oRc=!1;this.sLc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.f9e=null;this.hwb=(yb,Ub,yc)=>{yb=this.Uzi(yb);Ub=this.Uwm(yc);Hammer.inputHandler(this,yb,Ub);this.UQa&&yc.preventDefault();return this.UQa};this.ane=(yb,Ub,yc)=>{var ad=yc.rawEvent.pointerType.toString();const md=yc.rawEvent.pointerId.toString();if("touch"!==ad)return!1;yb=this.Uzi(yb);
if(1!==yb&&!this.Hpa.tb(md))return!1;this.Vah&&1===yb&&yc.rawEvent.isPrimary&&this.Hpa.count&&(va.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.mUd());this.oRc?this.DYk(md,Ub,yc):this.Hpa.W(md,yc);this.e_e&&2===yb&&(!this.bMe||this.bMe&&"function"===typeof yc.rawEvent.getCoalescedEvents)&&(Ub=yc.rawEvent.getCoalescedEvents())&&this.tMi()&&(this.sLc=Math.max(this.sLc,Ub.length));this.QBh&&(this.UQa=!1);ad=this.Twm(this.Hpa,yc,ad);Hammer.inputHandler(this,yb,ad);if(4===yb||
8===yb)this.oRc?this.NCj(md):this.Hpa.remove(md),this.Hpa.count||(this.session=null,this.e_e&&-1!==this.sLc&&(va.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.sLc),this.sLc=-1));this.UQa&&yc.preventDefault();return this.UQa};this.Kme=()=>!1;this.Hg=ab.EventHandlerManager.instance;this.v3e?(va.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.AMc=this.ane,this.jEb=T.a.Wfm):this.gIh?(va.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.AMc=this.hwb,
this.jEb=T.a.M1b):(va.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.AMc=this.Kme,this.jEb=T.a.Vfm);this.ee=Xa;this.o5=ea;m.AFrameworkApplication.J&&(this.oRc=m.AFrameworkApplication.J.$("UsePointerCaptureIsEnabled"),this.Vah=m.AFrameworkApplication.J.$("ClearCacheOnPrimaryPointerIsEnabled"),this.QBh=m.AFrameworkApplication.J.$("ResetHandledBeforeInputHandlerIsEnabled"),this.e_e=m.AFrameworkApplication.J.$("LogCoalescedEventsIsEnabled"),this.bMe=m.AFrameworkApplication.J.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.Dah=m.AFrameworkApplication.J.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.h7b=m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled"),this.A4b=this.oRc&&m.AFrameworkApplication.J.$("CancelDragFromGestureInputManagerIsEnabled")&&m.AFrameworkApplication.J.$("UseGestureInputManagerPointerCacheIsEnabled"))}rum(){return this.v3e?0:this.gIh?1:2}nw(ea){super.nw(ea);this.Hg.PKa(this.jEb,ea,0,this.AMc)}jw(ea){super.jw(ea);this.Hg.o7a(ea,this.jEb)}qvo(ea,Xa){m.AFrameworkApplication.T9c()?
ic.instance.w4f().continueWith(yb=>{this.Qdp();if(yb.Yi||yb.Zo)va.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",yb.status);else{va.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",yb.status);if(this.Dah){yb=window.Hammer;if("undefined"===typeof yb){va.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.yAe();return}if("undefined"===typeof yb.inputHandler){va.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.yAe();return}}if(!ea)throw this.yAe(),
Error.argumentNull("source element can not be null");yb=ia.a.Eb(ea,this.fRa);if(void 0===yb||null===yb)yb=new vc.a,ia.a.Cm(ea,this.fRa,yb),this.rvo(ea);if(!yb.tb(Rc[0])){var Ub=Object.assign(new Pc,{Xwb:mc(Rc[0],this,null),isi:Xa});yb.add(Rc[0],Ub)}}this.yAe()}):va.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}Qdp(){this.h7b&&(this.ee?this.f9e=this.ee.Xf("Task","RegisterGestureAdapterAfterLoad"):va.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}yAe(){this.h7b&&
(this.f9e?this.f9e.stop():va.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Vtp(ea){va.ULS.sendTraceTag(42256223,310,ea?100:10,"source element {0} ",ea.id);const Xa=ia.a.Eb(ea,this.fRa);void 0!==Xa&&null!==Xa&&(Xa.remove(Rc[0]),Xa.count||(ia.a.gV(ea,this.fRa),this.curRecognizer=null,this.Wtp(ea)))}rvo(ea){this.hjh.add(ea);this.Hg.PKa(this.jEb,ea,0,this.AMc)}Wtp(ea){this.hjh.remove(ea);this.Hg.o7a(ea,this.jEb)}recognize(ea){var Xa=Array(ea.pointers.length);
for(var yb=0;yb<ea.pointers.length;yb++)Xa[yb]=ea.pointers[yb].target;yb=null;for(this.shb=this.Fzm(Xa);void 0!==this.shb&&null!==this.shb&&(yb=ia.a.Eb(this.shb,this.fRa),void 0===yb||null===yb);this.shb=this.shb.parentNode);if(void 0!==yb&&null!==yb){this.curRecognizer&&this.curRecognizer.state===$b.Sik&&(this.curRecognizer=null);Xa=yb.keys;for(const Ub of Xa){Xa=yb.K(Ub);void 0!==Xa&&null!==Xa&&void 0!==Xa.Xwb&&null!==Xa.Xwb&&(void 0===this.curRecognizer||null===this.curRecognizer||Xa.Xwb===this.curRecognizer||
Xa.Xwb.canRecognizeWith(this.curRecognizer))&&Xa.Xwb.recognize(ea);const yc=Xa.Xwb.state;this.curRecognizer||$b.Pik!==yc&&$b.Qik!==yc&&$b.Rik!==yc||(this.curRecognizer=Xa.Xwb)}}}emit(ea,Xa){if("hammer.input"!==ea){this.UQa=!1;Xa=Cb.create(ea,this.shb,Xa.srcEvent,Xa,3,this.v3e);var yb=ia.a.Eb(this.shb,this.fRa);if(this.cqn(ea))var Ub=0;else if(this.ypn(ea))Ub=1;else if(this.Ltn(ea))Ub=2;else{va.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:yb}=yb.Ec(Rc[Ub]));
void 0!==yb&&null!==yb&&((yb=yb.isi,yb.fln())?ea.endsWith("start")?this.UQa=yb.PZn(Xa):ea.endsWith("end")?(yb.NZn(Xa),this.UQa=!0):ea.endsWith("cancel")?(yb.MZn(Xa),this.UQa=!0):ea.endsWith("move")&&(this.UQa=yb.OZn(Xa)):va.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",ea))}}get(ea){return Object(bb.a)(Hammer.Recognizer,ea)}Fzm(ea){if(1>ea.length)return null;if(1===ea.length)return ea[0];var Xa=ea[0],yb=!0;for(let Ub=1;Ub<ea.length;Ub++){if(!ea[Ub])return null;if(Xa!==
ea[Ub]){yb=!1;break}}if(yb)return Xa;Xa=this.Nsi(ea[0]);yb=0;for(const Ub of ea){ea=this.Nsi(Ub);if(Xa.K(Xa.count-1)!==ea.K(ea.count-1))return null;for(let yc=Xa.count-2,ad=ea.count-2;yc>=yb&&0<=ad;yc--,ad--)if(Xa.K(yc)!==ea.K(ad)){yb=yc+1;break}}return Xa.K(yb)}Nsi(ea){const Xa=new eb.a;for(;void 0!==ea&&null!==ea;ea=ea.parentNode)Xa.add(ea);return Xa}Uzi(ea){switch(ea){case T.a.xS:case T.a.qLb:return 1;case T.a.wS:case T.a.flf:return 2;case T.a.hM:case T.a.rLb:return 4;case T.a.UCe:case T.a.elf:return 8}return 0}tMi(){return 1<
this.Hpa.count}mUd(){va.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.oRc)for(const ea of this.Hpa)this.NCj(ea.key);else this.Hpa=new vc.a;this.session=null}DYk(ea,Xa,yb){va.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",ea);if(!this.CNc.tb(ea)){try{Xa.setPointerCapture(ea)}catch(Ub){va.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Ub)}this.CNc.add(ea,Xa)}this.Hpa.W(ea,yb);this.A4b&&1<this.Hpa.count&&this.o5&&!this.o5.JUc&&(this.o5.JUc=
!0)}NCj(ea){va.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",ea);if(this.CNc.tb(ea)){try{this.CNc.K(ea).releasePointerCapture(ea)}catch(Xa){va.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Xa)}this.CNc.remove(ea)}else va.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",ea);this.Hpa.remove(ea);this.A4b&&1>=this.Hpa.count&&this.o5&&this.o5.JUc&&(this.o5.JUc=!1)}Uwm(ea){const Xa=new Kb;var yb=ea.rawEvent;const Ub=yb.touches;
yb=yb.changedTouches;Xa.pointers=Array.clone(Ub);Xa.pointers=Array.clone(0<Ub.length?Ub:yb);Xa.changedPointers=Array.clone(yb);Xa.srcEvent=ea;Xa.pointerType="touch";return Xa}Twm(ea,Xa,yb){const Ub=new Kb;Ub.pointers=Mb.toArray(ea.values);Ub.changedPointers=[Xa];Ub.pointerType=yb;Ub.srcEvent=Xa;return Ub}cqn(ea){return La.a.startsWith(ea,T.a.Dpe)}ypn(ea){return La.a.startsWith(ea,T.a.pan)}Ltn(ea){return La.a.startsWith(ea,T.a.mFg)}}Object(f.a)(Ha,"GestureInputManager",ba.a,[893,894]);var zb=d(310);
class ac{constructor(){this.Z=null;this.vi=!1}get name(){return"Common.App.GestureInputManager"}wc(ea){ea.register(Ha,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().Ud(()=>new Ha(zb.a.instance,m.AFrameworkApplication.ua.Vr));this.Z=ea}init(){this.vi||(this.Z.resolve("Common.App.GestureManager.GestureInputManager"),this.vi=!0)}dispose(){}static main(){K.a.instance.Mc(new ac)}}Object(f.a)(ac,"GestureInputManagerPackage",null,[0,1]);var nc=d(272),Gb=d(46),tc=
d(1506);class Qb{constructor(ea,Xa,yb){this.F7e=this.E7e=null;this.$$b=new v.a;this.Ifd=Ub=>{let yc=null;yc&&yc.length||!Ub||!Ub.data||(yc=Ub.data.Pe);if(yc&&yc.length)try{const ad=Wa.a(yc);this.E7e=ad.NavBarDataJson;va.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.E7e?({av:this.F7e}=Wa.d(ad.NavBarDataJson)).returnValue?(this.eGn(this.F7e),this.$$b.gg(this.F7e)):(va.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:tc.a.csd(this.E7e)}),
this.$$b.iha()):(va.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.$$b.iha())}catch(ad){va.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.$$b.iha()}else va.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.Yed=()=>{this.$$b.iha();va.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.If=ea;this.sMc=yb;this.nqa=Xa.appSettings[Qb.YGp]||""}get l2o(){return this.$$b.task}get OT(){return this.If.value}jGo(){const ea=
{};ea[Qb.rYm]=m.AFrameworkApplication.rm;ea["Content-Type"]="application/json; charset=utf-8";va.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Xa=Gb.a.lq(this.nqa+Qb.m2o,Qb.TUn,m.AFrameworkApplication.ua.Gb.Mk.toString());this.OT.Xj(Xa,1,"",ea,!0,2,this.Ifd,this.Yed,null,void 0,void 0,void 0,void 0,"20")}eGn(ea){try{const Xa={};Xa.FlightName=ea.FlightName;Xa.SessionID=ea.SessionID;va.ULS.sendTraceTag(594883776,215,50,Wa.c(Xa))}catch(Xa){va.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}static get instance(){return Qb._instance||(Qb._instance=Qb.sPb())}static sPb(){return new Qb(new nc.a(()=>m.AFrameworkApplication.Fe),m.AFrameworkApplication.J,m.AFrameworkApplication.ua.Gb.Mk)}}Qb.rYm="X-qs";Qb.TUn="at";Qb.m2o="O365ShellServiceProxy.ashx";Qb._instance=null;Qb.YGp="ShellWebServiceBase";Object(f.a)(Qb,"O365ShellActor",null,[888]);class Yb{constructor(){this.Z=null;this.iz=()=>{m.AFrameworkApplication.KLg&&m.AFrameworkApplication.ua.Gb.tN&&this.Z.resolve("Common.App.O365Shell.O365ShellActor").jGo()}}get name(){return"Common.App.O365Shell"}wc(ea){this.Z=
ea;this.Z.register(Qb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().Ud(()=>new Qb(new nc.a(()=>m.AFrameworkApplication.Fe),m.AFrameworkApplication.J,m.AFrameworkApplication.ua.Gb.Mk))}init(){m.AFrameworkApplication.J.vp(this.iz)}dispose(){}static main(){K.a.instance.Mc(new Yb)}}Object(f.a)(Yb,"PackageManager",null,[0,1]);class fc{IXa(){}init(){}dispose(){}}Object(f.a)(fc,"NoOpOfflineLogger",null,[944,10]);var ib=d(806);class Jc{}Jc.VRd=0;Object(f.a)(Jc,"OfflineLoggerConstants",
null,[]);var jd=d(91),Wc=d(255),Ad=d(313);class Yd{constructor(ea,Xa,yb,Ub,yc,ad){this.O2a=!1;this.c$=null;this.DFc=this.z8b=this.RCb=0;this.MK=this.pjb=this.mT=null;this.fm=!1;this.ugg=(md,Sd)=>{if(void 0!==Sd&&null!==Sd&&void 0!==Sd.args&&null!==Sd.args){md=!1;if(!this.pjb.tb(Sd.args.tag)){if(!this.pjb.tb(Jc.VRd))return;md=!0}this.pjb.remove(md?Jc.VRd:Sd.args.tag);this.MK.tb(Sd.uploadId)||this.MK.W(Sd.uploadId,new eb.a);this.MK.K(Sd.uploadId).add(Sd.args)}};this.wgg=(md,Sd)=>{this.MK.remove(Sd.uploadId);
this.HFb&&(this.HFb=!1,this.o2h())};this.vgg=(md,Sd)=>{this.HFb=!0;if(void 0!==Sd&&null!==Sd&&this.MK.tb(Sd.uploadId)){md=!0;var ze=this.MK.K(Sd.uploadId);for(const Ne of ze)ze=Yd.serialize(Ne,this.UGa),this.nsd(this.lUc(this.DFc++),ze)||(md=!1);md&&this.MK.remove(Sd.uploadId)}};this.Bcg=()=>{this.dispose()};this.tGa=yb;this.fHa=Ub;this.UGa=yc;this.If=Xa;this.Jb=ea;this.Q1a=ad;this.HFb=!1;this.s_e="OfflineLoggerManifest|"+this.Q1a;this.fEk="OfflineLog|"+this.Q1a+"|"}init(){this.Vzg();this.fCn();this.O2a=
!1;this.If.v5a(this);this.mT=new jd.a(3,2,2500,Object(O.a)(this,this.iwe,"sendOfflineLogs"),104);this.Jb.$b(this.mT)}lUc(ea){return this.fEk+ea}fCn(){const ea=this.tGa.getItem(this.s_e);void 0!==ea&&null!==ea&&0<ea.length&&(this.c$=Yd.msd(ea));this.c$||(this.c$={});if(void 0===this.c$.end||null===this.c$.end)this.c$.end=0;if(void 0===this.c$.offset||null===this.c$.offset)this.c$.offset=0;this.RCb=this.c$.offset;isFinite(this.RCb)||(this.RCb=0);this.z8b=this.c$.end;isFinite(this.z8b)||(this.z8b=0);
this.DFc=this.z8b}Vzg(){this.pjb=new Ad.a;this.MK=new Wc.a;this.fHa.oPh(this.ugg);this.fHa.NPh(this.wgg);this.fHa.MPh(this.vgg);this.fHa.fPh(this.Bcg)}nsd(ea,Xa){try{return this.tGa.setItem(ea,Xa),!0}catch(yb){return!1}}iwe(){if(!this.O2a){for(var ea=this.RCb,Xa=new eb.a,yb=null;ea<this.z8b&&5>=Xa.count;++ea){var Ub=this.lUc(ea);const yc=this.tGa.getItem(Ub);this.tGa.removeItem(Ub);if(void 0===yc||null===yc)continue;const ad=({sessionId:Ub}=Yd.deserialize(yc)).returnValue;if(ad){if(!yb)yb=Ub;else if(Ub!==
yb)break;Xa.add(ad)}else va.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",yc)}0<Xa.count&&this.fHa.$Fj(this,Mb.toArray(Xa),yb);this.RCb=ea;ea>=this.z8b&&this.tOb()}}o2h(){this.tOb();this.mT=new jd.a(3,2,2500,Object(O.a)(this,this.iwe,"sendOfflineLogs"),104);this.Jb.$b(this.mT)}IXa(ea,Xa,yb){!this.fm&&va.ULS.k4(Xa,yb)&&this.pjb.W(ea,!0)}dispose(){if(!this.fm){this.mT&&this.Jb.wf(this.mT);var ea=Mb.toArray(this.MK.keys);ea.sort();for(const Xa of ea){ea=this.MK.K(Xa);for(const yb of ea)ea=
Yd.serialize(yb,this.UGa),this.nsd(this.lUc(this.DFc++),ea)}this.RCb<this.DFc?(this.c$.end=this.DFc,this.c$.offset=this.RCb,this.nsd(this.s_e,JSON.stringify(this.c$))):this.tGa.removeItem(this.s_e)}this.fm=!0}lCa(){this.O2a=!0}fYa(){this.O2a=!1;this.o2h()}tOb(){this.mT&&(this.Jb.wf(this.mT),this.mT=null)}static serialize(ea,Xa){const yb={};yb.t=ea.tag;yb.c=ea.category;yb.l=ea.level;yb.m=ea.message;yb.lt=ea.logType;yb.s=Xa;yb.ts=ea.timestamp;yb.o=ea.isMinified;yb.a=ea.args;return JSON.stringify(yb)}static deserialize(ea){return(ea=
Yd.msd(ea))?{returnValue:new ib.a(ea.ts,ea.c,ea.t,ea.l,ea.m,ea.lt,ea.o,ea.a),sessionId:ea.s}:{returnValue:null,sessionId:null}}static msd(ea){try{return JSON.parse(ea)}catch(Xa){va.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",Xa.message)}return null}}Object(f.a)(Yd,"OfflineLoggerImpl",null,[944,10,250]);class ke{constructor(ea,Xa,yb,Ub){this.sessionId=ea;this.version=Xa;this.LSd=yb;this.ehg=Ub;this.jVb=new eb.a}}Object(f.a)(ke,"CachedLogUpload",null,[]);
class bf{constructor(ea){ea.name&&(this.n=ea.name);ea.stack&&(this.s=ea.stack);ea.message&&(this.m=ea.message);ea.file&&(this.f=ea.file);null!=ea.line&&(this.l=ea.line);null!=ea.column&&(this.c=ea.column)}}Object(f.a)(bf,"LoggingExceptionArgsLocalStorage",null,[]);class od{constructor(ea){this.t=ea.tag;this.c=ea.category;this.l=ea.level;this.m=ea.message;this.lt=ea.logType;this.ts=ea.timestamp;this.o=ea.isMinified;this.a=ea.args;ea.exceptionArgs&&(this.e=new bf(ea.exceptionArgs))}}Object(f.a)(od,
"LoggingArgsLocalStorage",null,[]);var Vf=d(499);class ah{constructor(ea,Xa,yb,Ub,yc,ad,md){this.t=ea;this.m=Xa;this.s=yb;this.v=Ub;this.i=yc;this.a=ad;this.d=md;this.op="Log"}}Object(f.a)(ah,"LoggingKeyLocalStorage",null,[]);var Bf=d(118);const Of=(ea,Xa,yb,Ub)=>!(void 0===ea||null===ea)&&!(void 0===ea.i||null===ea.i)&&!(void 0===ea.t||null===ea.t)&&!(void 0===ea.s||null===ea.s)&&"Log"===ea.op&&ea.t===Xa&&isFinite(ea.t)&&Bf.a.isValid(ea.s)&&(void 0===ea.m||null===ea.m||ea.m===yb)&&(void 0===ea.d||
null===ea.d||ea.d===Ub);class Qf{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng){this.O2a=this.Jth=this.yth=this.zth=!1;this.MK=this.pjb=this.c$=this.mT=null;this.fm=!1;this.bTl=()=>{this.cfi(!0)};this.cTl=()=>{this.cfi(!1)};this.jbp=uh=>uh.s!==uh.s?uh.s.localeCompare(uh.s):uh.i-uh.i;this.gbp=uh=>uh.s!==uh.s?uh.s.localeCompare(uh.s):uh.i-uh.i;this.ugg=(uh,Oh)=>{if(void 0!==Oh&&null!==Oh&&void 0!==Oh.args&&null!==Oh.args){if(this.Gbd.tb(Oh.args.tag))this.Gbd.remove(Oh.args.tag);else if(this.Gbd.tb(Jc.VRd))this.Gbd.remove(Jc.VRd);
else if(!(this.VDk&&50>Oh.args.level))return;({value:uh}=this.KLa.Ec(Oh.uploadId)).returnValue||(uh=new ke(Oh.sessionId,Oh.version,Oh.LSd,Oh.ehg),this.KLa.W(Oh.uploadId,uh));this.KLa.K(Oh.uploadId).jVb.add(Oh.args)}};this.wgg=(uh,Oh)=>{this.KLa.remove(Oh.uploadId);this.HFb&&(this.HFb=!1,this.p2h())};this.vgg=(uh,Oh)=>{this.HFb=!0;void 0!==Oh&&null!==Oh&&this.KLa.tb(Oh.uploadId)&&this.zej(Oh.uploadId)&&!this.Jth&&(this.Jth=!0)};this.Bcg=()=>{this.dispose()};this.qFb=[];this.s8b=[];this.tGa=yb;this.fHa=
Ub;this.UGa=yc;this.If=Xa;this.Jb=ea;this.sMc=ad;this.$0e=md;this.bCh=Sd;this.j3a=ze;this.VDk=Ne;this.MXe=ng;this.Q1a=Ng;this.HFb=!1}get manifest(){return this.c$}get Gbd(){return this.pjb}get KLa(){return this.MK}init(){this.Vzg();this.O2a=!1;this.If.v5a(this);this.mT=new jd.a(3,1,2500,this.bTl,103);this.Jb.$b(this.mT)}cfi(ea){this.tOb();this.qFb=[];ea&&(this.s8b=[]);for(var Xa=0;Xa<this.tGa.length;Xa++){const yb=this.tGa.key(Xa),Ub=Qf.g4j(yb,!1);Of(Ub,this.sMc,this.$0e,this.Q1a)&&(Ub.s===this.UGa?
Array.add(this.qFb,yb):ea&&Array.add(this.s8b,yb))}if(this.qFb.length||ea&&this.s8b.length)if(Xa=this.MXe?this.gbp:this.jbp,this.qFb.sort(Xa),ea&&this.s8b.sort(Xa),0<this.qFb.length||0<this.s8b.length)this.mT=new jd.a(3,2,2500,Object(O.a)(this,this.iwe,"sendOfflineLogs"),105),this.Jb.$b(this.mT)}lUc(ea,Xa,yb,Ub){ea=new ah(this.sMc,this.$0e,Xa,yb,ea,Ub,this.Q1a);return JSON.stringify(ea)}Vzg(){this.pjb=new Ad.a;this.MK=new Wc.a;this.fHa.oPh(this.ugg);this.fHa.NPh(this.wgg);this.fHa.MPh(this.vgg);this.fHa.fPh(this.Bcg)}zej(ea){let Xa=
!1;if(({value:Ub}=this.KLa.Ec(ea)).returnValue&&Ub&&0<Ub.jVb.count){if(Ub.LSd>=this.j3a)return this.KLa.remove(ea),!1;var yb=Ub.jVb;const yc=Array(yb.count);for(let ad=0,md=yb.count;ad<md;++ad)yc[ad]=new od(yb.K(ad));yb=Qf.serialize(yc);var Ub=this.lUc(Ub.ehg,Ub.sessionId,Ub.version,Ub.LSd);this.nsd(Ub,yb)&&(this.KLa.remove(ea),Xa=!0)}return Xa}nsd(ea,Xa){try{return this.tGa.setItem(ea,Xa),!0}catch(yb){return!1}}iwe(){if(!this.O2a){var ea=0<this.qFb.length?this.qFb:this.s8b,Xa=ea.length;if(Xa)for(;0<
Xa;){Xa--;var yb=this.MXe?ea.pop():ea[0];this.MXe||Array.removeAt(ea,0);const ad=Qf.g4j(yb,!0);if(Of(ad,this.sMc,this.$0e,this.Q1a)){var Ub=this.tGa.getItem(yb);this.tGa.removeItem(yb);if(void 0!==Ub&&null!==Ub)if(ad.a>this.j3a)va.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",ad.a,this.j3a);else if(yb=Qf.msd(Ub,!0),void 0!==yb&&null!==yb&&isFinite(yb.length))if(yb.length){Ub=yb[yb.length-1];var yc=(new Date).getTime()-Ub.ts;if(yc<-Qf.I0j)va.ULS.sendTraceTag(37290078,
222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Ub.ts);else if(yc>this.bCh*Qf.I0j)va.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.bCh,Ub.ts);else{ad.s===this.UGa?this.zth||(this.zth=!0,va.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.yth||(this.yth=!0,va.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",
ad.s));Xa=Array(yb.length);for(Ub=0;Ub<yb.length;Ub++){ea=Ub;a:{yc=yb[Ub];if(void 0===yc||null===yc){yc=null;break a}let md=null;yc.e&&(md=new Vf.a(null),md.name=yc.e.n,md.stack=yc.e.s,md.message=yc.e.m,md.file=yc.e.f,md.line=yc.e.l,md.column=yc.e.c);yc=new ib.a(yc.ts,yc.c,yc.t,yc.l,yc.m,yc.lt,yc.o,yc.a,md)}Xa[ea]=yc}this.fHa.$Fj(this,Xa,ad.s,ad.v,ad.a+1,ad.i);break}}else va.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Ub);else va.ULS.sendTraceTag(37290076,
222,15,"Unable to deserialize the offline log: {0}",Ub)}}else this.tOb()}}p2h(){this.tOb();this.mT=new jd.a(3,1,2500,this.cTl,102);this.Jb.$b(this.mT)}IXa(ea,Xa,yb){!this.fm&&va.ULS.k4(Xa,yb)&&this.Gbd.W(ea,!0)}dispose(){if(!this.fm){this.mT&&this.Jb.wf(this.mT);var ea=Mb.toArray(this.KLa.keys);for(const Xa of ea)this.zej(Xa)}this.fm=!0}lCa(){this.O2a=!0;this.tOb()}fYa(){this.O2a=!1;this.p2h()}tOb(){this.mT&&(this.Jb.wf(this.mT),this.mT=null)}static serialize(ea){return JSON.stringify(ea)}static g4j(ea,
Xa){(ea=Qf.msd(ea,Xa))&&void 0===ea.d&&(ea=new ah(ea.t,ea.m,ea.s,ea.v,ea.i,ea.a,0));return ea}static msd(ea,Xa){try{return JSON.parse(ea)}catch(yb){Xa&&va.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",yb.message)}return null}}Qf.I0j=864E5;Object(f.a)(Qf,"OfflineLoggerImplV2",null,[944,10,250]);class Jg{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(ea){return this.handleError("Length",
ea),-1}}key(ea){try{return localStorage.key(ea)}catch(Xa){return this.handleError("Key",Xa),null}}getItem(ea){try{return localStorage.getItem(ea)}catch(Xa){return this.handleError("GetItem",Xa),null}}setItem(ea,Xa){try{return localStorage.setItem(ea,Xa)}catch(yb){return this.handleError("SetItem",yb),null}}removeItem(ea){try{localStorage.removeItem(ea)}catch(Xa){this.handleError("RemoveItem",Xa)}}clear(){try{localStorage.clear()}catch(ea){this.handleError("Clear",ea)}}handleError(){}}Object(f.a)(Jg,
"OfflineStorage",null,[943]);class jf{create(ea){var Xa=null;try{void 0!==localStorage&&null!==localStorage&&(Xa=new Jg)}catch(Ub){va.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Ub.message)}Object.getType(va.ULS.host).implementsInterface(924)&&Xa||(va.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Xa?"supported":"not supported",Object.getType(va.ULS.host).implementsInterface(924)?"supported":"not supported"),
ea=0);const yb=m.AFrameworkApplication.J;1===ea?Xa=new Yd(m.AFrameworkApplication.pc,m.AFrameworkApplication.Fe,Xa,va.ULS.host,m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.pci):2===ea?(ea=m.AFrameworkApplication.ua.Gb,Xa=new Qf(m.AFrameworkApplication.pc,m.AFrameworkApplication.Fe,Xa,va.ULS.host,m.AFrameworkApplication.userSessionId,ea.Mk,ea.Dma,yb.jc("OfflineLoggerRetentionInDays",30),yb.jc("OfflineLoggerMaxAttempts",5),yb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),yb.$("SendOfflineLogsV2ImprovementIsEnabled"),
m.AFrameworkApplication.pci)):Xa=new fc;Xa.init();return Xa}}Object(f.a)(jf,"OfflineLoggerFactory",null,[]);class $i{wc(){}get name(){return"Common.App.OfflineLogger"}init(){const ea=m.AFrameworkApplication.J;let Xa=0;ea.$("OneNoteOfflineLoggerIsEnabled")?Xa=1:ea.$("OfflineLoggerV2IsEnabled")&&(Xa=2);0!==Xa&&(m.AFrameworkApplication.bCe=(new jf).create(Xa))}dispose(){}}Object(f.a)($i,"OfflineLoggerPackage",null,[0,1]);var Vd=d(41),eh=d(1272);class rd{constructor(ea){this.qbj=null;this.dMm=()=>{va.ULS.sendTraceTag(527214156,
306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.fMm=Xa=>{va.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Xa=Wa.a(Xa.data.Pe).state+"";eh.a.instance.setItem("AccountLinkedStatusCache",Xa)};va.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Bcd=m.AFrameworkApplication.J.jb("PhoneLinkServiceEndpoint");(this.Cba=ea)||va.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");
this.Bcd&&this.Bcd.length||va.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}Q6l(ea){ea&&(this.Bcd="https://dcg-df.microsoft.com/",va.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.P6l()}P6l(){va.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.qbj)va.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");
else{this.qbj=new Date;var ea=new Date;this.Cba.tV("BayBridge",this.Bcd).then(Xa=>{const yb=+new Date-+ea;Xa.IsSuccess?(va.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",yb),this.F6l(Xa.Token,this.mim())):va.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",yb,Xa.ErrorCode,Xa.ErrorMessage)}).catch(Xa=>{va.ULS.sendTraceTag(527574725,
306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Xa,+new Date-+ea)})}}F6l(ea,Xa){const yb={};yb.Authorization="Bearer "+ea;yb["Authorization-Type"]="AAD";yb.Accept="application/json";yb["DCG-SessionId"]=m.AFrameworkApplication.userSessionId;m.AFrameworkApplication.Fe.Xj(Xa,1,null,yb,!1,2,this.fMm,this.dMm,null,void 0,void 0,void 0,void 0,"39");Vd.a("FetchAccountLinkedStatus")}ykm(){const ea=eh.a.instance.getItem("AccountLinkedStatusCache");return ea&&ea.length?
"true"===ea.toLowerCase()?!0:!1:!1}mim(){return this.Bcd+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(f.a)(rd,"PhoneLinkManager",null,[849]);class Gc{constructor(){this.Z=null}get name(){return"Common.App.PhoneLink"}wc(ea){this.Z=ea;this.Z.register(849,"Common.App.PhoneLink.IPhoneLinkManager").ha().Ud(()=>new rd(this.Z.resolve("Common.App.OAuth.IOAuthManager")))}init(){m.AFrameworkApplication.J.vp(()=>{this.g$a()})}g$a(){this.Z.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){K.a.instance.Mc(new Gc)}}
Object(f.a)(Gc,"PhoneLinkPackage",null,[0,1]);const Wd=ea=>{try{return Wa.a(ea)}catch(Xa){}return null};class Ye{constructor(ea,Xa,yb,Ub,yc,ad){this.s1=!1;this.Zk=null;this.f3e=!1;this.gjf=md=>{const Sd=md.dQb();Sd.continueWith(()=>{this.Zk=Sd.result;this.f3e&&(this.Zk.oC(2,null,!0),this.f3e=!1);this.Zk.AO((ze,Ne)=>{2===Ne.type&&this.Pb.Ob(x.a.OOb,2)});this.Zk.QZ((ze,Ne)=>{2===Ne.newState&&this.Pb.Ob(x.a.OOb,2)});2===this.Zk.connectionState&&this.Pb.Ob(x.a.OOb,2)})};this.Bsc=md=>{this.s1=!1;const Sd=
Wd(md.data.Pe);md.data.state.zE(Sd,this.Jsh.value)};this.F2n=md=>{5!==md.data.status||this.s1?this.Xmj(md):(this.s1=!0,this.Kli(md.data.state,!1))};this.Xmj=md=>{md.data.state.onFailure(-1)};this.Dfd=md=>{this.s1=!1;const Sd=Wd(md.data.Pe);md.data.state.zE(Sd,this.Jsh.value);this.vhj()};this.J2n=md=>{5!==md.data.status||this.s1?this.Zmj(md):(this.s1=!0,this.Mli(md.data.state,!1))};this.Zmj=md=>{md.data.state.onFailure(-1)};this.ga=ea;this.If=Xa;this.em=yb;this.Jsh=Ub;this.Aa=yc;this.yDk=ad}init(ea,
Xa){Xa&&ea.Ta("Common.Interface.IRtcBasicProvider").execute(this.gjf)}RUa(ea){this.Kli(ea,!0)}Kli(ea,Xa){const yb=this.Ahl(ea.NVj),Ub={};Ub[Ye.X6h]=Ye.Y6h;this.NFj.Xj(yb,2,"",Ub,!1,2,this.Bsc,Xa?this.F2n:this.Xmj,ea)}BOb(ea){this.Mli(ea,!0)}Mli(ea,Xa){const yb=this.Bhl(),Ub={};Ub[Ye.X6h]=Ye.Y6h;Ub[Ye.pYm]=La.a.$i(ea.UFj);Ub[Ye.nYm]=this.yDk.value.tul;this.NFj.Xj(yb,2,"",Ub,!1,2,this.Dfd,Xa?this.J2n:this.Zmj,ea)}Bhl(){return this.OXh()}Ahl(ea){let Xa=this.OXh();return Xa=Gb.a.lq(Xa,Ye.tYm,ea?"2":"1")}OXh(){let ea=
(this.Aa.value.appSettings.RenameWebServiceBase||"")+Ye.oYm;ea=Gb.a.lq(ea,Ye.qYm,La.a.$i(m.AFrameworkApplication.rm));this.sn&&this.sn.ude&&(ea=Gb.a.lq(ea,Ye.sYm,"1"));return ea}vhj(){this.Zk?this.Zk.oC(2,null,!0):this.f3e=!0}get Pb(){return this.ga.value}get NFj(){return this.If.value}get sn(){return this.em.value}static get instance(){return Ye._instance||(Ye._instance=Ye.sPb())}static sPb(){return new Ye(new nc.a(()=>m.AFrameworkApplication.va),new nc.a(()=>m.AFrameworkApplication.Fe),new nc.a(()=>
m.AFrameworkApplication.sn),new nc.a(()=>Fa.a.instance.resolve("Postmessage.IHostPostmessenger")),new nc.a(()=>m.AFrameworkApplication.J),new nc.a(()=>Fa.a.instance.resolve("Common.IRenameProps")))}}Ye.X6h="Content-Type";Ye.Y6h="application/json; charset=utf-8";Ye.oYm="renamehandler.ashx";Ye.qYm="qs";Ye.pYm="n";Ye.sYm="sl";Ye.nYm="X-CoauthLockId";Ye.tYm="u";Ye._instance=null;Object(f.a)(Ye,"ExecuteRenameFileHandler",null,[]);class yg{constructor(){this.onFailure=this.zE=null;this.NVj=!1}}Object(f.a)(yg,
"ExecuteRefreshFilenameData",null,[]);class yf{constructor(){this.onFailure=this.zE=this.UFj=null}}Object(f.a)(yf,"ExecuteRenameFileData",null,[]);class re{constructor(){this.Z=null;this.jRe=Ye.instance;this.iz=()=>{m.AFrameworkApplication.A$c()&&(Ye.instance.init(this.Z,m.AFrameworkApplication.Nkd),m.AFrameworkApplication.BOb=Object(O.a)(this,this.BOb,"executeRenameFile"),m.AFrameworkApplication.RUa=Object(O.a)(this,this.RUa,"executeRefreshFilename"),m.AFrameworkApplication.cnd=Object(O.a)(this,
this.cnd,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}wc(ea){this.Z=ea}init(){m.AFrameworkApplication.J.vp(this.iz)}BOb(ea,Xa,yb){const Ub=new yf;Ub.UFj=ea;Ub.zE=Xa;Ub.onFailure=yb;this.jRe.BOb(Ub)}RUa(ea,Xa,yb){const Ub=new yg;Ub.zE=ea;Ub.onFailure=Xa;Ub.NVj=yb;this.jRe.RUa(Ub)}cnd(){this.jRe.vhj()}dispose(){}}Object(f.a)(re,"PackageManager",null,[0,1]);var Xe=d(175);class dc{constructor(ea,Xa,yb){this.aCg=this.bCg=this.cCg=!1;this.rCg=!ea&&
!Xa;this.sCg=!ea&&!yb;this.rCg||this.sCg||(this.cCg=!ea,this.bCg=!Xa,this.aCg=!yb)}}Object(f.a)(dc,"RenameDisabledDialogInfo",null,[]);class Ac extends Xe.StandardDialog{constructor(ea,Xa,yb,Ub,yc){super();this.GGg=[];this.Qia=new dc(ea,Xa,yb);this.Dlb=Ub;this.$ib=yc;this.Ig="RenameDisabledDialog";this.Bd=0;this.Ke(1,CommonUIStrings.l_DialogClose);this.H_o();this.JDo()}H_o(){this.Qia.rCg?this.vpd(this.Dlb?this.$ib?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Qia.sCg?this.vpd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.ZXk();this.vQd(this.GGg)}vpd(ea){Array.add(this.GGg,ea)}ZXk(){const ea=[];this.Qia.cCg||Array.add(ea,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Qia.bCg||Array.add(ea,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Qia.aCg||Array.add(ea,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<ea.length&&Array.add(this.GGg,ea)}}Object(f.a)(Ac,"ReactRenameDisabledDialogBase",
Xe.StandardDialog,[]);class dd extends Ac{constructor(ea,Xa,yb,Ub,yc){super(ea,Xa,yb,Ub,yc)}JDo(){this.bvb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(f.a)(dd,"ReactRenameDisabledDialog",Ac,[]);class fd{static get mh(){return a.a.uy(fd.lo,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}fd.lo="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(fd,"RenameDisabledDialogHtml",null,[]);class Fd extends a.a{constructor(ea,Xa,yb,Ub,yc){super();this.Qia=new dc(ea,Xa,yb);this.Dlb=Ub;this.$ib=yc;this.Ig="RenameDisabledDialog";this.Bd=0;this.Ke(1,CommonUIStrings.l_DialogClose);this.mh=fd.mh;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.x8("RenameRow")}Jba(){if(this.Qia.rCg){let ea;ea=this.Dlb?this.$ib?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Fd.vpd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),ea)}else this.Qia.sCg?Fd.vpd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.T0m()}T0m(){this.Qia.cCg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Qia.bCg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Qia.aCg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static vpd(ea,Xa,yb){ea.style.display="none";Xa.innerText=yb}}Object(f.a)(Fd,"RenameDisabledDialog",a.a,[]);class cf{constructor(ea,Xa){this.eGb=0;this.ypf=(yb,Ub,yc,ad,md)=>{if(1===yc)return this.ga.Ob(x.a.Iua,1);yb=La.a.qL(this.kQa.zA);md=(0,md.getNewDocumentTitle)();md.length>this.eGb&&(md=md.substr(0,this.eGb));if(32!==this.ga.Qb(x.a.Iua,2,md))return this.RAc(yb),8;this.RAc(md);return 32};
this.ga=ea;this.kQa=Xa}initialize(ea){if(!this.ga||!this.kQa)return!1;this.eGb=ea;this.Xb();return!0}Xb(){this.ga.qa(x.a.ypf,z.a.frame,this.ypf)}RAc(ea){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(ea))}static Qm(){return new cf(m.AFrameworkApplication.va,m.AFrameworkApplication.Et)}}Object(f.a)(cf,"ReactRenameUIHandler",null,[977]);var Bg=d(1033),me=d(1590),mf=d(722),ug=d(142),Bi=d(262),Zf=d(74);class zf{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng){this._initialized=!1;this._element=
null;this.eGb=0;this.d7e=this.EUe=!1;this.ga=ea;this.Dgb=Xa;this.oe=yb;this.rx=Ub;this.kQa=yc;this.cDh=ad;this.FLd=md;this.vMe=Sd;this.wib=ze;this.Cph=Ne;this.Xi=ng;this.mWe=Ng}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(ea,Xa,yb){if(!(this.ga&&this.kQa&&this.cDh&&this.FLd&&this.vMe&&Xa)||0>=ea)return!1;this._element=Xa;this._element.title=yb;this._element.setAttribute(Zf.a.Wh,Zf.a.N$);this._element.setAttribute("Unselectable","on");this.eGb=ea;this.ME();
return this._initialized=!0}ME(){this.Dgb&&(this.Dgb.ub(T.a.blur,this._element,Object(O.a)(this,this.onBlur,"onBlur")),this.Dgb.ub(T.a.paste,this._element,Object(O.a)(this,this.tfd,"onPaste")));this.oe.ub(T.a.ij,this._element,Object(O.a)(this,this.onKeyDown,"onKeyDown"));this.rx.ub(T.a.kt,this._element,Object(O.a)(this,this.yE,"onPointerDown"));this.rx.ub(T.a.EP,this._element,Object(O.a)(this,this.CCa,"onPointerUp"))}onBlur(){this.isActive&&!this.EUe&&(this.Cph||this.vMe(this._element),this.X4h(),
this.Luf(!1));return this.EUe=!1}tfd(){va.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(ea){return this.isActive?this.V_n(ea):this.W_n(ea)}V_n(ea){let Xa=!1;switch(ea.Lb.keyCode){case Sys.UI.Key.enter:this.X4h();this.Luf(this.Xi||this.mWe);Xa=!0;break;case Sys.UI.Key.tab:this.Cph&&this.vMe(this._element);break;case Sys.UI.Key.esc:this.Otg(),this.Luf(this.Xi||this.mWe),Xa=!0}return Xa}W_n(ea){let Xa=!1;switch(ea.Lb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.l3j(this.mWe),
this.isActive&&this.FLd(this._element),Xa=!0}return Xa}yE(){this.isActive||(this.l3j(!1),this.isActive&&(this._element.focus(),this.FLd(this._element),this.d7e=!0));return!1}CCa(){return this.d7e?(this.FLd(this._element),this.d7e=!1,!0):!1}Goc(){return 32===this.ga.Ob(x.a.Iua,1)}X4h(){const ea=La.a.qL(this.kQa.zA);let Xa=this._element.innerText.trim();Xa.length>this.eGb&&(Xa=Xa.substr(0,this.eGb));Xa!==ea&&""!==Xa?32!==this.ga.Qb(x.a.Iua,2,Xa)?this.Otg():this.RAc(Xa):this.Otg()}Otg(){this.RAc(La.a.qL(this.kQa.zA))}RAc(ea){this._initialized&&
(this._element.innerText=ea,this.cDh())}l3j(ea){this.Goc()?this.isActive||(ea&&(this.EUe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Zf.a.Wh,Zf.a.oUh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Bg.a.oii),this.wib&&this.wib.execute(Xa=>{Xa.Zxj(!0)}),ea&&this._element.focus(),va.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.Ob(x.a.Uxc,
2)}Luf(ea){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Zf.a.Wh,Zf.a.N$);Sys.UI.DomElement.removeCssClass(this._element,Bg.a.oii);this.wib&&this.wib.execute(Xa=>{Xa.Zxj(!1)});ea&&(this._element.blur(),this._element.focus())}static CDa(){me.a.CDa(m.AFrameworkApplication.isRtl)}static Qm(){return new zf(m.AFrameworkApplication.va,mf.a.instance,ug.KeyInputManager.instance,Bi.a.instance,m.AFrameworkApplication.Et,zf.CDa,la.a.rOo,
la.a.P2h,Fa.a.instance.Ta("Common.App.Header.HeaderEventSource"),fb.a.c0,fb.a.Di,fb.a.nj)}}Object(f.a)(zf,"RenameUIHandler",null,[977]);class xh{static get instance(){return m.AFrameworkApplication.ua.Gb.tN?xh._instance||(xh._instance=cf.Qm()):xh._instance||(xh._instance=zf.Qm())}}xh._instance=null;Object(f.a)(xh,"RenameUIHandlerFactory",null,[]);var Vj=d(877);class Ui{constructor(){this.Fag=this.zRn=this.EMl=null}}Object(f.a)(Ui,"RenameMruEntryProperties",null,[]);var Bb=d(186),Pb=d(90),zc=d(1505),
$c;(function(ea){ea[ea.unknown=-1]="unknown";ea[ea.success=0]="success";ea[ea.jjq=1]="renameInvalidFileName";ea[ea.ijq=2]="renameInCoauthNotSupported";ea[ea.kjq=3]="renameNotSupportedInViewMode";ea[ea.Mbo=4]="permissionDenied";ea[ea.Klq=5]="serverCommunicationFailure";ea[ea.r1p=6]="fileNameTooLong"})($c||($c={}));Object(f.b)("CommonOperationResult",$c);var Ae=d(1868);class Gf{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng){this.Amc=()=>xh.instance.initialize(m.AFrameworkApplication.z2d,m.AFrameworkApplication.phi,
m.AFrameworkApplication.$Dj||CommonUIStrings.l_RenameFileTooltip)?32:8;this.Uxc=()=>{const uh=this.DDp(),Oh=this.fSk();va.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.MFb,Oh,uh,this.Dlb);m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.kH&&m.AFrameworkApplication.J.$("ReactRenameDisabledDialogIsEnabled")?new dd(this.MFb,!Oh,!uh,this.Dlb,
this.$ib()):new Fd(this.MFb,!Oh,!uh,this.Dlb,this.$ib());return 32};this.Iua=(uh,Oh,Hj,Da,Ib)=>{var hc;if(1===Hj)return this.Goc();if(!m.AFrameworkApplication.BOb)return 8;if(8===this.Goc())return this.Pb.Ob(x.a.Uxc,2),8;va.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");uh=!1;(null===(hc=m.AFrameworkApplication.J)||void 0===hc?0:hc.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))&&Ib instanceof Ae.a&&(uh=Ib.disableFailedActionDialog,Ib=Ib.fileNameCandidate);
m.AFrameworkApplication.BOb(Ib,Object(O.a)(this,this.Dfd,"onRenameFileSuccess"),uh?()=>{}:this.I2n);m.AFrameworkApplication.ZDj=!0;return 32};this.I2n=uh=>{const Oh=new Xe.StandardDialog;Oh.Bd=0;switch(uh){case 1:va.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Oh.Cna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:va.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Oh.Cna(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileNameTooLong,null);break;default:va.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:uh}),Oh.Cna(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}m.AFrameworkApplication.nN().execute(Hj=>{Hj.sendMessage(Pb.a.w7l,{["FailureMessage"]:$c[uh]})});this.QGj()};this.qto=(uh,Oh,Hj)=>{if(1===Hj)return this.Goc();if(!m.AFrameworkApplication.RUa)return 8;m.AFrameworkApplication.RUa(Object(O.a)(this,this.Bsc,"onRefreshFilenameSuccess"),
Object(O.a)(this,this.dne,"onRefreshFilenameFailure"),!1);return 32};this.Vje=(uh,Oh,Hj,Da,Ib)=>{if(1===Hj)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?this.Goc():8;if(2===Hj){if(!m.AFrameworkApplication.cnd)return pa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Ib)return pa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Ib[Bb.a.Yhn])if(Ib[Bb.a.M9j])if(uh=Ib[Bb.a.M9j].toLowerCase(),
Oh=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"),Hj=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Oh&&m.AFrameworkApplication.aub&&Hj){const hc={};hc[Bb.a.Quc]="1";hc[Bb.a.documentUrl]=uh;hc[Bb.a.reason]=zc.a.hvg;pa.Health.instance.recordKpiSuccess("MoveToFolder",null);m.AFrameworkApplication.nN().execute(Kc=>{Kc.sendMessage(Pb.a.SNb,hc)})}else if(!m.AFrameworkApplication.aub&&Hj)pa.Health.instance.recordKpiSuccess("MoveToFolder",
null),la.a.Tm(uh,la.a.Vva(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return pa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else pa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else m.AFrameworkApplication.RUa(Object(O.a)(this,this.Bsc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.dne,"onRefreshFilenameFailure"),!1),m.AFrameworkApplication.cnd(),pa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};
this.Wph=ea;this.ga=Xa;this.em=yb;this.dO=Ub;this.MFb=yc;this.fSk=ad;this.Dlb=md;this.hJh=Sd;this.LKk=ze;this.$ib=Ne;this.Aa=ng;this.KKk=Ng}Xb(){m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.tN||this.Pb.qa(x.a.Amc,z.a.frame,this.Amc);this.Pb.qa(x.a.Uxc,z.a.frame,this.Uxc);this.Pb.qa(x.a.Iua,z.a.frame,this.Iua);this.Pb.fb(x.a.OOb,z.a.frame,this.qto,64);this.Pb.fb(x.a.Vje,z.a.frame,this.Vje,64);this.Pb.qa(x.a.QVb,z.a.frame,Object(O.a)(this,this.QVb,"moveToFolder"));(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",
!0)||m.AFrameworkApplication.ua&&(m.AFrameworkApplication.J.$("PostMessageEmbedded")||m.AFrameworkApplication.J.$("IsJsApi"))&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&m.AFrameworkApplication.nN().execute(ea=>{ea.Bv(Pb.a.Xej);ea.LE(Pb.a.Xej,Gf.Lpo);ea.Bv(Pb.a.YBf);ea.LE(Pb.a.YBf,Gf.Kpo)})}Goc(){return 0===this.KKk.hFi()?32:8}DDp(){return this.sn?this.Dlb?this.sn.xhi:this.sn.qqb:!0}Dfd(ea,Xa){ea?0!==ea.OperationResult?this.ILi(ea.OperationResult):
(this.jQo(Xa,ea.NewName),this.svp(ea,Object(O.a)(m.AFrameworkApplication.ua.Gb,m.AFrameworkApplication.ua.Gb.h8j,"updateOpenInClientDocumentUrl")),m.AFrameworkApplication.J.$("DocumentNameInJewelInfoMenuIsEnabled")&&m.AFrameworkApplication.ua.Ge(),this.LKk.Q5j()):this.ILi(5)}jQo(ea,Xa){const yb={};yb[Bb.a.x7l]=Xa;ea.sendMessage(Pb.a.YBf,yb)}svp(ea,Xa){this.Gvp(ea);m.AFrameworkApplication.h_d=ea.DirectInvokeDavUrl;Xa=Xa(ea.EditDocInClientUrl);const yb=new Ui;yb.Fag=this.dO.zA;yb.EMl=Xa;yb.zRn=ea.EditDocInClientUrl;
this.Pb.Qb(x.a.aEj,2,yb)}ILi(ea){switch(ea){case 1:ea=new Xe.StandardDialog,ea.Bd=0,ea.lV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.QGj()}}Gvp(ea){this.dO.zA=Gf.d7k(this.dO.zA,ea.NewName);ea.BreadcrumbFolderName&&(this.dO.breadcrumbFolderName=ea.BreadcrumbFolderName);ea.BreadcrumbFolderUrl&&(this.dO.breadcrumbFolderUrl=ea.BreadcrumbFolderUrl);this.hJh(ea.NewName)}QVb(ea,Xa,yb,Ub,yc){if(1===yb)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?
32:8;if(2===yb){const ad={};ea=m.AFrameworkApplication.aub;Xa=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");ea=(!ea||ea&&Xa)&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ad[Bb.a.qgp]=ea;yc&&yc.MoveButtonClickedTime&&(ad[Bb.a.lPn]=yc.MoveButtonClickedTime.getTime());m.AFrameworkApplication.nN().execute(md=>{md.sendMessage(Pb.a.QVb,ad)});if(yc&&yc.MoveButtonClickedTime){if(ea=Vj.a.XG())yc=(new Date).getTime()-yc.MoveButtonClickedTime.getTime(),
ea.set("MovePostDuration",yc.toString());pa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",ea)}return 32}return 8}z6o(ea,Xa){return ea&&Xa?ea!==this.dO.breadcrumbFolderName||Xa!==this.dO.breadcrumbFolderUrl:!1}Bsc(ea,Xa){ea&&(ea.NewName!==La.a.qL(this.dO.zA)||this.z6o(ea.BreadcrumbFolderName,ea.BreadcrumbFolderUrl))&&this.Dfd(ea,Xa)}dne(){}QGj(){this.hJh(La.a.qL(this.dO.zA))}get Pb(){return this.ga.value}get sn(){return this.em.value}static get instance(){return Gf._instance||(Gf._instance=
Gf.sPb())}static sPb(){return new Gf(m.AFrameworkApplication.A$c,new nc.a(()=>m.AFrameworkApplication.va),new nc.a(()=>m.AFrameworkApplication.sn),m.AFrameworkApplication.Et,m.AFrameworkApplication.Bta,()=>m.AFrameworkApplication.TLg,m.AFrameworkApplication.Nkd,Object(O.a)(xh.instance,xh.instance.RAc,"updateTitle"),Fa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>m.AFrameworkApplication.qw,m.AFrameworkApplication.J,Fa.a.instance.resolve("Common.IRenameProps"))}static d7k(ea,Xa){ea=
La.a.jla(ea);return Xa+ea}static Lpo(ea){const Xa=ea.Values[Bb.a.eon];va.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Xa);Xa?m.AFrameworkApplication.va.Qb(x.a.Vje,2,ea.Values):pa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static Kpo(ea){m.AFrameworkApplication.va.Qb(x.a.Iua,2,ea.Values.NewName)}}Gf._instance=null;Object(f.a)(Gf,"RenameActor",null,[]);var jg=d(195),hi=d(1279),xj=d(584),xg=d(479);class fj{constructor(ea,
Xa){this.ga=ea;this.lGc=Xa}Xb(){this.ga.qa(x.a.mCg,z.a.frame,Object(O.a)(this,this.A9o,"showRenameDialogAction"))}A9o(ea,Xa,yb){ea=32;if(1===yb)return xg.SessionStatusManager.instance.Jk||m.AFrameworkApplication.eta?8:32;2===yb&&(32!==this.ga.Ob(x.a.Iua,1)?(this.ga.Ob(x.a.Uxc,2),jg.a.instance.fc(hi.a.asa,{["Reason"]:xj.a.XCo}),ea=8):32===this.ga.Ob(x.a.Vxc,1)?this.ga.Ob(x.a.Vxc,2):this.lGc.value.create().y_a());return ea}}Object(f.a)(fj,"RenameDialogActor",null,[957]);class dg{constructor(ea,Xa,yb){this.dialog=
null;this.ga=ea;this.dO=Xa;this.eib=yb}oIm(){const ea={};ea.nameInputProps={["type"]:"AppInputProps",["id"]:dg.Jgc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:La.a.qL(this.dO.zA),["maxLength"]:this.eib};return ea}y_a(){const ea={["id"]:"RenameDialog",["bodyControls"]:this.oIm()};this.dialog=new a.a(!1,!1,!0);this.dialog.Bd=1;this.dialog.Ig="RenameDialog";this.dialog.Uh(CommonUIStrings.l_RenameDialogTitle,Object(O.a)(this,this.$rg,"renameDialogHandler"),ea)}$rg(ea,Xa){if(Xa&&1===ea){if(Xa[dg.Jgc]&&
(ea=La.a.qL(this.dO.zA),Xa=(Xa[dg.Jgc]||"").trim(),Xa!==ea&&""!==Xa)){this.ga.Qb(x.a.Iua,2,Xa);return}jg.a.instance.fc(hi.a.Ggc,{["Reason"]:xj.a.sni})}}}dg.Jgc="txtDocumentName";Object(f.a)(dg,"ReactRenameDialog",null,[979]);class Nf{static get mh(){return a.a.uy(Nf.lo,CommonUIStrings.l_RenameDialogLabel)}}Nf.lo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Nf,"RenameDialogHtml",null,[]);class pg extends a.a{constructor(ea,Xa,yb){super();this.ga=ea;this.dO=Xa;this.eib=yb;this.Ig="RenameDialog";this.mh=Nf.mh}y_a(){var ea={["txtDocumentName"]:La.a.qL(this.dO.zA)};this.Uh(CommonUIStrings.l_RenameDialogTitle,Object(O.a)(this,this.$rg,"renameDialogHandler"),ea);ea=document.getElementById(pg.Jgc);0<this.eib&&(ea.maxLength=this.eib);ea.focus()}$rg(ea,Xa){if(1===ea&&(ea=La.a.qL(this.dO.zA),Xa=(Xa[pg.Jgc]||"").trim(),Xa!==ea&&""!==Xa)){this.ga.Qb(x.a.Iua,
2,Xa);return}jg.a.instance.fc(hi.a.Ggc,{["Reason"]:xj.a.sni})}}pg.Jgc="txtDocumentName";Object(f.a)(pg,"RenameDialog",a.a,[979]);class ye{constructor(ea){this.kQa=null;this.eib=0;this.ga=ea;this._initialized=!1}initialize(ea,Xa){this.kQa=ea;this.eib=Xa;this._initialized=!0}create(){return this._initialized?m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.kH&&m.AFrameworkApplication.J.$("ReactRenameDialogIsEnabled")?new dg(this.ga,this.kQa,this.eib):new pg(this.ga,this.kQa,this.eib):null}}
Object(f.a)(ye,"RenameDialogFactory",null,[958]);var qh=d(207),qg=d(114);class dl{constructor(ea,Xa){this.ga=ea;this.Zb=Xa}Xb(){this.ga.qa(x.a.Vxc,z.a.frame,Object(O.a)(this,this.B9o,"showRenameFlyoutAction"))}Nll(){return F.d("setDocumentTitleFlyoutOpened")&&m.AFrameworkApplication.ua.Gb.tN}B9o(ea,Xa,yb){if(1===yb)return this.Nll()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}RZk(){dl.Osn&&m.AFrameworkApplication.BI&&qg.a.instance.$b(new jd.a(5,1,5E3,
()=>{32===this.ga.Ob(x.a.Vxc,1)&&this.Zb&&this.Zb.currentScope.name===qh.AFrame.Do&&(Vd.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.Ob(x.a.Vxc,2))}))}static get Osn(){dl.VEd&&null!=dl.VEd||(m.AFrameworkApplication.$c("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),dl.VEd=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return dl.VEd}}dl.VEd=null;Object(f.a)(dl,
"RenameFlyoutActor",null,[956]);class Jk{constructor(ea,Xa,yb,Ub,yc){this.tul=null;this.em=yc;this.Xph=yb;this.Wph=Ub;this.hSk=ea;this.$ib=Xa}get sn(){return this.em.value}hFi(){if(!this.Wph())return 5;if(this.$ib())return 1;if(this.sn){if(this.Xph&&!this.sn.xhi)return 3;if(!this.Xph&&!this.sn.qqb)return 4}return this.hSk()?0:2}}Object(f.a)(Jk,"RenameProps",null,[955]);class Ni{constructor(ea,Xa,yb,Ub,yc,ad){this.Ps=!1;this.iZe=new vc.a;this.f6b=Xa;this.nB=yb;this.Y4b=Ub;this.Aa=yc;this.xja=ad}enable(){this.Ps||
(this.Q5j(),this.UDg(),this.Ps=!0)}generateKey(ea,Xa,yb){return String.format("{0}/{1}/{2}",yb,ea,Xa)}zxm(){const ea=La.a.qL(this.f6b().zA);return this.generateKey(this.f6b().breadcrumbFolderName,this.f6b().breadcrumbFolderUrl,ea)}Axm(ea,Xa,yb){return ea&&Xa?this.generateKey(ea,Xa,yb):yb}gUl(ea,Xa,yb){return ea&&ea!==this.f6b().breadcrumbFolderName||Xa&&Xa!==this.f6b().breadcrumbFolderUrl?!0:yb!==La.a.qL(this.f6b().zA)}Q5j(){const ea=this.zxm();this.iZe.W(ea,new Date)}rjg(ea){this.E4o(ea)&&this.FLh(ea)}E4o(ea){const Xa=
this.Y4b();return Xa?this.xja&&this.xja.$o||!Xa.ude||!m.AFrameworkApplication.RUa?(this.kYj(ea),this.Ps=!1):!0:!1}coj(ea,Xa,yb,Ub){const yc=this.gUl(ea,Xa,yb);ea=this.Axm(ea,Xa,yb);Xa=this.iZe.Ec(ea).returnValue;yc&&!Xa&&(this.KLi(Ub),va.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.z5f));yc||this.iZe.W(ea,this.nB())}}Object(f.a)(Ni,"ARenamedFileChecker",null,[886]);class Wh extends Ni{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){super(ea,Xa,yb,Ub,yc,ad);this.fMi=(ze,Ne)=>{Ne&&Ne.aWb&&
Ne.xij&&(Ne.jXa("BreadcrumbDocName")||Ne.jXa("BreadcrumbFolderName")||Ne.jXa("BreadcrumbFolderUrl")||Ne.jXa("DirectInvokeDAVUrl")||Ne.jXa("EditDocInClientUrl"))&&(va.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.z5f),this.rjg(Ne))};this.pO=yc;this.JKk=md;this.eUe=Sd}get z5f(){return"RenamedFileCheckerUsingSettingsRefresh"}UDg(){this.pO.ASc(this.fMi)}kYj(){this.pO.Jrg(this.fMi)}FLh(ea){if(ea&&ea.aWb){const Xa=ea.aWb;this.coj(Xa.jb("BreadcrumbFolderName"),Xa.jb("BreadcrumbFolderUrl"),
Xa.jb("BreadcrumbDocName"),ea)}}KLi(ea){const Xa={OperationResult:0,classId:1};ea=ea.aWb;Xa.BreadcrumbFolderName=ea.jb("BreadcrumbFolderName");Xa.BreadcrumbFolderUrl=ea.jb("BreadcrumbFolderUrl");Xa.DirectInvokeDavUrl=ea.jb("DirectInvokeDAVUrl");Xa.EditDocInClientUrl=ea.jb("EditDocInClientUrl");ea=ea.jb("BreadcrumbDocName");Xa.NewName=m.AFrameworkApplication.J_d?ea:La.a.qL(ea);this.eUe.execute(yb=>{this.hen(Xa,yb)})}hen(ea,Xa){this.JKk().Dfd(ea,Xa)}}Object(f.a)(Wh,"RenamedFileCheckerUsingSettingsRefresh",
Ni,[]);class gh extends Ni{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne){super(ea,yb,Ub,yc,ad,ze);this.oOc=this.uk=null;this.VIk=Xa;this.ga=md;this.Jb=Sd;Ne&&Ne.execute(ng=>{this.Uxo(ng)})}get z5f(){return"RenamedFileCheckerUsingTask"}Uxo(ea){this.uk=ea;this.uk.BHa(Object(O.a)(this,this.F_,"handleVisibilityChange"))}F_(ea,Xa){!this.Ps||0!==Xa.newState&&1!==Xa.newState||this.oOc||(this.UDg(),this.rjg(this.oOc))}UDg(){this.oOc=new jd.a(3,2,this.VIk(),Object(O.a)(this,this.rjg,"performRenameFileCheckTick"),
89);this.Jb.$b(this.oOc)}kYj(ea){this.Jb.wf(ea)}FLh(ea){this.uk&&2===this.uk.vA?this.Ozo(ea):m.AFrameworkApplication.RUa(Object(O.a)(this,this.Bsc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.dne,"onRefreshFilenameFailure"),!0)}Ozo(ea){this.Jb.wf(ea);this.oOc=null}Bsc(ea){ea&&this.coj(ea.BreadcrumbFolderName,ea.BreadcrumbFolderUrl,ea.NewName,null)}KLi(){this.ga.Ob(x.a.OOb,2)}dne(){}}Object(f.a)(gh,"RenamedFileCheckerUsingTask",Ni,[]);var th=d(83);class li{constructor(){this.Aa=this.Z=null;this.iz=
()=>{const ea=m.AFrameworkApplication.ua.Gb.tN;m.AFrameworkApplication.A$c()&&xh.instance.initialize(m.AFrameworkApplication.z2d,ea?null:m.AFrameworkApplication.phi,ea?null:m.AFrameworkApplication.$Dj||CommonUIStrings.l_RenameFileTooltip)&&(this.Z.register(Jk,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ud(()=>new Jk(()=>m.AFrameworkApplication.TLg,()=>m.AFrameworkApplication.qw,m.AFrameworkApplication.Nkd,m.AFrameworkApplication.A$c,new nc.a(()=>m.AFrameworkApplication.sn))).ha(),Gf.instance.Xb(),
this.Aa.$("RenameDialogIsEnabled")&&(this.Z.resolve("Common.App.Rename.RenameDialogFactory").initialize(m.AFrameworkApplication.Et,m.AFrameworkApplication.z2d),this.Z.resolve("Common.App.Rename.IRenameDialogActor").Xb()),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").Xb(),m.AFrameworkApplication.Nkd&&this.Z.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").RZk())}}get name(){return"Common.App.RenameFile"}wc(ea){this.Z=ea;this.Aa=
m.AFrameworkApplication.J;this.Z.register(fj,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ud(()=>new fj(m.AFrameworkApplication.va,this.Z.nf("Common.App.Rename.IRenameDialogFactory"))).ha();this.Z.register(ye,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ud(()=>new ye(m.AFrameworkApplication.va)).ha();this.Z.register(886,"Common.App.Rename.IRenamedFileChecker").Ud(()=>this.BJl()).ha();this.Z.register(dl,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ud(()=>
new dl(m.AFrameworkApplication.va,th.FocusManager.instance())).ha()}BJl(){if(this.Aa.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const ea=this.Z.Oa("Common.IRefreshableAppSettings");if(ea&&ea.X0i)return new Wh(()=>ea.jc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>m.AFrameworkApplication.Et,()=>new Date,()=>m.AFrameworkApplication.sn,ea,this.Z.Oa("Common.ISessionStatus"),()=>Gf.instance,this.Z.Ta("Postmessage.IHostPostmessenger"))}return new gh(()=>this.Aa.jc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Aa.jc("RenamedFileCheckerPingIntervalInMs",12E4),()=>m.AFrameworkApplication.Et,()=>new Date,()=>m.AFrameworkApplication.sn,m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.pc,this.Z.Oa("Common.ISessionStatus"),this.Z.Ta("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Aa.vp(this.iz)}dispose(){}}Object(f.a)(li,"PackageManager",null,[0,1]);class rg extends a.a{constructor(ea,Xa,yb){super(!1,!1,!0);this.CZb=(Ub,yc)=>{if(1===Ub){Ub=yc.ribbonLayoutChoice;
const ad=yc.showRibbonChoice;yc.checkedNewLookToggle!==this.xph&&appChrome.api.getToggleVNextLookHandler()();if(this.vCh!==Ub)appChrome.onRibbonModeToggle();this.eFh!==ad&&("AlwaysShow"===ad?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.xph=ea;this.vCh=Xa;this.eFh=yb}start(){this.Uh("",this.CZb,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["checkedNewLookToggle"]:this.xph,["ribbonLayoutChoice"]:this.vCh,["showRibbonChoice"]:this.eFh}})}}Object(f.a)(rg,
"RibbonSettingsDialog",a.a,[]);class jj{constructor(ea){this.ga=ea}Xb(){this.ga.qa(x.a.F9o,z.a.frame,this.G9o)}G9o(){let ea="SingleLineRibbon";const Xa=m.AFrameworkApplication.J.$("Fluent2StyleIsEnabled");"Multiline"===appChrome.selectors.getRibbonMode()&&(ea="ClassicRibbon");const yb=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new rg(Xa,ea,yb)).start();return 32}}Object(f.a)(jj,"RibbonSettingsDialogActor",null,[885]);class Jl{constructor(){this.Z=null}get name(){return"Common.App.RibbonSettings"}wc(ea){this.Z=
ea;this.Z.register(jj,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").Ud(()=>new jj(m.AFrameworkApplication.va)).ha()}init(){const ea=this.Z.Oa("Common.App.RibbonSettings.IRibbonSettingsDialogActor");ea?ea.Xb():R.b(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){K.a.instance.Mc(new Jl)}}Object(f.a)(Jl,"RibbonSettingsPackage",null,[0,1]);class Af{static get mh(){return a.a.uy(Af.lo,
CommonUIStrings.l_SaveACopyFileName)}}Af.lo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(f.a)(Af,"FileNameDialogHtml",null,[]);class kl extends a.a{constructor(ea,Xa,yb,Ub){super();this.sBd=this.HQa=
null;this.ga=ea;this.dwa=Xa;this.rbc=yb;this.Ke(1,CommonUIStrings.l_SaveButtonLabel);this.mh=Af.mh;this.Ig="FileNameDialog-SaveACopy";this.Ah=Ub}jJa(ea,Xa,yb){this.sBd=ea;this.HQa=yb;ea={["txtFileName"]:La.a.qL(m.AFrameworkApplication.Et.zA),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Xa)};this.Uh(CommonUIStrings.l_SaveToOneDrive,Object(O.a)(this,this.y2d,"fileNameDialogHandler"),ea);va.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}y2d(ea,
Xa){1!==ea?va.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(ea=Xa.txtFileName.trim(),va.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Xa=La.a.jla(m.AFrameworkApplication.fileName),ea&&""!==ea&&""!==Xa&&(ea+=Xa),this.rbc.cEa(this.sBd,this.HQa,ea,this.Ah))}}Object(f.a)(kl,"FileNameDialog",a.a,[1050]);class xi{constructor(ea,Xa,yb){this.ga=ea;this.dwa=Xa;this.rbc=yb}create(ea){return new kl(this.ga,this.dwa,this.rbc,
ea)}}Object(f.a)(xi,"FileNameDialogFactory",null,[1015]);class Eh extends Xe.StandardDialog{constructor(ea){super();this.bug=Xa=>{1===Xa?(va.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.Ob(x.a.vdb,2)):va.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Bd=1;this.Ke(1,CommonUIStrings.l_RetryButtonLabel);this.Ke(0,CommonUIStrings.l_DialogClose);this.ga=ea}iR(ea){va.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",ea);this.Iy(ea,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_ErrorSavingToOneDrive,this.bug)}}Object(f.a)(Eh,"RetryDialog",Xe.StandardDialog,[1014]);var Kj=d(1180);class Vi{}Vi.xdb="SaveToCloudStorage";Vi.vdb="SaveACopy";Object(f.a)(Vi,"SaveToCloudStorageConstants",null,[]);class Qh{constructor(ea,Xa,yb,Ub){this.SKd=null;this.dMk=ea;this.Aa=yb;this.Dxh=Xa;this.bth=new v.a;this.ee=Ub}epc(){return this.Aa.$("SaveToCloudStorageUIIsEnabled")}iqb(){return x.a.xdb}WTd(){ld.a.ate(Object(O.a)(this,this.rJj,"saveToCloudActionDispatcher"));ld.a.m_c([new Kj.a(x.a.xdb,
z.a.frame,0)],this.Dxh.kkc())}Xb(){const ea=this.Dxh.kkc();ea?(ea.Z1(()=>{this.bth.gg(!0)}),this.WTd()):va.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}hzj(){va.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}rJj(ea,Xa,yb,Ub,yc){Ub=m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk;var ad="";switch(ea){case x.a.xdb:ad=Vi.xdb;break;case x.a.vdb:ad=Vi.vdb;break;default:va.ULS.sendTraceTag(508372377,
216,50,"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}if(Xa.contextId!==z.a.frame||ea!==this.iqb())return 2;if(!this.epc())return 8;if(1===yb)return xg.SessionStatusManager.instance.Jk||m.AFrameworkApplication.eta?8:32;if(2===yb){this.hzj();const md=Ub&&ad===Vi.xdb&&null===yc&&m.AFrameworkApplication.J.$("FilePickerSkip_AfterSignIn_Fix")?{}:yc;md&&m.AFrameworkApplication.J.$("EntryPoint_SaveToCloudStorage")&&(md.SaveEntryPoint=ad);md&&md.FileDownloadUrl&&va.ULS.sendTraceTag(50708835,
216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.ee&&(this.SKd=this.ee.Xf("DialogShown","SaveToOneDriveReponseTime"));this.bth.task.continueWith(()=>{this.SKd&&(this.SKd.stop(),this.SKd=null);this.dMk.start(md)});return 32}return 8}}Object(f.a)(Qh,"SaveToCloudStorageActor",null,[1020]);class Mh extends Qh{constructor(ea,Xa,yb,Ub){super(ea,Xa,yb,Ub);this.zHk=Xa}epc(){return this.Aa.$("SaveACopyBrsIsEnabled")}iqb(){return x.a.vdb}WTd(){ld.a.ate(Object(O.a)(this,this.rJj,"saveToCloudActionDispatcher"));
ld.a.m_c([new Kj.a(x.a.vdb,z.a.frame,0)],this.zHk.kkc())}hzj(){m.AFrameworkApplication.$c("CreateCopy_cf;CreateCopy_tf");va.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(Mh,"SaveACopyActor",Qh,[]);class Ch{}Ch.default=0;Object(f.a)(Ch,"SaveToCloudErrorCodes",null,[]);class Al{constructor(ea,Xa,yb,Ub,yc,ad){this.Ah=null;this.$Nk=ea;this.Qxa=Xa;this.rbc=yb;this.Aa=Ub;this.c4b=yc;this.qJ=ad}start(ea){this.Ah=ea;var Xa=null!==this.Ah&&this.Ah.hasOwnProperty("SaveEntryPoint")&&
this.Ah.SaveEntryPoint.toString()===Vi.xdb;if("SharePointOnlineConsumer"===this.Aa.jb("FileSource")){const yb=Fa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(yb){yb.start(null,ea);return}}this.Qxa.r8c?(ea=Object(bb.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Host),m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk&&Xa&&("Open From URL"===ea||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",
!1))?(va.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.rbc.cEa("root","https://onedrive.live.com",null,this.Ah)):(va.ULS.sendTraceTag(6590559,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk?15:50,"User is signed in. We will show file picker."),this.Jkl())):(va.ULS.sendTraceTag(6590560,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk?
15:50,"User is not signed in. We will show sign in dialog."),this.N9o())}N9o(){this.$Nk.create().jJa()}qq(){this.qJ().iR(Ch.default)}Jkl(){try{va.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let ea={["client_id"]:this.Aa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.c4b||2===this.c4b)ea={["client_id"]:this.Aa.appSettings.UploadToSkyDriveClientId};WL.init(ea);va.ULS.sendTraceTag(6590562,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk?
15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(O.a)(this,this.zE,"onSuccess"),Object(O.a)(this,this.onFailure,"onFailure"))}catch(ea){va.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",ea,ea.stack),this.qq()}}zE(ea){va.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");ea&&ea.data&&ea.data.folders&&this.rbc.cEa(ea.data.folders[0].id,
ea.data.folders[0].urls.viewInBrowser,null,this.Ah)}onFailure(ea){if(ea&&ea.error){if("user_canceled"===ea.error.code){va.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}va.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",ea.error.code,ea.error.message)}else va.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.qq()}}Object(f.a)(Al,"SaveToCloudManager",null,[921]);class Rj extends Al{constructor(ea,
Xa,yb,Ub,yc,ad,md){super(Xa,yb,Ub,yc,ad,md);this.yvk=ea}zE(ea){ea&&ea.data&&ea.data.folders?(va.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.yvk.create(this.Ah).jJa(ea.data.folders[0].id,ea.data.folders[0].name,ea.data.folders[0].urls.viewInBrowser)):(va.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.qq())}onFailure(ea){ea&&ea.error&&"user_canceled"===ea.error.code&&va.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
super.onFailure(ea)}qq(){va.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.qq()}}Object(f.a)(Rj,"SaveACopyManager",Al,[]);var qk=d(179);class eg{constructor(ea,Xa,yb,Ub,yc){this.HQa=this.tl=this.mEc=null;this.s1=!1;this.Ah=this.f5a=null;this.lbf=ea;this.T3a=Xa;this.qJ=yb;this.Nj=Ub;this.ee=yc}neb(){this.Nj&&1===this.Nj.state||(this.tl=this.T3a(),this.tl.message=CommonUIStrings.l_CommentProgressTooltip,this.tl.Bd=5,this.tl.Au=!1,this.tl.aM(CommonUIStrings.l_DefaultDialogTitle,
null,null))}Hra(){this.tl&&(this.tl.close(),this.tl=null)}D8(){1!==m.AFrameworkApplication.ua.state&&this.qJ().iR(Ch.default)}TYb(){va.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");la.a.Tm(this.HQa,la.a.Vva(3),void 0,"UploadToCloudManager.RedirectToFolder")}SYb(ea){var Xa=null!==this.Ah&&this.Ah.hasOwnProperty("SaveEntryPoint")&&this.Ah.SaveEntryPoint.toString()===Vi.xdb;m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk&&Xa&&(ea+=
"&wdsvodm=true");let yb=Xa=!1;m.AFrameworkApplication.J&&(Xa=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),yb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));va.ULS.sendTraceTag(6654163,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",ea,Xa);if(Xa&&yb){va.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Ub={};Ub[Bb.a.Quc]="1";Ub[Bb.a.documentUrl]=ea;m.AFrameworkApplication.nN().execute(yc=>{yc.sendMessage(Pb.a.SNb,Ub)})}else la.a.Tm(ea,la.a.Vva(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}cEa(ea,Xa,yb=null,Ub=null){va.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.ee&&(this.f5a=this.ee.Xf("DialogShown","SaveToOneDriveUploadTime"));this.neb();this.HQa=Xa;this.mEc=this.lbf.create(ea,yb,Ub);this.Ah=Ub;this.Xka()}Xka(){va.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");
this.mEc.execute(Object(O.a)(this,this.D3n,"onSaveToCloudUploadFinished"),Object(O.a)(this,this.C3n,"onSaveToCloudUploadFailed"))}D3n(ea){this.Hra();this.s1=!1;if(ea&&ea.data&&ea.data.Pe){var Xa;if(({av:Xa}=Wa.d(ea.data.Pe)).returnValue)if(ea=Xa,ea.StatusCode!==qk.a.qz&&ea.StatusCode!==qk.a.Gfc)va.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.D8();else{va.ULS.sendTraceTag(6590603,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&
1===m.AFrameworkApplication.ua.Gb.Mk?15:50,"UploadToCloudManager upload success.");try{ea.NewDocumentUrl&&""!==ea.NewDocumentUrl?this.SYb(ea.NewDocumentUrl):this.TYb()}catch(yb){va.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",yb.toString())}this.Zgd()}else va.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:tc.a.csd(ea.data.Pe)}),this.D8()}else va.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.D8()}C3n(ea){5!==ea.data.status&&12!==ea.data.status||this.s1?(va.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",ea.data.status),this.Hra(),this.D8(),this.Zgd()):(va.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.s1=!0,this.Xka())}Zgd(){this.f5a&&(this.f5a.stop(),this.f5a=null)}}Object(f.a)(eg,"UploadToCloudManager",null,[920]);class qf extends eg{constructor(ea,Xa,yb,Ub,yc,ad){super(Xa,yb,Ub,yc,ad);this.ga=ea}F_f(){return!!this.Ah&&
!!this.Ah.SaveEntryPoint&&"VersionHistory"===this.Ah.SaveEntryPoint.toString()}D8(){va.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.F_f()&&this.ga.Qb(x.a.oue,2,{["FailureReason"]:"Unknown"});super.D8()}TYb(){va.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.F_f()&&this.ga.Ob(x.a.lld,2);super.TYb()}SYb(ea){va.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",ea);this.F_f()&&this.ga.Ob(x.a.lld,2);super.SYb(ea)}Xka(){this.Ah&&
"true"===this.Ah.SkipSaveToHost?super.Xka():32!==this.ga.Ob(x.a.YZb,1)?(va.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.Xka()):this.ga.Qb(x.a.YZb,2,[()=>{va.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");eg.prototype.Xka.call(this)},()=>{va.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.D8()}])}}Object(f.a)(qf,"SaveACopyUploadToCloudManager",
eg,[]);var kg=d(772),Wi=d(1178);class ql{constructor(){this.Z=null;this.iz=()=>{m.AFrameworkApplication.J.$("SaveACopyBrsIsEnabled")&&this.Z.resolve("Common.App.SaveACopy.SaveACopyActor").Xb()}}get name(){return"Common.App.SaveACopy"}init(){m.AFrameworkApplication.J.vp(this.iz)}dispose(){}wc(ea){this.Z=ea;this.Z.register(qf,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ud(()=>new qf(m.AFrameworkApplication.va,ea.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Wi.a).create(),
()=>new Eh(m.AFrameworkApplication.va),m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Vr)).ha();this.Z.register(xi,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ud(()=>new xi(m.AFrameworkApplication.va,m.AFrameworkApplication.ua.Gb,ea.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();this.Z.register(Mh,"Common.App.SaveACopy.SaveACopyActor").Ud(()=>new Mh(ea.resolve("Common.App.SaveACopy.SaveACopyManager"),ea.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
m.AFrameworkApplication.J,m.AFrameworkApplication.ua.Vr)).ha();this.Z.register(Rj,"Common.App.SaveACopy.SaveACopyManager").Ud(()=>new Rj(ea.resolve("Common.App.SaveACopy.FileNameDialogFactory"),ea.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),kg.a.instance,ea.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),m.AFrameworkApplication.J,m.AFrameworkApplication.R6,()=>new Eh(m.AFrameworkApplication.va))).ha()}static main(){K.a.instance.Mc(new ql)}}Object(f.a)(ql,"PackageManager",
null,[0,1]);var hg=d(40);class Km extends Xe.StandardDialog{constructor(ea,Xa){super();this.z9b=!1;this.xQ=null;this.bug=yb=>{1===yb?(va.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.xQ?this.ga.Qb(x.a.vmd,2,[this.xQ,this.z9b]):this.ga.Ob(x.a.vmd,2)):va.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.ga=ea;this.lHc=Xa;this.TNa=!1}iR(ea,Xa,yb){this.xQ=Xa;this.z9b=yb;va.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
ea,yb);ea=this.unf(ea);0===ea?(this.Bd=6,this.Ke(0,CommonUIStrings.l_DialogClose)):(this.Bd=0,this.Ke(1,CommonUIStrings.l_DialogClose));0===ea&&va.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Iy(hg.a.FLo,this.Xpm(ea),this.Wpm(ea,Xa),this.bug,!0)}unf(ea){return 0>ea||6<ea?(va.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",ea),0):ea}Wpm(ea,Xa){ea=this.unf(ea);return this.lHc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Xa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][ea]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Xa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][ea]}Xpm(ea){ea=
this.unf(ea);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][ea]}}Object(f.a)(Km,"ErrorRetryDialog",Xe.StandardDialog,[1052]);class zg{constructor(ea,Xa){this.Aa=ea;this.ga=Xa;this.lHc=this.Aa.$("SaveToHostWithExtraCharsInFileName")}create(){return new Km(this.ga,this.lHc)}}Object(f.a)(zg,
"ErrorRetryDialogFactory",null,[1017]);class Kd extends a.a{constructor(ea,Xa,yb,Ub,yc,ad,md=null){super();this.I9=null;this.ga=Xa;this.dwa=Ub;this.g5a=ad;this.Aa=ea;this.qJ=yc;this.Nj=yb;this.lHc=this.Aa.$("SaveToHostWithExtraCharsInFileName");this.Ah=md;this.Ke(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.Nj}Xfi(ea,Xa){this.$ua(1,!!ea&&ea!==Xa);this.I9=document.getElementById(Kd.rni);ba.a.addHandler(this.I9,"change",Object(O.a)(this,this.bme,"onFileNameChange"));ba.a.addHandler(this.I9,
"input",Object(O.a)(this,this.bme,"onFileNameChange"));this.I9.focus()}qni(ea){return this.lHc?(new RegExp("["+this.ali('\\/:*?"<>|')+"]")).test(ea):(new RegExp("["+this.ali('\\/:*?"<>|#{}%~&')+"]")).test(ea)}ali(ea){return ea.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}DQf(){const ea=La.a.qL(m.AFrameworkApplication.Et.zA);this.$ua(1,!!this.I9&&""!==this.I9.value&&this.I9.value!==ea)}bme(){this.I9&&window.setTimeout(()=>{this.DQf()},0)}y2d(ea,Xa){if(1!==ea)va.ULS.sendTraceTag(23881882,216,
50,"User click cancel to cancel upload file in file name dialog.");else{ea=Xa[Kd.rni];Xa=Kd.kqj in Xa?Xa[Kd.kqj]:!1;va.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",La.a.Hzj(ea),Xa);const yb=La.a.jla(m.AFrameworkApplication.fileName);(ea=ea?ea.trim():null)&&""!==ea&&""!==yb||1===this.ua.state?this.qni(ea)?this.qJ.create().iR(1,ea,Xa):this.g5a.cEa(ea+yb,Xa,this.Ah):this.qJ.create().iR(2,ea,Xa)}}dispose(){this.I9&&(ba.a.removeHandler(this.I9,
"change",Object(O.a)(this,this.bme,"onFileNameChange")),ba.a.removeHandler(this.I9,"input",Object(O.a)(this,this.bme,"onFileNameChange")),this.I9=null);super.dispose()}}Kd.rni="txtFileName";Kd.kqj="chkOverwrite";Object(f.a)(Kd,"FileNameDialogBase",a.a,[]);class Cg{static get mh(){return a.a.uy(Cg.lo,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Cg.lo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(Cg,"FileNameDialogHtml",null,[]);class wl extends Kd{constructor(ea,Xa,yb,Ub,yc,ad){super(ea,Xa,yb,Ub,yc,ad);this.mh=Cg.mh;this.Ig="FileNameDialog-SaveAsToHost"}jJa(ea,Xa){const yb=La.a.qL(m.AFrameworkApplication.Et.zA);Xa={["txtFileName"]:ea||yb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Xa};this.Uh(CommonUIStrings.L_SaveAs,Object(O.a)(this,this.y2d,"fileNameDialogHandler"),Xa);this.Xfi(ea,yb)}}Object(f.a)(wl,"FileNameDialog",Kd,[1051]);class Kl{constructor(ea,
Xa,yb,Ub,yc,ad){this.ga=Xa;this.Aa=ea;this.dwa=Ub;this.g5a=ad;this.qJ=yc;this.Nj=yb}create(){return new wl(this.Aa,this.ga,this.Nj,this.dwa,this.qJ,this.g5a)}}Object(f.a)(Kl,"FileNameDialogFactory",null,[1016]);class ae{constructor(ea,Xa,yb){this.ZIj=(Ub,yc,ad,md,Sd)=>yc.contextId!==z.a.frame||Ub!==x.a.vmd?2:this.Aa.$("SaveAsToHostBrsIsEnabled")?1===ad?xg.SessionStatusManager.instance.Jk||m.AFrameworkApplication.eta?8:32:2===ad?(va.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
Ub=this.JRe.create(),Sd&&Object.getType(Sd)===Array&&2===Sd.length?Ub.jJa(Sd[0],!!Sd[1]):Ub.jJa(null,!1),32):8:8;this.g5a=yb;this.JRe=Xa;this.Aa=ea}Xb(){2===m.AFrameworkApplication.ua.Gb.Mk?m.AFrameworkApplication.va.fb(x.a.vmd,z.a.frame,this.ZIj,4):m.AFrameworkApplication.va.qa(x.a.vmd,z.a.frame,this.ZIj)}}Object(f.a)(ae,"SaveAsToHostActor",null,[]);class pd{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){this.tl=null;this.z9b=this.s1=!1;this.f5a=this.Ah=this.xQ=null;this.Aa=Xa;this.nqa=this.Aa.appSettings.SaveAsToHostWebServiceBase;
this.unh=Ub;this.T3a=yc;this.If=yb;this.qJ=ad;this.ee=Sd;this.Nj=md;this.ga=ea;this.x2a=Xa.jb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}neb(){1!==this.Nj.state&&(this.tl=this.T3a(),this.tl.message=CommonUIStrings.l_CommentProgressTooltip,this.tl.Bd=5,this.tl.Au=!1,this.tl.aM(CommonUIStrings.l_DefaultDialogTitle,null,null))}D8(ea=0){1!==this.Nj.state&&this.qJ.create().iR(ea,La.a.qL(this.xQ),this.z9b)}TYb(){const ea=this.Aa.appSettings.BreadcrumbFolderUrl;va.ULS.sendTraceTag(8194016,216,
50,"Redirecting to OneDrive for business Folder.");la.a.Tm(ea,la.a.Vva(3),void 0,"UploadToHostManager.RedirectToFolder")}SYb(ea){let Xa=!1,yb=!1;this.Aa&&(Xa=this.Aa.$("SaveACopyIsEnabledForUiHost"),yb=this.Aa.$("UiHostSupportsDocRebootFeatures"));va.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",ea,Xa,yb);if(Xa&&yb){va.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ub=
{};Ub[Bb.a.Quc]="1";Ub[Bb.a.documentUrl]=ea;Ub[Bb.a.reason]=zc.a.hvg;m.AFrameworkApplication.nN().execute(yc=>{yc.sendMessage(Pb.a.SNb,Ub)})}else Xa&&!yb&&m.AFrameworkApplication.rN?la.a.Tm(ea,la.a.Vva(4),void 0,"UploadToHostManager.RedirectToEditUrl"):la.a.Tm(ea,la.a.Vva(3),void 0,"UploadToHostManager.RedirectToEditUrl")}cEa(ea,Xa,yb=null){va.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.unh&&!this.unh()&&this.If&&(this.ee&&(this.f5a=this.ee.Xf("DialogShown","SaveAsToHostUploadTime")),
this.neb(),this.z9b=Xa,this.xQ=ea,(this.Ah=yb)&&"true"===this.Ah.SkipSaveToHost?this.A1d():this.Xka())}Xka(){32!==this.ga.Ob(x.a.YZb,1)?(va.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.A1d()):this.ga.Qb(x.a.YZb,2,[()=>{va.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.A1d()},(ea,Xa)=>{va.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.D8(Xa)}])}B5n(ea){this.Hra();this.s1=!1;if(ea&&ea.data&&ea.data.Pe)if(({av:Xa}=Wa.d(ea.data.Pe)).returnValue)if(ea=Xa,ea.StatusCode!==qk.a.qz&&ea.StatusCode!==qk.a.Gfc){va.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Xa={};Xa.FailureReason=ea.StatusCode.toString();Xa.ExtraInfo=ea.ExtraInfo;this.LZa(Xa);this.D8(parseInt(ea.ExtraInfo))}else{va.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.Lsg();try{ea.NewDocumentUrl&&""!==
ea.NewDocumentUrl?this.SYb(ea.NewDocumentUrl):this.TYb()}catch(yb){va.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",yb.toString())}this.Zgd()}else va.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:tc.a.csd(ea.data.Pe)}),this.LZa({["FailureReason"]:"Failed to deserialize response"}),this.D8();else va.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.LZa({["FailureReason"]:"null response"}),this.D8()}A5n(ea){5!==
ea.data.status&&12!==ea.data.status||this.s1?(va.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:ea.data.status,["HttpStatus"]:ea.data.He}),this.LZa({["FailureReason"]:ea.data.He.toString()}),this.Hra(),this.D8(),this.Zgd()):(va.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.s1=!0,this.Ah&&"true"===this.Ah.SkipSaveToHost?this.A1d():this.Xka())}Hra(){this.tl&&(this.tl.close(),this.tl=null)}Zgd(){this.f5a&&(this.f5a.stop(),
this.f5a=null)}Lsg(){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.ga.Ob(x.a.lld,2)}LZa(ea){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.ga.Qb(x.a.oue,2,ea)}A1d(){let ea=this.nqa+this.x2a;ea=Gb.a.lq(ea,"qs",La.a.$i(m.AFrameworkApplication.rm));ea=Gb.a.lq(ea,"n",La.a.$i((new Date).getTime().toString()));ea=Gb.a.lq(ea,"ov",La.a.$i(this.z9b.toString()));ea=Gb.a.lq(ea,"fn",La.a.$i(this.xQ));this.Ah&&this.Ah.FileDownloadUrl&&(ea=Gb.a.lq(ea,"furl",La.a.$i(this.Ah.FileDownloadUrl)));
this.If.Xj(ea,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(O.a)(this,this.B5n,"onUploadFinished"),Object(O.a)(this,this.A5n,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(pd,"UploadToHostManager",null,[884]);class el{constructor(){this.Z=null;this.iz=()=>{m.AFrameworkApplication.J.$("SaveAsToHostBrsIsEnabled")&&this.Z.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Xb()}}get name(){return"Common.App.SaveAsToHost"}init(){m.AFrameworkApplication.J.vp(this.iz)}wc(ea){this.Z=
ea;this.Z.register(zg,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ud(()=>new zg(m.AFrameworkApplication.J,m.AFrameworkApplication.va)).ha();this.Z.register(pd,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ud(()=>new pd(m.AFrameworkApplication.va,m.AFrameworkApplication.J,m.AFrameworkApplication.Fe,()=>m.AFrameworkApplication.Yl,()=>(new Wi.a).create(),ea.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),
m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Vr)).ha();this.Z.register(Kl,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ud(()=>new Kl(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Gb,ea.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),ea.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();this.Z.register(ae,"Common.App.SaveAsToHost.SaveAsToHostActor").Ud(()=>
new ae(m.AFrameworkApplication.J,ea.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),ea.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){K.a.instance.Mc(new el)}}Object(f.a)(el,"SaveAsToHostPackage",null,[0,1]);class Yg extends Xe.StandardDialog{constructor(){super();this.Bd=0;this.Ke(1,CommonUIStrings.l_DialogClose)}iR(ea){this.Iy(ea,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(f.a)(Yg,"ErrorDialog",Xe.StandardDialog,
[1014]);var rh=d(203);class Mf extends Xe.StandardDialog{constructor(ea,Xa,yb){super();this.D$m=Ub=>{0===Ub?(va.ULS.sendTraceTag(6590598,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.wpe()};this.$nj=()=>{this.jma&&this.hide();va.ULS.sendTraceTag(7143885,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb&&1===m.AFrameworkApplication.ua.Gb.Mk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.ga.Ob(x.a.xdb,2)};this.ga=ea;this.Qxa=Xa;this.dwa=yb;this.vda=!1;this.Bd=1;this.qY(1);this.Ke(1,CommonUIStrings.l_SignIn);this.Ke(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}jJa(){this.Qxa.SOh(this.$nj);this.sw(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.D$m)}Dol(){let ea="2";if(this.dwa)switch(this.dwa.Mk){case 3:ea="0";break;case 2:ea="3";break;case 1:ea="1"}return ea}hide(){this.Qxa.JBo(this.$nj);super.hide()}wpe(){var ea=m.AFrameworkApplication.J.$("SignInAspxInWebAppsPortalIsEnabled")?
"/start/signin.aspx":"Signin.aspx";ea=new rh.QueryStringBuilder(ea);ea.Ae("prompt","1");ea.Ae("cbcxt",this.Dol());m.AFrameworkApplication.Mja(ea);la.a.Tm(ea.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(f.a)(Mf,"SignInDialog",Xe.StandardDialog,[1054]);class mi{constructor(ea,Xa,yb){this.ga=ea;this.Qxa=Xa;this.dwa=yb}create(){return new Mf(this.ga,this.Qxa,this.dwa)}}Object(f.a)(mi,"SignInDialogFactory",null,[1019]);class Ag{constructor(ea,Xa,yb,Ub,yc,ad,md){this.nqa=ea;this.xQ=Xa;this.M6b=
yb;this.sBd=Ub;this.x4e=yc;this.x2a=ad;this.Ah=md}execute(ea,Xa){if(!m.AFrameworkApplication.Yl&&m.AFrameworkApplication.Fe){var yb=this.nqa+this.x2a;yb=Gb.a.lq(yb,"fo",La.a.$i(this.sBd));yb=Gb.a.lq(yb,"fn",La.a.$i(this.xQ));yb=Gb.a.lq(yb,"qs",La.a.$i(this.x4e));yb=Gb.a.lq(yb,"n",La.a.$i((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(yb=Gb.a.lq(yb,"furl",La.a.$i(this.Ah.FileDownloadUrl)));this.M6b&&(yb=Gb.a.lq(yb,"fnn",La.a.$i(this.M6b)));m.AFrameworkApplication.Fe.Xj(yb,1,"",
{"Content-Type":"application/json; charset=utf-8"},!1,2,ea,Xa,null)}}}Object(f.a)(Ag,"SkyDriveUploadCaller",null,[1053]);class Hf{constructor(ea){this.Aa=ea;this.PJb=ea.appSettings.SkyDriveUploadWebServiceBase;this.xQ=ea.appSettings.FileName;this.x2a=ea.jb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(ea,Xa,yb){return new Ag(this.PJb,this.xQ,Xa,ea,m.AFrameworkApplication.rm,this.x2a,yb)}}Object(f.a)(Hf,"SkydriveUploadCallerFactory",null,[1018]);class Pg{constructor(){this.Z=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.J.$("SaveToCloudStorageUIIsEnabled")&&
this.Z.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Xb()}dispose(){}wc(ea){this.Z=ea;this.Z.register(mi,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ud(()=>new mi(m.AFrameworkApplication.va,kg.a.instance,m.AFrameworkApplication.ua.Gb)).ha();this.Z.register(Hf,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ud(()=>new Hf(m.AFrameworkApplication.J)).ha();
this.Z.register(Qh,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ud(()=>new Qh(ea.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),ea.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),m.AFrameworkApplication.J,m.AFrameworkApplication.ua.Vr)).ha();this.Z.register(eg,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ud(()=>new eg(ea.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Wi.a).create(),()=>new Yg,m.AFrameworkApplication.ua,
m.AFrameworkApplication.ua.Vr)).ha();this.Z.register(Al,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ud(()=>new Al(ea.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),kg.a.instance,ea.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),m.AFrameworkApplication.J,m.AFrameworkApplication.R6,()=>new Yg)).ha()}static main(){K.a.instance.Mc(new Pg)}}Object(f.a)(Pg,"PackageManager",null,[0,1]);class bk extends Xe.StandardDialog{constructor(){super();this.Bd=0;this.Ke(1,CommonUIStrings.l_DialogClose)}iR(ea,
Xa){this.ugi(ea,Xa,hg.a.HLo)}ugi(ea,Xa,yb){va.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",yb);this.Iy(yb,ea,Xa,null)}hxf(ea,Xa){va.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Iy(hg.a.JLo,ea,Xa,null,!0)}}Object(f.a)(bk,"ErrorDialog",Xe.StandardDialog,[1027]);class Sj{static get mh(){return a.a.uy(Sj.lo,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Sj.lo=
"<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(Sj,"FileNameDialogHtml",null,[]);var gj=d(94);class Yi extends Kd{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){super(ea,Xa,yb,Ub,yc,ad,Sd);this.Iib=this.G6e=this.oT=null;this.Oil=CommonUIStrings.l_SaveToAnotherFolder;this.mh=Sj.mh;this.Ig="FileNameDialog-SaveToSharePoint";this.YOc=md;this.MHk=Sd}jJa(ea){const Xa=La.a.qL(m.AFrameworkApplication.Et.zA),yb=m.AFrameworkApplication.breadcrumbFolderName,Ub=m.AFrameworkApplication.breadcrumbBrandName,yc={["txtFileName"]:ea||Xa};let ad=CommonUIStrings.L_SaveAs;
2===m.AFrameworkApplication.ua.Gb.Mk&&(ad=CommonUIStrings.L_SaveACopy);this.Uh(ad,Object(O.a)(this,this.y2d,"fileNameDialogHandler"),yc);this.Xfi(ea,Xa);this.cwf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost")||(this.oT=document.getElementById("anotherFolder"),ea=document.getElementById("folderLocation"),this.G6e=Zf.a.URh(ea,this.oT,"anotherFolderDescribedBy"),
this.oT.className="WACButton WACDialogButtonNormal",ea=!1,yb&&yb.length?(this.zMh(this.oT,this.G6e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ub,yb)),ea=this.lVk(Ub,yb)):this.zMh(this.oT,this.G6e,CommonUIStrings.l_CurrentOnlineFolder),this.nXk(this.oT),this.nVk(this.oT),ea?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.oT,"SaveToAnotherLocationTwo"),va.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.oT,"SaveToAnotherLocationOne"),ba.a.addHandler(this.oT,T.a.click,Object(O.a)(this,this.Pfg,"onSaveToAnotherLocationClick")),ba.a.addHandler(this.oT,T.a.ij,Object(O.a)(this,this.Dnj,"onSaveToAnotherLocationKeyDown")))}lVk(ea,Xa){let yb;yb=!1;const Ub=document.getElementById("currentLocation");Ub.innerText="";const yc=this.WBi(Ub,ea),ad=this.WBi(Ub,Xa);let md=255,Sd=255;255<yc+ad&&(md=Math.max(238,408-yc),Sd=Math.max(170,408-ad),yb=!0);this.VZk(Ub,ea,Sd,Xa,md);return yb}WBi(ea,
Xa){const yb=document.createElement("div");yb.innerText=Xa;yb.style.visibility="hidden";ea.appendChild(yb);Xa=yb.clientWidth;ea.removeChild(yb);return Xa}VZk(ea,Xa,yb,Ub,yc){Xa&&(this.yMh(ea,Xa,yb),this.MZk(ea));Ub&&this.yMh(ea,Ub,yc)}yMh(ea,Xa,yb){const Ub=document.createElement("div");Ub.innerText=Xa;Ub.title=Xa;Ub.className="SaveToAnotherFolderBreadcrumb";Ub.style.maxWidth=yb.toString()+"px";ea.appendChild(Ub)}MZk(ea){const Xa=document.createElement("span");Xa.id="FolderSeparator";const yb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");yb.setAttribute("class","SeparatorCaret");const Ub=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ub.setAttribute("points","1 4 1 11 5 7.5");yb.appendChild(Ub);Xa.appendChild(yb);ea.appendChild(Xa)}zMh(ea,Xa,yb){yb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,yb);Xa&&(Xa.innerText=yb);ea.tabIndex=0;ea.setAttribute(Zf.a.Wh,Zf.a.N$)}nVk(ea){const Xa=document.createElement("span");Xa.id="anotherFolderText";Xa.innerText=this.Oil;Xa.className="AnotherFolderTextSpan";
ea.appendChild(Xa)}nXk(ea){const Xa=document.createElement("span");Xa.className="cui-img-cont-float cui-img-16by16 ";this.Iib=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Iib.setAttribute("class","FolderIconSVG");const yb=document.createElementNS("http://www.w3.org/2000/svg","path");yb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Iib.appendChild(yb);Xa.appendChild(this.Iib);
ea.appendChild(Xa)}Dnj(ea){!ea||ea.keyCode!==gj.a.Pu&&ea.keyCode!==gj.a.Gtd||this.Pfg(ea)}Pfg(){if(this.I9){const ea=La.a.jla(m.AFrameworkApplication.fileName);let Xa=this.I9.value;this.hide();Xa&&""!==Xa&&""!==ea||1===this.ua.state?(""!==ea&&(Xa+=ea),this.qni(Xa)?this.qJ.create().iR(1,Xa,!1):this.YOc.start(Xa,this.MHk)):this.qJ.create().iR(2,Xa,!1)}}dol(ea){this.oT&&this.Iib&&(ea?(this.oT.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.oT,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Iib,
"DisabledFolderIconSVG")):(this.oT.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.oT,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Iib,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.oT,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Iib,"DisabledFolderIconSVG"))))}DQf(){super.DQf();this.dol(!!this.I9&&""!==this.I9.value)}dispose(){this.oT&&(ba.a.removeHandler(this.oT,T.a.click,Object(O.a)(this,this.Pfg,"onSaveToAnotherLocationClick")),ba.a.removeHandler(this.oT,
T.a.ij,Object(O.a)(this,this.Dnj,"onSaveToAnotherLocationKeyDown")),this.oT=null);super.dispose()}}Object(f.a)(Yi,"FileNameDialog",Kd,[1056]);var Bl=d(524),Ll=d(280),fn=d(1497),Yn=d(1705);class Tl{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(Tl,"SaveAsDialogInput",null,[]);class jm{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(jm,"SaveLocation",null,[]);var Kk=d(93);class gn{constructor(ea,
Xa,yb,Ub,yc,ad,md,Sd,ze){this.FZe=null;this.xQ="";this.Vpm=()=>{const Ne=new eb.a;Ne.add(this.Rom());const ng=this.eLm();ng&&Ne.addRange(ng);return Object.assign(new Tl,{enableMoreLocations:!m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.xQ,extension:La.a.jla(this.dO.zA),saveLocations:Ne.toArray(),scenario:"SaveToSharePoint"})};this.YOc=ea;this.qJ=Xa;this.Ah=ze;this.g5a=yb;this.Nj=yc;this.dO=Ub;this.yJb=md;this.Z$b=Sd;ad&&(this.FZe=new nc.a(()=>new fn.a(ad.value,
null)))}Rom(){const ea=new Bl.a(Ll.a.vh());ea.W("type","currentHost");return Object.assign(new jm,{folderName:this.dO.breadcrumbFolderName,friendlyPath:this.dO.breadcrumbBrandName,properties:ea})}Lsn(ea){return!!ea&&"ClassicMru"===ea.type&&!!ea.service_info&&!!ea.service_info.service_id&&-1!==ea.service_info.service_id.indexOf("SHAREPOINT")}eLm(){if(!this.FZe||!this.yJb)return null;var ea=this.FZe.value.FR("SaveAsToSharePointDialog",!1);if(!ea||3!==ea.state||!ea.ffj)return null;ea=ea.ffj;const Xa=
new eb.a;let yb=0,Ub=0;for(var yc=0;yc<ea.length;yc++){var ad=ea[yc];if(!this.Lsn(ad))continue;yb++;if(!ad.sharepoint_info)continue;const md=ad.url,Sd=ad.sharepoint_info.site_url,ze=ad.title;ad=Yn.b(ad,m.AFrameworkApplication.isRtl);if(!(md&&Sd&&ze&&ad))continue;Ub++;const Ne=new Bl.a(Ll.a.vh());Ne.W("type","SharePoint");Ne.W("siteUrl",Sd);Ne.W("folderUrl",md);Ub++;Xa.add(Object.assign(new jm,{folderName:ze,friendlyPath:ad,properties:Ne}))}yc=new Map;yc.set("NumPlaces",ea.length.toString());yc.set("NumSharepointPlaces",
yb.toString());yc.set("placesWithMetadata",Ub.toString());pa.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",yc);0<yb&&(Ub?.5>1*Ub/yb&&pa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):pa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Xa}aIf(){const ea={};ea.inputPropsCallback=this.Vpm;return ea}jJa(ea){this.xQ=ea;this.xQ||(this.xQ=String.format(CommonUIStrings.l_SaveACopy_Filename,
La.a.qL(this.dO.zA)));ea={["id"]:"SaveAsDialog",["bodyControls"]:this.aIf()};let Xa=CommonUIStrings.L_SaveAs;2===this.Nj.Gb.Mk&&(Xa=CommonUIStrings.L_SaveACopy);const yb=new a.a(!1,!1,!0);yb.Bd=1;yb.Ig="SaveAsDialog";yb.Ke(1,CommonUIStrings.l_SaveButtonLabel);yb.Uh(Xa,Object(O.a)(this,this.DLo,"saveAsDialogHandler"),ea)}Y8o(ea,Xa){ea&&""!==ea&&""!==Xa||1===this.Nj.state?this.Ksn()?this.tCn(ea,Xa):(""!==Xa&&(ea+=Xa),this.YOc.start(ea,this.Ah)):(va.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),
this.qJ.create().iR(2,ea,!1))}tCn(ea,Xa){pa.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const yb=this.Z$b.fYd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Z$b.Q2c(yb).then(Ub=>{if(Ub&&0<Ub.length){const yc=Ub[0][Bb.a.ico];Ub=Ub[0][Bb.a.jco];if(""!==yc&&""!==Ub)this.yJb.cEa(Ub,ea+Xa,yc,this.Ah),pa.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.qJ.create().iR(0,ea,!1);const ad=Vj.a.XG();ad&&(ad.set("SiteUrlAvailable",
""===yc?"false":"true"),ad.set("FolderUrlAvailable",""===Ub?"false":"true"));pa.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Kk.a,{extendedProperties:ad}))}}else this.qJ.create().iR(0,ea,!1),pa.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ub=>{"Canceled"===Ub?((Ub=Vj.a.XG())&&Ub.set("IsCanceled","true"),pa.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Kk.a,
{extendedProperties:Ub}))):pa.Health.instance.recordKpiFailure("SaveACopySFP",Ub,!1,!1,null)})}Ksn(){return this.Z$b?this.Z$b.Q_f():(va.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}DLo(ea,Xa){if(Xa&&1===ea){ea=Xa.fileName;var yb=La.a.jla(this.dO.zA);Xa.moreLocationsSelected&&this.Y8o(ea,yb);if(Xa.locationCallback){var Ub=Xa.locationCallback();Ub?Ub.properties&&"currentHost"===Ub.properties.K("type")?this.g5a.cEa(ea+yb,!1,this.Ah):Ub.properties&&"SharePoint"===Ub.properties.K("type")?
(Xa=Ub.properties.K("siteUrl"),Ub=Ub.properties.K("folderUrl"),this.yJb.cEa(Ub,ea+yb,Xa,this.Ah)):va.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):va.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else va.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(gn,"ReactSaveAsDialog",null,[1056]);class io{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd=null,ze=null,Ne=null){this.ga=Xa;this.Aa=ea;this.dwa=Ub;this.g5a=ad;this.qJ=yc;this.Nj=yb;this.aDh=
md;this.qDk=Sd;this.yJb=ze;this.Z$b=Ne}create(ea){return this.Nj&&this.Nj.Gb.kH?new gn(this.aDh,this.qJ,this.g5a,m.AFrameworkApplication.Et,this.Nj,this.qDk,this.yJb,this.Z$b,ea):new Yi(this.Aa,this.ga,this.Nj,this.dwa,this.qJ,this.g5a,this.aDh,ea)}}Object(f.a)(io,"FileNameDialogFactory",null,[1026]);class rl{constructor(ea,Xa,yb,Ub){this.nx=this.LMc=null;this.sQb=yc=>{this.nx||3!==yc.state||(this.nx=yc)};this.SDb=ea;this.Nj=yb;this.UIk=Ub;this.u2a=new nc.a(()=>new fn.a(Xa.value,this.sQb))}get Zoj(){this.LMc||
(this.u2a.value.FR("Save As",!0),this.nx&&this.nx.Iga&&this.nx.Iga.length&&(this.LMc=this.ZCm(this.nx.Iga)));return this.LMc}start(ea){if(!this.Zoj)if(m.AFrameworkApplication.breadcrumbFolderUrl&&m.AFrameworkApplication.breadcrumbFolderUrl.length)this.LMc=m.AFrameworkApplication.breadcrumbFolderUrl;else return va.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.nx),!1;const Xa=
this.UIk();Xa.l9o();const yb=Xa.MFm();if(!yb)return va.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.SDb.start((Ub,yc)=>{Xa.hide();ea(Ub,yc)},()=>{this.onCancel(Xa)},yb,this.LMc);return!0}onCancel(ea){ea.hide();va.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}ZCm(ea){ea=ea.toLowerCase();ea.endsWith("/")||(ea+="/");const Xa=ea.indexOf("/documents/");return-1!==Xa?ea.substring(0,Xa+1)+"_layouts/15/onedrive.aspx":""}}Object(f.a)(rl,
"OneDriveFilePickerHelper",null,[1025]);class vm extends a.a{constructor(){super()}l9o(){this.MFc="FilePickerDialog";this.mh="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ig="PickerDialog-MsoSp";this.showDialog("",null)}MFm(){return document.getElementById("FilePickerDiv")}JN(){}Nga(){}}Object(f.a)(vm,"PickerDialog",a.a,[1024]);class Lj{constructor(ea,Xa,yb,Ub,yc,ad,md){this.Aa=ea;this.JRe=yb;this.ga=Xa;this.YOc=Ub;this.SDb=yc;this.KMc=ad;this.Ypk=md}Xb(){const ea=this.SDb.kkc();ea?
fb.a.Wfa||this.Aa.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.ga.fb(x.a.dwc,z.a.frame,Object(O.a)(this,this.uJj,"saveToSharePointActionDispatcher"),64):(ea.Uab.continueWith(Xa=>{Xa.Yi&&this.SDb.Geg(Xa)}),this.WTd()):va.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}WTd(){ld.a.ate(Object(O.a)(this,this.uJj,"saveToSharePointActionDispatcher"));ld.a.m_c([new Kj.a(x.a.dwc,z.a.frame,0)],this.SDb.kkc())}get epc(){return this.Aa.$("SaveToAnotherFolderBrsIsEnabled")}get h_h(){return this.Aa.$("UserCanWriteRelative")}uJj(ea,
Xa,yb,Ub,yc){return Xa.contextId!==z.a.frame||ea!==x.a.dwc?2:this.epc&&(this.KMc.Zoj||this.h_h)?1===yb?xg.SessionStatusManager.instance.Jk||m.AFrameworkApplication.eta?8:this.Ypk()?32:8:2===yb?(va.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(yc&&yc.SaveEntryPoint&&"VersionHistory"===yc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.h_h?(va.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.JRe.create(yc).jJa(null)):(va.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.YOc.start(null,yc)),32):8:8}}Object(f.a)(Lj,"SaveToSharePointActor",null,[]);class wm{constructor(ea,Xa,yb,Ub){this.Ah=this.Bvh=null;this.yJb=ea;this.qJ=Xa;this.KMc=yb;this.Nj=Ub}start(ea,Xa){va.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Bvh=ea;this.Ah=Xa;this.KMc.start((yb,Ub)=>{this.processResponse(yb,Ub)})||this.hCg()}processResponse(ea,Xa){if(ea)this.zE(Xa);else this.onFailure(Xa)}hCg(){1!==
this.Nj.state&&this.qJ().hxf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}zE(ea){va.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(ea&&ea.data&&ea.data.value&&ea.data.value.length&&ea.data.value[0].sharePoint){const Xa=ea.data.value[0].sharePoint.url;ea=ea.data.value[0].sharePoint.listUrl;let yb=null;if(Xa&&(yb=ea?this.rLm(ea):this.qLm(Xa))){this.yJb.cEa(Xa,this.Bvh,yb,this.Ah);return}va.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Xa,!yb)}va.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.hCg()}qLm(ea){ea.endsWith("/")||(ea+="/");let Xa=0;for(let yb=0;yb<ea.length;yb++)if("/"===ea.charAt(yb)&&5===++Xa)return ea.substr(0,yb);return null}rLm(ea){ea.endsWith("/")&&(ea=ea.substring(0,ea.length-1));const Xa=ea.lastIndexOf("/");return-1!==Xa?ea.substring(0,Xa):null}onFailure(ea){va.ULS.sendTraceTag(23881888,
216,10,"Picker failure Callback called.");ea&&ea.error?va.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",ea.error.errorCode,ea.error.message):va.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.hCg()}}Object(f.a)(wm,"SaveToSharePointManager",null,[1023]);class aj{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){this.nqa=ea;this.xQ=Xa;this.M6b=Ub;this.x4e=ad;this.HQa=yb;this.mOk=yc;this.x2a=md;this.Ah=Sd}execute(ea,Xa){if(!m.AFrameworkApplication.Yl&&
m.AFrameworkApplication.Fe){var yb=this.nqa+this.x2a;yb=Gb.a.lq(yb,"fu",La.a.$i(this.HQa));yb=Gb.a.lq(yb,"su",La.a.$i(this.mOk));yb=Gb.a.lq(yb,"fn",La.a.$i(this.xQ));yb=Gb.a.lq(yb,"n",La.a.$i((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(yb=Gb.a.lq(yb,"furl",La.a.$i(this.Ah.FileDownloadUrl)));yb=yb+"&"+this.x4e;this.M6b&&this.M6b.length?yb=Gb.a.lq(yb,"fnn",La.a.$i(this.M6b)):va.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");va.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");m.AFrameworkApplication.Fe.Xj(yb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,ea,Xa,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(aj,"SharePointSaveAsCaller",null,[1055]);class sl{constructor(ea){this.PJb=ea.appSettings.SaveAsToHostWebServiceBase;this.xQ=ea.appSettings.FileName;this.x2a=ea.jb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(ea,Xa,yb,Ub){return new aj(this.PJb,this.xQ,ea,Xa,yb,m.AFrameworkApplication.rm,
this.x2a,Ub)}}Object(f.a)(sl,"SharePointUploadCallerFactory",null,[1022]);var yi=d(1277);class Dk{constructor(ea,Xa,yb,Ub,yc){this.tl=this.mEc=null;this.NJe=!1;this.A6e=this.HQa=null;this.lbf=Xa;this.T3a=yb;this.qJ=Ub;this.Nj=yc;this.ga=ea}cEa(ea,Xa,yb,Ub){this.NJe=!1;va.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.neb();this.HQa=ea;Ub&&Ub.SaveEntryPoint&&(this.A6e=Ub.SaveEntryPoint);this.mEc=this.lbf.create(ea,Xa,yb,Ub);Ub&&"true"===Ub.SkipSaveToHost?
this.Xka():this.Pcm()}Pcm(){const ea=()=>{va.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.Xka()};32!==this.ga.Qb(x.a.YZb,2,[()=>{va.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.Xka()},ea])&&ea()}Xka(){va.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.mEc.execute(Object(O.a)(this,this.F3n,"onSaveToSharePointUploadFinished"),Object(O.a)(this,this.E3n,
"onSaveToSharePointUploadFailed"))}F3n(ea){if(ea&&ea.data&&ea.data.Pe){var Xa;if(({av:Xa}=Wa.d(ea.data.Pe)).returnValue)if(Xa.StatusCode!==qk.a.qz&&Xa.StatusCode!==qk.a.Gfc)va.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",ea.data.status,Xa.StatusCode),Xa.StatusCode!==qk.a.Qsg&&this.$gi(ea.data.status)||(this.LZa(Xa.StatusCode.toString()),this.a8o(Xa.StatusCode));else{va.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.Lsg();try{Xa.NewDocumentUrl?this.SYb(Xa.NewDocumentUrl):this.TYb()}catch(yb){va.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",yb.toString())}}else va.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:tc.a.csd(ea.data.Pe)}),this.D_d()||(this.LZa("Failed to deserialize response"),this.Bpd())}else va.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.D_d()||(this.LZa("Unknown"),this.Bpd())}E3n(ea){ea&&ea.data?this.$gi(ea.data.status)||
(va.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.LZa(yi.a[ea.data.status]),this.Bpd()):(va.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.D_d()||(this.LZa("Unknown"),this.Bpd()))}D_d(){if(!this.NJe)return va.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.NJe=!0,this.Xka(),!0;va.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}$gi(ea){va.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
ea);return this.D_d()}TYb(){va.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");la.a.Tm(this.HQa,la.a.Vva(3),void 0,"UploadToSharePointManager.RedirectToFolder")}SYb(ea){let Xa=!1,yb=!1;m.AFrameworkApplication.J&&(Xa=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),yb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));va.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",ea,Xa);if(Xa&&yb){va.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Ub={};Ub[Bb.a.Quc]="1";Ub[Bb.a.documentUrl]=ea;Ub[Bb.a.reason]=zc.a.hvg;m.AFrameworkApplication.nN().execute(yc=>{yc.sendMessage(Pb.a.SNb,Ub)})}else la.a.Tm(ea,la.a.Vva(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}neb(){this.Nj&&1===this.Nj.state||(this.tl=this.T3a(),this.tl.message=CommonUIStrings.l_CommentProgressTooltip,this.tl.Bd=5,this.tl.Au=!1,this.tl.aM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Hra(){this.tl&&(this.tl.close(),this.tl=null)}Bpd(){this.qq(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}Z8o(){this.qq(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}g8o(){const ea=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.qq(CommonUIStrings.l_SaveAsFileTooLargeTitle,ea,hg.a.ELo)}qq(ea,Xa,yb=hg.a.ILo){va.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",ea,Xa);this.Hra();1!==this.Nj.state&&this.qJ().ugi(ea,Xa,yb)}a8o(ea){va.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
ea);switch(ea){case qk.a.ODe:this.Z8o();break;case qk.a.Qsg:this.g8o();break;default:this.Bpd()}}Lsg(){"VersionHistory"===this.A6e&&this.ga.Ob(x.a.lld,2)}LZa(ea){"VersionHistory"===this.A6e&&this.ga.Qb(x.a.oue,2,{["FailureReason"]:ea})}}Object(f.a)(Dk,"UploadToSharePointManager",null,[1021]);var fi=d(546),Dg=d(138);class yk{constructor(){this.Qkb=this.m0e=this.d0e=this.Z=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}wc(ea){this.Z=ea;this.d0e=fi.a.sq(ea.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.m0e=fi.a.sq(ea.Ta("Common.IEventEmitter<Common.IMruResult>"));this.Qkb=fi.a.sq(ea.Ta("Common.App.SharedFilePicker.ISharedFilePicker"));Dg.Task.WAA.call(null,this.d0e,this.m0e,this.Qkb).continueWith(()=>{this.Pto()})}Pto(){this.Z.register(sl,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ud(()=>new sl(m.AFrameworkApplication.J)).ha();this.Z.register(Dk,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ud(()=>
new Dk(m.AFrameworkApplication.va,this.Z.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Wi.a).create(),()=>new bk,m.AFrameworkApplication.ua)).ha();this.Z.register(wm,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ud(()=>new wm(this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new bk,this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),m.AFrameworkApplication.ua)).ha();
this.Z.register(rl,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ud(()=>new rl(this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new nc.a(()=>this.d0e.result),m.AFrameworkApplication.ua,()=>new vm)).ha();this.Z.register(io,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ud(()=>new io(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Gb,
this.Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Z.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new nc.a(()=>this.m0e.result),this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Qkb?this.Qkb.result:null)).ha();this.Z.register(Lj,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ud(()=>new Lj(m.AFrameworkApplication.J,m.AFrameworkApplication.va,this.Z.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>m.AFrameworkApplication.ua.Wll)).ha();m.AFrameworkApplication.J.$("SaveToAnotherFolderBrsIsEnabled")&&this.Z.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Xb()}static main(){K.a.instance.Mc(new yk)}}Object(f.a)(yk,"PackageManager",null,[0,1]);class Ym{}Object(f.a)(Ym,
"StringDifference",null,[1028]);class we{constructor(ea,Xa){this.charCode=ea;this.description=Xa}}Object(f.a)(we,"UBTableEntry",null,[]);class ri{}new we(8,"C0 Controls 1");new we(9,"Horizontal tab (HT)");new we(10,"Line feed (LF)");new we(12,"C0 Controls 2");new we(13,"Carriage return (CR)");new we(31,"C0 Controls 3");new we(32,"Space");new we(47,"ASCII Punctuation and Symbols 1");new we(57,"ASCII Digits");new we(64,"ASCII Punctuation and Symbols 2");new we(90,"Uppercase Latin Alphabet");new we(96,
"ASCII Punctuation and Symbols 3");new we(122,"Lowercase Latin Alphabet");new we(127,"U+0000..U+007F Basic Latin");new we(159,"C1 Controls");new we(160,"NB Space");new we(191,"Latin-1 Punctuation and Symbols");new we(255,"U+0080..U+00FF Latin-1 Supplement");new we(383,"U+0100..U+017F Latin Extended-A");new we(591,"U+0180..U+024F Latin Extended-B");new we(687,"U+0250..U+02AF IPA Extensions");new we(767,"U+02B0..U+02FF Spacing Modifier Letters");new we(879,"U+0300..U+036F Combining Diacritical Marks");
new we(1023,"U+0370..U+03FF Greek and Coptic");new we(1279,"U+0400..U+04FF Cyrillic");new we(1327,"U+0500..U+052F Cyrillic Supplement");new we(1423,"U+0530..U+058F Armenian");new we(1535,"U+0590..U+05FF Hebrew");new we(1791,"U+0600..U+06FF Arabic");new we(1871,"U+0700..U+074F Syriac");new we(1919,"U+0750..U+077F Arabic Supplement");new we(1983,"U+0780..U+07BF Thaana");new we(2047,"U+07C0..U+07FF NKo");new we(2111,"U+0800..U+083F Samaritan");new we(2143,"U+0840..U+085F Mandaic");new we(2303,"U+08A0..U+08FF Arabic Extended-A");
new we(2431,"U+0900..U+097F Devanagari");new we(2559,"U+0980..U+09FF Bengali");new we(2687,"U+0A00..U+0A7F Gurmukhi");new we(2815,"U+0A80..U+0AFF Gujarati");new we(2943,"U+0B00..U+0B7F Oriya");new we(3071,"U+0B80..U+0BFF Tamil");new we(3199,"U+0C00..U+0C7F Telugu");new we(3327,"U+0C80..U+0CFF Kannada");new we(3455,"U+0D00..U+0D7F Malayalam");new we(3583,"U+0D80..U+0DFF Sinhala");new we(3711,"U+0E00..U+0E7F Thai");new we(3839,"U+0E80..U+0EFF Lao");new we(4095,"U+0F00..U+0FFF Tibetan");new we(4255,
"U+1000..U+109F Myanmar");new we(4351,"U+10A0..U+10FF Georgian");new we(4607,"U+1100..U+11FF Hangul Jamo");new we(4991,"U+1200..U+137F Ethiopic");new we(5023,"U+1380..U+139F Ethiopic Supplement");new we(5119,"U+13A0..U+13FF Cherokee");new we(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new we(5791,"U+1680..U+169F Ogham");new we(5887,"U+16A0..U+16FF Runic");new we(5919,"U+1700..U+171F Tagalog");new we(5951,"U+1720..U+173F Hanunoo");new we(5983,"U+1740..U+175F Buhid");new we(6015,"U+1760..U+177F Tagbanwa");
new we(6143,"U+1780..U+17FF Khmer");new we(6319,"U+1800..U+18AF Mongolian");new we(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new we(6479,"U+1900..U+194F Limbu");new we(6527,"U+1950..U+197F Tai Le");new we(6623,"U+1980..U+19DF New Tai Lue");new we(6655,"U+19E0..U+19FF Khmer Symbols");new we(6687,"U+1A00..U+1A1F Buginese");new we(6831,"U+1A20..U+1AAF Tai Tham");new we(7039,"U+1B00..U+1B7F Balinese");new we(7103,"U+1B80..U+1BBF Sundanese");new we(7167,"U+1BC0..U+1BFF Batak");
new we(7247,"U+1C00..U+1C4F Lepcha");new we(7295,"U+1C50..U+1C7F Ol Chiki");new we(7375,"U+1CC0..U+1CCF Sundanese Supplement");new we(7423,"U+1CD0..U+1CFF Vedic Extensions");new we(7551,"U+1D00..U+1D7F Phonetic Extensions");new we(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new we(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new we(7935,"U+1E00..U+1EFF Latin Extended Additional");new we(8191,"U+1F00..U+1FFF Greek Extended");new we(8303,"U+2000..U+206F General Punctuation");
new we(8351,"U+2070..U+209F Superscripts and Subscripts");new we(8399,"U+20A0..U+20CF Currency Symbols");new we(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new we(8527,"U+2100..U+214F Letterlike Symbols");new we(8591,"U+2150..U+218F Number Forms");new we(8703,"U+2190..U+21FF Arrows");new we(8959,"U+2200..U+22FF Mathematical Operators");new we(9215,"U+2300..U+23FF Miscellaneous Technical");new we(9279,"U+2400..U+243F Control Pictures");new we(9311,"U+2440..U+245F Optical Character Recognition");
new we(9471,"U+2460..U+24FF Enclosed Alphanumerics");new we(9599,"U+2500..U+257F Box Drawing");new we(9631,"U+2580..U+259F Block Elements");new we(9727,"U+25A0..U+25FF Geometric Shapes");new we(9983,"U+2600..U+26FF Miscellaneous Symbols");new we(10175,"U+2700..U+27BF Dingbats");new we(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new we(10239,"U+27F0..U+27FF Supplemental Arrows-A");new we(10495,"U+2800..U+28FF Braille Patterns");new we(10623,"U+2900..U+297F Supplemental Arrows-B");
new we(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new we(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new we(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new we(11359,"U+2C00..U+2C5F Glagolitic");new we(11391,"U+2C60..U+2C7F Latin Extended-C");new we(11519,"U+2C80..U+2CFF Coptic");new we(11567,"U+2D00..U+2D2F Georgian Supplement");new we(11647,"U+2D30..U+2D7F Tifinagh");new we(11743,"U+2D80..U+2DDF Ethiopic Extended");new we(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new we(11903,"U+2E00..U+2E7F Supplemental Punctuation");new we(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new we(12255,"U+2F00..U+2FDF Kangxi Radicals");new we(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new we(12351,"U+3000..U+303F CJK Symbols and Punctuation");new we(12447,"U+3040..U+309F Hiragana");new we(12543,"U+30A0..U+30FF Katakana");new we(12591,"U+3100..U+312F Bopomofo");new we(12687,"U+3130..U+318F Hangul Compatibility Jamo");new we(12703,"U+3190..U+319F Kanbun");new we(12735,
"U+31A0..U+31BF Bopomofo Extended");new we(12783,"U+31C0..U+31EF CJK Strokes");new we(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new we(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new we(13311,"U+3300..U+33FF CJK Compatibility");new we(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new we(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new we(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new we(42127,"U+A000..U+A48F Yi Syllables");new we(42191,"U+A490..U+A4CF Yi Radicals");
new we(42239,"U+A4D0..U+A4FF Lisu");new we(42559,"U+A500..U+A63F Vai");new we(42655,"U+A640..U+A69F Cyrillic Extended-B");new we(42751,"U+A6A0..U+A6FF Bamum");new we(42783,"U+A700..U+A71F Modifier Tone Letters");new we(43007,"U+A720..U+A7FF Latin Extended-D");new we(43055,"U+A800..U+A82F Syloti Nagri");new we(43071,"U+A830..U+A83F Common Indic Number Forms");new we(43135,"U+A840..U+A87F Phags-pa");new we(43231,"U+A880..U+A8DF Saurashtra");new we(43263,"U+A8E0..U+A8FF Devanagari Extended");new we(43311,
"U+A900..U+A92F Kayah Li");new we(43359,"U+A930..U+A95F Rejang");new we(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new we(43487,"U+A980..U+A9DF Javanese");new we(43615,"U+AA00..U+AA5F Cham");new we(43647,"U+AA60..U+AA7F Myanmar Extended-A");new we(43743,"U+AA80..U+AADF Tai Viet");new we(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new we(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new we(44031,"U+ABC0..U+ABFF Meetei Mayek");new we(55215,"U+AC00..U+D7AF Hangul Syllables");new we(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new we(56191,"U+D800..U+DB7F High Surrogates");new we(56319,"U+DB80..U+DBFF High Private Use Surrogates");new we(57343,"U+DC00..U+DFFF Low Surrogates");new we(63743,"U+E000..U+F8FF Private Use Area");new we(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new we(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new we(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new we(65039,"U+FE00..U+FE0F Variation Selectors");new we(65055,"U+FE10..U+FE1F Vertical Forms");new we(65071,"U+FE20..U+FE2F Combining Half Marks");
new we(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new we(65135,"U+FE50..U+FE6F Small Form Variants");new we(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new we(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new we(65535,"U+FFF0..U+FFFF Specials");new we(65663,"U+10000..U+1007F Linear B Syllabary");new we(65791,"U+10080..U+100FF Linear B Ideograms");new we(65855,"U+10100..U+1013F Aegean Numbers");new we(65935,"U+10140..U+1018F Ancient Greek Numbers");new we(65999,"U+10190..U+101CF Ancient Symbols");
new we(66047,"U+101D0..U+101FF Phaistos Disc");new we(66207,"U+10280..U+1029F Lycian");new we(66271,"U+102A0..U+102DF Carian");new we(66351,"U+10300..U+1032F Old Italic");new we(66383,"U+10330..U+1034F Gothic");new we(66463,"U+10380..U+1039F Ugaritic");new we(66527,"U+103A0..U+103DF Old Persian");new we(66639,"U+10400..U+1044F Deseret");new we(66687,"U+10450..U+1047F Shavian");new we(66735,"U+10480..U+104AF Osmanya");new we(67647,"U+10800..U+1083F Cypriot Syllabary");new we(67679,"U+10840..U+1085F Imperial Aramaic");
new we(67871,"U+10900..U+1091F Phoenician");new we(67903,"U+10920..U+1093F Lydian");new we(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new we(68095,"U+109A0..U+109FF Meoritic Cursive");new we(68191,"U+10A00..U+10A5F Kharoshthi");new we(68223,"U+10A60..U+10A7F Old South Arabian");new we(68415,"U+10B00..U+10B3F Avestan");new we(68447,"U+10B40..U+10B5F Inscriptional Parthian");new we(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new we(68687,"U+10C00..U+10C4F Old Turkic");new we(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new we(69759,"U+11000..U+1107F Brahmi");new we(69839,"U+11080..U+110CF Kaithi");new we(69887,"U+110D0..U+110FF Sora Sompeng");new we(69967,"U+11100..U+1114F Chakma");new we(70111,"U+11180..U+111DF Sharada");new we(71375,"U+11680..U+116CF Takri");new we(74751,"U+12000..U+123FF Cuneiform");new we(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new we(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new we(92735,"U+16800..U+16A3F Bamum Supplement");new we(94111,"U+16F00..U+16F9F Miao");new we(110847,
"U+1B000..U+1B0FF Kana Supplement");new we(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new we(119295,"U+1D100..U+1D1FF Musical Symbols");new we(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new we(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new we(119679,"U+1D360..U+1D37F Counting Rod Numerals");new we(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new we(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new we(127023,"U+1F000..U+1F02F Mahjong Tiles");
new we(127135,"U+1F030..U+1F09F Domino Tiles");new we(127231,"U+1F0A0..U+1F0FF Playing Cards");new we(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new we(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new we(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new we(128591,"U+1F600..U+1F64F Emoticons");new we(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new we(128895,"U+1F700..U+1F77F Alchemical Symbols");new we(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new we(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new we(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new we(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new we(917631,"U+E0000..U+E007F Tags");new we(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new we(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new we(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(ri,"UnicodeBlocks",null,[882]);class Tj{constructor(){this.Z=
null}wc(ea){this.Z=ea;this.Z.register(Ym,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();this.Z.register(ri,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.Z.resolve("Common.App.SensitiveLogging.IStringDifference");this.Z.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){K.a.instance.Mc(new Tj)}}Object(f.a)(Tj,
"SensitiveLoggingPackage",null,[0,1]);var vf;(function(ea){ea[ea.Qdq=0]="myFiles";ea[ea.recent=1]="recent";ea[ea.mYp=2]="currentFolder";ea[ea.nsq=3]="yourPhone"})(vf||(vf={}));Object(f.b)("SharedFilePickerLandingLocation",vf);class ff{constructor(ea){this.NRb=this.iuc=null;this._initialized=!1;this.ySf=ea}s_c(ea){this._initialized||(ea.Bv(Pb.a.Ryj),ea.LE(Pb.a.Ryj,Object(O.a)(this,this.A2n,"onReceivedPickerResponse")),this._initialized=!0)}Q2c(ea){return this.NRb=new Promise((Xa,yb)=>{const Ub={};
Ub[Bb.a.hco]=ea;this.iuc=(yc,ad)=>{""===ad?(va.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Xa(yc)):("Canceled"===ad?va.ULS.sendTraceTag(572548164,306,50,ad):va.ULS.sendTraceTag(556901065,306,10,ad),yb(ad))};this.ySf.execute(yc=>{this.s_c(yc);yc.sendMessage(Pb.a.e7n,Ub)})})}A2n(ea){this.iuc(ea.Values[Bb.a.TOo],void 0===ea.Values[Bb.a.vjg]||null===ea.Values[Bb.a.vjg]?"":ea.Values[Bb.a.vjg])}Q_f(){return m.AFrameworkApplication.J.$("UiHostCommonFilePicker")}fYd(ea,Xa,yb,Ub,
yc,ad,md,Sd,ze=null){const Ne={};Ne[Bb.a.tOo]=ea;Ne[Bb.a.titleText]=Xa;Ne[Bb.a.g5k]=yb;Ne[Bb.a.h5k]=Ub;Ne[Bb.a.j5k]=yc;Ne[Bb.a.SVl]=!0;Ne[Bb.a.C7l]=ad;Ne[Bb.a.lco]=md;Ne[Bb.a.kco]=vf[Sd];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ne[Bb.a.mco]="Dark");ze&&(null!=ze.Jcc&&(Ne[Bb.a.Jcc]=ze.Jcc),null!=ze.rmc&&(Ne[Bb.a.rmc]=ze.rmc));return Ne}}Object(f.a)(ff,"SharedFilePickerManager",null,[881]);class Kf{constructor(){this.Z=null}get name(){return"Common.App.SharedFilePicker"}wc(ea){this.Z=
ea;ea.register(ff,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().Ud(()=>new ff(ea.Ta("Postmessage.IHostPostmessenger")))}init(){m.AFrameworkApplication.J.vp(()=>{this.g$a()})}g$a(){this.Z.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){K.a.instance.Mc(new Kf)}}Object(f.a)(Kf,"SharedFilePickerPackage",null,[0,1]);class Rg extends Sys.EventArgs{constructor(){super()}}Object(f.a)(Rg,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class ob{}Object(f.a)(ob,"TypingSpeedMeterWindow",null,[]);class Nb{constructor(ea,Xa){new U.a;this.Kle=()=>{};this.nB=ea;this.tk=Xa;this.tk.mff(this.Kle)}dispose(){this.tk.GDj(this.Kle)}}Object(f.a)(Nb,"TypingSpeedMeter",null,[1057]);class cc{constructor(ea){this.MOd=null;this.Mq=new v.a;this.nB=ea}initialize(ea,Xa,yb,Ub){this.MOd||(this.MOd=new Nb(this.nB,ea,Xa,yb,Ub),this.Mq.gg(this.MOd));return this.MOd}}Object(f.a)(cc,"TypingSpeedMeterProvider",null,[1029]);class Lc{constructor(){this.Gaf=
null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(m.AFrameworkApplication.J.$("TypingSpeedMeterIsEnabled")){const ea=Fa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),Xa=fi.a.sq(Fa.a.instance.Ta("Common.ICpuMeterProvider"));Xa.continueWith(()=>{const yb=Xa.result.Mq.task;var Ub=new Ra.a(m.AFrameworkApplication.J.jc("TypingSpeedMeterWindowSamplingPercent",0)/100);Ub=new Oa.a(Object(O.a)(Ub,Ub.h0b,"shouldBeInSample"));const yc=Ja.a.dH(12,1,Ub),ad=m.AFrameworkApplication.J.jc("TypingSpeedMeterWindowTimeoutMs",
5E3),md=m.AFrameworkApplication.J.jc("TypingSpeedMeterMaxKeystrokesPerWindow",5);yb.CWR(()=>this.Gaf=ea.initialize(yb.result,yc,ad,md))})}}dispose(){this.Gaf&&this.Gaf.dispose()}wc(ea){ea.register(cc,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().Ud(()=>new cc(la.a.Je))}static main(){K.a.instance.Mc(new Lc)}}Object(f.a)(Lc,"TypingSpeedMeterPackage",null,[0,1]);class Uc{constructor(){this.events=[];this.Osg=!1}static F1f(ea){return ea.ctrlKey&&"Control"!==
ea.key||ea.altKey&&"Alt"!==ea.key||!!Uc.oxn[ea.key]}static chl(ea,Xa){let yb;yb=Uc.F1f(ea)?ea.key:" "===ea.key?"Space":"CharacterKey";return null!=Xa?(Xa.altPressed=(!!ea.altKey).toString(),Xa.ctrlPressed=(!!ea.ctrlKey).toString(),Xa.key=yb,Xa.repeat=(!!ea.repeat).toString(),Xa.shiftPressed=(!!ea.shiftKey).toString(),Xa):{["altPressed"]:(!!ea.altKey).toString(),["ctrlPressed"]:(!!ea.ctrlKey).toString(),["key"]:yb,["repeat"]:(!!ea.repeat).toString(),["shiftPressed"]:(!!ea.shiftKey).toString()}}static k0i(ea){return window.performance&&
window.performance.now&&ea.timeStamp<performance.now()}static nli(ea){return!!ea&&Uc.k0i(ea)&&Uc.F1f(ea)}static oli(ea){return!!ea&&Uc.k0i(ea)&&!Uc.F1f(ea)}keyPressedEventHandlerStart(ea,Xa){Uc.oli(ea)&&this.JXj(ea,Xa)}keyPressedEventHandlerEnd(ea){Uc.oli(ea)&&this.oYj(ea)}keyDownEventHandlerStart(ea,Xa){Uc.nli(ea)&&this.JXj(ea,Xa)}keyDownEventHandlerEnd(ea){Uc.nli(ea)&&this.oYj(ea)}JXj(ea,Xa){ea={["metadata"]:Uc.chl(ea,Xa),["timeStamp"]:this.nAc(ea.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.nAc(performance.now()-
ea.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(ea);this.axo()}oYj(ea){if(0!==this.events.length){var Xa=this.nAc(ea.timeStamp);for(let yb=this.events.length-1;0<=yb;--yb){const Ub=this.events[yb];if(Ub.timeStamp===Xa){Ub.timeToHandlerFinishMs=this.nAc(performance.now()-ea.timeStamp);Ub.eventDurationMs=this.nAc(Ub.timeToHandlerFinishMs-Ub.timeToHandlerStartMs);break}}}}nAc(ea){return Number(ea.toFixed(2))}axo(){if(!this.Osg){const ea=document.createEvent("CustomEvent");
ea.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(ea);requestAnimationFrame(()=>{this.Osg=!1;const Xa=performance.now();this.events.forEach(Ub=>{Ub.timeToRequestAnimationFrameMs=this.nAc(Xa-Ub.timeStamp)});var yb=document.createEvent("CustomEvent");yb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(yb);this.events=[];yb=document.createEvent("CustomEvent");yb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(yb)});this.Osg=
!0}}}Uc.oxn={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class sd{constructor(){this.pue=this.nbb=this.BXa=this.erc=null;this.Stb=!1;this.pvc=null;this.k1c=[];this.Usd=()=>{sd.xpn()&&null==this.nbb?(this.BXa=null,this.nbb=requestAnimationFrame(this.bdd)):null!=this.nbb&&(cancelAnimationFrame(this.nbb),this.nbb=null)};this.bdd=ea=>{if(null!=this.BXa){const Xa=
ea-this.BXa;if(null==this.erc||this.erc<Xa)this.erc=Xa;for(let yb=0;yb<sd.ranges.length;++yb)if(Xa<sd.ranges[yb]){++this.k1c[yb];break}}this.BXa=ea;this.nbb=requestAnimationFrame(this.bdd)};this.kFj=()=>{if(null!=this.erc){var ea={};for(var Xa=0;Xa<sd.ranges.length;++Xa)ea[sd.ranges[Xa]]=this.k1c[Xa],this.k1c[Xa]=0;Xa=performance.now();ea={["intervalStart"]:this.pvc,["intervalEnd"]:Xa,["maxFrameLengthMs"]:this.erc,["frameData"]:ea};var yb=document.createEvent("CustomEvent");yb.initCustomEvent("reportframetiming",
!1,!1,ea);dispatchEvent(yb);this.erc=null;this.pvc=Xa}}}static SZf(){return!!window.performance&&!!window.performance.now}start(ea){!this.Stb&&sd.SZf()&&(this.c1o(),this.pue=setInterval(this.kFj,1E3*ea),this.pvc=performance.now(),this.Usd(),document.addEventListener("visibilitychange",this.Usd),this.Stb=!0)}stop(){this.Stb&&(document.removeEventListener("visibilitychange",this.Usd),null!=this.pue&&(clearInterval(this.pue),this.pue=null),null!=this.nbb&&(cancelAnimationFrame(this.nbb),this.nbb=null),
this.kFj(),this.Stb=!1)}get lab(){return this.Stb}c1o(){this.k1c=[];for(let ea=0;ea<sd.ranges.length;++ea)this.k1c.push(0)}}sd.xpn=()=>"visible"===document.visibilityState;sd.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class id{create(ea){return new Ra.a(ea)}}Object(f.a)(id,"RandomSamplerFactory",null,[1772]);var Ld=d(20),ne=d(66);class kf{constructor(ea,Xa,yb,Ub,yc){ea.mRd(()=>{Ub.cld()});ea.zff((ad,md)=>{Ub.$kd(md.revisionId,md.Nbb)});ea.pRd((ad,md)=>{Ub.x5m(md.bCa,
md.Nbb,md.M0j)});ea.K1k(()=>{Ub.Csg()});Xa.n2k((ad,md)=>{Ub.wlp(md.VEj,md.nCe,md.actualValue)});Xa.V0k((ad,md)=>{Ub.vlp(md.VEj,md.nCe,md.actualValue)});yc.lRd(()=>{Ub.xsd()});yb.AO((ad,md)=>{6===md.type&&Ub.Xvc(md.jA)})}}Object(f.a)(kf,"EventForwarder",null,[]);class vg{constructor(ea,Xa,yb){this.YFk=ea;this.RY=yb;this.Oac=Xa}create(ea,Xa){return new kf(this.YFk,this.Oac,ea,Xa,this.RY)}}Object(f.a)(vg,"EventForwarderFactory",null,[]);var Sh=d(347);class Ei{}Ei.qsp="TypingToOutboundReplicationStart";
Ei.Q7n="OutboundReplicationStartToOutboundReplicationEnd";Ei.rIj="RtcNotificationToInboundReplicationEnd";Ei.L4j="TypingToInboundReplicationEnd";Object(f.a)(Ei,"PerfTrackerPhases",null,[]);class pj{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze=null){this.xth=!1;this.W0e=5;this.Nuh=50;this.D_e=20;this.mZe=this.m_e=this.TEa=null;this.AFc=this.oFc=0;this.R8e=this.$9e=!1;this.NNd=Array(7);this.QCc=null;this.rkh=!1;this.dMe=null;this.Qma={};this.nDd=ea;this.N1a=Xa;this.zEk=yb;this.omh=Ub.create(Ei.rIj,yc,ad,
20,!1);this.NOd=Ub.create(Ei.L4j,md,Sd,20,!0);if(this.Aa=m.AFrameworkApplication.J)this.xth=this.Aa.$("LogSteppedInboundFrameIsEnabled"),this.D_e=this.Aa.jc("InboundFrameMaxNumberOfLongRunningTasks",20),this.Nuh=this.Aa.jc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.W0e=this.Aa.jc("InboundFrameNumberOfLastShortTasks",5);this.zCb=ze}get Hpl(){null==this.dMe&&(this.dMe=!!this.Aa&&this.Aa.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.dMe}initialize(ea){this.TEa=
ea}hFo(ea,Xa,yb=null){this.c2h();va.ULS.shipAssertTag(8229761,324,0<ea.length);let Ub=!1;for(const ad of ea){const md=ad.toString();if(md in this.Qma){var yc=this.Qma[md];if(!yc.Awc){yc.bMj(ea,Xa,yb);if(Ub)this.U$i(ad.toString(),yc,null,null,this.NNd,null);else{const Sd=this.H5l(),ze=this.Jfm(this.QCc);Ub=!0;this.U$i(ad.toString(),yc,Sd,this.mZe,this.NNd,ze)}delete this.Qma[md]}}else yc=this.nDd.create(this.omh,this.NOd),yc.bMj(ea,Xa),this.Qma[md]=yc}this.R8e=!1}Xvc(ea){va.ULS.shipAssertTag(8257930,
304,ea.M3i,"Expected data not sent on the wire");if(ea.M3i){if(ea.Xue in this.Qma){var Xa=this.Qma[ea.Xue];Xa.jve||(Xa.Xvc(ea.revisionId,ea.Vpj,ea.dTj,ea.Nbb),delete this.Qma[ea.Xue])}else Xa=this.nDd.create(this.omh,this.NOd),Xa.Xvc(ea.revisionId,ea.Vpj,ea.dTj,ea.Nbb),this.Qma[ea.Xue]=Xa;this.c2h()}}l7m(){this.$9e||(this.m_e=Array(this.D_e),this.mZe=Array(this.W0e),this.AFc=this.oFc=0,this.NNd=[0,0,0,0,0,0,0,0],this.QCc=Array(3),this.QCc[1]=[0,0],this.QCc[2]=[0,0],this.$9e=!0)}i5o(ea){return!ea.TP&&
ea.TN===da.a.PEj&&(ea=Sh.a(this.Qma))&&ea[0]?!0:!1}fYn(ea){this.$9e=!1;const Xa=Sh.a(this.Qma);Xa&&Xa[0]&&(ea.TRT>=this.Nuh&&this.oFc<this.D_e?this.m_e[this.oFc++]=ea:(this.mZe[this.AFc]=ea,this.AFc=this.AFc<this.W0e-1?this.AFc+1:0),this.mHn(ea),this.CHn(ea))}eYn(){this.l7m();this.R8e=!0}mHn(ea){this.NNd[ea.TP]++}CHn(ea){if(ea&&ea.UI){const Xa=this.QCc[ea.UI];Xa[0]+=1;Xa[1]+=ea.TRT}}Jfm(ea){const Xa={};ea&&(ea[1]&&(Xa.Typing=ea[1]),ea[2]&&(Xa.Clicking=ea[2]));return Xa}H5l(){return this.oFc?this.m_e.slice(0,
this.oFc-1):null}c2h(){var ea=Sh.a(this.Qma);if(ea&&(this.rkh||this.YHn(ea),ea.length>this.zEk))for(const Xa of ea){ea=this.Qma[Xa];const yb=ea.createdTime,Ub=this.N1a();6E4<Ub-yb&&(R.b(8438528,304,50,"{0}",{["Not Received"]:ea.Awc?"RtcNotification":"ServerRevision",["Duration"]:Ub-yb}),ea.Awc||R.b(42075798,304,15,"{0}",{["RevisionId"]:Xa,["Duration"]:Ub-yb}),delete this.Qma[Xa])}}YHn(ea){if(this.Hpl&&this.zCb)for(const Xa of ea)if(ea=this.Qma[Xa],ea.jve&&!ea.Awc&&(ea=ea.createdTime,2E3<this.N1a()-
ea)){let yb=null;Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().kb&&Ld.StaticActiveAppFrame.za().kb.hd&&(yb=Ld.StaticActiveAppFrame.za().kb.hd.Ag);this.zCb.execute(Ub=>{Ub.flush(yb,1)});this.rkh=!0}}U$i(ea,Xa,yb,Ub,yc,ad){this.xth&&(Xa=Xa.wfm())&&(Xa.RevisionId=ea,Xa.LRTWR=yb,Xa.LSTWR=Ub,Xa.TSD=yc,Xa.UIWR=ad,this.TEa&&this.TEa.track(Xa))}}Object(f.a)(pj,"InboundMonitor",null,[1060]);class Ed{constructor(ea,Xa,yb,Ub){this.gF=Xa;this.nDd=yb;this.GQk=Ub}create(ea,Xa,yb,Ub,yc=null){return new pj(this.nDd,
this.gF,50,this.GQk,ea,Xa,yb,Ub,yc)}}Object(f.a)(Ed,"InboundMonitorFactory",null,[1032]);var ni=d(380);class Ee{}Ee.jFe="UserCount";Ee.zJo="RevisionChainLength";Object(f.a)(Ee,"PerfTrackerPivotNames",null,[]);class hh{}Object(f.a)(hh,"PerfTrackingContext",null,[]);const Mj=ea=>5>=ea?"5AndFewer":10>=ea?"6To10":15>=ea?"11To15":20>=ea?"15To20":25>=ea?"21To25":30>=ea?"26To30":"31AndAbove";class Bj{}Object(f.a)(Bj,"SteppedInboundFrame",null,[]);class Zl{constructor(ea,Xa,yb,Ub,yc){this.Wjb=this.pDd=null;
this.jmh=500;this.oDd=this.Zwa=this.IEb=this.y7b=this.Nvd=-1;this.ARg=null;this.SDh=this.NCh=!1;this.rCh=null;this.hyh=this.LRa=0;this.J9b=ea;this.createdTime=Xa();this.nMd=!1;this.i2e=0;this.uGb=yb;this.vzk=Ub;this.NOd=yc;m.AFrameworkApplication.J&&(this.jmh=m.AFrameworkApplication.J.jc("InboundFrameSamplingMinimalTotalTimeMs",500))}get jve(){return this.NCh}get Awc(){return this.SDh}get AHj(){return this.rCh}get Nbb(){return this.LRa}get P7n(){return this.hyh}get eOb(){return this.uGb()}Xvc(ea,
Xa,yb,Ub){this.jve||(this.nMd=yb,this.i2e=Xa,this.Nvd=W.a.UP(la.a.Je(),2),this.ARg=(new Date).toISOString(),this.Wjb=ea,this.hyh=Ub,this.NCh=!0,this.Awc?this.Lji():(this.KXj(),Ma.a.instance.uA(ea.toString()+"Start"),ni.a.instance.Jie(2)))}bMj(ea,Xa,yb=null){this.Awc||(this.LRa=Xa,this.SDh=!0,this.rCh=ea,this.oDd=W.a.UP(la.a.Je(),2),this.jve&&(Ma.a.instance.uA(this.Wjb.toString()+"End"),yb&&(this.y7b=yb.YFj,this.IEb=yb.iNa,this.Zwa=yb.UEj),ni.a.instance.pVd(),this.Lji()))}wfm(){if(!(0<this.Nvd&&0<
this.y7b&&0<this.IEb&&0<this.Zwa&&0<this.oDd))return null;const ea=new Bj;ea.TT=W.a.UP(this.oDd-this.Nvd,2);if(ea.TT<this.jmh)return null;ea.ST=this.ARg;ea.UC=this.eOb;ea.RS=W.a.UP(this.y7b-this.Nvd,2);ea.SR=W.a.UP(this.IEb-this.y7b,2);ea.RRS=W.a.UP(this.Zwa-this.IEb,2);ea.RP=W.a.UP(this.oDd-this.Zwa,2);ea.ResponseLanded=W.a.UP(this.IEb,2);0<ea.RS?(Ma.a.instance.o0("RTCToRequestSent",this.Wjb.toString()+"Start","RequestInvoked"+this.y7b),Ma.a.instance.o0("RequestSentToResponseReceived","RequestInvoked"+
this.y7b,"RequestCompleted"+this.IEb),Ma.a.instance.o0("ResponseReceivedToReplicationStart","RequestCompleted"+this.IEb,"ReplicationStart"+this.Zwa)):Ma.a.instance.o0("RTCToReplicationStart",this.Wjb.toString()+"Start","ReplicationStart"+this.Zwa);Ma.a.instance.o0("Replication","ReplicationStart"+this.Zwa,this.Wjb.toString()+"End");return ea}KXj(){this.pDd=this.J9b.create();this.pDd.start(Ei.rIj,Ei.L4j)}Lji(){this.pDd||this.KXj();const ea=this.pDd.end(this.nMd,this.cJl());this.vzk.nue(ea);this.NOd.nue(ea+
this.i2e)}cJl(){const ea={};ea[Ee.jFe]=Mj(this.eOb);var Xa=this.AHj.length;ea[Ee.zJo]=9>=Xa?Xa.toString():"10AndAbove";return Object.assign(new hh,{P:ea,FC:this.Nbb,CFC:this.P7n+this.Nbb,ID:this.Wjb.toString(),CD:this.i2e,UC:this.eOb,RCL:this.AHj.length})}}Object(f.a)(Zl,"InboundOperation",null,[1059]);class kj{constructor(ea,Xa,yb){this.yQa=ea;this.N1a=Xa;this.uGb=yb}create(ea,Xa){return new Zl(this.yQa,this.N1a,this.uGb,ea,Xa)}}Object(f.a)(kj,"InboundOperationFactory",null,[1031]);class Ci{constructor(ea,
Xa,yb,Ub,yc,ad,md,Sd,ze){this.oMd=!0;this.jzh=this.cJd=null;this.oC=Ne=>{this.ei.oC(6,Ne)};this.h2e=ea;this.Duk=Xa;this.TIk=yb;this.ei=Ub;this.Haf=yc.create("TypingToOutboundReplicationStart",ad,md,20,!1);this.q5e=yc.create("OutboundReplicationStartToOutboundReplicationEnd",Sd,ze,20,!1)}get djg(){return this.cJd}get qpe(){return this.jzh}xsd(){!this.djg&&this.oMd&&(this.oMd=this.Duk())&&(this.cJd=this.h2e.create(this.oC,this.TIk(),this.Haf,this.q5e),this.djg.xsd())}cld(){this.oMd=!0;this.jzh=this.djg;
this.qpe&&(this.cJd=null,this.qpe.cld())}Csg(){this.cJd=null}$kd(ea,Xa){this.qpe&&this.qpe.$kd(ea,Xa)}}Object(f.a)(Ci,"OutboundMonitor",null,[]);class Ek{constructor(ea,Xa){this.h2e=ea;this.QHk=Xa}create(ea,Xa,yb,Ub,yc,ad,md){return new Ci(this.h2e,ea,Xa,yb,this.QHk,Ub,yc,ad,md)}}Object(f.a)(Ek,"OutboundMonitorFactory",null,[]);var zi=d(48);class Sg{constructor(ea){this.lkb=ea}get Hoo(){return this.lkb}tb(ea){return!!this.lkb&&ea in this.lkb}get M3i(){return this.tb(Sg.j0d)&&this.tb(Sg.JZb)&&this.tb(Sg.bBg)}get revisionId(){if(this.tb(Sg.JZb))return zi.a.Bf(this.lkb[Sg.JZb]);
throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get Xue(){if(this.tb(Sg.JZb))return this.lkb[Sg.JZb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get Vpj(){if(this.tb(Sg.j0d))return Number.parseInvariant(this.lkb[Sg.j0d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get dTj(){if(this.tb(Sg.JZb))return Boolean.parse(this.lkb[Sg.bBg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");
}get Nbb(){if(this.tb(Sg.Qbg))return Number.parseInvariant(this.lkb[Sg.Qbg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static kGl(ea){return new Sg(ea)}static pGl(ea,Xa,yb,Ub){const yc={};yc[Sg.j0d]=ea.toString();yc[Sg.JZb]=Xa.toString();yc[Sg.bBg]=yb.toString();yc[Sg.Qbg]=Ub.toString();return new Sg(yc)}}Sg.JZb="RevisionID";Sg.j0d="Duration";Sg.bBg="ShouldSample";Sg.Qbg="NumSequentialFailures";Object(f.a)(Sg,"ReplicationNotificationMessage",null,
[917]);class km{constructor(ea,Xa,yb,Ub,yc,ad,md){this.qt=this.ki=0;this.NGb=this.dRc=null;this.mJe=[];this.eAh=null;this.FAd={};this.LRa=0;this.J9b=ea;this.zMk=Xa;this.N1a=yb;this.uGb=Ub;this.NEh=yc;this.Wjb=null;this.FAd.TypingStartStage=null;this.FAd.ReplicationStartStage="TypingStartStage";this.FAd.ReplicationEndStage="ReplicationStartStage";this.xJh=1<this.eOb;this.Haf=ad;this.q5e=md}get eOb(){return this.uGb()}xsd(){this.snf("TypingStartStage")&&(this.npg("TypingStartStage"),va.ULS.shipAssertTag(8257931,
324,!this.NGb&&!this.qt,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.ki=this.N1a(),this.dRc=this.J9b.create(),this.zXj(this.dRc,Ei.qsp))}cld(){if(this.snf("ReplicationStartStage")){this.npg("ReplicationStartStage");va.ULS.shipAssertTag(8257932,324,!!this.dRc,"TypingStart not called");if(this.dRc){const ea=this.Fji(this.dRc,this.Wjb);this.Haf.nue(ea)}this.NGb=this.J9b.create();this.zXj(this.NGb,Ei.Q7n)}}$kd(ea,Xa){this.snf("ReplicationEndStage")&&(this.npg("ReplicationEndStage"),
this.qt=this.N1a(),this.LRa=Xa,va.ULS.shipAssertTag(8257933,324,!!this.NGb,"ReplicationStart not called"),this.NGb&&(va.ULS.shipAssertTag(8193425,324,!!this.NGb,"ReplicationStart not called"),Xa=this.Fji(this.NGb,ea),this.q5e.nue(Xa)),va.ULS.shipAssertTag(8257934,324,!!this.ki,"StartTime not set. No message sent to other editors."),this.ki&&(ea=Sg.pGl(this.qt-this.ki,ea,this.NEh,this.LRa),this.zMk(ea.Hoo)))}snf(ea){if(this.FAd[ea]===this.eAh)return!0;va.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.EUk()});
return!1}EUk(){const ea=new Sys.StringBuilder;ea.append("Actual Phase:");for(let Xa=0;Xa<this.mJe.length;Xa++)ea.append(" "+this.mJe[Xa]);return ea.toString()}npg(ea){this.mJe.push(ea);this.eAh=ea}zXj(ea,Xa){this.xJh&&ea.start(Xa)}Fji(ea,Xa){if(!this.xJh)return-1;const yb={};yb[Ee.jFe]=Mj(this.eOb);Xa=Object.assign(new hh,{P:yb,FC:this.LRa,CFC:0,ID:Xa?Xa.toString():"",CD:0,UC:this.eOb,RCL:0});return ea.end(this.NEh,Xa)}}Object(f.a)(km,"OutboundOperation",null,[1058]);class Je{constructor(ea,Xa,yb){this.J9b=
ea;this.N1a=Xa;this.uGb=yb}create(ea,Xa,yb,Ub){return new km(this.J9b,ea,this.N1a,this.uGb,Xa,yb,Ub)}}Object(f.a)(Je,"OutboundOperationFactory",null,[1030]);class Mc{constructor(ea,Xa){this.Xbh=this._name=this.Q5=null;this.ee=ea;this.TEa=Xa}start(ea,Xa=null){this.Q5=this.ee.Xf("UserAction",ea);this._name=ea;this.Xbh=Xa}end(ea,Xa){let yb=-1;ea&&(yb=this.Q5.Ri,Xa.D=yb,Xa.CN=this.Xbh,Xa.CD+=yb,this.TEa.track(Xa,this._name));return yb}}Object(f.a)(Mc,"PerfTracker",null,[918]);class Aa{constructor(ea,
Xa){this.ee=ea;this.TEa=Xa}create(){return new Mc(this.ee,this.TEa)}}Object(f.a)(Aa,"PerfTrackerFactory",null,[880]);class jb{constructor(ea,Xa,yb){this.UMc=null;this.PHk=ea;this.nmh=Xa;this.FAh=yb}init(ea,Xa,yb,Ub,yc,ad,md){Xa=this.FAh.create(Xa/100);yb=this.FAh.create(yb/100);this.UMc=this.PHk.create(Object(O.a)(Xa,Xa.h0b,"shouldBeInSample"),Object(O.a)(yb,yb.h0b,"shouldBeInSample"),ea,Ub,yc,ad,md)}xsd(){this.UMc.xsd()}cld(){this.UMc.cld()}Csg(){this.UMc.Csg()}$kd(ea,Xa){this.UMc.$kd(ea,Xa)}x5m(ea,
Xa,yb=null){this.nmh.hFo(ea,Xa,yb)}Xvc(ea){ea=Sg.kGl(ea);this.nmh.Xvc(ea);Ma.a.instance.uA(ea.revisionId+"Start")}wlp(ea,Xa,yb){R.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.aYd(ea,Xa,yb))}vlp(ea,Xa,yb){R.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.aYd(ea,Xa,yb))}aYd(ea,Xa,yb){const Ub={};Ub.PhaseName=ea;Ub.ThresholdValue=Xa;Ub.ActualValue=yb;return Ub}}Object(f.a)(jb,"ReplicationTelemetryManager",null,[]);var lc=d(954);class Nc extends lc.a{constructor(ea,
Xa){super(ea,Xa);this.Pk=this.mNd=0}eDa(ea){this.mNd+=ea;this.Pk++}getValue(){return this.Pk?this.mNd/this.Pk:0}PZa(){this.Pk=this.mNd=0}}Object(f.a)(Nc,"AverageMetric",lc.a,[]);class qd extends lc.a{constructor(ea,Xa){super(ea,Xa);this.f$=0}eDa(ea){ea>this.f$&&(this.f$=ea)}getValue(){return this.f$}PZa(){this.f$=0}}Object(f.a)(qd,"MaxMetric",lc.a,[]);var Rd=d(1946);class Me extends lc.a{constructor(ea,Xa,yb=100){super(ea,Xa);this.BGd=this.o9b=this.Aac=0;this.bLd=yb;this.h6e=new Rd.a(this.bLd)}eDa(ea){if(this.o9b===
this.bLd){const Xa=this.h6e.dequeue();this.Aac-=Xa;this.o9b--}this.h6e.enqueue(ea);this.Aac+=ea;this.o9b++;ea=this.Aac/this.o9b;ea>this.BGd&&this.o9b===this.bLd&&(this.BGd=ea)}getValue(){return this.BGd}PZa(){this.BGd=0;this.h6e=new Rd.a(this.bLd);this.o9b=this.Aac=0}}Object(f.a)(Me,"MaxRollingAverageMetric",lc.a,[]);class df extends lc.a{constructor(ea,Xa){super(ea,Xa);this.Pk=0}eDa(){this.Pk++}getValue(){return this.Pk}PZa(){this.Pk=0}}Object(f.a)(df,"CounterMetric",lc.a,[]);class Cf{constructor(ea,
Xa){var yb;this.MJb=Xa;this.CKe=new Nc(ea+"-AverageValue","Milliseconds");this.B_e=new qd(ea+"-MaxValue","Milliseconds");this.G_e=new Me(ea+"-MaxRollingAverageValue","Milliseconds");this.ONe=new df(ea+"-NumberOfEvents","Count");this.vxa=new qb.a(ea+"-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.RJ("CoAuthLatencySlowTargetValue",3E3),m.AFrameworkApplication.J.RJ("CoAuthLatencySlowThresholdPercentile",95),this.MJb);Xa=null===(yb=m.AFrameworkApplication.J)||void 0===yb?void 0:yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreaseWebLatencyVetoTime",
!1);m.AFrameworkApplication.$c("12b7f130;h128e180");this.j3e=Xa?new qb.a(ea+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.RJ("CoAuthLatencyBrokenSlowTargetValueForWord",1E4),m.AFrameworkApplication.J.RJ("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.MJb):new qb.a(ea+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.RJ("CoAuthLatencyBrokenSlowTargetValue",5E3),m.AFrameworkApplication.J.RJ("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.MJb)}U3(ea){this.CKe.eDa(ea);
this.B_e.eDa(ea);this.G_e.eDa(ea);this.ONe.eDa(ea);this.vxa.eDa(ea);this.j3e.eDa(ea)}Qse(){this.CKe.sZa();this.B_e.sZa();this.G_e.sZa();this.ONe.sZa();this.vxa.sZa();this.j3e.sZa();this.CKe.PZa();this.B_e.PZa();this.G_e.PZa();this.ONe.PZa();this.vxa.PZa();this.j3e.PZa()}}Object(f.a)(Cf,"ReplicationLatencyMetrics",null,[]);class sg{constructor(){this.zZe=new vc.a}xzj(ea,Xa,yb){if(!(0>Xa)){if(!({value:Ub}=this.zZe.Ec(ea,Ub)).returnValue){var Ub=new Cf(ea,yb);this.zZe.W(ea,Ub)}Ub.U3(Xa)}}Qse(){for(const ea of this.zZe.values)ea.Qse()}}
Object(f.a)(sg,"ReplicationTelemetryMetricsManager",null,[878]);class lg{xzj(){}Qse(){}}Object(f.a)(lg,"ReplicationTelemetryMetricsManagerStub",null,[878]);class Ia{constructor(ea,Xa,yb,Ub,yc,ad,md){this.W4a=this.xOd=0;this.ZEk=ea;this.n3e=yb;this.CHh=Ub;this.L9g=yc;this.Oac=Xa;this.$Ek=ad;this.MJb=md}nue(ea){this.ZEk.xzj(this.n3e,ea,this.MJb);ea>this.CHh&&this.Oac.alp(this.n3e,this.CHh,ea);this.xOd+=ea;this.W4a++;this.xOd/this.W4a>this.L9g&&this.W4a>this.$Ek&&this.Oac.Xbl(this.n3e,this.L9g,this.xOd/
this.W4a)}}Object(f.a)(Ia,"TimeSpanVerifier",null,[916]);class Zb{constructor(ea,Xa){this.cLk=ea;this.Oac=Xa}create(ea,Xa,yb,Ub,yc){return new Ia(this.cLk,this.Oac,ea,Xa,yb,Ub,yc)}}Object(f.a)(Zb,"TimeSpanVerifierFactory",null,[877]);class Qc extends Sys.EventArgs{constructor(ea,Xa,yb){super();this.VEj=ea;this.nCe=Xa;this.actualValue=yb}}Object(f.a)(Qc,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class ed{constructor(){this.sa=new U.a}alp(ea,Xa,yb){this.sa.raiseEvent("TSVTE",new Qc(ea,Xa,yb))}Xbl(ea,
Xa,yb){this.sa.raiseEvent("TSVATE",new Qc(ea,Xa,yb))}n2k(ea){this.sa.addHandler("TSVTE",ea)}V0k(ea){this.sa.addHandler("TSVATE",ea)}}Object(f.a)(ed,"TimeSpanVerifierNotifier",null,[879]);var Pd=d(1293);class hb{constructor(){this.Z=this.Aa=null}get name(){return"Box4.ReplicationTelemetry"}wc(ea){this.Aa=ea.resolve("Common.IAppSettingsManager");this.Z=ea;if(this.Aa.$("Box4ReplicationTelemetryIsEnabled")){ea.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new Aa(Ld.StaticActiveAppFrame.za().Vr,Ja.a.dH(20,
1,new Ca.a))).ha();ea.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new ed).ha();this.Aa.$("Box4ReplicationTelemetryMetricsIsEnabled")?ea.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new sg).ha():ea.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new lg).ha();ea.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Zb(ea.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),ea.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();
ea.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new Je(ea.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),hb.axi)).ha();ea.ia("ReplicationTelemetry.OutboundMonitorFactory",()=>new Ek(ea.resolve("ReplicationTelemetry.OutboundOperationFactory"),ea.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();ea.ia("ReplicationTelemetry.InboundOperationFactory",()=>new kj(ea.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),hb.axi)).ha();
var Xa=new Ed(ea.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),ea.resolve("ReplicationTelemetry.InboundOperationFactory"),ea.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),yb=this.Aa.$("ComponentStateLoggingPackageIsEnabled")?this.Z.Ta("Common.IComponentStateLogManager"):null;ea.ia("ReplicationTelemetry.IInboundMonitor",()=>Xa.create(this.Aa.jc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Aa.jc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Aa.jc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Aa.jc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),yb)).ha();ea.ia("Common.IRandomSamplerFactory",()=>new id).ha();ea.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new jb(ea.resolve("ReplicationTelemetry.OutboundMonitorFactory"),ea.resolve("ReplicationTelemetry.IInboundMonitor"),ea.resolve("Common.IRandomSamplerFactory"))).ha();ea.ia("ReplicationTelemetry.EventForwarderFactory",()=>new vg(Pd.a.instance,
ea.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),ea.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Aa.$("Box4ReplicationTelemetryIsEnabled")){var ea=this.Aa.jc("Box4ReplicationTelemetrySamplePercent",0),Xa=this.Aa.jc("Box4ReplicationTelemetryPhaseSamplePercent",0),yb=this.Aa.jc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Ub=this.Aa.jc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),yc=this.Aa.jc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),ad=this.Aa.jc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),md=this;this.Z.Ta("Box4.Presence.IRtcProxyProvider").execute(ze=>{ze.gD().continueWith(()=>{const Ne=ze.gD().result,ng=md.Z.resolve("ReplicationTelemetry.ReplicationTelemetryManager");ng.init(Ne,ea,Xa,yb,Ub,yc,ad);md.Z.resolve("ReplicationTelemetry.EventForwarderFactory").create(Ne,ng);if(md.Aa.$("LogSteppedInboundFrameIsEnabled")){const Ng=fi.a.sq(md.Z.Ta("Common.ICpuMeterProvider"));Ng.continueWith(()=>
{const uh=md.Z.resolve("ReplicationTelemetry.IInboundMonitor");var Oh=new Oa.a(()=>!0);Oh=Ja.a.dH(19,1,Oh);uh.initialize(Oh);const Hj=Ng.result.Mq.task;Hj.continueWith(()=>{Hj.result.CQd(0,()=>uh.R8e,Da=>{uh.fYn(Da)});Hj.result.CQd(1,Da=>uh.i5o(Da),()=>{uh.eYn()})})})}va.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var Sd=this;m.AFrameworkApplication.fG(()=>{Sd.Z.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Qse()})}}dispose(){}static axi(){const ea=ne.a.xd();
return ea?ea.wii:0}}Object(f.a)(hb,"ReplicationTelemetryPackage",null,[0,1]);var Id=d(1276),he=d(11),Cd=d(125),Wg=d(3),cd=d(82),If=d(63),Rf=d(37),ih=d(21),mh=d(166),Wk=d(7),na=d(2147);class db{static get mh(){return a.a.uy(db.lo,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}db.lo="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(db,"InsertSymbolsDialogHtml",null,[]);class Ob extends na.a{constructor(ea,Xa,yb){super();this.x8b=this.HSa=this.jlb=null;this.sVe=0;this.Obn=Ub=>{1===Ub?(this.weg("symbol_d_"+Ob.vKc),this.Zb.EN(this.aN,!0),this.Zb.$t().Uk.iA(this.jJ),this.jJ.focus()):this.hide()};this.CZj=Ub=>{if(Ub.target!==this.x8b){const yc=this.Zb.$t();yc&&yc.Uk&&(yc.Uk.iA(Ub.target),this.x8b=Ub.target)}this.S3n(Ub.target.id)};this.mhp=Ub=>{const yc=Ub.Df;if("a"!==yc.tagName.toLowerCase())return!1;Ub.eventName===
T.a.XC&&this.weg(yc.id);this.Zb.EN(this.aN,!0);this.Zb.$t().Uk.iA(yc);yc.focus();return!0};this.ohp=Ub=>{var yc=Ub.Df;if("a"!==yc.tagName.toLowerCase())return!1;const ad=parseInt(yc.id.substr(yc.id.lastIndexOf("_")+1));if(Ub.Lb.ctrlKey||Ub.Lb.altKey||Ub.Lb.keyCode>=gj.a.B3b&&Ub.Lb.keyCode<=gj.a.C3b)return!1;if(Ub.eventName===T.a.ij){Ub=Ub.Lb.keyCode;let md=-1;Ub===Sys.UI.Key.enter?(this.weg(yc.id),this.Zb.EN(this.aN,!0),this.Zb.$t().Uk.iA(yc),yc.focus()):Ub===Sys.UI.Key.up?md=ad-15:Ub===Sys.UI.Key.down?
md=ad+15:Ub===Sys.UI.Key.left?md=m.AFrameworkApplication.isRtl?ad+1:ad-1:Ub===Sys.UI.Key.right&&(md=m.AFrameworkApplication.isRtl?ad-1:ad+1);0<=md&&(yc=this.uNf("symbol_d_"+md))&&yc.focus()}return!0};this.ga=ea;this.Zb=Xa;this.klb=yb;this.Ke(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ke(0,CommonUIStrings.l_DialogClose);this.vda=!1;this.mh=db.mh;this.Ig="InsertSymbolsDialog"}dispose(){0<Ob.eaf&&va.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.sVe,Ob.eaf);Ob.ueh++;va.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Ob.ueh);this.ga=this.klb=null;super.dispose()}y_a(){this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.Obn,null);this.sVe=0;Ob.Aeh++;va.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Ob.Aeh);const ea=this.uNf("symbol_d_"+Ob.vKc);ea&&ea.focus()}hide(){var ea=document.getElementById("symbolsContainer");if(ea&&(ea=ea.getElementsByTagName("a")))for(let Xa=0;Xa<ea.length;Xa++)ba.a.removeHandler(ea[Xa],
T.a.focus,this.CZj);super.hide()}get tub(){return Ob.zKc}set tub(ea){Ob.zKc=ea}get nub(){return Ob.pKc}set nub(ea){Ob.pKc=ea}Jba(){super.Jba();var ea=document.getElementById("symbolsContainer");if(ea&&(ea.innerHTML=this.klb.Jgl(),ea=ea.getElementsByTagName("a")))for(let Xa=0;Xa<ea.length;Xa++)ba.a.addHandler(ea[Xa],T.a.focus,this.CZj)}Lqa(){const ea=document.getElementById("symbolsContainer");ea&&(this.jlb||(this.jlb=this.mhp,this.rr.ub(T.a.click,ea,this.jlb),this.rr.ub(T.a.XC,ea,this.jlb)),this.HSa||
(this.HSa=this.ohp,this.oe.ub(T.a.ij,ea,this.HSa),this.oe.ub(T.a.lv,ea,this.HSa),this.oe.ub(T.a.gi,ea,this.HSa)));super.Lqa()}Fob(){const ea=document.getElementById("symbolsContainer");ea&&(this.jlb&&(this.rr.xc(T.a.click,ea,this.jlb),this.rr.xc(T.a.XC,ea,this.jlb),this.jlb=null),this.HSa&&(this.oe.xc(T.a.ij,ea,this.HSa),this.oe.xc(T.a.lv,ea,this.HSa),this.oe.xc(T.a.gi,ea,this.HSa),this.HSa=null));super.Fob()}get zRf(){return!0}S3n(ea){this.PPj("symbol_d_"+Ob.vKc,!1);Ob.vKc=parseInt(ea.substr(ea.lastIndexOf("_")+
1));this.PPj(ea,!0);if(ea=document.getElementById("SymbolNameValueLabel")){const Xa=this.O8d(Ob.vKc);ea.innerText=Xa.altText}}O8d(ea){const Xa=this.klb.lBe.qFg.value,yb=Sh.a(Xa);return Xa[yb[ea]]}weg(ea){this.sVe++;Ob.eaf++;ea=parseInt(ea.substr(ea.lastIndexOf("_")+1));const Xa=this.O8d(ea),yb={};yb.SourceControlId="symbol_"+ea+"_"+Xa.jBe;this.ga.Qb(Wg.a.Bsb,2,yb);va.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",ea)}uNf(ea){const Xa=document.getElementById("symbolsContainer");
return Xa?Xa.querySelector("#"+ea):null}PPj(ea,Xa){if(ea=this.uNf(ea))Xa?(ea.setAttribute("selected","true"),ea.setAttribute("aria-selected","true"),ea.tabIndex=0):(ea.removeAttribute("selected"),ea.setAttribute("aria-selected","false"),ea.tabIndex=-1)}}Ob.vKc=0;Ob.zKc=null;Ob.pKc=null;Ob.Aeh=0;Ob.ueh=0;Ob.eaf=0;Object(f.a)(Ob,"InsertSymbolsDialog",na.a,[]);var Sb=d(1065);class qc{constructor(ea,Xa,yb,Ub,yc,ad,md){this.VMm=()=>this.klb.yhl();this.lxj=(Sd,ze,Ne,ng,Ng)=>{if(1===Ne)return 32;Sd=this.klb.Krj(Ng);
Sd=String.format(this.klb.nhp,Sd.character);Ng[Id.a.InnerHTML]=Sd;Ng[Id.a.On]=!1;return 32};this.wWa=(Sd,ze,Ne,ng,Ng)=>{if(({ge:Ne,selected:Hj,wWa:Da}=this.tYc(ze,Ne)).returnValue)return Da;const uh=Rf.a.mf(Hj);let Oh=!0;var Hj=8;var Da=this.Rc.Lc(15);Da.Ab(Ne.vd);Sb.a.Nod&&(Da.Ph=Sd);uh||(Hj=this.ga.Hf(ze,Wg.a.Bra,2,!0,ng,null),Sd=32===Hj,va.ULS.shipAssertTag(6407387,348,Sd,"DeleteForReplace did not succeed. Response is {0}",Hj),Oh=Sd);Oh&&(Sd=Ne.lb.Pg,ze=Rf.a.mf(Sd),va.ULS.shipAssertTag(6407388,
348,ze,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Sd.contextId),Hj=8,ze&&(Hj=this.ga.Hf(Sd,Wg.a.Bsb,2,!1,ng,Ng),va.ULS.shipAssertTag(6407389,348,32===Hj,"Insertion at IP context did not succeed. Response is {0}",Hj),32===Hj&&th.FocusManager.instance().Gg(Ne.nL)));Da.dispose();return Hj};this.Nbn=(Sd,ze,Ne,ng,Ng)=>{if(1===Ne)return 32;if(Rf.a.B$a(ze))return 2;Sd=this.klb.Krj(Ng);ng.Xt=Sd.index;ng=this.fd.mg(ze.node);Ne=ng.zb(11);va.ULS.shipAssertTag(6379466,324,
Ne,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Cd.a[ze.node.type]);Ne=this.Rc.Lc(15);Ne.ju(ng);qc.Cg.We(ze,Sd.character,!0,!1);ze=ih.SelectionFactory.ue(ng.currentNode,ze.cpBegin+1);this.ib.Kc(ze);Ne.dispose();return 32};this.KXb=(Sd,ze,Ne,ng,Ng)=>{if(1===Ne)return 32;Ng.MenuItems=this.pPk.value;return 32};this.DZj=(Sd,ze,Ne)=>{({wWa:Sd}=this.tYc(ze,Ne));return Sd};this.wUj=(Sd,ze,Ne)=>{2===Ne&&(new Ob(this.ga,th.FocusManager.instance(),Fa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).y_a();
return 32};this.ung=()=>32;this.ga=ea;this.fd=Xa;this.pPk=new nc.a(this.VMm);this.Rc=yb;this.klb=Ub;this.xl=yc;this.ib=ad;this.Vn=md}Xb(){this.ga.fb(Wg.a.ung,he.a.application,this.ung,96);this.ga.qa(Wg.a.KXb,he.a.view,this.KXb);this.ga.qa(Wg.a.kBe,he.a.view,this.DZj);this.ga.qa(Wg.a.Sre,he.a.view,this.lxj);this.ga.qa(Wg.a.Bsb,he.a.view,this.wWa);this.ga.qa(Wg.a.KXb,he.a.Vc,this.KXb);this.ga.qa(Wg.a.kBe,he.a.Vc,this.DZj);this.ga.qa(Wg.a.Sre,he.a.Vc,this.lxj);this.ga.qa(Wg.a.Bsb,he.a.Vc,this.Nbn);this.ga.Pc(Wg.a.KXb,
1124);this.ga.Pc(Wg.a.kBe,1036);this.ga.Pc(Wg.a.Sre,1124);this.ga.Pc(Wg.a.Bsb,1036);m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(Wg.a.P7c,he.a.view,this.wUj),this.ga.qa(Wg.a.P7c,he.a.Vc,this.wUj),this.ga.Pc(Wg.a.P7c,1124))}tYc(ea,Xa){let yb,Ub=null;ea.view.ve&&(Ub=ea.view);yb=null;if(!Ub||!Ub.lb)return R.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ea.toString()),
{returnValue:!0,ge:Ub,selected:yb,wWa:8};yb=Ub.lb.Pg;if(!yb)return{returnValue:!0,ge:Ub,selected:yb,wWa:2};if(this.xl.p2(yb)||this.xl.ama(yb))return{returnValue:!0,ge:Ub,selected:yb,wWa:8};if(Ub.lb.gb.GL||this.Vn&&this.Vn.instance&&this.Vn.instance.zX(yb)||Rf.a.B$a(ea.Lk))return{returnValue:!0,ge:Ub,selected:yb,wWa:2};if(Object(mh.a)().HEa(Wk.ParagraphReader.xX,yb))return ea=8,qc.Ac.fc(cd.a.Ne,{["Reason"]:If.a.XQ}),{returnValue:!0,ge:Ub,selected:yb,wWa:ea};ea=32;return 1===Xa?{returnValue:!0,ge:Ub,
selected:yb,wWa:ea}:{returnValue:!1,ge:Ub,selected:yb,wWa:ea}}static get Cg(){return qc.Rd||(qc.Rd=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set Cg(ea){qc.Rd=ea}static get Ac(){return jg.a.instance}}qc.Rd=null;Object(f.a)(qc,"SymbolsActor",null,[848]);class Ic{constructor(ea,Xa){this.jBe=ea;this.altText=Xa}}Object(f.a)(Ic,"Symbol",null,[]);class xc{constructor(){this.K9e=null;this.MGh=new nc.a(xc.mtf)}get qFg(){return this.MGh}vAi(ea){this.K9e||(this.K9e=Sh.a(this.MGh.value));
return Array.indexOf(this.K9e,ea)}static mtf(){const ea={};ea["\u2022"]=new Ic("\u2022",Box4Intl.Box4Strings.L_Bullet);ea["\u20ac"]=new Ic("\u20ac",Box4Intl.Box4Strings.L_EuroSign);ea["\u00a3"]=new Ic("\u00a3",Box4Intl.Box4Strings.L_PoundSign);ea["\u00a5"]=new Ic("\u00a5",Box4Intl.Box4Strings.L_YenSign);ea["\u00a9"]=new Ic("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);ea["\u00ae"]=new Ic("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);ea["\u2122"]=new Ic("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);
ea["\u00b1"]=new Ic("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);ea["\u2260"]=new Ic("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);ea["\u2264"]=new Ic("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);ea["\u2265"]=new Ic("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);ea["\u00f7"]=new Ic("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);ea["\u00d7"]=new Ic("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);ea["\u221e"]=new Ic("\u221e",Box4Intl.Box4Strings.L_Infinity);ea["\u00b5"]=new Ic("\u00b5",
Box4Intl.Box4Strings.L_MicroSign);ea["\u03b1"]=new Ic("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);ea["\u03b2"]=new Ic("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);ea["\u03c0"]=new Ic("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);ea["\u03a9"]=new Ic("\u03a9",Box4Intl.Box4Strings.L_OhmSign);ea["\u03a3"]=new Ic("\u03a3",Box4Intl.Box4Strings.L_NArySummation);ea["\u00b0"]=new Ic("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);ea["\u0394"]=new Ic("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);
ea["\u263a"]=new Ic("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);ea["\u2665"]=new Ic("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);ea["\u20b9"]=new Ic("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);ea["\u00bf"]=new Ic("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);ea["\u00a1"]=new Ic("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);ea["\u2014"]=new Ic("\u2014",Box4Intl.Box4Strings.L_EmDash);ea["\u2026"]=new Ic("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);ea["\u00c0"]=
new Ic("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);ea["\u00c1"]=new Ic("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);ea["\u00c2"]=new Ic("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);ea["\u00c3"]=new Ic("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);ea["\u00c4"]=new Ic("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);ea["\u00c5"]=new Ic("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);ea["\u00c6"]=
new Ic("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);ea["\u00c7"]=new Ic("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);ea["\u00c8"]=new Ic("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);ea["\u00c9"]=new Ic("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);ea["\u00ca"]=new Ic("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);ea["\u00cb"]=new Ic("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);ea["\u00cc"]=new Ic("\u00cc",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);ea["\u00cd"]=new Ic("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);ea["\u00ce"]=new Ic("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);ea["\u00cf"]=new Ic("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);ea["\u00d1"]=new Ic("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);ea["\u00d2"]=new Ic("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);ea["\u00d3"]=new Ic("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);ea["\u00d4"]=new Ic("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);ea["\u00d5"]=new Ic("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);ea["\u00d6"]=new Ic("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);ea["\u00d9"]=new Ic("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);ea["\u00da"]=new Ic("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);ea["\u00db"]=new Ic("\u00db",
Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);ea["\u00dc"]=new Ic("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);ea["\u00df"]=new Ic("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);ea["\u00e0"]=new Ic("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);ea["\u00e1"]=new Ic("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);ea["\u00e2"]=new Ic("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);ea["\u00e3"]=new Ic("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);
ea["\u00e4"]=new Ic("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);ea["\u00e5"]=new Ic("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);ea["\u00e6"]=new Ic("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);ea["\u00e7"]=new Ic("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);ea["\u00e8"]=new Ic("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);ea["\u00e9"]=new Ic("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);ea["\u00ea"]=new Ic("\u00ea",
Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);ea["\u00eb"]=new Ic("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);ea["\u00ec"]=new Ic("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);ea["\u00ed"]=new Ic("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);ea["\u00ee"]=new Ic("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);ea["\u00ef"]=new Ic("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);ea["\u00f1"]=new Ic("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);
ea["\u00f2"]=new Ic("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);ea["\u00f3"]=new Ic("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);ea["\u00f4"]=new Ic("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);ea["\u00f5"]=new Ic("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);ea["\u00f6"]=new Ic("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);ea["\u00f9"]=new Ic("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);ea["\u00fa"]=
new Ic("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);ea["\u00fb"]=new Ic("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);ea["\u00fc"]=new Ic("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);ea["\u00ff"]=new Ic("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);ea["\u011e"]=new Ic("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);ea["\u011f"]=new Ic("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);ea["\u0130"]=new Ic("\u0130",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);ea["\u0131"]=new Ic("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);ea["\u0152"]=new Ic("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);ea["\u0153"]=new Ic("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);ea["\u015e"]=new Ic("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);ea["\u015f"]=new Ic("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);ea["\u0178"]=new Ic("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);
return ea}}Object(f.a)(xc,"SymbolsLoader",null,[847]);var vb=d(421),Qd=d(348),Ze=d(208),Be=d(647),Ve=d(1371),Pe=d(228),Lf=d(98);class pe{constructor(ea){this.lBe=ea}get nhp(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}Krj(ea){ea=ea.SourceControlId.split("_");const Xa={};2===ea.length?(Xa.character=ea[1],Xa.index=this.lBe.vAi(Xa.character)):(Xa.character=ea[2],Xa.index=parseInt(ea[1]));return Xa}yhl(){return this.sHi()}build(){return this.WMm()}Jgl(){const ea=
new Sys.StringBuilder;ea.append('<table class="moreSymbolsTable">');const Xa=this.lBe.qFg.value,yb=Sh.a(Xa);let Ub=0;for(;Ub<yb.length;){Ub%15||ea.append('<tr role="presentation">');const yc=Xa[yb[Ub]];ea.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',"symbol_d_"+Ub,La.a.P_(yc.jBe),La.a.P_(yc.altText)));Ub++;
Ub%15&&Ub!==yb.length||ea.append("</tr>")}ea.append("</table>");return ea.toString()}WMm(){const ea=this.sHi();return Pe.o(ea)}sHi(){const ea=Object.assign(new vb.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});ea.MenuSectionList.push(this.g_k());m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&ea.MenuSectionList.push(this.iYk());return ea}iYk(){const ea=Object.assign(new Qd.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),
Xa=Object.assign(new Ze.a,{Id:"btnMoreSymbols",Command:Wg.a.P7c.toString(),LabelText:La.a.yf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:La.a.yf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:m.AFrameworkApplication.Lr,Image16by16Class:Lf.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});ea.ControlList.push(Xa);return ea}g_k(){const ea=Object.assign(new Qd.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),Xa=Object.assign(new Be.a,{Type:1,
Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),yb=this.lBe.qFg.value,Ub=Sh.a(yb),yc=Math.min(25,Ub.length);for(let md=0;md<yc;md++){var ad=yb[Ub[md]];ad=Object.assign(new Ve.a,{Id:String.format("{0}{1}_{2}","symbol_",md,ad.jBe),Character:ad.jBe,Command:Wg.a.Bsb.toString(),QueryCommand:Wg.a.Sre.toString(),Alt:La.a.yf(ad.altText)});Xa.GalleryItems.push(ad)}ea.ControlList.push(Xa);return ea}}Object(f.a)(pe,
"SymbolsUiBuilder",null,[846]);var Zh=d(50),Te=d(254),Gi=d(559),fe=d(346);class Fe{constructor(){this.Z=null}get name(){return"Box4.Symbols"}init(){m.AFrameworkApplication.J.$("InsertSymbolIsEnabled")&&this.Z.resolve("Box4.Symbols.ISymbolsActor").Xb()}dispose(){}wc(ea){this.Z=ea;this.Z.register(xc,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.Z.ia("Box4.Symbols.SymbolsUiBuilder",()=>new pe(this.Z.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();
this.Z.ia("Box4.Symbols.SymbolsActor",()=>new qc(m.AFrameworkApplication.va,new Gi.a,new fe.a,this.Z.resolve("Box4.Symbols.ISymbolsUIBuilder"),Te.a.instance,Zh.a.instance,this.Z.Ta("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){K.a.instance.Mc(new Fe)}}Object(f.a)(Fe,"Box4SymbolsPackage",null,[0,1]);var mg=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},bj=d(1613),Jh=d(1547),Gh=d(1519),cj=d(2020),Uj=d(303),Xk=d(420);class Lk{constructor(){this.mPa=null}wc(ea){this.container=ea}init(){this.mPa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.mPa&&this.mPa.dispose()}}Object(f.a)(Lk,"ALiveBooksAccessibilityCheckPackageManager",null,
[0,1]);class ii{get vAl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get wAl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get xAl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get M7n(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get ltc(){return CommonUIStrings.l_AccCheckerPaneTitle}get Eao(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(f.a)(ii,"AccessibilityCheckStringsProvider",null,[1220]);
class lj{constructor(){this.wIj=this.contentId=null}}Object(f.a)(lj,"ResultIds",null,[]);class Od{constructor(ea,Xa){this._element=null;this.$g=Xa;this.oe=ea}get element(){this._element||(this._element=this.wFl(),this.$A());return this._element}Lzg(ea){this._element=ea}dispose(){this.element&&(this.Rca(),this.Lzg(null))}$A(){this.$g&&this.oe?(this.$g.ub(T.a.click,this.element,Object(O.a)(this,this.onClick,"onClick")),this.oe.ub(T.a.ij,this.element,Object(O.a)(this,this.HI,"onKeyPress"))):va.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Rca(){this.$g&&this.oe&&(this.$g.xc(T.a.click,this.element,Object(O.a)(this,this.onClick,"onClick")),this.oe.xc(T.a.ij,this.element,Object(O.a)(this,this.HI,"onKeyPress")))}onClick(){this.flj();return!0}HI(ea){return this.Xmn(ea.Lb.keyCode)?(this.flj(),!0):!1}Xmn(ea){return ea===gj.a.Gtd||ea===gj.a.Pu}}Object(f.a)(Od,"AInteractivePaneElement",null,[1232,10]);var Nj=
d(467),yh=d(77);class Th extends Od{constructor(ea,Xa,yb){super(ea,Xa);this.p1e=yb}hide(){this.element.removeAttribute(Zf.a.Wh);Zf.a.Is(this.element,Zf.a.wA,Zf.a.mq);this.element.style.display="none"}show(){Zf.a.Is(this.element,Zf.a.wA,Zf.a.DO);Zf.a.Is(this.element,Zf.a.Wh,Zf.a.pif);this.element.style.display="block"}wFl(){const ea=Nj.b("div",this.nhj,"AccCheckerNotification");Zf.a.Is(ea,Zf.a.XTh,Zf.a.mq);Zf.a.Is(ea,Zf.a.Xja,this.Abg);ea.tabIndex=0;const Xa=Nj.b("span",this.mhj,"AccCheckerNotificationIcon");
var yb=Lf.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Xa.appendChild(yb);yb=Nj.b("span",this.Abg,"AccCheckerNotificationText");yh.a.Rx(yb,this.ohj);ea.appendChild(Xa);ea.appendChild(yb);return ea}flj(){this.p1e()}}Object(f.a)(Th,"APopupNotification",Od,[1283,1232,10]);class Tf extends Th{constructor(ea,Xa,yb,Ub){super(ea,Xa,yb);this.Vxa=Ub}get nhj(){return"AccCheckerOutOfSyncNotificationId"}get mhj(){return"AccCheckerOutOfSyncNotificationIconId"}get Abg(){return"AccCheckerOutOfSyncNotificationTextId"}get ohj(){return this.Vxa.M7n}}
Object(f.a)(Tf,"OutOfSyncNotification",Th,[]);class pp extends Th{constructor(ea,Xa,yb,Ub){super(ea,Xa,yb);this.Vxa=Ub}get nhj(){return"AccCheckerPartialResultNotificationId"}get mhj(){return"AccCheckerPartialResultNotificationIconId"}get Abg(){return"AccCheckerPartialResultNotificationTextId"}get ohj(){return this.Vxa.Eao}}Object(f.a)(pp,"PartialResultNotification",Th,[]);var jk=d(185),lm=d(30),ce=d(236);class Ge{constructor(ea,Xa,yb,Ub=null,yc=null,ad=null,md=null){this.ZBh=this.rO=this.oe=this.mPa=
null;this.vXa=Ub;this.$g=ea;this.Zb=Xa;this.gq=yb;this.Vxa=md||new ii;this.f2e=yc||new Tf(this.vXa,this.$g,Object(O.a)(this,this.tUl,"dimissOutOfSyncNotification"),this.Vxa);this.R2e=ad||new pp(this.vXa,this.$g,Object(O.a)(this,this.uUl,"dimissPartialResultNotification"),this.Vxa)}show(){}hide(){}get vXa(){return this.oe||(this.oe=m.AFrameworkApplication.ua.YE)}set vXa(ea){this.oe=ea}t9h(){}Fsa(){}dispose(){}mfb(){}cen(ea){var Xa=this.ZBh[ea];ea=Xa.contentId;if((Xa=Xa.wIj+"")&&Xa.length){const yb=
[];Array.add(yb,Object.assign(new lm.a,{name:"RuleID",string:Xa}));jk.a.sendTelemetryEvent(Object.assign(new ce.a,{name:String.format("{0}.{1}",Ge.nGg,"ViolationSelected"),dataFields:yb}))}this.$Qn(ea)}$Qn(ea){ea&&this.mPa.MUo(ea)||(this.Zb.EN(qh.AFrame.eLh,!1),this.B7o())}tUl(){this.mpd(!1)}uUl(){this.nUj(!1)}B7o(){const ea=Object.assign(new Xe.StandardDialog(!0),{Au:m.AFrameworkApplication.Qfa,Bd:1,TNa:!1});ea.qY(1);ea.Ke(1,this.Vxa.vAl);ea.Ke(0,CommonUIStrings.l_DialogCancel);ea.lV(this.Vxa.xAl,
this.Vxa.wAl,Xa=>{1===Xa&&this.XVf()})}Ehl(ea){let Xa=null;if(ea.Results&&0<ea.Results.length){Xa={};let yb=0;for(const Ub of ea.Results)Ub.ResultId=Ge.ATk+ ++yb,ea=new lj,ea.contentId=Ub.ContentId,ea.wIj=Ub.RuleId,Xa[Ub.ResultId]=ea}return Xa}dHn(){jk.a.addNamespaceMapping(Ge.nGg,Ge.Gjp);jk.a.sendTelemetryEvent(Object.assign(new ce.a,{name:String.format("{0}.{1}",Ge.nGg,"ShowTaskpane")}))}}Ge.ATk="AccCheckResult";Ge.nGg="Office.UX.AccChecker";Ge.Gjp="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";
Object(f.a)(Ge,"BaseAccessibilityCheckPane",null,[1222,10]);class Vc{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(Vc,"AccCheckerTaskPaneProps",null,[]);var Ii=d(1755),Wj=d(1893),hn=d(1527),Cm=d(196);class Cl extends Ge{constructor(ea,Xa,yb,Ub,yc=null,ad=null,md,Sd=
null,ze=null){super(Xa,yb,Ub,ad,void 0,void 0,Sd);this.S7g=null;this.KAh=this.Q2e=this.pId=this.uLd=this.TKd=!1;this.fbf=null;this.c$e=!!m.AFrameworkApplication.ua&&!!m.AFrameworkApplication.ua.Gb&&m.AFrameworkApplication.ua.Gb.v0f;this.GHc=this.k9=null;this.sIc=0;this.yCd=null;this.Z0=yc;ze&&(this.k9=ze.iQd,this.GHc=ze.F1p,this.sIc=ze.j4p);this.HC=new Wj.a}get isVisible(){return this.KAh}r_a(ea){this.KAh=ea}fxf(ea){ea&&(this.S7g=ea,ea.IsSuccess&&(this.ZBh=this.Ehl(ea),ea.IsPartialResult&&this.nUj(!0)),
this.TKd=!0,this.uLd=!1,this.Um())}mpd(ea){this.isVisible&&ea!==this.pId&&(this.pId=ea,this.Um())}nUj(ea){this.Q2e=ea;this.Um()}mS(){this.uLd||Cm.UISurfaces.Lv().then(ea=>{Ma.a.instance.uA(Cl.wBb+":PaneOpen:Start");ea.showTaskPane(Cl.wBb,this.LB());this.XVf();return null});this.isVisible?Cm.UISurfaces.Lv().then(ea=>{ea.setSelectedTaskPane(Cl.wBb);return null}):this.dHn()}Um(){Cm.UISurfaces.Lv().then(ea=>{ea.updateTaskPane(Cl.wBb,this.LB());return null})}LB(){var ea=new Vc;this.HC.yyb(ea);ea=Object.assign(new hn.a,
{title:this.Vxa.ltc,hideHeader:!1,width:320,location:2,contentProps:ea,onOpen:()=>{this.rca();this.r_a(!0);m.AFrameworkApplication.ua.Ge()},onClose:()=>{this.kha();this.r_a(!1);this.uLd=this.TKd=!1;this.Um();m.AFrameworkApplication.ua.Ge()},isModernPane:!0});this.c$e&&(ea.enableResize=!0,ea.minResizeWidth=268,ea.maxResizeWidth=920);return ea}initialize(ea){const Xa=this.Zb.ie(Cl.wBb);Xa.parent=qh.AFrame.Gq;Xa.IL=!0;this.mPa=ea;this.IUk()}dispose(){this.mfb();this.f2e&&(this.f2e.dispose(),this.f2e=
null);this.R2e&&(this.R2e.dispose(),this.R2e=null);super.dispose()}IUk(){this.HC.FN(this.onRecheckExecute());this.HC.FN(this.egm());this.HC.FN(this.HIm());this.HC.FN(this.onInvokeNavigateExecute());this.HC.FN(this.rvm());this.HC.FN(this.BDm());this.HC.FN(this.rFm());this.HC.FN(this.updateLastScanTime());this.HC.FN(this.showHelpPane())}onRecheckExecute(){return ea=>{ea.onRecheckExecute=()=>{this.XVf()}}}egm(){return ea=>{ea.accessibilityCheckResultCollection=this.S7g}}HIm(){return ea=>{ea.resultsReady=
this.TKd}}onInvokeNavigateExecute(){return ea=>{ea.onInvokeNavigateExecute=Xa=>{this.cen(Xa)}}}rvm(){return ea=>{ea.helpLink=this.i5l}}BDm(){return ea=>{ea.outOfSync=this.pId}}rFm(){return ea=>{ea.partialResult=this.Q2e}}updateLastScanTime(){return ea=>{ea.updateLastScanTime=Xa=>{this.fbf=Xa}}}showHelpPane(){return ea=>{ea.showHelpPane=()=>{m.AFrameworkApplication.J&&m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?m.AFrameworkApplication.hL||
this.FTh()?this.yCd?this.yCd():this.k9.value&&this.GHc&&this.sIc&&this.k9.value.Qb(this.sIc,2,this.GHc):this.kVj():this.FTh()?this.yCd?this.yCd():this.k9.value&&this.GHc&&this.sIc&&this.k9.value.Qb(this.sIc,2,this.GHc):this.kVj()}}}FTh(){return!this.Z0||!this.Z0.value}kVj(){const ea=this.Z0.value;if(ea){var Xa={};Xa.query=Cl.eKk+Cl.qyk;Xa=Object.assign(new Ii.a,{QU:Xa});ea.E8(Cl.MTe,Xa)}}XVf(){this.Q2e=this.pId=this.TKd=!1;this.fbf&&this.fbf();this.Um();this.uLd=!0;this.mPa.lXn()}rca(){this.Zb.Gg(Cl.wBb)}kha(){this.wab()&&
this.Zb.Gg(this.Zb.QW)}wab(){return!!this.Zb.currentScope&&this.Zb.currentScope.name===Cl.wBb}}Cl.wBb="AccessibilityCheckerPane";Cl.qyk="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Cl.MTe="FA000000012";Cl.eKk="AssetID=";Object(f.a)(Cl,"ReactAccessibilityCheckPane",Ge,[]);class Uk extends Cl{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze=null){super(ea,Xa,yb,Ub,yc,ad,void 0,ze);this.cvk=Sd;this.V5=md}get i5l(){return this.cvk}mS(){this.V5.iUa();super.mS()}}Object(f.a)(Uk,"ReactLiveBooksAccessibilityCheckPane",Cl,
[]);var Ml=d(1791),jo=d(140),tl=d(107),fl=d(61),Uh=d(131),nh=d(629),Ke=d(527),cg;(function(ea){ea[ea.error=0]="error";ea[ea.warning=1]="warning";ea[ea.tpq=2]="tip";ea[ea.d6p=3]="intelligentService"})(cg||(cg={}));Object(f.b)("AccessibilityRuleCategory",cg);class ub{constructor(ea,Xa,yb=null){this.NIe=null;this.bph=this.Jnh=!1;this.ZSa=ea;this.Uvd=Xa;this.ga=yb;this.Pb.qa(x.a.Ltl,z.a.frame,Object(O.a)(this,this.Gof,"closePane"))}get Pb(){return this.ga||(this.ga=m.AFrameworkApplication.va)}set Pb(ea){this.ga=
ea}f1l(){this.Jnh||(this.ZSa.initialize(this),this.Uvd.initialize(this),this.Jnh=!0)}lXn(){R.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.Uvd.GKo()}mS(ea,Xa,yb){if(1===yb)return xg.SessionStatusManager.instance.Jk?8:32;this.ZSa.isVisible||this.f1l();this.k9o();return 32}Gof(ea,Xa,yb){1!==yb&&this.ZSa.Fsa();return 32}e3n(){this.ZSa.mpd(!0)}fxf(ea){if(ea){if(ea.AccessibilityRules&&Object.keys(ea.AccessibilityRules).length){const yb=ea.AccessibilityRules;for(const Ub in yb){var Xa=Ub;const yc=
yb[Ub].RuleId+"";Xa!==yc&&R.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",Xa,yc)}this.NIe=yb}else!this.NIe&&ea.Results&&0<ea.Results.length?(R.b(18993251,200,15,"No accessibility rule definitions available"),ea.IsSuccess=!1):ea.AccessibilityRules=this.NIe;ea.IsSuccess||R.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.dAo(ea);this.UGn(ea);this.ZSa.fxf(ea)}}dAo(ea){const Xa=ea.AccessibilityRules;if(ea=ea.Results)for(let yb=ea.length-1;0<=yb;yb--){const Ub=
ea[yb];let yc="";const ad=Ub.RuleId;Ub.ContentName||(yc+="Result does not have content name. ");ad in Xa||(yc+=String.format("No accessibility check rule exists for ID {0}.",ad));0<yc.length&&(R.b(36214999,200,15,"Omitting invalid accessibility check result: "+yc),Array.removeAt(ea,yb))}}MJm(){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):Fa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("accessibility-checker-pane-strings")}k9o(){this.bph?
this.ZSa.mS():this.MJm().then(()=>{this.bph=!0;this.ZSa.mS()}).catch(ea=>va.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",ea))}UGn(ea){var Xa={};const yb={};var Ub=ea.Results,yc=[];Array.add(yc,Object.assign(new lm.a,{name:"FinalViolationCount",int64:0}));Array.add(yc,Object.assign(new lm.a,{name:"FinalErrorCount",string:"0"}));Array.add(yc,Object.assign(new lm.a,{name:"FinalWarningCount",string:"0"}));Array.add(yc,Object.assign(new lm.a,
{name:"FinalTipCount",string:"0"}));Array.add(yc,Object.assign(new lm.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ub){for(const Sd of Ub)if(ea.AccessibilityRules){var ad=ea.AccessibilityRules[Sd.RuleId];if(ad){if(Xa[cg[ad.Category]]){let ze=Xa[cg[ad.Category]];Xa[cg[ad.Category]]=++ze}else Xa[cg[ad.Category]]=1;yb[Sd.RuleId]?(ad=yb[Sd.RuleId],yb[Sd.RuleId]=++ad):yb[Sd.RuleId]=1}}yc[0].int64=Ub.length;for(var md in Xa)switch(ea=Xa[md],Ub=md,Ub="Final"+Ub.charAt(0).toUpperCase()+Ub.substring(1,
Ub.length)+"Count",Ub){case "FinalErrorCount":yc[1].string=ea.toString();break;case "FinalWarningCount":yc[2].string=ea.toString();break;case "FinalTipCount":yc[3].string=ea.toString();break;case "FinalIntelligentServiceCount":yc[4].string=ea.toString()}}jk.a.sendTelemetryEvent(Object.assign(new ce.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:yc}));for(const Sd in yb)Xa=Sd,yc=yb[Sd],md=[],Array.add(md,Object.assign(new lm.a,{name:"RuleID",string:Xa})),
Array.add(md,Object.assign(new lm.a,{name:"FinalViolationCount",string:yc.toString()})),jk.a.sendTelemetryEvent(Object.assign(new ce.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:md}))}dispose(){this.ZSa&&this.ZSa.dispose();this.Uvd&&this.Uvd.dispose()}}Object(f.a)(ub,"AAccessibilityCheckManager",null,[25,10]);var ec=d(464);const Tc=[12,14,22,19,30,43,44];class bd extends ub{constructor(ea,Xa,yb,Ub,yc,ad){super(Xa,yb,ea);this.Pb.qa(x.a.zBg,
z.a.frame,this.mS.bind(this));this.Pb.fb(x.a.Cmo,z.a.frame,this.nxj.bind(this),96);this.sU=yc;this.pFk=Ub;this.HBk=ad;this.Isc=()=>{this.e3n()};this.Awo()}nxj(ea,Xa,yb,Ub,yc){if(1===yb)return 32;yc[ec.a.On]=this.ZSa.isVisible;return 32}MUo(ea){if(this.HBk)return va.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;va.ULS.shipAssertTag(20272215,334,!!ea);return this.pFk.TQn(ea)}Awo(){for(const ea of Tc){const Xa=this.sU.qf(ea);Xa.Qo(this.Isc);Xa.ut(this.Isc);Xa.ly(this.Isc)}}gup(){for(const ea of Tc){const Xa=
this.sU.qf(ea);Xa.LP(this.Isc);Xa.kS(this.Isc);Xa.Hua(this.Isc)}}dispose(){super.dispose();this.gup()}}Object(f.a)(bd,"WordAccessibilityCheckManager",ub,[]);var le=d(84),tf=d(26),pf=d(102),rf=d(130),Hg=d(165),Fh=d(5),Ef=d(18),Bc=d(490);class Qm{constructor(ea,Xa,yb,Ub,yc,ad,md){this.Zn=null;this.iNb=0;this.fd=Xa;this.AG=yb;this.ib=Ub;this.ga=yc;this.qd=ad;this.Sy=ea;this.Ad=md}get yS(){if(!this.Zn){const ea=this.fd.mg(this.Sy.hd);this.AG.WIg(ea);if(ea.zb(7)||ea.kd(7))this.Zn=le.a.At(ea,ea.origin)}return this.Zn}TQn(ea){if(!ea||
!ea.Rg||0>=ea.Rg.length)return va.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Xa=Array(ea.Rg.length);let yb=7,Ub=null;for(let ad=0;ad<ea.Rg.length;ad++)if(Ub=this.s9l(ea.Rg[ad])){if(7===yb)yb=this.iNb;else if(yb!==this.iNb)return va.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var yc=this.Ad.SYa(Ub.characterData,Ub.ra);const md=ea.cpBegin?this.Ad.FMb(yc,ea.cpBegin):-1;yc=ea.cpEnd?this.Ad.FMb(yc,ea.cpEnd):
-1;if(-1>md||-1>yc)return va.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Xa[ad]=tf.a.XT(md,yc,!1,Ub);switch(ea.contentType){case 5:if(!pf.a.L5c(Xa[ad],!1))return!1;break;case 6:if(!rf.a.A7(Xa[ad]))return!1;break;case 7:Xa[ad]=tf.a.XT(-1,-1,!1,Ub)}}else return!1;Xa=new Hg.Selection(Xa,!1);return this.KZo(Ub,Xa,ea.contentType)}s9l(ea){if(this.yS)for(this.yS.reset(),this.iNb=7;this.yS.moveNext();){var Xa=this.yS.currentNode.type;if(38===Xa||36===
Xa||23===Xa)this.iNb=Xa;else if(12===Xa){Xa=this.yS.currentNode;const yb=Xa.ka(Fh.a.ed,0);if(ea===yb)return Xa}}return null}zZj(ea){this.ga.Ob(Ef.a.SW,2);this.ga.Ob(Ef.a.L6,2);let Xa=2;switch(this.iNb){case 23:Xa=32;break;case 38:Xa=this.ga.Qb(Ef.a.Zbb,2,new Bc.a(ea));break;case 36:Xa=this.ga.Qb(Ef.a.uub,2,new Bc.a(ea));break;default:va.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.iNb)}if(32===Xa)return!0;va.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",
this.iNb);return!1}KZo(ea,Xa,yb){if(this.zZj(ea)){ea=this.Sy.Gw;const Ub=this.ib.gb.currentSelection;Ub&&Ub.equals(Xa)&&this.qd.tha(ea,null);this.qd.tha(ea,Xa);switch(yb){case 0:case 1:this.ga.Ob(Wg.a.g_b,2);break;case 2:this.ga.Ob(Wg.a.Mmd,2);break;case 3:this.ga.Ob(Wg.a.HDa,2)}return!0}return!1}}Object(f.a)(Qm,"WordAccessibilityCheckNavigateManager",null,[1033]);class mm{constructor(ea){this.mPa=null;this.njh=ea}get fileId(){return this.njh?this.njh():null}initialize(ea){this.mPa=ea}ujj(ea){this.mPa.fxf(ea)}}
Object(f.a)(mm,"AAccessibilityCheckService",null,[1221,10]);class Eg{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(ea){ea=Sys.Serialization.JavaScriptSerializer.deserialize(ea);const Xa=ea.AccessibilityRules,yb={};if(Xa)for(let Ub=0;Ub<Xa.length;++Ub){const yc=Xa[Ub];yb[yc.Key]=yc.Value}ea.AccessibilityRules=yb;return ea}}Object(f.a)(Eg,"AccessibilityCheckResultCollection",null,[]);class Xh extends mm{constructor(ea){super(ea);
this.onFailure=(Xa,yb)=>{va.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",yb);Xa=Object.assign(new Eg,{IsSuccess:!1});this.ujj(Xa)};this.zE=Xa=>{Xa=Xh.FIm(Xa);let yb=null;if(Xa)try{yb=this.KRl(Xa)}catch(Ub){va.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",Ub.message),yb=Object.assign(new Eg,{IsSuccess:!1})}else va.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),yb=Object.assign(new Eg,{IsSuccess:!1});this.ujj(yb)}}dispose(){}static FIm(ea){let Xa=
null;ea&&ea.Nk&&(Xa=ea.Nk[0]);return Xa?Xa.Body:null}}Object(f.a)(Xh,"ALiveBooksAccessibilityCheckService",mm,[]);var rq=d(1079),on=d(1014),Dl=d(1363),Zm=d(258),tj=d(458);class qj extends Zm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Om(){return tj.a.zTk}static construct(ea,Xa){const yb=new qj;yb.FileId=ea;yb.IsCoauthorable=Xa;return yb}}Object(f.a)(qj,"WordAccessibilityCheckRequest",Zm.a,[]);class Fk{}Object(f.a)(Fk,"AccessibilityCheckRule",null,[]);var Jq=d(183);class Zr{static parse(ea){switch(La.a.xh(ea)){case "warnings":return 1;
case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw ea=String.format("Invalid Accessibility result category: {0}",ea),Jq.a.argument(ea);}}}Object(f.a)(Zr,"AccessibilityRuleCategoryParser",null,[]);class kc{constructor(){this.Category=this.Text=this.Id=null}static Rlp(ea){const Xa=new Fk;Xa.RuleId=ea.Id;Xa.RuleName=ea.Text;Xa.Category=Zr.parse(ea.Category);return Xa}}Object(f.a)(kc,"WordAccessibilityCheckRule",null,[]);class ck{}Object(f.a)(ck,"AccessibilityCheckResult",
null,[]);class pn{constructor(){this.cpEnd=this.cpBegin=this.Rg=null;this.contentType=0}}Object(f.a)(pn,"WordAccessibilityCheckContentId",null,[]);const Ul=ea=>{switch(La.a.xh(ea)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Kq=d(1562);class Tm{constructor(){this.OE=this.OS=this.ContentType=this.Label=
this.RuleId=this.ParaId=null}static Plp(ea){const Xa=new ck;Xa.RuleId=ea.RuleId;Xa.ContentName=ea.Label;const yb=new pn;yb.Rg=ea.ParaId;yb.cpBegin=Kq.b(ea.OS);yb.cpEnd=Kq.b(ea.OE);yb.contentType=Ul(ea.ContentType);Xa.ContentId=yb;return Xa}}Object(f.a)(Tm,"WordAccessibilityViolation",null,[]);class Eo{constructor(){this.Violations=this.Rules=null}static Qlp(ea){const Xa=new Eg;try{var yb={};if(ea.Rules){for(let Ub=0;Ub<ea.Rules.length;++Ub){const yc=kc.Rlp(ea.Rules[Ub]);yb[yc.RuleId]=yc}Xa.AccessibilityRules=
yb}if(ea.Violations){const Ub=Array(ea.Violations.length);for(yb=0;yb<ea.Violations.length;++yb)Ub[yb]=Tm.Plp(ea.Violations[yb]);Xa.Results=Ub}Xa.IsPartialResult=!1;Xa.IsSuccess=!0}catch(Ub){va.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Ub.message),Xa.IsSuccess=!1}return Xa}}Object(f.a)(Eo,"WordAccessibilityCheckResult",null,[]);class Dn extends Xh{constructor(ea,Xa,yb){super(ea);this.cEb=Xa;this.Rib=yb}GKo(){const ea=
Object.assign(new rq.a,{kr:qj.construct(this.fileId,this.Rib),status:on.a.MI,bG:"AccessibilityCheck"});this.cEb(Dl.a.BTk,!1,this.zE,this.onFailure,ea,null,ea)}KRl(ea){ea=Wa.b(ea);return Eo.Qlp(ea)}}Object(f.a)(Dn,"WordAccessibilityCheckService",Xh,[]);class vo extends Lk{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}wc(ea){super.wc(ea);ea.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Uk(m.AFrameworkApplication.va,Uj.a.instance,th.FocusManager.instance(),
Xk.a.instance,ea.nf("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),ug.KeyInputManager.instance,Ml.a.instance,m.AFrameworkApplication.J.jb("AccessibilityCheckerHelpUrl"))).ha();ea.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Dn(()=>m.AFrameworkApplication.rootQuerySignature,Ke.a.iU,jo.PageReader.instance.G6d(Ld.StaticActiveAppFrame.za().kb.hd))).ha();ea.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Qm(Ld.StaticActiveAppFrame.za().kb,
ea.resolve("Box4.Graph.IGraphIteratorFactory"),Object(tl.a)(),ea.resolve("Box4.ISelectionManager"),m.AFrameworkApplication.va,Object(fl.a)(),ea.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();ea.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new bd(m.AFrameworkApplication.va,ea.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),ea.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),ea.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),
Uh.a.jf.Tl,nh.a.Y9c)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").er.continueWith(()=>{Lk.prototype.init.call(this)})}}Object(f.a)(vo,"WordAccCheckerPackageManager",Lk,[]);var pc;(function(ea){ea[ea.H3p=0]="graphSpaceReplicatorNotSendingContent";ea[ea.A5p=1]="inboundRequestTakesTooLongToSendAfterRTC";ea[ea.RZp=2]="docxSaveMonitorKickoutElapsed"})(pc||(pc={}));Object(f.b)("ComponentLoggingScenario",pc);var Dm=d(1354);class wo{flush(ea,Xa){const yb=this.Upm(ea);yb.LoggingScenario=pc[Xa];
Sh.a(yb).length?va.ULS.sendTraceTag(594571986,3013,15,"{0}",yb):va.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",Dm.a[ea.J6a])}Upm(ea){const Xa={};if(!ea)return Xa;const yb=new Rd.a;for(yb.enqueue(ea);!yb.isEmpty;){ea=yb.dequeue();const Ub=Dm.a[ea.J6a];try{Xa[Ub]=ea.cD()}catch(yc){va.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Ub.toString(),{["Kind"]:"Exception",
["Stack"]:yc.stack,["Message"]:yc.message,["FileName"]:yc.fileName,["LineNumber"]:yc.lineNumber})}if((ea=ea.HWd)&&ea.length)for(const yc of ea)!yc||Dm.a[yc.J6a]in Xa||yb.enqueue(yc)}return Xa}}Object(f.a)(wo,"ComponentStateLogManager",null,[841]);class Zn{flush(){}}Object(f.a)(Zn,"NoOpComponentStateLogManager",null,[841]);class zk{constructor(){this.Z=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.Z.resolve("Common.IComponentStateLogManager")}dispose(){}wc(ea){this.Z=ea;m.AFrameworkApplication.J.$("ComponentStateLoggingPackageIsEnabled")?
ea.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new wo).as("Common.IComponentStateLogManager").ha():ea.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Zn).as("Common.IComponentStateLogManager").ha()}static main(){K.a.instance.Mc(new zk)}}Object(f.a)(zk,"WordEditorComponentStateLoggingPackage",null,[0,1]);var Rk=d(1184),Mk=d(655),Um=d(797),Tg=d(798),nm=d(68);class xm{constructor(ea,Xa=null,yb=-1,Ub=null){this.T1=ea;this.fKh=Ub||(()=>Xa);this.szd=yb}Xj(ea,
Xa,yb,Ub,yc,ad,md,Sd,ze,Ne=null,ng=!1,Ng=null,uh=null){const Oh=new XMLHttpRequest;let Hj="";ad="";2===Xa?(Hj="POST",yb&&(ad=yb)):Hj="GET";Xa={};this.T1&&(ea=Rk.a.aXk(Xa,ea,nm.a.mFe,m.AFrameworkApplication.TAb,this.T1));Oh.open(Hj,ea,!0);this.Dhl(Xa,ea);if(Ub)for(const Ib in Ub)Oh.setRequestHeader(Ib,La.a.gP(Ub[Ib]));for(const Ib in Xa)Oh.setRequestHeader(Ib,Xa[Ib]);ea=Ng||this.szd;0<ea&&(Oh.timeout=ea);ea=[];Array.add(ea,nm.a.q2);Ub=new Sys.Net.WebRequest;const Da=new Um.a(1,2,Ub,ea,yc,md,Sd,ze,
ng,Ne,uh);Oh.onreadystatechange=()=>{this.x2n(Oh,Da)};try{Oh.send(ad)}catch(Ib){va.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}Dkc(){return 1}x2n(ea,Xa){if(this.Zpl(ea,Xa)&&4===ea.readyState)if(ea.getResponseHeader(nm.a.Jji)&&m.AFrameworkApplication.i_c)m.AFrameworkApplication.i_c();else{var yb=ea.getResponseHeader(nm.a.zmf);Rk.a.kEe(yb);this.pAp(ea,Xa);ea.status===qk.a.qz?(Xa.status=2,Xa.mK(new Tg.a(Xa))):(Xa.status=ea.status&&ea.status!==qk.a.vxb?ea.status===
qk.a.l8?5:3:7,Xa.V6(new Mk.a(Xa)))}}Dhl(ea,Xa){ea["X-xhr"]=1;m.AFrameworkApplication.ZWa&&(ea[nm.a.h$i]=1);m.AFrameworkApplication.buildVersion&&(ea[nm.a.Wrc]=La.a.gP(m.AFrameworkApplication.buildVersion));let yb=null;this.fKh&&(yb=this.fKh());yb&&(ea[nm.a.PMg]=yb);m.AFrameworkApplication.RM&&(ea[nm.a.KLb]=La.a.gP(m.AFrameworkApplication.RM),m.AFrameworkApplication.Fqc&&va.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",ea[nm.a.KLb]));m.AFrameworkApplication.accessToken&&(Rk.a.w1h(Xa,m.AFrameworkApplication.b6)||
(ea[nm.a.zLh]=La.a.gP(m.AFrameworkApplication.accessToken)),Rk.a.w1h(Xa,m.AFrameworkApplication.qqa)||(ea[nm.a.ALh]=m.AFrameworkApplication.YSa.toString()));m.AFrameworkApplication.userType&&(ea[nm.a.y$j]=La.a.gP(m.AFrameworkApplication.userType))}pAp(ea,Xa){Xa.He=ea.status?ea.status:qk.a.vxb;try{Xa.Pe=ea.responseText;if(void 0!==Xa.SZa&&null!==Xa.SZa){Xa.wi={};for(let yb=0;yb<Xa.SZa.length;++yb){const Ub=Xa.SZa[yb];Xa.wi[Ub]=ea.getResponseHeader(Ub)}}Xa.Fye&&(Xa.ina=ea.responseText&&ea.responseText.length?
ea.responseXML:null)}catch(yb){va.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",Xa.id,Xa.request.get_url(),4===ea.readyState)}}Zpl(ea,Xa){return ea?Xa?!0:(va.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(va.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(ea,Xa,yb){return new xm(ea,
null,yb,Xa)}}Object(f.a)(xm,"SimpleClientRequestSender",null,[1760]);class xf{constructor(ea,Xa,yb){this.If=ea;this.EMd=Xa;this.IAh=yb}Xj(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne=null,ng=!1,Ng=null,uh=null,Oh=null,Hj=null,Da=!1){return this.IAh?this.EMd.Xj(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,uh,Oh):this.If.Xj(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng,uh,Oh,Hj,Da)}Dkc(ea){return this.IAh?this.EMd.Dkc():this.If.Dkc(ea)}}Object(f.a)(xf,"ClientRequestAdapter",null,[1835]);var em=d(222),Ug=d(263),El=d(232),mk=d(1299),Em=
d(1308),To=d(1365),Lm=d(44),ko=d(753),$n=d(608),Uo=d(88),qp=d(590),cr=d(617),ll;(function(ea){ea[ea.none=0]="none";ea[ea.oui=1]="getCells";ea[ea.cae=2]="hotStoreStatus";ea[ea.fJj=3]="saveMonitor";ea[ea.Hkq=4]="saveMonitor_LineageTombstone";ea[ea.iub=5]="kickoutExecutor"})(ll||(ll={}));Object(f.b)("MostRecentRevisionIdOrigin",ll);class jh extends Sys.EventArgs{constructor(ea,Xa,yb,Ub){super();this.Kab=ea;this.httpStatusCode=yb;this.$j=Ub}}Object(f.a)(jh,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,
[]);class $r{constructor(){this.q$=0}get isEmpty(){return!this.q$}sSc(ea){this.q$|=ea}B$c(ea){return!!(this.q$&ea)}clear(){this.q$=0}GUc(){return!1}}Object(f.a)($r,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Vl{constructor(ea,Xa=3){this.q$=0;this.WKd=new Map;this.FEk=ea;this.zLk=Xa}get isEmpty(){return!this.q$}sSc(ea){this.q$|=ea;let Xa=this.WKd.get(ea)||0;this.WKd.set(ea,++Xa)}B$c(ea){return!!(this.q$&ea)}clear(){this.q$=0;this.WKd.clear()}GUc(ea){return this.zLk&ea?(this.WKd.get(ea)||0)<this.FEk:
!1}}Object(f.a)(Vl,"DocxSaveMonitorRetryAttemptMany",null,[]);class Fp{static create(ea=!1,Xa=3,yb=0){return ea?new Vl(Xa,yb):new $r}}Object(f.a)(Fp,"DocxSaveMonitorRetryAttemptFactory",null,[]);class tq extends Zm.a{constructor(){super();this.CellId=this.FileId=null}Om(){return tj.a.aKf}static construct(ea){const Xa=new tq;Xa.FileId=ea.Hj().Bq;Xa.CellId=Uo.a(ea.Hc.id);return Xa}}Object(f.a)(tq,"LastSavedRevisionRequest",Zm.a,[]);var ao;(function(ea){ea[ea.teq=-1]="noResultYet";ea[ea.Hqq=0]="upToDate";
ea[ea.Rlq=1]="sessionLost";ea[ea.Xqq=2]="userSignedOut";ea[ea.Yhq=3]="previousRequestPending";ea[ea.rue=4]="requestFailed";ea[ea.Cmq=5]="shuttingDown";ea[ea.afq=6]="nullResponseData";ea[ea.y6p=7]="invalidResponseData";ea[ea.P0p=8]="failedRevisionLookup";ea[ea.Skq=9]="savedWithinThreshold";ea[ea.Heq=10]="notSavedWarning";ea[ea.d7p=11]="kickoutThreshold";ea[ea.cqq=12]="unknownRevision";ea[ea.yXp=13]="contentNotYetLoaded";ea[ea.IRo=14]="sessionExpired";ea[ea.gml=15]="canaryError";ea[ea.timeout=16]="timeout";
ea[ea.e7p=17]="kickoutThreshold_Offline";ea[ea.c_p=18]="dssSessionDeleted";ea[ea.d_p=19]="dssSessionExpired";ea[ea.orq=20]="waitingForSessionTokenRefresh";ea[ea.e_p=21]="dssSessionNotFound"})(ao||(ao={}));Object(f.b)("SaveMonitorResult",ao);class sh{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng,uh,Oh,Hj,Da,Ib,hc,Kc,zd,ue,Ue,Re,wg,Xg,fk=null,vh){this.JLc=0;this.d8b=!1;this.wOc=null;this.oKc=this.vZ=-1;this.U3e=null;this.zJd=0;this.AJd=!1;this.BGb=null;this.xMc=0;this.H6e=this.OHh=null;this.OV=this.fsh=
this.GGc=0;this.uZe=null;this.eph=!1;this.uk=null;this.jCh=this.FMd=0;this.IEh=!1;this.A$l=()=>{var ig;va.ULS.sendTraceTag(524871194,sh.Nn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.TR,["AppVisibilityState"]:mk.a[null===(ig=this.uk)||void 0===ig?void 0:ig.vA]});try{if(this.ZHc){var bh=this.ZHc();va.ULS.sendTraceTag(509367249,sh.Nn,50,"Additional Details: {0}",bh)}}catch(Ij){ig=Wa.c({["Kind"]:"Exception",["Stack"]:Ij.stack,["Message"]:Ij.message,["FileName"]:Ij.fileName,["LineNumber"]:Ij.lineNumber}),
va.ULS.sendTraceTag(509367062,sh.Nn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",ig)}ig=this.FFb;this.FFb=this.nB();if(this.Dda())this.sB.event(5),this.stop("session has shut down");else if(this.Qib===sh.kHj&&this.zEa(this.NDb),bh=this.f7b())if(this.TR)this.sB.event(0);else if(this.i8b())this.sB.event(1),this.stop("session is lost"),m.AFrameworkApplication.$c("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.eph&&!this.Ymn()&&(va.ULS.sendTraceTag(554726995,
sh.Nn,10,"DocxSaveMonitor: Session lost but not kicked out"),this.YJ(Lm.a.uhi));else if(this.fqh())20!==this.sB.currentState?(this.sB.event(20),this.OHh=this.nB(),va.ULS.sendTraceTag(593510691,sh.Nn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.QHh)):this.nB().getTime()-this.OHh.getTime()>this.QHh&&(this.sB.event(14),this.vge(20,Lm.a.S_d,"TokenExpired"));else if(this.FCk())if(this.FFb=ig,this.d8b)this.sB.event(3),this.nB().getTime()-
this.wOc.getTime()>this.IYe&&(ig=this.zMe.Dkc(this.vZ),va.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.vZ,yi.a[ig]),this.HKd&&this.HKd.log(),this.stop("stuck on previousRequestPending"),this.YJ());else if(ig=$n.b(tq.construct(bh)),this.d8b=!0,this.wOc=this.hLk(),this.vZ=this.zMe.Xj(sh.serviceUrl,2,ig,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.bql,this.aql,null,void 0,void 0,this.B4e,this.tPc,void 0,void 0,!0),0>=
this.vZ)this.d8b=!1,va.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.vZ.toString());else{ig=this.zMe.Dkc(this.vZ);bh=100;if(ig&&1!==ig||this.umh)bh=50;va.ULS.sendTraceTag(19161612,sh.Nn,bh,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.vZ,["Status"]:yi.a[ig]});this.HKd&&this.HKd.start(this.vZ)}else this.sB.event(2);else this.sB.event(13)};this.aql=ig=>{this.OV=this.QWd+1;let bh=this.d8b=!1,Ij=!1;ig=ig.data;fb.a.Jl&&m.AFrameworkApplication.jga("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");
ig?(va.ULS.sendTraceTag(22552773,sh.Nn,15,"Request failed {0}",{["Status"]:ig.status,["HttpStatus"]:ig.He,["Correlation"]:ig.wi?ig.wi[nm.a.q2]:"",["Id"]:ig.id,["ConsecutiveErrors"]:this.QWd,["Request.InvokedTime"]:ig.jH,["Request.EnqueueTime"]:ig.Tra,["Request.CompletedTime"]:ig.IO}),Ij=7===ig.status||13===ig.status,this.GUc(2)&&Ij?(this.H1a.sSc(2),bh=!0,this.oKc=ig.He,this.sB.event(16)):this.GUc(1)&&5===ig.status?(this.H1a.sSc(1),bh=!0,this.oKc=ig.He,this.sB.event(15)):(this.sB.event(4),this.oKc=
ig.He)):(this.sB.event(4),va.ULS.sendTraceTag(23425240,sh.Nn,15,"RequestFailed and event data is null"));if(!bh&&(this.H1a.clear(),Ij?this.vge(17,Lm.a.aYl,"while offline"):this.vge(11,Lm.a.Lxf,"while online")))return;this.zEa(bh?this.Oim(Ij):this.NDb)};this.bql=ig=>{this.OV=this.QWd+1;this.d8b=!1;var bh={};this.H1a.clear();if(ig=ig.data){var Ij=ig.wi?ig.wi[nm.a.q2]:"";bh.HttpStatus=ig.He;bh.Correlation=Ij;bh.Id=ig.id;va.ULS.sendTraceTag(23425242,sh.Nn,this.umh?50:100,"Request succeeded at the HTTP level {0}",
bh);this.oKc=ig.He}else va.ULS.sendTraceTag(23425241,sh.Nn,15,"Request succeeded with null response data");if(this.Dda()||!this.T_d)this.sB.event(5),this.stop("session has shut down");else if(!this.Bsn())if(ig&&ig.Pe)if(ig=this.tUa(ig.Pe))if(this.HH.r0a(ig),ig.StatusCode)this.L1f(ig,bh)||this.sB.event(8,bh);else{this.OV=0;this.FFb=this.nB();this.S5e.clear();bh={["LastSavedRevisionId"]:ig.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:ig.RevisionSequenceNumber};ig=Uo.b(ig.LastSavedRevisionId);
this.tyb(ig,3);var Mo=this.sHf().qNa.glc(ig);if(Mo){ig=null;Ij=this.Iqb();Mo=(Mo=Mo.kVa(Ij))?Mo.id:zi.a.nil;let Mn=Ij;for(;Mn&&!Mn.id.equals(Mo);)ig=Mn,Mn=Mn.OG;this.aXm(ig,bh,Ij)||this.sB.event(9)}else this.JVm()||this.sB.event(12,bh);this.zEa(this.zac)&&va.ULS.sendTraceTag(22552774,sh.Nn,50,"Received response from server -- going back to normal interval")}else this.sB.event(7),this.M1f("invalid response",bh);else this.sB.event(6),this.M1f("null response",bh)};this.BIo=(ig,bh)=>{ig={};ig.DocxSaveMonitorState=
ao[bh.newState];ig.PreviousState=ao[bh.jlg];ig.PreviousStateHits=bh.klg;ig.PreviousStateTransitionTime=bh.llg.toISOString();ig.LastHttpStatus=this.oKc;ig.LastSuccessTime=this.FFb.toISOString();this.wOc&&(ig.LastRequestStartTime=this.wOc.toISOString());ig.LastSavedRevisionID=this.Dje.toString();ig.LastSavedRevisionIdOrigin=this.JLc;ig.LastSavedRevisionIdSetTime=this.H6e?this.H6e.toISOString():null;ig.IsViable=this.lf.XBa;ig.IsNetworkConnected=this.lf.WA;ig.IsExpired=this.lf.hba;ig.HasEmergencyViewModeBeenDeployed=
this.lf.Jk;ig["Navigator.Online"]=window.navigator.onLine;const Ij=bh.jep;Ij&&sh.Bdj(ig,Ij);bh=bh.newState;switch(bh){case 13:va.ULS.sendTraceTag(5830086,sh.Nn,50,"{0}",ig);break;case 1:va.ULS.sendTraceTag(5884125,sh.Nn,50,"{0}",ig);break;case 0:va.ULS.sendTraceTag(5830087,sh.Nn,50,"{0}",ig);break;case 2:va.ULS.sendTraceTag(5830088,sh.Nn,50,"{0}",ig);break;case 3:va.ULS.sendTraceTag(5830089,sh.Nn,50,"{0}",ig);break;case 4:va.ULS.sendTraceTag(5884126,sh.Nn,50,"{0}",ig);break;case 5:va.ULS.sendTraceTag(5884127,
sh.Nn,50,"{0}",ig);break;case 6:va.ULS.shipAssertTag(5830090,sh.Nn,!1,"{0}",ig);break;case 7:va.ULS.shipAssertTag(5830091,sh.Nn,!1,"{0}",ig);break;case 8:va.ULS.sendTraceTag(5830092,sh.Nn,15,"{0}",ig);break;case 10:va.ULS.sendTraceTag(5830094,sh.Nn,15,"{0}",ig);break;case 9:va.ULS.sendTraceTag(5884128,sh.Nn,50,"{0}",ig);break;case 11:va.ULS.sendTraceTag(5830096,sh.Nn,15,"{0}",ig);break;case 17:va.ULS.sendTraceTag(37835678,sh.Nn,15,"{0}",ig);break;case 12:va.ULS.sendTraceTag(5830095,sh.Nn,15,"{0}",
ig);break;case 18:va.ULS.sendTraceTag(38122832,sh.Nn,15,"{0}",ig);break;case 19:va.ULS.sendTraceTag(38122833,sh.Nn,15,"{0}",ig);break;case 21:va.ULS.sendTraceTag(0,sh.Nn,15,"{0}",ig);break;case 14:va.ULS.sendTraceTag(6575508,sh.Nn,15,"{0}",ig);break;case 15:va.ULS.sendTraceTag(36739287,sh.Nn,50,"{0}",ig);break;case 16:va.ULS.sendTraceTag(36767649,sh.Nn,15,"{0}",ig);break;case 20:va.ULS.sendTraceTag(593510690,sh.Nn,15,"{0}",ig);break;default:va.ULS.shipAssertTag(5884129,sh.Nn,!1,"Bad state:{0} logInfo:{1}",
bh,ig)}};this.zac=ea;this.NDb=Xa;this.Qib=ea;this.oKh=yb;this.zNk=Ub;this.B4e=ad;this.tPc=md;this.r9b=Sd;this.kfh=ze;this.zMe=Ne;this.C1=ng;this.HH=Ng;this.f7b=uh;this.FCk=Oh;this.i8b=Hj;this.fqh=Da;this.Dda=Ib;this.nB=hc;this.hLk=Kc;this.eph=Xg;this.H1a=Fp.create(vh.isEnabled,vh.maxRetries,Ue.q$);this.S5e=new cr.a;this.ZHc=Re;this.sB=new Em.a(-1);this.lf=fk;this.sB.Mff(this.BIo);this.HKd=zd;this.FFb=hc();this.umh=ue;this.knk=vh.isEnabled?null:Ue;this.zCb=wg;this.QHh=this.oKh;this.f0e=zi.a.nil;this.sa=
new U.a;Fa.a.instance.Ta("Common.App.VisibilityManagement.IVisibilityManager").execute(ig=>{this.uk=ig;this.uk.BHa((bh,Ij)=>{this.F_(bh,Ij)});this.e4e=ig.vA});this.lf&&this.lf.Zlb((ig,bh)=>{this.rga(ig,bh)});this.IYe=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",yc):yc;this.jCh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",
this.NDb):this.NDb;this.IEh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.$("StopDocxSaveMonitorKickoutIsEnabled"):!0;this.BLk=vh}rga(ea,Xa){va.ULS.sendTraceTag(528577692,sh.Nn,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",To.a[Xa.$rc],To.a[Xa.zbb]);1!==Xa.zbb&&3!==Xa.zbb&&(va.ULS.sendTraceTag(528566343,sh.Nn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.H1a.B$c(1),this.H1a.B$c(2)),
this.H1a.clear())}get T_d(){return this.GGc}get Dje(){return this.f0e}get TR(){const ea=!this.Iqb()||this.Dje.equals(this.Iqb().id);ea||va.ULS.sendTraceTag(521413851,sh.Nn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Iqb().id.toString(),this.Dje.toString());return ea}get mZi(){return this.nB().getTime()-this.FFb.getTime()>this.IYe}get QWd(){return this.OV}get J6a(){return 3}get HWd(){let ea=null;Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().kb&&
Ld.StaticActiveAppFrame.za().kb.hd&&(ea=Ld.StaticActiveAppFrame.za().kb.hd.Ag);return[ea,nh.a.z4]}F_(ea,Xa){var yb,Ub,yc;ea={["VisibilityState"]:mk.a[this.uk.vA],["IsVisible"]:this.uk.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.d8b,["KickoutIntervalElapsed"]:this.mZi,["LastSuccessfulIterationTime"]:null!==(yb=this.FFb)&&void 0!==yb?yb:"null",["RequestStartTime"]:null!==(Ub=this.wOc)&&void 0!==Ub?Ub:"null",["SkippedKickouts"]:this.FMd,["LastSkippedKickoutAt"]:null!==(yc=this.ksh)&&void 0!==
yc?yc:"null"},["IsViable"]:this.lf.XBa,["IsNetworkConnected"]:this.lf.WA,["IsExpired"]:this.lf.hba,["HasEmergencyViewModeBeenDeployed"]:this.lf.Jk,["Navigator.Online"]:window.navigator.onLine};va.ULS.sendTraceTag(539874775,sh.Nn,50,Wa.c(ea));this.e4e!=this.uk.vA&&(0==Xa.oldState||1==Xa.oldState||0!==Xa.newState&&1!==Xa.newState||this.zEa(this.jCh),0===this.uk.vA?Vd.c(Ef.a.wfl,void 0,void 0,void 0,void 0,void 0,ea):0===this.e4e&&Vd.c(Ef.a.xfl,void 0,void 0,void 0,void 0,void 0,ea),this.e4e=this.uk.vA)}start(){this.GGc=
this.kfh.gob(this.A$l,this.Qib)}zEa(ea){if(!this.T_d||this.Qib===ea)return!1;const Xa=this.Qib;this.Qib=ea;this.stop("changing save monitor interval from "+Xa+"ms to "+ea+"ms");this.start();return!0}tyb(ea,Xa){if(Xa>=this.JLc&&ea&&!zi.a.nil.equals(ea)){var yb=!this.f0e.equals(ea);this.JLc=Xa;this.f0e=ea;const Ub=this.nB();this.H6e=Ub;const yc=this.TR;yb&&(Xa={["Id"]:ea.toString(),["IsUpToDate"]:yc,["Origin"]:ll[Xa]},this.uZe&&(Xa.LastUpToDateTime=this.uZe.toISOString()),(yb=this.sHf())&&yb.qNa&&(ea=
yb.qNa.glc(ea))&&(Xa.LastSavedCreationTime=ea.creationTime.toISOString()),va.ULS.sendTraceTag(557320151,sh.Nn,50,"Updating Last Saved Revision: {0}",Xa));yc&&(this.uZe=Ub)}else Xa<this.JLc?va.ULS.sendTraceTag(572051800,sh.Nn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.JLc,Xa):va.ULS.sendTraceTag(572051801,sh.Nn,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Xa)}stop(ea){this.wf(ea)}wf(ea){this.T_d&&(va.ULS.sendTraceTag(5830084,sh.Nn,50,"Stopping DocxSaveMonitor because {0}!",
ea),this.kfh.wf(this.T_d),this.GGc=0)}JVm(){if(0>=this.r9b)return!1;var ea=this.RCm();if(!ea)return this.U3e=null,this.zJd=0,this.AJd=!1;this.BGb=ea.e3d;this.BGb===this.U3e?this.zJd++:(this.U3e=this.BGb,this.zJd=1,this.AJd=!1);if(this.zJd<sh.sOn)return!1;this.xMc=+this.nB()-+this.BGb;if(this.xMc<=this.r9b)return!1;if(!this.AJd)return this.AJd=!0,this.$xj(),!1;if(this.zCb)this.zCb.execute(Xa=>{Xa.flush(this,0)});else{ea="";try{this.ZHc&&(ea=this.ZHc())}catch(Xa){ea=Wa.c({["Kind"]:"Exception",["Stack"]:Xa.stack,
["Message"]:Xa.message,["FileName"]:Xa.fileName,["LineNumber"]:Xa.lineNumber}),va.ULS.sendTraceTag(50426817,sh.Nn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",ea)}va.ULS.sendTraceTag(50426818,sh.Nn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.BGb.toISOString(),this.xMc,this.r9b,ea)}this.r9b=-1;this.stop("Exceeded oldest allowed local revision");this.YJ(Lm.a.bYl);return!0}RCm(){let ea=
null,Xa=this.Iqb();for(;Xa&&!Xa.ima;)ea=Xa,Xa=Xa.OG;return ea}Bsn(){return this.i8b()?(this.sB.event(1),this.stop("session is lost"),!0):this.fqh()?(this.sB.event(14),va.ULS.sendTraceTag(20029718,sh.Nn,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.YJ(Lm.a.S_d),!0):!1}sHf(){const ea=this.f7b();return ea?ea.Hc:null}Iqb(){const ea=this.sHf();return ea?ea.Mm:null}GUc(ea){return this.BLk.isEnabled?this.H1a.GUc(ea):this.knk.B$c(ea)&&!this.H1a.B$c(ea)}Oim(ea){return ea?sh.Ilp:sh.kHj}vge(ea,
Xa,yb){if(this.mZi)if(this.uk&&!this.uk.isVisible)va.ULS.sendTraceTag(540669727,sh.Nn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.FMd+=1,this.ksh=this.nB();else return this.sB.event(ea,{}),this.stop("request failed after kickout interval "+yb),this.zCb&&this.zCb.execute(Ub=>{Ub.flush(this,2)}),this.YJ(Xa),!0;return!1}L1f(ea,Xa){const yb=ea.StatusCode;return 88===yb||89===yb||236===yb?(Xa.KickoutDiagnostics=this.ZHc(),88===yb?(Xa.Result=
"deleted DSS session",this.sB.event(18,Xa),this.stop("deleted DSS session"),this.YJ(Lm.a.L4f)):89===yb?(Xa.Result="expired DSS session",this.sB.event(19,Xa),this.stop("expired DSS session"),this.YJ(Lm.a.WUb)):(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(ea=Uo.b(ea.LastSavedRevisionId),this.tyb(ea,4)),Xa.Result="DSS session not found",this.sB.event(21,Xa),this.stop("DSS session not found"),this.YJ(Lm.a.yhe)),
!0):14===yb?(this.stop("DSS returned an unspecified failure"),this.YJ(Lm.a.QCn),!0):104===yb?(this.stop("this operation is disabled on the server"),!0):this.M1f("unrecognized OperationResult: "+yb,Xa)}M1f(ea,Xa){if(!this.S5e.contains(ea))this.S5e.add(ea);else if(this.vge(11,Lm.a.Lxf,ea))return Xa.ConsecutiveErrors=this.QWd,Xa.Reason=ea,va.ULS.sendTraceTag(41997899,sh.Nn,15,"DocxSaveMonitor kickout. {0}",Xa),!0;this.zEa(this.NDb);return!1}aXm(ea,Xa,yb){let Ub=!1;if(ea){const yc=this.nB().getTime()-
ea.creationTime.getTime();yc>=this.oKh&&(Ub=!0,sh.Bdj(Xa,this.PIm(ea,yc,yb)),yc>=this.IYe&&10===this.sB.currentState?(this.sB.event(11,Xa),this.stop("didn't save in time"),this.YJ()):(this.sB.event(10,Xa),this.$xj(),this.cEf()))}return Ub}Q1k(ea){this.sa.addHandler(sh.auj,ea)}q1k(ea){this.sa.addHandler(sh.jEf,ea)}LDj(ea){this.sa.removeHandler(sh.jEf,ea)}$xj(){this.sa.raiseEvent(sh.auj)}tUa(ea){let Xa;return({group:Xa}=qp.a.D4(ea)).returnValue?Xa.Responses[0]:null}PIm(ea,Xa,yb){const Ub={};Ub.FirstUnsavedRevisionId=
ea.id.toString();Ub.FirstUnsavedRevisionLengthToRoot=ea.mP;Ub.UnsavedTimeInMs=Xa;Ub.CurrentRevisionId=yb.id.toString();Ub.CurrentRevisionLengthToRoot=yb.mP;return Ub}cEf(){Ke.a.dEf(Dl.a.fJj)}YJ(ea=Lm.a.Lxf){this.zNk?this.IEh?(va.ULS.sendTraceTag(509146274,sh.Nn,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",ea,this.Kwi()),0==this.GGc&&this.start()):this.uk&&!this.uk.isVisible?(va.ULS.sendTraceTag(509146273,sh.Nn,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",
ea,this.Kwi()),0==this.GGc&&this.start()):(this.stop(sh.Jxn),ea===Lm.a.S_d?this.C1.value.YJ(ea,Object.assign(new ko.a,{eka:4,WZ:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,t6:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.C1.value.YJ(ea,new ko.a)):va.ULS.sendTraceTag(19247383,sh.Nn,50,"Kickout disabled")}Kwi(){const ea={};var Xa=Fa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");ea.HasDataloss=!Xa.TR;ea.UnSavedRevisionsCount=Xa.o0a;ea.OldestUnsavedRevisionCreationTime=
Xa.TR?"":Xa.tjc().toString();ea.RevisionsWithOutServerRevisionSequenceNumbers=Xa.mfc();ea.RevisionsWithServerRevisionSequenceNumbers=Xa.OXd();ea.RSNManager_Diagnostics=Xa.cD();if(Xa=Fa.a.instance?Fa.a.instance.Oa("WordEditor.RunawayDataLossMonitor"):null)ea.RunawayDataLossMonitor_Diagnostics=Xa.PIj;ea.DocxSaveMonitor_Diagnostics=this.cD();(Xa=Fa.a.instance?Fa.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(ea.LastSavedToHostDetailsManager_Diagnostics=Xa.cD());this.uk&&(ea.VisibilityState=
mk.a[this.uk.vA]);return ea}cD(){const ea={};this.BGb&&(ea.ORT=this.BGb.toISOString());0<this.xMc&&(ea.AA=this.xMc);0<this.r9b&&(ea.MAA=this.r9b);0<this.FMd&&(ea.LSKO=this.ksh.toISOString());this.sB&&0<=this.sB.currentState&&(ea.SMS=ao[this.sB.currentState]);const Xa={};m.AFrameworkApplication.kma&&(Xa.S=1);Uh.a.LX&&(Xa.LS=1);this.lf&&(this.lf.$o&&(Xa.KO=1),this.lf.hba&&(Xa.TE=1));this.uk&&(Xa.VS=mk.a[this.uk.vA]);window.navigator&&(Xa.NW=!window.navigator.onLine);ea.AMD=Xa;return ea}avm(){const ea=
{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};m.AFrameworkApplication.buildVersion&&(ea["X-OfficeVersion"]=La.a.gP(m.AFrameworkApplication.buildVersion));m.AFrameworkApplication.accessToken&&(ea["X-AccessToken"]=La.a.gP(m.AFrameworkApplication.accessToken),ea["X-AccessTokenTtl"]=m.AFrameworkApplication.YSa.toString());m.AFrameworkApplication.RM&&(ea["X-Key"]=La.a.gP(m.AFrameworkApplication.RM));m.AFrameworkApplication.userType&&(ea["X-UserType"]=La.a.gP(m.AFrameworkApplication.userType));
const Xa=m.AFrameworkApplication.Fe.T0;Xa&&(ea["X-WacCluster"]=La.a.gP(Xa));m.AFrameworkApplication.userSessionId&&(ea["X-UserSessionId"]=La.a.gP(m.AFrameworkApplication.userSessionId));return ea}Ycm(){var ea=this.lf?this.lf.networkState:null;if(1===ea||3===ea)va.ULS.sendTraceTag(558158790,sh.Nn,15,"Not sending request because we dont have network.");else if(ea=this.f7b()){var Xa=new Sys.Net.WebRequest;Xa.set_httpVerb("POST");Xa.set_url(sh.serviceUrl);var yb={};yb.body=$n.b(tq.construct(ea));yb.headers=
this.avm();yb.method=Xa.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(Xa.getResolvedUrl(),yb).then(Ub=>{va.ULS.sendTraceTag(561551382,sh.Nn,50,"Request succeeded at the HTTP level {0}",Ub.statusText);this.fsh=Ub.status;return Ub.json()},Ub=>{va.ULS.sendTraceTag(561551383,sh.Nn,15,"Request failed at the HTTP level {0}",Ub);return null}).then(Ub=>{Ub=JSON.stringify(Ub);this.Ppl(Ub,this.fsh);return Ub},()=>{va.ULS.sendTraceTag(561551385,sh.Nn,15,"Request succeeded with null response data");
return""}):va.ULS.sendTraceTag(561002076,sh.Nn,15,"Browser does not support Fetch.")}catch(Ub){va.ULS.sendTraceTag(561551386,sh.Nn,15,String.format("Exception when attempting to get last revision save id : {0}",Ub))}}else va.ULS.sendTraceTag(540079457,sh.Nn,15,"Target node is null, not sending last saved revision request.")}Ppl(ea,Xa){let yb=zi.a.nil,Ub=!1,yc=-1;Xa===qk.a.qz&&((ea=this.tUa(ea))?(yb=Uo.b(ea.LastSavedRevisionId),ea.StatusCode||(Ub=!0,yc=ea.StatusCode)):va.ULS.sendTraceTag(561002077,
sh.Nn,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(sh.jEf,new jh(yb,Ub,Xa,yc))}static Bdj(ea,Xa){for(const yb in Xa)ea[yb]=Xa[yb]}Ymn(){return xg.SessionStatusManager.instance.$o}}sh.kHj=0;sh.serviceUrl=Uh.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";sh.Jxn="kickout";sh.auj="PS";sh.jEf="FLSR";sh.Nn=343;sh.sOn=5;sh.Ilp=5E4;Object(f.a)(sh,"DocxSaveMonitor",null,[844,113]);class Tp{gob(ea,Xa){return window.setInterval(ea,Xa)}wf(ea){window.clearInterval(ea)}}
Tp.instance=new Tp;Object(f.a)(Tp,"DocxSaveMonitorTaskManager",null,[843]);class Fm{constructor(ea){this.vZ=0;this.Uxa=ea}start(ea){this.Uxa&&(this.vZ=ea,this.Uxa.reset())}log(){if(this.Uxa){var ea={};ea.RequstId=this.vZ;ea.InvokeCount=this.Uxa.j8c;ea.InvokeFailedCount=this.Uxa.k8c;ea.NoOpenConnectionCount=this.Uxa.$dd;ea.SynchronousNotificationCount=this.Uxa.Lqd;ea.ResponseNotAvailable=this.Uxa.Eld;va.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",ea)}}}Object(f.a)(Fm,
"RequestLifeCycleTelemetryManager",null,[842]);class uq{constructor(){this.Z=this.D6e=null;this.aKl=()=>{var ea=m.AFrameworkApplication.J;if(!ea.$("DocxSaveMonitorEnabled"))return null;var Xa=ea.$("DocxSaveMonitorKickoutEnabled");const yb=ea.jc("DocxSaveMonitorIntervalMs",6E4),Ub=ea.jc("DocxSaveMonitorFailureIntervalMs",5E3),yc=ea.jc("DocxSaveMonitorWarningTimeMs",12E4),ad=ea.jc("DocxSaveMonitorKickoutTimeMs",6E5),md=ea.jc("DocxSaveMonitorQueueTimeoutMs",6E4),Sd=ea.jc("DocxSaveMonitorSentTimeoutMs",
12E4),ze=ea.jc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Ne=ea.$("DocxSaveMonitorTelemetryInfoEnabled");const ng=ea.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Ng=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),uh=ea.$("DocxSaveMonitorRawWebRequestsEnabled")||Ng;Ng=ea.$("ComponentStateLoggingPackageIsEnabled");ea=ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",
!1);var Oh=m.AFrameworkApplication.Fe,Hj=uh?new xm(m.AFrameworkApplication.userSessionId,Oh.T0,Oh.uZd):null;Hj=new xf(Oh,Hj,uh);Ne=Ne&&Oh&&!uh?new Fm(Oh.YI):null;uh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Oh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Da=Fp.create(uh,Oh);Da.sSc(1);
Da.sSc(2);Ng=Ng?this.Z.Ta("Common.IComponentStateLogManager"):null;Xa=new sh(yb,Ub,yc,Xa,ad,md,Sd,ze,Tp.instance,Hj,Fa.a.instance.nf("Wonca.KickoutExecutor"),Ug.a.instance,this.Tkc,()=>!m.AFrameworkApplication.oke||kg.a.instance.r8c,()=>Uh.a.LX,Object(O.a)(em.a.instance,em.a.instance.dIa,"checkAndTriggerSessionHasExpired"),()=>m.AFrameworkApplication.Yl,()=>new Date,()=>new Date,Ne,ng,Da,this.Ogm,Ng,ea,Fa.a.instance.Oa("Common.ISessionStatus")||xg.SessionStatusManager.instance,{isEnabled:uh,maxRetries:Oh});
Xa.start();va.ULS.sendTraceTag(5884131,sh.Nn,50,"SaveMonitor initialized");return Xa};this.Tkc=()=>{const ea=Ld.StaticActiveAppFrame.za().kb.Qc;return ea?ea.vd:null};this.Ogm=()=>{const ea={};m.AFrameworkApplication.pc&&(ea.TM=m.AFrameworkApplication.pc.cD());El.WoncaApp.jG&&(ea.RS=El.WoncaApp.jG.cD());nh.a.z4&&(ea.CRS=nh.a.z4.cD());Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().kb&&Ld.StaticActiveAppFrame.za().kb.hd&&Ld.StaticActiveAppFrame.za().kb.hd.Ag&&(ea.GSR=Ld.StaticActiveAppFrame.za().kb.hd.Ag.cD());
m.AFrameworkApplication.kma&&(ea.S=1);Uh.a.LX&&(ea.LS=1);ne.a.xd()&&ne.a.xd().ZE.$o&&(ea.KO=1);ea.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(ea)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Uh.a.wt||Uh.a.fn)this.D6e=this.Z.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.D6e&&this.D6e.stop("WordEditorDocxSaveMonitorPackage is being disposed")}wc(ea){this.Z=ea;(Uh.a.wt||Uh.a.fn)&&ea.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",
this.aKl).as("Wonca.IDocxSaveMonitor").ha()}static main(){K.a.instance.Mc(new uq)}}Object(f.a)(uq,"WordEditorDocxSaveMonitorPackage",null,[0,1]);var dj=d(1032);class an{constructor(ea,Xa){this.ho=ea;this.pNo=Object(dj.b)(Xa)}async loadChunk(ea){return this.ho.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(ea):(await this.pNo).OD.loadScript(ea)}}Object(f.a)(an,"WordOnlineChunksLoader",null,[]);class lo{constructor(){this.name="WordEditor.EditorAi.Entry"}wc(ea){ea.ia("WordEditor.EditorAi.WordOnlineChunksLoader",
()=>new an(m.AFrameworkApplication.J,ea.Ta("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){K.a.instance.Mc(new lo)}}Object(f.a)(lo,"EditorAiEntryPackage",null,[0,1]);var ma;(function(ea){ea[ea.rFp=0]="version0";ea[ea.version1=1]="version1"})(ma||(ma={}));Object(f.b)("FirstRunExperienceVersion",ma);class Ua{get ghf(){return"Word"}get NZh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return ma.rFp}get currentVersion(){return ma.version1}get rin(){return Ua.isEnabled()&&
m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get epc(){return Ua.isEnabled()&&m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get S2i(){return m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceTestIsEnabled")}get Pam(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get $dj(){return 24}get YHj(){return 4E3}get Zld(){return""}static isEnabled(){const ea=m.AFrameworkApplication.sessionStartInfoSettings?
m.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==ea&&"Automation"!==ea}}Object(f.a)(Ua,"FirstRunExperienceLauncherSettings",null,[871]);class xb{constructor(ea){this.Zhh=ea}h8o(ea){void 0==m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",void 0)&&this.Zhh&&this.Zhh.i8o(ea)}}Object(f.a)(xb,"FirstRunExperienceManager",null,[870]);class Xb{constructor(){this.Z=null}get name(){return"WordEditor.FirstRunExperience"}wc(ea){this.Z=
ea;this.Z.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new xb(this.Z.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const ea=this.Z.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");ea&&ea.h8o(new Ua)}dispose(){}}Object(f.a)(Xb,"WordEditorFirstRunExperiencePackageManager",null,[0,1]);class rc{constructor(ea,Xa){this.SNa=(yb,Ub,yc,ad,md)=>{var Sd,ze;if(1===yc)return md=null===(ze=null===(Sd=Ub.view.lb)||void 0===Sd?
void 0:Sd.gb)||void 0===ze?void 0:ze.currentSelection,(null===md||void 0===md?0:md.FL)||yb===Ef.a.lpd&&(null===md||void 0===md?0:md.LWa)?32:8;if(2===yc){Sd=this.Gib.Pj.isVisible;this.Gib.gA(!0,1===md);ze=0;switch(yb){case Ef.a.iUj:md=1;break;case Ef.a.jUj:md=2;break;case Ef.a.Zye:md=2;ze=1;break;case Ef.a.$ye:md=1;ze=2;break;case Ef.a.lpd:md=1;ze=3;break;case Ef.a.FCe:md=this.Gib.Vfc;break;default:ze=md=0}Sd&&yb===Ef.a.SNa||this.Gib.gVo(md,ze);return 32}return 8};this.Q$d=(yb,Ub,yc,ad,md)=>{this.toggleButton(md,
!1);return this.Ztl(yc)};this.FCe=(yb,Ub,yc,ad,md)=>this.Gib.Pj.isVisible?this.Q$d(yb,Ub,yc,ad,md):this.SNa(yb,Ub,yc,ad,md);this.ga=ea;this.Gib=Xa}dispose(){this.Gib&&this.Gib.dispose()}Xb(){this.ga.qa(Ef.a.FCe,he.a.view,this.FCe);this.ga.fb(Ef.a.SNa,he.a.view,this.SNa,4);this.ga.qa(Ef.a.Q$d,he.a.view,this.Q$d);this.ga.fb(Ef.a.Zye,he.a.view,this.SNa,4);this.ga.qa(Ef.a.$ye,he.a.view,this.SNa);this.ga.qa(Ef.a.lpd,he.a.view,this.SNa)}Ztl(ea){if(1===ea)return 32;this.Gib.gA(!1);return 32}toggleButton(ea,
Xa){ea&&(ea[ec.a.On]=Xa)}}Object(f.a)(rc,"FormatPictureActor",null,[10]);class Zc{constructor(ea){this.eJb=!1;this.Pj=ea}get Vfc(){return this.Pj.HMl}gVo(ea,Xa){switch(ea){case 0:case 1:this.Pj.m9o(Xa);break;case 2:this.Pj.x9o(Xa)}}gA(ea,Xa=!1){this.eJb||this.pUf();ea?this.Pj.mS(Xa):this.Pj.Fsa()}dispose(){this.Pj.dispose()}pUf(){this.eJb||(this.Pj.initialize(),this.eJb=!0)}}Object(f.a)(Zc,"FormatPictureManager",null,[840,10]);var Hd=d(344),Jd=d(157),Xd=d(155);class je{}je.rS=Xd.a.$3d;je.ktc=1;je.ltc=
WordEditorIntl.WordEditorStrings.L_FormatPicture;je.Cza="FormatPictureTaskPaneData";Object(f.a)(je,"FormatPicturePaneConstants",null,[]);class af{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(af,"FormatPictureTaskPaneProps",
null,[]);class Wf{constructor(ea,Xa,yb,Ub){this.S6e=0;this.hGc=this.iqa=null;this.fLd=this.ZKd=this.YFd=this.Ywd=this.vOd=0;this.ey=this.a6b=!1;this.dOe=0;this.$3n=()=>{this.JNj()};this.xn=()=>{let yc=!1;yc=this.tlo()||yc;yc=this.Jcb()||yc;yc=this.Icb()||yc;yc=this.puc()||yc;(yc=this.plo()||yc)&&this.Um()};this.V5=ea;this.mDk=Xa;this.DZe=yb;this.$g=Ub}initialize(){this.g2();this.xna()}get isVisible(){return this.ey}mS(ea){this.upd(ea)}Fsa(){this.kha();this.J0m()}m9o(ea){this.QPj(ea,1)}x9o(ea){this.QPj(ea,
2)}QPj(ea,Xa){this.dOe=Xa;this.S6e=ea}get HMl(){return this.dOe}dispose(){}g2(){this.V5.iUa();this.S6e=this.dOe=0}get focusManager(){return this.mDk.value}get Pb(){return this.DZe.value}wab(){return!!this.focusManager.currentScope&&this.focusManager.currentScope.name===je.rS}JNj(){this.focusManager.Gg(je.rS)}xna(){const ea=this.focusManager.ie(je.rS);ea.parent=qh.AFrame.Gq;ea.Nja(this.$3n)}kha(){this.wab()&&this.focusManager.Gg(this.focusManager.QW)}upd(ea){Cm.UISurfaces.Lv().then(Xa=>{Xa.showTaskPane(je.rS,
this.LB(ea));this.isVisible&&ea&&this.focusManager.Gg(je.rS);return null})}Um(){Cm.UISurfaces.Lv().then(ea=>{ea.updateTaskPane(je.rS,this.LB(!1));return null})}J0m(){Cm.UISurfaces.Lv().then(ea=>{ea.hideTaskPane(je.rS,2);return null})}LB(){const ea=new af;this.w1o(ea);return Object.assign(new hn.a,{title:je.ltc,hideHeader:!1,width:320,location:2,contentProps:ea,onOpen:Xa=>{this.ey=!0;Ld.StaticActiveAppFrame.za().B5a(this.xn);Ld.StaticActiveAppFrame.za().Ge();this.JNj();this.$g.iSc(je.rS,Xa)},onClose:()=>
{this.kha();this.ey=!1;Ld.StaticActiveAppFrame.za().hvc(this.xn);Ld.StaticActiveAppFrame.za().Ge()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}w1o(ea){const Xa=F.e().numberFormatInfo;ea.section=this.S6e;ea.numberFormatInfo="object"===typeof Xa?Xa:null;ea.title=this.iqa;ea.description=this.hGc;ea.topCrop=this.vOd;ea.bottomCrop=this.Ywd;ea.leftCrop=this.YFd;ea.rightCrop=this.ZKd;ea.rotationAngle=this.fLd;ea.onTitleChange=this.onTitleChange();ea.onDescriptionChange=this.onDescriptionChange();
ea.onCropSpinButtonChange=this.onCropSpinButtonChange();ea.onRotationSpinButtonChange=this.onRotationSpinButtonChange();ea.disabled=this.a6b}onTitleChange(){return ea=>{if(ea!==this.iqa){this.iqa=ea;var Xa=new Hd.DictionaryPropertySet;Xa.setValue(Jd.a.fsb,ea);this.Pb.Qb(Wg.a.Hnd,2,Xa);this.Um()}}}onDescriptionChange(){return ea=>{if(ea!==this.hGc){var Xa=new Hd.DictionaryPropertySet;Xa.setValue(Jd.a.R_,ea);this.hGc=ea;this.Pb.Qb(Wg.a.y_b,2,Xa);this.Um()}}}onCropSpinButtonChange(){return(ea,Xa)=>{const yb=
new Hd.DictionaryPropertySet;switch(Xa){case 0:this.vOd=ea;yb.setValue(Jd.a.ksb,ea);this.Pb.Qb(Ef.a.P6c,2,yb);break;case 1:this.Ywd=ea;yb.setValue(Jd.a.hsb,ea);this.Pb.Qb(Ef.a.M6c,2,yb);break;case 2:this.YFd=ea;yb.setValue(Jd.a.isb,ea);this.Pb.Qb(Ef.a.N6c,2,yb);break;case 3:this.ZKd=ea,yb.setValue(Jd.a.jsb,ea),this.Pb.Qb(Ef.a.O6c,2,yb)}this.Um()}}onRotationSpinButtonChange(){return ea=>{this.fLd=ea;const Xa=new Hd.DictionaryPropertySet;Xa.setValue(Jd.a.W6c,0);Xa.setValue(Jd.a.pX,ea);this.Pb.Qb(Wg.a.$aa,
2,Xa);this.Um()}}tlo(){const ea=2===this.Pb.Qb(Wg.a.Hnd,1,null),Xa=ea!==this.a6b;this.a6b=ea;return Xa}Jcb(){var ea=new Hd.DictionaryPropertySet;this.Pb.Qb(Wg.a.Jcb,2,ea);ea=ea.ka(Jd.a.fsb,"");const Xa=ea!==this.iqa;this.iqa=ea;return Xa}Icb(){var ea=new Hd.DictionaryPropertySet;this.Pb.Qb(Wg.a.Icb,2,ea);ea=ea.ka(Jd.a.R_,"");const Xa=ea!==this.hGc;this.hGc=ea;return Xa}puc(){var ea=new Hd.DictionaryPropertySet;this.Pb.Qb(Ef.a.Did,2,ea);const Xa=ea.ka(Jd.a.ksb,0),yb=ea.ka(Jd.a.hsb,0),Ub=ea.ka(Jd.a.isb,
0);ea=ea.ka(Jd.a.jsb,0);const yc=Xa!==this.vOd||yb!==this.Ywd||Ub!==this.YFd||ea!==this.ZKd;this.vOd=Xa;this.Ywd=yb;this.YFd=Ub;this.ZKd=ea;return yc}plo(){var ea=new Hd.DictionaryPropertySet;this.Pb.Qb(Wg.a.qYb,2,ea);ea=ea.ka(Jd.a.pX,0);const Xa=ea!==this.fLd;this.fLd=ea;return Xa}}Object(f.a)(Wf,"ReactFormatPicturePane",null,[839,10]);class Mg{constructor(){this.ABd=this.Z=null}get name(){return"WordEditor.FormatPicture"}wc(ea){this.Z=ea;this.Z.ia("WordEditor.FormatPicture.IFormatPictureManager",
()=>new Zc(this.Z.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.Z.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new Wf(Ml.a.instance,new nc.a(()=>th.FocusManager.instance()),new nc.a(()=>m.AFrameworkApplication.va),Uj.a.instance)).ha();this.Z.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new rc(m.AFrameworkApplication.va,this.Z.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(nh.a.uNg||nh.a.Sbk)this.ABd=this.Z.resolve("WordEditor.FormatPicture.FormatPictureActor"),
this.ABd.Xb(),Ld.StaticActiveAppFrame.za().Ge()}dispose(){this.ABd&&this.ABd.dispose()}static main(){K.a.instance.Mc(new Mg)}}Object(f.a)(Mg,"WordEditorFormatPicturePackage",null,[0,1]);var bi=d(1387),zh=d(576),Ah=d(1174);class Zi extends Zm.a{constructor(){super();this.Prompt=0;this.FileId=null}Om(){return tj.a.xTm}static construct(ea,Xa){const yb=new Zi;yb.FileId=ea;yb.Prompt=Xa;return yb}}Object(f.a)(Zi,"GraphMergeConsentChangedRequest",Zm.a,[]);var sk=d(521);class gm extends sk.a{constructor(){super();
this.Location=this.FileId=null}Om(){return tj.a.Vco}static construct(ea,Xa){const yb=new gm;yb.FileId=ea;yb.Location=Xa;return yb}}Object(f.a)(gm,"PlayGraphMergeReplayRequest",sk.a,[]);class Gj{constructor(ea,Xa,yb,Ub,yc,ad=null,md=null){this.fm=!1;this.SQa=null;this.LDh=this.lYe=!1;this.eqf=()=>{if(this.aFa.w$d)this.lYe=!0;else if(this.lYe=!1,!this.hRo){this.LDh=!0;var Sd=this.OPa.YCa;va.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",Sd===Ah.a.fqf);if(Sd===Ah.a.pWc||Sd===Ah.a.fqf)Sd=
Zi.construct(this.ZS(),Sd),this.Hs(Sd)}};this.XLi=(Sd,ze)=>{ze&&ze.T7f&&ze.T7f.lsf&&!this.aFa.W2i&&(this.aFa.P5j(),this.aFa.w$d=!0,this.Hs(ze.T7f.lsf))};this.VLi=(Sd,ze)=>{ze&&ze.aud&&this.aFa.P5j()};this.WLi=(Sd,ze)=>{ze&&(ze.ShowMergePrompt&&this.OPa.JFj(this.eqf),m.AFrameworkApplication.fh&&(m.AFrameworkApplication.fh.SessionMergeInfo|=ze.PartMergeInfo))};this.ZS=ea;this.OPd=yb;this.aFa=Ub;this.OPa=yc;this.OPd&&this.OPd.v1k(this.XLi);this.HH=ad||Ug.a.instance;if(!md){const Sd=new zh.a;md=ze=>Sd.Jaa(0,
ze)}this.Vok=md}get Nvn(){return this.lYe}get hRo(){return this.LDh}Hs(ea){const Xa=new rq.a;Xa.kr=ea;Xa.status=on.a.MI;Xa.bG="GraphMerge";const yb=this.Vok(()=>{this.Dld(Xa,ea.Om()===tj.a.c$h)});yb.MG(Xa);yb.i_()}Dld(ea,Xa){this.fm||(Xa&&(this.aFa.w$d=!1),2===ea.statusCode&&!ra.a.sTb(ea.Nk)&&1===ea.Nk.length&&ea.Nk[0]?(ea=ea.Nk[0],ea.StatusCode?this.aFa.Nyg():Xa&&this.OPa.JFj(this.eqf),this.HH.r0a(ea),this.Nvn&&this.eqf()):this.aFa.Nyg())}dfd(ea){this.SQa=ea;this.SQa.tcc(this.VLi);this.SQa.ucc(this.WLi)}dispose(){this.fm||
(this.OPd&&this.OPd.jCo(this.XLi),this.SQa&&(this.SQa.Ikd(this.VLi),this.SQa.Jkd(this.WLi)),this.fm=!0)}}Object(f.a)(Gj,"GraphMergeBackupManager",null,[872,10]);class En{constructor(ea,Xa=null,yb=null,Ub=null){this.JKe=0;this.fXe=!1;this.qrh=new Date(0);this.w$d=!1;this.OPa=ea;this.nB=Xa||(()=>new Date);yb||(yb=m.AFrameworkApplication.J?m.AFrameworkApplication.J.jc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.aFk=yb;Ub||(Ub=m.AFrameworkApplication.J?m.AFrameworkApplication.J.jc("WordEditorGraphMergeMaxBackups",
1):1);this.fuh=Ub}get tun(){return+this.nB()-+this.qrh<this.aFk}get W2i(){return this.OPa.YCa===Ah.a.automatic?!1:this.OPa.YCa===Ah.a.pWc?!0:this.fXe||this.w$d||this.tun}P5j(){this.qrh=this.nB();this.JKe++;this.JKe>=this.fuh&&this.Nyg()}Nyg(){this.fXe||(this.fXe=!0,va.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.JKe,this.fuh))}}Object(f.a)(En,"GraphMergeBackupThrottler",null,[869]);class Rm{constructor(ea,Xa,yb=null){this.kkh=
!1;this.s9=ea;this.svk=Xa;null==yb&&(yb=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WordEditorGraphMergeBypassConsentPrompt"));this.l4e=yb?Ah.a.automatic:Ah.a.Fqe}get YCa(){return this.l4e}JFj(ea){if(!this.kkh&&this.YCa===Ah.a.Fqe){var Xa=this.svk.value;Xa&&Xa.isFeatureEnabled(44)&&(this.kkh=!0,this.s9.execute(yb=>{yb.u8o(()=>{this.Yyl(ea)},()=>{this.pWc(ea)})}))}}pWc(ea){this.YCa===Ah.a.Fqe&&(va.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.l4e=
Ah.a.pWc,ea());this.gCj()}Yyl(ea){this.YCa===Ah.a.Fqe&&(va.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.l4e=Ah.a.fqf,ea());this.gCj()}gCj(){this.s9.execute(ea=>{ea.G0m()})}}Object(f.a)(Rm,"GraphMergeCollectionConsentManager",null,[868]);class Si extends Sys.EventArgs{constructor(ea){super();this.T7f=ea}}Object(f.a)(Si,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var rp=d(894),Ji=d(1051),Fn=d(625),ml;(function(ea){ea[ea.none=0]="none";ea[ea.Gj=1]="failure";
ea[ea.pza=2]="crash";ea[ea.success=3]="success"})(ml||(ml={}));Object(f.b)("GraphMergeReplayReason",ml);var jn=d(1799),Gn=d(1796),gl=d(59),rj=d(224),tk=d(177);class fp{constructor(ea,Xa,yb,Ub,yc,ad){this.Amg=this.Yg=null;this.S$c=this.XMg=!1;this.Rl=null;this.cpd=ea.runtime.cpd;this.Hu=ea;this.tf=Xa;this.hh=yb;this.Ro=Ub;this.Lyl=yc;this.WKi=ad}}Object(f.a)(fp,"GraphNodeComplexMergeState",null,[]);var mj=d(1499),xs=d(1476);class qr{constructor(ea,Xa=null){this.xg=ea;this.b9b=Xa||this.E3c()}get avb(){return this.b9b}get tf(){return this.xg}E3c(){return[Object(O.a)(this,
this.Y$o,"simpleMerge"),Object(O.a)(this,this.Uxl,"complexMerge")]}D1o(ea,Xa,yb,Ub,yc,ad){Xa=new fp(ea,yb,new nc.a(()=>new mj.a(Ub?Ub.zm:null,yc)),new nc.a(()=>new mj.a(Ub?Ub.zm:null,ad)),new nc.a(()=>new mj.a(ad,yc)),Xa.d$h(yc,()=>ea.runtime.rc));Xa.Yg=Ub.Zac;Xa.Amg=new rj.a;return Xa}merge(ea,Xa,yb,Ub,yc,ad){Xa=this.D1o(ea,Xa,yb,Ub,yc,ad);yb=!0;for(Ub=0;Ub<this.avb.length&&yb;Ub++)(yb=(0,this.avb[Ub])(Xa))||ea.logger.Uhe("GraphNodeMerge.GetMergeFunctions()",Ub);if(ea=Xa.S$c&&Xa.Rl?new xs.a(Xa.Rl,
!1):null)switch(ea.T_o(Xa.Yg),(ea?ea.zm:yc).sc){case gl.a.Xd:Xa.Hu.runtime.Jse.gAl.W(ea.zm.id,ea.zm);break;case gl.a.Hmb:Xa.Hu.runtime.Jse.eel.W(ea.zm.id,ea.zm);break;case gl.a.ZK:Xa.Hu.runtime.Jse.Pwl.W(ea.zm.id,ea.zm);break;case gl.a.paragraphNode:Xa.Hu.runtime.hje.add(ea.zm.id)}return{returnValue:Xa.S$c,Rl:ea}}Y$o(ea){if(ea.Hu.runtime.rc&&ea.Hu.runtime.rc.xrb(1000005)&&0<ea.Yg.count)return!0;var Xa=ea.WKi.Nqe;return ea.Ro.value.R8c(Xa)&&ea.Lyl.value.R8c(Xa)?ea.hh.value.R8c(Xa)?!0:(Xa=ea.Ro.value.Lf,
ea.S$c=!0,ea.Rl=Xa.GO(),!1):(ea.S$c=!0,!1)}Uxl(ea){const Xa=ea.Ro.value.Lf;ea.cpd&&tk.a.instance.Ua(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",Xa.id,Xa.sc);const yb=ea.WKi.UIg(ea);ea.S$c=yb;tk.a.instance.Ua(4018184,1,yb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",yb?"Succeeded":"Failed",Xa.id,Xa.sc,!!ea.Rl);return yb}}Object(f.a)(qr,"GraphNodeMerge",null,[1064]);var Up;(function(ea){ea[ea.none=0]="none";ea[ea.$Xp=1]="crashesOnly";ea[ea.Viq=
2]="rejectionsAndCrashes";ea[ea.nUp=3]="allMerges"})(Up||(Up={}));Object(f.b)("GraphMergeBackupCases",Up);var dr=d(1350),Fi=d(1297);class bo extends Zm.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=dr.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=Fi.a.none;this.Reason=ml.none;this.Prompt=0}Om(){return tj.a.c$h}static construct(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,
ng){const Ng=new bo;Ng.FileId=ea;Ng.BaseRevisions=Xa;Ng.TheirRevisions=yb;Ng.YourRevisions=Ub;Ng.IgnoreConflictsInLastServerRevision=yc;Ng.MergeHint=ad;Ng.ObjectSpaceId=md?Uo.a(md):null;Ng.RequestId=Sd?Uo.a(Sd):null;Ng.Source=ze;Ng.Reason=Ne;Ng.Prompt=ng;return Ng}}Object(f.a)(bo,"CreateGraphMergeReplayRequest",Zm.a,[]);var gp=d(825),ci=d(241),Mm=d(13),ys=d(1942),di=d(2029);class Vp{constructor(ea,Xa=null,yb=null){this.YWl=(Ub,yc)=>{let ad=Ub;var md=yc,Sd=this.Ajb.get(Ub);if(!Sd)return{oNa:ad,BZb:md};
md=new rj.a;md.add(Sd);var ze=this.jGb.get(Ub)||this.BH.K(Ub);Sd=new rj.a;Sd.add(ze);ze=new rj.a;ze.add(this.BH.K(Ub));va.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.uJ.lPf,this.uJ.zma,this.oBi(Sd),this.oBi(md));var Ne=this.KBi(this.uJ.zma);this.lam(Ne,Ub,md);Sd=new ys.a(Ne,ze,Ne.input.zma===dr.a.IBc?Sd:md,Ne.input.zma===dr.a.IBc?md:Sd,this.KBi(dr.a.IBc),Sd,md);md=new rj.a;for(ze=0;ze<yc.length;ze++){this.uJ.$I("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");
const ng=({jdb:ad,Nua:Ne}=Sd.Msd(Ub,yc.K(ze))).returnValue;md.add(Ne);ng?va.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Ub,yc.K(ze),ad,Ne):va.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Ub)}return{oNa:ad,BZb:md}};this.uJ=ea;this.BH=ea.Gn;this.Ajb=ea.Hkp;this.jGb=
ea.HLp;this.YDk=ea.PCn;this.xg=Xa||new Ji.a;this.AIk=yb||this.YWl}sZc(ea){const Xa=new rj.a;for(let yb=0;yb<ea.length;yb++){const Ub=this.QWl(ea.K(yb));Xa.add(Ub)}return Xa}rZc(ea,Xa,yb){const Ub=ea.rv===ea.IA&&ea.startCp===ea.endCp;Xa&&({oNa:ea.rv,Nua:ea.startCp}=this.u0a(ea.rv,ea.startCp,ea.rv),Ub&&(ea.IA=ea.rv,ea.endCp=ea.startCp));yb&&!Ub&&({oNa:ea.IA,Nua:ea.endCp}=this.u0a(ea.IA,ea.endCp,ea.IA));return ea}QWl(ea){if(ea.rv===ea.IA){var Xa=new rj.a;Xa.add(ea.startCp);Xa.add(ea.endCp);({oNa:ea,
BZb:Xa}=this.cLg(ea.rv,Xa));return new gp.a(ea,Xa.K(0),ea,Xa.K(1))}Xa=new rj.a;var yb=new rj.a;let Ub;Xa.add(ea.startCp);({oNa:Xa,BZb:Ub}=this.cLg(ea.rv,Xa));yb.add(ea.endCp);({oNa:ea,BZb:yb}=this.cLg(ea.IA,yb));return new gp.a(Xa,Ub.K(0),ea,yb.K(0))}cLg(ea,Xa){let yb=ea,Ub=Xa;if(!this.BH.K(ea))return va.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",ea),{oNa:yb,BZb:Ub};if(this.Ajb.get(ea))({oNa:yb,
BZb:Ub}=this.AIk(ea,Xa,yb,Ub));else if(this.uJ.CTf&&!this.uJ.CTf.K(this.uJ.CTf.length-1).k3(ea)){Ub=new rj.a;for(let yc=0;yc<Xa.length;yc++){let ad;({oNa:yb,Nua:ad}=this.u0a(ea,Xa.K(yc),yb));Ub.add(ad)}}return{oNa:yb,BZb:Ub}}oBi(ea){let Xa="";ea.forEach(yb=>{Xa+=yb.Mzc();Xa+=" ";return!0});return Xa}KBi(ea){const Xa=Fa.a.instance.Oa("Box4.IFeatureHelper"),yb=new di.a;yb.input.source=this.uJ.lPf;yb.input.zma=this.uJ.zma;yb.input.e0c=()=>Xa;yb.runtime.Gn=this.BH;yb.runtime.qIa=this.uJ.sxl;ea===dr.a.IBc?
(yb.runtime.JA=this.jGb,yb.runtime.sv=this.Ajb,yb.runtime.d2d=this.uJ.c5i,yb.runtime.VDe=this.uJ.y5i):ea===dr.a.gCe&&(yb.runtime.JA=this.Ajb,yb.runtime.sv=this.jGb,yb.runtime.d2d=this.uJ.y5i,yb.runtime.VDe=this.uJ.c5i);yb.runtime.rc=Xa;return yb}lam(ea,Xa,yb){if(ea.runtime.JA.tb(ci.a.MN)){var Ub=ea.runtime.JA.K(ci.a.MN);Ub=this.xg.getPropertyObjectIds(Ub,Fh.a.AY);if(1===Ub.length&&(Ub=Ub.K(0),ea.runtime.JA.tb(Ub)&&(Ub=ea.runtime.JA.K(Ub),3===this.xg.getPropertyInt32(Ub,Fh.a.GAb)))){const yc=this.xg.getPropertyString(Ub,
Fh.a.Xna),ad=this.xg.getPropertyString(Ub,Fh.a.i2b);Xa.toString()===yc&&yc===ad&&(Xa=this.xg.getPropertyObjectId(Ub,Fh.a.Qsd),ea.runtime.JA.tb(Xa)&&yb.add(ea.runtime.JA.K(Xa)))}}}FEm(ea,Xa){let yb=0;for(let Ub=0;Ub<ea.length;Ub++)if(Xa.equals(ea.K(Ub)))return yb=Ub,{returnValue:!0,idx:yb};return{returnValue:!1,idx:yb}}u0a(ea,Xa){const yb=this.YDk&&!!this.jGb.K(ea)&&!this.BH.K(ea);let Ub=ea,yc=Xa,ad=!1,md=!1;(yb?this.jGb:this.Ajb).forEach((Sd,ze)=>{this.uJ.$I("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.IZf(ze.sc)&&this.BH.K(Sd)){ze=null;if(yb){ze=this.$3c(ng=>this.jGb.K(ng)||this.BH.K(ng),Sd);var Ne=this.yee(ze,ea)}else Ne=this.$3c(ng=>this.BH.K(ng),Sd),Ne=this.yee(Ne,ea);if(Ne&&(md=!0,ze||(ze=this.$3c(ng=>this.jGb.K(ng)||this.BH.K(ng),Sd)),Sd=this.$3c(ng=>this.Ajb.K(ng)||this.BH.K(ng),Sd),Ne=0,({idx:Ne}=this.FEm(ze,ea)).returnValue)){for(let ng=Ne+1;ng<ze.length;ng++)if(this.yee(Sd,ze.K(ng)))return yc=0,Ub=ze.K(ng),ad=!0,!1;for(--Ne;0<=Ne;Ne--)if(this.yee(Sd,ze.K(Ne)))return yc=Number.MAX_VALUE,
Ub=ze.K(Ne),ad=!0,!1}}return!0});ad||(va.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",ea,Xa,yb,md),this.uJ.lPf===Fi.a.undo&&(va.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Ub),({Moi:Xa}=this.etm()).returnValue?(Ub=Xa,yc=
0,va.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Ub)):va.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Ub)));return{oNa:Ub,Nua:yc}}etm(){let ea=zi.a.nil,Xa=new rj.a;this.Ajb.forEach((yb,Ub)=>{this.uJ.$I("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.IZf(Ub.sc)?(Xa=this.$3c(yc=>this.Ajb.K(yc)||this.BH.K(yc),yb),!1):!0});return 0<Xa.length?(ea=Xa.K(0),{returnValue:!0,Moi:ea}):{returnValue:!1,Moi:ea}}IZf(ea){return ea===gl.a.KCa||ea===gl.a.Bp||ea===gl.a.Lna||ea===gl.a.Ica}$3c(ea,Xa){var yb=ea(Xa);Xa=new rj.a;if(!this.IZf(yb.sc))return Xa;yb=this.xg.getPropertyObjectIds(yb,Mm.a.rg);for(let Ub=0;Ub<yb.length;Ub++){const yc=new rj.a;this.wLf(ea,yb.K(Ub),yc);Xa.SA(Xa.length,yc)}return Xa}wLf(ea,Xa,yb){var Ub=ea(Xa);if(Ub)if(Ub.sc===gl.a.paragraphNode)yb.add(Xa);
else if(Ub.sc===gl.a.UX)Xa=this.xg.getPropertyObjectIds(Ub,Mm.a.VG).ug(0),this.wLf(ea,Xa,yb);else if(Ub.sc===gl.a.Bp||Ub.sc===gl.a.Lna||Ub.sc===gl.a.Ica)for(Xa=this.xg.getPropertyObjectIds(Ub,Mm.a.rg),Ub=0;Ub<Xa.length;Ub++)this.wLf(ea,Xa.K(Ub),yb)}yee(ea,Xa){for(let yb=0;yb<ea.length;yb++)if(Xa.equals(ea.K(yb)))return!0;return!1}}Object(f.a)(Vp,"GraphMergeSelectionRecordUpdater",null,[]);var zs=d(659),sp=d(297);class Lq extends jn.a{constructor(ea=null,Xa=null,yb=null,Ub=null,yc=null,ad=null,md=
null,Sd=null,ze=null,Ne=null,ng=null){var Ng;super();this.Gai=uh=>{const Oh=uh.DJ,Hj=Ld.StaticActiveAppFrame.za().kb.hd;return Object(zs.b)({cB:uh,sm:Oh,fileId:Hj.fileId,Tga:Hj.Tga,contextId:Hj.contextId,M1d:Oh?Oh.id:zi.a.nil,ndb:this.ndb,Dde:!1,Tae:!0,cellId:Hj.Hc.id},!0,Hj.Hc.store)};this.ZS=ea||(()=>m.AFrameworkApplication.rootQuerySignature);Xa||(Xa=uh=>new rp.a(uh));this.pCh=Xa;this.xg=yb||new Ji.a;this.Pah=md||new Gn.ChildNodeListMerge(this.tf);this.o$b=Sd;this.ndb||(this.o$b=(uh,Oh,Hj)=>new Fn.a(uh,
Oh,Hj));this.b9b=Ub||this.E3c();this.qib=yc||new cj.a;this.Qjh=ad||new qr(this.tf);this.nuh=(null===(Ng=m.AFrameworkApplication.J)||void 0===Ng?void 0:Ng.jc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.aFa=ze;this.OPa=Ne;this.K9d=this.VSl(ng);this.ohh=()=>Fa.a.instance.Oa("Box4.IFeatureHelper")}VSl(ea){ea||(ea=Up.none,ea=m.AFrameworkApplication.J?m.AFrameworkApplication.J.jc("WordEditorGraphMergeBackupCasesBrowser",ea):ea);return ea}ZJa(){return(new Date).getTime()}yYj(ea,...Xa){return String.format.apply(null,
[ea].concat(Xa))}flp(ea){throw Jq.a.invalidOperation(ea);}Q5d(ea){return String.format("Name: {0}, Message: {1}, Stack: {2}",ea.name,ea.message,ea.stack)}Jfo(ea){if(this.aFa&&this.aFa.W2i||!this.Ggp(ea))return null;this.SFn(ea);let Xa;({ucl:Ub,Gkp:yc,GLp:Xa}=this.jKl(ea,this.Gai));const yb=jn.a.wum(ea);var Ub=bo.construct(this.ZS(),Ub.nEa(),yc.nEa(),Xa.nEa(),ea.input.VRb,ea.input.zma,ea.input.il,ea.input.IVb,ea.input.source,yb,this.OPa.YCa);var yc=ea.output.NL;yb===ml.success&&0<yc.length&&(Ub.MergedRevision=
this.Gai(ea.output.NL.last()));return Ub}sZc(ea,Xa){return(new Vp(ea)).sZc(Xa)}rZc(ea,Xa,yb,Ub){return(new Vp(ea)).rZc(Xa,yb,Ub)}}Object(f.a)(Lq,"GraphMerger",jn.a,[]);Object(sp.a)(qr,{merge:!0});class Ak extends Lq{constructor(ea,Xa=null,yb=null){super(ea,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Xa,yb);this.sa=new U.a}get YCa(){return this.OPa?this.OPa.YCa:Ah.a.unknown}get CNb(){return null}set CNb(ea){}v1k(ea){this.sa.addHandler(Ak.kPf,ea)}jCo(ea){this.sa.removeHandler(Ak.kPf,ea)}PAg(){return!1}GVb(ea,
Xa,yb,Ub,yc,ad,md){(ea=super.GVb(ea,Xa,yb,Ub,yc,ad,md))&&this.sa.raiseEvent(Ak.kPf,new Si(ea));return ea}}Ak.kPf="GMC";Object(f.a)(Ak,"WordEditorGraphMerger",Lq,[864,865,866]);class Jr{constructor(){this.Z=null}get name(){return"WordEditor.GraphMerge"}wc(ea){this.Z=ea;this.Z.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Rm(this.Z.Ta("WordEditor.IBusinessBarController"),new nc.a(()=>ea.Oa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",
()=>new En(this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();this.Z.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Ak(()=>m.AFrameworkApplication.rootQuerySignature,this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Gj(()=>
m.AFrameworkApplication.rootQuerySignature,m.AFrameworkApplication.va,this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){Uh.a.tS||(Uh.a.tS=bi.a.laa());const ea=this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Uh.a.tS.mdl(ea);this.Z.resolve("Box4.IGraphMergeBackupManager")}dispose(){let ea=this.Z.Oa("Box4.IGraphMergeBackupManager");
ea&&ea.dispose()}}Object(f.a)(Jr,"GraphMergePackage",null,[0,1]);var Vo=d(292);class vq{constructor(ea){this.QMe="FontPicker";this.LWe=null;this.JOb=Xa=>{this.LWe=Xa.isEnabled;Xa=appChrome.actions.updateFontPickerLicenseState(this.QMe,Xa.isEnabled);appChrome.api.dispatch(Xa)};this.tgb=ea;this.MAd=this.tgb.Cua(Vo.a.IUb,this.JOb);this.tgb.isFeatureEnabled(Vo.a.IUb,!1).then(Xa=>{this.LWe=Xa})}get isLicensed(){return this.LWe}dispose(){this.tgb.iZb(Vo.a.IUb,this.MAd)}}Object(f.a)(vq,"ModernFontPickerFeatureHelper",
null,[2001,10]);var rr=d(494),om=d(648),qn=d(1676);class as{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(as,"FontInfoTaskPaneProps",null,[]);class pm{constructor(ea,Xa,yb,Ub=null){this.yaf=this.bZ=this.MAd=null;this._state=this.y8b=0;this.onOpen=()=>{this._state=2;this.LN()};this.onShow=yc=>{0!==this._state&&(this._state=2,1===yc&&(this.y8b=yc),this.LN())};this.onClose=
()=>{this.y8b=this._state=0;this.blur()};this.onHide=()=>{this._state=1;this.y8b=0};this.onUpsellButtonClicked=()=>{this.tgb.launchUpsellExperience(qn.a.experienceId)};this.DZe=ea;this.tgb=Xa;this.Tok=yb;this.Zb=Ub}get Pb(){return this.DZe.value}initialize(){this.Pb.qa(x.a.Rsg,z.a.frame,Object(O.a)(this,this.Rsg,"requestFontInfo"));this.MAd=this.tgb.Cua(Vo.a.IUb,Object(O.a)(this,this.JOb,"featureStateChangeCallback"));this.xna()}mS(ea=!1){const Xa=Cm.UISurfaces.Lv(),yb=this.tgb.isFeatureEnabled(Vo.a.IUb,
!1),Ub=[];Ub.push(Xa);Ub.push(yb);Promise.all(Ub).then(yc=>{yc[0].showTaskPane(qn.a.fPb,this.LB(yc[1]));ea&&this.LN()})}Lzp(ea){Cm.UISurfaces.Lv().then(Xa=>{Xa.updateTaskPane(qn.a.fPb,this.LB(ea));return null})}JOb(ea){this.Lzp(ea.isEnabled)}Rsg(ea,Xa,yb,Ub,yc){this.bZ=yc.CommandValueId;this.yaf=yc.Trigger;this.y8b=yc.InputMethod;this.mS(2===this._state&&1===this.y8b);return 32}LB(ea){const Xa=new as;Xa.onUpsellButtonClicked=this.onUpsellButtonClicked;Xa.fontName=this.bZ;Xa.isLicensed=ea;Xa.trigger=
this.yaf;Xa.helpArticleUrl=this.jzl();Xa.paneId=qn.a.fPb;ea=this.m7m();ea.contentProps=Xa;return ea}m7m(){return Object.assign(new hn.a,{title:qn.a.ltc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:this.onOpen,onClose:this.onClose,onShow:this.onShow,onHide:this.onHide})}xna(){if(this.Zb){var ea=this.Zb.ie(qn.a.fPb);ea.parent=qh.AFrame.Gq;ea.IL=!0}}LN(){this.Zb&&1===this.y8b&&this.Zb.Gg(qn.a.fPb)}blur(){this.Zb&&this.Zb.currentScope&&
this.Zb.currentScope.name===qn.a.fPb&&this.Zb.Gg(this.Zb.QW)}dispose(){this.tgb.iZb(Vo.a.IUb,this.MAd)}jzl(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.Tok,this.qvm(),"WDWAENDUSER",m.AFrameworkApplication.lcid)}qvm(){switch(this.yaf){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return pm.Ufl(this.bZ)}static Ufl(ea){let Xa=
"hlpFontInfo";for(let yb=0;yb<ea.length;++yb){const Ub=La.a.charAt(ea,yb);if(255<ea.charCodeAt(yb)||La.a.p8c(Ub))Xa+=Ub}return Xa}}Object(f.a)(pm,"FontInfoPane",null,[1942,10]);class oj extends pm{constructor(ea,Xa,yb,Ub,yc){super(ea,Xa,Ub.jb("FontInfoHelpBaseUrl"),yc);this.V5=yb}mS(ea){this.g2();super.mS(ea)}JOb(ea){super.JOb(ea);Ld.StaticActiveAppFrame.za().Ge()}g2(){this.V5.iUa()}}Object(f.a)(oj,"WordEditorFontInfoPane",pm,[]);class Uf{constructor(){this.V6b=this.RGd=this.LHc=this.Z=null}get name(){return"WordEditor.ModernFontPicker"}wc(ea){this.Z=
ea;ea.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new vq(this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();ea.ia("Common.ModernFontPicker.IFontInfoPane",()=>new oj(new nc.a(()=>m.AFrameworkApplication.va),this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ml.a.instance,m.AFrameworkApplication.J,th.FocusManager.instance())).ha()}init(){this.RGd=this.Z.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");
this.LHc=this.Z.resolve("Common.ModernFontPicker.IFontInfoPane");this.LHc.initialize();m.AFrameworkApplication.J.$("IsAnonymousUser")||((this.V6b=this.Z.Oa(om.a))?this.V6b.initialize():va.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Ld.StaticActiveAppFrame.za().Ge()}dispose(){this.LHc&&(this.LHc.dispose(),this.LHc=null);this.RGd&&(this.RGd.dispose(),this.RGd=null);this.V6b&&(this.V6b.Uya(),this.V6b=null)}static main(){Object(rr.a)()&&K.a.instance.Mc(new Uf)}}
Object(f.a)(Uf,"ModernFontPickerPackage",null,[0,1]);var si=d(67),$l=d(6),Wp=d(768),$f=d(31),co=d(1115);class ji{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng=null){this.$0=yb;this.fd=ea;this.Rc=Xa;this.Vh=yc;this.zPa=ad;this.MY=md;this.tah=Sd;this.sah=ze;this.uz=Ne;this.osk=Ng||ji.Cx}get Lh(){return this.uz?this.uz.Lh:!1}VRi(ea){return this.SKa(ea,0)}Q$m(ea){return this.SKa(ea,1)}SKa(ea,Xa){let yb=null;if(this.Lh&&this.MY&&(this.sah.instance&&this.sah.instance.GOa(ea),Xa?1===Xa&&(yb=this.MY.sBi(ea.node)):
yb=this.MY.pHf(ea.node,ea.cpBegin,ea.Fb),yb&&!yb.ka(Fh.a.eba,!1)))return va.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const Ub=$l.a.bX(this.fd.Ql());Ub.set(ea.node);Ub.zb(10);const yc=this.Rc.Lc(15);yc.ju(Ub);Xa?$f.OutlineElementNavigator.me(Ub):(this.G_a(Ub,ea),this.$0.wAc(ea.node,gj.a.Pu));ea=Wk.ParagraphReader.Zm(Ub.currentNode);this.pbn(Ub);this.Lh&&yb&&this.tah&&(Xa=new eb.a,Xa.add(Ub.currentNode),this.tah.vMh(Xa,yb.id));this.fWo(ea);
yc.dispose();return 32}fWo(ea){ea=ih.SelectionFactory.ue(ea,0);Zh.a.instance.Kc(ea)}pbn(ea){this.Vh.yy(ea,!0,!0,null,!1,!1);ea=$f.OutlineElementNavigator.Me(ea);this.R$m(ea)}G_a(ea,Xa){const yb=$f.OutlineElementNavigator.me(ea);if(Xa.cpBegin||this.Lh&&(!this.Lh||-1!==Xa.Fb)){ne.a.xd().xm&&Xa.cpBegin!==Wk.ParagraphReader.textLength(Xa.node)&&ne.a.xd().Bk.IG(Xa.node);this.Vh.yy(ea,!1,!0,null,!1,!0);var Ub=$l.a.bX(this.fd.Ql());Ub.set(yb);this.Vh.Eca(Ub,ea,Xa,!0,!0,!0)}}R$m(ea){ea=this.osk(ea);this.zPa.sSi(ea)}static YG(){return new ji(new Gi.a,
new fe.a,Fa.a.instance.resolve("Box4.IAutoCorrectScheduler"),co.a.instance,Fa.a.instance.resolve("Box4.IOutlineElementEditor"),Fa.a.instance.resolve("Box4.IBlobEditor"),Fa.a.instance.Oa("Box4.IContentControlReader"),Fa.a.instance.Oa("Box4.IContentControlEditor"),Fa.a.instance.Ta("Box4.IContentControlConverter"),Fa.a.instance.Oa("Box4.ContentControlConfigSettings"),Fa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=ji.OYg?ji.OYg:ji.OYg=ji.YG()}static Cx(ea){return tf.a.Cx(ea)}}
Object(f.a)(ji,"PageBreakInserter",null,[910]);class tp{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){this.sbn=(ze,Ne,ng,Ng)=>{var uh=Ne.view,Oh=uh.lb.Pg;if(!Oh)return 2;if(!this.pnf(Ne))return 8;if(1===ng)return 32;let Hj=!0;ng=8;const Da=this.KXe(Oh);Oh=this.Rc.Lc(15);Oh.Ab(uh.vd);Oh.Ph=ze;Da||(ng=this.ga.Hf(Ne,Wg.a.Bra,2,!0,Ng,null),ze=32===ng,va.ULS.shipAssertTag(4208012,314,ze),Hj=ze);Hj&&(uh=uh.lb.Pg,ze=this.KXe(uh),va.ULS.shipAssertTag(4208013,314,ze,"{0}",{["ContextId"]:Ne.contextId}),ng=8,ze&&(ng=
this.tVe.VRi(uh),va.ULS.shipAssertTag(4208014,314,32===ng)));Oh.dispose();32===ng&&this.Zd.Yu(10);return ng};this.rbn=(ze,Ne,ng)=>{if(!Ne||Ne.contextId!==he.a.Vc)return 8;if(1===ng)return Ne.contextId===he.a.Vc?32:8;if(2===ng){if(!this.pnf(Ne))return 8;ze=this.tVe.VRi(Ne);32===ze&&this.Zd.Yu(10);return ze}return 32};this.qbn=(ze,Ne,ng)=>{if(!Ne||Ne.contextId!==he.a.table)return 8;if(1===ng)return 32;if(2===ng){if(!this.pnf(Ne))return 8;ze=this.tVe.Q$m(Ne);32===ze&&this.Zd.Yu(10);return ze}return 32};
this.ga=ea;this.tVe=Xa;this.Rc=yb;this.Vn=Ub;this.KXe=yc;this.xl=ad;this.xBk=md;this.Zd=Sd}Xb(){this.ga.qa(Ef.a.SKa,he.a.view,this.sbn);this.ga.qa(Ef.a.SKa,he.a.Vc,this.rbn);this.ga.qa(Ef.a.SKa,he.a.table,this.qbn);this.ga.Pc(Ef.a.SKa,4)}o8(){const ea=th.FocusManager.instance().ie(si.a.AF);qh.AFrame.gj(ea,ug.KeyInputManager.oc(gj.a.Pu,ug.KeyInputManager.li),Ef.a.SKa)}Rmn(ea){return this.Ix(ea.iterator)}Oqn(ea){ea=ea.K(0);const Xa=Rf.a.vk(ea,!0,!1);if(this.Ix(Xa.Qa.iterator))return!0;ea=Rf.a.vk(ea,
!1,!1);return this.Ix(ea.Qa.iterator)}Ix(ea){return ea.zb(14)}pnf(ea){let Xa=null,yb=ea;if(yb.contextId===he.a.view){Xa=yb.view;if(!Xa.features.$Eg)return!1;yb=Xa.lb.Pg;if(!yb)return!1}else{const Ub=$l.a.eb(yb.node);if(Ub.zb(36)||Ub.zb(38)||Ub.zb(40)||Ub.zb(14))return!1}return Wp.a.iba(ea)?!1:yb.contextId===he.a.table?this.xl.Cmn(yb.node):!this.xl.Amn(yb)||this.Vn&&this.Vn.instance&&this.Vn.instance.zX(yb)?!1:((ea=this.KXe(yb))?this.Rmn(yb):this.Oqn(Xa.lb.gb))||ea&&this.xBk(yb,!0)?!1:!0}static YG(){return new tp(m.AFrameworkApplication.va,
ji.instance,new fe.a,Fa.a.instance.Ta("Box4.IExternalSelectionManager"),Rf.a.mf,Te.a.instance,pf.a.CBa,Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=tp.GXg?tp.GXg:tp.GXg=tp.YG()}}Object(f.a)(tp,"PageBreakActor",null,[862]);class Hn{constructor(){this.r2e=this.Z=null}get name(){return"WordEditor.PageBreak"}wc(ea){this.Z=ea}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){this.r2e=tp.instance;this.r2e.Xb();
this.r2e.o8();Ld.StaticActiveAppFrame.za().Ge()}dispose(){}}Object(f.a)(Hn,"PackageManager",null,[0,1]);var nk=d(1281);class ej{constructor(ea,Xa,yb){this.ga=ea;this.uyh=Xa;this.DQ=yb}Xb(){this.ga.fb(Ef.a.bjd,he.a.application,this.bjd.bind(this),96);this.ga.fb(Ef.a.JCe,he.a.application,this.JCe.bind(this),96)}JCe(ea,Xa,yb){return 1===yb?32:this.ga.Ob(Ef.a.b0a,2)}bjd(ea,Xa,yb,Ub,yc){if(1===yb)return 32;ea=this.uyh.getTotalPageCount();-1===ea?ea="":1===this.DQ.Gv||2===this.DQ.Gv?(Xa=this.uyh.Vom(),
Xa>ea&&(ea=Xa),ea=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,Xa,ea)):ea=1===ea?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,ea):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,ea);yc[nk.a.Visible]=!0;yc[nk.a.LabelText]=ea;return 32}}Object(f.a)(ej,"PaginationActor",null,[]);class Wo{constructor(){this.ixa=!1;this.M6k=()=>{this.CRh()}}get name(){return"WordEditor.Pagination"}wc(ea){this.Z=ea;this.Fd=this.Z.resolve("Box4.IFeatureHelper");
this.Z.ia("WordEditor.Pagination.PaginationActor",()=>new ej(m.AFrameworkApplication.va,this.Z.resolve("WordEditor.IPageNumberFinder"),this.Z.resolve("WordEditor.IMainViewModeManager"))).ha()}init(){this.Fd.er.continueWith(()=>{this.Ho()})}Ho(){const ea=Ld.StaticActiveAppFrame.za().kb;ea.uBa?this.CRh():ea.Qja(this.M6k)}CRh(){this.ixa||(this.ixa=!0,Fa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Xb())}dispose(){}}Object(f.a)(Wo,"PackageManager",null,[0,1]);class Ki{constructor(){this.Z=
null}wc(ea){this.Z=ea||Fa.a.instance}dispose(){}}Object(f.a)(Ki,"TellMePackage",null,[0,1]);var kk=d(1407),kn=d(1411),bs=d(354),ln=d(1406),wq=d(1287);class qm{constructor(ea=null,Xa=null,yb=null,Ub,yc=null){this.uJe=null;this.s8g=!1;this.Ohh=this.e4b=null;this.QNk=this.EEh=this.Rnk=this.Phh=!1;this.wyd=null;this.hok=null==Xa?m.AFrameworkApplication.QKb:Xa;this.Szk=null==yb?m.AFrameworkApplication.Y2:yb;this.vOk=null==yc?m.AFrameworkApplication.reb:yc;this.syk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeHelpOnHelpIsEnabled");
this.gQk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled");this.U0o(!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIgnoreQueryForHelp"));this.YPk=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.$$c;this.ZPk=!ln.a.Wfa()&&!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePeopleSuggestionIsEnabled");this.XPk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeFileSuggestionIsEnabled");this.wvk=!!m.AFrameworkApplication.ua&&
m.AFrameworkApplication.ua.Gb.l0b;this.$Pk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.wNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HelpShowsTopSearchResult");this.DHk=this.Uod||this.Tod;this.BHk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("OnlineCommandSuggestionsIsEnabled");this.CHk=this.nZf;this.lCk=!!m.AFrameworkApplication.J&&this.V_a&&m.AFrameworkApplication.J.$("StyledHeaderInLabelIsEnabled");this.Swk=
m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.wxk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.Gwk=m.AFrameworkApplication.J?parseFloat(m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.hCk=!!m.AFrameworkApplication.J&&
(m.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.MBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.ICk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.oAk=!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.bwn||this.qpn);this.cac=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.dPk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";
this.zxk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.xNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.iOk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.MNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("ShowFindInDocumentInZeroTermSearchBox")||
this.oS;this.wCk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeTemplateProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.IBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.aCk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===
m.AFrameworkApplication.uiCulture;this.tCk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeFeedbackProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.KCk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Unk=this.V_a&&!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.Zxk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.oOk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==m.AFrameworkApplication.J.jb("Application"));this.qpk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.$Rk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePerformanceMarkerEnabled");this.rAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.vAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.vxk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.vCk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeNotesSuggestionIsEnabled")||this.gun;this.tAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.uAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.sAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.yuk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.zuk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.xuk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.V7h&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.aQk=
this.P2i&&(this.Kgg||this.Lgg||this.Sfd||this.V_a&&ln.a.ota()&&!!m.AFrameworkApplication.J&&(this.Bxc||this.q0b||this.r0b||this.s0b||this.t0b||m.AFrameworkApplication.J.$("ShowAnswerSearchResults")||m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")||m.AFrameworkApplication.J.$("ShowEntitySearchResults")||m.AFrameworkApplication.J.$("ShowWolframSearchResults")));this.Smk=!!m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&m.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&
m.AFrameworkApplication.K5a;this.Tmk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled");this.c8m(ea||{});this.P6e="2918242107";this.O6e="1454393937";this.bHb={};this.tlb=[];this.dBl=[ln.a.yDe]}get application(){return this.e4b}get QKb(){return this.hok}get QNo(){return this.P6e}get PNo(){return this.O6e}get rCf(){return this.Ohh}get boi(){return this.Phh}get Y2(){return this.Szk}get reb(){return this.vOk}get MKb(){return this.Rnk}get r0m(){return this.syk}get Wjp(){return this.gQk}get P2i(){return!0}get Ljp(){return this.aQk}get a4o(){return this.EEh}U0o(ea){this.EEh=
ea}get V_a(){return this.YPk}get $qd(){return this.ZPk}get Yqd(){return this.XPk}get a7l(){return this.wvk}get Jjp(){return this.$Pk}get gDe(){return!1}get Sfd(){return this.DHk}get Kgg(){return this.BHk}get Lgg(){return this.CHk}get xab(){return!1}get Jfe(){return!1}get d0f(){return this.lCk}get Pye(){return this.QNk}get Bxc(){return!1}get I5o(){return!1}get Qzn(){return""}get CKf(){return 2}get IHm(){return 4}get JHm(){return 5}get oGi(){return""}get dsm(){return this.Swk}get FGi(){return this.wxk}get qGi(){return 1E3}get pGi(){return 1E-6}get hgp(){return this.dPk}get IEg(){return!1}get YYj(){return!1}get Krn(){return this.aCk}get ofe(){return!1}get pfe(){return!1}get XZi(){return!1}get WZi(){return!1}get gun(){return!1}get Q2i(){return!1}get M2d(){return!1}get Oyb(){return!1}get q0b(){return!1}get r0b(){return!1}get s0b(){return!1}get t0b(){return!1}get Uod(){return this.wNk}get vxc(){return this.xNk}get Tod(){return!1}get xHf(){return null}get hfe(){return!1}get Hye(){return this.MNk}get BCi(){return 0}get Olm(){return this.Gwk}get kHi(){return this.zxk}get Xsn(){return this.hCk}get bWf(){return this.oAk}get Gye(){return this.cac}get cBm(){return-3.9}get oS(){return this.iOk}get aad(){return this.wCk}get BZf(){return this.IBk}get w0f(){return this.tCk}get tmb(){return this.Unk}get lwn(){return this.KCk}get TAa(){return this.Zxk}get QVj(){return this.oOk}get kfl(){return this.qpk}get eFe(){return this.$Rk}get yce(){return this.rAk}get Sen(){return this.vAk}get kw(){return this.vxk}get Ztb(){return this.vCk}get Qen(){return this.tAk}get Ren(){return this.uAk}get Pen(){return this.sAk}get r3k(){return this.Smk}get s3k(){return this.Tmk}get Rka(){return this.yuk}get D0d(){return this.zuk}get mhc(){return this.xuk}get bwn(){return this.ICk}get qpn(){return this.MBk}get NTb(){return!!m.AFrameworkApplication.ua&&
m.AFrameworkApplication.ua.Gb.Bs}get Bs(){return!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.Bs}get fon(){return!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.yxc}get gSn(){return Lf.getImageClass("OfficeAssistant_32x32x32")}X5d(){return Promise.reject("GetFindMatchCount method is not overridden")}bge(ea){return Array.contains(appChrome.selectors.getVisibleControlIds(),ea)}cde(){return!1}get ree(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeModelRankerEnabled")}get P_j(){return m.AFrameworkApplication.J?
m.AFrameworkApplication.J.jb("TellMeServiceHelpClassifierModelName"):""}get nZf(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeMultiLingualCommandModelEnabled")}get CRb(){return"NoOpHeaderUi"}get $Al(){return this.wyd}get parameterData(){return this.bHb}get Drp(){return this.tlb}B2l(){if(this.uJe&&!this.s8g&&(this.s8g=!0,this.Gyb(this.uJe),this.Bs)){var ea=Fa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");ea=(new wq.a(ea)).n4d(this.uJe.bJ);appChrome.api.dispatch(ea)}}Gyb(){}mTl(ea){const Xa=
[];for(let yb=0;yb<ea.length;++yb)ea[yb].J6o?Xa.push(new bs.a(ea[yb].Fn,ln.a.i4j+yb.toString())):Xa.push(new bs.a(ea[yb].standard,ln.a.yDe+yb.toString()));return Xa}c8m(ea){const Xa={};for(const yb in ea){const Ub=yb,yc=ea[yb];for(const ad in yc){const md=ad,Sd=yc[ad];(Xa[md]||(Xa[md]={}))[Ub]=Sd}}this.wyd=Xa}get Q_j(){return""}get IUj(){return!1}}Object(f.a)(qm,"TellMeApplicationData",null,[1885]);class mo{constructor(ea,Xa=null,yb=!1){this.standard=ea;this.Fn=Xa;this.J6o=yb}}Object(f.a)(mo,"TryQuerySet",
null,[]);class no{constructor(){this.$uh=this.avh=null}get dPn(){return this.$uh}Aka(ea){this.avh=ea;return this.Isf(ea)}vTn(){this.$uh=this.avh}M6d(ea){return 8===ea.type?String.format(CommonUIStrings.l_FindInDocumentText,ea.BE):ea.BE}YGf(ea){return ea.BE}}Object(f.a)(no,"ParameterizedCommand",null,[]);class Io extends no{constructor(ea){super();this.M$c=ea}get commandId(){return this.M$c?"DefinitionsParameterized":"DefinitionButton"}get tig(){return"Definition"}Isf(ea){const Xa=La.a.yf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
ea.BE));return Pe.a(ln.a.ztf(ea.value),x.a.$uf.toString(),Xa,ln.a.jVf,null,La.a.yf(ln.a.ZMb(ea.BE)),Xa,null,null)}M6d(ea){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,ea.BE)}YGf(ea){return ln.a.ZMb(ea.BE)}}Object(f.a)(Io,"DefinitionsParameterizedCommand",no,[]);class Nl extends no{constructor(ea){super();this.M$c=ea}get commandId(){return this.M$c?m.AFrameworkApplication.ua.Gb.mkn?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get tig(){return"Find"}Isf(ea){const Xa=
La.a.yf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,ea.BE));return Pe.a(ln.a.ztf(ea.value),x.a.fic.toString(),Xa,"Find_16x16x32",null,La.a.yf(ea.BE),Xa,null,null)}M6d(ea){return String.format(CommonUIStrings.l_TextWithQuotation,ea.BE)}}Object(f.a)(Nl,"FindParameterizedCommand",no,[]);class nl extends no{constructor(ea){super();this.M$c=ea}get commandId(){return this.M$c?"SynonymsParameterized":"SynonymButton"}get tig(){return"Synonym"}Isf(ea){const Xa=La.a.yf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
ea.BE));return Pe.a(ln.a.ztf(ea.value),x.a.$uf.toString(),Xa,ln.a.jVf,null,La.a.yf(ln.a.ZMb(ea.BE)),Xa,null,null)}M6d(ea){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,ea.BE)}YGf(ea){return ln.a.ZMb(ea.BE)}}Object(f.a)(nl,"SynonymsParameterizedCommand",no,[]);var Ol=d(2148),cs=d(2176),ds=d(2183),Nk=d(2134),er=d(2135),es=d(1542);class up extends Ol.a{constructor(){super(...arguments);this.nT=null;this.S4a=cs.a.createInstance(this,ds.a.instance,es.a.instance,
!0,!0)}static get instance(){return up._instance}dic(){this.nT(this.S4a.Ak.Qna);this.S4a.k6a(!0)}X5d(ea){const Xa=new Promise((yb,Ub)=>{this.nT=yb;setTimeout(()=>{Ub("Find manager execution timed out");this.S4a.k6a(!0)},500)});ea=Nk.a.createQuery(ea,er.a.none);this.S4a.find(ea);return Xa}}up._instance=new up;Object(f.a)(up,"TellMeFindStatusSpy",Ol.a,[]);class Wl extends qm{constructor(ea){super({});this.e4b="Word";this.dxk=ea;m.AFrameworkApplication.J.$("TellMeFindInDocumentIsEnabled")&&(this.Phh=
!0,this.Ohh=this.M2d?"FindWithMatchesParameterized":"FindParameterized");ea=new Io(this.NTb);const Xa=new nl(this.NTb);this.parameterData[ea.commandId]=ea;this.parameterData[Xa.commandId]=Xa;ea=new Nl(this.NTb);this.parameterData[ea.commandId]=ea;m.AFrameworkApplication.J.$("TellMeTryQueriesIsEnabled")&&(ea=[new mo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new mo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new mo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,
"",!1),new mo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new mo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.tlb=this.mTl(ea))}X5d(ea){return up.instance.X5d(ea)}get pdb(){return si.a.Qua}get CRb(){return si.a.cWa}Gyb(ea){var Xa=m.AFrameworkApplication.J;ea=ea.bJ;ea.WordCountFlyout=!this.dxk();ea.SelectAllButton=!Xa.$("TellMeSelectAllResultIsEnabled");const yb=Xa.$("TellMeDesktopUpSellIsEnabled");let Ub=m.AFrameworkApplication.Kfe;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",
!Ub));Ub=!1;ea.TextBoxUpSellButton=!yb||Ub;ea.TableOfContentsUpSellButton=!yb||Ub;ea.SmartArtUpSellButton=!yb||Ub;ea.WordArtUpSellButton=!yb||Ub;ea.MultiColumnLayoutUpSellButton=!yb||Ub;ea.InsertEquationUpSellButton=!yb||Ub;ea.TrackChangesUpSellButton=!yb||Ub;ea.ShapesUpSellButton=!yb||Ub;ea.LabelsUpSellButton=!yb||Ub;ea.InsertCitationUpSellButton=!yb||Ub;ea.TextBoxUpSellButtonEnterprise=!yb||!Ub;ea.TableOfContentsUpSellButtonEnterprise=!yb||!Ub;ea.SmartArtUpSellButtonEnterprise=!yb||!Ub;ea.WordArtUpSellButtonEnterprise=
!yb||!Ub;ea.MultiColumnLayoutUpSellButtonEnterprise=!yb||!Ub;ea.InsertEquationUpSellButtonEnterprise=!yb||!Ub;ea.TrackChangesUpSellButtonEnterprise=!yb||!Ub;ea.ShapesUpSellButtonEnterprise=!yb||!Ub;ea.LabelsUpSellButtonEnterprise=!yb||!Ub;ea.InsertCitationUpSellButtonEnterprise=!yb||!Ub;Xa=!Xa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!m.AFrameworkApplication.Y2;ea.SynonymButton=Xa;ea.DefinitionButton=Xa}get Q_j(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get IEg(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get P_j(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Bxc(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get nZf(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get CKf(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get IUj(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get Jfe(){return m.AFrameworkApplication.J.$("TellMeRankerLoggingIsEnabled")&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get ree(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get ofe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get pfe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get qGi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get pGi(){return 1E-6*m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get XZi(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get WZi(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get oGi(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get Q2i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get BCi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get P2i(){return m.AFrameworkApplication.J.$("TellMeServiceForSearchIsEnabled")}get gDe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get xab(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Pye(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get YYj(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get hfe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get q0b(){return m.AFrameworkApplication.J.$("ShowAnswerSearchResults")}get r0b(){return m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")}get s0b(){return m.AFrameworkApplication.J.$("ShowEntitySearchResults")}get t0b(){return m.AFrameworkApplication.J.$("ShowWolframSearchResults")}get xHf(){return m.AFrameworkApplication.J.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(Wl,"WordEditorTellMeApplicationData",qm,[]);var Jo=d(1474),rn;(function(ea){ea[ea.none=0]="none";ea[ea.SMg=1]="waitAll";ea[ea.uoq=2]="synchronizeFast";ea[ea.whp=3]="synchronizeSlow"})(rn||(rn={}));Object(f.b)("ProviderSynchronizationType",rn);var rm;(function(ea){ea[ea.immediate=0]="immediate";ea[ea.SMg=1]="waitAll";ea[ea.soq=2]="synchronizeAndWaitAll";ea[ea.toq=3]="synchronizeAndWaitForRanker"})(rm||(rm={}));Object(f.b)("MenuUpdatePolicy",
rm);var In=d(1416),Sm=d(1413),Fo=d(1620),sm=d(1417),Xo=d(1465),eo=d(122),fr=d(302);class bn extends Ol.a{constructor(ea){super();this.XSk=ea}dic(){this.XSk.update()}}Object(f.a)(bn,"TellMeFindStatusManager",Ol.a,[]);class Ig{constructor(ea){this.olb=this.P$g=null;this.ki=0;this.IDd="TellMeWAC.";const Xa=ea.rCf;this.kc=ea;this.$Ad=Xa;this.AZe=Object.assign(new Jo.a,{landingTab:"Indoc",data:null});ea=new bn(this);this.S4a=cs.a.createInstance(ea,ds.a.instance,es.a.instance,!0,!0)}lN(){return"WordFindInDocument"}gX(){return this.kc.CKf?
this.kc.CKf===rm.SMg?rn.SMg:rn.whp:rn.none}XJ(ea,Xa){this.tvn(ea)?(this.olb=ea,this.P$g=Xa,ea=Nk.a.createQuery(ea.Vg,er.a.none),this.ki=window.performance.now(),this.S4a.find(ea)):Xa.Kt(new In.a(ea))}update(){this.PQo(Math.round(window.performance.now()-this.ki));var ea=String.format(CommonUIStrings.l_TextWithQuotation,this.olb.Vg);var Xa=m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Gb.Oyb?ln.a.jUa(this.olb.Vg,15,this.AZe):La.a.yf(this.olb.Vg);const yb=[];yb.push(appChrome.actions.setControlLabel(this.$Ad,
ea));yb.push(appChrome.actions.setCompoundButtonCommandValueId(this.$Ad,Xa));yb.push(appChrome.actions.updateCompoundButtonDescription(this.$Ad,this.iOf()));appChrome.api.dispatch(yb);ea=new Sm.a(this.$Ad,Fo.a.hHe,this.olb.Vg,this.S4a.Ak.Qna.toString());Xa=new sm.a(Xo.a.hHe);Xa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Xa.jy(ea);const Ub=new In.a(this.olb);Ub.gw(Xa);window.requestAnimationFrame(()=>{this.P$g.Kt(Ub)});this.S4a.k6a(!0);this.QQo(Math.round(window.performance.now()-
this.ki))}iOf(){const ea=this.S4a.Ak.Qna.toString();return"1"===ea?String.format(CommonUIStrings.l_SearchResultText,ea):String.format(CommonUIStrings.l_SearchResultsText,ea)}tvn(ea){return!!ea&&!!ea.Vg&&""!==ea.Vg.trim()}PQo(ea){const Xa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.olb.Vg.length};this.sendActivityEvent(Xa,ea)}QQo(ea){const Xa={["Time"]:(new Date).getTime(),["Event"]:"Latency",
["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.olb.Vg.length};this.sendActivityEvent(Xa,ea)}sendActivityEvent(ea,Xa){ea=eo.a.iI(ea);jk.a.DNa(Object.assign(new fr.a,{name:"Latency",dataFields:ea,durationMs:Xa}),this.IDd)}}Object(f.a)(Ig,"WordFindInDocumentWithMatchesProvider",null,[85]);class vp{constructor(ea,Xa){this.Pb=ea;this.Ube=Xa}q$a(ea,Xa,yb){return this.Ube.q$a(0,ea,Xa,yb)}insertHtmlText(ea){return ea?32===this.IUf(ea):!1}IUf(ea){return this.executeCommand(Wg.a.Gqa,
ea)}executeCommand(ea,Xa){const yb=new Hd.DictionaryPropertySet;yb.setValue(Jd.a.XX,Xa);yb.setValue(Jd.a.GDa,!1);Xa=this.Pb.Ob(ea,1);32===Xa&&(Xa=this.Pb.Qb(ea,2,yb));return Xa}}Object(f.a)(vp,"WordInsertContentHandler",null,[84]);class Ko extends Ki{constructor(){super();this.iz=()=>{if(m.AFrameworkApplication.tGg){var ea=Ld.StaticActiveAppFrame.za().Gb.UMf(x.a.mu);ea.V8c?this.ptj():ea.Z1(this.qNo);var Xa=new Wl(()=>!1);kk.TellMeActor.instance.initialize(Xa,null,null,null,null,null,Object(O.a)(Ld.StaticActiveAppFrame.za(),
Ld.StaticActiveAppFrame.za().X3d,"forceUpdateRibbonControls"),m.AFrameworkApplication.J,this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.Ta("Common.IActionContextProvider"),this.Z.Ta("Common.ISystemInitiatedFeedback"));kk.TellMeActor.instance.Gto(ea);kk.TellMeActor.instance.Rvo(new vp(m.AFrameworkApplication.va,this.Z.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));Xa.boi&&Xa.M2d&&kk.TellMeActor.instance.NG(new Ig(Xa),kn.a.mu)}};this.qNo=()=>
{this.ptj()}}get name(){return"WordEditor.TellMe"}init(){m.AFrameworkApplication.J.vp(this.iz)}ptj(){Ld.StaticActiveAppFrame.za().Ge()}}Object(f.a)(Ko,"WordEditorTellMePackage",Ki,[]);class Go{constructor(){this.Z=null;this.S_j=(ea,Xa,yb)=>{2===yb&&(ea=new Xe.StandardDialog,ea.Bd=0,ea.Cna(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>
{this.Ho()})}dispose(){}Ho(){if(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(118)){m.AFrameworkApplication.va.fb(Ef.a.qck,he.a.view,this.S_j,96);var ea=th.FocusManager.instance().ie(si.a.AF);qh.AFrame.gj(ea,ug.KeyInputManager.oc(gj.a.bgb,5|ug.KeyInputManager.li),Ef.a.qck)}}wc(ea){this.Z=ea}static main(){K.a.instance.Mc(new Go)}}Object(f.a)(Go,"WordEditorTestFeaturePackage",null,[0,1]);var As=d(1376),Us=d(112);class Nt{constructor(ea,Xa){this.sIj=ea;this.Pb=Xa;this.lwe=(yb,Ub,yc,ad,md)=>
{if(1===yc)return 32;this.sIj.oC(9,md,!1);return 32};this.dS=(yb,Ub)=>{if(9===Ub.type){var yc;(yb=Ub.jA)?("string"===typeof yb?yc=yb:"data"===yb.type&&(yc=Us.a.Hai(yb.Ggo,yb.newState,yb.X0o)),yc&&Nt.qSc(yc)):va.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.Rjd()}Rjd(){this.Pb.qa(Ef.a.lwe,z.a.frame,this.lwe);this.sIj.AO(this.dS)}dispose(){}static qSc(ea){ea=Ld.StaticActiveAppFrame.za().$J.yka(ea,!1);ea.image=5;ea.Gla="CoAuth_AuthorStatus_16x16x32";
Ld.StaticActiveAppFrame.za().$J.Iz(ea)}}Object(f.a)(Nt,"TrackChangeNotificationActor",null,[]);class Mq{constructor(){this.ei=this.raf=this.Z=null;this.Gfd=()=>{if(this.ei=As.a.U4c().result)this.Z.ia("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Nt(this.ei,m.AFrameworkApplication.va)).ha(),this.raf=this.Z.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}wc(ea){this.Z=ea}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>
{this.Ho()})}Ho(){As.a.U4c().continueWith(this.Gfd)}dispose(){this.raf&&this.raf.dispose()}}Object(f.a)(Mq,"WordEditorTrackChangeNotificationActorPackageManager",null,[0,1]);var Gp=d(105),cn=d(1384),hp=d(2126);class tm{}tm.MJg="UnsavedChanges";tm.NJg="UnsavedChangesThemed";tm.tMo="SavedChanges";tm.u5j="UnsavedChangesOpenPipe";tm.Eup="UnsavedChangesOpenPipeCssClassNameThemed";tm.t5j="UnsavedChangesClosePipe";tm.Bup="UnsavedChangesClosePipeThemed";tm.Cup="UnsavedChanges";tm.Dup="UnsavedChangesThemed";
tm.OJg="UnsavedChangesIndicatorPositionRef";Object(f.a)(tm,"UnsavedChangesHighlightUtils",null,[]);class ip extends cn.a{constructor(ea,Xa){super();this.Mia=ea;this.XD=Xa;this.x5=[this.XD?new hp.a(tm.NJg,tm.Dup):new hp.a(tm.MJg,tm.Cup)]}get Afa(){return!0}get Xrb(){return 4}get U9a(){return this.x5}wMa(ea,Xa){if(this.Mia){var yb=this.Mia.w8f;if(yb&&yb.count&&yb.contains(ea.id))for(ea=Xa.WMa("span"),Xa=0;Xa<ea.length;Xa++)yb=ea[Xa],Xa||yb.classList.add(this.XD?tm.Eup:tm.u5j),Xa===ea.length-1&&yb.classList.add(this.XD?
tm.Bup:tm.t5j),yb.classList.add(this.XD?tm.NJg:tm.MJg)}}p9a(){}}Object(f.a)(ip,"UnsavedChangesHighlightActor",cn.a,[]);var pt=d(1047);class xo{constructor(ea){this.iOe=null;this.Mia=ea;this.GWe=!1}get key(){return"UnsavedChangesHighlight"}get Fv(){return"UnsavedChanges"}reset(ea){if(this.Mia){ea=ea.node;if(Wk.ParagraphReader.Wb(ea)){const Xa=this.Mia.w8f;if(Xa&&Xa.contains(ea.id)){this.GWe=!0;this.iOe=ea.id;return}}this.GWe=!1;this.iOe=zi.a.nil}}rEa(){let ea=null;return this.GWe?(ea=Object.assign(new pt.a,
{dG:this.key,contentObject:this.iOe,description:null}),{returnValue:!0,JG:ea}):{returnValue:!1,JG:ea}}}Object(f.a)(xo,"UnsavedChangesHighlightCpContentDetailsProvider",null,[299,300]);class Ot{constructor(ea,Xa,yb,Ub,yc,ad,md){this.Yuh=null;this.v9=ea;this.lf=Xa;this.zZ=yb;this.V9=Ub;this.bIh=yc;this.Qpa=ad;this.XD=md;this.lf.AHa(this.t0.bind(this))}get w8f(){return this.Yuh}h1m(){if(this.v9){if(1===this.v9.Zof){if(0===this.v9.c2f&&this.v9.epj()){this.Yuh=this.v9.Bje;const ea=this.v9.Dsd;this.v9.uMo.forEach(this.pUl.bind(this));
ea.forEach(this.i1m.bind(this));0<ea.length&&this.$Vl(this.zZ);return 0}return this.xpo(this.v9.c2f)}return 2}return 1}xpo(ea){switch(ea){case 0:return this.v9.ANi()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}sOi(ea,Xa,yb){if(Xa)if(yb){yb=Xa.querySelectorAll("span");for(let Ub=0;Ub<yb.length;Ub++){const yc=yb[Ub];Ub||yc.classList.add(tm.u5j);Ub===yb.length-1&&yc.classList.add(tm.t5j);yc.classList.add(this.XD?tm.NJg:tm.MJg)}Xa.classList.add(tm.OJg);ea&&this.V9.KAc(ea)}else Xa.classList.add(tm.tMo)}Llc(ea,
Xa){const yb=this.hPm(ea);if(ea&&(ea=ea.fg(Ld.StaticActiveAppFrame.za().kb.Qc.Ic)))if(ea.Zf&&ea.Zf.uj&&0!==ea.Zf.uj.count)for(const Ub of ea.Zf.uj)this.sOi(yb,Ub,Xa);else this.sOi(yb,ea.htmlElement,Xa)}hPm(ea){return this.bIh&&(ea=this.bIh.ZQb(ea))&&ea&&(ea=ea.fg(Ld.StaticActiveAppFrame.za().kb.Qc.Ic))?ea:null}i1m(ea){this.Llc(ea,!0);return!0}pUl(ea){this.Llc(ea,!1);return!0}$Vl(ea){ea&&ea.continueWith(()=>{ea.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",
0)})}t0(ea,Xa){Xa===Sys.EventArgs.Empty?va.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Xa&&Xa.errorCode?this.Qpa.TR||(ea=this.h1m(),va.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",ea),pa.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==ea&&4!==ea&&this.aop(ea)):va.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Xa?"Error Code":"Kickout Event Args")}aop(ea){let Xa;const yb=
new Kk.a;yb.extendedProperties=new Map;yb.extendedProperties.set("HighlightUnsavedChangesResult",ea.toString());yb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(ea){case 1:case 2:case 6:Xa="HighlightInternalError";break;case 5:Xa="ChangeOutsideCanvas"}6!==ea&&5!==ea||yb.extendedProperties.set("UnsavedChangesCollectionResult",this.v9.c2f.toString());Xa&&(pa.Health.instance.recordQosError(Xa,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,yb),pa.Health.instance.recordKpiFailure("UnsavedChangesHighlight",
Xa,!0,!0,yb))}dispose(){this.lf.kZb(this.t0.bind(this))}}Object(f.a)(Ot,"UnsavedChangesHighlighter",null,[10]);var Fl=d(874),Ec=d(718),fs=d(1382);class gs extends fs.a{constructor(ea,Xa){super();this.Mia=ea;this.XD=Xa}u_a(ea){if(!this.Mia)return!1;const Xa=this.Mia.w8f;return Xa?Xa.contains(ea.Cb.id)||ea.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}hkl(ea,Xa){Xa=ea.OKa?ea.OKa[Xa]?ea.OKa[Xa].style?ea.OKa[Xa].style.marginLeft:null:null:null;var yb=ea.pma;ea=1440<=yb?-(yb/1440*96):ea.g6a(0,
96,this.zoom);yb=0;Xa&&(Xa=Xa.match(/^(\d+)px/))&&Xa[1]&&(yb=Number(Xa[1]));return ea-yb}Ckl(ea,Xa,yb){return Sys.UI.DomElement.getBounds(ea).y-yb.r7[Xa].y}Yjl(ea){return Sys.UI.DomElement.getBounds(ea).height}Y$h(ea,Xa,yb,Ub){let yc;yc=this.hkl(yb,Xa);Xa=this.Ckl(ea,Xa,yb);ea=this.Yjl(ea);Ub=Fl.a.createElement(Ub,Ec.a.div);Ub.className=this.XD?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Ub.style.left=yc+"px";Ub.style.top=Xa+"px";Ub.style.height=ea+"px";return Ub}n$h(ea,Xa,yb,Ub){const yc=
[],ad=ea.querySelectorAll("."+tm.OJg);if(0===ad.length&&ea.classList.contains(tm.OJg))yb=this.Y$h(ea,Xa,yb,Ub),yb.rka=Xa,yc.push(yb);else for(ea=0;ea<ad.length;ea++){const md=this.Y$h(ad[ea],Xa,yb,Ub);md.rka=Xa;yc.push(md)}return yc}fUa(ea){let Xa=[];var yb=ea.I3;const Ub=yb.Kh.ownerDocument;if(yb.Ij){let yc=0;for(const ad of yb.Zf.uj)(yb=this.n$h(ad,yc,ea,Ub))&&(Xa=Xa.concat(yb)),yc+=1}else Xa=this.n$h(yb.htmlElement,0,ea,Ub);return Xa}}Object(f.a)(gs,"UnsavedChangesIndicatorActor",fs.a,[]);class dk{constructor(){this.dZ=
this.Zx=this.LQa=this.V9=this.sDd=this.Mia=null}get name(){return"WordEditor.UnsavedChangesHighlight"}wc(){}init(){this.V9=Fa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.Mia=new Ot(Fa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),xg.SessionStatusManager.instance,fi.a.sq(Fa.a.instance.Ta("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.V9,Fa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Fa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),
!!Uh.a.instance&&Uh.a.instance.LBa);this.LQa=Fa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager");this.dZ=Fa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.sDd=new gs(this.Mia,!!Uh.a.instance&&Uh.a.instance.LBa);this.V9.eNa(this.sDd);this.LQa&&this.LQa.execute(ea=>{ea.dY(new xo(this.Mia))});this.Zx=new ip(this.Mia,!!Uh.a.instance&&Uh.a.instance.LBa);this.dZ.Vcb(this.Zx)}dispose(){this.V9&&this.sDd&&this.V9.bEe(this.sDd);this.dZ&&this.Zx&&this.dZ.DJg(this.Zx);
Gp.a.AD(this.Mia)}static main(){K.a.instance.Mc(new dk)}}Object(f.a)(dk,"WordEditorUnsavedChangesHighlightPackage",null,[0,1,10]);var Kn=d(204),ek=d(229),am=d(124);class hm{constructor(ea,Xa,yb){this.ga=ea;this.St=Xa;this.Aa=yb}Xb(){this.Aa.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(x.a.Yxc,z.a.frame,Object(O.a)(this.St,this.St.Yxc,"showZoomDialog")),this.ga.fb(x.a.Imo,z.a.frame,Object(O.a)(this.St,this.St.Qmj,"onQueryZoomText"),96),this.ga.qa(x.a.wud,z.a.frame,Object(O.a)(this.St,this.St.Ick,"zoomDialogTabFocusHandler")),
this.ga.qa(x.a.vud,z.a.frame,Object(O.a)(this.St,this.St.Ick,"zoomDialogTabFocusHandler")));this.Aa.$("ZoomSliderIsEnabled")&&(this.ga.fb(x.a.vxj,z.a.frame,Object(O.a)(this.St,this.St.r2n,"onQueryZoomPercentage"),96),this.ga.fb(x.a.Kck,z.a.frame,Object(O.a)(this.St,this.St.V5n,"onZoomToPercentage"),96),this.ga.qa(x.a.XLp,z.a.frame,am.ActionManager.eg))}}Object(f.a)(hm,"CommonZoomActor",null,[1863]);class sr extends hm{constructor(ea,Xa,yb){super(ea,Xa,yb);this.Hja=Xa}Xb(){super.Xb();this.Aa.$("ZoomPopupDialogIsEnabled")&&
(this.ga.qa(Ef.a.aOg,z.a.frame,am.ActionManager.eg),this.ga.qa(Ef.a.DGe,z.a.frame,Object(O.a)(this.Hja,this.Hja.WLp,"zoomTo100")));this.ga.qa(Ef.a.g3b,z.a.frame,Object(O.a)(this.Hja,this.Hja.g3b,"zoomToPageWidth"));this.ga.qa(x.a.osb,z.a.frame,Object(O.a)(this.Hja,this.Hja.osb,"increaseZoom"));this.ga.qa(x.a.vob,z.a.frame,Object(O.a)(this.Hja,this.Hja.vob,"decreaseZoom"));this.ga.qa(Ef.a.Zvg,z.a.frame,Object(O.a)(this.Hja,this.Hja.I0o,"setZoomLevelFromRibbon"));this.ga.fb(Ef.a.Rwb,z.a.frame,Object(O.a)(this.Hja,
this.Hja.Qmj,"onQueryZoomText"),96);this.ga.fb(Ef.a.ese,he.a.application,Object(O.a)(this.Hja,this.Hja.q2n,"onQueryZoomLevelLabelText"),96);this.ga.qa(Wg.a.Ebi,z.a.frame,am.ActionManager.eg);this.ga.qa(Wg.a.Dbi,z.a.frame,am.ActionManager.eg);this.ga.qa(Wg.a.Ibi,z.a.frame,am.ActionManager.eg);this.ga.qa(Wg.a.Fbi,z.a.frame,am.ActionManager.eg);this.ga.qa(Ef.a.$na,z.a.frame,am.ActionManager.eg)}}Object(f.a)(sr,"WordEditorZoomActor",hm,[]);class yj{constructor(ea,Xa){this.zoom=ea;this.n5k=Xa}}Object(f.a)(yj,
"SetCustomZoomArgs",null,[]);var hs=d(1127),Nq=d(180);class wk{constructor(ea,Xa){this.rOl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.sOl=[wk.gwf,wk.e_d,"200","150","100","75","50"];this.xra=3;this.tQ=0;this.delta=.1;this.T2f=0;this.jd=new U.a;this.Ai=null;this.J=ea;this.Pb=Xa;this.IQj(1)}get nl(){return this.tQ}IQj(ea){this.tQ=ea}get dYc(){return Math.round(100*this.nl)}get URn(){return Math.floor(this.dYc/10)/10+this.delta}get TRn(){return Math.ceil(this.dYc/
10)/10-this.delta}get ga(){return m.AFrameworkApplication.va}e3k(ea){this.jd.addHandler("ZoomChanged",ea)}RCo(ea){this.jd.removeHandler("ZoomChanged",ea)}gY(ea){this.e3k(ea)}hNa(ea){this.RCo(ea)}UAj(){}MCj(){}TAj(){}LCj(){}xud(ea){this.Jck(ea,this.nl)}Jck(ea,Xa){null!==ea&&Nq.a.tPj(ea,Xa)}Jzg(ea,Xa=!0){let yb=ea*=100;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(yb=new yj(ea,Xa));this.oNj(yb)}H0o(ea,Xa=!1){this.$na(ea,3|(Xa?0:4))}T5n(ea,Xa,yb){if(1===ea)return 32;ea=yb/100;ea<this.ydd?
ea=this.ydd:ea>this.Zcd&&(ea=this.Zcd);this.$na(ea,1);Xa&&(Xa.Xt=Math.floor(100*ea));return 32}Qmj(ea,Xa,yb,Ub,yc){if(1===yb)return 32;ea=La.a.RJa(this.dYc,6,m.AFrameworkApplication.numberFormat);yc.Value=ea;yc.LabelText=ea;return 32}V5n(ea,Xa,yb,Ub,yc){return 1===yb?32:this.T5n(yb,Ub,yc.value)}r2n(ea,Xa,yb,Ub,yc){yc.MinValue=100*this.ydd;yc.MaxValue=100*this.Zcd;yc.value=this.dYc;return 32}YJi(){return this.rOl}ZJi(){return this.sOl}$om(){let ea=Math.floor(100*this.nl).toString();1===this.xra?ea=
wk.gwf:2===this.xra&&(ea=wk.e_d);return ea}osb(ea,Xa,yb){if(1===yb)return 32;this.ncd(this.Pb?this.Pb.gE:0,"IncreaseZoom");this.xra=0;this.$na(this.URn);return 32}vob(ea,Xa,yb){if(1===yb)return 32;this.ncd(this.Pb?this.Pb.gE:0,"DecreaseZoom");this.xra=0;this.$na(this.TRn);return 32}I0o(ea,Xa,yb,Ub,yc){if(1===yb)return 32;this.ncd(this.Pb?this.Pb.gE:0,"SetZoomLevelFromRibbon");ea=yc.Value;if(ea.toLowerCase().startsWith("fit"))return ea=new jd.a(0,1,0,()=>{this.g3b(0,null,2,null,null)},138,void 0,!0),
qg.a.instance.$b(ea),32;ea=parseInt(ea)/100;if(isNaN(ea))return 2;this.xra=0;this.$na(ea);return 32}ncd(ea,Xa){va.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",ea,Xa,m.AFrameworkApplication.ua.Gb.Bs)}Yxc(ea,Xa,yb){if(1===yb)return 32;va.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const ea=this.$om();this.Ai=new hs.a(this.YJi(),this.ZJi(),Object(O.a)(this,this.lYm,"handleZoomDialogResult"),
th.FocusManager.instance(),!0);this.Ai.Yxc(CommonUIStrings.l_ZoomDialogTitle,ea)}Lin(ea){return ea.toLowerCase()===wk.gwf.toLowerCase()}Min(ea){return ea.toLowerCase()===wk.e_d.toLowerCase()}lYm(ea){if(ea){if(this.Lin(ea)){this.xra=1;var Xa=32}else if(this.Min(ea))this.xra=2,Xa=this.g3b(0,null,2,null,null);else if(Xa=Number.parseInvariant(ea)){this.xra=0;let yb=Xa;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(yb=new yj(Xa,!0));Xa=this.oNj(yb)}else Xa=8;32===Xa?va.ULS.sendTraceTag(7176729,
353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:ea}):va.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:ea})}else va.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:ea})}yoo(){this.jd.raiseEvent("ZoomChanged",null)}Xxj(){}yog(){}Ick(ea){if(!this.Ai)return 2;var Xa=this.Ai.focusManager.$t().Uk.tra;if(Xa===this.Ai.lB&&ea===x.a.wud||Xa===this.Ai.jJ&&ea===x.a.vud)this.Ai.eKb||this.Ai.AOo(),this.Ai.focusManager.$t().Uk.iA(this.Ai.eKb);else if(Xa.id.startsWith(this.Ai.gjd)||
Xa.className.startsWith(this.Ai.Dxj))Xa=null,ea===x.a.wud?Xa=this.Ai.jJ:ea===x.a.vud&&(Xa=this.Ai.lB),this.Ai.focusManager.$t().Uk.iA(Xa),Sys.UI.DomElement.removeCssClass(this.Ai.eKb.parentNode,this.Ai.hog);else if(ea===x.a.wud)this.Ai.focusManager.$t().urc();else if(ea===x.a.vud)this.Ai.focusManager.$t().rrc();else return 2;return 32}}wk.gwf="FullPage";wk.e_d="PageWidth";Object(f.a)(wk,"ZoomManager",null,[55]);var Xp;(function(ea){ea[ea.Tbj=0]="manual";ea[ea.I1p=1]="fitToFullPage";ea[ea.Uoi=2]="fitWidth";
ea[ea.ddg=3]="onBoot"})(Xp||(Xp={}));Object(f.b)("ZoomStatus",Xp);d(1282);var Yp;(function(ea){ea[ea.normal=0]="normal";ea[ea.Xmo=1]="quiet";ea[ea.Yfi=2]="disableScrollUpdate";ea[ea.OUl=4]="disableUiControlUpdate"})(Yp||(Yp={}));Object(f.b)("ZoomUpdateFlags",Yp);var qt=d(283),yn=d(54),Oq=d(230),Li=d(341),oo=d(253),po=d(1037),hl=d(484);class Ln extends wk{constructor(ea,Xa,yb,Ub,yc,ad,md){super(ea,Xa);this.kIp=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.lIp=[wk.e_d,"200",
"150","125","100","75","50"];this.kbf=this.wGj=!1;this.E9g="AutoFitForAdaptiveLayout";this.Svk="FitPageWidthFailure";this.PRk="UpdateZoomFailure";this.iTk="wwf";this.Bcf=null;this.Szj=()=>{this.xra===Xp.Uoi&&this.aDf()};this.xMl=Sd=>{if(Sd.ctrlKey){m.AFrameworkApplication.va.Ob(Wg.a.Fbi,2);Sd=Sd.dHp;if(!Sd)return!1;this.$na(this.nl-(0<Sd?.1:-.1));this.ncd(6,"CtrlScroll");return!0}return!1};this.U5n=()=>{va.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};
this.Ija=yb;this.Xm=Ub;this.Zb=yc;this.$g=ad;this.aIc=md;this.Zqh=ea.$("KeepViewAfterZoomIsEnabled");this.jTk=ea.$("ZoomShortCutIsEnabled");this.dSk=ea.$("DoNotAutoScrollAfterPinchIsEnabled");this.CAk=(this.qAk=ea.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&ea.$("AutoFitForSmallScreenModeIsEnabled");this.Rtk=ea.$("DoNotProcessUpdateZoomActionIsEnabled");this.kTk=ea.$("ZoomSliderIsEnabled");this.$A()}get appName(){return"WordEditor"}get Zcd(){return 4}get ydd(){return.1}get yMl(){return wacBoot.CtrlWheelMetrics}C2k(ea){this.jd.addHandler("PinchStart",
ea)}FCo(ea){this.jd.removeHandler("PinchStart",ea)}B2k(ea){this.jd.addHandler("PinchEnd",ea)}ECo(ea){this.jd.removeHandler("PinchEnd",ea)}get yH(){return null!=this.Z3g?this.Z3g:this.Z3g=Fa.a.instance.Oa("WordEditor.IStatusBarUser")}C9j(ea){ea=!(ea&Yp.OUl);const Xa=pb.a.get_instance().isCompleted(7);return ea&&Xa?(ea={SelectZoomOption:"ComboBoxModel"},Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().eJ(ea),this.cCp(),!0):!1}$na(ea,Xa=Yp.normal){let yb=!0;this.Rtk||m.AFrameworkApplication.va.Ob(Ef.a.$na,
2);if(this.nl===ea)return this.kbf||(this.kbf=this.C9j(Xa)),yb;ea>this.Zcd?ea=this.Zcd:ea<this.ydd&&(ea=this.ydd);var Ub=!!(Xa&Yp.Xmo);1===ea||Ub||m.AFrameworkApplication.va.Ob(Ef.a.aOg,2);try{Ub=null;Ld.StaticActiveAppFrame.za()&&Object(oo.a)(po.a,Ld.StaticActiveAppFrame.za().kb.Qc)&&(Ub=Ld.StaticActiveAppFrame.za().kb.Qc);let yc=-1,ad=-1,md=-1;const Sd=!(Xa&Yp.Yfi);this.Zqh&&Sd&&(yc=Rf.a.nRm(Zh.a.instance.gb.currentSelection,Ub),ad=Ub.NI.scrollLeft,md=Ub.NI.scrollTop);const ze=this.nl;this.IQj(ea);
this.yoo();this.kbf=this.C9j(Xa);Sd&&this.FAp(Ub,yc,ad,md,ze)}catch(yc){yb=!1,va.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",yc)}return yb}FAp(ea,Xa,yb,Ub,yc){ea&&ea.isActive?this.Zqh?0<=Xa&&100>=Xa?ea.ps.b4(100-Xa,!0,!0):ea.ps.gxn(yb,Ub,yc,this.nl):ea.ps.b4():va.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}WLp(ea,Xa,yb){2===yb&&(this.ncd(this.Pb?this.Pb.gE:0,"ZoomTo100"),this.xra=Xp.Tbj,this.$na(1));return 32}oNj(ea){this.xra=Xp.Tbj;let Xa,yb=
!0;if(this.dSk){if(!Object(oo.a)(yj,ea))return va.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Xa=ea.zoom/100;yb=ea.n5k}else Xa=Number.parseInvariant(String.format("{0}",ea))/100;va.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Xa);ea=Yp.normal;yb||(ea=Yp.Yfi);this.$na(Xa,ea);return 32}g3b(ea,Xa,yb){if(1===yb)return 32;va.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(Vd.a)("ZoomToPageWidth",!0);this.xra=Xp.Uoi;
this.g2l();return this.aDf()}q2n(ea,Xa,yb,Ub,yc){if(1===yb)return 32;ea=La.a.RJa(this.dYc,6,m.AFrameworkApplication.numberFormat);yc[qt.a.labelText]=ea;return 32}YJi(){return this.kIp}ZJi(){return this.lIp}g2l(){this.wGj||(Ld.StaticActiveAppFrame.za()?(Ld.StaticActiveAppFrame.za().a2(this.Szj),this.wGj=!0):va.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}aDf(){var ea=this.Ija.Vxi();if(!ea)return 8;for(var Xa=0;ea;)Xa=Math.max(Xa,Oq.a.instance.Jv(ea)),
ea=this.Ija.K3c(ea);ea=yn.a.Mj(Xa,0);(Xa=this.aIc())&&Xa.nye()&&(ea+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());ea+=2*Li.a.BNg;ea=Ld.StaticActiveAppFrame.za().kG.offsetWidth/ea;this.$na(ea);return 32}cCp(){this.yH&&(this.kTk?(this.yH.aV(hl.a.RLp),this.yH.aV(hl.a.TLp)):this.yH.aV(hl.a.ULp))}Hep(ea){ea||(ea=window.self.CtrlWheelMetrics);if(ea){var Xa=ea.ctrlWheelOccurred;if("boolean"!==typeof Xa)va.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{va.ULS.sendTraceTag(594346947,
353,50,"ctrlWheelOccurred: {0}",Xa);try{ea.stop()}catch(yb){va.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",yb)}}}else va.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}$A(){this.Hep(this.yMl);if(this.Xm){var ea=document.getElementById(si.a.O_d);ea&&this.Xm.ub(T.a.fvb,ea,this.xMl)}this.Zb&&(ea=this.Zb.ie(si.a.AF),this.jTk&&(ea.bindAction(ug.KeyInputManager.oc(gj.a.bBc,ug.KeyInputManager.li),x.a.osb),ea.bindAction(ug.KeyInputManager.oc(gj.a.Etd,ug.KeyInputManager.li),
x.a.osb),ea.bindAction(ug.KeyInputManager.oc(gj.a.cBc,ug.KeyInputManager.li),x.a.vob),ea.bindAction(ug.KeyInputManager.oc(gj.a.dBc,ug.KeyInputManager.li),x.a.vob),ea.bindAction(ug.KeyInputManager.oc(gj.a.Dvd,ug.KeyInputManager.li),Ef.a.DGe)));this.$g&&(this.Bcf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.$g.ub(T.a.click,this.Bcf,this.U5n);this.CAk&&(Ld.StaticActiveAppFrame.za().OQ.registerLayoutBreakpointChanged("canvas",Xa=>{this.ajf(Xa)}),Ld.StaticActiveAppFrame.za().OQ.registerBoundingWindowRectsChanged("canvas",
()=>{this.ajf(Ld.StaticActiveAppFrame.za().OQ.getLayoutBreakpoint())}))}ajf(ea){let Xa=!0,yb="";if(this.xra!==Xp.ddg)return Xa;pa.Health.instance.recordKpiUsage(this.E9g,0,this.iTk,null);switch(ea){case "Small":8===this.aDf()&&(yb=this.Svk,Xa=!1);break;default:1===this.nl||this.$na(1)||(yb=this.PRk,Xa=!1)}Xa||pa.Health.instance.recordKpiFailure(this.E9g,yb,!0,!0,null);return Xa}UAj(ea){this.C2k(ea)}MCj(ea){this.FCo(ea)}TAj(ea){this.B2k(ea)}LCj(ea){this.ECo(ea)}Xxj(){this.jd.raiseEvent("PinchStart",
null)}yog(){this.jd.raiseEvent("PinchEnd",null)}}Object(f.a)(Ln,"WordEditorZoomManager",wk,[54,55]);class wp{constructor(){this.Z=null}get name(){return"WordEditor.Zoom"}init(){if(m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")){const ea=this.Z.resolve("WordEditor.Zoom.WordEditorZoomActor"),Xa=this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager");ea.Xb();Sys.UI.DomElement.overrideGetBounds=!0;m.AFrameworkApplication.J.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&m.AFrameworkApplication.J.$("AutoFitForSmallScreenModeIsEnabled")&&
Xa&&pb.a.get_instance().Sk(4,()=>{Xa.ajf(Ld.StaticActiveAppFrame.za().OQ.getLayoutBreakpoint())||va.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}wc(ea){this.Z=ea;m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")&&(this.Z.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Ln(m.AFrameworkApplication.J,m.AFrameworkApplication.va,ek.WordSectionNavigator.instance,Kn.a.instance,th.FocusManager.instance(),Uj.a.instance,()=>ea.Oa("Box4.IFloatingObjectUpdater"))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.Z.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new sr(m.AFrameworkApplication.va,this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager"),m.AFrameworkApplication.J)).ha())}static main(){K.a.instance.Mc(new wp)}}Object(f.a)(wp,"ZoomPackage",null,[0,1]);var Hp=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},eq;(function(ea){ea[ea.LOp=0]="Healthy";ea[ea.HPp=1]="MissedScan";ea[ea.TPp=2]="NeedsReset";ea[ea.rNp=3]="CriticalUnresponsive";ea[ea.jPp=4]="KickoutComponent"})(eq||(eq={}));
Object(f.b)("TimerBasedWatchDogStatus",eq);class Vs{constructor(ea,Xa,yb){this.tLd=this.wrh=this.Ash=this.v5b=this.mGa=0;this.lej=3;this.tZd=3E4;this.Rac=ea;this.yCb=Xa;this.OKi=yb}vDa(){this.mGa=0}async $On(){const ea=Date.now(),Xa=this.Rac.Vpc;this.tLd++;if(this.wrh==Xa&&this.b6o(ea,this.Ash))return{["WatchDogScanTime"]:ea,["LastComponentScanTime"]:Xa,["ComponentStatus"]:eq[this.v5b],["ActionTaken"]:"None. Skipping to Match Interval"};this.wrh=Xa;this.Ash=ea;this.yCb=this.Rac.Nbi;this.v5b=this.pvi(ea,
Xa);3===this.v5b&&(await this.Ksp(),this.v5b=this.pvi(ea,this.Rac.Vpc));return this.F5k(this.v5b,ea,Xa)}Pvn(){return 0===this.v5b}pvi(ea,Xa){let yb=0;ea>Xa+Math.max(this.yCb,this.tZd)+this.OKi&&(yb=0===this.mGa?1:this.mGa<this.lej?2:this.mGa===this.lej?3:4);return yb}F5k(ea,Xa,yb){const Ub={};Ub.WatchDogScanNumber=this.tLd;Ub.WatchDogScanTime=Xa;Ub.LastComponentScanTime=yb;Ub.ComponentStatus=eq[ea];Ub.ExpectedComponentScanInterval=this.yCb;Ub.GraceTimeInMS=this.OKi;Ub.ActualTimeBetweenWatchDogAndComponentScans=
Xa-yb;switch(ea){case 0:Ub.ActionTaken="None";this.mGa=0;break;case 1:this.mGa++;Ub.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.mGa++;Ub.ActionTaken="Component restarted";va.ULS.sendTraceTag(509686347,3037,20,"Restarting Component with interval {0}",this.yCb);this.Rac.ZXj();this.Rac.iXj(Math.min(this.yCb,this.tZd/2));break;case 3:this.mGa++;Ub["ActionTaken?"]="Attempted Synchronous run: "+eq[ea];break;case 4:va.ULS.sendTraceTag(512570578,3037,15,"Component is not Responding. WatchDog would kickout now"),
Ub["ActionTaken?"]="Kickout",Ub.ShouldKickout=!0,this.mGa++}Ub.NextExpectedComponentScanTimeInMs=yb+(this.mGa+1)*this.yCb;Ub.MissedScans=this.mGa;return Ub}async Ksp(){return this.Rac.yqi()}b6o(ea,Xa){return Xa+this.yCb>ea}}Object(f.a)(Vs,"TimerBasedWatchDog",null,[1525]);class xp{constructor(ea,Xa,yb,Ub,yc,ad,md,Sd){this.ZY=null;this.wNc=this.kja=0;this.CFb=new Date(Date.UTC(0,1,1,0,0));this.CK={};this.SOc=this.ROc=0;this.z1h=async()=>{var ze;va.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",
this.ROc++);if(this.lf.$o)this.wld(),this.stop(),va.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.gy.o0a);else{this.CFb=new Date;var Ne={};Uh.a.iva||(Ne.DocxSaveMonitor_IsUpToDate=null===(ze=this.ZY)||void 0===ze?void 0:ze.TR);Ne.RSNManager_IsUpToDate=this.gy.TR;Ne.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.gy.mfc();Ne.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.gy.OXd();va.ULS.sendTraceTag(521413850,
3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",Ne);if(this.uk&&!this.uk.isVisible)va.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.gy.o0a),this.Hfo();else if(ze=this.gy.dXc(this.qLd),0<ze){ze=this.eti(ze);va.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(ze));this.rTl&&va.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.cD());if(0==this.kja)this.wNc=this.Vpc;else if(1<this.kja){va.ULS.sendTraceTag(524137233,
3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.kja,this.Vpc-this.wNc);if(this.Cgn&&(!await this.gy.p$d(this.MYm)||0===this.gy.dXc(this.qLd))){this.wld();return}this.Zbj(ze,this.Vpc);this.CK.ShouldKickout&&(va.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.CK)),this.C1.lUb(this.Cxm()))}this.kja++}else this.wld(),this.Xpl()}};this.A1h=async()=>{await this.z1h();this.oXj()};this.gy=ea;this.lf=Xa;this.C1=md;this.FMk=Sd;this.XCh=Ub;this.qLd=yc;this.$Lk=ad;this.ZY=Fa.a.instance.Oa("Wonca.IDocxSaveMonitor");
this.CK.ShouldKickout=!1;this.tjg=this.$bo;this.Ssj=this.aco;yb.execute(ze=>{this.uk=ze});this.lf.AHa(this.t0.bind(this))}get Vpc(){return this.CFb.getTime()}eti(ea){return{["NumberOfStaleRevisions"]:ea,["BrowserIsOnline"]:To.a[this.lf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.lf.$o,["IsSessionExpired"]:this.lf.hba,["IsSessionLost"]:this.lf.moc,["HasEmergencyViewDeployed"]:this.lf.Jk,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),
["VisibilityManager_AppVisibilityState"]:this.uk?mk.a[this.uk.vA]:"undefined"}}t0(ea,Xa){if(Xa){ea=Date.now();var yb=this.gy.dXc(this.qLd);0<yb&&(yb=this.eti(yb),this.Zbj(yb,ea));this.VKo();this.HFn(Xa.errorCode)}this.stop();this.ZY=Fa.a.instance.Oa("Wonca.IDocxSaveMonitor")}Xpl(){this.gy.C$d(this.$Lk)&&this.Oup()}Oup(){va.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.FMk.Cmf();Ke.a.dEf(Dl.a.JKo)}Cxm(){return this.Csn?Lm.a.jJp:this.lf.hba?
Lm.a.gck:Lm.a.iJp}stop(){0!==this.SOc&&(window.clearInterval(this.SOc),this.SOc=0);va.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async yqi(){this.tTp&&this.stop();this.A1h();va.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}Edp(ea){this.SOc=window.setTimeout(this.A1h,ea);va.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.wld()}oXj(){this.SOc=window.setInterval(this.z1h,this.XCh);va.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.wld()}VKo(){this.rri(this.CK);
va.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.CK))}get PIj(){const ea=Object.assign({},this.CK);this.rri(ea);return ea}rri(ea){ea.shouldKickout||(0==this.gy.dXc(this.qLd)?(ea.NoKickoutReason="No Stale Revisions",ea.OldestRevisionCreationTime=this.gy.tjc()):this.uk&&!this.uk.isVisible?(ea.NoKickoutReason="Session not active",ea.VisibilityManager_AppVisibilityState=this.uk.vA):this.H1i&&this.kja<=this.Ssj?(ea.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",
ea.ScansWithPersistentRunawayDataLoss=this.kja):this.kja<=this.tjg?(ea.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",ea.ScansWithPersistentRunawayDataLoss=this.kja):ea.NoKickoutReason="undefined");ea.LastScanTime=this.CFb.toISOString();ea.RunCounter=this.ROc}cD(){const ea={};Uh.a.iva||this.ZY&&(ea.DSM=this.ZY.cD());this.gy&&(ea.RSN=this.gy.cD());return ea}wld(){va.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.kja,this.wNc);this.wNc=this.kja=0}Hfo(){this.kja=Math.min(this.tjg-1,this.kja);this.wNc=Date.now()}H1i(){return 0===this.uk.vA&&this.lf.WA&&!this.lf.moc&&!this.lf.hba&&!this.lf.Jk}Zbj(ea,Xa){this.kja>this.Ssj&&this.H1i()?this.CK.ShouldKickout||(this.CK.ShouldKickout=!0,this.sri("Persistent RunawayDataLoss detected in active session",Xa,ea)):this.kja>this.tjg&&!this.CK.ShouldKickout&&(this.CK.ShouldKickout=!0,this.sri("Runaway DataLoss persists for more than 3 minutes.",Xa,ea))}sri(ea,Xa,yb){this.CK.KickoutTime=
(new Date(Xa)).toISOString();this.CK.KickoutReason=ea;Uh.a.iva||(this.CK.DSM_isUpToDate=this.ZY?this.ZY.TR:"Undefined");this.CK.SessionInfo=yb}HFn(ea){const Xa=this.CK.ShouldKickout;pa.Health.instance.recordKpiUsage(xp.EHe,1,xp.g2d,null);const yb=new Map;ea&&yb.set("ErrorCode",ea.toString());Xa?(yb.set("ShouldKickout","true"),yb.set("KickoutTime",this.CK.KickoutTime),yb.set("Reason",this.CK.KickoutReason),pa.Health.instance.recordKpiSuccess(xp.EHe,Object.assign(new Kk.a,{extendedProperties:yb}))):
(yb.set("ShouldKickout","false"),ea=this.CK.NoKickoutReason,yb.set("Reason",ea),pa.Health.instance.recordKpiFailure(xp.EHe,ea,!1,!1,Object.assign(new Kk.a,{extendedProperties:yb})))}ZXj(){va.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}iXj(ea){va.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",ea);this.Edp(ea)}get rTl(){return null!=this.TTg?this.TTg:this.TTg=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get MYm(){return null!=this.VWg?this.VWg:this.VWg=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get Cgn(){return null!=this.tZg?this.tZg:this.tZg=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get aco(){return null!=this.x2g?this.x2g:this.x2g=m.AFrameworkApplication.J.jc("RunawayDataLossMinimumScansBeforeKickout",1)}get $bo(){return null!=this.w2g?
this.w2g:this.w2g=m.AFrameworkApplication.J.jc("RunawayDataLossMaximumScansBeforeKickout",5)}get Csn(){return 1===this.lf.networkState||3===this.lf.networkState}get Nbi(){return this.XCh}}xp.EHe="RunAwayDataLossKickout";xp.g2d="wwrelfc";Object(f.a)(xp,"RunawayDataLossMonitor",null,[50,51]);class xq{constructor(){this.Vdh=3E4;this.Wsk=24E4;this.Xsk=12E4;this.Z=this.rLd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(Uh.a.wt||Uh.a.fn)this.rLd=this.Z.resolve(this.name),this.rLd.oXj(),
this.Z.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==m.AFrameworkApplication.fh.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.fh.icj()}$Jl(){return new xp(this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.Z.resolve("Common.ISessionStatus")||xg.SessionStatusManager.instance,this.Z.Ta("Common.App.VisibilityManagement.IVisibilityManager"),m.AFrameworkApplication.J.jc("RunawayDataLossScanIntervalInMs",this.Vdh),this.iLo,this.Xsk,Fa.a.instance.Oa("Box4.IKickoutExecutor"),
El.WoncaApp.jG)}wc(ea){if(Uh.a.wt||Uh.a.fn)this.Z=ea,ea.ia(this.name,this.$Jl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.nqg()}dispose(){this.rLd&&this.rLd.stop()}static main(){K.a.instance.Mc(new xq)}nqg(){this.Z.ia("WordEditor.RunawayDataLossMonitorWatchDog",()=>new Vs(this.Z.resolve(this.name),m.AFrameworkApplication.J.jc("RunawayDataLossScanIntervalInMs",this.Vdh),m.AFrameworkApplication.J.jc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get iLo(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",
this.jLo)}get jLo(){return m.AFrameworkApplication.J.jc("RunawayDataLossKickoutIntervalInMs",this.Wsk)}}Object(f.a)(xq,"WordEditorRunawayDataLossMonitorPackage",null,[0,1]);class tr{constructor(ea,Xa){this.FLk=ea;this.GLk=Xa}}Object(f.a)(tr,"LastSavedToHostDetailsEventArgs",null,[835]);class Qj{constructor(ea,Xa,yb,Ub,yc,ad,md){this.KQk=5E4;this.J$e=0;this.CFb=new Date(Date.UTC(0,1,1,0,0));this.Bsk=6E4;this.ROc=this.E8b=0;this.sa=new U.a;this.DQo=()=>{va.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",
this.ROc++);this.lf.$o||this.Dic().then(Sd=>{this.sa.raiseEvent(Qj.s5i,Sd);this.nsh=new Date;Sd=this.zac;this.uk&&!this.uk.isVisible&&(Sd=this.ePk);this.zEa(Sd)}).catch(Sd=>{this.zEa(this.TOm(Sd))})};this.EMd=ea;this.lf=yb;this.HH=yc;this.gy=ad;this.zac=Xa.jc("LastSavedToHostDetailsIntervalMs",6E4);this.NDb=Xa.jc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.ePk=Xa.jc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.zac);this.tPc=Xa.jc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.B4e=
Xa.jc("Microsoft.Office.WordOnline.LastSavedToHostDetailsQueueTimeoutMs",3E4);this.nsh=new Date;Ub.execute(Sd=>{this.uk=Sd;this.uk.BHa((ze,Ne)=>{this.F_(Ne)})});this.If=md;0==m.AFrameworkApplication.fh.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.fh.icj();this.zEa(this.zac)}F_(ea){0!==ea.newState&&1!==ea.newState||0===ea.oldState||1===ea.oldState||this.lf.$o||(this.zEa(this.J$e),va.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",
this.nsh,this.J$e))}gta(){return 1==this.lf.networkState}Dic(){this.CFb=new Date;return new Promise((ea,Xa)=>{if(this.gta())va.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),Xa(0);else if(this.lf.hba)va.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),Xa(2);else if(this.gy.TR)va.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),Xa(3);else{var yb=$n.b(tq.construct(this.Tkc())),
Ub={"Content-Type":"application/json; charset=utf-8"};va.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");if(this.j6o)Uh.a.yzc.Hs({url:Qj.serviceUrl,method:"POST",body:yb,headers:Ub,xwc:this.tPc,ZWf:!0}).then(ad=>{this.Aio(ad,ea,Xa)}).catch(ad=>{va.ULS.sendTraceTag(508073635,3037,15,"Failed to get LastSavedToHostDetails with CRMV2. Failed with error code: {0}",ad.errorCode);2===ad.errorCode?Xa(0):Xa(2)});else if(this.k6o){var yc=0;yc=this.If.Xj(Qj.serviceUrl,2,yb,Ub,!1,
0,ad=>this.t5i(ad,ea,Xa),ad=>this.u5i(ad,Xa),null,null,!1,this.B4e,this.tPc,null,null,!0);0>=yc&&(va.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+yc.toString()),Xa(0))}else yc=0,yc=this.EMd.Xj(Qj.serviceUrl,2,yb,Ub,!1,0,ad=>this.t5i(ad,ea,Xa),ad=>this.u5i(ad,Xa),null,null,!0,this.tPc),0>=yc&&(va.ULS.sendTraceTag(508650827,3037,15,"Invalid request id returned "+yc.toString()),Xa(0))}})}Aio(ea,Xa,yb){const Ub={},yc=ea.headers.get(nm.a.q2);Ub.HttpStatus=ea.status;Ub.Correlation=
yc;va.ULS.sendTraceTag(508650831,3037,50,"LastSavedRevisionID Response Summary: {0}",Ub);ea.ok?ea.text().then(ad=>{ad=this.tUa(ad);ad||(va.ULS.sendTraceTag(508650829,3037,15,"LastSavedRevisionResponse is null"),yb(2));va.ULS.sendTraceTag(508073634,3037,50,"Successfully retrieve LastSavedToHostDetails.");this.HH.r0a(ad);Xa(new tr(ad.LastSavedRevisionId,ad.RevisionSequenceNumber))}).catch(ad=>{va.ULS.sendTraceTag(508650828,3037,15,"Failed to parse LastSavedRevisionResponse. Exception: {0}",ad.toString());
yb(2)}):(va.ULS.sendTraceTag(508650830,3037,15,"LastSavedRevisionResponse failed with status code: {0}",ea.status),ea.status===qk.a.l8?yb(1):ea.status===qk.a.vxb?yb(0):yb(2))}u5i(ea,Xa){let yb=2;if(ea=ea.data){if(5===ea.status)yb=1;else if(7===ea.status||13===ea.status)yb=0;va.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",ea.status))}else va.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");Xa(yb)}t5i(ea,
Xa,yb){if(ea=ea.data){var Ub={},yc=ea.wi?ea.wi[nm.a.q2]:"";Ub.HttpStatus=ea.He;Ub.Correlation=yc;Ub.Id=ea.id;va.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Ub);(ea=this.tUa(ea.Pe))?(this.HH.r0a(ea),Xa(new tr(ea.LastSavedRevisionId,ea.RevisionSequenceNumber))):(va.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),yb(2))}else va.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),yb(2)}zEa(ea){0!==this.E8b&&window.clearTimeout(this.E8b);
this.E8b=window.setTimeout(this.DQo,ea);va.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+ea)}Tkc(){const ea=Ld.StaticActiveAppFrame.za().kb.Qc;return ea?ea.vd:null}TOm(ea){return 1===ea?this.J$e:0===ea?this.KQk:3===ea?this.zac:this.NDb}tUa(ea){let Xa;return({group:Xa}=qp.a.D4(ea)).returnValue?Xa.Responses[0]:null}a3k(ea){this.sa.addHandler(Qj.s5i,ea)}async yqi(){const ea=new Promise((Xa,yb)=>{window.setTimeout(yb,3E3)});await Promise.race([ea,this.Dic()]).then(()=>
{va.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{va.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}ZXj(){0!==this.E8b&&(va.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.E8b),this.E8b=0)}iXj(ea){va.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",ea);this.zEa(ea)}get Vpc(){return this.CFb.getTime()}get Nbi(){return this.Bsk}cD(){const ea={};ea.LastScanTime=
this.CFb.toISOString();ea.RunCounter=this.ROc;return ea}get j6o(){return null!=this.A3g?this.A3g:this.A3g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseCRMV2",!1):!1}get k6o(){return null!=this.B3g?this.B3g:this.B3g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToClientRequestManager",!1):!1}}Qj.s5i="ULSTHD";Qj.serviceUrl=Uh.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";
Object(f.a)(Qj,"LastSavedToHostDetailsManager",null,[822,51]);class fg{constructor(ea,Xa,yb){this.NZm=ea;this.zDa=Xa;this.uyn=yb;this.Zig=()=>{const Ub=this.NZm();return 32!==Ub?Ub:!this.zDa||this.zDa.TR?32:8};this.Myp=(Ub,yc,ad,md,Sd)=>{this.uyn.zEa(parseInt(Sd.toString()));return 32}}Xb(ea){ea.qa(Ef.a.Zig,he.a.view,this.Zig);ea.qa(Ef.a.S6j,he.a.view,this.Myp);ea.Pc(Ef.a.S6j,101)}}Object(f.a)(fg,"LastSavedToHostDetailsManagerActor",null,[]);class ym{constructor(){this.Z=null}get name(){return"WordEditor.LastSavedToHost"}wc(ea){const Xa=
m.AFrameworkApplication.J;this.Z=ea;const yb=new xm(m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Fe.T0,m.AFrameworkApplication.Fe.uZd);this.Z.ia("WordEditor.ILastSavedToHostDetailsManager",()=>new Qj(yb,Xa,this.Z.Oa("Common.ISessionStatus")||xg.SessionStatusManager.instance,this.Z.Ta("Common.App.VisibilityManagement.IVisibilityManager"),Ug.a.instance,this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),m.AFrameworkApplication.Fe)).ha();this.nqg()}init(){(new fg(()=>El.WoncaApp.jG.lNi(),
this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.Z.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Xb(m.AFrameworkApplication.va);this.Z.resolve("WordEditor.ILastSavedToHostDetailsManager");this.Z.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){K.a.instance.Mc(new ym)}nqg(){this.Z.ia("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new Vs(this.Z.resolve("WordEditor.ILastSavedToHostDetailsManager"),m.AFrameworkApplication.J.jc("LastSavedToHostDetailsIntervalMs",
6E4),m.AFrameworkApplication.J.jc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(f.a)(ym,"LastSavedToHostDetailsPackage",null,[0,1]);var Yo=d(1443),is=d(1498);class hu{constructor(ea,Xa,yb,Ub){this.hCl=ea;this.AMb=Xa;this.fCl=yb;this.appSettings=Ub;this.tpl=async()=>{const yc=is.b.bEa(),ad=Promise.race([this.S_n(),new Promise(md=>setTimeout(()=>md(!1),5E3))]);va.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {0}ms",yc.r0d);return ad};this.S_n=async()=>
{if(!this.gkn||!this.ign)return!1;await this.TMg();return await this.fCl.qnf()&&await this.hCl.qnf()?!0:!1};this.Ijn=new nc.a(this.tpl)}async isEnabled(){return this.Ijn.value}get gkn(){const ea=this.AMb.isInsertActionEnabled,Xa=this.AMb.isRewriteActionEnabled,yb=this.AMb.isVisualizeAsTableEnabled;return this.AMb.isStartActionEnabled||ea||Xa||yb}get ign(){return fb.a.nj?this.AMb.isFirefoxAllowed:!0}async TMg(){return new Promise(ea=>{this.appSettings.vp(()=>{ea(!0)})})}}Object(f.a)(hu,"CopilotComposeFeatureCondition",
null,[]);class js{constructor(ea){this.ffd=async()=>{const Xa=await this.k7i.value;await this.v7c(Xa);return Xa};this.F8n=K.a.instance;this.k7i=new nc.a(ea);this.R8m=new nc.a(this.ffd)}async Q6(){await this.k7i.value}async s_c(){return await this.R8m.value}async v7c(ea){K.a.instance.Mc(ea);return new Promise(Xa=>{this.F8n.registerOnPackageInit(ea.name,Xa)})}}Object(f.a)(js,"LazyLoadedPackage",null,[]);var Ws=d(2186),Lo=d(2149);const Kr=new js(()=>Promise.all([d.e(4),d.e(2),d.e(11)]).then(d.bind(null,
2169)).then(ea=>ea.instance));class Pq{constructor(ea,Xa){this.xIp=ea;this.logger=Xa;this.ffd=async()=>{await this.logger.measureActivityPerformanceAsync(this.rxf,{name:"Initialize",dataFields:[...Object(Lo.a)(Ws.a.getFields({featureName:"CopilotCompose",Nmf:Ws.a.UBc.ContentGeneration,Uhc:Ws.a.Wfb.IsEnabled,isUserInitiated:!1}))]})};this.rxf=async()=>{await Promise.all([Kr.Q6(),this.xIp.loadChunk("copilotComposeUx")]);await Kr.s_c()}}initialize(){this.ffd().catch(ea=>{va.ULS.lz(508913495,3048,10,
ea,"Failed to initialize CopilotCompose")})}}Object(f.a)(Pq,"CopilotComposeInitializer",null,[]);class Ip{constructor(ea,Xa){this.appSettings=ea;this.G7k=Xa;this.Z2f="Copilot";this.Sil="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped";this.u8n="Microsoft.Office.WordOnline.CopilotLicensePaywallNoPassOverrideEnabled"}async qnf(){const ea=await this.Rpl();va.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",ea);return 1===ea||0===ea}async Rpl(){if(this.ill())return 0;const ea=is.b.bEa(),
Xa=await this.pRf();va.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",ea.r0d);return Xa?this.B4o()?3:1:2}ill(){return this.appSettings.getBooleanFeatureGate(this.Sil,!1)}B4o(){return this.appSettings.getBooleanFeatureGate(this.u8n,!1)}async pRf(){return(await Object(dj.b)(this.G7k)).isFeatureEnabled(this.Z2f,!1)}}Object(f.a)(Ip,"CopilotComposeLicenseCondition",null,[]);class iu{constructor(ea){this.appSettings=ea}get isStartActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStartActionEnabled",
!1)}get isInsertActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsInsertActionEnabled",!1)}get isRewriteActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",!1)}get isStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStreamingEnabled",!1)}get isAutoOpenOnStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoOpenOnStartEnabled",
!1)}get isNonEmptyStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNonEmptyStartEnabled",!1)}get isCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotComposeCiqEnabled",!1)}get isCiqTeachingUiEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqTeachingUiEnabled",!1)}get isCiqMultilingualEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqMultilingualEnabled",
!1)}get isCiqBrowseCloudFilesEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCiqBrowseCloudFilesEnabled",!1)}get isCopilotPluginsEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCopilotPluginsEnabled",!1)}get isLogToAshaEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsLogToAshaEnabled",!1)}get isTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.CopilotCompose.isTableRenderingEnabled",
!1)}get isStylizedTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isStylizedTableRenderingEnabled",!1)}get streamingWordsPerSecond(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingWordsPerSecond",15)}get streamingBetweenChunkDelayMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingBetweenChunkDelayMs",110)}get isFirefoxAllowed(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsFirefoxAllowed",
!1)}get streamingChunkGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingChunkGenerationTimeoutMs",2E4)}get isAdminControlEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)}get isFeedbackSdkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.FeedbackSdkEnabled",!1)}get isSupportedLanguagesLinkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSupportedLanguagesLinkEnabled",
!1)}get isAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoAcceptFixEnabled",!1)}get isMultiTurnEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnEnabled",!1)}get isProactiveSurveysEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsProactiveSurveysEnabled",!1)}get isRewriteV2Enabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteStreamingWorkflowEnabled",
!1)}get isRewriteFormattedInsertionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isRewriteFormattedInsertionEnabled",!0)}get isRewriteFormattedTextBoxEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isRewriteFormattedTextBoxEnabled",!0)}get insertTextContextParagraphsCountLimit(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.InsertTextContextParagraphsCountLimit",
6)}get isMultiTurnExpandedInputEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnExpandedInputEnabled",!1)}get isDesignerSuggestionsSuppressionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDesignerSuggestionsSuppressionEnabled",!1)}get isSetParagraphLanguageEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSetParagraphLanguageEnabled",
!1)}get isWrongIntentUnhighlightEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsWrongIntentUnhighlightEnabled",!0)}get isDynamicAnchoringEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDynamicAnchoringEnabled",!1)}get isVisualizeAsTableEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsVisualizeAsTableEnabled",!1)}get isNewLineAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNewLineAutoAcceptFixEnabled",
!0)}get isPromptAssistanceEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsPromptAssistanceEnabled",!1)}get isAiRewriteContentLossWarningUxEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAiRewriteContentLossWarningUxEnabled",!0)}get canvasEventsPropagationFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.CanvasEventsPropagationFixEnabled",
!0)}}Object(f.a)(iu,"CopilotComposeFeatureGatesImpl",null,[]);class gq{constructor(ea,Xa){this.KVc=ea;this.AMb=Xa}async qnf(){if(!this.AMb.isAdminControlEnabled)return!0;const ea=is.b.bEa();try{return!await (await Object(dj.b)(this.KVc)).cN("CopilotContentGeneration",!0)}finally{va.ULS.sendTraceTag(508651538,3048,50,"Admin policy check took: {0}ms",ea.r0d)}}}Object(f.a)(gq,"CopilotComposeAdminPolicyCondition",null,[]);class Ka extends Yo.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}zUa(ea){ea.ia("WordEditor.Copilot.Compose.EditorAiTelemetryLogger",
()=>new is.a(ea.resolve("Wac.Common.Utils.IOtelWrapper"),"CopilotCompose")).ha()}BUa(){const ea=Fa.a.instance;(new Pq(ea.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),ea.resolve("WordEditor.Copilot.Compose.EditorAiTelemetryLogger"))).initialize()}AUa(){}static main(){Ka.aom().isEnabled().then(ea=>{ea&&K.a.instance.Mc(new Ka)}).catch(()=>{va.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static aom(){const ea=Fa.a.instance;ea.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureGates",
()=>new iu(m.AFrameworkApplication.J)).ha();ea.ia("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new Ip(m.AFrameworkApplication.J,ea.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();ea.ia("WordEditor.Copilot.Compose.CopilotComposeAdminPolicyCondition",()=>new gq(ea.Ta("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),ea.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"))).ha();ea.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",
()=>new hu(ea.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),ea.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"),ea.resolve("WordEditor.Copilot.Compose.CopilotComposeAdminPolicyCondition"),m.AFrameworkApplication.J)).ha();return ea.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}Object(f.a)(Ka,"CopilotComposeEntryPackage",Yo.a,[]);var $a=d(1447);class Hb extends $a.a{constructor(ea){var Xa;super("BooleanFeatureGateConditionId");this.Js=ea.Js;
this.d0c=ea.d0c;this.defaultValue=null!==(Xa=ea.defaultValue)&&void 0!==Xa?Xa:!1}initialize(){super.initialize();const ea=m.AFrameworkApplication.J;ea.vp(()=>{const Xa=ea.getBooleanFeatureGate(this.d0c,this.defaultValue);this.pi(Xa)})}pi(ea){super.pi(ea);va.ULS.sendTraceTag(512369937,3028,50,this.F6(this.Js,ea,`featureGate=${this.d0c}`))}}Object(f.a)(Hb,"BooleanFeatureGateCondition",$a.a,[]);class uc extends $a.a{constructor(ea){var Xa;super("DocumentOwnerConditionId");this.Js=ea.Js;this.pAg=null!==
(Xa=ea.pAg)&&void 0!==Xa?Xa:!0}initialize(){super.initialize();const ea=m.AFrameworkApplication.J;ea.vp(()=>{const Xa=ea.$("IsDocumentOwner");this.pi(Xa===this.pAg)})}pi(ea){super.pi(ea);va.ULS.sendTraceTag(508958623,3028,50,this.F6(this.Js,ea))}}Object(f.a)(uc,"DocumentOwnerCondition",$a.a,[]);var M=d(1408);class fa extends M.a{constructor(ea,Xa,yb){super("LicensePaywallCondition");this.dbc=ea.Js;this.tvk=ea.q6l;this.Aa=Xa;this.uv=yb}initialize(){super.initialize();this.kCl()}Wd(){super.Wd()}kCl(){this.Aa.vp(()=>
{!this.Aa.$("IsAnonymousUser")&&this.uv?this.uv.execute(ea=>{this.yZe=Date.now();ea.isFeatureEnabled(this.tvk,!1).then(Xa=>{this.yZe=Date.now()-this.yZe;this.pi(Xa)})}):this.pi(!1)})}pi(ea){super.pi(ea);va.ULS.sendTraceTag(508884163,3028,50,this.F6(this.dbc,ea,"Latency for license check: "+this.yZe.toString()+"ms"))}}Object(f.a)(fa,"LicensePaywallCondition",M.a,[]);var Va=d(1812),Fb=d(1482);class Vb extends Fb.a{constructor(ea){super(23,ea,null,3028,"SkittleInitializationTriggered")}}Object(f.a)(Vb,
"SkittleInitializationTriggerModel",Fb.a,[]);var wc=d(539);class Xc{constructor(){this.vga=(ea,Xa)=>{Xa.succeeded||va.ULS.sendTraceTag(508618435,3049,10,"Async loading of skittle module failed")}}v9m(ea){const Xa=wc.a.Instance().wQb().grb("WordEditor.Skittles");Xa.hoc()||this.uCn(ea).then(()=>{Xa.xqc(this.vga)}).catch(()=>{va.ULS.sendTraceTag(508618436,3049,10,"Async loading of skittle ux chunk failed")})}async uCn(ea){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):
(await Object(dj.b)(ea)).OD.loadScript("copilotSummarySkittleUx")}}Object(f.a)(Xc,"SkittlesProxyConsumerImpl",null,[109]);class vd{static vLm(){return new Xc}}Object(f.a)(vd,"SkittlesProxyConsumerFactory",null,[]);class Dd{constructor(ea,Xa){this.XVj=ea;this.zvg=Xa;this.UVi=!1;this.Mfd=async(yb,Ub)=>{if(Ub.wha){Object(Vd.a)("SkittleInitializationTriggered");for(const yc of this.XVj)yc.rDa(this.Mfd),yc.Wd();this.UVi||(this.UVi=!0,vd.vLm().v9m(this.zvg))}}}initialize(){va.ULS.sendTraceTag(508621533,
3049,50,"SkittleInitializer has begun initializing skittle trigger models");for(const ea of this.XVj)ea.vqa(this.Mfd),ea.initialize()}}Object(f.a)(Dd,"SkittleInitializer",null,[]);class Ce extends Yo.a{get name(){return"WordEditor.SkittleEntryPackage"}zUa(ea){this.container=ea}BUa(){const ea=new eb.a;if(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",!1)){var Xa=ea.push,yb=this.container,Ub=yb.resolve("WordEditor.WordCount.IWordCountManagerFactory");
yb=yb.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");var yc=new Hb({Js:24,d0c:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const ad=new Hb({Js:24,d0c:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),md=new uc({Js:24,pAg:!1});yc=new eb.a([yc,ad,md]);m.AFrameworkApplication.$c("fbc73697;a29b4114");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(yb=new fa({Js:24,q6l:"Copilot"},
m.AFrameworkApplication.J,yb),yc.add(yb));m.AFrameworkApplication.$c("f5gia801;0f27g313");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)&&(Ub=new Va.a({Js:24},Ub),yc.add(Ub));Xa.call(ea,new Vb(yc))}0!==ea.count&&(new Dd(ea,this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}AUa(){}static main(){K.a.instance.Mc(new Ce)}}Object(f.a)(Ce,"SkittleEntryPackage",Yo.a,[]);Type.registerNamespace("B4RT");
Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");
Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Fe.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");N;Type.registerNamespace("CACPU");Ga.main();
Type.registerNamespace("CAEventTimingMeter");mb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");nb.main();Type.registerNamespace("Common.App.GestureInput");wb.main();Type.registerNamespace("Common.App.GestureManager");ac.main();Type.registerNamespace("Common.ModernFontPicker");null==m.AFrameworkApplication.J||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),K.a.instance.Mc(new $i));
Type.registerNamespace("Common.App.O365Shell");Yb.main();Type.registerNamespace("Common.App.PhoneLink");Gc.main();Type.registerNamespace("Common.App.SensitiveLogging");Tj.main();Type.registerNamespace("Common.App.Rename");K.a.instance.Mc(new li,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");K.a.instance.Mc(new re);Type.registerNamespace("Common.App.SaveAsToHost");el.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Pg.main();Type.registerNamespace("Common.App.SaveACopy");
ql.main();Type.registerNamespace("Common.App.SaveToSharePoint");yk.main();Type.registerNamespace("Common.App.SharedFilePicker");Kf.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");Lc.main();mg;K.a.instance.Mc(new Wo);Uh.a.iva||uq.main();Hp;Mg.main();K.a.instance.Mc(new Xb);Uf.main();bj.a.prototype.toString=Jh.a.prototype.toString;
Gh.a.XKi=new cj.a;K.a.instance.Mc(new Jr);wp.main();K.a.instance.Mc(new vo);K.a.instance.Mc(new Hn);K.a.instance.Mc(new Ko);Go.main();zk.main();dk.main();Type.registerNamespace("NLRT");K.a.instance.Mc(new hb);Type.registerNamespace("Common.App.AccessibilitySettings");E.main();Type.registerNamespace("Common.App.RibbonSettings");Jl.main();K.a.instance.Mc(new Mq);lo.main();Ce.main();Ka.main();xq.main();ym.main();window.EventTiming={EventTimingMeter:Uc,FrameTimingMeter:sd}},2186:function(I,J,d){function m(u,
v,D){return{name:u,dataType:0,value:v,classification:D?D:4}}function f(u,v,D,y,H){void 0===H&&(H=4);y&&u.push(m("".concat(v?v+"."+D:D),y,H))}function a(u,v,D,y){if("boolean"===typeof y){var H=u.push;v="".concat(v?v+"."+D:D);H.call(u,{name:v,dataType:1,value:y,classification:4})}}d.d(J,"a",function(){return z});var l;(function(u){u.Web="Web";u.Desktop="Desktop";u.Universal="Universal";u.Mobile="Mobile";u.Win32="Win32";u.iOS="iOS";u.Android="Android"})(l||(l={}));var w;(function(u){u.Automation="Automation";
u.Dogfood="Dogfood";u.Microsoft="Microsoft";u.Insiders="Insiders";u.Production="Production"})(w||(w={}));var z;(function(u){(function(v){v.IsEnabled="IsEnabled";v.IsSeen="IsSeen";v.IsTried="IsTried";v.IsKept="IsKept";v.IsRejected="IsRejected"})(u.Wfb||(u.Wfb={}));(function(v){v.ContentGeneration="Content Generation";v.Commanding="Commanding";v.QAandSummaries="QA and Summaries";v.Collaboration="Collaboration";v.Suggestions="Suggestions"})(u.UBc||(u.UBc={}));(function(v){v.Chat="Chat";v.Canvas="Canvas"})(u.EntryPoint||
(u.EntryPoint={}));u.getFields=function(v){var D=[];f(D,"Copilot","FeatureActionType",v.Uhc);a(D,"Copilot","IsUserInitiated",v.isUserInitiated);f(D,"Copilot","FeatureName",v.featureName);f(D,"Copilot","SubFeatureName",v.coq);f(D,"Copilot","Capability",v.Nmf);a(D,"Copilot","IsThumbsUp",v.A0f);f(D,"Copilot","EntryPoint",v.entryPoint);D.push(m("zC.".concat("Copilot"),"Office.System.Copilot"));return D}})(z||(z={}));var x;(function(u){(function(v){v.Pillar="Pillar";v.Error="Error"})(u.EventType||(u.EventType=
{}));u.getFields=function(v){var D=[];f(D,"Asha","EventType",v.eventType);f(D,"Asha","Pillar",v.Dco);f(D,"Asha","Scenario",v.scenario);f(D,"Asha","Veto",v.lBc);f(D,"Asha","Error",v.error);a(D,"Asha","InStaging",v.inStaging);a(D,"Asha","IsSessionEndingError",v.isSessionEndingError);a(D,"Asha","IsIntentional",v.isIntentional);a(D,"Asha","IsInternal",v.isInternal);D.push(m("zC.".concat("Asha"),"Office.System.Asha"));return D}})(x||(x={}))}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23047711/wdjs/WordEditorDS.box4.dll2.js.map