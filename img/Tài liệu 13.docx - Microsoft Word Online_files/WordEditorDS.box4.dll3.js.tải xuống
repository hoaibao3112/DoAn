/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1398:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(1553);class f{constructor(){this.Vp=null;this.Hp=!1}xp(){this.Hp||(this.Hp=!0,this.Vp=m.a.instance.gIm(),m.a.instance.xp(this.Vp,this))}Tjj(){this.ikd();this.Hp=!1}ikd(){}}Object(I.a)(f,"Base",null,[])},1435:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.SIc=this.RIc=this.mLc=this.lLc=this.nLc=this.d$=this.e$=
!1}get ignorePunct(){return this.RIc}set ignorePunct(f){this.RIc=f}get ignoreSpace(){return this.SIc}set ignoreSpace(f){this.SIc=f}get matchCase(){return this.d$}set matchCase(f){this.d$=f}get matchPrefix(){return this.lLc}set matchPrefix(f){this.lLc=f}get matchSuffix(){return this.mLc}set matchSuffix(f){this.mLc=f}get matchWholeWord(){return this.e$}set matchWholeWord(f){this.e$=f}get matchWildcards(){return this.nLc}set matchWildcards(f){this.nLc=f}getTypeName(){return"Microsoft.WordServices.SearchOptions"}invokePropertyGet(f){switch(f){case 1:return this.ignorePunct;
case 2:return this.ignoreSpace;case 3:return this.matchCase;case 4:return this.matchPrefix;case 6:return this.matchSuffix;case 8:return this.matchWholeWord;case 7:return this.matchWildcards}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,a){switch(f){case 1:this.ignorePunct=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 2:this.ignoreSpace=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 3:this.matchCase=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 4:this.matchPrefix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 6:this.matchSuffix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 8:this.matchWholeWord=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 7:this.matchWildcards=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,a){this.invokePropertySet(f,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,a){f=this.invokeMethod(f,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}
Object(I.a)(m,"SearchOptions",null,[])},1466:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.before=0]="before";f[f.after=1]="after";f[f.start=2]="start";f[f.end=3]="end";f[f.replace=4]="replace"})(m||(m={}));Object(I.b)("InsertLocation",m)},1553:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);var m=d(48),f=d(8),a=d(524),l=d(280),w=d(1396);class z{constructor(){this.Jjb=new a.a(l.a.vh())}gIm(){return m.a.create().toString()}xp(x,u){x&&u||(f.ULS.sendTraceTag(17168157,
369,10,"Cannot keep reference for null object."),w.a.hg());this.E_k(x,u)}E_k(x,u){try{this.Jjb.add(x,u)}catch(v){f.ULS.sendTraceTag(17168158,369,10,"Failed to add object into the cache with exception message {0}.",v.message)}}L2d(x){let u=null;({value:u}=this.Jjb.Ec(x,u));u||f.ULS.sendTraceTag(17168159,369,15,"This object with reference Id {0} hasn't been added to the cache yet.",x);return u}Nzo(x){try{let u=null;({value:u}=this.Jjb.Ec(x,u));u&&(u.Tjj(),this.Jjb.remove(x))}catch(u){f.ULS.sendTraceTag(17168160,
369,10,"Failed to remove the object from the cache with exception message {0}.",u.message)}}jsl(){if(this.Jjb&&this.Jjb.values){for(const x of this.Jjb.values)x.Tjj();this.Jjb=new a.a(l.a.vh())}}static get instance(){return z._instance||(z._instance=new z)}}z._instance=null;Object(I.a)(z,"ObjectCache",null,[])},1621:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.X_c="extId";m.n5h="ComponentType";m.Qec="ComponentId";m.a3m="HostProps";m.Zfd="OptionalProps";Object(I.a)(m,"ActionPropertyNames",
null,[])},1766:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.unknown=0]="unknown";f[f.Leq=1]="notYetImplemented";f[f.Fqq=2]="unsupportedSelection";f[f.vqi=3]="forceSaveFailed";f[f.ugq=4]="ooxmlStringIsNull";f[f.ZYp=5]="dependencyNotReady";f[f.EZp=6]="documentNotSupported";f[f.tgq=7]="ooxmlIsMalformated";f[f.tUp=8]="anchoredObjectSelection";f[f.w6p=9]="invalidParameter"})(m||(m={}));Object(I.b)("OoxmlApiInvocationError",m)},1767:function(I,J,d){d.d(J,"a",function(){return m});
I=d(0);class m{}m.taskPaneWidth="TaskPaneWidth";m.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";m.pV="TaskPaneTitle";m.QU="NonPersistedSettings";m.onTaskPaneClose="OnTaskPaneClose";m.onExtensionLaunchCallback="OnExtensionLaunchCallback";m.ILh="ActionArgs";m.dialogWidth="DialogWidth";m.dialogHeight="DialogHeight";m.dialogLeft="DialogLeft";m.dialogTop="DialogTop";m.dialogTitle="DialogTitle";m.UYc="DialogCloseCallback";m.showLoadingSpinner="ShowLoadingSpinner";Object(I.a)(m,"PropertyNames",
null,[])},1768:function(I,J,d){d.d(J,"a",function(){return v});I=d(0);var m=d(1953),f=d(1955),a=d(1621),l=d(1952),w=d(1954),z=d(2),x=d(48),u=d(12);class v{constructor(){this.ga=z.AFrameworkApplication.va}p2f(D,y,H,F,G){this.Vyn(D,y,H,F,G)}Vyn(D,y,H,F,G){const {ExtensionComponentInstance:K}=d(1951),R={};R[a.a.X_c]=D;R[a.a.n5h]=y;R[a.a.Qec]=H;R[a.a.a3m]=F;R[a.a.Zfd]=G;F=8;if(z.AFrameworkApplication.v1i(D.getId()))switch(y){case l.a.action:F=this.ga.Qb(u.a.B1d,2,R);break;case l.a.z_j:F=this.ga.Qb(u.a.ZTj,
2,R);break;case l.a.JNo:F=this.ga.Qb(u.a.Pge,2,R);break;default:F=16}32===F?(F=x.a.create().toString(),G.optionalProperties.InstanceToken&&(F=G.optionalProperties.InstanceToken),D=new K(D,y,H,F),v.rJ[F]=D):D=new K(D,y,H,null);D.VRo(R)}Uyn(D){var y=D.ExtId;const H=D.ComponentType,F=D.ComponentId;var G=D.HostProps;D=D.OptionalProps;y=new m.a(y.Id,y.StoreId,y.StoreType,y.AppVersion);G=new w.a(G.HostType,G.FormFactor,G.Locale);const K=new f.a;K.optionalProperties=D.OptionalProperties;K.SYc=D.DevProperties;
v.instance.p2f(y,H,F,G,K)}getInstance(D){return v.rJ[D]}aAo(D){delete v.rJ[D]}static get instance(){v.kRe||(v.kRe=new v);return v.kRe}}v.kRe=null;v.rJ={};Object(I.a)(v,"ExtensionLifeCycleManager",null,[1227])},1771:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===
z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1961),J);f(d(1962),J);f(d(1963),J);f(d(1964),J)},1947:function(I,J,d){(function(m){d.d(J,"a",function(){return ba});var f=d(0),a=d(19),l=d(2),w=d(26),z=d(6),x=d(11),u=d(367),v=d(31),D=d(621),y=d(89),H=d(543),F=d(3),G=d(2024),K=d(5),R=d(8),E=d(71),N=d(109),O=d(18),U=d(1766),X=d(1949),V=d(1466),Q=d(1396),
T=d(1948);class ba{constructor(W,aa,Y,da,ka,qa,ua,Pa,Ja,Ca,ra,Ea,xa,Ma,ha,la){this.Mpa=this.nT=this._context=this.ld=this.sh=null;this.Z4=0;this.ga=W;this.Rd=aa;this.Vh=Y;this.hb=da;this.qoa=ka;this.vGa=qa;this.xl=ua;this.Zd=Pa;this.KC=Ja;this.uG=Ca;this.Qwa=ra;this.LY=Ea;this.Hjb=xa;this.ib=Ma;this.QDb=ha;this.FRe=la}su(W,aa){this.sh=W;this.ld=aa}get LF(){return null!=this.RWg?this.RWg:this.RWg=a.a.instance.resolve("Box4.IBox4GraphWriter")}mSi(W,aa,Y){var da;({BL:da}=this.dN(W.K(0),W.K(W.count-1),
1));W=Object.assign(new T.a,{dLa:da,Ioc:!0,keepCurrentFocus:!0});if(32!==this.ga.Qb(0===Y?O.a.insertFootnote:O.a.insertEndnote,2,W))return Q.a.sC(),null;Y=new E.a;(da=this.LY.jGf(da.node,da.cpBegin))||Q.a.hg();da=da.g7();da=this.gtm(da);Y.add(w.a.Cx(da));aa||(aa="");this.insertText(Y,aa,1);return W.hhj}VQl(W){var aa=this.ib.gb;if(aa&&aa.currentSelection&&aa.currentSelection.Qa&&(aa=aa.currentSelection.Qa.node,12===aa.type&&this.uG.V8a(aa)===W&&32!==this.ga.Qb(O.a.L6,2,null))){Q.a.hg();return}aa=new E.a;
if(W=W.esa)W=W.Ib,aa.add(w.a.createTextRange(W.paragraph,W.cp,W.cp+1));this.jgc(aa)}Qaa(W){W=this.uG.Qaa(W);if(1===W)return 0;if(0===W)return 1}HBm(W,aa){if(W=W.esa)if(W=W.Ib,aa=this.Qwa.cCi(W.paragraph,W.cp+1,0===aa?1:0))return aa.g7();return null}gtm(W){W&&38===W.type||Q.a.hg();W=z.a.eb(W);W.je();return W.je()}Hjc(W,aa){var Y=new z.a;Y.set(W);W=new E.a;this.hb.HQb(Y,!0,!1,W);Y=new E.a;for(const da of W)W=this.$If(da,aa),Y.addRange(W);return Y}$If(W,aa){var Y=this.LY.U1c(W,7);W=new E.a;aa=0===aa?
1:0;for(const da of Y)Y=da.g7(),da.Qaa()===aa&&W.add(Y);return W}f6d(W,aa){const Y=new E.a,da=W.count;if(this.H0f(W.K(0).node))return W=this.kFm(W.K(0).node,aa),Y.add(W),Y;for(let Pa=0;Pa<da;Pa++){var ka=W.K(Pa);if(ka.contextId==x.a.Zc)continue;var qa=ka.node;let Ja=0,Ca=qa.characterData.length;0===Pa&&0<=ka.cpBegin&&(Ja=ka.cpBegin);Pa===da-1&&0<=ka.cpEnd&&(Ca=ka.cpEnd);ka=qa.ra;for(qa=0;qa<ka.length;qa++)if(!(ka.Ub(qa).cp<Ja)){if(ka.Ub(qa).cp>Ca)break;var ua=ka.Ub(qa).blob;if(ua&&7==ua.Sh){const ra=
0===aa?1:0;ua.Qaa()===ra&&(ua=ua.g7(),Y.add(ua))}}}return Y}sza(W,aa){const Y=new E.a;let da=0;for(const ka of W)Y.add(this.Hjb.create(ka,aa,da++));return Y}dN(W,aa,Y,da=!1){let ka=0,qa=null;switch(Y){case 2:case 0:if(W.contextId===x.a.paragraph)aa=0,this.c9c(W.node)&&(da=this.Y5d(W.node),-1!==da&&(aa=da+2>this.hb.textLength(W.node)?this.hb.textLength(W.node):da+2)),qa=w.a.Uc(W.node,aa),ka=2===Y?0:4;else if(W.contextId===x.a.Zc)qa=w.a.Cx(W.node),ka=this.hb.textLength(W.node)?2===Y?2:6:2===Y?1:5;else if(W.contextId===
x.a.Cd||W.contextId===x.a.Vc)qa=w.a.Uc(W.node,W.cpBegin),ka=2===Y?3:7;else{if(W.contextId===x.a.table)return{returnValue:8,BL:W};Q.a.td()}qa.Fb=qa.Tb=W.oo();break;case 3:case 1:aa.contextId===x.a.paragraph||aa.contextId===x.a.Zc?(3===Y?(qa=w.a.Cx(aa.node),qa.Fb=qa.Tb=aa.qo()):(qa=this.Fnm(aa,da),0<this.hb.wm(qa.node,0)?qa.Fb=qa.Tb=this.hb.vy(qa.node):qa.Fb=qa.Tb=-1),ka=3===Y?9:11):aa.contextId===x.a.Cd||aa.contextId===x.a.Vc?(qa=w.a.Uc(aa.node,aa.cpEnd),qa.Fb=qa.Tb=aa.qo(),ka=3===Y?10:12):Q.a.td();
break;case 4:({BL:qa}=this.dN(W,aa,0));ka=13;break;default:R.ULS.sendTraceTag(17339329,369,15,"Undefined insert location: {0}",V.a[Y]),Q.a.td()}return{returnValue:ka,BL:qa}}Xse(W,aa){if(1<W.count){const Y=W.K(0);let da=W.K(W.count-1);switch(aa){case 2:if(da.contextId===x.a.Vc)W.remove(da),da=W.K(W.count-1),da.contextId===x.a.paragraph&&(W.W(W.count-1,w.a.createTextRange(da.node,0,this.hb.textLength(da.node))),this.Xv(W.K(W.count-1),2));else for(const ka of W)if(ka.contextId===x.a.Zc){W.remove(ka);
W.insert(0,ka);break}break;case 0:case 4:2===W.count&&da.contextId===x.a.Vc?(W.remove(da),W.W(0,w.a.Cx(Y.node)),this.Xv(W.K(0),2,da)):aa||W.K(1).contextId!==x.a.Zc?W.remove(Y):W.removeAt(1);break;case 3:Y.contextId===x.a.Vc&&(W.remove(Y),da.contextId===x.a.paragraph&&(W.W(W.count-1,w.a.createTextRange(da.node,0,this.hb.textLength(da.node))),this.Xv(W.K(W.count-1),2)));break;case 1:2===W.count&&Y.contextId===x.a.Vc?W.remove(Y):W.remove(da)}}}vEe(W,aa,Y,da,ka){if(!da)return 13===Y&&(W.clear(),W.add(aa)),
aa;let qa=null;const ua=W.K(0),Pa=W.K(W.count-1);switch(Y){case 0:qa=w.a.createTextRange(aa.node,0,da);W.W(0,w.a.create(aa.node));W.K(0).Tb=ua.qo();this.Xv(W.K(0),0);break;case 1:qa=w.a.createTextRange(aa.node,0,da);W.W(0,w.a.create(aa.node));W.K(0).Fb=0<this.hb.wm(aa.node,0)?this.hb.wm(aa.node,0):-1;W.K(0).Tb=0<this.hb.wm(aa.node,da)?this.hb.Ex(aa.node):-1;break;case 2:qa=w.a.createTextRange(aa.node,ka,ka+da);W.insert(0,qa);this.Xv(W.K(0),2);break;case 3:qa=w.a.createTextRange(aa.node,ua.cpBegin,
ua.cpBegin+da);W.W(0,w.a.createTextRange(aa.node,ua.cpBegin,ua.cpEnd+da));ua.contextId===x.a.Cd?(W.K(0).Tb=ua.qo(),this.Xv(W.K(0),0)):this.Xv(W.K(0),2);break;case 4:qa=w.a.createTextRange(aa.node,0,da);W.W(0,w.a.Wl(aa.node));Y=this.hb.wm(aa.node,da+ka);0<ka?(W.insert(0,w.a.createTextRange(aa.node,da,da+ka)),W.K(0).Tb=ua.qo(),this.wEa(W.K(0))):(W.K(0).Fb=0<Y?0:-1,W.K(0).Tb=0<Y?this.hb.Ex(aa.node):-1);break;case 5:case 6:this.wEa(W.K(0));W.K(0).Tb=0<this.hb.wm(W.K(0).node,this.hb.textLength(W.K(0).node))?
this.hb.Ex(aa.node):-1;6===Y&&this.GDf(aa.node,ka);qa=w.a.createTextRange(aa.node,ka,ka+da);break;case 7:ua.cpBegin&&this.GDf(aa.node,ua.cpBegin);qa=w.a.createTextRange(aa.node,ua.cpBegin,ua.cpBegin+da);ua.contextId===x.a.Cd?(W.W(0,w.a.createTextRange(aa.node,ua.cpBegin+da,ua.cpEnd+da)),this.wEa(W.K(0)),W.K(0).Tb=ua.qo()):(W.W(0,w.a.Uc(aa.node,ua.cpBegin+da)),this.wEa(W.K(0)),W.K(0).Tb=W.K(0).oo()+ua.qo()-ua.oo());break;case 9:qa=w.a.createTextRange(aa.node,ka,ka+da);W.removeAt(W.count-1);Pa.contextId===
x.a.paragraph?(W.add(w.a.create(aa.node)),W.K(W.count-1).Fb=Pa.oo(),this.Xv(W.K(W.count-1),1)):(W.add(w.a.createTextRange(aa.node,ka,ka+da)),W.add(w.a.Wl(aa.node)),da=this.hb.wm(aa.node,da+ka),W.K(W.count-1).Fb=0<da?0:-1,W.K(W.count-1).Tb=0<da?this.hb.Ex(aa.node):-1);break;case 10:qa=w.a.createTextRange(aa.node,Pa.cpEnd,Pa.cpEnd+da);Pa.cpEnd&&this.GDf(aa.node,Pa.cpEnd);W.W(W.count-1,w.a.createTextRange(aa.node,Pa.cpBegin,Pa.cpEnd+da));Pa.contextId!==x.a.Vc||Pa.oo()?W.K(W.count-1).Fb=Pa.oo():W.K(W.count-
1).Fb=-1;this.Xv(W.K(W.count-1),1);break;case 11:qa=ka?w.a.createTextRange(aa.node,0,da):w.a.create(aa.node);break;case 12:qa=w.a.createTextRange(aa.node,Pa.cpEnd,Pa.cpEnd+da);break;case 13:qa=w.a.createTextRange(W.K(0).node,W.K(0).cpBegin,W.K(0).cpBegin+da),W.W(0,qa),this.Xv(W.K(0),2)}this.Xv(qa,2);return qa}QOa(W,aa,Y=2){if(2===Y||!Y){var da=W.node.ra;0<da.length&&((da=da.first)&&-1!==W.oo()?W.Fb=da.mz:W.Fb=-1)}if(2===Y||1===Y)W=aa.node.ra,0<W.length&&((W=W.last)&&-1!==aa.qo()?aa.Tb=W.mz+W.pS+W.z2:
aa.Tb=-1)}ROa(W,aa=null){switch(W.contextId){case x.a.paragraph:this.Tvp(W);break;case x.a.Cd:this.Vvp(W,aa);break;case x.a.Vc:this.Qvp(W,aa)}}Qvp(W,aa=null){0<this.hb.wm(W.node,W.cpBegin)?W.Fb=W.Tb=this.hb.vy(W.node):W.Fb=W.Tb=-1;W.Tb=W.Fb+(aa?aa.qo()-aa.oo():0)}Vvp(W,aa){const Y=this.hb.wm(W.node,W.cpBegin);W.Tb=aa.qo();W.Fb=0<Y?this.hb.vy(W.node):-1}Tvp(W){var aa=this.hb.textLength(W.node);const Y=this.hb.wm(W.node,0);aa=this.hb.wm(W.node,aa);W.Fb=0<Y?this.hb.vy(W.node):-1;W.Tb=0<aa?this.hb.Ex(W.node):
-1}Xv(W,aa=2,Y=null){switch(W.contextId){case x.a.paragraph:this.Svp(W,aa);break;case x.a.Cd:this.Uvp(W,aa);break;case x.a.Vc:this.Rvp(W,Y)}}wEa(W){const aa=W.contextId!==x.a.Zc?W.cpBegin:this.hb.textLength(W.node);W.Fb=0<this.hb.wm(W.node,aa)?0:-1}Rvp(W,aa=null){0<this.hb.wm(W.node,W.cpBegin)?W.Fb=0:W.Fb=-1;W.Tb=W.Fb+(aa?aa.qo()-aa.oo():0)}Uvp(W,aa=2){const Y=this.hb.wm(W.node,W.cpBegin),da=this.hb.wm(W.node,W.cpEnd);switch(aa){case 2:W.Fb=0<Y?Y:-1;W.Tb=0<da?0:-1;break;case 0:W.Fb=0<Y?Y:-1;break;
case 1:W.Tb=0<da?0:-1}}Svp(W,aa=2){const Y=this.hb.textLength(W.node);var da=this.hb.wm(W.node,0),ka=this.hb.wm(W.node,Y);const qa=0<da?da:-1;ka=0<ka?0:-1;const ua=0<da?da/2:-1;da=0<da?da/2:-1;switch(aa){case 2:W.Fb=0<Y?qa:ua;W.Tb=0<Y?ka:da;break;case 0:W.Fb=0<Y?qa:ua;break;case 1:W.Tb=0<Y?ka:da}}Fnm(W,aa=!1){const Y=W.node;var da=this.hb.pg(Y,!1);if(!da)da=w.a.Uc(Y,this.hb.textLength(Y)),da.Fb=da.Tb=W.qo(),{tNb:da}=this.Fmc(da,!1),da=da.Vb(2);else if(aa){W=this.ld.Q2(da);for(aa=null;W&&da===this.hb.Zm(W);)aa=
W,W=this.ld.Q2(W);aa&&(da=this.ld.uSi(aa,!0))}return w.a.Uc(da,0)}insertBreak(W,aa,Y,da,ka,qa,ua,Pa=null,Ja=!1){this.FW(W,Y,6===aa?0:1);let Ca=null,ra=({BL:Ca}=this.dN(W.K(0),W.K(W.count-1),Y)).returnValue;const Ea=new z.a;Ea.set(Ca.node);Ea.zb(23)||6===aa||(R.ULS.sendTraceTag(17577860,369,15,"Inserting Break (excpect LineBreak) is only allowed in the main document."),Q.a.hg());Pa&&Pa.exb();switch(aa){case 0:Ca=this.sh.GOa(Ca,W);32!==this.ga.Hf(Ca,O.a.SKa,2,!1,null,null)&&Q.a.hg();Ja&&this.n7j(W,
aa,ra);Pa&&Pa.uza(W);ka(null);break;case 6:(da=this.dee(W,Y))&&({BL:Ca,returnValue:ra}=this.dN(W.K(0),W.K(W.count-1),Y));this.Rd.Lla(Ca,xa=>new u.a(xa));Ja&&this.n7j(W,aa,ra);da&&this.Xse(W,Y);Pa&&Pa.uza(W);ka(null);break;case 2:case 1002:case 3:case 4:case 5:(Y=this.sh.EDi(Ca,Ca))&&0<Y.count&&(Pa&&Pa.uza(W),Q.a.Gzc(da.appId,"Insert section break in content control is not allowed on wac currently.",void 0,X.a[aa]));this.w7c(da,ka,qa,ua);this.Hbn(Ca,aa,W,ra,Object(N.a)(this,this.Mxp,"updateGncListForInsertSectionBreak"),
Pa);break;default:R.ULS.sendTraceTag(17179037,369,15,"The breakType parameter is invalid: {0}.",X.a[aa]),Q.a.td()}}Hbn(W,aa,Y,da,ka,qa){let ua=0;switch(aa){case 2:case 1002:ua=2;break;case 3:ua=3;break;case 4:ua=4;break;case 5:ua=5;break;default:R.ULS.sendTraceTag(18957145,369,15,"The breakType parameter is undefined: {0}.",X.a[aa]),Q.a.td()}this._context.Cn.CF();this.vGa.xxe([W],"<w:p xmlns:w='http://schemas.microsoft.com/office/word/2003/wordml'><w:r><w:rPr><w:b/><w:b-cs/><w:color w:val='FF0000'/><w:sz w:val='28'/><w:sz-cs w:val='28'/></w:rPr><w:t>H</w:t></w:r></w:p>",
0,0,ua,null,()=>{ka&&ka(Y,da);this.nT(null);this._context.Cn.Dv();qa&&qa.uza(Y);Q.a.oP("InsertApiOperations.InsertSectionBreakUsingOoxml",Q.a.fQ(this.Z4),191)},Pa=>{R.ULS.sendTraceTag(18957146,369,10,"AppId:{0}, {1}",this._context.appId,U.a[Pa]);this.Mpa(U.a[Pa]);this._context.Cn.Dv();qa&&qa.uza(Y);Q.a.oP("InsertApiOperations.InsertSectionBreakUsingOoxml",Q.a.fQ(this.Z4),191,!1)})}Mxp(W,aa){const Y=W.K(0),da=W.K(W.count-1);if(7===aa)W.W(0,w.a.XT(0,Y.cpEnd-Y.cpBegin,!1,Y.node));else if(12===aa){const ka=
this.hb.pg(da.node,!0,!0);W.W(W.count-1,w.a.XT(da.cpBegin,da.cpEnd,!1,ka))}this.i6j(Y,W,aa)}n7j(W,aa,Y){const da=W.K(0);var ka=da.node;switch(aa){case 6:4===Y?(aa=this.hb.textLength(ka),W.W(0,w.a.Wl(ka)),1<aa&&W.insert(0,w.a.createTextRange(ka,1,aa))):7===Y&&((aa=da.cpEnd-da.cpBegin)?W.W(0,w.a.createTextRange(ka,da.cpBegin+1,da.cpEnd+1)):W.W(0,w.a.Uc(ka,da.cpBegin+1)));this.Ivp(da,W,Y);break;case 0:7===Y&&da.cpBegin?(ka=this.hb.pg(this.hb.pg(ka,!1),!1),aa=da.cpEnd-da.cpBegin,W.W(0,aa?w.a.createTextRange(ka,
0,aa):w.a.Uc(ka,0)),1<W.count&&W.K(1).contextId===x.a.Zc&&W.W(1,w.a.Wl(ka))):6===Y&&(ka=this.hb.pg(this.hb.pg(ka,!1),!1),W.W(0,w.a.Wl(ka))),this.i6j(da,W,Y)}}i6j(W,aa,Y){7===Y||6===Y||5===Y?(Y=aa.K(0).node.ra,0<Y.length?(Y=Y.first)&&-1!==aa.K(0).oo()&&0<Y.mz&&(aa.K(0).Fb=Y.mz):aa.K(0).Fb=-1,this.l6j(aa.K(0),W)):12===Y&&(W=aa.K(aa.count-1),aa=this.hb.wm(W.node,W.cpEnd),W.Tb=0<aa?W.qo():-1,W.contextId===x.a.Vc&&(W.Fb=0<aa?W.oo():-1))}Ivp(W,aa,Y){4===Y||7===Y||5===Y||6===Y?(Y=aa.K(0).contextId===x.a.Vc||
aa.K(0).contextId===x.a.Cd?aa.K(0).cpBegin:this.hb.textLength(aa.K(0).node),Y=this.hb.wm(aa.K(0).node,Y),aa.K(0).Fb=0<Y?0:-1,this.l6j(aa.K(0),W)):12===Y&&(W=aa.K(aa.count-1),aa=W.qo()-W.oo(),Y=this.hb.wm(W.node,W.cpEnd),W.Tb=0<Y?Y:-1,W.contextId===x.a.Vc&&(W.Fb=W.qo()-aa))}l6j(W,aa){W&&aa&&(W.Tb=W.contextId===x.a.Vc||W.contextId===x.a.Zc?W.oo()+(aa.qo()-aa.oo()):aa.qo())}w7c(W,aa,Y,da){this._context=W;this.nT=aa;this.Mpa=Y;this.Z4=da}$6a(W,aa=!0){var Y=0;if(this.c9c(W)){const da=this.Y5d(W);-1!==
da&&(Y=da+2>this.hb.textLength(W)?this.hb.textLength(W):da+2)}Y=aa?Y:this.hb.textLength(W);Y=w.a.Uc(W,Y);Y.Fb=Y.Tb=aa?this.hb.vy(W):this.hb.Ex(W);return Y}H0f(W){return Q.a.p1c()?z.a.eb(W).zb(37)?!0:!1:!1}c9c(W){const aa=this.uG.V8a(W);if(aa&&this.hb.Zm(aa)==W)return!0}V8a(W){return this.uG.V8a(W)}Y5d(W){W=W.ra;for(let aa=0;aa<W.length;aa++){const Y=W.Ub(aa),da=Y.blob;if(null!==da&&10===da.Sh)return Y.cp}return-1}insertParagraph(W,aa,Y){this.FW(W,Y,1);var da=!1;switch(Y){case 0:da=!0;break;case 1:da=
!1}aa=Q.a.OWc(aa);const ka=da?W.K(0):W.K(W.count-1),qa=this.hb.textLength(ka.node);let ua;var Pa=this.hb.pg(W.K(W.count-1).node,!1);({BL:ua}=this.dN(W.K(0),W.K(W.count-1),Y,!0));ua=this.sh.GOa(ua,W);if(ka.contextId===x.a.paragraph||ka.contextId===x.a.Zc){da=this.ld.Q2(ka.node);const Ja=this.ld.Q2(Pa);Pa=!Pa;da=!Pa&&!!Ja&&Ja!==da;if(1===Y&&(Pa||da)){let Ca;Y=this.U7c((Ca=new E.a,Ca.add(ua),Ca),aa,3).K(0).node}else!Y&&ka.contextId===x.a.Zc&&0<qa?(Y=this.vWa(ua,aa,!1),W.W(0,w.a.Wl(Y)),W.K(0).Fb=W.K(0).Tb=
this.hb.Ex(Y)):Y=this.vWa(ua,aa,!0)}else da?ka.cpBegin?ka.cpBegin===qa?(Y=this.vWa(ua,aa,!1),W.W(0,w.a.Cx(Y)),0<aa.length?this.Xv(W.K(0),2,ka):(aa=this.hb.wm(Y,0),W.K(0).Fb=0<aa?aa/2:-1,W.K(0).Tb=W.K(0).Fb+ka.qo()-ka.oo())):Y=this.WUf(ua,aa,da,W):Y=this.vWa(ua,aa,!0):ka.cpEnd===qa?Y=this.vWa(ua,aa,!1):ka.cpEnd?Y=this.WUf(ua,aa,da):(Y=this.vWa(ua,aa,!0),W.W(0,w.a.Uc(Y,0)),0<aa.length?this.ROa(W.K(0),ka):(aa=this.hb.wm(Y,0),W.K(0).Fb=0<aa?aa/2:-1,W.K(0).Tb=W.K(0).Fb+ka.qo()-ka.oo()));return Y}WUf(W,
aa,Y,da=null){let ka;({RIj:ua,tNb:ka}=this.Fmc(W));W=this.Vh.Psa(ua);if(Y){Y=ka.Vb(2);var qa=da.K(0).oo();var ua=da.K(0).qo();da.K(0).contextId===x.a.Cd?(qa=da.K(0).cpEnd-da.K(0).cpBegin,da.W(0,w.a.createTextRange(Y,0,qa)),0<this.hb.wm(Y,da.K(0).cpBegin)?da.K(0).Fb=this.hb.vy(Y):da.K(0).Fb=-1,da.K(0).Tb=ua):(da.W(0,w.a.Uc(Y,0)),0<this.hb.wm(Y,da.K(0).cpBegin)?(da.K(0).Fb=qa+this.hb.vy(Y),da.K(0).Tb=da.K(0).Fb+ua-qa):da.K(0).Fb=da.K(0).Tb=-1);1<da.count&&da.K(1).contextId===x.a.Zc&&da.W(1,w.a.Wl(Y));
ka.uc();da=w.a.Uc(Y,0);0<this.hb.wm(Y,da.cpBegin)&&(da.Fb=da.Tb=this.hb.vy(Y));this.Vh.Eca(ka,W,da,!0,!0,!1)}else Y=ua.Vb(2),ua.uc(),da=w.a.Cx(Y),0<this.hb.wm(Y,da.cpBegin)?da.Fb=da.Tb=this.hb.Ex(Y):da.Fb=da.Tb=-1,this.Vh.Eca(ua,W,da,!0,!0,!0);W=W.Vb(2);da=w.a.Uc(W,0);0<this.hb.wm(W,0)?da.Fb=da.Tb=this.hb.vy(W):da.Fb=da.Tb=-1;this.Rd.We(da,aa);return W}vWa(W,aa,Y,da=!1){({tNb:W}=this.Fmc(W,Y,da));W=W.Vb(2);Y=w.a.Uc(W,0);0<this.hb.wm(W,0)&&(Y.Fb=Y.Tb=this.hb.wm(W,0)/2);this.Rd.We(Y,aa);return W}Fmc(W,
aa=!1,Y=!1){var da,ka=null;const qa=new z.a;qa.set(W.node);qa.zb(11)&&(ka=qa.Dp(11));if((null===(da=this.LF)||void 0===da?0:da.G_a)&&!Y)return ka=z.a.eb(ka),W=this.LF.G_a(W.node,W.cpBegin,{eem:!0,P$m:aa,Fb:W.Fb,Tb:W.Tb}),{RIj:ka,tNb:W};Y?(Y=z.a.eb(ka),Y.zb(40),Y.kd(40),da=new D.a,Y.VJ(da,ka,1),Y=z.a.eb(da),ka=z.a.eb(ka)):(ka=z.a.eb(ka),ka.Nd(),v.OutlineElementNavigator.me(ka),Y=aa?this.Vh.lbn(ka):this.Vh.Psa(ka));this.Vh.Eca(ka,Y,W,!0,!0,!aa);return{RIj:ka,tNb:Y}}FW(W,aa,Y){W&&W.count||(R.ULS.sendTraceTag(22577489,
369,10,"The gncList shouldn't be null or empty."),Q.a.hg());if(Q.a.p1c()){var da=this.ld.ADi(W.K(0).node,W.K(W.count-1).node);da&&4===aa&&0===Y&&37===da.type&&Q.a.aHg()}if(1!==W.count||W.K(0).contextId!==x.a.table){da=new E.a;var ka=3;if(Y&&1!==Y)2===Y?da=W:Q.a.hg();else switch(ka=1,aa){case 2:case 0:W=this.yui(W.K(0));da.add(W);1===Y&&(ka=5);break;case 3:case 1:W=this.yui(W.K(W.count-1),!1);da.add(W);1===Y&&(ka=5);break;case 4:da=W,ka=4,1===Y&&(ka=6)}(y.a.Caa?this.qoa.cVc(da,ka):this.qoa.cVc(da,
ka)&&!this.g7l(da))||(R.ULS.sendTraceTag(21033307,369,15,"The inserting operation here is not allowed due to conflict with non-deletable or non-editable content control or field range."),Q.a.sC())}}g7l(W){for(let aa=0;aa<W.count;aa++){const Y=W.K(aa);if(Y.contextId===x.a.Vc||Y.contextId===x.a.Cd){if(this.h7l(Y))return!0}else if((Y.contextId===x.a.Zc||Y.contextId===x.a.paragraph)&&this.f7l(Y))return!0}return!1}h7l(W){const aa=W.cpBegin,Y=W.cpEnd;W=this.hb.wVa(W.node);let da=0;for(;da<W.length;){const ka=
W[da];if(ka.end<=aa)da++;else{if(Y<=ka.Dc)break;return aa>ka.Dc||ka.end>Y}}return!1}f7l(W){W=W.node;return W.ka(K.a.OBa,!1)||this.xl.hab(W)}insertText(W,aa,Y,da=-1,ka=null,qa=null){if(void 0===aa||null===aa)R.ULS.sendTraceTag(18477965,369,15,"Inserted text can not be null"),Q.a.td();this.FW(W,Y,0);const ua=4!==Y&&this.dee(W,Y);var Pa=Q.a.lyc(aa),Ja=Pa.length;if(1<Ja){this.FW(W,Y,1);var Ca=null;W.K(0).contextId===x.a.paragraph&&4===Y?Ca=w.a.Uc(W.K(W.count-1).node,0):{BL:Ca}=this.dN(W.K(0),W.K(W.count-
1),Y);aa=Pa.shift();const xa=Pa.pop();var ra=" "+aa;const Ma=xa+" ";4!==Y&&(Ca=this.sh.GOa(Ca,W));var Ea=new E.a;Ea.addRange(W);this.U7c(Ea,ra+Ma,Y,!1,da,ka,qa);ka=w.a.Uc(Ca.node,Ca.cpBegin+ra.length);ka.Fb=ka.Tb=-1;4===Y&&(qa=this.sh.hcl(Ca,ka),ka=this.sh.GOa(ka,Ea),Ca=w.a.Uc(ka.node,Math.max(ka.cpBegin-ra.length,0)),this.sh.lIo(Ca,qa,Ca,ka));({tNb:Ea}=this.Fmc(ka,!1));ra=Ca.node;Ea=Ea.Vb(2);ka=null;if(2<Ja&&(ka=this.qF(Pa,Ca.node,!1),1===da&&(da=ka.count,Ja=Ea.ra.first,Pa=this.FRe.uHi(ra.ra.last),
Ja=this.FRe.tHi(Ja),Ja.length!==Pa.length&&(R.ULS.sendTraceTag(508654922,324,15,"Number of field begins and ends that should be copied should be the same, but it's not."),Q.a.td()),0!==Ja.length&&0!==Pa.length)))for(qa=1;qa<da;qa++)this.FRe.q8h(ka.K(qa).node,Ja,Pa);da=w.a.createTextRange(ra,Ca.cpBegin,Ca.cpBegin+1);this.Xv(da,2);this.Rd.We(da,"");Ca.cpBegin||this.hb.textLength(ra)!==aa.length?aa.length?(Pa=w.a.createTextRange(ra,Ca.cpBegin,Ca.cpBegin+aa.length),this.Xv(Pa,2)):(Pa=w.a.Wl(ra),Pa.Fb=
Pa.Tb=this.hb.Ex(ra)):(Pa=w.a.create(ra),this.Xv(Pa,2));Ca=w.a.createTextRange(Ea,xa.length,xa.length+1);this.Xv(Ca,2);this.Rd.We(Ca,"");Ja=w.a.XT(0,xa.length,!1,Ea);this.hb.textLength(Ea)===xa.length&&(Ja=w.a.create(Ea),this.Xv(Ja,2));Ca=new E.a;da=new E.a;da.add(Pa);da.K(da.count-1).contextId===x.a.Cd&&(Pa=w.a.Wl(ra),Pa.Fb=Pa.Tb=this.hb.Ex(ra),da.add(Pa));ka&&da.addRange(ka);da.add(Ja);ka=W.K(0);Pa=W.K(W.count-1);switch(Y){case 2:Ca.addRange(da);W.K(0).contextId===x.a.paragraph||W.K(0).contextId===
x.a.Zc?(Ca.removeAt(Ca.count-1),W.W(0,w.a.create(Ea)),W.K(0).Tb=ka.qo(),this.Xv(W.K(0),0)):W.K(0).contextId===x.a.Cd?(Ca.removeAt(Ca.count-1),1<W.count&&W.K(0).node.id.equals(W.K(1).node.id)&&W.K(1).contextId===x.a.Zc?(W.W(0,w.a.create(Ea)),W.K(0).Tb=ka.qo(),this.Xv(W.K(0),0),W.removeAt(1)):(W.W(0,w.a.createTextRange(Ea,0,W.K(0).cpEnd-W.K(0).cpBegin+xa.length)),W.K(0).Tb=ka.qo(),this.Xv(W.K(0),0))):W.K(0).contextId===x.a.Vc&&W.removeAt(0);Ca.addRange(W);break;case 3:if(Pa.contextId===x.a.paragraph||
Pa.contextId===x.a.Zc||Pa.contextId===x.a.Cd&&!Pa.cpBegin)W.W(W.count-1,w.a.create(ra)),W.K(W.count-1).Fb=Pa.oo(),this.Xv(W.K(W.count-1),1);else if(Pa.contextId===x.a.Cd||Pa.contextId===x.a.Vc)Pa.cpBegin!==Pa.cpEnd||Pa.cpBegin===Pa.cpEnd&&aa.length?(W.W(W.count-1,w.a.createTextRange(ra,Pa.cpBegin,Pa.cpEnd+aa.length)),W.K(W.count-1).Fb=Pa.oo(),this.Xv(W.K(W.count-1),1)):W.removeAt(W.count-1),W.add(w.a.Wl(ra)),W.K(W.count-1).Fb=W.K(W.count-1).Tb=0<this.hb.wm(ra,this.hb.textLength(ra))?this.hb.Ex(ra):
-1;Ca.addRange(W);aa=da.K(0);da.removeAt(0);Ca.addRange(da);da.insert(0,aa);break;case 0:W.K(0).contextId===x.a.Cd?(W.W(0,w.a.createTextRange(Ea,xa.length,xa.length+W.K(0).cpEnd-W.K(0).cpBegin)),W.K(0).Tb=ka.qo(),this.Xv(W.K(0),0),1<W.count&&W.K(1).contextId===x.a.Zc&&(aa=W.K(1),W.W(1,w.a.Wl(Ea)),W.K(1).Fb=aa.oo(),W.K(1).Tb=aa.qo())):W.K(0).contextId===x.a.Vc?(W.W(0,w.a.Uc(Ea,xa.length+W.K(0).cpBegin)),this.Xv(W.K(0),0),W.K(0).Tb=W.K(0).Fb+ka.qo()-ka.oo()):W.K(0).contextId===x.a.Zc?(W.W(0,w.a.Wl(Ea)),
W.K(0).Fb=-1!==ka.qo()?0:-1,W.K(0).Tb=0<this.hb.wm(Ea,this.hb.textLength(Ea))?this.hb.Ex(Ea):-1):W.K(0).contextId===x.a.paragraph&&(xa.length&&this.hb.textLength(Ea)?(W.W(0,w.a.XT(xa.length,this.hb.textLength(Ea),!1,Ea)),W.K(0).Tb=ka.qo(),this.Xv(W.K(0),0),1<W.count&&(W.insert(1,w.a.Wl(Ea)),W.K(1).Fb=W.K(1).Tb=ka.qo(),W.K(0).contextId===x.a.Vc&&W.removeAt(0))):(W.W(0,w.a.create(Ea)),W.K(0).Tb=ka.qo(),this.Xv(W.K(0),0)));Ca.addRange(W);break;case 1:Ca.addRange(W);break;case 4:Ca.addRange(da)}ua&&this.Xse(Ca,
Y);W.clear();W.addRange(Ca);return da}return this.U7c(W,aa,Y,ua,da,ka,qa)}dee(W,aa){let Y;({BL:Y}=this.dN(W.K(0),W.K(W.count-1),aa));var da=this.sh.W$a(Y);da&&(this.sh.osd(Y),da=this.sh.W$a(Y));if(!da)return!1;da=null;let ka=0;var qa=W.K(W.count-1);if(1===aa&&(qa.contextId===x.a.Zc||qa.contextId===x.a.paragraph)&&(qa=this.hb.pg(qa.node,!1))){const ua=w.a.Uc(qa,0);this.sh.W$a(ua)||(da=ua,da.Fb=da.Tb=0<this.hb.wm(qa,0)?this.hb.vy(qa):-1,ka=W.count)}if(!da){let ua;qa=this.insertParagraph((ua=new E.a,
ua.add(Y),ua),"",0);2!==aa&&aa&&4!==aa?(da=w.a.Uc(qa,0),ka=W.count):(da=w.a.create(qa),ka=0);aa=this.hb.wm(qa,0);da.Fb=da.Tb=0<aa?aa/2:-1}W.insert(ka,da);return!0}U7c(W,aa,Y,da=!1,ka=-1,qa=null,ua=null){const Pa=aa.length;let Ja=new E.a;var Ca=W.K(0);var ra=W.K(W.count-1);const Ea=({BL:ra}=this.dN(Ca,ra,Y)).returnValue,xa=ra.node.characterData.length;if(13===Ea)return this.sh.KNb(),this.WLb(W),this.sh.tJa(),Ca.contextId!==x.a.Vc&&this.sh.W$a(W.K(0))&&this.K7j(W.K(0)),Ja=this.insertText(W,aa,0,ka,
qa,ua),W.clear(),W.addRange(Ja),Ja;if(1===ka){if((ka=ra.node.ra.Dh(ra.cpBegin))&&ka.lc)if(0===Y)if(Ca=ka.lc.hic(2))qa=ka.By.indexOf(Ca),-1!==qa&&(ra.Uea=qa+1,ra.Pra=ra.Uea),this.Rd.We(ra,aa,this.XTb);else for(ua?this.QDb.insertField(ra,ua,aa):this.QDb.insertField(ra," ADDIN \\* MERGEFORMAT ",aa),aa=ka.lc.length-1;0<=aa;aa--)ua=ka.lc.K(aa),0===ua.pe&&qa&&(ua.data=m.from(qa,"utf8").toString("base64"));else Ca=2===Y?ka.lc.hic(2):ka.lc.hic(3),qa=ka.By.indexOf(Ca),-1!==qa&&(ra.Uea=2===Y?qa+1:qa,ra.Pra=
ra.Uea),this.Rd.We(ra,aa,this.XTb)}else this.Rd.We(ra,aa,this.XTb);Ja.add(this.vEe(W,ra,Ea,Pa,xa));da&&this.Xse(W,Y);return Ja}qF(W,aa,Y){const da=new E.a;var ka=W.length;if(0<ka&&aa){aa=w.a.create(aa);this.Xv(aa);da.add(aa);if(Y)for(--ka;0<=ka;ka--)Y=this.insertParagraph(da,W[ka],0),Y=w.a.create(Y),this.Xv(Y),da.insert(0,Y);else for(let qa=0;qa<ka;qa++)Y=this.insertParagraph(da,W[qa],1),Y=w.a.create(Y),this.Xv(Y),da.add(Y);da.remove(aa)}return da}QQl(W){let aa;this.FW((aa=new E.a,aa.add(W),aa),4,
2);this.Rd.We(W,"")}vrl(W,aa,Y,da,ka){this.FW(W,4,2);this.w7c(aa,Y,da,ka);this._context.Cn.CF();this.vGa.xxe(W.toArray(),"<pkg:package xmlns:pkg='http://schemas.microsoft.com/office/2006/xmlPackage'><pkg:part pkg:name='/_rels/.rels' pkg:contentType='application/vnd.openxmlformats-package.relationships+xml' pkg:padding='512'><pkg:xmlData><Relationships xmlns='http://schemas.openxmlformats.org/package/2006/relationships'><Relationship Id='rId1' Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument' Target='word/document.xml'/></Relationships></pkg:xmlData></pkg:part><pkg:part pkg:name='/word/document.xml' pkg:contentType='application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml'><pkg:xmlData><w:document xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main' ><w:body></w:body></w:document></pkg:xmlData></pkg:part></pkg:package>",
0,0,0,null,()=>{this.nT(null);this._context.Cn.Dv();Q.a.oP("InsertApiOperations.ClearBody",Q.a.fQ(this.Z4),void 0,!0)},qa=>{R.ULS.sendTraceTag(19170978,369,10,"AppId:{0}, {1}",this._context.appId,U.a[qa]);this.Mpa(U.a[qa]);this._context.Cn.Dv();Q.a.oP("InsertApiOperations.ClearBody",Q.a.fQ(this.Z4),void 0,!1)})}qfc(W,aa){const Y=w.a.create(W);aa?Y.Fb=this.hb.vy(W):Y.Tb=this.hb.Ex(W);return Y}GDf(W,aa){W=W.ra;for(let Y=0;Y<W.length;Y++)if(W.Ub(Y).cp===aa){1<=Y&&(!W.Ub(Y-1).blob||W.Ub(Y-1).formatting)&&
(W.Ub(Y).formatting=W.Ub(Y-1).formatting?W.Ub(Y-1).formatting.Of(W.Ub(Y)):null);break}}yui(W,aa=!0){if(!W)return null;let Y=null;switch(W.contextId){case x.a.paragraph:Y=aa?w.a.Uc(W.node,0):w.a.Cx(W.node);break;case x.a.Zc:Y=w.a.Cx(W.node);break;case x.a.Cd:case x.a.Vc:Y=w.a.Uc(W.node,aa?W.cpBegin:W.cpEnd)}Y.Fb=aa?Y.Tb=W.oo():Y.Tb=W.qo();return Y}LZd(W){const aa=[];for(var Y of W)if(Y&&Y.contextId!==x.a.Vc){if(Y.contextId===x.a.Zc){const da=Y.iterator;da.Nd();da.uc();if(da.EBa(1))continue}aa.push(Y)}Y=
32;0<aa.length&&(Y=this.ga.Hf(new H.a(null),F.a.Fza,2,!0,null,W.toArray()));return 32===Y}WLb(W){if(W.count&&(1!==W.count||W.K(0).contextId!==x.a.Vc)){this.FW(W,4,2);var aa=new E.a;aa.addRange(W);var Y=W.K(W.count-1),da=this.Nqn(W);if(da)this.ld.R2h(da),W.clear(),W.addRange(this.hb.NA(da,!0,!1));else{da=this.L0i(W);this.N0i(W)||da||!this.M0i(W)||Q.a.hg();if(Y.contextId===x.a.Zc)if(1<W.count)W.removeAt(W.count-1);else return;else Y.contextId!==x.a.paragraph||da||(W.W(W.count-1,w.a.XT(0,this.hb.textLength(Y.node),
!1,Y.node)),W.K(W.count-1).Tb=Y.qo(),1===W.count&&(W.K(W.count-1).Fb=Y.oo()));this.Ndi(W,aa);Q.a.dDf()&&this.Kbn(aa)}}}jgc(W){if(W.count&&(1!==W.count||W.K(0).contextId!==x.a.Vc)){this.FW(W,4,2);var aa=new E.a;aa.addRange(W);var Y=W.K(W.count-1);this.N0i(W)||this.L0i(W)||!this.M0i(W)||Q.a.hg();this.Kqn(W)&&(Y.contextId===x.a.Zc?W.removeAt(W.count-1):Y.contextId===x.a.paragraph&&(W.W(W.count-1,w.a.createTextRange(Y.node,0,this.hb.textLength(Y.node))),this.ROa(W.K(W.count-1),Y),1===W.count&&(W.K(W.count-
1).Fb=Y.oo())));this.Ndi(W,aa)}}Ndi(W,aa){const Y=W.K(0),da=W.K(W.count-1);let ka=null,qa=!1,ua=!1;Y.contextId===x.a.paragraph?({BL:ka}=this.dN(Y,da,1),qa=da.contextId===x.a.Cd&&!this.XTb):this.XTb&&1===W.count&&Y.contextId===x.a.Cd?(ua=!0,ka=this.CPm(Y,ka)):({BL:ka}=this.dN(Y,da,this.XTb?1:2),ua=this.XTb);this.LZd(W)||(W.clear(),W.addRange(aa),R.ULS.sendTraceTag(21641408,369,15,"AppId:{0}, Clear or Delete is not allowed on the current object.",this._context.appId),Q.a.hg());ua&&!this.KC.nqf(da)&&
({BL:ka}=this.dN(Y,da,0));qa&&(ka=w.a.Uc(ka.node,0),this.K7j(ka));this.hb.wm(ka.node,ka.cpBegin)||(ka.Fb=ka.Tb=-1);W.clear();W.add(ka)}CPm(W,aa){aa=0;const Y=this.KC.LAa(W.node,W.cpBegin,W.cpEnd);for(const da of Y)da.Jd.authorName===l.AFrameworkApplication.userName&&1===da.Jd.changeType&&(aa=W.cpBegin<=da.yd?da.endCp>=W.cpEnd?aa+W.cpEnd-da.yd:aa+da.endCp-da.yd:da.endCp<=W.cpEnd?aa+da.endCp-W.cpBegin:aa+W.cpEnd-W.cpBegin);aa=w.a.Uc(W.node,W.cpBegin+(W.cpEnd-W.cpBegin-aa));aa.Fb=W.oo();aa.Tb=W.oo();
return aa}K7j(W){var aa=W.node.ra;if(0<aa.length){if(aa=aa.Dh(W.cpBegin))aa=aa.mz+aa.pS,W.Fb=W.Tb=0<aa?aa:-1}else W.Fb=W.Tb=-1}Nqn(W){const aa=W.K(0);W=W.K(W.count-1);const Y=this.ld.qla(aa.node,!0),da=this.hb.Zm(Y),ka=this.hb.GF(Y);return aa.contextId!==x.a.paragraph&&aa.contextId!==x.a.Zc||W.contextId!==x.a.paragraph&&W.contextId!==x.a.Zc||!da||da.id!==aa.node.id||!ka||ka.id!==W.node.id?null:Y}N0i(W){const aa=W.K(0);var Y=W.K(W.count-1);W=this.ld.qla(aa.node,!0);const da=this.hb.Zm(W);Y=this.ld.qla(Y.node,
!0);return!da||da.id!==aa.node.id||Y&&W.id===Y.id?!1:!0}L0i(W){var aa=W.K(0);W=W.K(W.count-1);const Y=this.ld.qla(W.node,!0),da=this.hb.GF(Y);aa=this.ld.qla(aa.node,!0);return!da||da.id!==W.node.id||aa&&Y.id===aa.id?!1:!0}Kqn(W){var aa=W.K(0),Y=W.K(W.count-1);aa=this.hb.pg(aa.node,!0);W=this.ld.qla(aa,!0);W=this.hb.GF(W);Y=this.hb.pg(Y.node,!1);var da=this.ld.qla(Y,!0);da=this.hb.Zm(da);return W&&W.id===aa.id&&da&&da.id===Y.id?!0:!1}M0i(W){const aa=W.K(0);W=W.K(W.count-1);const Y=this.ld.qla(aa.node,
!0),da=this.ld.qla(W.node,!0),ka=this.ld.qla(aa.node,!1),qa=this.ld.qla(W.node,!1),ua=this.hb.Zm(Y),Pa=this.hb.GF(da);return!Y&&!da||ua&&ua.id===aa.node.id&&Pa&&Pa.id===W.node.id||ka&&qa&&ka.id===qa.id?!1:!0}get XTb(){return this.Zd.Bg}Zan(W,aa,Y){var da=Q.a.lyc(aa),ka=da.length;if(1<ka){var qa=null;W.K(0).contextId===x.a.paragraph&&4===Y?qa=w.a.Uc(W.K(W.count-1).node,0):{BL:qa}=this.dN(W.K(0),W.K(W.count-1),Y);aa=da.shift();const Ca=da.pop();var ua=" "+aa,Pa=Ca+" ",Ja=new E.a;Ja.addRange(W);this.U7c(Ja,
ua+Pa,Y,!1);Pa=w.a.Uc(qa.node,qa.cpBegin+ua.length);Pa.Fb=Pa.Tb=-1;4===Y&&(qa=w.a.Uc(Pa.node,Math.max(Pa.cpBegin-ua.length,0)));({tNb:Pa}=this.Fmc(Pa,!1,!0));ua=qa.node;Pa=Pa.Vb(2);Ja=null;2<ka&&(Ja=this.NYk(da,qa.node));da=w.a.createTextRange(ua,qa.cpBegin,qa.cpBegin+1);da.Fb=da.Tb=-1;this.Rd.We(da,"");ka=qa.cpBegin||this.hb.textLength(ua)!==aa.length?aa.length?w.a.createTextRange(ua,qa.cpBegin,qa.cpBegin+aa.length):w.a.Wl(ua):w.a.create(ua);qa=w.a.createTextRange(Pa,Ca.length,Ca.length+1);this.Rd.We(qa,
"");let ra=w.a.XT(0,Ca.length,!1,Pa);this.hb.textLength(Pa)===Ca.length&&(ra=w.a.create(Pa));qa=new E.a;da=new E.a;da.add(ka);da.K(da.count-1).contextId===x.a.Cd&&(ka=w.a.Wl(ua),da.add(ka));Ja&&da.addRange(Ja);da.add(ra);Ja=W.K(W.count-1);switch(Y){case 2:qa.addRange(da);W.K(0).contextId===x.a.paragraph||W.K(0).contextId===x.a.Zc?(qa.removeAt(qa.count-1),W.W(0,w.a.create(Pa))):W.K(0).contextId===x.a.Cd?(qa.removeAt(qa.count-1),1<W.count&&W.K(0).node.id.equals(W.K(1).node.id)&&W.K(1).contextId===x.a.Zc?
(W.W(0,w.a.create(Pa)),W.removeAt(1)):W.W(0,w.a.createTextRange(Pa,0,W.K(0).cpEnd-W.K(0).cpBegin+Ca.length))):W.K(0).contextId===x.a.Vc&&W.removeAt(0);qa.addRange(W);break;case 3:if(Ja.contextId===x.a.paragraph||Ja.contextId===x.a.Zc||Ja.contextId===x.a.Cd&&!Ja.cpBegin)W.W(W.count-1,w.a.create(ua));else if(Ja.contextId===x.a.Cd||Ja.contextId===x.a.Vc)Ja.cpBegin!==Ja.cpEnd||Ja.cpBegin===Ja.cpEnd&&aa.length?W.W(W.count-1,w.a.createTextRange(ua,Ja.cpBegin,Ja.cpEnd+aa.length)):W.removeAt(W.count-1),W.add(w.a.Wl(ua));
qa.addRange(W);Y=da.K(0);da.removeAt(0);qa.addRange(da);da.insert(0,Y);break;case 0:W.K(0).contextId===x.a.Cd?(W.W(0,w.a.createTextRange(Pa,Ca.length,Ca.length+W.K(0).cpEnd-W.K(0).cpBegin)),1<W.count&&W.K(1).contextId===x.a.Zc&&W.W(1,w.a.Wl(Pa))):W.K(0).contextId===x.a.Vc?W.W(0,w.a.Uc(Pa,Ca.length+W.K(0).cpBegin)):W.K(0).contextId===x.a.Zc?W.W(0,w.a.Wl(Pa)):W.K(0).contextId===x.a.paragraph&&(Ca.length&&this.hb.textLength(Pa)?(W.W(0,w.a.XT(Ca.length,this.hb.textLength(Pa),!1,Pa)),1<W.count&&(W.insert(1,
w.a.Wl(Pa)),W.K(0).contextId===x.a.Vc&&W.removeAt(0))):W.W(0,w.a.create(Pa)));qa.addRange(W);break;case 1:qa.addRange(W);break;case 4:for(Y=0;Y<W.count-1;++Y)aa=W.K(Y).node,aa=z.a.eb(aa),aa.zb(40),aa.uc(),aa.Tg();qa.addRange(da)}W.clear();W.addRange(qa);return da}}NYk(W,aa){const Y=new E.a,da=W.length;if(0<da&&aa){aa=w.a.create(aa);Y.add(aa);for(let qa=0;qa<da;qa++){var ka=this.dan(Y,W[qa]);ka=w.a.create(ka);Y.add(ka)}Y.remove(aa)}return Y}dan(W,aa){aa=Q.a.OWc(aa);var Y=W.K(W.count-1);const da=this.hb.textLength(Y.node);
let ka;const qa=this.hb.pg(W.K(W.count-1).node,!1);ka=this.oxm(W.K(W.count-1));if(Y.contextId===x.a.paragraph||Y.contextId===x.a.Zc)if(qa)Y.contextId===x.a.Zc&&0<da?(Y=this.vWa(ka,aa,!1,!0),W.W(0,w.a.Wl(Y))):Y=this.vWa(ka,aa,!0,!0);else{let ua;Y=this.U7c((ua=new E.a,ua.add(ka),ua),aa,3).K(0).node}else Y.cpEnd===da?Y=this.vWa(ka,aa,!1,!0):Y.cpEnd?Y=this.WUf(ka,aa,!1):(Y=this.vWa(ka,aa,!0,!0),W.W(0,w.a.Uc(Y,0)));return Y}oxm(W){var aa=null;W.contextId===x.a.paragraph||W.contextId===x.a.Zc?(W=W.node,
aa=this.hb.pg(W,!1),aa||(W=w.a.Uc(W,this.hb.textLength(W)),aa=this.ibn(W).Vb(2)),aa=w.a.Uc(aa,0)):W.contextId===x.a.Cd||W.contextId===x.a.Vc?aa=w.a.Uc(W.node,W.cpEnd):Q.a.td();return aa}ibn(W){var aa=null,Y=new z.a;Y.set(W.node);Y.zb(11)&&(aa=Y.Dp(11));Y=z.a.eb(aa);var da=z.a.eb(aa);da.zb(40);da.kd(40);const ka=new D.a;da.VJ(ka,aa,1);aa=z.a.eb(ka);da.Yj(ka);da=this.Vh.dL(aa,void 0,!0);G.a.ql.H_a(z.a.eb(Y.Vb(2)),z.a.eb(da),W,!0,!0,!0,!1);v.OutlineElementNavigator.me(aa);return aa}Kbn(W){for(const aa of W)this.c9c(aa.node)&&
this.insertText(new E.a([aa])," ",2)}kFm(W,aa){return(W=this.V8a(W))&&this.Qaa(W)===aa?W:null}}Object(f.a)(ba,"InsertApiOperations",null,[1191])}).call(this,d(1546).SBc)},1948:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.dLa=this.hhj=null;this.keepCurrentFocus=this.Ioc=!1}}Object(I.a)(m,"NoteItemActionData",null,[])},1949:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.page=0]="page";f[f.next=2]="next";f[f.tlq=1002]="sectionNext";
f[f.qlq=3]="sectionContinuous";f[f.rlq=4]="sectionEven";f[f.ulq=5]="sectionOdd";f[f.line=6]="line"})(m||(m={}));Object(I.b)("BreakType",m)},1950:function(I,J,d){(function(m){d.d(J,"a",function(){return x});var f=d(0),a=d(89),l=d(1163),w=d(1398),z=d(1396);class x extends w.a{constructor(u,v,D,y,H,F,G,K,R,E){super();this.Ld=u;this._context=v;this._id=D;this.Hlh=y;this.nk=H;this.Xx=F;this.ld=G;this.sh=K;this.Yc=R;this.Lq=E}get LSf(){return this.Hlh}set LSf(u){this.Hlh=u}get _Id(){return this._id}get _ReferenceId(){return this.Hp?
this.Vp:null}get code(){return this.Xx.ksm(this)}set code(u){81===this.type&&(null===u||void 0===u?0:u.trim().toLowerCase().startsWith("addin"))?this.Xx.BUo(this,u):z.a.aHg()}get result(){if(this.Ld){const u=this.nk.create(this.Ld,this._context);81===this.type?(u.u2d=1,u.Fpb=this.data,u.o2d=this.code):(u.u2d=0,u.Fpb=null,u.o2d=null);return u}return null}get parentBody(){return this.ld.CLf(this.Ld.K(0).node,this.Ld.K(this.Ld.count-1).node,this._context)}get parentContentControl(){const u=this.parentContentControlOrNullObject;
u||z.a.Wk();return u}get parentContentControlOrNullObject(){const u=this.Ld.K(0),v=this.Ld.K(this.Ld.count-1);return this.sh.Skc(u,v,this._context)}get parentTable(){const u=this.parentTableOrNullObject;u||z.a.Wk();return u}get parentTableCell(){const u=this.parentTableCellOrNullObject;u||z.a.Wk();return u}get parentTableCellOrNullObject(){const u=this.Ld.K(0),v=this.Ld.K(this.Ld.count-1);return this.ld.vkc(u.node,this._context,v.node)}get parentTableOrNullObject(){const u=this.Ld.K(0),v=this.Ld.K(this.Ld.count-
1);return this.ld.drb(u.node,this._context,v.node)}a8l(u){return null===u||void 0===u?void 0:u.replace(/\r?\n|\r/g,"")}fbn(u){var v;const D=RegExp(".{1,76}","g");return(null===(v=null===u||void 0===u?void 0:u.match(D))||void 0===v?void 0:v.join("\r\n").concat("\r\n"))||u}get data(){a.a.Caa||z.a.Kj();if(81!==this.type)return null;const u=this.Xx.U5d(this);return z.a.gHe?u.data?m.from(this.a8l(u.data),"base64").toString("utf16le"):null:u.data?m.from(u.data,"base64").toString("utf8"):null}set data(u){a.a.Caa||
z.a.Kj();81!==this.type&&z.a.hg();1E6<(null===u||void 0===u?void 0:u.length)&&z.a.td();u=z.a.gHe?m.from(u,"utf16le").toString("base64"):m.from(u,"utf8").toString("base64");this.Xx.U5d(this).data=z.a.gHe?this.fbn(u):u}get kind(){a.a.Caa||z.a.Kj();switch(this.type){case 81:case 88:case 13:case 31:return 2;default:return 0}}get locked(){a.a.Caa||z.a.Kj();return 88===this.type?!0:this.Xx.U5d(this).YWa}set locked(u){a.a.Caa||z.a.Kj();88!==this.type&&(this.Xx.U5d(this).YWa=u)}get showCodes(){return null}set showCodes(u){}get type(){a.a.Caa||
z.a.Kj();const u=l.a.Thc(this.code);return"addin"===u?81:"toc"===u?13:"hyperlink"===u?88:"date"===u?31:100}_KeepReference(){this.xp()}_OnAccess(){}delete(){a.a.Caa||z.a.Kj();this.Yc.jgc(this.Ld)}getNext(){const u=this.getNextOrNullObject();u||z.a.Wk();return u}getNextOrNullObject(){return this.Xx.getNextOrNullObject(this,this._context)}getRange(){return this.Ld?this.nk.create(this.Ld,this._context):null}select(u){a.a.Caa||z.a.Kj();this.Lq.select(this.Ld,u)}updateResult(){a.a.Caa||z.a.Kj();this.Xx.updateResult(this)}getTypeName(){return"Microsoft.WordServices.Field"}invokePropertyGet(u){switch(u){case 1:return this._Id;
case 2:return this._ReferenceId;case 3:return this.code;case 16:return this.data;case 13:return this.kind;case 15:return this.locked;case 5:return this.parentBody;case 6:return this.parentContentControl;case 7:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 10:return this.parentTableCell;case 11:return this.parentTableCellOrNullObject;case 9:return this.parentTableOrNullObject;case 4:return this.result;case 14:return this.showCodes;case 12:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,v){switch(u){case 3:this.code=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return;case 16:this.data=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return;case 15:this.locked=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");return;case 14:this.showCodes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,v){this.invokePropertySet(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,v){switch(u){case 1002:return this.jh();case 1001:return this.kh();case 1003:return this.VC(v);case 1004:return this.i7();case 1005:return this.j7();case 1007:return this.gha(v);case 1006:return this.uAp()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokeMethodAsync(u,v){u=this.invokeMethod(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}VC(){return this.delete()}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}gha(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"int");this.select(u);return null}uAp(){this.updateResult();return null}}Object(f.a)(x,"Field",w.a,[901])}).call(this,d(1546).SBc)},1951:function(I,
J,d){d.r(J);d.d(J,"ExtensionComponentInstance",function(){return l});I=d(0);d(1767);var m=d(1768);d(1621);var f=d(2),a=d(12);class l{constructor(w,z,x,u){this.d4b=this.YN=null;this._id=w;this.rrk=x;this.Vzk=u;this.ga=f.AFrameworkApplication.va?f.AFrameworkApplication.va:null}bHf(){return this.rrk}get appVersion(){return this.d4b}VRo(w){this.YN=w}stop(){const w=this.ga.Qb(a.a.u3h,2,this.YN);m.a.instance.aAo(this.Vzk);return 32===w}restart(){return 32===this.ga.Qb(a.a.LGj,2,this.YN)}}Object(I.a)(l,
"ExtensionComponentInstance",null,[1252])},1952:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.z_j="Taskpane";m.action="Action";m.JNo="SDXDialog";Object(I.a)(m,"ComponentTypeNames",null,[])},1953:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a,l,w){this._id=f;this.XOk=a;this.dNd=l;this.d4b=w}getId(){return this._id}getStoreId(){return this.XOk}getStoreType(){return this.dNd}}Object(I.a)(m,"ExtensionIdentity",null,[1253])},1954:function(I,J,d){d.d(J,
"a",function(){return m});I=d(0);class m{constructor(f,a,l){this.ith=l}}Object(I.a)(m,"HostProperties",null,[])},1955:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.optionalProperties={};this.SYc={}}}Object(I.a)(m,"ExtensionLaunchProperties",null,[])},1961:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1962:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingsExampleAnotherCustomAnnotation=J.RoamingSettingsExampleCustomAnnotation=
J.RoamingSettingAnnotation=void 0;const m=d(418);class f{constructor(w){m.SchemaObject.assign(f,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[f.getTypeName()])}}J.RoamingSettingAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,
w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[a.getTypeName()])}}J.RoamingSettingsExampleCustomAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleAnotherCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,
[l.getTypeName()])}}J.RoamingSettingsExampleAnotherCustomAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1963:function(I,J){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingType=void 0;I=J.RoamingSettingType||(J.RoamingSettingType={});I.SingleValue="SingleValue";I.Dictionary="Dictionary"},1964:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingsWriteSignal=J.RoamingSettingsReadSignal=J.RoamingSettingsSignal=void 0;const m=d(418);class f{constructor(w){m.SchemaObject.assign(f,
this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[f.getTypeName()])}}J.RoamingSettingsSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsReadSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal",
"AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[a.getTypeName()])}}J.RoamingSettingsReadSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsWriteSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal","AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[l.getTypeName()])}}J.RoamingSettingsWriteSignal=
l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1965:function(I){function J(d,m,f){function a(){x=this;z=arguments;u=Date.now();var D=f&&!w;w||(w=setTimeout(l,m));D&&(v=d.apply(x,z),x=z=null);return v}function l(){var D=Date.now()-u;D<m&&0<=D?w=setTimeout(l,m-D):(w=null,f||(v=d.apply(x,z),x=z=null))}var w,z,x,u,v;null==m&&(m=100);a.clear=function(){w&&(clearTimeout(w),w=null)};a.flush=function(){w&&(v=d.apply(x,z),x=z=null,clearTimeout(w),w=null)};return a}J.nUa=J;I.exports=J;Object.defineProperty(I.exports,
"debounce",{enumerable:!0,get(){return I.exports.nUa}})},1969:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,
"__esModule",{value:!0});f(d(1970),J);f(d(1971),J);f(d(1972),J);f(d(1973),J)},1970:function(I,J){Object.defineProperty(J,"__esModule",{value:!0});J.DocumentTone=J.DocumentType=J.CitationStyle=J.OutputLength=J.FilterSensitivity=J.DetailedStatusCode=J.Status=void 0;(function(d){d.Success="Success";d.BlockedByPrefilter="BlockedByPrefilter";d.BlockedByPostfilter="BlockedByPostfilter";d.UnexpectedError="UnexpectedError"})(J.Status||(J.Status={}));(function(d){d[d.Pass=0]="Pass";d[d.SourceEmpty=1]="SourceEmpty";
d[d.SourceExceedLength=2]="SourceExceedLength";d[d.BRS=3]="BRS";d[d.OutputIdentical=4]="OutputIdentical";d[d.FilteredCharInRewrite=5]="FilteredCharInRewrite";d[d.UnkInRewrite=6]="UnkInRewrite";d[d.FluencyTooMuchChange=7]="FluencyTooMuchChange";d[d.ConcisenessLonger=8]="ConcisenessLonger";d[d.InvalidSpan=9]="InvalidSpan";d[d.InputException=10]="InputException";d[d.PredictionException=11]="PredictionException";d[d.PolitenessClassifierFiltered=12]="PolitenessClassifierFiltered";d[d.SourceTooShort=13]=
"SourceTooShort";d[d.PolitenessClassifierException=14]="PolitenessClassifierException";d[d.SentenceNotEnd=15]="SentenceNotEnd";d[d.PolitenessDeltaTooSmall=16]="PolitenessDeltaTooSmall";d[d.PolitenessTooLittleChange=17]="PolitenessTooLittleChange";d[d.Prefiltered=18]="Prefiltered";d[d.RegexFiltered=19]="RegexFiltered";d[d.PostfilteredLvl2=20]="PostfilteredLvl2";d[d.PostfilteredLvl3=21]="PostfilteredLvl3";d[d.OutputFiltered=91]="OutputFiltered";d[d.InputFilteredIncompleteBP=92]="InputFilteredIncompleteBP"})(J.DetailedStatusCode||
(J.DetailedStatusCode={}));(function(d){d.High="High";d.Medium="Medium";d.Low="Low";d.Disabled="Disabled"})(J.FilterSensitivity||(J.FilterSensitivity={}));(function(d){d.Short="Short";d.Medium="Medium";d.Long="Long"})(J.OutputLength||(J.OutputLength={}));(function(d){d.APA="APA";d.Chicago="Chicago";d.MLA="MLA"})(J.CitationStyle||(J.CitationStyle={}));(J.DocumentType||(J.DocumentType={})).News="News";(function(d){d.Neutral="Neutral";d.Casual="Casual";d.Excited="Excited";d.Passionate="Passionate";d.Persuasive=
"Persuasive";d.Professional="Professional";d.Optimistic="Optimistic";d.Technical="Technical";d.Thankful="Thankful"})(J.DocumentTone||(J.DocumentTone={}))},1971:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.WritersUnblockAnnotation=J.QualityStatus=void 0;const m=d(418);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_WritersUnblock_QualityStatus"}static getBaseTypes(){return[]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[f.getTypeName()])}}J.QualityStatus=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_WritersUnblock_WritersUnblockAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}J.WritersUnblockAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1972:function(I,J){Object.defineProperty(J,
"__esModule",{value:!0})},1973:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.WritersUnblockRequest=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_WritersUnblock_WritersUnblockRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.WritersUnblockRequest=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1974:function(I,J,d){var m=
this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1975),J);f(d(1976),J);f(d(1977),J);f(d(1978),
J)},1975:function(I,J){Object.defineProperty(J,"__esModule",{value:!0});J.Result=void 0;I=J.Result||(J.Result={});I.Success="Success";I.UnknownError="UnknownError"},1976:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1977:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.TextAbstractiveSummaryAnnotation=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_AzureTextAbstractiveSummarization_TextAbstractiveSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}J.TextAbstractiveSummaryAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1978:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.GenerateTextAbstractiveSummarySignal=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_AzureTextAbstractiveSummarization_GenerateTextAbstractiveSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}J.GenerateTextAbstractiveSummarySignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1979:function(I){I.exports=JSON.parse('{"Spelling":["Spelling","Drejtshkrimi","\u1225\u122d\u12d3\u1270 \u1206\u1204\u12eb\u1275","\u0627\u0644\u062a\u062f\u0642\u064a\u0642 \u0627\u0644\u0625\u0645\u0644\u0627\u0626\u064a","\u0548\u0582\u0572\u0572\u0561\u0563\u0580\u0578\u0582\u0569\u0575\u0578\u0582\u0576","\u09ac\u09be\u09a8\u09be\u09a8","Orfoqrafiya","Ortografia","\u0410\u0440\u0444\u0430\u0433\u0440\u0430\u0444\u0456\u044f","Pravopis","\u041f\u0440\u0430\u0432\u043e\u043f\u0438\u0441\u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430","\u062d\u0648\u0646\u062c\u06d5\u06a9\u0631\u062f\u0646","\u13a0\u13aa\u13b5\u13f0\u13cd\u13a9","\u62fc\u5199\u68c0\u67e5","\u62fc\u5b57\u6aa2\u67e5","Provjera pravopisa","Kontrola pravopisu","Stavekontrol","\u0627\u0645\u0644\u0627","\u00d5igekiri","Oikeinkirjoitus","Orthographe","Ortograf\u00eda","\u10db\u10d0\u10e0\u10d7\u10da\u10ec\u10d4\u10e0\u10d0","Rechtschreibung","\u039f\u03c1\u03b8\u03bf\u03b3\u03c1\u03b1\u03c6\u03af\u03b1","\u0a9c\u0acb\u0aa1\u0aa3\u0ac0","Sifellin","\u05d1\u05d3\u05d9\u05e7\u05ea \u05d0\u05d9\u05d5\u05ea","\u0935\u0930\u094d\u0924\u0928\u0940","Helyes\u00edr\u00e1s-ellen\u0151rz\u00e9s","Stafsetning","Nsupe","Ejaan","Titirarniq titirausikkut","Litri\u00fa","Upelo","Isipelingi","\u30b9\u30da\u30eb \u30c1\u30a7\u30c3\u30af","\u0c95\u0cbe\u0c97\u0cc1\u0ca3\u0cbf\u0ca4","\u0415\u043c\u043b\u0435\u043d\u0456 \u0442\u0435\u043a\u0441\u0435\u0440\u0443","\u17a2\u1780\u17d2\u1781\u179a\u17b6\u179c\u17b7\u179a\u17bb\u1791\u17d2\u1792","Usuk\'manem tz\'ib\'","Imyandikire","Tahajia","\u0935\u0930\u094d\u0923\u0930\u091a\u0928\u093e","\ub9de\ucda4\ubc95","\u0416\u0430\u0437\u044b\u043b\u044b\u0448","\u0e81\u0eb2\u0e99\u0eaa\u0eb0\u0e81\u0ebb\u0e94\u0e84\u0eb3","Pareizrakst\u012bba","Ra\u0161ybos tikrinimas","Orthographie","\u041f\u0440\u0430\u0432\u043e\u043f\u0438\u0441","\u0d38\u0d4d\u0d2a\u0d46\u0d32\u0d4d\u0d32\u0d3f\u0d02\u0d17\u0d4d","Ortografija","Takikupu","\u0935\u0930\u094d\u0923\u0935\u093f\u0928\u094d\u092f\u093e\u0938","\u0417\u04e9\u0432 \u0431\u0438\u0447\u0433\u0438\u0439\u043d \u0434\u04af\u0440\u044d\u043c","\u0939\u093f\u091c\u094d\u091c\u0947","Stavekontroll","\u0b2c\u0b28\u0b3e\u0b28\u0b4d","Pisownia","\u0a36\u0a2c\u0a26\u0a1c\u0a4b\u0a5c","\u0627\u0645\u0644\u0627\u0621","Allin qillqay","Corectare ortografic\u0103","Litreachadh","\u041e\u0440\u0444\u043e\u0433\u0440\u0430\u0444\u0438\u044f","Mopeleto","\u0647\u062c\u064a","\u0d85\u0d9a\u0dca\u0dc2\u0dbb \u0dc0\u0dd2\u0db1\u0dca\u200d\u0dba\u0dcf\u0dc3\u0dba","\u010crkovanje","Stavning","\u0418\u043c\u043b\u043e","\u0b8e\u0bb4\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1 \u0b9a\u0bb0\u0bbf\u0baa\u0bbe\u0bb0\u0bcd\u0baa\u0bcd\u0baa\u0bc1","\u0414\u04e9\u0440\u0435\u0441 \u044f\u0437\u044b\u043b\u044b\u0448","\u0c05\u0c15\u0c4d\u0c37\u0c30\u0c15\u0c4d\u0c30\u0c2e\u0c02","\u0e01\u0e32\u0e23\u0e2a\u0e30\u0e01\u0e14","\u12a3\u1340\u1213\u1215\u134b","Yaz\u0131m Denetimi","Orfografi\u00fda","\u041e\u0440\u0444\u043e\u0433\u0440\u0430\u0444\u0456\u044f","\u06c1\u062c\u06d2","\u0626\u0649\u0645\u0644\u0627","Imlo","Ki\u00ea\u0309m tra chi\u0301nh ta\u0309","Sillafu","Bindiin","\u00c0y\u1eb9\u0300w\u00f2 \u1eb8y\u1ecd \u1ecc\u0300r\u1ecd\u0300"],"Perspectives":["Perspectives"],"Acronyms":["Acronyms","Acronymes","Akronyme","Acr\u00f3nimos"],"Uncommon Words":["Uncommon Words"],"Grammar":["\u0646\u062d\u0648","\u8bed\u6cd5","\u8a9e\u6cd5","Gramatika","Grammatik","Grammatica","Grammar","Kielioppi","Grammaire","\u05d3\u05e7\u05d3\u05d5\u05e7","Nyelvtan","\u6587\u6cd5","\uc5b4\ubc95","Grammatikk","Gramatyka","Gram\u00e1tica","\u0413\u0440\u0430\u043c\u043c\u0430\u0442\u0438\u043a\u0430","Gramer"],"Clarity":["\u0627\u0644\u0648\u0636\u0648\u062d","\u660e\u6670\u6027","\u6e05\u6670\u6027","Jasnost","Klarhed","Duidelijkheid","Clarity","Selkeys","Clart\u00e9","Verst\u00e4ndlichkeit","\u05e9\u05e4\u05d4 \u05d1\u05e8\u05d5\u05e8\u05d4","\u00c9rthet\u0151s\u00e9g","Chiarezza","\u660e\u77ad\u306a\u8868\u73fe","\uba85\ub8cc\uc131","Klarhet","Przejrzysto\u015b\u0107","Clareza","\u042f\u0441\u043d\u043e\u0441\u0442\u044c","Claridad","A\u00e7\u0131kl\u0131k"],"Conciseness":["\u0627\u0644\u062f\u0642\u0629","\u7b80\u660e\u6027","\u7c21\u660e\u6027","V\u00fdsti\u017enost","Kortfattethed","Beknoptheid","Conciseness","Ytimekkyys","Concision","Pr\u00e4gnanz","\u05e9\u05e4\u05d4 \u05ea\u05de\u05e6\u05d9\u05ea\u05d9\u05ea","T\u00f6m\u00f6rs\u00e9g","Concisione","\u7c21\u6f54\u306a\u8868\u73fe","\uac04\uacb0\uc131","Presisjon","Zwi\u0119z\u0142o\u015b\u0107","Concis\u00e3o","\u041a\u0440\u0430\u0442\u043a\u043e\u0441\u0442\u044c","Concisi\u00f3n","Precision","Yal\u0131nl\u0131k"],"Formality":["\u0644\u063a\u0629 \u0631\u0633\u0645\u064a\u0629","\u6b63\u5f0f\u8bed\u4f53","\u6b63\u5f0f\u8a9e\u8a00","Form\u00e1ln\u00ed vyjad\u0159ov\u00e1n\u00ed","Formelt sprog","Formeel taalgebruik","Formality","Virallinen kieli","Langage formel","Formelle Sprache","\u05e9\u05e4\u05d4 \u05ea\u05e7\u05e0\u05d9\u05ea","Nyelvhaszn\u00e1lat","Registro formale","\u6b63\u5f0f\u306a\u7528\u6cd5","\ud615\uc2dd \uc5b8\uc5b4","Formelt spr\u00e5k","J\u0119zyk literacki","Linguagem formal","\u041e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u044f\u0437\u044b\u043a","Lenguaje formal","Formellt spr\u00e5k","Resm\u00ee dil"],"Inclusiveness":["\u0627\u0644\u0634\u0645\u0648\u0644\u064a\u0629","\u5305\u5bb9\u6027\u8bed\u8a00","\u5305\u5bb9\u6027\u8a9e\u8a00","Nediskriminuj\u00edc\u00ed jazyk","Inkluderende sprog","Inclusief taalgebruik","Inclusiveness","Syrjiv\u00e4 kielenk\u00e4ytt\u00f6","Langage non-discriminant","Neutrale Sprache","\u05e9\u05e4\u05d4 \u05de\u05db\u05d9\u05dc\u05d4","Politikailag korrekt nyelvhaszn\u00e1lat","Linguaggio inclusivo","\u975e\u5dee\u5225\u7528\u8a9e","\uac00\uce58 \uc911\ub9bd\uc801 \uc5b8\uc5b4","Inkluderende spr\u00e5k","J\u0119zyk r\u00f3wno\u015bciowy","Linguagem inclusiva","\u041d\u0435\u0434\u0438\u0441\u043a\u0440\u0438\u043c\u0438\u043d\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u044f\u0437\u044b\u043a","Lenguaje no discriminatorio","Inkluderande spr\u00e5kbruk","Ayr\u0131mc\u0131 dil"],"Punctuation Conventions":["\u0627\u0644\u062a\u0631\u0642\u064a\u0645","\u6807\u70b9\u89c4\u8303","\u6a19\u9ede\u7b26\u865f\u898f\u5247","Interpunkce","Tegns\u00e6tning","Interpunctie","Punctuation Conventions","V\u00e4limerkit","Ponctuation","Interpunktion","\u05de\u05d5\u05e1\u05db\u05de\u05d5\u05ea \u05e4\u05d9\u05e1\u05d5\u05e7","K\u00f6zpontoz\u00e1si szok\u00e1sok","Punteggiatura","\u53e5\u8aad\u70b9","\uad6c\ub450\ubc95","Tegnsetting","Interpunkcja","Pontua\u00e7\u00e3o","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b \u043f\u0443\u043d\u043a\u0442\u0443\u0430\u0446\u0438\u0438","Puntuaci\u00f3n","Noktalama i\u015faretleri kurallar\u0131"],"Resume":["\u0627\u0644\u0633\u064a\u0631\u0629 \u0627\u0644\u0630\u0627\u062a\u064a\u0629","\u7b80\u5386","\u5c65\u6b77","\u017divotopis","Curriculum Vitae","CV","Resume","Ansioluettelo","Lebenslauf","\u05e7\u05d5\u05e8\u05d5\u05ea \u05d7\u05d9\u05d9\u05dd","\u00d6n\u00e9letrajz","\u5c65\u6b74\u66f8","\uc774\ub825\uc11c","\u017byciorys","Curr\u00edculo","\u0410\u0432\u0442\u043e\u0431\u0438\u043e\u0433\u0440\u0430\u0444\u0438\u044f","Meritf\u00f6rteckning","\u00d6z ge\u00e7mi\u015f"],"Sensitive Geopolitical References":["\u0639\u0628\u0627\u0631\u0627\u062a \u062c\u064a\u0648\u0633\u064a\u0627\u0633\u064a\u0629 \u062d\u0633\u0627\u0633\u0629","\u654f\u611f\u5730\u7f18\u653f\u6cbb\u53c2\u8003","\u654f\u611f\u5730\u7de3\u653f\u6cbb\u53c3\u7167","Citliv\u00e9 geopolitick\u00e9 odkazy","F\u00f8lsomme geopolitiske betegnelser","Gevoelige geopolitieke referenties","Sensitive Geopolitical References","Ongelmalliset geopoliittiset viittaukset","R\u00e9f\u00e9rences g\u00e9opolitiques sensibles","Problematische geopolitische Bezeichnungen","\u05d4\u05e7\u05e9\u05e8\u05d9\u05dd \u05d2\u05d9\u05d0\u05d5-\u05e4\u05d5\u05dc\u05d9\u05d8\u05d9\u05d9\u05dd \u05e8\u05d2\u05d9\u05e9\u05d9\u05dd","\u00c9rz\u00e9keny geopolitikai kifejez\u00e9se","Riferimenti geopolitici problematici","\u5730\u653f\u7684\u306b\u914d\u616e\u3059\u3079\u304d\u7528\u8a9e","\ubbfc\uac10\ud55c \uc9c0\uc815\ud559\uc801 \uc6a9\uc5b4","Geopolitisk sensitive spr\u00e5kformer","Poprawno\u015b\u0107 geopolityczna","Refer\u00eancias geopol\u00edticas delicadas","\u0413\u0435\u043e\u043f\u043e\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u044b","Referencias geopol\u00edticas sensibles","K\u00e4nsliga geopolitiska referenser","Hassas jeopolitik ifadeler"],"Vocabulary":["\u0627\u0644\u0645\u0641\u0631\u062f\u0627\u062a","\u8bcd\u6c47\u9009\u62e9","\u8a5e\u5f59\u9078\u64c7","Slovn\u00ed z\u00e1soba","Ordvalg","Woordkeuze","Vocabulary","Sanasto","Vocabulaire","Wortwahl","\u05d1\u05d7\u05d9\u05e8\u05ea \u05d0\u05d5\u05e6\u05e8 \u05de\u05d9\u05dc\u05d9\u05dd","Sz\u00f3v\u00e1laszt\u00e1s","Scelte lessicali","\u8a9e\u5f59\u306e\u8003\u616e","\uc5b4\ud718 \uc120\ud0dd","S\u0142ownictwo","Escolha vocabular","\u0412\u044b\u0431\u043e\u0440 \u0441\u043b\u043e\u0432 \u0438 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0439","Vocabulario","Ordval","S\u00f6zc\u00fckler"],"Consistent Written Forms":["\u062a\u0646\u0627\u0633\u0642 \u0627\u0644\u0643\u062a\u0627\u0628\u0629","\u5f02\u4f53\u8bcd\u7edf\u4e00","\u7570\u9ad4\u8a5e\u7d71\u4e00\u7528\u6cd5","Konzistentn\u00ed psan\u00e9 tvary","Konsistente staveformer","Consistent taalgebruik","Consistent Written Forms","Yhten\u00e4inen kirjoitusasu","Coh\u00e9rence","Konsistente Schreibformen","\u05e2\u05e7\u05d1\u05d9\u05d5\u05ea \u05d1\u05db\u05ea\u05d9\u05d1\u05d4","Konzisztens \u00edrott alak","Coerenza formale","\u8868\u8a18\u306e\u63fa\u308c","\uc77c\uad00\ub41c \uc11c\uc2dd","Konsekvente skriftformer","Sp\u00f3jno\u015b\u0107 zapisu","Escritura coerente","\u0415\u0434\u0438\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u0438\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u044f","Coherencia","Konsekventa skriftformer","Tutarl\u0131 yaz\u0131m bi\u00e7imleri"],"Error Corrections":["\u062a\u0635\u062d\u064a\u062d \u0623\u062e\u0637\u0627\u0621","\u7ea0\u9519","\u7cfe\u932f","Oprava chyb","Fejlkorrigering","Foutcorrectie","Error Corrections","Virheen korjaukset","Correction d\'erreurs","Fehlerkorrigierungen","\u05ea\u05d9\u05e7\u05d5\u05df \u05e9\u05d2\u05d9\u05d0\u05d5\u05ea","Hiba jav\u00edt\u00e1s","Correzione degli errori","\u8aa4\u308a\u306e\u30c1\u30a7\u30c3\u30af","\uc624\ub958 \uc218\uc815","Feilretting","Korekta b\u0142\u0119d\u00f3w","Corre\u00e7\u00e3o de erros","\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a","Correcci\u00f3n de errores","Felkorrigering","Hata d\u00fczeltmeleri"],"Writing Conventions":["\u0623\u0633\u0627\u0644\u064a\u0628 \u0627\u0644\u0643\u062a\u0627\u0628\u0629","\u4e66\u5199\u89c4\u8303","\u66f8\u5beb\u898f\u5247","Pravopis","Skriftkonventioner","Schrijfregels","Writing Conventions","Kirjoitustyyli","Conventions","Schreibkonventionen","\u05de\u05d5\u05e1\u05db\u05de\u05d5\u05ea \u05db\u05ea\u05d9\u05d1\u05d4","Helyes\u00edr\u00e1si szok\u00e1sok","Convenzioni di scrittura","\u8868\u8a18\u306e\u57fa\u6e96","\uae00\uc4f0\uae30 \uaddc\uce59","Skriftnormer","Konwencje zapisu","Normas de escrita","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b \u043f\u0438\u0441\u044c\u043c\u0435\u043d\u043d\u043e\u0439 \u0440\u0435\u0447\u0438","Convenciones de escritura","Skrivregler","Yaz\u0131m kurallar\u0131"],"Typing Errors":["\u0623\u062e\u0637\u0627\u0621 \u0625\u0645\u0644\u0627\u0626\u064a\u0629","\u7b14\u8bef","\u7b46\u8aa4","P\u0159eklepy","Tastefejl","Typefouten","Typing Errors","Ly\u00f6ntivirheet","Fautes de frappe","Tippfehler","\u05d8\u05e2\u05d5\u05d9\u05d5\u05ea \u05d4\u05e7\u05dc\u05d3\u05d4","G\u00e9pel\u00e9si hib\u00e1k","Errori di digitazione","\u5165\u529b\u30df\u30b9","\uc624\ud0c0","Skrivefeil","Liter\u00f3wki","Erros de digita\u00e7\u00e3o","\u041e\u043f\u0435\u0447\u0430\u0442\u043a\u0438","Erratas","Skrivfel","Yaz\u0131m hatalar\u0131"],"Rewrite":["\u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u0643\u062a\u0627\u0628\u0629","\u6539\u5199","\u6539\u5beb","P\u0159eformulov\u00e1n\u00ed","Omskrivning","Herschrijving","Rewrite","Uudelleenkirjoitus","Reformulations","Umschreibung","\u05e9\u05db\u05ea\u05d5\u05d1","\u00c1t\u00edr\u00e1s","Riscrittura","\u7de8\u96c6","\ub2e4\uc2dc \uc4f0\uae30","Omskriving","Przeformu\u0142owanie","Reescrita","\u041f\u0435\u0440\u0435\u043f\u0438\u0441\u044b\u0432\u0430\u043d\u0438\u0435","Reformulaciones","Yeniden yaz\u0131m"],"Different phrasing":["Different phrasing"],"Improves flow":["Improves flow"],"Improves readability":["Improves readability"],"More concise":["More concise"],"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling.":["These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."],"The goal of these suggestions is to express an idea clearly, without extra words.":["The goal of these suggestions is to express an idea clearly, without extra words."],"These suggestions provide alternative ways of wording a phrase or sentence.":["These suggestions provide alternative ways of wording a phrase or sentence."],"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording.":["The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording."],"More formal":["More formal"],"These suggestions help make your writing more formal by reducing casual wording.":["These suggestions help make your writing more formal by reducing casual wording."]}')},
1980:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1981),J);f(d(1982),
J);f(d(1983),J);f(d(1984),J);f(d(1985),J);f(d(1986),J);f(d(1987),J);f(d(1988),J)},1981:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1982:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1983:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1984:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1985:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.BasicChatResponse=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,
this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_BasicChatResponse"}static getBaseTypes(){return["AugLoop_GenerativeAi_TextChatResponse","AugLoop_Chat_ChatResponse","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.BasicChatResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1986:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.DslResponse=void 0;const m=
d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_DslResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.DslResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1987:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.BasicChat=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,
this,a)}static getTypeName(){return"AugLoop_BasicChat_BasicChat"}static getBaseTypes(){return["AugLoop_Chat_Chat"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.BasicChat=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1988:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.DslInput=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_BasicChat_DslInput"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}J.DslInput=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},2163:function(I,J,d){function m(e){"Committed"===e.LR?Object(ti.w)(e,"HoveredCommitted"):"Highlighted"===e.LR&&Object(ti.w)(e,"HoveredHighlighted")}function f(e){"HoveredCommitted"===e.LR?Object(ti.w)(e,"Committed"):"HoveredHighlighted"===e.LR&&Object(ti.w)(e,"Highlighted")}function a(e,n){var C=e.getByTag(n).getFirst().JFg;if(C){e=Pd.TableReader.wy(C,0,Pd.TableReader.vg(C)-1).K(0);e=Ly.a.o9c(e);n=Pd.TableReader.Eh(C);
const ya=[];C=Pd.TableReader.wy(C,0,0).K(0);C=Ly.a.KA(C);for(var S of C){C="";var ja=new Ed.a;ja.set(S);ja.Vb(1);ja=ja.je();ja=new ce.a(ja,Ma.a.paragraph);ja=Af.ParagraphReader.text(ja.node);C+=pn.AParagraphNode.KP(ja);C=C.trim();ya.push(C)}S=JSON.stringify({columnsList:ya,totalColumns:n,isHeaderTable:e});Object(ti.o)("SendTableColumnDetails",S)}}function l(e,n,C,S,ja,ya,kb,Rb,sc){let Fc=0;for(const td of kb){kb=new Ed.a;kb.set(td);kb.Vb(1);kb=kb.je();var gd=new fb.a;const Bd=ce.a.XT(0,Af.ParagraphReader.textLength(kb),
!1,kb);gd.add(Bd);"thumbnail"===sc[Fc]||"FileLeafRef"===sc[Fc]?n.fka(Bd)&&(Rb[Fc]?(kb=ja.create(kb,C),gd=S.create(td,C),kb.L7c(Rb[Fc],4,{height:gd.columnWidth,width:gd.columnWidth,useSourceImageProps:!1})):e.insertText(gd,Rb[Fc]||"",4)):"RichMultiText"===sc[Fc]?ja.create(kb,C).insertHtml(Rb[Fc],4):(e.insertText(gd,Rb[Fc],4),"hyperlink"===sc[Fc]&&ya.wF(gd.K(0),Rb[Fc],!1));Fc++}}function w(e,n,C,S,ja,ya,kb,Rb){let sc=!1;(e.FL||1===n.Xo.count&&1===n.text.length)&&0===C&&1===n.ILf(n.Xo.K(0)).count&&(sc=
!0,!kb&&ja&&ya&&(ja.Values.type="ImageSelection",ja.Values.payload="ImageSelection",ja.Values.Action="SuccessfulSelectionV2",Rb&&(ja.Values.payload=JSON.stringify({text:"ImageSelection",typeOfField:{regular:!0,conditional:!1}})),S.flag=!0,window.parent.postMessage(JSON.stringify(ja),ya)));return sc}async function z(e,n){var C=e.MPb();C=e.getRange(0).ILf(C.K(0));1===C.count&&kl.a.o0i(C.K(0))&&(C=kl.a.Mn(C.K(0)),C=kl.a.szi(C),C={height:C.height,width:C.width,imageSelection:!0,useSourceImageProps:!1,
altText:n.altText},n.useSourceImageProps||(C.useSourceImageProps=!0),Object(ti.w)(e,"Filled"),e.L7c(n.imageUrl,4,C))}function x(e,n,C,S){var ja,ya;if(S&&n.tag.startsWith("mscacr"))if(S=n.MPb(),n.zg)for(ya=0;ya<S.count;ya++){var kb=null===(ja=S.K(ya))||void 0===ja?void 0:ja.node;n=e;var Rb=C;for(let sc=0;sc<kb.ra.length;sc++){const Fc=kb.ra.Ub(sc).formatting;n.wQj(Fc,Rb)}}else{ja=null===(ya=n.MPb().K(0))||void 0===ya?void 0:ya.node;S=n.MPb().K(0).cpBegin;ya=n=n.MPb().K(0).cpEnd;n=[];for(kb=0;kb<ja.ra.length;kb++)Rb=
ja.ra.Ub(kb).cp,Rb>=S&&Rb<ya&&n.push(ja.ra.Ub(kb));for(ja=0;ja<n.length;ja++)n[ja].blob||e.wQj(n[ja].formatting,C)}}function u(e){gk.has(e)||(E.ULS.sendTraceTag(528506889,2253,10,`Stat ${e} is undefined or zero`),gk.set(e,{valueMissing:!0,rMg:!1}))}function v(e){var n,C;null!==(n=gk.get(e))&&void 0!==n&&n.rMg||(E.ULS.sendTraceTag(528506890,2253,10,`Stat ${e} defined and non-zero`),n=null!==(C=gk.get(e))&&void 0!==C?C:{valueMissing:!1,rMg:!1},n.rMg=!0,gk.set(e,n))}function D(){var e,n;return null!==
(n=null===(e=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===e?void 0:e.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1))&&void 0!==n?n:!1}d.r(J);var y={};d.r(y);d.d(y,"getDocument",function(){return GG});var H=d(1069),F=d(0),G=d(2);class K{get name(){return"AppLoadStateTracker"}wc(){}init(){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MarkAppFullyLoadedExplicitly",!1)||H.a.get_instance().Xbj()}dispose(){}}
Object(F.a)(K,"AppLoadStateTrackerPackage",null,[0,1]);var R=d(178),E=d(8),N=d(46);class O{constructor(){this.Jnj=e=>{e=e.rawEvent;let n=e.blockedURI;n=N.a.fca(n);const C={};C.effectiveDirective=e.effectiveDirective;C.violatedDirective=e.violatedDirective;C.originalPolicy=e.originalPolicy;C.blockedURI=n;C.disposition=e.disposition;E.ULS.sendTraceTag(588084128,306,15,"{0}",C)};$addHandler(document,"securitypolicyviolation",this.Jnj)}dispose(){$removeHandler(document,"securitypolicyviolation",this.Jnj)}}
Object(F.a)(O,"ContentSecurityPolicyListener",null,[10]);class U{constructor(){this.Z=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.Z.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const e=this.Z.Oa("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");e&&e.dispose()}wc(e){this.Z=e;this.Z.register(O,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").ha().Ud(()=>new O)}static main(){R.a.instance.Mc(new U)}}Object(F.a)(U,
"ContentSecurityPolicyPackage",null,[0,1]);var X=d(87),V=d(1282),Q=d(283),T=d(12);class ba{constructor(e,n){this.YGc=null;this.oxp=(C,S,ja,ya,kb)=>{if(1===ja)return 32;kb[V.a.Value]=this.YGc;kb[Q.a.labelText]=this.YGc;kb[V.a.Visible]=!0;return 32};this.ga=e;this.Aa=n}Xb(){(this.YGc=this.Aa.jb("StatusBarEnvironmentNameToUse"))&&""!==this.YGc&&this.ga.fb(T.a.Qwj,X.a.frame,this.oxp,96)}}Object(F.a)(ba,"DisplayEnvironmentName",null,[]);class W{constructor(){this.Z=null}get name(){return"Common.App.DisplayEnvironmentName"}wc(e){this.Z=
e;this.Z.register(ba,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ha().Ud(()=>new ba(G.AFrameworkApplication.va,G.AFrameworkApplication.J))}init(){this.Z.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Xb()}dispose(){}static main(){R.a.instance.Mc(new W)}}Object(F.a)(W,"DisplayEnvironmentNamePackage",null,[0,1]);var aa=d(1789),Y=d(179),da=d(590),ka=d(131),qa=d(608),ua=d(458),Pa=d(258);class Ja extends Pa.a{constructor(){super();this.Offset=this.Top=this.CollectionId=
this.Authorization=this.FileId=this.Language=null}Om(){return ua.a.templates}static construct(e,n,C,S,ja,ya){const kb=new Ja;kb.Language=C;kb.FileId=n;kb.Authorization=e;kb.CollectionId=S;kb.Top=ja;kb.Offset=ya;return kb}}Object(F.a)(Ja,"TemplatesRequest",Pa.a,[]);class Ca{constructor(e,n,C){this.OT=e;this.J=n;this.JUn=C;this.V6i=async(S,ja,ya,kb)=>{var Rb;let sc=Ja.construct(null,G.AFrameworkApplication.rootQuerySignature,S,ja,ya,kb);this.JUn.tV("ContentPlatform",null!==(Rb=this.J.jb("ContentPlatformUrl"))&&
void 0!==Rb?Rb:"https://contentplatform.office.net").then(Fc=>{Fc.IsSuccess?sc=Ja.construct(Fc.Token,S,G.AFrameworkApplication.rootQuerySignature):E.ULS.sendTraceTag(509693953,3042,15,"Failed to acquire access token for Content Platform [OAuthResult Error: {0}]",Fc.ErrorMessage)}).catch(()=>{E.ULS.sendTraceTag(509693952,3042,15,"Failed to acquire access token for Content Platform")});return this.q_k(sc)}}q_k(e){return new Promise((n,C)=>{this.OT.Xj(`${ka.a.webServiceBase}OfficeTemplatesMetadata.ashx?perfTag=Templates`,
2,qa.b(e),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,S=>{var ja,ya;if(null===(ja=null===S||void 0===S?void 0:S.data)||void 0===ja||!ja.Pe)return C("No response data!");if(S.data.He!==Y.a.qz)return C(`Bad Http Status ${S.data.He}`);if(!({group:S}=da.a.D4(S.data.Pe)).returnValue)return C("Empty Server response!");ja=null;if(null===(ya=null===S||void 0===S?void 0:S.Responses)||void 0===ya||!ya.length||!(ja=S.Responses[0]))return C("No valid response!");n(ja.Templates)},S=>{var ja,ya;E.ULS.sendTraceTag(509692131,
3042,10,"Templates request failed [Status: {0}]",null===(ja=null===S||void 0===S?void 0:S.data)||void 0===ja?void 0:ja.status);C(null===(ya=null===S||void 0===S?void 0:S.data)||void 0===ya?void 0:ya.status)},e)})}}Object(F.a)(Ca,"OfficeTemplatesDiscoveryService",null,[]);class ra{get name(){return"Box4.OfficeTemplates"}init(){}dispose(){}wc(e){this.container=e;this.container.register(Ca,"Box4.OfficeTemplates.OfficeTemplatesDiscoveryService").ha().Ud(()=>new Ca(G.AFrameworkApplication.Fe,this.container.resolve("Common.IAppSettingsManager"),
this.container.resolve("Common.App.OAuth.IOAuthManager")))}static main(){R.a.instance.Mc(new ra);E.ULS.sendTraceTag(509692130,3042,50,"Box4 Office Templates package registered.")}}Object(F.a)(ra,"OfficeTemplatesPackage",null,[0,1]);var Ea=d(1271),xa=d(41),Ma=d(11),ha=d(18);class la{constructor(e,n){this.ga=e;this.UCc=n}Xb(){E.ULS.sendTraceTag(558965411,390,50,"Registering AcronymsWeb actions");try{this.ga.fb(ha.a.u0b,X.a.frame,this.UCc.hMi,1028),this.ga.fb(ha.a.$ng,Ma.a.view,this.UCc.rMi,1124)}catch(e){E.ULS.sendTraceTag(558965440,
390,10,"Registering actions failed",e.message)}}mfb(){E.ULS.sendTraceTag(558965441,390,50,"Unregistering AcronymsWeb actions");this.ga.Fy(ha.a.u0b,X.a.frame,this.UCc.hMi);this.ga.Fy(ha.a.$ng,Ma.a.view,this.UCc.rMi)}dispose(){this.UCc=this.ga=null}}Object(F.a)(la,"AcronymsWebActionDelegator",null,[10]);var Fa=d(464);class Ga{constructor(e){this.VCc=e;this.hMi=(n,C,S)=>{if(1===S)return 32;try{this.VCc.isVisible()?this.VCc.hide():this.VCc.show()}catch(ja){return E.ULS.sendTraceTag(558965410,390,10,"Show/hide pane failed",
ja.message),8}return 32};this.rMi=(n,C,S,ja,ya)=>{if(1===S)return 32;ya&&(ya[Fa.a.On]=this.VCc.isVisible(),ya[Fa.a.Visible]=!0);return 32}}dispose(){this.VCc=null}}Object(F.a)(Ga,"AcronymsWebActionHandler",null,[10]);var va=d(1755);class pa{constructor(e,n,C,S){this.ui=e;this.HMd=n;this.wSe=C;this.lId=Object.assign(new va.a,{isModernPane:!0,sourceLocationOverrideResourceId:this.HMd,pV:WordEditorIntl.WordEditorStrings.L_AcronymsPaneTitle});S(this)}static Sol(){return e=>{e.wSe.execute(async n=>{n=
await n.isFeatureEnabled("mso_sendASmile",!0)&&G.AFrameworkApplication.VE;const C={};C.EnableFeedback=n;e.lId.QU=C})}}isVisible(){return this.ui.c3(`${"FA000000085"}.${this.HMd}`)}show(){if(this.isVisible())return E.ULS.sendTraceTag(558965405,390,10,"Show pane called when already shown"),!0;xa.c(ha.a.u0b,void 0,void 0,void 0,2);let e=!1;try{e=this.ui.E8("FA000000085",this.lId,!0)}catch(n){E.ULS.sendTraceTag(558965406,390,10,"Show pane failed due to exception",n.message)}e||E.ULS.sendTraceTag(558965407,
390,10,"Show pane failed");return e}hide(){if(this.isVisible()){xa.c(ha.a.u0b,void 0,void 0,void 0,2);try{this.ui.bMb("FA000000085",this.lId)}catch(e){E.ULS.sendTraceTag(558965409,390,10,"Hide pane failed",e.message)}}else E.ULS.sendTraceTag(558965408,390,10,"Hide pane called when already hidden")}dispose(){this.lId=this.ui=null}}Object(F.a)(pa,"AcronymsWebPane",null,[10]);var Oa=d(1443);class Ra extends Oa.a{constructor(){super(...arguments);this.Z=null}get name(){return"WordEditor.AcronymsWeb"}zUa(e){this.Z=
e;this.Z.ia("WordEditor.AcronymsWeb.IAcronymsWebPane",()=>new pa(this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),G.AFrameworkApplication.J.jb("WordEditorAcronymsWebSourceLocationOverrideResourceId"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),pa.Sol())).ha();this.Z.ia("WordEditor.AcronymsWeb.IAcronymsWebActionHandler",()=>new Ga(this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane"))).ha();this.Z.ia("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator",
()=>new la(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler"))).ha()}BUa(){let e=!1;try{this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").Xb(),e=!0}catch(n){E.ULS.sendTraceTag(558965404,390,10,"Initializing package failed",n.message)}xa.a("InitializeAcronymsWebPackage",e)}AUa(){this.Z&&(this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").mfb(),this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane").dispose(),this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler").dispose(),
this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").dispose(),this.Z=null)}static get Cen(){return Object(Ea.a)(G.AFrameworkApplication.J,G.AFrameworkApplication.uiCulture)}static main(){G.AFrameworkApplication.hL||Ra.Cen&&R.a.instance.Mc(new Ra)}}Object(F.a)(Ra,"WordEditorAcronymsWebPackage",Oa.a,[]);var fb=d(71),qb=d(348);class mb{constructor(){this.Qpk=new fb.a}get PTd(){return this.Qpk}PCm(e){E.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",e);const n=new fb.a;for(const C of this.PTd)for(const S of C.wed)S.id===
e&&n.add(S);return n}lgl(e){var n=this.PCm(e);if(n&&0<n.count){e=Object.assign(new qb.a,{ControlList:[]});for(const C of n)n=C.wrd(),0<n.length&&Array.addRange(e.ControlList,n);return e}return null}KMh(e){this.PTd.add(e)}mzo(e){for(const n of this.PTd)if(n.FQh===e.FQh){this.PTd.remove(n);break}}static zUl(e,n,C=null){e=mb.Jnm(e);0<e.length&&(mb.Pwe(e,!1),C&&C(n,e))}static Jnm(e){const n=[];if(e&&e.wed&&0<e.wed.count)for(const C of e.wed)if(C.controls&&0<C.controls.count)for(const S of C.controls)if(S.menuItems&&
0<S.menuItems.count)for(const ja of S.menuItems)Array.add(n,ja.id);return n}static Pwe(e,n){if(e.length){var C=[];for(const S of e)C.push(appChrome.actions.updateControlEnabledDisabledState(S,n));appChrome.api.dispatch(C)}}}Object(F.a)(mb,"ContextMenuExtensibilityCache",null,[1882,1883]);var eb=d(86);class bb{constructor(){this.hZl=this.displayName=this.HWc=this.lC=this.RX=null;this.isUpgraded=!1}s1i(e,n){return this.RX.getStoreType().toLowerCase()===e.toLowerCase()&&this.RX.getSolutionId().toLowerCase()===
n.toLowerCase()}}Object(F.a)(bb,"AddinCommandsResourceItem",null,[]);class Wa{constructor(){this.rJe=null;this.qTe=0;this.iWe=!1;this.sa=new eb.a;this.Uzk=new fb.a}q0k(e){this.sa.addHandler("AddinCommandsLoadingMessageChanged",e)}get CSc(){return this.rJe}fxc(e){e!==this.rJe&&(this.rJe=e,this.sa.raiseEvent("AddinCommandsLoadingMessageChanged"))}xSo(){this.qTe++;this.CSc||this.fxc(CommonUIStrings.l_LoadingAddInsTitle)}Txg(){this.qTe--;this.xhe()&&(this.iWe?this.CSc!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&
this.fxc(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.fxc(null))}AUo(){this.iWe=!0;this.fxc(CommonUIStrings.l_ErrorLoadingAddInsTitle)}Z1h(){this.iWe=!1;this.xhe()?this.fxc(null):this.fxc(CommonUIStrings.l_LoadingAddInsTitle)}xhe(){return 0>=this.qTe}get Kmc(){return this.Uzk}gic(e,n,C=0){for(const S of this.Kmc)if(S.s1i(e,n)&&(!S.lC||S.lC.Ifm===C))return S;return null}xNh(e,n,C,S){const ja=new bb;ja.RX=e;ja.lC=n;ja.HWc=C;ja.displayName=S;this.Kmc.add(ja)}oYk(e,n,C,S){const ja=new bb;ja.RX=e;ja.lC=
n;ja.HWc=null;ja.hZl=C;ja.displayName=S;this.Kmc.add(ja)}Iyo(e,n){let C=0;for(const S of this.Kmc)S.RX.getStoreType()===e&&S.RX.getSolutionId()===n?this.Kmc.removeAt(C):C++}static getInstance(){Wa._instance||(Wa._instance=new Wa);return Wa._instance}}Wa._instance=null;Object(F.a)(Wa,"AddinCommandsResourceManager",null,[]);var Za=d(2027),Na=d(40),Db=d(1578),nb=d(786),Ta=d(549),cb=d(1579),sb=d(196),pb=d(175),tb=d(77),wb=d(43),gc=d(19);class vc{constructor(){this.title=this.id=this.tabs=null}}Object(F.a)(vc,
"AddInDataTransferObject",null,[]);class Pc{constructor(e,n,C){this.cwd=e;this.Imk=n;this.Kmk=C}get CJ(){return this.cwd}get addInId(){return this.Imk}get OXk(){return this.Kmk}static s1c(e){return(e=e.GCa)?Object.assign(new vc,{tabs:e.CJ.toArray(),id:e.addInId,title:e.OXk}):null}}Object(F.a)(Pc,"OneLineRibbonExtensibility",null,[]);var ld=d(1393);class Dc{static get Iw(){return Dc.Qp||(Dc.Qp=gc.a.instance.Oa("Common.Utils.IAriaNotifier"))}static Y8h(e,n,C,S){Dc.mZ&&Dc.mZ.WJ&&Dc.mZ.dismiss();Dc.mZ=
Za.a.F$h(n,e,e,3);Dc.mZ.content=C;ld.b(S)||(Dc.mZ.title=S,Dc.mZ.E$d=!0);e=new Sys.UI.Bounds(0,0,tb.a.srb(),tb.a.D_());Dc.mZ.Zja=Dc.DGf(e,n,Dc.mZ.ioa,1);Dc.mZ.show();Dc.Iw&&Dc.Iw.sendNotification(C.innerText,!0)}static Irf(e,n,C,S=null){sb.UISurfaces.uL().then(ja=>{let ya=null;Dc.XNc&&(ja.removeNotification(Dc.XNc),Dc.XNc=null);const kb=ja.callout(Object.assign(new Db.a,{target:e,title:n,content:C,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new cb.a,
{onDismiss:()=>{ja.removeNotification(ya)},directionalHint:null!=S?S:null})})),Rb=Object.assign(new Ta.a,{expirationOptions:Object.assign(new nb.a,{displayTimeoutSeconds:7,onExpire:()=>{ja.removeNotification(Dc.XNc)}})});ya=Dc.XNc=ja.addNotification(kb,Rb);return null},ja=>{E.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",ja);return null})}static ABg(e){Dc.mZ&&Dc.mZ.WJ&&Dc.mZ.dismiss();const n=new pb.StandardDialog;n.TNa=!1;n.Bd=0;n.Iy(Na.a.Gyn,CommonUIStrings.l_DialogError,
ld.b(e)?Dc.Mwi():e,null)}static a7o(e){Dc.mZ&&Dc.mZ.WJ&&Dc.mZ.dismiss();E.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",e.errorCode));const n=ld.b(e.description)?Dc.Mwi():e.description,C=new pb.StandardDialog;let S=null;e.rUc?(C.Bd=1,C.Ke(1,e.buttonText),C.qY(1)):C.Bd=0;S=ja=>{1===ja?e.rUc():e.Gra&&e.Gra()};C.TNa=!1;0===e.Jfa?C.Iy(e.errorCode,e.title?e.title:CommonUIStrings.l_DialogError,n,S):1===e.Jfa?C.lV(e.title?e.title:CommonUIStrings.l_DialogWarning,
n,S):C.Cna(e.title?e.title:CommonUIStrings.l_DialogInfo,n,S)}static DGf(e,n,C,S){let ja=0===S?0:4;const ya=e.x+e.width-n.x-n.width;n.x-e.x+n.width/2<=C/2?ja=0===S?2:5:ya+n.width/2<=C/2&&(ja=0===S?3:6);return ja}static q7o(e,n,C,S=!1){(n=Pc.s1c(n))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(n,ja=>{ja&&(S||Dc.Irf(ja,C,e,5))})}static r7o(e,n,C=!1){Dc.q7o(n.startedNode?n.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,
e),n,n.startedNode?n.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,e),C)}static p7o(e,n,C,S){if(Dc.g$j)e=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,C,S,CommonUIStrings.l_InsertionDialogRefresh)),Dc.Irf(n,e,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{n=wb.a.getElementBounds(n);var ja=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),ya=document.createElement("span");
ya.innerText=ja[0];var kb=document.createElement("span");kb.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,C,S,CommonUIStrings.l_InsertionDialogRefresh);kb.className="UIFontBold";C=document.createElement("span");C.innerText=ja[1];S=document.createElement("div");Sys.UI.DomElement.addCssClass(S,"ModalCalloutControl");S.appendChild(ya);S.appendChild(kb);S.appendChild(C);Dc.Y8h(e,n,S,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static V8o(e,n){var C=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,
S=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Dc.g$j?Dc.Irf(n,C,S):(n=wb.a.getElementBounds(n),Dc.Y8h(e,n,Dc.dil(S),C))}static lVl(){Dc.mZ&&Dc.mZ.WJ&&Dc.mZ.dismiss()}static dil(e){const n=document.createElement("div");Sys.UI.DomElement.addCssClass(n,"ModalCalloutControl");n.innerText=e;return n}static Mwi(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get g$j(){return G.AFrameworkApplication.ua.Gb.Bs&&G.AFrameworkApplication.ua.Gb.hXa}}
Dc.mZ=null;Dc.XNc=null;Dc.Qp=null;Object(F.a)(Dc,"AddInCommandsNotificationFactory",null,[]);var ic=d(109);class mc{constructor(e,n){this.j0a=(C,S,ja,ya,kb)=>{if(S.contextId!==Ma.a.application)return 2;if(1===ja)return C!==T.a.bcc||this.cwa&&this.cwa.vUm(kb)?32:8;if(!kb)return 8;switch(C){case T.a.AUb:this.cwa.AUb(kb);break;case T.a.bcc:this.cwa.R9d(kb);break;case T.a.pid:this.cwa.pid(kb);break;case T.a.Gxc:this.cwa.Gxc(kb);break;case T.a.iS:this.cwa.Tko(kb);break;case T.a.Avc:this.cwa.Avc(kb);break;
case T.a.zpg:this.cwa.eto();break;case T.a.v0b:this.cwa.v0b(kb);break;case T.a.VNa:this.cwa.VNa(kb);break;case T.a.zKa:this.cwa.zKa(kb)}return 32};this.ga=e;this.cwa=n}Xb(){this.ga.qa(T.a.AUb,Ma.a.application,this.j0a);this.ga.fb(T.a.bcc,Ma.a.application,this.j0a,64);this.ga.fb(T.a.pid,Ma.a.application,this.j0a,96);this.ga.qa(T.a.Gxc,Ma.a.application,this.j0a);this.ga.fb(T.a.Avc,Ma.a.application,this.j0a,64);this.ga.fb(T.a.iS,Ma.a.application,this.j0a,64);this.ga.qa(T.a.zpg,Ma.a.application,this.j0a);
this.ga.qa(T.a.v0b,Ma.a.application,this.j0a);this.ga.qa(T.a.VNa,Ma.a.application,this.j0a);this.ga.qa(T.a.zKa,Ma.a.application,this.j0a)}}Object(F.a)(mc,"AddInCommandsActor",null,[]);class Rc{constructor(){this.MKh={["tabhome"]:"tabHome",["tabinsert"]:"tabInsert",["tabpagelayoutword"]:"tabPageLayout",["tabreviewword"]:"tabReview",["tabview"]:"tabView",["tabhelp"]:"tabHelp"};this.IKh={["tabworddesign"]:["tabWordDesign",WoncaIntl.WoncaStrings.L_TabWordDesign,CommonUIStrings.l_TabWordDesignKeytip],
["tabreferences"]:["tabReferences",WoncaIntl.WoncaStrings.L_TabReferences,CommonUIStrings.l_TabReferencesKeytip],["tabmailings"]:["tabMailings",WoncaIntl.WoncaStrings.L_TabMailings,CommonUIStrings.l_TabMailingsKeytip],["tabdeveloper"]:["tabDeveloper",WoncaIntl.WoncaStrings.L_TabDeveloper,CommonUIStrings.l_TabDeveloperKeytip],["tabaddins"]:["tabAddIns",WoncaIntl.WoncaStrings.L_TabAddIns,CommonUIStrings.l_TabAddInsKeytip]};this.PPd=null}get l7h(){return"SourceControlId"}get O_(){return"Document"}get formFactor(){return"DesktopFormFactor"}iAm(){if(!this.PPd){this.PPd=
{};for(const e of Object.keys(this.MKh))this.PPd[e]=this.MKh[e];for(const e of Object.keys(this.IKh))this.PPd[e]=this.IKh[e][0]}}}Object(F.a)(Rc,"AddInCommandsStringProvider",null,[1071]);var rb=d(1852),Cb;(function(e){e[e.Lke=0]="notSupported";e[e.K7p=1]="launchByLocalCacheInitializer";e[e.G7p=2]="launchByAnonymousApiInitializer";e[e.I7p=3]="launchByInsertion";e[e.L7p=4]="launchByRefresh";e[e.J7p=5]="launchByLastUpdateInitializer";e[e.H7p=6]="launchByDynamicCall"})(Cb||(Cb={}));Object(F.b)("AddinCommandsLaunchOperationType",
Cb);class Kb{}Kb.slp=864E5;Kb.k3k=3;Kb.lVn=144E5;Object(F.a)(Kb,"AddinConstantsNum",null,[]);var $b=d(1415),ab;(function(e){e[e.Lke=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.Knq=1]="spCatalog";e[e.Jnq=2]="spApp";e[e.v1p=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.qqg=6]="registry";e[e.y5p=7]="inMemory";e[e.Lqq=8]="uploadFileDevCatalog";e[e.$3p=9]="hardCodedPreinstall";e[e.yqe=10]="privateCatalog";e[e.Erq=16]="wopiCatalog"})(ab||(ab={}));Object(F.b)("AddinProviderType",
ab);class ia{static $4o(e){return parseInt(ia.W1b($b.a.bQh,e)||"-1")<=(new Date).getTime()}static rsi(e){return parseInt(ia.W1b($b.a.Dcc,e)||"-1")}static uMi(e){return Boolean.parse(ia.W1b($b.a.Xff,e)||"false")}static W1b(e,n){let C=null;try{const S=ia.a7d();if(void 0!==S&&S){const ja=$b.a.Yic(e)+n;C=S.getItem(ja)}else E.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(S){E.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",
e,n)}return C}static uAb(e,n,C){try{const S=ia.a7d();if(void 0!==S&&S){const ja=$b.a.Yic(e)+C;S.setItem(ja,n)}else E.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(S){E.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",e,C)}}static a7d(){if(!ia.aBa)return null;let e=null;try{e=localStorage}catch(n){ia.aBa=!1,e=null}return e}}ia.aBa=!0;Object(F.a)(ia,"AddinUtil",null,[]);class La{constructor(e,
n,C,S=null){this.J=S?S:G.AFrameworkApplication.J;this.cVe=2;this.bSb=e;this.gSk=n;this.Ap=C}get f$a(){return this.cVe}get EDp(){return this.gSk}Xtg(e){if(this.J.$("AgaveSupportsLiveIdSpoofing")){var n=(new Date).getTime();this.bSb(e,this.f$a,{["ak0"]:n})}else if(ia.$4o(e)){n=String.format(G.AFrameworkApplication.ua.Gb.gYa+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",G.AFrameworkApplication.ua.Gb.Mk,this.EDp,G.AFrameworkApplication.rm);const C=G.AFrameworkApplication.Fe;
let S=null;this.Ap&&(S=this.Ap.Xf("ComponentAttach",ab[e]+Cb[this.f$a]));C.Xj(n,1,null,null,!0,4,ja=>{this.M5n(e,ja.data.Pe);S&&S.stop()},ja=>{E.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",ja.data.He);this.Jsc(e,1,"request failed");S&&S.stop()},null)}else ia.uMi(e)?(n=ia.rsi(e),this.bSb(e,this.f$a,{["ak0"]:n})):this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.tR?this.Jsc(e,1,"no local timestamp"):this.bSb(e,this.f$a,
null))}M5n(e,n){if(n&&""!==n)if(n=Sys.Net.XMLDOM(n)){ia.uAb($b.a.bQh,((new Date).getTime()+Kb.lVn).toString(),e);let C=n.getElementsByTagName("update");C&&C.length||(C=n.getElementsByTagName("o:update"));C&&0<C.length?(n=Date.parse(C[0].firstChild.nodeValue),ia.rsi(e)<n||ia.uMi(e)?this.bSb(e,this.f$a,{["ak0"]:n}):this.Jsc(e,1,"outdate timestamp in reponse")):this.Jsc(e,2,"no timestamp in response")}else this.Jsc(e,1,"response data is invalid");else this.Jsc(e,1,"no responseData")}Jsc(e,n,C){this.tR&&
this.bSb(e,this.f$a,{["AddinServiceUserState"]:n,["DiagnosticInfo"]:C})}get tR(){return this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(F.a)(La,"AddinCommandsAnonymousAPIInitializer",null,[827]);class Mb{constructor(e,n,C){this.cVe=C;this.bSb=e;this.ee=n}get f$a(){return this.cVe}Xtg(e){let n=null;this.ee&&(n=this.ee.Xf("ComponentAttach",ab[e]+Cb[this.f$a]));
if(null==this.$Ag(e)?0:this.$Ag(e)){const C=(new Date).getTime()-Kb.k3k*Kb.slp;this.bSb(e,this.f$a,{["ak0"]:C})}n&&n.stop()}}Object(F.a)(Mb,"AddinCommandsInitializerBase",null,[827]);class Ha extends Mb{constructor(e,n){super(e,n,5)}$Ag(){return!0}}Object(F.a)(Ha,"AddinCommandsInitializer",Mb,[]);class zb extends Mb{constructor(e,n){super(e,n,1)}$Ag(e){try{const n=$b.a.byi()+e;return Boolean.parse(this.xkm(n)||"false")}catch(n){E.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",
n.toString())}return null}xkm(e){const n=localStorage;return void 0!==n&&null!==n?n.getItem(e):null}}Object(F.a)(zb,"AddinCommandsLocalCacheInitializer",Mb,[]);var ac=d(633);class nc{constructor(e,n=null){this.Ap=e;this.J=n?n:G.AFrameworkApplication.J}get appUILocale(){return ac.a.Eg(G.AFrameworkApplication.lcid).name}J7m(){const e=this.pti();if(e)if(this.J.$("OcpsIsEnabled"))gc.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("ConnectedServices",
!0).then(C=>{for(const S of e){if(!C&&0===S.key){this.tR&&this.Q2j(0,S.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const ja=this.Lri(S.value);ja&&ja.Xtg(S.key)}return null})});else for(const n of e){const C=this.Lri(n.value);C&&C.Xtg(n.key)}}Ytg(e,n,C){C&&C[$b.a.Dcc]?(C[$b.a.EHa]=e,C[$b.a.DHa]=n,this.Klg(T.a.Avc,C),ia.uAb($b.a.Dcc,C[$b.a.Dcc].toString(),e)):this.tR?this.Q2j(e,n,C):this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&0===e&&(C={},C[$b.a.EHa]=e,C[$b.a.DHa]=n,this.Klg(T.a.iS,C))}Lri(e){let n=null;switch(e){case 1:n=new zb(Object(ic.a)(this,this.Ytg,"retrieveAddinFlagCompleted"),this.Ap);break;case 2:n=new La(Object(ic.a)(this,this.Ytg,"retrieveAddinFlagCompleted"),this.appUILocale,this.Ap,this.J);break;case 5:n=new Ha(Object(ic.a)(this,this.Ytg,"retrieveAddinFlagCompleted"),this.Ap)}return n}Q2j(e,n,C){0===e&&C&&C[$b.a.zRd]&&(C[$b.a.EHa]=e,C[$b.a.DHa]=n,E.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
C[$b.a.zRd].toString(),JSON.stringify(C)),this.Klg(T.a.iS,C))}get tR(){return this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(F.a)(nc,"AddinCommandsInitializerHost",null,[]);var Gb=d(152);class tc extends nc{constructor(e,n){super(n);this.ga=e}Uqp(){this.J7m()}Ahm(){return this.pti()}pti(){const e=new Gb.a;G.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&
(G.AFrameworkApplication.J.$("AddInCommandsRoamingStoreIsEnabled")?e.W(0,2):e.W(0,1),e.W(16,5));G.AFrameworkApplication.J.$("InsertAgaveMyOrgEnabledForHost")&&e.W(1,1);G.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled")&&e.W(10,5);G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&e.W(8,1);return e}Klg(e,n){this.ga.Qb(e,2,n)}}Object(F.a)(tc,"AddInCommandsInitService",nc,[810]);class Qb extends tc{constructor(e,n){super(e,n);rb.a.n6c=rb.a.wck}}Object(F.a)(Qb,"WordEditorAddInCommandsInitService",
tc,[]);class Yb{constructor(){this.labelText=null;this.visible=!1}}Object(F.a)(Yb,"AddinStatusCommandValues",null,[]);class fc{static wlo(e){const n=new Yb;n.labelText=e.CSc;n.visible=n.labelText?!0:!1;return n}static ize(e,n,C,S,ja){const ya=document.getElementById(C);ya?fc.R8o(e,n,ya,S,ja):E.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",C))}static R8o(e,n,C,S,ja){C?e.CSc===CommonUIStrings.l_ErrorLoadingAddInsTitle?Dc.p7o(n,C,S,ja):e.CSc===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
Dc.V8o(n,C):E.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(F.a)(fc,"AddinCommandsStatusHandler",null,[]);var ib=d(20),Jc=d(774),jd=d(1291),Wc=d(48),Ad=d(122),Yd=d(185);class ke extends Sys.EventArgs{constructor(){super();this.lC=this.Dq=null}}Object(F.a)(ke,"InsertionParamEventArgs",Sys.EventArgs,[]);class bf{constructor(e,n,C,S,ja,ya){this.lH=e;this.Dq=n;this.wDa=C;this.displayName=ja;this.V4i=ya}}Object(F.a)(bf,"PostLaunchAddinCommandsParameters",
null,[]);var od=d(197),Vf=d(354);class ah{}Object(F.a)(ah,"AppsForOfficeEntitlementQueryInfo",null,[]);var Bf=d(29),Of=d(16);class Qf{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(F.a)(Qf,"AddinAbstract",null,[]);var Jg=d(80);class jf{constructor(e,n,C,S=null){this.LQb=ja=>{let ya=!1,kb=null;try{if(0<ja.data.Pe.length){const Rb=Object(Jg.a)(Object,Bf.a(ja.data.Pe)),sc=Rb?Rb[this.appName]:null;sc&&(kb=Object(Jg.a)(Object,Bf.a(sc.toString())))}ya=!0}catch(Rb){this.u9a(null)}ya&&
this.fIc&&this.fIc(kb)};this.u9a=ja=>{this.$Hc&&this.$Hc(ja?ja.data:null)};this.wcb=ja=>{this.FNc&&this.FNc(ja?ja.data:null)};this.Zld=G.AFrameworkApplication.J.jb("RoamingServiceHandlerWebServiceBase");this.appName=e;this.fIc=n;this.$Hc=C;this.FNc=S}VAf(e){this.T3l(e,this.LQb,this.u9a)}T3l(e,n,C){const S=new Sys.StringBuilder(this.Zld);S.append("RoamingServiceHandler.ashx?action=");S.append("getAddinTeachingCalloutSettings");S.append("&");S.append(this.VLf(e));S.append("&");S.append(G.AFrameworkApplication.rm);
G.AFrameworkApplication.Fe.Xj(S.toString(),1,null,null,!0,2,n,C,null)}F1d(e){this.Y3l(e)}Y3l(e){var n=new Sys.StringBuilder(this.Zld);n.append("RoamingServiceHandler.ashx?action=");n.append("saveAddinTeachingCalloutSettings");n.append("&");n.append(G.AFrameworkApplication.rm);n=n.toString();e=Bf.c(e);G.AFrameworkApplication.Fe.Xj(n,2,e,null,!0,4,null,this.wcb,null)}VLf(e){const n=new Sys.StringBuilder("requestedsettings=");for(let C=0;C<e.count;C++)n.append(e.K(C)),C<e.count-1&&n.append(";");return n.toString()}}
Object(F.a)(jf,"AddinTeachingUIRoamingRequestHandler",null,[]);class $i extends Sys.EventArgs{constructor(e){super();this.solutionId=e.solutionId;this.assetId=e.assetId;this.storeType=e.storeType;this.storeId=e.storeId;this.assetStoreId=e.assetStoreId;this.targetType=e.targetType;this.width=e.width;this.height=e.height;this.displayName=e.displayName;this.version=e.version}}Object(F.a)($i,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Vd=d(236);class eh{constructor(e){this.Ecc=
this.Dq=null;this.VHj=!1;this.chb=this.gwd=this.oZa=this.yt=this.EBb=this.Qvc=null;this.d0n=()=>{const n=new od.ScriptSharpLegacyMap;this.Ecc&&this.Ecc.tabs&&!this.Ecc.tabs[0].isOfficeTab&&n.W("SDX.FeatureFlags","NonOfficeTab");this.Eqc(eh.l7(this.Dq),"ClickOnLaunch",n);this.Mie();this.Ecc?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Ecc,()=>{const C=new ke;C.Dq=this.Dq;this.jd.raiseEvent($b.a.H5i,C)}):E.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
this.sXn=()=>{this.Eqc(eh.l7(this.Dq),"ClickOnClose");this.Mie()};this.GYn=()=>{this.Eqc(eh.l7(this.Dq),"ClickOnDismiss");this.Mie()};this.pjj=n=>{if(n&&(n=n.detail)&&n.id&&this.rgn(n.id)){const C=(n.action||"").toLowerCase();if(n.success&&"opened"===C)this.Eqc(eh.l7(this.Dq),"CampaignLaunched"),E.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Mie(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.pjj,!0);else{let S;
try{S=JSON.stringify(n),E.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+S)}catch(ja){S="id : "+n.id+" telemetryEventName: "+n.telemetryEventName,E.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+S+" Error: "+(ja?ja.toString():""))}}}};this.LQb=n=>{n?this.O5o(n)?(E.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.Qvc="AddinHasShown"in n&&n.AddinHasShown?n.AddinHasShown.toString():null,this.s5h()):(E.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),
this.oZa(this.dmb,null)):(E.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.Qvc=null,this.s5h())};this.u9a=n=>{E.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",n?n.He:-1);this.oZa(this.dmb,null)};this.wcb=n=>{E.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",n?n.He:-1)};this.jd=e}get appName(){return G.AFrameworkApplication.J.jb("WebAppShortName")}get hQh(){this.EBb||(this.EBb=
new jf(this.appName,this.LQb,this.u9a,this.wcb));return this.EBb}get dmb(){this.gwd||(this.gwd=new fb.a);return this.gwd}set dmb(e){this.gwd=e}get sMb(){this.chb||(this.chb=new fb.a);return this.chb}set sMb(e){this.chb=e}IQd(e,n){window.addEventListener?(this.Dq=e,this.Ecc=n,window.addEventListener("LaunchAddinTaskpane",this.d0n,!0),window.addEventListener("DismissCallout",this.GYn,!0),window.addEventListener("CloseCallout",this.sXn,!0),window.addEventListener("FGWebSurfaceEvent",this.pjj,!0)):E.ULS.sendTraceTag(508625357,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}jAc(e,n,C,S){this.yt=e;this.dmb=n;this.sMb=C;this.oZa=S;E.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",n?n.count.toString():"null",C?C.count.toString():"null");0<this.dmb.count||0<this.sMb.count?(e=new fb.a,e.add(this.appName),this.hQh.VAf(e)):this.oZa(new fb.a,null)}rgn(e){e=Of.a.xh(e);return-1!==e.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==e.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==e.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==e.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==e.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==e.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}zve(e){if(this.appName){const n={},C={};C.LastTeachingUIShowTime=(new Date).toUTCString();C.AddinHasShown=e;n[this.appName]=Bf.c(C);this.hQh.F1d(n);E.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else E.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}Mie(){if(!this.VHj){const e=window.g_roamingAddinList;e&&(this.zve(e),this.VHj=!0)}}s5h(){const e=this.HSl();0===e.targetType?(e.solutionId?this.alo(e):this.Eqc(null,"NoSolutionId"),this.O8j(e),this.oZa(this.dmb,null)):this.oZa(this.dmb,e);E.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",e.addinId)}alo(e){const n=new ah;n.callbackFunc=C=>{if(C.errorCode){this.Eqc(e.solutionId,"FailToGetAppDetails");var S=window.g_roamingAddinList;
S&&this.zve(S)}else if(C.value)for(S of C.value)if(C=S[1],C===e.solutionId){const ja={};ja.solutionId=C;ja.assetId=S[5];ja.storeType=S[12];ja.storeId=S[11];ja.assetStoreId=S[6];ja.targetType=S[3];ja.width=S[7];ja.height=S[8];ja.displayName=S[0];ja.version=S[4];E.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",e.solutionId);S=new $i(ja);this.jd.raiseEvent($b.a.o7o,S);break}};n.storeType=OSF.StoreTypeEnum.PrivateCatalog;n.fromInsertDialog=!1;n.refresh=!1;this.yt.queryEntitlementDetails(n)}O5o(e){if("LastTeachingUIShowTime"in
e){if(e=+new Date-+new Date(e.LastTeachingUIShowTime.toString()),e<G.AFrameworkApplication.J.N2("AddinShowTeachingUIIntervalInMS",864E5))return E.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",e),!1}else E.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}HSl(){let e=new Vf.a(new Qf,0),n=new Vf.a(new Qf,0),C=0,S=0,ja=0;var ya=new fb.a;for(var kb of this.dmb)ya.add(kb);for(const Rb of this.sMb)ya.add(Rb);for(const Rb of ya)if(!("excatalog"!==
Rb.storeType||ld.c(Rb.installTimeInMS)||!Rb.installTimeInMS||Rb.installTimeInMS<=G.AFrameworkApplication.J.N2("DateTimeInMSForNewAddin",16409952E5))){ya=eh.ssi(Rb);if(this.Qvc&&(kb=this.Qvc.split(","),0<kb.length&&Array.contains(kb,ya))){ja++;E.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}ya.startsWith("private_")?(e=eh.IAi(Rb,e),S++):(n=eh.IAi(Rb,n),C++)}E.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
S,C,ja);return 0<n.value?n.key:0<e.value?e.key:Object.assign(new Qf,{addinId:null,targetType:-1,solutionId:null})}Eqc(e,n,C=null){e={["AppTeachingUICalloutAction"]:n,["SDX.Id"]:e,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(C)for(const S of C.keys)e[S]=C.K(S);Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ad.a.iI(e)}))}O8j(e){e&&(window.g_roamingAddinList=this.Qvc?this.Qvc+","+e.addinId:
e.addinId)}static l7(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}static IAi(e,n){return n.value<e.installTimeInMS?new Vf.a(Object.assign(new Qf,{addinId:eh.ssi(e),targetType:e.targetType,solutionId:e.solutionId}),e.installTimeInMS):n}static ssi(e){return Telemetry.PrivacyRules.IsPrivateAddin(e.storeType,e.assetId,null,null,e.storeId)?"private_"+e.installTimeInMS:e.solutionId}}Object(F.a)(eh,"PrivateCatalogTeachingCalloutHandler",null,
[]);class rd{constructor(e){this.OYe=null;this.Jmh=e}get nUb(){return this.OYe}lcc(e,n=null){this.Jmh.lcc(e,n);this.OYe=e}irg(e){this.Jmh.irg(e)}tOj(e){this.OYe=e}}Object(F.a)(rd,"RibbonExtensibilityManagerWithChangeDetection",null,[1895]);const Gc=()=>{const e=N.a.arb(window.location.href.toLowerCase(),"wdomexsrctype");return!!e&&"4"===e},Wd=()=>N.a.arb(window.location.href.toLowerCase(),"wdtpl"),Ye=()=>{const e=N.a.arb(window.location.href.toLowerCase(),"wdomexsrctype");return!!e&&"1"===e},yg=e=>
{let n=null;switch(e){case 0:n="omex";break;case 1:n="spcatalog";break;case 2:n="spapp";break;case 3:n="filesystem";break;case 4:n="exchange";break;case 6:n="registry";break;case 7:n="inmemory";break;case 8:n="uploadfiledevcatalog";break;case 9:n="hardcodedpreinstall";break;case 10:n="excatalog";break;case 16:n="wopicatalog"}return n},yf=e=>{let n=-1;switch(e.toLowerCase()){case "omex":n=0;break;case "spcatalog":n=1;break;case "spapp":n=2;break;case "filesystem":n=3;break;case "exchange":n=4;break;
case "registry":n=6;break;case "inmemory":n=7;break;case "uploadfiledevcatalog":n=8;break;case "hardcodedpreinstall":n=9;break;case "excatalog":n=10;break;case "wopicatalog":n=16}return n};class re{lcc(e,n=null){if(e=Pc.s1c(e)){appChrome.addInApi.dispatchActionsToInstallAddIn(e,n);for(const C of e.tabs)if(C.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(e,()=>{});break}}}irg(e){(e=Pc.s1c(e))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(e)}tOj(){}static KUl(e,n,C=null){e=re.TIm(e);
0<e.length&&(re.Pwe(e,!1),C&&C(n,e))}static TIm(e){const n=[];if(e&&(e=e.GCa,e.CJ&&0<e.CJ.count))for(const C of e.CJ)if(C.groups&&0<C.groups.length)for(const S of C.groups)if(S.controls&&0<S.controls.length)for(const ja of S.controls)Array.add(n,ja.id);return n}static Pwe(e){if(e.length){var n=[];for(const C of e)n.push(appChrome.actions.updateControlEnabledDisabledState(C,!0));appChrome.api.dispatch(n)}}}Object(F.a)(re,"OneLineRibbonExtensibilityManager",null,[1895]);class Xe{constructor(){this.Ver=
1}}Object(F.a)(Xe,"CacheItem",null,[]);class dc{constructor(e){this.gW=e}}Object(F.a)(dc,"AppsDataCacheManager",null,[1896]);var Ac=d(1272);class dd{constructor(){new dc(Ac.a.instance)}pMj(e,n){e=$b.a.byi()+e;Ac.a.instance.setItem(e,n.toString())}IGm(){var e=$b.a.AEi();E.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",e);e=Ac.a.instance.getItem(e);return Bf.a(e)}xYo(e){const n=$b.a.AEi();E.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",n);Ac.a.instance.setItem(n,Bf.c(e))}Gnn(){return!!Ac.a.instance.localStorage}static get instance(){dd._instance||
(dd._instance=new dd);return dd._instance}}dd._instance=null;Object(F.a)(dd,"AddInCommandsCacheManager",null,[1865]);var fd=d(95);class Fd{static fzi(e){const n=new fb.a;if(Fd.$4h)for(var C of Fd.$4h)n.add(C);C=null;switch(e){case "Workbook":C=Fd.eLp;break;case "Document":C=Fd.uXl;break;case "Presentation":C=Fd.Bgo}if(C)for(const S of C)n.add(S);return n}}Fd.$4h=["PrimaryCommandSurface","ContextMenu"];Fd.eLp=null;Fd.uXl=null;Fd.Bgo=null;Object(F.a)(Fd,"ExtensionPointType",null,[]);class cf{constructor(e){this.twh=
null;if(ld.c(e))throw E.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Ymk=e}get wed(){return this.twh||(this.twh=new fb.a)}get FQh(){return this.Ymk}}Object(F.a)(cf,"ContextMenuExtensibility",null,[1884]);class Bg{constructor(e,n=null,C=0){if(ld.c(e))throw E.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");
this.AHk=e;this.LOk=n;this.Bwk=C}get GCa(){return this.AHk}get startedNode(){return this.LOk}get Ifm(){return this.Bwk}}Object(F.a)(Bg,"RibbonExtensibility",null,[1944]);class me{constructor(e){this.Iuk=e.entitlement}get entitlement(){return this.Iuk}createActionContext(e,n){e={};e.ownerAddinInfo=this.entitlement;e.action=n;return e}}Object(F.a)(me,"AddInCommandsContextProvider",null,[]);class mf{constructor(e,n,C){this.r8g=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=
this.commandSurface=null;this.ribbonBuilder=e;this.eventBuilder=n;this.contextMenuBuilder=C}get addinInfo(){return this.r8g}LEl(e){return new me(e)}createActionBuilder(e,n){return OfficeExt.DefaultControlActionBinder.createActionBuilder(e,n.entitlement,n.manifest)}startApplyAddin(e){this.r8g=e;const n=this.LEl(e);this.actionBuilder=this.createActionBuilder(n,e)}endApplyAddin(){}jFf(e,n,C=0){return this.ribbonBuilder.CJ&&0<this.ribbonBuilder.CJ.count?new Bg(this.hfm(e,n),this.addinInfo.startedNode,
C):null}Dri(){var e=null;if(this.contextMenuBuilder.eje&&0<this.contextMenuBuilder.eje.count){e||(e=this.addinInfo.entitlement.solutionId);e=new cf(e);for(const n of this.contextMenuBuilder.eje)e.wed.add(n);return e}return null}hfm(e,n){return this.ribbonBuilder.CJ&&0<this.ribbonBuilder.CJ.count?new Pc(this.ribbonBuilder.CJ,e,n):null}}Object(F.a)(mf,"AddinCommandsBuilder",null,[]);class ug{constructor(e,n,C,S,ja,ya,kb){this.P0b=new fd.a;this.lH=e;this.yt=n;this.h6=C;this.Ovc=S;this.Yqf=ja;this.hdb=
ya;this.zcc=kb;this.mV=G.AFrameworkApplication.ua.Vr}Hyn(e,n,C,S,ja,ya,kb){const Rb=(sc,Fc,gd,td)=>{ja(sc,Fc,gd,td);sc=Cb[this.lH]+Fc.assetId;({value:Fc}=this.P0b.Ec(sc)).returnValue&&(Fc.stop(),this.P0b.remove(sc))};if(0!==this.lH&&e){E.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",e.count);4===this.lH&&(E.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",S)),this.rrl(e,S),ya());for(const sc of e)if(e=sc,E.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",
this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId))),this.pak(e))if(kb&&e.requireConsent)kb(e,Fc=>{try{if(this.mV){const td=Cb[this.lH]+Fc.solutionId,Bd=this.mV.Xf("ComponentAttach",td);this.P0b.W(td,Bd)}const gd=this.hdb.gic(Fc.storeType,Fc.solutionId);6!==this.lH&&(gd&&(this.qVd(gd),gd.RX.purge(!1)),this.yt.insertOsfControl(this.Ehd(Fc,n,C,Rb)),gd&&this.yt.ownerAddinControlRecreated(Fc.solutionId,Fc.storeType))}catch(gd){E.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(Fc.solutionId,Fc.ownerAddinStoreType||Fc.storeType,Fc.assetId,null,null,Fc.storeId),Fc.version,Fc.storeType,Fc.storeId,gd.message)),Rb(!1,Fc,null,null)}});else try{if(this.mV){const gd=Cb[this.lH]+e.solutionId,td=this.mV.Xf("ComponentAttach",gd);this.P0b.W(gd,td)}const Fc=this.hdb.gic(e.storeType,e.solutionId);
!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==G.AFrameworkApplication.ua.Gb.Mk&&1!==G.AFrameworkApplication.ua.Gb.Mk&&2!==G.AFrameworkApplication.ua.Gb.Mk||3!==this.lH||"excatalog"===e.storeType||!Fc||Fc.isUpgraded?6!==this.lH&&(Fc&&(this.qVd(Fc),Fc.RX.purge(!1)),this.yt.insertOsfControl(this.Ehd(e,n,C,Rb)),Fc&&this.yt.ownerAddinControlRecreated(e.solutionId,e.storeType)):(this.Ovc.tOj(Fc.lC),Rb(!0,e,null,Fc.displayName))}catch(Fc){E.ULS.sendTraceTag(17388185,
220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId,Fc.message)),Rb(!1,e,null,null)}else Rb(!1,e,null,null)}}Ryn(e,n,C,S,ja,ya){const kb=(Rb,sc,Fc,gd)=>{ya(Rb,sc,Fc,gd);Rb=Cb[this.lH]+sc.solutionId;({value:sc}=this.P0b.Ec(Rb)).returnValue&&(sc.stop(),
this.P0b.remove(Rb))};if(6===this.lH&&e)if(E.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId))),this.pak(e))try{if(this.mV){const sc=Cb[this.lH]+e.solutionId,Fc=this.mV.Xf("ComponentAttach",sc);this.P0b.W(sc,Fc)}const Rb=this.hdb.gic(e.storeType,e.solutionId);Rb||kb(!1,e,null,null);G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb.Edi?
this.esi(e,n,S,ja,C,sc=>{kb(sc,e,C,Rb.displayName)}):(this.esi(e,n,S,ja,C),kb(!0,e,C,Rb.displayName))}catch(Rb){E.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId,Rb.message)),kb(!1,e,null,null)}else kb(!1,
e,null,null)}xVn(e,n,C,S,ja,ya){if(ya)if(ya._isAddinCommandsManifest(this.h6.O_))try{G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb.Edi?this.dsi(e,n,C,ja,ya,kb=>{S(kb,e,ya,ya.getDefaultDisplayName())}):(this.dsi(e,n,C,ja,ya),S(!0,e,ya,ya.getDefaultDisplayName()))}catch(kb){E.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,
e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId,kb.message)),S(!1,e,ya,ya.getDefaultDisplayName())}else E.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId)),S(!1,
e,null,null);else E.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.h6.O_,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId)),S(!1,e,null,null)}Ehd(e,n,C,S){const ja={},ya=document.createElement("div");ya.setAttribute("visible","false");ja.div=ya;ja.id=e.solutionId;ja.solutionId=e.solutionId;
ja.version=e.version;ja.storeType=e.storeType;ja.storeId=e.storeId;ja.assetId=e.assetId;ja.assetStoreId=e.assetStoreId;ja.isvirtualOsfControl=!0;ja.virtualOsfControlActivationCallback=(kb,Rb)=>{const sc=this.hdb.gic(e.storeType,e.solutionId);sc&&(sc.isUpgraded&&(e.isUpgraded=!0),this.qVd(sc));this.xVn(e,n,C,S,kb,Rb)};ja.reason=3===this.lH?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return ja}dsi(e,n,C,S,ja,ya=null){const kb=
{};kb.solutionId=S.getSolutionId();kb.version=S.getVersion();kb.storeType=S.getStoreType();kb.storeId=S.getStoreId();kb.assetId=S.getAssetId();kb.assetStoreId=S.getAssetStoreId();kb.targetType=S.getOsfControlType();let Rb=null,sc=null;if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Rb=(new OfficeExt.Parser.AddinCommandsManifestParser(this.h6.O_,this.h6.formFactor)).parseExtensions(kb,ja,this.zcc),sc=Fd.fzi(this.h6.O_);
else try{Rb=(new OfficeExt.Parser.AddinCommandsManifestParser(this.h6.O_,this.h6.formFactor)).parseExtensions(kb,ja,this.zcc),sc=Fd.fzi(this.h6.O_)}catch(gd){throw E.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+gd.message),gd;}if(sc&&0<sc.count){if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Fc=n(e);n=C(e);C=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AddinCommandsMultipleCustomTabsEnabled");
Fc=new mf(Fc,null,n);for(const gd of sc)Fc.commandSurface=gd,Rb.apply(Fc,this.zcc,C)}else try{const gd=n(e),td=C(e),Bd=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AddinCommandsMultipleCustomTabsEnabled");Fc=new mf(gd,null,td);for(const wd of sc)Fc.commandSurface=wd,Rb.apply(Fc,this.zcc,Bd)}catch(gd){throw E.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+gd.message),gd;}if(OSF.OUtil.checkFlight(14))try{const gd=Fc.jFf(e.solutionId,ja.getDefaultDisplayName()),
td=Fc.Dri();gd&&this.Ovc.lcc(gd,ya);td&&this.Yqf.KMh(td);this.hdb.xNh(S,gd,td,ja.getDefaultDisplayName());E.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",ja.getDefaultDisplayName())}catch(gd){throw OfficeExt.DevConsole.log(gd),E.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+gd.message),gd;}else try{const gd=Fc.jFf(e.solutionId,ja.getDefaultDisplayName()),td=Fc.Dri();gd&&this.Ovc.lcc(gd);td&&this.Yqf.KMh(td);this.hdb.xNh(S,gd,td,ja.getDefaultDisplayName());
E.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",ja.getDefaultDisplayName())}catch(gd){throw E.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+gd.message),gd;}}}esi(e,n,C,S,ja,ya=null){const kb={};kb.solutionId=e.solutionId;kb.version=e.version;kb.storeType=e.storeType;kb.storeId=e.storeId;kb.assetId=e.assetId;kb.assetStoreId=e.assetStoreId;kb.targetType=e.targetType;const Rb=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.h6.O_,this.h6.formFactor);
try{const sc=n.getManifest(),Fc=Rb.parse(kb,sc,ja,this.zcc,n.getSharedRuntimeId(),n),gd=C(e),td=S(e),Bd=new mf(gd,null,td);Bd.commandSurface="PrimaryCommandSurface";Fc.apply(Bd,this.zcc,!0);if(Bd.ribbonBuilder.CJ&&0<Bd.ribbonBuilder.CJ.count){const wd=Bd.jFf(e.solutionId,n.getManifest().getDefaultDisplayName(),1);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.Ovc.lcc(wd,ya):wd&&this.Ovc.lcc(wd,ya);this.hdb.oYk(n,wd,ja,
n.getManifest().getDefaultDisplayName());E.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",n.getManifest().getDefaultDisplayName())}}catch(sc){E.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",n.getManifest().getDefaultDisplayName(),sc.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(sc)}}qVd(e){e.lC&&this.Ovc.irg(e.lC);e.HWc&&this.Yqf.mzo(e.HWc);this.hdb.Iyo(e.RX.getStoreType(),e.RX.getSolutionId())}rrl(e,n){n=yg(n);
for(const C of this.hdb.Kmc){if(C.RX.getStoreType()!==n)continue;let S=!0;for(const ja of e){const ya=ja;if(ya&&C.s1i(ya.storeType,ya.solutionId)){S=!1;break}}S&&(this.qVd(C),C.RX.purge(!1))}}pak(e){return!!e&&!!e.solutionId&&!!e.version&&!!e.storeType&&!!e.storeId}}Object(F.a)(ug,"AddInCommandsIntegration",null,[]);class Bi{constructor(e,n,C,S,ja,ya,kb,Rb=null){this.sa=new eb.a;this.rPa=e;this.Zrk=n;this.ek=C;this.GIh=S;this.j$b=ja;this.Mmk=ya;this.hwd=kb;this.lGk=Rb}p0k(e){this.sa.addHandler($b.a.YPh,
e)}L0k(e){this.sa.addHandler($b.a.H5i,e)}S2k(e){this.sa.addHandler($b.a.KTj,e)}x0k(e){this.sa.addHandler($b.a.bjf,e)}izn(e,n,C){const S=C[$b.a.uRd],ja=void 0===C[$b.a.DHa]?0:C[$b.a.DHa];if(S&&0!==ja)if(0>=S.count&&4!==ja)this.Utj(new bf(ja,null,null,n,null,!0));else{var ya=S.count,kb=new rd(new re),Rb=void 0===C[$b.a.EHa]?-1:C[$b.a.EHa],sc=new ug(ja,this.ek,this.rPa,kb,this.Zrk,this.j$b,this.hwd),Fc=te=>this.GIh.nhl(te.solutionId,this.hwd,this.rPa,e),gd=te=>this.GIh.kgl(te.solutionId),td=(te,Le,Oe)=>
{ya--;Oe=new bf(ja,Le,kb,n,Oe,0>=ya);if(te&&Le)this.Utj(Oe);else{if(3===ja||Le&&Le.isUpgraded)te="",Le&&(te=Telemetry.PrivacyRules.GetPrivacyCompliantId(Le.solutionId,Le.ownerAddinStoreType||Le.storeType,Le.assetId,null,null,Le.storeId)),Le={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:te},Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ad.a.iI(Le)}));this.Ttj(Oe)}ya||G.AFrameworkApplication.ua.Ge()},
Bd=(te,Le,Oe,We)=>{td(te,Le,We)},wd=()=>{this.Jbg();0>=S.count&&4===ja&&this.j$b.Txg()};6===ja?(Rb=C[$b.a.eZl],C=C[$b.a.fZl],sc.Ryn(S.K(0),Rb,C,Fc,gd,(te,Le,Oe,We)=>{td(te,Le,We)})):sc.Hyn(S,Fc,gd,Rb,Bd,wd,this.lGk)}else Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ad.a.iI({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),E.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.rPa.O_)),this.Ttj(new bf(ja,null,null,n,null,!0))}Ttj(e){this.Jbg(e);this.JUj(!1,e)}Utj(e){const n=e.Dq;let C=null;null!==n&&(C=n.storeType,C=C.toLowerCase());if(e&&"omex"===C&&(3===e.lH||n.isUpgraded)){var S={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(n.solutionId,n.ownerAddinStoreType||n.storeType,n.assetId,null,null,n.storeId)};Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Ad.a.iI(S)}))}this.Jbg(e);S=Ye()&&"omex"===C&&!!e.wDa&&!!n.solutionId&&2===e.lH&&n.solutionId.toLowerCase()===Wd().toLowerCase();var ja="excatalog"===C&&3===e.lH;if("omex"===C&&e.wDa&&(3===e.lH&&"hardcodedpreinstall"!==C||n.isUpgraded)||S||ja)S=new ke,S.Dq=n,S.lC=e.wDa.nUb,this.sa.raiseEvent($b.a.bjf,S);S=Gc();ja=Wd();S&&n&&"excatalog"===n.storeType&&e.wDa&&5===e.lH&&ja&&(n.storeId&&n.storeId.toLowerCase()===ja.toLowerCase()||n.assetId&&n.assetId.toLowerCase()===ja.toLowerCase())&&(S=new ke,
S.Dq=n,S.lC=e.wDa.nUb,this.sa.raiseEvent($b.a.bjf,S),E.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));n&&(dd.instance.pMj(yf(C),!0),"uploadfiledevcatalog"===C&&(S=this.Mmk.createAddinDataProvider(C,this.ek))&&S.localCacheAddinCommands(this.ek.CYa,n.solutionId,n.version,n.storeId),ia.uAb($b.a.Xff,"true",yf(C)));this.JUj(!0,e)}JUj(e,n){e?n.wDa&&5===n.lH&&n.wDa.nUb&&void 0!==n.Dq.showCallout&&null!==n.Dq.showCallout&&n.Dq.showCallout?((new eh(this.sa)).IQd(n.Dq,Pc.s1c(n.wDa.nUb)),
e=new ke,e.lC=n.wDa.nUb,e.Dq=n.Dq,this.sa.raiseEvent($b.a.KTj,e)):3!==n.lH?n.V4i&&this.j$b.Txg():n.wDa&&n.wDa.nUb&&"hardcodedpreinstall"!==n.Dq.storeType&&Dc.r7o(n.displayName,n.wDa.nUb,n.Dq.isAutoLaunched):3===n.lH?n.Dq&&"uploadfiledevcatalog"===n.Dq.storeType.toLowerCase()?(n=this.hwd.Irm(n.Dq.solutionId),Dc.ABg(n?n:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.j$b.AUo():n.V4i&&this.j$b.Txg()}Jbg(e=null){var n=e?e.Dq:null;const C=new ke;if(C.Dq=n){var S=this.j$b.gic(n.storeType,
n.solutionId,6===e.lH?1:0);if(S&&S.lC){C.lC=S.lC;var ja=Wd();ja=Ye()&&!!n.solutionId&&!!ja&&n.solutionId.toLowerCase()===ja.toLowerCase()&&2===e.lH;if(3===e.lH&&"hardcodedpreinstall"!==n.storeType||ja)e="",S.lC.GCa&&S.lC.GCa.CJ&&(S=S.lC.GCa.CJ.K(0))&&(e=S.id),n={["SDX_CommandPlacement"]:e,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(n.solutionId,n.ownerAddinStoreType||n.storeType,n.assetId,null,null,n.storeId)},Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:Ad.a.iI(n)}))}}this.sa.raiseEvent($b.a.YPh,C)}}Object(F.a)(Bi,"LaunchAddinCommandsHandler",null,[1880]);class Zf{constructor(e){this.NHk=e}get CYa(){return this.NHk}insertOsfControl(e){return this.CYa.insertOsfControl(e)}getManifestInvaildErrorString(){return this.CYa.getManifestInvaildErrorString()}isAddinCommandsAsync(e,n){this.CYa.isAddinCommandsAsync(e,n)}isAddinCommandsExAsync(e,n){this.CYa.isAddinCommandsExAsync(e,n)}ownerAddinControlRecreated(e,
n){this.CYa.ownerAddinControlRecreated(e,n)}queryEntitlementDetails(e){this.CYa.queryEntitlementDetails(e)}}Object(F.a)(Zf,"ContextActivationMgrWrapper",null,[1876]);class zf{}zf.Rfb="Alt";zf.R0a="Command";zf.id="Id";zf.Xfb="Image16by16";zf.Yfb="LabelText";zf.X0a="Title";zf.iHe="Groups";zf.kBb="Controls";zf.button="Button";zf.KJa="FlyoutAnchor";Object(F.a)(zf,"AddinDataNodeConstants",null,[]);var xh=d(208),Vj=d(776),Ui=d(421),Bb=d(151);class Pb{constructor(e,n){this.l3a=this.sch=null;if(ld.c(e)||
ld.c(n))throw E.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.ENe=n;this._id=e;this.e_[zf.id]=this._id}get id(){return this._id||""}get e_(){return this.sch||(this.sch={})}get controlType(){return this.ENe||""}get menuItems(){return this.l3a||(this.l3a=new fb.a)}wrd(){let e=null;this.ENe===zf.KJa?e=Object.assign(new Vj.a,{Menu:this.AMn()}):this.ENe===zf.button&&(e=Object.assign(new xh.a,
{}));e&&(this.e_[zf.id]&&(e.ExternalId=this.e_[zf.id]),this.e_[zf.R0a]&&(e.Command=this.e_[zf.R0a].toString()),this.e_[zf.Yfb]&&(e.LabelText=this.e_[zf.Yfb]),this.e_[zf.Rfb]&&(e.Alt=this.e_[zf.Rfb]),this.e_[zf.Xfb]&&(Bb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.e_[zf.Xfb]),e.ExternalImageId=this._id));return e}AMn(){const e=Object.assign(new Ui.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.l3a){const n=Object.assign(new qb.a,{ControlList:[]});
for(const C of this.l3a)Array.add(n.ControlList,C.wrd());Array.add(e.MenuSectionList,n)}return e}}Object(F.a)(Pb,"ControlDefinition",null,[1877]);class zc{constructor(e){this.jxa=null;if(ld.c(e))throw E.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=e;this.kdd[zf.id]=this._id}get kdd(){return this.jxa||(this.jxa={})}get id(){return this._id||""}wrd(){const e=Object.assign(new xh.a,
{});this.jxa[zf.id]&&(e.ExternalId=this.jxa[zf.id]);this.jxa[zf.R0a]&&(e.Command=this.jxa[zf.R0a].toString());this.jxa[zf.Yfb]&&(e.LabelText=this.jxa[zf.Yfb]);this.jxa[zf.Rfb]&&(e.Alt=this.jxa[zf.Rfb]);this.jxa[zf.Xfb]&&(Bb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.jxa[zf.Xfb]),e.ExternalImageId=this._id);return e}}Object(F.a)(zc,"MenuItemDefinition",null,[1907]);class $c{constructor(e){this.ZPa=null;if(ld.c(e))throw E.ULS.sendTraceTag(9175314,220,
10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=e}get id(){return this._id}get controls(){return this.ZPa||(this.ZPa=new fb.a)}wrd(){const e=[];if(this.ZPa)for(const n of this.ZPa){const C=n.wrd();C&&e.push(C)}return e}}Object(F.a)($c,"OfficeMenuDefinition",null,[1878]);class Ae{constructor(e,n,C){this.A9=this.C5b=null;this.r0e=e;this.a5b=n;this.H3b=C;this.REk=new fb.a}get hke(){return this.r0e}get UVc(){return this.a5b}get Ocf(){return this.H3b}addButton(e){E.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",e.actionType);this.A9=new Pb(this.Omb(e.id),zf.button);this.A9.e_[zf.Yfb]=e.label;this.A9.e_[zf.Rfb]=e.label;this.A9.e_[zf.Xfb]=e.icon["16"];this.NTc(this.A9.e_[zf.id],e.action);this.gKb(this.A9.e_);this.C5b.controls.add(this.A9);this.A9=null}startBuildMenu(e){if(ld.c(this.C5b))this.C5b=new $c(e.id);else{const n=this.Omb(e.id);this.A9=new Pb(n,zf.KJa);this.Ldc(this.A9.e_,e);this.A9.e_[zf.Xfb]=e.icon["16"];this.A9.e_[zf.R0a]=T.a.yqa}}addMenuItem(e){E.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",e.actionType);const n=new zc(this.Omb(e.id));this.Ldc(n.kdd,e);e.icon&&(n.kdd[zf.Xfb]=e.icon["16"]);this.NTc(n.kdd[zf.id],e.action);this.gKb(n.kdd);this.A9.menuItems.add(n)}endBuildMenu(){ld.c(this.A9)?(this.eje.add(this.C5b),this.C5b=null):(this.C5b.controls.add(this.A9),this.A9=null)}get eje(){return this.REk}NTc(e,n){this.Ocf.bindAction(e,n)}gKb(e){this.UVc.gKb(e)}Omb(e){return this.hke.qjc(e)}Ldc(e,n){e[zf.Yfb]=n.label;e[zf.Rfb]=n.label}}Object(F.a)(Ae,
"ContextMenuExtensibilityCreator",null,[1900,1894]);class Gf{constructor(e){this.QLc=e}get Mdd(){return this.QLc}qjc(e){return this.Mdd+e}}Object(F.a)(Gf,"DefaultContextMenuNamingProvider",null,[1898]);class jg{constructor(e,n,C,S){this.QLc=e;G.AFrameworkApplication.J.$("AddInCommandsMissingTabIsEnabled")&&C.iAm();this.yFh=n;this.ANk=S}get Mdd(){return this.QLc}get solutionId(){return this.yFh}get OAg(){return this.ANk}qjc(e){e=this.Mdd+this.solutionId+e;return this.OAg?(e in jg.xRd||(jg.xRd[e]="AddinControl"+
jg.m3k++),jg.xRd[e]):e}mci(e){if(this.OAg){const C=jg.xRd;for(const S in C){var n=S;if(e===C[S])return n.substr(this.Mdd.length+this.solutionId.length)}}return e}eNm(e){e=this.Mdd+this.solutionId+e;return this.OAg?(e in jg.igf||(jg.igf[e]="AddinTab"+jg.t3k++),jg.igf[e]):e}}jg.xRd={};jg.igf={};jg.t3k=0;jg.m3k=0;Object(F.a)(jg,"DefaultRibbonNamingProvider",null,[1875]);class hi{bindAction(e,n){OfficeExt.DefaultControlActionBinder.bindAction(e,n)}}Object(F.a)(hi,"DefaultUIControlActionBinder",null,[1899]);
class xj{constructor(e){this.sCb=e}get command(){return this.sCb}gKb(e){e[zf.R0a]=this.command}}Object(F.a)(xj,"DefaultUIControlCommandBinder",null,[1897]);var xg=d(45);class fj{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(F.a)(fj,"AddInControl",null,[]);class dg{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(F.a)(dg,"AddInGroup",null,[]);class Nf{constructor(){this.iconLocation=
this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(F.a)(Nf,"AddInMenuItem",null,[]);class pg{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(F.a)(pg,"AddInTab",null,[]);class ye{constructor(e,n,C,S,ja,ya){this.cwd=new fb.a;this.CFc=this.I1a=this.F5b=null;this.r0e=e;this.H3b=n;this.a5b=C;this.yFh=S;this.hwd=ja;this.Wgh=ya}get hke(){return this.r0e}get CJ(){return this.cwd}get Ocf(){return this.H3b}get UVc(){return this.a5b}startBuildTab(e){const n=
e.isOfficeTab?e.id:this.hke.eNm(e.id),C=e.isOfficeTab?null:e.label;this.F5b=Object.assign(new pg,{id:n,title:C,isOfficeTab:e.isOfficeTab,visible:e.visible,groups:[],tabType:e.tabType,insertBefore:e.insertBefore,insertAfter:e.insertAfter,autoFocus:e.autoFocus})}startBuildGroup(e){const n=this.Omb(e.id);this.I1a=Object.assign(new dg,{id:n,mlrId:e.mlrId,title:e.label,controls:[],groupType:0})}addNativeGroup(e){this.I1a=Object.assign(new dg,{id:e.id,mlrId:e.mlrId,title:e.label,controls:[],groupType:1});
this.F5b.groups.push(this.I1a)}addButton(e){const n=this.Omb(e.id);n&&(this.NTc(n,e.action),E.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",e.actionType),e=Object.assign(new fj,{id:n,title:e.label,iconLocation:this.yJf(e),enabled:e.enabled,controlType:0,attributes:this.Ldc()}),this.Wgh.jMh(new xg.a(n,this.UVc.command.toString())),this.I1a.controls.push(e))}addNativeControl(e){e.id&&(E.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
e.actionType),e=Object.assign(new fj,{id:e.id,title:"",iconLocation:"",enabled:e.enabled,controlType:2,attributes:this.Ldc()}),this.I1a.controls.push(e))}startBuildMenu(e){const n=this.Omb(e.id);n&&(this.CFc=Object.assign(new fj,{id:n,title:e.label,iconLocation:this.yJf(e),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(e){const n=this.Omb(e.id);n&&(this.NTc(n,e.action),E.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",e.actionType),e=Object.assign(new Nf,
{id:n,title:e.label,iconLocation:this.yJf(e),enabled:e.enabled,attributes:this.Ldc()}),this.Wgh.jMh(new xg.a(n,this.UVc.command.toString())),this.CFc.menuItems.push(e))}endBuildMenu(){ld.c(this.CFc.id)||this.I1a.controls.push(this.CFc);this.CFc=null}endBuildGroup(){ld.c(this.I1a.id)||this.F5b.groups.push(this.I1a);this.I1a=null}endBuildTab(){ld.c(this.F5b.id)||this.cwd.add(this.F5b);this.F5b=null}Ldc(){const e={};this.gKb(e);return e}yJf(e){return e.icon["80"]?e.icon["80"]:e.icon["32"]}gKb(e){this.UVc.gKb(e)}Omb(e){return this.hke.qjc(e)}NTc(e,
n){this.Ocf.bindAction(e,n)}}Object(F.a)(ye,"OneLineRibbonExtensibilityCreator",null,[1893,1894]);class qh{constructor(e,n){this.QLc=e;this.H3b=new hi;this.a5b=new xj(n)}kgl(e){e=new Gf(e);return new Ae(e,this.a5b,this.H3b)}nhl(e,n,C,S){C=new jg(this.QLc,e,C,!0);return new ye(C,this.H3b,this.a5b,e,n,S)}}Object(F.a)(qh,"UIExtensibilityFactory",null,[1866]);class qg{createAddinDataProvider(e,n){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(e,n.CYa)}static get instance(){qg._instance||
(qg._instance=new qg);return qg._instance}}qg._instance=null;Object(F.a)(qg,"OSFAddinDataProviderFactory",null,[1874]);class dl{constructor(){this.Acc=null}setErrorMessageForAddin(e,n){this.Acc||(this.Acc={});this.Acc[e]=n}Irm(e){return this.Acc&&e in this.Acc?this.Acc[e]:null}}Object(F.a)(dl,"AddinCommandsErrorManager",null,[]);var Jk=d(127);class Ni{constructor(){this.Jfa=0;this.rUc=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.pOi=!1;this.Y3m=this.Gra=null}}Object(F.a)(Ni,
"AddInCommandsNotificationParameters",null,[]);class Wh{constructor(){this.K9g=this.TIe=null;this.TQi=(e,n)=>{let C=null;C=()=>{e.getIsUpgrading()?window.setTimeout(C,1E3):e.getUpgradingFailed()?re.Pwe(n,!0):G.AFrameworkApplication.ua.Ge()};window.setTimeout(C,1E3)}}get Pcf(){return this.TIe||(this.TIe=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set Pcf(e){this.TIe=e}get Sbl(){return this.K9g||(this.K9g=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(e,
n){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(e,n)}zUm(e,n,C,S,ja){E.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",e);if((e=n.gic(ja.ownerAddinInfo.storeType,ja.ownerAddinInfo.solutionId))&&e.RX&&!e.RX.getIsUpgrading())if(n=null,0<e.RX.getNotificationParams().length&&(n=this.EXh(e.RX.getNotificationParams()[0]))&&2147758681===n.errorCode&&(e.isUpgraded=!0),2!==e.RX.getStatus()&&(1!==e.RX.getStatus()||n&&2147758681===n.errorCode))n&&this.FTj(e,n,null);
else try{C.setOwnerAddinEToken(e.RX.getEToken()),ja.action(C,S.CYa)}catch(ya){E.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?ya.stack:ya.message)),Dc.ABg(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}FTj(e,n,C=null){const S=e.RX;if(1===S.getNotificationParams().length||n.pOi){const ja=n.rUc,ya=n.Gra;n.rUc=()=>{S.removeFirstNotification();
if(0<S.getNotificationParams().length){const kb=this.EXh(S.getNotificationParams()[0]);this.FTj(e,kb)}2147758681===n.errorCode&&(re.KUl(e.lC,S,this.TQi),mb.zUl(e.HWc,S,this.TQi));ja&&ja()};n.Gra=()=>{ya&&ya();C&&C()};Dc.a7o(n)}}EXh(e){const n=new Ni;n.Jfa=e.infoType;n.id=e.id;n.title=e.title;n.description=e.description;n.buttonText=e.buttonTxt;n.rUc=e.buttonCallback;n.pOi=e.highPriority;n.Gra=e.dismissCallback;n.errorCode=e.errorCode;n.Y3m=e.iframeNotificationUrl;return n}}Object(F.a)(Wh,"AddinCommandsActionHandler",
null,[1873]);var gh=d(1281);class th{constructor(){this.lH=this.Gcb=0;this.Yff=null;this.Dqe=this.RCe=0;this.chb=this.qSe=this.qJe=null}get wRd(){this.qJe||(this.qJe=new fb.a);return this.qJe}get IEf(){this.qSe||(this.qSe=new fb.a);return this.qSe}get sMb(){this.chb||(this.chb=new fb.a);return this.chb}}Object(F.a)(th,"AddinCommandsListLoaderContext",null,[]);class li{constructor(e,n){this.entitlement=e;this.metadata=n}Lzc(){var e=this.entitlement;const n={};n.solutionId=e.solutionId;n.version=e.version;
n.storeType=e.storeType;n.storeId=e.storeId;n.assetId=e.assetId;n.assetStoreId=e.assetStoreId;n.targetType=e.targetType;n.requireConsent=e.requireConsent||!1;n.isAddinCommands=!0;n.addinCommandsActionType=0;n.targetType=this.targetType;return n}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(F.a)(li,"AddinEntitlementEx",null,[]);class rg extends Sys.EventArgs{constructor(e){super();this.properties=e}}Object(F.a)(rg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class jj{constructor(e,n,C){this.jd=new eb.a;this.context=
new th;this.e$e=null;this.R_n=(S,ja,ya,kb)=>{S?(S=new li(ya.targetData,kb),ja&&this.context.wRd.add(S),10===this.context.Gcb&&(this.context.IEf.add(S),0===S.targetType&&this.context.sMb.add(S))):(ja=ya.targetData,E.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ja.solutionId,ja.storeType,ja.assetId,null,null,ja.storeId),ja.storeType));this.ucg()};this.contextActivationMgr=e;this.n3k=n;this.vRd=C;this.appName=G.AFrameworkApplication.J.jb("WebAppShortName")}get A_j(){this.e$e||
(this.e$e=new eh(this.jd));return this.e$e}o0k(e){this.jd.addHandler($b.a.XPh,e)}Jrp(e){null!==e&&(this.context.Gcb=e[$b.a.EHa],this.context.lH=e[$b.a.DHa],this.context.RCe=this.context.Dqe=0,e=$b.a.Dcc in e?e[$b.a.Dcc]:0,-1!==this.context.Gcb&&0!==this.context.lH&&(this.context.Yff=this.n3k.createAddinDataProvider(yg(this.context.Gcb),this.contextActivationMgr),this.context.Yff?this.context.Yff.getEntitlementsAsync(this.contextActivationMgr.CYa,!0,e,n=>{this.m0n(n)}):E.ULS.sendTraceTag(17638145,
220,10,"Create AddinDataProvider fails for {0}",this.context.Gcb)))}m0n(e){if(e&&0<e.length){this.context.RCe=e.length;const C=Wd();for(let S=0;S<e.length;S++){const ja=e[S];if(Ye()&&ja&&ja.storeType&&"omex"===ja.storeType.toLowerCase()&&ja.assetId&&C&&ja.assetId.toLowerCase()===C.toLowerCase()){var n={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:jj.l7(ja)};Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ad.a.iI(n)}))}!ja||1!==ja.targetType&&
-1!==ja.targetType?this.ucg():(n={},G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(n.solutionId=ja.solutionId,n.version=ja.version):(n.marketplaceId=ja.solutionId,n.marketplaceVersion=ja.version),n.storeType=ja.storeType,n.storeId=ja.storeId,n.targetData=ja,this.contextActivationMgr.isAddinCommandsExAsync(n,this.R_n))}}else this.ucg()}ucg(){var e;(e=this.context).Dqe=e.Dqe+1;this.context.Dqe>=this.context.RCe&&
(this.vRd.pMj(this.context.Gcb,!1),0<this.context.RCe&&10===this.context.Gcb&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(e=!1,Gc()&&(e=this.pEn(this.context.IEf)),this.wDn(this.context.IEf),e?this.oZa(this.r5h(this.context.wRd)):this.A_j.jAc(this.contextActivationMgr,this.context.wRd,this.context.sMb,(n,C)=>{const S=new fb.a;for(const ja of n)n=ja.Lzc(),C&&C.solutionId===ja.solutionId&&(n.showCallout=!0,this.A_j.O8j(C)),S.add(n);this.oZa(S)})):this.oZa(this.r5h(this.context.wRd)))}r5h(e){const n=
new fb.a;if(e)for(const C of e)n.add(C.Lzc());return n}oZa(e){e&&e.count||ia.uAb($b.a.Xff,"false",this.context.Gcb);e={["ack2"]:e};e[$b.a.EHa]=this.context.Gcb;e[$b.a.DHa]=this.context.lH;this.jd.raiseEvent($b.a.XPh,new rg(e),this)}pEn(e){let n=!1;if(e&&1>e.count)return n;const C=Wd();if(!C)return n;for(const S of e)if(S.storeId&&S.storeId.toLowerCase()===C.toLowerCase()||S.assetId&&S.assetId.toLowerCase()===C.toLowerCase())e={["SDX_Id"]:jj.zEi(S),["SDX_TargetType"]:ld.c(S.targetType)?"":S.targetType.toString()},
Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ad.a.iI(e)})),n=!0;return n}wDn(e){if(!(e&&1>e.count))if(this.vRd.Gnn()){var n=this.vRd.IGm();n?(e=this.gwi(e,n),E.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(e=this.gwi(e,null),E.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.vRd.xYo(e)}else E.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}gwi(e,n){const C={};let S=!1;for(const ja of e)if(e=
jj.zEi(ja))!n||e in n||(this.pP(ja,e),E.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===e.toLowerCase()?S||(S=!0,C[e]=null):C[e]=null;return C}pP(e,n){var C=e.installTimeInMS?(new Date(e.installTimeInMS)).toISOString():"";C={["SDX.Id"]:n,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ld.c(e.targetType)?"":e.targetType.toString(),["SDX.AdminDeploymentTime"]:C};Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Ad.a.iI(C)}));1===e.targetType&&(e={["SDX.Id"]:n,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ad.a.iI(e)})))}static l7(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}static zEi(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}}Object(F.a)(jj,
"AddInCommandsListLoader",null,[]);var Jl;(function(e){e[e.Pae=0]="inactive";e[e.background=1]="background"})(Jl||(Jl={}));Object(F.b)("AppBackgroundState",Jl);var Af=d(7),kl=d(130),xi=d(75),Eh=d(253);class Kj{}Kj.text=1;Kj.image=2;Kj.table=4;Object(F.a)(Kj,"ContentCatagory",null,[]);class Vi{}Object(F.a)(Vi,"AddinCommandsHost",null,[]);var Qh=d(173),Mh=d(74);class Ch extends Qh.a{constructor(){super(void 0,void 0,void 0,!0);this.nGc="AddinCommandsUILessDialog";this.Q$e="WACDialogTitleText";this.pwa=
"0";this.l1=380;this.YY=190;this.Ig=this.nGc;this.Bd=5;this.Drk=String.format("{0}px",this.l1);this.owa=String.format("{0}px",this.YY);this.BMi=this.Au=!1;this.cV()}cV(){super.cV();this.Jq.style.width=this.Drk;this.Jq.style.height=this.owa;this.Jq.style.padding=this.pwa}d_a(e){this.JN();document.getElementById(this.Bj(this.Q$e)).innerText=e}JN(){super.JN();this.Oc.style.width=String.format("{0}px",this.l1);this.Oc.style.height=String.format("{0}px",this.YY);this.Oc.removeAttribute(Mh.a.Wh);this.Oc.removeAttribute(Mh.a.Xja)}hide(){this.T$d()}get Hob(){return this.Jq}initializeAndShowWithTitle(){this.Uh(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(F.a)(Ch,"AddinCommandsUILessDialog",Qh.a,[1881]);class Al extends Vi{constructor(e,n){super();this.ui=e;this.xId=n}setOwnerAddinEToken(e){this.xId.eToken=e}showTaskpane(e,n,C){E.ULS.sendTraceTag(19507426,220,50,"ShowTaskpane action called.");n=this.Rgl(e,this.xId,n);n.addinCommandsActionType=2;this.ui.kSb(n);(e=this.ui.f8a(e.solutionId))?(C(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),G.AFrameworkApplication.J.isChangeGateEnabled("TelemetryForActiveAddinSuccessOnWordWacEnabled")&&
E.ULS.sendTraceTag(526410901,220,50,"ShowTaskpane: succeed to call.")):(E.ULS.sendTraceTag(19507427,220,10,"ShowTaskpane: instance id is null."),C(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}showDialog(){}createUILessSandbox(e,n,C){E.ULS.sendTraceTag(19509248,220,50,"UILess action called.");var S=e.solutionId,ja=this.xId.solutionId;const ya=this.getSharedRuntimeId(n,!0,S,ja);S=ya?ja:S;ja=this.ui.f8a(S);ja||(e=this.Tfl(e,this.xId),e.addinCommandsActionType=3,e.isForUILessAction=!0,
e.sharedRuntimeId=ya,e.solutionId=S,n=n.getDefaultDisplayName(),Al.gbc.W(e.id,new Ch),e.div=Al.gbc.K(e.id).Hob,this.ui.createUILessSandbox(S,n,e),ja=this.ui.f8a(S));ja?C(ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(E.ULS.sendTraceTag(19509249,220,10,"UILess: instance id is null."),C(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}disposeHost(){}Rgl(e,n,C){const S={};S.solutionId=e.solutionId;S.version=e.version;S.storeType=e.storeType;S.storeId=e.storeId;S.assetId=e.assetId;S.assetStoreId=
e.assetStoreId;S.targetType=OSF.OsfControlTarget.TaskPane;S.displayName=C.getDefaultDisplayName();S.ownerAddinSolutionId=n.solutionId;S.ownerAddinStoreType=n.storeType;S.isAddinCommands=!0;S.sharedRuntimeId=this.getSharedRuntimeId(C,!1,e.solutionId,n.solutionId);G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring")&&S.sharedRuntimeId&&(S.solutionId=S.ownerAddinSolutionId,S.storeType=S.ownerAddinStoreType);return S}getSharedRuntimeId(e,n,C,
S){if(!e)return null;const ja=gc.a.instance.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider");if(!ja)return null;if(n)return e.getSharedRuntimeId(ja.O_,n,null);C=(new jg("",S,ja,!0)).mci(C.substr(S.length));return e.getSharedRuntimeId(ja.O_,n,C)}Tfl(e,n){var C=Wc.a.create().toString();C=new jd.a(C,e.solutionId,e.version,e.storeId,e.storeType,{});C.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;C.osfControlType=OSF.OsfControlTarget.TaskPane;C.assetId=e.assetId;C.assetStoreId=
e.assetStoreId;C.ownerAddinSolutionId=n.solutionId;C.ownerAddinStoreType=n.storeType;C.isAddinCommands=!0;return C}static VNa(e){Al.gbc.tb(e)&&Al.gbc.K(e).initializeAndShowWithTitle()}static zKa(e){Al.gbc.tb(e)&&Al.gbc.K(e).hide()}}Al.gbc=new fd.a;Object(F.a)(Al,"Box4AddInCommandsHost",Vi,[]);class Rj{constructor(e){this.xKb=this.kea=this.Dq=this.lC=null;this.dDj=this.Nqg=0;this.EBb=this.appName=null;this.wcb=n=>{E.ULS.sendTraceTag(523319329,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
n?n.He:-1)};this.Tdf=e;this.appName=G.AFrameworkApplication.J.jb("WebAppShortName")||"Word"}static GetPrivacyCompliantId(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}b0n(){this.Dq&&this.xKb&&(this.Tdf.R9d({["SourceControlId"]:this.xKb}),E.ULS.sendTraceTag(529110620,220,50,"Launch addin command has been triggered"))}CBg(e,n){e=null;n?(e=n,this.Dq=e.Dq,(this.lC=e.lC)&&this.lC.GCa&&this.lC.GCa.CJ&&(this.kea=this.lC.GCa.CJ.K(0)),this.kea&&
this.kea.id?this.kea.isOfficeTab?(n=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),e=this.Dq.solutionId,e in n?this.xKb=n[e]:(E.ULS.sendTraceTag(529110622,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",Rj.GetPrivacyCompliantId(this.Dq)),this.xKb=this.GFf(this.lC)),this.xKb?"TabHome"===this.kea.id?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Pc.s1c(this.lC),()=>{this.rze(this.r9a(this.xKb))}):G.AFrameworkApplication.va.qa(T.a.S_a,
Ma.a.application,Object(ic.a)(this,this.S_a,"tabSwitch2")):(this.pP("NoEnabledButtonFound"),E.ULS.sendTraceTag(529110623,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.Zqc())):this.cVj(this.r9a(this.kea.id),0):(this.pP("NoTabFound"),E.ULS.sendTraceTag(529110621,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.Zqc())):this.Zqc()}S_a(e,n,C,S,ja){this.kea.id.includes(ja.NewContextId)&&(G.AFrameworkApplication.va.Fy(T.a.S_a,Ma.a.application,
Object(ic.a)(this,this.S_a,"tabSwitch2")),this.D1h(ja.NewContextId,G.AFrameworkApplication.J.jc("AddinMaxTabSwitchDetectionTimesForTeachingUI",10)));return 32}D1h(e,n){if(0>=n)this.pP("TabSwitchTimeOut");else{var C=document.querySelector("button"+this.r9a(e));C.hasAttribute("aria-selected")&&"false"!==C.getAttribute("aria-selected")?(window.clearTimeout(this.dDj),this.rze(this.r9a(this.xKb))):this.dDj=window.setTimeout(()=>{this.D1h(e,n-1)},1E3)}}r9a(e){return"[id="+e+"]"}cVj(e,n){n>G.AFrameworkApplication.J.jc("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.Nqg),this.zpd("[data-unique-id='pivotOverflowButton']"),E.ULS.sendTraceTag(529110624,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time")):document.querySelector("button"+e)?(window.clearTimeout(this.Nqg),this.zpd(e)):this.Nqg=window.setTimeout(()=>{this.cVj(e,n+1)},1E3)}rze(e){let n=document.querySelector("button[data-unique-id='RightPaddle']");if(n)this.pP("RightPaddlePresent");else if(n=document.querySelector("button"+e),!n||"none"===window.getComputedStyle(n).display)if(n=
document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!n){this.pP("NoAnchor");E.ULS.sendTraceTag(529110625,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.Zqc();return}this.qAb(n,"ShowTeachingUIForAddinButton")}zpd(e){let n=document.querySelector("button"+e);if(!n&&("[data-unique-id='pivotOverflowButton']"!==e&&(n=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!n)){this.pP("NoAnchor");E.ULS.sendTraceTag(529110626,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");
this.Zqc();return}this.qAb(n,"ShowTeachingUIForAddinTab")}qAb(e,n){e.setAttribute("lpp-id","latestAddin");const C=gc.a.instance.Ta("Common.ISystemInitiatedFeedback");C&&e?(C.execute(S=>{S.logActivity(n,null)}),this.pP("Show"),E.ULS.sendTraceTag(529110656,220,50,"triggerLPPActivity triggered an LPP activity")):(this.pP("NoSifFutureObject"),E.ULS.sendTraceTag(529110627,220,15,"triggerLPPActivity failed to get a sifFuture"),this.Zqc())}GFf(e){if(!e)return null;if((e=e.GCa)&&e.CJ&&0<e.CJ.count)for(const n of e.CJ)if(n.groups&&
0<n.groups.length)for(const C of n.groups)if(C.controls&&0<C.controls.length)for(const S of C.controls){if(S.attributes&&!S.controlType&&S.enabled)return S.id;if(S.menuItems)for(const ja of S.menuItems)if(ja.attributes&&ja.enabled)return S.id}return null}pP(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:[{name:"AppTeachingUICalloutAction",string:e},{name:"SDX.Id",string:Rj.GetPrivacyCompliantId(this.Dq)},{name:"AppTeachingUICalloutGoal",
string:"NewAdminDeployment"},{name:"SDX.AppInstallOrigin",string:"Organization"}]}))}zve(e){const n={},C={};C.LastTeachingUIShowTime=(new Date).toUTCString();C.AddinHasShown=e;n[this.appName]=Bf.c(C);this.EBb=new jf(this.appName,null,null,this.wcb),this.EBb.F1d(n),E.ULS.sendTraceTag(523319328,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Zqc(){this.zve(window.g_roamingAddinList)}}Object(F.a)(Rj,"AddinTeachingCalloutHandler",null,[]);
var qk=d(2033);class eg{constructor(e,n,C,S,ja,ya,kb,Rb=null){this.zNe=e;this.ek=n;this.b1a=C;this.rPa=S;this.MLk=ja;this.ui=ya;this.rl=Rb;this.ui&&this.ui.x1k(this.bsl.bind(this))}Ofl(e,n,C){if(e){switch(this.BKm(n,C)){case Kj.text:n="ContextMenuText";break;case Kj.image:n="ContextMenuImage";break;default:return}(n=this.zNe.lgl(n))&&e.push(n)}}qgi(e){let n;switch(e){case 22:var C=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;n=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:C=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;
n=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}C=new Jc.a(C,n,null);C.id=e;C.image=1;C.closeable=!0;G.AFrameworkApplication.ua.Gb.rya(C,!0)||E.ULS.sendTraceTag(36790731,306,10,"Failed to add entry to business bar. Addin disabled message could not be shown to user.")}AUb(e){E.ULS.sendTraceTag(19507423,220,50,"LaunchAddInCommands log: {0}",{["HostType"]:this.rPa.O_,["LaunchOperationType"]:e[$b.a.DHa]});if(G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")||
!G.AFrameworkApplication.K5a){var n=e[$b.a.uRd];if(n&&0<n.count){const ja=n.count;for(let ya=ja-1;0<=ya;ya--){const kb=n.K(ya);OSF.OsfControl.isFirstPartyStoreString(kb.storeType)||n.remove(n.K(ya))}n.count<ja&&G.AFrameworkApplication.ua&&(G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&!G.AFrameworkApplication.ua.Gb.z7(22)&&this.qgi(22),G.AFrameworkApplication.K5a||G.AFrameworkApplication.ua.Gb.z7(36)||this.qgi(36));if(!n.count)return}}let C=null;if(G.AFrameworkApplication.J.$("HostInstallAddInsIsEnabled")){const ja=
this;C=new Bi(this.rPa,this.zNe,new Zf(this.ek.value),new qh("",T.a.bcc),this.b1a,qg.instance,new dl,(ya,kb)=>{const Rb=new jd.a(Wc.a.create().toString(),ya.solutionId,ya.version,ya.storeId,ya.storeType,null);Rb.assetId=ya.assetId;Rb.assetStoreId=ya.assetStoreId;Rb.osfControlType=1;ja.ui.fVj(Rb,()=>{kb(ya)})})}else C=new Bi(this.rPa,this.zNe,new Zf(this.ek.value),new qh("",T.a.bcc),this.b1a,qg.instance,new dl);C.x0k(this.oWn.bind(this));C.p0k(this.c0n.bind(this));n=new Rj(this);C.L0k(n.b0n.bind(n));
C.S2k(n.CBg.bind(n));const S=this;this.MLk.continueWith(()=>{try{Jk.a.get_instance().Sk(10,null).continueWith(()=>{C.izn(S.rl,ib.StaticActiveAppFrame.za().ksa(),e)},3)}catch(ja){E.ULS.sendTraceTag(19507424,220,10,"LaunchAddInCommands failure log: {0}",{["HostType"]:S.rPa.O_,["ExceptionMessage"]:ja.message})}},11)}oWn(e,n){n?n?Ye()||Gc()?(e=gc.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper"))?e.VVf(()=>{gc.a.instance.Ta("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(C=>{C.B4d(n.Dq.solutionId)?
this.rOg(n):E.ULS.sendTraceTag(512274763,220,15,"No ref for current add-in.")})}):E.ULS.sendTraceTag(512274764,220,15,"initializeHelper isn't ready."):this.rOg(n):E.ULS.sendTraceTag(528544852,220,15,"agaveParams is null"):E.ULS.sendTraceTag(529110619,220,15,"No args for OnAutoLaunchAddin event")}vUm(e){var n=null;e&&(n=e[this.rPa.l7h]);if(n){if(e=(new Wh).Pcf(n))return G.AFrameworkApplication.K5a||OSF.OsfControl.isFirstPartyStoreString(e.ownerAddinInfo.storeType);n='Failed to look up ActionContext for buttonId "'+
n+'" in HandleAddInCommandsActionEnabled.'}else n="Failed to retrieve required buttonId property in HandleAddInCommandsActionEnabled.";E.ULS.sendTraceTag(561816859,306,10,n);return G.AFrameworkApplication.K5a}R9d(e){let n=null;e&&(n=e[this.rPa.l7h]);n?(e=new Wh,this.wQf(e,n)):E.ULS.sendTraceTag(561816861,306,10,"Failed to retrieve required buttonId property in HandleAddInCommandsAction.")}wQf(e,n){const C=e.Pcf(n);if(C){const S=new Al(this.ui,C.ownerAddinInfo);e.zUm(n,this.b1a,S,new Zf(this.ek.value),
C);qk.b.fCc()&&C.ownerAddinInfo&&qk.b.qTn(C.ownerAddinInfo)}else E.ULS.sendTraceTag(561816863,306,10,'Failed to look up ActionContext for buttonId "'+n+'" in HandleAddInCommandsActionInternal.')}pid(e){const n=fc.wlo(this.b1a);e[gh.a.Visible]=n.visible;e[gh.a.LabelText]=n.visible?n.labelText:""}Gxc(){}get tR(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}Tko(e){if(e&&$b.a.EHa in e)if(this.ui){var n=e[$b.a.EHa];this.tR?$b.a.zRd in e&&(e=e[$b.a.zRd],this.ui.ZYb(n,e),1===e&&this.iS(n,!0)):this.iS(n,!0)}else E.ULS.sendTraceTag(508625026,220,10,"queryAddinDetailsWithActionData: abort because _appsForOfficeUiActor is null.");else E.ULS.sendTraceTag(509695234,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}iS(e,n=!1){this.ui?(E.ULS.sendTraceTag(509695232,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",e,n),this.ui.iS(e,
n)):E.ULS.sendTraceTag(509695233,220,10,"QueryAddinDetails: abort because _appsForOfficeUiActor is null.")}Avc(e){E.ULS.sendTraceTag(19507425,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",e[$b.a.DHa],e[$b.a.EHa]);this.b1a.xSo();window.setTimeout(()=>{const n=new jj(new Zf(this.ek.value),qg.instance,dd.instance);n.o0k((C,S)=>{this.AUb(S.properties);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.iS(e[$b.a.EHa])});n.Jrp(e)},0)}eto(){if(this.b1a.xhe()){this.b1a.Z1h();var e=gc.a.instance.resolve("Wonca.AddInCommands.IAddInCommandsInitService").Ahm();if(e)for(const n of e)e={["ack1"]:n.key,["ack0"]:4,["ak0"]:(new Date).getTime()},this.Avc(e)}else G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(E.ULS.sendTraceTag(509695235,220,50,"RefreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.b1a.xhe()),
this.iS(10,!0),this.iS(0,!0))}v0b(e){Dc.ABg(e[$b.a.p3k].toString())}VNa(e){Al.VNa(e[$b.a.yRd].toString())}zKa(e){Al.zKa(e[$b.a.yRd].toString())}rOg(e){var n=e.Dq;const C=e.lC,S=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&n.solutionId in S)n=S[n.solutionId];else if(n.assetId in S)n=S[n.assetId];else if(n=this.Snm(C),void 0===n||null===n){E.ULS.sendTraceTag(528544853,
220,15,"addinCommandControlId is NullOrUndefined");return}this.R9d({["SourceControlId"]:n});e.Dq.isAutoLaunched=!0}Snm(e){if(!e)return E.ULS.sendTraceTag(528561871,220,10,"Failed to get button id for addin"),null;if((e=e.GCa)&&e.CJ&&0<e.CJ.count)for(const n of e.CJ){if(n.groups&&1===n.groups.length){e=n.groups[0];if(e.controls&&1===e.controls.length){const C=e.controls[0];if(C.attributes&&!C.controlType&&C.enabled)return C.id}e.controls&&E.ULS.sendTraceTag(528261908,220,15,"It has multiple buttons")}n.groups&&
E.ULS.sendTraceTag(528261909,220,15,"It has multiple groups")}return null}BKm(e,n){let C=0;if(!e||!n)return C;for(var S=0;S<n.ar();S++){if(n.ZB(S)){if(n.je()&&14===n.uf){C|=Kj.table;break}n.uc()}n.uc()}for(n=0;n<e.length;++n)if(S=e.K(n),S.contextId===Ma.a.Cd||S.contextId===Ma.a.paragraph||S.contextId===Ma.a.image)Af.ParagraphReader.Wb(S.node)?C=xi.a(S.node,5)?C|Kj.image:C|Kj.text:kl.a.Eq(S.node)&&(C|=Kj.image);return C}bsl(){this.b1a.Z1h()}Rbl(e){if(e&&e.solutionId){var n=gc.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper");
n?n.VVf(()=>{gc.a.instance.Ta("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(C=>{var S=e.solutionId,ja=C.B4d(S);ja?ja.sharedRuntimeId&&ja.backgroundState===Jl.background?this.Ebl(ja.sharedRuntimeId,S):(C=C.Rog(ja),(C=$b.a.WPh in C?C[$b.a.WPh]:null)&&"true"===C.toLowerCase()?(C=new Wh,ja=C.Sbl,ja=S in ja?ja[S]:null,S=Telemetry.PrivacyRules.GetPrivacyCompliantId(S,e.storeType,e.assetId,null,null,e.storeId),ja?(this.wQf(C,ja),E.ULS.sendTraceTag(22360455,220,100,"LaunchAddInCommands AutoShowTaskPane Success for app "+
S)):E.ULS.sendTraceTag(22360454,220,15,"LaunchAddInCommands AutoShowTaskPane: No TaskPane set to autoshow for app "+S)):E.ULS.sendTraceTag(22360453,220,50,"LaunchAddInCommands AutoShowTaskPane: Document settings don't set AddinCommandsAutoShowTaskPaneWithDocument = true.")):E.ULS.sendTraceTag(22360452,220,50,"LaunchAddInCommands AutoShowTaskPane failed for afoRefData is null.")})}):E.ULS.sendTraceTag(22360451,220,10,"LaunchAddInCommands AutoShowTaskPane failed for initializeHelper is null.")}else E.ULS.sendTraceTag(571248988,
220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid asset id.")}Ebl(e,n){const C=new Wh;(e=C.getTaskPaneControlIdFromSolutionIdRuntimeId(n,e))&&this.wQf(C,e)}c0n(e,n){Object(Eh.a)(ke,n);G.AFrameworkApplication.J.$("AddInCommandsAutoShowTaskPaneIsEnabled")&&(n?window.setTimeout(()=>{n.Dq&&this.Rbl(n.Dq)},0):E.ULS.sendTraceTag(21546839,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null.")));qk.b.fCc()&&n&&qk.b.rTn(this,n)}}Object(F.a)(eg,"AddInCommandsManager",null,[809]);
class qf extends eg{constructor(e,n,C,S,ja,ya,kb,Rb,sc){super(e,n,C,S,ja,ya,kb,Rb);this.AUm=()=>{gc.a.instance.Oa("WordEditor.IStatusBarUser").DXb();this.ize()};(this.sJe=C)&&this.sJe.q0k(this.AUm);rb.a.n6c=rb.a.wck;this.Aa=sc}Gxc(){this.ize()}ize(){const e=this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1);fc.ize(this.sJe,ib.StaticActiveAppFrame.za().ksa(),"AddInCommandsLoadStatus-Medium14",
e?WoncaIntl.WoncaStrings.L_TabHome:WoncaIntl.WoncaStrings.L_TabInsert,CommonUIStrings.L_ButtonOfficeAddins)}}Object(F.a)(qf,"WordEditorAddInCommandsManager",eg,[]);class kg{get name(){return"WordEditor.AddInCommands"}wc(e){this.Z=e;this.Z.ia("CommandUI.AddInCommands.ContextMenuExtensibilityCache",()=>new mb).ha();this.Z.ia("CommandUI.AddInCommands.AddinCommandsResourceManager",()=>G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddinResourceManagerGetInstance",!0)?Wa.getInstance():
new Wa).ha();this.Z.ia("CommandUI.AddInCommands.IAddinCommandsStringProvider",()=>new Rc).ha();this.Z.ia("Wonca.AddInCommands.IAddInCommandsManager",()=>new qf(e.resolve("CommandUI.AddInCommands.ContextMenuExtensibilityCache"),e.nf("Common.App.AppsForOfficeCommon.IContextActivationManager"),e.resolve("CommandUI.AddInCommands.AddinCommandsResourceManager"),e.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider"),e.resolve("Wonca.ICommandUiManager").QP,e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
e.resolve("Common.ISharedDependencyLoader"),e.resolve("Common.IExternalUICommandDefinitionMapping"),e.resolve("Common.IAppSettingsManager"))).ha();this.Z.ia("Wonca.AddInCommands.AddInCommandsActor",()=>new mc(G.AFrameworkApplication.va,e.resolve("Wonca.AddInCommands.IAddInCommandsManager"))).ha();this.Z.ia("Wonca.AddInCommands.IAddInCommandsInitService",()=>new Qb(G.AFrameworkApplication.va,G.AFrameworkApplication.ua.Vr)).ha()}init(){G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&(this.Z.resolve("Wonca.AddInCommands.AddInCommandsActor").Xb(),
this.Z.resolve("WordEditor.UI.EditSurfaceContextMenu").Mto(Object(ic.a)(this.Z.resolve("Wonca.AddInCommands.IAddInCommandsManager"),this.Z.resolve("Wonca.AddInCommands.IAddInCommandsManager").Ofl,"buildAddInCommandsContextMenuProps")),G.AFrameworkApplication.J.$("AddInCommandsLoadedInBootingIsEnabled")&&this.Z.resolve("Wonca.AddInCommands.IAddInCommandsInitService").Uqp())}dispose(){Dc.lVl()}static main(){G.AFrameworkApplication.hL||R.a.instance.Mc(new kg)}}Object(F.a)(kg,"PackageManager",null,[0,
1]);class Wi{constructor(e,n){this.yB=e;this.appId=n}}Object(F.a)(Wi,"ActivatedAfoData",null,[]);class ql{constructor(e,n,C,S,ja,ya,kb,Rb=!0,sc=null,Fc=0,gd=null,td=null){this.settings=null;this.Lnk=e;this.ADd=n;this.wKk=C;this.GJb=S;this.sW=ja;this.dNd=ya;this.dTc=kb;this.yP=null;this.isToBePersisted=Rb;this.sharedRuntimeId=sc;this.backgroundState=Fc;this.h4b=gd;this.gok=td}get GRh(){return this.Lnk}get instanceId(){return this.ADd}get Rn(){return this.wKk}get version(){return this.GJb}get store(){return this.sW}get storeType(){return this.dNd}get assetId(){return this.h4b}get assetStoreId(){return this.gok}get fma(){return"inmemory"===
this.storeType||this.yP&&!this.yP.fma||!this.isToBePersisted?!1:!0}RTh(e){return e.Rn.toLowerCase()===this.Rn.toLowerCase()&&e.store.toLowerCase()===this.store.toLowerCase()&&e.storeType.toLowerCase()===this.storeType.toLowerCase()}}Object(F.a)(ql,"AppsForOfficeReferenceData",null,[]);class hg{constructor(){this.awa=new fd.a}add(e,n){this.awa.tb(e.id)&&E.ULS.sendTraceTag(7143680,344,15,"instance Id {0} already exists when adding new activated apps for office info",e.id);n=new Wi(e,n);this.awa.W(e.id,
n)}fVa(e){return this.awa.tb(e)?this.awa.K(e).appId:(E.ULS.sendTraceTag(7143681,344,15,"instance Id {0} not exists when trying to get App Id",e),null)}eQb(e){for(const n of this.awa)if(e===n.value.appId)return n.key;return null}E1c(e){return this.awa.K(e).yB.addinCommandsActionType}SHf(e){e=this.awa.K(e).yB;const n=new ql(null,e.id,e.solutionId,e.version,e.storeId,e.storeType,!0,e.isToBePersisted);e.ownerAddinSolutionId&&(n.yP=new ql(e.ownerAddinSolutionId,e.ownerAddinSolutionId,e.ownerAddinSolutionId,
e.version,e.storeId,e.ownerAddinStoreType,!1,e.isToBePersisted,e.sharedRuntimeId,e.backgroundState,e.assetId,e.assetStoreId));return n}eOm(e){return this.awa.K(e).yB.onTaskPaneClose}KPb(e){return this.awa.K(e).yB.div}ipm(e){return this.awa.K(e).yB.customizedActionDic}$zi(e){const n=new fb.a;for(const C of this.awa){const S=C.value.yB;S.ownerAddinSolutionId&&e.toLowerCase()===S.ownerAddinSolutionId.toLowerCase()&&n.add(S.id)}return n}qim(e){const n=new fb.a;for(const C of this.awa){const S=C.value.yB;
S.ownerAddinSolutionId&&e.toLowerCase()===S.ownerAddinSolutionId.toLowerCase()&&n.add(C.value.appId)}return n}}Object(F.a)(hg,"ActivatedAfoDataManager",null,[24]);class Km{constructor(e,n,C,S,ja){this.fli=e;this.controlId=n;this.Uzb=C;this.handler=S;this.callback=ja}}Object(F.a)(Km,"EventRegistrationParams",null,[]);var zg=d(91);class Kd{constructor(e,n,C){this.Kuo=S=>{this.Gvj(S.ao,(ja,ya)=>{ja.addHandler(ya.controlId,ya.handler,ya.callback,ya.Uzb)})};this.Stp=S=>{this.Gvj(S.ao,(ja,ya)=>{ja.removeHandler(ya.controlId,
ya.callback,ya.Uzb)})};this.Jb=e;this.xwd=n;this.w8g=C}invokeDdaMethod(e,n,C){const S=e.DdaMethod.DispatchId,ja=this.xwd.p6k.XFf(S);ja?(ja.parameters=e,ja.callback=n,ja.z3k=C,ja.controlId=e.DdaMethod.ControlId,ja.Ek=this.w8g.SHf(ja.controlId),ja.customizedActionDic=this.w8g.ipm(ja.controlId),this.Fef(Object(ic.a)(ja,ja.go,"go"),null)):(E.ULS.sendTraceTag(5902750,341,10,"API Call for method ID {0} does not exist.",S),this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}registerDdaEventAsync(e,
n,C,S,ja){this.Fef(this.Kuo,new Km(e,n,C,S,ja))}unregisterDdaEventAsync(e,n,C,S,ja){this.Fef(this.Stp,new Km(e,n,C,S,ja))}getThrottleForCall(e){return this.xwd.q6k.QOm(e)}Fef(e,n){e=new zg.a(2,1,0,e,116);e.ao=n;this.Jb.$b(e)}Gvj(e,n){const C=this.xwd.o6k.ajc(e.fli);C?n(C,e):(E.ULS.sendTraceTag(5902751,341,10,"Event for dispatch ID {0} does not exist.",e.fli),this.zr(e.callback,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}YH(e){this.zr(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}zr(e,
n){if(e){var C={};C.Error=n;e(C)}}}Object(F.a)(Kd,"AppsForOfficeApiAdapter",null,[1212]);class Cg{constructor(){this.f4b=this.Z=null}wc(e){this.Z=e;e.register(hg,"Common.App.AppsForOfficeCommon.ActivatedAfoDataManager").as("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager").ha().Ud(()=>new hg);e.register(Kd,"Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter").as("Common.App.AppsForOfficeCommon.IHostApi").ha().Ud(()=>new Kd(G.AFrameworkApplication.pc,e.resolve("Common.App.AppsForOfficeCommon.ApiManager"),
e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager")))}init(){}dispose(){this.f4b&&(this.f4b.dispose(),this.f4b=null)}}Object(F.a)(Cg,"AppsForOfficeCommonPackage",null,[0,1]);var wl=d(1389);class Kl{constructor(e,n,C){this.Bnk=e;this.Ank=n;this.Cnk=C}get p6k(){return this.Bnk}get o6k(){return this.Ank}get q6k(){return this.Cnk}}Object(F.a)(Kl,"ApiManager",null,[1214]);var ae=d(83),pd=d(420),el=d(195),Yg=d(219);class rh extends pb.StandardDialog{constructor(e,n){super();this.Lah=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;
this.Zgh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.$gh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.W1e=!1;this.rdc=()=>{this.hide();this.W1e&&this.jVj()};this.nXn=()=>{Ac.a.instance.getItem("optedIntoAddinDeveloperMode")?(Ac.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.W1e=!1):(Ac.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.W1e=!0)};this.oXn=(C,S)=>{1===C&&S.optInCheckbox&&(Ac.a.instance.getItem("optedIntoAddinDeveloperMode")?Ac.a.instance.removeItem("optedIntoAddinDeveloperMode"):
(Ac.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.jVj()))};this.V1a=e;this.mGc=n}showDialog(e,n){this.Ig=void 0===this.Ig||null===this.Ig?Yg.a.Muc(0,Number.MAX_VALUE).toString():this.Ig;G.AFrameworkApplication.ua.Gb.kH?this.Zoo(e,n):this.bAn(e,n)}bAn(e,n){const C=new Qh.a(void 0,void 0,!1);C.Bd=0;C.Ig=Yg.a.Muc(0,Number.MAX_VALUE).toString();C.mh=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
n,this.$gh,this.Zgh,this.Lah);C.Uh(e,this.oXn,{optInCheckbox:!1})}Zoo(e,n){this.m3a=this.rdc;this.show({["type"]:"StandardDialogProps",["id"]:this.Ig,["dialogIcon"]:3,["headerText"]:e,["titleText"]:n,["resultHandler"]:this.m3a,["messageAreaLink"]:this.zJl(),["permanentDismissCheckbox"]:this.wJl(),["renderMicrosoftLogoInHeader"]:!1})}zJl(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.Zgh,["handler"]:{["href"]:this.$gh,["target"]:"_blank"},["onExecute"]:null}}wJl(){return{["type"]:"AppCheckboxProps",
["id"]:"WACDialogOptInCheckbox",["label"]:this.Lah,["onExecute"]:this.nXn}}jVj(){const e=new pb.StandardDialog;e.Bd=4;const n=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.V1a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;e.lV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,n,this.mGc)}}Object(F.a)(rh,"AppsForOfficeDeveloperModeOptInDialog",pb.StandardDialog,[]);var Mf=
d(134);class mi{constructor(e,n){this.V1a=this.zzd=null;this.wAj=C=>{1===C&&this.V1a&&this.xuo()};this.S1=e;this.lia=n}initialize(){this.lia&&(this.lia.initialize(),this.e7o())}e7o(){if(this.lia){var e=this.lia.xsi();if(e){for(let C=0;C<e.count;C++){var n=!OSF.OsfControl.isFirstPartyStoreString(e.K(C).storeType);if(G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&n)G.AFrameworkApplication.ua&&!G.AFrameworkApplication.ua.Gb.z7(22)&&(n=new Jc.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,
CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),n.id=22,n.image=1,n.closeable=!0,G.AFrameworkApplication.ua.Gb.rya(n,!0)||E.ULS.sendTraceTag(36790730,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user."));else if(e.K(C).dTc||"registry"===e.K(C).storeType)if(n=new jd.a(e.K(C).instanceId,e.K(C).Rn,e.K(C).version,e.K(C).store,e.K(C).storeType,e.K(C).settings),n.assetId=e.K(C).assetId,n.assetStoreId=e.K(C).assetStoreId,n.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,
n.osfControlType=1,G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")){const S={};G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(S.solutionId=n.solutionId,S.version=n.version):(S.marketplaceId=n.solutionId,S.marketplaceVersion=n.version);S.storeType=n.storeType;S.storeId=n.storeId;S.targetData=n;this.S1.K2i(S,(ja,ya,kb)=>{const Rb=kb.targetData;if(!ya)this.S1.showTaskPane(Rb.solutionId,null,Rb);else if(G.AFrameworkApplication.J.$("InstallVisibleAddinCommandsEnabled")){if("omex"!==
S.storeType.toLowerCase())return;let sc=!1;this.gng(Fc=>{if(!Fc[$b.a.o3k]){if(Fc[$b.a.$Ph])for(const gd of Fc[$b.a.$Ph])if(sc=Mf.e(gd[1])===Mf.e(Rb.solutionId))break;sc||this.S1.NLh(Rb)}})}ja||E.ULS.sendTraceTag(542978530,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Rb.solutionId,Rb.storeType,Rb.assetId,null,null,Rb.storeId),Rb.storeType)})}else this.S1.showTaskPane(e.K(C).Rn,null,n)}this.Grp()}}}gng(e){const n={};n.callback=e;G.AFrameworkApplication.va.Qb(T.a.lYb,
2,n)}xsb(e){if(this.lia){var n=new ql(e.id,e.id,e.solutionId,e.version,e.storeId,e.storeType,!0,e.isToBePersisted,null,0,e.assetId,e.assetStoreId);e.ownerAddinSolutionId&&(n.yP=new ql(e.ownerAddinSolutionId,e.ownerAddinSolutionId,e.ownerAddinSolutionId,e.version,e.storeId,e.ownerAddinStoreType,!1,e.isToBePersisted));this.lia.xsb(n)}}DUf(e,n,C,S){this.lia&&(S=new ql(S.id,S.id,S.solutionId,S.version,S.storeId,S.storeType,!0),this.lia.DUf(e,n,C,S))}hVl(e){this.lia&&(e=this.lia.A4d(e))&&(e.dTc=!1,this.lia.pSo(e))}dispose(){this.S1&&
(this.S1.dispose(),this.S1=null);this.lia&&(this.lia.dispose(),this.lia=null)}Grp(){this.V1a=G.AFrameworkApplication.J.jb("DevAddinManifestFileUrl");this.zzd=G.AFrameworkApplication.J.jb("DevAddinManifestGuid");var e=G.AFrameworkApplication.J.jb("IsDevAddinTest");if(this.V1a&&this.zzd&&e){e="true"===e;var n=Ac.a.instance.getItem("optedIntoAddinDeveloperMode");const C=Ac.a.instance.getItem(this.zzd);n||e&&G.AFrameworkApplication.J.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?C||
e&&G.AFrameworkApplication.J.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?this.S1.yt.validateAndCacheNewDevAddinManifest(this.V1a):(e=new pb.StandardDialog,e.Bd=4,n=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.V1a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,e.lV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,n,this.wAj)):(e=new rh(this.V1a,this.wAj),
e.Bd=0,e.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}xuo(){this.S1.yt.validateAndCacheNewDevAddinManifest(this.V1a);Ac.a.instance.setItem(this.zzd,"true")}}Object(F.a)(mi,"AppsForOfficeManager",null,[1210,10]);class Ag{constructor(e,n){this.hostControl=e;this.controlStatusChanged=n.pim();this.notifyHost=n.Jnk}}Object(F.a)(Ag,"HostControlInfo",null,[]);class Hf{constructor(e){this.Pkb=e}create(){return new OSF.ContextActivationManagerBuilder(this.Pkb.gzi(),
this.Pkb.iBi())}}Object(F.a)(Hf,"ContextActivationManagerBuilderFactory",null,[1206]);var Pg=d(280);class bk{constructor(e,n,C){this.Erb=S=>{try{if(S&&S.rawEvent&&S.rawEvent.origin&&this.URb&&this.URb.id){var ja=this.Erj(S.rawEvent.origin);const ya=this.Erj(document.domain);if(Pg.a.vh().equals(ya,ja))if(S.rawEvent.source&&S.rawEvent.source.frameElement&&S.rawEvent.source.frameElement.id&&Pg.a.vh().equals(S.rawEvent.source.frameElement.id,this.URb.id)){ja=null;try{ja=JSON.parse(S.rawEvent.data)}catch(kb){E.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",kb.message)}ja?(ja.statusCode!==Y.a.qz||void 0!==ja.error&&ja.error?(E.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ja.statusCode,ja.error),this.onError()):(E.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.zE(ja.authorizationCode?ja.authorizationCode:
ja.signInUrl)),$removeHandler(window,"message",this.Erb),this.URb?document.body.contains(this.URb)?document.body.removeChild(this.URb):E.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):E.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):E.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else E.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else E.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else E.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(ya){E.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",ya.message)}};this.URb=e;this.zE=n;this.onError=C;$addHandler(window,"message",this.Erb)}Erj(e){let n="";try{e&&(n=-1<e.indexOf("//")?e.split("/")[2]:
e.split("/")[0])&&(n=n.split(":")[0],n=n.split("?")[0])}catch(C){E.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",C.message)}return n}static rF(e,n,C){new bk(e,n,C)}}Object(F.a)(bk,"ResponseHandler",null,[]);var Sj=d(203);class gj{constructor(e){this.PJb=e}tryAuthenticate(e,n){this.vpe(gj.$yk,()=>{e()},n)}tryAuthorize(e,n){this.vpe(gj.Aok,e,n)}getSignInUrl(e,n){this.vpe(gj.jFh,e,n)}signOut(e,n){this.vpe(gj.aOk,e,n)}vpe(e,n,C){var S=new Sj.QueryStringBuilder("AuthenticationProxyHandler.aspx");
S.Ae("responseType",e);G.AFrameworkApplication.Mja(S);S=String.format("{0}{1}&{2}",this.PJb,S.toString(),G.AFrameworkApplication.rm);const ja=document.createElement("iframe");ja.setAttribute("id","privateCatalogIframe");ja.setAttribute("name","privateCatalogIframe");ja.setAttribute("style","display: none");Pg.a.vh().equals(e,gj.jFh)||ja.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");bk.rF(ja,n,C);ja.setAttribute("src",S);document.body.appendChild(ja)}}
gj.Aok="authcode";gj.$yk="identitytoken";gj.jFh="signinurl";gj.aOk="signout";Object(F.a)(gj,"AuthenticationProxy",null,[]);class Yi{}Yi.getUserId="getUserId";Yi.getLastStoreUpdate="laststoreupdate";Yi.getEntitlement="getEntitlements";Yi.getEToken="getEToken";Yi.getManifest="getManifest";Yi.getAppState="getAppState";Yi.getKilledApps="getRemovedAddins";Yi.getAppDetails="getAppDetails";Yi.removeApps="removeAddin";Yi.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Yi.getPrivateCatalogAddIns=
"getAddIns";Yi.getPrivateCatalogManifests="getAppManifests";Yi.isStoreDisabled="isStoreDisabled";Object(F.a)(Yi,"S2SWebRequestActions",null,[]);var Bl=d(1054);class Ll{getUserId(e,n){const C=new fb.a;C.add(new Vf.a("corr",e));this.Hs(Yi.getUserId,C,1,n)}getLastStoreUpdate(e,n,C){const S=new fb.a;S.add(new Vf.a("lc",e));S.add(new Vf.a("corr",n));this.Hs(Yi.getLastStoreUpdate,S,1,C)}getEntitlement(e,n,C,S){e=new fb.a;e.add(new Vf.a("av",n));e.add(new Vf.a("corr",C));this.Hs(Yi.getEntitlement,e,1,S)}getEToken(e,
n,C,S,ja,ya){const kb=new fb.a;kb.add(new Vf.a("cmu",e));kb.add(new Vf.a("cmf",n));kb.add(new Vf.a("assetid",C));kb.add(new Vf.a("expver",S));kb.add(new Vf.a("corr",ja));this.Hs(Yi.getEToken,kb,1,ya)}getManifest(e,n,C,S){const ja=new fb.a;ja.add(new Vf.a("cmu",e));ja.add(new Vf.a("assetid",n));ja.add(new Vf.a("corr",C));this.Hs(Yi.getManifest,ja,1,S)}getAppState(e,n,C){const S=new fb.a;S.add(new Vf.a("ma",e));S.add(new Vf.a("corr",n));this.Hs(Yi.getAppState,S,1,C)}getKilledApps(e,n){const C=new fb.a;
C.add(new Vf.a("corr",e));this.Hs(Yi.getKilledApps,C,1,n)}getAppDetails(e,n,C,S){const ja=new fb.a;ja.add(new Vf.a("cmo",e));ja.add(new Vf.a("corr",C));this.sendWithBody(Yi.getAppDetails,ja,n,2,S,!1)}removeApps(e,n,C){const S=new fb.a;S.add(new Vf.a("corr",n));this.sendWithBody(Yi.removeApps,S,e,2,C,!1)}getLastPrivateCatalogUpdate(e,n,C,S,ja,ya){const kb=new fb.a;kb.add(new Vf.a("catalog","privatecatalog"));kb.add(new Vf.a("clientCode",e));kb.add(new Vf.a("clientVersion",n));kb.add(new Vf.a("corr",
ja));e=String.format("authorizationCode={0}&refreshToken={1}",C?Of.a.$i(C):"",S?Of.a.$i(S):"");this.sendWithBody(Yi.getLastPrivateCatalogUpdate,kb,e,2,ya,!0)}getPrivateCatalogAddIns(e,n,C,S,ja,ya){const kb=new fb.a;kb.add(new Vf.a("catalog","privatecatalog"));kb.add(new Vf.a("clientCode",e));kb.add(new Vf.a("clientVersion",n));kb.add(new Vf.a("corr",ja));e=String.format("authorizationCode={0}&refreshToken={1}",C?Of.a.$i(C):"",S?Of.a.$i(S):"");this.sendWithBody(Yi.getPrivateCatalogAddIns,kb,e,2,ya,
!0)}getPrivateCatalogManifests(e,n,C,S,ja){const ya=new fb.a;ya.add(new Vf.a("catalog","privatecatalog"));ya.add(new Vf.a("corr",S));e=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Of.a.$i(e),n?Of.a.$i(n):"",C?Of.a.$i(C):"");this.sendWithBody(Yi.getPrivateCatalogManifests,ya,e,2,ja,!0)}isStoreDisabled(e,n){const C=new fb.a;C.add(new Vf.a("corr",e));this.Hs(Yi.isStoreDisabled,C,2,n)}Hs(e,n,C,S){this.sendWithBody(e,n,null,C,S,!1)}sendWithBody(e,n,C,S,ja,ya){const kb=new Sj.QueryStringBuilder("AddinServiceHandler.ashx");
kb.Ae("action",e);kb.Ae("app",Bl.a[G.AFrameworkApplication.ua.Gb.Mk]);for(const Rb of n)kb.Ae(Rb.key,Rb.value);n=String.format("{0}{1}&{2}",G.AFrameworkApplication.ua.Gb.gYa,kb.toString(),G.AFrameworkApplication.rm);G.AFrameworkApplication.Fe.Xj(n,S,C,null,!1,2,Rb=>{let sc=null,Fc=null;Rb&&Rb.data&&(Rb.data.wi["X-BlockedForMinor"]&&"1"===Rb.data.wi["X-BlockedForMinor"].toString()&&(Rb.data.He=451),sc=Rb.data.Pe,Fc=Rb.data.wi);ja(Rb.data.He,sc,Fc)},Rb=>{var sc=null;let Fc=null;ya&&Rb&&Rb.data&&Rb.data.Pe&&
(sc=Rb.data.Pe,Fc=Rb.data.wi);ja(Rb.data.He,sc,Fc);if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){sc={message:"AddinServiceHandler request failed"};sc.code=Rb.data.He;sc.action=e;if(Rb.data.request||Rb.data.request.get_headers())sc["X-UserSessionId"]=Rb.data.request.get_headers()["X-UserSessionId"];408===Rb.data.He||503===Rb.data.He?E.ULS.sendTraceTag(538784582,220,10,JSON.stringify(sc)):E.ULS.sendTraceTag(18392345,220,50,JSON.stringify(sc))}else E.ULS.sendTraceTag(538736349,
220,50,"S2S web request failed with {0}.",Rb.data.He)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+e,void 0,void 0,void 0,["X-UserKey"])}}Object(F.a)(Ll,"S2SWebRequestManager",null,[]);class fn{constructor(e,n,C){this.oyd=null;this.ZDc=e;this.Pkb=n;this.Gyk=C}create(){if(!this.oyd){G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AppsForOfficeServerToServerIsEnabled")&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ll);G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled")&&
OfficeExt.PrivateCatalogService.initRequestHandler(new Ll,new gj(G.AFrameworkApplication.J.appSettings.WebServiceBase),G.AFrameworkApplication.J.$("PrivateCatalogThirdPartyHostsEnabled"),G.AFrameworkApplication.J.$("PrivateCatalogIsResultCodesEnabled"));"undefined"!==typeof OfficeExt.MosRequestHandler&&"undefined"!==typeof OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Ll);"undefined"!==typeof OfficeExt.ProxyBasedCatalogService&&"undefined"!==typeof OfficeExt.ProxyBasedCatalogService.initRequestHandler&&
OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ll);const e=this.oyd=this.ZDc.setHostInfo(this.Pkb.gzi()).setLocaleInfo(this.Pkb.iBi()).setUrlInfo(this.Pkb.yQm()).setMiscellaneousActivationParameters(this.Pkb.rAm()).setHostControlInfo(this.Gyk).setUserInfo(this.Pkb.KQm()).construct();void 0!==e&&null!==e&&"undefined"!==typeof e.hostCheckReadyHandler?G.AFrameworkApplication.K0k(Object(ic.a)(e,e.hostCheckReadyHandler,"hostCheckReadyHandler")):E.ULS.sendTraceTag(594613527,1403,15,"ContextActivationManager or its hostCheckReadyHandler is null")}return this.oyd}}
Object(F.a)(fn,"ContextActivationManagerFactory",null,[1209]);var Yn=d(1953),Tl=d(1954),jm=d(1955),Kk=d(1767),gn=d(1768),io=d(1952),rl=d(728),vm=d(140);class Lj{constructor(e,n,C){this._id=e;this.Pmk=n;this.Xqk=C;this.kUi=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get zKb(){return this.Pmk}get Mvl(){return this.Xqk}execute(e,n,C){C=C||{};C.commandMode=this.kUi;n.invokeAppCommand(this.zKb,this.Mvl,C,()=>{e.P0n(this.id)})}}Object(F.a)(Lj,"AddinNativeActionBase",null,[859]);class wm extends Lj{constructor(e,
n){super(1,e,n);this.kUi=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(F.a)(wm,"AddinTakeSnapshotAction",Lj,[]);class aj{wDl(e){return new Lj(3,e,this.Mgm().getNativeActionName(3))}Mgm(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(F.a)(aj,"AddinNativeActionManager",null,[837]);class sl{invokeAppCommand(e,n,C,S){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(e,n,C,S)}static getInstance(){sl._instance||(sl._instance=new sl);return sl._instance}}sl._instance=
null;Object(F.a)(sl,"OSFAddinCommandsRuntimeManager",null,[836]);var yi=d(200),Dk=d(17);class fi extends Qh.a{constructor(e,n,C){super();this.LSa=null;this.Q$e="WACDialogTitleText";this.pwa="0";this.RPa="15px";this.Crk="0px";this.owa="calc(100% - 30px)";this.Brk="100%";this.jBh=0;this.sa=new eb.a;this.Rmk=new aj;this.Bd=5;this.Ig=this.nGc=C;this.iPe=e;this.weh=n;this.DQe=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("OfficeAddinEnableInsertDialogAccessibilityFix")}pff(e){this.sa.addHandler("OnDialogClosedEventKey",
e)}IDj(e){this.sa.removeHandler("OnDialogClosedEventKey",e)}hXo(){this.m3a=null}cV(){super.cV();this.Jq.style.width="100%";this.Jq.style.height=this.Y5c?this.owa:this.Brk;this.Jq.style.marginTop=this.Y5c?this.RPa:this.Crk;this.Jq.style.padding=this.pwa}JN(){super.JN();this.Oc.style.width=String.format("{0}px",this.iPe*window.innerWidth/100);this.Oc.style.height=String.format("{0}px",this.weh*window.innerHeight/100);this.Oc.style.minWidth="0px";this.DQe&&G.AFrameworkApplication.isRtl&&100===this.iPe&&
(this.Oc.style.right="0px",this.Oc.style.marginRight="0px");this.LSa=document.getElementById(this.Bj(this.Q$e));this.LSa.style.position="absolute";this.LSa.style.whiteSpace="nowrap";this.LSa.style.textOverflow="ellipsis";G.AFrameworkApplication.isRtl?(this.LSa.style.right="14px",this.LSa.style.left="44px"):(this.LSa.style.right="44px",this.LSa.style.left="14px")}d_a(e){super.d_a(e);this.LSa&&this.LSa.setAttribute("title",e)}get Hob(){return this.Jq}ptg(){this.Oc.style.width=String.format("{0}px",
this.iPe*window.innerWidth/100);this.Oc.style.height=String.format("{0}px",this.weh*window.innerHeight/100);this.Oc.style.overflowY="hidden";this.Oc.style.overflowX="hidden";this.Oc.style.marginTop="";this.Oc.style.top="";Dk.a.ABa&&G.AFrameworkApplication.isRtl?(this.Oc.style.right="",this.Oc.style.marginRight=""):(this.Oc.style.left="",this.Oc.style.marginLeft="")}hide(){this.Rmk.wDl(this.nGc).execute(this,sl.getInstance(),{});this.jBh=window.setTimeout(()=>{this.sa.raiseEvent("OnDialogClosedEventKey",
this.nGc);yi.a.prototype.hide.call(this)},500)}P0n(e){3===e&&(window.clearTimeout(this.jBh),this.sa.raiseEvent("OnDialogClosedEventKey",this.nGc),super.hide())}}Object(F.a)(fi,"AppsForOfficeDialog",Qh.a,[825,826]);class Dg{constructor(){this.dialog=this.Ig=null}}Object(F.a)(Dg,"DialogInfo",null,[]);class yk{}yk.url="url";yk.height="height";yk.width="width";yk.cxf="displayInIframe";yk.W$d="hideTitle";Object(F.a)(yk,"DialogSettings",null,[]);class Ym{constructor(){this.height=this.width=0;this.Ig=this.controlId=
this.pageUrl=null;this.W$d=this.cxf=!1}}Object(F.a)(Ym,"DisplayDialogParams",null,[]);class we extends Sys.EventArgs{constructor(e,n,C=null,S="",ja=""){super();this.controlId=e;this.messageType=n;this.messageContent=C;this.$7f=S;this.Keb=ja}}Object(F.a)(we,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class ri extends Sys.EventArgs{constructor(e,n,C=null,S="",ja=""){super();this.controlId=e;this.messageType=n;this.messageContent=C;this.$7f=S;this.Keb=ja}}Object(F.a)(ri,"OnMessageParentEventArgs",Sys.EventArgs,
[]);var Tj=d(118);class vf{constructor(e){this.sa=new eb.a;this.qYn=(n,C)=>{if(n=this.qjc(C))this.ek.purgeDialogControl(C),vf.sPa.remove(n),this.sa.raiseEvent("OnMessageParentEventKey",new ri(n,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.ek=e}I1k(e){this.sa.addHandler("OnMessageParentEventKey",e)}QDj(e){this.sa.removeHandler("OnMessageParentEventKey",e)}H1k(e){this.sa.addHandler("OnMessageDialogEventKey",e)}mCo(e){this.sa.removeHandler("OnMessageDialogEventKey",e)}showDialog(e,n,C,S){if(vf.sPa.tb(n))E.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),C(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const gd=Bf.b(e),td=gd[yk.url];if(this.ek.getOsfControl(n).checkAppDomains(td)){var ja=new Ym;ja.width=gd[yk.width];ja.height=gd[yk.height];ja.pageUrl=td;ja.cxf=gd[yk.cxf];ja.W$d=gd[yk.W$d];ja.controlId=n;ja.Ig=Tj.a.create().toString();var ya=new Dg;ya.Ig=ja.Ig;var kb=this.ek.getOsfControl(ja.controlId).getManifest().getDefaultDisplayName(),Rb=this.ek.getOsfControl(ja.controlId).getStoreType().toLowerCase();
e=null;e=(4===G.AFrameworkApplication.ua.Gb.Mk&&"hardcodedpreinstall"===Rb||"sdxcatalog"===Rb)&&ja.W$d?this.createAndShowAppsForOfficeDialog(ja.width,ja.height,ja.Ig,!0,kb):this.createAndShowAppsForOfficeDialog(ja.width,ja.height,ja.Ig,!1,kb);var sc=this.ek.getOsfControl(ja.controlId),Fc=sc.getManifest();n={};n.id=ja.Ig;n.solutionId=sc.getSolutionId();n.version=sc.getVersion();n.storeType=Rb;n.storeId=sc.getStoreId();n.assetId=sc.getAssetId();n.assetStoreId=sc.getAssetStoreId();n.ownerAddinSolutionId=
sc.getOwnerAddinSolutionId();n.ownerAddinStoreType=sc.getOwnerAddinStoreType();n.appDomains=Fc.getAppDomains();n.dialogUrl=td;n.osfControlType=1;n.agaveName=kb;n.div=e.Hob;E.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(n.solutionId,n.ownerAddinStoreType||n.storeType,n.assetId,null,null,n.storeId),Of.a.HT(ja.pageUrl));this.ek.insertDialogControl(n);e.pff(this.qYn);ya.dialog=e;vf.sPa.W(ja.controlId,ya);S&&S(n);C(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else E.ULS.sendTraceTag(19940611,
344,10,"ShowDialog: dialog url not in app domains list."),C(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(gd){E.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",gd.message),C(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}WNn(e,n,C,S){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===S&&(S=C);try{const ja=this.qjc(e);ja&&this.sa.raiseEvent("OnMessageParentEventKey",new ri(ja,
OSF.DialogMessageType.DialogMessageReceived,n,C,S))}catch(ja){return E.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ja.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}$ya(e,n){if(vf.sPa.tb(e))try{const C=vf.sPa.K(e);C.dialog&&C.dialog.hide();this.ek.purgeDialogControl(C.Ig);vf.sPa.remove(e);n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(C){E.ULS.sendTraceTag(18371106,344,
10,"CloseDialog: action failed. Exception message: {0}",C.message),n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else E.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}iQo(e,n,C,S){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===S&&(S=C);if(vf.sPa.tb(e)&&(e=vf.sPa.K(e),e.dialog))try{this.sa.raiseEvent("OnMessageDialogEventKey",
new we(e.Ig,OSF.DialogMessageType.DialogParentMessageReceived,n,C,S))}catch(ja){E.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",ja.message)}}qjc(e){let n=null;for(const C of vf.sPa)if(C.value.Ig===e){n=C.key;break}return n}createAndShowAppsForOfficeDialog(e,n,C,S,ja){e=new fi(e,n,C);ja=S?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,ja);S&&(e.Y5c=!1,e.Au=!1);e.Uh(ja,null,null);e.hXo();return e}static BSm(){return vf.sPa}static getInstance(e){vf._instance||
(vf._instance=new vf(e));return vf._instance}}vf._instance=null;vf.sPa=new fd.a;Object(F.a)(vf,"AppsForOfficeDialogManager",null,[27]);class ff{constructor(e,n,C){this.ek=this.hKe=null;this.ui=n;this.l9=C}get contextActivationMgr(){!this.ek&&this.ui&&(this.ek=this.ui.yt);return this.ek}get u7a(){this.hKe||(this.hKe=vf.getInstance(this.contextActivationMgr));return this.hKe}showDialog(e,n,C){try{this.u7a.showDialog(n,e,C,S=>{this.l9.add(this.Nfl(S),S.id)})}catch(S){E.ULS.sendTraceTag(19670552,344,
10,"ShowDialogApiHelper: show dialog failed. Exception message: {0}",S.message),C(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Kdj(e,n,C,S){return this.u7a.WNn(e,n,C,S)}$ya(e,n){this.u7a.$ya(e,n)}VNa(e){return this.ui.VNa(e)}zKa(e){return this.ui.zKa(e)}sendMessage(e,n,C,S){this.u7a.iQo(e,n,C,S)}Nfl(e){return e?new jd.a(e.id,e.solutionId,e.version,e.storeId,e.storeType,null):null}}Object(F.a)(ff,"ShowDialogApiHelper",null,[1573]);var Kf=d(50),Rg=d(346),ob=d(237),Nb=d(559),cc=d(240),Lc=d(1791),
Uc=d(254),sd=d(107),id=d(272),Ld=d(39),ne=d(347),kf=d(344),vg=d(54),Sh=d(511),Ei=d(967),pj=d(36),Ed=d(6),ni=d(115),Ee=d(13),hh=d(1008),Mj=d(730);class Bj{constructor(e,n){this.Dk=e;Bj.zlb=n}J$m(e,n,C,S){const ja=Tj.a.create(),ya=new kf.DictionaryPropertySet;ya.setValue(Ee.a.zta,vg.a.hn(n,0));ya.setValue(Ee.a.yta,vg.a.hn(C,1));ya.setValue(Ld.a.U_,hh.a.ZOa);C=e.view;n=new pj.GraphTransaction(15);n.Ab(C.vd);C=null;const kb=({bWb:C}=this.Dk.Qgi(e,ya,ja)).returnValue;if(!kb)return null;var Rb=new Ed.a;
Rb.set(kb.node);Rb=this.K$m(Rb,S);n.dispose();C&&e.view.lb.Kc(C);Bj.zlb&&Bj.zlb.Ssf(e,ya,S,kb.node,Rb.id.toString(),kb.blob,ja);return Rb}K$m(e,n){if(!e||!e.currentNode||19!==e.uf)return null;const C=new Mj.a,S=new kf.DictionaryPropertySet;S.setValue(Ld.a.dQh,n.id);S.setValue(Ld.a.gQh,n.version);S.setValue(Ld.a.eQh,n.store);S.setValue(Ld.a.fQh,n.storeType);C.setValue(Ld.a.$lc,20);C.setValue(Ld.a.zKb,n.instanceId);C.setValue(Ld.a.cQh,S);C.setValue(Ld.a.aQh,n.isContent);e.Wf(C,2);e.Yj(C);return C}saveSettings(e,
n,C){var S=e.ka(Ld.a.cgf,null);let ja=0;var ya=S?S.length:0;const kb=[];for(var Rb=0;Rb<ya;Rb++){var sc=S.K(Rb),Fc=sc.zf(Ld.a.$ff);if(Fc in n){const gd=e.Hc,td=new ni.a;td.setValue(Ld.a.agf,n[Fc]);Fc=gd.hu(td,null);sc.setValue(Ld.a.bgf,Fc);ja+=1}kb.push(sc)}if(C&&ja!==C.length)for(S=0;S<C.length-ja;S++)ya=new kf.DictionaryPropertySet,Rb=C[ja+S],sc=e.Hc,Fc=new ni.a,Fc.setValue(Ld.a.agf,n[Rb]),sc=sc.hu(Fc,null),ya.setValue(Ld.a.$ff,Rb),ya.setValue(Ld.a.bgf,sc),kb.push(ya);return new Sh.a(Ei.CommonProperties.Se.id,
kb)}}Bj.zlb=null;Object(F.a)(Bj,"AddinEditor",null,[804]);var Zl=d(892);class kj{constructor(e){this.lae={};this.Rc=e}mXk(e){if(e){var n=e.properties.ka(Ld.a.zKb,"");this.lae[n]=e}}saveSettings(e,n){if(!n||!ne.a(n))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(!(e.instanceId in this.lae))return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.mMo(this.lae[e.instanceId],n);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}mMo(e,n){const C=this.Rc.Lc(15);C.Ab(e);n=
(new Bj(null,null)).saveSettings(e,n,ne.a(n));e.setValue(Ld.a.cgf,n);C.dispose()}$Ff(e){if(!e)return null;e=this.lae[e.instanceId];let n={};e&&(n=(new Zl.a(e)).getSettings());return n}}Object(F.a)(kj,"SaveSettingsHelper",null,[]);class Ci{constructor(e,n,C){this.ek=e;this.HY=n;this.cMk=C}activate(e,n){var C=n.ka(Ld.a.zKb,null);C||(C=String.format("{{{0}}}",Tj.a.create()),n.setValue(Ld.a.zKb,C));var S=new Zl.a(n);C=S.getSettings();S=S.z6d();C=new jd.a(S.instanceId,S.id,S.version,S.store,S.storeType,
C);C.div=e;C.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;C.osfControlType=S.isContent?OSF.OsfControlType.DocumentLevel:OSF.OsfControlType.ContainerLevel;this.HY.add(C,S.id);this.cMk.mXk(n);this.ek.value.insertOsfControl(C)}}Object(F.a)(Ci,"AddinActivator",null,[90]);var Ek=d(114),zi=d(1706),Sg=d(1651),km=d(872),Je=d(1595),Mc=d(88),Aa=d(470),jb=d(456);const lc=()=>{};class Nc extends zi.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc){super(e,n,C);this.wfg=Fc=>{if(Je.c(this.Tf)){var gd=
{},td=this.iJ?this.iJ.properties.sc.toString():this.Tf.sc.toString();gd[Aa.a.nodeId]=this.iJ?this.iJ.id.toString():this.Tf.id.toString();gd[Aa.a.classId]=td;gd[jb.a.amc]=this.bzk;td=vg.a.xf(kl.a.FF(this.Tf),0);var Bd=vg.a.xf(kl.a.rL(this.Tf),1);gd[jb.a.width]=td;gd[jb.a.height]=Bd;Je.d(Fc,this.Tf,this.Fm,gd)&&Fc.xqd()}};this.rtd=!1;this.Tf=ya;this.bzk=kb;this.iJ=Rb;this.Fm=sc;this.C5n=this.jwb.bind(this);this.mCp=this.aoa.bind(this)}Ssf(){new Sg.a(document.body,this.C5n,this.mCp,this.J,!1,null)}dAa(e){this.Ykd(e)}Ykd(e){km.a.instance.xLg(this.Tf.Hj());
this.Tf.Hj().Ag.nE(this.wfg,lc,e)}aoa(e){e&&!e.StatusCode&&this.Tf.SJ().Ag.nsb(e,Mc.b(e.RevisionList[0].BaseId),!1,new Date,"");this.Tf&&e?km.a.instance.UAc(this.Tf.Hj(),e.StatusCode):E.ULS.sendTraceTag(594929294,339,50,"Not able to notify upload notifier for completion")}coa(){return!0}}Object(F.a)(Nc,"BackCompatImageUploader",zi.a,[]);class qd{Ssf(e,n,C,S,ja,ya,kb){(new Nc(e,Ek.a.instance,G.AFrameworkApplication.J,n,C,S,ja,ya,kb)).Ssf()}}Object(F.a)(qd,"BackCompatImageUploaderWrapper",null,[808]);
var Rd=d(629),Me=d(1103);class df{create(){return new Me.a}}Object(F.a)(df,"AppNodeFactory",null,[284]);var Cf=d(1104);class sg{create(){return new Cf.a}}Object(F.a)(sg,"AppPropNodeFactory",null,[284]);class lg{constructor(){this.T1e=[]}zwo(e){this.T1e.push(e)}cVc(e,n){if(!e||!e.count)return E.ULS.sendTraceTag(17356047,341,15,"The GNC list passed into CheckOperation() should not be null or empty"),!1;for(let C=0;C<this.T1e.length;++C)if(!(0,this.T1e[C])(e,n))return!1;return!0}}Object(F.a)(lg,"ApiOperationChecker",
null,[1109]);var Ia=d(926);class Zb{constructor(){this.sa=new eb.a;this.Gxj=()=>{var e=(new Date).getTime();this.GUi()&&this.sa&&(this.sa.raiseEvent("GraphSpaceLoadContentReadyEventKey"),this.sa.dispose(),this.sa=null,Ia.a.zBj("GraphSpaceLoadContentReadyEventKey"));e=(new Date).getTime()-e;E.ULS.sendTraceTag(17585671,341,50,"{0}",e)}}VVf(e){this.GUi()?(Ia.a.zBj(),e()):this.sa&&(this.sa.addHandler("GraphSpaceLoadContentReadyEventKey",e),Ia.a.MUk(this.Gxj))}GUi(){let e=null;const n=Rd.a.hm.kb.hd;n&&
(e=new Ed.a,e.set(n),this.O8f(e)||(e=null));return e&&e.Vb(19)?!0:!1}O8f(e){Object(sd.a)().ZR(e);return e.Vb(18)}}Object(F.a)(Zb,"InitializeHelper",null,[1108]);var Qc=d(527);class ed{setTimeout(e,n=0){return window.setTimeout(e,n)}clearTimeout(e){window.clearTimeout(e)}setInterval(e,n=0){return window.setInterval(e,n)}clearInterval(e){window.clearInterval(e)}}Object(F.a)(ed,"WindowTimer",null,[1106]);var Pd=d(27),hb=d(5);class Id{}Id.text="text";Id.table="table";Id.yVb="matrix";Object(F.a)(Id,"AppBindingType",
null,[]);class he{}he.tRh="appBindingData";he.Rcc="appInstanceId";he.XRd="appReferenceId";Object(F.a)(he,"AppConstants",null,[]);class Cd{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc=null){this.uz=this.DAd=null;this.Edg=(gd,td)=>{if(this.PWf){gd=this.oQ.xsi();var Bd=new fb.a;for(var wd=0;wd<gd.count;++wd){var te=gd.K(wd);te=this.oQ.bjc(te);Bd.add(te)}wd=new fb.a;te=new fb.a;for(var Le of td.qci){td=this.hGf(Le.id);for(let We=0;We<Bd.count;++We){const Xf=new fb.a;for(var Oe of Bd.K(We))td===Oe.QQ&&Xf.add(Oe);
0<Xf.count&&(wd.add(gd.K(We)),te.add(Xf))}}if(0<te.count){Le=this.Rc.Lc(15);Le.Ab(this.oQ.pla());for(Oe=0;Oe<te.count;++Oe)for(const We of te.K(Oe))(gd=this.s1d.ajc(OSF.DDA.EventDispId.dispidBindingDataChangedEvent))&&wd.K(Oe)&&gd.Kxj(wd.K(Oe).instanceId,We.zW),this.oQ.Dqg(wd.K(Oe),We.zW);Le.dispose()}}};this.oQ=e;this.fq=n;this.ib=C;this.Rc=S;this.Pi=ja;this.T5=ya;this.XQa=Rb;this.GG=kb;this.l9=Fc;this.PWf=!0;this.th=sc}get x2i(){return G.AFrameworkApplication.J.$("TableCellRowSelectionIsEnabled")}get Tj(){return this.Pi.value}get s1d(){this.DAd||
(this.DAd=gc.a.instance.resolve("WordEditor.AppsForOffice.WordEditorEventStore"));return this.DAd}set s1d(e){this.DAd=e}get Yce(){this.uz||(this.uz=gc.a.instance.Oa("Box4.ContentControlConfigSettings"));return this.uz?this.uz.Lh:!1}get eVi(){return G.AFrameworkApplication.J.$("WordEditorAppsForOfficeAppBindingDataChangedEventIsEnabled")}kAa(e,n){const C={};n=this.oQ.bjc(n);for(var S of n)if(S.zW===e){e={};S=({QVh:e}=this.zti(S)).returnValue;if(S!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:S,
XK:C};C[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]=e;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,XK:C}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,XK:C}}Zsi(e,n){n=this.oQ.bjc(n);for(const C of n)if(C.zW===e)return e=C,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ijf:e};return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Ijf:null}}zti(e){const n={};let C=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;
n[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=e.zW;n[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=e.BO;if(e.BO===Id.table||e.BO===Id.yVb){let S=null;({root:S,returnValue:C}=this.FHi(e));C===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(n[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount]=Pd.TableReader.Eh(S),n[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=Pd.TableReader.vg(S),e.BO===Id.table&&(e=this.GG.Y8a(S),n[OSF.DDA.Marshaling.AppBindingKeys.HasHeaders]=0<e,n[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=
Pd.TableReader.vg(S)-e))}return{returnValue:C,QVh:n}}jcl(e){let n=null;const C=({jra:e}=this.iHf(e)).returnValue;if(C!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:C,graphNode:n};n=e.Xd.GO();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,graphNode:n}}CNm(e,n){let C=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,S=null;(e=this.oQ.kAa(e,n))?{root:S,returnValue:C}=this.FHi(e):C=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:C,root:S}}FHi(e){let n=
null,C=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;e?e.BO!==Id.table&&e.BO!==Id.yVb?C=OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType:(e=this.fq.getById(this.gVa(e.QQ)))?{Bp:n,returnValue:C}=this.R8d(e):C=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:C=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:C,root:n}}R8d(e){let n=null;var C=e.rv;e=e.IA;C=C&&e&&C.equals(e)?(n=this.Tj.Eb(C))&&14===n.type?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;return{returnValue:C,Bp:n}}q2c(e,n,C){var S=null;e=({jra:S}=this.p2c(n,e)).returnValue;return e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?e:(S=S.DF(!0))?(C.push(...S.toArray()),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}KFf(e){const n=[];if(e=this.oQ.bjc(e))for(const C of e){let S;({QVh:S}=this.zti(C)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
n.push(S)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,PVh:n}}lBj(e,n,C=null){var S=this.oQ.kAa(n,e);if(!S)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;var ja=S.QQ;S=this.gVa(ja);const ya=this.fq.getById(S);if(!ya)return E.ULS.sendTraceTag(17581638,341,10,"The content control bound id : {0} did not exist.",S),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;ja=this.oQ.oim(ja);e=this.oQ.Dqg(n,e);e===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(C&&C(),ya.Bee&&
1===ja.count?this.fq.eZb(S):ya.toc&&1===ja.count&&(ya.toc=!1));return e}lDa(e){let n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;e=this.gVa(e.QQ);this.fq.getById(e)?this.fq.eZb(e)&&(n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):n=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return n}CIl(){let e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType;var n=2;let C=0;const S=[];for(var ja of this.ib.gb)S.push(...ja.toArray());const ya=S[0];ja=S[S.length-1];2===S.length&&
ya.contextId===Ma.a.Cd&&ja.contextId===Ma.a.Zc&&(ja=ya);const kb=this.fq.ZO(ya,ja,0);if(kb&&0<kb.count)return C=kb.K(0).id,kb.K(0).toc=!0,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ow:C};if(ya.contextId===Ma.a.Cd&&(1===S.length||2===S.length))e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{id:C,returnValue:n}=this.fq.t5a(ya);else if((this.x2i||1===this.ib.gb.length)&&ya.contextId===Ma.a.paragraph&&ja.contextId===Ma.a.paragraph){let Rb;if(!({BBe:n}=this.B4j(ya.node)).returnValue||
!({BBe:Rb}=this.B4j(ja.node)).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,Ow:C};e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;({id:C,returnValue:n}=this.fq.sqa(n.id,Rb.id))}if(e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:e,Ow:C};if(n)return E.ULS.sendTraceTag(17585562,341,15,"{0}",{["ccError"]:n,["errMsg"]:"Unable to create content control for selection"}),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,
Ow:C};this.fq.getById(C).Bee=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ow:C}}Uso(e,n){this.th.fJ(n.id,e.Qa.node.id,!0);this.th.fJ(n.id,e.Xc.node.id,!1);({returnValue:e}=this.fq.sqa(e.Qa.node.id,e.Xc.node.id));return e?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}B4j(e){let n=e;if(!e||12!==e.type)return{returnValue:!1,BBe:n};e=Ed.a.eb(e);if(e.zb(14))if(this.T5.Ffe(e.kd(14)))n=e.currentNode;else return{returnValue:!1,
BBe:n};return{returnValue:!0,BBe:n}}tnm(e){var n;return(n=this.fq.getById(e))?(e=this.Tj.Eb(n.rv),n=this.Tj.Eb(n.IA),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,rXj:e,Cji:n}):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,rXj:null,Cji:null}}mnm(e){const n=this.fq.getByTitle(e);if(!n.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound,Ow:0};if(1<n.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound,
Ow:0};e=n.K(0).id;n.K(0).toc=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ow:e}}p2c(e,n){e=this.oQ.kAa(e,n);return this.iHf(e)}uMh(e,n){const C=this.oQ.kAa(e,n.zW);let S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(C){if(!this.fq.getById(this.gVa(n.QQ)))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(C.QQ===n.QQ){if(n.BO===C.BO)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else S=this.lBj(n.zW,e);if(S!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return S}return this.oQ.pSi(e,
n)}iGf(e,n){if(e=this.oQ.kAa(e,n)){if(e=this.fq.getById(this.gVa(e.QQ)))return e=e.getText(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,text:e};e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:e,text:null}}wxg(e,n,C){(e=this.oQ.kAa(e,n))?e.BO!==Id.text?C=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType:(e=this.gVa(e.QQ),C=(e=this.fq.getById(e))?e.Rxe(C)?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):C=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return C}yti(e,n,C,S){let ja=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ya,kb={};({root:ya}=this.CNm(e,n)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(S.isPartialTable&&this.T5.C2i(ya)?ja=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported:{HNl:kb,returnValue:ja}=this.T5.DNm(ya,C,S));return{returnValue:ja,
b_j:kb}}gjm(e,n){let C="";const S=[];(e=this.q2c(n,e,S))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&({hWa:C,returnValue:e}=this.XQa.fIf(S,!0));return{returnValue:e,hWa:C}}zMj(e,n,C,S,ja,ya,kb){let Rb=null,sc=null;if((e=({jra:Rb}=this.p2c(e,n)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=({Bp:sc}=this.R8d(Rb)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(ya.isPartialTable&&this.T5.C2i(sc))e=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported;
else if({yip:ya,returnValue:e}=this.T5.Hqp(sc,C,ya),e===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.T5.Xtn(C,sc,ya,ja,S)){if({Nip:S,returnValue:e}=this.T5.Kfo(ya,ja,S),e===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){kb(this.GG.KTo(Rb,S[0],S[1])?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,C?"table":"matrix");return}}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize;kb(e,C?"table":"matrix")}WJm(){const e=new fb.a;
var n=new fb.a;for(var C of this.ib.gb)n.addRange(this.fq.ZO(C.Qa,C.Xc,1));if(0<n.count){C=this.oQ.$si();Ed.a.eb(this.ib.J0);const ya=this.qsn(),kb={};for(var S of n)kb[S.id.toString()]=S;for(const Rb of Object.keys(kb)){n=kb[Rb];for(const sc of C){var ja=sc[he.tRh];if(this.gVa(ja.QQ)===n.id){S={["appInstanceId"]:sc[he.Rcc]};const Fc=this.oQ.A4d(sc[he.Rcc]);Fc&&(S[he.XRd]=Fc.Rn);S[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=ja.zW;S[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=ja.BO;ja.BO===Id.table&&
n.rv&&this.x2i&&ya&&(ja=null,{WYj:ja}=this.T5.kKm(this.Tj.Eb(n.rv)),S[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=ja);e.add(S)}}}}return e}nim(e){const n=new fb.a;var C=this.oQ.$si();for(const S of C)if(C=S[he.tRh],this.gVa(C.QQ)===e){const ja={["appInstanceId"]:S[he.Rcc]},ya=this.oQ.A4d(S[he.Rcc]);ja[he.XRd]=ya.Rn;ja[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=C.zW;ja[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=C.BO;n.add(ja)}return n}Xyo(e,n){e&&(e=e.instanceId,this.s1d.ajc(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent).removeHandler(e,
null,n))}Wyo(e,n){e&&(e=e.instanceId,this.s1d.ajc(OSF.DDA.EventDispId.dispidBindingDataChangedEvent).removeHandler(e,null,n))}Fhe(e,n,C){e=this.oQ.A4d(e);n=this.oQ.kAa(e,n);E.ULS.sendTraceTag(16798856,341,50,"{0}",{["method"]:C,["appId"]:e?e.Rn:null,["bindingType"]:n?n.BO:null})}gVa(e){e=Number.parseInvariant(e);return 2147483648>e?e:e+-4294967296}hGf(e){return-1<e?e.toString():(e- -4294967296).toString()}ukm(e){let n=0;(e=this.Tj.Eb(e))&&(n=e.ka(hb.a.Ow,0));return n}iuo(){this.fq.pWk(this.Edg)}Dsn(e){let n=
null;return({jra:n}=this.iHf(e)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess||!n.zg&&!this.Yce?!1:n.isEditable&&n.isSupported}qsn(){const e=Ed.a.eb(this.ib.J0);if(1>=e.ar())return!0;var n=e.je();let C=null;for(;n;){n=Ed.a.eb(n);if(!n.zb(16))return!1;if(!C)C=n.kd(16);else if(C!==n.kd(16))return!1;n=e.Mv()}return!0}iHf(e){let n=null;if(!e)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,jra:n};e=this.gVa(e.QQ);return(n=this.fq.getById(e))?{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
jra:n}:{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,jra:n}}hvf(e,n,C){let S=null;(e=({jra:S}=this.p2c(n,e)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=this.GG.bQl(S)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);C(e)}wef(e,n,C,S){let ja=null;var ya=null;(e=({jra:ja}=this.p2c(n,e)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=({Bp:ya}=this.R8d(ja)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
(ya=Pd.TableReader.Eh(ya),e=this.T5.Oen(ya,C)?this.GG.u7k(ja,C)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);S(e)}xdf(e,n,C,S,ja,ya){let kb=null;var Rb=null;(e=({jra:kb}=this.p2c(n,e)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=({Bp:Rb}=this.R8d(kb)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=Pd.TableReader.vg(Rb),n=this.GG.Y8a(Rb),Rb=
null,e=({XZj:Rb}=this.T5.Nen(n,e-n,C,S,ja)).returnValue?this.GG.c7k(kb,Rb)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);ya(e)}zui(e){return e?this.l9.$zi(e):new fb.a}j3c(e,n){if(e.tb(n))return e.K(n);const C=RegExp("\t","g");for(const S of e)if(S.key.replace(C," ")===n)return S.value;return null}}Object(F.a)(Cd,"AppBindingHelper",null,[1107]);class Wg extends Sys.EventArgs{constructor(e,
n,C){super();this.Yfc=e;this.Oae=n;this.Mag=C}}Object(F.a)(Wg,"OnDataNodeInsertedEventArgs",Sys.EventArgs,[]);class cd extends Sys.EventArgs{constructor(e,n,C,S){super();this.Yfc=e;this.Oae=n;this.wij=C;this.Mag=S}}Object(F.a)(cd,"OnDataNodeReplacedEventArgs",Sys.EventArgs,[]);var If=d(364);class Rf{constructor(e,n,C){this.XIa=C.qVa(e);this.sud=n}get Yfc(){return this.XIa.id}}Object(F.a)(Rf,"CustomXmlNodeList",null,[]);class ih{constructor(e,n){this.qr=new If.a;this.QCd=new fb.a;this.eyh=new fb.a;
this.Lgh=new fb.a;this.Npk=e;this.wl=n}add(e,n){if(!n)return null;if(this.QCd.count>=this.Npk.value){var C=this.QCd.K(0);this.Pdi(C);this.Lgh.add(C);E.ULS.sendTraceTag(9187593,341,50,"Put the first custom xml node list id: {0} in exceeded quota array as the added custom xml touches the quota which is 1024",C)}C=Tj.a.create().toString();this.qr.add(C,new Rf(e,n,this.wl));this.QCd.add(C);return C}get(e){const n=this.qr.K(e);if(void 0===n||null===n){if(-1<this.eyh.indexOf(e))throw E.ULS.sendTraceTag(9187594,
341,50,"Custom xml node list id: {0} is in out of date array",e),Error.invalidOperation(ih.fhg);if(-1<this.Lgh.indexOf(e))throw E.ULS.sendTraceTag(9187595,341,50,"Custom xml node list id: {0} is in exceeded quota array where the quota is 1024",e),Error.invalidOperation(ih.sli);return null}if(this.wl.qVa(n.Yfc)!==n.XIa)throw this.Mbj(e),E.ULS.sendTraceTag(9187596,341,50,"Put custom xml node list id: {0} in out of date array as the custom xml document has been changed",e),Error.invalidOperation(ih.fhg);
return n.sud}Mbj(e){this.Pdi(e);this.eyh.add(e)}Pdi(e){this.qr.remove(e);this.QCd.remove(e)}}ih.sli="exceedQuota";ih.fhg="outOfDate";Object(F.a)(ih,"CustomXmlNodeListCache",null,[1100]);class mh{constructor(){this.NodeListCacheId=this.CustomXmlId=null;this.NodeIndex=0}}Object(F.a)(mh,"CustomXmlNodePointer",null,[]);class Wk{constructor(e,n){this.sa=new eb.a;this.wl=e;this.N5b=n}eRb(e){let n,C=null,S=null;const ja=({sud:n}=this.XJi(e)).returnValue;if(void 0===n||null===n)return{returnValue:ja,XIa:S,
jBb:C};C=n[e.NodeIndex];S=this.wl.qVa(e.CustomXmlId);return{returnValue:void 0!==S&&null!==S&&void 0!==C&&null!==C?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,XIa:S,jBb:C}}XJi(e){let n=null;try{n=this.N5b.get(e.NodeListCacheId)}catch(C){return{returnValue:this.Frm(C),sud:n}}return{returnValue:n?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,sud:n}}m2j(e,n){const C=[],S=this.N5b.add(e,n);
let ja;for(let ya=0;ya<n.length;ya++){ja=n[ya];const kb=new mh;kb.CustomXmlId=e;kb.NodeListCacheId=S;kb.NodeIndex=ya;C.push(this.x5d(kb,ja))}return C}x5d(e,n){const C=this.wl.qVa(e.CustomXmlId),S={};S[OSF.DDA.Marshaling.DataNodeProperties.Handle]=e;S[OSF.DDA.Marshaling.DataNodeProperties.BaseName]=C.getNodeBaseName(n);S[OSF.DDA.Marshaling.DataNodeProperties.NamespaceUri]=C.getNodeNamespaceURI(n);S[OSF.DDA.Marshaling.DataNodeProperties.NodeType]=C.getNodeType(n);return S}aef(e,n){this.sa.addHandler(e,
n)}Yqg(e,n){this.sa.removeHandler(e,n)}Lno(e,n){e=this.x5d(n,e);n=new Wg(n.CustomXmlId,!1,e);return this.Pxj(Wk.$eg,n)}jjd(e,n,C){n=this.x5d(C,n);n[OSF.DDA.Marshaling.DataNodeProperties.Handle]=null;e=this.x5d(C,e);C=new cd(C.CustomXmlId,!1,n,e);return this.Pxj(Wk.bfg,C)}Pxj(e,n){try{this.sa.raiseEvent(e,n)}catch(C){return E.ULS.sendTraceTag(19489935,344,10,"RaiseNodeEvent({0}): action failed. Exception message: {1}",e,C.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Frm(e){return 0>
e.message.indexOf(":")?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:e.message.split(":")[1].trim()===ih.fhg?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate:e.message.split(":")[1].trim()===ih.sli?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}Wk.$eg="OnNodeInsertedInfoReceivedHandlerKey";Wk.bfg="OnNodeReplacedInfoReceivedHandlerKey";Wk.Qlj="OnNodeDeletedInfoReceivedHandlerKey";Object(F.a)(Wk,"CustomXmlHelper",null,
[1102]);var na=d(576),db=d(1079),Ob=d(1014),Sb=d(1363),qc=d(255);class Ic extends Pa.a{constructor(){super();this.FileId=null;this.IsSecondaryRevision=!1}Om(){return ua.a.Ytl}static construct(e,n){const C=new Ic;C.FileId=e;C.IsSecondaryRevision=n;return C}}Object(F.a)(Ic,"CloseFileAgaveAsyncRequest",Pa.a,[]);class xc extends Pa.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.SliceSize=this.FileType=0}Om(){return ua.a.P2c}static construct(e,n,C,S){const ja=new xc;ja.FileId=e;ja.IsCoauthorable=
n;ja.FileType=C;ja.SliceSize=S;return ja}}Object(F.a)(xc,"GetFileAgaveApiRequest",Pa.a,[]);class vb extends Pa.a{constructor(){super();this.FileId=null;this.SliceIndex=0;this.IsSecondaryRevision=!1}Om(){return ua.a.vsm}static construct(e,n,C){const S=new vb;S.FileId=e;S.SliceIndex=n;S.IsSecondaryRevision=C;return S}}Object(F.a)(vb,"GetFileSliceRequest",Pa.a,[]);class Qd{constructor(e,n){this.Ooc=e;this.handler=n}}Object(F.a)(Qd,"CloseAsyncRequestData",null,[]);class Ze{constructor(e,n,C,S,ja=!1){this.y0f=
!1;this.nni=e;this.fileSize=n;this.OCg=C;this.WBf=S;this.Ooc=ja}}Object(F.a)(Ze,"DocumentFile",null,[]);class Be{constructor(e,n,C,S){this.bhf=e;this.fileType=n;this.OCg=C;this.handler=S}}Object(F.a)(Be,"GetFileRequestData",null,[]);class Ve{constructor(e,n,C,S){this.controlId=e;this.Dap=n;this.Ooc=C;this.handler=S}}Object(F.a)(Ve,"GetFileSliceRequestData",null,[]);class Pe{constructor(e,n,C,S,ja,ya,kb){this.Ym=this.Wgb=this.t2a=this.PQa=null;this.VPo=Rb=>{if(this.ZS&&this.Tjb){var sc=xc.construct(this.ZS(),
this.Tjb.G6d(this.Amk),Rb.fileType,Rb.OCg);this.PQa=new db.a;this.PQa.kr=sc;this.PQa.status=Ob.a.MI;this.PQa.bG="GetFileAgave";sc=this.HS(()=>{this.j_c();if(2===this.PQa.statusCode&&this.PQa.Nk&&this.PQa.Nk.length&&this.PQa.Nk[0]){var Fc=this.PQa.Nk[0];this.UWi(Rb.bhf)?(E.ULS.sendTraceTag(7123615,344,15,"App {0} has reach the limit of number of cached files.",Rb.bhf),Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit,null)):(Fc=this.H9h(Rb.bhf,Fc.FileSize,Rb.OCg,null,Fc.IsSecondaryRevision),
Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Fc))}else E.ULS.sendTraceTag(7123614,344,15,"Fail to obtain the file."),Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)});sc.MG(this.PQa);sc.i_()}else this.j_c(),Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.WPo=Rb=>{if(this.ZS&&this.Tjb){var sc=vb.construct(this.ZS(),Rb.Dap,Rb.Ooc);this.t2a=new db.a;this.t2a.kr=sc;this.t2a.status=Ob.a.MI;sc=this.HS(()=>{this.j_c();if(2===this.t2a.statusCode&&
this.t2a.Nk&&this.t2a.Nk.length&&this.t2a.Nk[0]){var Fc=this.t2a.Nk[0];"undefined"===typeof Fc.SliceData?(E.ULS.sendTraceTag(20711200,344,15,"Undefined error possibly because we failed to get the file slice data"),Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)):Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Fc.SliceData)}else E.ULS.sendTraceTag(20711199,344,15,"Fail to obtain the file."),Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,
null)});sc.MG(this.t2a);sc.i_()}};this.BPo=Rb=>{var sc=Rb.Ooc;this.ZS&&this.Tjb&&(sc=Ic.construct(this.ZS(),sc),this.Wgb=new db.a,this.Wgb.kr=sc,this.Wgb.status=Ob.a.MI,sc=this.HS(()=>{this.j_c();2===this.Wgb.statusCode&&this.Wgb.Nk&&this.Wgb.Nk.length&&this.Wgb.Nk[0]?Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):E.ULS.sendTraceTag(20854626,344,15,"Fail to obtain the file.")}),sc.MG(this.Wgb),sc.i_())};this.FWb=Rb=>{this.j_c();E.ULS.sendTraceTag(7123616,344,15,"Fail to force save the file.");
Rb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.lyo=(Rb,sc)=>{this.CFa.tb(sc)&&this.CFa.remove(sc)};this.HS=e;this.ZS=n;this.Tjb=C;this.Amk=S;this.CFa=new fd.a;this.ee=ja;this.Aa=ya;this.ui=kb;this.ui.lff(this.lyo)}wqm(e,n,C,S){this.ee&&(this.Ym=this.ee.Xf("UserAction","GetFileAgaveApi"));e=new Be(e,n,C,S);this.cEf(e)}Aqm(e,n,C,S){this.ee&&(this.Ym=this.ee.Xf("UserAction","GetFileSliceAgaveApi"));e=new Ve(e,n,C,S);this.Scm(e)}APo(e,n,C,S){this.ee&&(this.Ym=this.ee.Xf("UserAction",
"CloseFileAsyncApi"));n=new Qd(n,S);this.Qcm(n);this.nBj(e,C)}cEf(e){Qc.a.iU(Sb.a.P2c,!1,this.VPo,this.FWb,e)}Scm(e){Qc.a.iU(Sb.a.P2c,!1,this.WPo,this.FWb,e)}Qcm(e){Qc.a.iU(Sb.a.P2c,!1,this.BPo,this.FWb,e)}H9h(e,n,C,S,ja=!1){const ya=Pe.Ppk++;n=new Ze(ya,n,C,S,ja);this.xWk(e,n);return n}j_c(){this.Ym&&(this.Ym.stop(),this.Ym=null)}xWk(e,n){this.CFa.tb(e)||this.CFa.W(e,new qc.a);this.CFa.K(e).W(n.nni,n)}Swi(e,n){let C=null;this.CFa.tb(e)&&({value:C}=this.CFa.K(e).Ec(n,C));C||E.ULS.sendTraceTag(7123617,
344,15,"File {0}:{1} doesn't exist",e,n);return C}UWi(e){return this.CFa.tb(e)?2<=this.CFa.K(e).count:!1}nBj(e,n){return this.CFa.tb(e)?this.CFa.K(e).remove(n)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}static WSd(e){return(new na.a).Jaa(0,e)}}Pe.Ppk=0;Object(F.a)(Pe,"GetFileApiHelper",null,[1105]);var Lf=d(165),pe=d(3),Zh=d(61),Te=d(614),Gi=d(58),fe=d(690),Fe=d(409),mg=d(99),bj=d(1097),Jh=
d(198),Gh=d(157),cj=d(59),Uj=d(874),Xk=d(718),Lk=d(199),ii=d(661);class lj extends Lk.a{constructor(e,n){super(new ii.a,e,n);this.Cbc=null}get Rla(){return 192}createElement(e){e=super.createElement(e);this.Cbc.appendChild(e);return e}vl(e){e=super.vl(e);this.Cbc.appendChild(e);return e}get Fkp(){return this.Cbc.cloneNode(!0)}yWb(){super.yWb();this.Cbc=Uj.a.createElement(this.container.ownerDocument,Xk.a.div)}hsc(){super.hsc();this.Cbc=null}dispose(){super.dispose();this.Cbc=null}}Object(F.a)(lj,
"HtmlDataRenderingView",Lk.a,[]);class Od{get Kg(){return null!=this.i4g?this.i4g:this.i4g=gc.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(e,n,C,S,ja){this.ib=e;this.Vgb=n;this.ga=C;this.Ryk=S;this.IQc=ja}Nwe(e,n,C,S){if(!e.length||!C)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;const ja=new Lf.Selection(e,n);try{this.ib.UZb(()=>{this.ib.Kc(ja)})}catch(kb){return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}const ya=new kf.DictionaryPropertySet;ya.setValue(Gh.a.XX,
C);ya.setValue(Gh.a.x0a,!0);return 32===this.ga.Qb(pe.a.Gqa,1,ya)?(this.ga.Zma(null,pe.a.Gqa,ya,kb=>{const Rb=ya.ka(Gh.a.csj,null);S(32===kb.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Rb)}),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}fIf(e,n){let C="";if(!e.length)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,hWa:C};if(!this.Vgb.Wun)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
hWa:C};let S=new pj.GraphTransaction(7);const ja=new Lf.Selection(e,n);let ya=null,kb=null;try{this.ib.UZb(()=>{this.ib.Kc(ja,void 0,!0);this.Vgb.n$j();S.Ab(this.Vgb.Pna);ya=e[0].node.Hc;kb=this.Vgb.Pna.Hc;this.Vgb.IXd(Object(Zh.a)().Ie.ge);this.Vgb.m$j()})}catch(Bd){return S.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hWa:C}}S.dispose();var Rb=[];n=new Ed.a;n.set(this.Vgb.j0j);for(var sc=n.je();sc;)Rb.push(sc),sc=n.Lwf();if(0<Rb.length){this.BCl(ya,kb);var Fc=new Ed.a;
Fc.set(e[0].node);if(!Fc.zb(7))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hWa:C};sc=Fc.mt(8);n=this.kUm(this.Vgb.j0j,Rb);S=new pj.GraphTransaction(7);S.Ab(n);Fc=new Ed.a;Fc.set(Rb[0]);if(!Fc.zb(8))return S.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hWa:C};Rb=Fc.mt(8);if(this.Kg.vn){sc=(new Te.WACStyleSet).gla(sc);Fc=(new Te.WACStyleSet).gla(Rb);for(var gd=0;gd<sc.Qw;gd++){var td=sc.vla(gd);Fc.Hdf(Gi.a.sMm(td))}Fc.oJj(Rb)}else{sc=(new Te.WACStyleSet).Uaa(sc);
Fc=(new Te.WACStyleSet).Uaa(Rb);for(gd=0;gd<sc.Qw;gd++)td=sc.FAa(gd),Fc.pOh(Gi.a.pMm(td));Fc.izg(Rb)}Rb=new lj(this.Ryk,this.IQc);sc=document.createElement("div");Rb.vdc(sc);Rb.rF(n);S.zod(Rb.Ic);S.dispose();C+=Rb.Fkp.innerHTML.replace('\\"','"');Rb.dispose();Rb=null}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,hWa:"<HTML>\r\n<HEAD></HEAD>\r\n<BODY>\r\n"+C+"\r\n</BODY>\r\n</HTML>"}}kUm(e,n){const C=new fe.a;Ed.a.eb(e).Wf(C,1);return this.jUm(C,n)}jUm(e,n){var C=!1;let S,ja=null;
1===n.length&&10===n[0].type?(C=!0,ja=S=n[0]):S=new Fe.a(new mg.a(10,cj.a.eia));e=Ed.a.eb(e);e.Wf(S,1);e.Yj(S);if(C)return S;C=[];for(e=0;e<n.length;e++){const ya=n[e];23===ya.type?0<C.length&&(ja=this.nLi(S,C),C=[]):C.push(ya)}0<C.length&&(n=this.nLi(S,C),ja=ja?S:n);return ja}nLi(e,n){var C=!1;let S;1===n.length&&23===n[0].type?(C=!0,S=n[0]):S=new bj.a;e=Ed.a.eb(e);e.Wf(S,1);e.Yj(S);if(C)return S;for(C=0;C<n.length;C++){const ja=n[C];ja.id=Wc.a.nil;e.Wf(ja,1)}return S}BCl(e,n){e=e.Mm;e=Object(Jh.d)(e).g3f();
var C=n.CDg();for(var S=0;S<e.length;S++){var ja=e[S];if(ja.sc===cj.a.Rma){if(!n.Dla(ja.id)){var ya=ja.clone();n.hu(ya,ja.id)}}else ja.sc===cj.a.s_a?(ya=ja.clone(),ya.id=ja.id,C.vya(ya)):ja.sc===cj.a.tzb&&(ya=ja.clone(),ya.id=ja.id,C.vya(ya))}e=n.PCf();e=Object(Jh.d)(e).g3f();for(C=0;C<e.length;C++)S=e[C],S.sc===cj.a.s_a?n.Dla(S.id)||(ja=S.clone(),ja.id=S.id,n.JP(ja)):S.sc!==cj.a.tzb||n.Dla(S.id)||(ja=S.clone(),ja.id=S.id,n.$jd(ja))}}Object(F.a)(Od,"HtmlDataGetSetProvider",null,[1103]);var Nj=d(182),
yh=d(146);class Th{constructor(e){this.y3a=e}getOoxml(e,n,C){e=this.LXh(e);this.y3a.NCi(e,n,C)}aug(e,n,C,S){this.y3a.aug(e,n,C,S)}xxe(e,n,C,S,ja,ya,kb,Rb){e=this.LXh(e);this.y3a.QOj(e,n,C,S,ja,ya,kb,Rb)}Tjc(e,n){return this.y3a.Tjc(e,n)}LXh(e){if(Nj.a.Qf(e))return null;e=[new Lf.Selection(e,!0)];return new yh.SelectionCollection(e,0)}}Object(F.a)(Th,"OoxmlRangeManager",null,[1099]);var Tf=d(521);class pp extends Tf.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=null;
this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0}Om(){return ua.a.h6n}static construct(e,n,C,S,ja,ya){const kb=new pp;kb.FileId=e;kb.IsCoauthorable=n;kb.AnchorData=C;kb.ContentControlId=S;kb.InsertLocationWithContentControl=ja;kb.WordOperationId=ya;return kb}}Object(F.a)(pp,"OoXmlGetRequest",Tf.a,[]);class jk extends Tf.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=null;this.WordOperationId=0}Om(){return ua.a.i6n}static construct(e,
n,C,S,ja){const ya=new jk;ya.FileId=e;ya.IsCoauthorable=n;ya.Ooxml=S;ya.AnchorData=C;ya.WordOperationId=ja;return ya}}Object(F.a)(jk,"OoXmlRetrieveStylesRequest",Tf.a,[]);class lm extends Tf.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=null;this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0;this.InsertFileOptions=null}Om(){return ua.a.j6n}static construct(e,n,C,S,ja,ya,kb,Rb){const sc=new lm;sc.FileId=e;sc.IsCoauthorable=
n;sc.Ooxml=S;sc.AnchorData=C;sc.ContentControlId=ja;sc.InsertLocationWithContentControl=ya;sc.WordOperationId=kb;sc.InsertFileOptions=Rb;return sc}}Object(F.a)(lm,"OoXmlSetRequest",Tf.a,[]);var ce=d(26),Ge=d(37),Vc;(function(e){e[e.unknown=-1]="unknown";e[e.main=0]="main";e[e.f2p=1]="footnote";e[e.J_p=2]="endnote";e[e.dpq=3]="textbox";e[e.comment=4]="comment";e[e.Z5c=5]="headerFooter"})(Vc||(Vc={}));Object(F.b)("DocumentKindType",Vc);var Ii=d(1464),Wj=d(1562);class hn{constructor(e,n,C,S,ja,ya){this.mK=
e;this.V6=n;this.mnd=C;this.dEa=S;this.ooxml=ja;this.Weo=ya}}Object(F.a)(hn,"OoxmlSelectionManagerCallBackData",null,[]);class Cm{constructor(e){this.AN=null;this.AN=e}}Object(F.a)(Cm,"SerializableOoxmlData",null,[]);class Cl{constructor(e,n,C,S,ja,ya){this.gEh=WordEditorIntl.WordEditorStrings.L_Inserting;this.onFailure=kb=>{this.$Z(kb.dEa);kb.V6&&kb.V6(3)};this.zE=kb=>{var Rb=kb.mnd.Nk;Rb?Rb.length?(Rb=kb.mnd.Nk[0])?Rb.StatusCode?this.jwn(kb.ooxml)?this.KWb("ooxml failed for an unknown reason",kb,
0):this.KWb("Agave sent malformated OOXML",kb,7):kb.Weo(kb):this.KWb("ooxml response is null",kb,0):this.KWb("response list is empty",kb,0):this.KWb("response list is null",kb,0)};this.Ueo=kb=>{const Rb=kb.mnd.Nk[0];Rb.RetrievedStyles?(kb.mK&&kb.mK(Rb.RetrievedStyles),this.$Z(kb.dEa)):this.KWb("retrieved styles is null",kb,0)};this.Heo=kb=>{const Rb=kb.mnd.Nk[0];Rb.OoXml?(kb.mK&&kb.mK(Rb.OoXml),this.$Z(kb.dEa)):this.KWb("ooxml is null",kb,0)};this.Veo=kb=>{const Rb=kb.mnd.Nk[0];Ek.a.instance.$b(new zg.a(0,
1,0,()=>{this.cEb(Sb.a.Ngg,!0,()=>{ka.a.jf.mBe(()=>{var sc=Rb.InsertedContentInfo;if(""!==sc){sc=Bf.b(sc);var Fc=Wj.a(sc.AN);sc=Fc.KYa;const gd=Wj.d(Fc.RU),td=Fc.FMa;Fc=Wj.d(Fc.X7);sc=sc.toString()+"|"+Bf.c(gd)+"|"+td.toString()+"|"+Bf.c(Fc);kb.mK(sc)}else kb.mK(sc)});this.$Z(kb.dEa)},(sc,Fc)=>{this.$Z(kb.dEa);this.MLa("we succeeded to set ooxml but failed in the second save, most likely, the user can't see the change yet. [errorCode: {0}]",Fc);kb.mK(null)},null,this.gEh,null)}))};this.rW=e;this.Rib=
n;this.ZS=C;this.iya=S;this.cEb=ja;this.zoh=ya}NCi(e,n,C){this.Gli(e,n,C,"ForceSaveAndGetOoXmlForSelection",!1,this.Heo,null,null,0,0,0,null,(S,ja,ya)=>pp.construct(S,ja,ya,0,0,0))}aug(e,n,C,S){const ja=this.rW.Xf("Task","ForceSaveAndRetrieveStyles");try{const ya=jk.construct(this.ZS(),this.Rib(),"{}",e,n),kb=Object.assign(new db.a,{kr:ya,status:Ob.a.MI,bG:"OoxmlRetrieveStyles"}),Rb=new hn(C,S,kb,ja,e,this.Ueo);this.cEb(Sb.a.Ngg,!1,this.zE,this.onFailure,Rb,null,kb)}catch(ya){this.MLa("failed in the call to retrieveStyles. most likely during ForceSave. [e:{0}] [callstack: {1}]",
ya.message,ya.stack),this.$Z(ja),S(0)}}QOj(e,n,C,S,ja,ya,kb,Rb){void 0===n||null===n?(this.MLa("Agave sent NULL OOXML"),Rb(4)):this.Rib()?this.Gli(e,kb,Rb,"ForceSaveAndSetOoXmlForSelection",!0,this.Veo,n,this.gEh,C,S,ja,ya,lm.construct):(this.MLa("Document is non-coauthorable. Disabled for SET OOXML"),Rb(6))}Tjc(e,n){if(!e)return new fb.a;var C=e.split("|");if(4!==C.length)return new fb.a;e=Number.parseLocale(C[0]);var S=Bf.b(C[1]);S=Wj.b(S);const ja=Number.parseLocale(C[2]);C=Bf.b(C[3]);const ya=
Wj.b(C);C=new fb.a;let kb=!1,Rb=!1,sc=!1,Fc=null,gd,td=-1;for(let Bd=0;Bd<n.count;Bd++)if(gd=n.K(Bd).ka(hb.a.ed,0),kb)if(sc||(td?(td!==Fc.characterData.length&&C.add(ce.a.createTextRange(Fc,td,Fc.characterData.length)),C.add(ce.a.Wl(Fc))):C.add(ce.a.create(Fc)),sc=!0),ja===gd){Rb=!0;(e=this.BHf(n.K(Bd),ya))&&C.add(ce.a.createTextRange(n.K(Bd),0,e));break}else C.add(ce.a.create(n.K(Bd)));else if(e===gd&&(kb=!0,Fc=n.K(Bd),td=this.BHf(Fc,S),ja===gd)){Rb=!0;e=this.BHf(Fc,ya);e===td?C.add(ce.a.Uc(n.K(Bd),
td)):C.add(ce.a.createTextRange(n.K(Bd),td,e));break}return kb&&Rb?C:new fb.a}BHf(e,n){e=this.iya.SYa(e.characterData,e.ra);return this.iya.FMb(e,n)}Gli(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd){S=this.rW.Xf("Task",S);const wd={};try{let mq=0,uk=0,au=0,ED=0;if(e){var te=e.currentSelection;if(te)if(Ge.a.gLa(te))this.MLa("User has selected an anchored object and it's not yet supported."),this.$Z(S),C(8);else{var Le=te.Qa.node,Oe=te.Xc.node;mq=Le.ka(hb.a.ed,0);au=Oe.ka(hb.a.ed,0);uk=cc.a.Hqb(te,!0);ED=cc.a.Hqb(te,
!1);wd.startParaId=mq;wd.endParaId=au;wd.cpBegin=uk;wd.cpEnd=ED;if(this.iya){var We=this.iya.SYa(Le.characterData,Le.ra),Xf=this.iya.EBc(We,uk,this.zoh);e=Xf;We=this.iya.SYa(Oe.characterData,Oe.ra);We=Xf=this.iya.EBc(We,ED,this.zoh);var Gg=Le.ka(hb.a.Vj,2147483646),Ph=Oe.ka(hb.a.Vj,2147483646);wd.textIdStart=Gg;wd.textIdEnd=Ph;var Aj=Le.Lra;wd.documentKind=Vc[Aj];if(-1===Aj||1===Aj||2===Aj)this.MLa("Unsupported DocumentKind is "+Aj),this.$Z(S),C(2);else{var Ih=new Ii.a(1,mq,Gg,e,au,Ph,We,Aj),Nm=new Cm(Wj.c(Ih)),
Sk=Bf.c(Nm),hk=td?JSON.stringify({["_importChangeTrackingMode"]:td.importChangeTrackingMode,["_importCustomProperties"]:td.importCustomProperties,["_importCustomXmlParts"]:td.importCustomXmlParts,["_importPageColor"]:td.importPageColor,["_importParagraphSpacing"]:td.importParagraphSpacing,["_importStyles"]:td.importStyles,["_importTheme"]:td.importTheme}):"",al=Bd(this.ZS(),this.Rib(),Sk,kb,sc,Fc,gd,hk),Cj=Object.assign(new db.a,{kr:al,status:Ob.a.MI,bG:"OoxmlSelection"}),Lg=new hn(n,C,Cj,S,kb,ya);
this.cEb(Sb.a.Ngg,ja,this.zE,this.onFailure,Lg,Rb,Cj)}}else this.MLa("IWordTextOffsetTranslator is null as it did not resolve"),this.$Z(S),C(5)}else this.$Z(S),C(2)}else this.MLa("SelectionCollection is null"),this.$Z(S),C(9)}catch(mq){this.MLa("failed in the call to GetOoxmlForSelection. most likely during ForceSave. [e:{0}] [logData: {1}] [callstack: {2}]",mq.message,wd,mq.stack),this.$Z(S),C(0)}}KWb(e,n,C){this.MLa("[reason:{0}].",e);n.V6&&n.V6(C)}jwn(e){let n=!0;const C=this.rW.Xf("Task","SetOoxmlIsValidXML");
try{const S=Sys.Net.XMLDOM(e);if(0<S.getElementsByTagName("parsererror").length)n=!1;else{const ja=S.parseError;void 0!==ja&&null!==ja&&ja.errorCode&&(n=!1)}}catch(S){n=!0,this.MLa("Failed in parsing the xml string: [message: {0}] [callstack: {1}]",S.message,S.stack)}finally{C.stop()}return n}$Z(e){e&&e.stop()}MLa(e,...n){E.ULS.sendTraceTag.apply(null,[7902996,341,15,"OoXml Operation Failed. "+e].concat(n))}}Object(F.a)(Cl,"OoxmlSelectionManager",null,[1104]);var Uk=d(21),Ml=d(79),jo=d(119),tl=d(31);
class fl{LBi(e,n,C){({aPo:e,cpBegin:S,gPo:n,cpEnd:C}=this.yjl(e,n,C));if(e===n)e=Uk.SelectionFactory.eL(e,S,C);else{var S=Uk.SelectionFactory.ue(e,S);n=Uk.SelectionFactory.ue(n,C);e=Ml.OutlineReader.JZf(e)?S:Uk.SelectionFactory.Vy(S,n.Xe?n.Xe.Qa:n.Qa)}return e}yjl(e,n,C){let S;e=fl.nEf(e);n=fl.nEf(n);C=fl.nEf(C);if(e.contains(n)){var ja=fl.Qnc(e.Qa)?e.Qa.node:C.Qa.node;S=e.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ja):e.Qa.contextId===Ma.a.paragraph?0:e.Qa.cpBegin;if(fl.Qnc(e.Xc))if(1===
e.length||2===e.length&&e.Qa.node.id===e.Xc.node.id&&e.Qa.contextId===Ma.a.Cd&&e.Xc.contextId===Ma.a.Zc)if(C.Xc.contextId===Ma.a.paragraph||C.Xc.contextId===Ma.a.Zc){var ya=jo.a.eb(C.Xc.node);ya.Ks();ya.mt(11);tl.OutlineElementNavigator.ft(ya,!0,!1)?(tl.OutlineElementNavigator.Me(ya),ya=ya.currentNode):ya=C.Xc.node}else ya=C.Xc.node;else ya=e.Xc.node;else C.Xc.contextId===Ma.a.paragraph||C.Xc.contextId===Ma.a.Zc?(ya=jo.a.eb(C.Xc.node),ya.Ks(),ya.mt(11),tl.OutlineElementNavigator.ft(ya,!0,!1)?(tl.OutlineElementNavigator.Me(ya),
ya=ya.currentNode):ya=C.Xc.node):ya=C.Xc.node;e=e.Xc.contextId===Ma.a.paragraph||e.Xc.contextId===Ma.a.Zc?C.Xc.contextId!==Ma.a.paragraph&&C.Xc.contextId!==Ma.a.Zc||C.Xc.node.id===ya.id?Af.ParagraphReader.textLength(ya):0:e.Xc.node.id===n.Xc.node.id?C.Xc.contextId===Ma.a.paragraph||C.Xc.contextId===Ma.a.Zc?ya===C.Xc.node?Af.ParagraphReader.textLength(C.Xc.node):e.Xc.cpEnd-n.Xc.cpEnd:C.Xc.cpEnd+e.Xc.cpEnd-n.Xc.cpEnd:e.Xc.cpEnd}else n.contains(e)?(e=Ge.a.ym(C)?C:Ge.a.eAa(C,{NE:!0,Du:!1,cH:!1,aJ:!0}),
ja=ya=e.Qa.node,S=e=e.Qa.cpBegin):fl.Apl(e,n)?e.Qa.node.id===e.Xc.node.id?n.Qa.node.id===e.Qa.node.id&&e.Qa.cpBegin<n.Qa.cpBegin?(ja=ya=e.Qa.node,S=e.Qa.contextId===Ma.a.paragraph?0:e.Qa.cpBegin,e=n.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ya):n.Qa.cpBegin):(C.Xc.contextId===Ma.a.paragraph||C.Xc.contextId===Ma.a.Zc?(ja=jo.a.eb(C.Xc.node),ja.Ks(),ja.mt(11),tl.OutlineElementNavigator.ft(ja,!0,!1),tl.OutlineElementNavigator.Me(ja),ja=ja.currentNode,S=0):(ja=C.Xc.node,S=C.Xc.cpEnd),ya=ja,
e=e.Xc.contextId===Ma.a.paragraph||e.Xc.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ya):S+e.Xc.cpEnd-n.Xc.cpEnd):fl.Qnc(e.Qa)&&(e.Qa.node.id!==n.Qa.node.id||e.Qa.contextId===Ma.a.paragraph||n.Qa.contextId===Ma.a.Zc||e.Qa.contextId!==Ma.a.Zc&&e.Qa.cpBegin<=n.Qa.cpBegin)?(ja=e.Qa.node,S=e.Qa.contextId===Ma.a.paragraph?0:e.Qa.contextId===Ma.a.Zc?n.Qa.node.id===e.Qa.node.id?C.Qa.contextId===Ma.a.paragraph||C.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ja):C.Qa.cpBegin:Af.ParagraphReader.textLength(ja):
e.Qa.cpBegin,e=fl.g$l(e),ya=e.node,e=n.Qa.contextId===Ma.a.paragraph||n.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(e.node):n.Qa.cpBegin):fl.Qnc(e.Xc)?(C.Xc.contextId===Ma.a.paragraph||C.Xc.contextId===Ma.a.Zc?(n=jo.a.eb(C.Xc.node),n.Ks(),n.mt(11),tl.OutlineElementNavigator.ft(n,!0,!1),tl.OutlineElementNavigator.Me(n),ja=n.currentNode,S=0):(ja=C.Xc.node,S=C.Xc.cpEnd),ya=e.Xc.node,e=e.Xc.contextId===Ma.a.paragraph||e.Xc.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ya):e.Xc.cpEnd):(C.Xc.contextId===
Ma.a.paragraph||C.Xc.contextId===Ma.a.Zc?(ja=jo.a.eb(C.Xc.node),ja.Ks(),ja.mt(11),tl.OutlineElementNavigator.ft(ja,!0,!1),tl.OutlineElementNavigator.Me(ja),ja=ja.currentNode,S=0):(ja=C.Xc.node,S=C.Xc.cpEnd),ya=ja,e=e.Xc.contextId===Ma.a.paragraph||e.Xc.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ja):S+e.Xc.cpEnd-n.Xc.cpEnd):e.Qa.node.id===n.Xc.node.id&&(e.Qa.cpBegin>=n.Xc.cpEnd||e.Qa.contextId===Ma.a.Zc)?(C.Xc.contextId===Ma.a.Zc||C.Xc.contextId===Ma.a.paragraph?(ja=jo.a.eb(C.Xc.node),ja.Ks(),
ja.mt(11),tl.OutlineElementNavigator.ft(ja,!0,!1),tl.OutlineElementNavigator.Me(ja),ja=ja.currentNode,S=e.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(e.Qa.node)-n.Xc.cpEnd:e.Qa.cpBegin-n.Xc.cpEnd):(ja=C.Xc.node,S=e.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ja):e.Qa.cpBegin-n.Xc.cpEnd+C.Xc.cpEnd),ya=e.Qa.node.id===e.Xc.node.id?ja:e.Xc.node,e=ja===ya?S+e.Xc.cpEnd-e.Xc.cpBegin:e.Xc.contextId===Ma.a.paragraph||e.Xc.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(ya):e.Xc.cpEnd):
(ja=e.Qa.node,S=e.Qa.contextId===Ma.a.paragraph?0:e.Qa.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(e.Qa.node):e.Qa.cpBegin,ya=e.Xc.node,e=e.Xc.contextId===Ma.a.paragraph||e.Xc.contextId===Ma.a.Zc?Af.ParagraphReader.textLength(e.Xc.node):e.Xc.cpEnd);return{aPo:ja,cpBegin:S,gPo:ya,cpEnd:e}}static nEf(e){e.Pf||(e=e.toArray(),e.reverse(),e=new Lf.Selection(e,!0));return e}static Apl(e,n){const C=e.toArray(),S=n.toArray();let ja,ya;if(e.contains(n)||n.contains(e))return!1;for(let kb=0;kb<e.length;kb++){ja=
C[kb];for(let Rb=0;Rb<n.length;Rb++)if(ya=S[Rb],ja.node.id===ya.node.id&&(ja.contextId===Ma.a.paragraph||ya.contextId===Ma.a.paragraph||ja.contextId===Ma.a.Zc&&ya.contextId===Ma.a.Zc||ja.contextId===Ma.a.Cd&&ya.contextId===Ma.a.Cd&&(ja.cpBegin>=ya.cpBegin&&ja.cpBegin<ya.cpEnd||ya.cpBegin>=ja.cpBegin&&ya.cpBegin<ja.cpEnd)))return!0}return!1}static Qnc(e){return!!e.node.anchor&&!e.node.anchor.zU&&e.node.Xz}static g$l(e){if(!fl.Qnc(e.Qa))return null;let n=e.Qa;e=e.ZT();for(e.moveNext();e.moveNext();)if(fl.Qnc(e.current))n=
e.current;else break;return n}}Object(F.a)(fl,"SetDataVirtualSelectionMerger",null,[1101]);var Uh=d(23),nh=d(15);class Ke{constructor(e,n,C){this.ga=e;this.ib=n;this.GG=C}gon(){this.ib.J0||E.ULS.sendTraceTag(8452246,341,15,"Unexpected error to selectionManager and the selectionRoot cannot return");return 1<Ed.a.eb(this.ib.J0).ar()}OIg(){let e=null;const n=Ed.a.eb(this.ib.J0);if(n.je()){const C=Ed.a.eb(n.currentNode);n.tLa&&n.je()&&Pd.TableReader.isTable(n)?e=n.currentNode:C.zb(14)&&(e=C.kd(14))}return e?
{returnValue:!0,CBe:e}:{returnValue:!1,CBe:e}}Jqp(e,n){let C="";var S=null;for(let ja=0;ja<n.length;ja++)if(e.equals(n[ja].node)){S=n[ja];break}if(S){e=Af.ParagraphReader.text(S.node);switch(S.contextId){case Ma.a.paragraph:C+=e;break;case Ma.a.Cd:n=S.cpBegin;S=S.cpEnd-n;0<S&&(C+=e.substr(n,S));break;case Ma.a.Zc:break;default:return E.ULS.sendTraceTag(8452249,341,15,"Unexpected context type when trying get selected text of paragraph node, context type is:"+S.contextId),{returnValue:!1,nwc:C}}return{returnValue:!0,
nwc:C}}return{returnValue:!1,nwc:C}}O3j(e,n,C){let S="",ja=!1;e=Ed.a.eb(e);const ya=e.ar();for(let Rb=0;Rb<ya;Rb++){if(e.ZB(Rb)){e.je();if(12===e.uf){if(C)S+=Af.ParagraphReader.text(e.currentNode);else{var kb=void 0;({nwc:kb}=this.Jqp(e.currentNode,n)).returnValue&&(S+=kb,ja=!0)}Rb!==ya-1&&(S+="\r")}else if(14===e.uf)for(kb=e.Vb(1);kb;){for(kb=e.Vb(1);kb;)ja=({SUc:kb}=this.O3j(kb,n,C)).returnValue||ja,S+=kb,e.tLa||(S+="\t"),kb=e.Mv();S+="\r\n";kb=e.Mv()}e.uc()}e.uc()}return{returnValue:ja,SUc:S}}dGi(e){const n=
{rows:[],headers:[]};if(!({CBe:Rb}=this.OIg()).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType,Wve:n};const C=Ed.a.eb(Rb),S=[];var ja={};if((ja.isSelectionManagerNull=!this.ib)||(ja.isSelectionCollectionNull=!this.ib.gb))return E.ULS.sendTraceTag(8452252,341,10,"Unexpected error to selectionManager and contigousSelection data cannot return.{0}",ja),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Wve:n};for(var ya of this.ib.gb)S.push(...ya.toArray());
ja=[];var kb;var Rb=this.GG.Y8a(Rb);ya=0;for(kb=C.Vb(1);kb;){kb=!1;e===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&ya<Rb&&(kb=!0);for(var sc=C.Vb(1);sc;){if(!Uh.TableCellReader.gr(sc)){let Fc="";(({SUc:Fc}=this.O3j(sc,S,kb)).returnValue||kb)&&ja.push(Fc)}sc=C.Mv()}0<ja.length&&(sc=Array.clone(ja),kb?Array.add(n.headers,sc):Array.add(n.rows,sc),Array.clear(ja));kb=C.Mv();ya++}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Wve:n}}APj(e,n,C){if(this.gon())this.vkn()?this.ntf(e,n,C,
!1):C(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection);else{let S;if(({CBe:S}=this.OIg()).returnValue){let ja,ya;({Opn:ja,UOo:ya}=this.jKm(S));ja?(E.ULS.sendTraceTag(8458370,344,15,"SetSelectedTable failed due to the attempt to set data in a partially selected table"),C(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)):this.esn(ya,n,e)?this.J7l(S,ya,e,n,C):this.ntf(e,n,C,!0)}else this.ntf(e,n,C,!1)}}AOm(e){let n="";if(Uh.TableCellReader.gr(e))return{returnValue:!1,SUc:n};
e=Ed.a.eb(e);const C=e.ar();for(let S=0;S<C;S++)e.ZB(S)&&(e.je(),12===e.uf&&(n+=Af.ParagraphReader.text(e.currentNode),S!==C-1&&(n+="\r")),e.uc()),e.uc();return{returnValue:!0,SUc:n}}C2i(e){let n=!1;Pd.TableReader.Bqi(e,C=>{Uh.TableCellReader.gr(C)&&(n=!0)});return n}DNm(e,n,C){let S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const ja={},ya=this.GG.Y8a(e),kb=Pd.TableReader.vg(e)-(n?ya:0),Rb=Pd.TableReader.Eh(e);let sc,Fc,gd,td,Bd;sc=C[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];Fc=C[OSF.DDA.Marshaling.BindingParameterKeys.RowCount];
gd=C[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];C=C[OSF.DDA.Marshaling.BindingParameterKeys.ColCount];if(0>sc||sc>=kb||sc+Fc>kb||0>gd||gd>=Rb||gd+C>Rb)S=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn;else{td=Fc?sc+Fc-1:kb;Bd=C?gd+C-1:Rb;e=Ed.a.eb(e);const wd=[];let te;ja.rows=[];ja.headers=[];nh.forEachCellInTable(e,(Le,Oe,We)=>{const Xf=n&&Oe<ya,Gg=n?ya:0;Oe=Oe>=sc+Gg&&Oe<=td+Gg;We=We>=gd&&We<=Bd;(Xf||Oe)&&We&&({SUc:te}=this.AOm(Le.currentNode)).returnValue&&wd.push(te);Le.tLa&&
0<wd.length&&(Le=Array.clone(wd),Array.add(Xf?ja.headers:ja.rows,Le),Array.clear(wd));return!0})}return{returnValue:S,HNl:ja}}isTable(e,n){return e.id===n.id&&14===e.type?!0:!1}Ffe(e){if(!e||14!==e.type)return!1;let n=!0;const C=this.QFf(),S=new Ed.a;S.set(e);nh.forEachCellInTable(S,ja=>Uh.TableCellReader.gr(ja.currentNode)||this.Lde(ja.currentNode,C)?!0:n=!1);return n}fsn(){let e;return({CBe:e}=this.OIg()).returnValue?this.Ffe(e):!1}J7l(e,n,C,S,ja){const ya=ha.a.CTh,kb=[];kb.push(n);kb.push(C);kb.push(S);
kb.push(e);32===this.ga.Ob(ya,1)?this.ga.Zma(null,ya,kb,Rb=>{32!==Rb.response&&E.ULS.sendTraceTag(8458371,344,10,"SetSelectedTable failed with error {0}",Rb.response);ja(32===Rb.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):(E.ULS.sendTraceTag(8458372,344,10,"SetSelectedTable failed due to the action is not enabled"),ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection))}ntf(e,n,C,S){S?this.ga.Ob(pe.a.RW,2):this.ga.Ob(pe.a.gI,
2);n=this.UBl(e,n);e=new kf.DictionaryPropertySet;e.setValue(Gh.a.XX,n);e.setValue(Gh.a.GDa,!0);n=pe.a.Gqa;32===this.ga.Ob(n,1)?this.ga.Zma(null,n,e,ja=>{C(32===ja.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):C(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}UBl(e,n){const C=document.createElement("div"),S=document.createElement("table");var ja=document.createAttribute("border");ja.value="1";S.attributes.setNamedItem(ja);
C.appendChild(S);if(e&&e.length){ja=document.createElement("tr");S.appendChild(ja);for(var ya=0;ya<e.length;++ya){var kb=document.createElement("th");kb.innerText=e[ya]?e[ya].toString():"";ja.appendChild(kb)}}for(e=0;e<n.length;++e)for(ja=n[e],ya=document.createElement("tr"),S.appendChild(ya),kb=0;kb<ja.length;++kb){const Rb=document.createElement("td");Rb.innerText=ja[kb]?ja[kb].toString():"";ya.appendChild(Rb)}return C.innerHTML}esn(e,n,C){if(e.length!==n.length+(C?1:0))return!1;if(C){if(e[0].length<
C.length)return!1;for(C=1;C<e.length;++C)if(e[C].length<n[C-1].length)return!1}else for(C=0;C<e.length;++C)if(e[C].length<n[C].length)return!1;return!0}QFf(){const e=[];for(const n of this.ib.gb)e.push(...n.toArray());return e}jKm(e){let n=!1,C=!1,S=!1;const ja=[],ya=this.QFf();e=Ed.a.eb(e);var kb=e.Vb(1);let Rb=!0;for(;kb;){kb=[];let sc=e.Vb(1);for(;sc;)Uh.TableCellReader.gr(sc)?C=!0:this.Lde(sc,ya)?(Rb&&(S=!0),kb.push(sc)):n=!0,sc=e.Tk();Rb=!1;ja.push(kb);e.uc();kb=e.Tk()}return{Opn:n,R6p:C,O6p:S,
UOo:ja}}Lde(e,n){var C=this.Xxi(e);e=this.CAi(e);let S=0,ja=!1;for(;S<n.length;++S){const ya=n[S];if(ya.node===C)if(ya.contextId===Ma.a.paragraph||ya.contextId===Ma.a.Zc){ja=!0;++S;break}else return!1}if(!ja||C===e)return ja;for(;S<n.length;++S)if(C=n[S],C.node===e)if(C.contextId===Ma.a.paragraph||C.contextId===Ma.a.Zc){ja=!0;break}else return!1;return ja}isSelected(e,n){let C;for(let S=0;S<n.length;++S)if(C=Ed.a.eb(n[S].node),C.zb(16)&&C.kd(16)===e)return!0;return!1}CAi(e){e=Ed.a.eb(e);var n=e.ar();
for(--n;-1<n;--n){if(e.ZB(n)){e.je();if(12===e.uf)return e.currentNode;if(14===e.uf){const C=this.CAi(e.currentNode);if(C)return C}e.uc()}e.uc()}return null}Xxi(e){e=Ed.a.eb(e);const n=e.ar();for(let C=0;C<n;++C){if(e.ZB(C)){e.je();if(12===e.uf)return e.currentNode;if(14===e.uf){const S=this.Xxi(e.currentNode);if(S)return S}e.uc()}e.uc()}return null}vkn(){let e=null,n=null,C=Ed.a.eb(this.ib.J0);0<C.ar()&&C.je()&&C.je()&&14===C.uf&&(e=C.currentNode);C=Ed.a.eb(this.ib.J0);1<C.ar()&&C.n7()&&C.je()&&
14===C.uf&&(n=C.currentNode);return e&&!this.Ffe(e)||n&&!this.Ffe(n)?!1:!0}kKm(e){const n={},C=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(e.Sce())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported,WYj:n};const S=this.QFf(),ja=Ed.a.eb(e);let ya=-1,kb=-1,Rb=-1,sc=-1;nh.forEachCellInTable(ja,(Fc,gd,td)=>{if(this.isSelected(Fc.currentNode,S)){if(-1===ya||-1===kb)ya=gd,kb=td;Rb=Rb<gd?gd:Rb;sc=sc<td?td:sc}else if(-1<kb&&td>=kb&&td<=sc)return!1;return!0});C===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=this.GG.Y8a(e),Rb>=e&&(ya=ya>=e?ya-e:0,n[OSF.DDA.Marshaling.TableSubsetKeys.StartRow]=ya,n[OSF.DDA.Marshaling.TableSubsetKeys.RowCount]=Rb-e-ya+1),n[OSF.DDA.Marshaling.TableSubsetKeys.StartColumn]=kb,n[OSF.DDA.Marshaling.TableSubsetKeys.ColumnCount]=sc-kb+1);return{returnValue:C,WYj:n}}Oen(e,n){let C=0;for(let S=0;S<n.length;S++)n[S].length>C&&(C=n[S].length);return C===e}Nen(e,n,C,S,ja){let ya=[];ja||(C=Array(e));return(!C&&!e||C&&C.length===e)&&
n===S.length?(ya=C.concat(S),{returnValue:!0,XZj:ya}):{returnValue:!1,XZj:ya}}Xtn(e,n,C,S,ja){e=e?this.GG.Y8a(n):0;if(!C||!S||C.length<S.length+e)return!1;if(ja){if(ja.length!==e)return!1;for(n=0;n<S.length+e;n++)if(C[n].length<(n<e?ja[n]:S[n-e]).length)return!1}else for(ja=0;ja<S.length;ja++)if(C[ja].length<S[ja].length)return!1;return!0}Hqp(e,n,C){const S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;let ja=0,ya=0;ja=C.startRow;ya=C.startCol;const kb=this.GG.Y8a(e),Rb=n?kb:0,sc=[],Fc=[],gd=Ed.a.eb(e);
nh.forEachCellInTable(gd,(td,Bd,wd)=>{if(!Uh.TableCellReader.Ng(gd)){const te=Bd>=ja+Rb;wd=wd>=ya;(n&&Bd<kb||te)&&wd&&sc.push(td.currentNode);td.tLa&&0<sc.length&&(td=Array.clone(sc),Fc.push(td),Array.clear(sc))}return!0});return{returnValue:S,yip:Fc}}Kfo(e,n,C){const S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ja=[],ya=[],kb=[],Rb=C?C.length:0;for(let sc=0;sc<n.length+Rb;sc++){const Fc=sc<Rb?C[sc]:n[sc-Rb],gd=e[sc];for(let td=0;td<Fc.length;td++)ya.push(gd[td]),kb.push(Fc[td])}ja.push(ya);ja.push(kb);
return{returnValue:S,Nip:ja}}}Object(F.a)(Ke,"TableMatrixHelper",null,[]);var cg=d(1898),ub=d(81),ec=d(82),Tc=d(63),bd=d(1536);class le{}Object(F.a)(le,"JSanityOptions",null,[]);class tf extends bd.a{constructor(e,n,C,S,ja){super(e,n,C);this.Zhb=S;this.kk=ja}lFp(){return Dk.a.TAe}vAc(e){var n;let C=null;if(this.sT&&!e)return E.ULS.sendTraceTag(594408837,307,10,"No htmlDomContent"),{returnValue:!1,Lka:C};if(!this.lFp())return this.Ac.fc(ec.a.asa,{["Reason"]:Tc.a.dXh}),{returnValue:!1,Lka:C};try{if(null===
(n=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===n?0:n.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_7588861_InsertHtmlEnhancement")){const ja=this.kk.pcb(e),ya=this.kk.wBf(e).getElementsByTagName("style");if(0<(null===ya||void 0===ya?void 0:ya.length)&&this.Zhb&&ja){for(n=0;n<ya.length;n++)this.Zhb.M7h(ja,ya[n]);e=ja.innerHTML}}const S=tf.kzl(e);C=jSanity.sanitize(S)}catch(S){return E.ULS.shipAssertTag(6423694,
307,!1),this.Ac.fc(ec.a.asa,{["Reason"]:Tc.a.alf}),{returnValue:!1,Lka:C}}return{returnValue:!0,Lka:C}}static kzl(e){var n;const C=new le;C.inputString=e;C.allowLinks=!0;C.customProtocols={};C.customProtocols["data:image/"]=1;C.externalContentCallback=(S,ja,ya,kb)=>{let Rb=!1;if("attribute"===S&&"src"===ja){ja=ub.a.CR(kb);for(const sc of ja)if(ya.startsWith(sc)){Rb=!0;break}ja=ub.a.CR(C.customProtocols);for(const sc of ja)if(ya.startsWith(sc)){Rb=!0;break}}Rb||(ya="CSSURL"===S?'url("about:blank")':
"about:blank");return ya};if(null===(n=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===n?0:n.getBooleanFeatureGate("Microsoft.Office.WordOnline.PreserveParastyleAttributeIsEnabled",!1))C.dataAttributeCallback=(S,ja)=>"data-ccp-parastyle"===S?ja:null;return C}}Object(F.a)(tf,"ExternalHtmlStringImportStrategy",bd.a,[]);var pf=d(232);class rf{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc=null,gd=null){var td;this.nRc=!1;this.y_o=4;this.x_o=(Bd,wd,
te,Le,Oe)=>{if(1===te)return 32;if(!Oe||Oe.length!==this.y_o)return 8;Bd=Oe[0];Le=Oe[1];wd=Oe[2];te=Oe[3];Oe=this.Rc.Lc(15);Oe.Ab(te);if(32!==this.ga.Ob(pe.a.Bra,2))return 8;te=0;if(Le){for(var We=0;We<Le.length;++We){var Xf=Bd[te];Le[We]&&this.aQj(Xf[We],Le[We].toString())}te++}for(Le=0;Le<wd.length;++Le){We=wd[Le];Xf=Bd[te];for(let Gg=0;Gg<We.length;++Gg)We[Gg]&&this.aQj(Xf[Gg],We[Gg].toString());te++}Oe.dispose();return 32};this.UPi=(Bd,wd,te,Le,Oe,We)=>{var Xf,Gg;if(wd===pe.a.Gqa&&(null===(Xf=
te.view)||void 0===Xf?0:Xf.ve)&&(Xf=te.view,Xf.lb&&(null===(Gg=this.xl)||void 0===Gg?0:Gg.ama(Xf.lb.Pg))))return null;Gg=this.yz.K(wd.toString());this.Bja&&We&&Object(Eh.a)(73,We)&&(Xf=this.Bja.cqd(),Xf.Ycc("ImportDataAction"),We.setValue(Gh.a.Zya,Xf));return this.IVd.create(Bd,wd,Gg,new id.a(()=>this.QYc(wd,We)),te,Le,Oe,We)};this.ga=e;this.zd=n;this.Rd=S;this.Hqk=ya;this.Rc=ja;this.kk=kb;this.Bja=Fc;this.jT=C;this.xl=sc;this.Zhb=gd;Rb&&(this.nRc=Rb.$("UseClipboardDataHelperInMultiLineImportIsEnabled"));
this.yz=new fd.a;this.yz.W(pe.a.vSd.toString(),262145);this.yz.W(pe.a.Gqa.toString(),262145);if(null===(td=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===td?0:td.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveEmptyParagraphAfterPasteIsEnabled",!1))e=this.yz.K(pe.a.Gqa.toString()),this.yz.W(pe.a.Gqa.toString(),e|524288)}get IVd(){return this.Hqk.value}Xb(){this.ga.wW(pe.a.vSd,Ma.a.view,this.UPi,1028);this.ga.wW(pe.a.Gqa,Ma.a.view,
this.UPi,4|(G.AFrameworkApplication.dv&&16384));this.ga.fb(ha.a.CTh,Ma.a.view,this.x_o,4)}aQj(e,n){e=Ed.a.eb(e);e.Vb(1)||this.jT.Tja(e,!0);e=tl.OutlineElementNavigator.Me(e);this.Rd.We(ce.a.Uc(e,0),n)}QYc(e,n){if(e===pe.a.vSd)return new cg.a(n,this.zd,this.kk,this.nRc,pf.WoncaApp.instance.v_a);if(e===pe.a.Gqa)return new tf(n,this.zd,pf.WoncaApp.instance.v_a,this.Zhb,this.kk);E.ULS.shipAssertTag(6348963,341,!1,"Could not find an import strategy for action {0}",e);return null}}Object(F.a)(rf,"AppsForOfficeApiActor",
null,[]);class Hg{constructor(e,n,C,S=null){this.appName=e;this.appVersion=n;this.clientMode=C;this.formFactor=S||"DefaultSettings"}}Object(F.a)(Hg,"HostInfo",null,[]);class Fh{constructor(e,n,C=null){this.appUILocale=e;this.dataLocale=n;this.lcid=C}}Object(F.a)(Fh,"LocaleInfo",null,[]);var Ef=d(1352);class Bc{constructor(){this.startTime=0;this.callback=null}}Object(F.a)(Bc,"SSOCallbackInfo",null,[]);class Qm{constructor(){this.accessToken=null}}Object(F.a)(Qm,"AccessTokenInformation",null,[850]);
class mm{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.R5a=this.I1b=this.vJf=this.dOf=this.I4c=this.mGg=null}}Object(F.a)(mm,"AppsForOfficeOauthResult",null,[]);class Eg{constructor(){this.token=null;this.expiresOn=0;this.R5a=this.authChallenge=null}}Object(F.a)(Eg,"CachedTokenInfo",null,[]);class Xh{constructor(){this.oia=new fb.a;this.kTa=this.jTa=!1;this.Ueb=this.authChallenge=null;this.startTime=this.retryCount=0;this.iQh=null}get callbacks(){return this.oia}}Object(F.a)(Xh,
"SSORequestInfo",null,[]);class rq extends Xh{constructor(){super();this.errorCode=0}}Object(F.a)(rq,"SSOFailedRequestInfo",Xh,[]);class on{static LLa(e,n,C,S){var ja=e.startTime;let ya=0;0<ja&&(ya=on.Xp()-ja);ja={["callInstanceId"]:ja.toString(),["callDuration"]:ya.toString(),["errorCode"]:n.toString()};if(S)for(const kb in S)ja[kb]=S[kb];E.ULS.sendTraceTag(51401116,344,50,"{0}",ja);Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:Ad.a.iI(ja)}));
e.callback(n,C)}static Xp(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(e){}return Date.now()}}Object(F.a)(on,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class Dl{constructor(e,n,C,S){this.Npa=new fb.a;this.t5=new fb.a;this.Ogb=null;this.cOc=new fb.a;this.bsh=Promise.resolve(null);this.gFh=!1;this.OKd=n;this.YPa=e;this.dNd=C;this.Qmk=S}Z4o(e){if(this.Ogb&&this.Ogb.authChallenge===e.authChallenge){if(Date.now()/1E3+Dl.zLn>this.Ogb.expiresOn)return this.Ogb=
null,!1;e=new mm;e.token=this.Ogb.token;e.expiresOn=this.Ogb.expiresOn;e.R5a=this.Ogb.R5a;e.I1b=!0;e.I4c=0;this.B5c(e);return!0}return!1}Y2o(e){for(let n=0;n<this.t5.count;n++)if(this.t5.K(n).authChallenge===e.authChallenge&&this.t5.K(n).Ueb===e.Ueb){let C;(C=this.t5.K(n)).retryCount=C.retryCount+1;e.retryCount=this.t5.K(n).retryCount;if(this.t5.K(n).retryCount<Dl.t7f||!this.t5.K(n).jTa&&e.jTa||!this.t5.K(n).kTa&&e.kTa){if(!this.t5.K(n).jTa&&e.jTa||!this.t5.K(n).kTa&&e.kTa)e.retryCount=0;this.t5.removeAt(n);
break}e=new mm;e.errorCode=this.t5.K(n).errorCode;this.B5c(e);return!0}return!1}y_k(e,n){for(let C=0;C<this.t5.count;C++)if(this.t5.K(C).Ueb===e.Ueb&&this.t5.K(C).authChallenge===e.authChallenge)return;this.t5.add(Object.assign(new rq,{jTa:e.jTa,kTa:e.kTa,authChallenge:e.authChallenge,Ueb:e.Ueb,errorCode:n,retryCount:e.retryCount}))}get resource(){return this.OKd}yFf(e,n,C,S,ja,ya){""===C&&(C=null);if(this.gFh)on.LLa(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var kb=
null;for(const Rb of this.Npa)if(Rb.jTa===e&&Rb.kTa===n&&Rb.authChallenge===C&&Rb.Ueb===ja){kb=Rb;break}kb||(kb=Object.assign(new Xh,{jTa:e,kTa:n,authChallenge:C,iQh:S,Ueb:ja,retryCount:0,startTime:on.Xp()}),this.Npa.add(kb));kb.retryCount=0;kb.callbacks.add(ya);this.bsh=this.bsh.then(()=>{if(0<this.Npa.count){var Rb=this.Npa.K(0);if(this.Z4o(Rb)||this.Y2o(Rb))return null;for(var sc=0;sc<this.cOc.count;)this.cOc.K(sc)+Dl.blp<on.Xp()?this.cOc.removeAt(sc):sc++;if(this.cOc.count>=Dl.WLn||this.Npa.count>=
Dl.tLn)return Rb=new mm,Rb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.B5c(Rb),null;let Fc=null;G.AFrameworkApplication.ua&&(sc=G.AFrameworkApplication.ua.Vr)&&(Fc=sc.Xf("ComponentAttach",this.YPa+Dl.WOk));return Rb.Ueb.fUk(this.resource,Rb.jTa,Rb.kTa,Rb.authChallenge,this.Qmk,Rb.iQh).then(gd=>{Fc&&Fc.stop();this.B5c(gd)},()=>{Fc&&Fc.stop();const gd=new mm;gd.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.B5c(gd)})}return null})}}B5c(e){try{if(this.Npa.count){var n=
this.Npa.K(0);this.Npa.removeAt(0);var C=null;e.errorCode||(C=new Qm,C.accessToken=e.token);e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.y_k(n,e.errorCode);var S={};null!=e.I4c&&(S.getTokenSilentTime=e.I4c.toString());null!=e.dOf&&(S.getTokenPopupTime=e.dOf.toString());
null!=e.vJf&&(S.getIDTokenTime=e.vJf.toString());null!=e.I1b&&(S.tokenCached=e.I1b.toString());e.mGg&&(S.detailedError=e.mGg);e.R5a&&(S.authLibrary=e.R5a);n.retryCount&&(S.retryCount=n.retryCount);for(var ja of n.callbacks)on.LLa(ja,e.errorCode,C,S);null!=e.I1b&&e.I1b||this.cOc.add(n.startTime);if(!e.errorCode)for(null!=e.expiresOn&&(this.Ogb=Object.assign(new Eg,{token:e.token,expiresOn:e.expiresOn,authChallenge:n.authChallenge,R5a:e.R5a})),this.t5.clear(),ja=0;ja<this.Npa.count;)if(this.Npa.K(ja).authChallenge===
n.authChallenge){for(const ya of this.Npa.K(ja).callbacks)on.LLa(ya,e.errorCode,C,S);this.Npa.removeAt(ja)}else ja++}}catch(ya){E.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ya.message)}}shutdown(){this.gFh=!0;this.Npa.clear()}}Dl.blp=6E4;Dl.WLn=6;Dl.tLn=6;Dl.t7f=3;Dl.zLn=300;Dl.WOk="GetAccessToken";Object(F.a)(Dl,"SSOCallbackManager",null,[]);var Zm=d(634);class tj{constructor(e,n,C=null){this.S3b=new fd.a;const S=new fb.a;n&&S.add(n.YIn);C&&S.addRange(C);
this.ek=e;this.NQk=S}$yo(e){this.S3b.tb(e)&&(this.S3b.K(e).shutdown(),this.S3b.remove(e))}zFf(e,n,C,S,ja,ya,kb,Rb,sc,Fc){Fc=Object.assign(new Bc,{startTime:on.Xp(),callback:Fc});try{const Bd=!!C&&""!==C;var gd=Fc.startTime;const wd=this.getOsfControl(e);let te=wd.getStoreType()||"",Le=wd.getOwnerAddinStoreType()||"",Oe=wd.getSolutionId()||"";const We=wd.getVersion()||"";te=te.toLowerCase();Le=Le.toLowerCase();Oe=Oe.toLowerCase();var td=N.a.sJf(n)||"";const Xf=N.a.sJf(wd.getIframeUrl())||"",Gg=td.toLowerCase()===
Xf.toLowerCase();td=te;"inmemory"===te&&(td=Le);const Ph=Telemetry.PrivacyRules.GetPrivacyCompliantId(Oe,td,wd.getAssetId(),null,null,wd.getStoreId()),Aj={["callInstanceId"]:gd.toString(),["controlSolutionId"]:Ph,["controlVersion"]:We,["storeType"]:te,["ownerStoreType"]:Le,["allowConsentPrompt"]:S.toString(),["forMSGraphAccess"]:ja.toString(),["allowSignInPrompt"]:ya.toString(),["hasAddinAuthChallenge"]:Bd.toString(),["securityOriginEqualsSourceLocation"]:Gg.toString(),["singleSignOnEnabled"]:kb.toString(),
["accountTypeFilter"]:Rb||""};E.ULS.sendTraceTag(51401115,344,50,"{0}",Aj);Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:Ad.a.iI(Aj)}));gd=!0;const Ih=G.AFrameworkApplication.J.jb("HostAuthType");switch(Rb){case "aad":gd="aad"===Ih;break;case "msa":gd="msa"===Ih;break;default:gd=!Rb||"noFilter"===Rb}if(gd){Rb=null;if(kb)for(const Nm of this.NQk)if(Nm.Fjn(Oe)){Rb=Nm;break}Rb?this.isSSOAddin(e)?(kb=!0,"omex"===td&&(kb=!1),"spapp"===
td||"spcatalog"===td?(E.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),on.LLa(Fc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ja&&!kb?(E.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),on.LLa(Fc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ja&&"exchange"===td&&(S=!1),this.yFf(e,n,C,td,S,ya,sc,Rb,Fc))):(E.ULS.sendTraceTag(22402395,344,
10,"GetAccessToken: current Addin is not a SSO Addin."),on.LLa(Fc,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):on.LLa(Fc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else on.LLa(Fc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Bd){this.Ehe(),E.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Bd.message),on.LLa(Fc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(e,
n,C,S){this.zFf(e,C[$b.a.dgf]||null,C[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,C[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,C[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,C[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,n,C[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,C[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,S)}yFf(e,n,
C,S,ja,ya,kb,Rb,sc){this.S3b.tb(e)?S=this.S3b.K(e):(S=new Dl(e,this.getWebApplicationResource(e).split(",")[0],S,this.getDefaultDisplayName(e)),this.S3b.add(e,S));const Fc=S.resource;e=tj.EIm(Fc,this.getWebApplicationId(e));const gd=OfficeExt.WACUtils.getHostSecure(n);e&&gd?e.toLowerCase()===gd.toLowerCase()?S.yFf(ja,ya,C,kb,Rb,sc):(tj.iVb('SSO Resource "'+Fc+'" cannot be used from "'+n+'" origin due to domain mismatch.'),E.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),
on.LLa(sc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(e||E.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),gd||E.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),on.LLa(sc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Ehe(){E.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(e){return this.ek.getOsfControl(e)}isSSOAddin(e){return this.getOsfControl(e).getManifest().isSSOAddin()}getWebApplicationId(e){return this.getOsfControl(e).getManifest().getWebApplicationId()}getWebApplicationResource(e){return this.getOsfControl(e).getManifest().getWebApplicationResource()}getDefaultDisplayName(e){return this.getOsfControl(e).getManifest().getDefaultDisplayName()}static pLm(){try{const e=
{};Dk.a.mXa&&Zm.a.r6c&&(e.UiHostSupportsAuthTokenAddinList=tj.Ooi);e.UiHostSupportsAuthToken=Zm.a.r6c;return e}catch(e){E.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",e.message)}return null}static getInstance(e,n,C=null){tj._instance||(tj._instance=new tj(e,C));return tj._instance}static xol(e){tj._instance&&tj._instance.$yo(e)}static iVb(e){window.console.warn&&window.console.warn(e)}static EIm(e,n){if(!e)return"";n||(n="");let C=e.toLowerCase();var S=
n.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(S)||(tj.iVb('SSO App Id "'+n+'" is not a valid format. It will be rejected from store submission.'),E.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));C.endsWith(S)||(tj.iVb('SSO Resource "'+e+'" does not end with App Id "'+n+'". It will be rejected from store submission.'),E.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!C.startsWith("https://")&&!C.startsWith("api://"))return tj.iVb('SSO Resource "'+
e+'" must be https:// or api:// protocol.'),E.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(n=0;n<e.length;n++){S=e.charAt(n);const ja=Of.a.charCodeAt(e,n);if(33>ja||126<ja||"&"===S||"?"===S||"#"===S||"%"===S||"\\"===S)return tj.iVb('SSO Resource "'+e+'" contains an invalid character "'+S+'".'),E.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+S+"' in resource URI."),""}if(0<=e.indexOf("::"))return tj.iVb('SSO Resource "'+e+'" contains an invalid string "::".'),
E.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<e.length)return tj.iVb('SSO Resource "'+e+'" is '+e.length+" characters and exceeds the max length of 120 characters."),E.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+e.length+"."),"";C.startsWith("api://")&&(C="https://"+C.substring(6,C.length));return 8===C.length?"":OfficeExt.WACUtils.getHostSecure(C)||""}}tj.Ooi="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
tj._instance=null;Object(F.a)(tj,"AppsForOfficeSingleSignOnManager",null,[821]);var qj=d(101);class Fk{constructor(e=null,n=null,C,S=null,ja=null,ya=null,kb=null,Rb=null,sc=null,Fc=null,gd=null,td=null,Bd=null,wd=null,te=null,Le=null){this.osfOmexBaseUrl=e;this.devCatalogUrl=n;this.spBaseUrl=S;this.docUrl=ja;this.pageBaseUrl=ya;this.localizedScriptsUrl=kb;this.localizedImagesUrl=Rb;this.localizedStylesUrl=sc;this.localizedResourcesUrl=Fc;this.firstPartyManifestCDNUrl=gd;this.sdxCdnUrl=td;this.sdx1CdnUrl=
wd;this.sdxDmsUrl=Bd;this.sovereignFederationDMSToken=te;this.sovereignFederationDMSTokenSuffix=Le}}Object(F.a)(Fk,"UrlInfo",null,[]);class Jq{constructor(e,n=null){this.userNameHashCode=e;this.loggableUserId=n}}Object(F.a)(Jq,"UserInfo",null,[]);class Zr{constructor(){this.hostFeatureGateFlag=0;this.JWc=!1}gzi(){return new Hg(OSF.AppName.WordWebApp,"16",OSF.ClientMode.ReadWrite)}iBi(){const e=ac.a.Eg(G.AFrameworkApplication.lcid);return new Fh(e?e.name:null,Ef.a.dataCulture.name,G.AFrameworkApplication.lcid.toString())}rAm(){G.AFrameworkApplication.J.$("SetAppContextInIframeNameIsEnabled")&&
(this.hostFeatureGateFlag|=1);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SetAppContextInIframeEnabledFor3rdPartyIsEnabled",!1)&&(this.hostFeatureGateFlag|=2);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitFlightingTreatmentAppSettings",!1)&&(G.AFrameworkApplication.J.appSettings.FlightingTreatmentVariables=G.AFrameworkApplication.J.j8a);return{["omexForceAnonymous"]:!1,["allowExternalMarketplace"]:G.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&
this.JWc,["approvedAddIns"]:G.AFrameworkApplication.J.jb("ApprovedAddIns"),["enableAddinCommands"]:G.AFrameworkApplication.J.$("AddInCommandsIsEnabled"),["enableBlackForestRedirect"]:G.AFrameworkApplication.J.$("BlackForestRedirectIsEnabled"),["enableMyApps"]:G.AFrameworkApplication.J.$("InsertAgaveEnableMyAppsForHost"),["enableMyOrg"]:G.AFrameworkApplication.J.$("InsertAgaveMyOrgEnabledForHost"),["enableDevCatalog"]:G.AFrameworkApplication.J.$("AppsForOfficeDevCatalogIsEnabled"),["enableTaskpaneUpgradeToAppCommand"]:G.AFrameworkApplication.J.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled"),
["enableUploadFileDevCatalog"]:G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&!G.AFrameworkApplication.J.$("UploadFileDevCatalogIsDisabled"),["enablePrivateCatalog"]:G.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled"),["showSignOutFromPrivateCatalogMessage"]:G.AFrameworkApplication.J.$("ShowSignOutFromPrivateCatalogMessage"),["envCode"]:G.AFrameworkApplication.J.appSettings.OfficeAddinTelemetryDataSourceCode,["enableFirstPartySSO"]:G.AFrameworkApplication.J.$("WordEditorAppsForOfficeFirstPartySSO"),
["enableSingleSignOnForAddin"]:G.AFrameworkApplication.J.$("WordEditorAppsForOfficeSingleSignOnIsEnabled")&&G.AFrameworkApplication.rfn,["hideAppsExtensionUrl"]:G.AFrameworkApplication.hideAppsExtensionUrl,["enableAnonymousUseLegacyCatalogService"]:G.AFrameworkApplication.J.$("AnonymousUseLegacyCatalogServiceIsEnabled"),["enableInsertDialogAccessibilityFix"]:G.AFrameworkApplication.J.$("OfficeAddinEnableInsertDialogAccessibilityFix"),["FollowDestinationFormattingPasteIsEnabled"]:!1,["enableDisplayBlockedMinorError"]:G.AFrameworkApplication.J.$("WordEditorDisplayBlockedMinorErrorIsEnabled"),
["disableAppsForOfficeThirdParty"]:G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled"),["wacSessionId"]:G.AFrameworkApplication.userSessionId,["disableLogging"]:!G.AFrameworkApplication.J.$("AriaLoggingIsEnabled"),["enableFirstPartySDXErrorMessages"]:G.AFrameworkApplication.J.$("OfficeAddinEnableFirstPartySDXErrorMessages"),["isHostDocumentDomain"]:G.AFrameworkApplication.J.$("AppsForOfficeIsJSHostDocumentDomain"),["sessionStartInfoJson"]:G.AFrameworkApplication.J.jb("SessionStartInfoJson"),
["FollowDestinationThemePasteIsEnabled"]:!1,["sdxAssetsToPrefetchMapping"]:G.AFrameworkApplication.J.jb("SdxAssetsToPrefetchMapping"),["wopiHostOriginFromPostMessage"]:G.AFrameworkApplication.wopiHostOriginFromPostMessage,["wopiHostOriginFromWacPropBag"]:G.AFrameworkApplication.J.jb("PostMessageOrigin"),["wacIsEmbedded"]:G.AFrameworkApplication.J.$("IsEmbedded"),["accessibilityAllowFocusAddinTaskpane"]:G.AFrameworkApplication.J.$("AccessibilityAllowFocusAddinTaskpane"),["isHostFrameTrustCheckEnabledForAddIns"]:G.AFrameworkApplication.J.$("HostFrameTrustCheckIsEnabledForAddIns"),
["isHostFrameTrusted"]:G.AFrameworkApplication.isHostFrameTrusted,["isUpnCheckEnabled"]:G.AFrameworkApplication.J.$("IsUpnCheckEnabled"),["wacUpn"]:G.AFrameworkApplication.J.jb("UserPrincipalName"),["hostInstallAddIns"]:G.AFrameworkApplication.J.jb("HostInstallAddIns"),["hostInstallAddInsIsEnabled"]:G.AFrameworkApplication.J.$("HostInstallAddInsIsEnabled"),["hostAllowedOfficeStore"]:G.AFrameworkApplication.J.$("HostAllowedOfficeStore"),["hostAllowedSdxEmbedding"]:G.AFrameworkApplication.J.$("HostAllowedSdxEmbedding"),
["addinEnforceHttpsIsEnabled"]:G.AFrameworkApplication.J.$("AddinEnforceHttpsIsEnabled"),["hostFeatureGateFlag"]:this.hostFeatureGateFlag,["appSettings"]:G.AFrameworkApplication.J.appSettings,["singleSignOnSettings"]:tj.pLm(),["flightingTreatmentVariables"]:G.AFrameworkApplication.J.j8a,["addinActionDefinitionHybridModeIsEnabled"]:G.AFrameworkApplication.J.$("AddinActionDefinitionHybridModeIsEnabled"),["AllowStorageAccessByUserActivationOnIFrame"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AllowStorageAccessByUserActivationOnIFrame",
!1),["enableSetFocusOnTaskpaneOnUserAction"]:!0,["officeJsUrl"]:G.AFrameworkApplication.mC("OfficeJs/word.js",5),["enableOfficeJsUrlParam"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableOfficeJsUrlParam",!1)}}yQm(){var e=G.AFrameworkApplication.bNg?G.AFrameworkApplication.J.jb("StaticContentHostNonOverriden"):qj.a.o4;const n=e+qj.a.Cpf,C=e+qj.a.cWc;e+=qj.a.Z4h;const S=qj.a.xTk(qj.a.cWc);return new Fk(G.AFrameworkApplication.J.appSettings.AppsForOfficeOmexBaseUrl,
G.AFrameworkApplication.J.appSettings.AppsForOfficeDevCatalogUrl,null,G.AFrameworkApplication.vRh,G.AFrameworkApplication.J.appSettings.EditDocInClientUrl,G.AFrameworkApplication.J.appSettings.StaticContentHost,n,C,e,S,G.AFrameworkApplication.J.appSettings.AppsForOfficeFirstPartyManifestUrl,G.AFrameworkApplication.J.jb("SdxCdnUrl"),G.AFrameworkApplication.J.appSettings.SdxDmsUrl,G.AFrameworkApplication.J.jb("Sdx1CdnUrl"),G.AFrameworkApplication.J.jb("SovereignFederationDMSToken"),G.AFrameworkApplication.J.jb("SovereignFederationDMSTokenSuffix"))}KQm(){const e=
G.AFrameworkApplication.J.jb("LoggableUserId");return new Jq(Of.a.HT(G.AFrameworkApplication.userName),e)}}Object(F.a)(Zr,"WordEditorActivationSettingsProvider",null,[1098]);class kc{constructor(e){this.dKe=e}$Ff(e){const n={};e=this.YFf(e);if(!e)return E.ULS.sendTraceTag(7143683,344,15,"propertyIterator is null"),n;if(!e.Vb(21))return n;do{var C=e.currentNode;const S=C.getValue(hb.a.bTc);C=C.getValue(hb.a.Scc);n[S]=C}while(e.Kf(21));return n}CLo(e,n){n||(E.ULS.sendTraceTag(7143684,344,15,"property is null, assume it means empty setting"),
n={});let C=this.YFf(e);if(!C)return E.ULS.sendTraceTag(7143685,344,15,"propertyIterator is null"),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const S=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled");for(;C.Vb(21);)C.y7a(!S);C=this.YFf(e);for(const ja in n){const ya=this.ftf(ja,n[ja]),kb=Tj.a.create();C.d6(ya,21,new Wc.a(kb,1),!S)}S&&(Object(Eh.a)(97,e)?e.fC(21):E.ULS.sendTraceTag(22024345,344,15,"appObj is not a graph node"));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}dispose(){}ftf(e,
n){const C=this.dKe.create(cj.a.BKb);C.setValue(hb.a.bTc,e);C.setValue(hb.a.Scc,n);return C}YFf(e){if(!Object(Eh.a)(97,e))return E.ULS.sendTraceTag(7143686,344,15,"appObj is not a graph node"),null;let n=null;e&&(n=new Ed.a,n.set(e));return n}}Object(F.a)(kc,"WordEditorAfoSettingsModel",null,[1095,10]);class ck{constructor(e,n,C){this.zW=e;this.BO=n;this.QQ=C}}Object(F.a)(ck,"AppBindingData",null,[]);var pn=d(104);class Ul{constructor(e,n,C,S,ja){this.uH=ja;this.DCd=0;this.vP=()=>{this.jd.raiseEvent(Ul.ewg)};
this.jd=new eb.a;this.lb=e;this.Pb=n;this.TNk=C;this.mea=S}get QNa(){return this.TNk}SPh(e){this.DCd||this.lb.AB(this.vP);this.jd.addHandler(Ul.ewg,e);this.DCd++}Qrg(e){this.jd.removeHandler(Ul.ewg,e);this.DCd--;this.DCd||this.lb.gna(this.vP)}getSelectedText(){let e="";for(const n of this.lb.gb)e+=this.w8d(n);if(e===pn.AParagraphNode.RB)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,nwc:e};e=pn.AParagraphNode.KP(e);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
nwc:e}}w8d(e){var n=8|(ka.a.F8?4:0);if(0!==n)return this.uH.getSelectedText(n,e);n="";if(e)for(const C of e){e=C.cpBegin;const S=C.cpEnd-e;let ja="";Af.ParagraphReader.Wb(C.node)&&(ja=C.node.characterData);switch(C.contextId){case Ma.a.paragraph:n+=ja+"\r";break;case Ma.a.Cd:0<S&&(n+=ja.substr(e,S));break;case Ma.a.Zc:n+="\r"}}return n}DZo(e,n){this.cmg(pe.a.vSd,e,n)}yZo(e,n,C,S){const ja=document.createElement("img");e=e.trim();var ya=new ii.a;let kb=ya.Hla(n/72,0),Rb=ya.Hla(C/72,0),sc="";n=()=>
{var Fc=ja.width;const gd=ja.height;if(gd&&Fc){if(kb&&!Rb||!kb&&Rb)Fc/=gd,kb?Rb=kb/Fc:kb=Rb*Fc;sc=this.l$h(e,kb,Rb);this.cmg(pe.a.Gqa,sc,S)}else S(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};C=()=>{S(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};ya=!1;(ya=void 0!==ja.onload&&void 0!==ja.onerror)?(ja.onload=n,ja.onerror=C,ja.src=String.format("data:image/png;base64,{0}",e)):(sc=this.l$h(e,kb,Rb),this.cmg(pe.a.Gqa,sc,S))}l$h(e,n,C){return String.format("<img src='data:image/png;base64,{0}'{1}{2} />",
e,n?String.format(" width='{0}px'",n):"",C?String.format(" height='{0}px'",C):"")}cmg(e,n,C){const S=new kf.DictionaryPropertySet;S.setValue(Gh.a.XX,n);S.setValue(Gh.a.GDa,!0);S.setValue(Ee.a.FBa,!0);32===this.Pb.Ob(e,1)?this.Pb.Zma(null,e,S,ja=>{C(32===ja.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):C(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}}Ul.ewg="SelectionChangedEventKey";Object(F.a)(Ul,"ApiObjectModel",
null,[1097]);var Kq=d(92),Tm=d(84);const Eo=e=>{switch(e){case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:return!0;default:return!1}};class Dn{constructor(e){this.tB=e}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.tB)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1:return this.oTn()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}oTn(){this.notifyActionHandlerReady();return null}}Object(F.a)(Dn,"AddinInternalService",null,[]);class vo{constructor(e,n,C,S){this.menuItemId=
e;this.ZNa=n;this.mfp=C;this.A7l=S}}Object(F.a)(vo,"NewDocumentParameters",null,[]);var pc=d(1396);class Dm{constructor(e,n,C,S,ja,ya){this._context=e;this.Utk=n;this.Aa=C;this.zFk=S;this.px=ja;this.ek=ya}createDocument(e){pc.a.ej()||pc.a.Kj();e&&e.length>this.Aa.jc("WordEditorCreateDocumentApiMaxAllowedBase64",52428800)&&(E.ULS.sendTraceTag(36714716,369,15,"Too large base64 stream size:{0}",e.length),pc.a.td());this._context.Cn.CF();const n=new vo("blank","agave",e?"streamBase64":"streamEmpty",e);
return OfficeExtension.WacRuntime.Utility.createPromise((C,S)=>{const ja=new pb.StandardDialog;ja.Bd=4;ja.sw(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,ya=>{2!==ya&&ya?this.zFk.create(C,S,n).FXc():S("Cancelled")})}).then(C=>{this._context.Cn.Dv();return C?OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Utk.create(C)):(pc.a.hg(),null)},C=>{this._context.Cn.Dv();"Cancelled"===C?pc.a.glp():pc.a.hg();return null})}getEnterpriseUserInfo(){return null}getMruFriendlyPath(){return null}getSharePointTenantRoot(){return null}isTapEnabled(){pc.a.Kj();
return!1}launchFileUrlInOfficeApp(){return!1}openDocument(e){pc.a.y6n||pc.a.Kj();e.endsWith(".docx")||pc.a.td();const n=this._context.appId?this.ek.value.getOsfControl(this._context.appId).getManifest().getDefaultDisplayName():"";return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=new pb.StandardDialog;S.Bd=4;S.sw(String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,n),"This Add-In is about to open the document "+e,1,ja=>{1===ja&&wb.a.Tm(e+"?web=1",void 0,void 0,"ExtensionPackage.OpenDialog");
C(null)})})}retrieveStylesFromBase64(e){pc.a.qIp()||pc.a.Kj();return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{this.px.SIo(e,n,C)})}getTypeName(){return"Microsoft.WordServices.Application"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1004:return this.zrm();case 1005:return this.SAm(n);case 1003:return this.$Km();case 1002:return this.aun();case 1006:return this.Zyn(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1001:return this.tFl(n);case 1008:return this.z6n(n);case 1007:return this.TIo(n)}e=this.invokeMethod(e,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}tFl(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.createDocument(e)}zrm(){return this.getEnterpriseUserInfo()}SAm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getMruFriendlyPath(e)}$Km(){return this.getSharePointTenantRoot()}aun(){return this.isTapEnabled()}Zyn(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.launchFileUrlInOfficeApp(n,e)}z6n(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.openDocument(e)}TIo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.retrieveStylesFromBase64(e)}}Object(F.a)(Dm,"Application",null,[]);class wo{constructor(){this.zJ=null}get types(){return this.zJ}set types(e){this.zJ=e}getTypeName(){return"Microsoft.WordServices.ContentControlOptions"}invokePropertyGet(e){switch(e){case 1:return this.types}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 1:this.types=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<int>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(wo,"ContentControlOptions",null,[947]);class Zn{constructor(){this.cmh=this.bmh=this.gmh=this.fmh=this.emh=this.dmh=this.amh=!1}get importChangeTrackingMode(){return this.amh}set importChangeTrackingMode(e){this.amh=e}get importCustomProperties(){return this.bmh}set importCustomProperties(e){this.bmh=e}get importCustomXmlParts(){return this.cmh}set importCustomXmlParts(e){this.cmh=
e}get importPageColor(){return this.dmh}set importPageColor(e){this.dmh=e}get importParagraphSpacing(){return this.emh}set importParagraphSpacing(e){this.emh=e}get importStyles(){return this.fmh}set importStyles(e){this.fmh=e}get importTheme(){return this.gmh}set importTheme(e){this.gmh=e}getTypeName(){return"Microsoft.WordServices.InsertFileOptions"}invokePropertyGet(e){switch(e){case 5:return this.importChangeTrackingMode;case 6:return this.importCustomProperties;case 7:return this.importCustomXmlParts;
case 4:return this.importPageColor;case 3:return this.importParagraphSpacing;case 2:return this.importStyles;case 1:return this.importTheme}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 5:this.importChangeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 6:this.importCustomProperties=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 7:this.importCustomXmlParts=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 4:this.importPageColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 3:this.importParagraphSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 2:this.importStyles=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 1:this.importTheme=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}
Object(F.a)(Zn,"InsertFileOptions",null,[]);var zk=d(1435);class Rk{constructor(){this.OKd=this.u9g=null;this.lA=this.w4a="";this.lFh=!0;this.options=null}get authChallenge(){return this.u9g}set authChallenge(e){this.u9g=e}get correlationId(){return this.lA}set correlationId(e){this.lA=e}get policy(){return null}set policy(e){}get resource(){return this.OKd}set resource(e){this.OKd=e}get scope(){return this.w4a}set scope(e){this.w4a=e}get silentLogin(){return this.lFh}set silentLogin(e){this.lFh=
e}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(e){switch(e){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 3:this.authChallenge=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 6:this.silentLogin=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(Rk,
"TokenParameters",null,[247]);class Mk{constructor(e){if(!e)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.O6f=e}areShortcutsInUse(e){return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{this.O6f.checkShortcutsInUse(e).then(S=>{n(S)}).catch(S=>{C(S)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((e,n)=>{this.O6f.getShortcuts().then(C=>{e(C)}).catch(C=>{n(C)})})}replaceShortcuts(e){return OfficeExtension.WacRuntime.Utility.createPromise((n,
C)=>{this.O6f.replaceShortcuts(e).then(()=>{n(null)}).catch(S=>{C(S)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){switch(e){case 3:return this.J$k(n);case 1:return this.gLm();case 2:return this.REo(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}J$k(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");return this.areShortcutsInUse(e)}gLm(){return this.getShortcuts()}REo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.replaceShortcuts(e)}}Object(F.a)(Mk,"ActionService",
null,[]);class Um{constructor(){this.data=null}}Object(F.a)(Um,"AugLoopHostMessageReceivedEventArgs",null,[]);var Tg=d(994);class nm{constructor(e,n=!1,C=null){this.YPa=e;this.mRa=n;this.wQa=C||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(e){this.mRa||Tg.a.HQo(e)}_RegisterHostMessageReceivedEvent(){this.mRa||(nm.iBj||(Tg.a.Dvo(e=>{this.wQa.fireEvent("",65542,Object.assign(new Um,{data:e}))}),nm.iBj=!0),this.wQa.register(this.YPa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.mRa||
this.wQa.unregister(this.YPa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
n){switch(e){case 1:return this.hQo(n);case 2:return this.Klk();case 3:return this.Ulk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}hQo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.sendMessage(e);return null}Klk(){this._RegisterHostMessageReceivedEvent();return null}Ulk(){this._UnregisterHostMessageReceivedEvent();return null}}
nm.iBj=!1;Object(F.a)(nm,"AugLoopEventService",null,[]);var xm=d(1485),xf=d(546);class em{constructor(e,n,C){this.Ijb=this.jjh=null;this.YPa=e;this.Zxh=n;if(this.Aa=C)this.jjh=this.Aa.jb("GetAccessTokenOAuthFirstPartyAllowList")}GCm(){this.Ijb||(this.Ijb=xf.a.sq(gc.a.instance.Ta("Common.App.OAuth.IOAuthManager")));return this.Ijb}gln(e,n){if(!this.Zxh||""===this.YPa||!this.Aa)return!1;const C=this.Zxh.getOsfControl(this.YPa);if(!C)return!1;let S=!1;this.jjh.split(";").forEach(ja=>{n===ja&&(S=!0)});
return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===G.AFrameworkApplication.ua.Gb.Mk&&C.isFirstParty()&&e===em.o5k&&S&&Mf.d(C.getSolutionId())===em.u5k}getAccessTokenFirstPartyOAuth(e,n){let C;C=this.gln(e,n)?S=>{const ja=this.GCm();ja.continueWith(()=>{ja.result.tV(e,n).then(ya=>{S(ya);return ya})})}:S=>{S(Object.assign(new xm.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(C)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1:return this.bgm(n)}e=this.invokeMethod(e,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}bgm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");return this.getAccessTokenFirstPartyOAuth(n,e)}}em.o5k="Maker";em.u5k="fa000000043";Object(F.a)(em,"Auth",null,[]);var Ug=d(138);class El{constructor(){this.Qkb=null}cLm(){this.Qkb||(this.Qkb=xf.a.sq(gc.a.instance.Ta("Common.App.SharedFilePicker.ISharedFilePicker")));
return this.Qkb}getSharedFilePickerResponse(e){return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{try{const S=this.cLm();Ug.Task.WAA.call(null,S).continueWith(()=>{const ja=S.result;if(ja){let ya={};({av:ya}=Bf.d(e)).returnValue?ja.Q2c(ya).then(kb=>{kb&&0<kb.length?n(kb):C(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(kb=>{C(kb)}):C(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The dialog customazation json string can not be deserialized."))}else C(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(S){C(S)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1:return this.bLm(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}bLm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getSharedFilePickerResponse(e)}}Object(F.a)(El,
"SharedFilePicker",null,[]);class mk{N7h(e){return'[data-unique-id="Ribbon-'+e+'"]'}Hrj(e,n){n=JSON.parse(n);if("callout"===n.type)return n.params.target=this.N7h(n.params.target),e.callout(n.params);n.props.target=this.N7h(n.props.target);return n.props}jao(e){return JSON.parse(e)}addNotification(e,n){if(!this.mRa)return sb.UISurfaces.uL().then(C=>C.addNotification(this.Hrj(C,e),this.jao(n)))}removeNotification(e){if(!this.mRa)return sb.UISurfaces.uL().then(n=>n.removeNotification(e))}updateNotification(e,
n){if(!this.mRa)return sb.UISurfaces.uL().then(C=>C.updateNotification(e,this.Hrj(C,n)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1:return this.sYk(n);case 3:return this.uAo(n);case 2:return this.Azp(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}sYk(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"string");return this.addNotification(n,e)}uAo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.removeNotification(e)}Azp(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");return this.updateNotification(n,e)}}Object(F.a)(mk,"NotificationService",null,[]);class Em{createInstance(e,n,C="",S=null,ja=null){switch(e){case "Microsoft.Office.ActionService":return new Mk(n);
case "Microsoft.Office.SharedFilePicker":return new El;case "Microsoft.Office.Auth":return new em(C,S,ja);case "Microsoft.Office.AugLoopEventService":return new nm(C);case "Microsoft.Office.NotificationService":return new mk}return null}}Object(F.a)(Em,"WacApiHost",null,[]);class To{constructor(e,n,C,S,ja,ya=null){this.tB=e;this.uRk=n;this.ga=C;this.zKk=S;this.CRk=ja;this.Cyd=ya}endCopilotOperation(e){return this.Cyd.endCopilotOperation(e)}startCopilotOperation(e){return this.Cyd.startCopilotOperation(e)}undo(){return 32===
this.ga.Ob(this.uRk,2)}_RegisterUndoStackChangedEvent(){const e=OfficeExtension.WacRuntime.RichApi.getEventManager();e.isEventRegistered("",65543)||this.zKk(To.Ioi);e.register(this.tB,"",65543)}_UnregisterUndoStackChangedEvent(){const e=OfficeExtension.WacRuntime.RichApi.getEventManager();e.unregister(this.tB,"",65543);e.isEventRegistered("",65543)||this.CRk(To.Ioi)}getTypeName(){return"Microsoft.Office.UndoService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1:return this.Xsp();case 2:return this.Mlk();case 3:return this.Wlk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){switch(e){case 5:return this.t0l(n);case 4:return this.mdp(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}t0l(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.endCopilotOperation(e)}mdp(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.startCopilotOperation(e)}Xsp(){return this.undo()}Mlk(){this._RegisterUndoStackChangedEvent();return null}Wlk(){this._UnregisterUndoStackChangedEvent();
return null}static Ioi(){OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent("",65543,null)}}Object(F.a)(To,"UndoService",null,[]);class Lm{constructor(){this.isFeedbackSent=!1}}Object(F.a)(Lm,"UserFeedbackUIDismissedEventArgs",null,[]);class ko{constructor(e,n,C=!1,S=null){this.YPa=e;this.XCb=n;this.mRa=C;this.wQa=S||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(e){this.wQa.fireEvent("",65546,Object.assign(new Lm,{isFeedbackSent:e}))}onError(){}MCm(e){switch(e){case 0:return"Smile";
case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}NCm(e){switch(e){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}LCm(e){const n={};n.isScenarioEnabled=e.isScenarioEnabled;n.scenarioType=e.scenarioType;if(e=e.question){const C={};C.questionUiType=e.questionUIType;C.questionUiBehavior=e.questionUIBehavior;C.questionInstruction=e.questionInstruction;C.questionOptions=e.questionOptions;n.questionDetails=C}return n}cRd(e,n,C){"True"===
C?e[n]=!0:"False"===C&&(e[n]=!1)}collectUserFeedback(e,n,C,S){if(!this.mRa){const ja={};G.AFrameworkApplication.J.LQd(ja);const ya=this.XCb.getContext(ja);ya.initialFeedbackType=this.MCm(e);ya.uiType=this.NCm(n);ya.telemetryGroup.featureArea=C;S.v2Config.contextDataFiles&&(ya.isShareContextDataEnabled=!0,ya.getContextData=()=>Promise.all(Nj.a.map(S.v2Config.contextDataFiles,kb=>window.fetch("data:application/octet-stream;base64,"+kb.base64Data).then(Rb=>Rb.blob()).then(Rb=>new File([Rb],kb.fileName,
{type:kb.fileType})))));(e=S.v2Config.scenarioConfig)&&(ya.scenarioConfig=this.LCm(e));this.cRd(ya,"showEmailAddress",S.v2Config.isEmailCollectionEnabled);this.cRd(ya,"isFileUploadEnabled",S.v2Config.isFileUploadEnabled);this.cRd(ya,"screenshot",S.v2Config.isScreenshotEnabled);this.cRd(ya,"isThankYouPageDisabled",S.v2Config.isThankYouPageDisabled);sb.UISurfaces.fLf().then(kb=>{kb.initializeFeedbackModal(ya,Object(ic.a)(this,this.onDismiss,"onDismiss"),Object(ic.a)(this,this.onError,"onError"));return kb})}}_RegisterUserFeedbackUIDismissedEvent(){this.mRa||
this.wQa.register(this.YPa,"",65546)}_UnregisterUserFeedbackUIDismissedEvent(){this.mRa||this.wQa.unregister(this.YPa,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1:return this.avl(n);case 18:return this.Nlk();case 19:return this.Xlk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}avl(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"object");this.collectUserFeedback(n,C,S,e);return null}Nlk(){this._RegisterUserFeedbackUIDismissedEvent();return null}Xlk(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(F.a)(ko,"UserFeedbackService",null,[]);class $n{get critiques(){return this.xsk}set critiques(e){this.xsk=e}getTypeName(){return"Microsoft.WordServices.AnnotationSet"}invokePropertyGet(e){switch(e){case 1:return this.critiques}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 1:this.critiques=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<WordEditor.Extension.Critique>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)($n,"AnnotationSet",null,[]);class Uo{get colorScheme(){return this.Wqk}set colorScheme(e){this.Wqk=e}get length(){return this.wG}set length(e){this.wG=e}get start(){return this.Yda}set start(e){this.Yda=e}getTypeName(){return"Microsoft.WordServices.Critique"}invokePropertyGet(e){switch(e){case 1:return this.colorScheme;case 2:return this.length;case 3:return this.start}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 1:this.colorScheme=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 2:this.length=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 3:this.start=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(Uo,"Critique",null,[]);class qp{constructor(){this.qmh=this.pmh=!1}get includeHiddenText(){return this.pmh}set includeHiddenText(e){this.pmh=e}get includeTextMarkedAsDeleted(){return this.qmh}set includeTextMarkedAsDeleted(e){this.qmh=
e}getTypeName(){return"Microsoft.WordServices.GetTextOptions"}invokePropertyGet(e){switch(e){case 1:return this.includeHiddenText;case 2:return this.includeTextMarkedAsDeleted}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 1:this.includeHiddenText=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");
return;case 2:this.includeTextMarkedAsDeleted=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}
Object(F.a)(qp,"GetTextOptions",null,[]);class cr{constructor(e,n,C){this.Qbf=null;this.ugb=n;this.tB=C;this._context=e}hostName(){return"WordOnline"}appId(){return this.ugb}createInstance(e){switch(e){case "Microsoft.WordServices.Application":return new Dm(gc.a.instance.resolve("WordEditor.Extension.RequestContext"),gc.a.instance.resolve("WordEditor.Extension.DocumentCreatedFactory"),G.AFrameworkApplication.J,gc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory"),
gc.a.instance.resolve("WordEditor.Extension.FileApiOperations"),gc.a.instance.nf("Common.App.AppsForOfficeCommon.IContextActivationManager"));case "Microsoft.WordServices.SearchOptions":return new zk.a;case "Microsoft.WordServices.ContentControlOptions":return new wo;case "Microsoft.WordServices.InsertFileOptions":return new Zn;case "Microsoft.WordServices.GetTextOptions":return new qp;case "Microsoft.Authentication.AuthenticationService":return gc.a.instance.resolve("WordEditor.Extension.AuthenticationServiceFactory").create(this._context,
this.tB);case "Microsoft.Authentication.TokenParameters":return new Rk;case "Microsoft.Office.Licensing.License":return gc.a.instance.resolve("WordEditor.Extension.LicenseFactory").create(this.tB);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return gc.a.instance.resolve("WordEditor.Extension.AppRuntimePersistenceServiceFactory").create(this._context,this.tB);case "Microsoft.AppRuntime.AppRuntimeService":return gc.a.instance.resolve("WordEditor.Extension.AppRuntimeServiceFactory").create(this._context,
this.tB);case "Microsoft.InternalService.AddinInternalService":return new Dn(this.tB);case "Microsoft.Office.AugLoopEventService":case "Microsoft.Office.NotificationService":var n=gc.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").yt.getOsfControl(this.tB);if(null===n||void 0===n?0:n.isFirstParty())return this.Qbf||(this.Qbf=new Em),this.Qbf.createInstance(e,null,this.tB);break;case "Microsoft.Office.UndoService":n=gc.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").yt.getOsfControl(this.tB);
if(null===n||void 0===n?0:n.isFirstParty()){const C=gc.a.instance.resolve("Box4.IUndoManager");e=gc.a.instance.resolve("WordEditor.CopilotOperationLifecycleHandler");return new To(this.tB,pe.a.undo,gc.a.instance.resolve("Common.IActionManager"),S=>C.D1k(S),S=>C.lCo(S),e)}break;case "Microsoft.Office.UserFeedbackService":n=gc.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").yt.getOsfControl(this.tB);if(null===n||void 0===n?0:n.isFirstParty())return new ko(this.tB,gc.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),
!1);break;case "Microsoft.WordServices.AnnotationSet":return new $n;case "Microsoft.WordServices.Critique":return new Uo}E.ULS.sendTraceTag(17359129,369,10,"Typename: {0} is an invalid parameter. Only instance for Application or SearchOptions can be created through this method.",e);pc.a.hg();return null}}Object(F.a)(cr,"RichApiHost",null,[1139]);var ll;(function(e){e[e.none=0]="none";e[e.ciq=1]="primitive";e[e.crq=2]="valueObject";e[e.EWp=3]="classObject"})(ll||(ll={}));Object(F.b)("TypeCategory_Deprecated",
ll);var jh=d(795);const $r=e=>{if(G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.IncludeWacApiHostTypeRegister")){let wn,Cn;wn=e.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);Cn=wn.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Cn.addParameter("shortcuts","String[]",1,null,0);Cn=wn.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Cn=wn.addMethod("ReplaceShortcuts",
2,"Void",0,0,"ReplaceShortcuts",0);Cn.addParameter("shortcuts","Object",1,null,0);wn=e.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Cn=wn.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Cn.addParameter("pickerCustomizationJsonString","String",1,null,0);wn=e.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Cn=
wn.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Cn.addParameter("appName","String",1,null,0);Cn.addParameter("target","String",1,null,0);wn=e.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);wn.addProperty("Data",4,"String",1,!1,null,0);wn=e.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",
3,2);Cn=wn.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Cn.addParameter("data","String",1,null,0);Cn=wn.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Cn=wn.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);wn=e.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);wn.addProperty("BatchId",6,"String",
1,!1,null,0);wn=e.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Cn=wn.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Cn.addParameter("batchId","String",1,null,0);Cn=wn.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);Cn.addParameter("batchId","String",1,null,0);Cn=wn.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Cn=wn.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,
1,"_RegisterUndoStackChangedEvent",4);Cn=wn.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);wn=e.addEnumType("Microsoft.Office.UserFeedbackType");wn.addEnumField("Like",0);wn.addEnumField("Dislike",1);wn.addEnumField("Idea",2);wn.addEnumField("Unclassified",3);wn=e.addEnumType("Microsoft.Office.UserFeedbackUIType");wn.addEnumField("ModalDialog",0);wn.addEnumField("Taskpane",1);wn=e.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}",
"{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);Cn=wn.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);Cn.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);Cn.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);Cn.addParameter("featureArea","String",1,null,0);Cn.addParameter("options","Object",1,null,0);Cn=wn.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);Cn=wn.addMethod("_UnregisterUserFeedbackUIDismissedEvent",
19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);wn=e.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);Cn=wn.addMethod("AddNotification",1,"String",1,0,"AddNotification",4);Cn.addParameter("props","String",1,null,0);Cn.addParameter("options","String",1,null,0);Cn=wn.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);Cn.addParameter("id","String",1,null,0);Cn=wn.addMethod("UpdateNotification",
2,"Void",0,0,"UpdateNotification",4);Cn.addParameter("id","String",1,null,0);Cn.addParameter("props","String",1,null,0)}const n=jh.a.FD?"Microsoft.WordServices.AugloopAnnotation":"Microsoft.WordServices.Annotation",C=jh.a.FD?"Microsoft.WordServices.AugloopAnnotationCollection":"Microsoft.WordServices.AnnotationCollection",S=jh.a.FD?"Microsoft.WordServices.AugloopAnnotationState":"Microsoft.WordServices.AnnotationState",ja=jh.a.FD?"Microsoft.WordServices.Annotation":"Microsoft.WordServices.AddInCritiqueAnnotation",
ya=jh.a.FD?"Microsoft.WordServices.AnnotationCollection":"Microsoft.WordServices.AddInCritiqueAnnotationCollection",kb=jh.a.FD?"Microsoft.WordServices.AnnotationState":"Microsoft.WordServices.AddInCritiqueAnnotationState",Rb=e.addType(n,"{4a0f635f-767e-4a07-b75e-80e8432ca12c}","",3,0);Rb.addProperty("Content",1,"Object",1,!0,null,0);Rb.addProperty("Id",2,"String",1,!0,null,0);Rb.addProperty("_ReferenceId",3,"String",1,!0,null,0);Rb.addProperty("_State",4,S,1,!1,null,0);Rb.addMethod("Delete",1006,
"Void",0,0,"Delete",0);Rb.addMethod("GetParentAsAnnotation",1005,n,3,1,"ParentAsAnnotation",0);Rb.addMethod("GetParentAsParagraph",1004,"Microsoft.WordServices.Paragraph",3,1,"ParentAsParagraph",0);Rb.addMethod("GetParentType",1003,"Microsoft.WordServices.AnnotationParentType",1,1,"ParentType",0);Rb.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Rb.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const sc=e.addType(C,"{0b4dc55f-db0a-4fda-93fe-2a32432b87d3}","",3,0);sc.addProperty("_ReferenceId",
2,"String",1,!0,null,0);sc.addMethod("GetFirst",1003,n,3,1,"First",0);sc.addMethod("GetFirstOrNullObject",1004,n,3,1,"FirstOrNullObject",0);sc.addIndexerMethod(1,n,3,0).addParameter("index","Object",1,null,0);sc.addMethod("Refresh",1005,"Void",0,1,"Refresh",0);sc.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);sc.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);sc.setCollectionInfo(n,!0);const Fc=e.addEnumType("Microsoft.WordServices.CritiqueColorScheme");Fc.addEnumField("Red",
0);Fc.addEnumField("Green",1);Fc.addEnumField("Blue",2);Fc.addEnumField("Lavender",3);Fc.addEnumField("Berry",4);const gd=e.addType("Microsoft.WordServices.Critique","{a080509b-c019-4abd-b9c0-537b1acbec13}","{9b24a8ca-e482-4a0d-9088-2f15ee3314d5}",2,0);gd.addProperty("ColorScheme",1,"Microsoft.WordServices.CritiqueColorScheme",1,!1,null,0);gd.addProperty("Length",2,"Int32",1,!1,null,0);gd.addProperty("Start",3,"Int32",1,!1,null,0);const td=e.addType("Microsoft.WordServices.CritiqueAnnotation","{29bdec2a-9618-4f5b-ac8e-b7c662f25e8b}",
"",3,0);td.addProperty("Critique",2,"Microsoft.WordServices.Critique",2,!0,null,0);td.addProperty("Range",3,"Microsoft.WordServices.Range",3,!0,null,0);td.addProperty("_ReferenceId",1,"String",1,!0,null,0);td.addMethod("Accept",1003,"Void",0,0,"Accept",0);td.addMethod("Reject",1004,"Void",0,0,"Reject",0);td.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);td.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Bd=e.addEnumType(kb);Bd.addEnumField("Created",0);Bd.addEnumField("Accepted",
1);Bd.addEnumField("Rejected",2);e.addType("Microsoft.WordServices.AnnotationSet","{dfd377f4-ffb7-4af4-9693-ac7693daf019}","{6aa74201-b4b9-49b6-8430-00bfaa074b76}",2,0).addProperty("Critiques",1,"Microsoft.WordServices.Critique[]",2,!1,null,0);const wd=e.addType(ja,"{9bea77fa-982e-44ef-bb15-3c8c98be2f58}","",3,0);wd.addProperty("CritiqueAnnotation",3,"Microsoft.WordServices.CritiqueAnnotation",3,!0,null,0);wd.addProperty("Id",1,"String",1,!0,null,0);wd.addProperty("State",4,kb,1,!0,null,0);wd.addProperty("_ReferenceId",
2,"String",1,!0,null,0);wd.addMethod("Delete",1003,"Void",0,0,"Delete",0);wd.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);wd.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const te=e.addType(ya,"{7028c6d1-419f-455d-9832-b669a875986a}","",3,0);te.addProperty("_ReferenceId",2,"String",1,!0,null,0);te.addMethod("GetFirst",1003,ja,3,0,"First",0);te.addMethod("GetFirstOrNullObject",1004,ja,3,0,"FirstOrNullObject",0);te.addIndexerMethod(1,ja,3,0).addParameter("index","Object",1,
null,0);te.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);te.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);te.setCollectionInfo(ja,!0);const Le=e.addType("Microsoft.WordServices.Application","{e033f092-ac87-40f7-a865-769c9fdacd72}","{2c000fc1-c973-41fc-b5e3-8f3a0cc65c12}",3,0);Le.addMethod("CreateDocument",1001,"Microsoft.WordServices.DocumentCreated",3,1,"CreateDocument",0).addParameter("base64File","String",1,null,0);Le.addMethod("GetEnterpriseUserInfo",1004,"String",1,1,
"EnterpriseUserInfo",4);Le.addMethod("GetMruFriendlyPath",1005,"String",1,1,"MruFriendlyPath",4).addParameter("documentUrl","String",1,null,0);Le.addMethod("GetSharePointTenantRoot",1003,"String",1,1,"SharePointTenantRoot",4);Le.addMethod("IsTapEnabled",1002,"Boolean",1,1,"IsTapEnabled",4);const Oe=Le.addMethod("LaunchFileUrlInOfficeApp",1006,"Boolean",1,1,"LaunchFileUrlInOfficeApp",4);Oe.addParameter("documentUrl","String",1,null,0);Oe.addParameter("useUniversalAsBackUp","Boolean",1,null,0);Le.addMethod("OpenDocument",
1008,"Void",0,1,"OpenDocument",0).addParameter("fileLocation","String",1,null,0);Le.addMethod("RetrieveStylesFromBase64",1007,"String",1,1,"RetrieveStylesFromBase64",0).addParameter("base64File","String",1,null,0);const We=e.addType("Microsoft.WordServices.Body","{5516bb1d-cf31-4aa9-97cd-ccebc2ee9e6d}","",3,0);We.addProperty("ContentControls",3,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);We.addProperty("Endnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);We.addProperty("Fields",
20,"Microsoft.WordServices.FieldCollection",3,!0,null,0);We.addProperty("Font",5,"Microsoft.WordServices.Font",3,!0,null,0);We.addProperty("Footnotes",18,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);We.addProperty("InlinePictures",7,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);We.addProperty("Lists",11,"Microsoft.WordServices.ListCollection",3,!0,null,0);We.addProperty("Paragraphs",2,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);We.addProperty("ParentBody",
10,"Microsoft.WordServices.Body",3,!0,null,0);We.addProperty("ParentBodyOrNullObject",16,"Microsoft.WordServices.Body",3,!0,null,0);We.addProperty("ParentContentControl",4,"Microsoft.WordServices.ContentControl",3,!0,null,0);We.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);We.addProperty("ParentSection",13,"Microsoft.WordServices.Section",3,!0,null,0);We.addProperty("ParentSectionOrNullObject",17,"Microsoft.WordServices.Section",3,!0,null,0);
We.addProperty("Style",6,"String",1,!1,null,0);We.addProperty("StyleBuiltIn",14,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);We.addProperty("Tables",12,"Microsoft.WordServices.TableCollection",3,!0,null,0);We.addProperty("Text",8,"String",1,!0,null,0);We.addProperty("Type",9,"Microsoft.WordServices.BodyType",1,!0,null,0);We.addProperty("_ReferenceId",1,"String",1,!0,null,0);We.addMethod("Clear",1011,"Void",0,0,"Clear",0);We.addMethod("GetComments",1019,"Microsoft.WordServices.CommentCollection",
3,1,"Comments",0);We.addMethod("GetContentControls",1021,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);We.addMethod("GetHtml",1013,"String",1,1,"Html",0);We.addMethod("GetOoxml",1014,"String",1,1,"Ooxml",0);We.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",
1,null,0);const Xf=We.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);Xf.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);Xf.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);We.addMethod("InsertContentControl",1007,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const Gg=We.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",
3,0,"InsertFileFromBase64",0);Gg.addParameter("base64File","String",1,null,0);Gg.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Ph=We.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);Ph.addParameter("html","String",1,null,0);Ph.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Aj=We.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",
0);Aj.addParameter("base64EncodedImage","String",1,null,0);Aj.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Ih=We.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);Ih.addParameter("ooxml","String",1,null,0);Ih.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Nm=We.addMethod("InsertParagraph",1006,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Nm.addParameter("paragraphText","String",
1,null,0);Nm.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);We.addMethod("GetReviewedText",1020,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);We.addMethod("GetTrackedChanges",1022,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);const Sk=We.addMethod("InsertTable",1017,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Sk.addParameter("rowCount","Int32",1,null,
0);Sk.addParameter("columnCount","Int32",1,null,0);Sk.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Sk.addParameter("values","String[][]",1,null,0);const hk=We.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);hk.addParameter("text","String",1,null,0);hk.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const al=We.addMethod("Search",1012,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);al.addParameter("searchText",
"String",1,null,0);al.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);We.addMethod("Select",1015,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);We.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);We.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Cj=We.addMethod("_Search2",1018,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Cj.addParameter("searchText","String",1,null,0);Cj.addParameter("searchFlags",
"Int32",1,null,0);const Lg=e.addType("Microsoft.WordServices.ContentControl","{b86e5ae1-476e-4e56-825d-885468e549f3}","",3,0);Lg.addProperty("Appearance",7,"Microsoft.WordServices.ContentControlAppearance",1,!1,null,0);Lg.addProperty("CannotDelete",10,"Boolean",1,!1,null,0);Lg.addProperty("CannotEdit",11,"Boolean",1,!1,null,0);Lg.addProperty("CheckboxContentControl",32,"Microsoft.WordServices.CheckboxContentControl",2,!0,null,0);Lg.addProperty("Color",8,"String",1,!1,null,0);Lg.addProperty("ContentControls",
15,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Lg.addProperty("Endnotes",30,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Lg.addProperty("Fields",31,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Lg.addProperty("Font",12,"Microsoft.WordServices.Font",3,!0,null,0);Lg.addProperty("Footnotes",29,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Lg.addProperty("Id",1,"UInt32",1,!0,null,0);Lg.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",
3,!0,null,0);Lg.addProperty("Lists",19,"Microsoft.WordServices.ListCollection",3,!0,null,0);Lg.addProperty("Paragraphs",14,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Lg.addProperty("ParentBody",25,"Microsoft.WordServices.Body",3,!0,null,0);Lg.addProperty("ParentContentControl",16,"Microsoft.WordServices.ContentControl",3,!0,null,0);Lg.addProperty("ParentContentControlOrNullObject",26,"Microsoft.WordServices.ContentControl",3,!0,null,0);Lg.addProperty("ParentTable",22,"Microsoft.WordServices.Table",
3,!0,null,0);Lg.addProperty("ParentTableCell",21,"Microsoft.WordServices.TableCell",3,!0,null,0);Lg.addProperty("ParentTableCellOrNullObject",27,"Microsoft.WordServices.TableCell",3,!0,null,0);Lg.addProperty("ParentTableOrNullObject",28,"Microsoft.WordServices.Table",3,!0,null,0);Lg.addProperty("PlaceholderText",5,"String",1,!1,null,0);Lg.addProperty("RemoveWhenEdited",9,"Boolean",1,!1,null,0);Lg.addProperty("Style",13,"String",1,!1,null,0);Lg.addProperty("StyleBuiltIn",24,"Microsoft.WordServices.StyleBuiltIn",
1,!1,null,0);Lg.addProperty("Subtype",23,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Lg.addProperty("Tables",20,"Microsoft.WordServices.TableCollection",3,!0,null,0);Lg.addProperty("Tag",4,"String",1,!1,null,0);Lg.addProperty("Text",18,"String",1,!0,null,0);Lg.addProperty("Title",3,"String",1,!1,null,0);Lg.addProperty("Type",6,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Lg.addProperty("_ReferenceId",2,"String",1,!0,null,0);Lg.addMethod("Clear",1010,"Void",0,0,"Clear",0);
Lg.addMethod("Delete",1011,"Void",0,0,"Delete",0).addParameter("keepContent","Boolean",1,null,0);Lg.addMethod("GetComments",1021,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Lg.addMethod("GetContentControls",1023,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Lg.addMethod("GetHtml",1013,"String",1,1,"Html",0);Lg.addMethod("GetOoxml",
1014,"String",1,1,"Ooxml",0);Lg.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const mq=Lg.addMethod("GetTextRanges",1019,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);mq.addParameter("endingMarks","String[]",1,null,0);mq.addParameter("trimSpacing","Boolean",1,null,0);Lg.addMethod("GetTrackedChanges",1024,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);const uk=
Lg.addMethod("InsertBreak",1008,"Void",0,0,"InsertBreak",0);uk.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);uk.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const au=Lg.addMethod("InsertFileFromBase64",1006,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);au.addParameter("base64File","String",1,null,0);au.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ED=Lg.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);ED.addParameter("html","String",1,null,0);ED.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const xA=Lg.addMethod("InsertInlinePictureFromBase64",1009,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);xA.addParameter("base64EncodedImage","String",1,null,0);xA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const yF=Lg.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);yF.addParameter("ooxml","String",1,null,0);yF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const fw=Lg.addMethod("InsertParagraph",1007,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);fw.addParameter("paragraphText","String",1,null,0);fw.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const xx=Lg.addMethod("InsertTable",1018,"Microsoft.WordServices.Table",3,0,"InsertTable",0);xx.addParameter("rowCount","Int32",1,null,
0);xx.addParameter("columnCount","Int32",1,null,0);xx.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);xx.addParameter("values","String[][]",1,null,0);const bu=Lg.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);bu.addParameter("text","String",1,null,0);bu.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const zF=Lg.addMethod("Search",1015,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);zF.addParameter("searchText",
"String",1,null,0);zF.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Lg.addMethod("Select",1012,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const FD=Lg.addMethod("Split",1017,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);FD.addParameter("delimiters","String[]",1,null,0);FD.addParameter("multiParagraphs","Boolean",1,null,0);FD.addParameter("trimDelimiters","Boolean",1,null,0);FD.addParameter("trimSpacing",
"Boolean",1,null,0);Lg.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Lg.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const nI=Lg.addMethod("_Search2",1020,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);nI.addParameter("searchText","String",1,null,0);nI.addParameter("searchFlags","Int32",1,null,0);Lg.addMethod("GetReviewedText",1022,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const Xu=
e.addType("Microsoft.WordServices.ContentControlCollection","{a6a87ba8-6037-4625-ba4b-ece14e708219}","",3,0);Xu.addProperty("_ReferenceId",2,"String",1,!0,null,0);Xu.addMethod("GetByChangeTrackingStates",1010,"Microsoft.WordServices.ContentControlCollection",3,1,"ByChangeTrackingStates",0).addParameter("types","Microsoft.WordServices.ChangeTrackingState[]",1,null,0);Xu.addMethod("GetById",1002,"Microsoft.WordServices.ContentControl",3,1,"ById",0).addParameter("id","Int32",1,null,0);Xu.addMethod("GetByIdOrNullObject",
1008,"Microsoft.WordServices.ContentControl",3,1,"ByIdOrNullObject",0).addParameter("id","Int32",1,null,0);Xu.addMethod("GetByTag",1004,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTag",0).addParameter("tag","String",1,null,0);Xu.addMethod("GetByTitle",1003,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTitle",0).addParameter("title","String",1,null,0);Xu.addMethod("GetByTypes",1006,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTypes",0).addParameter("types","Microsoft.WordServices.ContentControlType[]",
1,null,0);Xu.addMethod("GetFirst",1007,"Microsoft.WordServices.ContentControl",3,1,"First",0);Xu.addMethod("GetFirstOrNullObject",1009,"Microsoft.WordServices.ContentControl",3,1,"FirstOrNullObject",0);Xu.addIndexerMethod(1,"Microsoft.WordServices.ContentControl",3,0).addParameter("index","Object",1,null,0);Xu.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Xu.addMethod("_OnAccess",1005,"Void",0,1,"_OnAccess",0);Xu.setCollectionInfo("Microsoft.WordServices.ContentControl",!0);e.addType("Microsoft.WordServices.ContentControlOptions",
"{dc3307d1-f680-40be-94b4-c50e53399d0e}","{81d9e31a-cd15-43a2-8ee0-614fb6e37a0a}",2,0).addProperty("types",1,"Microsoft.WordServices.ContentControlType[]",1,!1,null,0);e.addType("Microsoft.WordServices.CheckboxContentControl","{70b1363a-da4f-4cf0-a688-cafd68052109}","{fd0a2f05-9b08-4525-9321-664b43f2cd51}",2,0).addProperty("IsChecked",1,"Boolean",1,!1,null,0);const yu=e.addType("Microsoft.WordServices.Comment","{9446f5cf-2bce-46d3-ae41-2a70c1398270}","",3,0);yu.addProperty("AuthorEmail",1,"String",
1,!0,null,0);yu.addProperty("AuthorName",2,"String",1,!0,null,0);yu.addProperty("Content",3,"String",1,!1,null,0);yu.addProperty("CreationDate",4,"DateTime",1,!1,null,0);yu.addProperty("Id",5,"String",1,!0,null,0);yu.addProperty("_ReferenceId",6,"String",1,!0,null,0);yu.addProperty("Replies",7,"Microsoft.WordServices.CommentReplyCollection",3,!0,null,0);yu.addProperty("Resolved",8,"Boolean",1,!1,null,0);yu.addProperty("ContentRange",9,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);yu.addMethod("GetRange",
1001,"Microsoft.WordServices.Range",3,0,"GetRange",0);yu.addMethod("Reply",1002,"Microsoft.WordServices.CommentReply",3,0,"Reply",0).addParameter("replyText","String",1,null,0);yu.addMethod("Delete",1003,"Void",0,0,"Delete",0);yu.addMethod("_KeepReference",1005,"Void",0,1,"_KeepReference",0);yu.addMethod("_OnAccess",1004,"Void",0,1,"_OnAccess",0);const gw=e.addType("Microsoft.WordServices.CommentContentRange","{fc4ae520-29e9-45ee-82ae-c0b29f2feefc}","",3,0);gw.addProperty("_ReferenceId",1,"String",
1,!0,null,0);gw.addProperty("Text",2,"String",1,!0,null,0);gw.addProperty("IsEmpty",3,"Boolean",1,!0,null,0);gw.addProperty("Hyperlink",4,"String",1,!1,null,0);gw.addProperty("Bold",5,"Boolean",1,!1,null,0);gw.addProperty("Italic",6,"Boolean",1,!1,null,0);gw.addProperty("StrikeThrough",7,"Boolean",1,!1,null,0);gw.addProperty("Underline",8,"Microsoft.WordServices.UnderlineType",1,!1,null,0);gw.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);gw.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",
0);const yA=gw.addMethod("InsertText",1003,"Microsoft.WordServices.CommentContentRange",3,0,"InsertText",0);yA.addParameter("text","String",1,null,0);yA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const gz=e.addType("Microsoft.WordServices.CommentCollection","{f1054c20-9d4b-4c62-9c80-e0e57ac4df64}","",3,0);gz.addProperty("_ReferenceId",2,"String",1,!0,null,0);gz.addMethod("GetFirst",1003,"Microsoft.WordServices.Comment",3,1,"First",0);gz.addMethod("GetFirstOrNullObject",
1004,"Microsoft.WordServices.Comment",3,1,"FirstOrNullObject",0);gz.addIndexerMethod(1,"Microsoft.WordServices.Comment",3,0).addParameter("index","object",1,null,0);gz.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);gz.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);gz.setCollectionInfo("Microsoft.WordServices.Comment",!0);const ht=e.addType("Microsoft.WordServices.CommentReply","{cd697f4e-f862-b2b3-bfa1-5a5a2231b3d4}","",3,0);ht.addProperty("AuthorEmail",1,"String",1,!0,null,
0);ht.addProperty("AuthorName",2,"String",1,!0,null,0);ht.addProperty("Content",3,"String",1,!1,null,0);ht.addProperty("CreationDate",4,"DateTime",1,!1,null,0);ht.addProperty("ParentComment",7,"Microsoft.WordServices.Comment",3,!0,null,0);ht.addProperty("Id",5,"String",1,!0,null,0);ht.addProperty("_ReferenceId",6,"String",1,!0,null,0);ht.addProperty("ContentRange",8,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);ht.addMethod("Delete",1002,"Void",0,0,"Delete",0);ht.addMethod("_KeepReference",
1001,"Void",0,1,"_KeepReference",0);ht.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);const hw=e.addType("Microsoft.WordServices.CommentReplyCollection","{bfce5553-cb82-aa57-dec3-0c164055f29e}","",3,0);hw.addProperty("_ReferenceId",2,"String",1,!0,null,0);hw.addMethod("GetFirst",1003,"Microsoft.WordServices.CommentReply",3,1,"First",0);hw.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.CommentReply",3,1,"FirstOrNullObject",0);hw.addIndexerMethod(1,"Microsoft.WordServices.CommentReply",
3,0).addParameter("index","object",1,null,0);hw.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);hw.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);hw.setCollectionInfo("Microsoft.WordServices.CommentReply",!0);const hz=e.addType("Microsoft.WordServices.CustomProperty","{5edbd9c9-449f-440c-bfae-d59d2db340bb}","",3,0);hz.addProperty("Key",2,"String",1,!0,null,0);hz.addProperty("Type",4,"Microsoft.WordServices.DocumentPropertyType",1,!0,null,0);hz.addProperty("Value",3,"Object",1,
!1,null,0);hz.addProperty("_Id",5,"String",1,!0,null,0);hz.addProperty("_ReferenceId",1,"String",1,!0,null,0);hz.addMethod("Delete",1003,"Void",0,0,"Delete",0);hz.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);hz.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Os=e.addType("Microsoft.WordServices.CustomPropertyCollection","{85869847-ef5b-4377-9a0b-0eb6da2059e5}","",3,0);Os.addProperty("_ReferenceId",2,"String",1,!0,null,0);const iz=Os.addMethod("Add",1003,"Microsoft.WordServices.CustomProperty",
3,0,"Add",0);iz.addParameter("key","String",1,null,0);iz.addParameter("value","Object",1,null,0);Os.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);Os.addMethod("GetCount",1004,"Int32",1,1,"Count",0);Os.addIndexerMethod(1,"Microsoft.WordServices.CustomProperty",3,0).addParameter("key","String",1,null,0);Os.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomProperty",3,1,"ItemOrNullObject",0).addParameter("key","String",1,null,0);Os.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",
0);Os.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Os.setCollectionInfo("Microsoft.WordServices.CustomProperty",!0);const it=e.addType("Microsoft.WordServices.CustomXmlPart","{e0f5b881-5a49-403f-adc1-627b9479ad11}","",3,0);it.addProperty("Id",2,"String",1,!0,null,0);it.addProperty("NamespaceUri",3,"String",1,!0,null,0);it.addProperty("_ReferenceId",1,"String",1,!0,null,0);it.addMethod("Delete",1003,"Void",0,0,"Delete",0);const AF=it.addMethod("DeleteAttribute",1012,"Void",0,0,"DeleteAttribute",
0);AF.addParameter("xpath","String",1,null,0);AF.addParameter("namespaceMappings","Object",1,null,0);AF.addParameter("name","String",1,null,0);const oI=it.addMethod("DeleteElement",1009,"Void",0,0,"DeleteElement",0);oI.addParameter("xpath","String",1,null,0);oI.addParameter("namespaceMappings","Object",1,null,0);it.addMethod("GetXml",1004,"String",1,1,"Xml",0);const BF=it.addMethod("InsertAttribute",1010,"Void",0,0,"InsertAttribute",0);BF.addParameter("xpath","String",1,null,0);BF.addParameter("namespaceMappings",
"Object",1,null,0);BF.addParameter("name","String",1,null,0);BF.addParameter("value","String",1,null,0);const GD=it.addMethod("InsertElement",1007,"Void",0,0,"InsertElement",0);GD.addParameter("xpath","String",1,null,0);GD.addParameter("xml","String",1,null,0);GD.addParameter("namespaceMappings","Object",1,null,0);GD.addParameter("index","Int32?",1,null,0);const yx=it.addMethod("Query",1006,"String[]",1,0,"Query",0);yx.addParameter("xpath","String",1,null,0);yx.addParameter("namespaceMappings","Object",
1,null,0);it.addMethod("SetXml",1005,"Void",0,0,"SetXml",0).addParameter("xml","String",1,null,0);const cC=it.addMethod("UpdateAttribute",1011,"Void",0,0,"UpdateAttribute",0);cC.addParameter("xpath","String",1,null,0);cC.addParameter("namespaceMappings","Object",1,null,0);cC.addParameter("name","String",1,null,0);cC.addParameter("value","String",1,null,0);const pI=it.addMethod("UpdateElement",1008,"Void",0,0,"UpdateElement",0);pI.addParameter("xpath","String",1,null,0);pI.addParameter("xml","String",
1,null,0);pI.addParameter("namespaceMappings","Object",1,null,0);it.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);it.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const zx=e.addType("Microsoft.WordServices.CustomXmlPartCollection","{cf95a7e8-7b45-4a7a-9de5-db47e5f9b66b}","",3,0);zx.addProperty("_ReferenceId",1,"String",1,!0,null,0);zx.addMethod("Add",1004,"Microsoft.WordServices.CustomXmlPart",3,0,"Add",0).addParameter("xml","String",1,null,0);zx.addMethod("GetByNamespace",
1005,"Microsoft.WordServices.CustomXmlPartScopedCollection",3,1,"ByNamespace",0).addParameter("namespaceUri","String",1,null,0);zx.addMethod("GetCount",1003,"Int32",1,1,"Count",0);zx.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);zx.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0).addParameter("id","String",1,null,0);zx.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);zx.addMethod("_OnAccess",1001,
"Void",0,1,"_OnAccess",0);zx.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const Ax=e.addType("Microsoft.WordServices.CustomXmlPartScopedCollection","{9fc07322-b3a6-407b-827e-c40e6e188f68}","",3,0);Ax.addProperty("_ReferenceId",1,"String",1,!0,null,0);Ax.addMethod("GetCount",1003,"Int32",1,1,"Count",0);Ax.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);Ax.addMethod("GetItemOrNullObject",1004,"Microsoft.WordServices.CustomXmlPart",
3,1,"",0).addParameter("id","String",1,null,0);Ax.addMethod("GetOnlyItem",1005,"Microsoft.WordServices.CustomXmlPart",3,1,"OnlyItem",0);Ax.addMethod("GetOnlyItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0);Ax.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ax.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Ax.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const Xl=e.addType("Microsoft.WordServices.Document","{1fd33ae5-86f2-4770-95f1-8bba5b1dce15}",
"",3,0);Xl.addProperty("AllowCloseOnUntitled",9,"Boolean",1,!1,null,0);Xl.addProperty("ChangeTrackingMode",10,"Microsoft.WordServices.ChangeTrackingMode",1,!1,null,0);Xl.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);Xl.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Xl.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",3,!0,null,0);Xl.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",
3,!0,null,0);Xl.addProperty("Saved",1,"Boolean",1,!0,null,0);Xl.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);Xl.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);Xl.addProperty("_ReferenceId",5,"String",1,!0,null,0);const cu=Xl.addMethod("AddStyle",1028,"Microsoft.WordServices.Style",ll.ClassObject,0,"AddStyle",0);cu.addParameter("name","String",1,null,0);cu.addParameter("type","Microsoft.WordServices.StyleType",1,null,0);Xl.addMethod("DeleteBookmark",
1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);Xl.addMethod("GetAnnotationById",1031,ja,3,0,"AnnotationById",0).addParameter("id","String",1,null,0);Xl.addMethod("GetAnnotationsByType",1020,C,3,1,"AnnotationsByType",0).addParameter("annotationType","String",1,null,0);Xl.addMethod("GetBookmarkRange",1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);Xl.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",
3,1,"BookmarkRangeOrNullObject",0).addParameter("name","String",1,null,0);Xl.addMethod("GetContentControls",1026,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Xl.addMethod("GetEndnoteBody",1025,"Microsoft.WordServices.Body",3,1,"EndnoteBody",0);Xl.addMethod("GetFootnoteBody",1024,"Microsoft.WordServices.Body",3,1,"FootnoteBody",0);Xl.addMethod("GetMetadata",
1013,"Object",1,1,"Metadata",0).addParameter("propertyGUID","String",1,null,0);Xl.addMethod("GetNeighborhoodTextAroundSelection",1017,"String",1,1,"NeighborhoodTextAroundSelection",4).addParameter("maxLength","Int32?",1,null,0);Xl.addMethod("GetSelection",1006,"Microsoft.WordServices.Range",3,1,"Selection",0);Xl.addMethod("GetStyles",1029,"Microsoft.WordServices.StyleCollection",ll.ClassObject,1,"GetStyles",0);Xl.addMethod("LaunchTapPane",1016,"Void",0,1,"LaunchTapPane",4).addParameter("documentUrl",
"String",1,null,0);const HD=Xl.addMethod("Save",1005,"Void",0,0,"Save",0);HD.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",1,null,0);HD.addParameter("fileName","String",1,null,0);Xl.addMethod("Close",1027,"Void",0,0,"Close",0).addParameter("closeBehavior","Microsoft.WordServices.CloseBehavior",1,null,0);const qI=Xl.addMethod("Search",1022,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);qI.addParameter("searchText","String",1,null,0);qI.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",
3,null,0);const qK=Xl.addMethod("SetMetadata",1014,"Void",0,0,"SetMetadata",0);qK.addParameter("propertyGUID","String",1,null,0);qK.addParameter("propertyValue","Object",1,null,0);const rI=Xl.addMethod("SetMetadataOnTile",1015,"Void",0,0,"SetMetadataOnTile",0);rI.addParameter("tileID","String",1,null,0);rI.addParameter("propertyGUID","String",1,null,0);rI.addParameter("propertyValue","Object",1,null,0);Xl.addMethod("SetNavigationPaneVisibility",1021,"Void",0,0,"SetNavigationPaneVisibility",4).addParameter("visible",
"Boolean",1,null,0);Xl.addMethod("_GetObjectByReferenceId",1001,"Object",1,1,"_GetObjectByReferenceId",0).addParameter("referenceId","String",1,null,0);Xl.addMethod("_GetObjectTypeNameByReferenceId",1002,"String",1,1,"_GetObjectTypeNameByReferenceId",0).addParameter("referenceId","String",1,null,0);Xl.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);Xl.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const rK=Xl.addMethod("_RegisterEvent",1018,"Void",0,1,"_RegisterEvent",0);rK.addParameter("referenceId",
"String",1,null,0);rK.addParameter("eventType","Microsoft.WordServices.EventType",1,null,0);Xl.addMethod("_RemoveAllReferences",1004,"Void",0,1,"_RemoveAllReferences",0);Xl.addMethod("_RemoveReference",1003,"Void",0,1,"_RemoveReference",0).addParameter("referenceId","String",1,null,0);const Bx=Xl.addMethod("_Search2",1023,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Bx.addParameter("searchText","String",1,null,0);Bx.addParameter("searchFlags","Int32",1,null,0);const sK=Xl.addMethod("_UnregisterEvent",
1019,"Void",0,1,"_UnregisterEvent",0);sK.addParameter("referenceId","String",1,null,0);sK.addParameter("eventType","Microsoft.WordServices.EventType",1,null,0);const dC=Xl.addMethod("InsertFileFromBase64",1030,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);dC.addParameter("base64File","String",1,null,0);dC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);dC.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",
0);Xl.addMethod("GetParagraphByUniqueLocalId",1033,"Microsoft.WordServices.Paragraph",3,1,"ParagraphById",0).addParameter("id","String",1,null,0);const Er=e.addType("Microsoft.WordServices.DocumentCreated","{1a6e7a8e-fa7a-4f86-b7d0-b50a3c10f515}","",3,0);Er.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);Er.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Er.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",
3,!0,null,0);Er.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",3,!0,null,0);Er.addProperty("Saved",1,"Boolean",1,!0,null,0);Er.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);Er.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);Er.addProperty("_ReferenceId",5,"String",1,!0,null,0);Er.addMethod("DeleteBookmark",1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);Er.addMethod("GetBookmarkRange",
1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);Er.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name","String",1,null,0);Er.addMethod("GetContentControls",1013,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);const Nd=Er.addMethod("InsertFileFromBase64",
1014,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);Nd.addParameter("base64File","String",1,null,0);Nd.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Nd.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",0);Er.addMethod("Open",1009,"Void",0,1,"Open",0);const Cx=Er.addMethod("Save",1005,"Void",0,0,"Save",0);Cx.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",
1,null,0);Cx.addParameter("fileName","String",1,null,0);Er.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);Er.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const qi=e.addType("Microsoft.WordServices.DocumentProperties","{642e1471-0cac-4dd2-bc76-1d1d0a3e130f}","",3,0);qi.addProperty("ApplicationName",11,"String",1,!0,null,0);qi.addProperty("Author",5,"String",1,!1,null,0);qi.addProperty("Category",20,"String",1,!1,null,0);qi.addProperty("Comments",7,"String",1,!1,null,0);qi.addProperty("Company",
23,"String",1,!1,null,0);qi.addProperty("CreationDate",13,"DateTime",1,!0,null,0);qi.addProperty("CustomProperties",2,"Microsoft.WordServices.CustomPropertyCollection",3,!0,null,0);qi.addProperty("Format",21,"String",1,!1,null,0);qi.addProperty("Keywords",6,"String",1,!1,null,0);qi.addProperty("LastAuthor",9,"String",1,!0,null,0);qi.addProperty("LastPrintDate",12,"DateTime?",1,!0,null,0);qi.addProperty("LastSaveTime",14,"DateTime?",1,!0,null,0);qi.addProperty("Manager",22,"String",1,!1,null,0);qi.addProperty("RevisionNumber",
10,"String",1,!0,null,0);qi.addProperty("Security",19,"Int32?",1,!0,null,0);qi.addProperty("Subject",4,"String",1,!1,null,0);qi.addProperty("Template",8,"String",1,!0,null,0);qi.addProperty("Title",3,"String",1,!1,null,0);qi.addProperty("_ReferenceId",1,"String",1,!0,null,0);qi.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);qi.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Zq=e.addType("Microsoft.WordServices.Field","{5109ffb2-cad2-4420-8f1d-edf33916127a}","",3,0);Zq.addProperty("_Id",
1,"Int32",1,!0,null,0);Zq.addProperty("_ReferenceId",2,"String",1,!0,null,0);Zq.addProperty("Code",3,"String",1,!0,null,0);Zq.addProperty("Result",4,"Microsoft.WordServices.Range",3,!0,null,0);Zq.addProperty("ParentBody",5,"Microsoft.WordServices.Body",3,!0,null,0);Zq.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);Zq.addProperty("ParentContentControlOrNullObject",7,"Microsoft.WordServices.ContentControl",3,!0,null,0);Zq.addProperty("ParentTable",8,"Microsoft.WordServices.Table",
3,!0,null,0);Zq.addProperty("ParentTableOrNullObject",9,"Microsoft.WordServices.Table",3,!0,null,0);Zq.addProperty("ParentTableCell",10,"Microsoft.WordServices.TableCell",3,!0,null,0);Zq.addProperty("ParentTableCellOrNullObject",11,"Microsoft.WordServices.TableCell",3,!0,null,0);Zq.addProperty("Data",16,"String",1,!1,null,0);Zq.addProperty("Kind",13,"Microsoft.WordServices.FieldKind",1,!0,null,0);Zq.addProperty("Locked",15,"Boolean",1,!1,null,0);Zq.addProperty("ShowCodes",14,"Boolean",1,!1,null,0);
Zq.addProperty("Type",12,"Microsoft.WordServices.FieldType",1,!0,null,0);Zq.addMethod("GetNextOrNullObject",1005,"Microsoft.WordServices.Field",3,1,"NextOrNullObject",0);Zq.addMethod("GetNext",1004,"Microsoft.WordServices.Field",3,1,"Next",0);Zq.addMethod("Delete",1003,"Void",0,0,"Delete",0);Zq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Zq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Zq.addMethod("Select",1007,"Void",ll.None,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",
1,null,0);Zq.addMethod("UpdateResult",1006,"Void",ll.None,0,"UpdateResult",0);const Lw=e.addType("Microsoft.WordServices.FieldCollection","{1eb67e75-ccdb-483a-afb0-03a447729113}","",3,0);Lw.addProperty("_ReferenceId",2,"String",1,!0,null,0);Lw.addMethod("GetFirst",1003,"Microsoft.WordServices.Field",3,1,"First",0);Lw.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Field",3,1,"FirstOrNullObject",0);Lw.addIndexerMethod(1,"Microsoft.WordServices.Field",3,0).addParameter("index","Object",
1,null,0);Lw.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Lw.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Lw.addMethod("getByTypes",1005,"Microsoft.WordServices.FieldCollection",ll.ClassObject,1,"getByTypes",0).addParameter("types","Microsoft.WordServices.FieldType[]",1,null,0);Lw.setCollectionInfo("Microsoft.WordServices.Field",!0);const du=e.addType("Microsoft.WordServices.Font","{896a961f-e647-4b59-82da-5f1143b5afc1}","",3,0);du.addProperty("Bold",4,"Boolean?",1,!1,null,
0);du.addProperty("Color",6,"String",1,!1,null,0);du.addProperty("DoubleStrikeThrough",11,"Boolean?",1,!1,null,0);du.addProperty("HighlightColor",12,"String",1,!1,null,0);du.addProperty("Italic",5,"Boolean?",1,!1,null,0);du.addProperty("Name",2,"String",1,!1,null,0);du.addProperty("Size",3,"Single?",1,!1,null,0);du.addProperty("StrikeThrough",10,"Boolean?",1,!1,null,0);du.addProperty("Subscript",8,"Boolean?",1,!1,null,0);du.addProperty("Superscript",9,"Boolean?",1,!1,null,0);du.addProperty("Underline",
7,"Microsoft.WordServices.UnderlineType",1,!1,null,0);du.addProperty("_ReferenceId",1,"String",1,!0,null,0);du.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);du.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Co=e.addType("Microsoft.WordServices.InlinePicture","{ef524552-be9e-413b-8030-e5eb3db24f19}","",3,0);Co.addProperty("AltTextDescription",3,"String",1,!1,null,0);Co.addProperty("AltTextTitle",4,"String",1,!1,null,0);Co.addProperty("Height",5,"Single",1,!1,null,0);Co.addProperty("Hyperlink",
6,"String",1,!1,null,0);Co.addProperty("ImageFormat",11,"Microsoft.WordServices.ImageFormat",1,!0,null,0);Co.addProperty("LockAspectRatio",7,"Boolean",1,!1,null,0);Co.addProperty("Paragraph",10,"Microsoft.WordServices.Paragraph",3,!0,null,0);Co.addProperty("ParentContentControl",9,"Microsoft.WordServices.ContentControl",3,!0,null,0);Co.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);Co.addProperty("ParentTable",14,"Microsoft.WordServices.Table",
3,!0,null,0);Co.addProperty("ParentTableCell",13,"Microsoft.WordServices.TableCell",3,!0,null,0);Co.addProperty("ParentTableCellOrNullObject",16,"Microsoft.WordServices.TableCell",3,!0,null,0);Co.addProperty("ParentTableOrNullObject",17,"Microsoft.WordServices.Table",3,!0,null,0);Co.addProperty("Width",8,"Single",1,!1,null,0);Co.addProperty("_Id",1,"Int32",1,!0,null,0);Co.addProperty("_ReferenceId",2,"String",1,!0,null,0);Co.addMethod("Delete",1012,"Void",0,0,"Delete",0);Co.addMethod("GetBase64ImageSrc",
1003,"String",1,1,"Base64ImageSrc",0);Co.addMethod("GetNext",1015,"Microsoft.WordServices.InlinePicture",3,1,"Next",0);Co.addMethod("GetNextOrNullObject",1016,"Microsoft.WordServices.InlinePicture",3,1,"NextOrNullObject",0);Co.addMethod("GetRange",1014,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const tK=Co.addMethod("InsertBreak",1006,"Void",0,0,"InsertBreak",0);tK.addParameter("breakType","Microsoft.WordServices.BreakType",
1,null,0);tK.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Co.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const ID=Co.addMethod("InsertFileFromBase64",1011,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);ID.addParameter("base64File","String",1,null,0);ID.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const MD=Co.addMethod("InsertHtml",1008,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);MD.addParameter("html","String",1,null,0);MD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const vI=Co.addMethod("InsertInlinePictureFromBase64",1005,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);vI.addParameter("base64EncodedImage","String",1,null,0);vI.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const wI=Co.addMethod("InsertOoxml",1009,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);wI.addParameter("ooxml","String",1,null,0);wI.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const xI=Co.addMethod("InsertParagraph",1010,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);xI.addParameter("paragraphText","String",1,null,0);xI.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const wK=Co.addMethod("InsertText",1007,"Microsoft.WordServices.Range",3,0,"InsertText",0);wK.addParameter("text","String",1,null,0);
wK.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Co.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);Co.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Co.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const kz=e.addType("Microsoft.WordServices.InlinePictureCollection","{ea74232b-e74b-4a8b-9d30-04d181c29cfa}","",3,0);kz.addProperty("_ReferenceId",2,"String",1,!0,null,
0);kz.addMethod("GetFirst",1003,"Microsoft.WordServices.InlinePicture",3,1,"First",0);kz.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.InlinePicture",3,1,"FirstOrNullObject",0);kz.addIndexerMethod(1,"Microsoft.WordServices.InlinePicture",3,0).addParameter("index","Object",1,null,0);kz.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);kz.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);kz.setCollectionInfo("Microsoft.WordServices.InlinePicture",!0);const mr=e.addType("Microsoft.WordServices.List",
"{92cb59a8-b889-4985-840c-42b2f740ef33}","",3,0);mr.addProperty("Id",1,"Int32",1,!0,null,0);mr.addProperty("LevelExistences",5,"Boolean[]",1,!0,null,0);mr.addProperty("LevelTypes",4,"Microsoft.WordServices.ListLevelType[]",1,!0,null,0);mr.addProperty("Paragraphs",3,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);mr.addProperty("_ReferenceId",2,"String",1,!0,null,0);mr.addMethod("GetLevelFont",1010,"Microsoft.WordServices.Font",3,1,"LevelFont",0).addParameter("level","Int32",1,null,0);mr.addMethod("GetLevelParagraphs",
1004,"Microsoft.WordServices.ParagraphCollection",3,1,"LevelParagraphs",0).addParameter("level","Int32",1,null,0);mr.addMethod("GetLevelPicture",1009,"String",1,1,"LevelPicture",0).addParameter("level","Int32",1,null,0);mr.addMethod("GetLevelString",1007,"String",1,1,"LevelString",0).addParameter("level","Int32",1,null,0);const yI=mr.addMethod("InsertParagraph",1003,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);yI.addParameter("paragraphText","String",1,null,0);yI.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const FF=mr.addMethod("ResetLevelFont",1011,"Void",0,0,"ResetLevelFont",0);FF.addParameter("level","Int32",1,null,0);FF.addParameter("resetFontName","Boolean",1,null,0);const Yu=mr.addMethod("SetLevelAlignment",1012,"Void",0,0,"SetLevelAlignment",0);Yu.addParameter("level","Int32",1,null,0);Yu.addParameter("alignment","Microsoft.WordServices.Alignment",1,null,0);const Pm=mr.addMethod("SetLevelBullet",1005,"Void",0,0,"SetLevelBullet",0);Pm.addParameter("level",
"Int32",1,null,0);Pm.addParameter("listBullet","Microsoft.WordServices.ListBullet",1,null,0);Pm.addParameter("charCode","Int32",1,null,0);Pm.addParameter("fontName","String",1,null,0);const iG=mr.addMethod("SetLevelIndents",1013,"Void",0,0,"SetLevelIndents",0);iG.addParameter("level","Int32",1,null,0);iG.addParameter("textIndent","Single",1,null,0);iG.addParameter("bulletNumberPictureIndent","Single",1,null,0);const eJ=mr.addMethod("SetLevelNumbering",1006,"Void",0,0,"SetLevelNumbering",0);eJ.addParameter("level",
"Int32",1,null,0);eJ.addParameter("listNumbering","Microsoft.WordServices.ListNumbering",1,null,0);eJ.addParameter("formatString","Object[]",1,null,0);const fJ=mr.addMethod("SetLevelPicture",1008,"Void",0,0,"SetLevelPicture",0);fJ.addParameter("level","Int32",1,null,0);fJ.addParameter("base64EncodedImage","String",1,null,0);const jG=mr.addMethod("SetLevelStartingNumber",1014,"Void",0,0,"SetLevelStartingNumber",0);jG.addParameter("level","Int32",1,null,0);jG.addParameter("startingNumber","Int32",1,
null,0);mr.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);mr.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const Hu=e.addType("Microsoft.WordServices.ListCollection","{d36f169f-d0b0-44e9-a933-62c4dcb1964f}","",3,0);Hu.addProperty("_ReferenceId",2,"String",1,!0,null,0);Hu.addMethod("GetById",1002,"Microsoft.WordServices.List",3,1,"ById",0).addParameter("id","Int32",1,null,0);Hu.addMethod("GetByIdOrNullObject",1005,"Microsoft.WordServices.List",3,1,"ByIdOrNullObject",0).addParameter("id",
"Int32",1,null,0);Hu.addMethod("GetFirst",1004,"Microsoft.WordServices.List",3,1,"First",0);Hu.addMethod("GetFirstOrNullObject",1006,"Microsoft.WordServices.List",3,1,"FirstOrNullObject",0);Hu.addIndexerMethod(1,"Microsoft.WordServices.List",3,0).addParameter("index","Object",1,null,0);Hu.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Hu.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);Hu.setCollectionInfo("Microsoft.WordServices.List",!0);const $u=e.addType("Microsoft.WordServices.ListItem",
"{f32748c0-d8dd-44ae-a550-92ed26a085a8}","",3,0);$u.addProperty("Level",4,"Int32",1,!1,null,0);$u.addProperty("ListString",3,"String",1,!0,null,0);$u.addProperty("SiblingIndex",2,"Int32",1,!0,null,0);$u.addProperty("_ReferenceId",1,"String",1,!0,null,0);$u.addMethod("GetAncestor",1003,"Microsoft.WordServices.Paragraph",3,1,"Ancestor",0).addParameter("parentOnly","Boolean",1,null,0);$u.addMethod("GetAncestorOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"AncestorOrNullObject",0).addParameter("parentOnly",
"Boolean",1,null,0);$u.addMethod("GetDescendants",1004,"Microsoft.WordServices.ParagraphCollection",3,1,"Descendants",0).addParameter("directChildrenOnly","Boolean",1,null,0);$u.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);$u.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Lt=e.addType("Microsoft.WordServices.ListLevel","{533c4bba-63a4-4254-b249-2a6cf843330f}","",3,0);Lt.addProperty("Alignment",3,"Microsoft.WordServices.Alignment",1,!1,null,0);Lt.addProperty("Font",4,
"Microsoft.WordServices.Font",ll.ClassObject,!0,null,0);Lt.addProperty("LinkedStyle",5,"String",1,!1,null,0);Lt.addProperty("NumberFormat",6,"String",1,!1,null,0);Lt.addProperty("NumberPosition",7,"Single",1,!1,null,0);Lt.addProperty("NumberStyle",8,"Microsoft.WordServices.ListBuiltInNumberStyle",1,!1,null,0);Lt.addProperty("ResetOnHigher",9,"Int32",1,!1,null,0);Lt.addProperty("StartAt",10,"Int32",1,!1,null,0);Lt.addProperty("TabPosition",11,"Single",1,!1,null,0);Lt.addProperty("TextPosition",12,
"Single",1,!1,null,0);Lt.addProperty("TrailingCharacter",13,"Microsoft.WordServices.TrailingCharacter",1,!1,null,0);Lt.addProperty("_Id",1,"Int32",1,!0,null,0);Lt.addProperty("_ReferenceId",2,"String",1,!0,null,0);Lt.addMethod("_KeepReference",1002,"Void",ll.None,1,"_KeepReference",0);Lt.addMethod("_OnAccess",1001,"Void",ll.None,1,"_OnAccess",0);const Bv=e.addType("Microsoft.WordServices.ListLevelCollection","{0bb00b5d-0a29-41f6-a0d8-f74c3a153600}","",3,0);Bv.addProperty("_ReferenceId",2,"String",
1,!0,null,0);Bv.addMethod("GetFirst",1003,"Microsoft.WordServices.ListLevel",ll.ClassObject,1,"First",0);Bv.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.ListLevel",ll.ClassObject,1,"FirstOrNullObject",0);Bv.addIndexerMethod(1,"Microsoft.WordServices.ListLevel",ll.ClassObject,0).addParameter("index","Object",1,null,0);Bv.addMethod("_KeepReference",1001,"Void",ll.None,1,"_KeepReference",0);Bv.addMethod("_OnAccess",1002,"Void",ll.None,1,"_OnAccess",0);Bv.setCollectionInfo("Microsoft.WordServices.ListLevel",
!0);const pw=e.addType("Microsoft.WordServices.ListTemplate","{6f2e0a54-8e99-420c-9716-81cae154ac0e}","",3,0);pw.addProperty("ListLevels",2,"Microsoft.WordServices.ListLevelCollection",ll.ClassObject,!0,null,0);pw.addProperty("OutlineNumbered",3,"Boolean",1,!1,null,0);pw.addProperty("_ReferenceId",1,"String",1,!0,null,0);pw.addMethod("_KeepReference",1002,"Void",ll.None,1,"_KeepReference",0);pw.addMethod("_OnAccess",1001,"Void",ll.None,1,"_OnAccess",0);const Yw=e.addType("Microsoft.WordServices.NoteItem",
"{4869fd78-c024-4e18-9405-ffa60e9bfd51}","",3,0);Yw.addProperty("Body",4,"Microsoft.WordServices.Body",3,!0,null,0);Yw.addProperty("Reference",5,"Microsoft.WordServices.Range",3,!0,null,0);Yw.addProperty("Type",3,"Microsoft.WordServices.NoteItemType",1,!0,null,0);Yw.addProperty("_Id",1,"String",1,!0,null,0);Yw.addProperty("_ReferenceId",2,"String",1,!0,null,0);Yw.addMethod("Delete",1003,"Void",0,0,"Delete",0);Yw.addMethod("GetNext",1004,"Microsoft.WordServices.NoteItem",3,1,"Next",0);Yw.addMethod("GetNextOrNullObject",
1005,"Microsoft.WordServices.NoteItem",3,1,"NextOrNullObject",0);Yw.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Yw.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const ws=e.addType("Microsoft.WordServices.NoteItemCollection","{38a0db4c-d855-40aa-879e-2251a0f17b11}","",3,0);ws.addProperty("_ReferenceId",2,"String",1,!0,null,0);ws.addMethod("GetFirst",1003,"Microsoft.WordServices.NoteItem",3,1,"First",0);ws.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.NoteItem",
3,1,"FirstOrNullObject",0);ws.addIndexerMethod(1,"Microsoft.WordServices.NoteItem",3,0).addParameter("index","Object",1,null,0);ws.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);ws.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);ws.setCollectionInfo("Microsoft.WordServices.NoteItem",!0);const uf=e.addType("Microsoft.WordServices.Paragraph","{d0c9772c-becf-4961-a582-8024ebdc614c}","",3,0);uf.addProperty("Alignment",7,"Microsoft.WordServices.Alignment",1,!1,null,0);uf.addProperty("ContentControls",
5,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);uf.addProperty("Endnotes",36,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);uf.addProperty("FirstLineIndent",8,"Single",1,!1,null,0);uf.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);uf.addProperty("Footnotes",35,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);uf.addProperty("Fields",37,"Microsoft.WordServices.FieldCollection",3,!0,null,0);uf.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",
3,!0,null,0);uf.addProperty("IsLastParagraph",28,"Boolean",1,!0,null,0);uf.addProperty("IsListItem",19,"Boolean",1,!0,null,0);uf.addProperty("LeftIndent",9,"Single",1,!1,null,0);uf.addProperty("LineSpacing",11,"Single",1,!1,null,0);uf.addProperty("LineUnitAfter",16,"Single",1,!1,null,0);uf.addProperty("LineUnitBefore",15,"Single",1,!1,null,0);uf.addProperty("List",24,"Microsoft.WordServices.List",3,!0,null,0);uf.addProperty("ListItem",27,"Microsoft.WordServices.ListItem",3,!0,null,0);uf.addProperty("ListItemOrNullObject",
34,"Microsoft.WordServices.ListItem",3,!0,null,0);uf.addProperty("ListOrNullObject",33,"Microsoft.WordServices.List",3,!0,null,0);uf.addProperty("OutlineLevel",12,"Int32",1,!1,null,0);uf.addProperty("ParentBody",23,"Microsoft.WordServices.Body",3,!0,null,0);uf.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);uf.addProperty("ParentContentControlOrNullObject",30,"Microsoft.WordServices.ContentControl",3,!0,null,0);uf.addProperty("ParentTable",26,"Microsoft.WordServices.Table",
3,!0,null,0);uf.addProperty("ParentTableCell",25,"Microsoft.WordServices.TableCell",3,!0,null,0);uf.addProperty("ParentTableCellOrNullObject",31,"Microsoft.WordServices.TableCell",3,!0,null,0);uf.addProperty("ParentTableOrNullObject",32,"Microsoft.WordServices.Table",3,!0,null,0);uf.addProperty("RightIndent",10,"Single",1,!1,null,0);uf.addProperty("SpaceAfter",14,"Single",1,!1,null,0);uf.addProperty("SpaceBefore",13,"Single",1,!1,null,0);uf.addProperty("Style",4,"String",1,!1,null,0);uf.addProperty("StyleBuiltIn",
29,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);uf.addProperty("TableNestingLevel",22,"Int32",1,!0,null,0);uf.addProperty("Text",18,"String",1,!0,null,0);uf.addProperty("_Id",1,"Int32",1,!0,null,0);uf.addProperty("_ReferenceId",2,"String",1,!0,null,0);uf.addProperty("UniqueLocalId",38,"String",1,!0,null,0);const wi=uf.addMethod("AttachToList",1022,"Microsoft.WordServices.List",3,0,"AttachToList",0);wi.addParameter("listId","Int32",1,null,0);wi.addParameter("level","Int32",1,null,0);uf.addMethod("Clear",
1011,"Void",0,0,"Clear",0);uf.addMethod("Delete",1012,"Void",0,0,"Delete",0);uf.addMethod("DetachFromList",1023,"Void",0,0,"DetachFromList",0);uf.addMethod("GetAnnotations",1036,ya,3,1,"Annotations",0);uf.addMethod("GetComments",1032,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);uf.addMethod("GetContentControls",1034,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",
0);uf.addMethod("GetHtml",1014,"String",1,1,"Html",0);uf.addMethod("GetMetadata",1028,"Object",1,1,"Metadata",0).addParameter("propertyGUID","String",1,null,0);uf.addMethod("GetNext",1024,"Microsoft.WordServices.Paragraph",3,1,"Next",0);uf.addMethod("GetNextOrNullObject",1026,"Microsoft.WordServices.Paragraph",3,1,"NextOrNullObject",0);uf.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);uf.addMethod("GetPrevious",1025,"Microsoft.WordServices.Paragraph",3,1,"Previous",0);uf.addMethod("GetPreviousOrNullObject",
1027,"Microsoft.WordServices.Paragraph",3,1,"PreviousOrNullObject",0);uf.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);uf.addMethod("GetReviewedText",1033,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const Kx=uf.addMethod("GetSubrange",1030,"Microsoft.WordServices.Range",3,1,"Subrange",0);Kx.addParameter("start",
"Int32",1,null,0);Kx.addParameter("length","Int32",1,null,0);const qq=uf.addMethod("GetTextRanges",1020,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);qq.addParameter("endingMarks","String[]",1,null,0);qq.addParameter("trimSpacing","Boolean",1,null,0);uf.addMethod("GetTrackedChanges",1035,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);uf.addMethod("InsertAnnotations",1037,"String[]",1,0,"InsertAnnotations",0).addParameter("annotations","Microsoft.WordServices.AnnotationSet",
2,null,0);const Cz=uf.addMethod("InsertBreak",1010,"Void",0,0,"InsertBreak",0);Cz.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);Cz.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);uf.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const vC=uf.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",
3,0,"InsertFileFromBase64",0);vC.addParameter("base64File","String",1,null,0);vC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const qw=uf.addMethod("InsertHtml",1006,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);qw.addParameter("html","String",1,null,0);qw.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Rh=uf.addMethod("InsertInlinePictureFromBase64",1003,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",
0);Rh.addParameter("base64EncodedImage","String",1,null,0);Rh.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ik=uf.addMethod("InsertOoxml",1007,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);ik.addParameter("ooxml","String",1,null,0);ik.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Ir=uf.addMethod("InsertParagraph",1009,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Ir.addParameter("paragraphText","String",
1,null,0);Ir.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Xn=uf.addMethod("InsertTable",1019,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Xn.addParameter("rowCount","Int32",1,null,0);Xn.addParameter("columnCount","Int32",1,null,0);Xn.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Xn.addParameter("values","String[][]",1,null,0);const Zg=uf.addMethod("InsertText",1005,"Microsoft.WordServices.Range",3,0,"InsertText",0);
Zg.addParameter("text","String",1,null,0);Zg.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Lx=uf.addMethod("Search",1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Lx.addParameter("searchText","String",1,null,0);Lx.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);uf.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const Ss=uf.addMethod("SetMetadata",
1029,"Void",0,0,"SetMetadata",0);Ss.addParameter("propertyGUID","String",1,null,0);Ss.addParameter("propertyValue","Object",1,null,0);const rw=uf.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);rw.addParameter("delimiters","String[]",1,null,0);rw.addParameter("trimDelimiters","Boolean",1,null,0);rw.addParameter("trimSpacing","Boolean",1,null,0);uf.addMethod("StartNewList",1021,"Microsoft.WordServices.List",3,0,"StartNewList",0);uf.addMethod("_KeepReference",1002,"Void",
0,1,"_KeepReference",0);uf.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const lz=uf.addMethod("_Search2",1031,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);lz.addParameter("searchText","String",1,null,0);lz.addParameter("searchFlags","Int32",1,null,0);uf.addMethod("GetText",1038,"String",1,1,"Text",0).addParameter("options","Microsoft.WordServices.GetTextOptions",2,null,0);const zu=e.addType("Microsoft.WordServices.ParagraphCollection","{20a0d5b4-fb08-460c-96aa-6af4afe8f1ba}",
"",3,0);zu.addProperty("_ReferenceId",2,"String",1,!0,null,0);zu.addMethod("GetFirst",1003,"Microsoft.WordServices.Paragraph",3,1,"First",0);zu.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"FirstOrNullObject",0);zu.addMethod("GetLast",1004,"Microsoft.WordServices.Paragraph",3,1,"Last",0);zu.addMethod("GetLastOrNullObject",1006,"Microsoft.WordServices.Paragraph",3,1,"LastOrNullObject",0);zu.addMethod("GetById",1007,"Microsoft.WordServices.Paragraph",3,1,"ById",4).addParameter("id",
"String",1,null,0);zu.addMethod("GetByIdOrNullObject",1008,"Microsoft.WordServices.Paragraph",3,1,"ByIdOrNullObject",4).addParameter("id","String",1,null,0);zu.addIndexerMethod(1,"Microsoft.WordServices.Paragraph",3,0).addParameter("index","Object",1,null,0);zu.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);zu.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);zu.setCollectionInfo("Microsoft.WordServices.Paragraph",!0);const ij=e.addType("Microsoft.WordServices.ParagraphFormat",
"{83717b74-133d-406e-b769-670eb67c577c}","",3,0);ij.addProperty("Alignment",2,"Microsoft.WordServices.Alignment",1,!1,null,0);ij.addProperty("FirstLineIndent",3,"Single",1,!1,null,0);ij.addProperty("KeepTogether",4,"Boolean",1,!1,null,0);ij.addProperty("KeepWithNext",5,"Boolean",1,!1,null,0);ij.addProperty("LeftIndent",6,"Single",1,!1,null,0);ij.addProperty("LineSpacing",7,"Single",1,!1,null,0);ij.addProperty("LineUnitAfter",8,"Single",1,!1,null,0);ij.addProperty("LineUnitBefore",9,"Single",1,!1,
null,0);ij.addProperty("MirrorIndents",10,"Boolean",1,!1,null,0);ij.addProperty("OutlineLevel",11,"Microsoft.WordServices.OutlineLevel",1,!1,null,0);ij.addProperty("RightIndent",12,"Single",1,!1,null,0);ij.addProperty("SpaceAfter",13,"Single",1,!1,null,0);ij.addProperty("SpaceBefore",14,"Single",1,!1,null,0);ij.addProperty("WidowControl",15,"Boolean",1,!1,null,0);ij.addProperty("_ReferenceId",1,"String",1,!0,null,0);ij.addMethod("_KeepReference",1002,"Void",ll.None,1,"_KeepReference",0);ij.addMethod("_OnAccess",
1001,"Void",ll.None,1,"_OnAccess",0);const Dj=e.addType("Microsoft.WordServices.Range","{4869fd78-c024-4e18-9405-ffa60e9bfd50}","",3,0);Dj.addProperty("ContentControls",6,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Dj.addProperty("Endnotes",22,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Dj.addProperty("Fields",23,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Dj.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Dj.addProperty("Footnotes",21,"Microsoft.WordServices.NoteItemCollection",
3,!0,null,0);Dj.addProperty("Hyperlink",11,"String",1,!1,null,0);Dj.addProperty("InlinePictures",8,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Dj.addProperty("IsEmpty",10,"Boolean",1,!0,null,0);Dj.addProperty("Lists",12,"Microsoft.WordServices.ListCollection",3,!0,null,0);Dj.addProperty("Paragraphs",5,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Dj.addProperty("ParentBody",16,"Microsoft.WordServices.Body",3,!0,null,0);Dj.addProperty("ParentContentControl",7,"Microsoft.WordServices.ContentControl",
3,!0,null,0);Dj.addProperty("ParentContentControlOrNullObject",18,"Microsoft.WordServices.ContentControl",3,!0,null,0);Dj.addProperty("ParentTable",15,"Microsoft.WordServices.Table",3,!0,null,0);Dj.addProperty("ParentTableCell",14,"Microsoft.WordServices.TableCell",3,!0,null,0);Dj.addProperty("ParentTableCellOrNullObject",19,"Microsoft.WordServices.TableCell",3,!0,null,0);Dj.addProperty("ParentTableOrNullObject",20,"Microsoft.WordServices.Table",3,!0,null,0);Dj.addProperty("Style",4,"String",1,!1,
null,0);Dj.addProperty("StyleBuiltIn",17,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Dj.addProperty("Tables",13,"Microsoft.WordServices.TableCollection",3,!0,null,0);Dj.addProperty("Text",9,"String",1,!0,null,0);Dj.addProperty("_Id",1,"Int32",1,!0,null,0);Dj.addProperty("_ReferenceId",2,"String",1,!0,null,0);Dj.addMethod("GetReviewedText",1041,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);Dj.addMethod("Clear",
1011,"Void",0,0,"Clear",0);Dj.addMethod("CompareLocationWith",1019,"Microsoft.WordServices.LocationRelation",1,1,"CompareLocationWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("Delete",1012,"Void",0,0,"Delete",0);Dj.addMethod("EndPreview",1035,"Void",0,1,"EndPreview",0);Dj.addMethod("ExpandTo",1020,"Microsoft.WordServices.Range",3,0,"ExpandTo",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("ExpandToOrNullObject",1028,"Microsoft.WordServices.Range",
3,0,"ExpandToOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);const Iq=Dj.addMethod("GetBookmarks",1026,"String[]",1,1,"Bookmarks",0);Iq.addParameter("includeHidden","Boolean",1,null,0);Iq.addParameter("includeAdjacent","Boolean",1,null,0);Dj.addMethod("GetComments",1040,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Dj.addMethod("GetContentControls",1042,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options",
"Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Dj.addMethod("GetHtml",1014,"String",1,1,"Html",0);Dj.addMethod("GetHyperlinkRanges",1023,"Microsoft.WordServices.RangeCollection",3,1,"HyperlinkRanges",0);const bl=Dj.addMethod("GetNextTextRange",1022,"Microsoft.WordServices.Range",3,1,"NextTextRange",0);bl.addParameter("endingMarks","String[]",1,null,0);bl.addParameter("trimSpacing","Boolean",1,null,0);const Mt=Dj.addMethod("GetNextTextRangeOrNullObject",
1030,"Microsoft.WordServices.Range",3,1,"NextTextRangeOrNullObject",0);Mt.addParameter("endingMarks","String[]",1,null,0);Mt.addParameter("trimSpacing","Boolean",1,null,0);Dj.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Dj.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const wC=Dj.addMethod("GetTextRanges",1025,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);wC.addParameter("endingMarks",
"String[]",1,null,0);wC.addParameter("trimSpacing","Boolean",1,null,0);Dj.addMethod("GetTrackedChanges",1044,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);Dj.addMethod("Highlight",1032,"Void",0,1,"Highlight",0).addParameter("color","String",1,null,0);Dj.addMethod("InsertBookmark",1027,"Void",0,0,"InsertBookmark",0).addParameter("name","String",1,null,0);const cl=Dj.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);cl.addParameter("breakType","Microsoft.WordServices.BreakType",
1,null,0);cl.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Dj.addMethod("InsertComment",1039,"Microsoft.WordServices.Comment",3,0,"InsertComment",0).addParameter("commentText","String",1,null,0);Dj.addMethod("InsertContentControl",1003,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);Dj.addMethod("InsertEndnote",1038,"Microsoft.WordServices.NoteItem",3,0,"InsertEndnote",
0).addParameter("insertText","String",1,null,0);const fC=Dj.addMethod("InsertField",1043,"Microsoft.WordServices.Field",ll.ClassObject,0,"InsertField",0);fC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);fC.addParameter("fieldType","Microsoft.WordServices.FieldType",1,null,0);fC.addParameter("text","String",1,null,0);fC.addParameter("removeFormatting","Boolean",1,null,0);const jt=Dj.addMethod("InsertFileFromBase64",1007,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",
0);jt.addParameter("base64File","String",1,null,0);jt.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Dj.addMethod("InsertFootnote",1037,"Microsoft.WordServices.NoteItem",3,0,"InsertFootnote",0).addParameter("insertText","String",1,null,0);const BA=Dj.addMethod("InsertHtml",1005,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);BA.addParameter("html","String",1,null,0);BA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ND=Dj.addMethod("InsertInlinePictureFromBase64",
1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);ND.addParameter("base64EncodedImage","String",1,null,0);ND.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const CA=Dj.addMethod("InsertOoxml",1006,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);CA.addParameter("ooxml","String",1,null,0);CA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const mz=Dj.addMethod("InsertParagraph",1008,"Microsoft.WordServices.Paragraph",
3,0,"InsertParagraph",0);mz.addParameter("paragraphText","String",1,null,0);mz.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const OD=Dj.addMethod("InsertTable",1024,"Microsoft.WordServices.Table",3,0,"InsertTable",0);OD.addParameter("rowCount","Int32",1,null,0);OD.addParameter("columnCount","Int32",1,null,0);OD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);OD.addParameter("values","String[][]",1,null,0);const Au=Dj.addMethod("InsertTapObjectFromFileContent",
1031,"Microsoft.WordServices.Range",3,0,"InsertTapObjectFromFileContent",4);Au.addParameter("fileContent","String",1,null,0);Au.addParameter("objectType","Microsoft.WordServices.TapObjectType",1,null,0);Au.addParameter("contentFormat","Microsoft.WordServices.FileContentFormat",1,null,0);const PD=Dj.addMethod("InsertText",1004,"Microsoft.WordServices.Range",3,0,"InsertText",0);PD.addParameter("text","String",1,null,0);PD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,
0);Dj.addMethod("IntersectWith",1021,"Microsoft.WordServices.Range",3,0,"IntersectWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("IntersectWithOrNullObject",1029,"Microsoft.WordServices.Range",3,0,"IntersectWithOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("PreviewTextReplacement",1034,"Void",0,1,"PreviewTextReplacement",0).addParameter("replacement","String",1,null,0);Dj.addMethod("RemoveHighlight",1033,"Void",0,1,
"RemoveHighlight",0);const zI=Dj.addMethod("Search",1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);zI.addParameter("searchText","String",1,null,0);zI.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Dj.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const QD=Dj.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);QD.addParameter("delimiters","String[]",
1,null,0);QD.addParameter("multiParagraphs","Boolean",1,null,0);QD.addParameter("trimDelimiters","Boolean",1,null,0);QD.addParameter("trimSpacing","Boolean",1,null,0);Dj.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Dj.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const gC=Dj.addMethod("_Search2",1036,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);gC.addParameter("searchText","String",1,null,0);gC.addParameter("searchFlags","Int32",1,null,0);const nz=e.addType("Microsoft.WordServices.RangeCollection",
"{38a0db4c-d855-40aa-879e-2251a0f17b1f}","",3,0);nz.addProperty("_ReferenceId",2,"String",1,!0,null,0);nz.addMethod("GetFirst",1003,"Microsoft.WordServices.Range",3,1,"First",0);nz.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Range",3,1,"FirstOrNullObject",0);nz.addIndexerMethod(1,"Microsoft.WordServices.Range",3,0).addParameter("index","Object",1,null,0);nz.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);nz.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);nz.setCollectionInfo("Microsoft.WordServices.Range",
!0);const oz=e.addType("Microsoft.WordServices.InsertFileOptions","{d396444d-d57f-45bb-a6b1-656f573b250f}","{0ad8e799-7550-4095-aa56-c0c6171febe8}",2,0);oz.addProperty("importCustomXmlParts",7,"Boolean",1,!1,null,0);oz.addProperty("importCustomProperties",6,"Boolean",1,!1,null,0);oz.addProperty("importChangeTrackingMode",5,"Boolean",1,!1,null,0);oz.addProperty("importPageColor",4,"Boolean",1,!1,null,0);oz.addProperty("importParagraphSpacing",3,"Boolean",1,!1,null,0);oz.addProperty("importStyles",
2,"Boolean",1,!1,null,0);oz.addProperty("importTheme",1,"Boolean",1,!1,null,0);const ry=e.addType("Microsoft.WordServices.SearchOptions","{957e194f-14af-462d-bd95-e29a55de3b4a}","{88b0a400-950b-42b1-b183-258f504bf71f}",3,0);ry.addProperty("IgnorePunct",1,"Boolean",1,!1,null,0);ry.addProperty("IgnoreSpace",2,"Boolean",1,!1,null,0);ry.addProperty("MatchCase",3,"Boolean",1,!1,null,0);ry.addProperty("MatchPrefix",4,"Boolean",1,!1,null,0);ry.addProperty("MatchSuffix",6,"Boolean",1,!1,null,0);ry.addProperty("MatchWholeWord",
8,"Boolean",1,!1,null,0);ry.addProperty("MatchWildcards",7,"Boolean",1,!1,null,0);const RD=e.addType("Microsoft.WordServices.GetTextOptions","{56e44ca6-8d40-4a75-9174-6fa534b3fe9b}","{168a8246-cc51-4a90-9047-67cb9a0465a6}",2,0);RD.addProperty("IncludeHiddenText",1,"Boolean",1,!1,null,0);RD.addProperty("IncludeTextMarkedAsDeleted",2,"Boolean",1,!1,null,0);const Im=e.addType("Microsoft.WordServices.Section","{a9d1403c-908b-4178-aa45-6b406aeb8cbf}","",3,0);Im.addProperty("Body",3,"Microsoft.WordServices.Body",
3,!0,null,0);Im.addProperty("_Id",1,"Int32",1,!0,null,0);Im.addProperty("_ReferenceId",2,"String",1,!0,null,0);Im.addMethod("GetFooter",1004,"Microsoft.WordServices.Body",3,1,"Footer",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);Im.addMethod("GetHeader",1003,"Microsoft.WordServices.Body",3,1,"Header",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);Im.addMethod("GetNext",1005,"Microsoft.WordServices.Section",3,1,"Next",0);Im.addMethod("GetNextOrNullObject",
1006,"Microsoft.WordServices.Section",3,1,"NextOrNullObject",0);Im.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Im.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Bu=e.addType("Microsoft.WordServices.SectionCollection","{23ef4423-1c46-48ee-951a-cec1d21d3a5b}","",3,0);Bu.addProperty("_ReferenceId",2,"String",1,!0,null,0);Bu.addMethod("GetFirst",1003,"Microsoft.WordServices.Section",3,1,"First",0);Bu.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Section",
3,1,"FirstOrNullObject",0);Bu.addIndexerMethod(1,"Microsoft.WordServices.Section",3,0).addParameter("index","Object",1,null,0);Bu.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Bu.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Bu.setCollectionInfo("Microsoft.WordServices.Section",!0);const kt=e.addType("Microsoft.WordServices.Setting","{03764d8a-7c3a-4a5f-82ec-029fbc6f57ee}","",3,0);kt.addProperty("Key",2,"String",1,!0,null,0);kt.addProperty("Value",3,"Object",1,!1,null,0);kt.addProperty("_Id",
4,"String",1,!0,null,0);kt.addProperty("_ReferenceId",1,"String",1,!0,null,0);kt.addMethod("Delete",1003,"Void",0,0,"Delete",0);kt.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);kt.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const jw=e.addType("Microsoft.WordServices.SettingCollection","{02c3b0b1-2468-48c1-8c30-c1e38c6734f7}","",3,0);jw.addProperty("_ReferenceId",2,"String",1,!0,null,0);const AI=jw.addMethod("Add",1003,"Microsoft.WordServices.Setting",3,0,"Add",0);AI.addParameter("key",
"String",1,null,0);AI.addParameter("value","Object",1,null,0);jw.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);jw.addMethod("GetCount",1004,"Int32",1,1,"Count",0);jw.addIndexerMethod(1,"Microsoft.WordServices.Setting",3,0).addParameter("key","String",1,null,0);jw.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.Setting",3,1,"ItemOrNullObject",0).addParameter("key","String",1,null,0);jw.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);jw.addMethod("_OnAccess",1001,
"Void",0,1,"_OnAccess",0);jw.setCollectionInfo("Microsoft.WordServices.Setting",!0);const aq=e.addType("Microsoft.WordServices.StyleCollection","{fee8d15d-a953-4906-aa80-af8d02008719}","",3,0);aq.addProperty("_ReferenceId",2,"String",1,!0,null,0);aq.addMethod("GetByName",1003,"Microsoft.WordServices.Style",ll.ClassObject,1,"GetByName",0).addParameter("name","String",1,null,0);aq.addMethod("GetByNameOrNullObject",1004,"Microsoft.WordServices.Style",ll.ClassObject,1,"GetByNameOrNullObject",0).addParameter("name",
"String",1,null,0);aq.addMethod("GetCount",1005,"Int32",1,1,"Count",0);aq.addIndexerMethod(1,"Microsoft.WordServices.Style",ll.ClassObject,0).addParameter("index","Object",1,null,0);aq.addMethod("_KeepReference",1002,"Void",ll.None,1,"_KeepReference",0);aq.addMethod("_OnAccess",1001,"Void",ll.None,1,"_OnAccess",0);aq.setCollectionInfo("Microsoft.WordServices.Style",!0);const Qs=e.addType("Microsoft.WordServices.Style","{c2b96925-a089-4d9d-b70e-9a842277a864}","",3,0);Qs.addProperty("BaseStyle",2,"String",
1,!0,null,0);Qs.addProperty("BuiltIn",3,"Boolean",1,!0,null,0);Qs.addProperty("Description",4,"String",1,!0,null,0);Qs.addProperty("Font",5,"Microsoft.WordServices.Font",ll.ClassObject,!0,null,0);Qs.addProperty("InUse",6,"Boolean",1,!0,null,0);Qs.addProperty("Linked",7,"Boolean",1,!0,null,0);Qs.addProperty("ListTemplate",16,"Microsoft.WordServices.ListTemplate",ll.ClassObject,!0,null,0);Qs.addProperty("NameLocal",8,"String",1,!0,null,0);Qs.addProperty("NextParagraphStyle",9,"String",1,!0,null,0);
Qs.addProperty("ParagraphFormat",15,"Microsoft.WordServices.ParagraphFormat",ll.ClassObject,!0,null,0);Qs.addProperty("Priority",10,"Int32",1,!1,null,0);Qs.addProperty("QuickStyle",11,"Boolean",1,!1,null,0);Qs.addProperty("Type",12,"Microsoft.WordServices.StyleType",1,!0,null,0);Qs.addProperty("UnhideWhenUsed",13,"Boolean",1,!1,null,0);Qs.addProperty("Visibility",14,"Boolean",1,!1,null,0);Qs.addProperty("_ReferenceId",1,"String",1,!0,null,0);Qs.addMethod("Delete",1003,"Void",ll.None,0,"Delete",0);
Qs.addMethod("_KeepReference",1002,"Void",ll.None,1,"_KeepReference",0);Qs.addMethod("_OnAccess",1001,"Void",ll.None,1,"_OnAccess",0);const Ck=e.addType("Microsoft.WordServices.Table","{55eb3bc4-acec-4fed-b8d3-10414e633465}","",3,0);Ck.addProperty("Alignment",33,"Microsoft.WordServices.Alignment",1,!1,null,0);Ck.addProperty("Endnotes",38,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ck.addProperty("Fields",39,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Ck.addProperty("Font",24,
"Microsoft.WordServices.Font",3,!0,null,0);Ck.addProperty("Footnotes",37,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ck.addProperty("HeaderRowCount",12,"Int32",1,!1,null,0);Ck.addProperty("HorizontalAlignment",22,"Microsoft.WordServices.Alignment",1,!1,null,0);Ck.addProperty("IsUniform",4,"Boolean",1,!0,null,0);Ck.addProperty("NestingLevel",6,"Int32",1,!0,null,0);Ck.addProperty("ParentBody",32,"Microsoft.WordServices.Body",3,!0,null,0);Ck.addProperty("ParentContentControl",25,"Microsoft.WordServices.ContentControl",
3,!0,null,0);Ck.addProperty("ParentContentControlOrNullObject",36,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ck.addProperty("ParentTable",8,"Microsoft.WordServices.Table",3,!0,null,0);Ck.addProperty("ParentTableCell",7,"Microsoft.WordServices.TableCell",3,!0,null,0);Ck.addProperty("ParentTableCellOrNullObject",34,"Microsoft.WordServices.TableCell",3,!0,null,0);Ck.addProperty("ParentTableOrNullObject",35,"Microsoft.WordServices.Table",3,!0,null,0);Ck.addProperty("RowCount",11,"Int32",1,!0,
null,0);Ck.addProperty("Rows",3,"Microsoft.WordServices.TableRowCollection",3,!0,null,0);Ck.addProperty("ShadingColor",18,"String",1,!1,null,0);Ck.addProperty("Style",10,"String",1,!1,null,0);Ck.addProperty("StyleBandedColumns",17,"Boolean",1,!1,null,0);Ck.addProperty("StyleBandedRows",16,"Boolean",1,!1,null,0);Ck.addProperty("StyleBuiltIn",31,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Ck.addProperty("StyleFirstColumn",14,"Boolean",1,!1,null,0);Ck.addProperty("StyleLastColumn",15,"Boolean",
1,!1,null,0);Ck.addProperty("StyleTotalRow",13,"Boolean",1,!1,null,0);Ck.addProperty("Tables",5,"Microsoft.WordServices.TableCollection",3,!0,null,0);Ck.addProperty("Values",9,"String[][]",1,!1,null,0);Ck.addProperty("VerticalAlignment",23,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);Ck.addProperty("Width",27,"Single",1,!1,null,0);Ck.addProperty("_Id",1,"Int32",1,!0,null,0);Ck.addProperty("_ReferenceId",2,"String",1,!0,null,0);const Mw=Ck.addMethod("AddColumns",1004,"Void",0,0,"AddColumns",
0);Mw.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Mw.addParameter("columnCount","Int32",1,null,0);Mw.addParameter("values","String[][]",1,null,0);const Nw=Ck.addMethod("AddRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"AddRows",0);Nw.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Nw.addParameter("rowCount","Int32",1,null,0);Nw.addParameter("values","String[][]",1,null,0);Ck.addMethod("AutoFitWindow",1012,"Void",0,0,
"AutoFitWindow",0);Ck.addMethod("Clear",1008,"Void",0,0,"Clear",0);Ck.addMethod("Delete",1007,"Void",0,0,"Delete",0);const BI=Ck.addMethod("DeleteColumns",1010,"Void",0,0,"DeleteColumns",0);BI.addParameter("columnIndex","Int32",1,null,0);BI.addParameter("columnCount","Int32?",1,null,0);const Ft=Ck.addMethod("DeleteRows",1009,"Void",0,0,"DeleteRows",0);Ft.addParameter("rowIndex","Int32",1,null,0);Ft.addParameter("rowCount","Int32?",1,null,0);Ck.addMethod("DistributeColumns",1014,"Void",0,0,"DistributeColumns",
0);Ck.addMethod("GetBorder",1015,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);const xK=Ck.addMethod("GetCell",1005,"Microsoft.WordServices.TableCell",3,1,"Cell",0);xK.addParameter("rowIndex","Int32",1,null,0);xK.addParameter("cellIndex","Int32",1,null,0);const Dp=Ck.addMethod("GetCellOrNullObject",1028,"Microsoft.WordServices.TableCell",3,1,"CellOrNullObject",0);Dp.addParameter("rowIndex","Int32",1,null,0);Dp.addParameter("cellIndex",
"Int32",1,null,0);Ck.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);Ck.addMethod("GetNext",1025,"Microsoft.WordServices.Table",3,1,"Next",0);Ck.addMethod("GetNextOrNullObject",1029,"Microsoft.WordServices.Table",3,1,"NextOrNullObject",0);Ck.addMethod("GetParagraphAfter",1027,"Microsoft.WordServices.Paragraph",3,1,"ParagraphAfter",0);Ck.addMethod("GetParagraphAfterOrNullObject",1031,"Microsoft.WordServices.Paragraph",
3,1,"ParagraphAfterOrNullObject",0);Ck.addMethod("GetParagraphBefore",1026,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBefore",0);Ck.addMethod("GetParagraphBeforeOrNullObject",1030,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBeforeOrNullObject",0);Ck.addMethod("GetRange",1019,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);Ck.addMethod("InsertContentControl",1020,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",
0);const CI=Ck.addMethod("InsertParagraph",1022,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);CI.addParameter("paragraphText","String",1,null,0);CI.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Rl=Ck.addMethod("InsertTable",1021,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Rl.addParameter("rowCount","Int32",1,null,0);Rl.addParameter("columnCount","Int32",1,null,0);Rl.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);Rl.addParameter("values","String[][]",1,null,0);const Ow=Ck.addMethod("MergeCells",1006,"Microsoft.WordServices.TableCell",3,0,"MergeCells",0);Ow.addParameter("topRow","Int32",1,null,0);Ow.addParameter("firstCell","Int32",1,null,0);Ow.addParameter("bottomRow","Int32",1,null,0);Ow.addParameter("lastCell","Int32",1,null,0);const DI=Ck.addMethod("Search",1018,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);DI.addParameter("searchText","String",1,null,0);DI.addParameter("searchOptions",
"Microsoft.WordServices.SearchOptions",3,null,0);Ck.addMethod("Select",1017,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const GF=Ck.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);GF.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);GF.addParameter("cellPadding","Single",1,null,0);Ck.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ck.addMethod("_OnAccess",1001,"Void",0,1,
"_OnAccess",0);const yK=Ck.addMethod("_Search2",1032,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);yK.addParameter("searchText","String",1,null,0);yK.addParameter("searchFlags","Int32",1,null,0);const pz=e.addType("Microsoft.WordServices.TableCollection","{793ca292-e6dc-48f7-b0e6-16311394a5b2}","",3,0);pz.addProperty("_ReferenceId",2,"String",1,!0,null,0);pz.addMethod("GetFirst",1003,"Microsoft.WordServices.Table",3,1,"First",0);pz.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Table",
3,1,"FirstOrNullObject",0);pz.addIndexerMethod(1,"Microsoft.WordServices.Table",3,0).addParameter("index","Object",1,null,0);pz.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);pz.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);pz.setCollectionInfo("Microsoft.WordServices.Table",!0);const So=e.addType("Microsoft.WordServices.TableRow","{7a28087b-2d9c-4db1-95af-b1ce69d1d4db}","",3,0);So.addProperty("CellCount",4,"Int32",1,!0,null,0);So.addProperty("Cells",3,"Microsoft.WordServices.TableCellCollection",
3,!0,null,0);So.addProperty("Endnotes",20,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);So.addProperty("Font",14,"Microsoft.WordServices.Font",3,!0,null,0);So.addProperty("Fields",21,"Microsoft.WordServices.FieldCollection",3,!0,null,0);So.addProperty("Footnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);So.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);So.addProperty("IsHeader",16,"Boolean",1,!0,null,0);So.addProperty("ParentTable",
5,"Microsoft.WordServices.Table",3,!0,null,0);So.addProperty("PreferredHeight",17,"Single",1,!1,null,0);So.addProperty("RowIndex",6,"Int32",1,!0,null,0);So.addProperty("ShadingColor",8,"String",1,!1,null,0);So.addProperty("Values",7,"String[][]",1,!1,null,0);So.addProperty("VerticalAlignment",13,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);So.addProperty("_Id",1,"Int32",1,!0,null,0);So.addProperty("_ReferenceId",2,"String",1,!0,null,0);So.addMethod("Clear",1006,"Void",0,0,"Clear",0);So.addMethod("Delete",
1005,"Void",0,0,"Delete",0);So.addMethod("GetBorder",1009,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);So.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);So.addMethod("GetNext",1012,"Microsoft.WordServices.TableRow",3,1,"Next",0);So.addMethod("GetNextOrNullObject",1013,"Microsoft.WordServices.TableRow",3,1,
"NextOrNullObject",0);So.addMethod("InsertContentControl",1025,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const be=So.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,1,"InsertRows",0);be.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);be.addParameter("rowCount","Int32",1,null,0);be.addParameter("values","String[][]",1,null,0);So.addMethod("Merge",1004,"Microsoft.WordServices.TableCell",3,0,"Merge",0);const HF=So.addMethod("Search",
1008,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);HF.addParameter("searchText","String",1,null,0);HF.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);So.addMethod("Select",1007,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const tC=So.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);tC.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);tC.addParameter("cellPadding",
"Single",1,null,0);So.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);So.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const FL=So.addMethod("_Search2",1026,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);FL.addParameter("searchText","String",1,null,0);FL.addParameter("searchFlags","Int32",1,null,0);const Qk=e.addType("Microsoft.WordServices.TableRowCollection","{f752737f-a469-460b-a2c1-08b958efb48f}","",3,0);Qk.addProperty("_ReferenceId",2,"String",1,!0,null,0);Qk.addMethod("GetFirst",
1003,"Microsoft.WordServices.TableRow",3,1,"First",0);Qk.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableRow",3,1,"FirstOrNullObject",0);Qk.addIndexerMethod(1,"Microsoft.WordServices.TableRow",3,0).addParameter("index","Object",1,null,0);Qk.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Qk.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Qk.setCollectionInfo("Microsoft.WordServices.TableRow",!0);const pq=e.addType("Microsoft.WordServices.TableCell","{276a08f8-2afc-42fd-a336-8890d712e195}",
"",3,0);pq.addProperty("Body",8,"Microsoft.WordServices.Body",3,!0,null,0);pq.addProperty("CellIndex",6,"Int32",1,!0,null,0);pq.addProperty("ColumnWidth",15,"Single?",1,!1,null,0);pq.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);pq.addProperty("ParentRow",4,"Microsoft.WordServices.TableRow",3,!0,null,0);pq.addProperty("ParentTable",3,"Microsoft.WordServices.Table",3,!0,null,0);pq.addProperty("RowIndex",5,"Int32",1,!0,null,0);pq.addProperty("ShadingColor",9,"String",
1,!1,null,0);pq.addProperty("Value",7,"String",1,!1,null,0);pq.addProperty("VerticalAlignment",14,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);pq.addProperty("Width",16,"Single",1,!0,null,0);pq.addProperty("_Id",1,"Int32",1,!0,null,0);pq.addProperty("_ReferenceId",2,"String",1,!0,null,0);pq.addMethod("DeleteColumn",1007,"Void",0,0,"DeleteColumn",0);pq.addMethod("DeleteRow",1006,"Void",0,0,"DeleteRow",0);pq.addMethod("GetBorder",1008,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation",
"Microsoft.WordServices.BorderLocation",1,null,0);pq.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);pq.addMethod("GetNext",1011,"Microsoft.WordServices.TableCell",3,1,"Next",0);pq.addMethod("GetNextOrNullObject",1012,"Microsoft.WordServices.TableCell",3,1,"NextOrNullObject",0);const DA=pq.addMethod("InsertColumns",1004,"Void",0,0,"InsertColumns",0);DA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);DA.addParameter("columnCount","Int32",1,null,0);DA.addParameter("values","String[][]",1,null,0);const IF=pq.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"InsertRows",0);IF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);IF.addParameter("rowCount","Int32",1,null,0);IF.addParameter("values","String[][]",1,null,0);const hC=pq.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);hC.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",
1,null,0);hC.addParameter("cellPadding","Single",1,null,0);const EI=pq.addMethod("Split",1005,"Void",0,0,"Split",0);EI.addParameter("rowCount","Int32",1,null,0);EI.addParameter("columnCount","Int32",1,null,0);pq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);pq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Ay=e.addType("Microsoft.WordServices.TableCellCollection","{67dffdfa-3a5c-431b-8ea7-9600e82453e3}","",3,0);Ay.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ay.addMethod("GetFirst",
1003,"Microsoft.WordServices.TableCell",3,1,"First",0);Ay.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableCell",3,1,"FirstOrNullObject",0);Ay.addIndexerMethod(1,"Microsoft.WordServices.TableCell",3,0).addParameter("index","Object",1,null,0);Ay.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ay.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Ay.setCollectionInfo("Microsoft.WordServices.TableCell",!0);const Pw=e.addType("Microsoft.WordServices.TableBorder","{3e45a91b-f887-4feb-8fef-21e1e40f6fb6}",
"",3,0);Pw.addProperty("Color",2,"String",1,!1,null,0);Pw.addProperty("Type",3,"Microsoft.WordServices.BorderType",1,!1,null,0);Pw.addProperty("Width",4,"Single",1,!1,null,0);Pw.addProperty("_ReferenceId",1,"String",1,!0,null,0);Pw.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Pw.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Rs=e.addType("Microsoft.WordServices.TrackedChange","{fb2462ee-ab45-426e-9637-de15ad6bf81d}","",3,0);Rs.addProperty("Author",2,"String",1,!0,null,
0);Rs.addProperty("Date",3,"DateTime",1,!0,null,0);Rs.addProperty("Text",4,"String",1,!0,null,0);Rs.addProperty("Type",5,"Microsoft.WordServices.TrackedChangeType",1,!0,null,0);Rs.addProperty("_ReferenceId",1,"String",1,!0,null,0);Rs.addMethod("Accept",1003,"Void",0,0,"Accept",0);Rs.addMethod("GetNext",1006,"Microsoft.WordServices.TrackedChange",3,1,"Next",0);Rs.addMethod("GetNextOrNullObject",1007,"Microsoft.WordServices.TrackedChange",3,1,"NextOrNullObject",0);Rs.addMethod("GetRange",1005,"Microsoft.WordServices.Range",
3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);Rs.addMethod("Reject",1004,"Void",0,0,"Reject",0);Rs.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Rs.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Ex=e.addType("Microsoft.WordServices.TrackedChangeCollection","{072f5cd0-50c2-4619-9478-8605fbe0797b}","",3,0);Ex.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ex.addMethod("AcceptAll",1006,"Void",0,0,"AcceptAll",0);Ex.addMethod("GetFirst",
1004,"Microsoft.WordServices.TrackedChange",3,1,"First",0);Ex.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.TrackedChange",3,1,"FirstOrNullObject",0);Ex.addIndexerMethod(1,"Microsoft.WordServices.TrackedChange",ll.ClassObject,0).addParameter("index","Object",1,null,0);Ex.addMethod("RejectAll",1007,"Void",0,0,"RejectAll",0);Ex.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ex.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Ex.setCollectionInfo("Microsoft.WordServices.TrackedChange",
!0);const Rp=e.addEnumType("Microsoft.WordServices.EventType");Rp.addEnumField("ContentControlDeleted",0);Rp.addEnumField("ContentControlSelectionChanged",1);Rp.addEnumField("ContentControlDataChanged",2);Rp.addEnumField("ContentControlAdded",3);Rp.addEnumField("AnnotationAdded",4);Rp.addEnumField("AnnotationChanged",5);Rp.addEnumField("AnnotationDeleted",6);Rp.addEnumField("CommentDeleted",7);Rp.addEnumField("CommentSelected",8);Rp.addEnumField("CommentDeselected",9);Rp.addEnumField("CommentChanged",
10);Rp.addEnumField("CommentAdded",11);Rp.addEnumField("ContentControlEntered",12);Rp.addEnumField("ContentControlExited",13);Rp.addEnumField("DocumentWordCountChanged",14);Rp.addEnumField("ParagraphAdded",15);Rp.addEnumField("ParagraphChanged",16);Rp.addEnumField("ParagraphDeleted",17);Rp.addEnumField("AnnotationClicked",18);Rp.addEnumField("AnnotationHovered",19);Rp.addEnumField("AnnotationInserted",20);Rp.addEnumField("AnnotationRemoved",21);const Gt=e.addEnumType("Microsoft.WordServices.ContentControlType");
Gt.addEnumField("Unknown",0);Gt.addEnumField("RichTextInline",1);Gt.addEnumField("RichTextParagraphs",2);Gt.addEnumField("RichTextTableCell",4);Gt.addEnumField("RichTextTableRow",8);Gt.addEnumField("RichTextTable",16);Gt.addEnumField("PlainTextInline",32);Gt.addEnumField("PlainTextParagraph",64);Gt.addEnumField("Picture",128);Gt.addEnumField("BuildingBlockGallery",256);Gt.addEnumField("CheckBox",512);Gt.addEnumField("ComboBox",1024);Gt.addEnumField("DropDownList",2048);Gt.addEnumField("DatePicker",
4096);Gt.addEnumField("RepeatingSection",8192);Gt.addEnumField("RichText",31);Gt.addEnumField("PlainText",96);const FI=e.addEnumType("Microsoft.WordServices.ContentControlAppearance");FI.addEnumField("BoundingBox",0);FI.addEnumField("Tags",1);FI.addEnumField("Hidden",2);const nr=e.addEnumType("Microsoft.WordServices.UnderlineType");nr.addEnumField("Mixed",-1);nr.addEnumField("None",0);nr.addEnumField("Hidden",5);nr.addEnumField("DotLine",8);nr.addEnumField("Single",1);nr.addEnumField("Word",2);nr.addEnumField("Double",
3);nr.addEnumField("Thick",6);nr.addEnumField("Dotted",4);nr.addEnumField("DottedHeavy",20);nr.addEnumField("DashLine",7);nr.addEnumField("DashLineHeavy",23);nr.addEnumField("DashLineLong",39);nr.addEnumField("DashLineLongHeavy",55);nr.addEnumField("DotDashLine",9);nr.addEnumField("DotDashLineHeavy",25);nr.addEnumField("TwoDotDashLine",10);nr.addEnumField("TwoDotDashLineHeavy",26);nr.addEnumField("Wave",11);nr.addEnumField("WaveHeavy",27);nr.addEnumField("WaveDouble",43);const qz=e.addEnumType("Microsoft.WordServices.BreakType");
qz.addEnumField("Page",0);qz.addEnumField("Next",2);qz.addEnumField("SectionNext",1002);qz.addEnumField("SectionContinuous",3);qz.addEnumField("SectionEven",4);qz.addEnumField("SectionOdd",5);qz.addEnumField("Line",6);const iC=e.addEnumType("Microsoft.WordServices.InsertLocation");iC.addEnumField("Before",0);iC.addEnumField("After",1);iC.addEnumField("Start",2);iC.addEnumField("End",3);iC.addEnumField("Replace",4);const rz=e.addEnumType("Microsoft.WordServices.Alignment");rz.addEnumField("Mixed",
-2);rz.addEnumField("Unknown",-1);rz.addEnumField("Left",0);rz.addEnumField("Centered",1);rz.addEnumField("Right",2);rz.addEnumField("Justified",3);const JF=e.addEnumType("Microsoft.WordServices.HeaderFooterType");JF.addEnumField("Primary",0);JF.addEnumField("FirstPage",1);JF.addEnumField("EvenPages",2);const Fx=e.addEnumType("Microsoft.WordServices.BodyType");Fx.addEnumField("Unknown",-1);Fx.addEnumField("MainDoc",0);Fx.addEnumField("Section",1);Fx.addEnumField("Header",2);Fx.addEnumField("Footer",
3);Fx.addEnumField("TableCell",4);Fx.addEnumField("Footnote",5);Fx.addEnumField("Endnote",6);Fx.addEnumField("NoteItem",7);const EA=e.addEnumType("Microsoft.WordServices.SelectionMode");EA.addEnumField("Select",0);EA.addEnumField("Start",1);EA.addEnumField("End",2);const Cu=e.addEnumType("Microsoft.WordServices.ImageFormat");Cu.addEnumField("Unsupported",-2);Cu.addEnumField("Undefined",-1);Cu.addEnumField("Bmp",0);Cu.addEnumField("Jpeg",1);Cu.addEnumField("Gif",2);Cu.addEnumField("Tiff",3);Cu.addEnumField("Png",
4);Cu.addEnumField("Icon",5);Cu.addEnumField("Exif",6);Cu.addEnumField("Wmf",7);Cu.addEnumField("Emf",8);Cu.addEnumField("Pict",9);Cu.addEnumField("Pdf",10);Cu.addEnumField("Svg",11);const sz=e.addEnumType("Microsoft.WordServices.RangeLocation");sz.addEnumField("Whole",0);sz.addEnumField("Start",1);sz.addEnumField("End",2);sz.addEnumField("Before",3);sz.addEnumField("After",4);sz.addEnumField("Content",5);const oq=e.addEnumType("Microsoft.WordServices.LocationRelation");oq.addEnumField("Unrelated",
0);oq.addEnumField("Equal",1);oq.addEnumField("ContainsStart",2);oq.addEnumField("ContainsEnd",3);oq.addEnumField("Contains",4);oq.addEnumField("InsideStart",5);oq.addEnumField("InsideEnd",6);oq.addEnumField("Inside",7);oq.addEnumField("AdjacentBefore",8);oq.addEnumField("OverlapsBefore",9);oq.addEnumField("Before",10);oq.addEnumField("AdjacentAfter",11);oq.addEnumField("OverlapsAfter",12);oq.addEnumField("After",13);const Du=e.addEnumType("Microsoft.WordServices.BorderLocation");Du.addEnumField("Top",
0);Du.addEnumField("Left",1);Du.addEnumField("Bottom",2);Du.addEnumField("Right",3);Du.addEnumField("InsideHorizontal",4);Du.addEnumField("InsideVertical",5);Du.addEnumField("Inside",6);Du.addEnumField("Outside",7);Du.addEnumField("All",8);const Qw=e.addEnumType("Microsoft.WordServices.CellPaddingLocation");Qw.addEnumField("Top",0);Qw.addEnumField("Left",1);Qw.addEnumField("Bottom",2);Qw.addEnumField("Right",3);const ar=e.addEnumType("Microsoft.WordServices.BorderType");ar.addEnumField("Mixed",-1);
ar.addEnumField("None",0);ar.addEnumField("Single",1);ar.addEnumField("Double",3);ar.addEnumField("Dotted",6);ar.addEnumField("Dashed",7);ar.addEnumField("DotDashed",8);ar.addEnumField("Dot2Dashed",9);ar.addEnumField("Triple",10);ar.addEnumField("ThinThickSmall",11);ar.addEnumField("ThickThinSmall",12);ar.addEnumField("ThinThickThinSmall",13);ar.addEnumField("ThinThickMed",14);ar.addEnumField("ThickThinMed",15);ar.addEnumField("ThinThickThinMed",16);ar.addEnumField("ThinThickLarge",17);ar.addEnumField("ThickThinLarge",
18);ar.addEnumField("ThinThickThinLarge",19);ar.addEnumField("Wave",20);ar.addEnumField("DoubleWave",21);ar.addEnumField("DashedSmall",22);ar.addEnumField("DashDotStroked",23);ar.addEnumField("ThreeDEmboss",24);ar.addEnumField("ThreeDEngrave",25);const KF=e.addEnumType("Microsoft.WordServices.VerticalAlignment");KF.addEnumField("Mixed",-1);KF.addEnumField("Top",0);KF.addEnumField("Center",1);KF.addEnumField("Bottom",2);const GI=e.addEnumType("Microsoft.WordServices.ListLevelType");GI.addEnumField("Bullet",
0);GI.addEnumField("Number",1);GI.addEnumField("Picture",2);const FA=e.addEnumType("Microsoft.WordServices.ListBullet");FA.addEnumField("Custom",0);FA.addEnumField("Solid",258231);FA.addEnumField("Hollow",131183);FA.addEnumField("Square",716967);FA.addEnumField("Diamonds",716918);FA.addEnumField("Arrow",717016);FA.addEnumField("Checkmark",717052);const jC=e.addEnumType("Microsoft.WordServices.ListNumbering");jC.addEnumField("None",-1);jC.addEnumField("Arabic",0);jC.addEnumField("UpperRoman",1);jC.addEnumField("LowerRoman",
2);jC.addEnumField("UpperLetter",3);jC.addEnumField("LowerLetter",4);const ag=e.addEnumType("Microsoft.WordServices.StyleBuiltIn");ag.addEnumField("Other",-1);ag.addEnumField("Normal",0);ag.addEnumField("Heading1",1);ag.addEnumField("Heading2",2);ag.addEnumField("Heading3",3);ag.addEnumField("Heading4",4);ag.addEnumField("Heading5",5);ag.addEnumField("Heading6",6);ag.addEnumField("Heading7",7);ag.addEnumField("Heading8",8);ag.addEnumField("Heading9",9);ag.addEnumField("Toc1",19);ag.addEnumField("Toc2",
20);ag.addEnumField("Toc3",21);ag.addEnumField("Toc4",22);ag.addEnumField("Toc5",23);ag.addEnumField("Toc6",24);ag.addEnumField("Toc7",25);ag.addEnumField("Toc8",26);ag.addEnumField("Toc9",27);ag.addEnumField("FootnoteText",29);ag.addEnumField("Header",31);ag.addEnumField("Footer",32);ag.addEnumField("Caption",34);ag.addEnumField("FootnoteReference",38);ag.addEnumField("EndnoteReference",42);ag.addEnumField("EndnoteText",43);ag.addEnumField("Title",62);ag.addEnumField("Subtitle",74);ag.addEnumField("Hyperlink",
85);ag.addEnumField("Strong",87);ag.addEnumField("Emphasis",88);ag.addEnumField("NoSpacing",157);ag.addEnumField("ListParagraph",179);ag.addEnumField("Quote",180);ag.addEnumField("IntenseQuote",181);ag.addEnumField("SubtleEmphasis",260);ag.addEnumField("IntenseEmphasis",261);ag.addEnumField("SubtleReference",262);ag.addEnumField("IntenseReference",263);ag.addEnumField("BookTitle",264);ag.addEnumField("Bibliography",265);ag.addEnumField("TocHeading",266);ag.addEnumField("TableGrid",154);ag.addEnumField("PlainTable1",
267);ag.addEnumField("PlainTable2",268);ag.addEnumField("PlainTable3",269);ag.addEnumField("PlainTable4",270);ag.addEnumField("PlainTable5",271);ag.addEnumField("TableGridLight",272);ag.addEnumField("GridTable1Light",111);ag.addEnumField("GridTable1Light_Accent1",280);ag.addEnumField("GridTable1Light_Accent2",287);ag.addEnumField("GridTable1Light_Accent3",294);ag.addEnumField("GridTable1Light_Accent4",301);ag.addEnumField("GridTable1Light_Accent5",308);ag.addEnumField("GridTable1Light_Accent6",315);
ag.addEnumField("GridTable2",274);ag.addEnumField("GridTable2_Accent1",281);ag.addEnumField("GridTable2_Accent2",288);ag.addEnumField("GridTable2_Accent3",295);ag.addEnumField("GridTable2_Accent4",302);ag.addEnumField("GridTable2_Accent5",309);ag.addEnumField("GridTable2_Accent6",316);ag.addEnumField("GridTable3",275);ag.addEnumField("GridTable3_Accent1",282);ag.addEnumField("GridTable3_Accent2",289);ag.addEnumField("GridTable3_Accent3",296);ag.addEnumField("GridTable3_Accent4",303);ag.addEnumField("GridTable3_Accent5",
310);ag.addEnumField("GridTable3_Accent6",317);ag.addEnumField("GridTable4",276);ag.addEnumField("GridTable4_Accent1",283);ag.addEnumField("GridTable4_Accent2",290);ag.addEnumField("GridTable4_Accent3",297);ag.addEnumField("GridTable4_Accent4",304);ag.addEnumField("GridTable4_Accent5",311);ag.addEnumField("GridTable4_Accent6",318);ag.addEnumField("GridTable5Dark",277);ag.addEnumField("GridTable5Dark_Accent1",284);ag.addEnumField("GridTable5Dark_Accent2",291);ag.addEnumField("GridTable5Dark_Accent3",
298);ag.addEnumField("GridTable5Dark_Accent4",305);ag.addEnumField("GridTable5Dark_Accent5",312);ag.addEnumField("GridTable5Dark_Accent6",319);ag.addEnumField("GridTable6Colorful",278);ag.addEnumField("GridTable6Colorful_Accent1",285);ag.addEnumField("GridTable6Colorful_Accent2",292);ag.addEnumField("GridTable6Colorful_Accent3",299);ag.addEnumField("GridTable6Colorful_Accent4",306);ag.addEnumField("GridTable6Colorful_Accent5",313);ag.addEnumField("GridTable6Colorful_Accent6",320);ag.addEnumField("GridTable7Colorful",
279);ag.addEnumField("GridTable7Colorful_Accent1",286);ag.addEnumField("GridTable7Colorful_Accent2",293);ag.addEnumField("GridTable7Colorful_Accent3",300);ag.addEnumField("GridTable7Colorful_Accent4",307);ag.addEnumField("GridTable7Colorful_Accent5",314);ag.addEnumField("GridTable7Colorful_Accent6",321);ag.addEnumField("ListTable1Light",322);ag.addEnumField("ListTable1Light_Accent1",329);ag.addEnumField("ListTable1Light_Accent2",336);ag.addEnumField("ListTable1Light_Accent3",343);ag.addEnumField("ListTable1Light_Accent4",
350);ag.addEnumField("ListTable1Light_Accent5",357);ag.addEnumField("ListTable1Light_Accent6",364);ag.addEnumField("ListTable2",323);ag.addEnumField("ListTable2_Accent1",330);ag.addEnumField("ListTable2_Accent2",337);ag.addEnumField("ListTable2_Accent3",344);ag.addEnumField("ListTable2_Accent4",351);ag.addEnumField("ListTable2_Accent5",358);ag.addEnumField("ListTable2_Accent6",365);ag.addEnumField("ListTable3",324);ag.addEnumField("ListTable3_Accent1",331);ag.addEnumField("ListTable3_Accent2",338);
ag.addEnumField("ListTable3_Accent3",345);ag.addEnumField("ListTable3_Accent4",352);ag.addEnumField("ListTable3_Accent5",359);ag.addEnumField("ListTable3_Accent6",366);ag.addEnumField("ListTable4",325);ag.addEnumField("ListTable4_Accent1",332);ag.addEnumField("ListTable4_Accent2",339);ag.addEnumField("ListTable4_Accent3",346);ag.addEnumField("ListTable4_Accent4",353);ag.addEnumField("ListTable4_Accent5",360);ag.addEnumField("ListTable4_Accent6",367);ag.addEnumField("ListTable5Dark",326);ag.addEnumField("ListTable5Dark_Accent1",
333);ag.addEnumField("ListTable5Dark_Accent2",340);ag.addEnumField("ListTable5Dark_Accent3",347);ag.addEnumField("ListTable5Dark_Accent4",354);ag.addEnumField("ListTable5Dark_Accent5",361);ag.addEnumField("ListTable5Dark_Accent6",368);ag.addEnumField("ListTable6Colorful",327);ag.addEnumField("ListTable6Colorful_Accent1",334);ag.addEnumField("ListTable6Colorful_Accent2",341);ag.addEnumField("ListTable6Colorful_Accent3",348);ag.addEnumField("ListTable6Colorful_Accent4",355);ag.addEnumField("ListTable6Colorful_Accent5",
362);ag.addEnumField("ListTable6Colorful_Accent6",369);ag.addEnumField("ListTable7Colorful",328);ag.addEnumField("ListTable7Colorful_Accent1",335);ag.addEnumField("ListTable7Colorful_Accent2",342);ag.addEnumField("ListTable7Colorful_Accent3",349);ag.addEnumField("ListTable7Colorful_Accent4",356);ag.addEnumField("ListTable7Colorful_Accent5",363);ag.addEnumField("ListTable7Colorful_Accent6",370);const SD=e.addEnumType("Microsoft.WordServices.DocumentPropertyType");SD.addEnumField("String",0);SD.addEnumField("Number",
1);SD.addEnumField("Date",2);SD.addEnumField("Boolean",3);const kw=e.addEnumType("Microsoft.WordServices.TapObjectType");kw.addEnumField("Chart",1);kw.addEnumField("SmartArt",2);kw.addEnumField("Table",3);kw.addEnumField("Image",4);kw.addEnumField("Slide",5);kw.addEnumField("OLE",6);kw.addEnumField("Text",7);const TD=e.addEnumType("Microsoft.WordServices.FileContentFormat");TD.addEnumField("Base64",0);TD.addEnumField("Html",7);TD.addEnumField("Ooxml",9);const kC=e.addEnumType("Microsoft.WordServices.AnnotationParentType");
kC.addEnumField("None",0);kC.addEnumField("Document",1);kC.addEnumField("Paragraph",2);kC.addEnumField("Annotation",3);const Rw=e.addEnumType(S);Rw.addEnumField("Undefined",0);Rw.addEnumField("Created",10);Rw.addEnumField("Sent",20);Rw.addEnumField("Duplicated",30);Rw.addEnumField("Seen",40);Rw.addEnumField("Tried",50);Rw.addEnumField("Kept",60);Rw.addEnumField("Rejected",70);const UD=e.addEnumType("Microsoft.WordServices.StyleType");UD.addEnumField("Character",0);UD.addEnumField("List",1);UD.addEnumField("Paragraph",
2);UD.addEnumField("Table",3);const sy=e.addEnumType("Microsoft.WordServices.OutlineLevel");sy.addEnumField("OutlineLevel1",0);sy.addEnumField("OutlineLevel2",1);sy.addEnumField("OutlineLevel3",2);sy.addEnumField("OutlineLevel4",3);const ui=e.addEnumType("Microsoft.WordServices.FieldType");ui.addEnumField("Addin",81);ui.addEnumField("AddressBlock",93);ui.addEnumField("Advance",84);ui.addEnumField("Ask",38);ui.addEnumField("Author",17);ui.addEnumField("AutoText",79);ui.addEnumField("AutoTextList",
89);ui.addEnumField("BarCode",63);ui.addEnumField("Bibliography",97);ui.addEnumField("BidiOutline",92);ui.addEnumField("Citation",96);ui.addEnumField("Comments",19);ui.addEnumField("Compare",80);ui.addEnumField("CreateDate",21);ui.addEnumField("Data",40);ui.addEnumField("Database",78);ui.addEnumField("Date",31);ui.addEnumField("DisplayBarcode",99);ui.addEnumField("DocProperty",85);ui.addEnumField("DocVariable",64);ui.addEnumField("EditTime",25);ui.addEnumField("Embedded",58);ui.addEnumField("EQ",
49);ui.addEnumField("Expression",34);ui.addEnumField("FileName",29);ui.addEnumField("FileSize",69);ui.addEnumField("FillIn",39);ui.addEnumField("FormCheckbox",71);ui.addEnumField("FormDropdown",83);ui.addEnumField("FormText",70);ui.addEnumField("GotoButton",50);ui.addEnumField("GreetingLine",94);ui.addEnumField("Hyperlink",88);ui.addEnumField("If",7);ui.addEnumField("Import",55);ui.addEnumField("Include",36);ui.addEnumField("IncludePicture",67);ui.addEnumField("IncludeText",68);ui.addEnumField("Index",
8);ui.addEnumField("Info",14);ui.addEnumField("Keywords",18);ui.addEnumField("LastSavedBy",20);ui.addEnumField("Link",56);ui.addEnumField("ListNum",90);ui.addEnumField("MacroButton",51);ui.addEnumField("MergeBarcode",98);ui.addEnumField("MergeField",59);ui.addEnumField("MergeRec",44);ui.addEnumField("MergeSeq",75);ui.addEnumField("Next",41);ui.addEnumField("NextIf",42);ui.addEnumField("NoteRef",72);ui.addEnumField("NumChars",28);ui.addEnumField("NumPages",26);ui.addEnumField("NumWords",27);ui.addEnumField("OCX",
87);ui.addEnumField("Page",33);ui.addEnumField("PageRef",37);ui.addEnumField("Print",48);ui.addEnumField("PrintDate",23);ui.addEnumField("Private",77);ui.addEnumField("Quote",35);ui.addEnumField("RD",11);ui.addEnumField("Ref",3);ui.addEnumField("RevNum",24);ui.addEnumField("SaveDate",22);ui.addEnumField("Section",65);ui.addEnumField("SectionPages",66);ui.addEnumField("Seq",12);ui.addEnumField("Set",6);ui.addEnumField("Shape",95);ui.addEnumField("SkipIf",43);ui.addEnumField("StyleRef",10);ui.addEnumField("Subject",
16);ui.addEnumField("Subscriber",82);ui.addEnumField("Symbol",57);ui.addEnumField("TA",74);ui.addEnumField("TC",9);ui.addEnumField("Template",30);ui.addEnumField("Time",32);ui.addEnumField("Title",15);ui.addEnumField("TOA",73);ui.addEnumField("TOC",13);ui.addEnumField("UserAddress",62);ui.addEnumField("UserInitials",61);ui.addEnumField("UserName",60);ui.addEnumField("XE",4);ui.addEnumField("Empty",-1);ui.addEnumField("Others",100);ui.addEnumField("Undefined",0);const VD=e.addEnumType("Microsoft.WordServices.FieldKind");
VD.addEnumField("None",0);VD.addEnumField("Hot",1);VD.addEnumField("Warm",2);VD.addEnumField("Cold",3);const LF=e.addEnumType("Microsoft.WordServices.TrailingCharacter");LF.addEnumField("TrailingTab",0);LF.addEnumField("TrailingSpace",1);LF.addEnumField("TrailingNone",2);const vi=e.addEnumType("Microsoft.WordServices.ListBuiltInNumberStyle");vi.addEnumField("None",-1);vi.addEnumField("Arabic",0);vi.addEnumField("UpperRoman",1);vi.addEnumField("LowerRoman",2);vi.addEnumField("UpperLetter",3);vi.addEnumField("LowerLetter",
4);vi.addEnumField("Ordinal",5);vi.addEnumField("CardinalText",6);vi.addEnumField("OrdinalText",7);vi.addEnumField("Kanji",10);vi.addEnumField("KanjiDigit",11);vi.addEnumField("AiueoHalfWidth",12);vi.addEnumField("IrohaHalfWidth",13);vi.addEnumField("ArabicFullWidth",14);vi.addEnumField("KanjiTraditional",16);vi.addEnumField("KanjiTraditional2",17);vi.addEnumField("NumberInCircle",18);vi.addEnumField("Aiueo",20);vi.addEnumField("Iroha",21);vi.addEnumField("ArabicLZ",22);vi.addEnumField("Bullet",23);
vi.addEnumField("Ganada",24);vi.addEnumField("Chosung",25);vi.addEnumField("GBNum1",26);vi.addEnumField("GBNum2",27);vi.addEnumField("GBNum3",28);vi.addEnumField("GBNum4",29);vi.addEnumField("Zodiac1",30);vi.addEnumField("Zodiac2",31);vi.addEnumField("Zodiac3",32);vi.addEnumField("TradChinNum1",33);vi.addEnumField("TradChinNum2",34);vi.addEnumField("TradChinNum3",35);vi.addEnumField("TradChinNum4",36);vi.addEnumField("SimpChinNum1",37);vi.addEnumField("SimpChinNum2",38);vi.addEnumField("SimpChinNum3",
39);vi.addEnumField("SimpChinNum4",40);vi.addEnumField("HanjaRead",41);vi.addEnumField("HanjaReadDigit",42);vi.addEnumField("Hangul",43);vi.addEnumField("Hanja",44);vi.addEnumField("Hebrew1",45);vi.addEnumField("Arabic1",46);vi.addEnumField("Hebrew2",47);vi.addEnumField("Arabic2",48);vi.addEnumField("HindiLetter1",49);vi.addEnumField("HindiLetter2",50);vi.addEnumField("HindiArabic",51);vi.addEnumField("HindiCardinalText",52);vi.addEnumField("ThaiLetter",53);vi.addEnumField("ThaiArabic",54);vi.addEnumField("ThaiCardinalText",
55);vi.addEnumField("VietCardinalText",56);vi.addEnumField("LowercaseRussian",58);vi.addEnumField("UppercaseRussian",59);vi.addEnumField("LowercaseGreek",60);vi.addEnumField("UppercaseGreek",61);vi.addEnumField("ArabicLZ2",62);vi.addEnumField("ArabicLZ3",63);vi.addEnumField("ArabicLZ4",64);vi.addEnumField("LowercaseTurkish",65);vi.addEnumField("UppercaseTurkish",66);vi.addEnumField("LowercaseBulgarian",67);vi.addEnumField("UppercaseBulgarian",68);vi.addEnumField("PictureBullet",249);vi.addEnumField("Legal",
253);vi.addEnumField("LegalLZ",254);const MF=e.addEnumType("Microsoft.WordServices.NoteItemType");MF.addEnumField("Footnote",0);MF.addEnumField("Endnote",1);const tz=e.addEnumType("Microsoft.WordServices.ChangeTrackingMode");tz.addEnumField("Off",0);tz.addEnumField("TrackAll",1);tz.addEnumField("TrackMineOnly",2);const WD=e.addEnumType("Microsoft.WordServices.ChangeTrackingState");WD.addEnumField("Unknown",0);WD.addEnumField("Normal",1);WD.addEnumField("Added",2);WD.addEnumField("Deleted",4);const XD=
e.addEnumType("Microsoft.WordServices.TrackedChangeType");XD.addEnumField("None",0);XD.addEnumField("Added",1);XD.addEnumField("Deleted",2);XD.addEnumField("Formatted",3);const Pj=e.addEnumType("Microsoft.WordServices.ChangeTrackingVersion");Pj.addEnumField("Original",0);Pj.addEnumField("Current",1);const Dh=e.addEnumType("Microsoft.WordServices.SaveBehavior");Dh.addEnumField("Save",0);Dh.addEnumField("Prompt",1);const Eu=e.addEnumType("Microsoft.WordServices.CloseBehavior");Eu.addEnumField("Save",
0);Eu.addEnumField("SkipSave",1);const Ep=e.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ep.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ep.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);const bq=e.addEnumType("Microsoft.AppRuntime.AppRuntimeState");bq.addEnumField("Inactive",
0);bq.addEnumField("Background",1);bq.addEnumField("Visible",2);const lC=e.addEnumType("Microsoft.AppRuntime.Visibility");lC.addEnumField("Hidden",1);lC.addEnumField("Visible",2);const Sw=e.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);Sw.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Sw.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",
0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);e.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0).addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);const NF=e.addEnumType("Microsoft.Authentication.IdentityType");NF.addEnumField("OrganizationAccount",0);NF.addEnumField("MicrosoftAccount",1);const Gx=e.addEnumType("Microsoft.Authentication.AuthorityType");
Gx.addEnumField("External",0);Gx.addEnumField("Msa",1);Gx.addEnumField("Aad",2);const OF=e.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);OF.addProperty("DisplayName",4,"String",1,!1,null,0);OF.addProperty("Email",3,"String",1,!1,null,0);OF.addProperty("FederationProvider",2,"String",1,!1,null,0);OF.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);const YD=e.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);YD.addProperty("AppId",4,"String",1,!1,null,0);YD.addProperty("Authority",2,"String",1,!1,null,0);YD.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);YD.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);YD.addProperty("TenantId",6,"String",1,!1,null,0);YD.addProperty("Upn",1,"String",1,!1,null,0);const PF=e.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);PF.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);PF.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4).addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);PF.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);PF.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);const Hq=e.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Hq.addProperty("AuthChallenge",3,"String",1,!1,null,0);Hq.addProperty("CorrelationId",7,"String",1,!1,null,0);Hq.addProperty("Policy",4,"String",1,!1,null,0);Hq.addProperty("Resource",2,"String",1,!1,null,0);Hq.addProperty("Scope",5,"String",1,!1,null,0);Hq.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);const ZD=e.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ZD.addProperty("AccessToken",2,"String",1,!1,null,0);ZD.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);const zK=e.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);zK.addProperty("Id",1,"String",1,!0,null,0);zK.addProperty("Value",2,"Object",1,!1,null,0);const AK=e.addType("Microsoft.Authentication.RoamingSettingCollection",
"{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);AK.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0).addParameter("id","String",1,null,0);AK.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0).addParameter("id","String",1,null,0);const Tw=e.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Tw.addEnumField("Unknown",0);Tw.addEnumField("Basic",1);Tw.addEnumField("Premium",2);const uz=e.addType("Microsoft.Office.Licensing.License",
"{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0),BK=uz.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);BK.addParameter("feature","String",1,null,0);BK.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);uz.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0).addParameter("feature","String",1,null,0);const mC=uz.addMethod("GetMsaDeviceTicket",
7,"String",1,1,"MsaDeviceTicket",4);mC.addParameter("resource","String",1,null,0);mC.addParameter("policy","String",1,null,0);mC.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);const CK=uz.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);CK.addParameter("feature","String",1,null,0);CK.addParameter("fallbackValue","Boolean",1,null,0);uz.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);uz.addMethod("LaunchUpsellExperience",
4,"Void",0,1,"LaunchUpsellExperience",0).addParameter("experienceId","String",1,null,0);uz.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4).addParameter("feature","String",1,null,0);const HI=e.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);HI.addProperty("Id",5,"String",1,!0,null,0);HI.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);HI.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",
0);e.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0).addProperty("Scopes",1,"String",1,!1,null,0)};class Vl extends Ul{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le){super(e,n,S,ya,Le);this.Twk=C;this.xz=ja;this.y3a=kb;this.vGa=Rb;this.T5=Bd;this.Rc=Fc;this.gp=gd;this.m1=td;this.fd=wd;this.XQa=sc;this.hb=te}get aKa(){return this.Twk}get Xfc(){return this.xz}iKm(){let e={};return{returnValue:({Wve:e}=
this.T5.dGi(OSF.DDA.Marshaling.CoercionTypeKeys.Table)).returnValue,YOo:e}}eKm(){let e={};return{returnValue:({Wve:e}=this.T5.dGi(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)).returnValue,SOo:e.rows}}gGf(e,n){const C={};return n.Rn?this.gp.kAa(e,n):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,XK:C}}iTm(e,n,C,S){const ja=[];if(!this.gp)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;e=this.gp.q2c(e,S,ja);if(e===OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;
if(e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return e;e=ja[0];S=e.node;if(!Af.ParagraphReader.Wb(S))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;const ya=this.fd.mg(S);if(!ya.zb(23))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!Kq.a.PHa(ya.origin)){const kb=new pj.GraphTransaction(7);kb.Ab(ya.origin);Kq.a.L_b(ya.origin);kb.dispose()}C=S.fg(C.Ic).htmlElement;if(!C)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;C.scrollIntoView();n===OSF.DDA.Marshaling.SelectionMode.Selected?
(n=new Lf.Selection(ja,!0),this.lb.Kc(n)):(n=e.cpBegin,e.contextId===Ma.a.paragraph?n=0:e.contextId===Ma.a.Zc&&(n=Af.ParagraphReader.textLength(S)),n=Uk.SelectionFactory.ue(S,n),this.lb.Kc(n));window.focus();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}chm(e){if(e.Rn){var n=Ed.a.eb(this.mea.pla());for(n=Tm.a.zq(n);n.moveNext();)Af.ParagraphReader.Wb(n.currentNode);return this.gp.KFf(e)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,PVh:[]}}bVk(e,n,C){const S=this.Rc.Lc(15);
S.Ab(this.mea.pla());C===OSF.DDA.Marshaling.BindingType.Text.toString()?{XK:e,returnValue:n}=this.Dlg(e,n,Id.text):C===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{XK:e,returnValue:n}=this.Dlg(e,n,Id.yVb):C===OSF.DDA.Marshaling.BindingType.Table.toString()?{XK:e,returnValue:n}=this.Dlg(e,n,Id.table):(e=null,n=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);S.dispose();return{returnValue:n,XK:e}}aVk(e,n,C,S){const ja=this.Rc.Lc(15);ja.Ab(this.mea.pla());S===OSF.DDA.Marshaling.BindingType.Text.toString()?
{XK:e,returnValue:n}=this.Clg(e,n,Id.text,C):S===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{XK:e,returnValue:n}=this.Clg(e,n,Id.yVb,C):S===OSF.DDA.Marshaling.BindingType.Table.toString()?{XK:e,returnValue:n}=this.Clg(e,n,Id.table,C):(e=null,n=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);ja.dispose();return{returnValue:n,XK:e}}iGf(e,n){return this.gp.iGf(e,n)}ljm(e,n,C){return this.gp.yti(e,n,!0,C)}ijm(e,n,C){let S;return{returnValue:({b_j:S}=this.gp.yti(e,n,!1,C)).returnValue,
iLn:S.rows}}hjm(e,n){return this.gp.gjm(e,n)}wxg(e,n,C){const S=this.Rc.Lc(15);S.Ab(this.mea.pla());e=this.gp.wxg(e,n,C);S.dispose();return e}kjm(e,n,C){const S=[];e=this.gp.q2c(n,e,S);e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?C(e,null):0>=S.length?C(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null):this.vGa.getOoxml(S,ja=>{C(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ja)},ja=>{const ya=this.Hie(ja);this.Whe(ja,3);C(ya,null)})}DSo(e,n,C,S,ja){const ya=C.TableHeaders;C=C.TableRows;
if(ya&&ya.length||C&&C.length){var kb=this.Rc.Lc(15);kb.Ab(this.mea.pla());this.gp.zMj(e,n,!0,ya,C,S,ja);kb.dispose()}else ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"table")}BSo(e,n,C,S,ja){if(C&&C.length){var ya=this.Rc.Lc(15);ya.Ab(this.mea.pla());this.gp.zMj(e,n,!1,null,C,S,ja);ya.dispose()}else ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"matrix")}iyo(e,n,C){return n.Rn?(C(this.Zio(e,n)),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}hvf(e,
n,C){if(n.Rn){const S=this.Rc.Lc(15);S.Ab(this.mea.pla());this.gp.hvf(e,n,C);S.dispose()}else C(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}wef(e,n,C,S){if(C&&C.length)if(n.Rn){const ja=this.Rc.Lc(15);ja.Ab(this.mea.pla());this.gp.wef(e,n,C,S);ja.dispose()}else S(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else S(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}xdf(e,n,C,S,ja,ya){if(C&&C.length||S&&S.length)if(n.Rn){const kb=this.Rc.Lc(15);kb.Ab(this.mea.pla());this.gp.xdf(e,
n,C,S,ja,ya);kb.dispose()}else ya(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else ya(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}Whe(e,n){switch(n){case 0:Eo(e)?E.ULS.sendTraceTag(8159503,341,50,"SetSelectedOoxml failed with error code: {0}",e):E.ULS.sendTraceTag(7611806,341,10,"SetSelectedOoxml failed with error code: {0}",e);break;case 1:Eo(e)?E.ULS.sendTraceTag(8159504,341,50,"GetSelectedOoxml failed with error code: {0}",e):E.ULS.sendTraceTag(7151686,341,10,"GetSelectedOoxml failed with error code: {0}",
e);break;case 2:Eo(e)?E.ULS.sendTraceTag(17385219,341,50,"SetBindingOoxml failed with error code: {0}",e):E.ULS.sendTraceTag(17385220,341,10,"SetBindingOoxml failed with error code: {0}",e);break;case 3:Eo(e)?E.ULS.sendTraceTag(17331611,341,50,"GetBindingOoxml failed with error code: {0}",e):E.ULS.sendTraceTag(17331612,341,10,"GetBindingOoxml failed with error code: {0}",e)}}fKm(e){this.y3a.NCi(this.lb.gb,n=>{e(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,n)},n=>{const C=this.Hie(n);this.Whe(n,
1);e(C,null)})}$Jm(){let e="";const n=this.lb.gb.currentSelection;return 1<this.lb.gb.length||!n||!n.length?{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,PKj:e}:{returnValue:({hWa:e}=this.XQa.fIf(n.toArray(),n.Pf)).returnValue,PKj:e}}xZo(e,n){const C=this.lb.gb.currentSelection;!e||1<this.lb.gb.length||!C||!C.length||this.XQa.Nwe(C.toArray(),C.Pf,e,S=>{n&&n(S)})}AZo(e,n){const C=this.mLf(this.lb.gb.K(0).Qa.node);this.y3a.QOj(this.lb.gb,e,0,0,0,null,S=>{var ja=this.y3a.Tjc(S,this.hb.Kv(C,
!0,!0));ja.count||(ja=this.y3a.Tjc(S,this.QEm()));if(ja.count){var ya=[];for(let kb=0;kb<ja.count;kb++)S=new Lf.Selection([ja.K(kb)],!0),ya.push(S);ja=new yh.SelectionCollection(ya,0);this.lb.F0(ja);n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else E.ULS.sendTraceTag(19994848,341,10,"AppId:{0}, Can't find the inserted ooxml when invoking SetSelectedOoxml"),n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},S=>{const ja=this.Hie(S);this.Whe(S,0);n(ja)})}ASo(e,n,C,S){let ja=null,ya=({Ijf:ja}=
this.gp.Zsi(n,e)).returnValue;if(ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)S(ya);else if(ja.BO!==Id.text)S(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else if(this.gp.Dsn(ja)){var kb=[];ya=this.gp.q2c(n,e,kb);if(ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)S(ya);else if(0>=kb.length)S(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{var Rb=null;if(!this.gp.Yce&&({graphNode:Rb,returnValue:ya}=this.gp.jcl(ja),ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){S(ya);
return}var sc=this.Rc.Lc(15);sc.Ab(this.mea.pla());if(!this.gp.Yce&&(this.gp.PWf=!1,ya=this.gp.lDa(ja),this.gp.PWf=!0,ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){S(ya);return}e=(Fc,gd)=>{if(!this.gp.Yce){if(Fc!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){let td=!0;for(const Bd of kb)if(!Bd.isValid){td=!1;break}td&&(gd=new Lf.Selection(kb,!0))}gd&&(gd=this.gp.Uso(gd,Rb),Fc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Fc=gd))}sc.dispose();S(Fc)};ya=this.XQa.Nwe(kb,!0,C,e);ya!==
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&e(ya,null)}}else S(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType)}CZo(e,n){let C=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders];e=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows];C&&C.length||e&&e.length?C&&1<C.length?(E.ULS.sendTraceTag(8458368,344,15,"SetSelectedTable failed for app want to add multi-row header table"),n(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)):(C=C[0],
this.T5.APj(C,e,n)):n(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}zZo(e,n){e&&e.length?this.T5.APj(null,e,n):n(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}CSo(e,n,C,S){let ja=null,ya=({Ijf:ja}=this.gp.Zsi(n,e)).returnValue;if(ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)S(ya);else if(ja.BO!==Id.text)S(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else{var kb=[];ya=this.gp.q2c(n,e,kb);ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
S(ya):0>=kb.length?S(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(e=this.gp.gVa(ja.QQ),this.vGa.xxe(kb,C,e,4,0,null,()=>{S(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},Rb=>{const sc=this.Hie(Rb);this.Whe(Rb,2);S(sc)}))}}mLf(e){const n=new Ed.a;n.set(e);e=null;n.zb(10)&&(e=n.Dp(10));return e}QEm(){const e=this.mea.WDm();return this.hb.Kv(e,!0,!0)}Zio(e,n){let C=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const S=this.Rc.Lc(15);S.Ab(this.mea.pla());C=this.gp.lBj(e,n,()=>{this.gp.Xyo(n,
e);this.gp.Wyo(n,e)});S.dispose();return C}Dlg(e,n,C){if(!n||""===n)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,XK:null};if((C===Id.yVb||C===Id.table)&&!this.T5.fsn())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,XK:null};let S,ja=({Ow:S}=this.gp.CIl()).returnValue;if(ja!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ja,XK:null};C=new ck(n,C,this.gp.hGf(S));ja=this.gp.uMh(e,C);return ja!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
{returnValue:ja,XK:null}:this.gp.kAa(n,e)}Clg(e,n,C,S){if(!n||""===n)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,XK:null};let ja=({Ow:S}=this.gp.mnm(S)).returnValue;if(ja!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ja,XK:null};if(C!==Id.text){let ya,kb;({rXj:ya,Cji:kb,returnValue:ja}=this.gp.tnm(S));if(ja!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ja,XK:null};if(!this.T5.isTable(ya,kb))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType,
XK:null}}C=new ck(n,C,this.gp.hGf(S));ja=this.gp.uMh(e,C);return ja!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?{returnValue:ja,XK:null}:this.gp.kAa(n,e)}Hie(e){switch(e){case 1:return OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;case 7:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat;default:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}c4l(e,n,C,S=null,ja=null){E.ULS.sendTraceTag(18354818,369,50,"A Word Rich API batch execution is requested.");
const ya=this.mea.pla(),kb=this.m1.create(),Rb=!!(e[6]&1);kb.context.Cn.Dv(ya);kb.context.appId=n;kb.context.controlId=S;kb.context.upc=Rb;kb.context.Ek=ja;S=new cr(kb.context,n,S);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(S,$r,kb,e).then(sc=>{kb.context.Cn.CF();if(!sc)return E.ULS.sendTraceTag(9204820,344,10,"The rich api executor call failed."),C(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;C(sc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{E.ULS.sendTraceTag(35733829,
369,10,"A Word Rich API batch execution was failed, AppId:{0}",n);kb.context.Cn.CF();C(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})}zqp(){let e;return ka.a.DVc?(e=ka.a.DVc,{returnValue:!0,url:e}):{returnValue:!1,url:null}}d4l(e,n,C,S,ja){this.c4l(e,n,ja,C,S)}saveSettings(e,n){return this.mea.lJj(e,n)}Vab(e){return this.mea.Rog(e)}}Object(F.a)(Vl,"WordEditorApiObjectModel",Ul,[1096,1097]);class Fp{static mDe(e,...n){for(let C=0;C<n.length;C++){if(!e||!e.hasOwnProperty(n[C]))return e=
null,{returnValue:!1,value:e};e=e[n[C]]}return{returnValue:!0,value:e}}}Object(F.a)(Fp,"AppsForOfficeCommonUtils",null,[]);class tq{constructor(e,n){this.P1e=null;this.A$e=e;this.Aa=n}QOm(e){return tq.rrn(e)?this.k6n:null}get k6n(){if(!this.P1e){const e=[];e.push(this.A$e.createIncompleteRequestThrottle(this.Aa.jc("WordEditorAppsForOfficeSelectionOoxmlMaxIncompleteRequests",1),this.Aa.jc("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3E4)));e.push(this.A$e.createTokenBucketThrottle(this.Aa.jc("WordEditorAppsForOfficeSelectionOoxmlTokenBucketCapacity",
3),this.Aa.jc("WordEditorAppsForOfficeSelectionOoxmlTokenBucketFillingIntervalMilliSec",2E3)));this.P1e=this.A$e.createChainedThrottle(e)}return this.P1e}static rrn(e){const n=e.DdaMethod.DispatchId;let C=null,S=n===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod&&({value:C}=Fp.mDe(e,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue;return S=(S=(S=(S=S||n===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod&&({value:C}=Fp.mDe(e,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,
OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)||n===OSF.DDA.MethodDispId.dispidGetBindingDataMethod&&({value:C}=Fp.mDe(e,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue)||n===OSF.DDA.MethodDispId.dispidSetBindingDataMethod&&({value:C}=Fp.mDe(e,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)&&!!C&&C===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml}}Object(F.a)(tq,"WordEditorApiThrottleStore",
null,[1093]);class ao{constructor(e,n,C,S,ja){this.$ca=e;this.xwd=C;this.Z0=ja}get bdc(){return this.Z0}initialize(){this.$ca.initialize();this.bdc.Xb()}dispose(){this.$ca&&(this.$ca.dispose(),this.$ca=null);this.bdc&&(this.bdc.dispose(),this.Z0=null)}}Object(F.a)(ao,"AppsForOfficeIntegrationManager",null,[10]);class sh extends ao{constructor(e,n,C,S,ja,ya,kb,Rb){super(e,n,C,S,ja);this.ng=null;this.znk=Rb;this.gp=ya}initialize(){super.initialize();this.znk.Xb();this.gp&&this.gp.iuo()}}Object(F.a)(sh,
"WordEditorAppsForOfficeIntegrationManager",ao,[]);var Tp=d(1279),Fm=d(584),uq=d(543),dj=d(33),an=d(1148),lo=d(1105);class ma{create(){return new lo.a}}Object(F.a)(ma,"AppBindingNodeFactory",null,[284]);class Ua{constructor(e,n,C,S,ja,ya,kb){this.Rc=n;this.zwd=C;this.v7e=S;this.AG=e;this.Nmk=ja;this.ga=ya;Ua.zd=kb}initialize(){}pla(){const e=Ed.a.eb(Rd.a.hm.kb.hd);this.AG.ZR(e);return e.currentNode}WDm(){const e=this.pla(),n=new Ed.a;n.set(e);return this.AG.qLf(n.currentNode)}A4d(e){return this.dti(e,
!1)}dti(e,n){let C=null;const S=this.rqb();if(S&&S.Vb(19)){do{var ja=S.currentNode;if(!ja.getValue(hb.a.aTc)){const ya=ja.getValue(hb.a.oTa);ja=ja.id.toString();if(n&&ya.toLowerCase()===e.toLowerCase()||ja===e){C=this.lXc(S);break}}}while(S.Kf(19))}return C}B4d(e){return this.dti(e,!0)}bjc(e){if(e&&e.yP)return this.bAf(e),this.bjc(e.yP);const n=new fb.a;if(e&&e.fma)for(e=this.lAa(e),e=Tm.a.Bo(e);e.moveNext();){const C=e.currentNode;50===C.type&&n.add(new ck(C.getValue(hb.a.zW),C.getValue(hb.a.BO),
C.getValue(hb.a.QQ)))}return n}KFf(){const e=new fb.a;var n=this.rqb();for(n=Tm.a.Bo(n.currentNode);n.moveNext();){const C=n.currentNode;50===C.type&&e.add(new ck(C.getValue(hb.a.zW),C.getValue(hb.a.BO),C.getValue(hb.a.QQ)))}return e}$si(){const e=new fb.a,n=this.rqb();this.zcm(n,C=>{const S=C.currentNode.id.toString();this.ycm(C,ja=>{e.add({["appInstanceId"]:S,["appBindingData"]:new ck(ja.getValue(hb.a.zW),ja.getValue(hb.a.BO),ja.getValue(hb.a.QQ))})})});return e}zcm(e,n){if(e&&e.Vb(19)){do n(e);
while(e.Ci(19))}}ycm(e,n){if(e&&e.Vb(22)){do n(e.currentNode);while(e.Ci(22))}}Dqg(e,n){if(!e||!n)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(e.yP)return this.Dqg(e.yP,n);if(e.fma&&(e=this.lAa(e))){const C=Ed.a.eb(e);let S=C.Vb(22);for(;S;){if(S.getValue(hb.a.zW)===n)return C.Tg(),e.setValue(Ee.a.DU,new Date),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;S=C.Ci(22)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}kAa(e,
n){e=this.bjc(e);for(const C of e)if(C.zW===n)return C;return null}oim(e){const n=this.KFf(),C=new fb.a;for(const S of n)S.QQ===e&&C.add(S);return C}pSi(e,n){if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(e.yP)return this.bAf(e),this.pSi(e.yP,n);if(e.fma){const C=this.lAa(e);if(!C)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.kAa(e,n.zW))return this.tvp(e,n);e=this.TDl(n);this.cVk(C,e)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}xsi(){const e=new fb.a,
n=this.rqb();if(n&&n.Vb(19)){do{const C=this.lXc(n);C&&e.add(C)}while(n.Kf(19))}return e}xsb(e){var n;if(e&&e.fma&&!this.lAa(e)){const C=this.Qsf(e);this.qdf(C,e);if(null===(n=e.assetId)||void 0===n?0:n.toLowerCase().startsWith("wa"))e=this.yDl(e),this.NUk(C,e)}}DUf(e,n,C,S){if(G.AFrameworkApplication.J.$("ContentAppIsEnabled")){for(;e&&!Object(Eh.a)(uq.a,e);)e=e.Lk;e?this.Dll(e)?(S=Object.assign(new an.a,{id:S.Rn,version:S.version,store:S.store,storeType:S.storeType,instanceId:String.format("{{{0}}}",
Tj.a.create()),isContent:!0}),e=this.Nmk.J$m(e,n,C,S),Zl.a.gWf(e)&&this.Icd(e)):this.ga.Qb(T.a.v0b,2,{["ak1"]:WordEditorIntl.WordEditorStrings.L_ContentAppError}):E.ULS.sendTraceTag(593876625,344,15,"Context is null")}}Icd(e){e=Ed.a.eb(e);e.zb(12);e.kd(12);e.Aq.RT=!0}Dll(e){e.contextId===Ma.a.view&&e.view.ve&&e.view.lb&&(e=e.view.lb.Pg);return e?e.Al?!0:!1:(Ua.zd.fc(Tp.a.Ne,{["Reason"]:Fm.a.Qn}),!1)}pSo(e){const n=this.lAa(e);if(n){const C=this.Rc.Lc(15);C.Ab(n);n.setValue(hb.a.nmb,e.dTc);n.setValue(Ee.a.DU,
new Date);C.dispose()}}hSo(e){const n=this.lAa(e);if(n){const C=this.Rc.Lc(4);C.Ab(n);n.setValue(dj.a.kjf,e.sharedRuntimeId);n.setValue(dj.a.ljf,e.backgroundState);n.setValue(Ee.a.DU,new Date);C.dispose()}}Rog(e){return e?e.yP?this.Rog(e.yP):e.fma&&(e=this.lAa(e))?this.v7e.$Ff(e):null:null}lJj(e,n){if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(e.yP)return this.bAf(e),this.lJj(e.yP,n);if(e.fma&&(e=this.lAa(e))){const C=this.Rc.Lc(15);C.Ab(e);n=this.v7e.CLo(e,n);e.setValue(Ee.a.DU,
new Date);C.dispose();return n}E.ULS.sendTraceTag(7143687,344,15,"App Node not found when trying to save settings");return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}dispose(){}lAa(e){const n=this.rqb();if(n&&n.Vb(19)){do if(this.lXc(n).RTh(e))return n.currentNode;while(n.Kf(19))}return null}lXc(e){var n=e.currentNode;const C=this.v7e.$Ff(n),S=n.getValue(hb.a.oTa),ja=n.getValue(hb.a.cTc),ya=n.getValue(hb.a.mmb),kb=n.getValue(hb.a.CKb);let Rb;if(e.Vb(20)){var sc=e.currentNode;Rb=sc.getValue(hb.a.oTa);
sc=sc.getValue(hb.a.mmb);e.uc()}e=n.getValue(hb.a.aTc);const Fc=n.getValue(hb.a.nmb),gd=n.ka(dj.a.kjf,null),td=n.ka(dj.a.ljf,0);n=n.id.toString();let Bd=null;e||(Bd=new ql(n,n,S,ja,ya,kb,Fc,!0,gd,td,Rb,sc),Bd.settings=C);return Bd}O8f(e){this.AG.ZR(e);return e.Vb(18)}rqb(){let e=null;const n=Rd.a.hm.kb.hd;n&&(e=new Ed.a,e.set(n),this.O8f(e)||(e=null));return e}Qsf(e){const n=this.zwd.create(cj.a.KHa);n.setValue(hb.a.oTa,e.Rn);n.setValue(hb.a.CKb,e.storeType);n.setValue(hb.a.cTc,e.version);n.setValue(hb.a.mmb,
e.store);n.setValue(hb.a.nmb,e.dTc);n.setValue(hb.a.aTc,!1);n.setValue(hb.a.BRh,!1);n.setValue(hb.a.HRh,"");n.setValue(hb.a.MRh,"right");n.setValue(hb.a.PRh,350);n.setValue(hb.a.ORh,1);n.setValue(hb.a.NRh,!1);return n}yDl(e){const n=this.zwd.create(cj.a.Tcc);n.setValue(hb.a.oTa,e.assetId);n.setValue(hb.a.cTc,e.version);n.setValue(hb.a.mmb,e.assetStoreId);n.setValue(hb.a.CKb,"omex");return n}NUk(e,n){n&&Ed.a.eb(e).Wf(n,20)}jjm(e,n){if((e=Ed.a.eb(e))&&e.Vb(22)){do{const C=e.currentNode,S=C.getValue(hb.a.zW);
if(n===S)return C}while(e.Kf(22))}return null}TDl(e){const n=(new ma).create(cj.a.Pcc);n.setValue(hb.a.zW,e.zW);n.setValue(hb.a.BO,e.BO);n.setValue(hb.a.QQ,e.QQ);return n}tvp(e,n){e=this.lAa(e);if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const C=this.jjm(e,n.zW);if(!C)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;C.setValue(hb.a.BO,n.BO);C.setValue(hb.a.QQ,n.QQ);e.setValue(Ee.a.DU,new Date);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}cVk(e,n){Ed.a.eb(e).Wf(n,
22);e.setValue(Ee.a.DU,new Date)}qdf(e,n){const C=this.rqb();C&&!e.anchor&&(n=Wc.a.Bf(n.GRh),Tj.a.compare(n.Gt,Tj.a.nil)&&(E.ULS.sendTraceTag(20796771,344,15,"Instance id is not a extended guid. Create a new extended guid for app node."),n=new Wc.a(Tj.a.create(),1)),C.d6(e,19,n))}bAf(e){this.xsb(e.yP)}}Ua.zd=null;Object(F.a)(Ua,"WordEditorAppsForOfficeModel",null,[1092,10]);var xb;(function(e){e[e.Geq=0]="notRegistered";e[e.riq=1]="queryStarted";e[e.Uiq=2]="registrationFailed";e[e.Tiq=3]="registered"})(xb||
(xb={}));Object(F.b)("CommandRegistrationStatus",xb);var Xb=d(604),rc;(function(e){e[e.OK=0]="OK";e[e.Feq=1]="notReady";e[e.aoq=2]="storeDisabled";e[e.H6p=3]="invokeFailure";e[e.Olq=4]="serviceDisabled";e[e.RVp=5]="builtinAddinDetails"})(rc||(rc={}));Object(F.b)("AddinDetailsQueryError",rc);class Zc{constructor(){this.addInDetails=this.title=null}}Object(F.a)(Zc,"AddInCategoryData",null,[]);class Hd{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(F.a)(Hd,
"AddInDetailData",null,[]);class Jd{constructor(){this.href=this.text=null}}Object(F.a)(Jd,"AddInLinkData",null,[]);class Xd{constructor(e,n,C){this.qPa=0;this.nkh=!1;this.ZPc=[];this.Aa=e;this.pPa=n;this.A3e=C;E.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}jMa(e,n){e&&n&&this.H4o(n)&&this.vtj()}H4o(e){0===e.xT&&(this.qPa|=1);1===e.xT&&(this.qPa|=2);2===e.xT&&(this.qPa|=4);return!!this.qPa}vtj(){let e=null;const n={},C=this.qqn,S=this.YPn;var ja=this.pPa.cX(0);const ya=this.pPa.cX(1),
kb=this.pPa.cX(2);(2===ja.errorCode||this.Q0b&&2===kb.errorCode)&&!S.length?(e={ariaDescription:CommonUIStrings.l_AddinPickerDisableError,iconName:"StoreDisabled",label:CommonUIStrings.l_AddinPickerDisableError,title:CommonUIStrings.l_AddInBackstageErrorViewTitle},E.ULS.sendTraceTag(508101771,220,50,"dataProvider storeDisabled error hit")):3===ja.errorCode&&3===ya.errorCode?(e={ariaDescription:CommonUIStrings.l_AddinPickerGeneralError,iconName:"Common",label:CommonUIStrings.l_AddinPickerGeneralError,
title:CommonUIStrings.l_AddInBackstageErrorViewTitle},E.ULS.sendTraceTag(508101770,220,50,"dataProvider invokeFailure error hit")):4!==ja.errorCode||S.length?!this.r0i&&(!this.ema||0!==kb.errorCode&&5!==kb.errorCode)||kb.BB.length||E.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.qPa,kb.errorCode):(e={ariaDescription:CommonUIStrings.l_AddinPickerServiceDisconnectedError,iconName:"StoreDisabled",label:CommonUIStrings.l_AddinPickerServiceDisconnectedError,
title:CommonUIStrings.l_AddInBackstageErrorViewTitle},E.ULS.sendTraceTag(508101769,220,50,"dataProvider serviceDisabled error hit"));this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8365521_BackstageAddinEntryPointDisplayMetrics")&&this.E9i("Backstage",S.length,ja,ya,kb);ja=!e;if(!ja||C||S.length)ja?(n.mruAddIns=S,C&&(n.categories=this.ydo)):n.errorViewProps=e,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(n,ja)),C&&ja&&!this.nkh&&(this.nkh=!0,E.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",
this.qPa))}E9i(e,n,C,S,ja){e={["Source"]:e,["MRUListNumber"]:n,["MyAddinsErrorCode"]:rc[C.errorCode],["MyAddInsResult"]:C.BB.length,["MyAddinsInvokeResultCode"]:C.Gj?C.Gj.invokeResultCode:"N/A",["AdminManagedErrorCode"]:rc[S.errorCode],["AdminManagedResult"]:S.BB.length,["AdminManageInvokeResultCode"]:S.Gj?S.Gj.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:this.Q0b?rc[ja.errorCode]:"undefined",["PopularAddinsResult"]:ja.BB.length,["PopularAddinsInvokeResultCode"]:ja.Gj?ja.Gj.invokeResultCode:
"N/A"};Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:Ad.a.iI(e)}))}get r0i(){return!!(this.qPa&4)}get qqn(){const e=this.pPa.cX(2);return(this.r0i||this.ema)&&(0===e.errorCode||5===e.errorCode)&&!!e.BB.length}get ydo(){var e=this.jpm();0<e.length&&(this.A3e=e);if(ld.c(this.A3e))return[];var n=JSON.parse(this.A3e);e=[];for(var C of n)n=Object.assign(new Zc,{title:C.title,addInDetails:[]}),this.agl(n,C.solutionIds),0<n.addInDetails.length&&
Array.add(e,n);0<this.ZPc.length&&(C=this.pPa.cX(2),E.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.ZPc.length,this.ZPc,C.BB.length),this.ZPc=[]);return e}get YPn(){var e=[],n=this.pPa.cX(0);Array.addRange(e,n.BB);n=this.pPa.cX(1);Array.addRange(e,n.BB);e.sort((C,S)=>{C=Mf.d(C.displayName);S=Mf.d(S.displayName);return Of.a.localeCompare(C,S)});n=[];for(const C of e)e=Object.assign(new Hd,{description:C.description,displayName:C.displayName,
solutionId:C.solutionId,uniqueId:this.t1c(C)}),Array.add(n,e);return n}agl(e,n){const C=this.ZPn;let S=0;for(const ja of n){if(4===S)break;if(C.contains(ja))continue;n=this.pPa.z8a(ja);if(!n){this.ZPc.push(ja);continue}const ya=Object.assign(new Hd,{description:n.description,displayName:n.displayName,solutionId:n.solutionId,uniqueId:this.t1c(n)});ya.links=[Object.assign(new Jd,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+n.solutionId})];Array.add(e.addInDetails,
ya);++S}}get ZPn(){const e=[];var n=this.pPa.cX(0);Array.addRange(e,n.BB);n=this.pPa.cX(1);Array.addRange(e,n.BB);n=new Xb.a(Pg.a.vh());for(const C of e)n.add(C.solutionId);return n}t1c(e){return this.ema?String.format("{0}#{1}",e.solutionId,e.storeId):e.solutionId}get ema(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}jpm(){return this.Aa?
this.Aa.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get Q0b(){return!!this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}}Object(F.a)(Xd,"AddInCategoryManager",null,[]);var je=d(524),af;(function(e){e[e.Pdq=0]="myAddins";e[e.dUp=1]="adminManaged";e[e.Ehq=2]="popular"})(af||(af={}));Object(F.b)("AddinCollectionType",af);class Wf{constructor(){this.AUP=this.priority=0}}Object(F.a)(Wf,"AddinDetailInfo",null,[]);
class Mg{constructor(e){this.solutionIds=null;this.errorCode=0;this.Gj=null;this.zea=e}}Object(F.a)(Mg,"AddinCollection",null,[]);class bi extends Sys.EventArgs{constructor(e,n,C,S=null){super();this.xT=e;this.errorCode=n;this.BB=C;this.Gj=S}}Object(F.a)(bi,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class zh{constructor(e){this.errorCode=e;this.BB=[];this.Gj=null}}Object(F.a)(zh,"GetAddinDetailsResult",null,[]);class Ah{}Object(F.a)(Ah,"GetEntitlementDetailsParameters",null,[]);var Zi=d(110);
class sk{constructor(e,n,C=null){this.sa=new eb.a;this.vC=new je.a(Pg.a.vh());this.Xr=new Gb.a;this.NV=0;this.lHb=null;this.cwb=(S,ja,ya)=>{if(ya)if(this.ecd(S,ya,window.performance.now()-ja),0===ya.errorCode){let Rb;if(ya.value){let sc=0;Rb=Array(ya.value.length);ya.value.forEach(Fc=>{Rb[sc++]=Fc})}else Rb=[];this.aK(S,Rb)}else if(-1===ya.errorCode||10===ya.errorCode)this.aK(S,[]);else{var kb={};kb.collectionType=af[S];kb.invokeResultCode=ya.errorCode;kb["queryResult.Value"]=ya.value?String.format("Length: {0}",
ya.value.length):"null";kb.queryStart=ja;kb.queryDuration=window.performance.now()-ja;this.Xr.W(S,Object.assign(new Mg(S),{errorCode:3,Gj:Error.create("QueryAddinDetails hit an invocation failure",kb)}));E.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",af[S],this.Xr.K(S).Gj.toString(),JSON.stringify(this.Xr.K(S).Gj))}else kb={},kb.collectionType=af[S],kb.queryResult=ya?"not null":"null",kb.queryStart=
ja,kb.queryDuration=window.performance.now()-ja,this.Xr.W(S,Object.assign(new Mg(S),{errorCode:3,Gj:Error.create("QueryAddinDetails hit an invocation failure",kb)})),E.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",af[S],this.Xr.K(S).Gj.toString(),JSON.stringify(this.Xr.K(S).Gj))};this.jMa=(S,ja)=>{S=Object.assign(new Mg(ja.xT),{solutionIds:new fb.a});var ya=ja.BB;for(const kb of ya)ya=kb.solutionId,
this.vC.tb(ya)?this.vC.W(ya,this.mdd(this.vC.K(ya),ja.xT,kb)):this.vC.add(ya,kb),S.solutionIds.add(ya);this.Xr.W(ja.xT,S)};this.Zpa=new qc.a;this.Zpa.add(OSF.StoreTypeEnum.MarketPlace,0);this.Zpa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Aa=e;this.ek=n;this.Su=C;this.$Ic=sk.r3c(e,"https://store-images.s-microsoft.com");this.Xlb(this.jMa)}get gcd(){return!!this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get h9c(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get yt(){return this.ek.value}cX(e){if(!this.eLa(e))return e=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:af[e]}),Object.assign(new zh(1),{Gj:e});if(this.Xr.K(e).Gj)return Object.assign(new zh(this.Xr.K(e).errorCode),{Gj:this.Xr.K(e).Gj});E.ULS.shipAssertTag(509870082,220,!!this.Xr.K(e).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",e);const n=new zh(0);for(const C of this.Xr.K(e).solutionIds)this.vC.tb(C)&&
Array.add(n.BB,this.vC.K(C));return n}z8a(e){return this.vC.tb(e)?this.vC.K(e):null}gNa(e){if(e){this.Xlb(e);for(const C of this.Xr.keys)if(this.eLa(C)&&!this.Xr.K(C).Gj){E.ULS.shipAssertTag(509870081,220,!!this.Xr.K(C).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",C);var n=[];for(const S of this.Xr.K(C).solutionIds)Array.add(n,this.vC.K(S));n=new bi(C,this.Xr.K(C).errorCode,n);e(null,n)}}}get name(){return"AddinDetailsManager"}ZYb(){}iS(e,n=!1){0!==
e&&10!==e?E.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ab[e]):this.qid(e,this.cwb,n)}Xlb(e){this.sa.addHandler($b.a.Ccc,e)}RQf(e){const n={};n.collectionType=af[e];this.Xr.W(e,Object.assign(new Mg(e),{errorCode:2,Gj:Error.create("The store is disabled.",n)}));E.ULS.sendTraceTag(510253056,220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",af[e],this.Xr.K(e).Gj.toString(),JSON.stringify(this.Xr.K(e).Gj))}TAg(){return this.eLa(2)?
this.Aa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Xr.K(2).Gj:!1:!0}qid(e,n,C=!1){E.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",e);e!==OSF.StoreTypeEnum.MarketPlace&&e!==OSF.StoreTypeEnum.PrivateCatalog?E.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",e):(this.TAg()&&this.queryStoreDisabled(0,(S,ja)=>{ja?this.RQf(2):(S=window.performance.now(),n(2,S,this.fGm()))}),this.queryStoreDisabled(e,(S,ja)=>{if(S===OSF.StoreTypeEnum.MarketPlace&&
ja)this.RQf(0);else if(S===OSF.StoreTypeEnum.PrivateCatalog&&ja)this.RQf(1);else{var ya=window.performance.now();this.yt.getEntitlementDetails(Object.assign(new Ah,{storeType:S,refresh:C}),kb=>{n(this.Zpa.K(S),ya,kb)})}}))}aK(e,n){e=new bi(e,0,n);this.sa.raiseEvent($b.a.Ccc,e)}eLa(e){return this.Xr.tb(e)?!!this.vC:!1}get ddc(){return this.Su?!this.Su.AreThirdPartyAddInsAllowed||this.Su.AppsForOfficeThirdPartyIsDisabled:!this.Aa.$("AreThirdPartyAddInsAllowed")||this.Aa.$("AppsForOfficeThirdPartyIsDisabled")}get noc(){return this.Su?
!this.Su.AppsForOfficeAllowExternalMarketplace:!this.Aa.$("AppsForOfficeAllowExternalMarketplace")}get Dwb(){return this.Su?this.Su.PopularAddinDetailsJsonString:this.Aa.jb("PopularAddinDetailsJsonString")}queryStoreDisabled(e,n){if(this.ddc)n(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&this.noc)n(e,!0);else{const C=sk.Pzc(e);if(C){const S=window.performance.now();this.yt.queryStoreDisabled(C,ja=>{E.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
e,ja,S,window.performance.now()-S);n(e,ja)})}else n(e,!1)}}mdd(e,n,C){return e?C?2===n?sk.$ub(C,e):sk.$ub(e,C):e:C}fGm(){if(!this.lHb){const e=JSON.parse(this.Dwb);this.P0c(e);this.lHb=e}return sk.Ndc(0,this.lHb)}P0c(e){sk.iTc(e);this.Zcc(e);this.Q0c(e)}Zcc(e){const n=this.oUc();for(var C=0;C<e.length&&0<n.count;C++){const S=e[C];if(n.tb(S.solutionId)){let ja=String.format("Found an override, solutionId: {0}",S.solutionId);const ya=n.K(S.solutionId);ya&&(isNaN(ya.addinInfo.priority)||(ja=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
ja,S.addinInfo.priority,ya.addinInfo.priority),S.addinInfo.priority=ya.addinInfo.priority),isNaN(ya.addinInfo.AUP)||(ja=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ja,S.addinInfo.AUP,ya.addinInfo.AUP),S.addinInfo.AUP=ya.addinInfo.AUP),ya.displayName&&(ja=String.format("{0}; DisplayName: update {1} to {2}",ja,S.displayName,ya.displayName),S.displayName=ya.displayName),ya.iconUrl&&(ja=String.format("{0}; IconUrl: update {1} to {2}",ja,S.iconUrl,ya.iconUrl),S.iconUrl=ya.iconUrl),ya.description&&
(ja=String.format("{0}; Description: update {1} to {2}",ja,S.description,ya.description),S.description=ya.description));n.remove(S.solutionId);this.h9c&&E.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ja)}}for(const S of n.keys)C=n.K(S),C.displayName&&C.iconUrl&&C.addinInfo&&(e.push(C),this.h9c&&E.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(C)))}oUc(){const e=new je.a(Pg.a.vh());
let n=this.Aa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!n)return e;n=n.trim();if(12>=n.length)return 0<n.length&&E.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",n),e;this.h9c&&E.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",n);try{const C=[],S=n.split("|");for(let ja=S.length-1;0<=ja;ja--){const ya=S[ja],kb=ya.split("\\");if(2>kb.length){C.push(ya);continue}const Rb=
sk.Igd(kb);Rb?e.tb(Rb.solutionId)||e.add(Rb.solutionId,Rb):C.push(ya)}this.h9c&&0<C.length&&E.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",C.join("|"));this.h9c&&0<e.count&&E.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",e.count,JSON.stringify(Zi.toArray(e.values)));return e}catch(C){E.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
n,C.toString())}return e}Q0c(e){for(let n=0;n<e.length;n++)Mf.c(e[n].iconUrl.toLowerCase(),"http",0)||(e[n].iconUrl=String.format("{0}/image/apps.{1}",this.$Ic,e[n].iconUrl))}fcd(e,n,C){const S={};S.AddinCollectionType=af[e];S.ErrorCode=n.errorCode;S.AddinCount=n.value?n.value.length:0;e=window.performance.now();n=Date.now()-G.AFrameworkApplication.YK;E.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",
C,e,n,JSON.stringify(S))}ecd(e,n,C){this.gcd?(C={["AddinCollectionType"]:af[e],["ErrorCode"]:n.errorCode,["QueryDuration"]:C,["FlyoutDataReadySinceBoot"]:Date.now()-G.AFrameworkApplication.YK},this.i9c(e)&&E.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(C)),C.AddinCount=n.value?n.value.length:0,E.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(C))):this.fcd(e,n,C)}i9c(e){0===e?this.NV|=1:1===e&&(this.NV|=2);e=this.NV&131;if(e=1===e||2===e)this.NV=255;return e}static Ndc(e,
n){const C={};C.errorCode=e;C.value=n;return C}static Pzc(e){return e===OSF.StoreTypeEnum.MarketPlace?"omex":e===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static $ub(e,n){n.solutionId=n.solutionId||e.solutionId;n.version=n.version||e.version;n.storeType=n.storeType||e.storeType;n.storeId=n.storeId||e.storeId;n.assetId=n.assetId||e.assetId;n.assetStoreId=n.assetStoreId||e.assetStoreId;n.displayName=n.displayName||e.displayName;n.provider=n.provider||e.provider;n.description=n.description||
e.description;n.iconUrl=n.iconUrl||e.iconUrl;n.webApplicationId=n.webApplicationId||e.webApplicationId;n.highResolutionIconUrl=n.highResolutionIconUrl||e.highResolutionIconUrl;n.licenseUrl=n.licenseUrl||e.licenseUrl;n.privacyUrl=n.privacyUrl||e.privacyUrl;n.addinInfo=n.addinInfo||e.addinInfo;isNaN(n.targetType)&&(n.targetType=e.targetType);isNaN(n.height)&&(n.height=e.height);isNaN(n.width)&&(n.width=e.width);return n}static iTc(e){for(const n of e)isNaN(n.targetType)&&(n.targetType=1),n.assetId=
n.assetId||n.solutionId,n.storeId=n.storeId||"en-US",n.storeType=n.storeType||"omex",n.assetStoreId=n.assetStoreId||"omex",isNaN(n.width)&&(n.width=0),isNaN(n.height)&&(n.height=0)}static Igd(e){const n={};let C=0;C<e.length&&0<e[C].trim().length&&e[C].trim().toLowerCase().startsWith("wa")&&(n.solutionId=e[C].trim(),n.addinInfo=Object.assign(new Wf,{priority:Number.NaN,AUP:Number.NaN}),++C<e.length&&0<e[C].trim().length&&(n.addinInfo.priority=parseInt(e[C].trim())),++C<e.length&&0<e[C].trim().length&&
(n.addinInfo.AUP=parseInt(e[C].trim())),++C<e.length&&0<e[C].trim().length&&(n.displayName=e[C].trim()),++C<e.length&&0<e[C].trim().length&&(n.iconUrl=e[C].trim()),++C<e.length&&0<e[C].trim().length&&(n.description=e[C].trim()));return n.solutionId?n:null}static r3c(e,n){e=e.jb("AddinImageStoreServiceUrl");if(!e)return n;e=e.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")?e:n}}Object(F.a)(sk,"AddinDetailsManager",null,[1217,1218]);class gm{constructor(e,n=0){this.Gj=null;this.zea=
e;this.errorCode=n}}Object(F.a)(gm,"AddinQueryResult",null,[]);class Gj extends gm{constructor(e,n=0){super(e,n);this.solutionIds=null}}Object(F.a)(Gj,"AddinCollection",gm,[]);var En;(function(e){e[e.stop=-1]="stop";e[e.skip=0]="skip";e[e.query=1]="query"})(En||(En={}));Object(F.b)("QueryStrategy",En);class Rm{constructor(e){this.A$g=432E5;e&&(this.A$g=36E5*e.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",12))}iMm(e){const n=new Date;let C=new Date(-1);try{const S=Rm.C3j(`${e}_ExpirationTime`);
S&&(C=new Date(parseInt(S,10)))}catch(S){E.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${e}: ${S}`)}if(n.getTime()<C.getTime()&&(e=Rm.C3j(`${e}_StoreDisabled`)))return"true"===e}g_o(e,n){void 0!==n&&null!==n&&(Rm.o4j(n.toString(),`${e}_StoreDisabled`),Rm.o4j(((new Date).getTime()+this.A$g).toString(),`${e}_ExpirationTime`))}static C3j(e){let n=null;try{const C=Rm.hrd;if(void 0!==C&&C){const S=$b.a.Yic("Flyout")+"_"+e;n=C.getItem(S)}else E.ULS.sendTraceTag(508063828,
220,50,"tryGetCache: Storage.Local null")}catch(C){E.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",e)}return n}static o4j(e,n){try{const C=Rm.hrd;if(void 0!==C&&C){const S=$b.a.Yic("Flyout")+"_"+n;C.setItem(S,e)}else E.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(C){E.ULS.sendTraceTag(508063825,220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",n)}}static get hrd(){if(!Rm.aBa)return null;
let e=null;try{e=localStorage}catch(n){Rm.aBa=!1,e=null,E.ULS.sendTraceTag(508063824,220,10,`Failed to use localStorage: error name: ${n.name}; message: ${n.message}; stack: ${n.stack}`)}return e}}Rm.aBa=!0;Object(F.a)(Rm,"StoreDisabledCache",null,[]);class Si{constructor(e,n,C=null){var S;this.sa=new eb.a;this.vC=new je.a(Pg.a.vh());this.Xr=new Gb.a;this.NV=0;this.Sda=new Gb.a;this.lHb=null;this.cwb=(ja,ya,kb)=>{if(kb)if(this.ecd(ja,kb,window.performance.now()-ya),0===kb.errorCode){let Rb;if(kb.value){let sc=
0;Rb=Array(kb.value.length);kb.value.forEach(Fc=>{Rb[sc++]=Fc})}else Rb=[];this.aK(new gm(ja),Rb)}else-1===kb.errorCode||10===kb.errorCode?this.aK(new gm(ja),[]):(ja=this.xlf(ja,ya,kb),this.aK(ja));else ja=Si.ylf(ja,ya),this.aK(ja)};this.jMa=(ja,ya)=>{if(0!==ya.errorCode)this.Xr.W(ya.xT,Object.assign(new Gj(ya.xT,ya.errorCode),{Gj:ya.Gj})),this.DOn&&this.kDa(ya.xT,1);else{ja=Object.assign(new Gj(ya.xT),{solutionIds:new fb.a});var kb=ya.BB;for(const Rb of kb)kb=Rb.solutionId,this.vC.tb(kb)?this.vC.W(kb,
this.mdd(this.vC.K(kb),ya.xT,Rb)):this.vC.add(kb,Rb),ja.solutionIds.add(kb);this.Xr.W(ya.xT,ja);this.kDa(ja.zea,1)}};this.Zpa=new qc.a;this.Zpa.add(OSF.StoreTypeEnum.MarketPlace,0);this.Zpa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Aa=e;this.ek=n;this.Su=C;this.$Ic=Si.r3c(e,"https://store-images.s-microsoft.com");this.Xlb(this.jMa);this.kGh=null!==(S=C.StoreDisabledCache)&&void 0!==S?S:new Rm(e)}get DOn(){return!!this.Aa&&this.Aa.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get tR(){return!!this.Aa&&
this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get gcd(){return!!this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get KCg(){return!!this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get $ep(){return!!this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.Aa&&this.Aa.$("IsAnonymousUser")}get wDf(){return!!this.Aa&&
this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get uic(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get LJa(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get yt(){return this.ek.value}cX(e){if(this.tR&&!this.x$a(e))return new zh(0);if(!this.eLa(e))return e=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:af[e]}),
Object.assign(new zh(1),{Gj:e});if(this.Xr.K(e).Gj)return Object.assign(new zh(this.Xr.K(e).errorCode),{Gj:this.Xr.K(e).Gj});E.ULS.shipAssertTag(509870082,220,!!this.Xr.K(e).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",e);const n=new zh(0);for(const C of this.Xr.K(e).solutionIds)this.vC.tb(C)&&Array.add(n.BB,this.vC.K(C));return n}z8a(e){return this.vC.tb(e)?this.vC.K(e):null}gNa(e){if(e){this.Xlb(e);for(const n of this.Xr.keys){if(this.tR&&!this.x$a(n))continue;
if(!this.eLa(n)||this.Xr.K(n).Gj)continue;E.ULS.shipAssertTag(509870081,220,!!this.Xr.K(n).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",n);const C=[],S=this.Xr.K(n);for(const ja of S.solutionIds)Array.add(C,this.vC.K(ja));e(null,new bi(n,S.errorCode,C,S.Gj))}}}get name(){return"AddinDetailsManager1"}ZYb(e,n){if(this.tR&&Si.Wtb(e)){var C=ja=>{this.aK(Si.vLb(ja,4,"The connected service is disabled."));this.kDa(ja,-1)},S=ja=>{this.aK(Si.vLb(ja,0,
"The user doesn't have any addin installed."),[]);this.kDa(ja,0)};0===e?(this.r7c(0,n,C,S),this.r7c(2,n,C,()=>{this.tYb(this.cwb)})):10===e&&this.kDa(1,1)}}iS(e,n=!1){Si.Wtb(e)?this.qid(e,this.cwb,n):E.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ab[e])}Xlb(e){this.sa.addHandler($b.a.Ccc,e)}r7c(e,n,C,S){this.x$a(e)||(3===n&&C?C(e):2===n&&S?S(e):this.kDa(e,1))}x$a(e){return this.Sda.tb(e)}kDa(e,n){if(this.tR){var C=this.x$a(e);if(!C||-1!==this.Sda.K(e)&&this.Sda.K(e)!==
n)E.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",af[e],C?En[this.Sda.K(e)]:"undefined",En[n]),this.Sda.W(e,n)}}xlf(e,n,C){const S={};S.collectionType=af[e];S.invokeResultCode=C.errorCode;S["queryResult.Value"]=C.value?String.format("Length: {0}",C.value.length):"null";S.queryStart=n;S.queryDuration=window.performance.now()-n;return Object.assign(new gm(e,3),{Gj:Error.create("QueryAddinDetails hit an invocation failure",S)})}K4o(){return this.eLa(2)?
this.Aa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.Xr.K(2).errorCode:!1:!0}xxc(e){return this.tR&&this.Sda.tb(e)?1===this.Sda.K(e):!0}qid(e,n,C=!1){E.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",e);if(e!==OSF.StoreTypeEnum.MarketPlace&&e!==OSF.StoreTypeEnum.PrivateCatalog)E.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",e);else{var S=this.Zpa.K(e);(!this.KCg||this.uic&&this.isAnonymousUser)&&e===OSF.StoreTypeEnum.MarketPlace&&
this.xxc(2)&&this.tYb(n);this.xxc(S)&&(this.uic&&this.isAnonymousUser?(e=Si.nlf(S),this.aK(e)):this.Omg(e,n,C))}}Omg(e,n,C){this.kxj(e,(S,ja)=>{if(S===OSF.StoreTypeEnum.MarketPlace&&ja)ja=Si.Rmb(0),this.aK(ja),this.KCg&&this.aK(Si.Rmb(2));else if(S===OSF.StoreTypeEnum.PrivateCatalog&&ja)ja=Si.Rmb(1),this.aK(ja);else{this.KCg&&S===OSF.StoreTypeEnum.MarketPlace&&this.xxc(2)&&n(2,window.performance.now(),this.bHj());var ya=window.performance.now();this.yt.getEntitlementDetails(Object.assign(new Ah,{storeType:S,
refresh:C}),kb=>{n(this.Zpa.K(S),ya,kb)})}})}tYb(e){this.K4o()&&this.kxj(0,(n,C)=>{C?(n=Si.Rmb(2),this.aK(n)):(n=window.performance.now(),e(2,n,this.bHj()))})}aK(e,n=null){0!==e.errorCode?(E.ULS.shipAssertTag(509116673,220,!n,"The parameter addinDetails must be null for any failed queries"),E.ULS.shipAssertTag(509116672,220,!!e.Gj,"The result.Failure must not be available for any failed queries"),this.LAg(e)?E.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",af[e.zea],rc[e.errorCode],e.Gj?e.Gj.toString():"null",JSON.stringify(e.Gj)):E.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",af[e.zea],rc[e.errorCode],e.Gj?e.Gj.toString():"null",JSON.stringify(e.Gj))):(E.ULS.shipAssertTag(509116643,220,!!n,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",af[e.zea]),E.ULS.sendTraceTag(509116642,220,
50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",af[e.zea],n?n.length:-1));e=new bi(e.zea,e.errorCode,n,e.Gj);this.sa.raiseEvent($b.a.Ccc,e)}LAg(e){return 3===e.errorCode&&(this.uic&&-2147208619===Si.v3c(e)||this.wDf&&-2===Si.v3c(e))||4===e.errorCode?!1:2!==e.errorCode}eLa(e){return this.Xr.tb(e)?!!this.vC:!1}get ddc(){return this.Su?!this.Su.AreThirdPartyAddInsAllowed||this.Su.AppsForOfficeThirdPartyIsDisabled:!this.Aa.$("AreThirdPartyAddInsAllowed")||this.Aa.$("AppsForOfficeThirdPartyIsDisabled")}get noc(){return this.Su?
!this.Su.AppsForOfficeAllowExternalMarketplace:!this.Aa.$("AppsForOfficeAllowExternalMarketplace")}get Dwb(){return this.Su?this.Su.PopularAddinDetailsJsonString:this.Aa.jb("PopularAddinDetailsJsonString")}queryStoreDisabled(e,n){if(this.ddc)n(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&this.noc)n(e,!0);else{const C=Si.Pzc(e);if(C){const S=window.performance.now();this.yt.queryStoreDisabled(C,ja=>{E.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
e,ja,S,window.performance.now()-S);n(e,ja)})}else n(e,!1)}}kxj(e,n){if(this.$ep)if(this.ddc)n(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&this.noc)n(e,!0);else{const C=Si.Pzc(e),S=this.kGh.iMm(e);if(void 0===S)if(C){const ja=window.performance.now();this.yt.queryStoreDisabled(C,ya=>{this.kGh.g_o(e,ya);E.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",e,ya,ja,window.performance.now()-ja);n(e,void 0!==ya?ya:!0)})}else n(e,
!1);else n(e,S)}else this.queryStoreDisabled(e,n)}mdd(e,n,C){return e?C?2===n?Si.$ub(C,e):Si.$ub(e,C):e:C}bHj(){if(!this.lHb){const e=JSON.parse(this.Dwb);this.P0c(e);this.lHb=e}return Si.Ndc(0,this.lHb)}P0c(e){Si.iTc(e);this.Zcc(e);this.Q0c(e)}Zcc(e){const n=this.oUc();for(var C=0;C<e.length&&0<n.count;C++){const S=e[C];if(n.tb(S.solutionId)){let ja=String.format("Found an override, solutionId: {0}",S.solutionId);const ya=n.K(S.solutionId);ya&&(isNaN(ya.addinInfo.priority)||(ja=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
ja,S.addinInfo.priority,ya.addinInfo.priority),S.addinInfo.priority=ya.addinInfo.priority),isNaN(ya.addinInfo.AUP)||(ja=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ja,S.addinInfo.AUP,ya.addinInfo.AUP),S.addinInfo.AUP=ya.addinInfo.AUP),ya.displayName&&(ja=String.format("{0}; DisplayName: update {1} to {2}",ja,S.displayName,ya.displayName),S.displayName=ya.displayName),ya.iconUrl&&(ja=String.format("{0}; IconUrl: update {1} to {2}",ja,S.iconUrl,ya.iconUrl),S.iconUrl=ya.iconUrl),ya.description&&
(ja=String.format("{0}; Description: update {1} to {2}",ja,S.description,ya.description),S.description=ya.description));n.remove(S.solutionId);this.LJa&&E.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ja)}}for(const S of n.keys)C=n.K(S),C.displayName&&C.iconUrl&&C.addinInfo&&(e.push(C),this.LJa&&E.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(C)))}oUc(){const e=new je.a(Pg.a.vh());
let n=this.Aa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!n)return e;n=n.trim();if(12>=n.length)return 0<n.length&&E.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",n),e;this.LJa&&E.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",n);try{const C=[],S=n.split("|");for(let ja=S.length-1;0<=ja;ja--){const ya=S[ja],kb=ya.split("\\");if(2>kb.length){C.push(ya);continue}const Rb=
Si.Igd(kb);Rb?e.tb(Rb.solutionId)||e.add(Rb.solutionId,Rb):C.push(ya)}this.LJa&&0<C.length&&E.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",C.join("|"));this.LJa&&0<e.count&&E.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",e.count,JSON.stringify(Zi.toArray(e.values)));return e}catch(C){E.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
n,C.toString())}return e}Q0c(e){for(let n=0;n<e.length;n++)Mf.c(e[n].iconUrl.toLowerCase(),"http",0)||(e[n].iconUrl=String.format("{0}/image/apps.{1}",this.$Ic,e[n].iconUrl))}static Wtb(e){return 0===e||10===e}static ylf(e,n){const C={};C.collectionType=af[e];C.queryResult="null";C.queryStart=n;C.queryDuration=window.performance.now()-n;return Object.assign(new gm(e,3),{Gj:Error.create("QueryAddinDetails hit an invocation failure",C)})}static vLb(e,n,C){const S={};S.collectionType=af[e];e=new gm(e,
n);0!==n&&(e.Gj=Error.create(C,S));return e}static Rmb(e){return Si.vLb(e,2,"The store is disabled.")}static nlf(e){const n={};n.collectionType=af[e];n.invokeResultCode=-2147208619;n.queryDuration=0;return Object.assign(new gm(e,3),{Gj:Error.create("Anonymous users do not have installed add-ins.",n)})}static v3c(e){return e.Gj?e.Gj.invokeResultCode:-1E3}fcd(e,n,C){const S={};S.AddinCollectionType=af[e];S.ErrorCode=n.errorCode;S.AddinCount=n.value?n.value.length:0;e=window.performance.now();n=Date.now()-
G.AFrameworkApplication.YK;E.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",C,e,n,JSON.stringify(S))}ecd(e,n,C){this.gcd?(C={["AddinCollectionType"]:af[e],["ErrorCode"]:n.errorCode,["QueryDuration"]:C,["FlyoutDataReadySinceBoot"]:Date.now()-G.AFrameworkApplication.YK},this.i9c(e)&&E.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(C)),C.AddinCount=n.value?n.value.length:0,E.ULS.sendTraceTag(512231322,
220,50,"logQueryCompletedResult: {0}",JSON.stringify(C))):this.fcd(e,n,C)}i9c(e){0===e?this.NV|=1:1===e&&(this.NV|=2);e=this.NV&131;if(e=1===e||2===e)this.NV=255;return e}static Ndc(e,n){const C={};C.errorCode=e;C.value=n;return C}static Pzc(e){return e===OSF.StoreTypeEnum.MarketPlace?"omex":e===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static $ub(e,n){n.solutionId=n.solutionId||e.solutionId;n.version=n.version||e.version;n.storeType=n.storeType||e.storeType;n.storeId=n.storeId||e.storeId;
n.assetId=n.assetId||e.assetId;n.assetStoreId=n.assetStoreId||e.assetStoreId;n.displayName=n.displayName||e.displayName;n.provider=n.provider||e.provider;n.description=n.description||e.description;n.iconUrl=n.iconUrl||e.iconUrl;n.webApplicationId=n.webApplicationId||e.webApplicationId;n.highResolutionIconUrl=n.highResolutionIconUrl||e.highResolutionIconUrl;n.licenseUrl=n.licenseUrl||e.licenseUrl;n.privacyUrl=n.privacyUrl||e.privacyUrl;n.addinInfo=n.addinInfo||e.addinInfo;isNaN(n.targetType)&&(n.targetType=
e.targetType);isNaN(n.height)&&(n.height=e.height);isNaN(n.width)&&(n.width=e.width);return n}static iTc(e){for(const n of e)isNaN(n.targetType)&&(n.targetType=1),n.assetId=n.assetId||n.solutionId,n.storeId=n.storeId||"en-US",n.storeType=n.storeType||"omex",n.assetStoreId=n.assetStoreId||"omex",isNaN(n.width)&&(n.width=0),isNaN(n.height)&&(n.height=0)}static Igd(e){const n={};let C=0;C<e.length&&0<e[C].trim().length&&e[C].trim().toLowerCase().startsWith("wa")&&(n.solutionId=e[C].trim(),n.addinInfo=
Object.assign(new Wf,{priority:Number.NaN,AUP:Number.NaN}),++C<e.length&&0<e[C].trim().length&&(n.addinInfo.priority=parseInt(e[C].trim())),++C<e.length&&0<e[C].trim().length&&(n.addinInfo.AUP=parseInt(e[C].trim())),++C<e.length&&0<e[C].trim().length&&(n.displayName=e[C].trim()),++C<e.length&&0<e[C].trim().length&&(n.iconUrl=e[C].trim()),++C<e.length&&0<e[C].trim().length&&(n.description=e[C].trim()));return n.solutionId?n:null}static r3c(e,n){e=e.jb("AddinImageStoreServiceUrl");if(!e)return n;e=
e.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")?e:n}}Object(F.a)(Si,"AddinDetailsManager1",null,[1217,1218]);class rp{constructor(e,n=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=e.solutionId;this.version=
e.version;this.storeType=e.storeType;this.storeId=e.storeId;this.assetId=e.assetId;this.assetStoreId=e.assetStoreId;this.displayName=e.displayName;this.provider=e.provider;this.description=e.description;this.targetType=e.targetType;this.height=e.height;this.width=e.width;this.iconUrl=e.iconUrl;this.webApplicationId=e.webApplicationId;this.highResolutionIconUrl=e.highResolutionIconUrl;this.licenseUrl=e.licenseUrl;this.privacyUrl=e.privacyUrl;this.addinInfo=n}Lzc(){const e={};e.solutionId=this.solutionId;
e.version=this.version;e.storeType=this.storeType;e.storeId=this.storeId;e.assetId=this.assetId;e.assetStoreId=this.assetStoreId;e.targetType=this.targetType;e.displayName=this.displayName;e.width=this.width;e.height=this.height;return e}}Object(F.a)(rp,"AddinDetail",null,[]);class Ji{constructor(e,n,C,S,ja){this.GMd=null;this.Aa=e;this.ek=n;this.mHb=C;this.XJk=S;this.ohb=ja}iS(e,n){this.yt.queryAppDetails(this.XJk,this.ohb,this.solutionIds,e,(C,S)=>{let ja=null;if(S){ja=Array(S.length);for(let ya=
0;ya<S.length;ya++)ja[ya]=new rp(S[ya],this.nIn(S[ya].solutionId))}n(C,ja||[])})}get dln(){return!!this.yt.queryAppDetails}nIn(e){return this.mHb.K(e)}get solutionIds(){if(!this.GMd){this.GMd=new fb.a;for(const e of this.mHb.keys)this.GMd.add(Mf.d(e))}return this.GMd.toArray()}get yt(){return this.ek.value}}Object(F.a)(Ji,"AddinDetailsLoader",null,[]);class Fn{constructor(e,n=0){this.Gj=null;this.zea=e;this.errorCode=n}}Object(F.a)(Fn,"AddinQueryResult",null,[]);class ml extends Fn{constructor(e,
n=0){super(e,n);this.jEg=this.solutionIds=null}}Object(F.a)(ml,"AddinCollection",Fn,[]);var jn=d(1190);class Gn extends jn.a{constructor(){super(Pg.a.vh())}}Object(F.a)(Gn,"AddinDetailTable",jn.a,[]);var gl;(function(e){e[e.stop=-1]="stop";e[e.skip=0]="skip";e[e.query=1]="query"})(gl||(gl={}));Object(F.b)("QueryStrategy",gl);class rj{constructor(e,n,C=null){this.sa=new eb.a;this.vC=new je.a(Pg.a.vh());this.Xr=new Gb.a;this.NV=0;this.Sda=new Gb.a;this.mHb=this.iLe=null;this.cwb=(S,ja,ya)=>{ya?(this.ecd(S,
ya,window.performance.now()-ja),0===ya.errorCode?(ja=ya.value?rj.x6k(ya.value):[],this.aK(new Fn(S),ja)):-1===ya.errorCode||10===ya.errorCode?this.aK(new Fn(S),[]):(S=this.xlf(S,ja,ya),this.aK(S))):(S=rj.ylf(S,ja),this.aK(S))};this.jMa=(S,ja)=>{if(0!==ja.errorCode&&5!==ja.errorCode)this.M5j(ja.xT,Object.assign(new ml(ja.xT,ja.errorCode),{Gj:ja.Gj}));else{S=Object.assign(new ml(ja.xT,ja.errorCode),{solutionIds:new fb.a,jEg:new fb.a});var ya=ja.BB;for(const Rb of ya){ya=Rb.solutionId;const sc=Rb.storeId;
if(this.vC.tb(ya)){var kb=this.vC.K(ya);kb.tb(sc)?kb.W(sc,this.mdd(kb.K(sc),ja.xT,Rb)):kb.add(sc,Rb)}else kb=new Gn,kb.add(sc,Rb),this.vC.add(ya,kb);S.solutionIds.add(ya);S.jEg.add(sc)}this.M5j(ja.xT,S)}};this.Zpa=new qc.a;this.Zpa.add(OSF.StoreTypeEnum.MarketPlace,0);this.Zpa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Aa=e;this.ek=n;this.Su=C;this.$Ic=rj.r3c(e,"https://store-images.s-microsoft.com");this.B3e=null;this.Xlb(this.jMa)}get ITd(){this.iLe||(this.iLe=this.Sti());return this.iLe}Sti(){const e=
JSON.parse(this.Dwb);this.P0c(e);return e.map(n=>new rp(n,n.addinInfo))}get tR(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get gcd(){return!!this.Aa&&this.Aa.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.Aa&&this.Aa.$("IsAnonymousUser")}get wDf(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get uic(){return!!this.Aa&&
this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get LJa(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get yt(){return this.ek.value}get Yjg(){this.B3e||(this.B3e=new Ji(this.Aa,this.ek,this.zdo,0,this.yt.getAppUILocale()));return this.B3e}cX(e){if(this.tR&&!this.x$a(e))return new zh(0);if(!this.eLa(e))return e=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:af[e]}),
Object.assign(new zh(1),{Gj:e});const n=this.Xr.K(e);if(n.Gj)return Object.assign(new zh(n.errorCode),{Gj:n.Gj});E.ULS.shipAssertTag(509870082,220,!!n.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",e);const C=new zh(n.errorCode);for(let S=0;S<n.solutionIds.count;S++){const ja=n.solutionIds.K(S),ya=n.jEg.K(S);if(this.vC.tb(ja)){const kb=this.vC.K(ja);kb.tb(ya)?Array.add(C.BB,kb.K(ya)):E.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",
ja,e,ya)}else E.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",ja,e)}return C}z8a(e,n=null){if(e=this.Kgm(e))if(n||(n=this.uiCulture),e.tb(n))return e.K(n);return null}Kgm(e){return this.vC.tb(e)?this.vC.K(e):null}gNa(e){if(e){this.Xlb(e);for(const n of this.Xr.keys){if(this.tR&&!this.x$a(n))continue;if(!this.eLa(n)||this.Xr.K(n).Gj)continue;E.ULS.shipAssertTag(509870081,220,!!this.Xr.K(n).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
n);const C=[],S=this.Xr.K(n);for(const ja of S.solutionIds)Array.add(C,this.vC.K(ja));e(null,new bi(n,S.errorCode,C,S.Gj))}}}get name(){return"AddinDetailsManager2"}ZYb(e,n){if(this.tR&&rj.Wtb(e)){var C=ja=>{this.aK(rj.vLb(ja,4,"The connected service is disabled."));this.kDa(ja,-1)},S=ja=>{this.aK(rj.vLb(ja,0,"The user doesn't have any addin installed."),[]);this.kDa(ja,0)};0===e?(this.r7c(0,n,C,S),this.r7c(2,n,C,()=>{this.tYb(this.cwb,this.ITd)})):10===e&&this.kDa(1,1)}}iS(e,n=!1){rj.Wtb(e)?this.qid(e,
this.cwb,n):E.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ab[e])}Xlb(e){this.sa.addHandler($b.a.Ccc,e)}r7c(e,n,C,S){this.x$a(e)||(3===n&&C?C(e):2===n&&S?S(e):this.kDa(e,1))}x$a(e){return this.Sda.tb(e)}kDa(e,n){if(this.tR){var C=this.x$a(e);if(!C||-1!==this.Sda.K(e)&&this.Sda.K(e)!==n)E.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",af[e],C?gl[this.Sda.K(e)]:"undefined",gl[n]),this.Sda.W(e,n)}}xlf(e,n,C){const S=
{};S.collectionType=af[e];S.invokeResultCode=C.errorCode;S["queryResult.Value"]=C.value?String.format("Length: {0}",C.value.length):"null";S.queryStart=n;S.queryDuration=window.performance.now()-n;return Object.assign(new Fn(e,3),{Gj:Error.create("QueryAddinDetails hit an invocation failure",S)})}TAg(e){if(e!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.xxc(2)){if(!this.eLa(2))return!0;if(this.Aa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===this.Xr.K(2).errorCode}return!1}xxc(e){return this.tR&&
this.Sda.tb(e)?1===this.Sda.K(e):!0}qid(e,n,C=!1){E.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",e);if(e!==OSF.StoreTypeEnum.MarketPlace&&e!==OSF.StoreTypeEnum.PrivateCatalog)E.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",e);else{var S=this.Zpa.K(e);this.TAg(e)&&this.tYb(n,this.sfo);this.xxc(S)&&(this.uic&&this.isAnonymousUser?(e=rj.nlf(S),this.aK(e)):this.Omg(e,n,C))}}get sfo(){return this.Xr.tb(2)?null:this.ITd}Omg(e,n,C){this.queryStoreDisabled(e,
(S,ja)=>{if(S===OSF.StoreTypeEnum.MarketPlace&&ja)ja=rj.Rmb(0),this.aK(ja);else if(S===OSF.StoreTypeEnum.PrivateCatalog&&ja)ja=rj.Rmb(1),this.aK(ja);else{var ya=window.performance.now();this.yt.getEntitlementDetails(Object.assign(new Ah,{storeType:S,refresh:C}),kb=>{n(this.Zpa.K(S),ya,kb)})}})}tYb(e=null,n=null){null===e&&(e=this.cwb);this.queryStoreDisabled(0,(C,S)=>{S?(C=rj.Rmb(2),this.aK(C)):null!=n?this.aK(new Fn(2,5),n):this.Dlo(e)})}aK(e,n=null){0!==e.errorCode&&5!==e.errorCode?(E.ULS.shipAssertTag(509116673,
220,!n,"The parameter addinDetails must be null for any failed queries"),E.ULS.shipAssertTag(509116672,220,!!e.Gj,"The result.Failure must not be available for any failed queries"),this.LAg(e)?E.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",af[e.zea],rc[e.errorCode],e.Gj?e.Gj.toString():"null",JSON.stringify(e.Gj)):E.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"(downgraded error)",af[e.zea],rc[e.errorCode],e.Gj?e.Gj.toString():"null",JSON.stringify(e.Gj))):(E.ULS.shipAssertTag(509116643,220,!!n,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",af[e.zea]),E.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",af[e.zea],n?n.length:-1,rc[e.errorCode]));e=new bi(e.zea,e.errorCode,n,e.Gj);this.sa.raiseEvent($b.a.Ccc,e)}LAg(e){return 3===
e.errorCode&&(this.uic&&-2147208619===rj.v3c(e)||this.wDf&&-2===rj.v3c(e))||4===e.errorCode?!1:2!==e.errorCode}M5j(e,n){this.Xr.W(e,n);this.kDa(e,1)}eLa(e){return this.Xr.tb(e)?!!this.vC:!1}get uiCulture(){return this.Su&&this.Su.UICulture?this.Su.UICulture:G.AFrameworkApplication.uiCulture}get ddc(){return this.Su?!this.Su.AreThirdPartyAddInsAllowed||this.Su.AppsForOfficeThirdPartyIsDisabled:!this.Aa.$("AreThirdPartyAddInsAllowed")||this.Aa.$("AppsForOfficeThirdPartyIsDisabled")}get noc(){return this.Su?
!this.Su.AppsForOfficeAllowExternalMarketplace:!this.Aa.$("AppsForOfficeAllowExternalMarketplace")}get zdo(){if(!this.mHb){this.mHb=new je.a(Pg.a.vh());const e=JSON.parse(this.Dwb);for(const n of e)this.mHb.add(n.solutionId,n.addinInfo)}return this.mHb}get Dwb(){return this.Su?this.Su.PopularAddinDetailsJsonString:this.Aa.jb("PopularAddinDetailsJsonString")}queryStoreDisabled(e,n){if(this.ddc)n(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&this.noc)n(e,!0);else{const C=rj.Pzc(e);if(C){const S=
window.performance.now();this.yt.queryStoreDisabled(C,ja=>{E.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",e,ja,S,window.performance.now()-S);n(e,ja)})}else n(e,!1)}}mdd(e,n,C){return e?C?2===n?rj.$ub(C,e):rj.$ub(e,C):e:C}Dlo(e){const n=(S,ja,ya)=>{e(2,ya,rj.Ndc(S,ja))},C=window.performance.now();this.Yjg&&this.Yjg.dln?this.Yjg.iS(!1,(S,ja)=>{this.Zcc(ja);e(2,C,rj.Ndc(S,ja))}):n(0,this.Sti(),C)}P0c(e){rj.iTc(e);this.Zcc(e);
this.Q0c(e)}Zcc(e){const n=this.oUc();for(var C=0;C<e.length&&0<n.count;C++){const S=e[C];if(n.tb(S.solutionId)){let ja=String.format("Found an override, solutionId: {0}",S.solutionId);const ya=n.K(S.solutionId);ya&&(isNaN(ya.addinInfo.priority)||(ja=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ja,S.addinInfo.priority,ya.addinInfo.priority),S.addinInfo.priority=ya.addinInfo.priority),isNaN(ya.addinInfo.AUP)||(ja=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ja,S.addinInfo.AUP,
ya.addinInfo.AUP),S.addinInfo.AUP=ya.addinInfo.AUP),ya.displayName&&(ja=String.format("{0}; DisplayName: update {1} to {2}",ja,S.displayName,ya.displayName),S.displayName=ya.displayName),ya.iconUrl&&(ja=String.format("{0}; IconUrl: update {1} to {2}",ja,S.iconUrl,ya.iconUrl),S.iconUrl=ya.iconUrl),ya.description&&(ja=String.format("{0}; Description: update {1} to {2}",ja,S.description,ya.description),S.description=ya.description));n.remove(S.solutionId);this.LJa&&E.ULS.sendTraceTag(509379136,220,50,
"ApplyOverridesToPopularAddinDetails: {0}.",ja)}}for(const S of n.keys)C=n.K(S),C.displayName&&C.iconUrl&&C.addinInfo&&(e.push(C),this.LJa&&E.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(C)))}oUc(){const e=new je.a(Pg.a.vh());let n=this.Aa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!n)return e;n=n.trim();if(12>=n.length)return 0<n.length&&E.ULS.sendTraceTag(509379106,220,
10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",n),e;this.LJa&&E.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",n);try{const C=[],S=n.split("|");for(let ja=S.length-1;0<=ja;ja--){const ya=S[ja],kb=ya.split("\\");if(2>kb.length){C.push(ya);continue}const Rb=rj.Igd(kb);Rb?e.tb(Rb.solutionId)||e.add(Rb.solutionId,Rb):C.push(ya)}this.LJa&&0<C.length&&E.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
C.join("|"));this.LJa&&0<e.count&&E.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",e.count,JSON.stringify(Zi.toArray(e.values)));return e}catch(C){E.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",n,C.toString())}return e}Q0c(e){for(let n=0;n<e.length;n++)Mf.c(e[n].iconUrl.toLowerCase(),"http",0)||(e[n].iconUrl=String.format("{0}/image/apps.{1}",this.$Ic,e[n].iconUrl))}static Wtb(e){return 0===
e||10===e}static ylf(e,n){const C={};C.collectionType=af[e];C.queryResult="null";C.queryStart=n;C.queryDuration=window.performance.now()-n;return Object.assign(new Fn(e,3),{Gj:Error.create("QueryAddinDetails hit an invocation failure",C)})}static vLb(e,n,C){const S={};S.collectionType=af[e];e=new Fn(e,n);0!==n&&(e.Gj=Error.create(C,S));return e}static Rmb(e){return rj.vLb(e,2,"The store is disabled.")}static nlf(e){const n={};n.collectionType=af[e];n.invokeResultCode=-2147208619;n.queryDuration=0;
return Object.assign(new Fn(e,3),{Gj:Error.create("Anonymous users do not have installed add-ins.",n)})}static v3c(e){return e.Gj?e.Gj.invokeResultCode:-1E3}fcd(e,n,C){const S={};S.AddinCollectionType=af[e];S.ErrorCode=n.errorCode;S.AddinCount=n.value?n.value.length:0;e=window.performance.now();n=Date.now()-G.AFrameworkApplication.YK;E.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",C,e,n,JSON.stringify(S))}ecd(e,
n,C){this.gcd?(C={["AddinCollectionType"]:af[e],["ErrorCode"]:n.errorCode,["QueryDuration"]:C,["FlyoutDataReadySinceBoot"]:Date.now()-G.AFrameworkApplication.YK},this.i9c(e)&&E.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(C)),C.AddinCount=n.value?n.value.length:0,E.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(C))):this.fcd(e,n,C)}i9c(e){0===e?this.NV|=1:1===e&&(this.NV|=2);e=this.NV&131;if(e=1===e||2===e)this.NV=255;return e}static Ndc(e,n){const C={};
C.errorCode=e;C.value=n;return C}static Pzc(e){return e===OSF.StoreTypeEnum.MarketPlace?"omex":e===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static $ub(e,n){n.solutionId=n.solutionId||e.solutionId;n.version=n.version||e.version;n.storeType=n.storeType||e.storeType;n.storeId=n.storeId||e.storeId;n.assetId=n.assetId||e.assetId;n.assetStoreId=n.assetStoreId||e.assetStoreId;n.displayName=n.displayName||e.displayName;n.provider=n.provider||e.provider;n.description=n.description||e.description;
n.iconUrl=n.iconUrl||e.iconUrl;n.webApplicationId=n.webApplicationId||e.webApplicationId;n.highResolutionIconUrl=n.highResolutionIconUrl||e.highResolutionIconUrl;n.licenseUrl=n.licenseUrl||e.licenseUrl;n.privacyUrl=n.privacyUrl||e.privacyUrl;n.addinInfo=n.addinInfo||e.addinInfo;isNaN(n.targetType)&&(n.targetType=e.targetType);isNaN(n.height)&&(n.height=e.height);isNaN(n.width)&&(n.width=e.width);return n}static x6k(e){const n=Array(e.length);for(let C=0;C<n.length;C++)n[C]=new rp(e[C],e[C].addinInfo);
return n}static iTc(e){for(const n of e)isNaN(n.targetType)&&(n.targetType=1),n.assetId=n.assetId||n.solutionId,n.storeId=n.storeId||"en-US",n.storeType=n.storeType||"omex",n.assetStoreId=n.assetStoreId||"omex",isNaN(n.width)&&(n.width=0),isNaN(n.height)&&(n.height=0)}static Igd(e){const n={};let C=0;C<e.length&&0<e[C].trim().length&&e[C].trim().toLowerCase().startsWith("wa")&&(n.solutionId=e[C].trim(),n.addinInfo=Object.assign(new Wf,{priority:Number.NaN,AUP:Number.NaN}),++C<e.length&&0<e[C].trim().length&&
(n.addinInfo.priority=parseInt(e[C].trim())),++C<e.length&&0<e[C].trim().length&&(n.addinInfo.AUP=parseInt(e[C].trim())),++C<e.length&&0<e[C].trim().length&&(n.displayName=e[C].trim()),++C<e.length&&0<e[C].trim().length&&(n.iconUrl=e[C].trim()),++C<e.length&&0<e[C].trim().length&&(n.description=e[C].trim()));return n.solutionId?n:null}static r3c(e,n){e=e.jb("AddinImageStoreServiceUrl");if(!e)return n;e=e.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")?e:n}}Object(F.a)(rj,"AddinDetailsManager2",
null,[1216]);class tk{constructor(e,n){this.Stc="popular";this.ZPh="addinDetails";this.ZYh="cache-lastUpdate";this.VXh="builtin-lastUpdate";this.utj=144E5;this.Aa=this.Zca=null;this.yVn=(C,S)=>{2===S.xT&&0===S.errorCode&&(this.Wlf=S.BB,this.QTd=this.now,E.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};this.Zca=n;this.Aa=e;this.Zca.gNa(this.yVn);this.utj=this.Aa.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",
144E5)}get pqn(){return this.QTd?this.now.getTime()-this.QTd.getTime()>=this.utj:!0}cX(e){var n=this.Zca.cX(e);2===e&&this.oqn(n.errorCode)&&(e=this.Wlf,null!=e?(this.pqn&&this.Zca.tYb(null,null),n=this.toDateString(this.now),n=this.toDateString(this.Elf)===n?this.klf(5,this.Zca.ITd):this.klf(0,e)):(tk.aBa&&(n=this.klf(5,this.Zca.ITd)),this.Elf=this.now,this.Zca.tYb(null,null)));return n}klf(e,n){return Object.assign(new zh(e),{BB:n,Gj:null})}toDateString(e){return e.toISOString().substring(2,16)}get Elf(){const e=
tk.W1b(this.Stc,this.VXh);return null!==e?new Date(e):new Date(0)}set Elf(e){tk.uAb(this.Stc,e.toISOString(),this.VXh)}get QTd(){const e=tk.W1b(this.Stc,this.ZYh);return null!==e?new Date(e):new Date(0)}set QTd(e){tk.uAb(this.Stc,e.toISOString(),this.ZYh)}get Wlf(){const e=tk.W1b(this.Stc,this.ZPh);let n=null;e&&(n=JSON.parse(e));return n}set Wlf(e){e=JSON.stringify(e);tk.uAb(this.Stc,e,this.ZPh)}get now(){return new Date}oqn(e){return 2!==e&&4!==e}z8a(e,n=null){return this.Zca.z8a(e,n)}gNa(e){this.Zca.gNa(e)}get name(){return"AddinDetailsCacheManager"}ZYb(e,
n){this.Zca.ZYb(e,n)}iS(e,n=!1){this.Zca.iS(e,n)}static W1b(e,n){let C=null;try{const S=tk.hrd;if(void 0!==S&&S){const ja=$b.a.Yic(e)+"_"+n;C=S.getItem(ja)}else E.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(S){E.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",e,n)}return C}static uAb(e,n,C){try{const S=tk.hrd;if(void 0!==S&&S){const ja=$b.a.Yic(e)+"_"+C;S.setItem(ja,n)}else E.ULS.sendTraceTag(508352217,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(S){E.ULS.sendTraceTag(508352216,220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",e,C)}}static get hrd(){if(!tk.aBa)return null;let e=null;try{e=localStorage}catch(n){tk.aBa=!1,e=null,E.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${n.name}; message: ${n.message}; stack: ${n.stack}`)}return e}}tk.aBa=!0;Object(F.a)(tk,"AddinDetailsCacheManager",null,[1217]);class fp{static createInstance(e,
n,C=null){e=fp.roc(e)?fp.Zff(e)?new tk(e,new rj(e,n,C)):new Si(e,n,C):new sk(e,n,C);E.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${e.name}`);return e}static roc(e){return(e||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static Zff(e){return(e||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(F.a)(fp,
"AddinDetailsManagerFactory",null,[]);class mj{constructor(e){this.U6e=e}next(e){this.U6e=(9301*this.U6e+49297)%233280;return Math.floor(this.U6e/233280*e)}}Object(F.a)(mj,"Random",null,[]);var xs=d(1725),qr=d(647);class Up{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(F.a)(Up,"GallerySectionProps",null,[]);var dr=d(1896);class Fi{constructor(){this.text=this.href=null}}Object(F.a)(Fi,"LinkProps",null,[]);var bo=d(1726),gp=d(180);class ci{constructor(e,
n){this.TEh=!0;this.mPk=e;this.nPk=n}J5i(){null==Ac.a.instance.getItem("AddinEntryPointSurveyShowed")&&this.TEh&&(this.TEh=!1,window.setTimeout(()=>{this.OGh=gc.a.instance.Ta("Common.ISystemInitiatedFeedback");null!=this.OGh&&this.OGh.execute(e=>{const n=this.UIf();this.Qim()||n&&(!n||"hidden"!==n.visibility)||(e.meb(this.mPk,null),Ac.a.instance.setItem("AddinEntryPointSurveyShowed","1"))})},this.nPk))}UIf(){let e=null;try{const n=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");n&&(e=
gp.a.WB(n.parentNode.parentNode.parentNode))}catch(n){E.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(n?n.toString():""))}return e}Qim(){let e=null;try{e=document.getElementById("BackstageGetAddIns")}catch(n){E.ULS.sendTraceTag(508343956,220,10,"Backstage get parent and parent get exception "+(n?n.toString():""))}return e}}Object(F.a)(ci,"FpsHelper",null,[]);class Mm{constructor(e,n,C,S,ja,ya=null,kb=null){this.zSe={};this.PDk={};this.OBd={};this.Lfh=this.Zih=
0;this.HBd=null;this.cwk=6E4;this.jMa=(Rb,sc)=>{this.ema?this.Mvo(sc):(this.Wjd(sc),this.qgb&&this.qgb.jMa(Rb,sc))};this.c1a=n;this.L3a=null;this.dDk=C;this.fDk=S;this.lMk=ja;this.qgb=kb;this.Aa=ya||G.AFrameworkApplication.J;this.c1a.gNa(this.jMa);appChrome.addInApi.loadOfficeAddInIcons()}get crf(){return this.OBd}Wjd(e){if(e.BB)for(let n=0;n<e.BB.length;n++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+e.BB[n].solutionId,e.BB[n].iconUrl);else 0===e.errorCode&&E.ULS.sendTraceTag(509687429,
220,10,"addinDetails is null which will lead to no icons registered")}get eVl(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get ema(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}get Q0b(){return!!this.Aa&&this.Aa.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}H0h(){if(this.YVh)return!0;
let e=this.c1a.cX(0);if(1!==e.errorCode)return!0;e=this.c1a.cX(1);return 1!==e.errorCode}nco(e){const n=[];var C=new mj((new Date).getDate());for(var S=0;30>S;S++)Array.add(n,C.next(e.count));C=0;for(const ja of e){S=!1;for(const ya of n)if(C===ya){S=!0;break}C++;if(S){let ya;(ya=ja.addinInfo).AUP=20*ya.AUP}else if(1===ja.addinInfo.priority){let ya;(ya=ja.addinInfo).AUP=4*ya.AUP}else if(2===ja.addinInfo.priority){let ya;(ya=ja.addinInfo).AUP=2*ya.AUP}}e.Sc((ja,ya)=>ja.addinInfo.AUP<ya.addinInfo.AUP?
1:-1);return e}qum(){const e={},n={},C={};n.root={margin:"0px","margin-left":"12px",width:"100%",maxWidth:"unset"};n.inner={margin:"-4px","margin-left":"18px"};C.root={width:100,height:100,backgroundColor:"transparent"};C.flexContainer={flexDirection:"column"};C.label={"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"};e.galleryButtonInExpanded=C;e.galleryStack=n;return e}tfm(){return Object.assign(new dr.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",
Icon:"AllApps_16",Command:this.lMk,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid var(--border-color, #c8c8c8)","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}Yem(e,n,C){const S={},ja={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid var(--border-color, #c8c8c8)"};
G.AFrameworkApplication.isRtl&&(ja.direction="ltr");S.root=ja;return Object.assign(new dr.a,{Id:C,ExternalId:C,Icon:"AddinFlyoutControl"+n.solutionId,Command:e===CommonUIStrings.l_PopularAddins?this.dDk:this.fDk,LabelText:n.displayName,Role:"menuitem",FullIconStyle:S,Alt:n.description})}Udo(e,n,C){const S=Object.assign(new Up,{SectionId:e,GalleryButtons:[]});for(let ja=0;ja<C;ja++)Array.add(S.GalleryButtons,this.Yem(e,n[ja],this.zSe[n[ja].solutionId]));return S}SHm(){var e=[];const n=this.c1a.cX(0);
Array.addRange(e,n.BB);const C=this.c1a.cX(1);Array.addRange(e,C.BB);let S=e.length;e.sort((gd,td)=>{gd=Mf.d(gd.displayName);td=Mf.d(td.displayName);return Of.a.localeCompare(gd,td)});const ja=3<S;ja&&(S=2);for(var ya=0;ya<S;ya++)this.uXh(e[ya]);let kb=[],Rb=null;this.Q0b||this.ema||!this.L3a?(Rb=this.c1a.cX(2),0!==Rb.errorCode&&5!==Rb.errorCode||Rb.BB.forEach(gd=>{-1!==gd.addinInfo.priority&&(this.uXh(gd),kb.push(gd))})):kb=this.L3a;E.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",
S,rc[n.errorCode],n.BB.length,rc[C.errorCode],C.BB.length,this.Q0b?rc[Rb.errorCode]:"undefined",kb.length);G.AFrameworkApplication.J.isChangeGateEnabled("OfficeVSO:8365528_FlyoutAddinEntryPointDisplayMetrics")&&this.qgb&&this.qgb.E9i("Flyout",S,n,C,Rb);let sc=!0;kb.length||(sc=!1);sc&&(kb=this.ema?this.ePm(kb,e):this.m9k(kb,e),this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.HBd=new ci("AddinFlyoutFeedbackSurvey",this.Aa.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyTriggerTime",
this.cwk)),this.HBd.J5i()));ya=Object.assign(new qb.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});const Fc=Object.assign(new xh.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(ya.ControlList,Fc);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));ya=Object.assign(new Ui.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],
MenuFooterSection:ya,UpdateDynamically:!0,IsFlexLayout:!0});(2===n.errorCode||this.Q0b&&2===Rb.errorCode)&&!e.length?(E.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit"),e=this.XEf("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(ya.MenuSectionList,e)):3===n.errorCode&&3===C.errorCode?(E.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),e=this.XEf("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(ya.MenuSectionList,e)):
this.eVl&&4===n.errorCode&&!e.length?(E.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),e=this.XEf("StoreDisabled",CommonUIStrings.l_AddinPickerServiceDisconnectedError),Array.add(ya.MenuSectionList,e)):(0<S&&this.xDl(ya,e,S,ja),sc&&(this.Lfh=30<kb.length?30:kb.length,Array.add(ya.MenuSectionList,this.ofm(kb,this.Lfh))));this.cql();0===ya.MenuSectionList.length&&(ya.IsFlexLayout=!1,E.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));return ya}Qpl(){const e=
[],n=this.c1a.cX(0);Array.addRange(e,n.BB);const C=this.c1a.cX(1);Array.addRange(e,C.BB);if(2!==n.errorCode||e.length){if(3===n.errorCode&&3===C.errorCode)return E.ULS.sendTraceTag(508360459,220,10,"dataProvider invoke error hit, launch survey fail."),!1;if(4===n.errorCode&&!e.length)return E.ULS.sendTraceTag(508360458,220,10,"dataProvider disconnecteddisabled error hit, launch survey fail."),!1}else return E.ULS.sendTraceTag(508360460,220,10,"store disabled hit, launch survey fail."),!1;return!0}cql(){window.setTimeout(()=>
{var e=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");e&&e.firstChild&&e.firstChild.firstChild&&e.firstChild.firstChild.firstChild&&(e=e.firstChild.firstChild.firstChild.scrollTop,0<e&&(e={["scrollTopValue"]:e.toString()},Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:Ad.a.iI(e)}))))},6E4)}ofm(e,n){const C=Object.assign(new qb.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});
for(var S=0;S<0+n&&S<e.length;S++)this.PDk.PopularAddInsListItem0=e[S].solutionId,this.Eem(C.ControlList,S.toString(),e[S]);if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)){S=[];for(let ja=0;ja<0+n&&ja<e.length;ja++)Array.add(S,e[ja].solutionId);e={["solutionIds"]:S.toString()};Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:Ad.a.iI(e)}))}return C}Eem(e,n,C){n=
this.Csf("PopularAddInsListItem",n,C);Array.add(e,n)}Csf(e,n,C){const S=[];var ja=Object.assign(new Fi,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+C.solutionId});Array.add(S,ja);ja={};ja["default"]="AddinFlyoutControl"+C.solutionId;const ya=this.t1c(C);return Object.assign(new bo.a,{Id:e+n,ExternalId:e+n,CommandId:e+n,CommandIdMapped:"1497204054",iconSet:ja,SecondaryLabel:null,Details:null,Label:C.displayName,ActionText:CommonUIStrings.l_AddinListAdd,
Description:C.description,Links:S,ActionId:e+"Add"+n,ActionIdMapped:"2882601901",ActionCommandValueId:ya,CommandValueId:ya})}t1c(e){return this.ema?String.format("{0}#{1}",e.solutionId,e.storeId):e.solutionId}q4d(e){if(!e)return null;var n=e.split("#");if(1!==n.length&&2!==n.length)return E.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;e=n[0].trim();n=2===n.length?n[1].trim():G.AFrameworkApplication.uiCulture;return this.c1a.z8a(e,n)}uXh(e){if(!(e.solutionId in
this.zSe)){const n="AddinGalleryButton"+this.Zih.toString();this.zSe[e.solutionId]=n;e=this.t1c(e);this.OBd[n]=e;this.OBd[n+"Add"]=e;this.Zih++}}jJi(e){return e?this.OBd[e]:null}XEf(e,n){const C=Object.assign(new qb.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});e=Object.assign(new xs.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:e,Label:n,RetryButtonTitle:"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===e?n:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});
Array.add(C.ControlList,e);return C}m9k(e,n){var C=new fb.a;for(let S=0;S<e.length;S++)C.add(e[S]);if(this.Q0b||!this.L3a)30<C.count&&(C=this.nco(C)),this.L3a=C.toArray();for(e=0;e<this.L3a.length;e++)for(C=0;C<n.length;C++)if(this.L3a[e].solutionId.toLowerCase()===n[C].solutionId.toLowerCase()){Array.remove(this.L3a,this.L3a[e--]);break}return this.L3a}gGm(e){var n=30,C=(new Date).getDate();n>e.length&&(n=e.length);var S=new mj(C);for(C=new Set;C.size<n;){const ja=S.next(e.length);C.add(ja)}for(n=
0;n<e.length;n++)S=e[n].addinInfo,C.has(n)?S.AUP*=20:S.AUP=1===S.priority?4*S.AUP:2===S.priority?2*S.AUP:1*S.AUP;e.sort((ja,ya)=>ja.addinInfo.AUP<ya.addinInfo.AUP?1:-1);return e}ePm(e,n){e=e.filter(C=>!n.some(S=>S.solutionId.toLowerCase()===C.solutionId.toLowerCase()));return this.gGm(e).slice(0,30)}Mvo(e){if(0===e.errorCode||2===e.xT&&5===e.errorCode)e.BB?this.Lvo(e.BB):E.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${af[e.xT]}`)}Lvo(e){var n,C,S,ja;for(let ya=
0;ya<e.length;ya++)e[ya]&&e[ya].solutionId&&e[ya].iconUrl?appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+e[ya].solutionId,e[ya].iconUrl):E.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(C=null===(n=e[ya])||void 0===n?void 0:n.solutionId)&&void 0!==C?C:"null",null!==(ja=null===(S=e[ya])||void 0===S?void 0:S.iconUrl)&&void 0!==ja?ja:"null")}xDl(e,n,C,S=!1){var ja=CommonUIStrings.l_MyAddinSection;const ya=Object.assign(new qb.a,
{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[],Title:ja}),kb=Object.assign(new qr.a,{Id:"MRUAddinsGalleryControl",ExternalId:"MRUAddinsGalleryControl",GalleryStyle:this.qum(),Width:3,Type:4,GallerySections:[]});Array.add(e.MenuSectionList,ya);Array.add(ya.ControlList,kb);e=this.Udo(ja,n,C);S&&Array.add(e.GalleryButtons,this.tfm());kb.GallerySections.push(e)}beo(e){if(e)try{e.MenuItems=this.SHm()}catch(n){E.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+
(n?n.toString():""))}else E.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}get YVh(){return"Dev Box"===G.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse")}}Object(F.a)(Mm,"AppsFlyoutGenerator",null,[10]);var ys=d(981);class di{}di.solutionId="solutionId";di.version="version";di.storeType="storeType";di.storeId="storeId";di.assetId="assetId";di.assetStoreId="assetStoreId";di.displayName="displayName";di.targetType="targetType";di.isAddinCommands="isAddinCommands";
di.height="height";di.width="width";di.sharedRuntimeId="sharedRuntimeId";di.backgroundState="backgroundState";Object(F.a)(di,"InsertAgaveParametersConstantsString",null,[]);class Vp extends Qh.a{constructor(e,n,C,S){super();this.owa="calc(100% - 46px)";this.RPa="15px";this.pwa="0";this.zGc="WACDialogPanel";this.l1=695;this.AGc=462;this.YY="80%";this.QDc=350;this.Igb="100%";this._frame=null;this.Bd=5;this.Ig="AddinInstallDialog";this.h4b=e;this.Uwa=n;this.qRk=C;this.JGk=S}cV(){super.cV();this.Jq.style.width=
this.Igb;this.Jq.style.height=this.owa;this.Jq.style.marginTop=this.RPa;this.Jq.style.padding=this.pwa;document.getElementById(this.Bj("WACDialogButtonPanel")).style.display="none";this.rnb.setAttribute("tabindex","0");$addHandler(this.rnb,"keyup",Object(ic.a)(this,this.aA,"onKeyUp"));const e=document.createElement("iframe");e.setAttribute("id","InstallAddinDialog");e.setAttribute("src","about:blank");e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("marginHeight","0");
e.setAttribute("marginWidth","0");e.setAttribute("frameBorder","0");e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const n=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.h4b,this.Uwa,this.qRk);e.setAttribute("src",n);this._frame=e;$addHandler(e,"load",Object(ic.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(ic.a)(this,this.onMessage,"onMessage"));this.Jq.appendChild(e);
this.Jq.appendChild(this.bGl())}bGl(){const e=document.createElement("div");e.setAttribute("tabindex","0");$addHandler(e,"focus",Object(ic.a)(this,this.s0n,"onLoopPivotFocus"));return e}aA(e){13!==e.keyCode&&32!==e.keyCode||this.hide()}s0n(){this.rnb.focus()}onLoad(){this._frame.focus()}onMessage(e){e=e.rawEvent;if(e.source===this._frame.contentWindow&&(e=(e=e.data)?e.split("|"):null)&&0<e.length&&("REFRESH_REQUIRED"===e[0]||"PRELOAD_MANIFEST"===e[0])){Ac.a.instance.setItem("refreshRequired","true");
const n={};n.solutionId=e[1];n.version=Vp.FSn(e[3]);n.storeType=e[4];n.storeId=e[5];n.assetId=e[6];n.targetType=Vp.xao(e[2]);n.assetStoreId=e[7];n.width=parseInt(e[8]);n.height=parseInt(e[9]);this.JGk(n)}}Nga(){this.Jq.style.width=this.Igb;this.Jq.style.height=this.owa;this.Jq.style.marginTop=this.RPa;this.Jq.style.padding=this.pwa;this.l1>yi.a.pageWidth?(this.Oc.style.width=String.format("{0}px",yi.a.pageWidth),this.Oc.style.overflowX="scroll",G.AFrameworkApplication.isRtl?this.Oc.style.right="0":
this.Oc.style.left="0"):(this.Oc.style.width=String.format("{0}px",this.l1),this.Oc.style.overflowX="hidden");this.Oc.offsetHeight>yi.a.pageHeight||this.AGc+50>yi.a.pageHeight?(this.Oc.style.height=String.format("{0}px",yi.a.pageHeight),this.Oc.style.overflowY="scroll",this.Oc.style.top="0",G.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0",this.Jq.style.minHeight=String.format("{0}px",this.QDc)):(this.Oc.style.overflowY="hidden",this.Oc.style.top="10%",this.Oc.style.height=
this.YY);this.$Ha()}$Ha(){if(this.Oc){var e=this.Oc.style.zIndex;this.Oc.style.zIndex="-9999";if(this.l1>yi.a.pageWidth)G.AFrameworkApplication.isRtl?this.Oc.style.marginRight="0":this.Oc.style.marginLeft="0";else{const n=String.format("{0}px",Math.floor(-this.Oc.offsetWidth/2));G.AFrameworkApplication.isRtl?this.Oc.style.marginRight=n:this.Oc.style.marginLeft=n;G.AFrameworkApplication.isRtl?this.Oc.style.right="50%":this.Oc.style.left="50%"}this.Oc.style.zIndex=String(e)}else E.ULS.sendTraceTag(509871430,
306,10,"_divMessageBox is null in CenterDialog()")}JN(){super.JN();const e=document.getElementById(this.Bj(this.zGc));e.style.width=String.format("{0}px",this.l1);e.style.height=this.YY}get Hob(){return this.Jq}dispose(){super.dispose();$removeHandler(window,"message",Object(ic.a)(this,this.onMessage,"onMessage"))}static xao(e){switch(e){case "1":return 0;case "2":return 1;default:return 0}}static FSn(e){const n=e.split(".");for(let C=0;C<4-n.length;C++)e+=".0";return e}}Object(F.a)(Vp,"AddinInstallDialog",
Qh.a,[]);class zs extends Qh.a{constructor(){super();this.owa="calc(100% - 46px)";this.RPa="15px";this.pwa="0";this.zGc="WACDialogPanel";this.l1=695;this.AGc=462;this.YY="80%";this.QDc=350;this.Igb="100%";this.Bd=5;this.Ig="AppsForOfficeInsertionDialog";this.DQe=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("OfficeAddinEnableInsertDialogAccessibilityFix")}cV(){super.cV();this.Jq.style.width=this.Igb;this.Jq.style.height=this.owa;this.Jq.style.marginTop=this.RPa;this.Jq.style.padding=this.pwa}Nga(){this.Jq.style.width=
this.Igb;this.Jq.style.height=this.owa;this.Jq.style.marginTop=this.RPa;this.Jq.style.padding=this.pwa;this.l1>yi.a.pageWidth?(this.Oc.style.width=String.format("{0}px",yi.a.pageWidth),this.Oc.style.overflowX="scroll",G.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0"):(this.Oc.style.width=String.format("{0}px",this.l1),this.Oc.style.overflowX="hidden");this.Oc.offsetHeight>yi.a.pageHeight||this.AGc+50>yi.a.pageHeight?(this.Oc.style.height=String.format("{0}px",yi.a.pageHeight),
this.Oc.style.overflowY="scroll",this.Oc.style.top="0",G.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0",this.DQe||(this.Oc.style.marginTop="-48px"),this.Jq.style.minHeight=String.format("{0}px",this.QDc)):(this.Oc.style.overflowY="hidden",this.Oc.style.top="10%",this.Oc.style.height=this.YY);this.$Ha()}$Ha(){if(this.Oc){var e=this.Oc.style.zIndex;this.Oc.style.zIndex="-9999";if(this.l1>yi.a.pageWidth)G.AFrameworkApplication.isRtl?this.Oc.style.marginRight="0":this.Oc.style.marginLeft=
"0";else{const n=String.format("{0}px",Math.floor(-this.Oc.offsetWidth/2));G.AFrameworkApplication.isRtl?this.Oc.style.marginRight=n:this.Oc.style.marginLeft=n;G.AFrameworkApplication.isRtl?this.Oc.style.right="50%":this.Oc.style.left="50%"}this.Oc.style.zIndex=String(e)}else E.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}JN(){super.JN();const e=document.getElementById(this.Bj(this.zGc));e.style.width=String.format("{0}px",this.l1);e.style.height=this.YY}get Hob(){return this.Jq}}
Object(F.a)(zs,"AppsForOfficeInsertionDialog",Qh.a,[1211]);var sp=d(789);class Lq extends Qh.a{constructor(e=!0,n=!0,C=null){super();this.owa="calc(100% - 46px)";this.RPa="15px";this.pwa="0";this.zGc="WACDialogPanel";this.l1=695;this.AGc=462;this.YY="80%";this.QDc=350;this.Igb="100%";this.teh=this.ADd=null;this.Mtk="auto";this.Ntk="5px";this.Otk="auto";this.Ltk="40px";this.Kzd="100px";this.BGc="200px";this.Bd=5;this.Ig="SDXDialog";this.Vib=e;this.Y5c=n;this.Bzd=C}cV(){super.cV();this.Jq.style.width=
this.Igb;this.Jq.style.height=this.owa;this.Jq.style.marginTop=this.RPa;this.Jq.style.padding=this.pwa}Nga(){this.Jq.style.width=this.Igb;this.Jq.style.height=this.Vib?this.owa:"100%";this.Jq.style.marginTop=this.Vib?this.RPa:"0px";this.Jq.style.padding=this.pwa;if(this.Vib){this.Kzd&&this.BGc&&(this.l1=parseInt(this.BGc.substring(0,this.BGc.length-2)),this.YY=this.Kzd);this.l1>yi.a.pageWidth?(this.Oc.style.width=String.format("{0}px",yi.a.pageWidth),this.Oc.style.overflowX="scroll",G.AFrameworkApplication.isRtl?
this.Oc.style.right="0":this.Oc.style.left="0"):(this.Oc.style.width=String.format("{0}px",this.l1),this.Oc.style.overflowX="hidden");if(this.Oc.offsetHeight>yi.a.pageHeight||this.AGc+50>yi.a.pageHeight)this.Oc.style.height=String.format("{0}px",yi.a.pageHeight),this.Oc.style.overflowY="scroll",this.Oc.style.top="0",G.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0",this.Jq.style.minHeight=String.format("{0}px",this.QDc);else{this.Oc.style.overflowY="hidden";const e="%"===
this.YY.substring(this.YY.length-1,this.YY.length),n=e?parseInt(this.YY.substring(0,this.YY.length-1)):parseInt(this.YY.substring(0,this.YY.length-2));this.Oc.style.top=e?(100-n)/2+"%":100*(yi.a.pageHeight-n)/yi.a.pageHeight/2+"%";this.Oc.style.height=this.YY}this.$Ha()}else this.Oc.style.left=this.Mtk,this.Oc.style.right=this.Ntk,this.Oc.style.top=this.Otk,this.Oc.style.bottom=this.Ltk,this.Oc.style.width=this.BGc,this.Oc.style.height=this.Kzd,this.Oc.style.overflowX="hidden",this.Oc.style.overflowY=
"hidden"}$Ha(){if(this.Oc){var e=this.Oc.style.zIndex;this.Oc.style.zIndex="-9999";if(this.l1>yi.a.pageWidth)G.AFrameworkApplication.isRtl?this.Oc.style.marginRight="0":this.Oc.style.marginLeft="0";else{const n=String.format("{0}px",Math.floor(-this.Oc.offsetWidth/2));G.AFrameworkApplication.isRtl?this.Oc.style.marginRight=n:this.Oc.style.marginLeft=n;G.AFrameworkApplication.isRtl?this.Oc.style.right="50%":this.Oc.style.left="50%"}this.Oc.style.zIndex=String(e)}else E.ULS.sendTraceTag(524892188,306,
10,"_divMessageBox is null in CenterDialog()")}JN(){super.JN();const e=document.getElementById(this.Bj(this.zGc));e.style.width=String.format("{0}px",this.l1);e.style.height=this.YY}get P9c(){return this.Vib}get Hob(){return this.Jq}get instanceId(){return this.ADd}set instanceId(e){this.ADd=e}get UYc(){return this.teh}set UYc(e){this.teh=e}UTo(e,n){this.Kzd=e;this.BGc=n}}Object(F.a)(Lq,"SDXDialog",Qh.a,[]);var Ak=d(1621),Jr=d(375),Vo=d(94),vq=d(142),rr=d(952);class om{constructor(e,n,C,S,ja,ya,kb,
Rb,sc=null){this.yDc=null;this.Ook=6E4;this.yxd=3E3;this.cJb=!1;this.S4=this.zFb=null;this.q8g=6E4;this.Y7b=!1;this.TMe=3E3;this.SMe=0;this.qgb=this.Zca=this.VGa=null;this.jMa=(Fc,gd)=>{!this.VAj||this.tR?this.Y7b||(this.Y7b=!0,this.Zjd()):2!==gd.xT&&3!==this.Aea&&this.Zjd()};this.tLi=(Fc,gd,td,Bd,wd)=>{if(2!==td)return 32;this.yxd&&(this.cJb=!0);if(!this.ema)return this.wUm(td,wd);if(2!==td)return 32;Fc=wd.Href;gd=this.S4.q4d(this.uOf(wd));if(!gd)return E.ULS.sendTraceTag(508913680,220,10,"Failed to get a valid AddinDetail object in LaunchAddinInstallDialog"),
8;gd=gd.Lzc();gd={["solutionId"]:om.l7(gd)};gd.href=Fc;gd.UILocation=wd.UILocation;Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Ad.a.iI(gd)}));return 32};this.v2f=(Fc,gd,td,Bd,wd)=>{if(!this.ema)return this.mzn(td,wd);if(2!==td)return 32;Fc=wd.SourceControlId;Fc=this.S4.q4d(this.scn?this.uOf(wd):this.S4.jJi(Fc));if(!Fc)return E.ULS.sendTraceTag(509751330,344,10,"No add-in details."),8;Fc=Fc.Lzc();this.kSb(Fc);G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&
(Fc={["solutionId"]:om.l7(Fc)},Fc.UILocation=wd.UILocation,Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Ad.a.iI(Fc)})));return 32};this.iWm=(Fc,gd,td,Bd,wd)=>{if(2!==td)return 32;this.xgc&&(this.cJb=!0);if(!this.ema)return this.jWm(td,wd);if(2!==td)return 32;Fc=this.S4.q4d(wd.CommandValueId);if(!Fc)return E.ULS.sendTraceTag(508913679,344,10,"No add-in details."),8;Fc=Fc.Lzc();this.ZAc("InstalledByListView",41,Fc);this.kSb(Fc);
Fc={["solutionId"]:om.l7(Fc)};Fc.UILocation=wd.UILocation;Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Ad.a.iI(Fc)}));return 32};this.Q4n=()=>{this.yDc=Bb.a("getTheme")?appChrome.api.getTheme():null;this.ek.value.setAppTheme(this.yDc);return this.yDc};this.lYb=(Fc,gd,td,Bd,wd)=>{if(2===td){Fc=wd.callback;if(!Fc)return 16;this.J0i()&&wd.storeType?this.Pwj(Fc,wd.storeType):this.$ko(Fc)}return 32};this.Nto=(Fc,gd,td,
Bd,wd)=>{if(2===td)if(this.wqa)wd&&wd.Observer?this.wqa.gNa(wd.Observer):E.ULS.sendTraceTag(510248469,220,10,"RegisterAddinDetailObserver: invalid actionData: {0}",JSON.stringify(wd));else return E.ULS.sendTraceTag(512231321,220,10,"RegisterAddinDetailObserver: this.AddinDetailsManager is null."),8;return 32};this.qHn=(Fc,gd,td,Bd,wd)=>{2===td&&E.ULS.sendTraceTag(16847762,341,50,String.format("[TellMeForOfficeAddIn-FlyoutRendered]: AppName:{0} | SessionId:{1} | Lcid:{2}",wd.LabelText,G.AFrameworkApplication.userSessionId,
G.AFrameworkApplication.lcid));return 32};this.Fpg=(Fc,gd,td,Bd,wd)=>{2===td&&(Fc=wd.callback)&&this.S0k(Fc);return 32};this.SRi=(Fc,gd,td,Bd,wd)=>{Bd=wd.ownerAddinSolutionId||wd.solutionId;Fc=G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring");td=wd.targetType;Bd=this.Ewd.B4d(Bd);var te=1===td&&Bd&&Bd.settings?Bd.settings:{};Fc||!Bd||om.Qf(Bd.sharedRuntimeId)||(wd.sharedRuntimeId=Bd.sharedRuntimeId,wd.backgroundState=Bd.backgroundState);
const Le=!om.Qf(wd.sharedRuntimeId);var Oe=wd.storeType;const We=wd.ownerAddinStoreType;let Xf;!Fc&&Le?(Xf=wd.ownerAddinSolutionId||wd.solutionId,Oe=We||Oe):Xf=wd.solutionId;const Gg=(new Wc.a(Tj.a.create(),1)).toString();te=new jd.a(Gg,Xf,wd.version,wd.storeId,Oe,te);te.assetId=wd.assetId;te.assetStoreId=wd.assetStoreId;te.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;te.osfControlType=td;te.sharedRuntimeId=wd.sharedRuntimeId;te.backgroundState=Fc?Bd?Bd.backgroundState:te.backgroundState:
wd.backgroundState;te.isPreload=Le&&1===te.backgroundState;void 0!==wd.isAddinCommands&&(te.isAddinCommands=wd.isAddinCommands);void 0!==wd.addinCommandsActionType&&(te.addinCommandsActionType=wd.addinCommandsActionType);te.isAddinCommands&&(te.ownerAddinSolutionId=wd.ownerAddinSolutionId,te.ownerAddinStoreType=We);te.isResizable=!0;te.resizeMinWidth=ys.a.taskPaneWidth;1===td?this.Ybn(te,wd.displayName):0===td&&this.$ca.value.DUf(gd,wd.width,wd.height,te);this.sa.raiseEvent("OnAppForOfficeActivated",
this.gBl(te));return 32};this.$ca=e;this.ek=C;this.Zb=S;this.gq=ja;this.ga=ya;this.Aa=kb;this.Ewd=Rb;this.A7b=sc;this.JFk=!sc;null!=this.Aa&&this.Aa.getIntFeatureGate("DismissAddinFlyoutTime",this.yxd);this.yKb&&(this.wqa?(this.S4=new Mm(this.ga,this.wqa,"3935259562","2544406033","1945259303",this.Aa,this.hNh),this.roc()&&(this.wqa.gNa(this.jMa),this.tR?window.setTimeout(()=>{this.Y7b||(this.Y7b=!0,this.Zjd(),E.ULS.sendTraceTag(508630613,220,15,"Timeout occurs even when the initializer's fix is applied."))},
this.q8g):this.VAj?this.cAf(this.TMe):window.setTimeout(()=>{this.Y7b||(this.Y7b=!0,this.Zjd(),E.ULS.sendTraceTag(509088386,220,15,"AddinDetailsManager not triggered"))},this.q8g))):E.ULS.sendTraceTag(509749262,220,10,"AddinDetailsManger is null"));this.vwa=null;this.Jnk=Object(ic.a)(this,this.ZAc,"userActionHandler");this.sa=new eb.a;this.T3b=this.Jxa=this.Bwh=null;G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorAddinThemeSupportEnabled",!1)&&(this.yDc=Bb.a("getTheme")?
appChrome.api.getTheme():null)}cAf(e){window.setTimeout(()=>{this.Qwo()},e)}get tR(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get xgc(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DismissFlyoutCollectionEnabled",!1)}Qwo(){0===this.Aea?(E.ULS.sendTraceTag(508830284,220,15,"commandRegistrationState: {0}, the 1st attempt was timeout, explicitly call queryAddinDetails.",xb[this.Aea]),this.iS(0,!0),
this.cAf(this.TMe)):1===this.Aea?(E.ULS.sendTraceTag(508830283,220,50,"commandRegistrationState: {0}, wait for queryAddinDetails for a few more seconds to complete.",xb[this.Aea]),this.Aea=2,this.cAf(3*this.TMe)):2===this.Aea?(E.ULS.sendTraceTag(508839687,220,15,"commandRegistrationState: {0}, the 2nd attempt was timeout, register the command anyway and complete.",xb[this.Aea]),this.Zjd()):E.ULS.sendTraceTag(508839686,220,50,"commandRegistrationState: {0}, registration completed.",xb[this.Aea])}get wqa(){this.GRd&&
!this.Zca&&(this.Zca=fp.createInstance(this.Aa,this.ek,{["AppsForOfficeAllowExternalMarketplace"]:this.Aa.$("AppsForOfficeAllowExternalMarketplace"),["AppsForOfficeThirdPartyIsDisabled"]:this.Aa.$("AppsForOfficeThirdPartyIsDisabled"),["AreThirdPartyAddInsAllowed"]:G.AFrameworkApplication.K5a,["PopularAddinDetailsJsonString"]:this.Dwb,["UICulture"]:G.AFrameworkApplication.uiCulture}));return this.Zca}get hNh(){this.Eag&&!this.qgb&&(this.qgb=new Xd(this.Aa,this.wqa,this.xdo));return this.qgb}get ema(){return this.roc&&
this.Zff}get Zff(){return(this.Aa||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}roc(){return(this.Aa||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}get xdo(){return`[{"title":"${CommonUIStrings.l_AddInCategoryTitleWritingFluently}","solutionIds":["wa200001011","wa200000368","wa104381714","wa200002281","wa200005107","wa200003478","wa104380050","wa104380449","wa104380140","wa104380519","wa104380278"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleEducationalPurpose}","solutionIds":["wa104099688","wa104382081","wa104381909","wa104379370","wa200001482","wa200002534","wa104380848","wa200001486","wa104380917","wa104380429"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndDiagrams}","solutionIds":["wa104380121","wa104051163","wa200000113","wa104379279","wa104218065","wa104381063","wa104379997","wa200000729","wa200001486","wa104178141","wa104380118"]}]`}get VAj(){return(this.Aa||
G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}get GRd(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get yKb(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.GRd}get Eag(){return!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",
!1)}get yt(){return this.ek.value}get ubp(){this.VGa||(this.VGa={},this.VGa.InsertAddInsFromBackstage="Backstage",this.VGa.InsertMoreAddInsFromBackstageFooter="InsertMoreAddInsFromBackstageFooter",this.VGa.LaunchMyAddInsFromBackstage="BackstageSeeAll",this.VGa.InsertAddIns="Ribbon",this.VGa.LaunchAddinDialogFromTellMe="TellMe",this.VGa.TeachingCallout="TeachingCallout",this.VGa.AddinFlyoutMoreButton="AddinFlyoutSeeAll",this.VGa.InsertMoreAddInsFromFooter="InsertMoreAddInsFromFooter");return this.VGa}Xb(){this.ga.fb(T.a.Zad,
X.a.frame,Object(ic.a)(this,this.Zad,"launchAppForOfficeDialog"),4);this.ga.fb(T.a.lYb,X.a.frame,this.lYb,96);this.ga.fb(T.a.Oto,X.a.frame,this.Nto,96);this.ga.qa(T.a.Ijp,X.a.frame,this.qHn);this.ga.qa(T.a.Fpg,X.a.frame,this.Fpg);this.ga.qa(T.a.QUf,X.a.frame,this.SRi);this.ga.qa(T.a.oSi,X.a.frame,this.SRi);this.ga.qa(T.a.B1d,X.a.frame,Object(ic.a)(this,this.LVm,"handleExecuteAddinAction"));this.ga.qa(T.a.ZTj,X.a.frame,Object(ic.a)(this,this.xXm,"handleShowExtensionTaskPane"));this.ga.qa(T.a.u3h,X.a.frame,
Object(ic.a)(this,this.YUm,"handleCloseExtensionTaskPane"));this.ga.qa(T.a.LGj,X.a.frame,Object(ic.a)(this,this.iXm,"handleRestartExtensionTaskPane"));this.ga.qa(T.a.Pge,X.a.frame,Object(ic.a)(this,this.rWm,"handleLaunchSDXDialog"));this.ga.qa(T.a.G2l,X.a.frame,Object(ic.a)(this,this.GVm,"handleEnterAddinBackstageAction"));this.yKb&&(this.ga.qa(T.a.Iyn,X.a.frame,Object(ic.a)(this,this.PLi,"handleLaunchAddinInstallDialog")),this.ga.qa(T.a.v2f,X.a.frame,this.v2f),this.roc()||this.ga.qa(T.a.wtj,X.a.frame,
Object(ic.a)(this,this.aMi,"handlePopulateAddInGallery")),this.ga.fb(T.a.Sko,X.a.frame,Object(ic.a)(this,this.dXm,"handleQueryAddInFlyout"),100),this.ga.qa(T.a.NXk,X.a.frame,this.tLi));if(this.Eag||this.yKb)this.ga.qa(T.a.Jyn,X.a.frame,Object(ic.a)(this,this.qWm,"handleLaunchAddinInstallDialogFromList")),this.ga.qa(T.a.pcn,X.a.frame,this.iWm);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorAddinThemeSupportEnabled",!1)&&Bb.a("registerOnThemeChangeCallback")&&
(this.ek.value.setAppTheme(this.yDc),appChrome.api.registerOnThemeChangeCallback(this.Q4n))}Zjd(){this.Aea=3;this.ga.qa(T.a.wtj,X.a.frame,Object(ic.a)(this,this.aMi,"handlePopulateAddInGallery"))}ruj(){return new fb.a}LVm(e,n,C,S,ja){if(2!==C)return 32;e=ja[Ak.a.X_c];if("Action"!==ja[Ak.a.n5h])return 8;n=ja[Ak.a.Qec];C=ja[Ak.a.Zfd];S=C.optionalProperties[Kk.a.ILh];var ya=(ja=this.lLf(ja))?this.f8a(ja):null;ya||(ja=new va.a,ya=C.optionalProperties[Kk.a.taskPaneWidth],0<=ya&&(ja.taskPaneWidth=ya),ja.pV=
C.optionalProperties[Kk.a.pV],ja.sourceLocationOverrideResourceId=C.optionalProperties[Kk.a.sourceLocationOverrideResourceId],ja.QU=C.SYc,ja.onTaskPaneClose=C.optionalProperties[Kk.a.onTaskPaneClose],ja.onExtensionLaunchCallback=C.optionalProperties[Kk.a.onExtensionLaunchCallback],ja.W7c=C.optionalProperties.InstanceToken?C.optionalProperties.InstanceToken:(new Wc.a(Tj.a.create(),1)).toString(),ja.isPreload=!0,ya=ja.W7c,this.E8(e.getId(),ja,!0));return this.OAf(ya,n,S)?32:8}qWm(e,n,C,S,ja){if(2!==
C)return 32;this.xgc&&(this.cJb=!0);return ja&&"LinkClickedPayload"===ja.Type?this.tLi(e,n,C,S,ja):this.PLi(e,n,C,S,ja)}PLi(e,n,C,S,ja){if(2!==C)return 32;e=this.zLm(ja);if(!e)return E.ULS.sendTraceTag(509687395,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;n=this.ek.value?this.ek.value.getAppUILocale()||"en-US":"en-US";this.T3b=new Vp(e,"wac_word",n,ya=>{ya.fromInstallDialog=!0;ya.UILocation=ja.UILocation;this.ZAc("0",3,ya)});this.T3b.Uh("",null,null);return 32}zLm(e){var n=
null;if(!e)return n;if(this.ema){if(e=this.S4.q4d(this.uOf(e)))n=e.solutionId}else n=e.CommandValueId,n=ld.c(n)?this.S4.crf[e.SourceControlId]:n;return n}uOf(e){let n;if(!e)return null;(n=e.CommandValueId)||(n=this.S4.jJi(e.SourceControlId));return n}rWm(e,n,C,S,ja){return 2!==C?32:this.Pge(ja[Ak.a.X_c],ja[Ak.a.Zfd])?32:8}GVm(e,n,C){var S;if(2!==C)return 32;this.ema&&(null===(S=this.hNh)||void 0===S?void 0:S.vtj());this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowBackstageSurveyEnabled",
!1)&&this.S4.Qpl()&&(this.HBd=new ci("AddinBackstageFeedbackSurvey",this.Aa.getIntFeatureGate("Microsoft.Office.SharedOnline.BackstageSurveyTriggerTime",this.Ook)),this.HBd.J5i());return 32}xXm(e,n,C,S,ja){if(2!==C)return 32;e=ja[Ak.a.X_c];n=ja[Ak.a.Qec];ja=ja[Ak.a.Zfd];C=new va.a;S=ja.optionalProperties[Kk.a.taskPaneWidth];0<=S&&(C.taskPaneWidth=S);C.pV=ja.optionalProperties[Kk.a.pV];C.sourceLocationOverrideResourceId=ja.optionalProperties[Kk.a.sourceLocationOverrideResourceId];C.QU=ja.SYc;C.onTaskPaneClose=
ja.optionalProperties[Kk.a.onTaskPaneClose];C.onExtensionLaunchCallback=ja.optionalProperties[Kk.a.onExtensionLaunchCallback];C.showLoadingSpinner=ja.optionalProperties[Kk.a.showLoadingSpinner];C.Qec=n;ja.optionalProperties.InstanceToken&&(C.W7c=ja.optionalProperties.InstanceToken);return this.E8(e.getId(),C,!0)?32:8}dXm(e,n,C){return 2!==C||this.S4.YVh?32:(e=!G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&G.AFrameworkApplication.K5a)&&this.S4&&!this.roc()&&this.S4.H0h()||e&&this.S4?
32:8}aMi(e,n,C,S,ja){if(2!==C)return this.S4.H0h()?32:8;Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.HandlePopulateAddInGallery"}));this.S4.beo(ja);this.xgc&&(this.cJb=!1,this.Rul());return 32}wUm(e,n){if(2!==e)return 32;e=n.Href;var C=n.CommandValueId;C=ld.c(C)?this.S4.crf[n.SourceControlId]:C;if(!C)return E.ULS.sendTraceTag(508887646,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;const S=this.wqa.z8a(C);if(S){const ja={};ja.solutionId=
C;ja.storeType=S.storeType;ja.storeId=S.storeId;ja.assetId=S.assetId;ja.assetStoreId=S.assetStoreId;C={["solutionId"]:om.l7(ja)};C.href=e;C.UILocation=n.UILocation;Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Ad.a.iI(C)}))}return 32}jWm(e,n){if(2!==e)return 32;e=n.CommandValueId;if(!e)return E.ULS.sendTraceTag(509219802,344,10,"No solutionId."),8;const C=this.wqa.z8a(e),S={};if(C)S.solutionId=e,S.version=C.version,S.storeType=
C.storeType,S.storeId=C.storeId,S.assetId=C.assetId,S.assetStoreId=C.assetStoreId,S.targetType=C.targetType,S.displayName=C.displayName,S.width=C.width,S.height=C.height,this.ZAc("InstalledByListView",41,S),this.kSb(S),e={["solutionId"]:om.l7(S)},e.UILocation=n.UILocation,Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Ad.a.iI(e)}));else return E.ULS.sendTraceTag(509219801,344,10,"No add-in details."),8;return 32}Rul(){this.xgc&&
window.setTimeout(()=>{const e=this.UIf();e&&"hidden"==e.visibility&&!this.cJb&&E.ULS.sendTraceTag(508072718,220,15,"Flyout dismiss after {0} seconds without taking any action",this.yxd)},this.yxd)}UIf(){let e=null;try{const n=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");n&&(e=gp.a.WB(n.parentNode.parentNode.parentNode))}catch(n){E.ULS.sendTraceTag(508072717,220,10,"AddinFlyout get parent and parent get exception "+(n?n.toString():""))}return e}YUm(e,n,C,S,ja){return 2!==C?32:(e=this.lLf(ja))?
(this.OTa(e),32):8}iXm(e,n,C,S,ja){if(2!==C)return 32;if(e=this.lLf(ja))if(e=this.ek.value.getOsfControl(e))return e.refresh(),32;return 8}lLf(e){let n=null;const C=e[Ak.a.X_c].getId();e=e[Ak.a.Zfd].optionalProperties[Kk.a.sourceLocationOverrideResourceId];C&&(n=this.v1c(C,e));return n}Ybn(e,n){const C=ja=>{var ya={};ya.solutionId=ja.solutionId;ya.version=ja.version;ya.storeType=ja.storeType;ya.storeId=ja.storeId;ya.assetId=ja.assetId;ya.assetStoreId=ja.assetStoreId;ya.targetType=1;ja=new fb.a;ja.add(ya);
ya={};ya[$b.a.uRd]=ja;ya[$b.a.DHa]=3;this.ga.Qb(T.a.AUb,2,ya)},S=(ja,ya)=>{this.showTaskPane(ja.solutionId,ya,ja);this.$ca&&this.$ca.value&&this.$ca.value.xsb(ja)};G.AFrameworkApplication.J.$("OfficeJsUseExperimentHostJsIsEnabled")&&(e.hostInfoFlags|=8);if(G.AFrameworkApplication.J.$("AddInCommandsIsEnabled"))if(e.isAddinCommands)0===e.addinCommandsActionType?C(e):2===e.addinCommandsActionType?S(e,n):3===e.addinCommandsActionType&&(this.createUILessSandbox(e.solutionId,n,e),this.$ca&&this.$ca.value&&
this.$ca.value.xsb(e));else{const ja={};G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ja.solutionId=e.solutionId,ja.version=e.version):(ja.marketplaceId=e.solutionId,ja.marketplaceVersion=e.version);ja.storeType=e.storeType;ja.storeId=e.storeId;ja.targetData=e;this.K2i(ja,(ya,kb,Rb)=>{Rb=Rb.targetData;kb?C(Rb):S(Rb,n);ya||E.ULS.sendTraceTag(542978529,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Rb.solutionId,
Rb.storeType,Rb.assetId,null,null,Rb.storeId),Rb.storeType)})}else S(e,n)}Zad(e,n,C,S,ja){if(1===C)return G.AFrameworkApplication.K5a?32:8;2===C&&(this.sa.raiseEvent("OnInsertionDialogOpened"),e=ja.SourceControlId,ja=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)?ja.Query:ja.CommandValueId,window.g_InstallOrigin=this.ubp[e]||"Unknown",n=this.I$n(e),G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.TellMeLaunchAddinDialogSetTabIdEnabled")&&
"LaunchAddinDialogFromTellMe"===e&&!om.Qf(ja)?(n.navigationMode=0,n.assetId=ja,this.qpd("{98143890-AC66-440E-A448-ED8771A02D52}",n)):G.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&(this.yKb||this.Eag)?"InsertMoreAddInsFromFooter"===e||"InsertMoreAddInsFromBackstageFooter"===e?(this.qpd("{98143890-AC66-440E-A448-ED8771A02D52}",n),this.xgc&&(this.cJb=!0)):"AddinFlyoutMoreButton"===e?(this.qpd("0",n),this.xgc&&(this.cJb=!0)):this.qpd(null,n):this.qpd(null,n),G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.LogTelemetryForStoreDialog")&&
(ja={["controlId"]:e},Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:Ad.a.iI(ja)}))));return 32}J0i(){return G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.AllowQueryEntitledAppsForSpecificStoreType")}B1d(){return!1}OAf(){return!1}E8(e,n=null,C=!1){if(!G.AFrameworkApplication.v1i(e))return E.ULS.sendTraceTag(527720961,1403,15,"First Party Taskpane blocked: Not in allow list: {0}",e),!1;n||(n=new va.a);n.QU||
(n.QU={});n.QU.ShowFeedback=G.AFrameworkApplication.VE;const S=n.W7c?n.W7c:(new Wc.a(Tj.a.create(),1)).toString();C=new jd.a(S,e,"","",C?"sdxcatalog":"firstparty",null,!1,{showResizeChatButton:n.showResizeChatButton,titleTag:n.w_j});C.activationStart=window.performance.now();C.taskPaneWidth=n.taskPaneWidth;C.sourceLocationOverrideResourceId=n.sourceLocationOverrideResourceId;C.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;C.osfControlType=1;C.onTaskPaneClose=n.onTaskPaneClose;
C.onExtensionLaunchCallback=n.onExtensionLaunchCallback;C.isModernPane=n.isModernPane;C.isResizable=n.isResizable;C.resizeMinWidth=n.resizeMinWidth;C.resizeMaxWidth=n.resizeMaxWidth;C.hostSettings=OSF.OUtil.serializeSettings(n.QU);C.settings=OSF.OUtil.serializeSettings(n.QU);C.featureGates=G.AFrameworkApplication.J.RIf(e);C.sharedRuntimeId=n.sharedRuntimeId;C.isPreload=n.isPreload;C.showLoadingSpinner=n.showLoadingSpinner;C.isPaneAutoOpened=n.isPaneAutoOpened;e=this.v1c(C.solutionId,n.sourceLocationOverrideResourceId);
return this.showTaskPane(e,n.pV,C)}bMb(e,n=null){e=n?this.v1c(e,n.sourceLocationOverrideResourceId):this.v1c(e,null);this.OTa(e)}OTa(){}c3(){return!1}JUi(){return!1}showTaskPane(){return!0}X8d(){return null}ZFf(){return 0}tMj(){}NLh(){}fVj(){}createUILessSandbox(){}f8a(){return null}VNa(e){var n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const C=this.rPb();C&&(3===C.E1c(e)?(n={},n[$b.a.yRd]=e,this.ga.Qb(T.a.VNa,2,n),n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):n=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);
return n}zKa(e){var n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const C=this.rPb();C&&(3===C.E1c(e)?(n={},n[$b.a.yRd]=e,this.ga.Qb(T.a.zKa,2,n),n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):n=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);return n}v0m(e){for(const n of vf.BSm())if(n.value.Ig===e)return n.value.dialog.hide(),n.key;return null}dispose(){this.ek&&this.ek.value&&"undefined"!==typeof this.ek.value.hostCheckReadyHandler&&(G.AFrameworkApplication.RBo(Object(ic.a)(this.ek.value,
this.ek.value.hostCheckReadyHandler,"hostCheckReadyHandler")),E.ULS.sendTraceTag(590943260,1403,100,"ContextActivationManager::HostCheckReadyHandler is unregistered"))}K2i(e,n){this.ek.value.isAddinCommandsAsync(e,n)}pim(){return Object(ic.a)(this,this.ARh,"appForOfficeStatusChangedHandler")}OLh(e){this.ek.value||E.ULS.shipAssertTag(6068437,341,!1,"ContextActivationManager unavailable while trying to activate app: {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||
e.storeType,e.assetId,null,null,e.storeId));this.ek.value.insertOsfControl(e)}pyj(e){this.ek.value?this.ek.value.activateOsfControl(e):E.ULS.shipAssertTag(6431491,341,!1,"ContextActivationManager unavailable while trying to reactivate app: {0}",e)}LNl(e){this.ek.value?this.ek.value.deActivateOsfControl(e):E.ULS.shipAssertTag(6431492,341,!1,"ContextActivationManager unavailable while trying to deactivate app: {0}",e)}mfn(e){return this.ek.value?2===this.ek.value.getOsfControlStatus(e):(E.ULS.shipAssertTag(18114241,
341,!1,"ContextActivationManager unavailable while trying to firgure out if app is active: {0}",e),!1)}rPb(){return null}ZAc(e,n,C=null){if(5===n)this.DBj(!1);else if(6===n)this.DBj(!0);else if(0===n)this.V0h(e,!1),G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb.PBa&&rr.ShyRibbon.cnb(1,0);else if(7===n)this.V0h(e,!0);else if(1===n)this.y6k();else if(2===n)this.kUd();else if(3===n)this.A7b&&this.A7b.hide(),this.yKb&&this.T3b&&this.T3b.hide(),C?(this.zFb=e=this.CTd(C),E.ULS.sendTraceTag(509679069,
220,50,"UserActionEnum.InsertAgave: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",om.l7(this.zFb)),this.yKb&&"fromInstallDialog"in C&&C.fromInstallDialog?this.M$m(e,C):this.kSb(e)):E.ULS.sendTraceTag(17113349,344,10,"InsertAgave: should have valid insert agave parameters");else if(41===n)this.GRd&&C&&(this.zFb=this.CTd(C),E.ULS.sendTraceTag(509674968,220,50,"UserActionEnum.ClickTrust: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",om.l7(this.zFb)));else if(40===n)this.GRd&&this.zFb&&
C&&(e=this.CTd(C),this.H$k(this.zFb,e)&&(E.ULS.sendTraceTag(509679068,220,50,"UserActionEnum.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",om.l7(e)),this.zFb=null,this.iS(0)));else if(36===n)C?this.kSb(this.CTd(C)):E.ULS.sendTraceTag(587579545,344,10,"InsertDevManifest: should have valid insert agave parameters");else if(37===n)e={["ak1"]:this.ek.value.getDevManifestInvalidUrlErrorString(C.manifestUrl)},this.ga.Qb(T.a.v0b,2,e);else if(9===n)G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&
G.AFrameworkApplication.J.$("AddInCommandsLoadedInBootingIsEnabled")&&this.ga.Qb(T.a.zpg,2,C);else if(8===n)e={["ak1"]:this.ek.value.getManifestInvaildErrorString()},this.ga.Qb(T.a.v0b,2,e);else if(13===n||14===n)(C=this.rPb())&&3===C.E1c(e)&&this.ek.value.notifyAgave(e,11);else if(15===n)(e=this.v0m(e))?(C=this.rPb())&&3!==C.E1c(e)&&this.yt.notifyAgave(e,11):(G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.SdxDialogHandleEscKey")&&this.Jxa&&this.Jxa.hide(),this.yKb&&
this.T3b&&this.T3b.hide());else if(23===n)Yd.a.sendOtelEvent(Object.assign(new sp.a,{otelEvent:C}));else if(38===n)Yd.a.sendOtelCustomerContent(Object.assign(new sp.a,{otelEvent:C}));else if(26===n)gn.a.instance.Uyn(C);else if(27===n)(e=C.Id.Id)&&this.OTa(e);else if(32===n){e=this.rPb().qim(C.solutionId);for(const S of e)this.OTa(S)}else n===OSF.AgaveHostAction.CloseSDXDialog&&this.Jxa&&C.InstanceId===this.Jxa.instanceId&&(this.Jxa.hide(),this.Jxa.UYc(C.DialogCloseCallbackParam,!0))}H$k(e,n){return Pg.a.vh().equals(e.solutionId,
n.solutionId)&&Pg.a.vh().equals(e.storeType,n.storeType)&&Pg.a.vh().equals(e.storeType,"OMEX")}ARh(){}jSo(e,n){e!==this.vwa&&(n&&this.blur(),this.ek.value&&(this.ek.value.notifyAgave(e,4),this.vwa=e))}lSo(e){this.ek.value.appHasNotifications(e)&&(this.vwa=null)}v1c(e,n=null){return e?n?String.format("{0}.{1}",e,n):e:""}DBj(e){e?(document.activeElement.blur(),this.gq.W9d(0,null,2,null,null)):(document.activeElement.blur(),this.gq.q5c(0,null,2,null,null));this.vwa=null}y6k(){this.vwa=null}V0h(e,n){this.vwa=
e;const C=this.JNf(e);if(C){var S=this.Zb.ie(C);n&&!this.Zb.getRegion(S.name)&&(n=new Jr.DOMFocusListing(()=>document.getElementById(this.p3c(e))),n.Uga=!0,n.rn(3),n.rn(2),n.rn(1),n=this.Zb.Rqa(()=>document.getElementById(this.p3c(e)),this.Zb.ie(C),n),n.rP=!0,n.AZa(),S.ot(vq.KeyInputManager.oc(Vo.a.pz,0)),S.ot(vq.KeyInputManager.oc(Vo.a.pz,4)));this.Zb.Gg(C)}}p3c(e){return e}blur(){document.activeElement.blur()}lff(e){this.sa.addHandler("OnAppForOfficeClose",e)}x1k(e){this.sa.addHandler("OnInsertionDialogOpened",
e)}Qbb(e,n=!1){n||(this.LNl(e),this.sa.raiseEvent("OnAppForOfficeClose",e));this.$ca&&this.$ca.value&&this.$ca.value.hVl(e);this.vwa=null}JNf(){return null}qpd(e,n){this.JFk&&(this.A7b=new zs);this.A7b.Uh("",null,null);this.ek.value.launchInsertDialog(this.A7b.Hob,e,n)}kUd(){this.A7b.hide()}Pge(e,n){const C=n.optionalProperties.InstanceToken?n.optionalProperties.InstanceToken:(new Wc.a(Tj.a.create(),1)).toString(),S=new jd.a(C,e.getId(),"","","sdxcatalog",null,!1);S.sourceLocationOverrideResourceId=
n.optionalProperties[Kk.a.sourceLocationOverrideResourceId];S.onExtensionLaunchCallback=n.optionalProperties[Kk.a.onExtensionLaunchCallback];S.settings=OSF.OUtil.serializeSettings(n.SYc?n.SYc:{});S.featureGates=G.AFrameworkApplication.J.RIf(e.getId());this.v1c(S.solutionId,S.sourceLocationOverrideResourceId);e=n.optionalProperties[Kk.a.UYc];this.Jxa=new Lq(!0,!0);const ja=n.optionalProperties[Kk.a.dialogTitle];this.Jxa.UTo(n.optionalProperties[Kk.a.dialogHeight],n.optionalProperties[Kk.a.dialogWidth]);
this.Jxa.instanceId=C;this.Jxa.UYc=e;this.Jxa.Uh(ja,null,null);S.div=this.Jxa.Hob;S.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;S.osfControlType=1;this.ek.value.insertOsfControl(S);return!0}kSb(e){this.ga.Qb(T.a.QUf,2,e)}M$m(e,n){this.ga.Qb(T.a.oSi,2,e);G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled")&&(e={["solutionId"]:om.l7(e)},e.UILocation=n.UILocation,Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",
dataFields:Ad.a.iI(e)})))}mzn(e,n){if(2!==e)return 32;e=n.CommandValueId;var C=ld.c(e)?this.S4.crf[n.SourceControlId]:e;if(!C)return E.ULS.sendTraceTag(508913678,344,10,"No solutionId."),8;e={};e.solutionId=C;if(C=this.wqa.z8a(C))e.version=C.version,e.storeType=C.storeType,e.storeId=C.storeId,e.assetId=C.assetId,e.assetStoreId=C.assetStoreId,e.targetType=C.targetType,e.displayName=C.displayName,e.width=C.width,e.height=C.height,this.kSb(e),G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&
(e={["solutionId"]:om.l7(e)},e.UILocation=n.UILocation,Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Ad.a.iI(e)})));else return E.ULS.sendTraceTag(509724485,344,10,"No add-in details."),8;return 32}$ko(e){if(this.J0i())this.Pwj(e,OSF.StoreTypeEnum.MarketPlace);else{const n=new ah;n.callbackFunc=e;n.storeType=OSF.StoreTypeEnum.MarketPlace;n.fromInsertDialog=!1;n.refresh="true"===Ac.a.instance.getItem("refreshRequired");this.ek.value.queryEntitlementDetails(n)}}Pwj(e,
n){const C=new ah;C.callbackFunc=e;C.storeType=n;C.fromInsertDialog=!1;C.refresh="true"===Ac.a.instance.getItem("refreshRequired");this.ek.value.queryEntitlementDetails(C)}I$n(e){const n={navigationMode:0,assetId:null,category:null};if(!e)return n;e=e.split("|");E.ULS.sendTraceTag(16847763,344,50,"LaunchInsertionDialog with parameters: {0}",JSON.stringify(e));if(3>e.length)return n;e[0]&&1===e[0].length&&(n.navigationMode=parseInt(e[0]));e[1]&&0<e[1].length&&(n.assetId=e[1]);e[2]&&0<e[2].length&&
(n.category=e[2]);return n}CTd(e){const n={};n.solutionId=e[di.solutionId];n.version=e[di.version];n.storeType=e[di.storeType];n.storeId=e[di.storeId];n.assetId=e[di.assetId];n.assetStoreId=e[di.assetStoreId];n.targetType=e[di.targetType]?e[di.targetType]:0;n.displayName=e[di.displayName];n.isAddinCommands=e[di.isAddinCommands];n.width=e[di.width]?e[di.width]:0;n.height=e[di.height]?e[di.height]:0;n.sharedRuntimeId=e[di.sharedRuntimeId];n.backgroundState=e[di.backgroundState]?e[di.backgroundState]:
0;return n}gBl(e){return[e.solutionId,e.version,e.storeId,e.storeType,e.osfControlType]}S0k(e){this.sa.addHandler("OnAppForOfficeActivated",e)}q2b(){}REe(){}ZYb(e,n){this.wqa&&(0===this.Aea&&om.Wtb(e)&&(this.Aea=1),this.wqa.ZYb(e,n))}iS(e,n=!1){this.wqa&&(0===this.Aea&&om.Wtb(e)&&(this.Aea=1),this.wqa.iS(e,n))}get Dwb(){return'[{"displayName":"Vertex42 Template Gallery","solutionId":"wa103296784","version":"1.1.0.0","description":"Browse over 300 templates created by Vertex42.com for Excel and Word","iconUrl":"18364.a3e7eafc-7761-4c16-8f90-68c3819a47e4.54117612-5f8b-47b0-a844-684631c459ca.131ca4d3-9ef1-4788-93e9-08aef4a16490.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":-1,"AUP":101}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com","addinInfo":{"priority":2,"AUP":3726}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.5.0.0","description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1529}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","description":"Unlimited access to licensed photos, clipart and your company\u2019s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":3,"AUP":1187}},{"displayName":"DocuSign for Word","solutionId":"wa104218065","version":"4.2.0.0","description":"Enhance productivity by electronically signing or sending any document from Microsoft Word","iconUrl":"18865.cc9ae10a-ba5e-4ca5-8ece-5bf0bbacdeaf.b1c97a18-3e7f-49b2-8024-46db9b8faebd.b566087e-eda0-4453-880e-f47a7d848eb9.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.docusign.com/company/privacy-policy","addinInfo":{"priority":3,"AUP":1970}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":2,"AUP":893}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":534}},{"displayName":"JAGGAER Contract Authoring","solutionId":"wa104379585","version":"3.0.0.0","description":"Author and review contracts faster than ever directly in Word with JAGGAER Contract Authoring.","iconUrl":"559.1462f0c6-f61c-42fe-ad1d-dc4d87b45174.2dc5016b-cdbc-41af-abd9-7c915ae43c4e.06280d94-a345-4639-ae39-da11227674ac.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474843308/Product_42949677815/Asset_52e3d4a8-11b7-420e-802b-a0ff29736a82/JAGGAERMasterAgreementTermsand.doc","privacyUrl":"https://www.jaggaer.com/about/privacy-policy","addinInfo":{"priority":-1,"AUP":244}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":453}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":2,"AUP":2464}},{"displayName":"Lucidchart Diagrams for Word","solutionId":"wa104380118","version":"2.0.0.0","description":"The easiest way to create and insert flowcharts, mockups, UML, mind maps and more in Microsoft Word.","iconUrl":"21470.8707174d-9346-4e3b-89fb-42a1eae7a042.2a02cd8e-edc2-44c8-9dca-10b7e851ac5a.eab30db5-84fe-4e19-b983-6d66f961dcff.png","licenseUrl":"https://lucid.co/tos","privacyUrl":"https://lucid.co/privacy","addinInfo":{"priority":3,"AUP":937}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":916}},{"displayName":"RefWorks Citation Manager","solutionId":"wa104380122","version":"2.1.0.1","description":"Access your reference collection when writing for quick formatting of citations and a bibliography.","iconUrl":"65260.65124d22-f776-49df-bc00-7feb775be86b.9c8232a6-57b5-45f6-9998-520f920cffe1.a28c4b83-5b94-4239-a8b2-1dc4fdf62abd.png","licenseUrl":"https://www.proquest.com/about/terms-and-conditions.html","privacyUrl":"https://www.proquest.com/about/privacy-home.html","addinInfo":{"priority":3,"AUP":3304}},{"displayName":"PDFfiller \u2013 edit your PDFs","solutionId":"wa104380140","version":"1.0.0.0","description":"Instantly add a document from Office365 to PDFfiller! Edit, sign, save, and share anytime, anywhere,","iconUrl":"14229.ae6bc553-5473-4b85-b0ea-714f7ce7f7b9.4763b6eb-4228-47cb-a466-650454ba5fe1.50b4e5e1-1ed9-4d90-9151-3b6be2f4bbb4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.pdffiller.com/en/privacy_policy.htm","addinInfo":{"priority":2,"AUP":216}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":91}},{"displayName":"Fejlretter - Powerful feedback","solutionId":"wa104380429","version":"2.0.0.0","description":"Save time when correcting student assignments with the critically acclaimed feedback tool.","iconUrl":"48038.4a8f5705-cdd6-4d3d-9ea1-eb6001a61fcf.e50840ee-5e4b-445e-8253-d4b06f278dd1.bd226b93-2fc4-4ecd-a04d-950b408fd15d.png","licenseUrl":"https://fejlretter.squarespace.com/betingelser","privacyUrl":"https://fejlretter.squarespace.com/privacy-policy","addinInfo":{"priority":3,"AUP":44}},{"displayName":"officeatwork | Wizard for Office","solutionId":"wa104380519","version":"3.5.0.0","description":"Create personalized documents and insert personalized content with just a few clicks.","iconUrl":"21517.0e251595-714f-4044-bf20-b68cba626477.4a09e61b-6aa7-4911-b267-164255e59dcf.c0787172-1cc0-41f2-8885-5fd04ccf297d.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":3517}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":1926}},{"displayName":"LEAP for Word","solutionId":"wa104380529","version":"3.0.0.0","description":"LEAP for Word helps automate documents and keep them up-to-date.","iconUrl":"11128.dc087b8a-bb43-477e-80a5-4d417ca5c857.dc25a14c-c04d-44cd-ac74-27e3a6537bd0.9630b45c-ae56-4630-8203-50fa08daa9b6.png","licenseUrl":"https://leap.us/terms.html","privacyUrl":"https://www.leap.us/privacy.html","addinInfo":{"priority":-1,"AUP":62}},{"displayName":"FMath Editor","solutionId":"wa104380848","version":"2.1.0.1","description":"Allow users to insert equations into documents.","iconUrl":"21513.6a3c2fa6-ade2-4929-a881-1dd4c188f978.63d347ef-61d0-4ddb-a5af-5102243732ae.0ad9963c-9d43-4f1d-b599-319229de2eda.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://math-on-web.com/privacy_policy.html","addinInfo":{"priority":2,"AUP":169}},{"displayName":"SmartCite for Papers","solutionId":"wa104380917","version":"1.0.1.0","description":"Cite references and generate bibliographies automatically from your ReadCube Papers library!","iconUrl":"37206.29ea90e8-6e48-40d7-a6f6-0e3c479febca.1a063694-e16a-4c0c-a2e9-08030cb75f3f.18a6c2f3-4683-4297-be90-d077e8cc1e08.png","licenseUrl":"https://www.papersapp.com/terms","privacyUrl":"https://www.papersapp.com/privacy","addinInfo":{"priority":3,"AUP":1696}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":-1,"AUP":332}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":-1,"AUP":273}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":2,"AUP":336}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":10474}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":144}},{"displayName":"SiteMap","solutionId":"wa104381519","version":"1.0.0.0","description":"Create SiteMaps and UI flows for Office document","iconUrl":"53703.e16f30a8-c796-46a0-8144-87f78c1714fc.0179cf34-ff8d-44ab-909e-62d8ca7404b7.16f23b12-05ab-4080-b531-395b75fa6046.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://mockflow.com/privacy_policy","addinInfo":{"priority":-1,"AUP":107}},{"displayName":"Stava Rex","solutionId":"wa104381613","version":"3.1.0.0","description":"Stava Rex \u00e4r ett r\u00e4ttstavningsprogram som r\u00e4ttar stavfel och grammatikfel i svensk text.","iconUrl":"6657.d163e868-f594-4452-9c43-a8e27b9d84b7.0033d815-1490-4021-b259-c8d11fa928f7.571b8cbb-7e92-41a2-a8ae-edf3c143c467.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr/tillagg-for-office","addinInfo":{"priority":-1,"AUP":1049}},{"displayName":"Visual Paradigm Online for Office","solutionId":"wa104381637","version":"1.0.0.0","description":"Draw and insert flowcharts, UML, mind maps, BPMN, Venn, ERD, ArchiMate and more in Office documents.","iconUrl":"37179.b19e18e4-8129-4f14-9c5f-94ff9f478a8e.7039006e-f2b2-4482-98db-255ae2f58628.bd478170-6d94-42f7-b043-44f31827a0d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://online.visual-paradigm.com/privacy.jsp","addinInfo":{"priority":-1,"AUP":100}},{"displayName":"SpellRight","solutionId":"wa104381658","version":"3.2.1.0","description":"Advanced spellchecker, specially designed for people with reading and writing difficulties.","iconUrl":"44740.a94c453b-9a33-4274-bbd3-812c98659aa6.6f414cd6-fdfa-4f0d-981d-e4ab7d165a01.d68a7473-2a11-46c9-8fb4-1532d54df637.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr","addinInfo":{"priority":-1,"AUP":612}},{"displayName":"Outwrite - AI Writing Assistant","solutionId":"wa104381714","version":"4.2.0.0","description":"Write better everywhere with Outwrite\'s proofreading and paraphrasing tool","iconUrl":"24265.44fd0c0a-670c-4940-9d4a-ed3b74576b95.005f9722-a130-46d4-8ebf-c65a5bc3ef81.d1dd5745-4742-4a49-86b9-d9cc20daa98e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://outwrite.com/privacy","addinInfo":{"priority":3,"AUP":270}},{"displayName":"LanguageTool","solutionId":"wa104381727","version":"1.0.0.9","description":"Advanced spell and grammar checker","iconUrl":"30578.091db8b2-7164-4fa1-ba0e-12b186fa9d3f.69a95916-c102-4f4e-9fe0-d891c84d0925.9dbc2d81-9492-4743-824a-db1a191f4605.png","licenseUrl":"https://languagetool.org/legal/terms","privacyUrl":"https://languagetool.org/legal/privacy","addinInfo":{"priority":1,"AUP":704}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":-1,"AUP":206}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":2,"AUP":2855}},{"displayName":"PolicyTech\u00ae Tools","solutionId":"wa104382046","version":"1.0.0.5","description":"Insert always up-to-date fields and links into securely stored PolicyTech\u00ae documents","iconUrl":"16192.0cc4c2a8-ba9f-46fd-843f-0da849b0a778.96177cd9-9568-4427-9e9c-3d4f85b12c3a.aafbd44f-5f1b-4745-96cf-86e320c1ab28.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.navexglobal.com/en-us/privacy-statement","addinInfo":{"priority":3,"AUP":1171}},{"displayName":"Mendeley Cite","solutionId":"wa104382081","version":"1.55.1.0","description":"Cite as you write. Generate citations and bibliographies and change your citation style.","iconUrl":"43392.23c5ae3a-3551-42b6-9ba6-5a9ac6c8ade4.14de091f-6544-45e8-b3a6-4a222e2ca359.f3ef8ae0-fa4a-46f7-9f22-7cb0e2e90fcd.png","licenseUrl":"https://www.mendeley.com/terms","privacyUrl":"https://www.elsevier.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":37759}},{"displayName":"Easy Syntax Highlighter","solutionId":"wa200000011","version":"1.0.1.0","description":"Code Syntax Highlighting for Word","iconUrl":"46879.e5d00319-8175-4ba7-9d6e-fdc1ea53abc5.228f1720-24bd-47ed-bbd3-59c73c454e5d.99fe41bb-6c5b-43f9-bc6d-585e984740bc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://app.pyxll.com/word-syntax-highlighter/privacy.html","addinInfo":{"priority":3,"AUP":411}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":1512}},{"displayName":"PERRLA","solutionId":"wa200000199","version":"8.1.0.0","description":"Create perfect APA & MLA papers. We\u2019ve helped students write perfectly formatted papers since 1998.","iconUrl":"7448.ce605f46-4369-4795-8a16-68d19f80e425.1917fc48-bfda-4ecf-9fb8-aa43ce0dbed9.a79b9edf-f0d2-477c-b0c4-ba812278c907.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.perrlacomplete.com/PrivacyPolicy/WordAddIn","addinInfo":{"priority":3,"AUP":1663}},{"displayName":"QuillBot","solutionId":"wa200000368","version":"1.0.0.0","description":"Save time and immediately improve your writing with QuillBot\u2019s Paraphrasing and Summarizing Tool. ","iconUrl":"5821.0c33b03b-ab2a-4712-ba09-d11a2edcbca7.e48cfd16-849a-473d-bfaa-746249630244.a00131df-ab1c-47cc-bef5-8d22f76e49dc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://word.quillbot.com/privacy.html","addinInfo":{"priority":1,"AUP":2949}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":908}},{"displayName":"Grammarly for Microsoft Word","solutionId":"wa200001011","version":"1.2.0.0","description":"Compose clear, mistake-free writing with Grammarly for Microsoft Word on Mac.","iconUrl":"44160.caa10083-95fd-4aa5-9299-a40c68cdc829.9e6b7934-9a4d-4e0f-948d-4f54dafab3f8.df43bd30-714e-4369-803a-00c9491be63b.png","licenseUrl":"https://www.grammarly.com/terms","privacyUrl":"https://www.grammarly.com/privacy-policy","addinInfo":{"priority":1,"AUP":23962}},{"displayName":"Writefull","solutionId":"wa200001482","version":"1.0.5.0","description":"Writefull is automated proofreading for science.","iconUrl":"15661.6e967273-a217-48f5-afd0-9c2b8e777bb9.c564a228-3fcf-4b0c-a7f3-a972b79c328c.25cff90e-9ce9-4a8f-8745-6e60c4b9b659.png","licenseUrl":"https://www.writefull.com/terms.html","privacyUrl":"https://www.writefull.com/privacy.html","addinInfo":{"priority":2,"AUP":400}},{"displayName":"Corinth Screenshots","solutionId":"wa200001486","version":"1.0.0.0","description":"Sync the visual content of the Corinth app with your Office teaching materials","iconUrl":"51869.9a32c413-7910-4eea-8110-596bd8a40a09.a203af63-a892-4e73-b9ad-dcb325ba30f2.16ceca3f-8b79-45b4-8593-4dae5d022848.png","licenseUrl":"https://www.corinth3d.com/EULA","privacyUrl":"https://www.corinth3d.com/corinth-privacy-policy","addinInfo":{"priority":2,"AUP":21}},{"displayName":"Spell checker and Grammar checker by Scribens","solutionId":"wa200001841","version":"1.0.0.0","description":"A powerful spelling and grammar checker. Scribens corrects 250 types of grammar mistakes.","iconUrl":"26848.b2f1ecc7-4017-4115-ae79-09c086924cf5.3c1daf8c-bc5d-4ffb-b4eb-160b11006f27.68175203-816b-48fd-ac79-99d7038badec.png","licenseUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","privacyUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","addinInfo":{"priority":-1,"AUP":255}},{"displayName":"ProWritingAid for Microsoft Word","solutionId":"wa200002281","version":"1.0.0.0","description":"The best writing style and grammar checker for everything you write.","iconUrl":"47676.90dd7d5f-0d94-454f-b4f8-247593fefda6.32a96d9b-d1fb-487e-b93a-532357aec0f1.6355c122-c3b0-4f89-8f7a-e3e9a6c0adff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://prowritingaid.com/en/Home/PrivacyWord","addinInfo":{"priority":2,"AUP":226}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":2517}},{"displayName":"Sciwheel","solutionId":"wa200002534","version":"6.0.0.0","description":"Cite effortlessly and format your bibliography with 7000+ styles, all without leaving Word. ","iconUrl":"53370.9d5750e6-7257-4e5e-9f38-9d2986f4b795.5095e0db-395b-4d89-8298-0231f31340b2.f4c9aecf-00d0-422f-ba8a-40f9991fa55f.png","licenseUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-download-installation-terms-and-conditions/software-license-agreement","privacyUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-privacy-notice","addinInfo":{"priority":2,"AUP":381}},{"displayName":"Citavi Assistant","solutionId":"wa200002891","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"41528.46a7367a-a31d-4175-9c32-fc8e30e8855a.21681137-d1cf-4b73-b8fb-15b7d87b6ef1.72153cd3-7603-49c4-b7d8-6895767a69a6.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":-1,"AUP":391}},{"displayName":"Impression Signatures","solutionId":"wa200003216","version":"1.0.0.0","description":"Securely sign and send documents for signature directly from Word and Excel.","iconUrl":"10171.55569ba6-8707-48a8-b3df-6e6413574914.d131bcfb-dba2-4b50-bccb-a2ad4f770edc.75c9fdcb-00dd-41b7-81f5-2637d24ad344.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.iubenda.com/privacy-policy/8039352/full-legal","addinInfo":{"priority":-1,"AUP":114}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":-1,"AUP":101}},{"displayName":"Wordtune","solutionId":"wa200003478","version":"1.0.0.0","description":"Wordtune helps you rewrite your text into a concise, engaging and well-written message.","iconUrl":"24151.f6b24171-2782-4f28-8af6-e38438631fbe.91ba765d-d20e-4d2e-9486-a3a498a5b3a1.7e060834-f678-403e-8cc9-4b80c9f87d7f.png","licenseUrl":"https://www.wordtune.com/terms-of-use","privacyUrl":"https://www.wordtune.com/privacy-policy","addinInfo":{"priority":1,"AUP":476}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":-1,"AUP":549}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":10144}},{"displayName":"Draft Coach","solutionId":"wa200004257","version":"1.1.121.0","description":"Formative writing feedback for students: available for Turnitin customers","iconUrl":"32351.26374e0d-06e7-47bd-b6cb-0a1e5e54f167.a165e027-3385-42db-bc1e-38bcbb939a51.ffef3075-692f-4d29-a0e2-b1ca1925b0d4.png","licenseUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm#Usage_Policy","privacyUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm","addinInfo":{"priority":3,"AUP":17823}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","description":"Introducing Ghostwriter OpenAI ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":1,"AUP":533}},{"displayName":"Legal AI Assistant","solutionId":"wa200005260","version":"1.0.0.0","description":"This add-in is designed to assist users in generating contracts and adding missing clauses using AI","iconUrl":"63548.f4c25bf7-14f2-46fe-9e82-501e47cf4e22.89c55224-07c3-47f2-ad1c-74f01a5391f8.c3bdc80b-1ae3-468f-adbe-d1bf1206b422.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://e-arbitrator.com/legal-ai-privacy-policy","addinInfo":{"priority":2,"AUP":111}},{"displayName":"GenText AI Assistant","solutionId":"wa200005287","version":"1.0.0.2","description":"GenText is an AI Assistant developed to help business professionals write reports","iconUrl":"39094.562d3128-5997-43ce-aded-f5b52b966432.c9dbaa0c-35ee-443a-8942-03744376197e.97368fc6-d794-4d0e-8282-a96670ef2828.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gentext.ai/privacy","addinInfo":{"priority":2,"AUP":138}},{"displayName":"TrustSigner","solutionId":"wa200005298","version":"1.0.0.0","description":"Sign documents fast, secure and affordable. Made in EU with legal binding.","iconUrl":"24353.f2399955-265f-4d0e-9e27-45e114545472.ebc76c58-2921-4d53-84bc-fefad793b03d.fc65492d-5b37-41f9-aca4-ca5b72c3a5a9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://trustsigner.eu/privacy","addinInfo":{"priority":2,"AUP":23}},{"displayName":"Ghostwriter Consultant Edition","solutionId":"wa200005312","version":"1.5.0.0","description":"Ghostwriter Consultant with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"36233.163ead30-016b-4591-a5b9-f2d2930e5403.bdc1efa7-a706-48f0-baf7-d76c2c5222ef.601d7792-1b34-4021-b4e7-15435a733bf1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":355}},{"displayName":"Dall-e Image Generator","solutionId":"wa200005313","version":"1.0.0.2","description":"Use AI to generate unique and stunning images based on the descriptive text within a document. ","iconUrl":"31431.4f416b91-4c5c-4aa1-b737-8aa50d8c65dc.bde80e16-2c77-4064-9ad7-a99a077ef64a.c508525c-965d-44b5-aec8-deb21c6941df.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.pegamento.nl/en/terms-conditions-text-to-image-extension","addinInfo":{"priority":2,"AUP":56}},{"displayName":"DrillBit-Plagiarism","solutionId":"wa200005339","version":"1.0.0.4","description":"Plagiarism detection software to detect similar or copied content.","iconUrl":"23545.e4fc7991-8bb7-408e-ad63-b9ab3b164d86.5c4bfb60-fbec-489d-a4dd-d294bfea0c0e.d48a04e3-6609-4d98-bcda-7e70107b93bc.png","licenseUrl":"https://drillbitplagiarism.com/termsCondition","privacyUrl":"https://drillbitplagiarism.com/customerHelp","addinInfo":{"priority":2,"AUP":17}},{"displayName":"Ghostwriter Legal","solutionId":"wa200005348","version":"1.5.0.0","description":"Ghostwriter Legal with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"19401.a89bf831-da40-48cb-aea0-9fdb99d2dfb6.24bb5297-c19d-4109-9ddc-4233c6565136.3d1468c5-2f55-4362-815a-846fdf9c7167.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":34}},{"displayName":"Ghostwriter Education","solutionId":"wa200005360","version":"1.5.0.0","description":"Ghostwriter Education with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"64228.96000578-f337-4e2a-9458-bf4f19bfed19.965f3cd0-f0cb-4f83-b18e-a1bba1290eab.8dd5e85f-59af-439e-9136-92bebf18e1d6.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":23}},{"displayName":"Spellbook","solutionId":"WA200004774","version":"1.2.0.0","description":"AI assistant for contract drafting & reviews","iconUrl":"https://store-images.s-microsoft.com/image/apps.2248.98a244f3-017a-4ff1-9a57-51c9bcb8dc52.3da7c824-0fd2-42df-9da5-5512230625d7.0dbc3752-ca78-4b17-a8be-82dc9cd273e7.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://spellbook.legal/privacy-policy","addinInfo":{"priority":3,"AUP":320}},{"displayName":"GPTZero","solutionId":"WA200005444","version":"1.0.0.0","description":"GPTZero detects AI-generated text right inside Word. Just highlight and get results!","iconUrl":"https://store-images.s-microsoft.com/image/apps.50366.6301eda2-a871-4076-b79c-e43711f93b87.450815d6-a39d-4d11-8105-54c6a6fcf733.6a7be30c-a1db-4b14-834e-4b6d149bb1fa.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gptzero.me/privacy-policy.html","addinInfo":{"priority":1,"AUP":227}}]'}get scn(){return!!this.Aa&&
this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserInstalledAddinCommandValueIdEnabled",!0)}get Aea(){return this.SMe}set Aea(e){E.ULS.sendTraceTag(508830282,220,50,"commandRegistrationState: {0} --\x3e {1}",xb[this.SMe],xb[e]);this.SMe=e}static Wtb(e){return 0===e||10===e}static l7(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}static Qf(e){return!e||!e.length}}Object(F.a)(om,"AppsForOfficeUIActor",null,[10,1208]);var qn=
d(479),as=d(124),pm=d(34);class oj{constructor(){this.onTabKeyDown=this.onExecute=this.icon=this.label=null}}Object(F.a)(oj,"TaskPaneHeaderButtonProps",null,[]);var Uf=d(768);class si{constructor(e,n,C){this.j7a=C;this.qJh=this.oJh=null;this.QHo=()=>{this.Gzn();this.Sxc(this.qJh,this.oJh)};this.Lnc=S=>S===T.a.yla;this.S1=e;this.XCb=n}mS(e,n){this.qJh=e;this.oJh=n;this.j7a.N_c(this.QHo)}Gzn(){this.XCb=gc.a.instance.Oa("Common.App.ICustomerFeedbackUiWrapper")}Sxc(e,n){e={};n&&(e.query=n.Vg);if(this.S1){const C=
Object.assign(new va.a,{taskPaneWidth:352});G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb&&G.AFrameworkApplication.ua.Gb.yde&&(C.isResizable=!0,C.resizeMinWidth=352,C.resizeMaxWidth=920);switch(n.actionId){case T.a.$5h:e.query="contactsupport";C.pV=WoncaIntl.WoncaStrings.L_ContactSupport;C.sourceLocationOverrideResourceId="Help.ContactSupport.Url";break;case T.a.yla:C.pV=WoncaIntl.WoncaStrings.L_GiveFeedback;C.sourceLocationOverrideResourceId="Help.GiveFeedback.Url";e.feedback=this.Bxi(n);
break;case T.a.i2j:e.query="showtraining";C.pV=WoncaIntl.WoncaStrings.L_Training;break;case T.a.fNg:e.query="whatsnew";C.pV=WoncaIntl.WoncaStrings.L_WhatsNew;break;default:C.pV=WoncaIntl.WoncaStrings.L_Help}C.QU=e;G.AFrameworkApplication.J&&G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackDelayTaskpane")?this.Lnc(n.actionId)?this.aUj("FA000000012",C,n):(C.isModernPane=!0,this.S1.E8("FA000000012",C)):this.S1.E8("FA000000012",C)}}Bxi(e){e=e.rd;G.AFrameworkApplication.J.LQd(e);
e=this.XCb.getContext(e);let n={};"telemetryGroup"in e&&(n=e.telemetryGroup);n.processSessionId=e.sessionId;n.officeBuild=e.build;e.telemetryGroup=n;if(void 0===e.feedbackType||null===e.feedbackType)e.feedbackType=-1;e.disableIncludeScreenshot="disableIncludeScreenshot"in e?e.disableIncludeScreenshot:!1;e.screenshot="screenshot"in e?e.screenshot:!0;e.disableScreenshotPreview=!1;e.includeScreenshotSelectedDefault=!0;return e}aUj(e,n,C,S=300){this.XCb.hif()?(n.QU.feedback=this.Bxi(C),this.S1.E8(e,n)):
this.APl(S).then(()=>{this.aUj(e,n,C,2*S)})}Fsa(){this.S1&&this.S1.bMb("FA000000012")}dispose(){}APl(e){return new Promise(n=>{window.setTimeout(()=>{n(null)},e)})}}Object(F.a)(si,"AgaveAssistancePane",null,[34,10]);class $l{constructor(e){this.NLk=e}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(e,n){this.NLk.spb(e,n)}}Object(F.a)($l,"RichApiEventManagerHost",null,[1146]);class Wp{constructor(){this.eh=new fd.a}YH(e){this.zr(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}zr(e,
n){if(e){var C={};C.Error=n;e(C)}}}Object(F.a)(Wp,"ApiEvent",null,[]);class $f extends Wp{constructor(){super();this.ng=null}}Object(F.a)($f,"WordEditorApiEvent",Wp,[]);class co extends $f{constructor(){super();this.d6e=null}addHandler(e,n,C,S){this.ng&&ld.b(S)?(this.d6e||(this.d6e=new $l(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.d6e)),this.eh.W(e,n),E.ULS.sendTraceTag(41513415,341,50,"Add RichApiMessage event handler for control: {0}.",e),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,
n,C){this.ng&&ld.b(C)&&this.eh.tb(e)?(this.eh.remove(e),E.ULS.sendTraceTag(41513416,341,50,"Remove RichApiMessage event for control: {0}.",e),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}spb(e,n){const C={};C[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData]=n;this.eh.tb(e)&&this.eh.K(e)(C)}c3d(e,n){this.spb(e,[[65536,65539,"",co.VDl(n),-1,!1]])}rDl(e,n){return[[2,1E3,"",JSON.stringify([e,n]),0,!1]]}static VDl(e){const n={};n.visibility=e?"Visible":"Hidden";return JSON.stringify(n)}static get instance(){return null!=
co.eYg?co.eYg:co.eYg=new co}}Object(F.a)(co,"RichApiMessageEvent",$f,[]);class ji{constructor(){this.iconUrl=this.title=this.id=null;this.ufe=this.isVisible=!1;this.vWb=this.t1b=this.gwb=this.yB=null;this.r$d=!1}}Object(F.a)(ji,"ReactAppsForOfficeTaskPaneData",null,[]);var tp=d(1527),Hn=d(507),nk=d(167);class ej{constructor(e,n,C){this.ENc=0;this.Dxa=e;this.ui=n;this.BRg=C}start(){this.ENc||(this.ENc=window.setInterval(()=>{OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.ui.f8a(this.BRg),
ej.uBm,null,(e,n)=>{e?E.ULS.sendTraceTag(591177106,3011,10,"Failed to send message to transcription pane, status: {0}.",e):this.xUm(n)})},ej.XNn))}stop(){this.ENc&&(window.clearInterval(this.ENc),this.ENc=0)}xUm(e){if(e&&e.completedContext){var n;if(({av:n}=Bf.d(e.completedContext)).returnValue&&n)for(e=0;e<n.length;e++)this.dYm(n[e])}}dYm(e){if(e[ej.a8f]&&e[ej.a8f]===ej.bGo&&e[ej.nld]&&e[ej.TFj])this.Dxa.eYm(e[ej.TFj],e).then(n=>{this.vo(e[ej.nld],n)}).catch(n=>{const C={};C[ej.Zki]=n;this.vo(e[ej.nld],
C)});else{const n={};n[ej.Zki]=ej.edn;this.vo(e[ej.nld],n)}}vo(e,n){n[ej.lop]=!0;n[ej.a8f]=ej.hIo;n[ej.nld]=e;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.ui.f8a(this.BRg),ej.u6k,n,C=>{C&&E.ULS.sendTraceTag(591152963,3011,10,"Failed to send message to transcription pane, status: {0}.",C)})}}ej.u6k="onTranscriptionHostMessage";ej.uBm="getNewTranscriptionMessages";ej.lop="transcription_message";ej.a8f="messageType";ej.TFj="requestType";ej.nld="requestId";ej.bGo="request";ej.hIo="response";
ej.XNn=3E3;ej.Zki="error";ej.edn="invalidMessage";Object(F.a)(ej,"TranscriptionAddInMessaging",null,[]);var Wo=d(1038);class Ki{constructor(e,n){this.Ilb=e;this.rDb=n}W6l(e){let n;n=this.X6l(e);0==n.length&&(n=this.V6l(e));return n}V6l(e){if(!this.rDb||!this.rDb.customProperties)return"";var n=this.rDb.customProperties.getItemOrNullObject("StoredTranscription");n=n?n.value:"";if(isNullOrUndefined(n)||0==n.length)return"";E.ULS.sendTraceTag(512522206,3011,50,"Fetched Transcription From Custom property storage");
e(!0);return n}X6l(e){if(!this.Ilb)return E.ULS.sendTraceTag(512522205,3011,10,"CustomXMLManager object is NULL"),"";var n=this.Ilb.w5d("http://schemas.microsoft.com/office/transcription/2022");if(isNullOrUndefined(n)||0==n.length)return"";n=n[0].getValue(hb.a.i7a);if(isNullOrUndefined(n)||0==n.length)return E.ULS.sendTraceTag(512522204,3011,10,"Not able to get the transcription data from XML Node"),"";n=(new DOMParser).parseFromString(n,"text/xml");if(!isNullOrUndefined(n)&&!isNullOrUndefined(n.lastChild)){n=
n.lastChild.textContent;if(isNullOrUndefined(n)||0==n.length)return"";E.ULS.sendTraceTag(512522207,3011,50,"Fetched Transcription From XML Storage");e(!1);return n}return""}}Object(F.a)(Ki,"TranscriptionDocumentStorageManager",null,[]);class kk{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc){this.Ilb=null;this.hxa="TranscriptionPane";this.MHf=()=>{const gd=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse").toLowerCase();return"string"==typeof gd&&gd.includes("inner ring")?
"DOGFOOD":"string"==typeof gd&&gd.includes("outer ring")?"MICROSOFT":"PRODUCTION"};this.i5n=()=>{E.ULS.sendTraceTag(594331858,3011,50,"Transcription pane closed by user.");const gd=this.UIi();gd.PaneOpenDurationInSecs=((performance.now()-this.Dyh)/1E3).toFixed(2);this.R4a.nQo(gd);this.Dyh=0;this.qIh.stop()};this.$4a=e;this.ui=n;this.rDb=C;this.R4a=S;this.Aa=ja;this.CHb=ya;this.$Qk=kb;this.qIh=new ej(this.$Qk,this.ui,kk.hwc);this.eya=Rb;this.Ilb=Fc;this.qJb=sc;this.Yd=Hn.a.getInstance(kk.kop)}load(){E.ULS.sendTraceTag(51667731,
3011,50,"Loading Transcription pane.");this.$4a&&(this.$4a.woc=!0)}UIi(){const e={},n=window.navigator;if(n){const C=n.connection||n.mozConnection||n.webkitConnection;C&&(e.DeviceNetDownLink=C.downlink,e.EffectiveNetworkType=C.effectiveType);e.IsOnline=n.onLine}return e}k$o(e){if(1===e)return 32;E.ULS.sendTraceTag(51667732,3011,50,"User intended to show Transcription Pane.");this.Yd.logKpiUsage({kpiName:this.hxa,kpiType:0});this.Dyh=performance.now();this.R4a.pQo(this.UIi());this.$4a&&!this.$4a.woc&&
this.load();if(!this.ui)return E.ULS.sendTraceTag(51667733,3011,10,"Failed to show Transcription pane, null object of AppsForOfficeUiActor"),this.Yd.logKpiFailure({kpiName:this.hxa,errorName:"FailedToTriggerPaneLaunch"}),16;e=nk.a.get("TeachingUIShowCount");e=parseInt(e);if(isNaN(e)||!isFinite(e))e=0;const n={};n.IsProductionEnvironment=(2===G.AFrameworkApplication.R6).toString();n.TranscriptionSessionId=this.R4a.vaf;n.AugLoopCloudALServiceUrl=this.Aa.jb("AugLoopCloudALServiceUrl");n.DocumentStorageType=
"DocumentXmlStorage";let C=!1;const S=(new Ki(this.Ilb,this.rDb)).W6l(ya=>{C=ya});n.HasStoredTranscription=(0!=S.length).toString();n.StoredTranscription=S;n.IsTranscriptionFetchedFromCustomProperties=C.toString();Object(Wo.b)()?n.MonthlyMinutesUsed=this.qJb.p7c:n.MonthlyMinutesUsed=this.CHb.p7c;n.TeachingUIShowCount=e;n.FrontDoorBaseUrl=this.Aa.jb("DictationFrontdoorDomain");n.DefaultTranscriptionLocale=this.$4a.locale;n.EnableSetAnnotationsFromALVoiceClient=(!!G.AFrameworkApplication.J&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSetAnnotationsFromALVoiceClient",
!0)||G.AFrameworkApplication.J.$("SetAnnotationsFromALVoiceClient"))).toString();n.UnlimitedMins="true";n.ALSessionInitRetryEnabled=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ALSessionInitRetryEnabled",!1)).toString();n.RoamingCallsRetry=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.RoamingCallsRetry",!1)).toString();n.FileSizeUploadLimit=3E8;n.isSharedUXDarkModeOn=
this.NJf().toString();n.UserTenantId=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.jb("TenantId").toString()||"";n.IsTranscriptionNewFlowEnabled=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsTranscriptionNewFlowEnabled",!1)).toString();n.ShouldSkipUpnCheck=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ShouldSkipUpnCheck",!1)).toString();n.EnableFlightAuthVersion=
(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.EnableFlightAuthVersion",!1)).toString();n.UseOfficeJsApiForLanguages=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.UseOfficeJsApiForLanguages",!1)).toString();n.IsAddToDocumentCallbackEnabled=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsAddToDocumentCallbackEnabled",
!1)).toString();n.Audience=this.MHf();const ja=Object.assign(new va.a,{taskPaneWidth:330,isResizable:!0,resizeMinWidth:330,resizeMaxWidth:920,isModernPane:!0,pV:WordEditorIntl.WordEditorStrings.L_TranscriptionPaneTitle,onTaskPaneClose:this.i5n,QU:n,sourceLocationOverrideResourceId:this.DPm()});return this.eya?(this.eya.initialized.then(()=>{ja.QU.IsFreemiumUpsellEnabled=this.eya.isFreemiumUpsellEnabled.toString();ja.QU.IsLicensedUser=this.eya.YYf.toString();this.Goi(ja,!this.eya.isFreemiumUpsellEnabled||
this.eya.YYf)}),32):this.Goi(ja,!0)}NJf(){return Bb.a("isSharedUXDarkModeOn")?appChrome.api.isSharedUXDarkModeOn():!1}DPm(){return"DOGFOOD"==this.MHf()||"MICROSOFT"==this.MHf()?"Taskpane_Dogfood.Url":"Taskpane.Url"}Goi(e,n){this.R4a.RPo(n);if(e=this.ui.E8(kk.hwc,e,!0))this.$4a.HZm=!0;else return this.R4a.qQo(e),E.ULS.sendTraceTag(587309125,3011,10,"Failed to show Transcription pane."),this.Yd.logKpiFailure({kpiName:this.hxa,errorName:"FailedToShowPane"}),16;this.qIh.start();this.Yd.logKpiSuccess({kpiName:this.hxa});
return 32}S0m(e){if(1===e)return 32;E.ULS.sendTraceTag(51667735,3011,50,"User intended to close Transcription pane.");if(!this.ui)return E.ULS.sendTraceTag(51667736,3011,10,"Failed to close Transcription pane, null object of AppsForOfficeUiActor"),this.Yd.logKpiFailure({kpiName:this.hxa,errorName:"FailedToClosePane"}),16;this.ui.bMb(kk.hwc);return 32}Guc(e,n,C,S,ja){if(1===C)return 32;if(!this.ui)return E.ULS.sendTraceTag(51667737,3011,10,"Failed to QueryToggle Transcription pane, null object of AppsForOfficeUiActor"),
16;ja&&(ja[Fa.a.On]=this.ui.c3(kk.hwc));return 32}bAj(){console.log("refreshMinutes minified");Object(Wo.b)()?this.qJb.LOb():this.CHb.LOb()}}kk.hwc="FA000000051";kk.kop={topLevelKpiName:"TranscribeFeatureUsage",featureName:"Transcribe",crewAlias:"VoiceTransEngg",areaName:"ContentCreation"};Object(F.a)(kk,"TranscriptionAddIn",null,[1008]);class kn{constructor(){this.type="EmbeddedTaskPaneProps";this.uniqueID=this.getContent=null;this.isSharedRuntimePane=!1;this.feedbackTaskPaneProps=this.addinSharingTaskPaneProps=
null}}Object(F.a)(kn,"WordAddInTaskPaneProps",null,[]);class bs{constructor(){this.rightActionButtonProps=null;this.canBeShared=!0}}Object(F.a)(bs,"AddinSharingProps",null,[]);class ln{constructor(){this.type="AddinSharingTaskPaneProps";this.assetId=this.sharingLink=this.iconUrl="";this.copySuccessCallback=null}}Object(F.a)(ln,"AddinSharingTaskPaneProps",null,[]);var wq=d(155);class qm{constructor(e,n){this.f3b=n;this.nNe="AppsForOfficeReactContainer";this.Lqk="TaskPaneCloseBtn";this.TMk="TaskPaneRightActionButton";
this.Qok="FA000000012";this.V5=e||Lc.a.instance;this.qn=new fd.a;this.OFa=new fd.a;this.OFa.add("FA000000012","Help");this.OFa.add("FA000000012.Help.GiveFeedback.Url","Feedback");this.OFa.add("FA000000002","Translator");this.OFa.add("FA000000006","Search");this.OFa.add("FA000000029","Editor");this.OFa.add("FA000000085","AcronymsWeb");this.OFa.add(kk.hwc,"Transcription")}f0(e){return this.qn.tb(e)?this.qn.K(e).isVisible:!1}dun(e){return this.qn.tb(e)?this.qn.K(e).ufe:!1}OTa(e){const n=this.qn.K(e);
n.isVisible&&(n.isVisible=!1,n.ufe=!1,sb.UISurfaces.Lv().then(C=>{C.hideTaskPane(n.id,2);return null}))}oBo(e){this.qn.remove(e)}Vkc(e){return this.qn.tb(e)?this.qn.K(e).id:null}showTaskPane(e,n,C,S,ja=null,ya=null){this.V5.iUa();if(this.qn.tb(e))this.qn.K(e).yB.isPaneAutoOpened=C.isPaneAutoOpened,G.AFrameworkApplication.J&&G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackRefreshActivationInfo")&&this.Lnc(e)&&(this.qn.K(e).yB.settings.feedback=C.settings.feedback);
else{var kb=document.createElement("div");kb.className=this.nNe;kb.id=this.nNe+C.id;C.div=kb;kb=String.format("AppForOfficePanel{0}",this.qn.count);let Rb;for(const sc of this.qn.keys)if(Rb=this.qn.K(sc),Rb.id==kb){kb=String.format("AppForOfficePanel{0}|{1}",this.qn.count,C.id);break}this.qn.add(e,Object.assign(new ji,{id:kb,title:n,yB:C,isVisible:!1,gwb:ya,vWb:ja,r$d:!1}))}this.upd(e,S)}dOm(e){return this.qn.tb(e)?this.qn.K(e).yB.backgroundState:Jl.Pae}E_o(e,n){this.qn.tb(e)&&(this.qn.K(e).yB.backgroundState=
n)}X8d(e){return this.qn.tb(e)?this.qn.K(e).yB:null}IUm(e,n){n===OSF.AgaveHostAction.TabExitShift?this.u3d(e):n===OSF.AgaveHostAction.TabExit&&(e=this.qn.K(e),this.isResizable(e)?sb.UISurfaces.Lv().then(C=>{C.focusResizeHandle();return null}):ae.FocusManager.instance().iod(wq.a.Ryc))}S8l(e){if(this.OFa.tb(e))return this.OFa.K(e);for(const n of this.OFa.keys)if(!e.indexOf(n))return this.OFa.K(n);return null}u3d(e){(e=this.qn.K(e).t1b)&&e.querySelector("[data-unique-id^='"+this.Lqk+"']").focus()}getContent(e){return()=>
this.qn.K(e).yB.div}qgm(e){return this.qn.K(e).yB}getAssetId(e){const n=this.qn.K(e).yB,C=/^WA\d{9}/i;let S;C.test(n.ownerAddinSolutionId)?S=C.exec(n.ownerAddinSolutionId)[0]:C.test(n.solutionId)?S=C.exec(n.solutionId)[0]:C.test(n.assetId)?S=C.exec(n.assetId)[0]:C.test(n.storeId)?S=C.exec(n.storeId)[0]:C.test(e)&&(S=C.exec(e)[0]);return S}$Hi(e,n,C,S){return()=>{Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Extensibility.Host.AddinSharing",dataFields:[{name:"AssetId",string:Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,
e.storeType,n,null,null,e.storeId)},{name:"ActionType",string:C},{name:"CorrelationId",string:S}]}))}}upd(e,n){const C=this.qn.K(e).id,S=ja=>{ja=this.qn.K(ja).t1b.querySelector("[data-unique-id^='"+this.TMk+"']");this.qAb(ja)};sb.UISurfaces.Lv().then(ja=>{n?ja.doNotUse_InitializePersistedTaskPane(C,this.LB(e,n)):(this.qn.K(e).isVisible?ja.setSelectedTaskPane(C):ja.showTaskPane(C,this.LB(e)),this.qn.K(e).yB.isPaneAutoOpened||(this.Lnc(e)?(ja=document.getElementById(this.qn.K(e).t1b.id),ae.FocusManager.LN(ja)):
(ja=document.getElementById(this.qn.K(e).yB.id),ae.FocusManager.LN(ja.contentWindow))),G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowAddInSharingTeachingCalloutIsEnabled",!1)&&S(e));return null})}qAb(e){const n=gc.a.instance.Ta("Common.ISystemInitiatedFeedback");n&&e?(e.setAttribute("lpp-id","addInTaskPaneShareButton"),n.execute(C=>{C.logActivity("ShowTeachingCalloutForAddinSharingButton",null);E.ULS.sendTraceTag(526989395,341,50,"triggerLPPActivity triggered an LPP activity")})):
E.ULS.sendTraceTag(526989394,341,15,"triggerLPPActivity failed to get a sifFuture")}LB(e,n=!1){var C=new kn;C.getContent=this.getContent(e);C.uniqueID=this.S8l(e);const S=this.qn.K(e);S.yB.sharedRuntimeId&&(C.isSharedRuntimePane=!0);var ja=this.getAssetId(e);const ya=this.qgm(e),kb=Wc.a.create().Gt.toString();ja&&(C.addinSharingTaskPaneProps={type:"AddinSharingTaskPaneProps",iconUrl:this.qn.K(e).iconUrl,sharingLink:`https://appsource.microsoft.com/product/office/${ja}?ocid=PROD_OfficeApps_CONS_OCMA_ACQ_OfficeOnline_shareViaLinkOnWacWord&correlationId=${kb}`,
assetId:ja,copySuccessCallback:this.$Hi(ya,ja,"copy",kb)});const Rb=new bs;Rb.canBeShared=!!ja;Rb.rightActionButtonProps=ja?{onExecute:this.$Hi(ya,ja,"share",kb)}:void 0;C=Object.assign(new tp.a,Rb,{title:this.qn.K(e).title,titleTag:this.qn.K(e).yB.titleTag,iconUrl:this.qn.K(e).iconUrl,hideHeader:!1,width:this.qn.K(e).yB.taskPaneWidth,location:2,contentProps:C,isModernPane:S.yB.isModernPane,onOpen:sc=>{n||(S.isVisible=!0);this.qn.K(e).t1b=sc;ib.StaticActiveAppFrame.za().Ge()},onClose:()=>{if(!n){S.r$d=
!1;const sc=S.gwb;sc&&sc(e);S.isVisible=!1}ib.StaticActiveAppFrame.za().Ge()},onCloseButtonTabKeyDown:sc=>{if(S.vWb){const Fc=sc.shiftKey?OSF.AgaveHostAction.TabInShift:OSF.AgaveHostAction.TabIn;Fc===OSF.AgaveHostAction.TabIn?this.Lnc(e)?(sc=document.getElementById(this.qn.K(e).t1b.id),ae.FocusManager.LN(sc)):(sc.preventDefault(),S.vWb(e,Fc)):S.r$d||(sc.preventDefault(),sb.UISurfaces.Lv().then(gd=>{this.Fej(gd,S,e,Fc);return null}))}},enableResize:S.yB.isResizable,minResizeWidth:S.yB.resizeMinWidth,
maxResizeWidth:S.yB.resizeMaxWidth,showResizeChatButton:this.qn.K(e).yB.showResizeChatButton,isPaneAutoOpened:S.yB.isPaneAutoOpened||n,onShow:()=>{jh.a.FD&&(this.qn.K(e).ufe=!0,this.f3b.Kse())},onHide:()=>{jh.a.FD&&(this.qn.K(e).ufe=!1,this.f3b.Kse())}});G.AFrameworkApplication.J&&!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddingSharingIsEnabled",!1)&&(C.canBeShared=void 0,C.rightActionButtonProps=void 0,C.contentProps.addinSharingTaskPaneProps=void 0);this.Lnc(e)&&
(ja=JSON.parse(S.yB.settings.feedback),ja={...C.contentProps,type:"OcvFeedbackTaskPaneProps",hideHeader:!1,feedbackTaskPaneProps:{customerUiWrapperFeedbackData:ja,taskPaneLocation:C.location,taskPaneIdToClose:this.qn.K(e).id}},C.contentProps=ja);G.AFrameworkApplication.J&&G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.HeaderIconURL")&&"fa000000125"==e.toLowerCase()&&(C.iconId="fa000000125",C.headerIconUrl="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Blue.svg");
return C}Lnc(e){return this.qn.tb(e)?"Help.GiveFeedback.Url"===this.qn.K(e).yB.sourceLocationOverrideResourceId:!1}q2b(e,n){this.qn.tb(e)&&(this.qn.K(e).title=n,this.q9j(e))}REe(e,n){this.qn.tb(e)&&(this.qn.K(e).iconUrl=n,this.q9j(e))}q9j(e){sb.UISurfaces.Lv().then(n=>{n.updateTaskPane(this.qn.K(e).id,this.LB(e));return null})}p9j(e,n){if(this.qn.tb(e)){const C=this.qn.K(e);C.r$d=!0;sb.UISurfaces.Lv().then(S=>{const ja=this.LB(e);ja.actionButtonProps=n;ja.actionButtonProps.onTabKeyDown=ya=>{ya.shiftKey&&
C.vWb&&(ya.preventDefault(),this.Fej(S,C,e,OSF.AgaveHostAction.TabInShift))};S.updateTaskPane(this.qn.K(e).id,ja);return null})}}Fej(e,n,C,S){2<=e.selectors.getTabbedTaskPaneCount()?e.focusTabbedTaskPaneArea():this.isResizable(n)?e.focusResizeHandle():n.vWb(C,S)}C4c(e){return this.qn.tb(e)?this.qn.K(e).title:null}ZHi(e){return this.qn.tb(e)?this.qn.K(e).iconUrl:null}dispose(){}pDe(e){let n=null;e=e.toLowerCase();for(const C of this.qn.keys){let S=e;C.toLowerCase()!==this.Qok.toLowerCase()&&(S=e.substring(0,
C.length));if(S===C.toLowerCase())return n=C,{returnValue:!0,LUc:n}}return{returnValue:!1,LUc:n}}p3c(e){return this.nNe+e}isResizable(e){return!!e&&!!e.yB&&e.yB.isResizable}}Object(F.a)(qm,"ReactWordEditorAppsForOfficeUIManager",null,[1138]);class mo extends om{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd=null,te){super(e,n,C,S,ja,ya,kb,sc,gd);this.f3b=te;this.Cdm={["fa000000059"]:!0,["FA000000002"]:!0};this.uJd=new fb.a;this.dXl=()=>{for(const Le of this.uJd)this.yfo(Le)};this.Xcf=(Le,Oe,We)=>
{if(2!==We)return Le!==ha.a.kze||this.jTj()?qn.SessionStatusManager.instance.Jk||Uf.a.iba(Oe.Lk)?8:32:16;Oe=this.c3("FA000000002.Ogma.Document.Url")?"FA000000002.Ogma.Document.Url":this.c3("FA000000002.Ogma.Settings.Url")?"FA000000002.Ogma.Settings.Url":"FA000000002.Ogma.Lookup.Url";Le=Le===ha.a.jze?"Ogma.Cdn.Document.Url":Le===ha.a.kze?"Ogma.Cdn.Settings.Url":"Ogma.Cdn.Lookup.Url";Oe!=="FA000000002."+Le&&this.c3(Oe)&&(E.ULS.sendTraceTag(39145870,399,50,"Closing Modern Translator task pane with Office CDN is used"),
this.bMb(Oe));E.ULS.sendTraceTag(39145871,399,50,"Opening Modern Translator task pane with Office CDN is used");Oe={};Oe.Locale=G.AFrameworkApplication.J.jb("ModernTranslatorLocale");Oe.SessionId=G.AFrameworkApplication.userSessionId;Oe.UserId=G.AFrameworkApplication.J.jb("ModernTranslatorLoggableUserId");Oe.MachineId=G.AFrameworkApplication.J.jb("ModernTranslatorMachineId");Oe.AugLoopUrl=G.AFrameworkApplication.J.jb("AugLoopCloudALServiceUrl");Oe.ReadingMode=2===pf.WoncaApp.instance.Dma?"true":"false";
Oe.DocProtected=G.AFrameworkApplication.dV?"true":"false";Oe.DisableEdit=!ka.a.wt||ka.a.fn||ka.a.l3&&G.AFrameworkApplication.qw?"true":"false";Oe.DisableCopyCut=G.AFrameworkApplication.J.$("DisablePrint")&&G.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")?"true":"false";Oe.Reason=(0).toString();Oe.UseGoToTranslatedDocument="true";Oe.MicrofeedbackWacEnabled=G.AFrameworkApplication.J.$("MicrofeedbackSurveyIsEnabled");We=gc.a.instance.Oa("WordEditor.TranslatorRoamingServiceManager");Oe.SettingsEnabled=
We?G.AFrameworkApplication.J.$("LanguageIntelligentSuggestionIsEnabled")&&void 0!==We.i0a&&null!==We.i0a&&""!==We.i0a.trim()?"true":"false":"false";We=new va.a;We.QU=Oe;We.sourceLocationOverrideResourceId=Le;We.pV=WordEditorIntl.WordEditorStrings.L_ModernTranslatorTaskPaneTitle;We.isModernPane=!0;Le=G.AFrameworkApplication.J.$("LanguageTranslationIsEnabled");(Le=this.E8("FA000000002",We,Le))||E.ULS.sendTraceTag(42074889,399,10,"Modern Translator task pane failed to display with Office CDN is used");
return Le?32:16};this.Xre=(Le,Oe,We,Xf,Gg)=>{if(1===We)return 32;Le=this.c3("FA000000002.Ogma.Document.Url")||this.c3("FA000000002.Ogma.Lookup.Url");Gg&&(Gg[Fa.a.On]=Le);return 32};this.Emo=(Le,Oe,We,Xf,Gg)=>{if(1===We)return 32;Gg&&(Gg[gh.a.Visible]=this.jTj());return 32};this.W9o=(Le,Oe,We)=>{if(2!==We)return 32;this.ga.Ob(ha.a.pFj,2);Le=new va.a;Le.pV="Suggested Tasks (Preview)";return this.E8("FA000000030",Le,!0)?32:16};this.tPo=(Le,Oe)=>{co.instance.spb(Le,Oe)};this.gwb=Le=>{const Oe=this.HY.eQb(Le);
tj.xol(Oe);const We=this.Vgi(Oe)||this.OXf(Oe);We&&this.Ls.f0(Le)&&co.instance.c3d(Oe,!1);if(this.Akn(Oe)){const Xf=this.HY.eOm(Oe);Xf&&Xf()}this.Qbb(Oe,We);this.Ls.OTa(Le);this.Zb.bV(this.JNf(Oe));this.f3b.Kse()};this.vWb=(Le,Oe)=>{let We=null;Le&&(We=this.HY.eQb(Le));if(!We)return E.ULS.sendTraceTag(19138189,344,10,"Add-in instanceId not found when pressing {Tab} on close button."),!1;this.yt.notifyAgave(We,Oe);this.vwa=We;return!0};this.HY=Rb;this.rW=Fc;this.Ls=wd||new qm(td,this.f3b)}Xb(){super.Xb();
this.ga.qa(ha.a.B0b,X.a.frame,this.Xcf);this.ga.qa(ha.a.jze,X.a.frame,this.Xcf);this.ga.qa(ha.a.kze,X.a.frame,this.Xcf);this.ga.qa(ha.a.$Uj,Ma.a.view,this.W9o);this.ga.fb(ha.a.Xre,Ma.a.view,this.Xre,96);this.ga.qa(ha.a.pFj,X.a.frame,as.ActionManager.eg);this.ga.fb(ha.a.rxj,X.a.frame,this.Emo,96)}ruj(){const e=this.zJm();this.ozg(()=>{this.requestIdleCallback(this.dXl,0)},mo.eKj);return e}zJm(){var e=!1;const n={};this.uJd.clear();var C=G.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.OEP.SdxAssetIdsToPreload",
"");if(!Of.a.baa(C)){e=!0;for(var S of C.split("_"))n[Of.a.xh(S)]=!0}if(e&&(C=this.mEi(),!ub.a.isEmpty(C))){S=Date.now()-6048E5;for(const ja in C)e=ja,C[ja]>S&&(n[Of.a.xh(e)]=!0)}if(!ub.a.isEmpty(n))for(const ja in n)this.uJd.add(ja);return this.uJd}yfo(e){switch(e){case mo.Ohc:this.xfo();break;case "FA000000002":this.zfo();break;default:this.Hkg(e,new va.a)}}xfo(){const e=Object.assign(new va.a,{pV:"Experimentation SDX",taskPaneWidth:0});this.tUo(e);this.Hkg(mo.Ohc,e)}zfo(){const e=Object.assign(new va.a,
{sourceLocationOverrideResourceId:"Ogma.Cdn.Lookup.Url",sharedRuntimeId:"Ogma.Cdn.Lookup.Url"});this.Hkg("FA000000002",e)}Hkg(e,n){n.isPreload=!0;this.ozg(()=>{this.requestIdleCallback(()=>{this.E8(e,n,!0)},0)},200)}tUo(e){e.sourceLocationOverrideResourceId=mo.eBf;e.sharedRuntimeId=mo.eBf}requestIdleCallback(e,n){let C=!1;try{window.self.requestIdleCallback(e)}catch(S){C=!0}C&&this.ozg(e,n)}ozg(e,n){n=new zg.a(2,1,n,()=>{e()});G.AFrameworkApplication.pc.$b(n)}jTj(){const e=gc.a.instance.Oa("WordEditor.TranslatorRoamingServiceManager");
return!!e&&e.sqn()}c3(e){return this.Ls.f0(e)}JUi(e){return this.Ls.dun(e)}OTa(e){let n=null;({LUc:n}=this.Ls.pDe(e)).returnValue&&this.gwb(n)}OXf(e){if(!e)return!1;e=this.kLf(e);return!!e&&!!e.getSharedRuntimeId()}ZFf(e){return this.Ls.dOm(e)}tMj(e,n){if(this.Ewd&&this.ZFf(e)!=n){var C=this.HY.eQb(e);if(C=(C=this.kLf(C))?C.getSharedRuntimeId():null){var S=this.Ewd.B4d(e);S?(S.sharedRuntimeId=C,S.backgroundState=n,this.Ewd.hSo(S),this.Ls.E_o(e,n)):pm.Debug.ral("No appRef in setAppTaskPaneBackgroundState.",
544318937)}else pm.Debug.ral("Not shared runtime in setAppTaskPaneBackgroundState.",544318859)}}X8d(e){return this.Ls.X8d(e)}B1d(e,n,C){let S=null;return({LUc:S}=this.Ls.pDe(e)).returnValue?(e=this.HY.eQb(S))?this.OAf(e,n,C):!1:!1}OAf(e,n,C){n=co.instance.rDl(n,C);OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(e,n,this.tPo);return!0}hro(e){let n="none";Of.a.baa(e)||(n=Of.a.xh(e.split(".")[0]));if(n in this.Cdm){e=this.mEi();e[n]=Date.now();try{localStorage.setItem("_OSF_Word_Preload_FPA_List",
JSON.stringify(e))}catch(C){}}}mEi(){let e={},n=null;try{n=localStorage.getItem("_OSF_Word_Preload_FPA_List")}catch(C){}Of.a.baa(n)||(e=JSON.parse(n));return e}showTaskPane(e,n,C){let S=null;var ja=({LUc:S}=this.Ls.pDe(e)).returnValue,ya=null;ya=C.isPreload;const kb=C.isForUILessAction||Of.a.xh(e)===mo.Ohc;var Rb=!Of.a.baa(C.sharedRuntimeId);ya?C.initialDisplayMode=1:(this.hro(e),Rb&&(C.initialDisplayMode=kb?1:2));Rb&&(C.hostInfoFlags=1,n||(n=this.Ls.C4c(e)));if(ja){ja=this.HY.eQb(S);if(Rb=this.kLf(ja))C.settings&&
(Rb.setSettings(C.settings),Rb.setHostSettings(C.hostSettings)),n&&G.AFrameworkApplication.J.$("WordEditorAppsForOFficeRefreshTaskPaneTitleIsEnabled")&&"Help.GiveFeedback.Url"!==C.sourceLocationOverrideResourceId&&this.Ls.q2b(S,n);const sc=this.Ls.f0(S),Fc=this.Ls.Vkc(S);this.Vgi(ja)?(this.VWl(ja)&&(E.ULS.sendTraceTag(50685986,344,50,"Reactivating app before showing because it's in an error state."),this.pyj(ja)),sc||(this.Ls.showTaskPane(S,n,C,ya,null,this.gwb),co.instance.c3d(ja,!0))):(sc||this.OXf(ja))&&
this.mfn(ja)?Rb&&(Rb.isFirstParty()&&!this.OXf(ja)&&Rb.refresh(),this.Ls.showTaskPane(e,n,C,kb),co.instance.c3d(ja,!0)):(this.pyj(ja),this.Ls.showTaskPane(S,n,C,kb,null,this.gwb),co.instance.c3d(ja,!0));ya=this.Zb.ie(Fc)}else G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&G.AFrameworkApplication.J.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled")&&!C.isAddinCommands&&(C.virtualOsfControlActivationCallback=()=>{this.gwb(e);this.M2j(C)}),this.Q8h(e,n,C,kb||ya),n=this.Ls.Vkc(e),ya=this.Zb.ie(n),
this.rMh(ya,C.id);ya?(ya.ot(vq.KeyInputManager.oc(Vo.a.pz,0)),ya.ot(vq.KeyInputManager.oc(Vo.a.pz,4))):E.ULS.sendTraceTag(36767389,344,10,"FocusScope should be initialized.");kb||(this.Zb.Gg(this.Zb.QW),this.vwa=null);return!0}NLh(e){const n=()=>{this.Ls.OTa(e.solutionId);this.Zb.Gg(this.Zb.QW);Ac.a.instance.setItem("refreshRequired","true");this.M2j(e);this.Ls.oBo(e.solutionId)};let C=null;const S=e.solutionId;({LUc:C}=this.Ls.pDe(S)).returnValue?this.Ls.f0(C)||this.Ls.showTaskPane(C,"",e,!1):(this.Ls.showTaskPane(S,
"",e,this.txf(S)),this.ek.value.insertBlankControlWithErrorUX(this.Ehd(e),n));this.Zb.Gg(this.Zb.QW);this.vwa=null}fVj(e,n){const C=e.solutionId;this.Ls.showTaskPane(C,"",e,this.txf(C));this.ek.value.insertBlankControlWithErrorUX(this.Ehd(e),()=>{this.Ls.OTa(e.solutionId);this.Zb.Gg(this.Zb.QW);n()});this.Zb.Gg(this.Zb.QW);this.vwa=null}M2j(e){var n={};n.solutionId=e.solutionId;n.version=e.version;n.storeType=e.storeType;n.storeId=e.storeId;n.assetId=e.assetId;n.assetStoreId=e.assetStoreId;n.targetType=
OSF.OsfControlType.ContainerLevel;G.AFrameworkApplication.J.$("AppsForOfficeSharedRuntimeIsEnabled")&&(n.sharedRuntimeId=e.sharedRuntimeId);e=new fb.a;e.add(n);n={};n[$b.a.uRd]=e;n[$b.a.DHa]=3;this.ga.Qb(T.a.AUb,2,n)}Ehd(e){const n={};n.div=e.div;n.id=e.id;n.solutionId=e.solutionId;n.version=e.version;n.storeType=e.storeType;n.storeId=e.storeId;n.osfControlType=e.osfControlType;G.AFrameworkApplication.J.$("AppsForOfficeSharedRuntimeIsEnabled")&&(n.sharedRuntimeId=e.sharedRuntimeId);return n}createUILessSandbox(e,
n,C){this.txf(e)?(this.Q8h(e,n,C,!0),e=this.Ls.Vkc(e),e=this.Zb.ie(e),this.rMh(e,C.id)):C.sharedRuntimeId?this.showTaskPane(e,n,C):(this.OLh(C),this.HY.add(C,e))}f8a(e){return this.HY.eQb(e)}dispose(){super.dispose();this.Ls.dispose()}ZAc(e,n,C=null){if(n===OSF.AgaveHostAction.TabExit||n===OSF.AgaveHostAction.TabExitShift){if(C=this.rPb())3===C.E1c(e)?this.ek.value.notifyAgave(e,OSF.AgaveHostAction.TabIn):(Dk.a.nj&&this.blur(),this.Ls.IUm(this.HY.fVa(e),n))}else if(n===OSF.AgaveHostAction.EnableTaskPaneHeaderButton){const S=
this.HY.fVa(e);C=Object.assign(new oj,{label:C.Label,icon:C.Icon,onExecute:()=>{this.J4n(S)}});this.Ls.p9j(S,C)}else n===OSF.AgaveHostAction.DisableTaskPaneHeaderButton?(C=this.HY.fVa(e),this.Ls.p9j(C,null)):n===OSF.AgaveHostAction.GetOriginalControlId?(e=C.controlId,n=new jg("",C.ownerAddinSolutionId,new Rc,!0),C.originalControlId=null==n?e:n.mci(e)):n===OSF.AgaveHostAction.PageIsReady?this.Bwh&&this.Bwh(e):super.ZAc(e,n,C)}JNf(e){e=this.HY.fVa(e);return this.Ls.Vkc(e)}rPb(){return this.HY}C4c(e){return this.Ls.C4c(e)}ARh(e){if(e){var n=
e.getSolutionId();e=e.getVersion();var C=this.Ls.C4c(n);if(!C||""===C)if(C=OSF.OsfManifestManager.getCachedManifest(n,e)){let S=null;const ja=this.ek.value.getAppUILocale();ja&&""!==ja&&(S=C.getDisplayName(ja));S&&""!==S||(S=C.getDefaultDisplayName());this.Ls.q2b(n,S)}C=this.Ls.ZHi(n);if(!C||""===C)if(e=OSF.OsfManifestManager.getCachedManifest(n,e))e=e.getDefaultIconUrl(),this.Ls.REe(n,e)}}rMh(e,n){e.Nja(()=>{this.jSo(n,Dk.a.nj)});e.w5a(()=>{this.lSo(n)})}VWl(e){if(!this.ek.value)return E.ULS.shipAssertTag(50685987,
341,!1,"ContextActivationManager unavailable while trying to figure out if app is one of the error states: {0}",e),!1;e=this.ek.value.getOsfControlStatus(e);return e!==OSF.OsfControlStatus.Activated&&e!==OSF.OsfControlStatus.NotActivated}Vgi(e){return this.pfn(e)}txf(e){return"FA000000029"===e}Q8h(e,n,C,S){G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&!OSF.OsfControl.isFirstPartyStoreString(C.storeType)?G.AFrameworkApplication.ua&&!G.AFrameworkApplication.ua.Gb.z7(22)&&(e=new Jc.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,
CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),e.id=22,e.image=1,e.closeable=!0,G.AFrameworkApplication.ua.Gb.rya(e,!0)||E.ULS.sendTraceTag(36962447,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user.")):G.AFrameworkApplication.K5a||OSF.OsfControl.isFirstPartyStoreString(C.storeType)?(this.Ls.showTaskPane(e,n,C,S,this.vWb,this.gwb),this.OLh(C),this.HY.add(C,e)):(E.ULS.sendTraceTag(571860445,344,50,"Taskpane web add-in disabled by doc IRM"),
G.AFrameworkApplication.ua&&!G.AFrameworkApplication.ua.Gb.z7(36)&&(e=new Jc.a(CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle,CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage,null),e.id=36,e.image=1,e.closeable=!0,G.AFrameworkApplication.ua.Gb.rya(e,!0)||E.ULS.sendTraceTag(573388438,306,10,"Failed to add entry to business bar. CLP protected doc addins disabled message could not be shown to user.")))}p3c(e){return this.Ls.p3c(e)}J4n(e){let n=null;e&&(n=this.HY.eQb(e));n?(this.yt.notifyAgave(n,
OSF.AgaveHostAction.TaskPaneHeaderButtonClicked),this.vwa=n):E.ULS.sendTraceTag(50738267,344,10,"Add-in instanceId not found when clicking on TaskPaneAction button.")}pfn(e){e=this.HY.SHf(e);return!!e&&"FA000000029"===e.Rn}Akn(e){e=this.HY.SHf(e).storeType.toLowerCase();return e===OSF.StoreType.FirstParty.toLowerCase()||e===OSF.StoreType.Sdx.toLowerCase()}kLf(e){return this.ek.value?this.ek.value.getOsfControl(e):null}q2b(e,n){this.Ls.Vkc(e);this.Ls.C4c(e)!==n&&this.Ls.q2b(e,n)}REe(e,n){this.Ls.Vkc(e);
this.Ls.ZHi(e)!==n&&this.Ls.REe(e,n)}}mo.Ohc="fa000000059";mo.eBf="FA59SharedRuntime.Url";mo.eKj=1E4;Object(F.a)(mo,"WordEditorAppsForOfficeUIActor",om,[]);class no{constructor(e,n){this.ui=e;this.ui.lff(Object(ic.a)(this,this.Rrl,"clearHandlersForApp"));this.Quk=n}get GAf(){return this.Quk}ajc(e){E.ULS.shipAssertTag(5902748,341,!!this.GAf);let n;return({value:n}=this.GAf.Ec(e)).returnValue?n:null}Rrl(e,n){for(const C of this.GAf)C.value&&C.value.removeHandler(n,null)}}Object(F.a)(no,"ApiEventStore",
null,[1215]);var Io=d(632),Nl;(function(e){e[e.m3p=1]="getSelectedDataAsync";e[e.Xlq=2]="setSelectedDataAsync";e[e.OTp=3]="addAppBindingFromSelectionAsync";e[e.NTp=4]="addAppBindingFromNamedItemAsync";e[e.U2p=5]="getDataAsync";e[e.Tlq=6]="setDataAsync";e[e.pVp=7]="bindingSelectionChangedEvent";e[e.W2p=8]="getFileAsync";e[e.$Tp=9]="addTableBindingRowsAsync";e[e.ZTp=10]="addTableBindingColumnsAsync";e[e.VYp=11]="deleteAllDataValuesAsync";e[e.I2p=12]="getAllAsync";e[e.M2p=13]="getByIdAsync";e[e.Xiq=
14]="releaseByIdAsync";e[e.u3p=15]="goToByIdAsync";e[e.Kdj=16]="messageParent";e[e.Glq=17]="sendMessageToDialog";e[e.getAccessToken=18]="getAccessToken";e[e.oVp=19]="bindingDataChangedEvent";e[e.wZp=20]="displayRibbonCalloutAsync";e[e.bmq=21]="setTextAsync";e[e.QTp=22]="addCustomXmlNodeAsync"})(Nl||(Nl={}));Object(F.b)("ApiName",Nl);const nl=(e,n,C,S=null)=>{S||(S={});S.ApiName=Nl[e];S.ApiCode=e;S.AppId=n;S.Result=C;E.ULS.sendTraceTag(17131735,341,50,"{0}",S)};class Ol extends $f{constructor(){super();
this.yK=this.gp=null;this.$cg=(e,n)=>{n.se&&(e=this.RZ.ukm(n.se),this.rci=this.RZ.nim(e),this.gC())};this.rci=new fb.a}get RZ(){this.gp||(this.gp=gc.a.instance.Oa("WordEditor.AppsForOffice.IAppBindingHelper"));return this.gp}set RZ(e){this.gp=e}get N6a(){this.yK||(this.yK=gc.a.instance.Oa("Box4.IContentControlDataChangedManager"));return this.yK}set N6a(e){this.yK=e}addHandler(e,n,C,S=null){this.N6a&&this.RZ?this.RZ.eVi?(this.eh.count||this.N6a.addHandler(Io.a.dZb,this.$cg),this.eh.W(this.M5a(e,S),
n),this.RZ.Fhe(e,S,"Binidng.AddHandler for BindingDataChangedEvent"),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,n,C=null){this.N6a&&this.RZ?this.RZ.eVi?C?this.RZ.j3c(this.eh,this.M5a(e,C))?(this.eh.remove(this.M5a(e,C)),this.eh.count||this.N6a.removeHandler(Io.a.dZb,this.$cg),this.RZ.Fhe(e,C,"Binidng.RemoveHandler for BindingDataChangedEvent"),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):
this.Eqg(e,n):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}Kxj(e,n=null){if(this.RZ&&(e=this.RZ.j3c(this.eh,this.M5a(e,n)))){const C={};C[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=n;n={};n[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=C;e(n)}}Eqg(e,n){if(this.N6a){const C=new fb.a;for(const S of this.eh.keys)S.startsWith(e)&&C.add(S);for(const S of C)this.eh.remove(S);this.eh.count||this.N6a.removeHandler(Io.a.dZb,
this.$cg);this.YH(n)}else this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}M5a(e,n){return e+"-"+n}gC(){for(const e of this.rci){const n=e[he.Rcc],C=e[he.XRd],S=e[OSF.DDA.Marshaling.AppBindingKeys.BindingId];let ja=this.RZ.zui(C);ja=ja?ja:new fb.a;ja.add(n);for(const ya of ja)this.Kxj(ya,S),nl(19,C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}static get instance(){return null!=Ol.JXg?Ol.JXg:Ol.JXg=new Ol}}Object(F.a)(Ol,"BindingDataChangedEvent",$f,[]);class cs extends $f{constructor(e){super();
this.qFa=this.gp=null;this.Lsc=()=>{this.NKj=this.RZ.WJm();this.qFa?this.Jb.wf(this.qFa):this.qFa=new zg.a(4,1,cs.odl,()=>{this.qFa=null;this.gC()});this.Jb.$b(this.qFa)};this.Jb=e;this.NKj=new fb.a}get RZ(){this.gp||(this.gp=gc.a.instance.resolve("WordEditor.AppsForOffice.IAppBindingHelper"));return this.gp}set RZ(e){this.gp=e}addHandler(e,n,C,S=null){this.ng?(this.eh.count||this.ng.SPh(this.Lsc),this.eh.W(this.M5a(e,S),n),this.RZ.Fhe(e,S,"Binidng.AddHandler for bindingSelectionChangedEvent"),this.YH(C)):
this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,n,C=null){C?this.ng&&this.j3c(this.eh,this.M5a(e,C))?(this.eh.remove(this.M5a(e,C)),this.eh.count||this.ng.Qrg(this.Lsc),this.RZ.Fhe(e,C,"Binidng.RemoveHandler for bindingSelectionChangedEvent"),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Eqg(e,n)}Eqg(e,n){if(this.ng){const C=new fb.a;for(const S of this.eh.keys)S.startsWith(e)&&C.add(S);for(const S of C)this.eh.remove(S);this.eh.count||
this.ng.Qrg(this.Lsc);this.YH(n)}else this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}M5a(e,n){return e+"-"+n}gC(){for(const C of this.NKj){var e=C[he.Rcc];const S=C[he.XRd],ja=C[OSF.DDA.Marshaling.AppBindingKeys.BindingId]?C[OSF.DDA.Marshaling.AppBindingKeys.BindingId]:null,ya=C[OSF.DDA.Marshaling.AppBindingKeys.BindingType]?C[OSF.DDA.Marshaling.AppBindingKeys.BindingType]:null;var n=this.RZ.zui(S);n=n?n:new fb.a;n.add(e);for(const kb of n)if(e=this.j3c(this.eh,this.M5a(kb,ja))){nl(7,
S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{["BindingType"]:ya});n={};n[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=ja;n[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=ya;const Rb={};Rb[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=n;ya===Id.table&&(Rb[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=C[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]);e(Rb)}}}j3c(e,n){if(e.tb(n))return e.K(n);const C=RegExp("\t","g");for(const S of e)if(S.key.replace(C," ")===n)return S.value;return null}static get instance(){return null!=
cs.OXg?cs.OXg:cs.OXg=new cs(G.AFrameworkApplication.pc)}}cs.odl=100;Object(F.a)(cs,"BindingSelectionChangedEvent",$f,[]);const ds=(e,n,C)=>{for(const S of n.keys)-1<S.indexOf(e)&&n.K(S)(C)};class Nk extends $f{constructor(){super();this.$wh=this.V0n=(e,n)=>{e={};e[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=n.Oae;e[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=n.wij;e[OSF.DDA.Marshaling.DataNodeEventProperties.NextSiblingNode]=n.eeq;ds(n.Yfc,this.eh,e)}}addHandler(e,n,C,S){this.ng&&
S?(this.eh.count||this.ng.Xfc.aef(Wk.Qlj,this.$wh),this.eh.W(e+"-"+S,n),E.ULS.sendTraceTag(19489929,341,50,"Add handler for nodeDeleted event on custom xml file whose id is: {0}.",S),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,n,C){e=e+"-"+C;this.ng&&C&&this.eh.tb(e)?(this.eh.remove(e),this.eh.count||this.ng.Xfc.Yqg(Wk.Qlj,this.$wh),E.ULS.sendTraceTag(19489930,341,50,"Remove handler for nodeDeleted event on custom xml file whose id is: {0}.",C),this.YH(n)):
this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}static get instance(){return null!=Nk.JYg?Nk.JYg:Nk.JYg=new Nk}}Object(F.a)(Nk,"DataNodeDeletedEvent",$f,[]);class er extends $f{constructor(){super();this.axh=this.W0n=(e,n)=>{e={};e[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=n.Oae;e[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=n.Mag;ds(n.Yfc,this.eh,e)}}addHandler(e,n,C,S){this.ng&&S?(this.eh.count||this.ng.Xfc.aef(Wk.$eg,this.axh),this.eh.W(e+"-"+S,n),E.ULS.sendTraceTag(19489931,
341,50,"Add handler for nodeInserted event on custom xml file whose id is: {0}.",S),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,n,C){e=e+"-"+C;this.ng&&C&&this.eh.tb(e)?(this.eh.remove(e),this.eh.count||this.ng.Xfc.Yqg(Wk.$eg,this.axh),E.ULS.sendTraceTag(19489932,341,50,"Remove handler for nodeInserted event on custom xml file whose id is: {0}.",C),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}static get instance(){return null!=
er.FYg?er.FYg:er.FYg=new er}}Object(F.a)(er,"DataNodeInsertedEvent",$f,[]);class es extends $f{constructor(){super();this.bxh=this.X0n=(e,n)=>{e={};e[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=n.Oae;e[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=n.wij;e[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=n.Mag;ds(n.Yfc,this.eh,e)}}addHandler(e,n,C,S){this.ng&&S?(this.eh.count||this.ng.Xfc.aef(Wk.bfg,this.bxh),this.eh.W(e+"-"+S,n),E.ULS.sendTraceTag(19489933,341,50,"Add handler for nodeReplaced event on custom xml file whose id is: {0}.",
S),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,n,C){e=e+"-"+C;this.ng&&C&&this.eh.tb(e)?(this.eh.remove(e),this.eh.count||this.ng.Xfc.Yqg(Wk.bfg,this.bxh),E.ULS.sendTraceTag(19489934,341,50,"Remove handler for nodeReplaced event on custom xml file whose id is: {0}.",C),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}static get instance(){return null!=es.MXg?es.MXg:es.MXg=new es}}Object(F.a)(es,"DataNodeReplacedEvent",
$f,[]);class up extends $f{constructor(e){super();this.Seg=(n,C)=>{this.eh.tb(C.controlId)&&(n={},n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=C.messageType,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=C.messageContent,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=C.$7f,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=C.Keb,this.eh.K(C.controlId)(n),C.messageType===OSF.DialogMessageType.DialogClosed&&
(this.eh.remove(C.controlId),this.eh.count||this.ng.QNa.u7a.QDj(this.Seg)))};this.dxa=e}addHandler(e,n,C,S=null){if(this.dxa)if(this.ng){E.ULS.sendTraceTag(19787875,341,50,"DialogMessageReceivedEvent.AddHandler called!");const ja=ya=>{ya===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.eh.count||this.ng.QNa.u7a.I1k(this.Seg),this.eh.W(e,n),this.YH(C)):(ya!==OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains&&E.ULS.sendTraceTag(19787904,341,10,"DialogMessageReceivedEvent.AddHandler failed!"),
this.zr(C,ya))};this.eh.tb(e)?ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.ng.QNa.showDialog(e,S,ja)}else this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,n){this.dxa?this.ng&&this.eh.tb(e)?(E.ULS.sendTraceTag(19787905,341,50,"DialogMessageReceivedEvent.RemoveHandler called!"),this.ng.QNa.$ya(e,C=>{this.eh.remove(e);this.eh.count||this.ng.QNa.u7a.QDj(this.Seg);C===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
this.YH(n):(E.ULS.sendTraceTag(19787906,341,10,"DialogMessageReceivedEvent.RemoveHandler failed!"),this.zr(n,C))})):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){const e=G.AFrameworkApplication.J?G.AFrameworkApplication.J.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return up._instance||(up._instance=new up(e))}}up._instance=null;Object(F.a)(up,"DialogMessageReceivedEvent",
$f,[]);class Wl extends $f{constructor(e){super();this.dxa=e}addHandler(e,n,C){if(this.dxa)if(this.ng){E.ULS.sendTraceTag(19787907,344,50,"DialogNotificationShownInAddinEvent.AddHandler called!");try{const S=this.ng.QNa.VNa(e);S===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.YH(C):this.zr(C,S)}catch(S){E.ULS.sendTraceTag(19787908,344,10,"DialogNotificationShownInAddinEvent.AddHandler failed. Error message: {0}.",S.message),this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.zr(C,
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,n){if(this.dxa)if(this.ng){E.ULS.sendTraceTag(19787909,344,50,"DialogNotificationShownInAddinEvent.RemoveHandler called!");try{const C=this.ng.QNa.zKa(e);C===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.YH(n):this.zr(n,C)}catch(C){E.ULS.sendTraceTag(19787910,344,10,"DialogNotificationShownInAddinEvent.RemoveHandler failed. Error message: {0}.",
C.message),this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){const e=G.AFrameworkApplication.J?G.AFrameworkApplication.J.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return Wl._instance||(Wl._instance=new Wl(e))}}Wl._instance=null;Object(F.a)(Wl,"DialogNotificationShownInAddinEvent",$f,[]);class Jo extends $f{constructor(e){super();
this.ylj=(n,C)=>{this.eh.tb(C.controlId)&&(n={},n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=C.messageType,n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=C.messageContent,n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=C.$7f,n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=C.Keb,this.eh.K(C.controlId)(n))};this.dxa=e}addHandler(e,n,C){this.dxa?this.ng?(E.ULS.sendTraceTag(595130066,
341,50,"DialogParentMessageReceivedEvent.AddHandler called!"),this.eh.count||this.ng.QNa.u7a.H1k(this.ylj),this.eh.W(e,n),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,n){this.dxa?this.ng&&this.eh.tb(e)?(E.ULS.sendTraceTag(595130065,341,50,"DialogParentMessageReceivedEvent.RemoveHandler called!"),this.eh.remove(e),this.eh.count||this.ng.QNa.u7a.mCo(this.ylj),this.YH(n)):this.zr(n,
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){const e=G.AFrameworkApplication.J?G.AFrameworkApplication.J.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return Jo._instance||(Jo._instance=new Jo(e))}}Jo._instance=null;Object(F.a)(Jo,"DialogParentMessageReceivedEventWord",$f,[]);class rn extends $f{constructor(e){super();this.qFa=null;this.Lsc=()=>{this.qFa?this.Jb.wf(this.qFa):this.qFa=
new zg.a(4,1,rn.NXl,()=>{this.qFa=null;this.gC()});this.Jb.$b(this.qFa)};this.Jb=e}addHandler(e,n,C){this.ng?(this.eh.count||this.ng.SPh(this.Lsc),this.eh.W(e,n),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,n){this.ng&&this.eh.tb(e)?(this.eh.remove(e),this.eh.count||this.ng.Qrg(this.Lsc),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){for(const e of this.eh.values)e&&e({})}static get instance(){return null!=rn.XXg?rn.XXg:
rn.XXg=new rn(G.AFrameworkApplication.pc)}}rn.NXl=100;Object(F.a)(rn,"DocumentSelectionChangedEvent",$f,[]);class rm extends $f{constructor(e,n,C,S){super();this.wDc=null;this.Snj=(ja,ya)=>{if(ya)if(ja=ya.node,!ja)E.ULS.sendTraceTag(22024347,341,10,"node is null");else{if(47===ja.type&&21===ya.M1h){if((ya=this.fd.mg(ja))&&ya.Vb(21))for(;ya.Kf(21););ya=new fb.a;this.l9&&(ya=ja.getValue(hb.a.oTa),ya=this.l9.$zi(ya));ya.add(ja.id.toString());for(const kb of ya)this.eh.tb(kb)&&(ja=this.eh.K(kb))&&ja({})}}else E.ULS.sendTraceTag(22024346,
341,10,"TopologyChangedEventArgs is null")};e&&(this.wDc=e.qf(47));this.fd=n;this.kEh=S;this.l9=C}addHandler(e,n,C){this.kEh?this.wDc?(this.eh.count||this.wDc.pPh(this.Snj),this.eh.W(e,n),this.YH(C)):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.zr(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,n){this.kEh?this.wDc&&this.eh.tb(e)?(this.eh.remove(e),this.eh.count||this.wDc.EDj(this.Snj),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):
this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){try{const e=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled");return rm._instance||(rm._instance=new rm(ka.a.jf.Tl,new Nb.a,gc.a.instance.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),e))}catch(e){return E.ULS.sendTraceTag(22024348,341,10,"Failed to get SettingsChangedEvent Instance: {0}.",e),null}}}rm._instance=null;Object(F.a)(rm,
"SettingsChangedEvent",$f,[]);class In extends $f{gC(){throw Error("Method not implemented.");}constructor(e){super();this.ek=e}addHandler(e,n,C){this.eh.count||this.ek.value.setOfficeThemeChangedHandler(this.b1n);this.eh.W(e,n);this.YH(C)}b1n(e){for(const n of In._instance.eh.values)n&&n(e)}removeHandler(e,n){this.eh.tb(e)?(this.eh.remove(e),this.YH(n)):this.zr(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){try{return In._instance||(In._instance=new In(gc.a.instance.nf("Common.App.AppsForOfficeCommon.IContextActivationManager")))}catch(e){return E.ULS.sendTraceTag(512300628,
341,10,"Failed to get OfficeThemeChangedEvent Instance: {0}.",e),null}}}In._instance=null;Object(F.a)(In,"OfficeThemeChangedEvent",$f,[]);class Sm extends no{constructor(e,n,C){super(e,n);this.cUe=C}ajc(e){if(e=super.ajc(e))e.ng=this.cUe;return e}static MFl(e,n){const C=new qc.a;C.W(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,rn.instance);C.W(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent,cs.instance);C.W(OSF.DDA.EventDispId.dispidBindingDataChangedEvent,Ol.instance);C.W(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,
up.instance);C.W(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Jo.instance);C.W(OSF.DDA.EventDispId.dispidDataNodeAddedEvent,er.instance);C.W(OSF.DDA.EventDispId.dispidDataNodeReplacedEvent,es.instance);C.W(OSF.DDA.EventDispId.dispidDataNodeDeletedEvent,Nk.instance);C.W(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,Wl.instance);C.W(OSF.DDA.EventDispId.dispidSettingsChangedEvent,rm.instance);C.W(OSF.DDA.EventDispId.dispidRichApiMessageEvent,co.instance);C.W(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,
In.instance);return new Sm(e,C,n)}}Object(F.a)(Sm,"WordEditorEventStore",no,[]);class Fo{constructor(){this.XEk=new id.a(()=>this.deo())}get Ndj(){return this.XEk.value}XFf(e){E.ULS.shipAssertTag(5902749,341,!!this.Ndj);let n;return({value:n}=this.Ndj.Ec(e)).returnValue?n():null}}Object(F.a)(Fo,"ApiMethodFactory",null,[1213]);class sm{constructor(e,n,C){this.customizedActionDic=this.Ek=this.controlId=null;this.parameters=e;this.callback=n;this.z3k=C;this.pu={};this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get errorCode(){return this.we}get result(){return this.pu}go(){this.execute();
this.vo()}execute(){}vo(){this.callback&&(this.result.Error=this.errorCode,this.callback(this.result))}}Object(F.a)(sm,"ApiMethod",null,[]);class Xo extends sm{constructor(){super();this.ng=null}static nYd(e){const n=new Xo;n.we=e;return n}}Object(F.a)(Xo,"LiveBooksApiMethod",sm,[]);class eo extends Xo{constructor(e){super();this.dxa=e}go(){let e;this.dxa?this.ng?(this.ng.QNa.sendMessage(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[$b.a.dgf],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),
e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.gQo(e)}gQo(e){this.we=e;this.vo()}}Object(F.a)(eo,"SendMessageMethod",Xo,[]);var fr=d(1850);class bn extends Xo{constructor(e){super();this.ui=e}go(){var e=this.ui.yt.getOsfControl(this.controlId);if(!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||e.isFirstParty()){e=e.getManifest();
var n=e.getMarketplaceID(),C=e.getWebApplicationId(),S=e.getWebApplicationMsaId();gc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(n).then(ja=>{this.we=0;const ya={};ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=ja.upn;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ja.userId;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=C;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=S?S:C;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
ja.authority;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=fr.a.nti(ja.authorityType);ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ja.isAnonymous;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ja.tenantId;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ja.supportsAuthToken;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=ya;this.vo()},ja=>{const ya={},kb=new fr.a;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
kb.upn;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=kb.userId;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=C;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=S?S:C;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=kb.authority;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=fr.a.nti(kb.authorityType);ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=kb.isAnonymous;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
kb.tenantId;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=kb.supportsAuthToken;ya[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=ja;this.we=1;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=ya;this.vo()})}}}Object(F.a)(bn,"GetAuthContextMethod",Xo,[]);class Ig extends sm{constructor(){super();this.ng=null}static nYd(e){const n=new Ig;n.we=e;return n}}Object(F.a)(Ig,"WordEditorApiMethod",sm,[]);class vp extends Ig{constructor(e){super();
this.gZ=e}go(){let e="";if(this.gZ)if(this.ng){var n=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]&&n[OSF.DDA.Marshaling.BindingParameterKeys.ItemName]){let C=null;n[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(C=n[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());e=n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();this.we=({XK:n}=this.ng.aVk(this.Ek,C,n[OSF.DDA.Marshaling.BindingParameterKeys.ItemName].toString(),
e)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=n}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;nl(4,this.Ek.Rn,this.errorCode,{["BindingType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(16795283,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,
["errMsg"]:"unexpected error to AddAppBindingFromNamedItem api"});this.vo()}}Object(F.a)(vp,"AddAppBindingFromNamedItemMethod",Ig,[]);class Ko extends Ig{constructor(e){super();this.gZ=e}go(){let e="";if(this.gZ)if(this.ng){var n=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]){let C=null;n[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(C=n[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());e=n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();
this.we=({XK:n}=this.ng.bVk(this.Ek,C,e)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=n}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;nl(3,this.Ek.Rn,this.errorCode,{["BindingType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(16795285,341,10,"{0}",{["error"]:this.errorCode,
["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to AddAppBindingFromSelection api"});this.vo()}}Object(F.a)(Ko,"AddAppBindingFromSelectionMethod",Ig,[]);class Go extends Ig{constructor(e,n){super();this.cGa=e;this.wl=n}execute(){if(this.cGa){var e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],C=this.wl.qVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this.we=void 0===C||null===C||C.builtIn?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:
C.wNh(e,n)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.vo()}}Object(F.a)(Go,"AddDataNamespaceMethod",Ig,[]);const As=(e,n,C)=>{let S=C.Rn||"00000000-0000-0000-0000-000000000000";C=C.yP?C.yP:C;C.storeType&&C.store&&C.Rn&&(S=Telemetry.PrivacyRules.GetPrivacyCompliantId(C.Rn,C.storeType,null,null,null,null));E.ULS.sendTraceTag(509368257,341,10,"{0}",{["ApiCode"]:e,
["AppId"]:S,["Result"]:n});n!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&E.ULS.sendTraceTag(509368256,341,10,"{0}",{["error"]:n,["apiName"]:e,["appId"]:S})};class Us extends Ig{constructor(e,n){super();this.cGa=e;this.wl=n}execute(){if(this.cGa){var e=null;this.we=({ced:e}=this.wl.Bdf(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml])).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){const n={};n[OSF.DDA.Marshaling.DataPartProperties.Id]="{"+e.id.Gt.toString().toUpperCase()+
"}";n[OSF.DDA.Marshaling.DataPartProperties.BuiltIn]=!1;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=n}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;As(22,this.errorCode,this.Ek);this.vo()}}Object(F.a)(Us,"AddDataPartMethod",Ig,[]);class Nt extends Ig{constructor(e){super();this.rOh=n=>{this.we=n;this.qP();this.vo()};this.gZ=e}go(){if(this.gZ)if(this.ng){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&
e[OSF.DDA.Marshaling.SetDataKeys.Data]){var n=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let C,S;0<e[OSF.DDA.Marshaling.SetDataKeys.Data].length?(C=null,e=e[OSF.DDA.Marshaling.SetDataKeys.Data],S=!1):(e=e[OSF.DDA.Marshaling.SetDataKeys.Data],C=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders],e=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows],S=!0);this.ng.xdf(n,this.Ek,C,e,S,this.rOh);return}n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
else n=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.rOh(n)}qP(){nl(10,this.Ek.Rn,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(17580612,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to AddTableBindingColumnsAsync API"})}}Object(F.a)(Nt,"AddTableBindingColumnsMethod",Ig,[]);class Mq extends Ig{constructor(e){super();this.sOh=n=>{this.we=n;this.qP();this.vo()};this.gZ=e}go(){if(this.gZ)if(this.ng){var e=
this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&e[OSF.DDA.Marshaling.SetDataKeys.Data]){this.ng.wef(e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.Ek,e[OSF.DDA.Marshaling.SetDataKeys.Data],this.sOh);return}e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.sOh(e)}qP(){nl(9,this.Ek.Rn,
this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(17580613,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to AddTableBindingRowsAsync API"})}}Object(F.a)(Mq,"AddTableBindingRowsMethod",Ig,[]);class Gp extends Ig{constructor(){super()}execute(){try{OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[$b.a.j3k][$b.a.i3k],this.parameters),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(e){E.ULS.sendTraceTag(17306273,
341,10,"AppCommandInvocationCompletedMethod: unexpected exception {0}",e.message),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}this.vo()}}Object(F.a)(Gp,"AppCommandInvocationCompletedMethod",Ig,[]);class cn extends Ig{constructor(){super()}go(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;E.ULS.shipAssertTag(20854624,341,!!this.ng.aKa);if(this.ng&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]){const n=
this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle],C=this.ng.aKa.Swi(this.controlId,n);if(C){var e=C.Ooc;if(C.y0f)this.we=this.ng.aKa.nBj(this.controlId,n),this.vo();else try{this.ng.aKa.APo(this.controlId,e,n,S=>{this.we=S;this.vo()})}catch(S){E.ULS.sendTraceTag(20854625,341,15,"Error happens when send close document request. "+S.message)}}}}}Object(F.a)(cn,"CloseDocumentCopyMethod",Ig,[]);class hp extends Ig{constructor(e,n){super();this.cGa=e;this.wl=n}execute(){this.we=this.cGa?
this.wl.Zdi(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]):OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.vo()}}Object(F.a)(hp,"DeleteDataPartMethod",Ig,[]);class tm extends Ig{constructor(e){super();this.qei=n=>{this.we=n;this.qP();this.vo()};this.gZ=e}go(){if(this.gZ)if(this.ng){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id]){this.ng.hvf(e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),
this.Ek,this.qei);return}e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.qei(e)}qP(){nl(11,this.Ek.Rn,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(17580614,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to deleteAllDataValuesAsync API"})}}Object(F.a)(tm,
"DeleteTableBindingRowsMethod",Ig,[]);class ip extends Ig{constructor(e){super();this.b4l=(n,C)=>{this.we=C;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=n);this.vo()};this.YBk=e}go(){if(this.YBk)if(this.ng){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData];if(e)try{let n=this.Ek.Rn||"00000000-0000-0000-0000-000000000000";const C=this.Ek.yP?this.Ek.yP:this.Ek;C.storeType&&C.store&&C.Rn&&(n=Telemetry.PrivacyRules.GetPrivacyCompliantId(C.Rn,
C.storeType,null,null,null,null));this.ng.d4l(e,n,this.controlId,this.Ek,this.b4l)}catch(n){E.ULS.sendTraceTag(17126306,344,10,"{0}",n.message),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.vo()}else E.ULS.sendTraceTag(9204821,344,10,"The rich api executor input parameter should not be null."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.vo()}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.vo();else E.ULS.sendTraceTag(9291534,341,15,"The Rich App API feature is not enabled."),
this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,this.vo()}}Object(F.a)(ip,"ExecuteRichApiRequestMethod",Ig,[]);var pt=d(1652);class xo{}xo.x8a="generalException";xo.Zbe="invalidArgument";xo.sbg="notAllowed";xo.$gf="apiNotAvailable";xo.Aup="unresolvedPendingRequest";xo.timeout="timeout";xo.ndf="adalTimeout";xo.x$j="userNotSignedIn";xo.Atd="userAborted";xo.vVj="silentSignInFailed";xo.g8c="invalidResourceUrl";xo.zVf="invalidGrant";xo.Q5h="connectionLost";xo.nof="clientError";xo.dxg=
"serverError";Object(F.a)(xo,"WopiHostErrorCodes",null,[]);class Ot{}Object(F.a)(Ot,"OAuthCallerMetadata",null,[]);class Fl{constructor(e){this.Cba=e;this.Auk=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}fUk(e,n,C,S,ja,ya){if(!this.Cba)return S=new mm,S.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(S);const kb=new Ot;kb.AddinName=ja;kb.AddinTrustId=ya;let Rb=-1;ya=null;if(S&&this.$Yi())ya=this.Cba.Q3j($b.a.mCe,
e,S,Fl.DEi(ja),kb);else{const sc=Date.now();ya=this.Cba.tV($b.a.mCe,e,kb).then(Fc=>{Rb=Date.now()-sc;const gd=(n||C)&&"login_required"===Fc.ErrorCode;return(n&&("interaction_required"===Fc.ErrorCode||"consent_required"===Fc.ErrorCode||"invalid_grant"===Fc.ErrorCode)||gd)&&this.$Yi()?this.Cba.Q3j($b.a.mCe,e,null,Fl.DEi(ja),kb):Promise.resolve(Fc)})}return ya.then(sc=>{const Fc=new mm;sc.IsSuccess?(Fc.token=sc.Token,sc.Telemetry&&(Fc.I1b=sc.Telemetry.fromCache,Fc.expiresOn=sc.Telemetry.expiresOn)):
(Fc.errorCode=this.TJn(sc),Fc.mGg=this.E$n(sc));return Fc}).catch(()=>{const sc=new mm;sc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(sc)}).then(sc=>{sc.R5a="OauthManager";0<=Rb&&(sc.I4c=Rb);return sc})}Fjn(e){const n=(G.AFrameworkApplication.J.jb(G.AFrameworkApplication.Yha)||"").toLowerCase();return(Dk.a.mXa||"teams"===n&&Zm.a.r6c)&&!Fl.cjn(e)||!this.Cba||!this.Cba.Afn()?!1:!0}$Yi(){return this.Auk||1!==pt.a.D4d()}TJn(e){switch(e.ErrorCode){case "UserCancelled":case "interaction_required":e=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:e=e.ErrorCode===xo.Atd?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:e.ErrorCode===xo.vVj?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:e.ErrorCode===xo.g8c?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:e.ErrorCode===xo.zVf?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:e.ErrorCode===xo.Q5h?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return e}E$n(e){let n="";(e=RegExp("AADSTS(\\d+)").exec(e.ErrorMessage))&&
1<e.length&&(n=e[1]);return n}static DEi(e){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,e)}static cjn(e){if(!e)return!1;e=e.toLowerCase();for(const n of tj.Ooi)if(n===e)return!0;return!1}}Object(F.a)(Fl,"AppsforOfficeTokenFromOauthManager",null,[40]);class Ec{constructor(e){this.YIn=e}static RIg(){if(G.AFrameworkApplication.J.$("AppForOfficeSSOV2IsEnabled")){var e=null;try{e=gc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(n){E.ULS.sendTraceTag(592061330,
1300,10,"Unable to resolve IOAuthManager: "+n)}e=new Fl(e);Ec._instance=new Ec(e)}}static getInstance(){Ec.wmh||(Ec.RIg(),Ec.wmh=!0);return Ec._instance}}Ec._instance=null;Ec.wmh=!1;Object(F.a)(Ec,"AppsForOfficeOauthManagerFactory",null,[28]);class fs extends Ig{constructor(e,n){super();this.AAk=e;this.ui=n}go(){E.ULS.sendTraceTag(22402398,341,50,"GetAccessToken was called!");const e=(n,C)=>{n===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(C=C.accessToken,this.result[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
C):E.ULS.sendTraceTag(22402399,341,10,"{0}",{["errorCode"]:n.toString(),["appId"]:this.Ek.Rn,["storeType"]:this.Ek.storeType});this.we=n;this.vo()};gc.a.instance.Ta("Postmessage.IHostPostmessenger").execute(n=>{const C=this.ui.yt,S=Ec.getInstance();tj.getInstance(C,n,S).getAccessToken(this.controlId,this.AAk,this.parameters,e)})}}Object(F.a)(fs,"GetAccessTokenMethod",Ig,[]);class gs extends Ig{constructor(e){super();this.gZ=e}go(){if(this.gZ)if(this.ng){let e=[];this.we=({PVh:e}=this.ng.chm(this.Ek)).returnValue;
this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=e}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;nl(12,this.Ek.Rn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(9049033,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to getAllAsync api"});this.vo()}}Object(F.a)(gs,"GetAllAppBindingsMethod",
Ig,[]);const dk=(e,n,C,S,ja)=>{E.ULS.sendTraceTag(7886233,341,50,"{0}",{["type"]:e?"get":"set",["error"]:n,["xmlSize"]:C,["latency"]:Math.max(S,0),["appId"]:ja})},Kn=(e,n)=>{E.ULS.sendTraceTag(7886234,341,50,"{0}",{["type"]:n?"get":"set",["delay"]:Math.max(e,0)})},ek=e=>(new Date).getTime()-e;class am{constructor(e,n){this.iea=e;this.JQk=n;this.kxd=this.Z4=this.cya=0}rAe(e){this.Z4=(new Date).getTime();this.kxd=0;this.cya=this.iea.setTimeout(()=>{this.kxd=(new Date).getTime();e()},this.JQk)}clearTimeout(){this.iea.clearTimeout(this.cya)}get Pfe(){return!!this.kxd}get Tmb(){return this.Z4}get YTd(){return this.kxd}}
Object(F.a)(am,"TimeoutMethodHelper",null,[]);class hm extends Ig{constructor(e,n,C,S){super();this.LXe=e;this.gZ=n;this.IGb=C;this.iea=S}go(){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let n=null;if(this.gZ)if(this.ng)if(void 0===e[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||void 0===e[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===e[OSF.DDA.Marshaling.BindingParameterKeys.Id])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{n=e[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();const S=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let ja;({XK:C}=this.ng.gGf(S,this.Ek));if(C&&(ja=C[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var C=ja[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.we=({text:e}=this.ng.iGf(this.Ek,S)).returnValue,this.vMa(e);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table)C===OSF.DDA.Marshaling.CoercionTypeKeys.Table?
(this.IHi(e),this.we=({b_j:e}=this.ng.ljm(this.Ek,S,e)).returnValue,this.vMa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)C===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix||C===OSF.DDA.Marshaling.CoercionTypeKeys.Table?(this.IHi(e),this.we=({iLn:e}=this.ng.ijm(this.Ek,S,e)).returnValue,this.vMa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&
this.LXe){this.dDm(S);return}n===OSF.DDA.Marshaling.CoercionTypeKeys.Html?(this.we=({hWa:e}=this.ng.hjm(this.Ek,S)).returnValue,this.vMa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.l0(n)}IHi(e){e.isPartialTable=!!e&&(!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||
!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]||!!e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]||!!e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]);e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]=e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]?e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]:0;e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]=e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]?e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]:0;e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]=
e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]?e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]:0;e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]=e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]?e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]:0}dDm(e){const n=new am(this.iea,this.IGb);n.rAe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Yvb(null,n.Tmb)});this.ng.kjm(this.Ek,e,(C,S)=>{n.Pfe?Kn(ek(n.YTd),!0):(n.clearTimeout(),this.we=C,this.Yvb(S,n.Tmb))})}l0(e){nl(5,
this.Ek.Rn,this.errorCode,{["CoercionType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(16795287,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to GetAppBindingData api",["CoercionType"]:e});this.vo()}vMa(e){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=e)}Yvb(e,n){dk(!0,this.errorCode,(e||"").length,ek(n),this.Ek.Rn);this.vMa(e);this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}
Object(F.a)(hm,"GetAppBindingDataMethod",Ig,[]);class sr extends Ig{constructor(e){super();this.gZ=e}go(){if(this.ng){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id])if(e=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.gZ){let n={};this.we=({XK:n}=this.ng.gGf(e,this.Ek)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=n}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;nl(13,this.Ek.Rn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(9000010,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to getAppBindingById api"});this.vo()}}Object(F.a)(sr,"GetAppBindingMethod",Ig,[]);class yj extends Ig{constructor(e){super();this.xz=e}execute(){const e=
this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath];let C,S;this.we=({XIa:C,jBb:S}=this.xz.eRb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)try{const ja=C.selectNodes(n,S);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.xz.m2j(e.CustomXmlId,ja)}catch(ja){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}this.vo()}}Object(F.a)(yj,"GetDataNodesMethod",Ig,[]);class hs extends Ig{constructor(e){super();
this.xz=e}execute(){let e,n;this.we=({XIa:e,jBb:n}=this.xz.eRb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=e.getNodeText(n));this.vo()}}Object(F.a)(hs,"GetDataNodeTextMethod",Ig,[]);class Nq extends Ig{constructor(e){super();this.xz=e}execute(){let e,n;this.we=({XIa:e,jBb:n}=this.xz.eRb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;
this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=9===n.nodeType||1===n.nodeType?e.getNodeXml(n):e.getNodeText(n));this.vo()}}Object(F.a)(Nq,"GetDataNodeValueMethod",Ig,[]);class wk extends Ig{constructor(e){super();this.xz=e}execute(){let e,n;this.we=({XIa:e,jBb:n}=this.xz.eRb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=
e.getNodeXml(n));this.vo()}}Object(F.a)(wk,"GetDataNodeXmlMethod",Ig,[]);class Xp extends Ig{constructor(e){super();this.wl=e}execute(){const e=this.wl.qVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);if(void 0===e||null===e||this.wl.hXf(e))this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound;else{const n={};n.id=e.id;n.DataPartBuiltIn=e.builtIn;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=n;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}this.vo()}}
Object(F.a)(Xp,"GetDataPartByIdMethod",Ig,[]);class Yp extends Ig{constructor(e,n){super();this.wl=e;this.xz=n}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath],C=this.wl.qVa(e);if(void 0!==C&&null!==C)try{const S=C.selectNodes(n,null);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.xz.m2j(e,S);this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(S){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.vo()}}Object(F.a)(Yp,"GetDataPartNodesMethod",Ig,[]);class qt extends Ig{constructor(e){super();this.wl=e}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],n=this.wl.I1c(),C=[];this.result[OSF.DDA.Marshaling.ListDescriptors.DataPartList]=C;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;for(let S=0;S<n.length;S++){const ja=n[S];if(e===ja.namespace&&!this.wl.hXf(ja)){const ya={};ya.id=ja.id;ya.DataPartBuiltIn=
ja.builtIn;C.push(ya)}}this.vo()}}Object(F.a)(qt,"GetDataPartsByNamespaceMethod",Ig,[]);class yn extends Ig{constructor(e){super();this.wl=e}execute(){const e=this.wl.qVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=void 0===e||null===e?null:e.P0a;this.we=void 0===e||null===e?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.vo()}}Object(F.a)(yn,"GetDataPartXmlMethod",Ig,[]);
class Oq extends Ig{constructor(e){super();this.wl=e}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],n=this.wl.qVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==n&&null!==n?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=n.I3c(e),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.vo()}}Object(F.a)(Oq,"GetDataPrefixByUriMethod",Ig,[]);class Li extends Ig{constructor(e){super();
this.wl=e}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],n=this.wl.qVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==n&&null!==n?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=n.LKf(e),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.vo()}}Object(F.a)(Li,"GetDataUriByPrefixMethod",Ig,[]);var oo=d(748);class po{constructor(){this.transaction=this.Uwi=this.qob=this.yS=
null}}Object(F.a)(po,"GetDocumentTextOperationContext",null,[]);class hl extends Ig{constructor(){super();this.fIj=null;this.DEk=100;this.Cqm=(e,n)=>{for(e=0;e<this.DEk;e++)if(n.yS.moveNext()){if(n.yS.currentNode.ez){var C=Uk.SelectionFactory.Er(n.yS.currentNode);C=this.ng.w8d(C);C!==pn.AParagraphNode.RB&&(n.qob+=pn.AParagraphNode.KP(C))}}else return n.transaction&&n.transaction.dispose(),n.Uwi(n.qob),!1;return!0}}go(){let e=!1;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.ng&&
this.ng.aKa&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]){const n=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType],C=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize];this.ng.aKa.UWi(this.controlId)?this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:0>=C?(E.ULS.sendTraceTag(7123611,341,15,"Invalid slice size. It should be greater than 0."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize):this.Btn(n)?e=this.zIm(n,C):(E.ULS.sendTraceTag(7123612,341,15,"Requested file type {0} is not supported.",n),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported)}e||this.vo()}Btn(e){return e===OSF.DDA.Marshaling.File.FileType.Compressed||e===OSF.DDA.Marshaling.File.FileType.Pdf||
e===OSF.DDA.Marshaling.File.FileType.Text}zIm(e,n){const C=(S,ja)=>{const ya={};ya.FileType=e;ya.SliceSize=n;nl(8,this.Ek.Rn,S,ya);this.hio(ja);this.qqm(S)};if(e===OSF.DDA.Marshaling.File.FileType.Text)return this.Bqm(n,C);this.ng.aKa.wqm(this.controlId,e,n,C);return!0}Bqm(e,n){E.ULS.sendTraceTag(8914013,341,100,"Started to get document content in text format; sliceSize is "+e);const C=this.IPm();if(!C)return!1;this.oLm(e,n,C).run();return!0}oLm(e,n,C){const S=new po;S.yS=C;S.qob="";S.transaction=
this.zum(C);S.Uwi=ja=>{(ja=this.tqm(ja,e))?(n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ja),E.ULS.sendTraceTag(8914015,341,100,"Finished getting text content.")):(n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,null),E.ULS.sendTraceTag(8914014,341,10,"Cannot get DocumentFile object."))};C=new oo.a(null,this.Cqm,S);C.nm("GetDocumentCopyInText");this.B_f()&&(C.oi=!0);return C}B_f(){return!!this.fIj}zum(e){if(this.B_f())return null;const n=(new Rg.a).Lc(3);n.Ab(e.currentNode);return n}IPm(){if(this.B_f())var e=
this.fIj;else{if(!Rd.a.hm||!Rd.a.hm.kb||!Rd.a.hm.kb.Qc)return E.ULS.sendTraceTag(8914016,341,10,"Cannot find ContentView in workspace of word frame."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,null;e=(new Nb.a).osa(Rd.a.hm.kb.Qc.vd,7,7).currentNode}const n=new jo.a;n.set(e);e=Tm.a.zq(n);e.zp(Ge.a.Mob,null);return e}tqm(e,n){if(!e&&""!==e)return null;const C=hl.skm(e);if(!this.gql(n,C))return null;e=hl.wLm(e,n);if(!e)return null;n=this.ng.aKa.H9h(this.controlId,C,n,e);
n.y0f=!0;E.ULS.sendTraceTag(8914017,341,100,"Got DocumentFile; total bytes are "+C);return n}gql(e,n){return e<n&&e%2?(E.ULS.sendTraceTag(8914018,341,15,"Invalid slice size. It should not be odd number."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,!1):!0}hio(e){e&&(this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle]=e.nni,this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize]=e.fileSize)}qqm(e){this.we=e;this.vo()}static skm(e){return 2*e.length+2}static wLm(e,
n){const C=new fb.a;var S=0;n/=2;do{const ja=S+(C.count?n:n-1);S=Of.a.substring(e,S,ja);C.add(S);S=ja}while(S<e.length);return C}}Object(F.a)(hl,"GetDocumentCopyMethod",Ig,[]);class Ln extends Ig{constructor(){super()}go(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;E.ULS.shipAssertTag(20711197,341,!!this.ng.aKa);if(this.ng&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&void 0!==
this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]){const C=this.ng.aKa.Swi(this.controlId,this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]);if(C){var e=C.Ooc,n=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex];if(C.y0f)this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=C.WBf.K(n),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.vo();else try{this.ng.aKa.Aqm(this.controlId,
n,e,(S,ja)=>{if(ja){ja=window.self.atob(ja);const ya=Array(ja.length);for(let kb=0;kb<ja.length;kb++)ya[kb]=ja.charCodeAt(kb);this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=ya;this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize]=ja.length;this.we=S;this.vo()}})}catch(S){E.ULS.sendTraceTag(20711198,341,15,"Error happens when converting string data to binary data. "+S.message)}}}}}Object(F.a)(Ln,"GetDocumentCopySliceMethod",Ig,[]);class wp extends Ig{constructor(){super()}execute(){let e=
null;if(this.ng&&({url:e}=this.ng.zqp()).returnValue){const n={};n[""+OSF.DDA.Marshaling.FilePropertiesKeys.Url]=e;this.result[""+OSF.DDA.Marshaling.FilePropertiesKeys.Properties]=n;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}}Object(F.a)(wp,"GetFilePropertiesMethod",Ig,[]);class Hp{constructor(){this.context=null;this.errorCode=0}}Object(F.a)(Hp,"NestedAppAuthContextResult",null,[]);class eq{static lBm(e,n){const C=new Hp;(e=e.getOsfControl(n))&&e.isFirstParty()?(C.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
e={},n=G.AFrameworkApplication.J.jb("AADUserObjectId"),e.userObjectId=n?n:G.AFrameworkApplication.J.jb("HostUserId"),e.userPrincipalName=G.AFrameworkApplication.J.jb("UserPrincipalName"),e.tenantId=G.AFrameworkApplication.J.jb("TenantId"),n=(G.AFrameworkApplication.J.jb("HostAuthType")||"").toLowerCase(),e.authorityType="aad"===n?"aad":"msa"===n?"msa":"other",C.context=e):C.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return C}}Object(F.a)(eq,"NestedAppAuthUtil",null,[]);class Vs extends Ig{constructor(e){super();
this.ui=e}go(){const e=eq.lBm(this.ui.yt,this.controlId||"");this.we=e.errorCode;if(e.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)for(const [n,C]of Object.entries(e.context))this.result[n]=C;this.vo()}}Object(F.a)(Vs,"GetNestedAppAuthContextMethod",Ig,[]);class xp extends Ig{constructor(e,n,C,S,ja,ya){super();this.qBk=e;this.mBk=n;this.rCk=C;this.DBk=S;this.IGb=ja;this.iea=ya}go(){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let n=null;if(this.ng)if(void 0===
e[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.GetDataKeys.CoercionType])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else if(n=e[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString(),n===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.we=({nwc:e}=this.ng.getSelectedText()).returnValue,this.vMa(e);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.rCk)this.we=({YOo:e}=this.ng.iKm()).returnValue,this.vMa(e);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&
this.DBk)this.we=({SOo:e}=this.ng.eKm()).returnValue,this.vMa(e);else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.mBk){this.gKm();return}n===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.qBk?(this.we=({PKj:e}=this.ng.$Jm()).returnValue,this.vMa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.l0(n)}gKm(){const e=new am(this.iea,this.IGb);e.rAe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;
this.Yvb(null,e.Tmb)});this.ng.fKm((n,C)=>{e.Pfe?Kn(ek(e.YTd),!0):(e.clearTimeout(),this.we=n,this.Yvb(C,e.Tmb))})}vMa(e){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=e)}Yvb(e,n){dk(!0,this.errorCode,(e||"").length,ek(n),this.Ek.Rn);this.vMa(e);this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}l0(e){nl(1,this.Ek.Rn,this.errorCode,{["CoercionType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
E.ULS.sendTraceTag(17385222,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to GetSelectedDataAsync api",["CoercionType"]:e});this.vo()}execute(){}}Object(F.a)(xp,"GetSelectedDataMethod",Ig,[]);class xq{constructor(){this.languageId=0;this.displayName=this.name=null}}Object(F.a)(xq,"TranslationLanguageInfo",null,[]);class tr{constructor(e,n){this.rIh=null;this.waf=!1;this.bsc=C=>{C={["Status"]:C.data.status,["HttpStatus"]:C.data.He,["ResponseData"]:Of.a.b3j(C.data.Pe)};
E.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",C)};this.Ied=C=>{E.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");let S;try{S=Bf.b(C.data.Pe)}catch(ja){E.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",ja);return}this.uvp(S)};
this.iLk=e;this.Ssk=n}nGo(){G.AFrameworkApplication.Fe.Xj(this.iLk(),1,null,null,!1,2,this.Ied,this.bsc,null)}Mxm(){const e=(this.rIh||this.Ssk()).split(","),n=this.waf?e.length/3:e.length/2,C=Array(n);for(let S=0;S<n;S++){C[S]=new xq;C[S].name=e[S];const ja=parseInt(e[S+n]);C[S].languageId=ja;C[S].displayName=this.waf?e[S+2*n]:ac.a.hKi()[ja]}return C}uvp(e){this.rIh=e.TranslationLanguages;this.waf=Boolean.parse(e.TranslationLanguagesLocalized||"false")}}Object(F.a)(tr,"TranslationLanguagesManager",
null,[]);var Qj=d(1178),fg=d(2036);class ym{constructor(){this.nEc=!1}start(e){ym.neb(this.DGp,Object(ic.a)(this,this.onCancel,"onCancel"));fg.a.taa(this.qGo,Object(ic.a)(this,this.NXn,"onComplete"),e)}onCancel(){this.nEc=!0;ym.Hra()}NXn(e,n,C){this.nEc||(n||(n=e?"Success":"UnknownError"),"Success"===n?(this.kgi&&ym.Hra(),this.zE(C)):(this.Yin(n)?E.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+n):E.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+
n),ym.Hra(),e=this.kfa(n),1!==G.AFrameworkApplication.ua.state&&(G.AFrameworkApplication.J.$("ReportConversionFailedErrorUnderAdditionalVetoes")&&G.AFrameworkApplication.lS(Na.a.q7h,void 0,["TranslationFailed"]),n=new pb.StandardDialog,n.Bd=0,n.Ke(1,CommonUIStrings.l_DialogClose),n.Iy(Na.a.q7h,CommonUIStrings.l_DefaultDialogTitle,e,null))))}static neb(e,n){const C=new Qj.a;ym.tl=C.create();ym.tl.message=e;ym.tl.aM(CommonUIStrings.l_DefaultDialogTitle,n,null)}static Hra(){ym.tl&&(ym.tl.close(),ym.tl=
null)}}ym.tl=null;Object(F.a)(ym,"TranslationRequest",null,[]);class Yo extends ym{constructor(e,n=0){super();this.pFd=e;this.jIk=n;this.ki=(new Date).getTime();G.AFrameworkApplication.Bn.c$a(9984)}start(e){E.ULS.sendTraceTag(23184016,301,50,"Translation started");super.start(e)}onCancel(e){super.onCancel(e);G.AFrameworkApplication.Bn.c$a(9986);E.ULS.sendTraceTag(40953793,301,50,"Translation canceled")}zE(){const e=(new Date).getTime()-this.ki;G.AFrameworkApplication.Bn.setDw(9985,e);this.redirect();
E.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")}get DGp(){return 10<=this.jIk?CommonUIStrings.l_WaitForLongTranslation:CommonUIStrings.l_WaitForTranslation}get kgi(){return!1}kfa(e){return"TranslationServiceUnavailable"===e?CommonUIStrings.l_TranslationServiceUnavailable:"DocumentCannotBeTranslated"===e?CommonUIStrings.l_DocumentCannotBeTranslated:"DocumentHasOCX"===e?CommonUIStrings.l_DocumentCannotBeTranslatedOCX:"DocumentTooLong"===e?CommonUIStrings.l_DocumentCannotBeTranslatedLength:
CommonUIStrings.l_GenericTranslationError}Yin(e){return"DocumentCannotBeTranslated"===e||"DocumentHasOCX"===e||"DocumentTooLong"===e}}Object(F.a)(Yo,"TranslateDocumentRequest",ym,[]);var is=d(434);class hu extends Yo{constructor(e){super(e)}redirect(){E.ULS.sendTraceTag(592255192,324,100,"Navigate to view mode for translation");if(is.b(G.AFrameworkApplication.J)){var e=new fd.a;e.add("language",this.pFd);e.add("fromeditor","1");is.d("view",e,is.e)}else e=N.a.lq(Rd.a.hm.WAb,"language",this.pFd)+"&fromeditor=1",
wb.a.openWindow(1,e)}get kgi(){return!0}get qGo(){return ka.a.webServiceBase+"docdatahandler.ashx?"+G.AFrameworkApplication.rm+"&language="+Of.a.$i(this.pFd)+"&languagename="+Of.a.$i(this.pFd)+"&type=png&o15=1"}}Object(F.a)(hu,"TranslateDocumentRequestFromEditor",Yo,[]);class js{static u2j(e){(new hu(e)).start(ib.StaticActiveAppFrame.za().$J)}static Nxm(){return ka.a.webServiceBase+"translation.ashx?"+G.AFrameworkApplication.rm+"&uilang="+Of.a.$i(G.AFrameworkApplication.uiCulture)}static Jpm(){return ka.a.Xrd}}
js.Xrd=new tr(js.Nxm,js.Jpm);Object(F.a)(js,"TranslationManager",null,[]);class Ws extends Ig{constructor(e,n,C){super();this.Akp=n;this.enabled=C}go(){if(this.enabled){var e=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],n=e[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),C=e[OSF.DDA.Marshaling.NavigationKeys.GoToType];e=e[OSF.DDA.Marshaling.NavigationKeys.SelectionMode];var S=null;n&&n.startsWith("TranslatedDocument")&&(S=n.split("|"),S=2===S.length?S[1]:null);S?(js.u2j(S),
this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.we=this.lvn(C)&&this.Bvn(e)?this.ng.iTm(n,e,this.Akp,this.Ek):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;nl(15,this.Ek.Rn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(17585945,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to goToByIdAsync api"})}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}lvn(e){return e===
OSF.DDA.Marshaling.GoToType.Binding}Bvn(e){return e===OSF.DDA.Marshaling.SelectionMode.Default||e===OSF.DDA.Marshaling.SelectionMode.Selected||e===OSF.DDA.Marshaling.SelectionMode.None}}Object(F.a)(Ws,"GoToByIdAsyncMethod",Ig,[]);class Lo extends Ig{constructor(){super()}execute(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.ng){const e=this.oEf(this.ng.Vab(this.Ek));if(e){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const n={};n.Settings=e;this.result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=
n}}}oEf(e){const n={};let C=0;for(const S in e)n[""+C]=[S,e[S]],C++;return n}}Object(F.a)(Lo,"LoadSettingsMethod",Ig,[]);class Kr extends Ig{constructor(e){super();this.dxa=e}go(){let e;e=this.dxa?this.ng?this.ng.QNa.Kdj(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[$b.a.dgf],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
this.VNn(e)}qP(){nl(16,this.Ek.Rn,this.errorCode,null);this.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&E.ULS.sendTraceTag(18376392,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"MessageParent API failed!"})}VNn(e){this.we=e;this.qP();this.vo()}}Object(F.a)(Kr,"MessageParentMethod",Ig,[]);class Pq extends Ig{constructor(e){super();this.hyo=n=>{this.we=n;this.vo()};this.gZ=e}go(){if(this.gZ)if(this.ng){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];
e=e[OSF.DDA.Marshaling.BindingParameterKeys.Id]?this.ng.iyo(e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.Ek,this.hyo):OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;nl(14,this.Ek.Rn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(9225408,341,10,"{0}",{["error"]:e,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to releaseAppBindingById api"});
e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.we=e,this.vo())}}Object(F.a)(Pq,"ReleaseAppBindingMethod",Ig,[]);class Ip extends Ig{constructor(){super()}execute(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SettingsRequest];e=Array.isArray(e[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?e[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null;this.ng&&(this.we=this.ng.saveSettings(this.Ek,this.oEf(e)))}oEf(e){const n=
{};if(e)for(let C=0;C<e.length;C++){const S=Array.isArray(e[C])?e[C]:null;S&&1<S.length&&(n[S[0]]=S[1])}return n}}Object(F.a)(Ip,"SaveSettingsMethod",Ig,[]);class iu extends Ig{constructor(e,n,C,S,ja){super();this.sMj=(ya,kb)=>{this.we=ya;this.l0(kb)};this.LXe=e;this.LJe=n;this.gZ=C;this.IGb=S;this.iea=ja}go(){const e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];let n=null;if(this.gZ)if(this.ng)if(void 0===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||
void 0===e[OSF.DDA.Marshaling.SetDataKeys.Data]||null===e[OSF.DDA.Marshaling.SetDataKeys.Data]||void 0===e[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===e[OSF.DDA.Marshaling.BindingParameterKeys.Id])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{n=e[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();var C=e[OSF.DDA.Marshaling.SetDataKeys.Data].toString();const ja=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let ya;({XK:S}=this.ng.gGf(ja,this.Ek));if(S&&(ya=
S[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var S=ya[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.we=this.ng.wxg(this.Ek,ja,C);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.LXe){if(C.startsWith("<")){this.KXo(ja,C);return}this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.LJe){this.EVo(ja,C);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table)if(S===
OSF.DDA.Marshaling.CoercionTypeKeys.Table){if((this.we=({Bwj:C}=this.z4j(e,ya)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.ng.DSo(this.Ek,ja,e[OSF.DDA.Marshaling.SetDataKeys.Data],C,this.sMj);return}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)if(S===OSF.DDA.Marshaling.CoercionTypeKeys.Table||S===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix){if((this.we=({Bwj:C}=this.z4j(e,ya)).returnValue)===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.ng.BSo(this.Ek,ja,e[OSF.DDA.Marshaling.SetDataKeys.Data],C,this.sMj);return}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.l0(n)}z4j(e,
n){let C=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const S=n[OSF.DDA.Marshaling.AppBindingKeys.RowCount];n=n[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount];var ja=!!e&&(!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]);const ya={};(ya.isPartialTable=ja)?(ja=e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow],e=e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol],0>ja||ja>=S||0>e||e>=n?C=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn:
(ya.startRow=ja,ya.startCol=e)):(ya.startRow=0,ya.startCol=0);return{returnValue:C,Bwj:ya}}l0(e){nl(6,this.Ek.Rn,this.errorCode,{["CoercionType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(16795289,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to SetAppBindingData API",["CoercionType"]:e});this.vo()}EVo(e,n){this.ng.ASo(this.Ek,e,n,C=>{this.we=C;this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}KXo(e,n){const C=
new am(this.iea,this.IGb);C.rAe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Yvb(C.Tmb,n.length)});this.ng.CSo(this.Ek,e,n,S=>{C.Pfe?Kn(ek(C.YTd),!1):(C.clearTimeout(),this.we=S,this.Yvb(C.Tmb,n.length))})}Yvb(e,n){dk(!1,this.errorCode,n,ek(e),this.Ek.Rn);this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}Object(F.a)(iu,"SetAppBindingDataMethod",Ig,[]);class gq extends Ig{constructor(e,n){super();this.cGa=e;this.xz=n}execute(){if(this.cGa){var e=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],
n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Text],C,S;this.we=({XIa:C,jBb:S}=this.xz.eRb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(C.builtIn){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;As(21,this.errorCode,this.Ek);this.vo();return}const ja=S.cloneNode(!0);C.setNodeText(S,n)?1!==S.nodeType?this.xz.jjd(S,ja,e):(n=ja.childNodes,this.we=void 0!==n&&null!==n&&n.length?1===n.length&&3===n[0].nodeType?this.xz.jjd(S.firstChild,n[0],
e):this.xz.jjd(S.firstChild,ja,e):this.xz.Lno(S.firstChild,e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;As(6,this.errorCode,this.Ek);this.vo()}}Object(F.a)(gq,"SetDataNodeTextMethod",Ig,[]);class Ka extends Ig{constructor(e,n){super();this.cGa=e;this.xz=n}execute(){if(this.cGa){var e=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.Data],
C,S;this.we=({XIa:C,jBb:S}=this.xz.eRb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(C.builtIn){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.vo();return}const ja=S.cloneNode(!0);9!==S.nodeType&&1!==S.nodeType&&C.setNodeText(S,n)?this.we=this.xz.jjd(S,ja,e):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.vo()}}Object(F.a)(Ka,"SetDataNodeValueMethod",
Ig,[]);class $a extends Ig{constructor(e,n,C){super();this.cGa=e;this.xz=n;this.N5b=C}execute(){if(this.cGa){var e=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml],C,S;this.we=({XIa:C,jBb:S}=this.xz.eRb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(C.builtIn){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.vo();return}const ja=S.cloneNode(!0);if(n=C.setNodeXml(S,n)){({sud:C}=
this.xz.XJi(e));if(void 0!==C&&null!==C&&C[e.NodeIndex]===S)try{C[e.NodeIndex]=n}catch(ya){this.N5b.Mbj(e.NodeListCacheId)}this.we=this.xz.jjd(n,ja,e)}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.vo()}}Object(F.a)($a,"SetDataNodeXmlMethod",Ig,[]);class Hb extends Ig{constructor(e,n,C,S,ja){super();this.LJe=e;this.jnk=n;this.IGb=C;this.iea=S;this.dCk=ja.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeTableIsEnabled");
this.cCk=ja.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeMatrixIsEnabled");this.bCk=ja.$("WordEditorAppsForOfficeImageCoercionTypeIsEnabled")}go(){const e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];let n="";if(this.ng)if(void 0===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||void 0===e[OSF.DDA.Marshaling.SetDataKeys.Data]||null===e[OSF.DDA.Marshaling.SetDataKeys.Data])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{n=e[OSF.DDA.Marshaling.SetDataKeys.CoercionType].toString();if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Text){this.jjo(e);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.LJe){this.ejo(e);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.jnk){if(e[OSF.DDA.Marshaling.SetDataKeys.Data].toString().startsWith("<")){this.hjo(e);return}this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.dCk){this.ijo(e);return}if(n===
OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.cCk){this.gjo(e);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Image&&this.bCk){this.fjo(e);return}this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.l0(n)}ijo(e){this.ng.CZo(e[OSF.DDA.Marshaling.SetDataKeys.Data],n=>{this.we=n;this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Table)})}gjo(e){this.ng.zZo(e[OSF.DDA.Marshaling.SetDataKeys.Data],n=>{this.we=n;this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)})}jjo(e){this.ng.DZo(e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),
n=>{this.we=n;this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Text)})}ejo(e){this.ng.xZo(e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),n=>{this.we=n;this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}hjo(e){const n=e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),C=new am(this.iea,this.IGb);C.rAe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.zPj(C.Tmb,n.length)});this.ng.AZo(n,S=>{C.Pfe?Kn(ek(C.YTd),!1):(C.clearTimeout(),this.we=S,this.zPj(C.Tmb,n.length))})}fjo(e){const n=
e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),C=e[OSF.DDA.Marshaling.SetDataKeys.ImageWidth];e=e[OSF.DDA.Marshaling.SetDataKeys.ImageHeight];0>C||0>e?(this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Image)):this.ng.yZo(n,C,e,S=>{this.we=S;this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Image)})}zPj(e,n){dk(!1,this.errorCode,n,ek(e),this.Ek.Rn);this.l0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}l0(e){nl(2,this.Ek.Rn,this.errorCode,{["CoercionType"]:e});
this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&E.ULS.sendTraceTag(17585946,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Ek.Rn,["errMsg"]:"unexpected error to setSelectedDataAsync API",["CoercionType"]:e});this.vo()}}Object(F.a)(Hb,"SetSelectedDataMethod",Ig,[]);class uc extends Ig{constructor(){super()}go(){32===G.AFrameworkApplication.va.Ob(this.parameters[0],2)?this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
this.vo()}}Object(F.a)(uc,"ExecuteFeature",Ig,[]);class M extends Ig{constructor(){super()}go(){const e=G.AFrameworkApplication.va.Ob(this.parameters[0],1);this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.pu[0]=32===e;this.pu[1]=!0;this.vo()}}Object(F.a)(M,"QueryFeature",Ig,[]);class fa extends Fo{constructor(e,n,C,S,ja,ya,kb){super();this.cUe=e;this.Aa=n;this.iea=C;this.wl=S;this.N5b=ja;this.xz=ya;this.ui=kb}XFf(e){if(e=super.XFf(e))e.ng=this.cUe;return e}deo(){const e=this.Aa.$("WordEditorAppsForOfficeImportExternalHtmlDataIsEnabled")&&
Dk.a.TAe,n=this.Aa.$("WordEditorAppsForOfficeSelectionOoxmlIsEnabled"),C=this.Aa.jc("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3E4),S=this.Aa.$("WordEditorAppsForOfficeCustomXmlWriteIsEnabled"),ja=new qc.a;ja.W(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>{const Rb=this.Aa.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeHtmlIsEnabled"),sc=this.Aa.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeTableIsEnabled"),Fc=this.Aa.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeMatrixIsEnabled");
return new xp(Rb,n,sc,Fc,C,this.iea)});ja.W(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,()=>new Hb(e,n,C,this.iea,this.Aa));ja.W(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new wp);ja.W(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new Vs(this.ui));ja.W(OSF.DDA.MethodDispId.dispidAddDataPartMethod,()=>new Us(S,this.wl));ja.W(OSF.DDA.MethodDispId.dispidGetDataPartByIdMethod,()=>new Xp(this.wl));ja.W(OSF.DDA.MethodDispId.dispidGetDataPartsByNamespaceMethod,()=>new qt(this.wl));
ja.W(OSF.DDA.MethodDispId.dispidGetDataPartXmlMethod,()=>new yn(this.wl));ja.W(OSF.DDA.MethodDispId.dispidGetDataPartNodesMethod,()=>new Yp(this.wl,this.xz));ja.W(OSF.DDA.MethodDispId.dispidDeleteDataPartMethod,()=>new hp(S,this.wl));ja.W(OSF.DDA.MethodDispId.dispidGetDataNodeValueMethod,()=>new Nq(this.xz));ja.W(OSF.DDA.MethodDispId.dispidGetDataNodeXmlMethod,()=>new wk(this.xz));ja.W(OSF.DDA.MethodDispId.dispidGetDataNodeTextMethod,()=>new hs(this.xz));ja.W(OSF.DDA.MethodDispId.dispidGetDataNodesMethod,
()=>new yj(this.xz));ja.W(OSF.DDA.MethodDispId.dispidSetDataNodeValueMethod,()=>new Ka(S,this.xz));ja.W(OSF.DDA.MethodDispId.dispidSetDataNodeXmlMethod,()=>new $a(S,this.xz,this.N5b));ja.W(OSF.DDA.MethodDispId.dispidSetDataNodeTextMethod,()=>new gq(S,this.xz));ja.W(OSF.DDA.MethodDispId.dispidAddDataNamespaceMethod,()=>new Go(S,this.wl));ja.W(OSF.DDA.MethodDispId.dispidGetDataUriByPrefixMethod,()=>new Li(this.wl));ja.W(OSF.DDA.MethodDispId.dispidGetDataPrefixByUriMethod,()=>new Oq(this.wl));const ya=
this.Aa.$(fa.uRh),kb=this.Aa.$(fa.r6k);ja.W(OSF.DDA.MethodDispId.dispidGetBindingMethod,()=>new sr(ya));ja.W(OSF.DDA.MethodDispId.dispidGetAllBindingsMethod,()=>new gs(ya));ja.W(OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod,()=>new Ko(kb));ja.W(OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod,()=>new vp(kb));ja.W(OSF.DDA.MethodDispId.dispidSetBindingDataMethod,()=>new iu(n,e,kb,C,this.iea));ja.W(OSF.DDA.MethodDispId.dispidGetBindingDataMethod,()=>new hm(n,ya,C,this.iea));ja.W(OSF.DDA.MethodDispId.dispidReleaseBindingMethod,
()=>new Pq(kb));ja.W(OSF.DDA.MethodDispId.dispidAddColumnsMethod,()=>new Nt(kb));ja.W(OSF.DDA.MethodDispId.dispidAddRowsMethod,()=>new Mq(kb));ja.W(OSF.DDA.MethodDispId.dispidClearAllRowsMethod,()=>new tm(kb));Dk.a.bBe?(ja.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new Ln),ja.W(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new cn),ja.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new hl)):(ja.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>Ig.nYd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),
ja.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>Ig.nYd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),ja.W(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>Ig.nYd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)));ja.W(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>{const Rb=this.Aa.$("WordEditorExtensionRichAPIIsEnabled");return new ip(Rb)});ja.W(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>new Lo);ja.W(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,
()=>new Ip);ja.W(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>{const Rb=this.Aa.$(fa.uRh);return new Ws(Kf.a.instance,Object(Zh.a)().Ie.ge,Rb)});ja.W(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>{const Rb=this.Aa.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new Kr(Rb)});ja.W(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>{const Rb=this.Aa.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new eo(Rb)});ja.W(OSF.DDA.MethodDispId.dispidExecuteFeature,()=>new uc);ja.W(OSF.DDA.MethodDispId.dispidQueryFeature,
()=>new M);ja.W(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new Gp);ja.W(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>{const Rb=this.Aa.$("WordEditorAppsForOfficeSingleSignOnIsEnabled");return new fs(Rb,this.ui)});ja.W(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new bn(this.ui));return ja}}fa.uRh="WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled";fa.r6k="WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled";Object(F.a)(fa,"WordEditorMethodFactory",Fo,[]);
class Va{constructor(e,n){this.Cv=e;this.Eyc=n}async Kse(){jh.a.FD&&this.Cv.ccc.count&&this.Eyc.vue()}}Object(F.a)(Va,"WritingAssistanceAddInHelper",null,[]);class Fb extends Cg{constructor(){super()}wc(e){if(Rd.a.hud||Rd.a.P2f||rl.a.fTb||G.AFrameworkApplication.QKb||G.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")||G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")){super.wc(e);var n=G.AFrameworkApplication.J.$("WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled"),C=G.AFrameworkApplication.J.$("WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled"),
S=G.AFrameworkApplication.J.$("WordEditorContentControlReadIsEnabled"),ja=G.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled");e.ia("WordEditor.AppsForOffice.GetFileApiHelper",()=>new Pe(Pe.WSd,()=>G.AFrameworkApplication.rootQuerySignature,vm.PageReader.instance,ib.StaticActiveAppFrame.za().kb.hd,new wl.a,G.AFrameworkApplication.J,e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("WordEditor.AppsForOffice.IGetFileApiHelper").ha();e.ia("Box4.AppsForOffice.ShowDialogApiHelper",
()=>new ff(ib.StaticActiveAppFrame.za(),e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("Box4.AppsForOffice.IShowDialogApiHelper").ha();S&&n&&e.ia("WordEditor.AppsForOffice.AppBindingHelper",()=>new Cd(e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel"),e.resolve("WordEditor.ContentControl.IContentControlManager"),Kf.a.instance,new Rg.a,new id.a(()=>ib.StaticActiveAppFrame.za().kb.hd.ud),
e.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),e.resolve("WordEditor.ITableEditor"),e.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),e.resolve("Box4.ContentControlParagraphMapping"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("WordEditor.AppsForOffice.IAppBindingHelper").ha();e.ia("WordEditor.AppsForOffice.TableMatrixHelper",()=>new Ke(G.AFrameworkApplication.va,Kf.a.instance,e.resolve("WordEditor.ITableEditor"))).ha();e.ia("WordEditor.AppsForOffice.CustomXmlHelper",
()=>new Wk(e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),e.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"))).as("WordEditor.AppsForOffice.ICustomXmlHelper").ha();e.ia("WordEditor.AppsForOffice.CustomXmlNodeListCache",()=>new ih(new id.a(()=>G.AFrameworkApplication.J.jc("WordEditorCustomXmlMaximumDataCollectionNumber",1024)),e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).as("WordEditor.AppsForOffice.ICustomXmlNodeListCache").ha();e.ia("WordEditor.AppsForOffice.OoxmlSelectionManager",
()=>new Cl(G.AFrameworkApplication.ua.Vr,()=>vm.PageReader.instance.G6d(ib.StaticActiveAppFrame.za().kb.hd),()=>G.AFrameworkApplication.rootQuerySignature,e.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Qc.a.iU,G.AFrameworkApplication.J.$("AppsForOfficeFixIpIssueForInsertOoxmlIsEnabled"))).as("WordEditor.AppsForOffice.IOoxmlSelectionManager").ha();e.ia("WordEditor.AppsForOffice.OoxmlRangeManager",()=>new Th(e.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"))).as("WordEditor.AppsForOffice.IOoxmlRangeManager").ha();
e.ia("WordEditor.AppsForOffice.HtmlDataGetSetProvider",()=>new Od(Kf.a.instance,e.Oa("Box4.Actors.InternalClipboard"),G.AFrameworkApplication.va,e.resolve("Box4.IHtmlViewRootFactory"),ob.a.Asa())).as("WordEditor.AppsForOffice.IHtmlDataGetSetProvider").ha();e.ia("WordEditor.AppsForOffice.WordEditorApiObjectModel",()=>new Vl(Kf.a.instance,G.AFrameworkApplication.va,e.resolve("WordEditor.AppsForOffice.GetFileApiHelper"),e.resolve("Box4.AppsForOffice.IShowDialogApiHelper"),e.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),
e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),e.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"),e.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),e.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),new Rg.a,S&&n?e.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):null,e.resolve("WordEditor.Extension.DocumentFactory"),e.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),new Nb.a,e.resolve("Box4.IParagraphReader"),cc.a.instance)).as("WordEditor.AppsForOffice.IWordEditorApiObjectModel").ha();
e.ia("WordEditor.AppsForOffice.WindowTimer",()=>new ed).as("WordEditor.AppsForOffice.IWindowTimers").ha();e.ia("WordEditor.AppsForOffice.WordEditorMethodFactory",()=>new fa(e.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"),G.AFrameworkApplication.J,e.resolve("WordEditor.AppsForOffice.IWindowTimers"),e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),e.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"),e.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("Common.App.AppsForOfficeCommon.IApiMethodFactory").ha();
e.ia("WordEditor.AppsForOffice.WordEditorEventStore",()=>Sm.MFl(e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),e.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"))).as("Common.App.AppsForOfficeCommon.IApiEventStore").ha();e.ia("WordEditor.AppsForOffice.WordEditorApiThrottleStore",()=>new tq(new OsfRuntime.Throttling.ThrottleFactory,G.AFrameworkApplication.J)).as("Common.App.AppsForOfficeCommon.IApiThrottleStore").ha();e.ia("Common.App.AppsForOfficeCommon.ApiManager",
()=>new Kl(e.resolve("WordEditor.AppsForOffice.WordEditorMethodFactory"),e.resolve("WordEditor.AppsForOffice.WordEditorEventStore"),e.resolve("WordEditor.AppsForOffice.WordEditorApiThrottleStore"))).as("Common.App.AppsForOfficeCommon.IApiManager").ha();e.ia("Box4.SetDataVirtualSelectionMerger",()=>new fl).as("Box4.Actors.IVirtualSelectionMerger").ha();e.ia("WordEditor.AppsForOffice.WritingAssistanceAddInHelper",()=>new Va(e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),e.resolve("Box4.Proofing.SuggestionRerenderer"))).as("WordEditor.AppsForOffice.WritingAssistanceAddInHelper").ha();
e.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor",()=>new mo(e.nf("Common.App.AppsForOfficeCommon.IAppsForOfficeManager"),null,e.nf("Common.App.AppsForOfficeCommon.IContextActivationManager"),ae.FocusManager.instance(),pd.a.instance,G.AFrameworkApplication.va,G.AFrameworkApplication.J,e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),null,
Lc.a.instance,e.resolve("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager"),null,e.resolve("WordEditor.AppsForOffice.WritingAssistanceAddInHelper"))).as("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").ha();e.ia("Wonca.AppsForOffice.SaveSettingsHelper",()=>new kj(new Rg.a)).ha();e.ia("Wonca.AppsForOffice.AddinActivator",()=>new Ci(e.nf("Common.App.AppsForOfficeCommon.IContextActivationManager"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),e.resolve("Wonca.AppsForOffice.SaveSettingsHelper"))).as("Wonca.IAddinActivator").ha();
e.ia("WordEditor.AppsForOffice.AppsForOfficeApiActor",()=>new rf(G.AFrameworkApplication.va,el.a.instance,e.resolve("Box4.IOutlineEditor"),e.resolve("Box4.ICharacterPropertiesEditor"),new Rg.a,e.nf("Box4.Actors.IClipboardOperationFactory"),e.resolve("Box4.IClipboardDataHelper"),G.AFrameworkApplication.J,Uc.a.instance,e.resolve("Common.Utils.Telemetry.ITelemetry"),e.resolve("Box4.Actors.IExternalPasteCssConverter"))).ha();e.ia("WordEditor.AppsForOffice.WordEditorAfoSettingsModel",()=>new kc(new sg)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel").ha();
e.ia("Wonca.AppsForOffice.BackCompatImageUploaderWrapper",()=>new qd).as("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper").ha();e.ia("Wonca.IFrameEditors.AddinEditor",()=>new Bj(e.resolve("WordEditor.IImageEditor"),e.resolve("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper"))).as("Wonca.IFrameEditors.IAddinEditor").ha();e.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel",()=>new Ua(Object(sd.a)(),new Rg.a,new df,e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel"),
e.resolve("Wonca.IFrameEditors.IAddinEditor"),G.AFrameworkApplication.va,el.a.instance)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").ha();e.ia("Common.App.AppsForOfficeCommon.AppsForOfficeManager",()=>new mi(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"))).as("Common.App.AppsForOfficeCommon.IAppsForOfficeManager").ha();e.ia("Common.App.AppsForOfficeCommon.HostControlInfo",()=>new Ag(e.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),
e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).ha();e.register(Zr,"WordEditor.AppsForOffice.WordEditorActivationSettingsProvider").as("Common.App.AppsForOfficeCommon.IActivationSettingsProvider").ha();e.ia("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory",()=>new Hf(e.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"))).ha();e.ia("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory",()=>new fn(e.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory").create(),
e.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"),e.resolve("Common.App.AppsForOfficeCommon.HostControlInfo"))).ha();e.ia("Common.App.AppsForOfficeCommon.IContextActivationManager",()=>{const ya=e.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory").create();ya.setOAuthManager(e.resolve("Common.App.OAuth.IOAuthManager"));return ya});e.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager",()=>new sh(e.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager"),
null,e.resolve("Common.App.AppsForOfficeCommon.ApiManager"),e.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),ja&&C?e.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):null,G.AFrameworkApplication.J,e.resolve("WordEditor.AppsForOffice.AppsForOfficeApiActor"))).ha();this.Z.ia("WordEditor.AppsForOffice.ApiOperationChecker",()=>new lg).as("WordEditor.AppsForOffice.IApiOperationChecker").ha();this.Z.ia("Box4.AppsForOffice.IInitializeHelper",
()=>new Zb).ha()}}get name(){return"WordEditor.AppsForOffice"}init(){if(Rd.a.hud){var e=this.Z.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider");e.JWc=!0;G.AFrameworkApplication.J.$("OcpsIsEnabled")?this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("ConnectedServices",!0).then(C=>{e.JWc=C;this.initInternal();return null})}):this.initInternal()}}initInternal(){this.f4b=this.Z.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager");
G.AFrameworkApplication.J.vp(()=>{this.f4b.initialize();ib.StaticActiveAppFrame.za().Ge();if(G.AFrameworkApplication.J.$("SdxIsEnabled")){var n={};n.Application=G.AFrameworkApplication.J.jb("Application");n.SdxDmsUrl=G.AFrameworkApplication.J.jb("SdxDmsUrl");n.SovereignFederationDMSToken=G.AFrameworkApplication.J.jb("SovereignFederationDMSToken");n.SovereignFederationDMSTokenSuffix=G.AFrameworkApplication.J.jb("SovereignFederationDMSTokenSuffix");n.SdxCdnUrl=G.AFrameworkApplication.J.jb("SdxCdnUrl");
n.Sdx1CdnUrl=G.AFrameworkApplication.J.jb("Sdx1CdnUrl");n.ForceUseSdx1Cdn=G.AFrameworkApplication.J.$("ForceUseSdx1Cdn");n.UICulture=G.AFrameworkApplication.J.jb("UICulture");n.LoggableUserId=G.AFrameworkApplication.J.jb("LoggableUserId");n.SessionStartInfoJson=G.AFrameworkApplication.J.jb("SessionStartInfoJson");n.StaticContentUrl=G.AFrameworkApplication.J.jb("StaticContentUrl");n.DmsSdxList=G.AFrameworkApplication.Ggi;var C={};C.generalParameters=n;C.flightingTreatmentVariables=G.AFrameworkApplication.J.j8a;
OfficeExt.SDXCatalog.InitializeSdx(C);let ja=!1;n=0;if(G.AFrameworkApplication.J.$("AppsForOfficeSharedRuntimeIsEnabled")){C=this.f4b.bdc.ruj();for(var S of C)OfficeExt.SDXCatalog.MarkSdxPreloadStart(S),mo.Ohc===Of.a.xh(S)&&(ja=!0,n=mo.eKj)}OfficeExt.SDXCatalog.PrefetchSdxAssets(G.AFrameworkApplication.J.appSettings,G.AFrameworkApplication.J.j8a,G.AFrameworkApplication.J.jb("Application"),"*");rl.a.fTb&&OfficeExt.SDXCatalog.PrefetchSdxAssets(G.AFrameworkApplication.J.appSettings,G.AFrameworkApplication.J.j8a,
G.AFrameworkApplication.J.jb("Application"),"fa000000029");S=G.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationDelayInMilliseconds",1E4);S+=n;G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationIsEnabled",!1)&&(OfficeExt.SDXCatalog.PrefetchSdxAssets(G.AFrameworkApplication.J.appSettings,G.AFrameworkApplication.J.j8a,G.AFrameworkApplication.J.jb("Application"),mo.Ohc),window.setTimeout(()=>{const ya=new Yn.a(mo.Ohc,
OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),kb=new Tl.a("WordOnline","Web","en-Us"),Rb=new jm.a;Rb.optionalProperties[Kk.a.pV]="Experimentation SDX";Rb.optionalProperties[Kk.a.taskPaneWidth]=0;if(ja){const sc={};sc.hostAddinActivationTimeStamp=Date.now();Rb.optionalProperties[Kk.a.ILh]=sc;Rb.optionalProperties[Kk.a.sourceLocationOverrideResourceId]=mo.eBf;gn.a.instance.p2f(ya,io.a.z_j,"",kb,Rb)}gn.a.instance.p2f(ya,io.a.action,"AddinActivationAction",kb,Rb)},S))}});const e=this.Z.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager");
this.Z.resolve("Box4.AppsForOffice.IInitializeHelper").VVf(()=>{e.initialize()});this.Z.resolve("WordEditor.ContentControl.IContentControlManager").cdl(this.Z.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))}}Object(F.a)(Fb,"AppsForOfficePackage",Cg,[]);class Vb{constructor(){this.correlationId=this.sessionId=this.z4e=null;this.actionId=0;this.rd=null}get Vg(){return this.z4e?this.z4e:""}set Vg(e){this.z4e=e}}Object(F.a)(Vb,"AssistanceSearchVariableUrlParameterSet",null,[]);var wc=d(238);
class Xc{constructor(){this.vi=!1;this.B1=!0;this.kDh=this.CDc=null}get isInitialized(){return this.vi}initialize(e,n){const C=!!e&&!!n;C&&(this.CDc=e,this.kDh=n);this.vi=C;G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||gc.a.instance.Ta("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(S=>{S.cN("Enabled").then(ja=>{this.B1=ja;return null},()=>null)})}Xb(e){e||
(e=G.AFrameworkApplication.va);G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.B1=G.AFrameworkApplication.VE,gc.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("mso_sendASmile",!0).then(C=>{this.B1=G.AFrameworkApplication.VE&&C;(C=G.AFrameworkApplication.ua)&&C.Ge();return null},()=>null)}));e.qa(T.a.d_b,X.a.frame,Object(ic.a)(this,
this.I9o,"showSearchResults"))}I9o(e,n,C,S,ja){if(1===C)return G.AFrameworkApplication.J.$("IsFeedbackExperiencesAvailable")||(this.B1=!1),ja&&"SourceControlId"in ja&&(ja=ja.SourceControlId,("GiveFeedback"===ja||"btnFeedback"===ja||"btnFeedbackPane"===ja||"PptEditingStatusBar.GiveFeedbackPane"===ja||"GiveFeedbackPane"===ja)&&!this.B1)?8:qn.SessionStatusManager.instance.Jk?8:32;E.ULS.sendTraceTag(4761738,1302,50,"");wc.a.mark(4771);if(this.isInitialized){e=ja.CommandValueId;n=ja.SourceControlId;ja=
Object.assign(new Vb,{actionId:T.a.d_b,rd:ja});if(void 0!==e&&null!==e)ja=Xc.zQm(e);else if(void 0!==n&&null!==n)switch(n){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":ja.actionId=T.a.yla;break;case "btnContactSupport":case "ContactSupport":ja.actionId=T.a.$5h;break;case "btnShowTraining":case "Training":ja.actionId=T.a.i2j;break;case "btnWhatsNew":case "WhatsNew":ja.actionId=T.a.fNg}this.CDc.A7o(this.kDh,ja);wc.a.mark(4772);
return 32}wc.a.mark(4772);return 8}dispose(){this.CDc&&(this.CDc.dispose(),this.CDc=null)}static get instance(){Xc._instance||(Xc._instance=new Xc);return Xc._instance}static zQm(e){const n=new Vb,C=e.indexOf("|");n.sessionId=e.substring(0,C);const S=e.indexOf("|",C+1);n.correlationId=e.substring(C+1,S);n.Vg=e.substr(S+1);return n}}Xc._instance=null;Object(F.a)(Xc,"AssistanceActor",null,[10]);class vd{constructor(){this.m9g=this.Aa=this.i4b=null;this.B2e=!1}A7o(e,n){if(n.actionId!==T.a.yla||G.AFrameworkApplication.VE)if(this.B2e&&
!G.AFrameworkApplication.hL)this.i4b||(this.i4b=this.m9g()),this.i4b.mS(e,n);else if(n.actionId===T.a.yla)this.j7o();else{e=e.getUrl(n);n=null;try{Of.a.GX(e)&&(n=wb.a.Tm(e,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no","AssistanceDisplayManager:HelpWindow"))}catch(C){throw E.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+
C.message),C;}n?E.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",e):E.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",e,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else E.ULS.sendTraceTag(554295451,356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.i4b&&
(this.i4b.dispose(),this.i4b=null)}YQj(e,n,C){C&&ld.c(e)?this.B2e=!1:(this.m9g=e,this.B2e=C);this.Aa=n}j7o(){G.AFrameworkApplication.va.Ob(T.a.yla,2)}static createInstance(e,n,C=null){const S=new vd;null==C?S.YQj(e,n,G.AFrameworkApplication.AUh||n.$("HelpTabIsEnabled")):S.YQj(e,n,C);return S}}Object(F.a)(vd,"AssistanceDisplayManager",null,[45,10]);class Dd{constructor(e,n,C,S,ja){this.Z9=e;this.gHd=n;this.pGd=C;this.Qnk=S;this.ith=ja}get lcid(){return this.Z9}get namespace(){return this.gHd}get kbb(){return this.pGd}get l$k(){return this.Qnk}get locale(){return this.ith}static PPm(e){const n=
e.indexOf(".");return 0<=n&&n<e.length&&(e=parseInt(e.substring(0,n)),!isNaN(e))?e:Dd.xal}static createInstance(e){return new Dd(G.AFrameworkApplication.lcid,e,Dd.PPm(G.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",ac.a.Eg(G.AFrameworkApplication.lcid).name)}}Dd.xal=16;Object(F.a)(Dd,"AssistanceSearchUrlParameterSet",null,[]);class Ce{constructor(e,n){e=new Sj.QueryStringBuilder(e);e.Ae("clid",n.lcid.toString());e.Ae("p1",n.namespace);e.Ae("ver",n.kbb.toString());
e.Ae("apps",n.l$k);e.Ae("lc",n.locale);this._url=e.toString()}getUrl(e){const n=new Sj.QueryStringBuilder(this._url);n.Ae("src","TellMe");n.Ae("query",e.Vg);n.Ae("sessionid",e.sessionId);n.Ae("correlationid",e.correlationId);return n.toString()}static createInstance(e){return new Ce(G.AFrameworkApplication.BUh,e)}}Object(F.a)(Ce,"AssistanceSearchUrlProvider",null,[31]);class ea{wc(){}init(){G.AFrameworkApplication.QKb&&!G.AFrameworkApplication.dBe&&Xc.instance.Xb(G.AFrameworkApplication.va)}dispose(){Xc.instance.dispose()}bRi(e){Xc.instance.initialize(vd.createInstance(e,
G.AFrameworkApplication.J),Ce.createInstance(Dd.createInstance("WDWAEndUser")))}}Object(F.a)(ea,"AssistancePackage",null,[0,1]);class Xa{}Xa.ktc=1;Xa.BD="AssistanceTaskPane";Xa.width=330;Xa.dGg="AssistanceTaskPaneData";Xa.MSf="AssistanceContentFrame";Object(F.a)(Xa,"AssistanceConstants",null,[]);var yb=d(35),Ub=d(1397);class yc{constructor(e){this.w1e=this.x1e=this.BC=this.Pj=null;this.lWn=n=>{n===this.Pj&&this.Fsa()};this.rsc=n=>{E.ULS.sendTraceTag(4474517,1302,50,"The resource at {0} is loaded successfully in assistance task pane",
n.target.src);wc.a.mark(4776)};this.Uvb=n=>{E.ULS.sendTraceTag(4474518,1302,15,"Loading the resource at {0} failed in assistance task pane",n.target.src);wc.a.mark(4776)};wc.a.mark(4773);this.SNd=e;this.g2();this.$A();wc.a.mark(4774)}g2(){this.Pj=this.SNd.QXc();this.jUf(this.Pj.K_a.cWh);this.Pj.aqg(this.lWn);this.Pj.xn()}$A(){yb.a.addHandler(this.BC,"load",this.x1e=this.rsc);yb.a.addHandler(this.BC,"error",this.w1e=this.Uvb)}Rca(){yb.a.removeHandler(this.BC,"load",this.x1e);this.x1e=null;yb.a.removeHandler(this.BC,
"error",this.w1e);this.w1e=null}dispose(){this.Rca();this.BC.parentNode.removeChild(this.BC);this.BC=null;this.Pj&&(this.SNd.Cgc(Xa.BD,this.Pj),this.Pj=null)}Muf(){this.BC.src=yc.bwh;this.Pj.yn()}mS(e,n){e=e.getUrl(n);wc.a.mark(4775);this.BC.src=e;this.Pj.f0?this.Pj.xn():this.SNd.showTaskPane(this.Pj)}Fsa(){this.SNd.hideTaskPane(this.Pj);this.Muf()}jUf(e){const n=Ub.a.createElement("iframe");n.src=yc.bwh;n.style.height="100%";this.BC=n;e.appendChild(this.BC);n.id=Xa.MSf}}yc.bwh="about:blank";Object(F.a)(yc,
"AssistancePane",null,[34,10]);var ad=d(1049),md=d(1033),Sd=d(147);class ze{QXc(){const e=new md.a(Sd.a.Z5a,Box4Intl.Box4Strings);return Lc.a.instance.Vai(Xa.BD,Xa.ktc,Xa.width,Xa.dGg,e)}showTaskPane(e){e.f0||(ib.StaticActiveAppFrame.za().Leb.bVj(e.id),e.show(),Rd.a.hm.B5a(Object(ic.a)(e,e.xn,"pollForStateAndUpdate")),Rd.a.hm.Ge())}hideTaskPane(e){Lc.a.instance.hideTaskPane(e)}Cgc(e,n){Lc.a.instance.Cgc(e,n)}}Object(F.a)(ze,"WordEditorTaskPaneHandler",null,[1090]);class Ne extends ea{constructor(){super();
this.XCb=this.FIh=null}get name(){return"WordEditor.Assistance"}wc(e){this.Z=e}init(){super.init();G.AFrameworkApplication.QKb&&(G.AFrameworkApplication.J.$("HelpTabIsEnabled")&&G.AFrameworkApplication.VE&&!G.AFrameworkApplication.hL?(this.FIh=this.Z.Oa("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.bRi(()=>new si(this.FIh,this.XCb,ad.a.F2c()))):this.bRi(()=>new yc(new ze)))}}Object(F.a)(Ne,"WordEditorAssistancePackage",ea,[]);var ng=d(1106);class Ng{create(){return new ng.a}}Object(F.a)(Ng,
"CustomXmlPartNodeFactory",null,[284]);class uh{constructor(e){this.N0e=0;this.N5a=new fd.a;this.YJb=e}RKf(){if(this.N0e===Number.MAX_VALUE)throw E.ULS.sendTraceTag(19276675,366,10,"The namespace count reach the maximum allowed number"),Error.create("The namespaces count is larger than the maximum allowed number");const e="ns"+this.N0e.toString();this.N0e++;return e}g_i(e){return void 0===e||null===e?!1:""!==this.I3c(e)?!0:!1}isDefaultNamespace(e){return void 0===e||null===e?!1:"http://www.w3.org/XML/1998/namespace"===
e}Nri(){if(void 0!==this.YJb&&null!==this.YJb){var e=RegExp('xmlns=["\']([^"]*)["\']|xmlns:([^=]*)="([^"]*)"',"g"),n,C="";for(this.g_i("http://www.w3.org/XML/1998/namespace")||this.N5a.add("xml","http://www.w3.org/XML/1998/namespace");n=e.exec(this.YJb);)void 0!==n[1]&&null!==n[1]?C=n[1]:void 0!==n[3]&&null!==n[3]&&(C=n[3]),""===C||this.g_i(C)||this.N5a.add(this.RKf(),C)}}addNamespaceMapping(e,n){if(void 0===n||null===n||""===n||void 0===e||null===e||""===e)return E.ULS.sendTraceTag(19276676,366,
10,"The namespace or prefix is empty"),!1;if(this.N5a.tb(e))return E.ULS.sendTraceTag(19714131,366,10,"The prefix is already exists"),!1;this.N5a.add(e,n);return!0}LKf(e){if(void 0===e||null===e||""===e)return"";let n;({value:n}=this.N5a.Ec(e,n));return void 0===n||null===n?"":n}I3c(e){if(void 0===e||null===e||""===e)return"";let n="";for(const C of this.N5a)if(C.value===e){n=C.key;break}return n}KKm(){this.Nri();let e=" ";for(const n of this.N5a)e=e+"xmlns:"+n.key+'="'+n.value+'" ';return e.trim()}}
Object(F.a)(uh,"XmlNamespaceManager",null,[]);class Oh{constructor(e,n){this.YJb=this.s3a=this.Rc=this.O5b=this._id=this.yxa=null;this.u$g=!1;this.gHd=null;this.init(e,n)}get P0a(){return this.YJb}get builtIn(){return this.u$g}get namespace(){return this.gHd}get id(){return this._id}get cR(){return this.O5b}selectNodes(e,n){return this.yxa.value.selectNodesByXPath(e,n)}getNodeXml(e){return this.yxa.value.getNodeXml(e)}setNodeXml(e,n){if(void 0!==n&&null!==n&&n.length>Oh.u7f)return null;e=this.yxa.value.setNodeXml(e,
n);void 0!==e&&null!==e&&(this.save(),this.c8j(n));return e}getNodeText(e){return this.yxa.value.getNodeText(e)}setNodeText(e,n){return void 0!==n&&null!==n&&n.length>Oh.u7f?!1:this.yxa.value.setNodeText(e,n)?(this.save(),!0):!1}getNodeBaseName(e){return this.yxa.value.getNodeBaseName(e)}getNodeNamespaceURI(e){return this.yxa.value.getNodeNamespaceURI(e)||""}getNodeType(e){return this.yxa.value.getNodeType(e)}I3c(e){return this.s3a.I3c(e)}LKf(e){return this.s3a.LKf(e)}wNh(e,n){const C=this.s3a.addNamespaceMapping(e,
n);C&&this.yxa.value.addNamespaceMapping(e,n);return C}appendChild(e,n){if(void 0!==n&&null!==n&&n.length>Oh.u7f)return null;e=this.yxa.value.appendChild(e,n);void 0!==e&&null!==e&&(this.save(),this.c8j(n));return e}VYf(){return this.P0a===this.O5b.getValue(hb.a.i7a)}kLg(){this.init(this.O5b,this.Rc)}save(){const e=this.Rc.Lc(4);e.Ab(this.O5b);const n=this.yxa.value.getDocumentElement();this.YJb=this.getNodeXml(n);this.O5b.setValue(hb.a.i7a,this.P0a);e.dispose()}init(e,n){this._id=e.getValue(hb.a.rNb);
this.YJb=e.getValue(hb.a.i7a);this.u$g=e.getValue(hb.a.Wfc);this.gHd=e.getValue(hb.a.dZd);this.s3a=new uh(this.P0a);const C=this.s3a.KKm();this.yxa=new id.a(()=>new OSF.XmlProcessor(this.P0a,C));this.O5b=e;this.Rc=n}c8j(e){e=new uh(e);e.Nri();e=e.N5a;for(const n of e.keys)if(!this.s3a.isDefaultNamespace(e.K(n)))try{let C=this.s3a.RKf();for(;this.s3a.N5a.tb(C);)C=this.s3a.RKf();this.wNh(C,e.K(n))}catch(C){E.ULS.sendTraceTag(20306075,366,10,"Cannot update namespace mapping as the namespace count has reached the maximum allowed number")}}}
Oh.u7f=1048576;Object(F.a)(Oh,"CustomXmlDocument",null,[1091]);class Hj{constructor(e,n,C){this.OFc=null;this.TKh=new If.a;this.zz=e;this.NFc=n;this.Rc=C}get Gka(){if(void 0===this.OFc||null===this.OFc||23!==this.OFc.role)this.OFc=this.gpm();return this.OFc}gpm(){const e=new Ed.a;e.set(this.zz.value);Object(sd.a)().ZR(e);e.Vb(23);return void 0!==e&&null!==e&&52===e.uf?e:null}w5d(e,n=!1){const C=[],S=this.Gka;if(S){let ja=S.Vb(24);for(;ja;){const ya=ja.getValue(hb.a.dZd),kb=ja.getValue(hb.a.Wfc);ya===
e&&kb===n&&C.push(ja);ja=S.Kf(24)}}return C}QHf(e){let n=null;const C=this.Gka;if(C)for(var S=C.Vb(24);S;){S=S.getValue(hb.a.rNb);if(Pg.a.vh().equals(S,e)){n=C;break}S=C.Kf(24)}return n}owi(e){const n=e.getValue(hb.a.rNb),C=e.getValue(hb.a.i7a),S=this.TKh.K(n);void 0!==S&&null!==S&&S.P0a===C?e=S:(e=new Oh(e,this.Rc),this.TKh.add(e.id,e),void 0!==S&&null!==S&&S.P0a!==C&&E.ULS.sendTraceTag(9187598,366,50,"Custom xml id: {0} is out of date",n));return e}I1c(){const e=[],n=this.Gka;if(n)for(var C=n.Vb(24);C;)C=
this.owi(C),e.push(C),C=n.Kf(24);return e}qVa(e){let n=null;if(e=this.QHf(e))n=e.currentNode;return n?this.owi(n):null}Bdf(e){let n=null;if(e.length>Hj.ALn)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,ced:n};var C=new OSF.XmlProcessor(e,"");if(C.isValidXml()){const S=this.Rc.Lc(4);S.ju(this.Gka);C=C.getNodeNamespaceURI(C.getDocumentElement());const ja=this.Gka;n=this.NFc.create(cj.a.cR);const ya=new Wc.a(Tj.a.create(),1);n.setValue(hb.a.rNb,"{"+Mf.e(ya.Gt.toString())+"}");
n.setValue(hb.a.i7a,e);n.setValue(hb.a.dZd,C||"");n.setValue(hb.a.Wfc,!1);ja.d6(n,24,ya);S.dispose();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ced:n}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,ced:n}}Zdi(e){if(e=this.QHf(e)){if(e.currentNode.getValue(hb.a.Wfc))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;const n=this.Rc.Lc(4);n.ju(this.Gka);e.Tg();n.dispose();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}HTo(e,
n){if(e=this.QHf(e)){const C=e.currentNode;C.getValue(hb.a.Wfc)||(e=this.Rc.Lc(4),e.ju(this.Gka),C.setValue(hb.a.i7a,n),e.dispose())}}hXf(e){return e.builtIn&&"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties"===e.namespace}}Hj.ALn=1048576;Object(F.a)(Hj,"WordEditorCustomXmlManager",null,[1070]);class Da{get name(){return"WordEditor.CustomXml"}init(){}dispose(){}wc(e){e.ia("WordEditor.CustomXmlPartNodeFactory",()=>new Ng).ha();e.ia("WordEditor.CustomXml.WordEditorCustomXmlManager",
()=>new Hj(new id.a(()=>ib.StaticActiveAppFrame.za().kb.hd),gc.a.instance.resolve("WordEditor.CustomXmlPartNodeFactory"),new Rg.a)).as("WordEditor.CustomXml.IWordEditorCustomXmlManager").ha()}static main(){R.a.instance.Mc(new Da)}}Object(F.a)(Da,"CustomXmlPackage",null,[0,1]);var Ib;(function(e){e[e.xOg=0]="Boot";e[e.wOg=1]="BeforeOpen";e[e.$Pg=2]="OnPaneOpen";e[e.ZPg=3]="OnPaneClose"})(Ib||(Ib={}));Object(F.b)("ReadyTime",Ib);class hc{constructor(e,n,C,S,ja){this.container=e;this.fu=n;this.actors=
C;this.RL=S;this.lfg=(ya,kb)=>{kb.data?this.RL.le(()=>{this.Wd(this.fu.get(Ib.ZPg));this.initialize(this.fu.get(Ib.$Pg))},"WD:IOO"):this.RL.le(()=>{this.Wd(this.fu.get(Ib.wOg));this.Wd(this.fu.get(Ib.$Pg));this.initialize(this.fu.get(Ib.ZPg))},"WD:DOC")};this.zWn=()=>{this.RL.le(()=>this.initialize(this.fu.get(Ib.wOg)),"WD:IBO")};ja.xcc(this.lfg);ja.mPh(this.zWn)}dkf(){this.ddg()}ddg(){this.RL.le(()=>{this.initialize(this.fu.get(Ib.xOg));this.actors.forEach(e=>e.Xb())},"WD:BOOT")}initialize(e){e.forEach(n=>
this.container.resolve(n).initialize())}Wd(e){e.forEach(n=>this.container.resolve(n).Wd())}}Object(F.a)(hc,"DesignerPackageInitializer",null,[]);class Kc{kFl(e,n,C,S,ja){return new hc(e,n,C,S,ja)}}Object(F.a)(Kc,"DesignerInitializerFactory",null,[]);var zd=d(183),ue=d(303),Ue=d(204),Re=d(1035),wg=d(66);class Xg extends Pa.a{constructor(e,n,C){super();this.DesiredRevisionId=this.FileId=this.TemplateUrl=null;this.TemplateUrl=e;this.FileId=n;this.DesiredRevisionId=C}Om(){return ua.a.tSd}static construct(e,
n,C){return new Xg(e,n,C)}}Object(F.a)(Xg,"ApplyTemplateRequest",Pa.a,[]);class fk{constructor(e){this.OT=e}tSd(e,n){return new Promise((C,S)=>{const ja=Xg.construct(e,G.AFrameworkApplication.rootQuerySignature,n),ya=String.format("{0}/we/OneNote.ashx?perfTag=ApplyTemplate&{1}",ka.a.webServiceBase,G.AFrameworkApplication.rootQuerySignature);this.OT.Xj(ya,2,qa.b(ja),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,kb=>{var Rb,sc;if(null===(Rb=null===kb||void 0===kb?void 0:kb.data)||void 0===
Rb||!Rb.Pe)return S("No response data!");if(kb.data.He!==Y.a.qz)return S(`Bad Http Status ${kb.data.He}`);if(!({group:kb}=da.a.D4(kb.data.Pe)).returnValue)return S("Empty ServerResponse!");Rb=null;if(null===(sc=null===kb||void 0===kb?void 0:kb.Responses)||void 0===sc||!sc.length||!(Rb=kb.Responses[0])||Rb.classId!=ua.a.tSd)return S("No valid response!");E.ULS.sendTraceTag(509642067,3016,50,"ApplyTemplate call successful.");C(Rb)},kb=>{var Rb,sc;E.ULS.sendTraceTag(509642066,3042,10,"ApplyTemplates request failed [Status: {0}]",
null===(Rb=null===kb||void 0===kb?void 0:kb.data)||void 0===Rb?void 0:Rb.status);S(null===(sc=null===kb||void 0===kb?void 0:kb.data)||void 0===sc?void 0:sc.status)},ja)})}}Object(F.a)(fk,"ApplyTemplatesProxyImplementation",null,[]);var vh=d(1507),ig=d(1719),bh=d(1408);class Ij extends bh.a{constructor(e,n,C,S){super(Ij.Ljf);this.Js=e;this.Og=n;this.view=C;this.options=S}initialize(){super.initialize();const e=this.options.bwc==this.Og.Vja(this.view.vd,{W_:this.options.W_,Msa:this.options.b7c,LKa:this.options.a7c,
V_:this.options.V_});e&&!this.nta&&E.ULS.sendTraceTag(557114691,3028,50,this.F6(this.Js,!0,`satisfiedIfBlank=${this.options.bwc}`));this.pi(e)}Wd(){super.Wd()}}Ij.Ljf="BlankDocumentConditionId";Object(F.a)(Ij,"BlankDocumentCondition",bh.a,[]);var Mo=d(1067),Mn=d(1102),ol=d(1043),Bk=d(1447);class zm extends Bk.a{constructor(e,n,C=0,S=!0){super("DocumentEditedConditionId");this.Tob=e;this.ih=n;this.bvf=C;this.Pup=S;this.Wbg=this.pCe=0;this.Tdg=()=>{setTimeout(()=>{var ja,ya;++this.Wbg;0==this.pCe&&
(this.pCe=(new Date).getTime());if(this.ih.V2){const kb=null===(ja=this.ih.yO)||void 0===ja?void 0:ja.UMl;ja=null===(ya=null===kb||void 0===kb?void 0:kb.pOb)||void 0===ya?void 0:ya.OUb();null!==ja&&void 0!==ja&&ja.some(Rb=>Rb instanceof Mn.a||Rb instanceof ol.a||Rb instanceof Mo.a)||(0==this.bvf?this.rhj():(clearTimeout(this.Tha),this.Tha=setTimeout(()=>{this.nYj();this.rhj();E.ULS.sendTraceTag(521446627,3016,50,"User stopped editing {0} seconds ago. Document has been edited {1} times. The last action was: {2}.                 {3} milliseconds have passed since the change began",
this.bvf/1E3,this.Wbg,kb.actionId,(new Date).getTime()-this.pCe);this.pCe=this.Wbg=0},this.bvf)))}},1E3)};this.Tha=void 0}initialize(){super.initialize();this.Tob.vKb(this.Tdg)}Wd(){this.Tob.Jte(this.Tdg);this.nYj();super.Wd()}nYj(){this.Tha&&(clearTimeout(this.Tha),this.Tha=void 0)}rhj(){this.pi(!0);this.Pup&&this.Tob.Jte(this.Tdg)}}Object(F.a)(zm,"DocumentEditedCondition",Bk.a,[]);class qo extends Bk.a{constructor(e,n,C){super("LocalStorageConditionId");this.v9i=e;this.spp=n;this.defaultValue=C}initialize(){var e;
super.initialize();G.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.Designer.LocalStorageConditionOverride",void 0)===this.v9i?this.pi(!0):this.pi((null!==(e=localStorage.getItem(this.v9i))&&void 0!==e?e:this.defaultValue)===this.spp)}}Object(F.a)(qo,"LocalStorageCondition",Bk.a,[]);var Nn=d(1482),ju=d(1070),kh=d(30),Bs=d(555),uj=d(42);class Lr{constructor(e,n,C){this.$m=e;this.gcb=n;this.Q_d=C;this.hkj=(S,ja)=>{this.documentType=ja.documentType;Lr.HZi||this.Yab();this.Q_d.hCo(this.hkj)};
this.Q_d.o1k(this.hkj)}Yab(){if(void 0===this.documentType||null===this.documentType)this.documentType=-1;this.userType=this.RQm();this.uxf();const e=new Bs.a;e.name=Lr.SXl;e.dataFields=this.YEl();e.dnmInterval=1;e.dnmAllowedPartA=[1,3,4,2,5];Yd.a.sendDirectNumericEvent(e);Lr.HZi=!0}YEl(){const e=[];[this.cL("isBlank",this.gVi),this.cL("DocumentType",this.documentType),this.cL("UserType",this.userType),this.cL("TableCount",this.Jca),this.cL("CharacterCount",this.characterCount),this.cL("ParagraphCount",
this.YU),this.cL("ImageCount",this.zL),this.cL("ListElementsCount",this.K6i),this.cL("BlobsCount",this.OTc),this.cL("PageCount",this.VU)].forEach(n=>{e.push(n)});return e}cL(e,n){const C=new kh.a;C.name=e;"number"===typeof n?C.int64=n:"boolean"===typeof n&&(C.bool=n);return C}uxf(){this.YU=this.OTc=this.K6i=this.Jca=this.zL=this.characterCount=0;this.VU=this.gcb.getTotalPageCount();var e=Rd.a.hm.kb.Qc.vd;this.gVi=Af.ParagraphReader.Vja(e);if(!this.gVi){e=this.$m.osa(e,7,7).currentNode;var n=Ed.a.eb(e);
for(e=Tm.a.At(n,e);e.moveNext();)if(n=e.currentNode)if(kl.a.Eq(n))this.zL++;else if(Pd.TableReader.kP(n))this.Jca++;else if(uj.ListItemReader.Fg(n))this.K6i++;else if(Af.ParagraphReader.Wb(n)){var C=xi.e(n);for(let S=0;S<C.length;S++)5===C[S].Sh?this.zL++:this.OTc++;C=pn.AParagraphNode.KP(n.characterData);C=C.trim();this.characterCount+=C.length;0<C.length&&!Af.ParagraphReader.EX(n)&&!Af.ParagraphReader.DX(n)&&this.YU++}}}RQm(){return!0===G.AFrameworkApplication.J.$("IsO365ConsumerHost")?1:!0===G.AFrameworkApplication.J.$("IsO365CommercialHost")?
2:!0===G.AFrameworkApplication.J.$("IsEduUser")?3:0}}Lr.SXl="Office.DNM.Word.Online.Designer.DocumentStatsEvent";Lr.HZi=!1;Object(F.a)(Lr,"DocumentStatsDnmLogger",null,[]);var sw=d(1510),Jp=d(880),gr;(function(e){e[e.initial=0]="initial";e[e.left=1]="left";e[e.center=2]="center";e[e.right=3]="right";e[e.justify=4]="justify"})(gr||(gr={}));var rt;(function(e){e[e.initial=0]="initial";e[e.firstLine=1]="firstLine";e[e.hanging=2]="hanging"})(rt||(rt={}));var Zo;(function(e){e[e.none=0]="none";e[e.unknownError=
1]="unknownError";e[e.nonTargetDocument=2]="nonTargetDocument";e[e.trackChangesNotSupported=3]="trackChangesNotSupported";e[e.lowConfidenceDocument=4]="lowConfidenceDocument";e[e.documentTooLarge=5]="documentTooLarge";e[e.multipleAuthorsNotSupported=6]="multipleAuthorsNotSupported"})(Zo||(Zo={}));var sn;(function(e){e[e.table=0]="table";e[e.themeImage=1]="themeImage";e[e.complexDecorator=2]="complexDecorator";e[e.text2Image=3]="text2Image"})(sn||(sn={}));var Pl;(function(e){e[e.main=0]="main";e[e.coverPage=
1]="coverPage";e[e.text2Image=2]="text2Image";e[e.letter=3]="letter";e[e.generalDocument=4]="generalDocument";e[e.toDoList=5]="toDoList";e[e.resume=6]="resume";e[e.coverLetter=7]="coverLetter";e[e.notes=8]="notes";e[e.journal=9]="journal";e[e.letterhead=10]="letterhead";e[e.report=11]="report";e[e.article=12]="article";e[e.invoice=13]="invoice";e[e.favorites=14]="favorites";e[e.other=15]="other";e[e.none=16]="none"})(Pl||(Pl={}));var jp;(function(e){e[e.letters=0]="letters";e[e.writing=1]="writing";
e[e.lists=2]="lists";e[e.resumes=3]="resumes";e[e.business=4]="business";e[e.education=5]="education";e[e.newsletters=6]="newsletters"})(jp||(jp={}));(function(){function e(n,C){void 0===n&&(n=Pl.none);void 0===C&&(C="");this.labelId=n;this.Dha=C}e.prototype.getLabel=function(){var n;return null!==(n=this.labelId)&&void 0!==n?n:void 0};e.prototype.getStringId=function(){return this.Dha};e.prototype.equals=function(n){return this.Dha||n.Dha?this.Dha===n.Dha:this.labelId===n.labelId};e.equals=function(n,
C){return n||C?n&&C?n.equals(C):!1:n===C};e.prototype.toString=function(){return null!==this.Dha?this.Dha:null!==this.labelId?this.labelId.toString():""};return e})();var ur;(function(e){e[e.main=0]="main";e[e.templates=1]="templates";e[e.templateStyles=2]="templateStyles"})(ur||(ur={}));var Gk;(function(e){e[e.theme=0]="theme";e[e.templateTheme=1]="templateTheme";e[e.officeTemplate=2]="officeTemplate"})(Gk||(Gk={}));var Cs;(function(e){e[e.BetweenLeftAndRightMargin=0]="BetweenLeftAndRightMargin";
e[e.BetweenLeftAndRightEdge=1]="BetweenLeftAndRightEdge"})(Cs||(Cs={}));var st;(function(e){e[e.stretchInsideMargins=0]="stretchInsideMargins";e[e.stretchEdgeToEdge=1]="stretchEdgeToEdge";e[e.original=2]="original"})(st||(st={}));var sf;(function(e){e[e.stretchInsideMargins=0]="stretchInsideMargins";e[e.original=1]="original"})(sf||(sf={}));var On;(function(e){e[e.plain=0]="plain";e[e.predefined=1]="predefined";e[e.generatedByAI=2]="generatedByAI"})(On||(On={}));var xl=d(641),tt=d(1473),Jf=d(143);
class Xj{}Object(F.a)(Xj,"DesignerInfo",null,[]);class av{constructor(e,n,C,S,ja,ya){this.INb=e;this.assetId=n;this.isPremium=C;this.isL2Template=S;this.collectionId=ja;this.collectionName=ya}}Object(F.a)(av,"DesignInfo",null,[]);class yq{}yq.ssh="";yq.N5f=e=>{var n;e.ztb()&&Xj.QC&&xa.a(Jf.a.ulk,!0,void 0,[{name:"CollectionID",string:Xj.QC.collectionId},{name:"TemplateID",string:Xj.QC.assetId},{name:"TemplateType",string:null===(n=Xj.QC.INb)||void 0===n?void 0:n.toString()},{name:"IsPremium",bool:Xj.QC.isPremium},
{name:"IsProactivePane",bool:Xj.p$c},{name:"IsL2Template",bool:Xj.QC.isL2Template}])};yq.W$i=(e,n)=>{var C;n.ztb()&&(Xj.QC?xa.a(Jf.a.vlk,!0,null,[{name:"CollectionID",string:Xj.QC.collectionId},{name:"TemplateID",string:Xj.QC.assetId},{name:"TemplateType",string:null===(C=Xj.QC.INb)||void 0===C?void 0:C.toString()},{name:"IsPremium",bool:Xj.QC.isPremium},{name:"IsProactivePane",bool:Xj.p$c},{name:"IsL2Template",bool:Xj.QC.isL2Template},{name:"IsTemplateApplied",bool:e}]):E.ULS.shipAssertTag(509125727,
3016,!1,"Could not log tried event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};yq.rHn=e=>{var n,C;e.ztb()&&(Xj.QC?yq.ssh!==Xj.QC.assetId&&(yq.ssh=Xj.QC.assetId,xa.a(Jf.a.tlk,!0,void 0,[{name:"CollectionID",string:Xj.QC.collectionId},{name:"TemplateID",string:Xj.QC.assetId},{name:"TemplateType",string:null===(n=Xj.QC.INb)||void 0===n?void 0:n.toString()},{name:"IsPremium",bool:Xj.QC.isPremium},{name:"IsProactivePane",bool:Xj.p$c},{name:"IsL2Template",bool:null===(C=Xj.QC)||
void 0===C?void 0:C.isL2Template}])):E.ULS.shipAssertTag(509096994,3016,!1,"Could not log edited event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};Object(F.a)(yq,"TemplateLogger",null,[]);class bv{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm){this.Pb=e;this.sn=n;this.qWc=C;this.Nhd=S;this.Igc=ja;this.zaa=ya;this.uJo=kb;this.mdb=Rb;this.zD=sc;this.OP=Fc;this.Ap=gd;this.Zi=td;this.sV=Bd;this.Wkp=wd;this.k0j=te;this.$d=Le;this.Sw=Oe;this.k0m=
We;this.XVh=Xf;this.jL=Gg;this.I9k=Ph;this.nzc=Aj;this.hd=Ih;this.ih=Nm;this.applyTheme=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(578856856,3016,!1),2;this.qWc.Khe();this.Nhd.akd();this.sn.yq||E.ULS.sendTraceTag(573608067,3016,50,"Applying theme while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.sn.Sja,this.sn.hA.FLa);const mq=Lg.theme.id;this.Xnb(163,()=>{this.$d.sun()&&Jp.a.Rza(new xl.ThemeOperationSignal({operation:xl.IThemeOperation.Apply,themeId:mq}));Xj.QC&&yq.N5f(this.$d);
this.Wkp.applyTheme(Lg.theme,!1);const uk=Lg.theme,au=Xj.QC&&0!=Xj.QC.INb;Xj.QC=new av(uk.type==Gk.templateTheme?1:0,uk.id.toString(),!1,uk.IsL2Template,uk.collectionId,uk.collectionName);yq.W$i(au,this.$d);this.ih.wcc(this.Psc);Lg.callback&&Lg.callback(this.OP.Sm.NZb)});Cj&&(Cj.Xt=mq,Cj.kE=Lg.theme.isThemeInFavorites?1:0);2!=this.$d.zSl()&&this.k0j.X$i(Lg.theme);return 32};this.fixInconsistencies=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(578856857,3016,!1),2;this.qWc.Khe();this.Nhd.akd();
this.sn.yq||E.ULS.sendTraceTag(573608068,3016,50,"Fixing inconsistencies while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.sn.Sja,this.sn.hA.FLa);this.Xnb(162,async()=>{try{const mq=this.Ap.Xf("UserAction",Jf.a.fixInconsistencies),uk=Date.now();this.Igc.e8k().then(()=>{Lg.callback&&Lg.callback(this.OP.Sm.NZb);xa.a(Jf.a.jam,!0,Date.now()-uk);mq.stop()})}catch(mq){E.ULS.sendTraceTag(538240195,3016,10,mq)}});return 32};this.accept=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(578856858,
3016,!1),2;this.Sw.isVisible&&this.Nhd.akd();this.Xnb(171,()=>{this.mdb.accept(Lg.paragraphNode,Lg.VVj)});Cj&&(Cj.Xt=Lg.role,Cj.kE=this.Sw.isVisible?0:1);this.$d.lXf()&&28==Lg.role&&this.k0m.v_n();return 32};this.acceptAll=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(578856859,3016,!1),2;this.Xnb(167,()=>{this.mdb.acceptAll()});1!==Lg.source&&this.Nhd.akd();Cj&&(Cj.Xt=Lg.source,Cj.kE=this.Sw.isVisible?0:1);return 32};this.reject=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(578856860,
3016,!1),2;this.mdb.reject(Lg.paragraphNode,Lg.VVj);Cj&&(Cj.Xt=Lg.role,Cj.kE=this.Sw.isVisible?0:1);return 32};this.rejectAll=(Sk,hk,al,Cj)=>{this.Xnb(168,()=>{this.mdb.rejectAll()});Cj&&(Cj.kE=this.Sw.isVisible?0:1);return 32};this.Lpd=(Sk,hk,al,Cj)=>{this.Xnb(211,()=>{this.mdb.Lpd()});Cj&&(Cj.kE=this.Sw.isVisible?0:1);return 32};this.reviewChanges=(Sk,hk,al,Cj)=>{this.Xnb(169,()=>{const Lg=this.OP.KIm();Lg&&this.zD.kjd(tt.a.create(Lg))});Cj&&(Cj.kE=this.Sw.isVisible?0:1);return 32};this.tryAnyway=
()=>{this.zaa.nVl();return 32};this.showMoreThemes=(Sk,hk,al,Cj)=>{Sk=this.sV.hCn();Cj&&(Cj.Xt=Sk);return 32};this.logThemeInfo=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(546109061,3016,!1),2;this.k0j.X$i(Lg.theme);return 32};this.bnb=(Sk,hk,al,Cj,Lg)=>{Lg&&this.mdb.bnb(Lg);this.Sw.isVisible&&this.Nhd.akd();Cj&&(Cj.Xt=Lg.role,Cj.kE=this.Sw.isVisible?0:1);return 32};this.MOa=(Sk,hk,al,Cj,Lg)=>{Lg&&this.mdb.MOa(Lg.paragraphNode);Cj&&(Cj.Xt=Lg.role,Cj.kE=this.Sw.isVisible?0:1);return 32};this.BMg=
(Sk,hk,al,Cj,Lg)=>{Lg.cUb?this.mdb.MOa(Lg.paragraphNode):this.mdb.BMg(Lg.paragraphNode);Cj&&(Cj.Xt=Lg.cUb?1:0,Cj.kE=this.Sw.isVisible?0:1);return 32};this.F6n=()=>Of.a.GX(Jf.a.hLi)?(wb.a.Tm(Jf.a.hLi,void 0,void 0,"WordDesigner.OpenGreenroomPanel"),32):2;this.revertTheme=()=>{this.Xnb(208,()=>{this.uJo.revertTheme()});return 32};this.toggleFavorite=(Sk,hk,al,Cj,Lg)=>{if(!Lg)return E.ULS.shipAssertTag(520488720,3016,!1),2;Cj&&(Cj.Xt=Lg.theme.id,Cj.kE=Lg.fmn?1:0);this.sV.toggleFavorite(Lg.theme);return 32};
this.applyOfficeTemplate=(Sk,hk,al,Cj,Lg)=>{var mq;if(!Lg)return E.ULS.shipAssertTag(509693955,3016,!1),2;if(!Lg)return E.ULS.shipAssertTag(509642068,3016,!1),2;null===(mq=this.jL)||void 0===mq?void 0:mq.ADg();this.XVh.showDialog();Sk=Tj.a.create();this.nzc.h_=Sk;this.nzc.bVn=Lg;this.nzc.CSl=this.RNg;this.hd.addListener(this.nzc);this.I9k.tSd(Lg.template.binaryUrl,Sk.toString()).then(uk=>{if(0!=uk.StatusCode)E.ULS.shipAssertTag(509436170,3016,!1,`ApplyTemplate response not successful. OperationResult ${uk.StatusCode}`),
this.RNg(this.nzc,Lg),this.Iy();else{Xj.QC&&yq.N5f(this.$d);uk=Xj.QC&&0!=Xj.QC.INb;const au=Lg.template;Xj.QC=new av(2,au.templateId,au.isPremium,au.isL2Template,au.collectionId,au.collectionName);yq.W$i(uk,this.$d);this.ih.wcc(this.Psc)}}).catch(uk=>{E.ULS.shipAssertTag(509638114,3016,!1,uk);this.RNg(this.nzc,Lg)});return 32};this.Psc=(Sk,hk)=>{if(hk.actionId===pe.a.Dya||this.ih.dba(hk.actionId))yq.N5f(this.$d),Xj.QC=null,this.ih.Krg(this.Psc)};this.RNg=(Sk,hk)=>{var al;this.hd.removeListener(Sk);
this.XVh.$ya();null===(al=this.jL)||void 0===al?void 0:al.G0d();hk.RYn(this.OP.Sm.NZb)};this.Iy=()=>{const Sk=new pb.StandardDialog;Sk.Bd=0;Sk.sw(WordRibbonStrings.ApplyTemplateErrorDialogTitle,WordRibbonStrings.ApplyTemplateErrorDialogMessage,0)}}Xb(){this.Pb.fb(pe.a.H5a,Ma.a.view,this.applyTheme,1036);this.Pb.fb(ha.a.i3d,Ma.a.view,this.fixInconsistencies,1028);this.Pb.fb(ha.a.WPd,Ma.a.view,this.accept,1036);this.Pb.fb(pe.a.Nlb,Ma.a.view,this.acceptAll,1036);this.Pb.fb(ha.a.kte,Ma.a.view,this.reject,
1036);this.Pb.fb(ha.a.fkd,Ma.a.view,this.rejectAll,1036);this.Pb.fb(ha.a.Vvf,Ma.a.view,this.Lpd,1036);this.Pb.fb(ha.a.Svf,Ma.a.view,this.reviewChanges,1036);this.Pb.fb(ha.a.Tei,Ma.a.view,this.tryAnyway,1028);this.Pb.fb(ha.a.Rei,Ma.a.view,this.showMoreThemes,1036);this.Pb.fb(ha.a.Mei,Ma.a.view,this.logThemeInfo,1124);this.Pb.fb(ha.a.bnb,Ma.a.view,this.bnb,1036);this.Pb.fb(ha.a.MOa,Ma.a.view,this.MOa,1036);this.Pb.fb(ha.a.Xvf,Ma.a.view,this.BMg,1036);this.Pb.fb(ha.a.Nei,Ma.a.view,this.F6n,1028);this.Pb.fb(ha.a.kug,
Ma.a.view,this.revertTheme,1028);this.Pb.fb(ha.a.Hmi,Ma.a.view,this.toggleFavorite,1036);this.Pb.fb(pe.a.Dya,Ma.a.view,this.applyOfficeTemplate,1036)}Xnb(e,n){e=this.gob(e,n);this.Zi.$b(e)}gob(e,n){return new zg.a(2,1,0,n,e)}}Object(F.a)(bv,"DesignerActionActor",null,[1181]);const By=e=>{wc.a.hlf&&window.performance.mark(e)};var Qq=d(1539);class Cy{constructor(e,n,C,S,ja,ya,kb,Rb){this.Pb=e;this.Sw=n;this.EXa=C;this.GJo=S;this.HJo=ja;this.ho=ya;this.Zu=kb;this.$d=Rb;this.EXa.M0k(this.Keg.bind(this))}Xb(){this.Pb.fb(ha.a.wOa,
X.a.frame,this.wOa.bind(this),1036);this.Pb.fb(ha.a.Fuc,Ma.a.view,this.Fuc.bind(this),1124);this.Pb.fb(ha.a.dng,Ma.a.view,this.Wid.bind(this),1124);this.Pb.fb(ha.a.bng,Ma.a.view,this.Wid.bind(this),1124);this.Pb.fb(ha.a.cng,Ma.a.view,this.Wid.bind(this),1124);this.Pb.fb(ha.a.$mg,Ma.a.view,this.Wid.bind(this),1124);this.Pb.fb(ha.a.eng,Ma.a.view,this.Wid.bind(this),1124);this.Pb.fb(ha.a.Qvf,Ma.a.view,this.VZd.bind(this),1028);this.Pb.fb(ha.a.Ovf,Ma.a.view,this.VZd.bind(this),1028);this.Pb.fb(ha.a.Pvf,
Ma.a.view,this.VZd.bind(this),1028);this.Pb.fb(ha.a.Nvf,Ma.a.view,this.VZd.bind(this),1028);this.Pb.fb(ha.a.Sei,Ma.a.view,this.wOa.bind(this),1028);this.ho.vcc(this.F3.bind(this))}Keg(){this.GJo.dispatch(this.HJo.updateControlHiddenState(Jf.a.vyj,!1));By(Jf.a.ysj);window.performance&&"function"===typeof window.performance.measure&&window.performance.measure(Jf.a.ybo,Jf.a.zsj,Jf.a.ysj)}wOa(e,n,C,S,ja){return 1===C?32:2===C?(e=Object(Eh.a)(Qq.a,ja)?ja.id:0,Xj.p$c=0!=e,S&&(S.Xt=this.Sw.isVisible?0:1,
S.kE=e),this.Sw.isVisible?this.Sw.hide():this.Sw.show(e),32):2}Fuc(e,n,C,S,ja){if(1===C)return 32;if(!ja)return 2;ja&&(ja[Fa.a.On]=this.Sw.isVisible);return 32}Wid(e,n,C,S,ja){if(1===C)return 32;if(!ja)return 2;if(ja)if(e===ha.a.dng)ja[gh.a.Visible]=!this.ho.Hqa();else if(e===ha.a.bng)ja[gh.a.Visible]=this.ho.Hqa();else if(e===ha.a.cng)ja[gh.a.Visible]=this.$d.h0f()&&this.ho.Q8c(2);else if(e===ha.a.$mg)ja[gh.a.Visible]=this.$d.h0f()&&!this.ho.Q8c(2);else if(e!=ha.a.eng)return E.ULS.shipAssertTag(523850504,
3016,!1,`unexpected actionId: ${e}`),8;return 32}VZd(e,n,C){if(1===C)return 32;E.ULS.sendTraceTag(523850505,3016,50,`designerChangeSettings actionId: ${e}`);if(e===ha.a.Qvf)this.ho.V_l();else if(e===ha.a.Ovf)this.ho.c2()?this.ho.Qfi():(E.ULS.sendTraceTag(509137224,3016,15,"designerDisableSuggestionsUntilUpdate fallback to local disable since roaming data is not ready"),this.ho.Ewf());else if(e===ha.a.YRl)this.ho.Ewf();else if(e===ha.a.Pvf)this.ho.x5j(2);else if(e===ha.a.Nvf)this.ho.rNj(2),this.Sw.isVisible&&
this.Sw.hide();else return E.ULS.shipAssertTag(523850506,3016,!1,`unexpected actionId: ${e}`),8;return 32}F3(){this.Zu.Ge()}}Object(F.a)(Cy,"DesignerActor",null,[1181]);var Cv=d(1089);class ks{constructor(e,n,C){this.Pb=e;this.mva=n;this.Wba=C;this.hDa=(S,ja,ya)=>{var kb,Rb,sc,Fc,gd;return 1===ya?(0===this.mva.Ena&&this.mva.PAc(0),E.ULS.sendTraceTag(524149770,3016,50,"CCP floatie opened or refreshed. Designer paste state: {0}. CorrelationId: {1}",null===(kb=this.mva.Ena)||void 0===kb?void 0:kb.toString(),
null===(Rb=this.mva.sUb)||void 0===Rb?void 0:Rb.toString()),xa.a("Box4PasteFloatieOpenedOrRefreshed",!0,void 0,[Object.assign(new kh.a,{name:"DesignerPasteState",string:null===(sc=this.mva.Ena)||void 0===sc?void 0:sc.toString()}),Object.assign(new kh.a,{name:"CorrelationId",string:null===(Fc=this.mva.sUb)||void 0===Fc?void 0:Fc.toString()})]),1===this.mva.Ena?32:2):2===ya?(this.mva.g0i(this.mva.Eka())&&!this.mva.g0i(null===(gd=this.mva.XNa)||void 0===gd?void 0:gd.Hao)&&G.AFrameworkApplication.va.Qb(pe.a.uZa,
2,null),this.mva.rWo(S),this.Wba.Luc(Object.assign(new Cv.a,{e9c:!0,WX:"reformatPastedContentToDesignerPaste"})),S=this.mva.s9k(),E.ULS.sendTraceTag(524149771,3016,50,`Suggestions applied: ${S}`),ka.a.Vuc(()=>{this.Wba.Luc(Object.assign(new Cv.a,{e9c:!1,nBg:!0}))}),32):2}}Xb(){this.Pb.fb(pe.a.hDa,Ma.a.view,this.hDa,1036)}}Object(F.a)(ks,"DesignerPasteActor",null,[1181]);class Xs{set h_(e){this.Fm=e}set CSl(e){this.rtk=e}set bVn(e){this.eGk=e}constructor(e){this.ih=e}psc(){}pYa(){}Ivb(e){e.ud.Mm.id.Gt.equals(this.Fm)&&
(this.Yfo(),this.rtk(this,this.eGk))}Yfo(){this.ih.crc(pe.a.Dya,this.ih.I2(),!0)}}Object(F.a)(Xs,"TemplateAppliedListener",null,[]);class Mr{constructor(e,n){this.vi=!1;this.pYn=(C,S)=>{S.data?this.start():this.stop()};this.P8g=n;this.yzd=e}initialize(){this.vi||(this.yzd.xcc(this.pYn),this.vi=!0)}Wd(){}start(){for(const e of this.P8g)e.register()}stop(){for(const e of this.P8g)e.unregister()}}Object(F.a)(Mr,"WorkflowManager",null,[1182,506]);class No{setTimeout(e,n){return window.setTimeout(e,n)}clearTimeout(e){window.clearTimeout(e)}}
Object(F.a)(No,"WindowTimeout",null,[1183]);class hq extends Bk.a{constructor(e,n,C){super(Jf.a.pul);this.Js=e;this.sn=n;this.hag=C}static zPg(e,n){return!n||e.yq?!0:e.hA.FLa&&0<(n&1)?0<(n&2)?!1:e.Sja:!e.hA.FLa&&0<(n&4)?0<(n&8)?!1:e.Sja:!0}initialize(){super.initialize();hq.zPg(this.sn,this.hag)&&(this.nta||E.ULS.sendTraceTag(540116318,3016,50,this.F6(this.Js,!0)),this.pi(!0))}Wd(){super.Wd()}}Object(F.a)(hq,"CoAuthCondition",Bk.a,[]);class ul extends Bk.a{pi(e){this.f8b===e&&e||super.pi(e)}}Object(F.a)(ul,
"AOnChangeOrUnsatisfiedConditionProcessor",Bk.a,[]);class ku extends ul{constructor(e,n,C){super("DocumentHasHeadingConditionId");this.qV=e;this.fR=n;this.gBa=C;this.isInitialized=!1}initialize(){if(!this.isInitialized){super.initialize();this.isInitialized=!0;var e=this.qV.lvm();for(const n of e)n&&!this.fR.W_d(n)&&this.gBa.hef(n,!1);this.gBa.size&&(E.ULS.sendTraceTag(509649924,3016,50,"Document has headings suitable for image suggestions"),this.pi(!0))}}Wd(){this.isInitialized&&(this.isInitialized=
!1,super.Wd())}}Object(F.a)(ku,"DocumentHasHeadingCondition",ul,[]);class Pn extends ul{constructor(e,n,C,S){super(Jf.a.mhi);this.ZHj=e;this.TNb=n;this.qV=C;this.gBa=S;this.sGe=this.isInitialized=!1;this.zga=()=>{const ja=this.qV.cOf();ja&&this.gBa.hef(ja,!0);this.pi(!!ja)};this.Sed=()=>{G.AFrameworkApplication.pc.$b(new zg.a(2,1,500,this.zga));this.Wd()}}initialize(){super.initialize();if(!this.isInitialized){this.isInitialized=!0;var e=this.qV.cOf();e?(this.gBa.hef(e,!0),this.pi(!0)):this.sGe||
(this.sGe=!0,this.ZHj.register(),this.TNb.register(),this.TNb.QH(this.Sed))}}Wd(){this.isInitialized&&(this.isInitialized=!1,this.sGe&&(this.sGe=!1,this.TNb.hK(this.Sed),this.TNb.unregister(),this.ZHj.unregister()));super.Wd()}}Object(F.a)(Pn,"DocumentHasTitleCondition",ul,[]);class wa extends ul{constructor(){super("HeadingsImageConditionId")}v_n(){this.pi(!0)}}Object(F.a)(wa,"HeadingsImageCondition",ul,[1180]);var Sa=d(108);class za extends Bk.a{constructor(e,n,C,S,ja=2E3){super(Jf.a.pbk);this.Tob=
e;this.iK=n;this.gBa=C;this.Qc=S;this.Tak=ja;this.isInitialized=!1;this.f5i=1;this.znf=()=>{if(!this.gBa.E0f){var ya=Af.ParagraphReader.Zm(this.Qc.vd),kb=this.gBa.dtm();null===ya||void 0===ya||!ya.characterData||kb&&ya.characterData===kb.g2f||100<=ya.characterData.length||this.iK.C$c(ya)||(kb=Sa.FormattingReader.Vs(ce.a.create(ya)),kb=Sa.FormattingReader.Ug(kb,Ee.a.fontSize,this.Noi),ya!==this.mic||this.Noi!==kb||this.M$l!==ya.characterData?(this.mic=ya,this.Noi=kb,this.M$l=ya.characterData,this.ahi()):
(ya=Af.ParagraphReader.Kv(this.Qc.vd,!1,!1).count,10>ya&&ya>this.f5i&&(this.ahi(),this.f5i=ya)))}}}rIl(){return new zg.a(2,1,this.Tak,()=>{this.gBa.E0f=!0;this.pi(!0);this.Qke=null})}initialize(){super.initialize();this.isInitialized||(this.isInitialized=!0,this.Tob.vKb(this.znf),this.znf())}Wd(){this.isInitialized&&(this.isInitialized=!1,this.Tob.Jte(this.znf));super.Wd()}ahi(){this.Qke?G.AFrameworkApplication.pc.Z3(this.Qke,this.Tak):(this.Qke=this.rIl(),G.AFrameworkApplication.pc.$b(this.Qke))}}
Object(F.a)(za,"ImageSuggestionWholeSessionTriggerCondition",Bk.a,[]);class ta extends ul{constructor(e,n){super(Jf.a.Igj);this.fR=e;this.Qc=n}initialize(){super.initialize();const e=Af.ParagraphReader.Zm(this.Qc.vd);this.pi(!this.fR.W_d(e))}}Object(F.a)(ta,"NoCoverPhotoCondition",ul,[]);class Ya extends Bk.a{constructor(e,n){super(Jf.a.Kao);this.context=n;this.D3=(C,S)=>{this.context.kef(S.node);S.pZi&&(this.context.u$l(),this.pi(!0))};this.zgd=e.qf(12);this.context=n}initialize(){super.initialize();
this.zgd.gPh(this.D3)}Wd(){this.zgd.CDj(this.D3);super.Wd()}}Object(F.a)(Ya,"PasteCondition",Bk.a,[]);class Eb extends Bk.a{constructor(e){super(Jf.a.E8n);this.EXa=e;this.phe=this.isInitialized=!1;this.bmj=()=>{this.pi(this.EXa.PTh)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.EXa.PTh?this.pi(!0):this.phe||(this.phe=!0,this.EXa.j0k(this.bmj)))}Wd(){this.isInitialized&&(this.isInitialized=!1,this.phe&&(this.EXa.GBo(this.bmj),this.phe=!1),super.Wd())}}Object(F.a)(Eb,
"PQLicenseCondition",Bk.a,[]);var Wb=d(1596);class oc extends ul{constructor(e,n,C,S,ja,ya){super(Jf.a.Fko);this.Lgc=e;this.eYb=n;this.fIn=C;this.Qc=S;this.lb=ja;this.iua=ya;this.isInitialized=!1;this.Pmj=(kb,Rb)=>{Rb.data.annotation?Rb.data.annotation.annotationType!==Wb.DocumentPullQuoteAnnotation.getTypeName()?(E.ULS.shipAssertTag(542500387,3016,!1),this.pi(!1)):(kb=Rb.data.annotation.content)?(E.ULS.sendTraceTag(541446528,3016,50,"PullQuotes received; Number of detected pull quotes: {0}",kb.numberOfDetectedPullQuotes),
this.pi(0<kb.numberOfDetectedPullQuotes)):(E.ULS.shipAssertTag(542500416,3016,!1),this.pi(!1)):(E.ULS.shipAssertTag(542500386,3016,!1),this.pi(!1))}}initialize(){if(!this.isInitialized){super.initialize();var e=this.fIn.z6d();let n=!1;75>e.paragraphCount&&10>e.listElementsCount&&10>e.blobsCount&&2>e.tableCount&&(this.eYb.register(),this.Lgc.register(),this.Lgc.QH(this.Pmj),e=this.Wom(),-1==e&&E.ULS.sendTraceTag(536941664,3016,15,"Current paragraph index for PQ signal could not be obtained."),e=new Wb.PullQuotesSignal({currentParagraphIndex:e}),
this.Lgc.Rza(e),this.eYb.Rza(e),this.isInitialized=n=!0);E.ULS.sendTraceTag(541446499,3016,50,"PullQuotes signal sent: {0}",n)}}Wd(){this.isInitialized&&(this.Lgc.hK(this.Pmj),this.isInitialized=!1,super.Wd())}Wom(){var e=this.lb.gb.currentSelection;if(!e)return-1;e=e.Pf?e.Xc:e.Qa;if(!e||0>e.cpBegin)return-1;e=e.node;let n=0;if(this.N3i(e)){var C=Af.ParagraphReader.Zm(this.Qc.vd);C=this.iua.gUa(C,!1,!1);do if(this.N3i(C.DA)){if(C.DA===e)return n;n++}while(C.Ala())}return-1}N3i(e){return Af.ParagraphReader.Wb(e)&&
!Af.ParagraphReader.DX(e)&&!Af.ParagraphReader.EX(e)&&Af.ParagraphReader.S$a(e)}}Object(F.a)(oc,"PullQuotesCondition",ul,[]);var Oc=d(1602),Sc=d(1454);class ud extends ul{constructor(e,n,C,S){super(Jf.a.f0j);this.qV=e;this.YRb=n;this.gG=C;this.$d=S;this.isInitialized=!1;this.fig=0;this.Uce=!1;this.Xkj=(ja,ya)=>{var kb;if(!ya)E.ULS.shipAssertTag(520986718,3016,!1,"Got images for a non-existent paragraph");else if(this.YRb.has(ya))if(++this.fig,ja=this.qV.getImages(ya))if((null===(kb=ja.wU)||void 0===
kb?void 0:kb.length)<Jf.a.Uie)E.ULS.shipAssertTag(543269218,3016,!1),this.Ske(!1);else{for(kb=0;kb<Jf.a.Uie&&ja.wU[kb].category===Oc.SuggestionCategory.TextRelatedImage;)kb++;E.ULS.sendTraceTag(527210448,3016,50,`${kb} TextRelated image suggestions returned by workflow`);0<kb?(ya=this.YRb.get(ya),ya.suggestion=new Sc.b(Wc.a.create(),ja.wU,ja.baseUrl,this.gG,this.$d,ya.Qfe),this.Ske(!0)):this.Ske(!1)}else E.ULS.shipAssertTag(543269217,3016,!1),this.Ske(!1)}}initialize(){var e;super.initialize();if(!this.isInitialized){this.isInitialized=
!0;var n=[];for(const [C,S]of this.YRb)(null===(e=S.paragraph)||void 0===e?0:e.characterData)?(S.g2f=S.paragraph.characterData,n.push({id:C,text:S.g2f})):(E.ULS.shipAssertTag(543269214,3016,!1),this.YRb.delete(C));this.YRb.size?(this.Y2i()||E.ULS.sendTraceTag(509649923,3016,50,"Request images for headings"),this.qV.initialize(),this.qV.sff(this.Xkj),this.qV.uZb(n)):(E.ULS.shipAssertTag(521184916,3016,!1),this.pi(!1))}}Wd(){this.isInitialized&&(this.qV.NDj(this.Xkj),this.qV.Wd(),this.isInitialized=
!1);super.Wd()}Ske(e){this.Uce||(this.Uce=e);this.fig==this.YRb.size&&(this.pi(this.Uce),this.fig=0,this.Uce=!1,this.Y2i()||E.ULS.sendTraceTag(509649922,3016,50,"Received all images requested for headings"))}Y2i(){return this.YRb.values().next().value.Qfe}}Object(F.a)(ud,"TextToImageCondition",ul,[]);var xd=d(1093),Yc=d(1422);class Md{constructor(e,n,C,S,ja){this.$d=e;this.Igc=n;this.gsa=C;this.Sm=S;this.context=ja;this.isInitialized=!1;this.ffa=0;this.Pvb=(ya,kb)=>{var Rb=kb.data.annotation;if(Rb)if(Rb.annotationType!==
Yc.FormattingSuggestionsAnnotation.getTypeName())E.ULS.shipAssertTag(523068247,3016,!1);else if(ya=this.gsa.getParent(Rb))if(kb.data.operationType===xd.b.getTypeName())this.Igc.z0m(ya);else if(kb.data.operationType!==xd.a.getTypeName())E.ULS.shipAssertTag(523068249,3016,!1,`unexpected operationType: ${kb.data.operationType}`);else{if(!this.$d.p_f()&&!this.context.TCa.includes(ya))if((Rb=Rb.content)&&Rb.range===Yc.FormattingSuggestionsRange.List&&this.context.Mzl(ya))E.ULS.sendTraceTag(509870788,3016,
50,`Don't skip list paragraph: ${null===ya||void 0===ya?void 0:ya.id}`);else{E.ULS.sendTraceTag(523068251,3016,50,`Skip paragraph not in pastedNodes: ${null===ya||void 0===ya?void 0:ya.id}`);return}this.ffa&&(Rb=[Object.assign(new kh.a,{name:Jf.a.Zog,string:this.$d.p_f()?"RealTimeInconsistencies":"BlueDiamondSmartPaste"})],xa.a(Jf.a.Yog,!0,Date.now()-this.ffa,Rb),this.ffa=0);0<this.$d.fzb()&&this.context.TCa.includes(ya)?E.ULS.sendTraceTag(521483353,3016,50,`Skip paragraph for SmartPaste CCP: ${null===
ya||void 0===ya?void 0:ya.id}`):this.Igc.P7o(ya,kb.data.annotation)}else E.ULS.shipAssertTag(523068248,3016,!1);else E.ULS.shipAssertTag(523068246,3016,!1)}}initialize(){this.isInitialized||(E.ULS.sendTraceTag(545874375,3016,50,"ConsistencySuggestionsProvider - initialize"),this.ffa=Date.now(),this.gsa.QH(this.Pvb),this.Sm.register(),this.gsa.register(),this.isInitialized=!0)}Wd(){this.isInitialized&&(E.ULS.sendTraceTag(545874376,3016,50,"ConsistencySuggestionsProvider - deinitialize"),this.Sm.unregister(),
this.gsa.unregister(),this.gsa.hK(this.Pvb),this.isInitialized=!1)}}Object(F.a)(Md,"ConsistencySuggestionsProvider",null,[506]);class He{constructor(e,n,C,S=!0){this.wOk=e;this.qKk=n;this.zGh=C;this.VId=S;this.T2j=(ja,ya)=>{ya.wha?this.VId&&this._timer?(clearTimeout(this._timer),this.v9j()):this.Jdp():this.Wd()};this._timer=void 0}initialize(){E.ULS.sendTraceTag(545874373,3016,50,"ConsistencySuggestionsTriggerManager - initialize");const e=this.bJi();for(const n of e)n.vqa(this.T2j),n.initialize()}Wd(){E.ULS.sendTraceTag(545874374,
3016,50,"ConsistencySuggestionsTriggerManager - deinitialize");this.VXj();const e=this.bJi();for(const n of e)n.Wd(),n.rDa(this.T2j)}VXj(){if(this.VId){if(!this._timer)return;clearTimeout(this._timer);this._timer=void 0}this.zGh.Wd()}Jdp(){this.zGh.initialize();this.VId&&this.v9j()}bJi(){return this.VId?this.wOk:this.qKk}v9j(){this._timer=setTimeout(()=>{this.VXj()},3E4)}}Object(F.a)(He,"ConsistencySuggestionsTriggerManager",null,[1113]);class xe{constructor(e){this.Pd=e;this.IKc=new Set;this.clear()}clear(){this.nsl()}get TCa(){return this.dzh}nsl(){this.dzh=
[];this.IKc.clear();this.bzh=!1}kef(e){this.bzh&&this.clear();this.dzh.push(e);uj.ListItemReader.De?uj.ListItemReader.isListItem(e)&&({listId:e}=uj.ListItemReader.Jr(e),this.IKc.add(e)):this.Pd&&(e=this.Pd.mfa(e))&&e.hasProperty(hb.a.listID)&&(e=e.getValue(hb.a.listID),this.IKc.add(e))}u$l(){this.bzh=!0}Mzl(e){if(uj.ListItemReader.De){if(uj.ListItemReader.isListItem(e))return{listId:e}=uj.ListItemReader.Jr(e),this.IKc.has(e)}else if((e=this.Pd.mfa(e))&&e.hasProperty(hb.a.listID))return e=e.ka(hb.a.listID,
-1),this.IKc.has(e);return!1}}Object(F.a)(xe,"ContextualSuggestionsContext",null,[]);var ve=d(1478);class Qe{constructor(e,n,C){this.fR=e;this.OP=n;this.zD=C;this.w_n=S=>{this.zD.Kuc({role:28,paragraphNode:S.Ib.paragraph,placeholder:!1,K6c:S});G.AFrameworkApplication.pc.$b(new zg.a(2,1,0,()=>{this.zD.kjd(tt.a.create(S.Ib.paragraph))},void 0,void 0,!0))}}H8o(e){e.paragraphNode?e.suggestion?e.suggestion.ssa(e.Jsa)?null==e.suggestion.x_(e.Jsa)?E.ULS.shipAssertTag(541435532,3016,!1):3===this.OP.Uye(new ve.b(e.suggestion,
[e.paragraphNode],0,Af.ParagraphReader.textLength(e.paragraphNode),()=>this.RSh(e)))&&E.ULS.sendTraceTag(541435533,3016,50,"Contextual image suggestion offered"):E.ULS.shipAssertTag(541435531,3016,!1):E.ULS.shipAssertTag(540389592,3016,!1):E.ULS.shipAssertTag(541435530,3016,!1)}RSh(e){if(e.paragraphNode)if(e.suggestion)if(e.suggestion.ssa(e.Jsa))if(null==e.suggestion.x_(e.Jsa))E.ULS.shipAssertTag(527521920,3016,!1);else return E.ULS.sendTraceTag(527210447,3016,50,"Applying image suggestion. {0}",
{["imageIndex"]:e.Jsa,["imageConfidence"]:e.suggestion.$vm(e.Jsa)}),3===this.OP.Evj(e,n=>{n.suggestion.selectedIndex=n.Jsa;if(n=this.fR.KUf(n.suggestion.ssa(n.Jsa),n.paragraphNode,!0,pe.a.EKb,pe.a.Ehf,{xld:{T0b:0,Ctf:Jf.a.MPi},altText:n.suggestion.x_(n.Jsa),Aae:pe.a.iSd},this.w_n))return{role:28,paragraphNode:n.Ib.paragraph,K6c:n,placeholder:!0}});else E.ULS.shipAssertTag(527521891,3016,!1);else E.ULS.shipAssertTag(527521890,3016,!1);else E.ULS.shipAssertTag(527521889,3016,!1)}}Object(F.a)(Qe,"ImageSuggestionHandlerImpl",
null,[1179]);class hf{constructor(e,n,C){this.Sw=e;this.fR=n;this.Qc=C}initialize(){}Dca(){return this.Sw.isVisible?(E.ULS.sendTraceTag(543269248,3016,50,"Auto launch suppressed: pane already visible"),!0):this.fR.W_d(Af.ParagraphReader.Zm(this.Qc.vd))?(E.ULS.sendTraceTag(543269249,3016,50,"Auto launch suppressed: first paragraph is an image"),!0):!1}v0(){}}Object(F.a)(hf,"ImageSuggestionSuppressionModel",null,[971]);class nf extends Map{constructor(){super(...arguments);this.E0f=!1}hef(e,n){if(e){var C=
e.id.toString();this.has(C)?this.get(C).paragraph=e:this.set(C,{suggestion:null,paragraph:e,g2f:"",Qfe:n})}}dtm(){return this.values().next().value}}Object(F.a)(nf,"ImageSuggestionContextMap",Map,[]);class bg{constructor(e,n,C){this.Tna=e;this.lTf=n;this.gBa=C;this.isInitialized=!1;this.L2j=(S,ja)=>{if(ja.wha)for(const ya of this.gBa.values())ya.suggestion&&this.lTf.H8o(new ve.a(ya.suggestion,ya.paragraph,0));this.gBa.E0f=!1}}initialize(){if(!this.isInitialized){for(const e of this.Tna)e.vqa(this.L2j),
e.initialize();this.isInitialized=!0}}Wd(){if(this.isInitialized){for(const e of this.Tna)e.Wd(),e.rDa(this.L2j);this.isInitialized=!1}}}Object(F.a)(bg,"ImageSuggestionTriggerManager",null,[1113]);class lh{constructor(e){this.Sw=e}initialize(){}Dca(){return this.Sw.isVisible?(E.ULS.sendTraceTag(542500385,3016,50,"Auto launch suppressed: pane already visible"),!0):!1}v0(){}}Object(F.a)(lh,"PullQuotesSuppressionModel",null,[971]);var ph=d(1769);class Sf{constructor(e,n,C,S,ja,ya,kb=null,Rb){this.Tna=
e;this.Hko=n;this.eYb=C;this.Tvf=S;this.OP=ja;this.Sm=ya;this.gG=kb;this.$d=Rb;this.e8d=(sc,Fc)=>{Fc.wha&&this.y9o().then(gd=>{E.ULS.sendTraceTag(542500378,3016,50,`PullQuotes showed: ${gd}`)});this.Wd()}}initialize(){E.ULS.sendTraceTag(542500376,3016,50,"PullQuotesTriggerManager.ts - initialize");for(const e of this.Tna)e.vqa(this.e8d),e.initialize()}Wd(){E.ULS.sendTraceTag(542500377,3016,50,"PullQuotesTriggerManager.ts - deinitialize");for(const e of this.Tna)e.Wd(),e.rDa(this.e8d)}y9o(){return this.eYb.getAnnotations().then(e=>
{let n=0;try{for(const C of e){if(!C)return E.ULS.shipAssertTag(542500379,3016,!1),n;if(C.annotationType!==Wb.PullQuoteAnnotation.getTypeName())return E.ULS.shipAssertTag(542500380,3016,!1),n;const S=C.content;if(!S)return E.ULS.shipAssertTag(542500381,3016,!1),n;if(0<S.confidence){const ja=C.parent;if(!ja)return E.ULS.sendTraceTag(512239202,3016,50,"Paragraph node is null."),n;const ya=this.Sm.YB(ja);if(!ya||27===ya.role||ya.$la)continue;let kb=Af.ParagraphReader.text(ja);if(!kb)return E.ULS.shipAssertTag(512323934,
3016,!1),n;const Rb=S.range.start,sc=S.range.length;E.ULS.sendTraceTag(538730699,3016,50,"PQ annotation info: {0}",{["annStart"]:Rb,["annLength"]:sc,["orgTextLength"]:kb.length,["paragraphLength"]:Af.ParagraphReader.textLength(ja)});0<sc&&(kb=kb.substr(Rb,sc));const Fc=Math.floor(Math.random()*ph.a.TIj),gd=Wc.a.create();E.ULS.sendTraceTag(541446497,3016,50,"Detected pull quote info: {0}",{["suggestionId"]:gd,["confidence"]:S.confidence,["textLength"]:kb.length,["paragraphLength"]:Af.ParagraphReader.textLength(ja),
["paragraphRole"]:ya.role});this.Tvf.Kuc({role:27,paragraphNode:ja,placeholder:!1});const td=this.OP.Uye(new ve.b(new Sc.d(gd,1,this.gG,this.$d,!0,Fc,kb),[ja],Rb,Rb+sc,(Bd,wd)=>{if(!wd||1!=wd.length)return E.ULS.shipAssertTag(509744530,3016,!1,`Wrong paragraph count when applying pull quote ${null===wd||void 0===wd?void 0:wd.length} suggestionId:${gd}`),!1;wd=wd[0];E.ULS.sendTraceTag(541446498,3016,50,"Blue dot clicked, creating pull quote with info: {0}",{["suggestionId"]:gd,["textLength"]:kb.length,
["paragraphLength"]:Af.ParagraphReader.textLength(wd),["paragraphRole"]:Bd.role,["styleId"]:Fc});Bd=[new ve.c(new Sc.d(gd,1,this.gG,this.$d,!0,Fc,kb),wd,Fc,kb,te=>{this.Tvf.kjd(tt.a.create(te));this.Tvf.Kuc({role:27,paragraphNode:te,placeholder:!1})})];this.Hko.oSd(Bd);return!0}));td&&1!==td&&n++}}}catch(C){E.ULS.shipAssertTag(542500383,3016,!1,"Exception occurred: {0}",String.format("{0} {1}",C.message,C.stack))}finally{return n}}).catch(()=>{E.ULS.shipAssertTag(542500384,3016,!1);return Promise.resolve(0)})}}
Object(F.a)(Sf,"PullQuotesTriggerManager",null,[1113]);class De{constructor(e,n,C){this.source=e;this.event=n;this.target=C}}Object(F.a)(De,"Transition",null,[]);class Yf{constructor(){this.s2j=[new De(0,0,1),new De(1,0,1),new De(1,1,2),new De(0,1,3),new De(3,2,0),new De(1,2,0),new De(2,2,0)];this.isInitialized=!1}zHn(e){const n=new kh.a,C=new kh.a;n.name=Jf.a.OXl;n.int64=e.event;C.name=Jf.a.QXl;C.int64=e.target;xa.a(Jf.a.PXl,!0,void 0,[n,C])}transition(e,n){if(this.isInitialized&&this.s2j)for(const C of this.s2j)if(C.event===
e&&C.source===this.state)return n&&(this.zHn(C),this.state=C.target),!0;return!1}initialize(e){this.isInitialized||(this.state=e,this.isInitialized=!0)}getState(){return this.state}F_d(e){return this.transition(e,!0)}}Object(F.a)(Yf,"DocumentStateMachine",null,[]);var ki=d(1441);class Df{constructor(e,n){this.V_j=e;this.Eae=n}equals(e){return!!e&&this.V_j===e.V_j&&this.Eae.length===e.Eae.length&&this.Eae.every((n,C)=>n===e.Eae[C])}}Object(F.a)(Df,"TemplateContent",null,[]);class gf{yBp(e){this.yyn=
this.Byi(e)}iun(e){var n;return!(null===(n=this.yyn)||void 0===n?0:n.equals(this.Byi(e)))}Byi(e){var n,C;let S=0;const ja=[];e=Af.ParagraphReader.Kv(e,!0,!0);for(const ya of e)if(e=ya)Af.ParagraphReader.M5c(e)&&ja.push(e.id.toString()),S+=null!==(C=null===(n=e.characterData)||void 0===n?void 0:n.length)&&void 0!==C?C:0;return new Df(S,ja)}}Object(F.a)(gf,"TemplateContentComparer",null,[]);class vj{constructor(e,n,C,S,ja,ya){this.Og=e;this.view=n;this.Tob=C;this.ih=S;this.Mgc=ja;this.$d=ya;this.jd=
new eb.a;this.R_j=new gf;this.C2n=(kb,Rb)=>{this.ih.dba(Rb.actionId)&&this.ADg()};this.t5n=(kb,Rb)=>{this.gYi||(this.ekj(kb,Rb),this.uSd&&this.G0d())};this.ekj=()=>{if(!this.uSd){let kb=!1;this.S8c()?kb=this.Mgc.F_d(2):1===this.rVa()?this.R_j.iun(this.view.vd)&&(kb=this.Mgc.F_d(1),yq.rHn(this.$d)):kb=this.Mgc.F_d(1);kb&&this.jd.raiseEvent("OnDocumentStateChanged",new ki.a(this.rVa()))}};this.Zqp();this.Tob.vKb(this.ekj);this.ih.t2k(this.t5n);this.ih.U1k(this.C2n)}S8c(){return this.Og.Vja(this.view.vd)}Zqp(){const e=
this.S8c()?0:3;this.Mgc.initialize(e)}Hwi(){switch(this.rVa()){case 0:case 1:return ur.templates;case 2:return ur.templateStyles;default:return ur.main}}ADg(){this.uSd=!0}G0d(){this.uSd=!1;this.Mgc.F_d(0)&&this.$wp();this.R_j.yBp(this.view.vd)}$wp(){this.jd.raiseEvent("OnDocumentStateChanged",new ki.a(this.rVa()))}rVa(){return this.Mgc.getState()}xPh(e){this.jd.addHandler("OnDocumentStateChanged",e)}freeze(){this.gYi=!0}ltp(){this.gYi=!1}}Object(F.a)(vj,"DocumentStateMonitor",null,[1177]);class cm extends bh.a{constructor(e,
n,C){super(n);this.cWe=!1;this.errorState=e;this.F$a=C}get nta(){return this.F$a&&this.cWe?!1:super.nta}dismiss(){this.F$a&&!this.cWe&&(this.cWe=!0,this.pi(!1))}}Object(F.a)(cm,"AErrorStateConditionProcessor",bh.a,[1200,858,506]);class yl extends cm{constructor(e){super(Zo.nonTargetDocument,"DocumentLanguageErrorConditionId",!0);this.i6b=e;this.bLe=this.OYn.bind(this)}initialize(){super.initialize();void 0===this.i6b.T8c?this.i6b.G0k(this.bLe):this.tZa()}Wd(){this.i6b.tDj(this.bLe);super.Wd()}tZa(){this.pi(void 0!==
this.i6b.T8c&&!this.i6b.T8c)}OYn(){this.tZa();this.i6b.tDj(this.bLe)}}Object(F.a)(yl,"DocumentLanguageErrorCondition",cm,[]);var Vh=d(1402);class yo extends cm{constructor(e){super(Zo.documentTooLarge,"DocumentTooLargeErrorConditionId",!1);this.Qvb=(n,C)=>{C.data.operationType===Vh.a.getTypeName()&&(C.data.annotation?C.data.annotation.annotationType!==Yc.FormattingSuggestionsSummaryAnnotation.getTypeName()?E.ULS.shipAssertTag(570781981,3016,!1):(n=C.data.annotation.content)?this.pi(n.errorCode===
Yc.ErrorCode.DocumentTooLarge):E.ULS.shipAssertTag(570781982,3016,!1):E.ULS.shipAssertTag(570781980,3016,!1))};this.Mih=e}initialize(){super.initialize();this.Mih.QH(this.Qvb)}Wd(){super.Wd();this.Mih.hK(this.Qvb)}tZa(){}}Object(F.a)(yo,"DocumentTooLargeErrorCondition",cm,[]);var pl=d(1433);class Qn extends cm{constructor(e,n,C){super(Zo.lowConfidenceDocument,"LowConfidenceErrorConditionId",!0);this.Zbh=-1;this.Uib=!1;this.Pdg=(S,ja)=>{ja.data.operationType===Vh.a.getTypeName()&&(ja.data.annotation?
ja.data.annotation.annotationType!==pl.DocumentRoleDetectionAnnotation.getTypeName()?E.ULS.shipAssertTag(570781977,3016,!1):(S=ja.data.annotation.content,S)?S.errorCode||(this.Zbh=S.isTarget?1:0,this.Uib||this.tZa(),this.OPe.hK(this.Pdg)):E.ULS.shipAssertTag(570781978,3016,!1):E.ULS.shipAssertTag(570781976,3016,!1))};this.OPe=e;this.hb=n;this.Qj=C}initialize(){super.initialize();this.OPe.QH(this.Pdg)}Wd(){super.Wd();this.OPe.hK(this.Pdg)}tZa(){this.Uib=this.hb.Vja(this.Qj.vd);this.pi(!this.Zbh&&!this.Uib)}}
Object(F.a)(Qn,"LowConfidenceErrorCondition",cm,[]);var Yj=d(1221),iq=d(1222);class fo extends cm{constructor(e,n){super(Zo.multipleAuthorsNotSupported,"MultipleAuthorsErrorConditionId",!1);this.sn=e;this.hag=n;this.Meh=!1}tZa(){const e=!hq.zPg(this.sn,this.hag);this.pi(e);e&&!this.Meh&&(this.Meh=!0,E.ULS.sendTraceTag(556888910,Yj.a.fag,iq.a.info,"Coauthoring error satisfied: {{ AmIAlone: {0}, AmITheOnlyCoauthor: {1}, IsWebToWeb: {2} }}",this.sn.yq,this.sn.Sja,this.sn.hA.FLa))}}Object(F.a)(fo,"MultipleAuthorsErrorCondition",
cm,[]);class fm extends cm{constructor(e,n){super(Zo.trackChangesNotSupported,"TrackChangeErrorConditionId",!1);this.Qd=e;this.zOa=n;this.Hoj=()=>{this.tZa()}}initialize(){super.initialize();this.zOa.jte("OnTrackChangesStatusUpdatedEventKey",this.Hoj);this.tZa()}Wd(){super.Wd();this.zOa.vBo(this.Hoj)}tZa(){this.pi(this.Qd.Bg)}}Object(F.a)(fm,"TrackChangeErrorCondition",cm,[]);class Kh{constructor(e){this.vi=!1;this.Pyd=Zo.none;this.SKe=!1;this.rYa=()=>{this.oKg()};this.sa=new eb.a;this.PY=e}initialize(){if(!this.PY.count)E.ULS.shipAssertTag(570781983,
3016,!1);else if(!this.vi){for(const e of this.PY)e.initialize(),e.fRd(this.rYa);this.vi=!0;this.oKg()}}Wd(){if(this.vi){for(const e of this.PY)e.Hte(this.rYa),e.Wd();this.vi=!1}}UOh(e){this.sa.addHandler("CurrentErrorStateChangedEventKey",e)}LBo(e){this.sa.removeHandler("CurrentErrorStateChangedEventKey",e)}get eNb(){return this.Pyd}FQj(e){this.Pyd!==e&&(this.Pyd=e,this.sa.raiseEvent("CurrentErrorStateChangedEventKey",new ki.a(this.Pyd)))}nVl(){for(const e of this.PY)e.F$a&&e.dismiss()}W3d(){this.SKe=
!1;for(const e of this.PY)e.tZa();this.oKg();return this.eNb}i6o(e){return e.F$a&&this.SKe&&this.eNb!==e.errorState}oKg(){for(const e of this.PY)if(e.nta&&!this.i6o(e)){this.FQj(e.errorState);this.SKe=!0;return}this.FQj(Zo.none)}}Object(F.a)(Kh,"ErrorStateManagerV2",null,[1176,506]);class lu{constructor(e,n,C,S,ja,ya){this.taskPane=e;this.w4=n;this.hjp=C;this.zaa=S;this.zD=ja;this.$P=ya;this.isInitialized=!1;this.iAc=()=>{this.taskPane.isVisible&&this.hjp.woc&&!this.zaa.eNb&&(this.J2j(11===this.taskPane.Js?
Jf.a.mlk:Jf.a.F9n),this.E9n=wb.a.Je(),window.addEventListener("FGWebSurfaceEvent",this.H$i,!0),this.w4.VDj(this.iAc),this.w4.PDj(this.iAc),this.zaa.LBo(this.iAc))};this.H$i=kb=>{var Rb;"d7c04a5a-c5ed-43b1-a927-d2f31717f7ee"===(null===(Rb=null===kb||void 0===kb?void 0:kb.detail)||void 0===Rb?void 0:Rb.id)&&(kb=wb.a.Je()-this.E9n,E.ULS.sendTraceTag(529348737,3016,50,`Pane FRE shown after: ${kb}`));window.removeEventListener("FGWebSurfaceEvent",this.H$i,!0)};this.nnj=()=>{this.J2j(Jf.a.XWn);this.zD.qCo(this.nnj)}}initialize(){this.isInitialized||
(this.isInitialized=!0,this.w4.xcc(this.iAc),this.w4.vff(this.iAc),this.zaa.UOh(this.iAc),this.zD.xff(this.nnj))}Wd(){}J2j(e){this.$P.execute(n=>{n.logActivity(e,null)})}}Object(F.a)(lu,"DesignerFirstRunExperienceManager",null,[1175,506]);var oi=d(136),Rq=d(658),zl=d(52),$o=d(229),zq=d(230),Yk=d(78),Kp=d(1066);class cv{get state(){return this._state}constructor(){this._state="pending";this.uHb=new Promise((e,n)=>{this.nT=e;this.Mpa=n})}finally(e){return this.uHb.finally(e)}then(e,n){return this.uHb.then(e,
n)}catch(e){return this.uHb.catch(e)}resolve(e){this.nT(e);this._state="fulfilled"}reject(e){this.Mpa(e);this._state="rejected"}}Symbol.toStringTag;Object(F.a)(cv,"DeferredPromise",null,[]);var dn=d(1809),Pt=d(1724),kp=d(171),sj=d(1453);const dv=(e,n,C=!0,S=()=>!0)=>{const ja=new Ed.a;ja.set(e);nh.forEachCellInTable(ja,ya=>{(ya=ya.currentNode)&&S(ya)&&(ya.setValue(hb.a.Nzb,kp.a.Oya),ya.setValue(hb.a.Kzb,kp.a.Oya),ya.setValue(hb.a.Lzb,kp.a.Oya),ya.setValue(hb.a.Mzb,kp.a.Oya));return!0});C&&(e.setValue(hb.a.mb,
0),e.setValue(hb.a.nb,kp.a.Oya),e.setValue(hb.a.ob,0),e.setValue(hb.a.pb,kp.a.Oya),e.setValue(hb.a.Xa,0),e.setValue(hb.a.Ya,kp.a.Oya),e.setValue(hb.a.Va,0),e.setValue(hb.a.Wa,kp.a.Oya));ja.set(e);n.D9j(ja)},Ds=(e,n)=>(null===e||void 0===e?void 0:e.type)===n,ls=e=>{if(!e.Nd())return!1;e.kd(11);return!0},Es=e=>{if(!e)return E.ULS.shipAssertTag(528779278,3016,!1),null;if(e=$o.WordSectionNavigator.instance.NU(e)){const n=new Pt.a;n.marginTop=zq.a.instance.usa(e);n.marginBottom=zq.a.instance.xAa(e);n.marginLeft=
zq.a.instance.gN(e);n.marginRight=zq.a.instance.hN(e);n.pageWidth=zq.a.instance.Jv(e);n.pageHeight=zq.a.instance.qE(e);n.DBa=zq.a.instance.C9c(e);return n}E.ULS.shipAssertTag(529008003,3016,!1);return null},Zw=(e,n,C)=>{var S;const ja=new kf.DictionaryPropertySet;ja.setValue(Gh.a.XX,e);ja.setValue(Gh.a.GDa,!0);ja.setValue(Gh.a.Vfa,!0);n.Qb(pe.a.LHa,2,ja);e=[];for(C=C.gb.currentSelection.ZT(!0);C.moveNext();)(n=null===(S=C.current)||void 0===S?void 0:S.node)&&e.push(n);return e},tw=()=>{var e=vm.PageReader.instance.qkc();
e=Af.ParagraphReader.Zm(e,!0,!0);if(!e)return E.ULS.shipAssertTag(527212705,3016,!1),!1;if(Ys())return!1;e=Es(e);if(!e)return!1;var n=dn.a.uua[3].D3a,C=dn.a.uua[0].C3a,S=dn.a.uua[0].D3a;if(!(e.pageHeight===dn.a.uua[3].C3a&&e.pageWidth===n||e.pageHeight===C&&e.pageWidth===S))return!1;n=dn.a.S3[0].rGd;C=dn.a.S3[0]._marginLeft;S=dn.a.S3[0].sGd;return e.marginTop===dn.a.S3[0].tGd&&e.marginBottom===n&&e.marginLeft===C&&e.marginRight&&S},Ys=()=>{const e=Ed.a.eb(Rd.a.hm.kb.hd);Object(sd.a)().ZR(e);if(!e.currentNode)return E.ULS.shipAssertTag(527212706,
3016,!1),!1;if(!e.PVa(0,n=>n instanceof Kp.a))return!1;e.je();do{const n=e.currentNode;if(n&&n.ka(hb.a.tMb,void 0)===Jf.a.hDl)return!0}while(e.Tk());return!1},Zs=(e,n)=>{e=Af.ParagraphReader.Kv(e,!1,!1);return null===e||void 0===e?void 0:e.toArray().filter(C=>{var S;const ja=null===(S=null===C||void 0===C?void 0:C.characterData)||void 0===S?void 0:S.trim();return 0!==(null===ja||void 0===ja?void 0:ja.length)&&!(null===n||void 0===n?0:n.find(ya=>ya===ja))})},il=(e,n,C,S,ja,ya,kb,Rb)=>{let sc=C.mg(e);
if(!sc.zb(14)||!sc.kd(14))return E.ULS.shipAssertTag(524115976,3016,!1),!1;if(!ls(sc))return E.ULS.shipAssertTag(524115977,3016,!1),!1;n.yy(sc,!1,!1);n=n.dL(sc);hr(e,n,S,ja,ya,kb,Rb,!0);sc=C.mg(e);sc.Nd();sc.Tg();sc.Tg();return!0},Fs=(e,n)=>{e=n.mg(e);ls(e)?e.Tk()&&n.Ayi(e).Tk()&&(e.PVa(0,C=>Ds(C,12)),null!==e&&Af.ParagraphReader.isEmpty(e)&&(e.Tg(),e.Tg())):E.ULS.shipAssertTag(527462685,3016,!1)},Aq=(e,n,C,S,ja=60)=>{var ya,kb=Af.ParagraphReader.Kv(n,!1,!1);if(kb&&0!==kb.count){n=[];for(const Rb of kb)if(kb=
Rb,0===(null===(ya=null===kb||void 0===kb?void 0:kb.characterData)||void 0===ya?void 0:ya.trim().length)&&(n.push(kb),2===n.length))break;for(const Rb of e)mn(Rb,C,S,ja);for(const Rb of n)mn(Rb,C,S,ja)}},mn=(e,n,C,S=60)=>{n.Gtc(e,0,Af.ParagraphReader.textLength(e),C,S)},og=(e,n,C,S,ja)=>{S=S.mg(e);S.zb(14);const ya=S.kd(14),kb=new cv;C.lWf(e,0,Af.ParagraphReader.textLength(e),ja,Rb=>{var sc;if(60===Rb){if(!n.read(ya)){Rb=n.write;a:{switch(ja){case sj.a.zEg:var Fc={type:sn.table};break a;case sj.a.Pec:Fc=
{type:sn.complexDecorator};break a}Fc=void 0}Rb.call(n,ya,Fc)}0!==(null===(sc=null===e||void 0===e?void 0:e.characterData)||void 0===sc?void 0:sc.trim().length)&&n.qLp(ya,e)}kb.resolve()});return kb},hr=(e,n,C,S,ja,ya,kb,Rb=!1)=>{var sc;const Fc=e.iQ,gd=C.pDi(e),td=kb.YB(e);e=Af.ParagraphReader.R3(e);const Bd=ce.a.createTextRange(n,0,Af.ParagraphReader.textLength(n));S.We(Bd,e);C.LSh(n,gd);C=null!==(sc=null===td||void 0===td?void 0:td.role)&&void 0!==sc?sc:1;Rb&&1===C&&(ja=ja.Be(Fc),ja===zl.StyleReader.dBb&&
(C=2),ja===zl.StyleReader.oud&&(C=3));1!==C&&(ya.Uja(n,C),kb.Qnd(n,C,td.ipc,!1,td.Fcd,td.Eie,td.listItemPrefix))},jl=(e,n,C)=>{(e=e.properties)&&n.kzg(e,C)},Sq=e=>e?e.replace(/((rgb\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}\s*\))|(#[0-9a-fA-F]{6}))/g,n=>Yk.a.sXd(n)):(E.ULS.shipAssertTag(523104409,3016,!1),e),Dz=(e,n)=>{e=n.mg(e);return ls(e)?!0:(E.ULS.shipAssertTag(509207309,3016,!1),!1)};class Pi{constructor(e,n,C,S,ja,ya,kb,Rb,sc){this.Mf=e;this.$m=n;this.lb=C;this.Skf=S;this.HR=ja;this.Yb=ya;this.FA=kb;
this.Qc=Rb;this.ps=sc;this.LUf=(Fc,gd,td,Bd,wd)=>null!==gd&&void 0!==gd&&gd.properties?(null===Fc||void 0===Fc?void 0:Fc.property)===Gh.a.Bu?(E.ULS.sendTraceTag(524076488,3016,50,`Image loaded after ${wb.a.Je()-td}`),Bd&&this.mii(gd,Bd),wd&&wd(gd),!0):!1:(E.ULS.shipAssertTag(524076485,3016,!1),!1)}KUf(e,n,C,S=pe.a.s6,ja=pe.a.Ehf,ya,kb){var Rb,sc,Fc,gd;try{if(e&&""!==e){n||E.ULS.shipAssertTag(544011278,3016,!1,"Paragraph is not valid");var td=String.format('<img src="{0}"/>',e),Bd=this.OGl(n,C,ja);
if(Bd){const wd=null===(Rb=this.lb.gb)||void 0===Rb?void 0:Rb.currentSelection;this.lb.Kc(new Lf.Selection([ce.a.Uc(Bd,0)],!0));const te=new kf.DictionaryPropertySet;te.setValue(Gh.a.XX,td);te.setValue(Gh.a.Vfa,!0);G.AFrameworkApplication.va.Qb(S,2,te);const Le=Af.ParagraphReader.pg(n,C);null===(sc=this.ps)||void 0===sc?void 0:sc.b4(0);null===(Fc=this.ps)||void 0===Fc?void 0:Fc.P_a();this.lb.Kc(wd);null===(gd=this.ps)||void 0===gd?void 0:gd.iTa();const Oe=Pi.s6d(Le);if(kb||ya){const We=wb.a.Je();
Pi.ENh(Oe,Xf=>this.LUf(Xf,Oe,We,ya,kb))}return Oe}E.ULS.shipAssertTag(545814281,3016,!1,"Unsuccessful node creation")}else E.ULS.shipAssertTag(545814280,3016,!1,"Invalid image URL")}catch(wd){E.ULS.shipAssertTag(545814282,3016,!1,String.format("{0} {1}",wd.message,wd.stack))}}mii(e,n){const C=null===e||void 0===e?void 0:e.properties;if(C)if(n){var S=this.FA.Lc(15,n.Aae);try{S.Rz.Ab(this.Qc.vd),n.xld&&this.EHo(e,n.xld),n.altText&&this.HR.g_a(C,n.altText)}finally{S.dispose()}}else E.ULS.shipAssertTag(523572621,
3016,!1);else E.ULS.shipAssertTag(523572620,3016,!1)}OGl(e,n,C){C=this.FA.Lc(15,C,!1);try{C.Rz.Ab(this.Qc.vd);const S=this.$m.mg(e);if(!S.Nd())return null;tl.OutlineElementNavigator.me(S);this.Mf.yy(S,n,!1,void 0,void 0,!1);const ja=new Rq.a,ya=this.Yb.IF(e);ya&&(ja.goa=ya.nh(zl.StyleReader.c3b));return this.Mf.dL(S,ja)}finally{C.dispose()}}W_d(e){return null!=this.$m.mg(e).PVa(0,n=>kl.a.LSb(n.properties))?!0:!!Pi.s6d(e)}Ljl(e,n,C){if(0>=C)E.ULS.shipAssertTag(545367367,3016,!1,String.format("Aspect ratio:{0} must be bigger than 0",
C));else{var S=e/n;if(C>S)return n=Math.floor((n-e/C)/n*5E4),{width:e,height:e/C,MIa:n,JIa:n};if(C<S)return e=Math.floor((e-n*C)/e*5E4),{width:n*C,height:n,KIa:e,LIa:e}}}lkl(e,n,C,S){let ja={width:e,height:n};S.Ctf&&(e=this.Ljl(e,n,S.Ctf),ja={...ja,...e},e=ja.width,n=ja.height);if(0===S.T0b&&C)return ja.width=2*oi.a.iB(C.pageWidth-C.marginLeft-C.marginRight)-.08,ja.height=ja.width/e*n,ja;if(1===S.T0b&&C)return ja.width=2*oi.a.iB(C.pageWidth),ja.height=ja.width/e*n,ja.rQi=-C.marginLeft,ja;if(2===S.T0b&&
0<S.SWh&&0<S.OWh)return C=Math.min(1*S.SWh/e,1*S.OWh/n),ja.width=e*C,ja.height=n*C,ja;-1!==S.T0b&&E.ULS.shipAssertTag(524105118,3016,!1,"Couldn't stretch image for stretchType {0}",S.T0b);return ja}T8k(e,n){var C,S,ja,ya,kb,Rb;const sc=e.properties;this.Skf.JNa(sc,n.width);this.Skf.INa(sc,n.height);n.rQi&&(null===(C=e.Ib)||void 0===C?0:C.paragraph)&&Re.a.n9a.KNa(null===(S=e.Ib)||void 0===S?void 0:S.paragraph,1,n.rQi);(n.MIa||n.JIa||n.KIa||n.LIa)&&this.HR.kyg(sc,null!==(ja=n.MIa)&&void 0!==ja?ja:0,
null!==(ya=n.JIa)&&void 0!==ya?ya:0,null!==(kb=n.KIa)&&void 0!==kb?kb:0,null!==(Rb=n.LIa)&&void 0!==Rb?Rb:0)}EHo(e,n){var C;if(e){var S=e.properties;if(S){var ja=kl.a.FF(S);S=kl.a.rL(S);if(0>=ja)E.ULS.shipAssertTag(545814284,3016,!1,String.format("Image width:{0} must be bigger than 0",ja));else if(0>=S)E.ULS.shipAssertTag(545814285,3016,!1,String.format("Image height:{0} must be bigger than 0",S));else{var ya=Es(null===(C=e.Ib)||void 0===C?void 0:C.paragraph);n=this.lkl(ja,S,ya,n);this.T8k(e,n)}}else E.ULS.shipAssertTag(545814283,
3016,!1,"Image properties should not be null")}else E.ULS.shipAssertTag(539772548,3016,!1,"Image blob should not be null")}bvc(e,n){this.Skf.KCj(n,e);e=this.$m.mg(n);Af.ParagraphReader.isEmpty(e)&&this.Mf.pDa(e.currentNode)}static s6d(e){var n;const C=(null===e||void 0===e?0:e.ra)?e.ra.length:0;for(let S=0;S<C;S++){const ja=e.ra.Ub(S);if(5==(null===(n=ja.blob)||void 0===n?void 0:n.Sh))return ja.blob}return null}static ENh(e,n){const C=(S,ja)=>{n(ja)&&(e.properties.remove_propertyChanged(C),e.properties.ICo(C))};
e.properties.add_propertyChanged(C);e.properties.H2k(C)}static HEo(e){if(!e)return E.ULS.shipAssertTag(538996813,3016,!1),[e,!1];const n=/src="([\w\W]+?)"/g;let C,S=e,ja=!1;for(;null!==(C=n.exec(e));)S=S.replace(C[1],Sd.a.Aj(C[1])),ja=!0;return[S,ja]}}Object(F.a)(Pi,"DesignerImageManagerImpl",null,[1148]);var dm=d(1708),Xi=d(1418);class Oo{constructor(e,n,C,S){this.Sm=e;this.y1b=n;this.Qc=C;this.Yb=S;this.isInitialized=!1;this.wzc=new Map;this.Dgd=new Map;this.jd=new eb.a;this.zoj=(ja,ya)=>{var kb;
ya.data.operationType===Vh.a.getTypeName()&&(ya.data.annotation?(ja=this.GEm(ya.data.annotation.parentPath),ja.id&&ja.text?ya.data.annotation.annotationType!==dm.TextToImageAnnotation.getTypeName()?E.ULS.shipAssertTag(526424277,3016,!1):(ya=ya.data.annotation.content)?null!==(kb=ya.images)&&void 0!==kb&&kb.length?this.wzc.set(ja.text,{wU:ya.images,baseUrl:ya.baseUrl}):E.ULS.shipAssertTag(526424279,3016,!1):E.ULS.shipAssertTag(526424278,3016,!1):E.ULS.shipAssertTag(521184640,3016,!1),this.jd.raiseEvent("OnImagesChanged",
ja.id)):(E.ULS.shipAssertTag(526424276,3016,!1),this.jd.raiseEvent("OnImagesChanged",null)))}}initialize(){this.isInitialized||(this.isInitialized=!0,this.y1b.register(),this.y1b.QH(this.zoj))}Wd(){this.isInitialized&&(this.isInitialized=!1,this.y1b.hK(this.zoj),this.y1b.unregister())}LFj(){const e=this.cOf();return e?this.uZb([{id:e.id.toString(),text:e.characterData}]):!0}uZb(e){e=e.filter(n=>{const C=n.id;n=n.text;return n?this.wzc.has(n)?(this.Dgd.get(C)!==n&&this.Dgd.set(C,n),this.jd.raiseEvent("OnImagesChanged",
C),!1):!0:(E.ULS.sendTraceTag(512267554,3016,50,""===n?"DesignerTextToImageManager.RequestImages - paragraphText is empty":"DesignerTextToImageManager.RequestImages - paragraphText is null"),this.jd.raiseEvent("OnImagesChanged",C),!1)});if(!e.length)return!0;e.forEach(n=>{this.Dgd.set(n.id,n.text);this.wzc.set(n.text,null)});this.SQo(e);return!1}sff(e){this.jd.addHandler("OnImagesChanged",e)}NDj(e){this.jd.removeHandler("OnImagesChanged",e)}cOf(){var e;const n=Af.ParagraphReader.Zm(this.Qc.vd);return null===
n||void 0===n||!n.characterData||n.TG?null:2===(null===(e=this.Sm.YB(n))||void 0===e?void 0:e.role)||this.Sm.OZf(n)&&this.Yb.Be(this.Yb.Cq(n))===zl.StyleReader.dBb?n:null}lvm(){return Af.ParagraphReader.Kv(this.Qc.vd,!1,!1,!1).toArray().filter(e=>{var n;const C=null===(n=this.Sm.YB(e))||void 0===n?void 0:n.role;return Object(Xi.b)(C)||this.Sm.OZf(e)&&this.Yb.Be(this.Yb.Cq(e))===zl.StyleReader.wordStyleIdHeader?!0:!1})}swm(){return this.wzc.get(this.wzc.keys().next().value)}getImages(e){e=this.Dgd.get(e);
return this.wzc.get(e)}SQo(e){e=e.map(n=>({id:n.id,body:new dm.TextToImageSignal({content:n.text})}));this.y1b.D_l(e,dm.TextToImageSignal.getTypeName())}GEm(e){let n="";e&&(e=e.split("\\",3),3<=e.length&&(n=e[2]));e=this.Dgd.get(n);return{id:n,text:e}}}Object(F.a)(Oo,"DesignerTextToImageManagerImpl",null,[1173]);class ms{constructor(e){this.sa=new eb.a;this.i9g=this.Znh=this.vi=!1;this.uv=e}get Hin(){return this.Znh}get PTh(){return this.i9g}M0k(e){this.sa.addHandler("LicenseStateChanged",e)}j0k(e){this.sa.addHandler("PQLicenseStateChanged",
e)}GBo(e){this.sa.removeHandler("PQLicenseStateChanged",e)}initialize(){this.vi||(this.uv.execute(e=>{e.isFeatureEnabled(Jf.a.KBf,Jf.a.w6i).then(n=>{n?e.getFeatureTier(Jf.a.KBf,0).then(C=>{C=[Object.assign(new kh.a,{name:"tier",int64:C})];xa.a(Jf.a.hIp,!0,0,C)}):xa.a(Jf.a.jIp);this.g9j(n);return null});e.Cua(Jf.a.KBf,n=>{this.g9j(n.isEnabled)});e.isFeatureEnabled(Jf.a.zwj,Jf.a.w6i).then(n=>{this.n8j(n);return null});e.Cua(Jf.a.zwj,n=>{this.n8j(n.isEnabled)})}),this.vi=!0)}Wd(){}g9j(e){this.Znh=e;
this.sa.raiseEvent("LicenseStateChanged",new ki.a(e))}n8j(e){this.i9g=e;this.sa.raiseEvent("PQLicenseStateChanged",new ki.a(e))}}Object(F.a)(ms,"LicenseManager",null,[1174,506]);class nn{constructor(e,n){this.Og=e;this.Qc=n}initialize(){const e=this.Og.Vja(this.Qc.vd);E.ULS.sendTraceTag(541701569,3016,50,`isDocumentEmpty=${e}`)}Wd(){}}Object(F.a)(nn,"BlankDocumentLogger",null,[1172]);class $g{constructor(e,n,C){this.F2=e;this.gsa=n;this.w4=C;this.Ucf=!1;this.ebb=null;this.ffa=0;this.Ose=!1;this.Hcg=
(S,ja)=>{try{if(ja.data.operationType===Vh.a.getTypeName()){if(!this.Ose){const ya=[Object.assign(new kh.a,{name:Jf.a.Zog,string:"PaneInconsistencies"})];xa.a(Jf.a.Yog,!0,Date.now()-this.ffa,ya);this.Ose=!0}if(this.ebb){let ya;(ya=this.ebb).interval=ya.interval+Jf.a.R5h}else this.Ucf||(this.ebb=new zg.a(3,1,Jf.a.R5h,()=>{this.Khe();this.ebb=null}),Ek.a.instance.$b(this.ebb))}}catch(ya){E.ULS.shipAssertTag(575930784,3016,!1,String.format("{0} {1}",ya.message,ya.stack))}};this.Noe=(S,ja)=>{ja.data&&
this.ffa&&xa.a(Jf.a.G9n,!0,Date.now()-this.ffa)}}initialize(){this.ffa=Date.now();this.Ose=!1;this.F2.QH(this.Hcg);this.w4.vff(this.Noe)}Wd(){this.F2.hK(this.Hcg);this.w4.PDj(this.Noe);this.Ose=!0;this.ffa=0}Khe(){try{this.Ucf||this.gsa.getAnnotations().then(e=>{E.ULS.sendTraceTag(575930781,3016,50,"Consistency fix actions: {0}",e.count);xa.a(Jf.a.glk,!0,void 0,[Object.assign(new kh.a,{name:"FormattingSuggestionsCount",int64:e.count})]);const n={};for(const C of e){e=C.content;for(const S of e.suggestions)n[S.type.toString()]=
S.type.toString()in n?n[S.type.toString()]+1:1}E.ULS.sendTraceTag(575930782,3016,50,"Consistency fix actions: {0} ",JSON.stringify(n));this.Ucf=!0;this.ebb=null;this.F2.hK(this.Hcg)})}catch(e){E.ULS.shipAssertTag(575930783,3016,!1,String.format("{0} {1}",e.message,e.stack))}}}Object(F.a)($g,"ConsistencyFixActionsLogger",null,[1171,506]);class zo{constructor(e){this.iL=e;this.Leh=this.vi=!1;this.Jvb=(n,C)=>{C.data.operationType===Vh.a.getTypeName()&&(C.data.annotation?C.data.annotation.annotationType!==
pl.DocumentRoleDetectionAnnotation.getTypeName()?E.ULS.shipAssertTag(544035804,3016,!1):(n=C.data.annotation.content,n)?n.errorCode||(E.ULS.sendTraceTag(575248462,3016,50,"Document confidence: {0}",n.isTarget?1:0),E.ULS.sendTraceTag(544012318,3016,50,"Is well-formatted document: {0}",n.isWellFormatted?1:0),n=[Object.assign(new kh.a,{name:Jf.a.FXl,double:n.isTarget?1:0}),Object.assign(new kh.a,{name:Jf.a.GXl,double:n.isWellFormatted?1:0})],xa.a(Jf.a.EXl,!0,void 0,n),this.Leh=!0,this.Wd()):E.ULS.shipAssertTag(544035805,
3016,!1):E.ULS.shipAssertTag(544035803,3016,!1))}}initialize(){this.vi||this.Leh||(this.iL.QH(this.Jvb),this.vi=!0)}Wd(){this.vi&&(this.iL.hK(this.Jvb),this.vi=!1)}}Object(F.a)(zo,"DocumentRoleDetectionLogger",null,[1170,506]);class Ql{constructor(e=null,n,C){this.gG=e;this.jNg=n;this.$d=C;this.QYd=0}CGn(){0===this.$d.Alg()&&this.gG&&0<this.QYd&&(this.gG.execute(e=>{for(let n=0;n<Math.min(this.QYd,Jf.a.OLn);n++)e.logActivity(Jf.a.zlg,null)}),this.QYd=0)}akd(){0===this.$d.Alg()?this.QYd++:this.gG&&
this.gG.execute(e=>{this.jNg.setTimeout(()=>{e.logActivity(Jf.a.zlg,null);2===this.$d.Alg()&&e.logActivity(Jf.a.zlg,null)},Jf.a.xho)})}}Object(F.a)(Ql,"ProactiveSurveyEventLogger",null,[1169]);var Bq=d(1801),Mi=d(1384),ok=d(2126),en=d(32),Lp=d(116),Fg=d(723),tn=d(1723),Vm=d(128);class Ju extends Mi.a{constructor(e,n,C,S){super();this.Koa=e;this.Wn=n;this.VPe=C;this.nfh=S;this.bpk=[Jf.a.Rjf,Jf.a.Sjf]}get Afa(){return this.Koa.isEnabled()}get Xrb(){return 3}get U9a(){return null!=this.XWg?this.XWg:
this.XWg=[new ok.a(en.a.Qbk,null),new ok.a(en.a.qNg,null)]}wMa(e,n){const C=this.vs.OIa;var S=this.vs.Qad;if(C)if(3===C.type){if(C.VL&&(S=C.VL,this.q2h(S.RTc),1===C.action&&S.gt.includes(e))){e=n.Gh.querySelectorAll("*");for(let ja=0,ya=e.length;ja<ya;ja++)this.nfh(e[ja],en.a.qNg);return}(S=C.$B)&&S.gt.includes(e)&&(S.gt[0]===e&&this.ESo(S.RTc,C.action),this.vyb(n.Gh,C.action,e))}else S&&3===S.type&&3===C.action&&S.$B.gt.includes(e)&&this.vyb(n.Gh,0,e)}oXa(e){return Object(Eh.a)(tn.a,e)}p9a(e,n){(e=
Object(Jg.a)(tn.a,e))&&e.gt.forEach(C=>{n.add(C)})}vyb(e,n,C){if(2===n||!n){e=e.querySelectorAll("*");n=2===n?en.a.Qbk:en.a.qNg;for(let S=0,ja=e.length;S<ja;S++){const ya=e[S];1===Fg.a(ya)&&this.Ipl(C,ya)&&this.VPe(ya,n)}}}Ipl(e,n){var C=this.Wn.u3c(ce.a.create(e),1);if(!C||!C.count)return!0;e=C.K(0).Dc;C=C.K(0).end;const S=Vm.a.Eb(n,Lp.a.zza);n=Vm.a.Eb(n,Lp.a.uvb);return Math.max(e,S)<Math.min(C,n)}ESo(e,n){switch(n){case 4:case 1:case 3:this.q2h(e);break;case 0:this.VPe(e,Jf.a.Sjf);break;case 2:this.VPe(e,
Jf.a.Rjf)}}q2h(e){for(const n of this.bpk)this.nfh(e,n)}}Object(F.a)(Ju,"HighlightActor",Mi.a,[]);var OA=d(1047);class pk{constructor(e,n){this.e1e=this.Urh=this.sQ=null;this.hb=e;this.t$=n}get key(){return"DESIGNER REVIEW"}get Fv(){return WordEditorIntl.WordEditorStrings.L_DesignerReview}reset(e){this.hb.Wb(e.node)?this.sQ=e.node:this.sQ=null}rEa(){let e=null;if(!this.sQ)return{returnValue:!1,JG:e};if(this.Urh!==this.sQ){const n=this.t$.YB(this.sQ);this.e1e=n.$la?n:null;this.Urh=this.sQ}if(!this.e1e)return{returnValue:!1,
JG:e};e=Object.assign(new OA.a,{dG:this.key,contentObject:this.e1e,description:Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress});return{returnValue:!0,JG:e}}}Object(F.a)(pk,"ReviewDetailsProvider",null,[299,300]);class uw{constructor(e,n,C,S,ja,ya,kb,Rb){this.kBa=e;this.vs=n;this.AKa=C;this.ZVh=S;this.uHj=ja;this.Lcf=ya;this.Og=kb;this.Sm=Rb}initialize(){this.vs.Vcb(this.AKa);this.kBa.eNa(this.ZVh);this.uHj.initialize();this.Lcf.execute(e=>{e.dY(new pk(this.Og,this.Sm))})}Wd(){this.vs.DJg(this.AKa);
this.kBa.bEe(this.ZVh);this.uHj.Wd()}}Object(F.a)(uw,"OnCanvasInitializer",null,[506]);class Qt{constructor(e,n,C){this.vi=!1;this.c8=(S,ja)=>{if(ja&&ja.Rm&&ja.Rm.currentSelection&&ja.Rm.currentSelection.Qa&&ja.Rm.currentSelection.Qa.node){S=ja.Rm.currentSelection;var ya=S.Qa.node;1!==ja.az&&ja.az||!Ge.a.ym(S)||!this.CLk.C$c(ya)?this.a$g.Vrl():this.a$g.DVo(ya)}};this.a$g=e;this.ib=n;this.CLk=C}initialize(){this.vi||(this.ib.AB(this.c8),this.vi=!0)}Wd(){}}Object(F.a)(Qt,"ReviewSelectionManager",null,
[506]);var vr=d(100),Tq=d(188),$e=d(321);const ev=e=>0>e.indexOf(",")?Tq.FontUtils.jSc(e,Tq.FontUtils.kza(e)):e,lp=e=>{e=Tq.FontUtils.$5d(e).returnValue;return e.startsWith("'")||e.startsWith('"')?e.slice(1,-1):e},PA=[WordRibbonStrings.DesignerStyleFontAvenirNextDemiBold,WordRibbonStrings.DesignerStyleFontAvenir,WordRibbonStrings.DesignerStyleFontCentury,WordRibbonStrings.DesignerStyleFontSitka,WordRibbonStrings.DesignerStyleFontWalbaum,WordRibbonStrings.DesignerStyleFontRockwellNova,WordRibbonStrings.DesignerStyleFontUnivers,
WordRibbonStrings.DesignerStyleFontSagonaBook,WordRibbonStrings.DesignerStyleFontSagona,WordRibbonStrings.DesignerStyleFontFranklin,WordRibbonStrings.DesignerStyleFontPerpetua,WordRibbonStrings.DesignerStyleFontAmasisMTPro,WordRibbonStrings.DesignerStyleFontSabonNextLT,WordRibbonStrings.DesignerStyleFontTradeGothicNext,WordRibbonStrings.DesignerStyleFontCooperBlack,WordRibbonStrings.DesignerStyleFontNeueHaasGroteskTextPro,WordRibbonStrings.DesignerStyleFontTisaOffcSerifPro,WordRibbonStrings.DesignerStyleFontQuireSans,
WordRibbonStrings.DesignerStyleFontGillSansNova,WordRibbonStrings.DesignerStyleFontTheHand,WordRibbonStrings.DesignerStyleFontGoudyType,WordRibbonStrings.DesignerStyleFontPlantagenetCherokee,WordRibbonStrings.DesignerStyleFontFootlightMTLight,WordRibbonStrings.DesignerStyleFontBaskervilleOldFace,WordRibbonStrings.DesignerStyleFontLucidaCalligraphy,WordRibbonStrings.DesignerStyleFontEbrima,WordRibbonStrings.DesignerStyleFontCorbel,WordRibbonStrings.DesignerStyleFontElephantPro,WordRibbonStrings.DesignerStyleFontDaytona,
WordRibbonStrings.DesignerStyleFontBierstadt,WordRibbonStrings.DesignerStyleFontSitkaBanner,WordRibbonStrings.DesignerStyleFontGrandview,WordRibbonStrings.DesignerStyleFontSkeenaDisplay,WordRibbonStrings.DesignerStyleFontTenorite,WordRibbonStrings.DesignerStyleFontGadugi,WordRibbonStrings.DesignerStyleFontSeaford,WordRibbonStrings.DesignerStyleFontWalbaumDisplay,WordRibbonStrings.DesignerStyleFontAgencyFB,WordRibbonStrings.DesignerStyleFontAharoni,WordRibbonStrings.DesignerStyleFontArial,WordRibbonStrings.DesignerStyleFontArialNova,
WordRibbonStrings.DesignerStyleFontArialNovaBold,WordRibbonStrings.DesignerStyleFontArialNovaCondBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProDemi,WordRibbonStrings.DesignerStyleFontBaguetScript,WordRibbonStrings.DesignerStyleFontBaguetScriptRegular,WordRibbonStrings.DesignerStyleFontBahnschrifr,WordRibbonStrings.DesignerStyleFontBahnschrift,WordRibbonStrings.DesignerStyleFontBierstadtRegular,WordRibbonStrings.DesignerStyleFontBiome,
WordRibbonStrings.DesignerStyleFontBodoniMT,WordRibbonStrings.DesignerStyleFontBritannic,WordRibbonStrings.DesignerStyleFontCalibri,WordRibbonStrings.DesignerStyleFontCalistoMT,WordRibbonStrings.DesignerStyleFontCavolini,WordRibbonStrings.DesignerStyleFontDubai,WordRibbonStrings.DesignerStyleFontElephantProRegular,WordRibbonStrings.DesignerStyleFontErasBoldITC,WordRibbonStrings.DesignerStyleFontGeorgia,WordRibbonStrings.DesignerStyleFontGeorgiaPro,WordRibbonStrings.DesignerStyleFontJumble,WordRibbonStrings.DesignerStyleFontMVBoli,
WordRibbonStrings.DesignerStyleFontNewsGothicMT,WordRibbonStrings.DesignerStyleFontPerpetuaBoldItalic,WordRibbonStrings.DesignerStyleFontPerpetuaItalic,WordRibbonStrings.DesignerStyleFontRastantyCortez,WordRibbonStrings.DesignerStyleFontSegoe,WordRibbonStrings.DesignerStyleFontSegoeScript,WordRibbonStrings.DesignerStyleFontSegoeUI,WordRibbonStrings.DesignerStyleFontSegoeUIBold,WordRibbonStrings.DesignerStyleFontSitkaHeading,WordRibbonStrings.DesignerStyleFontSitkaText,WordRibbonStrings.DesignerStyleFontTenoriteBold,
WordRibbonStrings.DesignerStyleFontTenoriteRegular,WordRibbonStrings.DesignerStyleFontTradeGothic,WordRibbonStrings.DesignerStyleFontTradeGothicInline,WordRibbonStrings.DesignerStyleFontVijaya,WordRibbonStrings.DesignerStyleFontWideLatin,WordRibbonStrings.DesignerStyleFontNordiqueInlineRegular];class Wm{constructor(e,n){this.lr=e;this.title=n}}Object(F.a)(Wm,"TriageOption",null,[]);class Ku extends Wm{constructor(e,n,C,S,ja,ya,kb,Rb,sc){super(e,n);this.fontSize=S;this.color=ja;this.bold=ya;this.italic=
kb;this.underline=Rb;this.backgroundImg=sc;this.font=ev(C)}}Object(F.a)(Ku,"FormattedRangeTriageOption",Wm,[]);class ut extends Ku{constructor(e,n,C,S,ja,ya,kb,Rb,sc){super(0,n,C,S,ja,ya,kb,Rb,sc);this.role=e}}Object(F.a)(ut,"RoleTriageOption",Ku,[]);class fv extends Ku{constructor(e,n,C,S,ja,ya,kb,Rb,sc){super(1,n,C,S,ja,ya,kb,Rb,sc);this.Hcb=e}}Object(F.a)(fv,"PullQuoteTriageOption",Ku,[]);class QA extends Wm{constructor(e,n,C){super(2,void 0);this.imageUrl=e;this.altText=n;this.Jsa=C}}Object(F.a)(QA,
"ImageTriageOption",Wm,[]);class Ez{constructor(e,n,C,S){this.rtc=e;this.g$n=n;this.Yb=C;this.$d=S}rDm(e){if(!e)return E.ULS.shipAssertTag(574424853,3016,!1),this.ZHf(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle);let n=null;return({hWj:n}=this.g$n.oDe(e.id)).returnValue?new ut(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle,this.rtc.getPropertyValue(n,Ee.a.font,vr.a.KJ),Math.min(this.irf(this.rtc.getPropertyValue(n,Ee.a.fontSize,Jf.a.Zuf)),Ez.cMn),Yk.a.JB(this.rtc.getPropertyValue(n,
Ee.a.fontColor,Yk.a.wob.Sfb)),this.rtc.getPropertyValue(n,Ee.a.bold,!1),this.rtc.getPropertyValue(n,Ee.a.italic,!1),this.rtc.getPropertyValue(n,Ee.a.underline,!1),null):(E.ULS.sendTraceTag(512276631,3016,50,"No formatting information for paragraph. Showing Title style in the triage menu."),this.ZHf(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle))}MPm(e,n){const C=this.Yb.ro(),S=C.nh(Xi.j(e));if(!S){if(14===e&&this.$d.Ysa()&&(E.ULS.sendTraceTag(541446534,3018,15,"No Caption style in the document."),
n=this.JPm(C.nh(Xi.j(13)),n),null!=n))return n;E.ULS.shipAssertTag(574424855,3016,!1);return this.ZHf(e)}return new ut(e,S.ka(Ld.a.UYa,Xi.k(e)),S.ka(Ee.a.font,vr.a.KJ),n,Yk.a.JB(S.ka(Ee.a.fontColor,Yk.a.wob.Sfb)),S.ka(Ee.a.bold,!1),S.ka(Ee.a.italic,!1),S.ka(Ee.a.underline,!1),null)}LPm(e,n){let C=vr.a.KJ,S=Yk.a.JB(Yk.a.wob.Sfb),ja=!1,ya="";switch(e){case 0:S="#201f1e";ya="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="175" height="42" rx="2" fill="none"/><line x1="5" y1="4" x2="169" y2="4.00001" stroke="#EA6B14" stroke-width="2"/></svg>');
break;case 1:S="#ffffff";C="Helvetica Neue";ja=!0;ya="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="4" width="160" height="37" fill="#5066DB"/><path d="M151 24V28.3178H152.859C152.859 29.0093 152.727 29.5981 152.464 30.0841C152.202 30.5514 151.713 30.9065 151 31.1495V33C151.582 32.9252 152.117 32.757 152.605 32.4953C153.112 32.215 153.544 31.8692 153.901 31.4579C154.257 31.0467 154.53 30.5701 154.717 30.028C154.924 29.486 155.018 28.9065 154.999 28.2897V24H151ZM156.999 14V28.3178H158.857C158.857 29.0093 158.726 29.5981 158.463 30.0841C158.2 30.5514 157.712 30.9065 156.999 31.1495V33C157.581 32.9252 158.116 32.757 158.604 32.4953C159.111 32.215 159.543 31.8692 159.899 31.4579C160.256 31.0467 160.528 30.5701 160.716 30.028C160.923 29.486 161.016 28.9065 160.998 28.2897V24H156.999Z" fill="white"/><rect x="5.6" y="0.6" width="158.8" height="35.8" stroke="black" stroke-width="1.2"/></svg>');
break;case 2:S="#007fac";C="SF Pro Display";ya="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="3" width="162" height="34" fill="#EAEFF6"/><path d="M162 37H168V3H6V37H87H107.25H147.5" stroke="#007FAC" stroke-width="2"/><path d="M155.998 33V37.3178H157.857C157.857 38.0093 157.726 38.5888 157.463 39.0561C157.2 39.5421 156.712 39.9065 155.998 40.1495V42C156.58 41.9252 157.125 41.7477 157.632 41.4673C158.12 41.2056 158.542 40.8692 158.899 40.4579C159.256 40.0467 159.537 39.5701 159.744 39.028C159.932 38.486 160.016 37.9065 159.997 37.2897V33H155.998ZM150 33V37.3178H151.859C151.859 38.0093 151.727 38.5888 151.464 39.0561C151.202 39.5421 150.713 39.9065 150 40.1495V42C150.582 41.9252 151.126 41.7477 151.633 41.4673C152.122 41.2056 152.544 40.8692 152.901 40.4579C153.257 40.0467 153.539 39.5701 153.746 39.028C153.933 38.486 154.018 37.9065 153.999 37.2897V33H150Z" fill="#007FAC"/></svg>');
break;case 3:S="#3865a8";C="Avenir";ya="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><svg x="0" y="2"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 0C5.89543 0 5 0.895431 5 2V25C5 36.1046 5.89543 37 7 37H83.0061C83.1025 37.2646 83.2556 37.5127 83.4655 37.7252L85.8929 40.1821C86.6692 40.9679 87.9278 40.9679 88.7041 40.1821L91.1314 37.7252C91.3413 37.5127 91.4945 37.2646 91.5909 37H167C168.105 37 169 36.1046 169 35V2C169 0.895431 168.105 0 167 0H7Z" fill="#E9EBF4"/></svg></svg>');
break;case 4:S="#201f1e",ya="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="3" width="2" height="6" fill="#548235"/><rect x="5" y="5" width="2" height="6" transform="rotate(-90 5 5)" fill="#548235"/><rect x="-5" y="29" width="2" height="6" transform="rotate(-90 5 29)" fill="#548235"/><rect x="7" y="19" width="2" height="6" transform="rotate(180 7 29)" fill="#548235"/><rect x="169" y="19" width="2" height="6" transform="rotate(-180 169 29)" fill="#548235"/><rect x="179" y="27" width="2" height="6" transform="rotate(90 169 27)" fill="#548235"/><rect x="169" y="3" width="2" height="6" transform="rotate(90 169 3)" fill="#548235"/><rect x="167" y="3" width="2" height="6" fill="#548235"/></svg>')}return new fv(e,
n,C,this.irf(Jf.a.Zuf),S,ja,!1,!1,ya)}KPm(e,n){return new QA(null===e||void 0===e?void 0:e.ZNf(n),null===e||void 0===e?void 0:e.x_(n),n)}ZHf(e,n=null){return new ut(e,n||Xi.k(e),vr.a.KJ,this.irf(Jf.a.Zuf),Yk.a.JB(Yk.a.wob.Sfb),!1,!1,!1,null)}JPm(e,n){return null==e?null:new ut(14,Xi.k(14),e.ka(Ee.a.font,vr.a.KJ),n,Yk.a.JB(e.ka(Ee.a.fontColor,Yk.a.wob.Sfb)),!1,!0,!1,null)}irf(e){return e/2}}Ez.cMn=25;Object(F.a)(Ez,"TriageOptionFactory",null,[1168]);class Dv{constructor(e,n){this.options=e;this.selectedIndex=
n}}Object(F.a)(Dv,"TriageOptions",null,[]);class Ao{constructor(e,n,C,S){this.Sm=e;this.bDe=n;this.$d=C;this.iK=S}lDm(e){var n;if(!e)return E.ULS.shipAssertTag(574424851,3016,!1),null;const C=null===(n=this.iK.hX(e))||void 0===n?void 0:n.suggestion;n=this.Sm.YB(e);return Object(Sc.e)(C)?this.EHm(C):2===(null===C||void 0===C?void 0:C.lr)?this.owm(C):this.Fpm(e,n)}Fpm(e,n){const C=Ao.NPm(n.role,this.$d.Ysa()),S=Array(C.count-9+Math.max(3,this.Sm.eSf+1)+1);S[Ao.original]=this.bDe.rDm(e);e=Ao.original;
let ja=1;for(let ya=0;ya<C.count;ya++){const kb=C.K(ya);if(this.y4o(kb)){ja--;continue}const Rb=ya+ja;kb.role===n.role&&(e=Rb);S[Rb]=this.bDe.MPm(kb.role,kb.TK)}return new Dv(S,e)}EHm(e){const n=Ao.FHm();let C,S=Ao.original;C=Array(n.count);for(let ja=0;ja<n.count;ja++){const ya=n.K(ja);ya.TK==e.Hcb&&(S=ja);C[ja]=this.bDe.LPm(ya.TK,e.jid)}return new Dv(C,S)}owm(e){let n;n=Array(e.Fyc);for(let C=0;C<e.Fyc;C++)n[C]=this.bDe.KPm(e,C);return new Dv(n,e.selectedIndex)}aKm(e,n){var C;if(!e)return E.ULS.shipAssertTag(572301728,
3016,!1),Ao.original;if(!n)return E.ULS.shipAssertTag(572301729,3016,!1),Ao.original;const S=null===(C=this.iK.hX(n))||void 0===C?void 0:C.suggestion;if(Object(Sc.e)(S))return S.Hcb;if(2===(null===S||void 0===S?void 0:S.lr))return S.selectedIndex;if(0===(null===S||void 0===S?void 0:S.lr))for(n=this.Sm.YB(n),C=0;C<e.length;C++)if(0!==e[C].lr)E.ULS.shipAssertTag(527569926,3016,!1,`${e[C].lr}`);else if(e[C].role===n.role)return C;return Ao.original}y4o(e){return 6<e.role&&12>=e.role&&4+this.Sm.eSf<e.role}static NPm(e,
n=!1){const C=new fb.a;C.add({role:13,TK:12});C.add({role:4,TK:19});C.add({role:5,TK:18});C.add({role:6,TK:17});C.add({role:7,TK:16});C.add({role:8,TK:15});C.add({role:9,TK:14});C.add({role:10,TK:13});C.add({role:11,TK:12});C.add({role:12,TK:12});C.add({role:2,TK:25});C.add({role:3,TK:19});n&&C.insert(Ao.Gml,{role:14,TK:11});15===e&&C.insert(Ao.YAn,{role:15,TK:12});return C}static FHm(){const e=new fb.a;e.add({role:27,TK:0});e.add({role:27,TK:1});e.add({role:27,TK:2});e.add({role:27,TK:3});e.add({role:27,
TK:4});return e}}Ao.original=0;Ao.Gml=1;Ao.YAn=4;Object(F.a)(Ao,"TriageOptionProvider",null,[1165]);class Rt extends bh.a{constructor(e){super("FormattingSuggestionsReadyConditionId");this.iL=e;this.ceg=(n,C)=>{C.data.operationType===Vh.a.getTypeName()&&C.data.annotation&&C.data.annotation.annotationType===Yc.FormattingSuggestionsSummaryAnnotation.getTypeName()&&(n=C.data.annotation.content)&&!n.errorCode&&(this.pi(!0),this.iL.hK(this.ceg))}}initialize(){super.initialize();this.iL.QH(this.ceg)}Wd(){this.iL.hK(this.ceg);
super.Wd()}}Object(F.a)(Rt,"FormattingSuggestionsReadyCondition",bh.a,[]);class RA extends bh.a{constructor(e){super("RoleDetectionReadyCondition");this.iL=e;this.Mfg=(n,C)=>{C.data.operationType===Vh.a.getTypeName()&&C.data.annotation&&C.data.annotation.annotationType===pl.DocumentRoleDetectionAnnotation.getTypeName()&&(n=C.data.annotation.content)&&!n.errorCode&&(this.pi(!0),this.iL.hK(this.Mfg))}}initialize(){super.initialize();this.iL.QH(this.Mfg)}Wd(){this.iL.hK(this.Mfg);super.Wd()}}Object(F.a)(RA,
"RoleDetectionReadyCondition",bh.a,[]);class Dy extends bh.a{constructor(e){super("ThemeGeneratorReadyCondition");this.A4=e;this.lgg=(n,C)=>{C.data.operationType===Vh.a.getTypeName()&&C.data.annotation&&C.data.annotation.annotationType===xl.ThemeGeneratorAnnotation.getTypeName()&&C.data.annotation.content&&(this.pi(!0),this.A4.hK(this.lgg))}}initialize(){super.initialize();this.A4.QH(this.lgg)}Wd(){this.A4.hK(this.lgg);super.Wd()}}Object(F.a)(Dy,"ThemeGeneratorReadyCondition",bh.a,[]);var $w=d(207);
class Fz{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc){this.Zu=e;this.fJa=n;this.w4=C;this.zaa=S;this.focusManager=ja;this.y_j=ya;this.oJg=kb;this.qWc=Rb;this.EXa=sc;this.yho=Fc;this.IEd=this.ey=this.vi=!1;this.dbc=0;this.sko=(gd,td)=>{td?td.data?this.Ysd(td.data):E.ULS.shipAssertTag(556373976,3016,!1):E.ULS.shipAssertTag(556373975,3016,!1)};this.Nog=()=>{this.r_a(!0);this.IEd||this.rca();this.Zu.Ge()};this.Mog=()=>{this.qWc.Khe();this.qWc.Wd();this.yho.CGn();this.r_a(!1);this.kha();this.Zu.Ge();xa.c(ha.a.Stl,
void 0,void 0,void 0,12)}}get isVisible(){return this.ey}get Js(){return this.dbc}r_a(e){e!==this.ey&&(this.ey=e,this.w4.Wno(this.ey))}show(e=0){this.isVisible?this.rca():(this.w4.Uno(),this.initialize(),this.zaa.W3d(),this.IEd=!!e,this.dbc=e,this.lCg())}hide(){this.oJg().then(e=>{e.hideTaskPane(Jf.a.rS,Jf.a.taskPaneLocation);return null})}initialize(){this.vi||(this.fJa.I2k(this.sko),this.g2(),this.xna(),this.vi=!0)}g2(){this.y_j.iUa();this.y_j.Dfc(this.focusManager)}xna(){const e=this.focusManager.ie(Jf.a.rS);
e.parent=$w.AFrame.Gq;e.bindAction(vq.KeyInputManager.Vw(Box4Intl.Box4Strings.l_HK_Undo),pe.a.undo);e.bindAction(vq.KeyInputManager.Vw(Box4Intl.Box4Strings.l_HK_Redo),pe.a.Sga)}rca(){this.focusManager.Gg(Jf.a.rS)}kha(){this.focusManager.Gg($w.AFrame.Do)}lCg(){const e=this.fJa.tla();e.isPaneAutoOpened=this.IEd;e.Js=this.dbc;this.oJg().then(n=>{n.showTaskPane(Jf.a.rS,this.LB(e));return null})}Ysd(e){this.isVisible&&this.oJg().then(n=>{n.updateTaskPane(Jf.a.rS,this.LB(e));return null})}LB(e){return Object.assign(new tp.a,
{title:this.EXa.Hin?WordEditorIntl.WordEditorStrings.L_Designer:String.format("{0} ({1})",WordEditorIntl.WordEditorStrings.L_Designer,WordEditorIntl.WordEditorStrings.L_Preview),hideHeader:!1,width:Jf.a.taskPaneWidth,location:Jf.a.taskPaneLocation,contentProps:e,onOpen:this.Nog,onClose:this.Mog,enableResize:!1,isModernPane:!0,isPaneAutoOpened:this.IEd,Js:this.dbc})}}Object(F.a)(Fz,"DesignerTaskPane",null,[1164]);class Lu{constructor(){this.sa=new eb.a}xcc(e){this.sa.addHandler("OnVisibilityChanged",
e)}VDj(e){this.sa.removeHandler("OnVisibilityChanged",e)}vff(e){this.sa.addHandler("OnLoadingStateChanged",e)}PDj(e){this.sa.removeHandler("OnLoadingStateChanged",e)}mPh(e){this.sa.addHandler("OnBeforeOpen",e)}Wno(e){this.sa.raiseEvent("OnVisibilityChanged",new ki.a(e))}Vno(e){this.sa.raiseEvent("OnLoadingStateChanged",new ki.a(e))}Uno(){this.sa.raiseEvent("OnBeforeOpen",new Sys.EventArgs)}}Object(F.a)(Lu,"DesignerTaskPaneEvents",null,[1166,1167]);class mu{constructor(e,n){this.w4=e;this.conditions=
n;this.eFb=this.isInitialized=!1;this.rYa=()=>{this.p1h()}}initialize(){if(0==this.conditions.count)E.ULS.shipAssertTag(556619356,3016,!1);else if(!this.isInitialized){for(const e of this.conditions)e.initialize(),e.fRd(this.rYa);this.isInitialized=!0;this.p1h()}}Wd(){if(this.isInitialized){for(const e of this.conditions)e.Hte(this.rYa),e.Wd();this.isInitialized=!1}}get woc(){return this.eFb}PQj(e){this.eFb!==e&&(this.eFb=e,this.w4.Vno(this.eFb))}p1h(){for(const e of this.conditions)if(!e.nta){this.PQj(!1);
return}this.PQj(!0)}}Object(F.a)(mu,"PaneLoadingManager",null,[1163]);class Gz{constructor(e,n){this.ji=!1;this.gAk=e;this.Rz=n}dispose(){var e;this.ji||(this.Rz.dispose(),null===(e=this.gAk)||void 0===e?void 0:e.dispose(),this.ji=!0)}}Object(F.a)(Gz,"DesignerTransaction",null,[1188,10]);class zn{constructor(e,n){this.Rc=e;this.t$=n}Lc(e,n,C=!0){e=this.Rc.Lc(e);e.Ph=n;return new Gz(C?this.t$.ZFo():null,e)}}Object(F.a)(zn,"DesignerTransactionFactory",null,[1161]);class Ok{constructor(e,n){this.iQd=
e;this.Ohd=n}trigger(e,n){n?(E.ULS.sendTraceTag(554742742,3016,50,`DesignerProactiveTriggerManager.triggerDesigner - shouldStart=${n.wha}`),n.wha&&this.Ohd.Qif(1,()=>{this.iQd.Qb(ha.a.wOa,2,new Qq.a(n.id))})):E.ULS.shipAssertTag(521172809,3016,!1)}}Object(F.a)(Ok,"OpenDesignerPaneTriggerAction",null,[1162]);class vw{constructor(e,n,C){this.qQd=e;this.kdf=n;this.Js=C}}Object(F.a)(vw,"TeachingCalloutButtonEventAction",null,[]);class oE{constructor(e,n,...C){this.$P=e;this.hGg=n;this.V2j=S=>{for(const ja of this.kYh)(null===
S||void 0===S?void 0:S.type)===ja.qQd&&ja.kdf&&(E.ULS.sendTraceTag(520127499,3016,50,`TeachingCalloutTriggerAction.triggerTeachingActivityEventAction - buttonAction=${ja.kdf}`),xa.a(ja.qQd),ja.kdf.trigger(this,{id:ja.Js,wha:!0}),window.removeEventListener(ja.qQd,this.V2j,!0))};if(C){this.kYh=C;for(const S of this.kYh)window.addEventListener(S.qQd,this.V2j,!0)}}trigger(e,n){n?(E.ULS.sendTraceTag(521172628,3016,50,`TeachingCalloutTriggerAction.trigger - shouldStart=${n.wha}`),n.wha&&this.$P&&this.hGg&&
(xa.a(this.hGg),this.$P.execute(C=>{C.logActivity(this.hGg,null)}))):E.ULS.shipAssertTag(521172808,3016,!1)}}Object(F.a)(oE,"TeachingCalloutTriggerAction",null,[1162]);class Am extends Nn.a{constructor(e,n,C,S){super(e,n,C,3016,"OnTriggerImageSuggestionEventKey");this.uGj=S}mRb(e){super.mRb(e);super.Ggf()&&super.nRb(this.uGj)}nRb(e){super.nRb(e);this.BDa(!1);super.nRb(this.uGj)}BDa(e=!0){var n;super.BDa(e&&!(null===(n=this.bqa)||void 0===n?0:n.Dca()))}}Object(F.a)(Am,"AutoResetSequentialTriggerModel",
Nn.a,[]);class jq extends bh.a{constructor(e){super(Jf.a.UZd);this.LM=e}initialize(){super.initialize();this.DRh=this.LM.Sk(19,()=>{this.pi(!0)})}Wd(){this.DRh&&this.DRh.Una(!0);this.mEa&&G.AFrameworkApplication.pc.wf(this.mEa);super.Wd()}}Object(F.a)(jq,"DesignerAfterApplicationBootCondition",bh.a,[]);class go extends bh.a{constructor(e){super(Jf.a.XRl);this.Gdi=e}initialize(){super.initialize();0<=this.Gdi&&(this.mEa=new zg.a(2,1,1E3*this.Gdi,()=>{this.pi(!0)}),G.AFrameworkApplication.pc.$b(this.mEa))}Wd(){this.mEa&&
G.AFrameworkApplication.pc.wf(this.mEa);super.Wd()}}Object(F.a)(go,"DesignerDelayCondition",bh.a,[]);class nj extends ul{constructor(e,n,C){super(Jf.a.bSl);this.ho=e;this.epi=n;this.Vei=C;this.F3=()=>{this.ho.c2()&&(this.pi(this.ho.Q8c(this.epi)===this.Vei),this.ho.lZb(this.F3))}}initialize(){super.initialize();this.ho.c2()?this.pi(this.ho.Q8c(this.epi)===this.Vei):this.ho.vcc(this.F3)}Wd(){this.ho.lZb(this.F3);super.Wd()}}Object(F.a)(nj,"DesignerFlagsSettingCondition",ul,[]);var ns=d(992);class $s extends bh.a{constructor(){super(Jf.a.VUl)}initialize(){super.initialize();
Object(ns.a)().then(e=>{this.pi(!e)}).catch(()=>{this.pi(!0)})}}Object(F.a)($s,"DisabledCopilotCondition",bh.a,[]);var Hz=d(1597);class Nr extends Sys.EventArgs{constructor(e){super();this.documentType=e}}Object(F.a)(Nr,"DocumentTypeObtainedEventArgs",Sys.EventArgs,[]);class lG{constructor(){this.jd=new eb.a}o1k(e){this.jd.addHandler("DocumentTypeObtainedEventId",e)}hCo(e){this.jd.removeHandler("DocumentTypeObtainedEventId",e)}uno(e){this.jd.raiseEvent("DocumentTypeObtainedEventId",e)}}Object(F.a)(lG,
"DocumentTypeEventSource",null,[]);class ax extends ul{constructor(e,n,C,S,ja,ya=null){super(Jf.a.qhi);this.Js=e;this.vaa=n;this.Q_d=C;this.fLp=S;this.Vip=ja;this.i2f=null;this.Z$c=this.isInitialized=!1;this.Ovb=(kb,Rb)=>{if(Rb.data.operationType===Vh.a.getTypeName()||Rb.data.operationType===xd.o.getTypeName())Rb.data.annotation?Rb.data.annotation.annotationType!==vh.DocumentTypeClassifierAnnotation.getTypeName()?E.ULS.shipAssertTag(573907533,3016,!1):(kb=Rb.data.annotation.content)?kb.documentTypeConfidences.length?
(this.i2f=this.Xp(),kb=kb.documentTypeConfidences[0].documentTypeLabel,this.Z$c=Array.contains(this.Vip,kb),this.Q_d.uno(new Nr(kb)),this.Z$c&&!this.nta&&E.ULS.sendTraceTag(561309448,3016,50,this.F6(this.Js,!0)),this.pi(this.Z$c)):E.ULS.shipAssertTag(573907535,3016,!1):E.ULS.shipAssertTag(573907534,3016,!1):E.ULS.shipAssertTag(573907532,3016,!1)};this.Xp=ya?ya:()=>new Date}get v3o(){return!this.i2f||+this.Xp()-+this.i2f>this.fLp}initialize(){super.initialize();this.isInitialized||(this.vaa.QH(this.Ovb),
this.vaa.register(),this.isInitialized=!0);this.v3o?(this.vaa.Rza(new Hz.a),E.ULS.sendTraceTag(509874258,3016,50,"DocumentTypeClassifierSignal emitted by the DocumentTypeCondition.")):(this.Z$c&&E.ULS.sendTraceTag(561109203,3016,50,this.F6(this.Js,!0)),this.pi(this.Z$c))}Wd(){this.isInitialized&&(this.vaa.hK(this.Ovb),this.isInitialized=!1);super.Wd()}}Object(F.a)(ax,"DocumentTypeCondition",ul,[]);var Ey;(function(e){e.kjk="E_Spelling_Grammar";e.yik="E_Refinements";e.AutoCorrect="E_AutoCorrect";e.Vjk=
"E_TextPrediction";e.yCc="E_Similarity"})(Ey||(Ey={}));Object(F.b)("EditorAcceptSignalType",Ey);class Bm{}Bm.F0h="CharacterTyped";Bm.erj="ParagraphAdded";Bm.lrj="ParagraphDeleted";Bm.A3d="FontFormattingChangesCount";Bm.wordCount="WordCount";Bm.YU="ParagraphCount";Bm.Btf="Spelling;Grammar;Acronyms;Clarity;Conciseness;Formality;Inclusiveness;Perspectives;Punctuation Conventions;Sensitive Geopolitical References;Vocabulary;Uncommon Words".split(";");Bm.dhc=[Ey.AutoCorrect,Ey.yik,Ey.yCc,Ey.kjk,Ey.Vjk];
Object(F.a)(Bm,"SignalIds",null,[]);class St extends bh.a{constructor(e,n,C,S,ja=null){super(Jf.a.odm);this.Js=e;this.$yb=n;this.sEf=C;this.wdd=S;this.jsc=(ya,kb)=>{ya=this.$yb.Twi();kb.qC===Bm.A3d&&(kb=ya.values[Bm.A3d],ya=(kb-1)%this.wdd,this.rEf[ya]=this.Xp(),kb<this.wdd||+this.rEf[ya]-+this.rEf[kb%this.wdd]>this.sEf||(E.ULS.sendTraceTag(561309447,3016,50,this.F6(this.Js,!0)),this.$yb.Irg(this.jsc),this.pi(!0)))};this.Xp=ja?ja:()=>new Date;this.rEf=Array(S)}initialize(){super.initialize();this.$yb.wPh(this.jsc)}Wd(){this.$yb.Irg(this.jsc);
super.Wd()}}Object(F.a)(St,"FormattingActionsCondition",bh.a,[]);class gJ extends bh.a{constructor(e,n,C){super(Jf.a.qdm);this.Js=e;this.Pb=n;this.$d=C;this.yaa=new Set;this.m5a=0;this.JWd=1}initialize(){super.initialize();this.eUf();this.Pb.fY(this)}Wd(){this.Pb.d2b(this);super.Wd()}E3(){}C3(e){2===e.behavior&&this.yaa.has(e.actionId)&&(this.m5a+=1,this.m5a===this.JWd&&(E.ULS.sendTraceTag(523351776,3016,50,this.F6(this.Js,!0)),this.pi(!0)))}eUf(){switch(this.$d.R_d()){case 2:this.yaa.add(pe.a.font);
this.JWd=1;break;case 3:this.yaa.add(pe.a.zT);this.JWd=1;break;case 4:this.yaa.add(pe.a.font),this.yaa.add(pe.a.pC),this.yaa.add(pe.a.S2),this.yaa.add(pe.a.l4),this.yaa.add(pe.a.fE),this.yaa.add(pe.a.bold),this.yaa.add(pe.a.fA),this.yaa.add(pe.a.underline),this.yaa.add(pe.a.strikethrough),this.yaa.add(pe.a.rY),this.yaa.add(pe.a.sca),this.yaa.add(pe.a.hx),this.yaa.add(pe.a.eva),this.JWd=3}}}Object(F.a)(gJ,"FormattingChangeCondition",bh.a,[119]);class Gl extends ul{constructor(e,n,C){super(Jf.a.Mqi);
this.Js=e;this.F2=n;this.j8f=C;this.isInitialized=!1;this.Pvb=(S,ja)=>{ja.data.operationType===Vh.a.getTypeName()&&(ja.data.annotation?ja.data.annotation.annotationType!==Yc.FormattingSuggestionsSummaryAnnotation.getTypeName()?(E.ULS.shipAssertTag(574912652,3016,!1),this.pi(!1)):(S=ja.data.annotation.content)?S.errorCode?this.pi(!1):((S=S.numberOfSuggestions>=this.j8f)&&!this.nta&&E.ULS.sendTraceTag(561309445,3016,50,this.F6(this.Js,!0)),this.pi(S)):(E.ULS.shipAssertTag(574912653,3016,!1),this.pi(!1)):
(E.ULS.shipAssertTag(574912651,3016,!1),this.pi(!1)))}}initialize(){super.initialize();this.isInitialized||(this.F2.QH(this.Pvb),this.F2.register(),this.isInitialized=!0)}Wd(){this.isInitialized&&(this.F2.unregister(),this.F2.hK(this.Pvb),this.isInitialized=!1);super.Wd()}}Object(F.a)(Gl,"FormattingSuggestionsCondition",ul,[]);class hJ extends bh.a{constructor(e,n,C){super(Jf.a.X9n);this.Js=e;this.$yb=n;this.k8f=C;this.jsc=(S,ja)=>{S=this.$yb.Twi();ja.qC===Bm.YU&&((ja=S.values[Bm.YU]>=this.k8f)&&
!this.nta&&E.ULS.sendTraceTag(561309446,3016,50,this.F6(this.Js,!0)),this.pi(ja))}}initialize(){super.initialize();this.$yb.wPh(this.jsc)}Wd(){this.$yb.Irg(this.jsc);super.Wd()}}Object(F.a)(hJ,"ParagraphCountCondition",bh.a,[]);class fh extends ul{constructor(e,n,C){super(Jf.a.$Hj);this.Js=e;this.iL=n;this.oOn=C;this.nhi=this.ghi=this.isInitialized=!1;this.Jvb=(S,ja)=>{ja.data.operationType===Vh.a.getTypeName()&&(ja.data.annotation?ja.data.annotation.annotationType!==pl.DocumentRoleDetectionAnnotation.getTypeName()?
(E.ULS.shipAssertTag(555812322,3016,!1),this.pi(!1)):(ja=ja.data.annotation.content)?ja.errorCode?this.pi(!1):((S=ja.isTarget)&&!this.ghi&&E.ULS.sendTraceTag(561309451,3016,50,this.F6(this.Js,!0,"subCondition=DocumentConfidenceCondition")),this.ghi=S,(ja=ja.supportedLanguagesCoverage>this.oOn)&&!this.nhi&&E.ULS.sendTraceTag(555812353,3016,50,this.F6(this.Js,!0,"subCondition=DocumentLanguageCondition")),this.nhi=ja,(S=S&&ja)&&!this.nta&&E.ULS.sendTraceTag(555812354,3016,50,this.F6(this.Js,!0)),this.pi(S)):
(E.ULS.shipAssertTag(555812323,3016,!1),this.pi(!1)):(E.ULS.shipAssertTag(555812321,3016,!1),this.pi(!1)))}}initialize(){super.initialize();this.isInitialized||(this.iL.QH(this.Jvb),this.iL.register(),this.isInitialized=!0)}Wd(){this.isInitialized&&(this.iL.unregister(),this.iL.hK(this.Jvb),this.isInitialized=!1);super.Wd()}}Object(F.a)(fh,"RoleDetectionCondition",ul,[]);class zv extends ul{constructor(e,n,C){super(Jf.a.u0j);this.Js=e;this.A4=n;this.kCe=C;this.vi=!1;this.Kne=()=>{E.ULS.sendTraceTag(541385729,
3016,50,this.F6(this.Js,!0));this.pi(!0)}}initialize(){super.initialize();this.vi||(this.A4.register(),this.kCe.qRd(this.Kne),this.kCe.initialize(),this.vi=!0)}Wd(){this.vi&&(this.kCe.UDj(this.Kne),this.kCe.Wd(),this.A4.unregister(),this.vi=!1);super.Wd()}}Object(F.a)(zv,"ThemesLoadedCondition",ul,[]);class zy{constructor(e,n,C){this.Tna=e;this.Qgp=n;this.cDe=C;this.vi=!1;this.F2j=(S,ja)=>{this.cDe&&this.cDe.trigger(S,ja);this.Wd()}}initialize(){E.ULS.sendTraceTag(554742740,3016,50,`DesignerProactiveTriggerManager.initialize - isInitialized=${this.vi}`);
if(!this.vi){this.Qgp.initialize();for(const e of this.Tna)e.vqa(this.F2j),e.initialize();this.vi=!0}}Wd(){E.ULS.sendTraceTag(554742741,3016,50,`DesignerProactiveTriggerManager.deinitialize - isInitialized=${this.vi}`);if(this.vi){for(const e of this.Tna)e.Wd(),e.rDa(this.F2j);this.vi=!1}}}Object(F.a)(zy,"DesignerProactiveTriggerManager",null,[1113,506]);class ww extends Nn.a{constructor(e,n,C,S=null,ja=null){super(e,n,C,3016,"OnTriggerDesigner");this.Kbo=ja;this.PIk=S}mRb(e){var n;super.mRb(e);null===
(n=this.Kbo)||void 0===n?void 0:n.mRb(e)}nRb(e){Array.contains(ww.kOk,e)?(E.ULS.sendTraceTag(546137305,3016,50,`DesignerSequentialTriggerModel.handleConditionUnsatisfied - conditionId=${e}`),this.BDa(!1)):super.nRb(e)}BDa(e=!0){var n,C;super.BDa(e&&!(null===(n=this.bqa)||void 0===n?0:n.Dca())&&!(null===(C=this.PIk)||void 0===C?0:C.Dca()))}}ww.kOk=[Jf.a.$Hj,Jf.a.qhi,Jf.a.Mqi,Jf.a.Igj,Jf.a.mhi,Jf.a.f0j,Jf.a.u0j];Object(F.a)(ww,"DesignerSequentialTriggerModel",Nn.a,[]);class Iz{constructor(e,n,C){this.Pdj=
e;this.eep=n;this.Tep=C}mRb(e){e===this.eep&&(this.startTime=wb.a.Je());e===this.Tep&&this.startTime&&(e=wb.a.Je()-this.startTime,E.ULS.sendTraceTag(512492310,3016,50,`${this.Pdj} { elapsedTime: ${e} ms }`))}}Object(F.a)(Iz,"DesignerTriggerModelPerformanceMeter",null,[]);class SA{constructor(e,n,C){this.ptk=e;this.Dgh=n;this.Vvk=C}initialize(){}Dca(){return this.Vvk?this.ptk.isVisible?(E.ULS.sendTraceTag(555771225,3016,50,"Auto launch suppressed: pane already visible"),!0):this.Dgh.W3d()?(E.ULS.sendTraceTag(555771226,
3016,50,"Auto launch suppressed: errorState {0}",this.Dgh.eNb),!0):!1:(E.ULS.sendTraceTag(508952729,3016,50,"Auto launch suppressed: flight is disabled"),!0)}v0(){}}Object(F.a)(SA,"HeuristicSuppressionModel",null,[971]);class TA{constructor(e){this.ozh=e;this.initialize()}initialize(){this.OXe=void 0;this.ozh.Gsn(sj.a.Pei).then(e=>{this.OXe=e})}Dca(){if(void 0===this.OXe)return E.ULS.sendTraceTag(521199813,3016,50,"Auto launch suppressed: No results from intelligence"),!0;if(this.OXe)return E.ULS.sendTraceTag(521199812,
3016,50,"Auto launch suppressed: pane was already opened for this document"),!0;this.ozh.Xbo(sj.a.Pei);return!1}v0(){}}Object(F.a)(TA,"PersistenceSuppressionModel",null,[971]);class Gs{constructor(e){this.Blg=e}initialize(){E.ULS.sendTraceTag(554742739,3016,50,"ProactiveTriggerDeinitializer.initialize");this.Blg.Wd()}Wd(){}}Object(F.a)(Gs,"ProactiveTriggerDeinitializer",null,[506]);class Ev{constructor(e,n,C){this.w$j=e;this.Ohd=n;this.Blg=C}initialize(){E.ULS.sendTraceTag(554742738,3016,50,"ProactiveTriggerInitializer.initialize");
this.w$j.initialize();this.Ohd.CAj(this.w$j);this.Blg.initialize()}Wd(){}}Object(F.a)(Ev,"ProactiveTriggerInitializer",null,[506]);var Fv=d(617);class Gv{constructor(e,n,C=null){this.hQa=new Fv.a;this.g8e=!1;this.GDb=this.JGb=null;this.$jj=(S,ja)=>{ja.data?(this.JGb=this.gF(),this.g8e=!1):(this.JGb=this.GDb=null,this.ZZc())};this.ga=e;this.yzd=n;this.gF=C?C:()=>new Date}initialize(){this.yzd.xcc(this.$jj);this.ga.fY(this);this.eUf()}Wd(){this.yzd.VDj(this.$jj);this.ga.d2b(this)}get id(){return 1}get Vsc(){return this.JGb}get l_c(){return this.GDb}E3(){}C3(e){2===
e.behavior&&this.hQa.contains(e.actionId)&&(this.GDb=this.gF(),this.ZZc())}ZZc(){this.g8e||(this.g8e=!0)}eUf(){this.hQa.add(pe.a.H5a);this.hQa.add(ha.a.i3d);this.hQa.add(ha.a.Svf);this.hQa.add(pe.a.Nlb);this.hQa.add(ha.a.fkd);this.hQa.add(ha.a.WPd);this.hQa.add(ha.a.kte);this.hQa.add(ha.a.bnb);this.hQa.add(ha.a.MOa)}}Object(F.a)(Gv,"UserEngagementMonitor",null,[119,1160,506,981]);class Fy extends bh.a{constructor(e){super("DocumentOwnerConditionId");this.Js=e}initialize(){super.initialize();const e=
G.AFrameworkApplication.J.$("IsDocumentOwner");E.ULS.sendTraceTag(521430743,3016,50,this.F6(this.Js,e,e&&!this.nta?"The owner of the document has changed":""));this.pi(e)}Wd(){super.Wd()}}Object(F.a)(Fy,"DocumentOwnerCondition",bh.a,[]);class UA extends bh.a{constructor(e,n){super("ProactiveV2AllowedBySettingsConditionId");this.ho=e;this.Js=n;this.F3=()=>{if(this.ho.c2()){var C=this.ho.Hqa()&&this.ho.w0i();E.ULS.sendTraceTag(521446609,3016,50,this.F6(this.Js,C));this.pi(C)}else E.ULS.shipAssertTag(521446610,
3016,!1)}}initialize(){super.initialize();this.ho.c2()?this.pi(this.ho.Hqa()&&this.ho.w0i()):this.ho.vcc(this.F3)}Wd(){this.ho.lZb(this.F3);super.Wd()}}Object(F.a)(UA,"ProactiveV2AllowedBySettingsCondition",bh.a,[]);class Ox{constructor(e,n,C,S,ja,ya){this.$d=e;this.F2=n;this.iQd=C;this.Ohd=S;this.zaa=ja;this.$Rl=ya;this.isInitialized=!1;this.Qvb=(kb,Rb)=>{Rb.data.operationType===Vh.a.getTypeName()&&(Rb.data.annotation?Rb.data.annotation.annotationType!==Yc.FormattingSuggestionsSummaryAnnotation.getTypeName()?
E.ULS.shipAssertTag(521446622,3016,!1):(kb=Rb.data.annotation.content)?this.zaa.W3d()?(E.ULS.sendTraceTag(521446620,3016,50,`Auto launch suppressed by errorState ${this.zaa.eNb}`),this.Wd()):(E.ULS.sendTraceTag(521446619,3016,50,"Other conditions for the opening of the panel have been satisfied, check numberOfSuggestions = {0}",kb.numberOfSuggestions),!kb.errorCode&&kb.numberOfSuggestions>=this.$d.Aho()?(this.Ohd.Qif(1,()=>{this.iQd.Qb(ha.a.wOa,2,new Qq.a(11))}),E.ULS.sendTraceTag(521446618,3016,
50,"All conditions have been met. Open Designer")):this.Wd()):E.ULS.shipAssertTag(521446621,3016,!1):E.ULS.shipAssertTag(521446623,3016,!1))}}initialize(){this.isInitialized||(this.zaa.W3d()?E.ULS.sendTraceTag(521446626,3016,50,`ProactiveSuggestionsChecker - initialize supressed by errorState ${this.zaa.eNb}`):(E.ULS.sendTraceTag(521446625,3016,50,"ProactiveSuggestionsChecker - initialize"),this.F2.QH(this.Qvb),this.F2.register(),this.$Rl.initialize(),this.isInitialized=!0))}Wd(){this.isInitialized&&
(E.ULS.sendTraceTag(521446624,3016,50,"ProactiveSuggestionsChecker - deinitialize"),this.F2.unregister(),this.F2.hK(this.Qvb),this.isInitialized=!1)}}Object(F.a)(Ox,"ProactiveSuggestionsChecker",null,[506]);class mG{constructor(e,n,C,S,ja){this.Tna=e;this.bZj=n;this.Pb=S;this.ho=ja;this.isInitialized=this.vwf=this.VMg=this.Wak=!1;this.pXj=(ya,kb)=>{E.ULS.sendTraceTag(521446614,3016,50,"ProactiveTriggerManagerV2 startNewChecker");kb.wha?this.bZj.initialize():this.UXj()};this.lfg=(ya,kb)=>{kb.data?
(E.ULS.sendTraceTag(521446613,3016,50,"Stop on pane opened"),this.Wd()):this.Wak&&(E.ULS.sendTraceTag(521446612,3016,50,"Restart due to AcceptAll from pane"),this.initialize())};C.xcc(this.lfg);this.Pb.fY(this)}initialize(){if(!this.isInitialized){this.isInitialized=!0;E.ULS.sendTraceTag(521446617,3016,50,"ProactiveTriggerManagerV2 init");for(const e of this.Tna)e.vqa(this.pXj),e.initialize()}}Wd(){if(this.isInitialized){this.isInitialized=!1;E.ULS.sendTraceTag(521446616,3016,50,"ProactiveTriggerManagerV2 deinit");
this.UXj();for(const e of this.Tna)e.Wd(),e.rDa(this.pXj)}}UXj(){E.ULS.sendTraceTag(521446615,3016,50,"ProactiveTriggerManagerV2 stopActiveChecker");this.bZj.Wd()}E3(){}C3(e){if(2===e.behavior)switch(e.actionId){case pe.a.Nlb:this.VMg=this.Wak=!0;this.vwf&&this.ho.mji();break;case ha.a.wOa:e=e.rd;!this.VMg&&e&&11===e.id&&(this.ho.GUl(),this.vwf=!0);break;case pe.a.H5a:case ha.a.WPd:this.VMg=!0,this.vwf&&this.ho.mji()}}}Object(F.a)(mG,"ProactiveTriggerManagerV2",null,[1113,119]);var Or=d(47),yC=d(133);
class Jz{constructor(e,n,C,S,ja=null){this.paragraphFormat=e;this.c0j=n;this.textLength=C;this.qoe=S;this.Oak=ja}}Object(F.a)(Jz,"ParagraphFormattingFullSnapshot",null,[]);class VA{constructor(e,n,C){this.vu=e;this.cpEnd=n;this.mo=C}}Object(F.a)(VA,"TextRunFormattingFullSnapshot",null,[]);class nG{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd){this.Rd=e;this.K9=n;this.Ee=C;this.xv=S;this.KId=ja;this.EZ=ya;this.cTe=kb;this.iNd=Rb;this.xe=sc;this.lg=gd}cwc(e,n=!0){var C;if(e){this.Rd.hMa(e);var S=new fb.a;
for(var ja=0;ja<e.ra.length-1;ja++){var ya=e.ra.Ub(ja);ya.formatting&&ya.formatting.mo&&S.add(new VA(ya.cp,e.ra.Ub(ja+1).cp,ya.formatting.mo.clone()))}ya=e.ra.Ub(e.ra.length-1);ya.formatting&&ya.formatting.mo&&S.add(new VA(ya.cp,ya.cp,ya.formatting.mo.clone()));ja=ya=null;n&&({uva:ya}=this.iNd.oDe(this.xe.GQb(e)),ja=null===(C=this.xe.Cq(e))||void 0===C?void 0:C.id);this.KId.put(e.id,new Jz(e.LA(),S,Af.ParagraphReader.textLength(e),ya,ja))}else E.ULS.shipAssertTag(556410145,3016,!1)}TZa(e,n=!0){if(e){var C=
null;if(({hWj:C}=this.KId.oDe(e.id)).returnValue){const ja=e.J6();try{this.xv.vVd(e);if(C.paragraphFormat&&C.Oak&&e.iQ&&e.iQ.id===C.Oak)for(var S of e.properties.Zj())C.paragraphFormat.hasProperty(S)||e.iQ.hasProperty(S)&&e.properties.Vf(S);this.xv.eTh(e,C.paragraphFormat);this.K9.P0();let ya=S=null;({Fga:S,b0j:ya}=this.uEm(C));this.bYo(e,S,C);for(const kb of C.c0j)this.I_o(kb,ya,C),this.K9k(kb,e);this.Rd.hMa(e);e.Vm();n&&this.KId.remove(e.id)}finally{ja&&ja.dispose()}}}else E.ULS.shipAssertTag(556410146,
3016,!1)}svf(e){e?this.KId.remove(e.id):E.ULS.shipAssertTag(556410147,3016,!1)}K9k(e,n){var C=n.ra.Ub(n.ra.length-1);if(C.cp===e.vu&&e.vu===e.cpEnd)this.Tpp(C,e,n);else for(C=0;C<n.ra.length-1;C++){const S=n.ra.Ub(C),ja=n.ra.Ub(C+1);if(S.cp>=e.vu&&S.cp<e.cpEnd){let ya=!1;ja.cp<=e.cpEnd?ya=!0:E.ULS.sendTraceTag(540652370,3016,15,"applyTextRunFormattingOnParagraph: textRunFormatting.cpEnd < next.cp");ya&&S.formatting&&(this.Ee.Wqa(S.formatting),this.Ee.qha(S.formatting,e.mo))}}}Tpp(e,n,C){var S;C=uj.ListItemReader.De?
C:this.lg.mfa(C);let ja=null;if(uj.ListItemReader.isListItem(C)&&n.mo&&(ja=n.mo.Zj())&&(this.Ee.Wqa(e.formatting),this.Ee.qha(e.formatting,n.mo),null===(S=Or.a.getInstance())||void 0===S||!S.du))for(const ya of ja)C.setValue(ya,n.mo.zf(ya))}uEm(e){const n=new fb.a,C=new fb.a;let S=null;if(!e.qoe||!(S=e.qoe.Zj()))return{Fga:n,b0j:C};for(e=0;e<S.length;e++){const ja=S[e];Nj.a.any(yC.a.iKi(),ya=>ya===ja)?n.add(ja):C.add(ja)}return{Fga:n,b0j:C}}bYo(e,n,C){this.EZ.AW(this.cTe(e,0,Af.ParagraphReader.textLength(e)),
S=>{for(const ja of n)this.Ee.Cl(S,ja,C.qoe.zf(ja))})}I_o(e,n,C){for(const S of n)e.mo.hasProperty(S)||e.mo.setValue(S,C.qoe.zf(S))}}Object(F.a)(nG,"RestoreManager",null,[1159]);class Mu{constructor(e,n,C){this.hDb=e;this.Uda=n;this.WPa=C}accept(e,n=!1){return e?Mu.Nsb(()=>{this.Uda.gnf(e,2,n)}):(E.ULS.shipAssertTag(590434823,3016,!1),!1)}acceptAll(){const e=this.hDb.Lc(15,pe.a.Nlb);try{return e.Rz.Ab(this.WPa.vd),Mu.Nsb(()=>{this.Uda.XRf(!1,0)})}finally{e&&e.dispose()}}reject(e,n=!1){if(!e)return E.ULS.shipAssertTag(590434824,
3016,!1),!1;const C=this.hDb.Lc(15,ha.a.kte);try{return C.Rz.Ab(e),Mu.Nsb(()=>{this.Uda.gnf(e,3,n)})}finally{C&&C.dispose()}}rejectAll(){const e=this.hDb.Lc(15,ha.a.fkd);try{return e.Rz.Ab(this.WPa.vd),Mu.Nsb(()=>{this.Uda.XRf(!0)})}finally{e&&e.dispose()}}BMg(e){if(!e)return E.ULS.shipAssertTag(529106274,3016,!1),!1;const n=this.hDb.Lc(15,ha.a.Xvf);try{return n.Rz.Ab(e),Mu.Nsb(()=>{this.Uda.gnf(e,.1,!1)})}finally{n&&n.dispose()}}Lpd(){const e=this.hDb.Lc(15,ha.a.Vvf);try{return e.Rz.Ab(this.WPa.vd),
Mu.Nsb(()=>{this.Uda.XRf(!0);this.Uda.Lpd()})}finally{e&&e.dispose()}return!1}bnb(e){if(null===e||void 0===e||!e.paragraphNode)return E.ULS.shipAssertTag(575484486,3016,!1),!1;const n=this.hDb.Lc(15,ha.a.bnb);try{return n.Rz.Ab(e.paragraphNode),Mu.Nsb(()=>{1===e.lr&&n.Rz.QLa(e.h_,1);this.Uda.Onl(e)})}finally{n&&n.dispose()}}MOa(e){if(!e)return E.ULS.shipAssertTag(573850376,3016,!1),!1;const n=this.hDb.Lc(15,ha.a.MOa);try{return n.Rz.Ab(e),Mu.Nsb(()=>{this.Uda.MOa(e)})}finally{n&&n.dispose()}}static Nsb(e){try{return e(),
!0}catch(n){return E.ULS.shipAssertTag(572068186,3016,!1,String.format("{0} {1}",n.message,n.stack)),!1}}}Object(F.a)(Mu,"ReviewActions",null,[1157]);var iJ=d(1573),Px=d(1712),pE=d(1720),xw=d(1603);class Kz{constructor(e,n,C,S,ja,ya){this.q9e=e;this._state=n;this.gGc=C;this.Izk=S;this.Pnk=ja;this.Xmk=ya;this.q9e.MXa(this._state)}get suggestion(){return this.q9e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this.suggestion.MXa(this._state))}get description(){return this.gGc}get vsb(){return this.Izk}get HKb(){return this.Pnk}get z2o(){return 0==
this.q9e.lr}get PQ(){var e;return null!==(e=this.Xmk)&&void 0!==e?e:[]}}Object(F.a)(Kz,"ReviewIntent",null,[]);class Gy{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf=null,Gg,Ph,Aj,Ih,Nm,Sk){this.Pb=e;this.RL=n;this.w4=C;this.Mfa=S;this.eIn=ja;this.dK=ya;this.Og=kb;this.a4=Rb;this.Jvc=sc;this.zD=Fc;this.iK=gd;this.Sm=td;this.Sqe=Bd;this.FA=wd;this.Yba=te;this.fR=Le;this.yhc=Oe;this.Zyl=We;this.gG=Xf;this.$d=Gg;this.lTf=Ph;this.ho=Aj;this.iua=Ih;this.Pd=Nm;this.Qc=Sk;this.Lld=null;
this.f0=!1;this.kBj=new Map;this.l3n=(hk,al)=>{this.Nec(al.data.paragraphNode,5)};this.t3n=(hk,al)=>{this.Lld?this.Lld(al.data):this.f0&&E.ULS.shipAssertTag(590434837,3016,!1)};this.F3=()=>{this.ho.Hqa()||this.f0||this.NTi()};this.L4n=(hk,al)=>{(this.f0=al.data)&&this.NTi();!al.data&&0<this.Sm.NZb&&this.Pb.Qb(pe.a.Nlb,2,new xw.a(1))};this.Kfg=(hk,al)=>{if(hk=this.iK.hX(al.data.paragraphNode))if(al.data.paragraphNode.lqe=al.data.isVisible){if(0==hk.state||.1==hk.state)hk.z2o?this.x8k(al.data.paragraphNode,
hk):hk.HKb(),E.ULS.sendTraceTag(540676563,3016,50,"Role: {0};",hk.vsb);this.LUd(al.data.paragraphNode,1);this.Lld&&this.Lld(this.Sm.NZb)}else.1===hk.state?this.zD.uog(new Px.a(al.data.paragraphNode,hk.vsb)):1<hk.state&&this.Nec(al.data.paragraphNode,hk.state)};this.AWn=(hk,al)=>{(hk=this.iK.hX(al.data.currentNode))&&1<hk.state&&this.Nec(al.data.currentNode,hk.state)};this.Sm.c2k(this.t3n);this.zD.Z1k(this.l3n);this.zD.xff(this.Kfg);this.zD.b1k(this.AWn);this.w4.xcc(this.L4n);this.ho.vcc(this.F3)}$Yo(e){this.Lld=
e}Uye(e){let n=0;if(!e.SXa)return E.ULS.sendTraceTag(521412957,3016,50,"Paragraph node not available."),n;if(!e.sSd)return E.ULS.shipAssertTag(545117584,3016,!1),n;const C=this.Sm.YB(e.SXa);if(!this.ho.Hqa())return E.ULS.sendTraceTag(537260062,3016,50,`type: ${e.annotationType} role: ${C.role}`),1;if(0==e.suggestion.lr&&this.Sm.PZi(e.SXa,C))return E.ULS.sendTraceTag(529105475,3016,50,`type: ${e.annotationType} role: ${C.role}`),1;this.Yba.lWf(e.SXa,e.Qmc,e.$7c-e.Qmc,e.annotationType,S=>{S||(n=this.pze(new ve.b(e.suggestion,
e.gt,e.Qmc,e.$7c,()=>{e.annotationType!==sj.a.Hmg&&e.annotationType!==sj.a.NEg||this.Yba.Gtc(e.SXa,e.Qmc,e.$7c-e.Qmc,e.annotationType,60);const ja=e.sSd(C,e.gt);E.ULS.shipAssertTag(540676565,3016,ja,`Contextual suggestion failed to apply. annotationType: ${e.annotationType}`);return ja}),0,this.Jvc.cjc(C.role)))});1<n&&(e.annotationType===sj.a.Hmg||e.annotationType===sj.a.NEg)&&this.gG&&this.gG.execute(S=>{S.logActivity(Jf.a.WXn,null)});E.ULS.sendTraceTag(540653090,3016,50,"Role: {0}; Status {1};",
C.role,n);return n}G1c(e,n=null){if(!n&&(n=Object(Jg.a)(pn.AParagraphNode,e.parent),!n))return[];e=e.content;if(!e||!e.range||e.range!==Yc.FormattingSuggestionsRange.List)return[n];if(15!==this.Sm.YB(n).role)return[];if(uj.ListItemReader.De){if(!uj.ListItemReader.isListItem(n))return[n];({listId:e}=uj.ListItemReader.Jr(n))}else{e=this.Pd.mfa(n);if(!e||!e.hasProperty(hb.a.listID))return[n];e=e.getValue(hb.a.listID)}const C=this.iua.gUa(n,!0,!1),S=[];for(;n;)if(S.push(n),n=C.Ala()?C.DA:null,uj.ListItemReader.De){if(!uj.ListItemReader.isListItem(n))break;
if(uj.ListItemReader.Jr(n).listId!==e)break}else{const ja=this.Pd.mfa(n);if(!ja)break;if(!ja.hasProperty(hb.a.listID))break;if(ja.getValue(hb.a.listID)!==e)break}return S}mio(e,n,C=null){if(!e)return E.ULS.shipAssertTag(590434825,3016,!1),0;if(!n)return E.ULS.shipAssertTag(590434828,3016,!1),0;const S=e.content;if(!S)return E.ULS.shipAssertTag(590434826,3016,!1),0;const ja=this.G1c(e);if(!ja||!ja.length)return E.ULS.shipAssertTag(590434827,3016,!1),0;const ya=this.Sm.YB(ja[0]);if(15===ya.role&&1!==
e.content.range)return 1;let kb=!1;ja.forEach(Rb=>{this.Sm.YB(Rb).N$a||(kb=!0)});return kb?this.oCg(new ve.b(new Sc.c(Wc.a.create(),this.gG,this.$d,!1,C),ja,0,this.Og.textLength(ja[0]),()=>n(S,ja)),this.Jvc.cjc(ya.role),!1):1}Dio(e,n,C){if(!e||0==e.length)return E.ULS.shipAssertTag(512603861,3016,!1),0;if(!n)return E.ULS.shipAssertTag(590434833,3016,!1),0;let S=!1;e.forEach(ya=>{this.Sm.YB(ya).N$a||(S=!0)});const ja=this.Sm.YB(e[0]);return S?this.oCg(new ve.b(new Sc.c(Wc.a.create(),this.gG,this.$d,
!1,C),e,0,this.Og.textLength(e[0]),()=>n(ja,e)),this.Jvc.cjc(ja.role),!0):n(ja,e)?2:0}Nio(e,n){if(!e)return E.ULS.shipAssertTag(589963425,3016,!1),0;if(!n)return E.ULS.shipAssertTag(512603860,3016,!1),0;const C=this.Sm.YB(e);return C.N$a?n(C,e)?2:0:this.oCg(new ve.b(new Sc.c(Wc.a.create(),this.gG,this.$d,!1,null),[e],0,this.Og.textLength(e),()=>n(C,e)),this.Jvc.cjc(C.role),!0)}Evj(e,n){if(!e)return E.ULS.shipAssertTag(555055119,3016,!1),0;if(!n)return E.ULS.shipAssertTag(555055120,3016,!1),0;if(!e.paragraphNode)return E.ULS.shipAssertTag(555055121,
3016,!1),0;n=n(e);const C=null===n||void 0===n?void 0:n.paragraphNode;if(!C)return E.ULS.shipAssertTag(541446668,3016,!1),0;this.zD.Kuc(n);this.yhc.register(C,e.suggestion);return this.pze(new ve.b(e.suggestion,[C],0,1,null),(null===n||void 0===n?0:n.placeholder)?.5:1,this.Jvc.cjc(n.role))}gnf(e,n,C=!1){e?this.j5j(e,n,C):E.ULS.shipAssertTag(590434834,3016,!1)}XRf(e,n){const C=[];this.iK.forEach(S=>{const ja=this.iK.hX(S);if(void 0!==n&&ja.suggestion.lr!==n)return E.ULS.sendTraceTag(537796610,3016,
50,`skiped role: ${ja.vsb} type: ${ja.suggestion.lr}`),!0;e||0!=ja.state&&.1!==ja.state||(E.ULS.sendTraceTag(540676562,3016,50,"Role: {0};",ja.vsb),ja.HKb());C.push(S);return!0},!e);C.length&&C.forEach(S=>{this.j5j(S,e?3:2,!0)});E.ULS.sendTraceTag(537796611,3016,50,`reject: ${e} count: ${C.length}`)}Lpd(){this.ho.Hqa()&&(E.ULS.sendTraceTag(537260063,3016,50,"snoozeContextualSuggestions"),this.ho.Qfi())}K0m(e){const n=this.Sm.YB(e);n&&!n.$la&&this.Nec(e,5)}Onl(e){if(null!==e&&void 0!==e&&e.paragraphNode){var n=
this.iK.hX(e.paragraphNode),C=this.iK.hX(e.paragraphNode).suggestion,S=this.Sm.YB(e.paragraphNode);switch(e.lr){case 1:case 3:this.yhc.unregister(e.paragraphNode);const ja=ya=>{this.zD.Kuc({role:27,paragraphNode:e.paragraphNode,placeholder:ya})};e.paragraphNode=this.Sqe.aol(e.paragraphNode,C,()=>{this.zD.kjd(tt.a.create(e.paragraphNode));ja(!1)},e.h_);ja(!0);this.yhc.register(e.paragraphNode,C);this.pze(new ve.b(C,[e.paragraphNode],0,1,null),1,this.Jvc.cjc(e.role));break;case 2:this.yhc.unregister(e.paragraphNode);
n=Af.ParagraphReader.pg(e.paragraphNode,!1);this.fR.bvc(S.K6c,e.paragraphNode);this.lTf.instance.RSh(new ve.a(C,n,e.Jsa));break;default:1===e.role?n&&n.PQ&&0<n.PQ.length?n.PQ.forEach(ya=>{this.a4.TZa(ya,!1)}):this.a4.TZa(e.paragraphNode,!1):0!=e.role&&e.role===S.fSd?(this.a4.TZa(e.paragraphNode,!1),this.dK.pmb(e.paragraphNode,S.gSd)):n&&n.PQ&&0<n.PQ.length?n.PQ.forEach(ya=>{this.dK.Uja(ya,e.role)}):this.dK.Uja(e.paragraphNode,e.role)}this.zD.uog(new Px.a(e.paragraphNode,e.role));this.LUd(e.paragraphNode,
4)}else E.ULS.shipAssertTag(575484485,3016,!1)}MOa(e){if(e){var n=this.iK.hX(e);n?(this.zD.uog(new Px.a(e,n.vsb)),3!==n.state&&.1!==n.state||n.HKb(),4===n.state&&(n&&n.PQ&&0<n.PQ.length?n.PQ.forEach(C=>{this.a4.TZa(C,!1)}):this.a4.TZa(e,!1),n.HKb()),this.LUd(e,1)):E.ULS.shipAssertTag(573850382,3016,!1)}else E.ULS.shipAssertTag(573850381,3016,!1)}KIm(){let e=null;this.iK.forEach(n=>{e=n;return!1},!1);return e}fkc(e,n){return e?this.iK.LBm(e,n):(E.ULS.shipAssertTag(590434835,3016,!1),null)}LUd(e,n){const C=
this.iK.hX(e);C?(C.state=n,3===n&&27!=C.vsb&&28!=C.vsb&&1===C.PQ.length&&(this.Yba.Gtc(e,0,e.characterData.length,sj.a.Mci,70),this.kBj.set(e,Date.now()))):E.ULS.sendTraceTag(512239234,3016,50,"Review intent for given paragraph node is null.")}Nec(e,n){const C=this.iK.hX(e);if(!e.lqe||1<n)this.Mfa.zAb(e,1),C&&C.PQ&&0<C.PQ.length?C.PQ.forEach(S=>{this.a4.svf(S)}):this.a4.svf(e),this.zD.Qxj(new pE.a(e,n)),e=[Object.assign(new kh.a,{name:Jf.a.Mxl,int64:n})],this.eIn(Jf.a.Lxl,!0,void 0,e)}Kxl(e){const n=
this.iK.hX(e);let C=0;n?C=n.state:E.ULS.shipAssertTag(573687424,3016,!1);this.Nec(e,C)}j5j(e,n,C){const S=this.Sm.YB(e);if(S.$la){var ja=this.iK.hX(e),ya=null===ja||void 0===ja?void 0:ja.state;this.LUd(e,n);3===n||.1===n?27===S.role?(1===ya&&(this.yhc.unregister(e),this.Sqe.PBj(e)),C=!1):28===S.role?(this.yhc.unregister(e),this.fR.bvc(S.K6c,e),C=!1):(ja&&ja.PQ&&0<ja.PQ.length?ja.PQ.forEach(kb=>{this.a4.TZa(kb,!1)}):this.a4.TZa(e,!1),this.zD.Rno(new Px.a(e))):2===n&&this.zD.Pno(new Px.a(e));C&&this.Kxl(e)}}pze(e,
n,C,S=!1){const ja=this.Sm.YB(e.SXa);0<e.$7c&&!ja.$la&&!this.W3o(e.SXa)?(this.Mfa.XXa(e.SXa,new iJ.a(1,e.Qmc,e.$7c,void 0,new Kz(e.suggestion,n,C,ja.role,e.sSd,e.gt))),0==e.suggestion.lr&&this.Zyl.register(e.SXa,e.suggestion),this.zD.Qno(new Px.a(e.SXa,ja.role,S)),e=3):e=4;E.ULS.sendTraceTag(540653091,3016,50,"Role: {0}; Status {1}; State: {2};",ja.role,e,n);return e}W3o(e){var n=Date.now();return this.f0?!1:(e=this.kBj.get(e))?n-e<this.$d.Ldl():!1}oCg(e,n,C){this.RL.le(()=>{e.gt.forEach(S=>{this.a4.cwc(S,
C)})},"WD:SF");if(e.sSd())return this.pze(e,1,n,!C);e.gt.forEach(S=>{this.a4.svf(S)});return 0}NTi(){this.iK.forEach(e=>{if(1<this.iK.hX(e).state)return!0;this.Nec(e,5);return!0},!1)}x8k(e,n){const C=this.FA.Lc(15,pe.a.JSh);try{n&&n.PQ&&0<n.PQ.length?(C.Rz.Ab(this.Qc.vd),n.PQ.forEach(S=>{this.a4.cwc(S,!0)})):(C.Rz.Ab(e),this.a4.cwc(e,!0)),n.HKb()}finally{C&&C.dispose()}}}Object(F.a)(Gy,"ReviewManager",null,[1153]);class oG{constructor(e,n,C,S){this.hRe=new Set;this.Wn=e;this.hb=n;this.VRa=C;this.WPa=
S}forEach(e,n=!1){if(e){var C=Object(Jg.a)(pn.AParagraphNode,n?this.hb.GF(this.WPa.vd):this.hb.Zm(this.WPa.vd));n=this.VRa.gUa(C,!0,n);do if(this.C$c(n.DA)&&!e(n.DA))break;while(n.Ala())}else E.ULS.shipAssertTag(590391060,3016,!1)}LBm(e,n){if(!e)return E.ULS.shipAssertTag(590391061,3016,!1),null;for(e=this.VRa.gUa(e,!0,n);e.Ala();)if(this.C$c(e.DA))return e.DA;return null}C$c(e){return e?0<this.Wn.hKa(e,1,()=>!0).count&&!Array.from(this.hRe).some(n=>n(e)):(E.ULS.shipAssertTag(590391062,3016,!1),!1)}hX(e){if(!e)return E.ULS.sendTraceTag(522301513,
3016,50,"Get null paragraphNode while trying to initialize ReviewIntent"),null;e=this.Wn.hKa(e,1,()=>!0);if(1===e.count)return e.K(0).intent;E.ULS.sendTraceTag(522301514,3016,50,"Return null ReviewIntent because of unexpected ranges.count: {0}",e.count);return null}HWk(e){this.hRe.add(e);return()=>this.hRe.delete(e)}}Object(F.a)(oG,"ReviewTraverser",null,[1154]);var Lz;(function(e){e[e.None=0]="None";e[e.oik=1]="ProactivePaneOpeningDisabled";e[e.hPp=2]="JumpstartProactivePaneOpeningDisabled"})(Lz||
(Lz={}));Object(F.b)("DesignerFlagSetting",Lz);const qE=e=>{if(!e)return Lz.None;const n=e.split(".");return 2===n.length&&1===parseInt(n[0])?parseInt(n[1]):"0"===e?Lz.oik:Lz.None};class zC{constructor(){this.FavoriteThemesIDs=this.DesignerFlags=this.CSDisableDate=null}equals(e){return this.CSDisableDate===e.CSDisableDate&&this.DesignerFlags===e.DesignerFlags&&this.FavoriteThemesIDs===e.FavoriteThemesIDs}}Object(F.a)(zC,"WordDesignerSettings",null,[1061]);class Mp{constructor(e,n){this.gud=e;this.$d=
n;this.roamingSettings=null;this.gif=!0;this.jd=new eb.a}initialize(){if(this.gud){E.ULS.sendTraceTag(523850467,3016,50,"DesignerSettingsManager - initialize with roaming");var e=Date.now();this.gud.Vab().then(n=>{this.roamingSettings=n;this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);!0!==this.Hqa()&&(n=[Object.assign(new kh.a,{name:"CSEnabled",bool:this.Hqa()})],xa.a(Jf.a.MCn,!0,Date.now()-e,n));this.$d.qAg()&&(n=new zC,n.CSDisableDate=new Date(0),n.DesignerFlags="",n.FavoriteThemesIDs=
[],this.roamingSettings=n)}).catch(n=>{E.ULS.sendTraceTag(509137223,3016,15,`DesignerSettingsManager - failed loading from roaming with error ${JSON.stringify(n,["message","stack"],2)}`)})}else E.ULS.sendTraceTag(523850466,3016,50,"DesignerSettingsManager - initialize. No roaming")}Wd(){E.ULS.sendTraceTag(523850497,3016,50,`DesignerSettingsManager - deinitialize. CS_enabled: ${this.Hqa()}`)}vcc(e){this.jd.addHandler("OnSettingsChanged",e)}lZb(e){this.jd.removeHandler("OnSettingsChanged",e)}c2(){return this.$d.rye()||
this.$d.qAg()?!0:!(!this.roamingSettings||!this.gud)}V_l(){this.Hqa()?E.ULS.shipAssertTag(523850498,3016,!1):(this.gif=!0,this.roamingSettings&&(this.roamingSettings.CSDisableDate=new Date(0),this.btd()),this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs),E.ULS.sendTraceTag(523850499,3016,50,"DesignerSettingsManager - enableContextualSuggestions."))}Hqa(){if(this.$d.rye())return!0;if(this.c2())return!1===this.gif||this.roamingSettings&&this.roamingSettings.CSDisableDate&&this.roamingSettings.CSDisableDate>
new Date(0)?!1:!0}Ewf(){const e=this.Hqa();this.gif=!1;e&&this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);E.ULS.sendTraceTag(523850500,3016,50,`DesignerSettingsManager - disableForSession. Changed:${e}`)}Qfi(){if(this.roamingSettings){var e=this.Hqa();this.roamingSettings.CSDisableDate=new Date;this.btd();e&&this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);E.ULS.sendTraceTag(523850502,3016,50,`DesignerSettingsManager - disableUntilUpdate. Changed:${e}`)}else E.ULS.shipAssertTag(523850501,
3016,!1),this.Ewf()}Q8c(e,n){return this.c2()?qE(this.roamingSettings.DesignerFlags)&e?!0:!1:n}rNj(e){if(this.roamingSettings){var n=this.roamingSettings.DesignerFlags;e|=qE(n);this.roamingSettings.DesignerFlags=`1.${e}`;n!==this.roamingSettings.DesignerFlags&&(this.btd(),this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else E.ULS.shipAssertTag(508944657,3016,!1)}x5j(e){if(this.roamingSettings){var n=this.roamingSettings.DesignerFlags;e=qE(n)&~e;this.roamingSettings.DesignerFlags=`1.${e}`;
n!==this.roamingSettings.DesignerFlags&&(this.btd(),this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else E.ULS.shipAssertTag(508944656,3016,!1)}w0i(){return!this.Q8c(1,!0)}GUl(){this.rNj(1)}mji(){this.x5j(1)}azm(){if(this.roamingSettings)return E.ULS.sendTraceTag(520488718,3016,50,`DesignerSettingsManager - getListOfFavoriteThemesIDs. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`),this.roamingSettings.FavoriteThemesIDs;E.ULS.shipAssertTag(520488719,3016,!1)}ymp(e){var n,
C;if(this.roamingSettings){var S=null!==(C=null===(n=this.roamingSettings.FavoriteThemesIDs)||void 0===n?void 0:n.indexOf(e,0))&&void 0!==C?C:-1;-1===S?(this.roamingSettings.FavoriteThemesIDs||(this.roamingSettings.FavoriteThemesIDs=[]),this.roamingSettings.FavoriteThemesIDs.unshift(e)):this.roamingSettings.FavoriteThemesIDs.splice(S,1);this.$d.qAg()||this.btd();this.jd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);E.ULS.sendTraceTag(520488716,3016,50,`DesignerSettingsManager - toggleFavoriteTheme. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`)}else E.ULS.shipAssertTag(520488717,
3016,!1)}btd(){this.gud&&(this.gud.saveSettings(this.roamingSettings),E.ULS.sendTraceTag(523850503,3016,50,"DesignerSettingsManager - updateRoamingSettings"))}}Object(F.a)(Mp,"DesignerSettingsManager",null,[1158]);class AC extends bh.a{constructor(e){super("DesignerSettingsReadyConditionId");this.ho=e;this.F3=()=>{this.ho.c2()?(this.pi(!0),this.ho.lZb(this.F3)):E.ULS.sendTraceTag(523850465,3016,15,"DesignerSettingsReadyCondition: settings changed, but not loaded")}}initialize(){super.initialize();
this.ho.c2()?this.pi(!0):this.ho.vcc(this.F3)}Wd(){this.ho.lZb(this.F3);super.Wd()}}Object(F.a)(AC,"DesignerSettingsReadyCondition",bh.a,[]);var Tt=d(1514),Mz=d(1515);class Hy{static Von(e){return String(e).charAt(0)==String(e)}static o0l(e){return Hy.Von(e)?"*"+e:e.toString()}static SNl(e){const n=[];for(let S=0;S<e.length;S+=2){var C=e.substring(S,Math.min(e.length,S+2));C=C.startsWith("*")?Number(C.substring(1)):Number(C);n.push(C)}return n}static tin(e){return e instanceof Date&&!isNaN(e.getTime())}}
Object(F.a)(Hy,"WordDesignerSettingsUtils",null,[]);var Iy=d(264);const rE=new Date(0);class Qx extends Tt.a{constructor(e,n,C,S,ja){super(e,n,C,S,ja);this.v$="Word Designer";this.SFb=["CSDisableDate","DesignerFlags","FavoriteThemesIDs"];this.O8b=Qx.plk;this.cIc="getWordDesignerSettings";this.D$b="saveWordDesignerSettings";this.Akb=Iy.a.fGe}fGe(){return this.Mi}async Bld(){return!0}ncc(){var e;return["CSDisableDate",this.Mi.CSDisableDate,"DesignerFlags",null!==(e=this.Mi.DesignerFlags)&&void 0!==
e?e:"0","FavoriteThemesIDs",this.Mi.FavoriteThemesIDs]}mcc(){var e,n=this.Mi.CSDisableDate?this.Mi.CSDisableDate.toISOString():"";n=this.Mi.CSDisableDate?n.substring(0,n.indexOf("T")):"";const C=this.Mi.FavoriteThemesIDs?this.Mi.FavoriteThemesIDs.map(Hy.o0l).join(""):"";return{["CSDisableDate"]:this.PZ(n),["DesignerFlags"]:this.PZ(null!==(e=this.Mi.DesignerFlags)&&void 0!==e?e:"0"),["FavoriteThemesIDs"]:this.PZ(C)}}NXc(){return new Mz.a(this.Mi)}get dgc(){return new zC}Kgd(e){const n=new zC;if(e.CSDisableDate){const C=
this.Iyj(e.CSDisableDate);n.CSDisableDate=Hy.tin(C)?C:rE}else n.CSDisableDate=null;n.DesignerFlags=e.DesignerFlags?this.Hkd(e.DesignerFlags):"0";n.FavoriteThemesIDs=e.FavoriteThemesIDs?Hy.SNl(this.Hkd(e.FavoriteThemesIDs)):[];return n}Vab(){return this.Jbd()}saveSettings(e){this.Mi=e;return this.wmd()}}Qx.plk="WordDesignerSettingsChangedEvent";Object(F.a)(Qx,"WordDesignerSettingsHandler",Tt.a,[1156]);class BC{constructor(e,n,C,S,ja,ya,kb,Rb,sc=null,Fc){this.$d=e;this.kua=n;this.GVd=C;this.gsa=S;this.F2=
ja;this.ih=ya;this.Sm=Rb;this.gG=sc;this.Igc=Fc;this.Yoc=this.isInitialized=!1;this.Ena=this.ffa=0;this.mpe="";this.lua=new Map;this.DLb=new Map;this.wUc=0;this.p7a=new fb.a;this.XNa=null;this.sUb=Wc.a.nil;this.qTb=!1;this.TCa=[];this.Psc=(gd,td)=>{this.XNa&&td.actionId===pe.a.hDa&&this.XNa.hcd()};this.Pvb=(gd,td)=>{if(null==this.TCa||0==this.TCa.length)this.Ena=2;else if(td.data.operationType!==xd.a.getTypeName())E.ULS.sendTraceTag(512350099,3016,50,`unexpected operationType: ${td.data.operationType}`);
else if(this.qTb)if(gd=td.data.annotation)if(gd.annotationType!==Yc.FormattingSuggestionsAnnotation.getTypeName())E.ULS.shipAssertTag(521429915,3016,!1);else if(td=this.gsa.getParent(gd))if(this.TCa.includes(td)){var Bd=this.TCa.indexOf(td);-1!==Bd&&(this.DLb.set(gd,{aIj:this.Sm.YB(td),Sig:Bd}),this.wUc=this.TCa.length,this.wvf(213),this.XNa||(this.XNa=new Sc.a(this.sUb,this.gG,this.$d,!1,this.ih.Eka),this.XNa.MXa(0)),1!==this.Ena&&(this.Ena=1,this.PAc(this.Ena)),this.DLb.size===this.wUc&&this.GAc(),
this.opp())}else E.ULS.sendTraceTag(521483348,3016,50,`Skip non-pasted paragraph ${null===td||void 0===td?void 0:td.id}`);else E.ULS.shipAssertTag(521429914,3016,!1);else E.ULS.shipAssertTag(521429916,3016,!1)};this.Qvb=(gd,td)=>{td.data.operationType===xd.a.getTypeName()&&(td.data.annotation?td.data.annotation.annotationType!==Yc.FormattingSuggestionsSummaryAnnotation.getTypeName()?E.ULS.shipAssertTag(521429912,3016,!1):(this.ffa&&(gd=[Object.assign(new kh.a,{name:Jf.a.Zog,string:"CCPFloatieSmartPaste"})],
xa.a(Jf.a.Yog,!0,Date.now()-this.ffa,gd),this.ffa=0),(td=td.data.annotation.content)?(td.errorCode||0===td.numberOfSuggestions)&&this.qTb&&0===this.Ena&&this.htf(213,5E3,!1):E.ULS.shipAssertTag(521429911,3016,!1)):E.ULS.shipAssertTag(521429913,3016,!1))};this.D3=(gd,td)=>{var Bd;this.kef(td.node);td.pZi&&(this.upl()?(this.Gdn(),this.dgp(),this.PAc(0),this.htf(213,1E4)):(this.Qzp(this.TCa),this.GAc(),this.XNa&&1===this.XNa.kgp&&this.XNa.hcd()),this.Urj=!0,xa.a("PasteActionHappened",!0,void 0,[Object.assign(new kh.a,
{name:"IsNewPasteAction",Boolean:this.qTb}),Object.assign(new kh.a,{name:"CorrelationId",string:null===(Bd=this.sUb)||void 0===Bd?void 0:Bd.toString()})]))};this.Ena=0;this.wRi();this.zgd=kb.qf(12)}initialize(){this.isInitialized||(E.ULS.sendTraceTag(521483352,3016,50,"SmartPasteManager - initialize"),this.ih.wcc(this.Psc),this.zgd.gPh(this.D3),this.isInitialized=!0)}Wd(){this.isInitialized&&(E.ULS.sendTraceTag(521483351,3016,50,"SmartPasteManager - deinitialize"),this.ih.Krg(this.Psc),this.GAc(),
this.zgd.CDj(this.D3),this.isInitialized=!1)}dgp(){E.ULS.sendTraceTag(521483350,3016,50,`SmartPasteManager - subscribe to AL was called: ${this.Yoc}`);this.Yoc||(this.ffa=Date.now(),this.gsa.QH(this.Pvb),this.F2.QH(this.Qvb),this.F2.register(),this.gsa.register(),this.Yoc=!0,this.htf(217,3E4))}GAc(){E.ULS.sendTraceTag(521483349,3016,50,`SmartPasteManager - unsub from AL was called: ${this.Yoc}`);this.Yoc&&(this.F2.unregister(),this.gsa.unregister(),this.gsa.hK(this.Pvb),this.F2.hK(this.Qvb),this.Yoc=
!1,this.wvf())}wRi(){switch(this.$d.fzb()){case 1:this.mpe="floatie.gbFormatWithDesignerButton-Menu16";this.kua.dzg("floatie.gbFormatWithDesignerButton");this.lua.set(0,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerAnalyzing,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});this.lua.set(1,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});this.lua.set(2,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,
altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipUnavailable});break;case 2:this.mpe="floatie.gbMatchDocumentFormattingButton-Menu16";this.kua.dzg("floatie.gbMatchDocumentFormattingButton");this.lua.set(0,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingAnalyzing,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.lua.set(1,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});
this.lua.set(2,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipUnavailable});break;case 3:this.mpe="floatie.gbUseSmartPasteButton-Menu16",this.kua.dzg("floatie.gbUseSmartPasteButton"),this.lua.set(0,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPasteAnalyzing,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.lua.set(1,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),
this.lua.set(2,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipUnavailable})}}PAc(e){if(0!==this.lua.size&&this.lua.get(e)){this.Ena=e;var n=this.lua.get(e).labelText;e=this.lua.get(e).altText;var C=document.getElementById(this.mpe);this.kua.PAc(n,e,C?!0:!1)}else this.wRi(),E.ULS.sendTraceTag(521416988,3016,50,`pasteStateStrings initialized in updateSmartPasteButton method. Correlation id:${this.sUb}`)}Gdn(){this.XNa=null;this.DLb.clear();
this.Ena=this.wUc=0;this.wvf()}htf(e,n,C=!0){n=new zg.a(2,1,n,()=>{switch(e){case 213:0===this.Ena&&(this.PAc(2),C&&this.GAc());break;case 217:this.GAc()}},e);G.AFrameworkApplication.pc.$b(n);this.p7a.add(n)}wvf(e=null){if(0!==this.p7a.count)if(e){let n=0;for(;n<this.p7a.count;)this.p7a.K(n).Cva===e?(G.AFrameworkApplication.pc.wf(this.p7a.K(n)),this.p7a.removeAt(n)):n++}else{for(e=0;e<this.p7a.count;e++)G.AFrameworkApplication.pc.wf(this.p7a.K(e));this.p7a.clear()}}upl(){if(this.GVd.instance){const e=
this.GVd.instance.wFm();if(e!==Wc.a.nil&&e!==this.sUb)return this.sUb=e,this.qTb=!0}else return E.ULS.sendTraceTag(521483347,307,10,"ClipboardActor future not ready"),this.qTb=!0;return this.qTb=0===this.DLb.size}Qzp(e){1===this.Ena&&(this.wUc!==e.length?E.ULS.sendTraceTag(521483346,3016,50,`Missmatch in number of pasted paragraph. Number of cached pasted paragraphs:${this.wUc}. Number of pasted paragraphs:${e.length}`):this.DLb.forEach((n,C)=>{n.Sig<e.length&&(C.parent=e[n.Sig])}))}rWo(e){this.GVd.instance?
this.GVd.instance.g5i=e:E.ULS.sendTraceTag(521483345,307,10,"ClipboardActor future not ready")}kef(e){this.Urj&&(this.TCa=[],this.Urj=!1);this.TCa.push(e)}s9k(){this.GAc();if(0===this.DLb.size)return 0;const e=this.Igc.t9k(this.DLb,this.TCa);0<e?this.XNa.MXa(1):E.ULS.shipAssertTag(520646736,3016,!1);return e}g0i(e){return e?e===pe.a.vZa||e===pe.a.P3||e===pe.a.xwb:!1}Eka(){return this.ih.Eka}opp(){const e=gc.a.instance.Ta("Common.ISystemInitiatedFeedback");e&&e.execute(n=>{switch(this.$d.fzb()){case 1:n.logActivity(Jf.a.elk,
null);break;case 2:n.logActivity(Jf.a.klk,null);break;case 3:n.logActivity(Jf.a.xlk,null)}})}}Object(F.a)(BC,"SmartPasteManager",null,[506,1155]);class Cq{constructor(e){this.lKh=e}get Kg(){return null!=this.o4g?this.o4g:this.o4g=gc.a.instance.Oa("Box4.Styles.StyleSettings")}getPropertyValue(e,n,C){if(!e)return E.ULS.shipAssertTag(574407567,3016,!1),C;var S=new od.ScriptSharpLegacyMap;for(var ja of e.c0j)if(ja.mo.hasProperty(n)){const ya=ja.cpEnd-ja.vu,kb=ja.mo.getValue(n);if(S.tb(kb)){let Rb;S.W(Rb=
kb,S.K(Rb)+ya)}else S.add(kb,ya)}ja=e.textLength*Jf.a.Vop;for(const ya of S.keys)if(S.K(ya)>ja)return ya;if(e.paragraphFormat.hasProperty(n))return e.paragraphFormat.getValue(n);S=e.paragraphFormat.ka(Ld.a.styleName,Jf.a.Uop);e=this.lKh.ro();this.Kg.vn?(S=e.gv().GAa(S),e=e.nh(this.lKh.Be(S))):e=e.qKa(S);return e?e.ka(n,C):C}}Object(F.a)(Cq,"ParagraphFormattingSnapshotReader",null,[1152]);class Rx{constructor(){this.Uxa=new If.a}put(e,n){this.Uxa.add(e,n)}oDe(e){let n;return{returnValue:({value:n}=
this.Uxa.Ec(e)).returnValue,hWj:n}}remove(e){this.Uxa.remove(e)}}Object(F.a)(Rx,"ParagraphFormattingStorage",null,[1151]);class Hl{constructor(){this.TMc=new je.a(Pg.a.vh())}put(e,n){this.TMc.tb(e)?this.TMc.W(e,n):this.TMc.add(e,n)}oDe(e){let n;return{returnValue:({value:n}=this.TMc.Ec(e,n)).returnValue,uva:n}}tb(e){return this.TMc.tb(e)}}Object(F.a)(Hl,"StyleStorage",null,[]);var Az=d(267);class Nu{constructor(e){this.Ap=e;this.E$a=!1;this.nz=this.dialog=null;this.Mbd=this.zL=0;this.jd=new eb.a;
this.Kcg="OnApplyThemeDialogClosed"}showDialog(){this.dialog=new Qh.a(!1,!1,!0);this.dialog.Bd=5;this.dialog.Uh(WordEditorIntl.WordEditorStrings.L_DesignerApplyThemeDialogTitle,null,this.NPb());this.nz=this.Ap.Xf("DialogShown","ApplyThemeBlockingDialog");this.E$a=!0;E.ULS.sendTraceTag(524121478,3016,50,"Apply theme blocking dialog is shown.");xa.a(Jf.a.X9k,!0);this.Mbd=this.zL=0;Az.a.delay(6E4).continueWith(()=>{E.ULS.sendTraceTag(509367262,3016,50,"Apply theme blocking dialog started closing after timeout.");
this.$ya(!0)})}B5o(e,n){var C,S;if(null===(C=e.decorators)||void 0===C?0:C.filter(ya=>ya.hasImages).length)return!0;const ja=new Set;for(const [ya,kb]of e.styles)null===(S=kb.decorators)||void 0===S?void 0:S.forEach(Rb=>{Rb.hasImages&&ja.add(Xi.g(ya))});if(!ja.size)return!1;e=this.Ap.Xf("UserAction","ApplyThemeDialogShouldShow");C=!1;for(const ya of n.keys())if(ja.has(ya)){C=!0;break}e.stop();return C}$ya(e=!1){this.E$a&&(e||this.Mbd==this.zL)&&(this.dialog.hide(),this.nz.stop(),this.E$a=!1,this.jd.raiseEvent(this.Kcg),
E.ULS.sendTraceTag(524121479,3016,50,`Apply theme blocking dialog has closed, isForced: ${e}`),e=[Object.assign(new kh.a,{name:Jf.a.V9k,boolean:e})],xa.a(Jf.a.U9k,!0,void 0,e))}Vef(){this.E$a&&(this.zL+=1)}Cbg(){if(this.E$a)return this.Mbd+=1,this.Mbd==this.zL?(this.$ya(),!0):!1}pff(e){this.jd.addHandler(this.Kcg,e)}IDj(e){this.jd.removeHandler(this.Kcg,e)}NPb(){return{["id"]:"ApplyThemeDialog",["dialogButtonsOption"]:5,["hideCloseButton"]:!0}}}Object(F.a)(Nu,"ApplyThemeDialogManagerImpl",null,[1150]);
class Dq{constructor(){this.sa=new eb.a}initialize(){}Wd(){}qRd(e){this.sa.addHandler(Dq.CMa,e)}UDj(e){this.sa.removeHandler(Dq.CMa,e)}}Dq.CMa="OnThemesChanged";Object(F.a)(Dq,"AThemeProvider",null,[1141,506]);class Jy{constructor(e=Pl.none,n=""){this.labelId=e;this.Dha=n}getLabel(){return this.labelId}getStringId(){return this.Dha}equals(e){return this.Dha||e.Dha?this.Dha===e.Dha:this.labelId===e.labelId}static equals(e,n){return e||n?e&&n?e.equals(n):!1:e===n}toString(){return null!==this.Dha?this.Dha:
null!==this.labelId?this.labelId.toString():""}}Object(F.a)(Jy,"SectionId",null,[]);class Ky extends Dq{constructor(e,n,C,S,ja){super();this.A4=e;this.qV=n;this.l7a=C;this.w4=S;this.$d=ja;this.qgc=this.Rw=null;this.Eud=new Map([[xl.SectionLabel.Article,Pl.article],[xl.SectionLabel.CoverLetter,Pl.coverLetter],[xl.SectionLabel.CoverPage,Pl.coverPage],[xl.SectionLabel.GeneralDocument,Pl.generalDocument],[xl.SectionLabel.Invoice,Pl.invoice],[xl.SectionLabel.Journal,Pl.journal],[xl.SectionLabel.Letter,
Pl.letter],[xl.SectionLabel.Letterhead,Pl.letterhead],[xl.SectionLabel.Main,Pl.main],[xl.SectionLabel.Notes,Pl.notes],[xl.SectionLabel.Report,Pl.report],[xl.SectionLabel.Resume,Pl.resume],[xl.SectionLabel.Text2Image,Pl.text2Image],[xl.SectionLabel.ToDoList,Pl.toDoList]]);this.pBb=new Map([[jp.letters,{id:"817f4488-91de-4a44-842e-44670553632b",displayName:"Letters"}],[jp.writing,{id:"e3abc6aa-ea3f-4d0f-887d-e929caf85eaf",displayName:"Writing"}],[jp.lists,{id:"d9d2be59-6d2a-41b7-bd37-74507d741f9c",
displayName:"Lists"}],[jp.resumes,{id:"39b64df5-1fb2-4699-b467-028bb20986e3",displayName:"Resumes"}],[jp.business,{id:"f2015b9f-1a5f-4cdf-813a-3cbedcd28768",displayName:"Business"}],[jp.education,{id:"f9f17e14-9f18-4872-ab1d-c4e05a7e3446",displayName:"Education"}],[jp.newsletters,{id:"dd8a511d-30c7-4019-8cfe-611888ea2450",displayName:"Newsletters"}]]);this.activeSection=null;this.isInitialized=!1;this.nRh=(ya,kb)=>{var Rb;this.A4.hK(this.nRh);if(kb.data.annotation)if(kb.data.annotation.annotationType!==
xl.ThemeGeneratorAnnotation.getTypeName())E.ULS.shipAssertTag(545399813,3016,!1);else if(ya=kb.data.annotation.content){if(null===(Rb=ya.sections)||void 0===Rb?0:Rb.length)this.Rw=this.Dfm(ya);this.sa.raiseEvent(Dq.CMa)}else E.ULS.shipAssertTag(545399814,3016,!1);else E.ULS.shipAssertTag(545399812,3016,!1)};this.hgg=()=>{var ya;this.Rw&&(this.pFf(this.Rw)||(this.Rw=null===(ya=this.Rw)||void 0===ya?void 0:ya.map(kb=>{kb.id.getLabel()===Pl.text2Image&&(kb.isLoaded=!0,kb.items=[]);return kb})),this.sa.raiseEvent(Dq.CMa))};
this.FWn=()=>{var ya;const kb=this.XFi(this.Rw,Pl.text2Image);null!==kb&&void 0!==kb&&kb.items&&(this.qV.initialize(),this.qV.sff(this.hgg),this.qV.LFj()?this.pFf(this.Rw)||(this.Rw=null===(ya=this.Rw)||void 0===ya?void 0:ya.filter(Rb=>Rb.id.getLabel()!==Pl.text2Image)):kb.isLoaded=!1,this.sa.raiseEvent(Dq.CMa))}}c9d(){return this.Rw}G4c(){return this.qgc}Xic(){return this.activeSection}G_(){return!1}she(){}initialize(){this.isInitialized||(this.A4.QH(this.nRh),this.A4.Rza(new xl.ThemeGeneratorSignal),
this.w4.mPh(this.FWn),this.isInitialized=!0)}Wd(){}Dfm(e){let n=[];this.qgc=new je.a(Pg.a.vh());this.activeSection=e.activeSection;for(const C of e.sections){if(C.label===xl.SectionLabel.CoverPage&&!tw())continue;e=[];for(const ya of C.items){const kb=ya;Dk.a.QR&&["D7ST","D14ST","D25ST"].some(Rb=>Rb===kb.name)||(this.qgc.add(kb.name,kb.id),e.push(this.getTheme(kb,C)))}let S=null,ja=null;if(this.$d.ztb()){const ya=this.Vvi(this.Eud.get(C.label));ya&&(S=ya.id,ja=ya.displayName)}n.push({label:this.Eud.get(C.label),
labelDisplayName:ja,id:new Jy(this.Eud.get(C.label),S),displayName:ja,items:e,isLoaded:C.label!==xl.SectionLabel.Text2Image,G_:!1});C.label==xl.SectionLabel.Text2Image&&(this.qV.initialize(),this.qV.sff(this.hgg),this.qV.LFj()&&(this.pFf(n)||(n=null===n||void 0===n?void 0:n.filter(ya=>ya.id.getLabel()!==Pl.text2Image))))}return n}Vvi(e){switch(e){case Pl.letter:case Pl.coverLetter:case Pl.letterhead:return this.pBb.get(jp.letters);case Pl.generalDocument:case Pl.journal:return this.pBb.get(jp.writing);
case Pl.toDoList:return this.pBb.get(jp.lists);case Pl.resume:return this.pBb.get(jp.resumes);case Pl.notes:case Pl.invoice:return this.pBb.get(jp.business);case Pl.report:return this.pBb.get(jp.education);case Pl.article:return this.pBb.get(jp.newsletters)}}getTheme(e,n){const C=new Map;let S=!1;for(const ya of e.roles){var ja=Xi.f(ya.type);C.set(Xi.h(ja),{decorators:this.l7a.Eri(ya.style.decorators),fontName:ev(ya.style.fontFamily),fontSize:ya.style.fontSize,fontColor:ya.style.fontColor,bold:ya.style.bold,
italic:ya.style.italic,underline:ya.style.underline,alignment:ya.style.alignment,lineSpacing:ya.style.lineSpacing,beforeSpacing:ya.style.beforeSpacing,afterSpacing:ya.style.afterSpacing,specialIndentType:ya.style.specialIndentType,specialIndentBy:ya.style.specialIndentBy,fontKerning:ya.style.fontKerning,allCaps:ya.style.allCaps});ya.style.decorators&&(S=!0);ja=ya.style.fontFamily;$e.a.OJa.isEnabled?$e.a.OJa.qra(ja):$e.a.WIa.isEnabled&&$e.a.WIa.qra(ja)}n=this.Vvi(this.Eud.get(n.label));return{type:e.type,
name:e.name,id:e.id,styles:C,decorators:this.l7a.Eri(e.decorators),layout:e.layout,accentColor:e.accentColor,backgroundColor:e.backgroundColor,isSimpleTheme:!e.decorators&&!S,collectionId:null===n||void 0===n?void 0:n.id,collectionName:null===n||void 0===n?void 0:n.displayName,IsL2Template:!1}}XFi(e,n){if(!e)return null;for(const C of e)if(C.id.getLabel()===n)return C;return null}pFf(e){var n;const C=this.qV.swm();this.qV.NDj(this.hgg);this.qV.Wd();if(!C||null===(n=C.wU)||void 0===n||!n.length||C.wU[0].category!==
Oc.SuggestionCategory.TextRelatedImage)return!1;e=this.XFi(e,Pl.text2Image);e.isLoaded=!0;null===e||void 0===e?void 0:e.items.forEach(S=>{var ja;S.decorators=null===(ja=S.decorators)||void 0===ja?void 0:ja.map(ya=>ya.type===sn.text2Image?{...ya,imageUrl:C.baseUrl+C.wU[0].imageId,thumbnailUrl:C.baseUrl+C.wU[0].thumbnailId,altText:C.wU[0].altText}:ya)});return!0}}Object(F.a)(Ky,"AugLoopThemeProvider",Dq,[]);class Zj{constructor(e,n){this.text=e;this.role=n}}Object(F.a)(Zj,"BlankDocSentence",null,[]);
class Nz{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc){this.BYj=1;this.Rd=e;this.fq=n;this.Ee=C;this.fd=S;this.iF=ja;this.Vh=ya;this.Ujb=kb;this.hb=Rb;this.EZ=sc;this.WPa=Fc}Fbe(e){var n=Object(Jg.a)(pn.AParagraphNode,this.hb.Zm(this.WPa.vd));n=this.Bbn(n);this.Wfp(n);e&&this.fan(n)}G4j(e,n,C,S){let ja=ce.a.createTextRange(n,e,e+this.BYj);this.Rd.We(ja,C);ja=ce.a.createTextRange(n,e,e+C.length);n.o_(e);n.ra.Dh(e).hyperlink=this.iF.wF(ja,S,!0);this.EZ.AW(ja,ya=>{this.Ee.Mnd(ya,!0)})}HDe(e,n,C){let S=ce.a.createTextRange(n,
e,e+this.BYj);this.Rd.We(S,C);S=ce.a.createTextRange(n,e,e+C.length);this.EZ.AW(S,ja=>{this.Ee.HN(ja,!0)})}Bbn(e){let n=Object(Jg.a)(Ed.a,this.fd.mg(e));n.Nd();const C=new fb.a;for(let S=0;10>S;S++){const ja=Nz.Kjf[S];tl.OutlineElementNavigator.me(n);this.Vh.yy(n,!1,!1);this.Vh.dL(n);C.add(n.currentNode);const ya=ce.a.Uc(n.currentNode,0);this.Rd.We(ya,ja.text,!0,!1);this.Ujb.Uja(n.currentNode,ja.role)}n=Object(Jg.a)(Ed.a,this.fd.mg(e));n.Nd();tl.OutlineElementNavigator.me(n);n.Tg();return C}Wfp(e){let n=
0;for(const C of e)e=C.characterData.indexOf("$"),-1!==e&&(3===n?this.G4j(e,C,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentLearnMoreDesigner,Jf.a.qdl):6===n?(this.HDe(e,C,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeStylesBold),e=C.characterData.indexOf("$"),this.HDe(e,C,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentStylesBold),e=C.characterData.indexOf("$"),this.G4j(e,C,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentLearnMoreStyles,Jf.a.rdl)):7===
n?this.HDe(e,C,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeDesignerBold):9===n&&this.HDe(e,C,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeDesignerBold)),n++}fan(e){let n=0;for(;n<e.count;){var C=e.K(n);const ja=Nz.Kjf[n].role;for(;n+1<e.count&&Nz.Kjf[n+1].role==ja;)n++;var S=e.K(n);({id:C,returnValue:S}=this.fq.sqa(C.id,S.id));0===S?(C=this.fq.getById(C),C.title=Xi.i(ja),C.HL=!0,C.removeWhenEdited=!0):E.ULS.shipAssertTag(528312211,3016,!1);n++}}}Nz.Kjf=[new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentTitle,
2),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSubtitle,3),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFirstHeading,4),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFirstParagraph,13),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSecondHeading,5),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSecondParagraph,13),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentThirdParagraph,13),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFourthParagraph,
13),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentThirdHeading,5),new Zj(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFifthParagraph,13)];Object(F.a)(Nz,"BlankDocumentEditor",null,[1149]);d(422);class jJ extends Fv.a{constructor(){super();jJ.resolveInheritance();this.$$ge=this.getEnumerator}}Object(F.a)(jJ,"IntSet",Fv.a,[16,15]);d(256);d(313);var kJ=d(1709);const Eq=[pl.RoleType.Title,pl.RoleType.Subtitle,pl.RoleType.Heading1,pl.RoleType.Heading2,pl.RoleType.Heading3,
pl.RoleType.Heading4,pl.RoleType.Heading5,pl.RoleType.Heading6,pl.RoleType.Heading7,pl.RoleType.Heading8,pl.RoleType.Heading9,pl.RoleType.BodyText,pl.RoleType.ListItem],WA=[Yc.FormattingSuggestionType.FontSize,Yc.FormattingSuggestionType.FontFamily,Yc.FormattingSuggestionType.FontColor,Yc.FormattingSuggestionType.Alignment,Yc.FormattingSuggestionType.Indentation,Yc.FormattingSuggestionType.Bold,Yc.FormattingSuggestionType.RightIndentation,Yc.FormattingSuggestionType.Italic,Yc.FormattingSuggestionType.Underline,
Yc.FormattingSuggestionType.AllCaps,Yc.FormattingSuggestionType.LineSpacing,Yc.FormattingSuggestionType.BeforeSpacing,Yc.FormattingSuggestionType.AfterSpacing,Yc.FormattingSuggestionType.SpecialIndentType,Yc.FormattingSuggestionType.SpecialIndentBy];class Sx extends Dq{static mpl(e){const n=e.map(C=>C.roleType);return Eq.every(C=>n.includes(C))}static npl(e){return e.every(n=>{const C=n.suggestions.map(S=>S.type);return WA.every(S=>C.includes(S))})}}Object(F.a)(Sx,"ACurrentThemeProvider",Dq,[]);class lJ{constructor(){this.decorators=
void 0;this.fontName=null;this.fontColor=this.fontSize=0;this.underline=this.italic=this.bold=!1;this.alignment=gr.initial;this.allCaps=!1;this.rightIndent=this.leftIndent=this.afterSpacing=this.beforeSpacing=this.lineSpacing=0;this.specialIndentType=rt.initial;this.fontKerning=this.specialIndentBy=0}}Object(F.a)(lJ,"DesignerStyle",null,[]);class mJ{constructor(){this.type=Gk.theme;this.styles=this.id=this.name=null;this.decorators=void 0;this.layout=null;this.accentColor=0;this.colorLabel=this.fontLabel=
null;this.backgroundColor=void 0;this.isThemeInFavorites=this.isSimpleTheme=!1;this.collectionName=this.collectionId=null;this.IsL2Template=!1}}Object(F.a)(mJ,"DesignerTheme",null,[]);class Uq extends Sx{constructor(e){super();this.oRe=null;this.LHh=0;this.GFc=void 0;this.vi=!1;this.n0j=(n,C)=>{C.data.operationType===Vh.a.getTypeName()&&(C.data.annotation?C.data.annotation.annotationType!==kJ.ThemeExtractorAnnotation.getTypeName()?E.ULS.shipAssertTag(543745801,3016,!1):(n=C.data.annotation.content)?
n.roleCommonProperties?(n=n.roleCommonProperties,this.oRe=Uq.asi(n,!1),Sx.mpl(n)&&Sx.npl(n)&&Uq.asi(n,!0),this.LHh=wb.a.Je(),this.OHo(),this.sa.raiseEvent(Dq.CMa),E.ULS.sendTraceTag(524105094,3016,50,"theme provided")):(this.dyo(),E.ULS.sendTraceTag(524105093,3016,50,"no roleCommonProperties")):E.ULS.shipAssertTag(543745802,3016,!1):E.ULS.shipAssertTag(543745800,3016,!1))};this.JQc=e}get K5l(){return this.oRe}c9d(){return[]}Xic(){return null}G4c(){const e=new je.a(Pg.a.vh());this.oRe&&e.add(Uq.Vbi,
255);return e}G_(){return!1}she(){}initialize(){this.vi||(E.ULS.sendTraceTag(540312158,3016,50,"CurrentThemeProvider - initialize"),this.JQc.register(),this.JQc.QH(this.n0j),this.JQc.Rza(new kJ.ThemeExtractorSignal),this.vi=!0)}Wd(){this.vi&&(E.ULS.sendTraceTag(540312159,3016,50,"CurrentThemeProvider - deinitialize"),this.JQc.hK(this.n0j),this.JQc.unregister(),this.vi=!1)}TR(){return 1E3>wb.a.Je()-this.LHh}dyo(){void 0!==this.GFc&&this.GFc.reject(Error("Theme was not extracted successfully"))}OHo(){void 0!==
this.GFc&&(this.GFc.resolve(this.K5l),this.GFc=void 0)}static asi(e,n=!0){const C=new je.a(Pg.a.vh());for(var S of e)if(n||!S.isGenerated){e=new lJ;for(var ja of S.suggestions){var ya=ja.fixedValue;switch(ja.type){case Yc.FormattingSuggestionType.FontSize:e.fontSize=parseFloat(ya)/2;break;case Yc.FormattingSuggestionType.FontFamily:e.fontName=ya;break;case Yc.FormattingSuggestionType.FontColor:e.fontColor=parseInt(ya);break;case Yc.FormattingSuggestionType.Alignment:e.alignment=this.PRl(parseInt(ya));
break;case Yc.FormattingSuggestionType.Indentation:e.leftIndent=parseFloat(ya);break;case Yc.FormattingSuggestionType.Bold:e.bold="true"===ya;break;case Yc.FormattingSuggestionType.RightIndentation:e.rightIndent=parseFloat(ya);break;case Yc.FormattingSuggestionType.Italic:e.italic="true"===ya;break;case Yc.FormattingSuggestionType.Underline:e.underline="true"===ya;break;case Yc.FormattingSuggestionType.AllCaps:e.allCaps="true"===ya;break;case Yc.FormattingSuggestionType.LineSpacing:e.lineSpacing=
parseFloat(ya);break;case Yc.FormattingSuggestionType.BeforeSpacing:e.beforeSpacing=parseFloat(ya);break;case Yc.FormattingSuggestionType.AfterSpacing:e.afterSpacing=parseFloat(ya);break;case Yc.FormattingSuggestionType.SpecialIndentType:e.specialIndentType=this.Kbp(parseInt(ya));break;case Yc.FormattingSuggestionType.SpecialIndentBy:e.specialIndentBy=parseFloat(ya)}}ya=Xi.f(S.roleType);C.add(Xi.h(ya),e)}n=Object;S=n.assign;ja=new mJ;e=Uq.Vbi;ya=new Map;for(const kb of C)ya.set(kb.key,kb.value);return S.call(n,
ja,{name:e,styles:ya})}static PRl(e){switch(e){case 0:return gr.left;case 1:return gr.right;case 2:return gr.center;case 3:return gr.justify;default:return gr.left}}static Kbp(e){switch(e){case 0:return rt.firstLine;case 1:return rt.hanging;default:return rt.firstLine}}}Uq.Vbi="CurrentTheme";Object(F.a)(Uq,"CurrentThemeProvider",Sx,[]);var Ly=d(53);class ir{static fvl(e){let n;[e,C,n]=Yk.a.dae(e);e=255*e/Yk.a.T7;n=255*n/Yk.a.T7;var C=255*C/Yk.a.T7;if(240<n)return WordEditorIntl.WordEditorStrings.L_ColorWhite;
if(20>n)return WordEditorIntl.WordEditorStrings.L_ColorBlack;if(20>=C)return 170<n?WordEditorIntl.WordEditorStrings.L_ColorGray25:100<n?WordEditorIntl.WordEditorStrings.L_ColorGray50:WordEditorIntl.WordEditorStrings.L_ColorGray80;C=20<C&&75>=C?ir.Zfk:75<C&&115>=C?ir.$fk:115<C&&150>=C?ir.agk:150<C&&240>=C?ir.bgk:ir.cgk;let S=0;for(;S<C.length&&e>=C[S];)S++;if(S==C.length)E.ULS.sendTraceTag(512570762,3023,10,"Hue index out of bounds");else return n>ir.phk[S]?ir.mek[S]:n<ir.qhk[S]?ir.lek[S]:ir.nek[S]}}
ir.mek=[WordEditorIntl.WordEditorStrings.L_ColorCoral,WordEditorIntl.WordEditorStrings.L_ColorRose,WordEditorIntl.WordEditorStrings.L_ColorLightOrange,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorLightYellow,WordEditorIntl.WordEditorStrings.L_ColorLightYellow,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorLime,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,
WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorAqua,WordEditorIntl.WordEditorStrings.L_ColorSkyBlue,WordEditorIntl.WordEditorStrings.L_ColorLightTurquoise,WordEditorIntl.WordEditorStrings.L_ColorPaleBlue,WordEditorIntl.WordEditorStrings.L_ColorLightBlue,WordEditorIntl.WordEditorStrings.L_ColorIceBlue,WordEditorIntl.WordEditorStrings.L_ColorPeriwinkle,WordEditorIntl.WordEditorStrings.L_ColorLavender,WordEditorIntl.WordEditorStrings.L_ColorPink,WordEditorIntl.WordEditorStrings.L_ColorTan,
WordEditorIntl.WordEditorStrings.L_ColorRose];ir.nek=[WordEditorIntl.WordEditorStrings.L_ColorCoral,WordEditorIntl.WordEditorStrings.L_ColorRed,WordEditorIntl.WordEditorStrings.L_ColorOrange,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorGold,WordEditorIntl.WordEditorStrings.L_ColorYellow,WordEditorIntl.WordEditorStrings.L_ColorOliveGreen,WordEditorIntl.WordEditorStrings.L_ColorOliveGreen,WordEditorIntl.WordEditorStrings.L_ColorGreen,
WordEditorIntl.WordEditorStrings.L_ColorGreen,WordEditorIntl.WordEditorStrings.L_ColorBrightGreen,WordEditorIntl.WordEditorStrings.L_ColorTeal,WordEditorIntl.WordEditorStrings.L_ColorAqua,WordEditorIntl.WordEditorStrings.L_ColorTurquoise,WordEditorIntl.WordEditorStrings.L_ColorPaleBlue,WordEditorIntl.WordEditorStrings.L_ColorBlue,WordEditorIntl.WordEditorStrings.L_ColorBlueGray,WordEditorIntl.WordEditorStrings.L_ColorIndigo,WordEditorIntl.WordEditorStrings.L_ColorGalleryStandardColor10,WordEditorIntl.WordEditorStrings.L_ColorPink,
WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorRed];ir.lek=[WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkRed,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkYellow,WordEditorIntl.WordEditorStrings.L_ColorDarkYellow,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,
WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkBlue,WordEditorIntl.WordEditorStrings.L_ColorDarkBlue,WordEditorIntl.WordEditorStrings.L_ColorBlueGray,WordEditorIntl.WordEditorStrings.L_ColorIndigo,WordEditorIntl.WordEditorStrings.L_ColorDarkPurple,
WordEditorIntl.WordEditorStrings.L_ColorPlum,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkRed];ir.Zfk=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0];ir.$fk=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256];ir.agk=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256];ir.bgk=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,140,0,180,0,0,224,241,0,256];ir.cgk=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,
0,256];ir.qhk=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100];ir.phk=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165];Object(F.a)(ir,"ColorNaming",null,[]);const XA=new Map([[3044790,3044790],[5269211,5269211],[32684,32684],[15362836,8600587],[13977459,11348049],[169590,160089],[1596093,1596093]]),Hv=WordEditorIntl.WordEditorStrings.L_DesignerStyleTabularTitleDecoratorAltTextTitle,My=WordRibbonStrings.DesignerStyleCoverPageDecoratorAriaLabel,
Hk=new Map([[Sd.a.Aj("D10TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD10TIAltTextTitle,width:624,height:193}],[Sd.a.Aj("D1TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1TIAltTextTitle,width:624,height:190}],[Sd.a.Aj("D6TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD6TIAltTextTitle,width:624,height:193}],[Sd.a.Aj("D7TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD7TIAltTextTitle,width:1575,height:728}],
[Sd.a.Aj("D31TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD31TIAltTextTitle,width:1428,height:390}],[Sd.a.Aj("D3TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD3TIAltTextTitle,width:2216,height:720}],[Sd.a.Aj("D8TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TIAltTextTitle,width:1852,height:694}],[Sd.a.Aj("D2TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD2TIAltTextTitle,width:1299,height:471}],[Sd.a.Aj("D8TI1.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI1AltTextTitle,width:1661,height:785}],[Sd.a.Aj("D8TI2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI2AltTextTitle,width:1619,height:848}],[Sd.a.Aj("D8TI3a.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI3aAltTextTitle,width:1602,height:473}],[Sd.a.Aj("D8TI4a.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI4aAltTextTitle,width:1613,height:211}],[Sd.a.Aj("D8TI5.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI5AltTextTitle,width:1595,height:498}],[Sd.a.Aj("D10TI2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD10TI2AltTextTitle,width:1281,height:357}],[Sd.a.Aj("D30TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD30TIAltTextTitle,width:1377,height:315}],[Sd.a.Aj("DCL1TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageDCL1TIAltTextTitle,width:2017,height:800}],[Sd.a.Aj("DCL3TI.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageDCL3TIAltTextTitle,width:1246,height:551}],[Sd.a.Aj("D1CP1.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP1AltTextTitle,width:2112,height:1364}],[Sd.a.Aj("D1CP2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP2AltTextTitle,width:624,height:624}],[Sd.a.Aj("D1CP3.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP3AltTextTitle,width:624,height:433}],[Sd.a.Aj("D1CP4.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP4AltTextTitle,width:624,height:416}]]);var Ho=d(598),im=d(1171),at=d(363);class wj{static PSm(){wj.Db||(wj.Db=new od.ScriptSharpLegacyMap,wj.Db.add(Ee.a.font,vr.a.KJ),wj.Db.add(hb.a.$e,-1),wj.Db.add(hb.a.Ve,-1),wj.Db.add(hb.a.vf,-1),wj.Db.add(hb.a.ff,-1),wj.Db.add(hb.a.Te,-1),wj.Db.add(hb.a.d2,""),wj.Db.add(hb.a.A6,""),wj.Db.add(hb.a.zF,""),wj.Db.add(hb.a.q7,""),wj.Db.add(hb.a.C2,""),wj.Db.add(Ee.a.fontSize,vr.a.VO),wj.Db.add(Ee.a.fontColor,
Yk.a.auto),wj.Db.add(Ee.a.highlight,Yk.a.auto),wj.Db.add(Ld.a.ku,Yk.a.auto),wj.Db.add(Ee.a.RF,0),wj.Db.add(Ee.a.bold,!1),wj.Db.add(Ee.a.italic,!1),wj.Db.add(Ee.a.underline,!1),wj.Db.add(Ee.a.underlineType,vr.a.xV),wj.Db.add(Ee.a.strikethrough,!1),wj.Db.add(Ld.a.xu,!1),wj.Db.add(Ee.a.superscript,!1),wj.Db.add(Ee.a.subscript,!1),wj.Db.add(dj.a.Gfb,!1),wj.Db.add(hb.a.Jw,""),wj.Db.add(Ee.a.tE,!1),wj.Db.add(Ee.a.lba,!1),wj.Db.add(Ee.a.isHidden,!1),wj.Db.add(hb.a.$sb,!1),wj.Db.add(hb.a.gPb,0),wj.Db.add(hb.a.noProof,
!1),wj.Db.add(Gh.a.Ngj,!1),wj.Db.add(Ld.a.capitalization,0),wj.Db.add(hb.a.Sla,!1),wj.Db.add(hb.a.k8,0),wj.Db.add(hb.a.uD,0),wj.Db.add(hb.a.fua,0),wj.Db.add(hb.a.Jt,0),wj.Db.add(hb.a.WU,0),wj.Db.add(hb.a.ke,0),wj.Db.add(hb.a.Uv,0),wj.Db.add(hb.a.OCa,0),wj.Db.add(Ld.a.Xoe,0),wj.Db.add(Ld.a.Woe,0),wj.Db.add(hb.a.Uj,at.a.TCg),wj.Db.add(hb.a.ta,at.a.sWj),wj.Db.add(hb.a.ya,at.a.ya),wj.Db.add(hb.a.xa,at.a.lineSpacing),wj.Db.add(hb.a.Hga,at.a.tWf),wj.Db.add(hb.a.Gga,at.a.hWf),wj.Db.add(hb.a.M3,at.a.tWj),
wj.Db.add(hb.a.L3,at.a.rWj),wj.Db.add(Ee.a.si,0),wj.Db.add(Ee.a.Cs,0),wj.Db.add(Ld.a.Nse,!1),wj.Db.add(hb.a.Dy,null),wj.Db.add(hb.a.iC,null),wj.Db.add(hb.a.hC,null),wj.Db.add(hb.a.Jj,-1));return wj.Db}}wj.Db=null;Object(F.a)(wj,"DefaultStyle",null,[]);class vt{constructor(e,n,C,S,ja){this.Koa=e;this.xe=n;this.wbc=C;this.iNd=S;this.RPe=ja}j1l(e){return this.XOn(e)}Tdb(e){var n=Gi.a.Np();n=$o.WordSectionNavigator.instance.Zxi(n);e.layout||(e.layout={marginTop:Jf.a.sZd,marginBottom:Jf.a.sZd,marginLeft:Jf.a.sZd,
marginRight:Jf.a.sZd});n.properties.setValue(hb.a.marginTop,oi.a.lD(e.layout.marginTop));n.properties.setValue(hb.a.marginBottom,oi.a.lD(e.layout.marginBottom));n.properties.setValue(hb.a.marginLeft,oi.a.lD(e.layout.marginLeft));n.properties.setValue(hb.a.marginRight,oi.a.lD(e.layout.marginRight))}XOn(e){if(!e)return E.ULS.shipAssertTag(574755655,3016,!1),!1;let n=!0;e.type===Gk.templateTheme&&this.Tdb(e);const C=this.xe.ro();if(e.styles.has("BodyText")){var S=e.styles.get("BodyText");n=this.sej(S,
13,C)}else E.ULS.shipAssertTag(543745807,3016,!1);e.styles.forEach((ja,ya)=>{ya=Xi.g(ya);if(13!==ya&&14!==ya||14===ya&&this.Koa.Ysa())n=this.sej(ja,ya,C)});if(this.Koa.KWi())for(S=16;25>=S;S++){const ja=Xi.h(S);e.styles.has(ja)||this.hwp(S,e,C)||(n=!1)}return n}sej(e,n,C){var S;let ja=Xi.j(n),ya=C.nh(ja);!ya&&14===n&&this.Koa.Ysa()&&(E.ULS.sendTraceTag(null,3018,15,"No Caption style in the document."),ja=Xi.j(13),ya=C.nh(ja));C=2===(null===(S=this.RPe)||void 0===S?void 0:S.rVa())?vt.Wvf(e,n,!0):this.AMm(n,
e,ya);if(ya){if(this.iNd.put(ja,ya.clone().Ti()),C&&!this.wbc.ubb(Xi.j(n),C,null))return!1}else return E.ULS.shipAssertTag(571999311,3016,!1),!1;return!0}hwp(e,n,C){const S=Xi.j(e);C=C.nh(S);if(!C)return E.ULS.shipAssertTag(571012639,3016,!1),!1;const ja=new od.ScriptSharpLegacyMap;n=n.accentColor;e=Xi.c(e)?XA.has(n)?XA.get(n):0:0;ja.add(Ee.a.fontColor,0===e?Yk.a.auto:Yk.a.cha(e));this.iNd.put(S,C.clone().Ti());return this.wbc.ubb(S,ja,null)}AMm(e,n,C){e=vt.Wvf(n,e);if(C&&(C=C.Zj()))for(n=0;n<C.length;n++){const S=
C[n];if(!e.tb(S)){let ja;({value:ja}=wj.PSm().Ec(S,ja)).returnValue&&e.add(S,ja)}}return e}static Wvf(e,n,C=!1){const S=new od.ScriptSharpLegacyMap;if(e.fontName){const ja=lp(e.fontName);S.add(hb.a.d2,ja);S.add(Ee.a.font,ja)}void 0!==e.fontColor&&S.add(Ee.a.fontColor,0===e.fontColor?Yk.a.auto:Yk.a.cha(e.fontColor));void 0!==e.bold&&S.add(Ee.a.bold,e.bold);void 0!==e.italic&&S.add(Ee.a.italic,e.italic);void 0!==e.underline&&S.add(Ee.a.underline,e.underline);void 0!==e.allCaps&&S.add(Ld.a.capitalization,
e.allCaps?2:0);if(C)return S;void 0!==e.fontSize&&S.add(Ee.a.fontSize,2*e.fontSize);void 0!==e.alignment&&S.add(Ee.a.si,vt.QRl(e.alignment));void 0!==e.beforeSpacing&&S.add(hb.a.Uj,oi.a.fK(e.beforeSpacing));void 0!==e.afterSpacing&&S.add(hb.a.ta,oi.a.fK(e.afterSpacing));S.add(hb.a.ny,15===n);S.add(hb.a.Jj,Xi.a(n));e.lineSpacing&&(n=Object.assign(new Ho.a,{unit:2,value:e.lineSpacing}),({xa:n,$bk:C}=im.a.PAi(n)).returnValue?(S.add(hb.a.ya,C),S.add(hb.a.xa,n)):E.ULS.shipAssertTag(592454611,3016,!1));
switch(e.specialIndentType){case rt.firstLine:S.add(hb.a.uD,oi.a.lD(e.specialIndentBy));break;case rt.hanging:S.add(hb.a.Jt,oi.a.lD(e.specialIndentBy))}return S}static QRl(e){switch(e){case gr.left:return 1;case gr.center:return 2;case gr.right:return 3;case gr.justify:return 6;default:return E.ULS.shipAssertTag(592720768,3016,!1),null}}}Object(F.a)(vt,"StyleManager",null,[1122]);class pG{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih){this.Pb=e;this.fL=n;this.$m=C;this.Mf=
S;this.lb=ja;this.ik=ya;this.t4=kb;this.dK=Rb;this.Cg=sc;this.sn=Fc;this.fR=gd;this.Sm=td;this.FA=Bd;this.tj=wd;this.eua=te;this.Yb=Le;this.Yba=Oe;this.b2=We;this.$d=Xf;this.lXb=Gg;this.ps=Ph;this.Xs=Aj;this.jL=Ih;this.Oci=36;this.eej=20}zhf(e,n,C){var S,ja,ya,kb,Rb,sc,Fc;if(e)if(n){var gd=!0,td=null===(S=this.lb.gb)||void 0===S?void 0:S.currentSelection;e=Af.ParagraphReader.Zm(e,!0,!0);null===(ja=this.ps)||void 0===ja?void 0:ja.P_a();ja=this.Ban(e,n);null===(ya=this.ps)||void 0===ya?void 0:ya.iTa();
gd&&(gd=0<(null===ja||void 0===ja?void 0:ja.length));if(gd){C===Gk.templateTheme&&this.SQl(ja);ya=new Set;gd=new Map;for(const Bd of ja)Bd.TG&&ya.add(Bd.TG);this.rjo(ya,n,gd)?this.Pzp(ja,n,gd,C)?(this.sjo(ya,n),this.Wbo(ja,n),this.scrollIntoView(ja,C===Gk.templateTheme),C!==Gk.templateTheme&&(null===(Rb=null===(kb=null===td||void 0===td?void 0:td.Qa)||void 0===kb?void 0:kb.node)||void 0===Rb?0:Rb.isConnected)&&(null===(sc=this.ps)||void 0===sc?void 0:sc.P_a(),this.lb.Kc(td),null===(Fc=this.ps)||void 0===
Fc?void 0:Fc.iTa())):E.ULS.shipAssertTag(520937801,3016,!1):E.ULS.shipAssertTag(520937802,3016,!1)}else E.ULS.shipAssertTag(520937803,3016,!1)}else E.ULS.shipAssertTag(536941707,3016,!1);else E.ULS.shipAssertTag(536941706,3016,!1)}SQl(e){if(0<(null===e||void 0===e?void 0:e.length)){const n=e[e.length-1];!this.$m.mg(n).zb(14)&&Af.ParagraphReader.isEmpty(this.$m.mg(n))&&(this.Mf.pDa(n),e.pop())}}rjo(e,n,C){let S=void 0,ja=!0;try{S=this.FA.Lc(15,pe.a.k$a,!1);S.Rz.Ab(this.Oh);for(const ya of e)ja&&(ja=
this.FHo(ya,n,C)),dv(ya,this.ik,!1,kb=>kb.Ng),jl(ya,this.ik,My),n.widthOption===st.stretchEdgeToEdge&&(this.t4.setCellPadding(ya,1,this.Oci),this.t4.setCellPadding(ya,3,this.Oci))}finally{S&&S.dispose()}return ja}Wbo(e,n){for(const C of e)C.TG||this.fL.write(C,n)}sjo(e,n){var C;for(const S of e)n.heightOption===sf.stretchInsideMargins&&this.aam(S),e=Zs(S,[]),this.fL.write(S,n,e),(null===(C=this.jL)||void 0===C?0:C.uSd)||this.Rbo(e,S)}Rbo(e,n){const C=this.FA.Lc(15,pe.a.WZd);try{C.Rz.Ab(this.Oh),Aq(e,
n,this.Yba,sj.a.Pec)}finally{C.dispose()}}FAo(e){const n=this.FA.Lc(15,pe.a.Zcb,!1);try{n.Rz.Ab(this.Oh);var C=this.$m,S=this.Mf;const ja=C.mg(e);null!==ja&&ja.Nd()&&(ja.Tg(),C.Ayi(ja).Tk()?ja.Tg():S.dL(ja))}finally{n&&n.dispose()}}qrg(e){const n=this.FA.Lc(15,pe.a.Zcb,!1);try{n.Rz.Ab(this.Oh);Fs(e,this.$m);if(this.$d.a1i()){let C=void 0,S=void 0;const ja=Af.ParagraphReader.Kv(e,!1,!1,!1);for(let ya=ja.count-1;0<=ya;ya--){const kb=ja.K(ya);if(!Af.ParagraphReader.Wb(kb))continue;const Rb=this.Yb.GQb(kb);
C||Rb!==Xi.k(2)||Af.ParagraphReader.R3(kb)===WordEditorIntl.WordEditorStrings.L_Designer_CoverPageTitle||(C=kb,this.GLi(C,2));S||Rb!==Xi.k(3)||Af.ParagraphReader.R3(kb)===WordEditorIntl.WordEditorStrings.L_Designer_CoverPageSubtitle||(S=kb,this.GLi(S,3));if(C&&S)break}}this.t4.RW(e)}finally{n&&n.dispose()}}Jqg(e){this.fL.read(e)&&(!Ds(e,12)||null!==e&&void 0!==e&&e.TG?Ds(e,14)&&Dz(e,this.$m)&&this.qrg(e):this.FAo(e))}WEf(e){var n,C,S,ja;if(!e)return null;const ya=new Map,kb=atob(null===e||void 0===
e?void 0:e.htmlToPaste),Rb=Sq(kb);if(e.styleOverrides)for(const sc of e.styleOverrides){const Fc=Xi.f(sc.type);ya.set(Xi.h(Fc),{fontName:sc.style.fontFamily?ev(sc.style.fontFamily):void 0,fontSize:sc.style.fontSize,fontColor:sc.style.fontColor,bold:sc.style.bold,italic:sc.style.italic,underline:sc.style.underline,alignment:sc.style.alignment,lineSpacing:sc.style.lineSpacing,beforeSpacing:sc.style.beforeSpacing,afterSpacing:sc.style.afterSpacing,specialIndentType:sc.style.specialIndentType,specialIndentBy:sc.style.specialIndentBy,
fontKerning:sc.style.fontKerning,allCaps:sc.style.allCaps})}return{htmlToPaste:kb,htmlToPasteDark:Rb,imagePaths:null===(n=null===e||void 0===e?void 0:e.imagePaths)||void 0===n?void 0:n.map(sc=>Sd.a.Aj(sc)),imageThumbnailPaths:null===(C=null===e||void 0===e?void 0:e.imagePaths)||void 0===C?void 0:C.map(sc=>Sd.a.Aj("Thumbnail_"+sc)),thumbnailImage:Sd.a.Aj(null===e||void 0===e?void 0:e.thumbnailImage),widthOption:null===e||void 0===e?void 0:e.widthOption,heightOption:null===e||void 0===e?void 0:e.heightOption,
type:sn.complexDecorator,hasImages:null!==(ja=null===(S=null===e||void 0===e?void 0:e.imagePaths)||void 0===S?void 0:S.length)&&void 0!==ja?ja:!1,styleOverrides:ya}}Ibd(e){return og(e,this.fL,this.Yba,this.$m,sj.a.Pec)}Ban(e,n){var C=Af.ParagraphReader.Zm(this.Oh,!0,!0);(new Ed.a).set(C);C=this.FA.Lc(4,pe.a.LHa);try{C.Rz.Ab(this.Oh);const S=this.$m.mg(e);if(!ls(S)){E.ULS.shipAssertTag(536941711,3016,!1);return}this.Mf.yy(S,!0,!1,null,!1,!1);const ja=new Rq.a,ya=this.Yb.ro();ja.goa=ya.nh(zl.StyleReader.dBb);
const kb=this.Mf.dL(S,ja);this.lb.Kc(new Lf.Selection([ce.a.Uc(kb,0)],!0))}finally{C&&C.dispose()}return Zw(n.htmlToPaste,this.Pb,this.lb)}FHo(e,n,C){const S=Es(e);if(!S)return E.ULS.shipAssertTag(536941712,3016,!1),!1;n.heightOption===sf.stretchInsideMargins&&this.ofp(e,S);n.widthOption!==st.stretchInsideMargins&&n.widthOption!==st.stretchEdgeToEdge||this.pfp(e,S,n.widthOption===st.stretchEdgeToEdge);C.set(e,this.ANf(e));return!0}ofp(e,n){n=vg.a.hn(vg.a.Mj(n.pageHeight-n.marginTop-n.marginBottom,
1),1);const C=Pd.TableReader.PFf(e);var S=new Ed.a;S.set(e);S=Pd.TableReader.q8d(S);var ja=S.reduce((ya,kb)=>ya+kb);ja=0<ja?n/ja:void 0;if(1!==ja)for(let ya=0;ya<C.count;ya++){let kb;kb=ja?S[ya]*ja:n/Pd.TableReader.vg(e);this.ik.N_b(C.K(ya),kb-.5/Pd.TableReader.vg(e))}}pfp(e,n,C){var S=n.pageWidth;C?(e.properties.setValue(hb.a.ke,-n.marginLeft),e.properties.setValue(hb.a.Uv,-n.marginRight)):S=S-n.marginLeft-n.marginRight;C=vg.a.hn(vg.a.Mj(S,0),0);n=this.ANf(e);S=n.reduce((ja,ya)=>ja+ya);C/=S;for(S=
0;S<n.length;S++)this.ik.cva(e,S,n[S]*C)}DHo(e){var n,C,S,ja,ya=e.currentNode;if(ya&&!ya.Ng){var kb=Af.ParagraphReader.Kv(ya,!1,!1,!1);if(e=nh.getContainingTableRow(e))if(e=Ly.a.Fkc(e),0>=e)E.ULS.shipAssertTag(523551523,3016,!1);else if(this.Xs.Gd){if(ya=ya.jm(this.Xs.Gd.Ic))if(ya=vg.a.hn(ya.L4d(),1)/e,1<ya)for(const Rb of kb)if(Af.ParagraphReader.Wb(Rb)){kb=ce.a.createTextRange(Rb,0,Af.ParagraphReader.textLength(Rb));kb=Sa.FormattingReader.Vs(kb);e=null!==(ja=null===(S=null===(C=null===(n=null===
kb||void 0===kb?void 0:kb.Ib)||void 0===n?void 0:n.formatting)||void 0===C?void 0:C.cache)||void 0===S?void 0:S.fontSize)&&void 0!==ja?ja:void 0;if(void 0===e){E.ULS.shipAssertTag(523548884,3016,!1);break}e=Math.floor(e/ya);e<this.eej&&(E.ULS.sendTraceTag(523548885,3016,50,"Font size limit reached"),e=this.eej);this.tj.Cl(kb,Ee.a.fontSize,e)}}else E.ULS.shipAssertTag(509667290,3016,!1);else E.ULS.shipAssertTag(523551522,3016,!1)}}Pzp(e,n,C,S){var ja=Af.ParagraphReader.Kv(this.Oh,!1,!1,!1);const ya=
new fb.a;for(var kb of ja)e.includes(kb)||ya.add(kb);ja=this.Sm.yDi(new Set([2,3]),ya);for(const Rb of e)if(Af.ParagraphReader.Wb(Rb))if(e=Af.ParagraphReader.R3(Rb).trim(),e.startsWith("Image"))this.b2.Vef(),this.Qwp(Rb,n,C);else if(S!==Gk.templateTheme)switch(e){case "Title":e=void 0;ja.has(2)&&(e=ja.get(2).K(0));!e&&1<ya.count&&(kb=ya.K(1),this.Yb.Be(this.Yb.Cq(kb))===zl.StyleReader.dBb&&(e=kb));this.ALi(Rb,e,2,n);break;case "Subtitle":e=void 0;ja.has(3)&&(e=ja.get(3).K(0));!e&&2<ya.count&&(kb=
ya.K(2),this.Yb.Be(this.Yb.Cq(kb))===zl.StyleReader.oud&&(e=kb));this.ALi(Rb,e,3,n);break;case "Author":e=this.sn.gz.IsAnonymous?WordEditorIntl.WordEditorStrings.L_Designer_CoverPageAuthorName:this.sn.gz.Name;e.endsWith(" \ud83c\udf0e")&&(e=Array.from(e).slice(0,-2).join(""));this.oEe(Rb,e,13,n);break;case "Company":this.oEe(Rb,WordEditorIntl.WordEditorStrings.L_Designer_CoverPageCompanyName,13,n);break;case "Date":this.oEe(Rb,(new Date).toLocaleDateString(),5,n)}return!0}KEj(e,n){e=ce.a.createTextRange(e,
0,Af.ParagraphReader.textLength(e));this.Cg.We(e,n)}y9k(e,n,C){if(C.styleOverrides&&C.styleOverrides.has(Xi.h(n))){C=C.styleOverrides.get(Xi.h(n));n=vt.Wvf(C,n);C=ce.a.createTextRange(e,0,Af.ParagraphReader.textLength(e));C=Sa.FormattingReader.Vs(C);var S=new Set;S.add(Ee.a.si);S.add(hb.a.Uj);S.add(hb.a.ta);S.add(hb.a.ya);S.add(hb.a.xa);S.add(hb.a.ke);S.add(hb.a.Uv);for(const ja of n.keys)S.has(ja)?e.setValue(ja,n.K(ja)):this.tj.Cl(C,ja,n.K(ja))}}oEe(e,n,C,S){const ja=this.FA.Lc(15,pe.a.LHa);try{ja.Rz.Ab(this.Oh),
this.KEj(e,n),this.dK.Uja(e,C),this.y9k(e,C,S)}finally{ja&&ja.dispose()}}Qwp(e,n,C){var S=Af.ParagraphReader.R3(e).trim().split(" ");if(2!==S.length)E.ULS.shipAssertTag(536941713,3016,!1);else if(S=Number(S[1]),isNaN(S))E.ULS.shipAssertTag(536941714,3016,!1);else{var ja=this.FA.Lc(15,pe.a.LHa);try{ja.Rz.Ab(this.Oh),this.KEj(e,""),this.JEo(e,n.imagePaths[S],C)}finally{ja&&ja.dispose()}}}GLi(e,n){il(e,this.Mf,this.$m,this.lXb,this.Cg,this.Yb,this.dK,this.Sm);this.dK.Uja(e,n)}WFm(e){switch(e){case 2:return WordEditorIntl.WordEditorStrings.L_Designer_CoverPageTitle;
case 3:return WordEditorIntl.WordEditorStrings.L_Designer_CoverPageSubtitle;default:E.ULS.shipAssertTag(524115978,3016,!1)}}ALi(e,n,C,S){n||E.ULS.sendTraceTag(521413784,3016,50,`Using placeholder string for ${Xi.h(C)}`);this.oEe(e,n?Af.ParagraphReader.R3(n):this.WFm(C),C,S);this.$d.a1i()&&n&&(e=new Ed.a,e.set(n),ls(e),e.Tg())}JEo(e,n,C){if(e.tIa&&e.TG){var S=e.tIa;this.t4.setCellPadding(S,1,0);this.t4.setCellPadding(S,3,0);this.t4.setCellPadding(S,0,0);this.t4.setCellPadding(S,2,0);var ja=this.t4.Ft(S),
ya=new Ed.a;ya.set(e.TG);ja=Pd.TableReader.q8d(ya).slice(ja,ja+S.rowSpan).reduce((kb,Rb)=>kb+Rb,0);ya=this.t4.y4c(S);this.fR.KUf(n,e,!1,pe.a.k$a,pe.a.vbe,{xld:{T0b:2,SWh:ya,OWh:ja},altText:Hk.has(n)?Hk.get(n).altText:void 0,Aae:pe.a.K7c},()=>{this.b2.Cbg()&&this.qBp(C)});e=e.ka(Ee.a.si,2);n=this.$m.Ql();n.set(S);n.je();n.Tg();n.je();S=n.je();S.setValue(Ee.a.si,e);S.setValue(hb.a.Uv,0);S.setValue(hb.a.ke,0)}}qBp(e){for(const n of e.keys()){const C=this.ANf(n),S=e.get(n);if(C.length!==S.length){E.ULS.shipAssertTag(520644507,
3016,!1);break}for(let ja=0;ja<S.length;ja++)C[ja]!==S[ja]&&this.ik.cva(n,ja,S[ja])}}scrollIntoView(e,n){var C;e=n?e.filter(S=>""!==(null===S||void 0===S?void 0:S.characterData)):e;if(e=e.length?e[0]:void 0)this.lb.Kc(new Lf.Selection([ce.a.Uc(e,0)],!0)),null===(C=this.ps)||void 0===C?void 0:C.b4(0)}aam(e){const n=this.FA.Lc(15,pe.a.k$a,!1);try{n.Rz.Ab(e);const C=new Ed.a;C.set(e);nh.forEachCellInTable(C,S=>{this.DHo(S);return!0})}finally{n.dispose()}}get Oh(){return this.eua.value}ANf(e){const n=
new Ed.a;n.set(e);return Pd.TableReader.Laa(n)}}Object(F.a)(pG,"ComplexDecoratorEditor",null,[1144]);var mp=d(1900),wr=d(2117);class bx{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd){var te;this.bvg=[Ee.a.bold,Ee.a.fontColor,Ee.a.italic,Ee.a.strikethrough,Ld.a.xu,Ee.a.subscript,Ee.a.superscript,Ee.a.underline,dj.a.Gfb,...((null===(te=Or.a.getInstance())||void 0===te?0:te.du)?uj.ListItemReader.Iub:[])];this.Koa=e;this.cTe=n;this.zM=C;this.Ee=S;this.xv=ja;this.Jyh=ya;this.ew=kb;this.EZ=Rb;this.lg=
sc;this.$th=Fc;this.xe=gd;this.Rd=td;this.CBd=Bd;this.RPe=wd;e=this.bvg.indexOf(Ee.a.fontColor);-1<e&&this.bvg.splice(e,1)}Uja(e,n){var C,S;if(e){var ja=this.xe.ro().nh(Xi.j(n));var ya=!1;ja||14!==n||(ja=this.xe.ro().nh(Xi.j(13)),ya=!0);this.Koa.Onn()&&15===n&&!this.$th.qQb(e)&&this.$th.YBl(e);if(this.Koa.pon()){var kb=Xi.b(n)||2===n||3===n||14===n;(14!==n||14===n&&this.Koa.Ysa())&&this.ew.ZP(ja,e,!1,void 0,void 0,void 0,new mp.a(this.bvg,kb,!0,!0))}else kb=this.Jyh.pDi(e),(14!==n||14===n&&this.Koa.Ysa())&&
this.ew.ZP(ja,e,!1),this.Jyh.LSh(e,kb);14===n&&this.Koa.Ysa()&&(ya&&this.d8k(e,ja),this.Ovp(e));2===(null===(C=this.RPe)||void 0===C?void 0:C.rVa())&&e.TG&&0!==(null===(S=e.characterData)||void 0===S?void 0:S.trim().length)&&this.cam(e)}else E.ULS.shipAssertTag(592720725,3016,!1)}cam(e){var n,C=e.tIa;if(null===C||void 0===C?0:C.hasProperty(Ee.a.QG)){var S=C.getValue(Ee.a.QG);C=this.zM.Vs(ce.a.create(e));null!==(n=null===C||void 0===C?void 0:C.mo)&&void 0!==n&&n.hasProperty(Ee.a.fontColor)||(n=this.xe.Be(this.xe.Cq(e)),
n=this.xe.ro().nh(n),n=null===n||void 0===n?void 0:n.getValue(Ee.a.fontColor),1!==Yk.a.G8a(Yk.a.Jjf,Yk.a.Cmb(n))&&Yk.a.G8a(Yk.a.$Fe,1!==Yk.a.Cmb(n))&&(S=Yk.a.G8a(Yk.a.Cmb(n),Yk.a.Cmb(S)),e=this.nAm(e),S<e&&this.Ee.jka(C)))}}nAm(e){const n=e.ra?e.ra.length:0;let C=3;for(let ya=0;ya<n-1;ya++){var S=e.ra.Ub(ya);if(S.formatting){var ja=this.zM.Ug(S.formatting,Ee.a.fontSize,0);S=this.zM.Ug(S.formatting,Ee.a.bold,0);ja=18<=ja||14<=ja&&S?3:4.5;ja>C&&(C=ja)}}return C}pmb(e,n){if(e)if(n){var C=uj.ListItemReader.De?
e:this.lg.mfa(e),S=null;uj.ListItemReader.isListItem(C)&&(S=this.lg.M2(C));this.EZ.AW(this.cTe(e,0,Af.ParagraphReader.textLength(e)),ja=>{for(const ya of n)switch(ya.type){case Yc.FormattingSuggestionType.FontSize:this.pC(ja,ya.fixedValue,C,e);break;case Yc.FormattingSuggestionType.FontFamily:this.cVo(ja,ya.fixedValue,C,S,e);break;case Yc.FormattingSuggestionType.FontColor:this.hx(ja,ya.fixedValue,C,e);break;case Yc.FormattingSuggestionType.Bold:this.HN(ja,ya.fixedValue,C,e);break;case Yc.FormattingSuggestionType.Italic:this.fA(ja,
ya.fixedValue);break;case Yc.FormattingSuggestionType.Underline:this.C8(ja,ya.fixedValue);break;case Yc.FormattingSuggestionType.Indentation:case Yc.FormattingSuggestionType.RightIndentation:this.KVo(e,ya.type,ya.fixedValue);break;case Yc.FormattingSuggestionType.Alignment:this.bSo(e,ya.fixedValue);break;case Yc.FormattingSuggestionType.BeforeSpacing:this.fyb(e,ya.fixedValue);break;case Yc.FormattingSuggestionType.AfterSpacing:this.eyb(e,ya.fixedValue);break;case Yc.FormattingSuggestionType.LineSpacing:this.UE(e,
ya.fixedValue)}})}else E.ULS.shipAssertTag(592720730,3016,!1);else E.ULS.shipAssertTag(592720729,3016,!1)}pC(e,n,C,S){n=Number.parseInvariant(n);isNaN(n)?E.ULS.shipAssertTag(592527906,3016,!1):(this.Ee.pC(e,this.Ee.Uec(n)),uj.ListItemReader.isListItem(C)&&this.KWo(S,n))}hx(e,n,C,S){n=Number.parseInvariant(n);isNaN(n)?E.ULS.shipAssertTag(592527907,3016,!1):(n=Of.a.JJ(n,6),this.Ee.hx(e,n,null),uj.ListItemReader.isListItem(C)&&this.JWo(S,n))}cVo(e,n,C,S,ja){n=n.split(",");if(0<n.length){n=n[0].trim();
const ya=this.zM.Ug(e,Ee.a.font,"");Array.contains(Jf.a.Spi,ya)||(this.Ee.lha(e,n),uj.ListItemReader.isListItem(C)&&S&&!S.listType&&this.IWo(ja,n))}}HN(e,n,C,S){n=Boolean.parse(n);this.Ee.HN(e,n);uj.ListItemReader.isListItem(C)&&this.HWo(S,n)}fA(e,n){n=Boolean.parse(n);this.Ee.fA(e,n)}C8(e,n){n=Boolean.parse(n);this.Ee.C8(e,n)}KVo(e,n,C){var S=parseFloat(C);isNaN(S)?E.ULS.shipAssertTag(592454612,3016,!1):(C=this.xv.fr,S=oi.a.fK(S),n===Yc.FormattingSuggestionType.Indentation?C.KNa(e,1,S):C.oyb(e,1,
S))}static RRl(e){switch(e){case gr.left:return wr.a.Left;case gr.center:return wr.a.Center;case gr.right:return wr.a.Right;case gr.justify:return wr.a.Justified;default:return E.ULS.shipAssertTag(538240013,3016,!1),null}}bSo(e,n){n=Number.parseInvariant(n);if(isNaN(n))E.ULS.shipAssertTag(592454613,3016,!1);else{switch(n){case wr.a.Left:n=1;break;case wr.a.Right:n=3;break;case wr.a.Center:n=2;break;case wr.a.Justified:n=6;break;case wr.a.None:n=0;break;default:return}this.xv.wH(e,n)}}fyb(e,n){n=Number.parseInvariant(n);
isNaN(n)?E.ULS.shipAssertTag(574433370,3016,!1):this.xv.fyb(e,new Ho.a(4,n))}eyb(e,n){n=Number.parseInvariant(n);isNaN(n)?E.ULS.shipAssertTag(574433371,3016,!1):this.xv.eyb(e,new Ho.a(4,n))}UE(e,n){n=Number.parseInvariant(n);isNaN(n)?E.ULS.shipAssertTag(574433372,3016,!1):this.xv.UE(e,new Ho.a(2,n))}HWo(e,n){e=this.Rd.R7a(e);this.Ee.HN(e,n)}JWo(e,n){e=this.Rd.R7a(e);this.Ee.hx(e,n,null)}KWo(e,n){e=this.Rd.R7a(e);this.Ee.pC(e,n)}IWo(e,n){e=this.Rd.R7a(e);this.Ee.lha(e,n)}d8k(e,n){if(null!=e&&null!=
n){if(n.hasProperty(Ee.a.fontSize)){var C=n.getValue(Ee.a.fontSize);12<=C/2&&(C-=2)}this.pmb(e,[{type:Yc.FormattingSuggestionType.FontSize,fixedValue:C.toString()},{type:Yc.FormattingSuggestionType.Italic,fixedValue:"true"}])}}Ovp(e){var n=Af.ParagraphReader.pg(e,!0);null!=n&&this.CBd.s6h(n)?this.xv.wH(e,Af.ParagraphReader.Xy(n)):(n=Af.ParagraphReader.pg(e,!1),null!=n&&this.CBd.s6h(n)&&this.xv.wH(e,Af.ParagraphReader.Xy(n)))}}Object(F.a)(bx,"ParagraphDesigner",null,[1128]);class YA{constructor(e,
n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We){this.Pb=e;this.fL=n;this.$m=C;this.Mf=S;this.dK=ja;this.lb=ya;this.t4=kb;this.ik=Rb;this.FA=sc;this.Qc=Fc;this.ps=gd;this.Yba=td;this.b2=Bd;this.Cg=wd;this.lXb=te;this.Yb=Le;this.Sm=Oe;this.fR=We}zhf(e,n){var C,S,ja,ya;if(e)if(n){var kb=null===(C=this.lb.gb)||void 0===C?void 0:C.currentSelection;if(this.insertTable(e,n)){C=this.FA.Lc(15,pe.a.LHa);var Rb=void 0,sc=void 0;try{C.Rz.Ab(this.Qc.vd);Rb=this.xNm(e);if(!Rb)return;sc=Zs(Rb,["ParagraphPlaceholder"]);
this.oeo(e,Rb,n);jl(Rb,this.ik,Hv);this.Qvo(Rb);Aq(sc,Rb,this.Yba,sj.a.zEg)}finally{C&&C.dispose()}this.lb.Kc(new Lf.Selection([ce.a.Uc(e,0)],!0));null===(S=this.ps)||void 0===S?void 0:S.b4(0);null===(ja=this.ps)||void 0===ja?void 0:ja.P_a();this.lb.Kc(kb);null===(ya=this.ps)||void 0===ya?void 0:ya.iTa();this.fL.write(Rb,n,sc)}}else E.ULS.shipAssertTag(543737922,3016,!1);else E.ULS.shipAssertTag(543737921,3016,!1)}xNm(e){e=this.$m.mg(e);if(!ls(e))return E.ULS.shipAssertTag(527541731,3016,!1),null;
if(!e.Tk())return E.ULS.shipAssertTag(527541760,3016,!1),null;const n=e.PVa(0,C=>Ds(C,14));return Ds(e.currentNode,14)?n:null}Jqg(e,n){var C,S,ja;const ya=null===(C=this.lb.gb)||void 0===C?void 0:C.currentSelection;this.lb.Kc(null);C=this.FA.Lc(15,pe.a.Zcb);try{C.Rz.Ab(this.Qc.vd),this.qrg(e,n)}finally{C&&C.dispose()}null===(S=this.ps)||void 0===S?void 0:S.P_a();this.lb.Kc(ya);null===(ja=this.ps)||void 0===ja?void 0:ja.iTa()}qrg(e,n){var C;if(e&&n&&Dz(e,this.$m)){n=Af.ParagraphReader.Kv(e,!1,!1);
var S=void 0,ja=this.fL.read(e).ARd;for(let ya=n.count-1;0<=ya;ya--){const kb=n.K(ya),Rb=kb;if(0!==(null===(C=null===Rb||void 0===Rb?void 0:Rb.characterData)||void 0===C?void 0:C.trim().length)&&!ja.find(sc=>{var Fc,gd;return(null===(Fc=sc.id)||void 0===Fc?void 0:Fc.toString())===(null===(gd=Rb.id)||void 0===gd?void 0:gd.toString())})){if(!il(kb,this.Mf,this.$m,this.lXb,this.Cg,this.Yb,this.dK,this.Sm))return;S||(S=kb)}}Fs(null!==S&&void 0!==S?S:e,this.$m);this.t4.RW(e)}}WEf(e){if(!e)return null;
const n=Pi.HEo(atob(null===e||void 0===e?void 0:e.htmlTable)),C=Sq(n[0]);return{htmlTable:n[0],htmlTableDark:C,hasImages:n[1],fontColor:null===e||void 0===e?void 0:e.fontColor,alignment:null===e||void 0===e?void 0:e.alignment,paragraphRow:null===e||void 0===e?void 0:e.paragraphRow,paragraphCol:null===e||void 0===e?void 0:e.paragraphCol,beforeSpacing:null===e||void 0===e?void 0:e.beforeSpacing,afterSpacing:null===e||void 0===e?void 0:e.afterSpacing,type:null===e||void 0===e?void 0:e.type}}Ibd(e){return og(e,
this.fL,this.Yba,this.$m,sj.a.zEg)}insertTable(e,n){const C=this.$m.mg(e);if(!ls(C))return E.ULS.shipAssertTag(542766210,3016,!1),!1;const S=this.FA.Lc(4,pe.a.LHa);let ja;e=Af.ParagraphReader.pg(e,!1);if(Af.ParagraphReader.Wb(e)&&""===Af.ParagraphReader.R3(e))ja=e;else try{S.Rz.Ab(this.Qc.vd),this.Mf.yy(C,!1,!1),ja=this.Mf.dL(C)}finally{S&&S.dispose()}this.lb.Kc(new Lf.Selection([ce.a.Uc(ja,0)],!0));Zw(n.htmlTable,this.Pb,this.lb);return!0}oeo(e,n,C){const S=this.$m.mg(n);S.zb(8)&&(nh.moveToCellContent(S,
C.paragraphRow,C.paragraphCol),Ds(S.currentNode,11)?(S.je(),hr(e,S.currentNode,this.lXb,this.Cg,this.Yb,this.dK,this.Sm,!0),this.FKb(S.currentNode,n,C),e=this.$m.mg(e),e.zb(8)&&(e.Tg(),e.Tg())):E.ULS.shipAssertTag(524115975,3016,!1))}Qvo(e){const n=new Ed.a;n.set(e);nh.forEachCellInTable(n,C=>{if(!C.N9a(11))return!0;C.je();if(!C.N9a(12))return C.uc(),!0;C.je();const S=C.currentNode;Ds(S,12)&&this.LUf(S);C.uc();C.uc();return!0})}LUf(e){const n=Pi.s6d(e);n&&(this.b2.Vef(),Pi.ENh(n,C=>{if((null===C||
void 0===C?void 0:C.property)===Gh.a.Bu)return this.fR.mii(n,{xld:void 0,altText:Hv,Aae:pe.a.K7c}),this.b2.Cbg(),!0}))}FKb(e,n,C){this.dK.pmb(e,[{type:Yc.FormattingSuggestionType.FontColor,fixedValue:C.fontColor.toString()},{type:Yc.FormattingSuggestionType.Alignment,fixedValue:bx.RRl(C.alignment).toString()}]);const S=null!==C.beforeSpacing&&void 0!==C.beforeSpacing,ja=null!==C.afterSpacing&&void 0!==C.afterSpacing;if(S||ja){const ya=[];S&&ya.push({type:Yc.FormattingSuggestionType.BeforeSpacing,
fixedValue:C.beforeSpacing.toString()});ja&&ya.push({type:Yc.FormattingSuggestionType.AfterSpacing,fixedValue:C.afterSpacing.toString()});for(const kb of Af.ParagraphReader.Kv(n,!1,!1))kb!==e&&this.dK.pmb(kb,ya)}dv(n,this.ik,!1,ya=>ya.Ng)}}Object(F.a)(YA,"TableDecoratorEditor",null,[1144]);class yw{constructor(e,n,C,S,ja,ya,kb,Rb){this.fL=e;this.fR=n;this.FA=C;this.Qc=S;this.iua=ja;this.$m=ya;this.Yba=kb;this.b2=Rb}zhf(e,n){if(e)if(n){if(e=this.ccn(e,n))n.decoratorId=e.properties.id.Gt.toString(),
this.fL.write(e.Ib.paragraph,n)}else E.ULS.shipAssertTag(541735123,3016,!1,"Invalid decorator");else E.ULS.shipAssertTag(541735122,3016,!1,"Invalid node")}Jqg(e,n){const C=this.FA.Lc(15,pe.a.Zcb);try{C.Rz.Ab(this.Qc.vd),this.Zzo(e,n)}finally{C&&C.dispose()}}Zzo(e,n){var C,S;if(e)if(n)if(n=null===n||void 0===n?void 0:n.decoratorId){var ja=Pi.s6d(e),ya=null===(C=null===ja||void 0===ja?void 0:ja.properties)||void 0===C?void 0:C.id;null!==(S=null===ya||void 0===ya?void 0:ya.Gt)&&void 0!==S&&S.toString()&&
n===ya.Gt.toString()?this.q$k(e)?this.fR.bvc(ja,e):E.ULS.shipAssertTag(541735126,3016,!1,"Non-image and non-empty paragraphs before decorator"):E.ULS.shipAssertTag(538187611,3016,!1,"Decorator is not in its paragraph")}else E.ULS.shipAssertTag(538501596,3016,!1,"Decorator id null or undefined");else E.ULS.shipAssertTag(541735125,3016,!1,"Invalid decorator");else E.ULS.shipAssertTag(541735124,3016,!1,"Invalid node")}q$k(e){e=this.iua.gUa(e,!0,!0);do if(!this.fR.W_d(e.DA)){const n=this.$m.mg(e.DA);
if(!Af.ParagraphReader.isEmpty(n))return!1}while(e.Ala());return!0}WEf(e){return e?e.type===xl.DecoratorType.ThemeImage?{imageUrl:Sd.a.Aj(null===e||void 0===e?void 0:e.imageName),thumbnailUrl:Sd.a.Aj("Thumbnail_"+(null===e||void 0===e?void 0:e.imageName)),imageType:null===e||void 0===e?void 0:e.imageType,type:null===e||void 0===e?void 0:e.type,hasImages:!0}:{imageUrl:"",thumbnailUrl:"",imageType:null===e||void 0===e?void 0:e.imageType,type:null===e||void 0===e?void 0:e.type,hasImages:!0,altText:""}:
null}Ibd(e){const n=new cv;this.Yba.lWf(e,0,Af.ParagraphReader.textLength(e),sj.a.p0j,C=>{var S,ja;60===C&&this.fL.write(e,{decoratorId:null===(ja=null===(S=e.id)||void 0===S?void 0:S.Gt)||void 0===ja?void 0:ja.toString(),type:sn.themeImage});n.resolve()});return n}ccn(e,n){var C,S;if(null===n||void 0===n||!n.imageUrl)return E.ULS.shipAssertTag(541735129,3016,!1,"Image URL is not valid"),null;e=Af.ParagraphReader.Zm(e,!0,!0);if(!e)return E.ULS.shipAssertTag(541735130,3016,!1,"Cannot find paragraph"),
null;this.b2.Vef();n=this.fR.KUf(n.imageUrl,e,!0,pe.a.k$a,pe.a.vbe,{xld:{T0b:this.Ik(n.imageType),Ctf:this.Yvm(n)},altText:this.x_(n),Aae:pe.a.K7c},()=>{this.b2.Cbg()});if((e=null===(C=null===n||void 0===n?void 0:n.Ib)||void 0===C?void 0:C.paragraph)&&(null===(S=n.properties)||void 0===S?0:S.id))return this.Ybo(e),n;E.ULS.shipAssertTag(541735131,3016,!1,"Problem with image blob object while inserting theme image");this.b2.$ya(!0);return null}Ybo(e){const n=this.FA.Lc(15,pe.a.WZd);try{n.Rz.Ab(this.Qc.vd),
this.Yba.Gtc(e,0,Af.ParagraphReader.textLength(e),sj.a.p0j,60)}finally{n.dispose()}}Ik(e){switch(e){case Cs.BetweenLeftAndRightMargin:return 0;case Cs.BetweenLeftAndRightEdge:return 1}}Yvm(e){if(e.type===sn.text2Image)return Jf.a.MPi}x_(e){let n="";e.type===sn.text2Image?n=e.altText:Hk.has(e.imageUrl)&&(n=Hk.get(e.imageUrl).altText);return n?n:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}}Object(F.a)(yw,"ThemeImageDecoratorEditor",null,[1144]);class xr{constructor(e,n,C,S,ja,ya,kb,Rb,
sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk){this.Pb=e;this.fL=n;this.$m=C;this.Mf=S;this.dK=ja;this.lb=ya;this.t4=kb;this.fR=Rb;this.Sm=sc;this.FA=Fc;this.Qc=gd;this.ik=td;this.Cg=Bd;this.sn=wd;this.tj=te;this.iua=Le;this.eua=Oe;this.ps=We;this.Yba=Xf;this.b2=Gg;this.$d=Ph;this.lXb=Aj;this.Yb=Ih;this.Xs=Nm;this.jL=Sk}create(e){if(e){var n=Array(e.length);e.forEach((C,S)=>{switch(C){case sn.table:n[S]=new YA(this.Pb,this.fL,this.$m,this.Mf,this.dK,this.lb,this.t4,this.ik,this.FA,this.Qc,this.ps,
this.Yba,this.b2,this.Cg,this.lXb,this.Yb,this.Sm,this.fR);break;case sn.complexDecorator:n[S]=new pG(this.Pb,this.fL,this.$m,this.Mf,this.lb,this.ik,this.t4,this.dK,this.Cg,this.sn,this.fR,this.Sm,this.FA,this.tj,this.eua,this.Yb,this.Yba,this.b2,this.$d,this.lXb,this.ps,this.Xs,this.jL);break;case sn.themeImage:case sn.text2Image:n[S]=new yw(this.fL,this.fR,this.FA,this.Qc,this.iua,this.$m,this.Yba,this.b2);break;default:E.ULS.shipAssertTag(542945287,3016,!1)}});return n}E.ULS.shipAssertTag(543737925,
3016,!1)}}Object(F.a)(xr,"DecoratorEditorFactoryImpl",null,[1136]);class Oz{constructor(e,n,C,S,ja,ya,kb,Rb){var sc;this.oZd=e;this.fL=n;this.ih=C;this.$m=S;this.jL=ja;this.ujg=ya;this.FA=kb;this.eua=Rb;this.Rdg=(Fc,gd)=>{if(2===gd.data){Fc=void 0;try{Fc=this.FA.Lc(15,pe.a.Uei,!1),Fc.Rz.Ab(this.eua.value),this.fL.map.forEach((td,Bd)=>{td.ARd.forEach(wd=>{wd&&this.ujg.Gtc(wd,0,Af.ParagraphReader.textLength(wd),sj.a.Pec,70)});void 0!==Bd&&Aq(td.ARd,Bd,this.ujg,sj.a.Pec,70);Bd&&this.ujg.Gtc(Bd,0,Af.ParagraphReader.textLength(Bd),
sj.a.Pec,70)}),this.fL.clear()}finally{Fc.dispose()}}};null===(sc=this.jL)||void 0===sc?void 0:sc.xPh(this.Rdg)}ISh(e,n,C){if(!e)E.ULS.shipAssertTag(543737924,3016,!1);else if(n){var S=n.map(ja=>ja.type);this.oZd.create(S).forEach((ja,ya)=>{ja.zhf(e,n[ya],C)})}}Kyo(){this.fL.map.forEach((e,n)=>{if(null!==n&&void 0!==n&&n.isConnected){var C=this.ih.dba(),S=this.oZd.create([e.Bci.type]);1===S.length&&S[0].Jqg(n,e.Bci);C&&this.fL.remove(n)}})}zYm(){var e;return(null===(e=this.ih)||void 0===e?void 0:
e.Eka)===pe.a.Dya}vAo(){this.jL.freeze();this.ih.undo();this.jL.ltp()}async okg(e){if(e){var n=this.oZd.create([sn.themeImage,sn.table,sn.complexDecorator]),C=n[0],S=n[1];n=n[2];var ja=[];for(const ya of e)this.fL.read(ya)||(this.$m.mg(ya).zb(14)?ja.push(S.Ibd(ya)):ja.push(C.Ibd(ya)),ja.push(n.Ibd(ya)));return Promise.all(ja)}}Eri(e){if(!e)return null;const n=e.map(S=>S.type),C=[];this.oZd.create(n).forEach((S,ja)=>{C.push(S.WEf(e[ja]))});return C}}Object(F.a)(Oz,"DecoratorManagerImpl",null,[1134]);
class ro{constructor(e){this.ARd=[];this.Bci=e}kMh(e){this.ARd.push(e)}}Object(F.a)(ro,"DecoratorInfoHolder",null,[]);class Ou{constructor(){this.map=new Map}write(e,n,C){if(this.map.size>=Jf.a.UNl){E.ULS.sendTraceTag(526391136,3016,50,"Decorator storage capacity exceeded");const ja=this.map.keys();for(let ya=0;10>ya;ya++)this.map.delete(ja.next().value)}this.map.set(e,new ro(n));const S=this.map.get(e);null===C||void 0===C?void 0:C.forEach(ja=>{S.kMh(ja)})}qLp(e,n){this.map.has(e)&&this.map.get(e).kMh(n)}read(e){return this.map.has(e)?
this.map.get(e):null}remove(e){this.map.has(e)&&this.map.delete(e)}clear(){this.map.clear()}yYm(){for(const e of this.map.keys())if(null===e||void 0===e?0:e.isConnected)return!0;return!1}}Object(F.a)(Ou,"DecoratorStorageImpl",null,[1135]);class qG{constructor(e,n,C,S,ja,ya,kb=null,Rb,sc,Fc,gd){this.u8a=e;this.FA=n;this.dK=C;this.OP=S;this.Qc=ja;this.Og=ya;this.gG=kb;this.$d=Rb;this.Sm=sc;this.Yb=Fc;this.E2=gd}e8k(){return this.u8a.getAnnotations().then(e=>{let n=0,C=0;const S=this.FA.Lc(15,ha.a.i3d);
try{S.Rz.Ab(this.Qc.vd);for(const ja of e){const ya=this.kN(ja),kb=this.ceb(ja),Rb=this.nHi(ja,kb);if(kb){const sc=this.OP.Dio(this.OP.G1c(ja,ya),(Fc,gd)=>{gd.forEach(td=>{this.dK.Uja(td,Fc.role)});return!0},Rb);sc&&1!==sc&&n++}else{const sc=this.OP.mio(ja,(Fc,gd)=>{gd.forEach(td=>{this.dK.pmb(td,Fc.suggestions)});return!0},Rb);sc&&1!==sc&&C++}}}finally{S&&S.dispose()}E.ULS.sendTraceTag(538190339,3016,50,`style:${n} df:${C} of total: ${e.count}`);return n+C}).catch(e=>{E.ULS.shipAssertTag(538468955,
3016,!1,String.format("{0} {1}",e.message,e.stack));return Promise.resolve(0)})}kN(e){if(!e)return E.ULS.shipAssertTag(546137295,3016,!1),null;if(!e.content)return E.ULS.shipAssertTag(546137296,3016,!1),null;const n=e.parent;return n?n:this.u8a.getParent(e)}ceb(e,n=0){const C=this.OP.G1c(e,this.kN(e));if(!C.length)return!1;const S=this.Sm.YB(C[0]);if(!S)return!1;n=0===n?S.role:n;const ja=this.Yb.ro().nh(Xi.j(n));if(!ja)return E.ULS.sendTraceTag(538190341,3016,50,`No WAC style for role: ${n}`),!1;
var ya=e.content;if(!ya)return E.ULS.sendTraceTag(538190342,3016,50,`No formattingSuggestionsAnnotation for role: ${n}`),!1;e=new Set;let kb=!1;for(const Rb of ya.suggestions){C.forEach(sc=>{this.vtn(Rb,ja,Af.ParagraphReader.O4c(sc))||(kb=!0)});if(kb)return E.ULS.sendTraceTag(538468956,3016,50,`type: ${Rb.type} role: ${S.role}`),!1;e.add(Rb.type)}n=this.MMm();for(const Rb of n)if(!e.has(Rb)&&(n=this.nko(Rb))&&(ya=ja.getValue(n)))for(const sc of C){const Fc=this.E2.Ug(this.E2.Vs(ce.a.create(sc)),n,
null);if(ya!==Fc)return E.ULS.sendTraceTag(512522202,3016,50,`type: ${Rb} role: ${S.role}`),!1}E.ULS.sendTraceTag(538468957,3016,50,`role: ${S.role}`);return!0}getPropertyValue(e,n,C,S){return(n=n.getValue(e))?n:C?(e=C.getValue(e))?e:S:S}vtn(e,n,C){switch(e.type){case Yc.FormattingSuggestionType.FontSize:return Number.parseInvariant(e.fixedValue)===this.getPropertyValue(Ee.a.fontSize,n,C,vr.a.VO);case Yc.FormattingSuggestionType.FontFamily:return e.fixedValue===this.getPropertyValue(Ee.a.font,n,C,
"");case Yc.FormattingSuggestionType.FontColor:return Number.parseInvariant(e.fixedValue)===this.getPropertyValue(Ee.a.fontColor,n,C,Yk.a.auto);case Yc.FormattingSuggestionType.Bold:return Boolean.parse(e.fixedValue)===this.getPropertyValue(Ee.a.bold,n,C,!1);case Yc.FormattingSuggestionType.Italic:return Boolean.parse(e.fixedValue)===this.getPropertyValue(Ee.a.italic,n,C,!1);case Yc.FormattingSuggestionType.Underline:return Boolean.parse(e.fixedValue)===this.getPropertyValue(Ee.a.underline,n,C,!1);
case Yc.FormattingSuggestionType.LineSpacing:return this.snn(n,C,e.fixedValue);case Yc.FormattingSuggestionType.BeforeSpacing:return this.getPropertyValue(hb.a.Uj,n,C,0)===oi.a.fK(Number.parseInvariant(e.fixedValue));case Yc.FormattingSuggestionType.AfterSpacing:return this.getPropertyValue(hb.a.ta,n,C,0)===oi.a.fK(Number.parseInvariant(e.fixedValue));case Yc.FormattingSuggestionType.Indentation:return parseFloat(e.fixedValue)===this.getPropertyValue(hb.a.ke,n,C,0);case Yc.FormattingSuggestionType.RightIndentation:return parseFloat(e.fixedValue)===
this.getPropertyValue(hb.a.Uv,n,C,0);case Yc.FormattingSuggestionType.Alignment:return this.Ven(n,C,e.fixedValue)}return!1}Ven(e,n,C){C=Number.parseInvariant(C);if(isNaN(C))return!0;e=this.getPropertyValue(Ee.a.si,e,n,1);switch(C){case wr.a.Left:return 1===e;case wr.a.Right:return 3===e;case wr.a.Center:return 2===e;case wr.a.Justified:return 6===e}return!0}snn(e,n,C){const S=this.getPropertyValue(hb.a.ya,e,n,void 0);e=this.getPropertyValue(hb.a.xa,e,n,0)/(0===S?240:20);return Number.parseFloat(C)===
e}MMm(){return[Yc.FormattingSuggestionType.FontSize,Yc.FormattingSuggestionType.FontFamily,Yc.FormattingSuggestionType.FontColor,Yc.FormattingSuggestionType.Bold,Yc.FormattingSuggestionType.Italic,Yc.FormattingSuggestionType.Underline,Yc.FormattingSuggestionType.LineSpacing,Yc.FormattingSuggestionType.BeforeSpacing,Yc.FormattingSuggestionType.AfterSpacing,Yc.FormattingSuggestionType.Indentation,Yc.FormattingSuggestionType.RightIndentation,Yc.FormattingSuggestionType.Alignment]}nko(e){switch(e){case Yc.FormattingSuggestionType.FontSize:return Ee.a.fontSize;
case Yc.FormattingSuggestionType.FontFamily:return Ee.a.font;case Yc.FormattingSuggestionType.FontColor:return Ee.a.fontColor;case Yc.FormattingSuggestionType.Bold:return Ee.a.bold;case Yc.FormattingSuggestionType.Italic:return Ee.a.italic;case Yc.FormattingSuggestionType.Underline:return Ee.a.underline;case Yc.FormattingSuggestionType.LineSpacing:return hb.a.xa;case Yc.FormattingSuggestionType.BeforeSpacing:return hb.a.Uj;case Yc.FormattingSuggestionType.AfterSpacing:return hb.a.ta;case Yc.FormattingSuggestionType.Indentation:return hb.a.ke;
case Yc.FormattingSuggestionType.RightIndentation:return hb.a.Uv;case Yc.FormattingSuggestionType.Alignment:return Ee.a.si;default:E.ULS.shipAssertTag(512522201,3016,!1,`type: ${e}`)}}t9k(e,n){let C=0,S=0;const ja=this.FA.Lc(15,pe.a.hDa);try{ja.Rz.Ab(this.Qc.vd),e.forEach((ya,kb)=>{if(this.ceb(kb,ya.aIj.role))this.dK.Uja(this.kN(kb),ya.aIj.role),C++;else{const Rb=kb.content;Rb&&(this.dK.pmb(n?n[ya.Sig]:this.kN(kb),Rb.suggestions),S++)}})}finally{ja&&ja.dispose()}E.ULS.sendTraceTag(524170564,3016,
50,`style:${C} df:${S} of total: ${e.size}`);return C+S}x5l(e){let n=0;for(const C of e.suggestions)n+=Math.pow(2,C.type);return n}nHi(e,n){const C=this.kN(e);if(!C)return[];const S=this.Sm.YB(C);return S?(e=e.content)?[Object.assign(new kh.a,{name:"formatTypes",int64:this.x5l(e)}),Object.assign(new kh.a,{name:"role",int64:S.role}),Object.assign(new kh.a,{name:"textLength",int64:C.kY.length}),Object.assign(new kh.a,{name:"useStyles",bool:n})]:[]:[]}z0m(e){this.OP.K0m(e)}P7o(e,n){const C=this.ceb(n),
S=this.nHi(n,C);if(C)this.OP.Uye(new ve.b(new Sc.c(Wc.a.create(),this.gG,this.$d,!0,S),this.OP.G1c(n,e),0,this.Og.textLength(e),(ja,ya)=>{ya.forEach(kb=>{this.dK.Uja(kb,ja.role)});return!0}));else{const ja=n.content;ja&&this.OP.Uye(new ve.b(new Sc.c(Wc.a.create(),this.gG,this.$d,!0,S),this.OP.G1c(n,e),0,this.Og.textLength(e),(ya,kb)=>{kb.forEach(Rb=>{this.dK.pmb(Rb,ja.suggestions)});return!0}))}}}Object(F.a)(qG,"DocumentConsistencyManager",null,[1131]);var CC=d(1436);class Ny{constructor(e){this.gEd=
void 0;this.vi=!1;this.Jvb=(n,C)=>{n=C.data.operationType;n!==Vh.a.getTypeName()&&n!==CC.a.getTypeName()||this.update(C.data.annotation)};this.ifh=e;this.sa=new eb.a}G0k(e){this.sa.addHandler(Ny.Gxf,e)}tDj(e){this.sa.removeHandler(Ny.Gxf,e)}get T8c(){return this.gEd}set T8c(e){this.gEd!==e&&(this.gEd=e,this.sa.raiseEvent(Ny.Gxf,new ki.a(this.gEd)))}initialize(){this.vi||(this.ifh.QH(this.Jvb),this.vi=!0)}Wd(){this.vi&&(this.ifh.hK(this.Jvb),this.vi=!1)}update(e){this.T8c=e.content.supportedLanguagesCoverage>
Jf.a.fZj}}Ny.Gxf="DocumentContentLanguageSupportChangedEventKey";Object(F.a)(Ny,"DocumentLanguageManager",null,[1130,506]);var nJ=d(328),Iv=d(351);class Tx{constructor(e,n,C,S,ja,ya){this.Cg=e;this.Kl=n;this.Pd=C;this.Sm=S;this.jC=ja;this.N3=ya;this.m3f=new If.a}YBl(e){var n=this.Sm.YB(e);if(null==n.Fcd)E.ULS.shipAssertTag(556323523,3016,!1,"ListId not set in manual list item state!");else{var C=n.Fcd,S=n.Fcd,ja=n.listItemPrefix,ya=!1;this.m3f.tb(S)?C=this.m3f.get(S):ya=!0;var kb=this.Sm.Kzm(S);if(kb)if(kb.levelInfos&&
kb.levelInfos.length){null==n.Eie&&E.ULS.shipAssertTag(556323526,3016,!1,"Manual List Item level is not set!");kb.fontFamily||E.ULS.shipAssertTag(556323527,3016,!1,"Font family not set for manual list item!");var Rb=kb.fontFamily||vr.a.KJ,sc=n.Eie||0,Fc=Tx.dKf(kb,sc);n=Tx.fzm(kb,sc);var gd=Tx.oym(kb,sc);if(42===n)E.ULS.shipAssertTag(556323528,3016,!1,"Cannot map ListStyle!");else{C=this.uHl(C,Rb,sc,Fc,n,gd);if(ja)this.jAo(e,ja);else if(kb.listType===wr.e.Numbered){E.ULS.shipAssertTag(556323529,3016,
!1,"No list prefix detected!");return}ja=new Ed.a;kb=new kf.DictionaryPropertySet;this.Sfo(e,n,ja,kb);n=this.jC.fX(e);this.W7k(C,ja,kb,ya);this.N3.KNa(e,n.unit,n.value);e=this.qQb(e);null!=e?this.m3f.W(S,e):E.ULS.shipAssertTag(556323530,3016,!1,"Didn't get list id of converted list!")}}else E.ULS.shipAssertTag(556323525,3016,!1,"No level infos in manual list info!");else E.ULS.shipAssertTag(556323524,3016,!1,"Cannot find manual list info!")}}qQb(e){if(uj.ListItemReader.De)return uj.ListItemReader.isListItem(e)?
uj.ListItemReader.Jr(e).listId:null;e=this.Pd.mfa(e);return(null===e||void 0===e?0:e.hasProperty(hb.a.listID))?e.getValue(hb.a.listID):null}W7k(e,n,C,S){this.Kl.Bqa(C,n,e,S)}jAo(e,n){if(n)try{const C=ce.a.createTextRange(e,0,Tx.qGm(n,e.characterData));this.Cg.We(C,"")}catch(C){E.ULS.shipAssertTag(556074240,3016,!0,`Remove list prefix failed! error ${C}`)}}Sfo(e,n,C,S){C.set(e);C.zb(11)&&C.kd(11);C.set(C.currentNode);Ge.a.Ou(C);S.setValue(Gh.a.JL,0);S.setValue(Gh.a.cC,6===n?1:0);S.setValue(hb.a.at,
nJ.a.hae)}uHl(e,n,C,S,ja,ya){e=Iv.a.OW(6===ja?1:0,ja,null,e,C,S,n);ya&&(e.yD=ya);return e}static fzm(e,n){switch(Tx.zCm(e,n)){case "decimal":return 1;case "lowerLetter":return 2;case "lowerRoman":return 3;case "upperLetter":return 4;case "upperRoman":return 5;case "bullet":return 6;default:return 42}}static zCm(e,n){for(let C=0;C<e.levelInfos.length;C++){const S=e.levelInfos[C];if(S.level===n)return S.numberFormat||e.listType!==wr.e.Numbered?e.levelInfos[C].numberFormat:"decimal"}E.ULS.shipAssertTag(556323531,
3016,!1,"No number format for given level!");return null}static dKf(e,n){for(let C=0;C<e.levelInfos.length;C++){const S=e.levelInfos[C];if(S.level===n)return S.levelText||e.listType!==wr.e.Numbered?S.levelText:"%1."}E.ULS.shipAssertTag(556323532,3016,!1,"No level text for given level!");return null}static oym(e,n){for(let C=0;C<e.levelInfos.length;C++){const S=e.levelInfos[C];if(S.level===n)return S.startAt}E.ULS.shipAssertTag(556323533,3016,!1,"No StartAt value for given level!");return null}static qGm(e,
n){var C=n.indexOf(e);if(-1==C)return E.ULS.shipAssertTag(556074241,3016,!1,"Prefix not found in paragraph text!"),0;e=C+e.length;for(C=0;e+C<=n.length&&" "==n.charAt(e+C);)C++;return e+C}}Object(F.a)(Tx,"ManualListConverter",null,[1129]);class sE extends Dq{constructor(e){super();this.kij=e;this.Imd=10;this.activeSection=this.qgc=this.Rw=null;this.isInitialized=!1}c9d(){return this.Rw}G4c(){return this.qgc}Xic(){return this.activeSection}G_(e){var n;const C=null===(n=this.Rw)||void 0===n?void 0:
n.find(S=>S.id.equals(e));return C&&C.G_}she(e,n){const C=e?this.Rw.find(S=>S.id.equals(e)):void 0;C&&this.kij.V6i(G.AFrameworkApplication.uiCulture,e.toString(),this.Imd,C.items.length).then(S=>{var ja;if(S&&0!==S.length){for(const ya of S)C.items.push({type:Gk.officeTemplate,name:ya.Id,templateId:ya.Id,previewImageUrl:ya.ThumbnailUrl,binaryUrl:ya.BinaryUrl,isPortraitOriented:null!==(ja=ya.IsPortraitLayout)&&void 0!==ja?ja:!0,isPremium:ya.IsPremium,collectionId:C.id.toString(),collectionName:C.displayName,
isL2Template:n});C.G_=0===C.items.length%this.Imd;C.G_&&(this.sa.raiseEvent(Dq.CMa),this.she(C.id))}else C.G_=!1;this.sa.raiseEvent(Dq.CMa)}).catch(()=>{C.G_=!1;this.sa.raiseEvent(Dq.CMa)});Promise.resolve()}d7i(){var e;this.kij.V6i(G.AFrameworkApplication.uiCulture,null,this.Imd,null===(e=this.Rw)||void 0===e?void 0:e.length).then(n=>{var C;this.qgc=new je.a(Pg.a.vh());let S=new Map,ja=new Map;for(let ya of n)S.has(ya.CollectionId)||(S.set(ya.CollectionId,[]),ja.set(ya.CollectionId,ya.CollectionDisplayName)),
S.get(ya.CollectionId).push({type:Gk.officeTemplate,name:ya.Id,templateId:ya.Id,previewImageUrl:ya.ThumbnailUrl,binaryUrl:ya.BinaryUrl,isPortraitOriented:null!==(C=ya.IsPortraitLayout)&&void 0!==C?C:!0,isPremium:ya.IsPremium,collectionId:ya.CollectionId,collectionName:ya.CollectionDisplayName,isL2Template:ya.IsL2Template});for(let ya of S.keys())this.Rw.push({label:Pl.none,labelDisplayName:ja.get(ya),id:new Jy(Pl.none,ya),displayName:ja.get(ya),items:S.get(ya),isLoaded:!0,G_:0<S.get(ya).length&&0===
S.get(ya).length%this.Imd});0===this.Rw.length%this.Imd&&(this.sa.raiseEvent(Dq.CMa),this.d7i());this.sa.raiseEvent(Dq.CMa)}).catch(n=>{E.ULS.shipAssertTag(509693954,3016,!1,`Office templates retrieval error: ${n}`)});Promise.resolve()}initialize(){this.isInitialized||(this.Rw=[],this.d7i(),this.isInitialized=!0)}Wd(){}}Object(F.a)(sE,"OfficeTemplatesThemeProvider",Dq,[]);var tE=d(923);class Ux{constructor(e=null,n=null){this.fz=e;this.wkp=n}}Object(F.a)(Ux,"ParagraphFormattingSnapshot",null,[]);
class cx{constructor(e,n){this.formatting=e;this.Bmg=n}}Object(F.a)(cx,"FormattingPropertyDefinitionPair",null,[]);class ZA{constructor(e,n){this._fontColor=this.fRc=this._formatting=0;this.bZ=null;this.vu=e;this.jDl=n}cwc(e,n){if(!e)return E.ULS.shipAssertTag(592307426,3016,!1),!1;this._formatting=0;for(const C of ZA.Kih)n.Ug(e,C.Bmg,!1)&&(this.bNh(C.formatting),64===C.formatting&&(this.fRc=n.Ug(e,Ee.a.underlineType,vr.a.wAb)),256===C.formatting&&(this._fontColor=n.Ug(e,Ee.a.fontColor,Yk.a.auto)));
e=n.Ug(e,Ee.a.font,"");Nj.a.contains(Jf.a.Spi,e)&&(this.bNh(128),this.bZ=e);return!!this._formatting}TZa(e,n){if(!e)E.ULS.shipAssertTag(592307427,3016,!1);else if(!n)E.ULS.shipAssertTag(592307456,3016,!1);else if(this._formatting){for(const C of ZA.Kih)if(this.xUi(C.formatting))switch(C.formatting){case 1:n.HN(e,!0);break;case 8:n.Owe(e,!0);break;case 256:n.hx(e,Of.a.JJ(this._fontColor,6),null);break;case 2:n.fA(e,!0);break;case 4:n.una(e,!0);break;case 16:n.NNa(e,!0);break;case 32:n.hva(e,!0);break;
case 64:n.sha(e,this.fRc)}this.xUi(128)&&n.lha(e,this.bZ)}}bNh(e){this._formatting|=e}xUi(e){return(this._formatting&e)===e}}ZA.Kih=[new cx(1,Ee.a.bold),new cx(256,Ee.a.fontColor),new cx(2,Ee.a.italic),new cx(4,Ee.a.strikethrough),new cx(8,Ld.a.xu),new cx(16,Ee.a.subscript),new cx(32,Ee.a.superscript),new cx(64,Ee.a.underline)];Object(F.a)(ZA,"TextRunFormattingSnapshot",null,[]);class rG{get Ds(){return null!=this.D0g?this.D0g:this.D0g=Or.a.getInstance()}constructor(e,n,C,S,ja,ya,kb){this.zTm=e;this.E2=
n;this.tj=C;this.Pd=S;this.g8=ja;this.ED=ya;this.CI=kb}LSh(e,n){if(e)if(n){var C=n.fz;if(n=n.wkp){for(const S of n)this.ED.AW(this.zTm(e,S.vu,S.jDl),ja=>{S.TZa(ja,this.tj)});if(C){if(!this.Ds.Ht&&(n=new Ed.a,n.set(e),n.Nd())){n.uc();const S=new tE.a;n.Wf(S,4);n.Yj(S);S.setValue(hb.a.listID,C.listId);S.setValue(hb.a.listLevel,C.listLevel)}this.Ds.du&&this.CI.A_b(e,C.listId,C.listLevel)}}else E.ULS.shipAssertTag(590754180,3016,!1)}else E.ULS.shipAssertTag(590754179,3016,!1);else E.ULS.shipAssertTag(590754178,
3016,!1)}pDi(e){if(!e)return E.ULS.shipAssertTag(590754181,3016,!1),null;const n=new fb.a;for(var C=0;C<e.ra.length-1;C++){const S=e.ra.Ub(C);if(!S.formatting)continue;const ja=new ZA(S.cp,e.ra.Ub(C+1).cp);ja.cwc(S.formatting,this.E2)&&n.add(ja)}C=null;e=this.g8.Pm(e);uj.ListItemReader.Fg(e)&&(uj.ListItemReader.De?C=uj.ListItemReader.nla(e):(C=new Ed.a,C.set(e),this.Pd.TVb(C),C=this.Pd.z_(C.currentNode,!1,!1)));return new Ux(C,n)}}Object(F.a)(rG,"ParagraphFormattingSnapshotManager",null,[1127]);var Fq=
d(414),uE=d(1125),nu=d(1732),kL=d(1649);class Po{static QSm(){Po.Oxb||(Po.Oxb=new od.ScriptSharpLegacyMap,Po.Oxb.add(0,{indent:.3,vqd:(e,n,C)=>{const S=e.length+1,ja=Po.$vc,ya=Po.awc;n=Po.RWc(n);const kb=n+66148;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${kb},"w":${C}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":20,"g":107,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":53734,"w":${C}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":0,"g":0,"r":0}}},"fontFamily":"${ja}","fontSize":${ya}},"length":${S}}],"paraFormatRunArray":[{"length":${S},"paragraphFormat":{"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":164030,"y":82747},"rot":0,"size":{"h":${n},"w":${C-
295364}}}},"wordGc2Type":13000}]}`}}),Po.Oxb.add(1,{indent:.9,vqd:(e,n,C)=>{const S=e.length+1,ja=Po.$vc,ya=Po.awc;n=Po.RWc(n);const kb=n+777476,Rb=n+587852,sc=C-119350,Fc=C-1540438,gd=n+59675,td=C-453325;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${kb},"w":${C}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":249996,"y":143249},"rot":0,"size":{"h":${Rb},"w":${sc}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"fontFamily":"${ja}","fontSize":${ya}},"length":${S}}],"paraFormatRunArray":[{"length":${S},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":837024,"y":430397},"rot":0,"size":{"h":${n},"w":${Fc}}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":1}}},"lineDash":0,"weight":42863},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":112627,"y":0},"rot":0,"size":{"h":${Rb},"w":${sc}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":304366,"y":220893},"rot":0,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":2,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":${td},"y":${gd}},"rot":10800000,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${kb},"w":${C}}}}`}}),
Po.Oxb.add(2,{indent:.7,vqd:(e,n,C)=>{const S=e.length+1,ja=Po.$vc,ya=Po.awc;n=Po.RWc(n);const kb=n+80835,Rb=C-999962,sc=n+444908,Fc=n+66148,gd=n+66148,td=13350-Math.round(gd/2),Bd=142329+Math.round(gd/2),wd=C-1134575,te=C-727217,Le=n+190818,Oe=C-Math.round(gd/2);n-=77606;const We=C-1149386;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":246,"g":239,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":157851},"rot":10800000,"size":{"h":${Fc},"w":${C}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"${ja}","fontSize":${ya}},"length":${S}}],"paraFormatRunArray":[{"length":${S},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":443019,"y":244229},"rot":0,"size":{"h":${kb},"w":${Rb}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":8939,"y":159883},"rot":0,"size":{"h":37400,"w":671031}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${td},"y":${Bd}},"rot":5400000,"size":{"h":34645,"w":${gd}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":25828,"y":${Le}},"rot":0,"size":{"h":34537,"w":${wd}}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${te},"y":${Le}},"rot":0,"size":{"h":34537,"w":729926}}},"wordGc2Type":13000},{"id":9,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Oe},"y":${Bd}},"rot":5400000,"size":{"h":34645,"w":${gd}}}},"wordGc2Type":13000},{"id":10,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":1149133,"y":159846},"rot":0,"size":{"h":37400,"w":${wd}}}},"wordGc2Type":13000},{"id":11,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${We},"y":${n}},"rot":0,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000},{"id":12,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":681162,"y":0},"rot":10800000,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${sc},"w":${C}}}}`}}),
Po.Oxb.add(3,{indent:1,vqd:(e,n,C)=>{const S=e.length+1,ja=Po.$vc,ya=Po.awc;n=Po.RWc(n);const kb=C-1518499,Rb=n+392522,sc=n,Fc=n-316115,gd=C/2-256447;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":158},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${gd},"y":${Fc}},"rot":2700000,"size":{"h":512895,"w":512895}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":25},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${sc},"w":${C}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":168,"g":101,"r":56}}},"fontFamily":"${ja}","fontSize":${ya}},"length":${S}}],"paraFormatRunArray":[{"length":${S},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":726947,"y":71168},"rot":0,"size":{"h":${n},"w":${kb}}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${Rb},"w":${C}}}}`}}),
Po.Oxb.add(4,{indent:.3,vqd:(e,n,C)=>{const S=e.length+1,ja=Po.$vc,ya=Po.awc;n=Po.RWc(n);const kb=n+125516,Rb=C-120310,sc=C-427001,Fc=n;C-=244619;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${kb},"w":${Rb}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fontFamily":"${ja}","fontSize":${ya}},"length":${S}}],"paraFormatRunArray":[{"length":${S},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":101388,"y":81834},"rot":0,"size":{"h":${n},"w":${sc}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":${Fc}},"rot":0,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${C},"y":0},"rot":10800000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":5400000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${C},"y":${Fc}},"rot":16200000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000}]}`}}));
return Po.Oxb}static RWc(e){return vg.a.cZa(e,0)*oi.a.lhc+Po.sLo}}Po.Oxb=null;Po.$vc="Calibri";Po.awc=1400;Po.sLo=256E3;Object(F.a)(Po,"PullQuoteStyles",null,[]);class kq{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe){this.HR=e;this.ZZ=n;this.ih=C;this.J=S;this.UTm=ja;this.T4m=ya;this.lb=kb;this.rc=Rb;this.Cg=sc;this.ED=Fc;this.tj=gd;this.logger=td;this.Mf=Bd;this.Qc=wd;this.eWa=te;this.Pjf=Le;this.Yb=Oe;this.range=window.self.document.createRange()}PNh(e,n){var C;if(e)if(({value:Rb}=
Po.QSm().Ec(e.Hcb,Rb)).returnValue){var S=this.tJl(e);if(S){var ja=$o.WordSectionNavigator.instance.NU(S),ya=ja?oi.a.iJg(zq.a.instance.gN(ja)):kq.SIj,kb=ja?oi.a.iJg(zq.a.instance.hN(ja)):kq.SIj;ja=(ja?oi.a.iJg(zq.a.instance.Jv(ja)):kq.nLo)-ya-kb;ya=this.pvm(S,Rb.indent);kb=Rb.vqd(e.jid,ya,ja);var Rb=new uq.a(this.Qc);this.lb.Kc(Uk.SelectionFactory.Er(S));S=new nu.a(Rb,this.eWa,!0,this.HR,this.J,Object(sd.a)());S=new kL.a(S,kb,this.ZZ,this.ih,n,Rg.a.instance,!1,null,this.HR,this.T4m,ja/kq.oLo,ya+kq.qLo,
this.J,this.Pjf,this.rc,!1,[]);S.n_o(e.callback);S.zUo(sc=>{E.ULS.shipAssertTag(545271898,3016,!1,"PullQuote failed to create, error message: {0}",sc)});this.UTm.vwg(S,Rb,!1,n);return null===(C=Rb.Lk)||void 0===C?void 0:C.node}E.ULS.shipAssertTag(555034258,3016,!1,"Unsuccessful node creation")}else E.ULS.shipAssertTag(555034257,3016,!1,String.format("Non existing styleId: {0}",e.Hcb));else E.ULS.shipAssertTag(555034256,3016,!1,"No PullQuoteData")}pvm(e,n){this.ED.AW(ce.a.createTextRange(e,0,Af.ParagraphReader.textLength(e)),
S=>{this.tj.pC(S,Po.awc/100*2);this.tj.lha(S,Po.$vc)});Re.a.n9a.KNa(e,1,oi.a.lD(n));Re.a.n9a.oyb(e,1,oi.a.lD(n));this.Qc.Ffb();n=0;try{var C=e.jm(this.Qc.Ic);const S=Fq.a.tza(C,void 0,!1,!1),ja=uE.a.V9h(S.ZI,this.logger).NO;for(C=0;C<ja.jo.count-1;C++){const ya=ja.N8a(C);this.range.setStart(ya.htmlElement,0);this.range.setEnd(ya.htmlElement,ya.htmlElement.textContent.length);const kb=this.range.getBoundingClientRect();n+=kb.height}}catch(S){n=kq.pLo,E.ULS.shipAssertTag(555034259,3016,!1,"Couldn't calculate pull quote text height. Exception: {0}",
String.format("{0} {1}",S.message,S.stack))}finally{return this.ED.AW(ce.a.createTextRange(e,0,Af.ParagraphReader.textLength(e)),S=>{this.tj.pC(S,22)}),Re.a.n9a.KNa(e,1,oi.a.lD(0)),Re.a.n9a.oyb(e,1,oi.a.lD(0)),n}}tJl(e){var n=new Ed.a;n.set(e.paragraphNode);if(!n.Nd())return null;tl.OutlineElementNavigator.me(n);this.Mf.yy(n,!0,!1,void 0,void 0,!1);var C=new Rq.a;const S=this.Yb.IF(e.paragraphNode);S&&(C.goa=S.nh(zl.StyleReader.c3b));if(n=this.Mf.dL(n,C))C=ce.a.Uc(n,0),this.Cg.We(C,e.jid,!0,!1);return n}aol(e,
n,C,S){if(e)if(n)if(C){if(e=this.PBj(e))return n=new ve.c(n,e,n.Hcb,n.jid,C),this.PNh(n,S);E.ULS.shipAssertTag(554443525,3016,!1,"No next node with pull quote")}else E.ULS.shipAssertTag(554443524,3016,!1,"No PullQuote success callback");else E.ULS.shipAssertTag(554443523,3016,!1,"No PullQuoteSuggestion");else E.ULS.shipAssertTag(554443522,3016,!1,"No PullQuoteNode")}PBj(e){if(e){var n=this.PBm(e);this.Mf.pDa(e);n&&this.lb.Kc(Ge.a.vk(Uk.SelectionFactory.Uo(ce.a.create(n)),!1,!1));return n}E.ULS.shipAssertTag(554443526,
3016,!1,"No PullQuoteNode")}PBm(e){if(!e)return null;const n=new Ed.a;n.set(e);n.Nd();n.uc();return n.Tk()?n.currentNode:null}}kq.oLo=9509.76;kq.qLo=50;kq.pLo=39;kq.SIj=914400;kq.nLo=7772400;Object(F.a)(kq,"PullQuotesDesignerImpl",null,[1125]);class DC{constructor(e,n,C,S){this.FA=e;this.Sqe=n;this.OP=C;this.Qc=S}oSd(e){const n=this.FA.Lc(15,ha.a.oSd,!1),C=Tj.a.create();try{n.Rz.Ab(this.Qc.vd);let S=!0;for(const ja of e)n.Rz.QLa(C,1),S=this.OP.Evj(ja,ya=>({role:27,paragraphNode:this.Sqe.PNh(ya,C),
placeholder:!0}))&&S;return S}catch(S){return E.ULS.shipAssertTag(555034255,3016,!1,String.format("Applying pull quotes failed. Exception: {0} {1}",S.message,S.stack)),!1}finally{n&&n.dispose()}}}Object(F.a)(DC,"PullQuotesManagerImpl",null,[1126]);class sG{constructor(e,n,C){this.Yo=e;this.ih=n;this.Gw=C;this.dialog=null;this.E$a=!1;this.$ya=S=>{1==S&&this.cwj(!0);this.E$a=!1}}revertTheme(){return this.ih.V2?this.ih.dba()?this.cwj():(this.openDialog(),!1):(E.ULS.shipAssertTag(539829795,3016,!1),!1)}cwj(e=
!1){var n=this.Gw;if(null===n||void 0===n||!n.vd)return E.ULS.shipAssertTag(539808770,3016,!1),!1;const C=this.Yo.Lc(7,ha.a.kug);C.Ab(n.vd);n=!0;try{for(;n&&this.ih.V2&&!this.ih.dba();)n=this.ih.undo();n&&this.ih.V2&&this.ih.dba()?n=this.ih.undo():(E.ULS.shipAssertTag(539829824,3016,!1,String.format("Has undo entries:{0}",this.ih.V2)),n=!1)}finally{return null===C||void 0===C?void 0:C.dispose(),e=Object.assign(new kh.a,{name:"DialogShown",bool:e}),xa.a(Jf.a.Ebo,n,void 0,[e]),n}}openDialog(){this.E$a||
(this.dialog=new pb.StandardDialog,this.dialog.Bd=1,this.dialog.Ke(1,WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogButtonLabel),this.dialog.Ig=Jf.a.tJo,this.dialog.sw(WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogTitle,WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogDescription,0,this.$ya),this.E$a=!0)}}Object(F.a)(sG,"RevertManager",null,[1124]);class tG{cjc(e){return 27===e?WordEditorIntl.WordEditorStrings.L_DesignerPullQuoteReviewTitle:28===e?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionV2ReviewTitle:
WordEditorIntl.WordEditorStrings.L_DesignerFormattingFixesReviewTitle}}Object(F.a)(tG,"ReviewDescriptionBuilder",null,[1123]);class $h{constructor(e,n,C){C?(this.urd=ev(e),this.STc=ev(n)):(this.urd=e,this.STc=n)}}Object(F.a)($h,"FontPairing",null,[]);class EC{eN(e){return e?Of.a.HT(e.urd)^Of.a.HT(e.STc):0}equals(e,n){return e.urd===n.urd&&e.STc===n.STc}hla(e){return e.urd+":"+e.STc}}Object(F.a)(EC,"EqualityComparer",null,[12,13]);class ch{constructor(e,n){this.sV=e;this.RL=n;this.jrd=null;ch.D8m();
ch.I9m();ch.$5f=new Xb.a(Pg.a.vh())}X$i(e){this.RL.le(()=>{this.tHn(e)},"WD:LTCI")}tHn(e){var n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf;if(e.styles&&!ch.$5f.contains(e.name)){ch.$5f.add(e.name);var Gg=[Object.assign(new kh.a,{name:"themeId",int64:this.sV.Zkc(e.name)}),Object.assign(new kh.a,{name:"formalInformalCategory",int64:ch.myi(e)}),Object.assign(new kh.a,{name:"traditionalModernCategory",int64:ch.SIi(e)}),Object.assign(new kh.a,{name:"titleFontName",string:lp(null===(n=e.styles.get("Title"))||
void 0===n?void 0:n.fontName)}),Object.assign(new kh.a,{name:"bodyFontName",string:lp(null===(C=e.styles.get("BodyText"))||void 0===C?void 0:C.fontName)}),Object.assign(new kh.a,{name:"titleFontColor",string:null===(S=e.styles.get("Title"))||void 0===S?void 0:S.fontColor.toString(16)}),Object.assign(new kh.a,{name:"subtitleFontColor",string:null===(ja=e.styles.get("Subtitle"))||void 0===ja?void 0:ja.fontColor.toString(16)}),Object.assign(new kh.a,{name:"heading1FontColor",string:null===(ya=e.styles.get("Heading1"))||
void 0===ya?void 0:ya.fontColor.toString(16)}),Object.assign(new kh.a,{name:"titleAlignment",int64:null===(kb=e.styles.get("Title"))||void 0===kb?void 0:kb.alignment}),Object.assign(new kh.a,{name:"subtitleAlignment",int64:null===(Rb=e.styles.get("Subtitle"))||void 0===Rb?void 0:Rb.alignment}),Object.assign(new kh.a,{name:"heading1Alignment",int64:null===(sc=e.styles.get("Heading1"))||void 0===sc?void 0:sc.alignment}),Object.assign(new kh.a,{name:"bodyAlignment",int64:null===(Fc=e.styles.get("BodyText"))||
void 0===Fc?void 0:Fc.alignment}),Object.assign(new kh.a,{name:"bodyFontSize",int64:null===(gd=e.styles.get("BodyText"))||void 0===gd?void 0:gd.fontSize}),Object.assign(new kh.a,{name:"orderInThePane",int64:this.NOm(e.name)}),Object.assign(new kh.a,{name:"backgroundColor",string:null===(td=e.backgroundColor)||void 0===td?void 0:td.toString(16)}),Object.assign(new kh.a,{name:"themeImageDecorator",bool:null!==(wd=null===(Bd=e.decorators)||void 0===Bd?void 0:Bd.some(Ph=>Ph.type===sn.themeImage))&&void 0!==
wd?wd:!1}),Object.assign(new kh.a,{name:"titleTableDecorator",bool:null!==(Oe=null===(Le=null===(te=e.styles.get("Title"))||void 0===te?void 0:te.decorators)||void 0===Le?void 0:Le.some(Ph=>Ph.type===sn.table))&&void 0!==Oe?Oe:!1}),Object.assign(new kh.a,{name:"complexThemeDecorator",bool:null!==(Xf=null===(We=e.decorators)||void 0===We?void 0:We.some(Ph=>Ph.type===sn.complexDecorator))&&void 0!==Xf?Xf:!1})];xa.a(Jf.a.Kkp,!0,void 0,Gg)}}static myi(e){e=ch.tIi(e);return ch.Ir.tb(e)?ch.Ir.K(e):3}static SIi(e){e=
ch.tIi(e);return ch.Wr.tb(e)?ch.Wr.K(e):3}static D8m(){ch.Ir=new je.a(new EC);ch.Ir.add(new $h("Walbaum Display","Walbaum Text",!0),0);ch.Ir.add(new $h("Century Gothic","Century Gothic",!0),0);ch.Ir.add(new $h("Perpetua","Perpetua",!0),0);ch.Ir.add(new $h("Elephant Pro","Walbaum Text",!0),0);ch.Ir.add(new $h("Imprint MT Shadow","Sabon Next LT",!0),0);ch.Ir.add(new $h("Sitka Banner","Sitka Text",!0),0);ch.Ir.add(new $h("Sitka Banner","Franklin Gothic Book",!0),0);ch.Ir.add(new $h("Avenir Next LT Pro Light",
"Avenir Next LT Pro",!0),0);ch.Ir.add(new $h("Univers Condensed Light","Univers",!0),0);ch.Ir.add(new $h("Univers","Univers",!0),0);ch.Ir.add(new $h("Walbaum Display Light","Avenir Next",!0),0);ch.Ir.add(new $h("Goudy Type","Dante",!0),0);ch.Ir.add(new $h("Lucida Calligraphy","Dante",!0),0);ch.Ir.add(new $h("Edwardian Script ITC","Sabon Next LT",!0),0);ch.Ir.add(new $h("Footlight MT Light","Goudy Old Style",!0),0);ch.Ir.add(new $h("Rockwell Nova Light","News Gothic MT",!0),1);ch.Ir.add(new $h("Walbaum Display",
"News Gothic MT",!0),1);ch.Ir.add(new $h("Cooper Black","Neue Haas Grotesk Text Pro",!0),1);ch.Ir.add(new $h("Franklin Gothic Heavy","Franklin Gothic Book",!0),0);ch.Ir.add(new $h("Calibri Light","Calibri Body",!0),0);ch.Ir.add(new $h("Impact","Neue Haas Grotesk Text Pro",!0),1);ch.Ir.add(new $h("Rockwell Nova","Trade Gothic Next",!0),1);ch.Ir.add(new $h("Trade Gothic Next Heavy","Georgia",!0),1);ch.Ir.add(new $h("Tisa Offc Serif Pro","Avenir Next",!0),1);ch.Ir.add(new $h("Quire Sans","Tisa Offc Serif Pro",
!0),1);ch.Ir.add(new $h("Amasis MT Pro","Trade Gothic Next",!0),1);ch.Ir.add(new $h("Trade Gothic Next Cond","Trade Gothic Next",!0),1);ch.Ir.add(new $h("Plantagenet Cherokee","Calibri (Body)",!0),1);ch.Ir.add(new $h("Brush Script MT","Corbel",!0),1);ch.Ir.add(new $h("Elephant Pro","Amasis MT Pro",!0),2);ch.Ir.add(new $h("Rockwell Nova Extra Bold","Amasis MT Pro",!0),2);ch.Ir.add(new $h("Cooper Black","Amasis MT Pro",!0),2);ch.Ir.add(new $h("Sagona ExtraLight","Quire Sans",!0),2);ch.Ir.add(new $h("Gill Sans Nova Ultra Bold",
"Gill Sans Nova",!0),2);ch.Ir.add(new $h("Sagona Book","Amasis MT Pro",!0),2);ch.Ir.add(new $h("Trade Gothic Next Inline","Avenir Next",!0),2);ch.Ir.add(new $h("Modern Love","Avenir Next LT Pro",!0),2);ch.Ir.add(new $h("The Serif Hand Black","Amasis MT Pro Light",!0),2);ch.Ir.add(new $h("The Hand Black","Avenir Next LT Pro",!0),2);ch.Ir.add(new $h("Tisa Offc Serif Pro","Selawik",!0),2);ch.Ir.add(new $h("Walbaum Display SemiBold","News Gothic MT",!0),2);ch.Ir.add(new $h("Baskerville Old Face","Franklin Gothic Book",
!0),2);ch.Ir.add(new $h("Mistral","Univers",!0),2);ch.Ir.add(new $h("Magneto","Ebrima",!0),2)}static I9m(){ch.Wr=new je.a(new EC);ch.Wr.add(new $h("Walbaum Display","Walbaum Text",!0),0);ch.Wr.add(new $h("Perpetua","Perpetua",!0),0);ch.Wr.add(new $h("Elephant Pro","Walbaum Text",!0),0);ch.Wr.add(new $h("Imprint MT Shadow","Sabon Next LT",!0),0);ch.Wr.add(new $h("Rockwell Nova Light","News Gothic MT",!0),0);ch.Wr.add(new $h("Walbaum Display","News Gothic MT",!0),0);ch.Wr.add(new $h("Cooper Black",
"Neue Haas Grotesk Text Pro",!0),0);ch.Wr.add(new $h("Elephant Pro","Amasis MT Pro",!0),0);ch.Wr.add(new $h("Rockwell Nova Extra Bold","Amasis MT Pro",!0),0);ch.Wr.add(new $h("Cooper Black","Amasis MT Pro",!0),0);ch.Wr.add(new $h("Goudy Type","Dante",!0),0);ch.Wr.add(new $h("Lucida Calligraphy","Dante",!0),0);ch.Wr.add(new $h("Century Gothic","Century Gothic",!0),1);ch.Wr.add(new $h("Sitka Banner","Sitka Text",!0),1);ch.Wr.add(new $h("Sitka Banner","Franklin Gothic Book",!0),1);ch.Wr.add(new $h("Franklin Gothic Heavy",
"Franklin Gothic Book",!0),1);ch.Wr.add(new $h("Impact","Neue Haas Grotesk Text Pro",!0),1);ch.Wr.add(new $h("Rockwell Nova","Trade Gothic Next",!0),1);ch.Wr.add(new $h("Trade Gothic Next Heavy","Georgia",!0),1);ch.Wr.add(new $h("Sagona ExtraLight","Quire Sans",!0),1);ch.Wr.add(new $h("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),1);ch.Wr.add(new $h("Sagona Book","Amasis MT Pro",!0),1);ch.Wr.add(new $h("Trade Gothic Next Inline","Avenir Next",!0),1);ch.Wr.add(new $h("Trade Gothic Next Cond","Trade Gothic Next",
!0),1);ch.Wr.add(new $h("Plantagenet Cherokee","Calibri (Body)",!0),1);ch.Wr.add(new $h("Baskerville Old Face","Franklin Gothic Book",!0),1);ch.Wr.add(new $h("Mistral","Univers",!0),1);ch.Wr.add(new $h("Brush Script MT","Corbel",!0),1);ch.Wr.add(new $h("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),2);ch.Wr.add(new $h("Univers Condensed Light","Univers",!0),2);ch.Wr.add(new $h("Univers","Univers",!0),2);ch.Wr.add(new $h("Walbaum Display Light","Avenir Next",!0),2);ch.Wr.add(new $h("Tisa Offc Serif Pro",
"Avenir Next",!0),2);ch.Wr.add(new $h("Quire Sans","Tisa Offc Serif Pro",!0),2);ch.Wr.add(new $h("Amasis MT Pro","Trade Gothic Next",!0),2);ch.Wr.add(new $h("Modern Love","Avenir Next LT Pro",!0),2);ch.Wr.add(new $h("The Serif Hand Black","Amasis MT Pro Light",!0),2);ch.Wr.add(new $h("The Hand Black","Avenir Next LT Pro",!0),2);ch.Wr.add(new $h("Tisa Offc Serif Pro","Selawik",!0),2);ch.Wr.add(new $h("Calibri Light","Calibri Body",!0),2);ch.Wr.add(new $h("Walbaum Display SemiBold","News Gothic MT",
!0),2);ch.Wr.add(new $h("Footlight MT Light","Goudy Old Style",!0),2);ch.Wr.add(new $h("Magneto","Ebrima",!0),2);ch.Wr.add(new $h("Edwardian Script ITC","Sabon Next LT",!0),2)}static tIi(e){var n,C;const S=null===(n=e.styles.get("Title"))||void 0===n?void 0:n.fontName;e=null===(C=e.styles.get("BodyText"))||void 0===C?void 0:C.fontName;return S&&e?new $h(S,e,!1):new $h("default","default",!1)}NOm(e){this.jrd||this.G9m(this.sV.Hsi());return this.jrd.has(e)?this.jrd.get(e):(E.ULS.shipAssertTag(554995927,
3016,!1),-1)}G9m(e){this.jrd=new Map;for(let n=0;n<e.length;n++)this.jrd.set(e[n].name,n)}}ch.Ir=null;ch.Wr=null;ch.$5f=null;Object(F.a)(ch,"ThemeCategorizer",null,[1119]);class Pz{constructor(e,n){this.Xg=e;this.UFe=n}c$l(e){let n=null;const C=ch.myi(e),S=ch.SIi(e),ja=this.Vgn();ja||E.ULS.sendTraceTag(523257814,3016,50,"applyThemeToTables - default color palette is changed");0===C?ja&&1!==S?2===S?n="List Table 3 {0}":0===S&&(n="Grid Table 3 {0}"):n="Plain Table 3":2===C?ja&&2!==S?0===S?n="Grid Table 5 Dark {0}":
1===S&&(n="List Table 5 Dark {0}"):n="Plain Table 5":1===C?ja&&1!==S?2===S?n="Grid Table 3 {0}":0===S&&(n="List Table 7 Colorful {0}"):n="Plain Table 5":n="Table Grid";e=this.l8l(e.colorLabel);return String.format(n,e)}l8l(e){return e.includes("Blue")?"Accent 1":e.includes("Orange")?"Accent 2":e.includes("Yellow")?"Accent 4":e.includes("Turquoise")?"Accent 5":e.includes("Green")?"Accent 6":"Accent 3"}Vgn(){var e=vm.PageReader.instance.qkc();if(!e)return!1;e=e.ka(hb.a.Oeb,null);return Yk.a.WSb(e)}rkn(e){return e.startsWith(Pz.Qdn)?
!1:!0}Y9k(e,n){e=this.c$l(e);for(const S of n){n=this.Xg.O2(S);var C=this.Xg.fH(S);C=this.Xg.U8d(C);E.ULS.sendTraceTag(523572700,3016,50,"applyThemeToTables");1696===n&&(this.rkn(C)||(n=32));this.UFe.LPj(e,n,S)}}}Pz.Qdn="Table Grid";Object(F.a)(Pz,"TableDesigner",null,[1121]);var uG=d(1710);class vG{constructor(e,n){this.Zgf=e;this.fL=n;this.isInitialized=!1}initialize(){this.isInitialized||(this.isInitialized=!0,this.Zgf.register())}Wd(){this.isInitialized&&(this.Zgf.unregister(),this.isInitialized=
!1)}WNm(e){if(e){var n=null,C=[],S=[],ja=[],ya=[],kb=null;kb=Tm.a.Bo(e);kb.zp(Rb=>36!==Rb.uf,null);for(e=null;kb.moveNext();)if(e=kb.currentNode,14===e.type){n||(n=e);break}if(n){n=Ed.a.eb(n);do{kb=n.currentNode;if(this.fL.read(kb))ja.push(kb);else if(e=this.UNm(kb))switch(e.type){case uG.TableType.SimpleHeaded:S.push(kb);break;case uG.TableType.Other:C.push(kb)}else E.ULS.sendTraceTag(524149721,3016,50,"No TableTypeAnnotation for table in document."),ya.push(kb);n.xs||n.tdo()}while(Object(nh.moveToNextTable)(n))}E.ULS.sendTraceTag(523902976,
3016,50,`getTables stats: otherTables=${C.length},
      simpleHeadedTables=${S.length},
      decoratorTables=${ja.length},
      noAnnotationTables=${ya.length}`);return{other:C,BVj:S,TNl:ja,VRn:ya}}E.ULS.shipAssertTag(524113552,3016,!1,"No target node")}UNm(e){e=this.Zgf.Vsi(e);for(const n of e)if(n.annotationType===uG.TableTypeAnnotation.getTypeName())return n.content}}Object(F.a)(vG,"TableManager",null,[1120,506]);class FC{constructor(e,n,C){this.Ezc=e;this.$d=n;this.ho=C;this.jd=new eb.a;this.oOe=this.Rw=null;this.areUserSettingsLoaded=this.isInitialized=!1;this.Vve=null;this.F3=()=>{if(this.$d.Gif())if(this.ho.c2()){this.areUserSettingsLoaded=
!0;var S=this.aHj();0<S.length&&this.Rw.unshift({label:Pl.favorites,labelDisplayName:null,id:new Jy(Pl.favorites),displayName:null,items:S,isLoaded:!0,G_:!1});this.Rw=null;this.jd.raiseEvent("OnThemesChanged");this.ho.lZb(this.F3)}else this.areUserSettingsLoaded=!1,E.ULS.shipAssertTag(512337434,3016,!1)};this.o2n=()=>{this.Rw=null;this.jd.raiseEvent("OnThemesChanged")};this.kWb=Jf.a.x7m}get TMl(){if(!this.oOe){const e=this.Ezc.filter(n=>n instanceof Sx);this.oOe=0===e.length?null:e[0]}return this.oOe}initialize(){this.isInitialized||
(this.Ezc.forEach(e=>{e.qRd(this.o2n);e!=this.TMl&&e.initialize()}),this.isInitialized=!0,this.$d.Gif()&&!this.ho.c2()&&(this.areUserSettingsLoaded=!1,this.ho.vcc(this.F3)))}Wd(){this.$d.Gif()&&this.ho.lZb(this.F3)}qRd(e){this.jd.addHandler("OnThemesChanged",e)}UDj(e){this.jd.removeHandler("OnThemesChanged",e)}g2k(e){this.jd.addHandler("OnShowMoreThemes",e)}Xic(){var e;const n=null===(e=this.Ezc.find(C=>C instanceof Ky))||void 0===e?void 0:e.Xic();return n?new Jy(n):void 0}OOf(){const e=this.dOl(this.Chm()),
n=this.uBi();e.forEach(C=>{C.id.getLabel()===Pl.main&&(C.items=n.items.slice(0,this.kWb))});return e}Chm(){var e;if(this.Rw)return this.Rw;this.Rw=[];for(const n of this.Ezc)if(!(n instanceof Sx)&&n.c9d())for(const C of n.c9d()){let S;if(this.$d.ztb())if(S=C.displayName?this.Rw.filter(ja=>{var ya,kb;return(null===(ya=ja.displayName)||void 0===ya?void 0:ya.toLowerCase())===(null===(kb=C.displayName)||void 0===kb?void 0:kb.toLowerCase())}):null,0<(null===S||void 0===S?void 0:S.length)){for(const ja of C.items){const ya=
null===(e=S[0].items)||void 0===e?void 0:e.filter(kb=>kb.name===ja.name);ya&&0!==ya.length||S[0].items.push(ja)}C.G_&&C.G_!==S[0].G_&&(S[0].G_=C.G_)}else this.Rw.push(C);else S=this.Rw.filter(ja=>ja.label===C.label),0<(null===S||void 0===S?void 0:S.length)?S[0].items.push(...C.items):this.Rw.push(C)}this.$d.KWi()&&this.Rw.forEach(n=>{for(const C of n.items)C.type===Gk.theme&&C.styles.forEach(S=>{var ja=S.fontColor;const ya=18<=S.fontSize||14<=S.fontSize&&S.bold?3:4.5;ja=Yk.a.Y4d(ja)<ya?XA.has(ja)?
XA.get(ja):0:ja;S.fontColor=ja})});this.Rw.forEach(n=>{for(const ja of n.items)if(ja.type===Gk.theme||ja.type===Gk.templateTheme||ja.type===Gk.officeTemplate){var C=void 0;n=ja;if(null===(C=n.styles)||void 0===C?0:C.has("Heading1")){C=n;a:{var S=n.styles.get("Heading1").fontName;S=lp(S);for(const ya of PA)if(void 0!==ya&&S.startsWith(ya)){S=ya;break a}E.ULS.shipAssertTag(557672E3,3016,!1);S=void 0}C.fontLabel=S}n.colorLabel=ir.fvl(n.accentColor)}});if(this.$d.mXf()){if(!this.ho.c2())return this.areUserSettingsLoaded=
!1,E.ULS.shipAssertTag(512522208,3016,!1),this.Rw;this.areUserSettingsLoaded=!0;e=this.aHj();0<e.length&&this.Rw.unshift({label:Pl.favorites,labelDisplayName:null,id:new Jy(Pl.favorites),displayName:null,items:e,isLoaded:!0,G_:!1})}return this.Rw}aHj(){const e=[];var n=this.ho.azm();if(0<(null===n||void 0===n?void 0:n.length)){const C=this.Hsi();for(const S of n)if(n=C.find(ja=>ja.id==S))n.isThemeInFavorites=!0,e.push(n)}return e}Hsi(){var e;const n=[];null===(e=this.Rw)||void 0===e?void 0:e.forEach(C=>
{n.push(...C.items)});return n}Zkc(e){for(const n of this.Ezc)if(n.G4c()&&n.G4c().tb(e))return n.G4c().K(e);E.ULS.shipAssertTag(590386456,3016,!1);return 0}toggleFavorite(e){this.ho.ymp(e.id);e.isThemeInFavorites=!e.isThemeInFavorites;this.Rw=null;this.jd.raiseEvent("OnThemesChanged")}hCn(){var e,n;this.kWb+=Jf.a.sUn;const C=null!==(n=null===(e=this.uBi())||void 0===e?void 0:e.items.length)&&void 0!==n?n:0;e=this.kWb<C;this.kWb=Math.min(this.kWb,C);this.jd.raiseEvent("OnShowMoreThemes",new ki.a(e));
return this.kWb}l7i(){if(null!==this.Vve)for(const e of this.Ezc)e.G_(this.Vve)&&e.she(this.Vve,!0)}setSelectedSection(e){this.Vve=e;this.l7i()}uBi(){var e;if(null===(e=this.Rw)||void 0===e||!e.length)return null;for(const n of this.Rw)if(n.id.getLabel()===Pl.main)return n;return null}dOl(e){const n=[];null===e||void 0===e?void 0:e.forEach(C=>{n.push({label:C.label,labelDisplayName:C.labelDisplayName,id:C.id,displayName:C.displayName,items:[...C.items],isLoaded:C.isLoaded,G_:C.G_})});return n}}Object(F.a)(FC,
"ThemeGenerator",null,[1118,506]);class oJ{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph){this.sdl=e;this.l7a=n;this.$d=C;this.RL=S;this.FA=ja;this.Zt=ya;this.dK=kb;this.iua=Rb;this.Og=sc;this.OP=Fc;this.Pfp=gd;this.utp=td;this.Qc=Bd;this.hKo=wd;this.Sm=te;this.b2=Le;this.fL=Oe;this.cip=We;this.Xhp=Xf;this.Ap=Gg;this.jL=Ph;this.Uij=()=>{var Aj;null===(Aj=this.jL)||void 0===Aj?void 0:Aj.G0d();this.b2.IDj(this.Uij)}}async applyTheme(e,n){var C,S,ja,ya;if(!e)return E.ULS.shipAssertTag(593073563,
3016,!1),!1;const kb=this.Ap.Xf("UserAction",Jf.a.applyTheme),Rb=Date.now();let sc;try{const Fc=this.Og.Vja(this.Qc.vd),gd=this.$d.Qfn();this.hKo.kWn();let td=this.c4c();await this.okg(td);if(e.type===Gk.templateTheme||e.type===Gk.officeTemplate)null===(C=this.jL)||void 0===C?void 0:C.ADg();2!==(null===(S=this.jL)||void 0===S?void 0:S.rVa())&&(this.fL.yYm()?(this.RL.le(()=>this.l7a.Kyo(),"WD:RAD"),td=this.c4c()):this.$d.ztb()&&this.l7a.zYm()&&(this.l7a.vAo(),this.nE(),td=this.c4c()));const Bd=this.$Em(e,
td);C=!1;let wd=pe.a.H5a;if(this.b2.B5o(e,Bd)){if(e.type===Gk.templateTheme||e.type===Gk.officeTemplate)C=!0,this.b2.pff(this.Uij);this.b2.showDialog();wd=pe.a.Fhf}let te;this.$d.Bce()&&(te=this.cip.WNm(this.Qc.vd));const Le=null===te||void 0===te?void 0:te.BVj,Oe=this.xjo(e,td,Le,Fc&&gd,n,wd);this.pjo(e,Bd);this.yjo(e);e.type!==Gk.templateTheme||C||(null===(ja=this.jL)||void 0===ja?void 0:ja.G0d());E.ULS.sendTraceTag(543481999,3016,50,`applyTheme result=${Oe},
        isDocumentEmpty=${Fc},
        isBootstrappingEnabled=${gd},
        areTablesEnabled=${this.$d.Bce()},
        areSimpleHeadedTablesDetected=${0<(null===Le||void 0===Le?void 0:Le.length)}`);sc=[Object.assign(new kh.a,{name:Jf.a.R9k,int64:te.other.length}),Object.assign(new kh.a,{name:Jf.a.T9k,int64:te.BVj.length}),Object.assign(new kh.a,{name:Jf.a.M9k,int64:te.TNl.length}),Object.assign(new kh.a,{name:Jf.a.Q9k,int64:te.VRn.length}),Object.assign(new kh.a,{name:Jf.a.S9k,int64:Oe}),Object.assign(new kh.a,{name:Jf.a.O9k,int64:Fc}),Object.assign(new kh.a,{name:Jf.a.N9k,int64:gd}),Object.assign(new kh.a,
{name:Jf.a.L9k,int64:this.$d.Bce()}),Object.assign(new kh.a,{name:"IsProactivePane",bool:Xj.p$c}),Object.assign(new kh.a,{name:"DesignType",string:null===(ya=null===Xj||void 0===Xj?void 0:Xj.QC)||void 0===ya?void 0:ya.INb.toString()}),Object.assign(new kh.a,{name:"IsTemplateApplied",string:Xj.QC&&0!=Xj.QC.INb})];return Oe}catch(Fc){return E.ULS.shipAssertTag(592720733,3016,!1,String.format("{0} {1}",Fc.message,Fc.stack)),sc=[Object.assign(new kh.a,{name:"error",string:Fc.message})],!1}finally{xa.a(Jf.a.P9k,
!0,Date.now()-Rb,sc),kb.stop()}}xjo(e,n,C=[],S=!1,ja=!1,ya=pe.a.H5a){var kb,Rb,sc;let Fc=!0;ya=this.FA.Lc(15,ya);try{ya.Rz.Ab(this.Qc.vd);this.RL.le(()=>this.Pfp.j1l(e),"WD:MS");const gd=this.utp.create(e,ja||2===(null===(kb=this.jL)||void 0===kb?void 0:kb.rVa()),2===(null===(Rb=this.jL)||void 0===Rb?void 0:Rb.rVa()));gd.Z3h(n);this.RL.le(()=>{for(const td of n)Fc=!!this.OP.Nio(td,(Bd,wd)=>{gd.huc(wd,Bd)||this.RL.le(()=>this.dK.Uja(wd,Bd.role),"WD:ASFR");return!0})&&Fc},"WD:PPFAT");this.RL.le(()=>
gd.FKb(),"WD:URPAF");this.RL.le(()=>this.Zt.P0(),"WD:ULN");this.RL.le(()=>this.whf(e),"WD:ABC");S&&this.sdl.Fbe(this.$d.bgn());2!==(null===(sc=this.jL)||void 0===sc?void 0:sc.rVa())&&(null===C||void 0===C?0:C.length)&&this.RL.le(()=>this.Xhp.Y9k(e,C),"WD:ATTT")}finally{ya&&ya.dispose()}return Fc}$Em(e,n){var C,S,ja,ya,kb=new Set;for(const [Rb,sc]of e.styles)(null===(C=sc.decorators)||void 0===C?0:C.length)&&kb.add(Xi.g(Rb));e=new fb.a(n.filter(Rb=>Af.ParagraphReader.Wb(Rb)&&!Rb.tIa));kb=this.Sm.yDi(kb,
e);if(!kb.has(2))for(const Rb of e)e=null!==(ja=null===(S=this.Sm.YB(Rb))||void 0===S?void 0:S.role)&&void 0!==ja?ja:1,n=null===Rb||void 0===Rb?void 0:Rb.iQ,(null!==(ya=null===n||void 0===n?void 0:n.ka(hb.a.na,void 0))&&void 0!==ya?ya:void 0)==zl.StyleReader.dBb&&1===e&&(this.Sm.Qnd(Rb,2,!1),kb.set(2,new fb.a([Rb])));return kb}pjo(e,n){this.RL.le(()=>{for(const C of n.keys())for(const S of n.get(C))this.RL.le(()=>{var ja;return this.l7a.ISh(S,null===(ja=e.styles.get(Xi.h(C)))||void 0===ja?void 0:
ja.decorators,e.type)},"WD:ADFS")},"WD:PSD")}yjo(e){e.decorators&&this.RL.le(()=>this.l7a.ISh(this.Qc.vd,e.decorators,e.type),"WD:ADFT")}async okg(e){e=this.l7a.okg(e);let n;const C=new Promise(S=>n=setTimeout(()=>{S();E.ULS.sendTraceTag(527202188,3016,50,"Reading intelligence timed out")},2E3));await Promise.race([e,C]);clearTimeout(n)}whf(e){var n;const C=null===(n=this.Qc)||void 0===n?void 0:n.vd;C?void 0===e.backgroundColor?C.hasProperty(Ee.a.fS)&&C.setValue(Ee.a.fS,Yk.a.jB):C.setValue(Ee.a.fS,
Yk.a.cha(e.backgroundColor)):E.ULS.shipAssertTag(541102279,3016,!1)}c4c(){const e=this.Og.Zm(this.Qc.vd),n=this.iua.gUa(e,!0,!1),C=[];this.RL.le(()=>{do C.push(n.DA);while(n.Ala())},"WD:IFAP");return C}nE(){this.Og.Zm(this.Qc.vd).Hj().Ag.nE(null,()=>{E.ULS.sendTraceTag(508937036,3016,50,"forceOutbound failed")},null)}}Object(F.a)(oJ,"ThemeManager",null,[1117]);class zw{constructor(e,n,C,S){this.d$g=null;this.zM=e;this.Ujb=n;this.qtk=S;this.WKe=new fb.a;this.TIh=new fb.a}Z3h(){}huc(e,n){if(!e)return E.ULS.shipAssertTag(590206988,
3016,!1),!1;switch(n.role){case 1:return this.TIh.add(e),!0;case 13:return this.Pho(e,n.N$a),!1;default:return!1}}FKb(){var e=this.qtk.styles.get(Xi.h(13)),n=1;0<this.WKe.count&&(n=this.jkl(this.WKe),n=2*e.fontSize/n);for(const C of this.TIh)if(e=Ed.a.eb(C),Af.ParagraphReader.isEmpty(e))this.Ujb.Uja(C,13);else{e=[];if(1!==n){const S=Math.ceil(n*this.lZh(C));e.push({type:Yc.FormattingSuggestionType.FontSize,fixedValue:S.toString()})}this.Ujb.pmb(C,e)}}Pho(e,n){this.WKe.add(this.lZh(e));!this.d$g&&
n&&(this.d$g=this.$mi(e,Ee.a.font,null))}$mi(e,n,C){return(e=this.zM.Vs(ce.a.create(e)))?this.zM.Ug(e,n,C):C}jkl(e){e.Sc((C,S)=>C-S);const n=e.count>>1;return e.count%2?e.K(n):(e.K(n)+e.K(n-1))/2}lZh(e){const n=this.$mi(e,Ee.a.fontSize,vr.a.VO),C=(e.ra?e.ra.length:0)-1;let S=0,ja=0;for(let kb=0;kb<C;kb++){var ya=e.ra.Ub(kb);const Rb=e.ra.Ub(kb+1);let sc=n;ya.formatting&&(sc=this.zM.Ug(ya.formatting,Ee.a.fontSize,n));ya=Rb.cp-ya.cp;S+=sc*ya;ja+=ya}return 0<ja?S/ja:n}}Object(F.a)(zw,"UnknownRoleProcessor",
null,[1140]);class wG{constructor(e,n,C=!1){this.Uvf=e;this.a4=n;this.j4m=C;this.wJg=new Set}Z3h(e){e.forEach(n=>{this.j4m&&(null===n||void 0===n?0:n.tIa)||1!==this.Uvf.YB(n).role||(this.a4.cwc(n,!0),this.wJg.add(n))})}huc(e){return this.wJg.has(e)}FKb(){this.wJg.forEach(e=>{this.a4.TZa(e,!0)})}}Object(F.a)(wG,"UnknownRoleProcessorPreserveStyle",null,[1140]);class xG{constructor(e,n,C,S,ja){this.Uvf=e;this.E2=n;this.dK=C;this.$d=S;this.a4=ja}create(e,n,C=!1){return n?new wG(this.Uvf,this.a4,C):new zw(this.E2,
this.dK,this.$d,e)}}Object(F.a)(xG,"UnknownRoleProcessorFactory",null,[1116]);class GC{constructor(){this.initialized=!1;this.map=new Map}initialize(){this.initialized=!0}register(e,n){this.initialized||this.initialize();this.map.has(e)||this.map.set(e,[]);this.map.get(e).push(n)}unregister(e){this.map.delete(e)}}Object(F.a)(GC,"ASuggestionLifecycleManager",null,[1115]);class yG extends GC{constructor(e){super();this.Pq=e;this.Tvb=(n,C)=>{if(C.property===Ee.a.lastModifiedTime&&this.map.has(C.node)){const S=
C.node.ka(Ee.a.lastModifiedTime,void 0);if(S){let ja=!0;this.map.get(C.node).forEach(ya=>{ya.uTh&&ya.uTh>=S?ya.hcd():ja=!1});ja&&this.map.delete(C.node)}}}}initialize(){this.Pq.qf(12).Qo(this.Tvb);super.initialize()}register(e,n){super.register(e,n);n.uTh=e.ka(Ee.a.lastModifiedTime,void 0)}}Object(F.a)(yG,"ConsistencySuggestionLifecycleManager",GC,[1115]);class $A extends GC{constructor(e){super();this.Pq=e;this.Svb=(n,C)=>{this.map.has(C.node)&&(this.map.get(C.node).forEach(S=>{S.hcd()}),this.map.delete(C.node))};
this.$Zn=(n,C)=>{this.map.has(C.node)&&!Object(xi.a)(C.node,5)&&(this.map.get(C.node).forEach(S=>{(Object(Sc.e)(S)||2===(null===S||void 0===S?void 0:S.lr))&&S.hcd()}),this.map.delete(C.node))}}initialize(){const e=this.Pq.qf(12);e.ly(this.Svb);e.Qo(this.$Zn);super.initialize()}}Object(F.a)($A,"EnhancementSuggestionLifecycleManager",GC,[1115]);class vE{constructor(e){this.ih=e;this.Gwf=this.Yvg=null;this.Bfe=this.isInitialized=!1;this.gDj=(n,C)=>{this.ih.dba(C.actionId)&&(this.Yvg?this.Yvg(null):E.ULS.shipAssertTag(574755666,
3016,!1))};this.b5j=()=>{this.Gwf?(this.Gwf(),xa.a(Jf.a.JUl,!0),E.ULS.sendTraceTag(537794770,3016,50,"Revert button has been disabled")):E.ULS.shipAssertTag(537794769,3016,!1)}}initialize(){this.isInitialized||(this.EEg(),this.isInitialized=!0)}Wd(){this.isInitialized&&(this.SJg(),this.isInitialized=!1)}setSelectThemeButtonCallback(e){this.Yvg=e}setDisableRevertButtonCallback(e){this.Gwf=e}EEg(){this.Bfe||(this.ih.wcc(this.gDj),this.ih.u2k(this.b5j),this.Bfe=!0)}SJg(){this.Bfe&&(this.ih.Krg(this.gDj),
this.ih.BCo(this.b5j),this.Bfe=!1)}}Object(F.a)(vE,"DesignerUndoTracker",null,[1114,506]);class dx extends Qh.a{constructor(e,n){super(!1,!1,!0);this.Sw=e;this.Bt=n;this.xLb=void 0;this.Jql=C=>{xa.a(Jf.a.vkk,!0,void 0,[{name:"chosenOption",string:C},{name:"index",int64:this.xLb.findIndex(S=>S.id===C)}]);this.hide();switch(C){case "Template":this.Sw.show(22);break;case "Upload":window.open("https://onedrive.live.com/");break;case "Learn":window.open("https://support.microsoft.com/en-us/word");break;
case "Other":this.Bt.invokeUserFeedback("WordUserIntentDialogSurvey")}}}P7m(){this.xLb=[{["id"]:"Explore",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogExplore,["imageSrc"]:Sd.a.Aj("UserIntentExploreIcon.png")},{["id"]:"Template",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogTemplate,["imageSrc"]:Sd.a.Aj("UserIntentTemplateIcon.png")},{["id"]:"Blank",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogBlank,["imageSrc"]:Sd.a.Aj("UserIntentStartBlankIcon.png")},
{["id"]:"Upload",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogUpload,["imageSrc"]:Sd.a.Aj("UserIntentUploadFileIcon.png")},{["id"]:"Learn",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogLearn,["imageSrc"]:Sd.a.Aj("UserIntentHowToIcon.png")}];const e={["id"]:"Other",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogOther,["imageSrc"]:Sd.a.Aj("UserIntentMoreItemsIcon.png")};dx.B$o(this.xLb);this.xLb.push(e)}b$o(){void 0===this.xLb&&this.P7m();localStorage.setItem(dx.nfi,
"true");this.Uh("",void 0,{["id"]:dx.id,["dialogButtonsOption"]:5,["bodyControls"]:{["dialogTitle"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogTitle,["dialogSubtitle"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogSubtitle,["chooseFunction"]:this.Jql,["rowsInfo"]:[this.xLb.slice(0,3),this.xLb.slice(3,6)]}});xa.a(Jf.a.wkk)}static B$o(e){for(let n=e.length-1;0<n;n--){const C=Math.floor(Math.random()*(n+1));[e[n],e[C]]=[e[C],e[n]]}}}dx.id="UserIntentDialog";dx.nfi="UserIntentDialogShown";
Object(F.a)(dx,"UserIntentDialog",Qh.a,[]);class ex{constructor(e,n){this.Tna=e;this.ULg=n;this.isInitialized=!1;this.G2j=(C,S)=>{S.wha&&this.ULg&&this.ULg.b$o()}}initialize(){if(!this.isInitialized){for(const e of this.Tna)e.vqa(this.G2j),e.initialize();this.isInitialized=!0}}Wd(){if(this.isInitialized){for(const e of this.Tna)e.Wd(),e.rDa(this.G2j);this.isInitialized=!1}}}Object(F.a)(ex,"UserIntentDialogTriggerManager",null,[1113]);var wE=d(120);class xE{constructor(e,n){this.theme=e;this.callback=
n}}Object(F.a)(xE,"ApplyThemeActionData",null,[]);class HC{constructor(e){this.callback=e}}Object(F.a)(HC,"FixInconsistenciesActionData",null,[]);var Oy=d(117);class IC{constructor(e,n){this.query=e;this.callback=n}}Object(F.a)(IC,"GenerateDocumentActionData",null,[]);class yE{constructor(e,n){this.template=e;this.RYn=n}}Object(F.a)(yE,"ApplyOfficeTemplateActionData",null,[]);class Vq{constructor(e,n,C,S,ja,ya){this.j7a=ja;this.Yq=ya;this.ga=e;this.Uda=n;this.PIh=C}W9k(e,n){e=new xE(e,n);this.ga.Qb(pe.a.H5a,
2,e)}X8k(e,n){e=new yE(e,n);this.ga.Qb(pe.a.Dya,2,e)}generateDocument(e,n){e=new IC(e,n);this.ga.Qb(pe.a.cSl,2,e)}kam(e){e=new HC(e);this.ga.Qb(ha.a.i3d,2,e)}acceptAll(){const e=new xw.a(0);this.ga.Qb(pe.a.Nlb,2,e)}rejectAll(){this.ga.Ob(ha.a.fkd,2)}showMoreThemes(){this.ga.Ob(ha.a.Rei,2)}logThemeInfo(e){this.ga.Qb(ha.a.Mei,2,{theme:e})}setReviewingCallback(e){this.Uda.$Yo(e)}setSelectThemeButtonCallback(e){this.PIh.setSelectThemeButtonCallback(e)}setDisableRevertButtonCallback(e){this.PIh.setDisableRevertButtonCallback(e)}reviewChanges(){this.ga.Ob(ha.a.Svf,
2)}openGreenroomInNewTab(){this.ga.Ob(ha.a.Nei,2)}invokeUserFeedback(e){this.j7a.N_c(n=>{this.Y9o(n,e)})}Y9o(e,n){e.meb(n,null)}tryAnyway(){this.ga.Ob(ha.a.Tei,2)}revertTheme(){this.ga.Ob(ha.a.kug,2)}getFontColorCssWithRespectTheming(e){return this.Yq.EHf(Yk.a.cha(e),new Oy.a(wE.a.YO()))}getColorCssWithRespectTheming(e){return this.Yq.H2(Yk.a.cha(e),new Oy.a(wE.a.YO()))}toggleFavorite(e,n){this.ga.Qb(ha.a.Hmi,2,{theme:e,fmn:n})}}Object(F.a)(Vq,"DesignerPropsActions",null,[1112]);class ai{constructor(){this.type=
null;this.isDataLoaded=!1;this.errorState=Zo.none;this.activeSection=this.sections=null;this.isPaneAutoOpened=!1;this.Js=0;this.applyOfficeTemplate=this.applyTheme=this.reviewChanges=this.fixInconsistencies=null;this.inconsistenciesCount=0;this.rejectAll=this.acceptAll=null;this.hasMoreThemesToShow=!1;this.tryAnyway=this.logThemeInfo=this.tryAgain=this.showMoreThemes=null;this.errorTimeout=0;this.paneContent=this.revertTheme=this.openGreenroomInNewTab=this.invokeUserFeedback=this.setDisableRevertButtonCallback=
this.setSelectThemeButtonCallback=this.setReviewingCallback=null;this.canGetFocus=!0;this.generateDocument=this.toggleFavorite=null;this.areUserSettingsLoaded=!1;this.setSelectedSection=this.showMoreTemplates=null}}Object(F.a)(ai,"DesignerTaskPaneData",null,[]);class Ut{constructor(e,n,C,S,ja,ya,kb,Rb){this.$d=e;this.Bt=n;this.zaa=C;this.H9n=S;this.sV=ja;this.Sm=ya;this.WM=kb;this.jL=Rb}Pmb(){var e,n;return Object.assign(new ai,{acceptAll:Object(ic.a)(this.Bt,this.Bt.acceptAll,"acceptAll"),applyTheme:Object(ic.a)(this.Bt,
this.Bt.W9k,"applyThemeHandler"),applyOfficeTemplate:Object(ic.a)(this.Bt,this.Bt.X8k,"applyOfficeTemplateHandler"),generateDocument:Object(ic.a)(this.Bt,this.Bt.generateDocument,"generateDocument"),isDataLoaded:this.H9n.woc,errorState:this.zaa.eNb,fixInconsistencies:Object(ic.a)(this.Bt,this.Bt.kam,"fixInconsistenciesHandler"),inconsistenciesCount:this.Sm.inconsistenciesCount,invokeUserFeedback:void 0,rejectAll:Object(ic.a)(this.Bt,this.Bt.rejectAll,"rejectAll"),hasMoreThemesToShow:!0,showMoreThemes:Object(ic.a)(this.Bt,
this.Bt.showMoreThemes,"showMoreThemes"),logThemeInfo:Object(ic.a)(this.Bt,this.Bt.logThemeInfo,"logThemeInfo"),reviewChanges:Object(ic.a)(this.Bt,this.Bt.reviewChanges,"reviewChanges"),setReviewingCallback:Object(ic.a)(this.Bt,this.Bt.setReviewingCallback,"setReviewingCallback"),setSelectThemeButtonCallback:Object(ic.a)(this.Bt,this.Bt.setSelectThemeButtonCallback,"setSelectThemeButtonCallback"),setDisableRevertButtonCallback:Object(ic.a)(this.Bt,this.Bt.setDisableRevertButtonCallback,"setDisableRevertButtonCallback"),
sections:this.sV.OOf(),activeSection:this.sV.Xic(),type:Jf.a.x_j,tryAnyway:Object(ic.a)(this.Bt,this.Bt.tryAnyway,"tryAnyway"),openGreenroomInNewTab:this.$d.Cin()?Object(ic.a)(this.Bt,this.Bt.openGreenroomInNewTab,"openGreenroomInNewTab"):void 0,revertTheme:Object(ic.a)(this.Bt,this.Bt.revertTheme,"revertTheme"),isCanvasDarkModeOn:!!this.WM&&this.WM.u6,getFontColorCssWithRespectTheming:Object(ic.a)(this.Bt,this.Bt.getFontColorCssWithRespectTheming,"getFontColorCssWithRespectTheming"),getColorCssWithRespectTheming:Object(ic.a)(this.Bt,
this.Bt.getColorCssWithRespectTheming,"getColorCssWithRespectTheming"),paneContent:null!==(n=null===(e=this.jL)||void 0===e?void 0:e.Hwi())&&void 0!==n?n:ur.main,canGetFocus:!0,toggleFavorite:this.$d.mXf()?Object(ic.a)(this.Bt,this.Bt.toggleFavorite,"toggleFavorite"):void 0,areUserSettingsLoaded:this.sV.areUserSettingsLoaded,showMoreTemplates:Object(ic.a)(this.sV,this.sV.l7i,"loadMoreTemplates"),setSelectedSection:Object(ic.a)(this.sV,this.sV.setSelectedSection,"setSelectedSection")})}ztl(e){return Object.assign(new ai,
{acceptAll:e.acceptAll,applyTheme:e.applyTheme,applyOfficeTemplate:e.applyOfficeTemplate,generateDocument:e.generateDocument,isPaneAutoOpened:e.isPaneAutoOpened,errorState:e.errorState,isDataLoaded:e.isDataLoaded,fixInconsistencies:e.fixInconsistencies,inconsistenciesCount:e.inconsistenciesCount,invokeUserFeedback:e.invokeUserFeedback,rejectAll:e.rejectAll,hasMoreThemesToShow:e.hasMoreThemesToShow,showMoreThemes:e.showMoreThemes,logThemeInfo:e.logThemeInfo,reviewChanges:e.reviewChanges,setReviewingCallback:e.setReviewingCallback,
setSelectThemeButtonCallback:e.setSelectThemeButtonCallback,setDisableRevertButtonCallback:e.setDisableRevertButtonCallback,sections:e.sections,activeSection:e.activeSection,type:e.type,tryAnyway:e.tryAnyway,openGreenroomInNewTab:e.openGreenroomInNewTab,revertTheme:e.revertTheme,isCanvasDarkModeOn:e.isCanvasDarkModeOn,getFontColorCssWithRespectTheming:e.getFontColorCssWithRespectTheming,getColorCssWithRespectTheming:e.getColorCssWithRespectTheming,paneContent:e.paneContent,canGetFocus:e.canGetFocus,
toggleFavorite:this.$d.mXf()?e.toggleFavorite:void 0,areUserSettingsLoaded:e.areUserSettingsLoaded,showMoreTemplates:e.showMoreTemplates,setSelectedSection:e.setSelectedSection})}}Object(F.a)(Ut,"DesignerPropsFactory",null,[1110]);class Vx{constructor(e){this.Awa=null;this.u4e=e;this.sa=new eb.a}I2k(e){this.sa.addHandler("PropsChangedEvent",e)}tla(){this.Awa||(this.Awa=this.u4e.Pmb());return this.Awa}uxb(e,n=!1){if(e){this.Awa||(E.ULS.shipAssertTag(592496460,3016,!1),this.Awa=this.u4e.Pmb());var C=
this.u4e.ztl(this.Awa);e(C);if(n||this.E6o(C))this.Awa=C,e=new ki.a(this.Awa),this.sa.xfa&&this.sa.raiseEvent("PropsChangedEvent",e)}else E.ULS.shipAssertTag(592496459,3016,!1)}E6o(e){return e.inconsistenciesCount!==this.Awa.inconsistenciesCount||e.errorState!==this.Awa.errorState||e.isDataLoaded!==this.Awa.isDataLoaded||e.invokeUserFeedback!==this.Awa.invokeUserFeedback}}Object(F.a)(Vx,"DesignerPropsManager",null,[1089]);class ap{constructor(e,n,C,S,ja,ya,kb,Rb,sc=0,Fc,gd){this.fJa=e;this.zaa=n;
this.Sm=C;this.w4=S;this.sV=ja;this.jNg=ya;this.Bt=kb;this.NEf=Rb;this.tko=sc;this.zuf=Fc;this.jL=gd;this.isInitialized=!1;this.Dmg=0;this.hid=null;this.z_n=(td,Bd)=>{this.$yl(()=>{this.fJa.uxb(wd=>{wd.inconsistenciesCount=Bd.data;wd.canGetFocus=!0})})};this.Kne=()=>{this.fJa.uxb(td=>{td.sections=this.sV.OOf();td.activeSection=this.sV.Xic();td.canGetFocus=!0;td.areUserSettingsLoaded=this.sV.areUserSettingsLoaded},!0)};this.h4n=(td,Bd)=>{this.fJa.uxb(wd=>{wd.sections=this.sV.OOf();wd.hasMoreThemesToShow=
Bd.data;wd.canGetFocus=!0;wd.areUserSettingsLoaded=this.sV.areUserSettingsLoaded},!0)};this.Rdg=()=>{this.fJa.uxb(td=>{if(this.jL){const Bd=this.jL.Hwi();td.paneContent!==Bd&&(td.activeSection=void 0,td.paneContent=Bd,td.canGetFocus=!1)}},!0)};this.ogg=(td,Bd)=>{this.fJa.uxb(wd=>{wd.isCanvasDarkModeOn=Bd.isCanvasDarkModeOn;wd.canGetFocus=!0},!0)};this.GMl=(td,Bd)=>{this.fJa.uxb(wd=>{wd.errorState=Bd.data;wd.canGetFocus=!0})};this.Noe=(td,Bd)=>{this.fJa.uxb(wd=>{wd.isDataLoaded=Bd.data;wd.canGetFocus=
!0;wd.isPaneAutoOpened=Xj.p$c})}}initialize(){this.isInitialized||(this.Sm.w1k(this.z_n),this.zaa.UOh(this.GMl),this.sV.qRd(this.Kne),this.sV.g2k(this.h4n),this.w4.vff(this.Noe),this.zuf.kRd(this.ogg),this.NEf.execute(async e=>{await e.isFeatureEnabled(Jf.a.pfj,!1)&&this.fJa.uxb(n=>{n.invokeUserFeedback=C=>this.Bt.invokeUserFeedback(C);n.canGetFocus=!0},!0)}),this.jL&&this.jL.xPh(this.Rdg),this.isInitialized=!0)}Wd(){}$yl(e){this.hid?(this.hid=e,this.Dmg||(this.Dmg=this.jNg.setTimeout(()=>{this.hid();
this.Dmg=0},this.tko))):(this.hid=e,this.hid())}}Object(F.a)(ap,"DesignerPropsUpdater",null,[1088,506]);class zG{constructor(e,n,C){this.LM=e;this.iSl=n;this.kb=C;this.K8=()=>{this.d8c();this.kb.bdb(this.K8)};if(!e)throw zd.a.argument("AppLifecycleManager is null");if(!C)throw zd.a.argument("Workspace is null");}get $d(){return null!=this.RTg?this.RTg:this.RTg=(()=>this.container.resolve("WordEditor.Designer.IDesignerControl"))()}get name(){return"WordEditor.Designer"}init(){this.container.resolve("Box4.IFeatureHelper").er.continueWith(()=>
{this.Ho()})}wc(e){this.container=e;e.ia("WordEditor.Designer.Perf.IPerfLogger",()=>new ig.a(wb.a.Je)).ha();e.ia("WordEditor.Designer.Persistence.IDesignerTransactionFactory",()=>new zn(e.resolve("Box4.Graph.IGraphTransactionFactory"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();e.ia("WordEditor.Designer.AL.IWorkflowManager",()=>{const ja=new fb.a;ja.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL);ja.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb);
ja.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u8a);ja.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dve);ja.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").m0j);ja.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4);return new Mr(e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),ja)}).ha();e.ia("WordEditor.Designer.Style.IStyleManager",()=>new vt(e.resolve("WordEditor.Designer.IDesignerControl"),
e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("Box4.Styles.IWACStyleEditor"),e.resolve("WordEditor.Designer.Storage.StyleStorage"),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager",()=>new rG(ce.a.createTextRange,e.resolve("Box4.IFormattingReader"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.List.IListReader"),e.resolve("Box4.IOutlineElementNavigator"),e.resolve("Box4.TextFormattingHelper"),
e.resolve("Box4.List.ListItemEditor"))).ha();e.ia("WordEditor.Designer.Style.IManualListConverter",()=>new Tx(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.List.IListEditor"),e.resolve("Box4.List.IListReader"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.IParagraphIndentationReader"),Re.a.n9a)).ha();e.ia("WordEditor.Designer.Style.Decorator.DecoratorStorage",()=>new Ou).ha();e.ia("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory",
()=>new xr(G.AFrameworkApplication.va,e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.ISelectionManager"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Designer.Image.DesignerImageManager"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
this.kb.Qc,e.resolve("Box4.ITableEditor"),e.resolve("Box4.ICharacterPropertiesEditor"),wg.a.xd(),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.IParagraphIteratorFactory"),new id.a(()=>ib.StaticActiveAppFrame.za().kb.Qc.vd),this.A3j(),e.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),e.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),e.resolve("Box4.Styles.IWACStyleReader"),
Object(Zh.a)(),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Style.Decorator.DecoratorManager",()=>new Oz(e.resolve("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),e.resolve("Box4.IUndoManager"),e.resolve("Box4.Graph.IGraphIteratorFactory"),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null,e.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),
e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),new id.a(()=>ib.StaticActiveAppFrame.za().kb.Qc.vd))).ha();e.ia("WordEditor.Designer.Style.IParagraphDesigner",()=>new bx(e.resolve("WordEditor.Designer.IDesignerControl"),ce.a.createTextRange,e.resolve("Box4.IFormattingReader"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.IParagraphEditor"),e.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),e.resolve("Box4.Styles.IWACStyleEditor"),e.resolve("Box4.TextFormattingHelper"),
e.resolve("Box4.List.IListReader"),e.resolve("WordEditor.Designer.Style.IManualListConverter"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.AugmentationLoop.IFormattingExtractor"),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Style.IUnknownRoleProcessorFactory",()=>new xG(e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.IFormattingReader"),
e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Review.IRestoreManager"))).ha();e.ia("WordEditor.Designer.Style.IBlankDocumentEditor",()=>new Nz(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("WordEditor.ContentControl.IContentControlManager"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.IHyperlinkEditor"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),
e.resolve("Box4.IParagraphReader"),e.resolve("Box4.TextFormattingHelper"),this.kb.Qc)).ha();e.ia("WordEditor.Designer.Style.ITableDesigner",()=>new Pz(e.resolve("WordEditor.IWACTableStyleReader"),sw.a.instance)).ha();e.ia("WordEditor.Designer.Style.ITableManager",()=>new vG(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Kip,e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"))).ha();e.ia("WordEditor.Designer.Style.IThemeManager",()=>new oJ(e.resolve("WordEditor.Designer.Style.IBlankDocumentEditor"),
e.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Perf.IPerfLogger"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.IFlatListEditor"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.IParagraphIteratorFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Designer.Review.IReviewManager"),e.resolve("WordEditor.Designer.Style.IStyleManager"),
e.resolve("WordEditor.Designer.Style.IUnknownRoleProcessorFactory"),this.kb.Qc,e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),e.resolve("WordEditor.Designer.Style.ITableManager"),e.resolve("WordEditor.Designer.Style.ITableDesigner"),e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Image.DesignerImageManagerImpl",()=>new Pi(e.resolve("Box4.IOutlineElementEditor"),e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.ISelectionManager"),e.resolve("Box4.Images.IImageEditor"),e.resolve("WordEditor.IImageEditor"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),this.kb.Qc,this.A3j())).as("WordEditor.Designer.Image.DesignerImageManager").ha();
e.ia("WordEditor.Designer.Image.DesignerTextToImageManagerImpl",()=>new Oo(e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").y1b,this.kb.Qc,e.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Designer.Image.DesignerTextToImageManager").ha();e.ia("WordEditor.Designer.Style.IDocumentLanguageManager",()=>new Ny(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL)).ha();e.ia("WordEditor.Designer.Style.IRevertManager",
()=>new sG(e.resolve("Box4.Graph.IGraphTransactionFactory"),e.resolve("Box4.IUndoManager"),this.kb.Gw)).ha();e.ia("WordEditor.Designer.Style.ApplyThemeDialogManager",()=>new Nu(e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"))).ha();this.Guo();this.Jwo();this.qxo();this.Auo();e.ia("WordEditor.Designer.FRE.IFirstRunExperienceManager",()=>new lu(e.resolve("WordEditor.Designer.IDesignerTaskPane"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),
e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.Ta("Common.ISystemInitiatedFeedback"))).ha();e.ia("WordEditor.Designer.Style.IThemeCategorizer",()=>new ch(e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.Designer.Perf.IPerfLogger"))).ha();e.ia("WordEditor.Designer.Style.CurrentThemeProvider",()=>new Uq(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").m0j)).ha();e.ia("WordEditor.Designer.Style.AugLoopThemeProvider",
()=>new Ky(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.IDesignerControl"))).ha();this.$d.ztb()&&e.ia("WordEditor.Designer.Style.OfficeTemplatesThemeProvider",()=>new sE(e.resolve("Box4.OfficeTemplates.OfficeTemplatesDiscoveryService"))).ha();
const n=new id.a(()=>{const ja=[];ja.push(e.resolve("WordEditor.Designer.Style.CurrentThemeProvider"));ja.push(e.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"));this.$d.ztb()&&ja.push(e.resolve("WordEditor.Designer.Style.OfficeTemplatesThemeProvider"));return ja});e.ia("WordEditor.Designer.Style.IThemeGenerator",()=>new FC(n.value,e.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha();e.ia("WordEditor.Designer.Trackers.IDesignerUndoTracker",
()=>new vE(e.resolve("Box4.IUndoManager"))).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsActions",()=>new Vq(G.AFrameworkApplication.va,e.resolve("WordEditor.Designer.Review.IReviewManager"),e.resolve("WordEditor.Designer.Trackers.IDesignerUndoTracker"),e.Ta("Common.ISystemInitiatedFeedback"),ad.a.F2c(),e.resolve("Box4.ICssColorProvider"))).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsFactory",()=>new Ut(e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),
e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.IDarkModeState"),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.BrowserApis.IWindowTimeout",()=>new No).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsUpdater",()=>
new ap(e.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),e.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),e.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.$d.zHm(),e.resolve("Box4.DarkModeEventsManager"),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsManager",()=>new Vx(e.resolve("WordEditor.Designer.Wire.IDesignerPropsFactory"))).ha();e.ia("WordEditor.Designer.Logging.IBlankDocumentLogger",()=>new nn(e.resolve("Box4.IParagraphReader"),this.kb.Qc)).ha();e.ia("WordEditor.Designer.Logging.IConsistencyFixActionsLogger",()=>new $g(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb,
e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u8a,e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha();e.ia("WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",()=>new zo(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL)).ha();e.ia("WordEditor.Designer.Logging.IProactiveSurveyEventLogger",()=>new Ql(e.Ta("Common.ISystemInitiatedFeedback"),e.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),e.resolve("WordEditor.Designer.IDesignerControl"))).ha();
e.ia("WordEditor.Designer.IDesignerTaskPane",()=>new Fz(ib.StaticActiveAppFrame.za(),e.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),ae.FocusManager.instance(),Lc.a.instance,sb.UISurfaces.Lv,e.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),e.resolve("WordEditor.Designer.License.ILicenseManager"),e.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"))).ha();
const C=new id.a(()=>new Lu);e.ia("WordEditor.Designer.IDesignerTaskPaneEvents",()=>C.value).ha();e.ia("WordEditor.Designer.IDesignerTaskPaneEventsInternal",()=>C.value).ha();e.ia("WordEditor.Designer.License.ILicenseManager",()=>new ms(e.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();e.ia("WordEditor.Designer.Storage.IParagraphFormattingStorage",()=>new Rx).ha();e.ia("WordEditor.Designer.Storage.StyleStorage",()=>new Hl).ha();e.ia("WordEditor.Designer.Review.IReviewTraverser",
()=>new oG(e.resolve("Box4.Intent.IIntentRangeEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.IParagraphIteratorFactory"),this.kb.Qc)).ha();e.ia("WordEditor.Designer.Review.IRestoreManager",()=>new nG(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("WordEditor.IFlatListEditor"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.IParagraphEditor"),e.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),e.resolve("Box4.TextFormattingHelper"),ce.a.createTextRange,e.resolve("WordEditor.Designer.Storage.StyleStorage"),
e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("Box4.List.IListReader"))).ha();this.container.ia("WordEditor.Designer.Style.PullQuotesDesigner",()=>new kq(e.resolve("WordEditor.IImageEditor"),e.resolve("Box4.CatchUpActivity.IChangeIdEditor"),e.resolve("Box4.IUndoManager"),G.AFrameworkApplication.J,e.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),e.resolve("Box4.Images.IImageReader"),e.resolve("Box4.ISelectionManager"),e.resolve("Box4.IFeatureHelper"),
e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.TextFormattingHelper"),e.resolve("Box4.IFormattingEditor"),e.resolve("WordEditor.ClientPagination.IClientPaginationUlsLogger"),e.resolve("Box4.IOutlineElementEditor"),ib.StaticActiveAppFrame.za().kb.Qc,G.AFrameworkApplication.ua.eWa,e.resolve("Box4.IBlobReader"),e.resolve("Box4.Styles.IWACStyleReader"))).ha();this.container.ia("WordEditor.Designer.Style.PullQuotesManager",()=>new DC(e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
e.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),e.resolve("WordEditor.Designer.Review.IReviewManager"),ib.StaticActiveAppFrame.za().kb.Qc)).ha();this.container.ia("WordEditor.Designer.Persistence.PersistenceHelper",()=>new sj.a(new id.a(()=>ib.StaticActiveAppFrame.za().kb.hd.ud),e.resolve("Box4.IIntelligenceReader"),e.resolve("Box4.IIntelligenceEditor"),e.resolve("Box4.PersistenceSettingsManager"))).ha();e.ia("WordEditor.Designer.Review.IReviewManager",()=>new Gy(G.AFrameworkApplication.va,
e.resolve("WordEditor.Designer.Perf.IPerfLogger"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("Box4.Intent.IIntentRangeEditor"),xa.a,e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Designer.Review.IRestoreManager"),new tG,e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
e.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),e.resolve("WordEditor.Designer.Image.DesignerImageManager"),e.resolve("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager"),e.resolve("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager"),e.Ta("Common.ISystemInitiatedFeedback"),e.resolve("WordEditor.Designer.IDesignerControl"),
e.Ta("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),e.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),e.resolve("Box4.IParagraphIteratorFactory"),e.resolve("Box4.List.IListReader"),this.kb.Qc)).ha();e.ia("WordEditor.Designer.Review.IReviewActions",()=>new Mu(e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.Designer.Review.IReviewManager"),this.kb.Gw)).ha();e.ia("WordEditor.Designer.OnCanvas.ReviewSelectionManager",
()=>new Qt(e.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),e.resolve("Box4.ISelectionManager"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();e.ia("WordEditor.Designer.OnCanvas.HighlightActor",()=>new Ju(e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("Box4.Intent.IIntentRangeEditor"),tb.a.sg,tb.a.Px)).ha();e.ia("WordEditor.Designer.OnCanvas.IBlueDotActor",()=>new Bq.a(e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.Highlight.IHighlightManager"),
Object(ic.a)(ue.a.instance,ue.a.instance.LI,"registerHandlerWithData"),Object(ic.a)(Ue.a.instance,Ue.a.instance.ub,"registerHandler"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"),this.kb.Gw)).ha();e.ia("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader",()=>new Cq(e.resolve("Box4.Styles.IWACStyleReader"))).ha();e.ia("WordEditor.Designer.OnCanvas.ITriageOptionFactory",()=>new Ez(e.resolve("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader"),
e.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("WordEditor.Designer.IDesignerControl"))).ha();e.ia("WordEditor.Designer.OnCanvas.ITriageOptionProvider",()=>new Ao(e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.OnCanvas.ITriageOptionFactory"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();e.ia("WordEditor.Designer.Style.IDocumentConsistencyManager",
()=>new qG(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u8a,e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("WordEditor.Designer.Review.IReviewManager"),this.kb.Qc,e.resolve("Box4.IParagraphReader"),e.Ta("Common.ISystemInitiatedFeedback"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.Styles.IWACStyleReader"),
e.resolve("Box4.IFormattingReader"))).ha();const S=new id.a(()=>new wa);e.ia("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition",()=>S.value).ha();e.ia("Box4.OfficeTemplates.ApplyTemplatesProxy",()=>new fk(G.AFrameworkApplication.Fe));e.ia("WordEditor.Designer.Style.ITemplateAppliedListener",()=>new Xs(e.resolve("Box4.IUndoManager")));e.ia("WordEditor.Designer.Actors.DesignerActionActor",()=>new bv(G.AFrameworkApplication.va,wg.a.xd(),e.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),
e.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"),e.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.Designer.Style.IRevertManager"),e.resolve("WordEditor.Designer.Review.IReviewActions"),e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.resolve("WordEditor.Designer.Review.IReviewManager"),e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),G.AFrameworkApplication.pc,
e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.Designer.Style.IThemeManager"),e.resolve("WordEditor.Designer.Style.IThemeCategorizer"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.IDesignerTaskPane"),e.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"),e.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),this.$d.bma()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):
null,e.resolve("Box4.OfficeTemplates.ApplyTemplatesProxy"),e.resolve("WordEditor.Designer.Style.ITemplateAppliedListener"),this.kb.hd,this.container.resolve("Box4.IUndoManager"))).ha();e.ia("WordEditor.Designer.Actors.DesignerActor",()=>new Cy(G.AFrameworkApplication.va,e.resolve("WordEditor.Designer.IDesignerTaskPane"),e.resolve("WordEditor.Designer.License.ILicenseManager"),appChrome.api,appChrome.actions,e.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),ib.StaticActiveAppFrame.za(),
e.resolve("WordEditor.Designer.IDesignerControl"))).ha();e.ia("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager",()=>new $A(e.resolve("Box4.Graph.IGraphInstance"))).ha();e.ia("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager",()=>new yG(e.resolve("Box4.Graph.IGraphInstance"))).ha();e.ia("WordEditor.Designer.DocumentTypeEventSource",()=>new lG).ha();this.$d.lde()&&e.ia("WordEditor.Designer.DocumentStatsDnmLogger",()=>new Lr(e.resolve("Box4.Graph.IGraphIteratorFactory"),
e.resolve("WordEditor.IPageNumberFinder"),e.resolve("WordEditor.Designer.DocumentTypeEventSource"))).ha();this.$d.fzb()&&e.ia("WordEditor.Designer.Actors.DesignerPasteActor",()=>new ks(G.AFrameworkApplication.va,e.resolve("WordEditor.Designer.SmartPaste.SmartPasteManager"),e.resolve("Box4.IPasteFloatieEventSource"))).ha();this.$d.fzb()?this.xxo():this.$d.bde()&&this.kuo();this.$d.VAg()&&this.eqg();this.$d.bma()&&!this.$d.rtb()&&this.Wvo();this.$d.z0i()&&this.Rwo();this.$d.IWi()&&this.Ovo();this.$d.lXf()&&
this.zvo();this.$d.H0i()&&this.Uwo();this.$d.N0f()&&this.Rxo()}dispose(){}Auo(){this.$d.bma()&&(this.container.ia("WordEditor.Designer.DocumentState.DocumentStateMachine",()=>new Yf).ha(),this.container.ia("WordEditor.Designer.DocumentState.IDocumentStateMonitor",()=>new vj(this.container.resolve("Box4.IParagraphReader"),this.kb.Qc,this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.container.resolve("WordEditor.Designer.DocumentState.DocumentStateMachine"),
this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha())}Jwo(){const e=new id.a(()=>new Rt(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb)),n=new id.a(()=>new RA(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL)),C=new id.a(()=>new Dy(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4)),S=new id.a(()=>{const ja=new fb.a;ja.add(e.value);ja.add(n.value);ja.add(C.value);return ja});
this.container.ia("WordEditor.Designer.Pane.PaneLoadingManager",()=>new mu(this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),S.value)).as("WordEditor.Designer.Pane.IPaneLoadingManager").ha()}qxo(){this.container.register(Qx,"WordEditor.Designer.WordDesignerSettingsHandler").as("WordEditor.Designer.IWordDesignerSettingsHandler").ha().Ud(()=>new Qx(this.container.resolve("Box4.IRoamingServiceRequestManager"),this.container.resolve("Box4.RoamingSetting.IRoamingSettingCache"),
this.container.resolve("Common.IAppSettingsManager"),new eb.a,this.container.resolve("Common.IUlsWrapper")));this.container.ia("WordEditor.Designer.Settings.DesignerSettingsManager",()=>new Mp(this.container.resolve("WordEditor.Designer.WordDesignerSettingsHandler"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).as("WordEditor.Designer.Settings.IDesignerSettingsManager").ha()}Guo(){const e=new id.a(()=>new fo(wg.a.xd(),this.$d.pgc())),n=new id.a(()=>new fm(this.container.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
this.container.resolve("Box4.TrackChange.ITrackChangeEventsActor"))),C=new id.a(()=>new yl(this.container.resolve("WordEditor.Designer.Style.IDocumentLanguageManager"))),S=new id.a(()=>new yo(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb)),ja=new id.a(()=>new Qn(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL,this.container.resolve("Box4.IParagraphReader"),this.kb.Qc)),ya=new id.a(()=>{const kb=new fb.a;this.$d.pgc()&&kb.add(e.value);
this.$d.Ain()&&kb.add(n.value);kb.add(S.value);kb.add(C.value);this.$d.Lnn()&&kb.add(ja.value);return kb});this.container.ia("WordEditor.Designer.Errors.IErrorStateManager",()=>new Kh(ya.value)).ha()}xxo(){this.container.ia("WordEditor.Designer.SmartPaste.SmartPasteManager",()=>new BC(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("Box4.UI.PasteFloatieManager"),this.container.Ta("Box4.Actors.ClipboardActor"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u8a,
this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb,this.container.resolve("Box4.IUndoManager"),ka.a.jf.Tl,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Ta("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"))).ha()}kuo(){this.container.ia("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext",()=>new xe(this.container.resolve("Box4.List.IListReader"))).ha();
this.container.ia("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider",()=>new Md(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u8a,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))).ha();
const e=new id.a(()=>new hq(6,wg.a.xd(),this.$d.pgc())),n=new id.a(()=>new Ya(ka.a.jf.Tl,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))),C=new id.a(()=>new AC(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),S=new id.a(()=>{const gd=new fb.a;gd.add(n.value);gd.add(C.value);gd.add(e.value);return gd}),ja=new id.a(()=>new ww(6,S.value,null)),ya=new id.a(()=>{const gd=[];gd.push(ja.value);return gd}),kb=new id.a(()=>
new zm(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),Rb=new id.a(()=>{const gd=new fb.a;gd.add(kb.value);gd.add(C.value);return gd}),sc=new id.a(()=>new ww(6,Rb.value,null)),Fc=new id.a(()=>{const gd=[];gd.push(sc.value);return gd});this.container.ia("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager",()=>new He(ya.value,Fc.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider"),
!this.$d.p_f())).ha()}Rwo(){this.container.ia("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker",()=>new Ox(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb,G.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.container.resolve("WordEditor.Designer.FRE.IFirstRunExperienceManager")));
const e=new id.a(()=>new Fy(11)),n=new id.a(()=>new UA(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),11)),C=new id.a(()=>new zm(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.$d.zho(),!1)),S=new id.a(()=>{const kb=new fb.a;kb.add(e.value);kb.add(n.value);kb.add(C.value);return kb}),ja=new id.a(()=>new Nn.a(11,S.value,null,3016,Jf.a.Dho)),ya=new id.a(()=>{const kb=[];kb.push(ja.value);
return kb});this.container.ia("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2",()=>new mG(ya.value,this.container.resolve("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker"),this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),G.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha()}Wvo(){const e=new id.a(()=>new jq(this.LM)),n=new id.a(()=>new $s),C=new id.a(()=>new zv(15,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4,
this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),S=new id.a(()=>new Ij(15,this.container.resolve("Box4.IParagraphReader"),this.kb.Qc,{bwc:!0,W_:!1,b7c:!0,a7c:!0,V_:!0})),ja=new id.a(()=>{const sc=new fb.a;sc.add(e.value);sc.add(n.value);sc.add(C.value);sc.add(S.value);return sc}),ya=new id.a(()=>new SA(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.$d.bma()&&!this.$d.rtb())),kb=
new id.a(()=>new ww(15,ja.value,ya.value,null,new Iz("Jump-start templates loaded",Jf.a.UZd,Ij.Ljf))),Rb=new id.a(()=>{const sc=new fb.a;sc.add(kb.value);return sc});this.container.ia("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial",()=>new zy(Rb.value,ya.value,null)).ha()}Rxo(){const e=new id.a(()=>new jq(this.LM)),n=new id.a(()=>new qo(dx.nfi,"false","false")),C=new id.a(()=>new Ij(2,this.container.resolve("Box4.IParagraphReader"),this.kb.Qc,{bwc:!0,W_:!1,b7c:!0,
a7c:!0,V_:!0})),S=new id.a(()=>new $s),ja=new id.a(()=>{const kb=new fb.a;kb.add(e.value);kb.add(n.value);kb.add(C.value);kb.add(S.value);return kb}),ya=new id.a(()=>new Nn.a(2,ja.value,null,3016,Jf.a.UZd));this.container.ia("WordEditor.Designer.UserIntentDialog.UserIntentDialog",()=>new dx(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"))).ha();this.container.ia("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager",
()=>new ex([ya.value],this.container.resolve("WordEditor.Designer.UserIntentDialog.UserIntentDialog"))).ha()}eqg(){const e=new id.a(()=>new hq(1,wg.a.xd(),this.$d.pgc())),n=new id.a(()=>new fh(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL,Jf.a.fZj)),C=[vh.DocumentTypeLabel.ManualsAndGuidelines,vh.DocumentTypeLabel.ContractsAndPolicies,vh.DocumentTypeLabel.ArticlesAndReports,vh.DocumentTypeLabel.JobDescription],S=new id.a(()=>new ax(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").vaa,
this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Jf.a.d5m,C)),ja=new id.a(()=>new hJ(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),Jf.a.k8f)),ya=new id.a(()=>new St(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),Jf.a.sEf,Jf.a.wdd)),kb=new id.a(()=>new Gl(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kPb,Jf.a.j8f)),Rb=new id.a(()=>new zv(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4,
this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),sc=new id.a(()=>new Ij(2,this.container.resolve("Box4.IParagraphReader"),this.kb.Qc,{bwc:!0,W_:!1,b7c:!0,a7c:!0,V_:!0})),Fc=new id.a(()=>new zm(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),gd=new id.a(()=>new gJ(10,G.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.IDesignerControl"))),td=new id.a(()=>new ax(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").vaa,
this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Jf.a.Kxf,[vh.DocumentTypeLabel.Letters])),Bd=new id.a(()=>new zv(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),wd=new id.a(()=>new jq(this.LM)),te=new id.a(()=>new $s),Le=new id.a(()=>new AC(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),Oe=new id.a(()=>new nj(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),
2,!1)),We=new id.a(()=>new go(this.$d.rtb()?Jf.a.Wwn:-1)),Xf=new id.a(()=>new zv(13,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A4,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),Gg=new id.a(()=>new Ij(13,this.container.resolve("Box4.IParagraphReader"),this.kb.Qc,{bwc:!0,W_:!1,b7c:!0,a7c:!0,V_:!0})),Ph=new id.a(()=>{const uk=new fb.a;uk.add(ja.value);uk.add(e.value);uk.add(ya.value);this.$d.ajn()&&uk.add(S.value);uk.add(n.value);uk.add(kb.value);
uk.add(Rb.value);return uk}),Aj=new id.a(()=>{const uk=new fb.a;uk.add(td.value);1===this.$d.R_d()?uk.add(Fc.value):uk.add(gd.value);uk.add(Bd.value);return uk}),Ih=new id.a(()=>{const uk=new fb.a;uk.add(wd.value);uk.add(te.value);this.$d.h0f()&&(uk.add(Le.value),uk.add(Oe.value));uk.add(We.value);uk.add(Xf.value);uk.add(Gg.value);return uk}),Nm=new id.a(()=>new SA(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),
this.$d.y0i())),Sk=new id.a(()=>new TA(this.container.resolve("WordEditor.Designer.Persistence.PersistenceHelper"))),hk=new id.a(()=>new ww(1,Ph.value,Nm.value)),al=new id.a(()=>{let uk;return new ww(2,(uk=new fb.a,uk.add(sc.value),uk),Nm.value)}),Cj=new id.a(()=>new ww(10,Aj.value,Nm.value,Sk.value)),Lg=new id.a(()=>new ww(13,Ih.value,Nm.value,null,new Iz("Jump-start proactive Designer Pane opening",Jf.a.UZd,Ij.Ljf))),mq=new id.a(()=>{const uk=new fb.a;(this.$d.R_d()||this.$d.lde())&&uk.add(Cj.value);
this.$d.hYf()&&uk.add(hk.value);this.$d.hVi()&&uk.add(al.value);this.$d.rtb()&&uk.add(Lg.value);return uk});this.container.ia("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager",()=>{let uk=new Ok(G.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"));this.$d.rtb()&&this.$d.p1f()&&(uk=new oE(this.container.Ta("Common.ISystemInitiatedFeedback"),Jf.a.Swn,new vw(Jf.a.Twn,uk,13)));return new zy(mq.value,Nm.value,uk)}).ha();this.container.ia("WordEditor.Designer.Proactive.IUserEngagementMonitor",
()=>new Gv(G.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha()}zvo(){const e=new nf,n=new id.a(()=>new ku(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),e)),C=new id.a(()=>new ud(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),e,this.container.Ta("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),
S=new id.a(()=>{const kb=new fb.a;kb.add(this.container.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"));kb.add(n.value);kb.add(C.value);return kb}),ja=new id.a(()=>new Nn.a(14,S.value,null,3016,Jf.a.l0m)),ya=new id.a(()=>{const kb=new fb.a;kb.push(ja.value);return kb});this.container.ia("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager",()=>new bg(ya.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),
e)).ha()}Ovo(){const e=new nf,n=new id.a(()=>new zm(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),C=new id.a(()=>new za(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("WordEditor.Designer.Review.IReviewTraverser"),e,this.kb.Qc)),S=new id.a(()=>new hq(8,wg.a.xd(),this.$d.pgc())),ja=new id.a(()=>new ta(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),
this.kb.Qc)),ya=new id.a(()=>new Pn(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dve,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),e)),kb=[vh.DocumentTypeLabel.ManualsAndGuidelines,vh.DocumentTypeLabel.ArticlesAndReports,vh.DocumentTypeLabel.DocumentsDesignedForPrinting,vh.DocumentTypeLabel.Forms,vh.DocumentTypeLabel.ListsAndNotes,vh.DocumentTypeLabel.Plans],
Rb=new id.a(()=>new ax(8,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").vaa,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Jf.a.Kxf,kb)),sc=new id.a(()=>new ud(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),e,this.container.Ta("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),Fc=new id.a(()=>new AC(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),
gd=new id.a(()=>{const te=new fb.a;te.add(n.value);te.add(C.value);te.add(Fc.value);te.add(S.value);te.add(ja.value);te.add(ya.value);te.add(sc.value);this.$d.Mtn()&&te.add(Rb.value);return te}),td=new id.a(()=>new hf(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Image.DesignerImageManagerImpl"),this.kb.Qc)),Bd=new id.a(()=>new Am(8,gd.value,td.value,Jf.a.pbk)),wd=new id.a(()=>{const te=new fb.a;te.add(Bd.value);return te});this.container.ia("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler",
()=>new Qe(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();this.container.ia("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager",()=>new bg(wd.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),e)).ha()}Uwo(){const e=new id.a(()=>new Eb(this.container.resolve("WordEditor.Designer.License.ILicenseManager"))),
n=new id.a(()=>new hq(9,wg.a.xd(),this.$d.pgc())),C=new id.a(()=>new zm(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),S=new id.a(()=>new Ij(9,this.container.resolve("Box4.IParagraphReader"),this.kb.Qc,{bwc:!1,W_:!1,b7c:!0,a7c:!0,V_:!0})),ja=[vh.DocumentTypeLabel.ManualsAndGuidelines,vh.DocumentTypeLabel.ArticlesAndReports,vh.DocumentTypeLabel.DocumentsDesignedForPrinting,vh.DocumentTypeLabel.Forms,vh.DocumentTypeLabel.JobDescription,
vh.DocumentTypeLabel.ListsAndNotes,vh.DocumentTypeLabel.Plans],ya=new id.a(()=>new ax(9,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").vaa,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Jf.a.Kxf,ja)),kb=new id.a(()=>new oc(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Lgc,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").eYb,this.container.resolve("WordEditor.Designer.DocumentInfo"),
this.kb.Qc,this.container.resolve("Box4.ISelectionManager"),this.container.resolve("Box4.IParagraphIteratorFactory"))),Rb=new id.a(()=>new AC(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),sc=new id.a(()=>{const Bd=new fb.a;Bd.add(e.value);Bd.add(C.value);Bd.add(n.value);Bd.add(Rb.value);Bd.add(S.value);Bd.add(ya.value);Bd.add(kb.value);return Bd}),Fc=new id.a(()=>new lh(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"))),gd=new id.a(()=>new ww(9,sc.value,
Fc.value)),td=new id.a(()=>{const Bd=[];Bd.push(gd.value);return Bd});this.container.ia("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager",()=>new Sf(td.value,this.container.resolve("WordEditor.Designer.Style.PullQuotesManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").eYb,this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
this.container.Ta("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha()}A3j(){const e=ib.StaticActiveAppFrame.za().kb.Qc;(null===e||void 0===e?0:e.ps)||E.ULS.sendTraceTag(529268809,3016,10,"AutoScroller not defined");return null===e||void 0===e?void 0:e.ps}Ho(){this.$d.tN()?this.LM.Sk(16,()=>{this.s7c()}):this.s7c()}s7c(){By(Jf.a.zsj);this.$d.isEnabled()!==ju.a.tpc()&&E.ULS.shipAssertTag(541169756,3016,!1,`${this.$d.isEnabled()}, ${ju.a.tpc()}`);
this.$d.isEnabled()&&(this.kb.uBa?this.d8c():this.kb.Qja(this.K8))}WCm(){const e="WordEditor.Designer.License.ILicenseManager WordEditor.Designer.Style.IDocumentLanguageManager WordEditor.Designer.Errors.IErrorStateManager WordEditor.Designer.Pane.IPaneLoadingManager WordEditor.Designer.Settings.IDesignerSettingsManager WordEditor.Designer.AL.IWorkflowManager WordEditor.Designer.OnCanvas.OnCanvasInitializer WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager".split(" ");this.container.ia("WordEditor.Designer.OnCanvas.OnCanvasInitializer",
()=>new uw(this.container.resolve("Box4.Indicator.IIndicatorManager"),this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.Designer.OnCanvas.HighlightActor"),this.container.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),this.container.resolve("WordEditor.Designer.OnCanvas.ReviewSelectionManager"),this.container.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.container.resolve("Box4.IParagraphReader"),this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();
this.$d.Bin()&&e.push("WordEditor.Designer.FRE.IFirstRunExperienceManager");this.$d.bde()&&!this.$d.fzb()&&e.push("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager");this.$d.VAg()&&(e.push("WordEditor.Designer.Proactive.ProactiveTriggerInitializer"),this.container.ia("WordEditor.Designer.Proactive.ProactiveTriggerInitializer",()=>new Ev(this.container.resolve("WordEditor.Designer.Proactive.IUserEngagementMonitor"),this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),
this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());this.$d.bma()&&!this.$d.rtb()&&e.push("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial");this.$d.z0i()&&e.push("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2");this.$d.IWi()&&e.push("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager");this.$d.lXf()&&e.push("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager");
this.$d.H0i()&&e.push("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager");this.$d.fzb()&&e.push("WordEditor.Designer.SmartPaste.SmartPasteManager");this.$d.N0f()&&e.push("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager");this.$d.lde()&&e.push("WordEditor.Designer.DocumentStatsDnmLogger");return e}XCm(){const e=["WordEditor.Designer.Wire.IDesignerPropsUpdater","WordEditor.Designer.Trackers.IDesignerUndoTracker","WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",
"WordEditor.Designer.Logging.IConsistencyFixActionsLogger","WordEditor.Designer.Logging.IBlankDocumentLogger"];this.$d.Bce()&&e.push("WordEditor.Designer.Style.ITableManager");return e}VCm(){const e=["WordEditor.Designer.Style.IThemeGenerator"];this.$d.VAg()&&(e.push("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer"),this.container.ia("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer",()=>new Gs(this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());
return e}d8c(){const e=this.container.resolve("WordEditor.Designer.Perf.IPerfLogger");e.le(()=>{const n=new Map;n.set(0,this.WCm());n.set(2,this.XCm());n.set(1,this.VCm());n.set(3,[]);const C=[this.container.resolve("WordEditor.Designer.Actors.DesignerActor"),this.container.resolve("WordEditor.Designer.Actors.DesignerActionActor")];this.$d.fzb()&&C.push(this.container.resolve("WordEditor.Designer.Actors.DesignerPasteActor"));this.iSl.kFl(this.container,n,C,e,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal")).dkf()},
"WD:II")}}Object(F.a)(zG,"DesignerPackageManager",null,[0,1]);var aB=d(978),Rn=d(1861),Gq=d(956),ei=d(1412);class Jv{}Jv.vii="https://nleditor.osi.officeppe.net";Jv.sii="https://nleditor.osi.office.net";Jv.ZQh=[ei.a.lRh,ei.a.Sif,ei.a.v_h,ei.a.W_h,ei.a.Gof,ei.a.k5h,ei.a.qzl,ei.a.V6h,ei.a.ihi,ei.a.LBf,ei.a.kti,ei.a.I0m,ei.a.N0m,ei.a.MOi,ei.a.oPi,ei.a.pPi,ei.a.PSf,ei.a.iUi,ei.a.rBn,ei.a.Xgj,ei.a.hoe,ei.a.Yfd,ei.a.Dpj,ei.a.l7n,ei.a.Shg,ei.a.PXb,ei.a.Efo,ei.a.oBj,ei.a.eug,ei.a.n0o,ei.a.VYj,ei.a.xip,ei.a.szc,
ei.a.f2j,ei.a.R2j,ei.a.H4j,ei.a.Kud];Object(F.a)(Jv,"MessengerConstants",null,[]);var ti=d(881),ou=d(10),wt=d(399),JC=d(166),fx=d(242),KC=d(69);d(868);var pJ=d(463);class bB{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We){this.k7e=()=>{setTimeout(()=>{this.cqh&&Object(ti.o)("SelectionPointerUp")},100);return!0};this.wwg=Xf=>{Xf&&Xf.Lb.keyCode===Vo.a.O2b?this.R2a.flag&&(Object(ti.o)("FocusOnInputNotif"),this.R2a.flag=!1):Xf&&Xf.Lb.keyCode===Vo.a.J4&&Object(ti.o)("FocusOutOfEditor");
return!0};this.gbf=(Xf,Gg)=>{Xf=Xf.getByTag(Gg);const Ph=[];for(let Aj=0;Aj<Xf.length();Aj++){const Ih=Xf._GetItem(Aj);Ph.push(Ih.id)}this.dRa.set(Gg,Ph)};this.m1=n;this.iF=C;this.aya=gd;this.ib=Le;this.Cj=Oe;this.Yc=S;this.ld=ja;this.Dk=ya;this.Ee=kb;this.lW=Rb;this.aea=sc;this.zo=Fc;this.Aia=td;this.H1=[];this.ZOc=[];this.dWe=this.x6b=this.mgh=this.qJc=this.dlh=this.VQa=this.cqh=!1;this.R2a={flag:!1};this.L$b=[];this.qGh=[];this.dRa=new Map;this.B6b=new Map;this.A6b=new Map;this.sh=Bd;this.VRa=
wd;this.hb=te;this.ga=We;this.y5c=this.y5c.bind(this);this.fwe=this.fwe.bind(this);this.dKg=this.dKg.bind(this);this.tkm();this.AJm();this.MPo();this._frame=G.AFrameworkApplication.ua;this.Cj.mode=0;this.Aia.vKb(this.fwe);this.ib.AB(this.y5c);this._frame&&(this._frame.YE.ub(ou.a.gi,this._frame.get_element(),ti.s),this._frame.YE.ub(ou.a.rLb,this._frame.get_element(),this.k7e));Object(ti.k)()&&this.ga.qa(ha.a.DSi,X.a.frame,this.Jbn.bind(this));G.AFrameworkApplication.Zef(this.sMi)}tkm(){Object(ti.o)("GetCAAEPlaceholders",
JSON.stringify({["sessionId"]:G.AFrameworkApplication.userSessionId}))}Jbn(e,n,C){2===C&&Object(ti.o)("InsertSnippetPanel");return 32}AJm(){Object(ti.o)("GetSPOReflowFlag")}iwp(e,n,C){(e=e.getByTag(C).getFirst())&&0<=n?(this.VQa=!0,e=e.JFg,0<=n&&KC.TableViewElementProperties.Fxg(e,n,n)):this.VQa=!1}MPo(){Object(ti.o)("DocumentGenLoaded")}sMi(e,n){Object(ti.o)("SendWordErrorDetails",JSON.stringify(n))}fwe(){let e=new Gq.a("CAAEMessage");e.SendTime=Date.now();e=Object(ti.n)(e,JSON.stringify({editHappened:!0}),
"EditHappenedInDocument");window.parent.postMessage(JSON.stringify(e),this.aya)}ZPo(){const e=this.m1.create().body.getHtml();Object(ti.o)("HtmlForDocument",e)}RQo(){const e=this.m1.create().body.text;Object(ti.o)("DocTextForSuggestions",e)}rQo(){const e=this.m1.create(),n=[];if(e.body.paragraphs)for(let C=0;C<e.body.paragraphs.length();C++)e.body.paragraphs._GetItem(C).text&&n.push(e.body.paragraphs._GetItem(C).text);Object(ti.o)("DocTextForRePrompt",JSON.stringify(n))}tQo(){const e=this.m1.create(),
n=this.fpa(e),C=[];[...this.B6b.values()].forEach(S=>{const ja=n.getByTag(S.tagId),ya=[];for(let kb=0;kb<ja.length();kb++)ya.push(ja._GetItem(kb).id);ya&&ya.length&&C.push({...S,jWp:ya})});Object(ti.o)("SendPlaceholderSuggestions",JSON.stringify(C))}y5c(){if(!this.qJc){var e=this.m1.create(),n=new Gq.a("CAAEMessage");n.SendTime=Date.now();var C=e.uKm();if("NoSelection"!==C)if("TextBoxSelection"===C)n.Values.payload="TextBoxSelection",n.Values.Action="UnSuccessfulSelectionV2",window.parent.postMessage(JSON.stringify(n),
this.aya);else{C=e.getSelection();var S=C.contentControls,ja=this.ib.gb.currentSelection,ya=ja.length,kb=C.parentTableOrNullObject,Rb=this.ib.Pg,sc=ja.Xe,Fc;if(!(Fc=w(ja,C,S.length(),this.R2a,n,this.aya,void 0,this.x6b))&&(Fc=null!==Rb))a:{var gd=S.length();Fc=n;var td=this.aya,Bd=this.ib.gb,wd=this.VQa,te=this.ld,Le=this.R2a,Oe=this.x6b,We,Xf,Gg=Object(JC.a)().lU(Rb,14);if(null!==Gg&&1===Gg.length){Rb=Object(JC.a)().lU(Rb,16);var Ph=!0;if(kb){var Aj=null===(We=null===kb||void 0===kb?void 0:kb.getCell(0,
0))||void 0===We?void 0:We.body.contentControls;for(We=0;We<(null===Aj||void 0===Aj?void 0:Aj.length());We++)if(Aj._GetItem(We).tag.endsWith("TableSelection")){Ph=!1;break}}if(1===Rb.length&&Ph&&(Oe||0===gd))if(sc=null===(Xf=Rb.getContext(0))||void 0===Xf?void 0:Xf.node,0!==C.text.length&&!wd&&sc&&te.HOf(sc).trim()===C.text.trim()&&Object(ti.b)(Bd.currentSelection)){if(Fc.Values.payload=C.text,Fc.Values.type="TableCellSelection",Fc.Values.Action="SuccessfulSelectionV2",Le.flag=!0,Oe){window.parent.postMessage(JSON.stringify(Fc),
td);Fc=!1;break a}}else{Fc=!1;break a}else if(Xf=new Ed.a,null!==sc&&null!==sc.Qa&&null!==sc.Xc){Xf.set(sc.Qa.node);Xf.zb(14);var Ih=Xf.kd(14);Xf=fx.TableBorderSelectionCache.oca;b:{kb=Ih;fx.TableBorderSelectionCache.x7c(kb);Gg=fx.TableBorderSelectionCache.oca;We=Gg.leftMostColumnSelected;Bd=Gg.rightMostColumnSelected;te=Gg.topMostRowSelected;Gg=Gg.bottomMostRowSelected;for(Ph=0;Ph<Rb.length;Ph++){if(Rb.getContext(Ph).contextId!==Ma.a.ix){kb=!1;break b}Aj=Rb.getContext(Ph).node;if(!Uh.TableCellReader.gr(Aj)){const Nm=
new Ed.a;Nm.set(Aj);if(Nm.zb(14)&&nh.getContainingTable(Nm)===kb){Nm.kd(14);Aj=Uh.TableCellReader.WJa(Nm,Aj);if(!Aj){kb=!1;break b}We=Math.min(We,Aj.pp);Bd=Math.max(Bd,Aj.pp);te=Math.min(te,Aj.rowIndex);Gg=Math.max(Gg,Aj.rowIndex)}}}kb={leftMostColumnSelected:We,rightMostColumnSelected:Bd,topMostRowSelected:te,bottomMostRowSelected:Gg}}Xf="boolean"!=typeof kb?kb.bottomMostRowSelected-kb.topMostRowSelected:Xf.bottomMostRowSelected-Xf.topMostRowSelected;"boolean"==typeof kb||0!==gd||null===Ih||0!==
kb.leftMostColumnSelected||kb.rightMostColumnSelected!==Pd.TableReader.Eh(Ih)-1||Xf!==Pd.TableReader.vg(Ih)-1||sc.Qa.contextId!==Ma.a.Mu&&sc.Qa.contextId!==Ma.a.ix||sc.Xc.contextId!==Ma.a.Mu&&sc.Xc.contextId!==Ma.a.ix?wd||(Fc.Values.payload="MultipleContext",Fc.Values.Action="UnSuccessfulSelectionV2"):(Fc.Values.payload="TableSelection",Fc.Values.type="TableSelection",Fc.Values.Action="SuccessfulSelectionV2",Le.flag=!0,Oe&&(Fc.Values.payload=JSON.stringify({text:"TableSelection",typeOfField:{regular:!0,
conditional:!1}})))}else{if(null!==Gg&&1<Gg.length){Fc.Values.payload="MultipleContext";Fc.Values.Action="UnSuccessfulSelectionV2";window.parent.postMessage(JSON.stringify(Fc),td);Fc=!0;break a}if(kb&&null!==Gg&&1===Gg.length&&C.text){sc=null===(Ih=null===kb||void 0===kb?void 0:kb.getCell(0,0))||void 0===Ih?void 0:Ih.body.contentControls;for(wd=0;wd<(null===sc||void 0===sc?void 0:sc.length());wd++)if(sc._GetItem(wd).tag.endsWith("TableSelection")){Fc.Values.payload="TableCellSelection";Fc.Values.Action=
"UnSuccessfulSelectionV2";window.parent.postMessage(JSON.stringify(Fc),td);Fc=!0;break a}Fc=!1;break a}}window.parent.postMessage(JSON.stringify(Fc),td);Fc=!0}else Fc=void 0}if(!Fc)if(Fc=Object(ti.c)(ja),1<ya&&!this.x6b)n=Object(ti.m)(n,"MultipleContext"),window.parent.postMessage(JSON.stringify(n),this.aya);else if(ya)if(td=this.VQa?!0:""!==C.text&&C.EUf(!0),this.x6b)n=Object(ti.a)(n,ja,Fc,td,C.text,S,this.R2a),(e=this.mjh(C,e,ja))&&"UnSuccessfulSelectionV2"!==n.Values.Action&&(n.Values.payload=
e.Values.payload,n.Values.Action=e.Values.Action),window.parent.postMessage(JSON.stringify(n),this.aya);else if(1==ya){n=Object(ti.e)(n,Fc,td,C.text,S.length(),this.R2a);if(e=this.mjh(C,e,ja))n.Values.payload=e.Values.payload,n.Values.Action=e.Values.Action;window.parent.postMessage(JSON.stringify(n),this.aya)}}}}mjh(e,n,C){const S=new Gq.a("CAAEMessage");if(0===e.text.length&&C.K(0).contextId===Ma.a.Vc||1===e.text.length&&("\r"===e.text||"\n"===e.text))return S.Values.Action="EmptySelection",this.R2a.flag=
!1,S.Values.payload=this.Mhh(this.fpa(n)),this.Lhh(this.fpa(n)),S}byk(e){const n=new Gq.a("CAAEMessage");n.Values.Action="EmptySelection";this.R2a.flag=!1;n.Values.payload=this.Mhh(this.fpa(e));this.Lhh(this.fpa(e));return n}Mhh(e){const n=new Set;this.H1.forEach(C=>{let S=e.getByTag(C);for(let ja=0;ja<S.length();ja++){const ya=S._GetItem(ja);void 0!==ya.qXj&&""!==ya.getRange(0).text||ya.deleteContentControl(!0)}S=e.getByTag(C);0===S.length()&&n.add(C)});0!==n.size&&(this.H1=this.H1.filter(C=>!n.has(C)));
return Array.from(n)}Lhh(e){const n=new Map;let C=!1;for(const [S,ja]of this.dRa){const ya=ja.filter(kb=>null!==e.getByIdOrNullObject(kb));ja.length!==ya.length&&(C=!0);n.set(S,ya)}C&&(this.dRa=n,Object(ti.v)(n))}Jtd(e){return e&&e.title&&e.tag?!0:(E.ULS.sendTraceTag(541403280,2250,10,"Malformed CaaeMessagePlaceholder"),!1)}Ytj(e){const n=new Gq.a("CAAEMessage");n.Values.payload=e;n.SendTime=Date.now();window.parent.postMessage(JSON.stringify(n),this.aya)}q9h(e,n,C,S,ja){if(this.Jtd(n)){var ya=e.parentTableOrNullObject;
{var kb=this.ib;var Rb=kb.Pg;kb=kb.gb.currentSelection.Xe;Rb=Object(JC.a)().lU(Rb,14);const sc=new Ed.a;null!==kb&&null!==Rb&&1===Rb.length&&null!==kb&&null!==kb.Qa&&null!==kb.Xc?(sc.set(kb.Qa.node),sc.zb(14),kb=sc.kd(14)):kb=void 0}Rb=kb;kb=!1;"Image"===C&&(kb=w(this.ib.gb.currentSelection,e,e.contentControls.length(),this.R2a,void 0,void 0,!0,this.x6b));if(!kb&&ya&&"Table"===C&&Rb)return C=ya.getCell(0,0).body.getRange(2).insertContentControl(),C.text=" ",C.LR="Committed",C.title=n.title,C.appearance=
2,C.tag=n.tag,this.H1.push(n.tag),!0;ya=e.parentTableOrNullObject;if(!kb&&ya&&"TableCell"===C){C=e.text.trim();ya=pc.a.lyc(C);e.insertText(" ",4);C=e.getRange(2).insertContentControl();for(kb=0;kb<ya.length;kb++)0==kb?C.insertText(ya[kb],4):C.insertText(" "+ya[kb],3);C.LR=S?"Committed":"Highlighted";1===ya.length&&""===ya[0]?C.insertText(" ",2):C.insertText("",2);e.insertText("",4)}else C=e.insertContentControl(),S?Object(ti.w)(C,"Committed"):Object(ti.w)(C,"Highlighted"),Object(ti.y)(C,2,"");C.title=
n.title;C.appearance=2;C.tag=n.tag;this.H1.push(n.tag);ja&&S&&(ja.id=C.id);return!0}}dKg(e){const n=this.m1.create(),C=this.fpa(n);e.map(S=>{S=C.getByTag(S);for(let ja=0;ja<S.length();ja++){const ya=S._GetItem(ja);ya.appearance=2;ya.insertText("",2);x(this.Ee,ya,!0,this.dWe);Object(ti.w)(ya,"Highlighted")}})}qZl(e,n,C){if(this.Jtd(n)&&(e=e.getByTag(n.tag),1<=e.length()))for(let S=0;S<e.length();S++){const ja=e._GetItem(S);ja.title=n.title;C&&(this.ZOc=[],Object(ti.w)(ja,"Highlighted"),ja.insertText("",
2))}}f1m(e,n){if(this.dlh&&("hyperlink"===e.datatype||"email"===e.datatype)){let C=n.getRange(0).Xo.K(0);n.zg&&(C=ce.a.createTextRange(C.node,0,Af.ParagraphReader.textLength(C.node)));this.iF.wF(C,"email"===e.datatype?"mailto:"+e.title:e.title,!1)}}N7l(e,n){n.map(C=>{var S;const ja=e.getByTag(C.tag);if(1<=ja.length())for(let ya=0;ya<ja.length();ya++){const kb=ja._GetItem(ya);C.title&&(x(this.Ee,kb,"true"===(null===(S=C.title)||void 0===S?void 0:S.toLowerCase())?!1:!0,this.dWe),Object(ti.w)(kb,"Filled"))}})}E7l(e,
n){n.map(C=>{const S=e.getByTag(C.tag);if(1<=S.length()){var ja=!1;for(let We=0;We<S.length();We++){const Xf=S._GetItem(We);if(C.title)if(Xf.tag.endsWith("TableSelection")){if(!ja){var ya=void 0,kb=void 0,Rb=Xf;ja=this.Yc;var sc=this.Dk,Fc=this.lW,gd=this.aea,td=this.zo,Bd=this.iF,wd=C.tableValues,te=C.tableValuesDataTypes;kb=Object.keys(wd).length;var Le=Rb.JFg;ya=Pd.TableReader.vg(Le);if(Le){const Gg=Pd.TableReader.wy(Le,0,ya-1);Rb=Gg.K(0);Rb=Ly.a.o9c(Rb);const Ph=Pd.TableReader.vg(Le);if(2<ya){var Oe=
Gg.K(2);Oe=new ce.a(Oe,Ma.a.Mu);G.AFrameworkApplication.va.Hf(Oe,pe.a.deleteRow,2,!1,new wt.a,Ph-2)}Rb||1!==kb?(ya=1===ya?Gg.K(0):Gg.K(1),ya=new ce.a(ya,Ma.a.Mu),kb=G.AFrameworkApplication.va.Hf(ya,pe.a.s$a,2,!1,new wt.a,Rb?kb:kb-1)):kb=32;if(32===kb){kb=Pd.TableReader.wy(Le,0,Pd.TableReader.vg(Le)-1);Rb||(Le=kb.K(0),Le=Ly.a.KA(Le),l(ja,sc,Fc,gd,td,Bd,Le,wd[0],te[0]));Le=1===Ph?1:2;for(Le;Le<kb.count;Le++)ya=kb.K(Le),ya=Ly.a.KA(ya),1===Ph?l(ja,sc,Fc,gd,td,Bd,ya,Rb?wd[Le-1]:wd[Le],Rb?te[Le-1]:te[Le]):
l(ja,sc,Fc,gd,td,Bd,ya,Rb?wd[Le-2]:wd[Le-1],Rb?te[Le-2]:te[Le-1]);1<kb.count&&1<Ph&&(ja=kb.K(1),ja=new ce.a(ja,Ma.a.Mu),G.AFrameworkApplication.va.Hf(ja,pe.a.deleteRow,2,!1,new wt.a,1))}}ja=!0;Object(ti.w)(Xf,"Filled");Xf.insertText("",2);Object(ti.o)("FilledValueContentControl","Updated value")}}else"string"===typeof C.title&&C.tag===Xf.tag?(Xf.tag.endsWith("ImageSelection")&&C.imageProperties&&C.imageProperties.imageUrl?(C.imageProperties={...C.imageProperties,altText:C.title},z(Xf,C.imageProperties)):
"RichMultiText"===C.datatype?(Object(ti.w)(Xf,"Filled"),Xf.insertHtml(C.title,4)):C.title!==Xf.text&&(Object(ti.w)(Xf,"Filled"),Xf.text=C.title,this.f1m(C,Xf)),Object(ti.o)("FilledValueContentControl","Updated value")):(Object(ti.w)(Xf,"Filled"),Object(ti.o)("FilledValueContentControl"));else Object(ti.w)(Xf,"Highlighted"),Xf.insertText("",2)}}})}deleteContentControl(e,n){if(this.Jtd(n)&&(e=e.getByTag(n.tag),1<=e.length())){for(let C=0;C<e.length();C++)e._GetItem(C).deleteContentControl(!0);this.H1=
this.H1.filter(C=>C!==n.tag)}}hRl(){if(0<this.L$b.length){const e=this.m1.create();for(let n=0;n<this.L$b.length;n++){const C=e.contentControls.getByTag(this.L$b[n]);C&&C.length()&&C._GetItem(0).deleteContentControl(!0)}}}BNo(e,n){this.Jtd(n)&&(e=e.getByTag(n.tag),1<=e.length()&&(e=e._GetItem(0).qXj,e=Uk.SelectionFactory.ue(e,0),Kf.a.instance.Kc(e),Object(ti.o)("FilledValueContentControl","Updated value")))}Z$d(e,n,C,S){if(this.Jtd(n))if(e=e.getByTag(n.tag),S){if(S=e.getByIdOrNullObject(S.id))"Hover"===
C?m(S):"Highlight"===C&&f(S),S.insertText("",2)}else if(1<=e.length())for(S=0;S<e.length();S++)n=e._GetItem(S),"Hover"===C?m(n):"Highlight"===C&&f(n),n.insertText("",2)}Rop(e){let n=e.textOffset;var C=Gi.a.Np();C=this.hb.Zm(C);C=this.VRa.gUa(C,!1,!1);let S;do{const ja=C.DA;if(ja){const ya=Af.ParagraphReader.textLength(ja);n>ya?0<ya&&(n=n-ya-2):Af.ParagraphReader.text(ja).substring(n,n+e.name.length).toLowerCase()===e.name.toLowerCase()&&(S=ce.a.createTextRange(ja,n,n+e.name.length),this.EXm(S,e))}}while(C.Ala()&&
!S)}a1m(){this.B6b.forEach(e=>{e.tagId&&(this.A6b.get(e.tagId).forEach(n=>{const C=new fb.a;C.add(n);this.sh.ngf(C);this.sh.t5a(n,this.lW,void 0,!0)||(n=this.sh.t5a(n,this.lW),Object(ti.w)(n,"Highlighted"),Object(ti.y)(n,2,""),n.title=e.name,n.appearance=2,n.tag=e.tagId)}),this.H1.push(e.tagId))})}EXm(e,n){if(this.B6b.has(n.name)){if({tagId:n}=this.B6b.get(n.name),n&&this.A6b.has(n)){var C=this.A6b.get(n);C.push(e);this.A6b.delete(n);this.A6b.set(n,C)}}else C=Math.floor(1E6*Math.random()+1).toString(),
this.B6b.set(n.name,{...n,tagId:C}),this.A6b.set(C,[e])}jD(e){const n=this.m1.create();var C=this.fpa(n),S={id:void 0};switch(e.Values.Action){case "RemoveContentControlAck":C=this.byk(n);window.parent.postMessage(JSON.stringify(C),this.aya);break;case "CreateContentControlForTableCell":var ja=n.getSelection();C=e.Values.Placeholder;var ya="PlaceholderV2"===e.Values.type;e=e.Values.source;this.VQa=!0;this.qJc=ya;this.q9h(ja,C,"TableCell",ya,S);this.ib.Kc(Ge.a.vk(this.ib.gb.currentSelection,!1,!0,
void 0,!1));this.VQa=this.qJc=!1;ya&&(ja=this.m1.create(),ja=this.fpa(ja),void 0===e||"Panel"===e?Object(ti.h)(ja,C,S.id):"PlaceholderCard"===e&&Object(ti.q)(ja,C),this.gbf(ja,C.tag));break;case "UpdateTableColumnHighlight":S=e.Values.MessageContent;e=e.Values.Placeholder;e.tag.endsWith("TableSelection")&&this.iwp(C,S,e.tag);break;case "GetTableColumnDetails":e=e.Values.Placeholder;e.tag.endsWith("TableSelection")&&a(C,e.tag);break;case "FetchSelection":C=e.Values.Placeholder;e=this.m1.create();e=
this.fpa(e);Object(ti.h)(e,C,void 0);break;case "CreateContentControl":ya=n.getSelection();C=e.Values.Placeholder;ja=e.Values.source;this.qJc=e="PlaceholderV2"===e.Values.type;var kb=Object(ti.g)(C.tag);ya=this.q9h(ya,C,kb,e,S);this.VQa=!0;ya&&this.ib.Kc(Ge.a.vk(this.ib.gb.currentSelection,!0,!1,void 0,!0));this.VQa=this.qJc=!1;e&&(e=this.m1.create(),e=this.fpa(e),void 0===ja||"Panel"===ja?Object(ti.h)(e,C,S.id):"PlaceholderCard"===ja&&Object(ti.q)(e,C),this.gbf(e,C.tag));break;case "CancelWACContentControlCreation":this.VQa=
!0;this.ib.Kc(Ge.a.vk(this.ib.gb.currentSelection,!0,!1,void 0,!0));this.VQa=!1;break;case "EditContentControl":this.qZl(C,e.Values.Placeholder,e.Values.type);break;case "FillConditionalAnswers":this.N7l(C,e.Values.Placeholder);break;case "FillValueForContentControl":this.E7l(C,e.Values.Placeholder);break;case "DeleteContentControl":e=e.Values.Placeholder;this.deleteContentControl(C,e);this.dRa.delete(e.tag);break;case "RemoveSelections":S="AllCommited"===e.Values.type;ja="All"===e.Values.type;const Rb=
e.Values.Placeholder;if("Single"===e.Values.type&&e.Values.MessageContent){const sc=Object(ti.f)(JSON.parse(e.Values.MessageContent));this.H1=Object(ti.p)(Rb,C,this.H1,this.ZOc,void 0,sc);0===C.getByTag(Rb.tag).length()?this.H1=this.H1.filter(Fc=>Fc!==Rb.tag):(C=this.dRa.get(sc.tag))&&this.dRa.set(sc.tag,C.filter(Fc=>Fc!=sc.id))}else S?(this.H1=(e=e.Values.PreviousPlaceholderTag)?Object(ti.p)(Rb,C,this.H1,this.ZOc,"Committed",void 0,e):Object(ti.p)(Rb,C,this.H1,this.ZOc,"Committed",void 0),C=this.m1.create(),
C=this.fpa(C),e&&this.dRa.delete(Rb.tag),this.gbf(C,e?e:Rb.tag),Object(ti.u)(e?e:Rb.tag,this.dRa.get(e?e:Rb.tag))):ja&&(this.H1=Object(ti.p)(Rb,C,this.H1,this.ZOc,void 0,void 0),this.dRa.delete(Rb.tag));break;case "GetHTML":this.Ytj(n.getSelection().getHtml());break;case "GetSelectedText":this.Ytj(n.getSelection().text);break;case "ScrollToContentControl":e=e.Values.Placeholder;this.mgh&&this.BNo(C,e);break;case "HighlightHoveredContentControl":S=e.Values.Placeholder;(e=e.Values.MessageContent)?(e=
Object(ti.f)(JSON.parse(e)),this.Z$d(C,S,"Hover",e)):this.Z$d(C,S,"Hover");break;case "UnhighlightHoveredContentControl":S=e.Values.Placeholder;(e=e.Values.MessageContent)?(e=Object(ti.f)(JSON.parse(e)),this.Z$d(C,S,"Highlight",e)):this.Z$d(C,S,"Highlight");break;case "PublishSaveTemplate":Qc.a.iU(Sb.a.Dec,!1,sc=>{sc={["data"]:sc,["sessionId"]:G.AFrameworkApplication.userSessionId,["sortedPlaceholderTags"]:this.fpa(n).getContentControls().map(Fc=>Fc.tag)};Object(ti.o)("ReceiveSuccessPublishSaveTemplate",
JSON.stringify(sc))},(sc,Fc)=>{Object(ti.o)("ReceiveFailurePublishSaveTemplate",JSON.stringify({["data"]:sc,["statusCode"]:pJ.a[Fc],["sessionId"]:G.AFrameworkApplication.userSessionId}))},null);break;case "SendPlaceholderCCDetails":S=e.Values.MessageContent;this.mgh=e.Values.isScrollDocEnabled;this.dlh=e.Values.highlightHyperlinkAndEmail;this.x6b=e.Values.isConditionalFieldsEnabled;this.dWe=e.Values.isDocGenLoaded;this.H1=S;G.AFrameworkApplication.$c("DeleteStaleCCsTreatment;DeleteStaleCCsControl");
G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CADeleteStaleCCsEnabled",!1)&&this.jtk(n,S);S&&0<S.length&&this.dKg(S);Object(ti.o)("EditFlowContentControlsLoaded",JSON.stringify({["sessionId"]:G.AFrameworkApplication.userSessionId}));e=new Map;this._frame&&(this._frame.YE.xc(ou.a.gi,this._frame.get_element(),ti.s),this._frame.YE.ub(ou.a.gi,this._frame.get_element(),this.wwg));for(ja=0;ja<S.length;ja++){ya=C.getByTag(S[ja]);kb=[];for(let sc=0;sc<ya.length();sc++)kb.push(ya._GetItem(sc).id);
e.set(S[ja],kb)}this.dRa=new Map(e);Object(ti.r)(e);break;case "CloseTemplateStudio":this.ib.gna(this.y5c);G.AFrameworkApplication.PBo(this.sMi);this._frame&&(this._frame.YE.xc(ou.a.gi,this._frame.get_element(),this.wwg),this._frame.YE.xc(ou.a.rLb,this._frame.get_element(),this.k7e));break;case "SendAckForDocGenLoaded":this.ib.gna(this.y5c);this._frame&&(this._frame.YE.xc(ou.a.gi,this._frame.get_element(),this.wwg),this._frame.YE.xc(ou.a.rLb,this._frame.get_element(),this.k7e),this._frame.YE.ub(ou.a.gi,
this._frame.get_element(),ti.t));break;case "SPOInReflowMode":this.cqh=e.Values.MessageContent;break;case "DisableEditDocCheck":this.Aia.Jte(this.fwe);break;case "AddContentToDocument":this.m1.create().body.insertHtml(e.Values.Content,4);this.L$b=e.Values.ContentControlIds;this.qGh=e.Values.BreaksCount;Object(ti.o)("UpdatedContent");break;case "ReceivedUpdatedContent":C=this.m1.create();for(e=0;e<this.L$b.length;e++)for(S=0;S<this.qGh[e];S++)C.body.paragraphs._GetItem(e+S).text.length&&(ja=C.body.paragraphs._GetItem(e+
S).insertContentControl(),ja.tag=this.L$b[e],ja.appearance=2);break;case "DeleteSectionFromTemplate":C=this.m1.create().contentControls.getByTag(e.Values.ContentControlId);for(e=0;e<C.length();e++)C._GetItem(e).deleteContentControl(!1);break;case "EditSectionInTemplate":C=this.m1.create();S=e.Values.ContentControlId;ja=C.contentControls.getByTag(S);for(ya=1;ya<ja.length();ya++)ja._GetItem(ya).deleteContentControl(!1);C.contentControls.getByTag(S)._GetItem(0).text=e.Values.NewSectionText;break;case "GetHtmlForDocument":this.ZPo();
break;case "GetDocTextForSuggestions":this.hRl();this.RQo();break;case "GetDocTextForRePrompt":this.rQo();break;case "GetSuggestionsForFields":C=e.Values.MessageContent;this.B6b=new Map;if(C&&0<C.length)for(e=0;e<C.length;e++)this.Rop(C[e]);this.a1m();this.tQo();break;case "GetDocContentControls":C={["sessionId"]:G.AFrameworkApplication.userSessionId,["placeholderTags"]:C.getContentControls().map(sc=>sc.tag)},Object(ti.o)("SendDocContentControls",JSON.stringify(C))}}fpa(e){G.AFrameworkApplication.$c("ccHeaderFooterTreatment;ccHeaderFooterControl");
return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CAHeaderFooterCCEnabled",!1)?e.contentControls:e.body.contentControls}jtk(e,n){const C=this.fpa(e);C.getContentControls().map(S=>S.tag).filter(S=>S&&S.startsWith("msca")&&0>n.indexOf(S)).forEach(S=>{var ja;S=C.getByTag(S);for(let ya=0;ya<S.length();ya++)null===(ja=S._GetItem(ya))||void 0===ja?void 0:ja.deleteContentControl(!0)})}}Object(F.a)(bB,"CaaeMessageHandler",null,[1094]);class AG{constructor(e,n,C,S,ja,ya,kb,
Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We){this.mlb=null;this.vv=e;this.GCd=n;this.Mpk=new bB(this,C,S,ja,ya,kb,Rb,sc,Fc,gd,n,td,Bd,wd,te,Le,Oe,We);this.vv.Lja(Jv.vii);this.vv.Lja(Jv.sii);this.GCd!==aB.a.lmb&&(this.vv.Lja(this.GCd),this.Ur("CAAEMessage",this.Mpk))}Ur(e,n){E.ULS.sendTraceTag(541405831,2250,50,"Attempting to register a handler for MessageTypeId [{0}].",e);if(e&&""!==e)if("CAAEMessage"!==e)E.ULS.sendTraceTag(540357400,2250,10,"Attempted to register MessageTypeId other than CAAEMessage");else if(n){var C=
!1;this.vv.isEnabled()&&(this.vv.Bv(e),C=this.vv.LE(e,n.jD.bind(n)));C||E.ULS.sendTraceTag(541405834,2250,10,"Failed to register Messenger handler for MessageTypeId [{0}].",e)}else E.ULS.sendTraceTag(541405833,2250,10,"Attempted to register null IIncomingMessageHandler.");else E.ULS.sendTraceTag(541405832,2250,10,"Attempted to register null or empty MessageTypeId.")}sendMessage(e,n){if(this.mlb){var C=this.mlb.src;this.vv.HZf(C)?Array.contains(Jv.ZQh,e)?this.vv.Gdb(Object.assign(new Gq.a,{MessageId:e,
SendTime:Date.now(),Values:{["Payload"]:n}}),this.mlb.contentWindow,N.a.getOrigin(C))||E.ULS.sendTraceTag(541405838,2250,10,"Failed to send a message with MessageTypeId [{0}].",e):E.ULS.sendTraceTag(541405837,2250,10,"Attempted to send a message with unsupported MessageTypeId [{0}].",e):E.ULS.sendTraceTag(541405836,2250,10,"Attempted to send a message to origin that's not allowed.")}else E.ULS.sendTraceTag(541405835,2250,10,"Attempted to send a message with undefined target iframe element and MessageTypeId [{0}].",
e)}}Object(F.a)(AG,"DocumentAssemblyMessenger",null,[1072]);var BG=d(1379),pu=d(1382),bp=d(2127);class cB{constructor(e,n,C,S,ja,ya){this.y6h=this.A6h=null;this.gt=e;this.x6h=n;this.Vzl=C;this.Wzl=S;this.A6h=ja;this.y6h=ya}}Object(F.a)(cB,"ContentAssemblyHighlightContext",null,[]);class dB extends pu.a{constructor(e,n,C,S){super();this.Irk=40;this.ANc="px";this.ADc="aria-label";this.Xzl="Field_20";this.hb=e;this.$g=n;this.dZ=C;(this.pB=S)&&this.pB.gRd(this.mH.bind(this))}fUa(e){const n=[],C=e.g6a(0,
this.Irk,this.zoom);n.push(this.Mea(e.I3,C,e.nBc[0].y-e.r7[0].y));return n}Mea(e,n,C){const S=e.Kh.ownerDocument,ja=Uj.a.createElement(S,Xk.a.div);ja.className=dB.Hrk;ja.style.left=n+this.ANc;ja.style.top=C+this.ANc;n=Uj.a.createElement(S,Xk.a.div);Bb.a("renderIcon")&&appChrome.api.renderIcon(this.Xzl,n);n.setAttribute("role","img");n.setAttribute("alt","Conditional section");n.title="Conditional section";n.setAttribute(this.ADc,"Conditional section");ja.appendChild(n);e={context:new cB([],ja,new Set,
new Set,null,null),kcg:e,container:ja};this.$g.LI(ou.a.click,ja,this.Zta.bind(this),e);return ja}u_a(e){e=this.hb.Zm(e.Cb);return Object(ti.d)(e,!1,e.TG)}tVd(){const e=Object.assign(new bp.a,{action:1,type:7,$B:null,VL:this.sia});this.sia=null;this.dZ.vH(e)}mH(e,n){this.sia&&!n.U7a.Df.classList.contains(ti.j)&&this.tVd()}Zta(e){if(!e)return!1;let n=e.uq.context;if(dB.oab(n,this.sia))return!0;n=this.oJf(e.uq.kcg,n,e.uq.container);e=Object.assign(new bp.a,{action:0,type:7,$B:n,VL:this.sia});this.sia=
n;this.dZ.vH(e);return!0}oJf(e,n,C){n={z6h:new Set,jXb:new Set,B6h:null,Fqf:null};const S=this.hb.Kv(e.Cb,!0,!1),ja=[];if(S)for(const ya of S)ja.push(ya);this.KYk(e,n,ja);return n=new cB(ja,C,n.z6h,n.jXb,n.B6h,n.Fqf)}KYk(e,n,C){if(e.Ij){var S=new Set;for(const ya of e.Zf.uj)ya.querySelectorAll("*").forEach(S.add,S);e=Array.from(S.values())}else e=Array.prototype.slice.call(e.htmlElement.querySelectorAll("*"),0);let ja=[];n.jXb.add(C[0].id);n.B6h=C[0].id;n.Fqf=C[0].id;e.forEach(ya=>{const kb=Vm.a.Eb(ya,
"CaaeContentControlStartGuids");if(kb)for(const Rb of kb)ja.push(Rb),n.z6h.add(Rb);if(!ja.length)return!0;ya=Vm.a.Eb(ya,"CaaeContentControlEndGuids");if(!ya)return!0;ja=BG.a.$uc(ja,ya)});for(S=e=this.hb.pg(C[C.length-1],!1,!0);ja.length&&e;){n.jXb.add(e.id);n.Fqf=e.id;C.push(e);for(const ya of S.gJ)ya.htmlElement.querySelectorAll(".CaaeContentControlEnd").forEach(kb=>{(kb=Vm.a.Eb(kb,"CaaeContentControlEndGuids"))&&(ja=BG.a.$uc(ja,kb))});S=e=this.hb.pg(e,!1,!0)}}static oab(e,n){return!!n&&!!e&&e.x6h===
n.x6h}}dB.Hrk="WordBookmarkSvgIndicatorContainer";Object(F.a)(dB,"ContentAssemblyIndicatorActor",pu.a,[325]);class LC extends Mi.a{constructor(){super()}get Afa(){return!0}get Xrb(){return 7}get U9a(){if(null!=this.x5)return this.x5;this.x5=[];this.x5.push(new ok.a(ti.j,ti.j));return this.x5}wMa(e,n){var C;if(this.Afa){var S=this.vs.OIa,ja=this.vs.Qad,ya=e.TG;if(S&&7===S.type){ja=n.WMa("*");const kb=S.$B;if(null===(C=S.VL)||void 0===C?0:C.gt.includes(e))for(const Rb of ja)this.vs.BZa(Rb);ya&&Object(ti.d)(e,
!0,ya)&&this.WPj(ya,ti.j,!1);kb&&kb.gt.includes(e)&&this.vyb(n,S.action,kb,e,ja,ya)}else S&&ja&&7===ja.type&&3===S.action&&ja.$B.gt.includes(e)&&(C=n.WMa("*"),this.vyb(n,0,ja.$B,e,C,ya))}}oXa(e){return e instanceof cB}p9a(e,n){if(e)for(const C of e.gt)n.add(C)}WPj(e,n,C){e=e.fg(Object(Zh.a)().Gd.Ic).htmlElement.querySelectorAll("table");0!==e.length&&e[0].classList.toggle(n,!!C)}vyb(e,n,C,S,ja,ya){if(0===n&&e.htmlElement)if(ya)this.WPj(ya,ti.j,!0);else{e=ja.length;var kb=S.id===C.A6h,Rb=S.id===C.y6h;
n=Array(e);var sc=[],Fc=0;ya=!1;for(let td=0;td<e;td++){const Bd=ja[td];var gd=Fg.a(Bd);n[td]=gd;gd=Bd.classList;if(0!=n[td]){const wd=!gd.contains(en.a.mI),te=Vm.a.Eb(Bd,"CaaeContentControlEndGuids");te&&sc.push(...te);if(kb){let Le;if(Le=Vm.a.Eb(Bd,"CaaeContentControlStartGuids"))Fc+=Le.length,gd.add(ti.j);if(te)for(const Oe of te)this.thn(C,Oe)&&Fc--;0!==Fc&&wd&&gd.add(ti.j)}kb||Rb||!C.Wzl.has(S.id)||(Vm.a.Eb(Bd,"CaaeContentControlEndGuids")&&ya?gd.add(ti.j):wd&&gd.add(ti.j))}ya=!gd.contains(en.a.M7a)}ya=
!1;if(Rb&&!kb)for(C=0;C<e;C++)S=ja[C].classList,0!==n[C]&&!S.contains(en.a.mI)&&ya&&S.add(ti.j),ya=!S.contains(en.a.M7a)}}thn(e,n){for(const C of e.Vzl)if(n.equals(C))return!0;return!1}}Object(F.a)(LC,"ContentAssemblyHighlightActor",Mi.a,[296]);class Pr{constructor(){this.Z=null}get name(){return"WordEditor.DocumentAssemblyEditor"}wc(e){this.Z=e;const n=G.AFrameworkApplication.Ewb||aB.a.lmb;this.Z.ia("WordEditor.DocumentAssemblyEditor.Messenger",()=>new AG(new aB.a(null,null),n,this.Z.resolve("WordEditor.Extension.DocumentFactory"),
this.Z.resolve("Box4.IHyperlinkEditor"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),this.Z.resolve("WordEditor.Extension.TableOperations"),this.Z.resolve("WordEditor.IImageEditor"),this.Z.resolve("Box4.IFormattingEditor"),this.Z.resolve("WordEditor.Extension.RequestContext"),this.Z.resolve("WordEditor.Extension.TableCellFactory"),this.Z.resolve("WordEditor.Extension.ParagraphFactory"),this.Z.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Z.resolve("WordEditor.Extension.IContentControlOperations"),
this.Z.resolve("Box4.IParagraphIteratorFactory"),this.Z.resolve("Box4.IParagraphReader"),Kf.a.instance,Rn.a.instance,G.AFrameworkApplication.va)).ha();this.Z.ia("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor",()=>new dB(e.resolve("Box4.IParagraphReader"),ue.a.instance,this.Z.resolve("Box4.Highlight.IHighlightManager"),e.resolve("Box4.IInteractiveEventHandler"))).ha()}init(){this.Z.resolve("WordEditor.DocumentAssemblyEditor.Messenger");G.AFrameworkApplication.dv&&(G.AFrameworkApplication.$c("ccAnnotationsTreatment;ccAnnotationsControl"),
G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.contentControlAnnotations",!1)&&(this.Z.resolve("Box4.Indicator.IIndicatorManager").eNa(this.Z.resolve("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor")),this.Z.resolve("Box4.Highlight.IHighlightManager").Vcb(new LC)))}dispose(){}static main(){if(!G.AFrameworkApplication.hL&&G.AFrameworkApplication.dv){R.a.instance.Mc(new Pr);const e=G.AFrameworkApplication.ua;e&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",
!1)&&"DocGen"!==G.AFrameworkApplication.dv&&"ContentAssemblyView"!==G.AFrameworkApplication.dv||!e.Rua||e.Rua.classList.add("HideRibbon"),e.W5c&&e.$Dg.classList.add("hidePanel"))}}}Object(F.a)(Pr,"DocumentAssemblyPackageManager",null,[0,1]);var Pu=d(1492);class CG extends Sys.EventArgs{constructor(e){super();this.Gtb=e}}Object(F.a)(CG,"LicenseStateChangeEventArgs",Sys.EventArgs,[]);class gu{constructor(e,n,C){this.uv=e;this.Aa=n;this.OZe=C;this.JUb=new Promise((S,ja)=>{this.mLk=S;this.DKk=ja});this.Wdm=
S=>{if(S.featureName===Pu.a.zyf)switch(S.tierName){case 2:E.ULS.sendTraceTag(541332422,2250,50,"FreemiumCallback for {0} updated state to Premium",S.featureName);this.OZe.raiseEvent("OnLicenseStateChange",new CG(!0));this.uv.execute(ja=>{ja.iZb(S.featureName,this.MOk)});break;default:E.ULS.sendTraceTag(541332423,2250,10,"FreemiumCallback for {0} received with unexpected value {1}",S.featureName,S.tierName)}else E.ULS.sendTraceTag(541332424,2250,10,"FreemiumCallback received with unexpected FeatureName {0}",
S.featureName)}}bPh(e){this.OZe.addHandler("OnLicenseStateChange",e)}s7m(){this.PMd=(e,n)=>{this.OZe.raiseEvent("OnLicenseStateChange",new CG(2!==e));this.mLk({mode:e,nad:2!==e,U6p:n})};this.Btk=()=>{E.ULS.sendTraceTag(541131153,2250,50,"Disabling feature for reason: Tier name is basic");this.DKk("Tier name is basic")};this.uv.execute(e=>{e.getFeatureTier(Pu.a.zyf,0).then(n=>{const C=e.isFreemiumUpsellEnabled();if(32===this.EVm(n,C))E.ULS.sendTraceTag(541332419,2250,50,"WordEditor HandleEnableDisable Licensing completed successfully");
else return e.isFeatureEnabled(Pu.a.Byf,!0);return null}).then(n=>{null!==n&&(this.$Wm(n,e),E.ULS.sendTraceTag(541332420,2250,50,"WordEditor HandlePremium Licensing completed successfully"));return null}).catch(n=>{E.ULS.sendTraceTag(541332421,2250,10,"Failed to initialize with licensing: Error {0}",n);n=e.isFreemiumUpsellEnabled();this.PMd(1,n);return null})})}EVm(e,n){this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1)&&(e=0);switch(e){case 2:return this.PMd(0,
n),32;case 1:return this.Btk(),32;default:return 2}}$Wm(e,n){const C=n.isFreemiumUpsellEnabled(),S=this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1);e&&!S?this.PMd(1,C):(this.MOk=n.Cua(Pu.a.zyf,this.Wdm),this.PMd(2,C||S))}}Object(F.a)(gu,"AddInLicensingManager",null,[1078]);const Wx=(e,n,C,S,ja)=>{const ya={state:3,daysRemaining:-1};e=Math.floor((+n-+e)/864E5);0>e?ya.state=3:e>=C?(ya.daysRemaining=C-e,ya.state=e>C+30?2:5):(ya.daysRemaining=C-e,ya.state=
1);if(2===ya.state||5===ya.state)ya.state=S&&0<=ja?0:ya.state;return ya};class Xx{constructor(e,n=null){this.Aa=e;this.gF=null!==n&&void 0!==n?n:()=>new Date}$Tb(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsWomppEnabled",!1)}EGf(){const e=new Date(this.Aa.getStringFeatureGate("Microsoft.Office.WordOnline.FA000000029.WomppUntilDate","2021/12/1")),n=this.gF();return Math.floor((+e-+n)/864E5)}Win(){const e=G.AFrameworkApplication.fMa;return e&&e.toLowerCase()===Xx.$kk?
!0:!1}}Xx.$kk="tm67341774";Object(F.a)(Xx,"UpsellCampaignGate",null,[]);class eB{constructor(e){this.Aa=e}isEnabled(){const e=this.Aa.$("EditorBrowserExtensionPromo"),n=this.Z_l();return e||n}Z_l(){return"-4"===G.AFrameworkApplication.sessionStartInfoSettings.Ring}}Object(F.a)(eB,"BxPromoGate",null,[]);class fB{constructor(){this.isDismissed=this.isInstalled=!1}}Object(F.a)(fB,"BxPromoSettings",null,[1061]);class Kv extends Tt.a{constructor(e,n,C,S,ja){super(e,n,C,S,ja);this.cIc="getEditorBxPromoSettings";
this.D$b="saveEditorBxPromoSettings";this.O8b=Kv.Sdk;this.SFb=["IsInstalled","IsDismissed"];this.v$="BX cross-promo";this.Akb=Iy.a.yyf}async hWo(){this.Mi||(this.Sg.sendTraceTag(557183135,2250,15,"BX cross-promo settings null when setting isDismissed"),this.Mi=new fB);this.Mi.isDismissed=!0;await this.wmd()}get dgc(){return new fB}ncc(){return["IsInstalled",this.Mi.isInstalled,"IsDismissed",this.Mi.isDismissed]}mcc(){return{["IsInstalled"]:this.PZ(this.Mi.isInstalled.toString()),["IsDismissed"]:this.PZ(this.Mi.isDismissed.toString())}}async Bld(e){const n=
this.Mi.isDismissed&&!e.isDismissed;this.Mi.isDismissed=this.Mi.isDismissed||e.isDismissed;this.Mi.isInstalled=this.Mi.isInstalled||e.isInstalled;return n}NXc(){return new Mz.a}Kgd(e){const n=new fB;n.isInstalled=this.Fyj(e.IsInstalled);n.isDismissed=this.Fyj(e.IsDismissed);return n}}Kv.Sdk="BxPromoSettingsChangedEvent";Object(F.a)(Kv,"BxPromoSettingsHandler",Tt.a,[1083,1084,1010]);const qJ=[["363d7011-83dd-4cc0-bdec-ea4af4df4dbb",!1],["6d1d8c3d-62d5-45d1-b850-d8a98a24964b",!1]],rJ=[["cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",
!1],["f55d29d6-efd4-4a51-8a01-e0a7bd549073",!0],["c1ed6a31-f439-4115-8272-7bbd2f663a84",!0],["d124712e-74ac-43eb-9bb6-373b2398f448",!0],["ca649e0f-48de-4f54-b687-2bda07e40728",!0],["9e5c572b-ec30-4f6b-b75c-ad9e60efe95e",!0],["12d7f72e-e53e-4b27-b1ed-4ee115f54994",!0],["f57c12d6-03e4-4f48-9b7b-f95802a6c669",!1],["25714ab1-190b-4ef3-8d3d-e45bfd591c45",!0],["708198dd-ecbf-44fb-a428-ff2bc10e4d17",!0],["0fc5f67a-9d4e-41de-a1c6-ebe9b8b9046c",!0],["6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",!0],["5d411ad2-a965-4c01-b425-ecce2b374dfa",
!0],["e006985e-33eb-42e1-9196-1333c4ecad9c",!0],["e3391a10-ee05-41e7-984d-82e72981a099",!0],["520b6db9-9638-4266-aa31-dc2cadd19aa8",!0],["0124af9e-756d-4ab9-8cc6-d99a20c22897",!0],["b85a7205-ba3d-4afb-8187-86f8ea104c75",!0],["0941dabb-e993-4a10-8a92-70a95ca5389d",!0],["7c2ff4d7-41a9-4310-949b-863a0dfa4257",!1],["0da5de95-d496-4d23-8f93-693ef6592ae6",!1],["04cc32b6-7af4-4778-8ce9-c32698169b6a",!0],["95647447-1670-4af1-868e-7266583f61ff",!0],["a7927082-e6bb-4061-a134-3051e5969222",!0],["c61cb624-820e-454a-b426-cdd4c0a7011b",
!0],["26bdc172-02a8-4f0a-8ec0-6049906f1f7c",!0],["79dd443b-0b94-45a1-90ad-02807565324d",!1],["4ee98de6-ea40-48db-ae36-ca82fc8473f7",!0],["2948a1be-32f1-460e-84ef-8b89597af9f1",!0],["67718619-a6b1-43ec-af18-1c48bbc27acd",!0],["a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",!0],["19c926ad-f32d-42f8-996f-853c3ba00ab5",!0],["5f1ea714-acc6-4b01-84d5-5a7666aa297b",!0],["296f8f65-02fb-45a7-b4ab-5dc137edc563",!0],["766428da-f41f-451d-818d-174eb99d84ba",!0],["8778ba37-ca99-4ab9-a964-55abd18f7eba",!0],["a44ac718-8213-42ff-87a5-1e5d6592c352",
!1],["97e25aa1-c0cc-435f-adaa-e2d490553b6d",!0]],xt=[["6d60d9da-9e38-4d1e-bfc5-05a04120eef9",!1],["63e72d3d-62d7-4e73-8d66-c137d8841121",!1],["27783a58-c44f-4778-9856-36d9eab63693",!1],["5cb7fc16-cd78-449c-86d9-5d047be21ac4",!1],["79405b77-e475-4f04-ba37-a3e6be66d3f2",!0],["7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",!0],["ba48d6ad-df91-4420-b26f-31c07765842d",!0],["d7746119-e7e5-4e97-9979-bcd2114f9fe9",!1],["50d4e435-dd52-4c0d-bb7a-9bb1c154a148",!0],["ef92c613-9224-424f-b391-748476b011cb",!0],["9aabeae7-bda2-44a7-a7f1-9c3d9089191e",
!0],["39e466f1-6ebd-4ada-a7db-e0cc74048f1e",!0],["55178e46-8927-4b63-b19e-7c6fb5f8929b",!0],["aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",!1],["8cf6f68e-f693-4e6f-b253-5092cd19b9e2",!0],["4f42f243-8cb5-4f1a-a5a6-58b60d303e02",!0],["012a7c1a-292a-4e17-b126-00191939cc0d",!0],["6cb8eda6-6cac-443a-8e3a-0df80ba725f6",!0],["6dbfae4c-9818-4dec-a769-2595168927f2",!1],["02c15397-df70-4f00-aa4d-7269e6d4e712",!1],["bd326c9c-0e4a-4ddf-be36-1ef7bee200ca",!0],["49b2a4fe-b569-43fb-bb54-796eddc260b3",!0],["d1572a1d-58d1-443f-997e-2722cfc41afe",
!0],["f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",!1],["64213f24-0943-4585-8dd4-ee4f26b47a37",!0],["413425d5-5a64-4ea6-84df-aae06c596439",!0],["a127d2c9-2faf-491b-8d6a-e9b027fec098",!0],["999cc56a-caa5-4889-829e-7e249688e1cf",!0],["62540ee8-7f12-4c6e-be18-89268fa8a289",!1],["b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",!0],["c4301606-9bc2-4389-bb1a-c08370627172",!0],["75069b86-2fd8-4158-a9ab-2793fd1d6f8b",!0],["03522a58-4044-4bab-b796-0630ae2ad00a",!0],["9feebbfe-9e8d-4b59-8c7a-8b3c462d6697",!0],["e24fd819-cc17-4be9-afec-dd103055198e",
!0],["72e604b0-a185-413b-bd45-ad555288c746",!1],["c1056d52-e69d-43a6-926c-662cb2228185",!0],["5b75d94a-856d-461b-9bb4-879f4502b4c3",!1],["6ae03cab-953e-4382-bd27-843c5d553b23",!1],["e8c121e0-1ecd-4e88-8694-2fb17acb519d",!0],["f4aa4a0a-f81a-41ac-b710-de4a60b99282",!1],["ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",!0],["e805847a-9050-45de-b767-f48ed68ad848",!0],["d96e4e94-041b-4389-861d-3cd4556d55f6",!0],["84275a90-df79-4b9e-a208-9ec8b5e59622",!1],["faa8f367-32d3-44cc-8eda-6e1e9de23efc",!1],["c68edc3b-9340-4b68-9d18-268bb82e2d94",
!0],["8caa3b8f-202e-4a32-91a8-320b5272777e",!0],["3f2eda01-e8a5-4ed9-9494-6de566bc5333",!1],["6a0e1c97-430e-4d83-889d-8c4fea315a83",!0],["aa78ec66-2078-42bf-84f5-c241eb53a531",!0],["fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",!1],["2d08dbe8-c11b-4190-a428-9a2c0a37bd68",!0],["3fd9c226-3925-4855-ba1e-49eb9ee46d24",!0],["1c169b51-d9a5-4b69-9abc-2bcd5e9c5912",!0],["818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",!1],["79d4a5c7-11c0-4be1-8d3c-c322f9941323",!0],["b956d579-6d99-4278-8b7d-e281ab8c576b",!0],["55aa25a5-e28a-4f22-8410-34a4df965e30",
!1],["d78a8ad6-bac7-47ff-8016-d75f7fcd8370",!0],["822bb35e-0608-466e-a771-a315fcf95821",!0],["0c576af1-54af-4acb-8065-4616bb73820d",!0],["e3994139-ff36-44da-ae72-500b70d9b80f",!0],["2700d569-bd6f-4806-9bf1-49abd64d9fd3",!0],["3f2e6b47-fc23-4f99-ad25-1758e7f179b6",!0],["352579fc-6ae6-4eb1-8d3b-895ab239714e",!1],["985091e9-4b33-42f7-b2ff-191b03f2ba74",!0],["9d62fd01-8804-4485-a5f0-257131e4f6aa",!0],["e7c89ada-94b2-426a-b8ea-069712de5d9f",!1]];class Qz{constructor(e,n,C){this.FGa=e;this.J3e=n;this.DBb=
C;this.bkb=new Map;this.lqh=this.Bth=this.nEd=!1;this.Bff=S=>{this.J3e.addHandler(Qz.Kkg,S)};this.UBp=(S,ja)=>{S=!ja.Gtb;S!==this.nEd&&(this.nEd=S,this.FGa.x1i()&&this.J3e.raiseEvent(Qz.Kkg))};this.bXf=(S,ja,ya)=>this.FGa.x1i()?0===this.bkb.size?(this.Bth||(Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.PremiumPreviewCritiquesFilter.FilteringBeforeInitialization",dataFields:[]})),this.Bth=!0),!0):!this.nEd||"Spelling"===ja||ya&&-1===ya.toLowerCase().search("en")||this.lqh?
!0:void 0!==this.bkb.get(S)?!this.bkb.get(S):!1:!0;this.isCritiqueTypeUnderPaywall=(S,ja,ya)=>ya&&-1===ya.toLowerCase().search("en")?!1:void 0!==this.bkb.get(S)?this.bkb.get(S):!0}IQi(e,n=!1){this.nEd=!e.nad;this.lqh=n;this.DBb.bPh(this.UBp);xt.forEach(([C,S])=>this.bkb.set(C,S));qJ.forEach(([C,S])=>this.bkb.set(C,S));this.FGa.dsn()||rJ.forEach(([C,S])=>this.bkb.set(C,S));this.J3e.raiseEvent(Qz.Kkg)}}Qz.Kkg="PremiumPreviewFilterChangedEvent";Object(F.a)(Qz,"PremiumPreviewCritiquesFilter",null,[1081]);
class gv{constructor(){this.startDate=null;this.allPpTypes=this.currentPpType=this.acceptedSimilarityCitations=this.acceptedTextPredictions=this.acceptedRefinements=this.acceptedSpellingAndGrammar=this.autoCorrectedErrors=this.totalDays=0}}Object(F.a)(gv,"PremiumPreviewSettings",null,[1061]);class gB extends gv{constructor(){super(...arguments);this.state=this.premiumSuggestionsCount=this.totalDays=this.daysRemaining=0;this.startDate=null;this.cardType=1}}Object(F.a)(gB,"PremiumPreviewData",gv,[]);
class DG extends Sys.EventArgs{constructor(e){super();this.Gl=e}}Object(F.a)(DG,"PremiumPreviewDataChangeEventArgs",Sys.EventArgs,[]);var Aw;(function(e){e[e.initial=0]="initial";e[e.Dfa=1]="inProgress";e[e.K4l=2]="expired";e[e.error=3]="error";e[e.fhj=4]="notInitialized";e[e.g0p=5]="expiredWithMetrics";e[e.Inq=6]="softPaywallInProgress"})(Aw||(Aw={}));Object(F.b)("PremiumPreviewState",Aw);var hB;(function(e){e[e.QQp=1]="Regular";e[e.HSp=2]="Wompp";e[e.DRp=4]="SoftPaywall"})(hB||(hB={}));Object(F.b)("PremiumPreviewType",
hB);class Vt{constructor(e,n,C,S,ja,ya,kb=null){this.O9b=e;this.Alb=n;this.FGa=C;this.yOe=S;this.Sg=ja;this.yGa=ya;this.AOe=!1;this.OLe=this.Alb.$Tb()?2:1;this.d2n=(Rb,sc)=>{this.m7c(sc.settings)};this.gF=kb?kb:()=>new Date;this.Gl=Object.assign(new gB,{state:4});this.O9b.hff(this.d2n)}async start(e){const n=await this.Owm(),C=this.kEi(e);if(1===n.state&&2===n.currentPpType)this.Sg.sendTraceTag(545293637,2250,15,"User tried to enter WOMPP but already inProgress");else{switch(e){case 1:if(this.HDp(n,
e)){this.Sg.sendTraceTag(545293638,2250,15,"Trying to start Premium Preview but already in PP.");return}this.O9b.kGj();break;case 2:if(1===n.state&&1===n.currentPpType){if(n.daysRemaining>C){this.Sg.sendTraceTag(545293639,2250,15,"User tried to enter WOMPP but regular PP is longer.");return}}else this.O9b.kGj();break;default:this.Sg.sendTraceTag(545116506,2250,10,`Premium Preview started with type; ${hB[e]}`);return}this.setState(1,e);this.yGa.Jta(ha.a.$Ig,!0,null,null,null,null,[{...(new kh.a),name:"ppType",
string:hB[e]},{...(new kh.a),name:"ppDuration",int64:C}])}}HDp(e,n){const C=e.allPpTypes,S=e.startDate;e=e.totalDays;return 1===n&&0===C?!!S&&!!e:0!==(C&n)}kEi(e){switch(e){case 1:return this.FGa.OLf();case 2:return this.Alb.EGf()}}Owm(){return new Promise(e=>{if(this.AOe&&4!==this.Gl.state)e(this.Gl);else{const n=(C,S)=>{4!==S.Gl.state&&(this.AOe=!0,this.GCo(n),e(S.Gl))};this.wKb(n)}})}m7c(e){this.AOe=!0;e?4===e.currentPpType?this.Gl={...(new gB),cardType:4,state:6}:e.startDate||e.totalDays?(this.Gl=
{...Wx(e.startDate,this.gF(),e.totalDays,this.Alb.$Tb(),this.Alb.EGf()),...e,premiumSuggestionsCount:0,cardType:this.OLe},3===this.Gl.state&&this.Sg.sendTraceTag(559256014,2250,10,"Premium preview start date greater than current date"),1!==this.Gl.state||2!==this.Gl.currentPpType||this.Alb.$Tb()||(this.Sg.sendTraceTag(540674119,2250,15,"Tried to start WOMPP but it is disabled. Defaulting to expired state."),this.Gl.state=2)):(this.Sg.sendTraceTag(559256013,2250,50,"Premium preview not yet started"),
this.Gl=Object.assign(new gB,{daysRemaining:this.FGa.OLf(),state:0,totalDays:this.FGa.OLf(),startDate:null,cardType:this.OLe})):(this.Sg.sendTraceTag(559256012,2250,15,"Trying to intialize premium preview data with null settings"),this.Gl=Object.assign(new gB,{state:3}));this.raiseEvent()}MTo(e){this.Sg.sendTraceTag(559256015,2250,50,"Setting premium preview remaining days: {0}",e);this.Gl.daysRemaining=e;this.raiseEvent()}async aSo(e){await this.O9b.php(e,this.Gl)}setState(e,n){this.Sg.sendTraceTag(559256016,
2250,50,"Setting premium preview state: {0}",e);this.Gl||(this.Sg.sendTraceTag(559256017,2250,15,"Premium preview data null when setting state: {0}",e),this.Gl=new gB,this.Gl.cardType=this.OLe);switch(e){case 1:const C=this.gF();this.O9b.$Zo(new Date(C.toUTCString()),this.kEi(n),n);void 0!==n&&(this.Gl.allPpTypes|=n,this.Gl.currentPpType=n);break;case 0:this.Sg.sendTraceTag(559256019,2250,50,"Setting premium preview state to Initial from {0}",this.Gl.state),this.O9b.kHo(),this.raiseEvent()}this.Gl.state=
e;this.raiseEvent()}raiseEvent(){this.yGa.Jta(ha.a.PXb,!0,null,null,null,null,[{...(new kh.a),name:"AllPpTypes",int64:this.Gl.allPpTypes},{...(new kh.a),name:"CurrentPpType",string:hB[this.Gl.currentPpType]},{...(new kh.a),name:"PremiumPreviewState",string:Aw[this.Gl.state]},{...(new kh.a),name:"DaysRemaining",int64:this.Gl.daysRemaining},{...(new kh.a),name:"TotalDays",int64:this.Gl.totalDays},{...(new kh.a),name:"PremiumSuggestionsCount",int64:this.Gl.premiumSuggestionsCount},{...(new kh.a),name:"AcceptedRefinements",
int64:this.Gl.acceptedRefinements},{...(new kh.a),name:"AcceptedSimilarityCitations",int64:this.Gl.acceptedSimilarityCitations},{...(new kh.a),name:"AcceptedSpellingAndGrammar",int64:this.Gl.acceptedSpellingAndGrammar},{...(new kh.a),name:"AcceptedTextPredictions",int64:this.Gl.acceptedTextPredictions},{...(new kh.a),name:"AutoCorrectedErrors",int64:this.Gl.autoCorrectedErrors}]);this.yOe.raiseEvent(Vt.Jkg,new DG(this.Gl))}wKb(e){this.yOe.addHandler(Vt.Jkg,e)}GCo(e){this.yOe.removeHandler(Vt.Jkg,
e)}}Vt.Jkg="PremiumPreviewDataChangedEvent";Object(F.a)(Vt,"PremiumPreviewDataHandler",null,[]);class EG{constructor(e,n){this.Aa=e;this.DBb=n}OLf(){return this.Aa.getIntFeatureGate("Microsoft.Office.WordOnline.FA000000029.PremiumPreviewDuration",7)}async YZf(){if(!this.Aa.$("EditorPremiumPreviewEnabled"))return!1;try{return!(await this.DBb.JUb).nad}catch(e){return!1}}vqn(){return this.Aa.$("EditorPremiumPreviewStateUpdateEnabled")}x1i(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.SelectedCritiquesDuringPremiumPreview",
!1)}dsn(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsSelectedCritiquesDuringPremiumPReviewAcceptRateHigh",!1)}}Object(F.a)(EG,"PremiumPreviewGate",null,[1077]);const sJ=new Map([["E_Refinements","acceptedRefinements"],["E_Similarity","acceptedSimilarityCitations"],["E_Spelling_Grammar","acceptedSpellingAndGrammar"],["E_TextPrediction","acceptedTextPredictions"],["E_AutoCorrect","autoCorrectedErrors"]]);class Bw extends Tt.a{constructor(e,n,C,S,ja){super(e,n,C,
S,ja);this.cIc="getPremiumPreviewSettings";this.D$b="savePremiumPreviewSettings";this.O8b=Bw.Cfo;this.SFb="StartDate TotalDays AcceptedRefinements AcceptedSimilarity AcceptedSpellingAndGrammar AcceptedTextPrediction AutoCorrectErrors CurrentPpType AllPpTypes".split(" ");this.v$="Premium preview";this.Akb=Iy.a.Cyf}async $Zo(e,n,C){this.Mi||(this.Sg.sendTraceTag(559255966,2250,15,"Premium preview settings null when setting date and total days "),this.Mi=new gv);let S=this.Mi.allPpTypes|C;this.Mi.startDate&&
this.Mi.totalDays&&(S|=1);this.Mi={...this.Mi,startDate:e,totalDays:n,currentPpType:C,allPpTypes:S};await this.wmd()}async php(e,n){var C=await this.xGi();C=this.Lkj(C);for(const S of Bm.dhc)this.avp(e,n,C,S);this.Mi=C;this.tJj(this.mcc())}kGj(){this.Mi||(this.Sg.sendTraceTag(545338245,2250,15,"Premium preview settings null when setting date and total days "),this.Mi=new gv);this.Mi={...this.Mi,acceptedRefinements:0,acceptedSimilarityCitations:0,acceptedSpellingAndGrammar:0,acceptedTextPredictions:0,
autoCorrectedErrors:0}}avp(e,n,C,S){const ja=sJ.get(S);n[ja]=C[ja]+=void 0==e.get(S)?0:e.get(S)}get dgc(){return new gv}ncc(){return["StartDate",this.Mi.startDate,"TotalDays",this.Mi.totalDays,"AcceptedRefinements",this.Mi.acceptedRefinements,"AcceptedSimilarity",this.Mi.acceptedSimilarityCitations,"AcceptedSpellingAndGrammar",this.Mi.acceptedSpellingAndGrammar,"AcceptedTextPrediction",this.Mi.acceptedTextPredictions,"AutoCorrectErrors",this.Mi.autoCorrectedErrors,"CurrentPpType",this.Mi.currentPpType,
"AllPpTypes",this.Mi.allPpTypes]}mcc(){var e=this.Mi.startDate.toISOString();e=e.substring(0,e.indexOf("T"));return{["StartDate"]:this.PZ(e),["TotalDays"]:this.PZ(this.Mi.totalDays.toString()),["AcceptedRefinements"]:this.PZ(this.Mi.acceptedRefinements.toString()),["AcceptedSimilarity"]:this.PZ(this.Mi.acceptedSimilarityCitations.toString()),["AcceptedSpellingAndGrammar"]:this.PZ(this.Mi.acceptedSpellingAndGrammar.toString()),["AcceptedTextPrediction"]:this.PZ(this.Mi.acceptedTextPredictions.toString()),
["AutoCorrectErrors"]:this.PZ(this.Mi.autoCorrectedErrors.toString()),["CurrentPpType"]:this.PZ(this.Mi.currentPpType.toString()),["AllPpTypes"]:this.PZ(this.Mi.allPpTypes.toString())}}async Bld(e){if(e.startDate!==this.Mi.startDate||e.currentPpType!==this.Mi.currentPpType)return!0;this.Mi=e;return!1}NXc(){return new Mz.a}Kgd(e){let n=null;e.StartDate&&(n=this.Iyj(e.StartDate));const C=this.Pcb(e.TotalDays);return{startDate:n,totalDays:C,acceptedRefinements:this.Pcb(e.AcceptedRefinements,!0),acceptedSimilarityCitations:this.Pcb(e.AcceptedSimilarity,
!0),acceptedSpellingAndGrammar:this.Pcb(e.AcceptedSpellingAndGrammar,!0),acceptedTextPredictions:this.Pcb(e.AcceptedTextPrediction,!0),autoCorrectedErrors:this.Pcb(e.AutoCorrectErrors,!0),currentPpType:this.Pcb(e.CurrentPpType,!0),allPpTypes:this.Pcb(e.AllPpTypes,!0)}}}Bw.Cfo="PremiumPreviewSettingsChangedEvent";Object(F.a)(Bw,"PremiumPreviewSettingsHandler",Tt.a,[1075]);class Cw{constructor(e,n,C,S,ja,ya=null){this.ga=e;this.Sg=n;this.FGa=C;this.cSa=S;this.Alb=ja;this.Hah=!1;this.yfd=(kb,Rb)=>{if(!Rb||
!Rb.Gl)this.Sg.sendTraceTag(559255960,2250,10,"PremiumPreviewStateUpdater: premium preview data is null");else if(Rb.Gl.state!==this.Gl.state||Rb.Gl.currentPpType!==this.Gl.currentPpType)this.Gl=Rb.Gl,this.QLj(this.Gl),this.YMo()};this.hql=()=>{if(1===this.Gl.state||5===this.Gl.state){const kb=Wx(this.Gl.startDate,this.gF(),this.Gl.totalDays,this.Alb.$Tb(),this.Alb.EGf());this.Gl={...this.Gl,...kb};switch(this.Gl.state){case 2:case 5:this.Sg.sendTraceTag(559255963,2250,50,"Premium preview state check: preview expired");
this.cSa.setState(this.Gl.state);break;case 3:this.Sg.sendTraceTag(559255964,2250,10,"Premium preview state check: start date greater than current date");this.cSa.setState(this.Gl.state);break;case 1:this.Sg.sendTraceTag(559255965,2250,50,"Premium preview state check: days remaining updated",this.Gl.daysRemaining),this.cSa.MTo(this.Gl.daysRemaining)}this.QLj(this.Gl)}};this.gF=ya?ya:()=>new Date;this.Gl=this.cSa.Gl;this.y9m()}y9m(){this.FGa.vqn()?this.cSa.wKb(this.yfd):this.Sg.sendTraceTag(559255959,
2250,10,"PremiumPreviewStateUpdater: premium preview update disabled")}QLj(e){this.Sg.sendTraceTag(559255961,2250,50,"Premium preview state change message sent");this.ga.Qb(ha.a.PXb,2,e)}YMo(){1!==this.Gl.state||this.Hah||(this.Hah=!0,window.setInterval(this.hql,36E5),this.Sg.sendTraceTag(559255962,2250,50,"Premium preview state check initiated"))}}Object(F.a)(Cw,"PremiumPreviewStateUpdater",null,[]);class iB{constructor(e){this.Aa=e}fYi(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",
!1)}}Object(F.a)(iB,"SimulateFreeUserGate",null,[]);var Yx=d(312),Wq=d(1771);class FG{constructor(e,n,C,S){this.Re=e;this.Sg=n;this.xOk=C;this.LC=S}async initialize(){try{await this.LC.im(),this.Re.ub(this,Wq.RoamingSettingAnnotation.getTypeName())}catch(e){this.Sg.sendTraceTag(0,2250,10,"Soft Paywall annotation registration failed.",e)}}gH(e,n){n!==Vh.a.getTypeName()?this.Sg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings with wrong operation type",n):null!==e&&void 0!==e&&e.content&&
Yx.a.getTypeNameFor(e.content)===Wq.RoamingSettingAnnotation.getTypeName()?(n=e.content,n.settingValueJson?(e=JSON.parse(n.settingValueJson),this.xOk.updateAndPersistState(e),this.Sg.sendTraceTag(0,383,50,"SoftPaywall annotation initialized "+JSON.stringify(e))):this.Sg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings annotation setting is invalid",e)):this.Sg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings annotation is invalid",e)}}Object(F.a)(FG,"SoftPaywallAnnotationHandler",
null,[114]);class An{constructor(e,n,C,S){this.wFh=e;this.xFh=n;this.yGa=C;this.Sg=S;this.initialCredits=20;this.isEnabled=!1;this.B8e=0}updateAndPersistState(e){this.softPaywallData=this.Yep(e)}get softPaywallData(){return{credits:this.credits,receivedCredits:this.receivedCredits,receivedCreditsDate:this.receivedCreditsDate,isEnabled:this.isEnabled}}set softPaywallData(e){this.credits=e.credits;this.receivedCredits=e.receivedCredits;this.receivedCreditsDate=e.receivedCreditsDate}spendCredit(){0>=
this.credits?this.Sg.sendTraceTag(512234826,2250,10,"Spend credits are called with no credits left",this.softPaywallData):(this.B8e++,this.credits--,this.wFh.HLj(),this.yGa.Jta(ha.a.acp,!0,null,null,null,null,[{...(new kh.a),name:"newData",string:JSON.stringify(this.softPaywallData)}]))}Yep(e){let n={...e},C=!1;this.xFh.W4o(e)&&(n=this.kEo(e),C=!0);this.B8e&&(0<n.credits&&(n.credits--,C=!0),this.B8e--);C&&this.wFh.fRo(n);return n}kEo(e){const n={credits:this.initialCredits,receivedCredits:this.initialCredits,
receivedCreditsDate:this.xFh.iWj(),isEnabled:this.isEnabled};this.yGa.Jta(ha.a.UAp,!0,null,null,null,null,[{...(new kh.a),name:"oldData",string:JSON.stringify(e)},{...(new kh.a),name:"newData",int64:JSON.stringify(n)}]);return n}}Object(F.a)(An,"SoftPaywallState",null,[]);class yt{constructor(e,n){this.Aa=e;this.DBb=n}async isEnabled(){if(!this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.EditorSoftPaywallEnabled",!1))return!1;try{return!(await this.DBb.JUb).nad}catch(e){return!1}}}
Object(F.a)(yt,"SoftPaywallGate",null,[1074]);var wh=d(879),zz=d(878);class MC{constructor(e,n,C,S){this.Re=e;this.Sg=n;this.LC=C;this.IY=S;this.xnk="SoftPaywall";this.BCh=10014}fRo(e){e=new Wq.RoamingSettingsWriteSignal({id:this.BCh,valueJson:JSON.stringify(e),settingType:Wq.RoamingSettingType.Dictionary});const n=new wh.a;n.body=e;e=Object.assign(new Vh.a,{parentPath:["Signal",Wq.RoamingSettingsWriteSignal.getTypeName()],items:[n]});this.N0d(e)}HLj(){var e=new Wq.RoamingSettingsReadSignal({ids:[this.BCh]});
const n=new wh.a;n.body=e;e=Object.assign(new Vh.a,{parentPath:["Signal",Wq.RoamingSettingsReadSignal.getTypeName()],items:[n]});this.N0d(e)}async N0d(e){try{await this.LC.im(),this.Wcf(e)}catch(n){this.Sg.sendTraceTag(0,2250,10,"EnsureAugLoopRuntimeManager exception.",n)}}async Wcf(e){try{await this.Re.activateAnnotation(Wq.RoamingSettingAnnotation.getTypeName(),this.xnk),this.IY.getAugLoopRuntimeManager().submitOperation(Object.assign(new zz.a,{operation:e}))}catch(n){this.Sg.sendTraceTag(0,2250,
10,"Activating RoamingSettingAnnotation threw exception.",n)}}}Object(F.a)(MC,"SoftPaywallSignalSender",null,[1073]);class Py{iWj(){var e=new Date;return 100*e.getFullYear()+e.getMonth()+1}W4o(e){return null!==e&&void 0!==e&&e.receivedCreditsDate?Number(e.receivedCreditsDate)<this.iWj():!0}}Object(F.a)(Py,"SoftPaywallUtils",null,[1069]);class Xw extends Oa.a{constructor(){super(...arguments);this.Z=null}get name(){return"WordEditor.EditorUpsell"}zUa(e){this.Z=e;this.Z.ia("WordEditor.Ideas.AddInLoader.IAddInLicensingManager",
()=>new gu(this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),G.AFrameworkApplication.J,new eb.a)).ha();this.Z.ia("WordEditor.EditorUpsell.IPremiumPreviewGate",()=>new EG(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();this.Z.ia("WordEditor.EditorUpsell.ISimulateFreeUserGate",()=>new iB(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ia("WordEditor.EditorUpsell.IUpsellCampaignGate",()=>new Xx(this.Z.resolve("Common.IAppSettingsManager"))).ha();
this.Z.ia("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler",()=>new Bw(this.Z.resolve("Box4.IRoamingServiceRequestManager"),this.Z.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.Z.resolve("Common.IAppSettingsManager"),new eb.a,this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ia("WordEditor.EditorUpsell.PremiumPreviewDataHandler",()=>new Vt(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),
new eb.a,this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"))).as("WordEditor.EditorUpsell.IPremiumPreviewDataProvider").as("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").as("WordEditor.EditorUpsell.IPremiumPreviewDataHandler").as("WordEditor.EditorUpsell.IPremiumPreviewAPI").ha();this.Z.ia("WordEditor.EditorUpsell.PremiumPreviewCritiquesFilter",()=>new Qz(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),new eb.a,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).as("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").ha();
this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter");this.Z.register(Cw,"WordEditor.EditorUpsell.PremiumPreviewStateUpdater").ha().Ud(()=>new Cw(G.AFrameworkApplication.va,this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"))).ha();this.Z.ia("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler",()=>new Kv(this.Z.resolve("Box4.IRoamingServiceRequestManager"),
e.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.Z.resolve("Common.IAppSettingsManager"),new eb.a,this.Z.resolve("Common.IUlsWrapper"))).as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsUpdater").as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsReader").ha();this.Z.ia("WordEditor.Ideas.EditorUpsell.IBxPromoGate",()=>new eB(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ia("WordEditor.EditorUpsell.ISoftPaywallGate",()=>new yt(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();
this.Z.ia("WordEditor.EditorUpsell.SoftPaywallUtils",()=>new Py).ha();this.Z.ia("WordEditor.EditorUpsell.SoftPaywallSignalSender",()=>new MC(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).ha();this.Z.ia("WordEditor.EditorUpsell.ISoftPaywallData",()=>new An(this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender"),this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallUtils"),
this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ia("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler",()=>new FG(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"))).ha()}async BUa(){var e=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),n=this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallGate"),
C=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager");C.s7m();var S=this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");e=await e.YZf();n=await n.isEnabled();rl.a.fTb&&n?(await this.OTf(),this.i7m(C,n)):rl.a.fTb&&(e||S.$Tb())?(S=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.Z.resolve("WordEditor.EditorUpsell.PremiumPreviewStateUpdater"),await this.OTf(),S=await S.Jbd(),this.m7c(S),C=await C.JUb,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").IQi(C)):
this.OTf()}OTf(){this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate").isEnabled()&&this.Z.resolve("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler").Jbd()}m7c(e){this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").m7c(e)}i7m(e,n){this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(async C=>{if(C.isFreemiumUpsellEnabled()){C=this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender");var S=this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler"),
ja=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),ya=this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallData");S.initialize();this.m7c({currentPpType:4});S=await e.JUb;ja.IQi(S,n);ya.isEnabled=!0;C.HLj()}})}AUa(){}static main(){R.a.instance.Mc(new Xw)}}Object(F.a)(Xw,"WordEditorEditorUpsellPackage",Oa.a,[]);var nw=d(809);class Rz{constructor(e,n,C){this.ga=e;this.Sg=n;this.A3a=C;this.Ai=null;this.veh={["id"]:Rz.jPg,["bodyControls"]:{["id"]:Rz.jPg,["isModal"]:!0,["isBlocking"]:!1,
["dialogType"]:0}};this.d7n=()=>{try{this.Ai=this.pBm(),this.Ai.Bd=5,this.veh.bodyControls.dialogType=4,this.Ai.Uh("",this.$ya,this.veh)}catch(S){this.Sg.sendTraceTag(542749407,2250,10,`Upsell share dialog failed to open. Error message: ${S.message}, error stack trace ${S.stack}`);return}this.A3a.ex(ha.a.q6n,!0)};this.$ya=S=>{this.A3a.Jta(ha.a.Otl,!0,null,null,null,null,[{...(new kh.a),name:"ClosedWithDialogButtonType",string:nw.a[S]}]);this.ga.Qb(ha.a.kdb,2,"tell-a-friend-button")};this.ga.qa(ha.a.YXm,
Ma.a.view,this.d7n)}dispose(){this.Ai&&this.Ai.dispose()}pBm(){return new Qh.a(!1,!1,!0)}}Rz.jPg="GenericDialog";Object(F.a)(Rz,"UpsellCampaignActor",null,[]);class lq extends Oa.a{constructor(){super(...arguments);this.mJh=this.Z=null}get name(){return"WordEditor.UpsellCampaign"}zUa(e){this.Z=e}BUa(){const e=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewAPI"),n=this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");this.mJh=new Rz(G.AFrameworkApplication.va,this.Z.resolve("Common.IUlsWrapper"),
this.Z.resolve("Wac.Common.Utils.IOtelWrapper"));n.Win()&&(e.start(2),this.Z.resolve("Wac.Common.Utils.IOtelWrapper").ex(ha.a.r6n,!0))}AUa(){this.mJh.dispose()}static main(){(new Xx(G.AFrameworkApplication.J)).$Tb()&&R.a.instance.Mc(new lq)}}Object(F.a)(lq,"WordEditorUpsellCampaignPackage",Oa.a,[]);class jB{constructor(){this.xx=(new Rg.a).Lc(15);const e=ib.StaticActiveAppFrame.za().kb.hd;this.xx.Ab(e)}dispose(){this.xx.dispose()}}Object(F.a)(jB,"AutomationTransaction",null,[10]);const GG=()=>gc.a.instance.resolve("WordEditor.Extension.DocumentFactory").create();
var ow=d(2183),lL=d(2132),tJ=d(2134),zE=d(1874),uJ=d(231),vJ=d(299),wJ=d(545),BM=d(1491),zt=d(876),yr=d(2137);class Zx{constructor(e){this.c6k=e;this.b6k=0}Usi(){return`${this.c6k}${this.b6k++}`}}Object(F.a)(Zx,"AnnotationItemIdGenerator",null,[]);class hv{constructor(e,n,C,S,ja){this.V0b=e;this.$Oo=n;this.Cv=C;this.Mfa=S;this.f3b=ja;this.ksk=new Zx("#CP");this.Hmk=new Zx("#AIC");this.o8g="ThirdParty"}PEl(e,n){var C;this.JEp(e,n);const S=e.node;var ja=this.P$j(S,n);const ya=e.zj,kb=e.Po-ya;if(0>=
kb)E.ULS.sendTraceTag(508859913,369,50,"AppId:{0}, range length must be positive.",n.appId);else{var Rb=new fb.a;Rb.add(e);this.$Oo.select(Rb,1);Rb=null===(C=S.characterData)||void 0===C?void 0:C.substring(ya,ya+kb);C=Jp.a.eH(S);ja=Object.assign(new Vh.a,{parentRevId:ja.toString(),parentPath:C.split("\\"),sourceTimestamp:Date.now(),items:[Object.assign(new wh.a,{id:jh.a.FD?this.ksk.Usi():this.DBm(),source:jh.a.FD?this.o8g:void 0,body:Object.assign(new zt.b,{id:Tj.a.create().toString(),priority:1,
context:Rb,startInContext:0,categoryName:hv.zXd,suggestions:[],range:{start:ya,length:kb}})})]});this.V0b.submitOperation(ja);ja={};ja.contextId=e.contextId==Ma.a.Cd?"textRange":"paragraph";ja.AppId=null===n||void 0===n?void 0:n.appId;E.ULS.sendTraceTag(508863364,369,50,Bf.c(ja))}}I$m(e,n,C){var S;const ja=this.P$j(n,C),ya=Jp.a.eH(n),kb=[],Rb=[];for(const Fc of e){if(0>=Fc.length||0>Fc.start)E.ULS.sendTraceTag(508180510,369,50,`AppId: ${0}, invalid start or length for critique annotation. start: ${Fc.start} length: ${Fc.length}`),
pc.a.td();const {g4k:gd,e4k:td,isValid:Bd}=this.L3k(n,Fc.start,Fc.length);Bd||(E.ULS.sendTraceTag(508126468,369,50,`AppId: ${0},  start or length outside of paragraph. start: ${Fc.start} length: ${Fc.length}`),pc.a.td());var sc=null===(S=n.characterData)||void 0===S?void 0:S.substring(gd,gd+td);e=Tj.a.create().toString();sc=Object.assign(new wh.a,{id:this.Hmk.Usi(),source:this.o8g,body:Object.assign(new zt.a,{id:e,context:sc,priority:3,startInContext:0,categoryName:hv.wXk,suggestions:[],range:{start:gd,
length:td},addInId:C.Ek.Rn,squiggleStyle:yr.b.Solid,squiggleColor:this.PJn(Fc.colorScheme)})});Rb.push(sc);kb.push(e)}n=Object.assign(new Vh.a,{parentRevId:ja.toString(),parentPath:ya.split("\\"),sourceTimestamp:Date.now(),items:Rb});this.V0b.submitOperation(n);return kb}L3k(e,n,C){const {DQh:S,isValid:ja}=this.Dzi(e.characterData,0,n+1),{DQh:ya,isValid:kb}=this.Dzi(e.characterData,S,C);return{g4k:S,e4k:ya-S+1,isValid:ja&&kb}}Dzi(e,n,C){let S=0;for(;S<C&&n<e.length;)e[n]!==pn.AParagraphNode.RB&&S++,
n++;return{DQh:n-1,isValid:S===C}}Fgm(e){e=Jp.a.eH(e);return(e=this.Cv.w4d(e))?e.toArray().filter(n=>n.annotationType===zt.a.getTypeName()):[]}JEp(e,n){e.contextId!=Ma.a.Cd&&e.contextId!=Ma.a.paragraph&&e.contextId!=Ma.a.Zc&&(E.ULS.sendTraceTag(508863366,369,15,"AppId:{0}, node must be textRange or paragraph.",n.appId),pc.a.td())}P$j(e,n){e=e.ka(hb.a.Vj,0);0===e&&(E.ULS.sendTraceTag(508863365,369,10,"AppId:{0}, cannot read paragraph textId.",n.appId),pc.a.hg());return e}DBm(){const e=hv.jsk+hv.Cch.toString();
hv.Cch++;return e}PJn(e){switch(e){case 0:return yr.a.Red;case 1:return yr.a.Green;case 2:return yr.a.Blue;case 3:return yr.a.Lavender;case 4:return yr.a.Berry;default:return yr.a.None}}AQl(e,n){if(e)for(const C of e)if(C.contextId!=Ma.a.Cd&&C.contextId!=Ma.a.paragraph)E.ULS.sendTraceTag(508847651,369,50,"Skipping non-text context {0} for addin {1]",Ma.a[C.contextId],n.appId);else if(e=Jp.a.eH(C.node),e=this.Cv.w4d(e))for(const S of e)S.content.categoryName===hv.zXd&&this.Cv.qUa(S,!1)}ZPl(e){this.Cv.qUa(e,
!1)}FXa(e){e.utb||(e=this.Cv.FXa(e.id),e.utb||pc.a.hg())}uQh(e){this.FXa(e);const n=e.parent;var C=this.Mfa.hKa(n,0,ya=>ya.intent===e);if(1!=C.count)throw Error("Invalid intent range count, we should get exactly one intent");C=C.K(0);const S=C.Dc,ja=this.Rhj(n.characterData,0,S);return{vu:C.Dc-ja,cpEnd:C.end-(ja+this.Rhj(n.characterData,S,C.end-1))}}Rhj(e,n,C){let S=0;for(;n<C;)e[n]===pn.AParagraphNode.RB&&n<e.length&&S++,n++;return S}Sca(e,n){this.Cv.Sca(e,n);this.f3b.Kse()}}hv.Cch=1;hv.jsk="#CP";
hv.zXd="CopilotHighlight";hv.wXk="AddInCritique";Object(F.a)(hv,"AnnotationOperations",null,[1202]);class NC{constructor(e,n,C){this.OVl=1;this.NVl=2;this.ui=n;this.l9=C;this.tB=e}getAppRuntimeStartState(){const e=this.l9.fVa(this.tB);return this.ui.ZFf(e)==Jl.background?1:0}setAppRuntimeStartState(e){const n=this.l9.fVa(this.tB);this.ui.tMj(n,1==e?Jl.background:Jl.Pae)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case this.NVl:return this.vim();case this.OVl:return this.mSo(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}vim(){return this.getAppRuntimeStartState()}mSo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.setAppRuntimeStartState(e);return null}}Object(F.a)(NC,"AppRuntimePersistenceService",null,[]);class HG{constructor(e,n){this.Z0=e;this.l9=n}create(e,n){return new NC(n,this.Z0,this.l9,e)}}Object(F.a)(HG,"AppRuntimePersistenceServiceFactory",null,[]);class IG{constructor(e,
n,C){this.ui=n;this.l9=C;this.tB=e}getAppRuntimeState(){const e=this.l9.fVa(this.tB);return this.ui.c3(e)?2:1}setAppRuntimeState(e){const n=this.l9.fVa(this.tB);2===e?(e=this.ui.X8d(n),e.isForUILessAction=!1,this.ui.showTaskPane(n,null,e)):1===e&&this.ui.OTa(n)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 2:return this.wim();case 1:return this.nSo(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}wim(){return this.getAppRuntimeState()}nSo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");this.setAppRuntimeState(e);return null}}Object(F.a)(IG,"AppRuntimeService",null,[]);class kB{constructor(e,n){this.Z0=e;this.l9=n}create(e,n){return new IG(n,this.Z0,this.l9,e)}}Object(F.a)(kB,"AppRuntimeServiceFactory",null,[]);var At=d(1439),xJ=d(319),lB=d(1856),zr=d(724),Hh=d(1398);class JG extends Hh.a{constructor(e,n,C,S){super();this.kB=e;this._context=n;this.zo=C;this.Re=S}get content(){return void 0===this.kB.content||null===this.kB.content?{}:this.kB.content}get id(){return this.kB.id}get _ReferenceId(){return this.Hp?
this.Vp:null}get _State(){return void 0===this.kB.content||null===this.kB.content||void 0===this.kB.content.M_||null===this.kB.content.M_||void 0===this.kB.content.M_.state||null===this.kB.content.M_.state?0:this.kB.content.M_.state}set _State(e){void 0!==this.kB.content&&null!==this.kB.content&&void 0!==this.kB.content.M_&&null!==this.kB.content.M_||pc.a.hg();this.kB.content.M_.state=e;this.Re.Sca(this.kB,e)}deleteObject(){this.FXa();const e=Object(Jg.a)(zr.a,this.kB.parent);e||pc.a.hg();e.deleteAnnotation(this.kB.content);
this._State=70}getParentAsAnnotation(){this.FXa();if(3===this.kB.oXb&&this.kB.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new JG(this.kB.parent,this._context,this.zo,this.Re));pc.a.hg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentAsParagraph(){this.FXa();if(2===this.kB.oXb&&this.kB.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.zo.create(this.kB.parent,this._context));pc.a.hg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentType(){this.FXa();
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.kB.oXb)}_KeepReference(){this.xp()}_OnAccess(){}getTypeName(){return jh.a.FD?"Microsoft.WordServices.AugloopAnnotation":"Microsoft.WordServices.Annotation"}invokePropertyGet(e){switch(e){case 1:return this.content;case 2:return this.id;case 3:return this._ReferenceId;case 4:return this._State}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,
n){switch(e){case 4:this._State=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1006:return this.VC(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,
n){switch(e){case 1005:return this.eFm();case 1004:return this.fFm();case 1003:return this.oFm()}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();return null}eFm(){return this.getParentAsAnnotation()}fFm(){return this.getParentAsParagraph()}oFm(){return this.getParentType()}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}FXa(){this.kB.utb||(this._context.Cn.CF(),this._context.Cn.Dv(),this.kB=this.Re.FXa(this.kB.id),
this.kB.utb||pc.a.hg())}}Object(F.a)(JG,"Annotation",Hh.a,[901]);class Ar{constructor(e,n,C){this.OIe=this.El=-1;this.iq=C;0<e&&(this.El+=e);this.OIe=0<n?e+n<this.iq.length()?e+n:this.iq.length():this.iq.length()}get_current(){return this.El<this.OIe?this.iq._GetItem(this.El):null}moveNext(){const e=this.orp();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}orp(){this.El++;return this.El<this.OIe?!0:!1}}Object(F.a)(Ar,"ElementEnumerator",null,[946]);class jr extends Hh.a{constructor(e,
n,C,S){super();this.JY=this.QMc=null;this.ynk=e;this._context=n;this.Re=C;this.zo=S;C.ub(this,e)}length(){return this.QMc.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){return!this.QMc||0>=this.length()?null:this.getItem(0)}getItem(e){return this._GetItem(e)}refresh(){this._context.Cn.CF();this._context.Cn.Dv();return this.Re.getAnnotationsByType(this.ynk).then(e=>{this.Chd(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)})}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return jh.a.FD?"Microsoft.WordServices.AugloopAnnotationCollection":"Microsoft.WordServices.AnnotationCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.y_(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1005:return this.sto()}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}y_(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}sto(){return this.refresh()}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}gH(e,n){try{const C=new JG(e,this._context,this.zo,this.Re);C.xp();this.xp();n===Vh.a.getTypeName()?OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,4,C._ReferenceId):this.JY&&n===CC.a.getTypeName()?(this.JY.W(e.id,C),OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,
5,C._ReferenceId)):n===At.a.getTypeName()&&OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,6,C._ReferenceId);e.annotationType===xJ.a.getTypeName()&&this.qvp(e,n)}catch(C){lB.a.$bd(C,[e],!1)}}qvp(e,n){n===Vh.a.getTypeName()?lB.a.Azb(e,32):n===At.a.getTypeName()&&lB.a.Azb(e,64)}_GetItem(e){let n=null;"number"===typeof e?e<this.length()&&(n=this.QMc.K(e)):"string"===typeof e&&(n=e);if(n&&this.JY.tb(n))return this.JY.K(n);pc.a.td();return null}Chd(e){this.JY=new fd.a;
this.QMc=new fb.a;if(e)for(const n of e)this.QMc.add(n.id),this.JY.add(n.id,new JG(n,this._context,this.zo,this.Re))}}Object(F.a)(jr,"AnnotationCollection",Hh.a,[114,901,931]);class Qy{constructor(e,n){this.Re=e;this.zo=n}create(e,n){return new jr(e,n,this.Re,this.zo)}}Object(F.a)(Qy,"AnnotationCollectionFactory",null,[]);var mL=d(1851);class KG{constructor(){this.y9g=this.ugb=null;this.z9g=0;this.lJh=this.FQc=null;this.onh=!1}get appId(){return this.ugb}set appId(e){this.ugb=e}get authority(){return this.y9g}set authority(e){this.y9g=
e}get authorityType(){return this.z9g}set authorityType(e){this.z9g=e}get isAnonymous(){return this.onh}set isAnonymous(e){this.onh=e}get tenantId(){return this.FQc}set tenantId(e){this.FQc=e}get upn(){return this.lJh}set upn(e){this.lJh=e}getTypeName(){return"Microsoft.Authentication.AuthContext"}invokePropertyGet(e){switch(e){case 4:return this.appId;case 2:return this.authority;case 3:return this.authorityType;case 5:return this.isAnonymous;case 6:return this.tenantId;case 1:return this.upn}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 4:this.appId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 2:this.authority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.authorityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 5:this.isAnonymous=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 1:this.upn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}O7l(e){this.upn=e.upn;this.authority=e.authority;this.authorityType=e.authorityType;this.tenantId=e.tenantId;this.isAnonymous=e.isAnonymous}}Object(F.a)(KG,"AuthContext",null,[]);var qu=d(1538),AE;(function(e){e[e.unknown=-1]="unknown";e[e.Dgq=0]="organizationAccount";e[e.k9p=1]="microsoftAccount"})(AE||(AE={}));Object(F.b)("IdentityType",AE);class OC{constructor(){this.rhh=this.Zfh=
this.Cwa=null;this.NIc=0}get displayName(){return this.Cwa}set displayName(e){this.Cwa=e}get email(){return this.Zfh}set email(e){this.Zfh=e}get federationProvider(){return this.rhh}set federationProvider(e){this.rhh=e}get identityType(){return this.NIc}set identityType(e){this.NIc=e}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(e){switch(e){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}static lGl(e){const n=new OC;n.displayName=e.displayName;n.email=e.email;switch(e.authority){case "MicrosoftAccount":n.identityType=
1;break;default:n.identityType=0}n.federationProvider="";return n}}Object(F.a)(OC,"OfficeIdentityInfo",null,[]);class BE{constructor(e,n,C){this.LH=null;this._id=e;this._value=n;this.Rk=C}get id(){return this._id}get value(){return this._value}set value(e){}getTypeName(){return"Microsoft.Authentication.RoamingSetting"}invokePropertyGet(e){switch(e){case 1:return this.id;case 2:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 2:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");this.LH=n[0].toString();return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromise((C,S)=>{if(1===this.Rk){let ja,ya;try{ja=gc.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager"),
ya=gc.a.instance.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),Object(Wo.b)()?Object(Wo.a)(2,()=>ja.oSc(parseInt(this.LH)),!1,()=>!0).then(()=>{ya.bAj();C(null)}).catch(kb=>{E.ULS.sendTraceTag(528859142,3011,10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",kb);S(kb)}):ja.oSc(parseInt(this.LH)).then(()=>{ya.bAj();C(null)}).catch(kb=>{S(kb)})}catch(kb){S(kb)}}else 0===this.Rk?(gc.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").vJj(this.LH),
C(null)):S(null)})}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(BE,"RoamingSetting",null,[]);class Sz{getItem(e){let n,C;if("ridTranscriptionQuotaMinutesUsed"===e)return OfficeExtension.WacRuntime.Utility.createPromise(S=>{Object(Wo.b)()?Object(Wo.a)(2,()=>gc.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").j9a(),
!0,()=>!0).then(ja=>{n=ja.toString();C=1;S(new BE(e,n,C))}).catch(ja=>{E.ULS.sendTraceTag(528859141,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",ja)}):gc.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").j9a().then(ja=>{n=ja.toString();C=1;S(new BE(e,n,C))})});n=gc.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").i0a;C=0;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new BE(e,n,C))}getItemOrNullObject(){return null}getTypeName(){return"Microsoft.Authentication.RoamingSettingCollection"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1:return this.y_(n);case 2:return this.d9a(n)}e=
this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}d9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}}Object(F.a)(Sz,"RoamingSettingCollection",null,[]);class iv{static get Wki(){return iv.Luk}static kfa(e){return e in iv.Wki?iv.Wki[e].toString():e}}iv.map=null;iv.Luk={["GeneralException"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException,
["AccessDenied"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied,["ApiNotAvailable"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ApiNotAvailable,["UserNotSignedIn"]:WordEditorIntl.WordEditorStrings.L_UserNotSignedIn,["UserAborted"]:WordEditorIntl.WordEditorStrings.L_UserAborted,["UnsupportedUserIdentity"]:WordEditorIntl.WordEditorStrings.L_UnsupoortedUserIdentity,["InvalidResourceUrl"]:WordEditorIntl.WordEditorStrings.L_InvalidResourceUrl,["InvalidGrant"]:WordEditorIntl.WordEditorStrings.L_InvalidGrant,
["AddinIsAlreadyRequestingToken"]:WordEditorIntl.WordEditorStrings.L_SSOAddinIsAlreadyRequestingToken,["ResourceNotAllowed"]:WordEditorIntl.WordEditorStrings.L_SSOResourceNotAllowed,["ClientError"]:WordEditorIntl.WordEditorStrings.L_SSOClientError,["ServerError"]:WordEditorIntl.WordEditorStrings.L_SSOServerError};Object(F.a)(iv,"SingleSignOnErrorCodeMap",null,[]);class yJ{constructor(e,n){this.Svd=e;this.NIc=n}get accessToken(){return this.Svd}set accessToken(e){this.Svd=e}get tokenIdenityType(){return this.NIc}set tokenIdenityType(e){this.NIc=
e}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(e){switch(e){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(yJ,"SingleSignOnToken",
null,[]);class PC{constructor(e,n,C,S){this.ui=n;this.tB=e;this._context=S}get roamingSettings(){if(!this.ui.yt.getOsfControl(this.tB).isFirstParty())throw OfficeExtension.WacRuntime.Utility.createRichApiException(qu.a.$Jb,iv.kfa(qu.a.$Jb));return new Sz}getAccessToken(e){const n=this.ui.yt,C=n.getOsfControl(this.tB),S=C.getManifest(),ja=S.getMarketplaceID(),ya=S.getMarketplaceVersion();this.qP(e,ja,ya);return OfficeExtension.WacRuntime.Utility.createPromise((kb,Rb)=>{n._enableFirstPartySSO?C.isFirstParty()&&
this.Bfn(S,e)?(this._context.Cn.CF(),gc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(e,ja).then(sc=>{this._context.Cn.Dv();kb(sc)},sc=>{this._context.Cn.Dv();Rb(sc.toString())})):Rb(qu.a.$Jb):Rb(qu.a.$gf)}).then(kb=>{let Rb;switch(kb.authority){case mL.a.Y5n:Rb=1;break;default:Rb=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new yJ(kb.accessToken,Rb))},kb=>{this.xEn(e,ja,kb);return kb?OfficeExtension.WacRuntime.Utility.createPromise((Rb,sc)=>
{sc(OfficeExtension.WacRuntime.Utility.createRichApiException(kb,iv.kfa(kb)))}):OfficeExtension.WacRuntime.Utility.createPromise((Rb,sc)=>{sc(OfficeExtension.WacRuntime.Utility.createRichApiException(qu.a.x8a,iv.kfa(qu.a.x8a)))})})}getAuthContext(){const e=this.ui.yt.getOsfControl(this.tB).getManifest(),n=e.getMarketplaceID(),C=e.getWebApplicationId();return OfficeExtension.WacRuntime.Utility.createPromise((S,ja)=>{this._context.Cn.CF();gc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(n).then(ya=>
{this._context.Cn.Dv();S(ya)},ya=>{this._context.Cn.Dv();ja(ya.toString())})}).then(S=>{const ja=new KG;ja.O7l(S);ja.appId=C;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ja)},S=>S?OfficeExtension.WacRuntime.Utility.createPromise((ja,ya)=>{ya(OfficeExtension.WacRuntime.Utility.createRichApiException(S,iv.kfa(S)))}):OfficeExtension.WacRuntime.Utility.createPromise((ja,ya)=>{ya(OfficeExtension.WacRuntime.Utility.createRichApiException(qu.a.x8a,iv.kfa(qu.a.x8a)))}))}getPrimaryIdentityInfo(){const e=
this.ui.yt.getOsfControl(this.tB).getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{this._context.Cn.CF();gc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(e).then(S=>{this._context.Cn.Dv();n(S)},S=>{this._context.Cn.Dv();C(S.toString())})}).then(n=>{n=OC.lGl(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)},n=>n?OfficeExtension.WacRuntime.Utility.createPromise((C,S)=>{S(OfficeExtension.WacRuntime.Utility.createRichApiException(n,
iv.kfa(n)))}):OfficeExtension.WacRuntime.Utility.createPromise((C,S)=>{S(OfficeExtension.WacRuntime.Utility.createRichApiException(qu.a.x8a,iv.kfa(qu.a.x8a)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(e){switch(e){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1:return this.cgm(n);case 3:return this.Gim();case 2:return this.VGm()}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}cgm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Rk);return this.getAccessToken(e)}Gim(){return this.getAuthContext()}VGm(){return this.getPrimaryIdentityInfo()}Bfn(e,
n){let C=!1;const S=e.getWebApplicationAuthorizations();e=null;for(const kb of S)if(kb.getResource().toLowerCase()===n.resource.toLowerCase()){e=kb;C=!0;break}if(!C){var ja="";for(var ya of S)ja+=this.ecg(ya.getResource().toLowerCase())+",";ja=ja.substring(0,ja.length-1);E.ULS.sendTraceTag(39362643,369,50,"{0}",Bf.c({["event"]:"AuthenticationService::IsAuthorizationDeclared",["authsLength"]:S.length,["resources"]:ja}));return!1}ya=n.scope.split(" ,+");for(ja of ya)if(""!==ja){ya=!1;for(const kb of e.getScopes())ja.toLowerCase()===
kb.toLowerCase()&&(ya=!0);if(!ya)return!1}return!0}qP(e,n,C){e=this.ecg(e.resource);E.ULS.sendTraceTag(39102240,369,50,"{0}",Bf.c({["manifestId"]:n,["manifestVersion"]:C,["resource"]:e}))}xEn(e,n,C){e=this.ecg(e.resource);E.ULS.sendTraceTag(39102241,369,10,"{0}",Bf.c({["manifestId"]:n,["resource"]:e,["error"]:C}))}ecg(e){return(e?e:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(F.a)(PC,"AuthenticationService",null,[]);class QC{constructor(e,n){this.Z0=e;this.Nia=
n}create(e,n){return new PC(n,this.Z0,this.Nia,e)}}Object(F.a)(QC,"AuthenticationServiceFactory",null,[]);class Wt extends Hh.a{constructor(e){super();pc.a.Tx(e,"FieldCollection");this.K6b=e}length(){return this.K6b.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){return this.K6b&&this.K6b.count?this.K6b.K(0):null}getByTypes(e){const n=new fb.a;for(const C of this.K6b)for(const S of e)if(C.type===S){n.add(C);
break}return new Wt(n)}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.K6b.K(e);pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.FieldCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1002:return this.jh();case 1001:return this.kh();case 1005:return this.wGf(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}wGf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<int>");return this.getByTypes(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Wt,"FieldCollection",
Hh.a,[901,931]);class Hs extends Hh.a{constructor(e){super();pc.a.Tx(e,"InlinePictureCollection");this.fJc=e}length(){return this.fJc.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){pc.a.ej()||pc.a.Kj();return!this.fJc||0>=this.fJc.count?null:this.fJc.K(0)}_GetItem(e){e=pc.a.QN(e);if(e<this.length())return this.fJc.K(e);E.ULS.sendTraceTag(16847771,369,10,"The index is out of the paragraph range.");pc.a.td();
return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.InlinePictureCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Hs,"InlinePictureCollection",Hh.a,[901,931]);var bt=d(1466),mB;(function(e){e[e.body=0]="body";e[e.jra=1]="contentControl";e[e.rYp=2]="customProperty";e[e.paragraph=3]="paragraph";e[e.range=4]="range";e[e.table=5]="table";e[e.Mu=6]="tableRow"})(mB||(mB={}));Object(F.b)("ObjectType",mB);class Tz extends Hh.a{constructor(e,
n,C,S,ja,ya,kb){super();this.M8b=this.qjb=null;pc.a.Tx(mB[e],"ListCollection.calledClassName");pc.a.Tx(ja,"ListCollection.requestContext");this.iCb=e;this.Tn=n;this.Ze=C;this.vx=S;this._context=ja;this.Xn=ya;this.hb=kb;this.vx&&this._context.upc&&(this.M8b=this.vx.Smc.create(this.vx.Xo))}length(){return this.qjb.count}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.qjb.K(e);E.ULS.sendTraceTag(19772865,369,10,"The index is out of the boundary of list in class ListCollection.");pc.a.td();
return null}get _ReferenceId(){return this.Hp?this.Vp:null}getById(e){(e=this.getByIdOrNullObject(e))||pc.a.Wk();return e}getByIdOrNullObject(e){if(!this.qjb||!this.length())return null;for(let n=0;n<this.length();n++)if(this.qjb.K(n).id===e)return this.qjb.K(n);return null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){this.a7j();return this.qjb&&this.length()?this.qjb.K(0):null}getItem(e){e=pc.a.QN(e);return this.getById(e)}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,
n){this.a7j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.ListCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1002:return this.a2c(n);case 1005:return this.b2c(n);case 1004:return this.dD();case 1006:return this.eD();case 1:return this.y_(n);case 1001:return this.jh();case 1003:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}a2c(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getById(e)}b2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getByIdOrNullObject(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}a7j(){let e=null;switch(this.iCb){case 0:e=this.hb.NA(this.Tn,
!0,!1);break;case 1:e=this.Ze.DF();break;case 4:e=G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.vx.Jsb?this.vx.Jsb.Xo:this.M8b?this.M8b.Xo:this.vx.Xo:this.vx.Xo;break;default:E.ULS.sendTraceTag(19772866,369,15,"AppId:{0}, invalid object type to get the list collection.",this._context.appId)}this.qjb=this.Xn.Bsi(e,this._context)}ikd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.M8b&&(this.M8b.exb(),this.M8b=null)}}Object(F.a)(Tz,"ListCollection",
Hh.a,[901,931]);class Qu extends Hh.a{constructor(e){super();pc.a.Tx(e,"NoteItemCollection");this.aMc=e}length(){return this.aMc.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){return this.aMc&&this.aMc.count?this.aMc.K(0):null}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.aMc.K(e);pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,
n,this))}getTypeName(){return"Microsoft.WordServices.NoteItemCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}}Object(F.a)(Qu,"NoteItemCollection",Hh.a,[901,931]);class jv extends Hh.a{constructor(e){super();pc.a.Tx(e,"ParagraphCollection");this.EQ=e}length(){return this.EQ.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){pc.a.ej()||pc.a.Kj();return this.EQ&&this.EQ.count?this.EQ.K(0):null}getLast(){const e=this.getLastOrNullObject();e||pc.a.Wk();return e}getLastOrNullObject(){pc.a.ej()||
pc.a.Kj();return this.EQ&&this.EQ.count?this.EQ.K(this.EQ.count-1):null}_GetItem(e){e=pc.a.QN(e);if(e<this.length())return this.EQ.K(e);E.ULS.sendTraceTag(16795330,369,10,"The index is out of the paragraph range.");pc.a.td();return null}getById(e){(e=this.getByIdOrNullObject(e))||pc.a.Wk();return e}getByIdOrNullObject(e){var n;if(!e||!this.EQ||!this.EQ.count)return null;const C=this.EQ.getEnumerator();for(;C.moveNext();){const S=C.get_current();if((null===(n=S.psa())||void 0===n?void 0:n.id.toString())===
e)return S}return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.ParagraphCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1005:return this.eD();case 1004:return this.Pxm();case 1006:return this.Sxm();case 1007:return this.a2c(n);case 1008:return this.b2c(n);case 1:return this.WN(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=
this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}Pxm(){return this.getLast()}Sxm(){return this.getLastOrNullObject()}a2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getById(e)}b2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByIdOrNullObject(e)}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(jv,"ParagraphCollection",Hh.a,[901,931]);class nB extends Hh.a{constructor(e,n,C,S,ja,ya){super();this.Eac=this._tables=null;this.iCb=e;this.WHb=n;this.vx=C;this.Ze=S;this._context=ja;this.ld=ya;this.vx&&this._context.upc&&(this.Eac=this.vx.Smc.create(this.vx.Xo))}length(){return this._tables.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();
e||pc.a.Wk();return e}getFirstOrNullObject(){this.o9j();return this._tables&&this.length()?this._tables.K(0):null}_GetItem(e){e=pc.a.QN(e);if(e<this._tables.count)return this._tables.K(e);E.ULS.sendTraceTag(19969492,369,10,"The index is out of the table collection range.");pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){this.o9j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.TableCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}o9j(){switch(this.iCb){case 0:case 5:this._tables=this.ld.XNm(this.WHb,this._context);break;case 1:var e=this.Ze.DF();this._tables=this.ld.OHi(e.K(0),
e.K(e.count-1),this._context);break;case 4:e=G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.vx.Jsb?this.vx.Jsb.Xo:this.Eac?this.Eac.Xo:this.vx.Xo:this.vx.Xo;this._tables=this.ld.OHi(e.K(0),e.K(e.count-1),this._context);break;default:E.ULS.sendTraceTag(19969493,369,15,"AppId:{0}, invalid object type to get the table collection.",this._context.appId)}}ikd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.Eac&&(this.Eac.exb(),this.Eac=null)}}
Object(F.a)(nB,"TableCollection",Hh.a,[901,931]);class kv extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb){super();this.taf=null;this.iCb=e;this.WHb=n;this.vx=C;this.Ze=S;this._context=ja;this.wx=ya;this.hb=kb;this.Hl=Rb;this.vx&&this._context.upc&&(this.taf=this.vx.Smc.create(this.vx.Xo))}length(){return this.NSa.count}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.NSa.K(e);pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}acceptAll(){for(const e of this.NSa)e.accept()}getFirst(){const e=
this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){this.B9j();return this.NSa&&0<this.NSa.count?this.NSa.K(0):null}rejectAll(){for(const e of this.NSa)e.reject()}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){this.B9j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.TrackedChangeCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1006:return this.FTk();case 1004:return this.dD();case 1005:return this.eD();case 1:return this.WN(n);case 1007:return this.cyo();
case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}FTk(){this.acceptAll();return null}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}cyo(){this.rejectAll();return null}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}B9j(){switch(this.iCb){case 3:var e=new fb.a,n=ce.a.create(this.WHb);e.add(n);this.NSa=this.wx.PIi(e,this._context);break;case 0:new fb.a;e=this.hb.NA(this.WHb,!0,!1);this.NSa=this.wx.PIi(e,this._context);break;case 1:var C=this.Ze.DF();e=this.Hl.DPb(C,5);if(C&&e&&0<C.count&&0<e.count){n=C.K(0);C=C.K(C.count-1);const S=e.K(0),ja=e.K(e.count-1);S.Fb=n.Fb+1;ja.Tb=C.Tb-1}this.NSa=this.wx.QIi(e,this._context);break;case 4:e=G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?
this.vx.Jsb?this.vx.Jsb.Xo:this.taf?this.taf.Xo:this.vx.Xo:this.vx.Xo;this.NSa=this.wx.QIi(e,this._context);break;default:E.ULS.sendTraceTag(508123031,369,15,"AppId:{0}, invalid object type to get the trackedChange collection.",this._context.appId)}}}Object(F.a)(kv,"TrackedChangeCollection",Hh.a,[901,931]);class Lv extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih){super();pc.a.bPa(e,"Body");this.Tn=e;this._context=n;this.zo=C;this.nk=S;this.zC=ja;this.iO=ya;
this.Lxa=kb;this.fd=Rb;this.yoa=sc;this.hb=Fc;this.Lq=gd;this.xB=td;this.Yc=Bd;this.ay=wd;this.sh=te;this.vB=Le;this.px=Oe;this.Hl=We;this.ld=Xf;this.Xn=Gg;this.Ot=Ph;this.wx=Aj;this.Xx=Ih}get dWh(){return this.Tn}get contentControls(){const e=new wo;e.types=[31];return this.getContentControls(e)}get endnotes(){var e=new fb.a;switch(this.type){case 4:case 1:case 0:e.addRange(this.Yc.Hjc(this.Tn,1));break;case 2:case 3:case 5:case 6:return null}e=this.Yc.sza(e,this._context);return new Qu(e)}get fields(){const e=
new fb.a;switch(this.Tn.type){case 8:case 10:case 36:case 16:case 38:case 37:const n=this.hb.Kv(this.Tn,!0,!1),C=n.count;for(let S=0;S<C;S++){const ja=this.Xx.Ejc(n.K(S),this._context,!0);e.addRange(ja)}break;default:E.ULS.sendTraceTag(539530944,369,10,"AppId:{0}, in function Body.Fields, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),pc.a.hg()}return new Wt(e)}get font(){return this.zC.create(0,this.Tn,null,null,this._context)}get footnotes(){var e=
new fb.a;switch(this.type){case 4:case 1:case 0:e.addRange(this.Yc.Hjc(this.Tn,0));break;case 2:case 3:case 5:case 6:return null}e=this.Yc.sza(e,this._context);return new Qu(e)}get inlinePictures(){var e=this.hb.Kv(this.Tn,!0,!1);let n=0;const C=new fb.a;for(const S of e){e=new fb.a;this.ay.KJf(e,S);for(const ja of e)C.add(this.iO.create(ja,this._context,n++))}return new Hs(C)}get lists(){return pc.a.ej()?new Tz(0,this.Tn,null,null,this._context,this.Xn,this.hb):null}get paragraphs(){const e=this.hb.Kv(this.Tn,
!0,!1);let n=0;const C=new fb.a;for(const S of e)C.add(this.zo.create(S,this._context,n++));return new jv(C)}get parentBody(){if(!pc.a.ej())return null;const e=this.parentBodyOrNullObject;e||pc.a.Wk();return e}get parentBodyOrNullObject(){return pc.a.ej()?this.ld.BLf(this.Tn,this._context):null}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||pc.a.Wk();return e}get parentContentControlOrNullObject(){const e=ce.a.create(this.tsa(!0)),n=ce.a.create(this.tsa(!1));this.Yc.QOa(e,
n);return this.sh.Skc(e,n,this._context)}get parentSection(){if(!pc.a.ej())return null;const e=this.parentSectionOrNullObject;e||pc.a.Wk();return e}get parentSectionOrNullObject(){if(!pc.a.ej())return null;const e=this.fd.mg(this.Tn);let n=null;switch(this.Tn.type){case 16:case 36:e.zb(10)&&(n=e.Dp(10));break;case 10:n=this.Tn;break;case 8:1===e.ar()&&(n=e.je())}return n?this.Lxa.create(n,this._context):null}get style(){const e=this.hb.NA(this.Tn,!0,!1);return this.xB.c3c(e)}set style(e){const n=
this.hb.NA(this.Tn,!0,!1);this.xB.Qwc(n,e)}get styleBuiltIn(){if(!pc.a.ej())return-1;const e=this.hb.NA(this.Tn,!0,!1);return this.xB.h6d(e)}set styleBuiltIn(e){pc.a.ej()||pc.a.Kj();const n=this.hb.NA(this.Tn,!0,!1);this.xB.Ywe(n,e)}get tables(){return pc.a.ej()?new nB(0,this.Tn,null,null,this._context,this.ld):null}get text(){let e="";switch(this.Tn.type){case 8:case 10:case 36:case 16:case 38:case 37:const n=this.hb.Kv(this.Tn,!0,!1),C=n.count;for(let S=0;S<C;S++)e+=this.hb.AXb(n.K(S)),S<C-1&&(e+=
pc.a.kqc);break;default:E.ULS.sendTraceTag(16814427,369,10,"AppId:{0}, in function Body.Text, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),pc.a.hg()}return e}get type(){if(!pc.a.ej())return-1;switch(this.Tn.type){case 8:return 0;case 10:const e=this.fd.mg(this.Tn);e.zb(8);e.kd(8);return 1===e.ar()?0:1;case 36:switch(this.Tn.properties.getValue(hb.a.Flc)){case 0:case 2:case 1:return 2;case 3:case 5:case 4:return 3;default:return-1}case 16:return 4;
case 38:return 7;case 37:return 1==this.Tn.getValue(hb.a.Y6)?5:6;default:return-1}}get _ReferenceId(){return this.Hp?this.Vp:null}clear(){const e=(new Date).getTime(),n=this.hb.NA(this.Tn,!0,!1);pc.a.gBc(n,"Body.Clear");this.Yc.ROa(n.K(0));this.Yc.ROa(n.K(n.count-1));if(8===this.Tn.type&&1<Ed.a.eb(this.Tn).ar())return OfficeExtension.WacRuntime.Utility.createPromise((C,S)=>{this.Yc.vrl(n,this._context,C,S,e)});this.Yc.WLb(n);pc.a.dDf()||(5===this.type||6===this.type)&&this.insertText(" ",2);pc.a.oP("Body.Clear",
pc.a.fQ(e));return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getComments(){if(0===this.type)return this.Ot.fhm(this._context);if(1===this.type)return this.Ot.Bmm(this.Tn,this._context);const e=this.hb.NA(this.Tn,!0,!1);return this.Ot.b5d(e,this._context)}getContentControls(e){var n;e=null!==(n=null===e||void 0===e?void 0:e.types)&&void 0!==n?n:[];pc.a.q_c(e);n=this.sh.RMm(this.Tn,this._context);return 0===e.length?n:null===n||void 0===n?void 0:n.getByTypes(e)}getHtml(){const e=
this.hb.NA(this.Tn,!0,!1);return this.px.getHtml(e.toArray(),this._context)}getOoxml(){const e=(new Date).getTime();this._context.Cn.CF();return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{const S=this.hb.NA(this.Tn,!0,!1);this.px.getOoxml(S,this._context,n,C,e)})}getReviewedText(e){let n="";switch(this.Tn.type){case 8:case 10:case 36:case 16:case 38:case 37:const C=this.hb.Kv(this.Tn,!0,!1),S=C.count;for(let ja=0;ja<S;ja++)n+=this.wx.l8d(C.K(ja),e);break;default:E.ULS.sendTraceTag(545005571,
369,10,"NodeType:{0} is not supported to get the reviewed text.",this.Tn.type)}return n}getTrackedChanges(){return new kv(0,this.Tn,null,null,this._context,this.wx,this.hb,this.Hl)}getRange(e){pc.a.ej()||pc.a.Kj();let n=new fb.a;e&&5!==e?1===e?n.add(ce.a.create(this.tsa(!0))):2===e||4===e?n.add(ce.a.create(this.tsa(!1))):(E.ULS.sendTraceTag(18745291,369,15,"AppId:{0}, rangeLocation of Body.GetRange must be Start/End/Whole/Content/After.",this._context.appId),pc.a.td()):n=this.hb.NA(this.Tn,!0,!1);
this.Hl.Gwe(n);return(e=this.Hl.DPb(n,e))?this.nk.create(e,this._context):null}insertBreak(e,n){const C=(new Date).getTime(),S=new fb.a;this.Yc.H0f(this.Tn)&&6!==e&&pc.a.sC();switch(n){case 2:var ja=!1;e||(ja=!0);ja=this.hb.Zm(this.Tn,!0,ja);S.add(ce.a.create(ja));break;case 3:ja=this.tsa(!1);S.add(ce.a.create(ja));break;default:E.ULS.sendTraceTag(17179034,369,15,"AppId:{0}, insertLocation of Body.InsertBreak must be Start or End.",this._context.appId),pc.a.td()}6===e?this.Yc.QOa(S.K(0),S.K(0)):S.K(0).contextId!==
Ma.a.table&&(ja=this.Yc.$6a(S.K(0).node,2===n),S.W(0,ja));return OfficeExtension.WacRuntime.Utility.createPromise((ya,kb)=>{this.Yc.insertBreak(S,e,n,this._context,ya,kb,C)})}insertContentControl(e){pc.a.$zf(e,"Body");e=pc.a.vrd(e,0);8!==e||pc.a.dia||pc.a.td();const n=this.Yc.qfc(this.tsa(!0),!0),C=this.Yc.qfc(this.tsa(!1),!1);return this.sh.sqa(n,C,this._context,e)}insertFileFromBase64(e,n){"<"===e.charAt(0)&&(E.ULS.sendTraceTag(18130831,369,10,"invalid argument for insertFileFromeBase64 API in Body class.",
this._context.appId),pc.a.td());return this.Nla(e,n,!1)}insertHtml(e,n){const C=(new Date).getTime();let S=new fb.a;var ja=2;switch(n){case 2:case 3:ja=this.tsa(2===n);S.add(ce.a.create(ja));ja=2===n?0:1;break;case 4:return S=this.hb.NA(this.Tn,!0,!1),pc.a.gBc(S,"Body.InsertHtml"),this.clear().then(()=>this.insertHtml(e,2));default:pc.a.td()}this.Yc.QOa(S.K(0),S.K(S.count-1),ja);return this.px.insertHtml(S,e,n,C,this._context)}insertInlinePictureFromBase64(e,n){const C=(new Date).getTime();2!==n&&
3!==n&&(E.ULS.sendTraceTag(17433734,369,50,"AppId:{0}, insert inline picture with none supported location in Body class",this._context.appId),pc.a.td());const S=ce.a.create(this.tsa(2===n));let ja=null;this.Yc.QOa(S,S);({BL:ja}=this.Yc.dN(S,S,n));let ya;this.Yc.FW((ya=new fb.a,ya.add(ja),ya),n,0);return this.ay.lSb(e,ja,this._context).then(kb=>{this._context.Cn.Dv(this.Tn);if(!kb)return E.ULS.sendTraceTag(17433736,369,10,"AppId:{0}, something went wrong when insert iamge into Body.",this._context.appId),
pc.a.oP("Body.InsertInlinePictureFromBase64",pc.a.fQ(C),e.length,!1),pc.a.hg(),null;pc.a.oP("Body.InsertInlinePictureFromBase64",pc.a.fQ(C),e.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.iO.create(this.ay.t0c(kb),this._context))})}insertOoxml(e,n){"<"!==e.charAt(0)&&(E.ULS.sendTraceTag(18130832,369,10,"invalid argument for InsertOoxml API in Body class.",this._context.appId),pc.a.td());return this.Nla(e,n,!0)}insertParagraph(e,n){var C=!1,S=null;switch(n){case 2:n=
0;S=this.hb.Zm(this.Tn,!0,!0);C=!0;break;case 3:n=1;S=this.hb.GF(this.Tn,!0,!0);C=!1;break;default:E.ULS.sendTraceTag(17319647,369,15,"AppId:{0}, Invalid insert location for Body.InsertPparagraph method.",this._context.appId),pc.a.td()}S||pc.a.hg();if(14===S.type){let ya;var ja=this.ld.D6d((ya=new fb.a,ya.add(ce.a.create(S)),ya),C);e=pc.a.OWc(e);let kb;this.Yc.insertText((kb=new fb.a,kb.add(ce.a.Uc(ja.node,0)),kb),e,n);C=ja.node}else S=this.Yc.$6a(S,C),C=this.Yc.insertParagraph((ja=new fb.a,ja.add(S),
ja),e,n);return this.zo.create(C,this._context)}insertTable(e,n,C,S){pc.a.ej()||pc.a.Kj();const ja=new fb.a;var ya=!1;let kb=null;switch(C){case 2:C=0;kb=this.hb.Zm(this.Tn,!0,!0);ya=!0;break;case 3:C=1;kb=this.hb.GF(this.Tn,!0,!0);ya=!1;break;default:E.ULS.sendTraceTag(19951649,369,15,"AppId:{0}, Invalid insert location for Body.InsertTable method.",this._context.appId),pc.a.td()}kb||pc.a.hg();14===kb.type?ja.add(ce.a.create(kb)):(ya=this.Yc.$6a(kb,ya),ja.add(ya));return this.ld.insertTable(ja,e,
n,C,S,this._context)}insertText(e,n){var C=new fb.a;switch(n){case 2:case 3:const S=this.tsa(2===n);C.add(ce.a.create(S));this.Yc.QOa(C.K(0),C.K(C.count-1));break;case 4:(C=this.parentContentControlOrNullObject)&&C.clear();C=this.hb.NA(this.Tn,!0,!1);this.Yc.Xv(C.K(0));this.Yc.Xv(C.K(C.count-1));break;default:E.ULS.sendTraceTag(21284487,369,15,"AppId:{0}, undefined location for Body.InsertText: {1}.",this._context.appId,bt.a[n]),pc.a.td()}this.Yc.FW(C,n,0);return this.Zbn(C,e,n)}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>
{const S=this.hb.NA(this.Tn,!0,!1);this.vB.find(S,e,n,C,this._context)})}_Search2(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.hb.NA(this.Tn,!0,!1);this.vB.Ipb(S,e,n,C,this._context)})}select(e){const n=this.hb.NA(this.Tn,!0,!1);this.Lq.select(n,e)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.Tn,"Body")}getTypeName(){return"Microsoft.WordServices.Body"}invokePropertyGet(e){switch(e){case 3:return this.contentControls;case 19:return this.endnotes;case 20:return this.fields;
case 5:return this.font;case 18:return this.footnotes;case 7:return this.inlinePictures;case 11:return this.lists;case 2:return this.paragraphs;case 10:return this.parentBody;case 16:return this.parentBodyOrNullObject;case 4:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 13:return this.parentSection;case 17:return this.parentSectionOrNullObject;case 6:return this.style;case 14:return this.styleBuiltIn;case 12:return this.tables;case 8:return this.text;case 9:return this.type;
case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 6:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 14:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1019:return this.HPb();case 1021:return this.YJa(n);case 1013:return this.YPb();case 1016:return this.ofa(n);case 1020:return this.MQb(n);case 1007:return this.RKa(n);case 1006:return this.Qsa(n);case 1017:return this.t$a(n);case 1003:return this.TKa(n);case 1015:return this.gha(n);case 1002:return this.jh();case 1001:return this.kh();case 1022:return this.$Qb()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){switch(e){case 1011:return this.fIa();case 1014:return this.xQb();case 1009:return this.j$a(n);case 1008:return this.Osa(n);case 1004:return this.m$a(n);case 1010:return this.n$a(n);case 1005:return this.r$a(n);case 1012:return this.Vua(n);case 1018:return this.moa(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}fIa(){return this.clear()}HPb(){return this.getComments()}YJa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,wo);return this.getContentControls(e)}YPb(){return this.getHtml()}xQb(){return this.getOoxml()}ofa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}MQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}$Qb(){return this.getTrackedChanges()}j$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");
return this.insertBreak(n,e)}RKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.insertContentControl(e)}Osa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(n,e)}m$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(n,
e)}n$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(n,e)}r$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(n,e)}Qsa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertParagraph(n,e)}t$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(n,C,S,e)}TKa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertText(n,e)}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}tsa(e){const n=Ed.a.eb(this.Tn);var C=null;switch(this.Tn.type){case 8:C=Lv.PIf(n,10,e);n.Yj(C);C=Lv.PIf(n,23,e);break;case 10:C=Lv.PIf(n,23,e);break;case 36:case 16:case 38:case 37:C=n.currentNode;break;default:E.ULS.sendTraceTag(16814430,369,10,"AppId:{0}, In function Body.GetLowestLayerOffSpringParagraphNode(). Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),pc.a.hg()}return this.Gzm(C,
e)}Gzm(e,n){let C=null;if(e&&(23===e.type||36===e.type||16===e.type||38===e.type||37===e.type)){e=Ed.a.eb(e);let S,ja;do if(S=e.currentNode,ja=n?e.zu(2)?e.Vb(2):e.je():e.zu(2)?e.xL(2):e.n7(),S&&ja&&11===S.type&&12===ja.type){C=ja;break}while(e.currentNode&&e.QA())}return C}Zbn(e,n,C){if(void 0===n||null===n)return null;var S=2===C?e.K(0):e.K(e.count-1);const ja=3!==C?!0:!1;n=pc.a.lyc(n);let ya=null;const kb=this.tsa(ja);if(kb){var Rb=null;switch(C){case 2:ya=n.pop();e=0;this.Yc.c9c(kb)&&(Rb=this.Yc.Y5d(kb),
-1!==Rb&&(e=Rb+2>this.hb.textLength(kb)?this.hb.textLength(kb):Rb+2));Rb=ce.a.Uc(kb,e);Rb.Fb=Rb.Tb=S.oo();this.yoa.We(Rb,ya);ya.length?(Rb=ce.a.createTextRange(kb,e,e+ya.length),this.Yc.Xv(Rb,2)):(Rb=ce.a.Uc(kb,0),Rb.Fb=Rb.Tb=S.oo());break;case 3:ya=n.shift();Rb=ce.a.Cx(kb);Rb.Fb=Rb.Tb=S.qo();this.yoa.We(Rb,ya);ya.length?(Rb=ce.a.createTextRange(kb,Af.ParagraphReader.textLength(kb)-ya.length,Af.ParagraphReader.textLength(kb)),this.Yc.Xv(Rb,2)):(Rb=ce.a.Cx(kb),Rb.Fb=Rb.Tb=S.qo());break;case 4:ya=n.pop(),
Rb=this.bcn(e,ya,kb)}S=this.Yc.qF(n,Rb.node,ja);2===C?(0<ya.length||!ya.length&&!n.length)&&S.add(Rb):3===C?(0<ya.length||!ya.length&&!n.length)&&S.insert(0,Rb):S.add(Rb);return this.nk.create(S,this._context)}return null}bcn(e,n,C){8===this.Tn.type&&1<Ed.a.eb(this.Tn).ar()&&(E.ULS.sendTraceTag(18667733,369,15,"AppId:{0}, Body.InsertText cannot replace the content of the document that contains multiple sections.",this._context.appId),pc.a.sC());C=C.ra;C&&C.length||(E.ULS.sendTraceTag(20030220,369,
15,"AppId:{0}, CharacterPropertiesArray is null or empty before replacing the body.",this._context.appId),pc.a.hg());C=C.first.Zqa(null);this.Yc.WLb(e);e=this.tsa(!0);var S=e.ra;S&&S.length||(E.ULS.sendTraceTag(20030221,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty after replacing the body.",this._context.appId),pc.a.hg());S.Ub(0).formatting=C.formatting.Of(S.Ub(0));C=0;this.Yc.c9c(e)&&(S=this.Yc.Y5d(e),-1!==S&&(pc.a.dDf()?C=S+2:(C=S+1,n=" "+n)));S=ce.a.Uc(e,C);const ja=this.hb.wm(e,
0);S.Fb=S.Tb=0<ja?ja/2:-1;this.yoa.We(S,n);e=n.length?ce.a.createTextRange(e,C,C+n.length):ce.a.Uc(e,C);e.Fb=S.oo();e.Tb=n.length?0<ja?0:-1:S.qo();return e}Nla(e,n,C){const S=(new Date).getTime();let ja=new fb.a;switch(n){case 2:case 3:const ya=this.tsa(2===n);ja.add(ce.a.create(ya));break;case 4:ja=this.hb.NA(this.Tn,!0,!1);break;default:E.ULS.sendTraceTag(18130833,369,15,"AppId:{0}, invalid insert location for body's insert Ooxml or insert Docx method",this._context.appId),pc.a.td()}this.Yc.QOa(ja.K(0),
ja.K(ja.count-1));return OfficeExtension.WacRuntime.Utility.createPromise((ya,kb)=>{this.px.insertOoxml(ja,e,n,this.Tn,this._context,ya,kb,S,C?0:1)})}static PIf(e,n,C){let S=null;if(e)if(C&&e.je()){do if(e.currentNode.type===n){S=e.currentNode;break}while(e.Tk());e.uc()}else if(!C&&e.n7()){do if(e.currentNode.type===n){S=e.currentNode;break}while(e.cP());e.uc()}return S}}Object(F.a)(Lv,"Body",Hh.a,[901]);class np{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg){this.Lxa=null;this.zo=
e;this.nk=n;this.zC=C;this.iO=S;this.fd=ja;this.yoa=ya;this.hb=kb;this.Lq=Rb;this.xB=sc;this.Yc=Fc;this.ay=gd;this.sh=td;this.vB=Bd;this.px=wd;this.Hl=te;this.ld=Le;this.Xn=Oe;this.Ot=We;this.wx=Xf;this.Xx=Gg}su(e){this.Lxa=e}create(e,n){return new Lv(e,n,this.zo,this.nk,this.zC,this.iO,this.Lxa,this.fd,this.yoa,this.hb,this.Lq,this.xB,this.Yc,this.ay,this.sh,this.vB,this.px,this.Hl,this.ld,this.Xn,this.Ot,this.wx,this.Xx)}}Object(F.a)(np,"BodyFactory",null,[1080]);var ef=d(944);class oB extends Hh.a{constructor(e){super();
this.Ze=e}get isChecked(){return this.Ze.isChecked}set isChecked(e){this.Ze.isChecked!==e&&(this.Ze.isChecked=e,ef.a.fCa(this.Ze.objectId))}getTypeName(){return"Microsoft.WordServices.CheckboxContentControl"}invokePropertyGet(e){switch(e){case 1:return this.isChecked}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 1:this.isChecked=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(oB,
"CheckboxContentControl",Hh.a,[901]);class lv{create(e){return new oB(e)}}Object(F.a)(lv,"CheckboxContentControlFactory",null,[1080]);var os=d(898);class CE extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb){super();pc.a.gBc(e,"CommentContentRange");this.Ld=e;this.lW=n;this.Yc=C;this.s1a=S;this.Yoa=ja;this.Hl=ya;this.Ot=kb;this.Nq=Rb}get bold(){const e=this.v_();return e.TTc?null:1===e.bold}set bold(e){pc.a.Tx(e,"Font.Bold");this.Nq.wt(this.nka().currentNode)?e!=this.bold&&(e=e?new os.a(1):new os.a(0),
this.Yoa.ODa(this.Ld,pe.a.bold,e),this.kMb()):pc.a.aAb()}get hyperlink(){const e=this.Hl.Qqb(this.Ld).returnValue;return e&&e.length?e[0].hyperlink.url:null}set hyperlink(e){this.Nq.wt(this.nka().currentNode)?(this.Hl.cOj(this.Ld,e,!1,this.lW),this.kMb()):pc.a.aAb()}get italic(){const e=this.v_();return e.vpc?null:1===e.italic}set italic(e){pc.a.Tx(e,"Font.Italic");this.Nq.wt(this.nka().currentNode)?e!=this.italic&&(e=e?new os.a(1):new os.a(0),this.Yoa.ODa(this.Ld,pe.a.fA,e),this.kMb()):pc.a.aAb()}get isEmpty(){return this.text===
pc.a.kqc}get text(){return this.Hl.cEi(this.Ld,this.lW)}get strikeThrough(){const e=this.v_();return e.yyc?null:1===e.strikethrough}set strikeThrough(e){pc.a.Tx(e,"Font.StrikeThrough");this.Nq.wt(this.nka().currentNode)?e!=this.strikeThrough&&(e=e?new os.a(1):new os.a(0),this.Yoa.ODa(this.Ld,pe.a.strikethrough,e),this.kMb()):pc.a.aAb()}get underline(){const e=this.v_();return e.xV?-1:[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0][e.underlineType]}set underline(e){this.Nq.wt(this.nka().currentNode)?
e!==this.underline&&(0===e?(this.Yoa.ODa(this.Ld,pe.a.sha,17),this.kMb()):1===e?(this.Yoa.ODa(this.Ld,pe.a.sha,0),this.kMb()):pc.a.td()):pc.a.aAb()}get _ReferenceId(){return this.Hp?this.Vp:null}_KeepReference(){return this.xp()}_OnAccess(){pc.a.gBc(this.Ld,"CommentContentRange");for(const e of this.Ld)pc.a.Q0(e.node,"CommentContentRange")}insertText(e,n){if(this.Nq.wt(this.nka().currentNode)){var C=new Ed.a;C.set(this.Ld.K(0).node);C.zb(40);C.kd(40);e=1<pc.a.lyc(e).length?this.Yc.Zan(this.Ld,e,n):
this.Yc.insertText(this.Ld,e,n);n=e.count;var S=e.K(n-1);S.contextId===Ma.a.paragraph&&(S=ce.a.createTextRange(S.node,0,Af.ParagraphReader.textLength(S.node)),e.removeAt(n-1),e.add(S));e.K(0).contextId===Ma.a.Zc&&e.removeAt(0);e=this.s1a.create(e,this.lW);({startIndex:n,endIndex:S}=e.Cyi(C));this.kMb();e.AQh(C,n,S);return e}pc.a.aAb()}getTypeName(){return"Microsoft.WordServices.CommentContentRange"}invokePropertyGet(e){switch(e){case 1:return this._ReferenceId;case 3:return this.isEmpty;case 4:return this.hyperlink;
case 2:return this.text;case 5:return this.bold;case 6:return this.italic;case 7:return this.strikeThrough;case 8:return this.underline}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 4:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 5:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 6:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 7:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 8:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
n){switch(e){case 1001:return this.jh();case 1002:return this.kh();case 1003:return this.TKa(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}TKa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertText(n,e)}v_(){const e=this.Yoa.v_(this.Ld);e||pc.a.hg();return e}Cyi(e){let n=-1,C=-1;const S=e.ar();if(0<S){e.je();for(let ja=0;ja<S;ja++)e.je(),e.currentNode.id==this.Ld.K(0).node.id&&(n=ja),e.currentNode.id==this.Ld.K(this.Ld.count-1).node.id&&(C=ja),e.uc(),e.Tk()}e.zb(40);e.kd(40);return{startIndex:n,endIndex:C}}AQh(e,n,C){const S=new fb.a;if(0<e.ar()){e.je();for(let ya=0,kb=0;ya<C+1;ya++,kb++){e.je();if(ya>=n&&ya<C+1){var ja=this.Ld.K(kb-n);if(ja.contextId===Ma.a.Zc){ya--;
ja=S.K(S.count-1).node;S.add(ce.a.Wl(ja));continue}else ja.contextId===Ma.a.Cd?S.add(ce.a.createTextRange(e.currentNode,ja.zj,ja.Po)):ja.contextId===Ma.a.paragraph&&S.add(ce.a.create(e.currentNode))}e.uc();e.Tk()}e.zb(40);e.kd(40);this.Ld=S}}kMb(){const e=this.nka();let n=-1,C=-1;({startIndex:n,endIndex:C}=this.Cyi(e));this.Ot.lxl(e.currentNode);this.AQh(e,n,C)}Xo(){return this.Ld}nka(){const e=new Ed.a;e.set(this.Ld.K(0).node);e.zb(40);e.kd(40);return e}}Object(F.a)(CE,"CommentContentRange",Hh.a,
[901]);class Uz{constructor(e,n,C,S){this.Yc=e;this.Yoa=n;this.Hl=C;this.Nq=S}su(e){this.Ot=e}create(e,n){return new CE(e,n,this.Yc,this,this.Yoa,this.Hl,this.Ot,this.Nq)}}Object(F.a)(Uz,"CommentContentRangeFactory",null,[1080]);class Br extends Hh.a{constructor(e){super();pc.a.Tx(e,"CommentReplyCollection");this.e5b=e}length(){return this.e5b.count}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.e5b.K(e);pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=
this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){return this.e5b&&0<this.e5b.count?this.e5b.K(0):null}getItem(e){e=pc.a.QN(e);return e<this.length()?this.e5b.K(e):null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.CommentReplyCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.y_(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Br,"CommentReplyCollection",Hh.a,[901,931]);class pi extends Hh.a{constructor(e,n,C,S,ja,ya,kb){super();pc.a.Tx(e,"Comment GraphNodeContext");
this.hda=e;this.lW=n;this.Ot=C;this.nk=S;this.Zxd=ja;this.s1a=ya;this.hb=kb}get authorEmail(){return this.Ot.gvi(this.hda)}get authorName(){return this.hda.getValue(hb.a.F6a)}get content(){return this.Ot.hvi(this.hda)}set content(e){this.Ot.Gxg(e,this.hda,!0)}get contentRange(){const e=Ed.a.eb(this.hda),n=e.ar(),C=new fb.a;if(0<n){e.je();for(let S=0;S<n;S++)e.je(),S===n-1?C.add(ce.a.createTextRange(e.currentNode,0,this.hb.textLength(e.currentNode))):C.add(ce.a.create(e.currentNode)),e.uc(),e.Tk()}return this.s1a.create(C,
this.lW)}set contentRange(e){this.Ot.VMj(e,this.hda)}get creationDate(){return this.hda.getValue(hb.a.nIa)}get id(){return this.hda.getValue(hb.a.ZG)}get _ReferenceId(){return this.Hp?this.Vp:null}get replies(){var e=this.Ot.Lmm(this.hda);const n=new fb.a;for(const C of e)e=this.Zxd.create(C,this.lW),n.add(e);return new Br(n)}get resolved(){return this.hda.ka(hb.a.Bea,!1)}set resolved(e){this.Ot.MHo(this.hda,e)}reply(e){if(this.resolved)pc.a.sC();else return e=this.Ot.mZk(this.hda,e),this.Zxd.create(e,
this.lW)}deleteObject(){this.Ot.deleteComment(this.hda)}getRange(){const e=this.Ot.qAa(this.hda),n=new fb.a;for(let C=0;C<e.length;C++){const S=e.K(C);n.add(S)}return this.nk.create(n,this.lW)}_KeepReference(){return this.xp()}_OnAccess(){pc.a.Q0(this.hda,"Comment")}getTypeName(){return"Microsoft.WordServices.Comment"}invokePropertyGet(e){switch(e){case 1:return this.authorEmail;case 2:return this.authorName;case 3:return this.content;case 9:return this.contentRange;case 4:return this.creationDate;
case 7:return this.replies;case 8:return this.resolved;case 5:return this.id;case 6:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 8:this.resolved=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 9:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,CE);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1001:return this.ofa(n);case 1002:return this.lFo(n);case 1003:return this.VC(n);case 1005:return this.jh();case 1004:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ofa(){return this.getRange()}lFo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.reply(e)}VC(){this.deleteObject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(pi,"Comment",Hh.a,[901]);class Xm{constructor(e,n,C){this.Ot=this.nk=null;this.Zxd=e;this.s1a=n;this.hb=C}su(e,n){this.nk=e;this.Ot=
n}create(e,n){return new pi(e,n,this.Ot,this.nk,this.Zxd,this.s1a,this.hb)}}Object(F.a)(Xm,"CommentFactory",null,[1080]);var Sn=d(1862),Zk=d(1582);class mv extends Hh.a{constructor(e){super();pc.a.Tx(e,"CommentCollection");this.qh=e}length(){return this.qh.count}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.qh.K(e);pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){return this.qh&&
0<this.qh.count?this.qh.K(0):null}getItem(e){e=pc.a.QN(e);return e<this.length()?this.qh.K(e):null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.CommentCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.y_(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}y_(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(mv,"CommentCollection",Hh.a,[901,931]);var Gm=d(1414);class zJ{constructor(e,n,C,S,ja,ya,kb,Rb){this.pQa=null;this.Nq=e;n.execute(sc=>{this.pQa=sc});this.t1a=C;this.vmk=S;this.ib=ja;this.hb=ya;this.Hl=kb;this.c5b=Rb}insertComment(e,n,C){this.Nq.Wsb(this.vmk,!1)||pc.a.sC();var S=new Lf.Selection(e.toArray(),!0);e&&0<=e.count&&
e.K(0)&&e.K(0).contextId==Ma.a.Vc&&this.ib.u3j(S);if(this.hb.Wb(e.K(0).node)&&this.hb.Wb(e.K(e.count-1).node)){e=this.ib.gb.currentSelection;this.ib.Kc(S);S=Sn.a.ufc(null);const ja=new Zk.a;ja.Ola(n+"\n");S.text=[ja.xjc()];this.pQa.tqa(S,null);this.pQa.eza(S);n=Wc.a.Bf(S.objectId);n=this.Nq.ud.Eb(n);this.ib.Kc(e);return this.t1a.create(n,C)}pc.a.td();return null}hvi(e){e=Ed.a.eb(e);e=this.Nq.GPb(e);return this.ZFm(e[0])}Gxg(e,n,C){this.Nq.wt(n)?(n=this.Nq.G2(n.id.toString()),this.Nq.MZc(n,null),this.Nq.MZc(n,
null),C?(C=new Zk.a,C.Ola(e+"\n"),n.text=[C.xjc()]):n.text=[e],this.Nq.Dnb(n)):pc.a.aAb()}deleteComment(e){this.pQa.deleteComment(this.Nq.G2(e.id.toString()))}mZk(e,n){e=this.Nq.R8h(this.Nq.G2(e.id.toString()).id,null);const C=new Zk.a;C.Ola(n+"\n");e.text=[C.xjc()];this.pQa.eza(e);n=Wc.a.Bf(e.objectId);return this.Nq.ud.Eb(n)}b5d(e,n){var C=this.Pmm(e);e=new fb.a;for(const S of C)C=this.t1a.create(S,n),e.add(C);return new mv(e)}qAa(e){return this.Nq.LMf(e.id)}Lmm(e){var n=this.qAa(e),C=G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8213734_FixCommentReplyBug")?
n.Qa.zj:n.Qa.cpBegin;n=n.Qa.node.ra.Dh(C);C=new fb.a;e=e.getValue(hb.a.GJ);if(n.Ue&&0<n.Ue.length)for(let S=0;S<n.Ue.length;S++)if(n.Ue.K(S).Wc){const ja=n.Ue.K(S).FPb();e===ja.ka(hb.a.HO,null)&&C.add(ja)}return C}Kmm(e){return this.Nq.EF(e).objectId}gvi(e){e=e.ka(hb.a.XVc,"");return!Of.a.Qf(e)&&(e=e.split("::"),!Nj.a.Qf(e)&&2<=e.length)?e[1]:null}Pmm(e){const n=new fb.a,C=e.count;for(let ya=0;ya<C;ya++){var S=e.K(ya);if(S.contextId===Ma.a.Zc)continue;const kb=-1===S.cpEnd?S.Po:S.cpEnd;S=S.node.ra;
for(let Rb=0;Rb<S.length;Rb++){if(0>S.Ub(Rb).cp)continue;if(S.Ub(Rb).cp>kb)break;const sc=S.Ub(Rb);if(sc.Ue&&0<sc.Ue.length)for(let Fc=0;Fc<sc.Ue.length;Fc++){const gd=sc.Ue.K(Fc).FPb();var ja=this.qAa(gd);Of.a.Qf(gd.ka(hb.a.HO,null))&&!n.contains(gd)&&(ja=this.Hl.d5h(e.K(0),e.K(C-1),ja.K(0),ja.K(ja.length-1)),10!=ja&&13!=ja&&0!=ja&&11!=ja&&8!=ja&&n.add(gd))}}}return n}ZFm(e){if(""==e)return"";let n="";e=Zk.a.Jqb(e);for(let C=0;C<e.ops.length-1;C++){const S=e.ops[C];null!=S.attributes&&null!=S.attributes.atmention?
(n+="@",n+=S.attributes.atmention.fullName):n+=S.insert?S.insert:"\n"}return n}fhm(e){const n=new fb.a;for(const S of this.Nq.Fgf)if(!S.Rf&&!Of.a.Qf(S.objectId)){var C=Wc.a.Bf(S.objectId);C=this.Nq.ud.Eb(C);C=this.t1a.create(C,e);n.add(C)}return new mv(n)}Bmm(e,n){const C=new fb.a;for(const ja of this.Nq.Fgf)if(!ja.Rf&&!Of.a.Qf(ja.objectId)){var S=Wc.a.Bf(ja.objectId);S=this.Nq.ud.Eb(S);if(this.KVi(e,S,!0)||this.KVi(e,S,!1))S=this.t1a.create(S,n),C.contains(S)||C.add(S)}return new mv(C)}MHo(e,n){this.pQa.PLb(this.Nq.G2(e.id.toString()),
n)}KVi(e,n,C){n=this.Nq.ud.Eb(C?Gm.k(n):Gm.h(n));n=Ed.a.eb(n);return n.zb(10)&&(n.kd(10),n.Aq.equals(e))?!0:!1}lxl(e){const n=this.Nq.G2(e.id.toString());this.Nq.MZc(n,null);e=Ed.a.eb(e);e=this.Nq.GPb(e);n.text=e;this.Nq.Dnb(n)}VMj(e,n){this.Nq.wt(n)||pc.a.aAb();const C=e.Xo().count,S=Array(C);for(let ja=0;ja<C;ja++){const ya=e.Xo().K(ja).node;ya.TSb=!0;S[ja]=ya}e=this.c5b.qHg(S)[0];this.Gxg(e,n,!1)}}Object(F.a)(zJ,"CommentOperations",null,[1201]);class Vz extends Hh.a{constructor(e,n,C,S,ja,ya){super();
pc.a.Tx(e,"CommentReply GraphNodeContext");this.nFa=e;this.lW=n;this.Ot=C;this.Pi=S;this.t1a=ja;this.s1a=ya}get authorEmail(){return this.Ot.gvi(this.nFa)}get authorName(){return this.nFa.getValue(hb.a.F6a)}get content(){return this.Ot.hvi(this.nFa)}set content(e){this.Ot.Gxg(e,this.nFa,!0)}get contentRange(){const e=Ed.a.eb(this.nFa),n=e.ar(),C=new fb.a;if(0<n){e.je();for(let S=0;S<n;S++)e.je(),C.add(ce.a.create(e.currentNode)),e.uc(),e.Tk()}return this.s1a.create(C,this.lW)}set contentRange(e){this.Ot.VMj(e,
this.nFa)}get creationDate(){return this.nFa.getValue(hb.a.nIa)}get id(){return this.nFa.getValue(hb.a.ZG)}get _ReferenceId(){return this.Hp?this.Vp:null}get parentComment(){var e=this.nFa.ka(hb.a.HO,null);return Of.a.Qf(e)?null:(e=this.Pi.value.Eb(Wc.a.Bf(this.Ot.Kmm(e))),this.t1a.create(e,this.lW))}deleteObject(){this.Ot.deleteComment(this.nFa)}_KeepReference(){return this.xp()}_OnAccess(){pc.a.Q0(this.nFa,"CommentReply")}getTypeName(){return"Microsoft.WordServices.CommentReply"}invokePropertyGet(e){switch(e){case 1:return this.authorEmail;
case 2:return this.authorName;case 3:return this.content;case 4:return this.creationDate;case 5:return this.id;case 6:return this._ReferenceId;case 7:return this.parentComment;case 8:return this.contentRange}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 8:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,CE);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1002:return this.VC(n);case 1001:return this.jh();case 1003:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,
n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Vz,"CommentReply",Hh.a,[901]);class Qr{constructor(e){this.t1a=this.Ot=null;this.Pi=e}su(e,n,C){this.t1a=e;this.Ot=n;this.s1a=C}create(e,n){return new Vz(e,n,this.Ot,this.Pi,this.t1a,this.s1a)}}Object(F.a)(Qr,"CommentReplyFactory",null,[1080]);var Dw=d(334);class gx extends Hh.a{constructor(e){super();
pc.a.Tx(e,"RangeCollection");this.Rda=e}length(){return this.Rda.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){pc.a.ej()||pc.a.Kj();return this.Rda&&this.Rda.count?this.Rda.K(0):null}_GetItem(e){e=pc.a.QN(e);if(e<this.length())return this.Rda.K(e);E.ULS.sendTraceTag(18745302,369,10,"The index is out of the boundary of range list.");pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.RangeCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(gx,"RangeCollection",Hh.a,[901,931]);class LG extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih){super();pc.a.Tx(e,"wacContentControl");this.Ze=e;this._context=n;this.fq=C;this.f5=S;this.zo=ja;this.nk=ya;this.zC=kb;this.iO=Rb;this.Lq=sc;this.xB=Fc;this.Yc=gd;this.sh=td;this.ay=Bd;this.vB=
wd;this.px=te;this.Hl=Le;this.Xn=Oe;this.ld=We;this.hb=Xf;this.Ot=Gg;this.wx=Ph;this.Xx=Aj;this.ZLe=Ih}get appearance(){return this.Ze.appearance}set appearance(e){this.enb("ContentControl.Appearance");this.Ze.appearance=e;ef.a.fCa(this.Ze.objectId)}get cannotDelete(){return!this.Ze.Tla}set cannotDelete(e){this.enb("ContentControl.CannotDelete");e&&this.removeWhenEdited&&pc.a.td();this.Ze.Tla=!e;ef.a.fCa(this.Ze.objectId)}get cannotEdit(){return!this.Ze.isEditable}set cannotEdit(e){this.enb("ContentControl.CannotEdit");
this.Ze.isEditable=!e;ef.a.fCa(this.Ze.objectId)}get checkboxContentControl(){if(!pc.a.dia||8!==this.Ze.type)return null;this.Iah||(this.Iah=this.ZLe.create(this.Ze));return this.Iah}get color(){return null==this.Ze.color?"#000000":Yk.a.JB(this.Ze.color).toUpperCase()}set color(e){this.enb("ContentControl.Color");e=pc.a.$Oa(e,"ContentControl.Color",this._context);e=parseInt(e,16);isNaN(e)?pc.a.td():(this.Ze.color=e,ef.a.fCa(this.Ze.objectId))}get endnotes(){var e=this.Ze.DF();e=this.Yc.f6d(e,1);e=
this.Yc.sza(e,this._context);return new Qu(e)}get fields(){return this.Ze.HL?new Wt(new fb.a):new Wt(this.Xx.nsm(this.Ze,this._context))}get contentControls(){const e=new wo;e.types=[31];return this.getContentControls(e)}get font(){null==this._font&&(this._font=this.zC.create(1,null,this.Ze,null,this._context));G.AFrameworkApplication.dv&&this._font._OnAccess();return this._font}get footnotes(){var e=this.Ze.DF();e=this.Yc.f6d(e,0);e=this.Yc.sza(e,this._context);return new Qu(e)}get id(){return this.Ze.id}get inlinePictures(){const e=
this.Ze.DF(),n=new fb.a;for(const C of e)this.VGl(n,C);return new Hs(n)}get lists(){return pc.a.ej()?new Tz(1,null,this.Ze,null,this._context,this.Xn,null):null}get paragraphs(){const e=this.Ze.DF();let n=0;const C=new fb.a;for(const S of e)C.add(this.zo.create(S.node,this._context,n++));return new jv(C)}get parentBody(){if(!pc.a.ej())return null;const e=this.Ze.DF();return this.ld.CLf(e.K(0).node,e.K(e.count-1).node,this._context)}get parentContentControl(){const e=this.parentContentControlOrNullObject;
e||pc.a.Wk();return e}get parentContentControlOrNullObject(){var e;for(e=this.Ze.parentId;(e=this.fq.getById(e))&&!this.sh.L8c(e);)e=e.parentId;return e?this.f5.create(e,this._context):null}get parentTable(){if(!pc.a.ej())return null;const e=this.parentTableOrNullObject;e||pc.a.Wk();return e}get parentTableCell(){if(!pc.a.ej())return null;const e=this.parentTableCellOrNullObject;e||pc.a.Wk();return e}get parentTableCellOrNullObject(){return pc.a.ej()?this.ld.vkc(this.Ze.start.node,this._context,this.Ze.end.node):
null}get parentTableOrNullObject(){return pc.a.ej()?this.ld.drb(this.Ze.start.node,this._context,this.Ze.end.node):null}get placeholderText(){let e=this.Ze.placeholderText;e||(e=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);return e}set placeholderText(e){Dw.a.aga?(e=pc.a.OWc(e),this.Ze.HL&&(this.insertText(e,4),this.Ze.HL=!0),this.Ze.placeholderText=e):(E.ULS.sendTraceTag(20833952,369,15,"AppId:{0}, set placeholder text for contentcontrol on wac is not allowed.",this._context.appId),
pc.a.sC())}get removeWhenEdited(){return this.Ze.removeWhenEdited}set removeWhenEdited(e){this.enb("ContentControl.RemoveWhenEdited");e&&this.cannotDelete&&pc.a.td();this.Ze.removeWhenEdited=e;ef.a.fCa(this.Ze.objectId)}get style(){const e=this.Ze.DF();return this.xB.c3c(e)}set style(e){this.enb("ContentControl.Style");const n=this.Ze.DF();this.xB.Qwc(n,e);ef.a.fCa(this.Ze.objectId)}get styleBuiltIn(){if(!pc.a.ej())return-1;const e=this.Ze.DF();return this.xB.h6d(e)}set styleBuiltIn(e){pc.a.ej()||
pc.a.Kj();const n=this.Ze.DF();this.xB.Ywe(n,e);ef.a.fCa(this.Ze.objectId)}get zg(){return this.Ze.zg}get JFg(){if(!this.Ze.type){const e=Ed.a.eb(this.Ze.start.node);if(e.zb(14))return e.kd(14)}}get qXj(){if(!this.Ze.type)return this.Ze.start?this.Ze.start.node:void 0}get subtype(){return pc.a.ej()?this.IMm():0}get tables(){return pc.a.ej()?new nB(1,null,null,this.Ze,this._context,this.ld):null}get tag(){return this.Ze.tag}set tag(e){this.enb("ContentControl.Tag");pc.a.Tx(e,"Tag");this.Ze.tag=e;ef.a.fCa(this.Ze.objectId)}get text(){return this.Ze.HL?
"":this.Ze.getText()}getReviewedText(e){return this.Ze.HL?"":this.wx.NIm(this.Ze,e)}get title(){return this.Ze.title}set title(e){this.enb("ContentControl.Title");pc.a.Tx(e,"Title");this.Ze.title=e;ef.a.fCa(this.Ze.objectId)}get type(){switch(this.Ze.type){case 1:return 96;case 8:return pc.a.dia?512:31;default:return 31}}get _ReferenceId(){return this.Hp?this.Vp:null}clear(){pc.a.iud()?this.Psl():this.Osl()}deleteContentControl(e){pc.a.iud()?this.zQl(e):this.yQl(e)}getComments(){return this.Ot.b5d(this.Ze.DF(),
this._context)}getContentControls(e){var n;e=null!==(n=null===e||void 0===e?void 0:e.types)&&void 0!==n?n:[];pc.a.q_c(e);n=this.fq.ZO(this.Ze.start,this.Ze.end,1);for(var C of n)if(C.id===this.Ze.id){n.remove(C);break}C=this.sh.rNf(n,this._context);return 0===e.length?C:null===C||void 0===C?void 0:C.getByTypes(e)}getHtml(){const e=this.Ze.DF();return this.px.getHtml(e.toArray(),this._context)}getOoxml(){const e=(new Date).getTime();this._context.Cn.CF();const n=this.Ze.DF();return OfficeExtension.WacRuntime.Utility.createPromise((C,
S)=>{this.px.getOoxml(n,this._context,C,S,e)})}getRange(e){pc.a.ej()||pc.a.Kj();1!==e&&2!==e&&e&&5!==e&&4!==e&&3!==e&&(E.ULS.sendTraceTag(18745292,369,15,"AppId:{0}, rangeLocation of ContentControl.GetRange must be Start/End/Whole/Content/Before/After.",this._context.appId),pc.a.td());var n=e;3===e&&(n=1);var C=this.Ze.DF(),S=C.K(0),ja=C.K(C.count-1);if(ja.contextId===Ma.a.paragraph&&4===e){var ya=(ya=this.hb.textLength(ja.node))?ce.a.createTextRange(ja.node,0,ya):ce.a.Cx(ja.node);C.removeAt(C.count-
1);C.add(ya);this.Hl.Mwc(S,ja,C,!1)}n=this.Hl.DPb(C,n);C&&n&&0<C.count&&0<n.count&&(S=C.K(0),C=C.K(C.count-1),ja=n.K(0),ya=n.K(n.count-1),1===e?ja.Fb=ya.Tb=S.Fb+1:2===e?ja.Fb=ya.Tb=C.Tb-1:5===e&&(ja.Fb=S.Fb+1,ya.Tb=C.Tb-1));return this.nk.create(n,this._context)}getTextRanges(e,n){pc.a.ej()||pc.a.Kj();var C=this.Ze.DF();e=this.Hl.QNf(C,e,n);n=new fb.a;for(C=0;C<e.length;C++)n.add(this.nk.create(e[C],this._context,C));return new gx(n)}getTrackedChanges(){return new kv(1,null,null,this.Ze,this._context,
this.wx,this.hb,this.Hl)}insertBreak(e,n){const C=(new Date).getTime();2!==n&&3!==n&&n&&1!==n&&(E.ULS.sendTraceTag(19158349,369,15,"AppId:{0}, invalid insert location for ContentControl.InsertBreak.",this._context.appId),pc.a.td());pc.a.dia?this.qOb(n):this.opb(n);let S=!1;if(6===e||(pc.a.gGe()||this.Ze.zg)&&!e)S=this.vnc(n);const ja=new fb.a;ja.add(this.SPb(n));S&&this.sh.tJa();return OfficeExtension.WacRuntime.Utility.createPromise((ya,kb)=>{this.Yc.insertBreak(ja,e,n,this._context,ya,kb,C)})}insertFileFromBase64(e,
n){"<"===e.charAt(0)&&(E.ULS.sendTraceTag(18130834,369,10,"invalid argument for insertFileFromBase64 API in ContentControl class.",this._context.appId),pc.a.td());this.Ze.isEditable||pc.a.Gzc(this._context.appId,"ContentControl.InsertFileFromBase64",void 0,bt.a[n]);pc.a.dia?this.qOb(n):this.opb(n);return this.Nla(e,n,!1)}insertHtml(e,n){pc.a.dia?this.qOb(n):this.opb(n);return pc.a.iud()?this.Dan(e,n):this.Can(e,n)}insertInlinePictureFromBase64(e,n){pc.a.dia?this.qOb(n):this.opb(n);return this.L7c(e,
n)}insertOoxml(e,n){"<"!==e.charAt(0)&&(E.ULS.sendTraceTag(18130835,369,10,"invalid argument for InsertOoxml API in ContentControl class.",this._context.appId),pc.a.td());pc.a.dia?this.qOb(n):this.opb(n);return this.Nla(e,n,!0)}insertParagraph(e,n){2!==n&&3!==n&&n&&1!==n&&(E.ULS.sendTraceTag(21070048,369,15,"AppId:{0}, Invalid insert location for ContentControl.InsertPparagraph method.",this._context.appId),pc.a.td());pc.a.gGe()||2!==n&&3!==n||this.Ze.zg||pc.a.Gzc(this._context.appId,"ContentControl.InsertParagraph",
void 0,bt.a[n]);pc.a.dia?this.qOb(n):this.opb(n);const C=this.vnc(n),S=new fb.a;S.add(this.SPb(n));2===n?n=0:3===n&&(n=1);C&&this.sh.tJa();return this.zo.create(this.Yc.insertParagraph(S,e,n),this._context)}insertTable(e,n,C,S){pc.a.ej()||pc.a.Kj();2!==C&&3!==C&&C&&1!==C&&(E.ULS.sendTraceTag(20971524,369,15,"Invalid argument for InsertTable API in ContentControl class.",this._context.appId),pc.a.td());pc.a.gGe()||2!==C&&3!==C||this.Ze.zg||pc.a.Gzc(this._context.appId,"ContentControl.InsertParagraph",
void 0,bt.a[C]);pc.a.dia?this.qOb(C):this.opb(C);const ja=this.vnc(C),ya=new fb.a;ya.add(this.SPb(C));2===C?C=0:3===C&&(C=1);ja&&this.sh.tJa();return this.ld.insertTable(ya,e,n,C,S,this._context)}insertText(e,n){2!==n&&3!==n&&4!==n&&(E.ULS.sendTraceTag(21284488,369,15,"AppId:{0}, invalid location for ContentControl.InsertText: {1}.",this._context.appId,bt.a[n]),pc.a.td());pc.a.dia&&this.bki(n);var C=pc.a.lyc(e);!pc.a.gGe()&&1<C.length&&!this.Ze.zg&&pc.a.Gzc(this._context.appId,"ContentControl.InsertText",
"Attempt to insert multi-line text into an inline content control",bt.a[n]);if(this.Ze.HL&&1===C.length&&""===C[0])return this.nk.create(this.Ljc(),this._context);if(!pc.a.iud()&&(this.Ze.HL||4===n))return this.Ze.Rxe(e)&&pc.a.hg(),this.nk.create(this.Ljc(),this._context);C=this.vnc(n);let S=new fb.a;switch(n){case 2:case 3:S.add(this.SPb(n));break;case 4:S=this.Ljc()}C&&this.sh.tJa();return this.nk.create(this.Yc.insertText(S,e,n),this._context)}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>
{const S=this.Ze.DF();this.vB.find(S,e,n,C,this._context)})}_Search2(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.Ze.DF();this.vB.Ipb(S,e,n,C,this._context)})}select(e){switch(e){case 0:this.sh.select(this.Ze);break;case 1:case 2:if(this.Ze.HL)this.sh.select(this.Ze);else{const n=1===e?this.Ze.start:this.Ze.end;let C;this.Lq.select((C=new fb.a,C.add(n),C),e)}}}split(e,n,C,S){pc.a.ej()||pc.a.Kj();const ja=this.Ze.DF();if(ja&&0<ja.count){let ya;(ya=ja.K(0)).Fb=ya.Fb+
1;let kb;(kb=ja.K(ja.count-1)).Tb=kb.Tb-1}e=this.Hl.kyc(ja,e,n,C,S);n=new fb.a;for(C=0;C<e.length;C++)n.add(this.nk.create(e[C],this._context,C));return new gx(n)}_KeepReference(){this.xp()}_OnAccess(){this.Ze.isValid()||(E.ULS.sendTraceTag(17155413,369,15,"AppId:{0}, Should not access invalid contentcontrol object.",this._context.appId),pc.a.hg())}getTypeName(){return"Microsoft.WordServices.ContentControl"}invokePropertyGet(e){switch(e){case 7:return this.appearance;case 10:return this.cannotDelete;
case 11:return this.cannotEdit;case 32:return this.checkboxContentControl;case 8:return this.color;case 15:return this.contentControls;case 30:return this.endnotes;case 31:return this.fields;case 12:return this.font;case 29:return this.footnotes;case 1:return this.id;case 17:return this.inlinePictures;case 19:return this.lists;case 14:return this.paragraphs;case 25:return this.parentBody;case 16:return this.parentContentControl;case 26:return this.parentContentControlOrNullObject;case 22:return this.parentTable;
case 21:return this.parentTableCell;case 27:return this.parentTableCellOrNullObject;case 28:return this.parentTableOrNullObject;case 5:return this.placeholderText;case 9:return this.removeWhenEdited;case 13:return this.style;case 24:return this.styleBuiltIn;case 23:return this.subtype;case 20:return this.tables;case 4:return this.tag;case 18:return this.text;case 3:return this.title;case 6:return this.type;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 7:this.appearance=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 10:this.cannotDelete=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 11:this.cannotEdit=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 8:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 5:this.placeholderText=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 9:this.removeWhenEdited=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 13:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 24:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 4:this.tag=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1010:return this.fIa();case 1011:return this.VC(n);case 1021:return this.HPb();case 1023:return this.YJa(n);case 1013:return this.YPb();case 1016:return this.ofa(n);
case 1019:return this.E4c(n);case 1024:return this.$Qb();case 1007:return this.Qsa(n);case 1018:return this.t$a(n);case 1003:return this.TKa(n);case 1012:return this.gha(n);case 1017:return this.L0b(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1014:return this.xQb();case 1008:return this.j$a(n);case 1006:return this.Osa(n);case 1004:return this.m$a(n);case 1009:return this.n$a(n);
case 1005:return this.r$a(n);case 1015:return this.Vua(n);case 1020:return this.moa(n);case 1022:return this.MQb(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}fIa(){this.clear();return null}VC(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");this.deleteContentControl(e);return null}HPb(){return this.getComments()}YJa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,wo);return this.getContentControls(e)}YPb(){return this.getHtml()}xQb(){return this.getOoxml()}ofa(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}E4c(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getTextRanges(n,e)}$Qb(){return this.getTrackedChanges()}MQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}j$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(n,e)}Osa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(n,e)}m$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(n,e)}n$a(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(n,e)}r$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(n,e)}Qsa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertParagraph(n,e)}t$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(n,C,S,e)}TKa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertText(n,e)}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}L0b(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"boolean");return this.split(n,C,S,e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}isValid(){return this.Ze.isValid()}VGl(e,n){const C=new fb.a;this.ay.B6d(C,n);if(!(0>=C.count))for(const S of C)e.add(this.iO.create(S,
this._context))}Nla(e,n,C){const S=(new Date).getTime();if(2===n||3===n||4===n){const ja=this.Ze.DF();return OfficeExtension.WacRuntime.Utility.createPromise((ya,kb)=>{const Rb=C?0:1;this.px.insertOoxml(ja,e,n,ja.K(0).node,this._context,ya,kb,S,Rb,this.Ze.id)})}E.ULS.sendTraceTag(18130836,369,15,"AppId:{0}, ContentControl.InsertOoxmlOrDocx: undefined location!",this._context.appId);pc.a.td();return null}enb(e){this.Ze.isSupported||(E.ULS.sendTraceTag(19417247,369,15,"AppId:{0}, {1}: currently is not supported as the contentcontrol is no-supported on WAC!",
this._context.appId,e),pc.a.sC())}SPb(e){var n=null;switch(e){case 0:case 2:var C=this.Ze.start;n=this.Ze.zg?0:C.cpBegin;n=ce.a.Uc(C.node,n);n.Fb=e?n.Tb=C.oo():n.Tb=C.oo()-1;break;case 1:case 3:C=this.Ze.end,n=this.Ze.zg?C.node.characterData.length:C.cpEnd,n=ce.a.Uc(C.node,n),n.Fb=1===e?n.Tb=C.qo()+1:n.Tb=C.qo()}return n}Ljc(){if(pc.a.mIp()&&!this.Ze.zg&&!this.Ze.start)return new fb.a;const e=this.Ze.DF();let n;(n=e.K(0)).Fb=n.Fb+1;let C;(C=e.K(e.count-1)).Tb=C.Tb-1;return e}vnc(e){let n=!1;!this.Ze.HL||
2!==e&&3!==e&&4!==e||(n=!0,this.sh.KNb(),this.clear(),this.Ze.HL=!1);return n}Can(e,n){pc.a.hBc(e,"ContentControl.InsertHtml");if(!this.Ze.isEditable)return pc.a.Gzc(this._context.appId,"ContentControl.InsertHtml",void 0,bt.a[n]),null;const C=(new Date).getTime();if(this.Ze.Bee||this.Ze.toc)return E.ULS.sendTraceTag(19482261,369,15,"AppId:{0}, content control with Binding is not allowed for insertHtml API in ContentControl class.",this._context.appId),pc.a.sC(),null;if(2===n||3===n||4===n){const S=
this.Ze.DF(),ja=this.Ze.Xd;let ya=this.Ze.id;return this.fq.eZb(ya)?(E.ULS.sendTraceTag(19482262,369,15,"AppId:{0}, failed to release content control for insertHtml API in ContentControl class.",this._context.appId),pc.a.hg(),null):this.px.insertHtml(S,e,n,C,this._context,!0).then(()=>{let kb=!1;if(1===S.count&&S.K(0).contextId===Ma.a.Vc){kb=!0;let Rb=new fb.a;Rb.add(S.K(0));Rb=this.Yc.insertText(Rb," ",3);S.W(0,Rb.K(0))}if(({id:ya}=this.fq.XVk(S,ja)).returnValue)return E.ULS.sendTraceTag(19482263,
369,10,"AppId:{0}, failed to restore the content control for insertHtml API in ContentControl class.",this._context.appId),pc.a.hg(),null;this.Ze=this.fq.getById(ya);kb&&this.Ze.Rxe("");return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.nk.create(S,this._context))})}E.ULS.sendTraceTag(19482264,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId);pc.a.td();return null}Dan(e,n){const C=(new Date).getTime();pc.a.hBc(e,"ContentControl.InsertHtml");
const S=this.vnc(n);let ja=new fb.a;switch(n){case 2:case 3:ja.add(this.SPb(n));break;case 4:ja=this.Ljc();break;default:E.ULS.sendTraceTag(22062857,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId),pc.a.td()}S&&this.sh.tJa();return this.px.insertHtml(ja,e,n,C,this._context)}Osl(){this.Ze.clear()&&pc.a.hg()}Psl(){this.Yc.WLb(this.Ljc())}yQl(e){(e?this.fq.eZb(this.id):this.fq.lQl(this.id))&&pc.a.hg()}zQl(e){e?(e=!1,this.Ze.HL&&(e=!0,this.sh.KNb(),
this.clear()),this.fq.eZb(this.id)&&pc.a.hg(),e&&this.sh.tJa()):this.Yc.jgc(this.Ze.DF())}get Xd(){return this.Ze.Xd}get LR(){return this.Ze.Xd.LR}set LR(e){this.Ze.Xd.LR=e}set text(e){G.AFrameworkApplication.dv&&this.Ze.Rxe(e)}L7c(e,n,C){const S=(new Date).getTime();let ja=null,ya=!1;switch(n){case 4:ya=!0;this.sh.KNb();this.clear();ja=this.SPb(2);break;case 3:case 2:ya=this.vnc(n);ja=this.SPb(n);break;default:E.ULS.sendTraceTag(20047956,369,15,"AppId:{0}, invalid argument for insertInlinePictureFromBase64 API in ContentControl class.",
this._context.appId),pc.a.td()}ja||(E.ULS.sendTraceTag(20047957,369,50,"AppId:{0}, user wants to insert an image into content control but a wrong place or something wrong.",this._context.appId),pc.a.hg());ya&&this.sh.tJa();let kb;this.Yc.FW((kb=new fb.a,kb.add(ja),kb),n,0);G.AFrameworkApplication.dv&&C?(this._context.Cn.Dv(),n=this.ay.lSb(e,ja,this._context,C)):n=this.ay.lSb(e,ja,this._context);return n.then(Rb=>{G.AFrameworkApplication.dv||this._context.Cn.Dv();if(!Rb)return E.ULS.sendTraceTag(20047958,
369,10,"AppId:{0}, something went wrong when insert iamge into ContentControl.",this._context.appId),pc.a.oP("ContentControl.InsertInlinePictureFromBase64",pc.a.fQ(S),e.length,!1),pc.a.hg(),null;pc.a.oP("ContentControl.InsertInlinePictureFromBase64",pc.a.fQ(S),e.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.iO.create(this.ay.t0c(Rb),this._context))})}MPb(){if(G.AFrameworkApplication.dv)return this.Ze.DF()}IMm(){return this.sh.L8c(this.Ze)?0===this.Ze.type?this.Ze.zg?
this.K$k()?16:2:1:1===this.Ze.type?this.Ze.zg?64:32:8===this.Ze.type?512:0:0}K$k(){const e=this.Ze.start.node,n=this.Ze.end.node;var C=Ed.a.eb(e);if(C.zb(14)){var S=C.kd(14);C=this.hb.Zm(S);S=this.hb.GF(S);if(C&&S&&e.id===C.id&&n.id===S.id)return!0}return!1}opb(e){96===this.type&&0!==e&&1!==e&&pc.a.sC()}bki(e){512===this.type&&0!==e&&1!==e&&pc.a.sC()}qOb(e){this.opb(e);this.bki(e)}}Object(F.a)(LG,"ContentControl",Hh.a,[901]);class pB{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd){this.ld=this.sh=
this.iO=this.nk=this.zo=null;this.zC=e;this.fq=n;this.Lq=C;this.xB=S;this.Yc=ja;this.ay=ya;this.vB=kb;this.px=Rb;this.Hl=sc;this.Xn=Fc;this.hb=gd;this.erk=td;this.ZLe=Bd}su(e,n,C,S,ja,ya,kb){this.zo=e;this.nk=n;this.iO=C;this.sh=S;this.ld=ja;this.wx=ya;this.Xx=kb}create(e,n){return new LG(e,n,this.fq,this,this.zo,this.nk,this.zC,this.iO,this.Lq,this.xB,this.Yc,this.sh,this.ay,this.vB,this.px,this.Hl,this.Xn,this.ld,this.hb,this.erk,this.wx,this.Xx,this.ZLe)}}Object(F.a)(pB,"ContentControlFactory",
null,[1080]);class RC extends Hh.a{constructor(e){super();pc.a.Tx(e,"ContentCollection");this.qwa=e}length(){return this.qwa.count}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.qwa.K(e);E.ULS.sendTraceTag(17093347,369,10,"The index is out of the ContentControlCollection range.");pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}getByChangeTrackingStates(e){pc.a.nIp()||pc.a.Kj();if(null===e||void 0===e||!e.length)return null;let n=0;for(const C of e)0<=C&&4>=C?n|=
C:pc.a.td();e=new fb.a;for(const C of this.qwa)C.isValid()&&(null!=C.Xd.jx?this.DWf(n,4)&&e.add(C):null!=C.Xd.Ly?this.DWf(n,2)&&e.add(C):this.DWf(n,1)&&e.add(C));return new RC(e)}getById(e){(e=this.getByIdOrNullObject(e))||pc.a.Wk();return e}getByIdOrNullObject(e){let n=null;for(const C of this.qwa)if(C.id===e&&C.isValid()){n=C;break}return n}getByTag(e){return this.Wti(n=>n.tag===e)}getByTitle(e){return this.Wti(n=>n.title===e)}getByTypes(e){pc.a.ej()||pc.a.Kj();const n=new fb.a;for(const C of this.qwa)if(C.isValid())for(const S of e)if(0<
(C.subtype&S)){n.add(C);break}return new RC(n)}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){pc.a.ej()||pc.a.Kj();return this.qwa&&0<this.qwa.count?this.qwa.K(0):null}getItem(e){e=pc.a.QN(e);return this.getById(e)}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.ContentControlCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1010:return this.mkm(n);case 1002:return this.a2c(n);case 1008:return this.b2c(n);case 1004:return this.qkm(n);case 1003:return this.rkm(n);
case 1006:return this.wGf(n);case 1007:return this.dD();case 1009:return this.eD();case 1:return this.y_(n);case 1001:return this.jh();case 1005:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}getContentControls(){return this.qwa&&0<this.qwa.count?Array.from(this.qwa):[]}mkm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,
"Array<int>");return this.getByChangeTrackingStates(e)}a2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getById(e)}b2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getByIdOrNullObject(e)}qkm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByTag(e)}rkm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByTitle(e)}wGf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"Array<int>");return this.getByTypes(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}DWf(e,n){return 0!==(e&n)}Wti(e){if(!e)return null;const n=new fb.a;for(const C of this.qwa)e(C)&&C.isValid()&&n.add(C);return new RC(n)}}Object(F.a)(RC,"ContentControlCollection",Hh.a,[901,931]);class DE{constructor(e,
n,C,S,ja,ya,kb,Rb,sc,Fc,gd){this.fq=e;this.yK=n;this.f5=C;this.Yc=S;this.qG=ja;this.Wm=ya;this.ESe=kb;this.Gp=Rb;this.hb=sc;this.yo=Fc;this.Lq=gd}get uF(){return null!=this.aTg?this.aTg:this.aTg=(()=>this.ESe())()}L8c(e){switch(e.type){case 0:case 1:return!0;case 8:return pc.a.dia;default:return!1}}Ehm(e=null){const n=this.fq.ghm();return this.rNf(n,e)}sNf(e,n,C=null){e=this.fq.ZO(e,n,1);return this.rNf(e,C)}rNf(e,n=null){if(!e||!this.f5)return null;const C=new fb.a;for(const S of e)this.L8c(S)&&
C.add(this.f5.create(S,n));return new RC(C)}RMm(e,n=null){e=this.hb.NA(e,!0,!1);return 0>=e.count?null:this.sNf(e.K(0),e.K(e.count-1),n)}EDi(e,n){return this.fq.ZO(e,n,3,!0)}Skc(e,n,C=null){n=this.fq.ZO(e,n,3,!0);e=null;if(0<n.count)if(this.L8c(n.K(0)))e=n.K(0);else for(n=n.K(0),n=n.parentId;n=this.fq.getById(n);){if(this.L8c(n)){e=n;break}n=n.parentId}return e?this.f5.create(e,C):null}ngf(e){if(e.count){var n=e.K(0),C=e.K(e.count-1);if(n.contextId===Ma.a.Zc){var S=this.hb.textLength(n.node)?ce.a.Cx(n.node):
ce.a.create(n.node);S.Fb=n.oo();S.Tb=n.qo();n===C&&(C=S);n=S}C.contextId!==Ma.a.Zc||this.hb.textLength(C.node)||(S=ce.a.create(C.node),S.Tb=C.qo(),C=S);if((Ge.a.Xw(n)&&Ge.a.etb(n)||this.hb.en(n))&&Ge.a.Xw(C)&&Ge.a.etb(C)){S=this.Gp.I8a(n.node,n.zj,n.Fb,!0);const ja=this.Gp.I8a(C.node,C.Po,C.Tb,!1);if(!S&&!ja||S&&ja&&S.se.equals(ja.se)&&S.zg)S=ce.a.create(C.node),S.Fb=C.Fb,S.Tb=C.Tb,C=S}e.W(0,n);e.W(e.count-1,C)}}sqa(e,n,C,S=0,ja=!1){let ya=0;if(e=({id:ya}=this.fq.dVk(e,n,S,ja)).returnValue){if(ja)return e;
E.ULS.sendTraceTag(17148101,369,15,"AppId:{0}, failed to create a new block content control.",C.appId);pc.a.hg();return null}if(ja)return e;ja=this.fq.getById(ya);ef.a.Mhe(ja.objectId);ja.type=S;return this.f5.create(ja,C)}t5a(e,n,C=0,S=!1){let ja=0;if(e=({id:ja}=this.fq.t5a(e,null,C,S)).returnValue){if(S)return e;E.ULS.sendTraceTag(17148102,369,15,"AppId:{0}, failed to create a new inline content control.",n.appId);pc.a.hg();return null}if(S)return e;S=this.fq.getById(ja);if(G.AFrameworkApplication.dv&&
S&&null===S.start)return 2;ef.a.Mhe(S.objectId);S.type=C;return this.f5.create(S,n)}dX(e,n){return this.fq.dX(e,n)}W$a(e){return this.qG.W$a(e)}KNb(){this.yK&&this.yK.KNb("RelateToSelection")}tJa(){this.yK&&this.yK.tJa("RelateToSelection")}select(e){this.Wm.select(e.objectId,!0)}osd(e){this.uF&&Ge.a.mf(e)&&this.uF.osd(e)}GOa(e,n){if(!this.uF||!Ge.a.mf(e))return e;var C=n.K(0),S=ce.a.Uc(C.node,C.zj);S.Tb=S.Fb=C.Fb;C=n.K(n.count-1);var ja=ce.a.Uc(C.node,C.Po);ja.Tb=ja.Fb=C.Tb;C=Ge.a.pl(C)||C.contextId===
Ma.a.paragraph;const ya=new fb.a;ya.add(S);ya.add(ja);for(S=this.Qzi(e.node,e.cpBegin,e.Fb);S;){ja=e.node.id;e=this.h1l(S,e,ya);if(!e.node.id.equals(ja)&&(S=this.Gp.xvi(e.node,S.se),!S)){E.ULS.sendTraceTag(36459329,369,15,"Failed to find content control start boundary after split.");pc.a.hg();break}this.g1l(S,ya);S=this.Gp.xvi(S.Ib.paragraph,S.se);ja=S.Ib.Hb.sL(S.se,!0);S=ce.a.Uc(S.Ib.paragraph,S.Ib.cp);S.Tb=S.Fb=ja+1;if(!this.uF.GOa(S)){E.ULS.sendTraceTag(36459330,369,15,"Failed to Convert inline content control to block.");
pc.a.hg();break}S=this.Qzi(e.node,e.cpBegin,e.Fb)}C=this.qBm(ya,C);!n.count||C&&C.count||(E.ULS.sendTraceTag(36459332,369,15,"GncList is empty after conversion"),pc.a.hg());n.clear();n.addRange(C);return e}h1l(e,n,C){if(!e.Ib.cp)return n;C.add(n);this.HWj(e,!0,C);n=C.K(C.count-1);C.removeAt(C.count-1);return n}g1l(e,n){(e=this.Gp.lnm(e))?e.Ib.cp!==this.hb.textLength(e.Ib.paragraph)&&this.HWj(e,!1,n):(E.ULS.sendTraceTag(36459333,369,15,"Failed to find content control end boundary."),pc.a.hg())}HWj(e,
n,C){var S=e.Ib;e=S.Hb.sL(e.se,e.Wc);S=ce.a.Uc(S.paragraph,S.cp);S.Tb=S.Fb=e+(n?0:1);n=new fb.a;for(var ja of C)n.add(this.pdc(ja,S));({tNb:ja}=this.Yc.Fmc(S,!1));ja=this.yo.Me(ja);for(e=0;e<C.count;e++)C.W(e,this.nxm(C.K(e),S,ja,n.K(e)))}TWf(e,n){return e.node.id.equals(n.node.id)&&(e.cpBegin>n.cpBegin||e.cpBegin===n.cpBegin&&e.oo()>n.oo())}hcl(e,n){return this.pdc(e,n)}pdc(e,n=null,C=!1){return n&&!this.TWf(e,n)?null:this.Gp.I8a(e.node,e.cpBegin,e.Fb,C)}lIo(e,n,C,S){this.Hue(e,n,C,S)}Hue(e,n,C=
null,S=null,ja=!1){C&&S&&!this.TWf(C,S)||(C=e.node.ra.Dh(ja?e.zj:e.Po))&&C.Hb&&C.Hb.length&&(n=n?C.Hb.sL(n.se,n.Wc):-1,n=ja?0<=n?n+1:0:0<=n?n:C.Hb.length,e.contextId===Ma.a.Vc?e.Tb=e.Fb=n:ja?e.Fb=n:e.Tb=n)}nxm(e,n,C,S){if(!this.TWf(e,n))return e;C=ce.a.Uc(C,e.cpBegin-n.cpBegin);this.Hue(C,S,e,n);return C}Qzi(e,n,C){e=this.Gp.Maa(e,n,C);for(const S of e)if(!S.zg)return S;return null}qBm(e,n){const C=e.K(0);e=e.K(e.count-1);return this.Lq.xyi(C,e,n)}}Object(F.a)(DE,"ContentControlOperations",null,[1199]);
class MG extends Hh.a{constructor(e,n,C){super();this._context=e;this.wl=n;this.j5=C}get id(){return this.j5.id}get namespaceUri(){return this.j5.namespace}get _ReferenceId(){return this.Hp?this.Vp:null}deleteObject(){this.gnb();this.wl.Zdi(this.id)!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pc.a.td()}deleteAttribute(e,n,C){this.gnb();e=this.pRb(n,e);e=this.Yxb(e);1!==e.length&&pc.a.td();e[0].removeAttribute(C);this.j5.save()}deleteElement(e,n){this.gnb();e=this.pRb(n,e);e=this.Yxb(e);1!==
e.length&&pc.a.td();e[0].parentNode.removeChild(e[0]);this.j5.save()}getXml(){return this.j5.P0a}insertAttribute(e,n,C,S){this.gnb();e=this.pRb(n,e);e=this.Yxb(e);1!=e.length&&pc.a.td();e[0].setAttribute(C,S);this.j5.save()}insertElement(e,n,C,S){this.gnb();e=this.pRb(C,e);e=this.Yxb(e);1!==e.length&&pc.a.td();S||0===S?S>e[0].childNodes.length&&pc.a.td():S=e[0].childNodes.length;n=new OSF.XmlProcessor(n,"");e[0].insertBefore(n.getDocumentElement(),S===e[0].childNodes.length?null:e[0].childNodes[S])||
pc.a.td();this.j5.save()}query(e,n){e=this.pRb(n,e);e=this.Yxb(e,!1);n=[];if(e)for(let C=0;C<e.length;C++){const S=this.j5.getNodeXml(e[C]);n.push(S)}return n}setXml(e){this.gnb();const n=this.Yxb("/",!1);n&&(this.j5.setNodeXml(n[0].firstChild,e)||pc.a.td())}updateAttribute(e,n,C,S){this.gnb();e=this.pRb(n,e);e=this.Yxb(e);1!==e.length&&pc.a.td();e[0].hasAttribute(C)?e[0].setAttribute(C,S):pc.a.td();this.j5.save()}updateElement(e,n,C){this.gnb();e=this.pRb(C,e);e=this.Yxb(e);1!==e.length&&pc.a.td();
this.j5.setNodeXml(e[0],n)||pc.a.td()}pRb(e,n){const C=Object.keys(e);for(let S=0;S<C.length;S++){const ja=C[S],ya=this.j5.I3c(e[ja]);ya&&(n=n.replace("/"+ja+":","/"+ya+":"))}return n}Yxb(e,n=!0){let C;try{C=this.j5.selectNodes(e,null)}catch(S){n&&pc.a.td()}n&&!C&&pc.a.td();return C}gnb(){this.j5.builtIn&&pc.a.td()}_KeepReference(){this.xp()}_OnAccess(){this._context.Cn.sec(this.wl.Gka.currentNode);this.j5.VYf()||this.j5.kLg();pc.a.Q0(this.j5.cR,"CustomXmlPart")}getTypeName(){return"Microsoft.WordServices.CustomXmlPart"}invokePropertyGet(e){switch(e){case 2:return this.id;
case 3:return this.namespaceUri;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.VC(n);
case 1012:return this.hQl(n);case 1009:return this.EQl(n);case 1004:return this.uSm();case 1010:return this.O$m(n);case 1007:return this.lan(n);case 1006:return this.slo(n);case 1005:return this.F0o(n);case 1011:return this.vvp(n);case 1008:return this.fxp(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();
return null}hQl(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");this.deleteAttribute(n,C,e);return null}EQl(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");this.deleteElement(n,e);return null}uSm(){return this.getXml()}O$m(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"string");this.insertAttribute(n,C,S,e);return null}lan(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"any");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"int?");this.insertElement(n,C,S,e);return null}slo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");return this.query(n,e)}F0o(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.setXml(e);return null}vvp(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"any"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"string");this.updateAttribute(n,C,S,e);return null}fxp(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"any");this.updateElement(n,C,e);return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();
return null}}Object(F.a)(MG,"CustomXmlPart",Hh.a,[901]);class EE{constructor(e){this.wl=e}su(){}create(e,n){return new MG(n,this.wl,e)}}Object(F.a)(EE,"CustomXmlPartFactory",null,[1080]);class FE extends Hh.a{constructor(e){super();this.Stk=e}get body(){pc.a.sC();return null}get contentControls(){pc.a.sC();return null}get customXmlParts(){pc.a.sC();return null}get properties(){pc.a.sC();return null}get saved(){return!1}get sections(){pc.a.sC();return null}get settings(){pc.a.sC();return null}get _ReferenceId(){return this.Hp?
this.Vp:null}addStyle(){pc.a.sC();return null}deleteBookmark(){pc.a.sC()}getBookmarkRange(){pc.a.sC();return null}getBookmarkRangeOrNullObject(){pc.a.sC();return null}getContentControls(){pc.a.sC();return null}insertFileFromBase64(){pc.a.sC();return null}getStyles(){pc.a.sC();return null}open(){return OfficeExtension.WacRuntime.Utility.createPromise(e=>{const n=new pb.StandardDialog;n.Bd=4;n.sw(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,C=>{1===C&&
wb.a.Tm(this.Stk,void 0,void 0,"ExtensionPackage.OpenDialog");e(null)})})}save(){pc.a.sC()}_KeepReference(){this.xp()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.DocumentCreated"}invokePropertyGet(e){switch(e){case 3:return this.body;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1028:return this.Eef(n);case 1011:return this.mvf(n);case 1010:return this.nGf(n);case 1012:return this.oGf(n);case 1013:return this.YJa(n);
case 1029:return this.lNf();case 1005:return this.lvg(n);case 1008:return this.jh();case 1007:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1009:return this.Q6n();case 1014:return this.Osa(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Eef(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.addStyle(n,e)}mvf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.deleteBookmark(e);return null}nGf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRange(e)}oGf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRangeOrNullObject(e)}YJa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,wo);return this.getContentControls(e)}Osa(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,Zn);return this.insertFileFromBase64(n,C,e)}lNf(){return this.getStyles()}Q6n(){return this.open()}lvg(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");this.save(n,e);return null}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}}Object(F.a)(FE,"DocumentCreated",Hh.a,[901]);class so{create(e){return new FE(e)}}Object(F.a)(so,"DocumentCreatedFactory",null,[]);var Wz=d(309),NG=d(220),Xz=d(223);class Xt extends Hh.a{constructor(e,n,C,S,ja){super();this._context=e;this.wl=n;this.pda=C;this.nFk=S;this.P1a=ja}length(){return this.getCount()}_GetItem(e){if(pc.a.QN(e)<this.length())return this.pda.K(e);pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}getCount(){this.rfb();
return this.pda.count}getItem(e){(e=this.getItemOrNullObject(e))||pc.a.Wk();return e}getItemOrNullObject(e){this.rfb();for(let n=0;n<this.pda.count;n++)if(this.pda.K(n).id==e)return this.pda.K(n);return null}getOnlyItem(){const e=this.getOnlyItemOrNullObject();e||pc.a.Wk();return e}getOnlyItemOrNullObject(){this.rfb();return 1==this.getCount()?this.pda.K(0):null}rfb(){const e=this.wl.I1c(),n=new fb.a;for(let C=0;C<e.length;C++)if(e[C].namespace===this.nFk){const S=this.P1a.create(e[C],this._context);
e[C].builtIn&&0!=n.count?n.insert(0,S):n.add(S)}this.pda=n}_KeepReference(){this.xp()}_OnAccess(){this._context.Cn.sec(this.wl.Gka.currentNode)}getAsyncEnumerator(e,n){this.rfb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartScopedCollection"}invokePropertyGet(e){switch(e){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=
this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.K8a();case 2:return this.y_(n);case 1004:return this.d9a(n);case 1005:return this.bDm();case 1006:return this.cDm();case 1002:return this.jh();
case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}K8a(){return this.getCount()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}d9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}bDm(){return this.getOnlyItem()}cDm(){return this.getOnlyItemOrNullObject()}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}}Object(F.a)(Xt,"CustomXmlPartScopedCollection",Hh.a,[901,931]);class Yz extends Hh.a{constructor(e,n,C,S,ja){super();this._context=e;this.wl=n;this.pda=C;this.P1a=S;this.Rc=ja}length(){return this.getCount()}_GetItem(e){if(pc.a.QN(e)<this.length())return this.pda.K(e);pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}add(e){let n=null;({ced:n}=this.wl.Bdf(e)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pc.a.td();e=
new Oh(n,this.Rc);return this.P1a.create(e,this._context)}getByNamespace(e){this.rfb();const n=this.pda,C=new fb.a;for(let S=0;S<n.count;S++)n[S].namespace===e&&C.add(this.P1a.create(n[S],this._context));return 0==C.count?null:new Xt(this._context,this.wl,C,e,this.P1a)}getCount(){this.rfb();return this.pda.count}getItem(e){(e=this.getItemOrNullObject(e))||pc.a.Wk();return e}getItemOrNullObject(e){this.rfb();for(let n=0;n<this.pda.count;n++)if(this.pda.K(n).id==e)return this.pda.K(n);return null}rfb(){const e=
this.wl.I1c(),n=new fb.a;for(let C=0;C<e.length;C++){const S=this.P1a.create(e[C],this._context);e[C].builtIn&&0!=n.count?n.insert(0,S):n.add(S)}this.pda=n}_KeepReference(){this.xp()}_OnAccess(){this._context.Cn.sec(this.wl.Gka.currentNode)}getAsyncEnumerator(e,n){this.rfb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartCollection"}invokePropertyGet(e){switch(e){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1004:return this.nSc(n);case 1005:return this.pkm(n);case 1003:return this.K8a();case 2:return this.y_(n);case 1006:return this.d9a(n);
case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nSc(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.add(e)}pkm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByNamespace(e)}K8a(){return this.getCount()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.getItem(e)}d9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Yz,"CustomXmlPartCollection",Hh.a,[901,931]);var yp=d(1553);class Rr extends Hh.a{constructor(e){super();pc.a.Tx(e,"SectionCollection");this.hPc=e}length(){return this.hPc.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();
e||pc.a.Wk();return e}getFirstOrNullObject(){pc.a.ej()||pc.a.Kj();return this.hPc&&this.hPc.count?this.hPc.K(0):null}_GetItem(e){e=pc.a.QN(e);if(0<=e&&e<this.length())return this.hPc.K(e);E.ULS.sendTraceTag(16814432,369,10,"The index is out of the section range.");pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.SectionCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Rr,"SectionCollection",Hh.a,[901,931]);class hx extends Hh.a{constructor(e,n,C){super();this.U2a=e;this.kia=n;this.L1=C}get key(){return this.U2a}get value(){return this.L1.get(this.U2a).getValue(hb.a.Scc)}set value(e){this.L1.get(this.U2a).setValue(hb.a.Scc,
e)}get _Id(){return null}get _ReferenceId(){return this.Hp?this.Vp:null}deleteObject(){const e=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled"),n=new Ed.a;n.set(this.kia);let C=n.Vb(21);for(;C;){if(C.getValue(hb.a.bTc)===this.U2a){n.y7a(!e);break}C=n.Kf(21)}e&&this.kia.fC(21);this.kia.setValue(Ee.a.DU,new Date);this.L1.delete(this.U2a)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.L1.get(this.U2a),"Setting")}getTypeName(){return"Microsoft.WordServices.Setting"}invokePropertyGet(e){switch(e){case 2:return this.key;
case 3:return this.value;case 4:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.VC(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(hx,"Setting",
Hh.a,[901]);class GE extends Hh.a{constructor(e,n){super();this.kia=e;this.Y$b=n;this.L1=new Map}get _ReferenceId(){return this.Hp?this.Vp:null}add(e,n){e||pc.a.td();this.YOa();if(this.L1.has(e))this.L1.get(e).setValue(hb.a.Scc,n),this.kia.setValue(Ee.a.DU,new Date);else{const C=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled");n=this.Y$b.ftf(e,n);const S=Tj.a.create(),ja=new Ed.a;ja.set(this.kia);ja.d6(n,21,new Wc.a(S,1),!C);C&&this.kia.fC(21);this.kia.setValue(Ee.a.DU,
new Date);this.L1.set(e,n)}return new hx(e,this.kia,this.L1)}deleteAll(){this.L1.clear();const e=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled"),n=new Ed.a;for(n.set(this.kia);n.Vb(21);)n.y7a(!e);e&&this.kia.fC(21);this.kia.setValue(Ee.a.DU,new Date)}getCount(){this.YOa();return this.L1.size}getItem(e){this.YOa();(e=this.PJf(e))||pc.a.Wk();return e}getItemOrNullObject(e){this.YOa();return this.PJf(e)}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,
n){this.YOa();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.SettingCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.nSc(n);case 1005:return this.jvf();case 1004:return this.K8a();case 1:return this.y_(n);case 1006:return this.d9a(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}length(){return this.L1.size}_GetItem(e){e=
pc.a.QN(e);if(0>e||e>=this.L1.size)return pc.a.td(),null;const n=this.L1.keys();let C="";for(let S=0;S<=e;S++)C=n.next().value;return this.PJf(C)}nSc(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");return this.add(n,e)}jvf(){this.deleteAll();return null}K8a(){return this.getCount()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}d9a(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}YOa(){this.L1.clear();const e=new Ed.a;e.set(this.kia);let n=e.Vb(21);for(;n;){const C=n.getValue(hb.a.bTc);this.L1.set(C,n);n=e.Kf(21)}}PJf(e){return this.L1.has(e)?new hx(e,this.kia,this.L1):null}}Object(F.a)(GE,"SettingCollection",Hh.a,[901,931]);class HE extends Hh.a{constructor(e,n){super();this._style=e;this.ew=n}get alignment(){if(this._style.hasProperty(Ee.a.si))switch(this._style.getValue(Ee.a.si)){case 1:return 0;
case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(e){let n=0;switch(e){case 0:n=1;break;case 2:n=3;break;case 1:n=2;break;case 3:n=6;break;default:E.ULS.sendTraceTag(509097629,369,15,"set ParagraphFormat.Alignment with not supported value: {0}.",e),pc.a.td()}e=new Map;e.set(Ee.a.si,n);this.rD(e)}get firstLineIndent(){if(this._style.hasProperty(hb.a.uD)){const e=this._style.getValue(hb.a.uD);return oi.a.Wha(e)}}set firstLineIndent(e){e=
oi.a.fK(e);const n=new Map;0<=e?n.set(hb.a.uD,e):n.set(hb.a.Jt,e);this.rD(n)}get keepTogether(){if(this._style.hasProperty(dj.a.keepTogether))return this._style.getValue(dj.a.keepTogether)}set keepTogether(e){pc.a.Tx(e,"ParagraphFormat.KeepTogether");const n=new Map;n.set(dj.a.keepTogether,e);this.rD(n)}get keepWithNext(){if(this._style.hasProperty(dj.a.keepWithNext))return this._style.getValue(dj.a.keepWithNext)}set keepWithNext(e){pc.a.Tx(e,"ParagraphFormat.KeepWithNext");const n=new Map;n.set(dj.a.keepWithNext,
e);this.rD(n)}get leftIndent(){if(this._style.hasProperty(hb.a.ke)){const e=this._style.getValue(hb.a.ke);return oi.a.Wha(e)}}set leftIndent(e){const n=new Map;n.set(hb.a.ke,oi.a.fK(e));this.rD(n)}get lineSpacing(){if(this._style.hasProperty(hb.a.xa)){const e=this._style.getValue(hb.a.xa);return oi.a.Wha(e)}}set lineSpacing(e){pc.a.D0a(e,"ParagraphFormat.LineSpacing");const n=new Map;n.set(hb.a.xa,oi.a.fK(e));this.rD(n)}get lineUnitAfter(){if(this._style.hasProperty(hb.a.L3))return this._style.getValue(hb.a.L3)/
100;if(this._style.hasProperty(hb.a.ta)){const e=this._style.getValue(hb.a.ta);return oi.a.Wha(e)/12}}set lineUnitAfter(e){pc.a.C0a(e,"ParagraphFormat.LineUnitAfter");const n=new Map;n.set(hb.a.L3,100*e);n.set(hb.a.Gga,!1);this.rD(n)}get lineUnitBefore(){if(this._style.hasProperty(hb.a.M3))return this._style.getValue(hb.a.M3)/100;if(this._style.hasProperty(hb.a.Uj)){const e=this._style.getValue(hb.a.Uj);return oi.a.Wha(e)/12}}set lineUnitBefore(e){pc.a.C0a(e,"ParagraphFormat.LineUnitBefore");const n=
new Map;n.set(hb.a.M3,100*e);n.set(hb.a.Hga,!1);this.rD(n)}get mirrorIndents(){}set mirrorIndents(e){}get outlineLevel(){if(this._style.hasProperty(hb.a.Jj))return this._style.getValue(hb.a.Jj)}set outlineLevel(e){if(0>e||9<e)E.ULS.sendTraceTag(509097628,369,10,"Set OutlineLevel with not supported value: {0}.",e),pc.a.td();const n=new Map;n.set(hb.a.Jj,e);this.rD(n)}get rightIndent(){if(this._style.hasProperty(hb.a.Uv)){const e=this._style.getValue(hb.a.Uv);return oi.a.Wha(e)}}set rightIndent(e){const n=
new Map;n.set(hb.a.Uv,oi.a.fK(e));this.rD(n)}get spaceAfter(){if(this._style.hasProperty(hb.a.L3))return this._style.getValue(hb.a.L3)/100*12;if(this._style.hasProperty(hb.a.ta)){const e=this._style.getValue(hb.a.ta);return oi.a.Wha(e)}}set spaceAfter(e){pc.a.C0a(e,"ParagraphFormat.SpaceAfter");const n=new Map;n.set(hb.a.ta,oi.a.fK(e));n.set(hb.a.Gga,!1);this._style.Vf(hb.a.L3);this.rD(n)}get spaceBefore(){if(this._style.hasProperty(hb.a.M3))return this._style.getValue(hb.a.M3)/100*12;if(this._style.hasProperty(hb.a.Uj)){const e=
this._style.getValue(hb.a.Uj);return oi.a.Wha(e)}}set spaceBefore(e){pc.a.C0a(e,"ParagraphFormat.SpaceBefore");const n=new Map;n.set(hb.a.Uj,oi.a.fK(e));n.set(hb.a.Hga,!1);this._style.Vf(hb.a.M3);this.rD(n)}get widowControl(){if(this._style.hasProperty(dj.a.widowControl))return this._style.getValue(dj.a.widowControl)}set widowControl(e){pc.a.Tx(e,"ParagraphFormat.WidowControl");const n=new Map;n.set(dj.a.widowControl,e);this.rD(n)}get _ReferenceId(){return this.Hp?this.Vp:null}_KeepReference(){return this.xp()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.ParagraphFormat"}invokePropertyGet(e){switch(e){case 2:return this.alignment;
case 3:return this.firstLineIndent;case 4:return this.keepTogether;case 5:return this.keepWithNext;case 6:return this.leftIndent;case 7:return this.lineSpacing;case 8:return this.lineUnitAfter;case 9:return this.lineUnitBefore;case 10:return this.mirrorIndents;case 11:return this.outlineLevel;case 12:return this.rightIndent;case 13:return this.spaceAfter;case 14:return this.spaceBefore;case 15:return this.widowControl;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 2:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 3:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 4:this.keepTogether=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 5:this.keepWithNext=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 6:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 7:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 8:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 9:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 10:this.mirrorIndents=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 11:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 12:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 13:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 14:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 15:this.widowControl=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}rD(e){const n=this._style.getValue(Ld.a.la),C=new od.ScriptSharpLegacyMap;for(const S of e)C.W(S[0],S[1]);this.ew.ubb(n,C,Gi.a.Np())}}Object(F.a)(HE,"ParagraphFormat",Hh.a,[901]);class Qo extends Hh.a{constructor(e,n,C){super();this.zC=e;this._style=n;this.ew=C;this.zIk=new HE(this._style,this.ew);this._font=this.zC.create(null,null,null,null,null,this._style)}get baseStyle(){if(this._style.hasProperty(hb.a.pa))return this._style.getValue(hb.a.pa)}get builtIn(){}get description(){}get font(){return this._font}get inUse(){if(this._style.hasProperty(hb.a.e2i))return this._style.getValue(hb.a.e2i)}get linked(){return this._style.hasProperty(hb.a.linkedStyle)?
!0:!1}get listTemplate(){return null}get nameLocal(){return this._style.getValue(Ld.a.la)}get nextParagraphStyle(){if(this._style.hasProperty(Ld.a.he))return this._style.getValue(Ld.a.he)}get paragraphFormat(){return this.zIk}get priority(){if(this._style.hasProperty(dj.a.oa))return this._style.getValue(dj.a.oa)}set priority(e){pc.a.C0a(e,"Style.Priority");this.rD(dj.a.oa,e)}get quickStyle(){if(this._style.hasProperty(hb.a.Hd))return this._style.getValue(hb.a.Hd)}set quickStyle(e){pc.a.Tx(e,"Style.QuickStyle");
this.rD(hb.a.Hd,e)}get type(){return this._style.getValue(Ld.a.ma)}get unhideWhenUsed(){if(this._style.hasProperty(hb.a.unhideWhenUsed))return this._style.getValue(hb.a.unhideWhenUsed)}set unhideWhenUsed(e){pc.a.Tx(e,"Style.UnhideWhenUsed");this.rD(hb.a.unhideWhenUsed,e)}get visibility(){if(this._style.hasProperty(hb.a.nmb))return this._style.getValue(hb.a.nmb)}set visibility(e){pc.a.Tx(e,"Style.Visibility");this.rD(hb.a.nmb,e)}get _ReferenceId(){return this.Hp?this.Vp:null}deleteObject(){const e=
new fb.a;e.add(this._style.getValue(Ld.a.la));this.ew.Ydi(e)}_KeepReference(){return this.xp()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Style"}invokePropertyGet(e){switch(e){case 2:return this.baseStyle;case 3:return this.builtIn;case 4:return this.description;case 5:return this.font;case 6:return this.inUse;case 7:return this.linked;case 16:return this.listTemplate;case 8:return this.nameLocal;case 9:return this.nextParagraphStyle;case 15:return this.paragraphFormat;case 10:return this.priority;
case 11:return this.quickStyle;case 12:return this.type;case 13:return this.unhideWhenUsed;case 14:return this.visibility;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 10:this.priority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 11:this.quickStyle=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 13:this.unhideWhenUsed=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 14:this.visibility=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
n){switch(e){case 1003:return this.VC(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}rD(e,n){const C=this._style.getValue(hb.a.na),S=new od.ScriptSharpLegacyMap;S.W(e,n);this.ew.ubb(C,S,Gi.a.Np())}}
Object(F.a)(Qo,"Style",Hh.a,[901]);class Sr extends Hh.a{constructor(e,n,C){super();this.q0e=new Map;this.smh=new Map;this.zC=e;this.hlb=n;this.ew=C}length(){return this.hlb.Qw}_GetItem(e){if(pc.a.QN(e)<this.length())return this.smh.get(e);E.ULS.sendTraceTag(508941208,369,10,"The index is out of the style collection range.");pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:null}getByName(e){(e=this.getByNameOrNullObject(e))||pc.a.Wk();return e}getByNameOrNullObject(e){if(this.q0e.has(e))return this.q0e.get(e);
if(Gi.a.Kg.vn){var n=this.hlb.gv().GAa(e);n=this.hlb.nh(Gi.a.Yb.Be(n))}else n=this.hlb.qKa(e);return n?(n=new Qo(this.zC,n,this.ew),this.q0e.set(e,n),n):null}getCount(){return this.hlb.Qw}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){this.iLg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}iLg(){for(let e=0;e<this.length();e++){const n=new Qo(this.zC,this.IRm(e),this.ew);this.smh.set(e,n)}}IRm(e){return Gi.a.Kg.vn?(e=this.hlb.gv().vla(e),this.hlb.nh(Gi.a.Yb.Be(e))):
this.hlb.FAa(e)}getTypeName(){return"Microsoft.WordServices.StyleCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
n){switch(e){case 1003:return this.nkm(n);case 1004:return this.okm(n);case 1005:return this.K8a();case 1:return this.WN(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nkm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByName(e)}okm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.getByNameOrNullObject(e)}K8a(){return this.getCount()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Sr,"StyleCollection",Hh.a,[901,931]);class OG extends Hh.a{constructor(e,n,C,S,ja){super();this.context=e;this.annotation=n;this.lKb=C;this.JHa=S;this.ujd=ja}get critique(){if(!jh.a.FD)return null;let e=new Uo;e.colorScheme=this.OJn(this.lKb.squiggleColor);
const {vu:n,cpEnd:C}=this.JHa.uQh(this.annotation);e.start=n;e.length=C-n;return e}OJn(e){switch(e){case yr.a.Red:return 0;case yr.a.Blue:return 2;case yr.a.Green:return 1;case yr.a.Lavender:return 3;case yr.a.Berry:return 4;default:throw Error("Invalid squiggle color");}}get range(){if(!jh.a.FD)return null;const {vu:e,cpEnd:n}=this.JHa.uQh(this.annotation);this.annotation.utb||pc.a.hg();var C=ce.a.createTextRange(this.annotation.parent,e,n);C=new fb.a([C]);return this.ujd.create(C,this.context)}get _ReferenceId(){return this.Hp?
this.Vp:null}accept(){jh.a.FD||pc.a.Kj();this.JHa.Sca(this.annotation,60)}reject(){jh.a.FD||pc.a.Kj();this.JHa.Sca(this.annotation,70)}_KeepReference(){this.xp()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.CritiqueAnnotation"}invokePropertyGet(e){switch(e){case 2:return this.critique;case 3:return this.range;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1003:return this.Gcf();case 1004:return this.rqg();case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Gcf(){this.accept();return null}rqg(){this.reject();
return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(OG,"CritiqueAnnotation",Hh.a,[901]);var qB=d(1463),Zp=d(1090);class Yt extends Hh.a{constructor(e,n,C,S){super();this.annotation=e;this.context=n;this.JHa=C;this.ujd=S;qB.a.$mc(e.content)?this.lKb=e.content:pc.a.hg()}get critiqueAnnotation(){return jh.a.FD?this.lKb?new OG(this.context,this.annotation,this.lKb,this.JHa,this.ujd):null:null}get id(){var e;return jh.a.FD&&null!==(e=this.lKb)&&void 0!==e&&
e.id?this.lKb.id:null}get state(){var e;if(!jh.a.FD)return null;const n=null===(e=this.lKb)||void 0===e?void 0:e.M_.state;if(!n)return 0;switch(n){case Zp.a.Kept:return 1;case Zp.a.Rejected:return 2;case Zp.a.Created:return 0;default:return E.ULS.sendTraceTag(508126469,369,10,"Unexpected annotation state: "+Zp.a[n],this.context.appId),0}}get _ReferenceId(){return this.Hp?this.Vp:null}deleteObject(){jh.a.FD||pc.a.Kj();this.JHa.ZPl(this.annotation)}_KeepReference(){this.xp()}_OnAccess(){}getTypeName(){return jh.a.FD?
"Microsoft.WordServices.Annotation":"Microsoft.WordServices.AddInCritiqueAnnotation"}invokePropertyGet(e){switch(e){case 3:return this.critiqueAnnotation;case 1:return this.id;case 4:return this.state;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.VC(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();
return null}}Object(F.a)(Yt,"Annotation",Hh.a,[901]);class IE{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk,al,Cj,Lg,mq,uk){this.hPb=al;this.hig=Cj;this.Agd=Lg;this.Cv=mq;this.JHa=uk;this.VJe=new fd.a;this.myo=()=>{this._RemoveAllReferences()};this.Bal=()=>{this._context.Cn.Dv()};pc.a.Tx(e,"Document");this.Vu=e;this._context=n;this.qQ=C;this.Lxa=S;this.nk=ja;this.ga=ya;this.ib=kb;this.AG=Rb;this.ul=sc;Fc.lff(this.myo);this.hyk=gd;this.sh=td;this.rDb=Bd;this.unk=
wd;this.Ep=te;this.hb=Le;this.vB=Oe;this.px=We;this.wx=Xf;this.wl=Gg;this.P1a=Ph;this.Rc=Aj;this.Y$b=Ih;this.hy=Nm;this.ew=Sk;this.zC=hk}get context(){return this._context}get allowCloseOnUntitled(){return!1}set allowCloseOnUntitled(e){pc.a.Kj()}get body(){return this.qQ.create(this.AG.qU(this.Vu.value),this._context)}get changeTrackingMode(){return this.wx.hlm()}set changeTrackingMode(e){this.wx.ZSo(this.ga,e)}get contentControls(){const e=new wo;e.types=[31];return this.getContentControls(e)}get customXmlParts(){const e=
this.wl.I1c(),n=new fb.a;for(let C=0;C<e.length;C++){const S=this.P1a.create(e[C],this._context);e[C].builtIn&&0!=n.count?n.insert(0,S):n.add(S)}return new Yz(this._context,this.wl,n,this.P1a,this.Rc)}get properties(){pc.a.ej()||pc.a.Kj("Getter");return this.rDb}get saved(){return!this.hyk()}get sections(){const e=Ed.a.eb(this.AG.qU(this.Vu.value)),n=new fb.a;let C=0;this.ul.$Ua(e,S=>{n.add(this.Lxa.create(S,this._context,C++));return!0});return new Rr(n)}get settings(){this.context.Ek||pc.a.hg();
const e=this.Y$b.rqb(this.Vu,this.AG);e||pc.a.hg();let n=this.Y$b.lAa(this.context.Ek,e.currentNode);n||(n=this.Y$b.xsb(this.context.Ek,e.currentNode));n||pc.a.hg();return new GE(n,this.Y$b)}get _ReferenceId(){return null}addStyle(e,n){pc.a.EYj()||pc.a.Kj();const C=Gi.a.Np(),S=new pj.GraphTransaction(15);S.Ab(C);S.Ph=pe.a.UMb;let ja;ja=Gi.a.Kg.vn?new Wz.a(new NG.a):new Xz.a(new NG.a);try{const ya=Of.a.P_(e);ja.setValue(hb.a.na,Of.a.oDa(ya));ja.setValue(Ld.a.la,ya);ja.setValue(Ld.a.styleName,ya);ja.setValue(Ld.a.UYa,
ya);ja.setValue(Ld.a.ma,n);ja.setValue(Ee.a.highlight,Yk.a.auto);ja.setValue(Ld.a.ku,Yk.a.auto);ja.setValue(hb.a.Hd,!0);ja.setValue(hb.a.ne,!0);ja.setValue(hb.a.pa,zl.StyleReader.wordStyleIdNormal);ja.Vf(hb.a.eE);e=[];e.push(ja);Gi.a.gSc(e,C)}finally{S.dispose()}return new Qo(this.zC,ja,this.ew)}deleteBookmark(e){(e=this.Ep.mAa(e))&&this.Ep.EBj(e.id)}getAnnotationById(e){jh.a.Tsi||pc.a.Kj();return e?(e=this.Cv.qsi(e))&&e.content.addInId===this.context.Ek.Rn?new Yt(e,this._context,this.JHa,this.nk):
null:null}getAnnotationsByType(e){this._context.Cn.CF();this._context.Cn.Dv();let n;this.VJe.tb(e)?n=this.VJe.K(e):(n=this.unk.create(e,this._context),this.VJe.add(e,n));return n.refresh().then(()=>OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n))}getBookmarkRange(e){(e=this.getBookmarkRangeOrNullObject(e))||pc.a.Wk();return e}getBookmarkRangeOrNullObject(e){const n=this.Ep.jDi(e);if(!n||n&&0==n.count)return null;const C=new fb.a;e=this.Ep.mAa(e);var S=this.Ep.nAa(e,!0);var ja=n.K(0);
if(1==n.count){var ya=this.Ep.nAa(e,!1);ya=ya.qea.Ib.cp;S=S.qea.Ib.cp;ja=this.hb.textLength(ja)===ya-S?ce.a.create(ja):ce.a.createTextRange(ja,S,ya)}else ya=S.qea.Ib.cp,ja=0===ya?ce.a.create(ja):ce.a.createTextRange(ja,ya,this.hb.textLength(ja));C.add(ja);for(ja=1;ja<n.count;ja++)ja!=n.count-1?C.add(ce.a.create(n.K(ja))):ja==n.count-1&&(ya=this.Ep.nAa(e,!1))&&(S=n.K(ja),ya=ya.qea.Ib.cp,ya=this.hb.textLength(S)===ya?ce.a.create(S):ce.a.createTextRange(n.K(ja),0,ya),C.add(ya));return this.nk.create(C,
this._context)}getContentControls(e){var n;e=null!==(n=null===e||void 0===e?void 0:e.types)&&void 0!==n?n:[];pc.a.q_c(e);n=this.sh.Ehm(this._context);return 0===e.length?n:null===n||void 0===n?void 0:n.getByTypes(e)}getEndnoteBody(){pc.a.p1c()||pc.a.Kj();return this.qQ.create(this.lyi(0),this._context)}getFootnoteBody(){pc.a.p1c()||pc.a.Kj();return this.qQ.create(this.lyi(1),this._context)}getMetadata(){pc.a.Kj();return null}getNeighborhoodTextAroundSelection(){pc.a.Kj();return null}uKm(){var e=this.ib.gb.currentSelection;
if(!e)return"NoSelection";e=e.toArray();for(let n=0;n<e.length;n++){const C=e[n];if(C.contextId===Ma.a.L$&&19===C.node.type)return"TextBoxSelection"}return"ValidSelection"}getSelection(){var e=this.ib.gb.currentSelection;e||pc.a.hg();e=e.toArray();const n=new fb.a;for(let C=0;C<e.length;C++){const S=e[C];S.contextId===Ma.a.L$&&19===S.node.type&&pc.a.sC();n.add(S)}return this.nk.create(n,this._context)}insertFileFromBase64(e,n,C){"<"===e.charAt(0)&&(E.ULS.sendTraceTag(509110469,369,10,"invalid argument for insertFileFromBase64 API in Document class.",
this._context.appId),pc.a.td());null===C&&(C=new Zn);return this.kan(e,n,C)}getStyles(){pc.a.EYj()||pc.a.Kj();return new Sr(this.zC,this.hy.ro(),this.ew)}launchTapPane(){pc.a.Kj()}save(){this._context.Cn.CF();this.ga.Gho(pe.a.$Zb,this.Bal)}close(){}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.hb.NA(this.Vu.value,!0,!0,!0);this.vB.find(S,e,n,C,this._context)})}getParagraphByUniqueLocalId(e){pc.a.gig||pc.a.Kj();(e=this.Agd.jCm(e))||pc.a.Wk();const n=this.hb.Kv(this.Vu.value,
!0,!0,!0);let C=null;for(const S of n)if(S.id.toString()==e){C=this.hig.create(S,this._context);break}C||pc.a.Wk();return C}setMetadata(){pc.a.Kj()}setMetadataOnTile(){pc.a.Kj()}setNavigationPaneVisibility(e){this.ga.Ob(e?ha.a.Oxc:ha.a.JVc,2)}_GetObjectByReferenceId(e){return yp.a.instance.L2d(e)}_GetObjectTypeNameByReferenceId(e){return yp.a.instance.L2d(e).getTypeName()}_KeepReference(){}_OnAccess(){}_RegisterEvent(e,n){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
e,n)}_RemoveAllReferences(){yp.a.instance.jsl()}_RemoveReference(e){yp.a.instance.Nzo(e)}_Search2(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.hb.NA(this.Vu.value,!0,!0,!0);this.vB.Ipb(S,e,n,C,this._context)})}_UnregisterEvent(e,n){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,e,n)}getTypeName(){return"Microsoft.WordServices.Document"}invokePropertyGet(e){switch(e){case 9:return this.allowCloseOnUntitled;case 3:return this.body;
case 10:return this.changeTrackingMode;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 9:this.allowCloseOnUntitled=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 10:this.changeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1028:return this.Eef(n);case 1011:return this.mvf(n);case 1031:return this.$hm(n);
case 1010:return this.nGf(n);case 1012:return this.oGf(n);case 1026:return this.YJa(n);case 1013:return this.HKf(n);case 1017:return this.iBm(n);case 1006:return this.zKm();case 1029:return this.lNf();case 1016:return this.kzn(n);case 1005:return this.lvg(n);case 1027:return this.bul(n);case 1014:return this.Cyg(n);case 1015:return this.iXo(n);case 1021:return this.qXo(n);case 1001:return this.Glk(n);case 1002:return this.Hlk(n);case 1008:return this.jh();case 1007:return this.kh();case 1018:return this.Jlk(n);
case 1004:return this.Olk();case 1003:return this.Plk(n);case 1019:return this.Tlk(n);case 1033:return this.yEm(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1020:return this.gim(n);case 1022:return this.Vua(n);case 1023:return this.moa(n);case 1025:return this.wrm();case 1024:return this.Ntm();case 1030:return this.Osa(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Eef(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.addStyle(n,e)}mvf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.deleteBookmark(e);return null}$hm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getAnnotationById(e)}kan(e,n,C){const S=(new Date).getTime();let ja=new fb.a;const ya=this.AG.qU(this.Vu.value);switch(n){case 2:var kb=
this.hb.Zm(ya);ja.add(ce.a.create(kb));break;case 3:kb=this.hb.GF(ya);ja.add(ce.a.create(kb));break;case 4:ja=this.hb.NA(ya,!0,!1);break;default:E.ULS.sendTraceTag(509110468,369,15,`AppId:${this._context.appId}, invalid insert location for document's insert Docx method`,this._context.appId),pc.a.td()}return OfficeExtension.WacRuntime.Utility.createPromise((Rb,sc)=>{this.px.insertOoxml(ja,e,n,ya,this._context,Rb,sc,S,1,0,!1,null,C)})}gim(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.getAnnotationsByType(e)}nGf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRange(e)}oGf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRangeOrNullObject(e)}YJa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,wo);return this.getContentControls(e)}wrm(){return this.getEndnoteBody()}Ntm(){return this.getFootnoteBody()}HKf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.getMetadata(e)}iBm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.getNeighborhoodTextAroundSelection(e)}zKm(){return this.getSelection()}Osa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,Zn);return this.insertFileFromBase64(n,C,e)}lNf(){return this.getStyles()}kzn(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.launchTapPane(e);return null}lvg(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");this.save(n,e);return null}bul(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.close(e);return null}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,e)}Cyg(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");this.setMetadata(n,e);return null}iXo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"any");this.setMetadataOnTile(n,C,e);return null}qXo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");this.setNavigationPaneVisibility(e);return null}Glk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this._GetObjectByReferenceId(e)}Hlk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this._GetObjectTypeNameByReferenceId(e)}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}Jlk(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this._RegisterEvent(n,e);return null}Olk(){this._RemoveAllReferences();return null}Plk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this._RemoveReference(e);return null}Tlk(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");this._UnregisterEvent(n,e);return null}yEm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getParagraphByUniqueLocalId(e)}lyi(e){const n=this.AG.qU(this.Vu.value);(e=this.hPb.Z2c(n,e))||pc.a.Wk();return e}}Object(F.a)(IE,"Document",null,[]);class PG{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk,al,Cj,Lg,mq,uk){this.nv=e;this.context=n;this.Qdl=C;this.cOo=S;this.ujd=ja;this.Pb=ya;this.lb=kb;this.IYa=Rb;this.qg=
sc;this.bdc=Fc;this.fP=gd;this.Jqf=td;this.Kgc=Bd;this.Y5k=wd;this.nem=te;this.Og=Le;this.MNo=Oe;this.j7l=We;this.Nnp=Xf;this.h7a=Gg;this.lNl=Ph;this.Yo=Aj;this.Z0o=Ih;this.uzb=Nm;this.p4=Sk;this.Sbm=hk;this.hPb=al;this.hig=Cj;this.Agd=Lg;this.Cv=mq;this.JHa=uk}create(){return new IE(this.nv,this.context,this.Qdl,this.cOo,this.ujd,this.Pb,this.lb,this.IYa,this.qg,this.bdc,this.fP,this.Jqf,this.Kgc,this.Y5k,this.nem,this.Og,this.MNo,this.j7l,this.Nnp,this.h7a,this.lNl,this.Yo,this.Z0o,this.uzb,this.p4,
this.Sbm,this.hPb,this.hig,this.Agd,this.Cv,this.JHa)}}Object(F.a)(PG,"DocumentFactory",null,[]);class AJ{constructor(e,n){this.EFh=this.bQc=null;this.I8e=e;this.Rc=n;this.dJ()}get WI(){return this.EFh}dJ(){const e=this.I8e.getValue(hb.a.hci);this.bQc!==e&&(this.bQc=e,this.EFh=Bf.b(this.bQc))}wdb(){const e=this.Rc.Lc(4);e.Ab(this.I8e);this.bQc=Bf.c(this.WI);this.I8e.setValue(hb.a.hci,this.bQc);e.dispose()}}Object(F.a)(AJ,"StandardPropertyDocument",null,[1204]);class zp extends Oh{constructor(e,n){super(e,
n)}KEi(){return this.selectNodes("//ns0:property",null).length}JEi(e){const n=this.selectNodes("//ns0:property",null);for(const C of n)if(this.getKey(C).toLowerCase()===e.toLowerCase())return C;return null}sHm(e){const n=this.selectNodes("//ns0:property",null);return 0<=e&&e<n.length?n[e]:null}eZk(e,n){if(void 0!==e&&null!==e&&void 0!==n&&null!==n){const C=this.selectSingleNode("//ns0:Properties",null);if((e=this.tHm(e,n))&&this.appendChild(C,e))return this.fHo(),!0}return!1}dQl(){if(this.KEi()){for(var e=
this.selectSingleNode("//ns0:Properties",null);e.hasChildNodes();)e.removeChild(e.firstChild);this.save()}}getKey(e){if(void 0===e||null===e)return null;e=this.selectSingleNode("@name",e);return void 0!==e&&null!==e?this.getNodeText(e):null}hxe(e,n){if(void 0===e||null===e||void 0===n||null===n)return!1;e=this.selectSingleNode("@name",e);return void 0!==e&&null!==e?this.setNodeText(e,n):!1}getType(e){return void 0!==e&&null!==e?this.getNodeBaseName(e.firstChild):null}getValue(e){return void 0!==e&&
null!==e?this.getNodeText(e.firstChild):null}setValue(e,n){return void 0!==e&&null!==e&&void 0!==n&&null!==n?(n=this.dJi(n),!!n&&!!this.setNodeXml(e.firstChild,n)):!1}aRl(e){void 0!==e&&null!==e&&void 0!==e.parentNode&&null!==e.parentNode&&(e.parentNode.removeChild(e),this.save())}tHm(e,n){return(n=this.dJi(n))?'<property xmlns="'+zp.cZd+'" fmtid="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}" pid="2" name="'+Of.a.yf(e)+'">'+n+"</property>":null}dJi(e){var n=Object.getType(e);let C=null;n===Number?C=parseInt(String(e))===
e?zp.L$j:zp.K$j:n===String?(n=RegExp("[0-9]{4}(-[0-9]{2}){2}T[0-9]{2}(:[0-9]{2}){2}\\.[0-9]{3}Z","g").exec(e),C=void 0!==n&&null!==n&&0<n.length&&n[0]===e?zp.J$j:zp.M$j,e=Of.a.yf(e)):n===Boolean&&(C=zp.I$j);return C?"<vt:"+C+' xmlns:vt="'+zp.pEp+'">'+e+"</vt:"+C+">":null}fHo(){const e=this.selectNodes("//@pid",null);for(let n=0;n<e.length;n++)this.setNodeText(e[n],(n+2).toString())}selectSingleNode(e,n){e=this.selectNodes(e,n);return void 0!==e&&null!==e&&0<e.length?e[0]:null}}zp.cZd="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";
zp.pEp="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes";zp.L$j="i4";zp.K$j="r8";zp.M$j="lpwstr";zp.I$j="bool";zp.J$j="filetime";Object(F.a)(zp,"CustomPropertyDocument",Oh,[1223,1091]);class Ru extends Hh.a{constructor(e,n,C,S){super();this._context=e;this.uQ=C;this.wl=n;this.O1a=S}get key(){return this.uQ.getKey(this.O1a)}get type(){let e=0;switch(this.uQ.getType(this.O1a)){case zp.L$j:case zp.K$j:e=1;break;case zp.M$j:e=0;break;case zp.I$j:e=3;break;case zp.J$j:e=2}return e}get value(){const e=
this.uQ.getValue(this.O1a);return 1===this.type?Number.parseInvariant(e):3===this.type?Boolean.parse(e):2===this.type?new Date(e):e}set value(e){this.uQ.setValue(this.O1a,e)||pc.a.td()}get _Id(){return this.key}get _ReferenceId(){return this.Hp?this.Vp:null}deleteObject(){this.uQ.aRl(this.O1a);this.O1a=null}_KeepReference(){this.xp()}_OnAccess(){this._context.Cn.sec(this.wl.Gka.currentNode);this.O1a||pc.a.Wk();if(!this.uQ.VYf()){this.uQ.kLg();const e=this.uQ.JEi(this.key);e?this.O1a=e:pc.a.Wk()}}getTypeName(){return"Microsoft.WordServices.CustomProperty"}invokePropertyGet(e){switch(e){case 2:return this.key;
case 4:return this.type;case 3:return this.value;case 5:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.VC(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}VGo(e){this.uQ.hxe(this.O1a,
e)}}Object(F.a)(Ru,"CustomProperty",Hh.a,[901]);class BJ extends Hh.a{constructor(e,n,C,S){super();this._context=e;this.wl=n;this.NFc=S;this.Rc=C;e=this.wl.w5d(zp.cZd,!0);e=0<e.length?e[0]:this.$Hl();this.uQ=new zp(e,this.Rc)}length(){return this.getCount()}_GetItem(e){e=pc.a.QN(e);if(e=this.uQ.sHm(e))return new Ru(this._context,this.wl,this.uQ,e);E.ULS.sendTraceTag(21016673,369,10,"The index is out of the CustomPropertyCollection range.");pc.a.td();return null}get _ReferenceId(){return this.Hp?this.Vp:
null}add(e,n){void 0!==e&&null!==e&&void 0!==n&&null!==n||pc.a.td();var C=this.uQ.cR;if(!C.isConnected){const S=this.wl.Gka,ja=C.getValue(hb.a.rNb);S.d6(C,24,Wc.a.Bf(ja+"{1}"))}(C=this.getItemOrNullObject(e))?(C.key!==e&&C.VGo(e),C.value=n):this.uQ.eZk(e,n)?C=this.getItemOrNullObject(e):pc.a.td();return C}deleteAll(){this.uQ.dQl()}getCount(){return this.uQ.KEi()}getItem(e){(e=this.getItemOrNullObject(e))||pc.a.Wk();return e}getItemOrNullObject(e){return(e=this.uQ.JEi(e))?new Ru(this._context,this.wl,
this.uQ,e):null}_KeepReference(){this.xp()}_OnAccess(){this._context.Cn.sec(this.wl.Gka.currentNode);if(!this.uQ.cR.isConnected){const e=this.wl.w5d(zp.cZd,!0);0<e.length&&(this.uQ=new zp(e[0],this.Rc))}this.uQ.VYf()||this.uQ.kLg()}getAsyncEnumerator(e,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.CustomPropertyCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.nSc(n);case 1005:return this.jvf();case 1004:return this.K8a();case 1:return this.y_(n);case 1006:return this.d9a(n);
case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nSc(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");return this.add(n,e)}jvf(){this.deleteAll();return null}K8a(){return this.getCount()}y_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.getItem(e)}d9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}$Hl(){const e=this.NFc.create(cj.a.cR),n=new Wc.a(Tj.a.create(),1);e.setValue(hb.a.rNb,"{"+Mf.e(n.Gt.toString())+"}");e.setValue(hb.a.i7a,'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"></Properties>');
e.setValue(hb.a.dZd,zp.cZd);e.setValue(hb.a.Wfc,!0);return e}}Object(F.a)(BJ,"CustomPropertyCollection",Hh.a,[901,931]);class $x extends Hh.a{constructor(e,n,C,S,ja){super();this.xM=this.Pt=null;this._context=e;this.wl=n;this.Rc=C;this.NFc=S;this.aBk=ja}get applicationName(){this.xM.dJ();return this.xM.WI.application}get author(){this.Pt.dJ();return this.Pt.WI.Creator}set author(e){this.Pt.dJ();this.Pt.WI.Creator=e;this.Pt.wdb()}get category(){this.Pt.dJ();return this.Pt.WI.Category}set category(e){this.Pt.dJ();
this.Pt.WI.Category=e;this.Pt.wdb()}get comments(){this.Pt.dJ();return this.Pt.WI.Description}set comments(e){this.Pt.dJ();this.Pt.WI.Description=e;this.Pt.wdb()}get company(){this.xM.dJ();return this.xM.WI.company}set company(e){this.xM.dJ();this.xM.WI.company=e;this.xM.wdb()}get creationDate(){this.Pt.dJ();const e=this.Pt.WI.CreatedDate;return void 0!==e&&null!==e?new Date(e):null}get customProperties(){return new BJ(this._context,this.wl,this.Rc,this.NFc)}get format(){this.xM.dJ();return this.xM.WI.format}set format(e){this.xM.dJ();
this.xM.WI.format=e;this.xM.wdb()}get keywords(){this.Pt.dJ();return this.Pt.WI.Keywords}set keywords(e){this.Pt.dJ();this.Pt.WI.Keywords=e;this.Pt.wdb()}get lastAuthor(){this.Pt.dJ();return this.Pt.WI.LastModifiedBy}get lastPrintDate(){this.Pt.dJ();const e=this.Pt.WI.LastPrinted;return void 0!==e&&null!==e?new Date(e):null}get lastSaveTime(){this.Pt.dJ();const e=this.Pt.WI.Modified;return void 0!==e&&null!==e?new Date(e):null}get manager(){this.xM.dJ();return this.xM.WI.manager}set manager(e){this.xM.dJ();
this.xM.WI.manager=e;this.xM.wdb()}get revisionNumber(){this.Pt.dJ();return this.Pt.WI.Revision}get security(){this.xM.dJ();return this.xM.WI.docSecurity}get subject(){this.Pt.dJ();return this.Pt.WI.Subject}set subject(e){this.Pt.dJ();this.Pt.WI.Subject=e;this.Pt.wdb()}get template(){this.xM.dJ();return this.xM.WI.template}get title(){this.Pt.dJ();return this.Pt.WI.Title}set title(e){this.Pt.dJ();this.Pt.WI.Title=e;this.Pt.wdb()}get _ReferenceId(){return this.Hp?this.Vp:null}_KeepReference(){this.xp()}_OnAccess(){this.aBk||
pc.a.Kj();this._context.Cn.sec(this.wl.Gka.currentNode);this.loadDocumentProperty()}getTypeName(){return"Microsoft.WordServices.DocumentProperties"}invokePropertyGet(e){switch(e){case 11:return this.applicationName;case 5:return this.author;case 20:return this.category;case 7:return this.comments;case 23:return this.company;case 13:return this.creationDate;case 2:return this.customProperties;case 21:return this.format;case 6:return this.keywords;case 9:return this.lastAuthor;case 12:return this.lastPrintDate;
case 14:return this.lastSaveTime;case 22:return this.manager;case 10:return this.revisionNumber;case 19:return this.security;case 4:return this.subject;case 8:return this.template;case 3:return this.title;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 5:this.author=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 20:this.category=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.comments=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 23:this.company=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 21:this.format=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 6:this.keywords=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,
"string");return;case 22:this.manager=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.subject=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.jh();
case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}loadDocumentProperty(){if(void 0===this.Pt||null===this.Pt)this.Pt=this.SGi($x.MCl);if(void 0===this.xM||null===this.xM)this.xM=this.SGi($x.V4l)}SGi(e){e=this.wl.w5d(e,!0);return new AJ(e[0],this.Rc)}}$x.MCl="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";
$x.V4l="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";Object(F.a)($x,"DocumentProperties",Hh.a,[901]);var dh;(function(e){e[e.left=0]="left";e[e.right=1]="right";e[e.firstLine=2]="firstLine"})(dh||(dh={}));Object(F.b)("ExtensionParagraphIndent",dh);var Is;(function(e){e[e.lineSpacing=0]="lineSpacing";e[e.before=1]="before";e[e.after=2]="after";e[e.Z7p=3]="lineBefore";e[e.Y7p=4]="lineAfter"})(Is||(Is={}));Object(F.b)("ExtensionParagraphSpacing",Is);class rB extends Hh.a{constructor(e){super();
this.annotations=e;pc.a.Tx(e,"AnnotationCollection")}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){jh.a.FD||pc.a.Kj();return this.annotations&&0<this.annotations.length?this.annotations[0]:null}_GetItem(e){jh.a.FD||pc.a.Kj();e=pc.a.QN(e);if(0<=e&&e<this.length())return this.annotations[e];pc.a.td()}_KeepReference(){this.xp()}_OnAccess(){}length(){return jh.a.FD?this.annotations.length:null}getAsyncEnumerator(e,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return jh.a.FD?"Microsoft.WordServices.AnnotationCollection":"Microsoft.WordServices.AddInCritiqueAnnotationCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(rB,"AnnotationCollection",Hh.a,[901,931]);class Ry extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk){super();this.uPa=hk;pc.a.bPa(e,"Paragraph");this.Od=e;this._context=n;this._id=C;this.zC=S;this.iO=ja;this.zo=ya;this.nk=kb;this.TZe=Rb;this.hb=sc;this.xv=Fc;this.LK=gd;this.Lq=
td;this.xB=Bd;this.Yc=wd;this.ay=te;this.sh=Le;this.vB=Oe;this.px=We;this.Hl=Xf;this.ld=Gg;this.Xn=Ph;this.Ot=Aj;this.wx=Ih;this.Xx=Nm;this.I2e=Sk}get alignment(){switch(this.hb.Xy(this.Od)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(e){let n=0;switch(e){case 0:n=1;break;case 2:n=3;break;case 1:n=2;break;case 3:n=6;break;default:E.ULS.sendTraceTag(16871628,369,15,"AppId:{0}, set Paragraph.Alignment with not supported value: {1}.",
this._context.appId,e),pc.a.td()}this.xv.wH(this.Od,n)}get contentControls(){const e=new wo;e.types=[31];return this.getContentControls(e)}get fields(){return new Wt(this.Xx.Ejc(this.Od,this._context,!1))}get endnotes(){var e=this.Yc.$If(this.Od,1);e=this.Yc.sza(e,this._context);return new Qu(e)}get firstLineIndent(){return this.vLf(2)}set firstLineIndent(e){const n=this.xv.fr;e=oi.a.fK(e);0<=e?n.jha(this.Od,e):n.myb(this.Od,0-e)}get font(){return this.zC.create(3,this.Od,null,null,this._context)}get footnotes(){var e=
this.Yc.$If(this.Od,0);e=this.Yc.sza(e,this._context);return new Qu(e)}get inlinePictures(){const e=new fb.a,n=new fb.a;let C=0;this.ay.KJf(n,this.Od);for(const S of n)e.add(this.iO.create(S,this._context,C++));return new Hs(e)}get isLastParagraph(){if(!pc.a.ej())return!1;var e=this.ld.G7d(this.Od);return e?(e=this.hb.GF(e))?e.id.equals(this.Od.id)?!0:!1:!1:!1}get isListItem(){return pc.a.ej()?this.hb.DX(this.Od):!1}get leftIndent(){return this.vLf(0)}set leftIndent(e){this.xv.fr.KNa(this.Od,1,oi.a.fK(e))}get lineSpacing(){return this.b4c(0)}set lineSpacing(e){pc.a.D0a(e,
"Paragraph.LineSpacing");this.xv.UE(this.Od,new Ho.a(2,e/12))}get lineUnitAfter(){return this.b4c(4)}set lineUnitAfter(e){pc.a.C0a(e,"Paragraph.LineUnitAfter");this.xv.eyb(this.Od,new Ho.a(2,e))}get lineUnitBefore(){return this.b4c(3)}set lineUnitBefore(e){pc.a.C0a(e,"Paragraph.LineUnitBefore");this.xv.fyb(this.Od,new Ho.a(2,e))}get list(){if(!pc.a.ej())return null;const e=this.listOrNullObject;e||pc.a.Wk();return e}get listItem(){if(!pc.a.ej())return null;const e=this.listItemOrNullObject;e||pc.a.Wk();
return e}get listItemOrNullObject(){if(!pc.a.ej())return null;let e;if(uj.ListItemReader.De){if(!uj.ListItemReader.isListItem(this.Od))return null;e=Af.ParagraphReader.ukc(this.Od)}else if(!({nXb:e}=this.Xn.f$c(this.Od)).returnValue)return null;return this.TZe.create(e,this._context)}get listOrNullObject(){if(!pc.a.ej())return null;var e=new fb.a;e.add(ce.a.create(this.Od));e=this.Xn.Bsi(e,this._context);return e.count?e.K(0):null}get outlineLevel(){return this.hb.zAa(this.Od)+1}set outlineLevel(e){if(1>
e||10<e)E.ULS.sendTraceTag(19674595,369,10,"Set OutlineLevel with not supported value: {0}.",e),pc.a.td();this.xv.QXo(this.Od,e-1)}get parentBody(){return pc.a.ej()?this.ld.BLf(this.Od,this._context):null}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||pc.a.Wk();return e}get parentContentControlOrNullObject(){const e=ce.a.create(this.Od);this.Yc.QOa(e,e);return this.sh.Skc(e,e,this._context)}get parentTable(){if(!pc.a.ej())return null;const e=this.parentTableOrNullObject;
e||pc.a.Wk();return e}get parentTableCell(){if(!pc.a.ej())return null;const e=this.parentTableCellOrNullObject;e||pc.a.Wk();return e}get parentTableCellOrNullObject(){return pc.a.ej()?this.ld.vkc(this.Od,this._context):null}get parentTableOrNullObject(){return pc.a.ej()?this.ld.drb(this.Od,this._context):null}get rightIndent(){return this.vLf(1)}set rightIndent(e){this.xv.fr.oyb(this.Od,1,oi.a.fK(e))}get spaceAfter(){return this.b4c(2)}set spaceAfter(e){pc.a.C0a(e,"Paragraph.SpaceAfter");this.xv.eyb(this.Od,
new Ho.a(4,e))}get spaceBefore(){return this.b4c(1)}set spaceBefore(e){pc.a.C0a(e,"Paragraph.SpaceBefore");this.xv.fyb(this.Od,new Ho.a(4,e))}get style(){let e;return this.xB.c3c((e=new fb.a,e.add(ce.a.create(this.Od)),e))}set style(e){let n;this.xB.Qwc((n=new fb.a,n.add(ce.a.create(this.Od)),n),e)}get styleBuiltIn(){if(!pc.a.ej())return-1;let e;return this.xB.h6d((e=new fb.a,e.add(ce.a.create(this.Od)),e))}set styleBuiltIn(e){pc.a.ej()||pc.a.Kj();let n;this.xB.Ywe((n=new fb.a,n.add(ce.a.create(this.Od)),
n),e)}get tableNestingLevel(){return pc.a.ej()?this.ld.CHi(this.Od):0}get text(){return this.hb.AXb(this.Od)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}get uniqueLocalId(){return pc.a.gig?this.I2e.rDi(this.Od.id.toString()):null}attachToList(e,n){pc.a.ej()||pc.a.Kj();return this.Xn.attachToList(this.Od,e,n,this._context)}clear(){const e=ce.a.create(this.Od);this.m6j(e);let n;this.Yc.WLb((n=new fb.a,n.add(e),n))}deleteParagraph(){const e=ce.a.create(this.Od);this.m6j(e);
let n;this.Yc.jgc((n=new fb.a,n.add(e),n))}detachFromList(){pc.a.ej()||pc.a.Kj();this.Xn.detachFromList(this.Od)}getAnnotations(){jh.a.FD||pc.a.Kj();const e=this.uPa.Fgm(this.Od);return new rB(e.map(n=>new Yt(n,this._context,this.uPa,this.nk)))}getComments(){const e=new fb.a;e.add(ce.a.create(this.Od));return this.Ot.b5d(e,this._context)}getContentControls(e){var n;e=null!==(n=null===e||void 0===e?void 0:e.types)&&void 0!==n?n:[];pc.a.q_c(e);n=ce.a.create(this.Od);n=this.sh.sNf(n,n,this._context);
return 0===e.length?n:null===n||void 0===n?void 0:n.getByTypes(e)}getHtml(){const e=[ce.a.create(this.Od)];return this.px.getHtml(e,this._context)}getMetadata(){pc.a.Kj();return null}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){pc.a.ej()||pc.a.Kj();const e=this.hb.pg(this.Od,!1,!0);return e?this.zo.create(e,this._context):null}getOoxml(){const e=(new Date).getTime();this._context.Cn.CF();return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{const S=
new fb.a;S.add(ce.a.create(this.Od));this.px.getOoxml(S,this._context,n,C,e)})}getPrevious(){const e=this.getPreviousOrNullObject();e||pc.a.Wk();return e}getPreviousOrNullObject(){pc.a.ej()||pc.a.Kj();const e=this.hb.pg(this.Od,!0,!0);return e?this.zo.create(e,this._context):null}getRange(e){pc.a.ej()||pc.a.Kj();1!==e&&2!==e&&e&&5!==e&&4!==e&&(E.ULS.sendTraceTag(18745294,369,15,"AppId:{0}, rangeLocation of Paragraph.GetRange must be Start/End/Whole/Content/After.",this._context.appId),pc.a.td());
const n=new fb.a;n.add(ce.a.create(this.Od));this.Hl.Gwe(n);return(e=this.Hl.DPb(n,e))?this.nk.create(e,this._context):null}getSubrange(e,n){pc.a.ej()||pc.a.Kj();(0>e||e+n>this.hb.textLength(this.Od)||0>n)&&pc.a.td();e=n?ce.a.createTextRange(this.Od,e,e+n):ce.a.Uc(this.Od,e);let C;return this.nk.create((C=new fb.a,C.add(e),C),this._context,0)}getText(e){var n,C;pc.a.rOm||pc.a.Kj();const S=null!==(n=null===e||void 0===e?void 0:e.includeTextMarkedAsDeleted)&&void 0!==n?n:!1;e=null!==(C=null===e||void 0===
e?void 0:e.includeHiddenText)&&void 0!==C?C:!1;C=0;S||(C|=1);e||(C|=8);return this.hb.Kjg(this.Od,C)}getTextRanges(e,n){pc.a.ej()||pc.a.Kj();var C=new fb.a;C.add(ce.a.create(this.Od));this.Hl.Gwe(C);e=this.Hl.QNf(C,e,n);n=new fb.a;for(C=0;C<e.length;C++)n.add(this.nk.create(e[C],this._context,C));return new gx(n)}getTrackedChanges(){return new kv(3,this.Od,null,null,this._context,this.wx,this.hb,this.Hl)}getReviewedText(e){return this.wx.l8d(this.Od,e)}insertAnnotations(e){jh.a.FD||pc.a.Kj();return this.uPa.I$m(e.critiques,
this.Od,this._context)}insertBreak(e,n){n&&1!==n&&(E.ULS.sendTraceTag(17179038,369,15,"AppId:{0}, insertLocation of Paragraph.InsertBreak must be Before or After.",this._context.appId),pc.a.td());const C=(new Date).getTime(),S=new fb.a;S.add(ce.a.create(this.Od));if(6===e)this.Yc.QOa(S.K(0),S.K(0));else{const ja=this.Yc.$6a(this.Od,!n);S.W(0,ja)}return OfficeExtension.WacRuntime.Utility.createPromise((ja,ya)=>{this.Yc.insertBreak(S,e,n,this._context,ja,ya,C)})}insertContentControl(e){pc.a.$zf(e,"Paragraph");
e=pc.a.vrd(e,0);8!==e||pc.a.dia||pc.a.td();const n=this.Yc.qfc(this.Od,!0),C=this.Yc.qfc(this.Od,!1);return this.sh.sqa(n,C,this._context,e)}insertFileFromBase64(e,n){"<"===e.charAt(0)&&(E.ULS.sendTraceTag(18130840,369,10,"invalid argument for insertFileFromeBase64 API in Paragraph class.",this._context.appId),pc.a.td());return this.Nla(e,n,!1)}insertHtml(e,n){const C=(new Date).getTime();if(2===n||3===n||4===n){const S=new fb.a,ja=ce.a.XT(0,this.hb.textLength(this.Od),!1,this.Od);S.add(ja);return this.px.insertHtml(S,
e,n,C,this._context)}pc.a.td();return null}insertInlinePictureFromBase64(e,n){return this.L7c(e,n)}insertOoxml(e,n){"<"!==e.charAt(0)&&(E.ULS.sendTraceTag(18130841,369,10,"invalid argument for InsertOoxml API in Paragraph class.",this._context.appId),pc.a.td());return this.Nla(e,n,!0)}insertParagraph(e,n){let C=null;switch(n){case 0:C=this.Yc.$6a(this.Od,!0);break;case 1:C=this.Yc.$6a(this.Od,!1);break;default:E.ULS.sendTraceTag(21070050,369,15,"AppId:{0}, Invalid insert location for Paragraph.InsertParagraph method.",
this._context.appId),pc.a.td()}let S;return this.zo.create(this.Yc.insertParagraph((S=new fb.a,S.add(C),S),e,n),this._context)}insertTable(e,n,C,S){pc.a.ej()||pc.a.Kj();const ja=this.Yc.$6a(this.Od,!C);let ya;return this.ld.insertTable((ya=new fb.a,ya.add(ja),ya),e,n,C,S,this._context)}insertText(e,n){2!==n&&3!==n&&4!==n&&(E.ULS.sendTraceTag(21284492,369,15,"AppId:{0}, invalid location for Paragraph.InsertText: {1}.",this._context.appId,bt.a[n]),pc.a.td());const C=ce.a.create(this.Od);this.Yc.QOa(C,
C);let S;return this.nk.create(this.Yc.insertText((S=new fb.a,S.add(C),S),e,n),this._context)}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=new fb.a;S.add(ce.a.create(this.Od));this.vB.find(S,e,n,C,this._context)})}_Search2(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=new fb.a;S.add(ce.a.create(this.Od));this.vB.Ipb(S,e,n,C,this._context)})}select(e){const n=new fb.a;n.add(ce.a.create(this.Od));this.Lq.select(n,e)}setMetadata(){pc.a.Kj()}split(e,
n,C){pc.a.ej()||pc.a.Kj();const S=new fb.a;S.add(ce.a.create(this.Od));this.Hl.Gwe(S);e=this.Hl.kyc(S,e,!1,n,C);n=new fb.a;for(C=0;C<e.length;C++)n.add(this.nk.create(e[C],this._context,C));return new gx(n)}startNewList(){pc.a.ej()||pc.a.Kj();return this.Xn.startNewList(this.Od,this._context)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.Od,"Paragraph")}getTypeName(){return"Microsoft.WordServices.Paragraph"}invokePropertyGet(e){switch(e){case 7:return this.alignment;case 5:return this.contentControls;
case 36:return this.endnotes;case 8:return this.firstLineIndent;case 37:return this.fields;case 3:return this.font;case 35:return this.footnotes;case 17:return this.inlinePictures;case 28:return this.isLastParagraph;case 19:return this.isListItem;case 9:return this.leftIndent;case 11:return this.lineSpacing;case 16:return this.lineUnitAfter;case 15:return this.lineUnitBefore;case 24:return this.list;case 27:return this.listItem;case 34:return this.listItemOrNullObject;case 33:return this.listOrNullObject;
case 12:return this.outlineLevel;case 23:return this.parentBody;case 6:return this.parentContentControl;case 30:return this.parentContentControlOrNullObject;case 26:return this.parentTable;case 25:return this.parentTableCell;case 31:return this.parentTableCellOrNullObject;case 32:return this.parentTableOrNullObject;case 10:return this.rightIndent;case 14:return this.spaceAfter;case 13:return this.spaceBefore;case 4:return this.style;case 29:return this.styleBuiltIn;case 22:return this.tableNestingLevel;
case 18:return this.text;case 1:return this._Id;case 2:return this._ReferenceId;case 38:return this.uniqueLocalId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 7:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 8:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"number");return;case 9:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 11:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 16:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 15:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 12:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return;case 10:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 14:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 13:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 4:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 29:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1022:return this.Oal(n);case 1011:return this.fIa();case 1012:return this.VC(n);case 1023:return this.FSl();case 1036:return this.iim();case 1014:return this.YPb();case 1032:return this.HPb();case 1034:return this.YJa(n);case 1028:return this.HKf(n);case 1024:return this.i7();
case 1026:return this.j7();case 1025:return this.LGm();case 1027:return this.OGm();case 1017:return this.ofa(n);case 1030:return this.CMm(n);case 1020:return this.E4c(n);case 1035:return this.$Qb();case 1033:return this.MQb(n);case 1037:return this.N$m(n);case 1004:return this.RKa(n);case 1009:return this.Qsa(n);case 1019:return this.t$a(n);case 1005:return this.TKa(n);case 1013:return this.gha(n);case 1029:return this.Cyg(n);case 1018:return this.L0b(n);case 1021:return this.Idp();case 1038:return this.yOm(n);
case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1015:return this.xQb();case 1010:return this.j$a(n);case 1008:return this.Osa(n);case 1006:return this.m$a(n);case 1003:return this.n$a(n);case 1007:return this.r$a(n);case 1016:return this.Vua(n);case 1031:return this.moa(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Oal(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.attachToList(n,e)}fIa(){this.clear();return null}VC(){this.deleteParagraph();return null}FSl(){this.detachFromList();return null}iim(){return this.getAnnotations()}HPb(){return this.getComments()}YJa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,wo);return this.getContentControls(e)}YPb(){return this.getHtml()}HKf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
return this.getMetadata(e)}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}xQb(){return this.getOoxml()}LGm(){return this.getPrevious()}OGm(){return this.getPreviousOrNullObject()}ofa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}CMm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.getSubrange(n,e)}E4c(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getTextRanges(n,e)}MQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}$Qb(){return this.getTrackedChanges()}N$m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,$n);return this.insertAnnotations(e)}j$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertBreak(n,e)}RKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.insertContentControl(e)}Osa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(n,e)}m$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");
return this.insertHtml(n,e)}n$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(n,e)}r$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(n,e)}Qsa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(n,e)}t$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(n,C,S,e)}TKa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(n,e)}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");this.select(e);return null}Cyg(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");this.setMetadata(n,e);return null}L0b(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"boolean");return this.split(n,C,e)}Idp(){return this.startNewList()}yOm(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,qp);return this.getText(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}L7c(e,n,C){const S=(new Date).getTime();if(!n||1===n)return E.ULS.sendTraceTag(17433743,369,50,"AppId:{0}, insert inline picture with none supported location in Paragraph class.",this._context.appId),pc.a.td(),null;var ja=null;if(4===n)ja=ce.a.Uc(this.Od,0),this.clear();else{ja=ce.a.create(this.Od);({BL:ja}=this.Yc.dN(ja,ja,n));let ya;this.Yc.FW((ya=
new fb.a,ya.add(ja),ya),n,0)}G.AFrameworkApplication.dv?(this._context.Cn.Dv(this.Od),n=this.ay.lSb(e,ja,this._context,C)):n=this.ay.lSb(e,ja,this._context);return n.then(ya=>{G.AFrameworkApplication.dv||this._context.Cn.Dv(this.Od);if(ya)return pc.a.oP("Paragraph.InsertInlinePictureFromBase64",pc.a.fQ(S),e.length),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.iO.create(this.ay.t0c(ya),this._context));E.ULS.sendTraceTag(17433744,369,10,"AppId:{0}, something went wrong when insert iamge into Paragraph.",
this._context.appId);pc.a.oP("Paragraph.InsertInlinePictureFromBase64",pc.a.fQ(S),e.length,!1);pc.a.hg();return null})}vLf(e){var n=this.hb.o9a(this.Od);if(n&&(n=n.Cu))switch(e){case 2:switch(e=this.KLf(1,n.yha),n.specialIndentType){case 1:return e;case 2:return-e;default:return 0}case 0:return this.KLf(n.qsb,n.RA);case 1:return this.KLf(n.rsb,n.Hfa);default:return 0}E.ULS.sendTraceTag(16832386,369,10,"AppId:{0}, error happened when reading paragraph {1} indent.",this._context.appId,dh[e]);pc.a.hg();
return 0}b4c(e){var n=this.hb.o9a(this.Od);if(n&&(n=n.cQ))switch(e){case 0:return this.LLf(n.lineSpacing.unit,n.lineSpacing.value);case 1:return this.LLf(n.beforeSpacing.unit,n.beforeSpacing.value);case 2:return this.LLf(n.afterSpacing.unit,n.afterSpacing.value);case 3:return this.QAi(n.beforeSpacing.unit,n.beforeSpacing.value);case 4:return this.QAi(n.afterSpacing.unit,n.afterSpacing.value);default:return 0}E.ULS.sendTraceTag(16832387,369,10,"AppId:{0}, error happened when reading paragraph {1} spacing.",
this._context.appId,Is[e]);pc.a.hg();return 0}KLf(e,n){switch(e){case 2:return e=vg.a.RLb(n),oi.a.Wha(e);case 1:return oi.a.Wha(n);default:return 0}}LLf(e,n){switch(e){case 2:return 12*n;case 3:return oi.a.Wha(n);case 4:return n;default:return 0}}QAi(e,n){switch(e){case 4:return n/12;case 3:return oi.a.Wha(n)/12;case 2:return n;default:return 0}}m6j(e){const n=this.hb.wm(this.Od,0),C=this.hb.wm(this.Od,this.hb.textLength(this.Od)),S=this.hb.vy(this.Od),ja=this.hb.Ex(this.Od),ya=C-ja;e.Fb=0<n?S+(S<
ya?ya-S:0):-1;e.Tb=0<C?ja+(S<ya?0:ya-S):-1}Nla(e,n,C){const S=(new Date).getTime(),ja=new fb.a;switch(n){case 2:case 3:case 4:const ya=ce.a.create(this.Od);this.Yc.QOa(ya,ya);ja.add(ya);break;default:return E.ULS.sendTraceTag(18130842,369,15,"AppId:{0}, Paragraph.InsertOoxmlOrDocx: undefined location!",this._context.appId),pc.a.td(),null}return OfficeExtension.WacRuntime.Utility.createPromise((ya,kb)=>{this.px.insertOoxml(ja,e,n,this.Od,this._context,ya,kb,S,C?0:1)})}language(){return this.LK.WJf(this.Od)}psa(){return this.Od}}
Object(F.a)(Ry,"Paragraph",Hh.a,[901]);var SC=d(89),nv=d(102);class Js extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk){super();this.C5=null;this.Kia="_";this.vyk="OLE_LINK";this.cpk=40;pc.a.gBc(e,"Range");this.Ld=e;this._context=n;this._id=C;this.zo=S;this.iO=ja;this.zC=ya;this.nk=kb;this.Smc=Rb;this.hb=sc;this.Lq=Fc;this.xB=gd;this.Yc=td;this.ay=Bd;this.sh=wd;this.vB=te;this.px=Le;this.Hl=Oe;this.iF=We;this.ld=Xf;this.Xn=Gg;this.Ep=Ph;this.Hjb=
Aj;this.Ot=Ih;this.wx=Nm;this.Xx=Sk;this.uPa=hk;this.J6b=-1;this.QAd=this.RAd=null;this._context.upc&&(this.C5=this.Smc.create(e))}get u2d(){return this.J6b}set u2d(e){this.J6b=e}get Fpb(){return this.RAd}set Fpb(e){this.RAd=e}get o2d(){return this.QAd}set o2d(e){this.QAd=e}get Jsb(){return this.C5}get Xo(){return this.Ld}get contentControls(){const e=new wo;e.types=[31];return this.getContentControls(e)}get endnotes(){var e=this.Yc.f6d(this.Ld,1);e=this.Yc.sza(e,this._context);return new Qu(e)}get fields(){const e=
new fb.a;var n=!1;for(let C=0;C<this.Ld.count;C++){const S=this.Ld.K(C);switch(S.contextId){case Ma.a.paragraph:n=this.Xx.Ejc(S.node,this._context,n);e.addRange(n);n=!0;break;case Ma.a.Cd:n=this.Xx.V5d(S.node,S.cpBegin,S.cpEnd,this._context,n);e.addRange(n);n=!0;break;case Ma.a.Zc:break;case Ma.a.Vc:break;default:E.ULS.sendTraceTag(539530914,369,10,"AppId:{0}, the contextId {1} is not supported to get the fields.",this._context.appId,S.contextId),pc.a.hg()}}return new Wt(e)}get font(){return this.zC.create(4,
null,null,this,this._context)}get footnotes(){var e=this.Yc.f6d(this.Ld,0);e=this.Yc.sza(e,this._context);return new Qu(e)}get hyperlink(){if(!pc.a.ej())return null;const e=(pc.a.vpg()?this.Hl.Qqb(this.Ld):this.Qqb()).returnValue;return e&&e.length?e[0].hyperlink.url:null}set hyperlink(e){pc.a.ej()||pc.a.Kj();if(pc.a.vpg())this.Hl.cOj(this.Xo,e,!0,this._context);else{this.i_f()||pc.a.hg();if(this.Ld.K(0).contextId===Ma.a.Vc||this.Ld.K(0).contextId===Ma.a.Zc)E.ULS.sendTraceTag(18989185,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",
this._context.appId),pc.a.hg();var n,C=({Uag:n}=this.Qqb()).returnValue;if(C)for(let S=0;S<C.length;S++)this.iF.fV(C[S].paragraph,C[S].hyperlink);e&&""!==e&&n&&0<n.count&&(this.Hl.YZh(n.K(0))?(C=!1,0===e.indexOf("#")&&(e=e.substr(1),C=!0),this.iF.wF(n.K(0),e,!1,!1,!1,C)):pc.a.sC())}}get inlinePictures(){const e=new fb.a;let n=0;for(const C of this.Ld){const S=new fb.a;this.ay.B6d(S,C);for(const ja of S)e.add(this.iO.create(ja,this._context,n++))}return new Hs(e)}get isEmpty(){return this.Hl.eTb(this.Ld)}get lists(){return pc.a.ej()?
new Tz(4,null,null,this,this._context,this.Xn,null):null}get paragraphs(){let e=0;const n=new fb.a,C=new Fv.a;for(const S of this.Ld)C.contains(S.node.id.toString())||(C.add(S.node.id.toString()),n.add(this.zo.create(S.node,this._context,e++)));return new jv(n)}get parentBody(){return pc.a.ej()?this.ld.CLf(this.Ld.K(0).node,this.Ld.K(this.Ld.count-1).node,this._context):null}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||pc.a.Wk();return e}get parentContentControlOrNullObject(){return this.sh.Skc(this.Ld.K(0),
this.Ld.K(this.Ld.count-1),this._context)}get parentTable(){if(!pc.a.ej())return null;const e=this.parentTableOrNullObject;e||pc.a.Wk();return e}get parentTableCell(){if(!pc.a.ej())return null;const e=this.parentTableCellOrNullObject;e||pc.a.Wk();return e}get parentTableCellOrNullObject(){if(!pc.a.ej())return null;const e=this.Ld.K(0),n=this.Ld.K(this.Ld.count-1);return this.ld.vkc(e.node,this._context,n.node)}get parentTableOrNullObject(){if(!pc.a.ej())return null;const e=this.Ld.K(0),n=this.Ld.K(this.Ld.count-
1);return this.ld.drb(e.node,this._context,n.node)}get style(){return this.xB.c3c(this.Ld)}set style(e){this.xB.Qwc(this.Ld,e)}get styleBuiltIn(){return pc.a.ej()?this.xB.h6d(this.Ld):-1}set styleBuiltIn(e){pc.a.ej()||pc.a.Kj();this.xB.Ywe(this.Ld,e)}get tables(){return pc.a.ej()?new nB(4,null,this,null,this._context,this.ld):null}get text(){return this.Hl.cEi(this.Ld,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}clear(){this.mzc();this.Yc.WLb(this.Ld);this.OMb()}compareLocationWith(e){pc.a.ej()||
pc.a.Kj();e&&e.Xo.count||pc.a.hg();return this.Hl.d5h(this.Xo.K(0),this.Xo.K(this.Xo.count-1),e.Xo.K(0),e.Xo.K(e.Xo.count-1))}deleteRange(){this.mzc();this.Yc.jgc(this.Ld);this.OMb()}endPreview(){}expandTo(e){(e=this.expandToOrNullObject(e))||pc.a.Wk();return e}expandToOrNullObject(e){pc.a.ej()||pc.a.Kj();if(!e||!e.Xo.count)return null;if(this.OYi(e)){var n=this.Hl.tL(this.Ld.K(0),!0),C=this.Hl.tL(this.Ld.K(this.Ld.count-1),!1,!0),S=this.Hl.tL(e.Xo.K(0),!0);e=this.Hl.tL(e.Xo.K(e.Xo.count-1),!1,!0);
const ja=this.oka(n,S),ya=this.oka(C,e);2===ja&&(n=S);ya||(C=e);S=this.tyi(n,C);return this.nk.create(S,this._context)}return null}getBookmarks(e,n){var C;const S=[],ja=new fb.a;var ya=new fb.a;const kb=null===(C=G.AFrameworkApplication.J)||void 0===C?void 0:C.$("HideBookMarkStartingWithOleLink");for(const Rb of this.Xo)if(C=Rb.node,C.ra)for(let sc=0;sc<C.ra.length;sc++){const Fc=C.ra.Ub(sc);if(Fc.Ch)for(let gd=0;gd<Fc.Ch.length;gd++){const td=Fc.Ch.K(gd).uo.toString();ya.contains(td)||ya.add(td);
n||(ja.contains(td)?ja.remove(td):ja.add(td))}}else E.ULS.sendTraceTag(545396882,369,15,"Paragraph characterProperties is null");for(const Rb of ya)if(n||!n&&!ja.contains(Rb))ya=this.Ep.wPb(Wc.a.Bf(Rb)).ka(hb.a.tu,""),!e&&(e||ya.startsWith(this.Kia)||kb&&ya.startsWith(this.vyk))||S.push(ya);return S}getComments(){return this.Ot.b5d(this.Ld,this._context)}getContentControls(e){var n;e=null!==(n=null===e||void 0===e?void 0:e.types)&&void 0!==n?n:[];pc.a.q_c(e);n=this.Ld.K(0);const C=this.Ld.K(this.Ld.count-
1);n=this.sh.sNf(n,C,this._context);return 0===e.length?n:null===n||void 0===n?void 0:n.getByTypes(e)}getHtml(){return this.px.getHtml(this.Ld.toArray(),this._context)}getHyperlinkRanges(){pc.a.ej()||pc.a.Kj();let e;const n=new fb.a;({returnValue:e}=pc.a.vpg()?this.Hl.Qqb(this.Ld):this.Qqb());if(!e)return new gx(n);for(let C=0;C<e.length;C++){const S=new fb.a;S.add(ce.a.createTextRange(e[C].paragraph,e[C].cpBegin,e[C].cpEnd));n.add(this.nk.create(S,this._context,C))}return new gx(n)}getNextTextRange(e,
n){(e=this.getNextTextRangeOrNullObject(e,n))||pc.a.Wk();return e}getNextTextRangeOrNullObject(e,n){pc.a.ej()||pc.a.Kj();return(e=this.Hl.getNextTextRange(this.Ld,e,n))?this.nk.create(e,this._context):null}getOoxml(){const e=(new Date).getTime();this._context.Cn.CF();return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{this.px.getOoxml(this.Ld,this._context,n,C,e)})}getReviewedText(e){return this.OIm(e)}getRange(e){pc.a.ej()||pc.a.Kj();1!==e&&2!==e&&e&&5!==e&&4!==e&&(E.ULS.sendTraceTag(18745295,
369,15,"AppId:{0}, rangeLocation of Range.GetRange must be Start/End/Whole/Content/After.",this._context.appId),pc.a.td());return(e=this.Hl.DPb(this.Ld,e))?this.nk.create(e,this._context):null}getTextRanges(e,n){pc.a.ej()||pc.a.Kj();e=this.Hl.QNf(this.Ld,e,n);n=new fb.a;for(let C=0;C<e.length;C++)n.add(this.nk.create(e[C],this._context,C));return new gx(n)}getTrackedChanges(){return new kv(4,null,this,null,this._context,this.wx,this.hb,this.Hl)}highlight(){const e=this.Ld.K(0);this.uPa.PEl(e,this._context)}insertBookmark(e){var n=
RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu");if(Of.a.Qf(e)||e.length>this.cpk||e.includes(" ")||!n.test(e))pc.a.td();else{n=this.Xo.K(0);var C=this.Xo.K(this.Xo.count-1);this.Ep.Tbc(e,n.zj,C.Po,n.node,C.node,!0)}}insertBreak(e,n){n&&1!==n&&(E.ULS.sendTraceTag(17179039,369,15,"AppId:{0}, insertLocation of Range.InsertBreak must be Before, After.",this._context.appId),pc.a.td());const C=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((S,ja)=>{this.Yc.insertBreak(this.Ld,
e,n,this._context,S,ja,C,this.C5,!0)})}insertComment(e){return void 0===e||null===e?(pc.a.td(),null):this.Ot.insertComment(this.Xo,e,this._context)}insertContentControl(e){pc.a.$zf(e,"Range");e=pc.a.vrd(e,0);8!==e||pc.a.dia||pc.a.td();return this.EUf(!1,e)}insertFileFromBase64(e,n){"<"===e.charAt(0)&&(E.ULS.sendTraceTag(18130843,369,10,"invalid argument for insertFileFromeBase64 API in Range class.",this._context.appId),pc.a.td());return this.Nla(e,n,!1)}insertEndnote(e){e=this.Yc.mSi(this.Ld,e,1);
return this.Hjb.create(e,this._context)}insertFootnote(e){e=this.Yc.mSi(this.Ld,e,0);return this.Hjb.create(e,this._context)}insertHtml(e,n){const C=(new Date).getTime();return this.px.insertHtml(this.Ld,e,n,C,this._context,!0,this.C5)}insertInlinePictureFromBase64(e,n){const C=(new Date).getTime();this.Yc.FW(this.Ld,n,0);4===n&&this.clear();const S=this.Yc.dee(this.Ld,n);let ja=null;const ya=this.Ld.K(0),kb=this.Ld.K(this.Ld.count-1),Rb=({BL:ja}=this.Yc.dN(ya,kb,n)).returnValue,sc=ja.node.characterData.length;
this.mzc();return this.ay.lSb(e,ja,this._context).then(Fc=>{this._context.Cn.Dv(ya.node);if(!Fc)return this.OMb(),E.ULS.sendTraceTag(17433748,369,10,"AppId:{0}, something went wrong when insert image into Range.",this._context.appId),pc.a.oP("Range.InsertInlinePictureFromBase64",pc.a.fQ(C),e.length,!1),pc.a.hg(),null;pc.a.oP("Range.InsertInlinePictureFromBase64",pc.a.fQ(C),e.length);Fc=this.ay.t0c(Fc);this.Yc.vEe(this.Ld,ja,Rb,1,sc);S&&this.Yc.Xse(this.Ld,n);this.OMb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.iO.create(Fc,
this._context))})}insertOoxml(e,n){"<"!==e.charAt(0)&&(E.ULS.sendTraceTag(18130844,369,10,"invalid argument for InsertOoxml API in Range class.",this._context.appId),pc.a.td());return this.Nla(e,n,!0)}insertParagraph(e,n){n&&1!==n&&(E.ULS.sendTraceTag(21070051,369,15,"AppId:{0}, Invalid insert location for Range.InsertParagraph method.",this._context.appId),pc.a.td());this.mzc();var C=!n,S=C?this.Ld.K(0):this.Ld.K(this.Ld.count-1);S=this.hb.pg(S.node,C);if(C=this.ld.D6d(this.Ld,!n))if(S){n?1===n&&
(n=0):n=1;var ja;var ya=this.Yc.insertParagraph((ja=new fb.a,ja.add(C),ja),e,n)}else e=pc.a.OWc(e),ja=ce.a.Uc(C.node,0),0<this.hb.wm(ja.node,ja.cpBegin)?ja.Fb=ja.Tb=this.hb.wm(ja.node,ja.cpBegin)/2:ja.Fb=ja.Tb=-1,this.Yc.insertText((ya=new fb.a,ya.add(ja),ya),e,n),ya=C.node;else ya=this.Yc.insertParagraph(this.Ld,e,n);this.OMb();return this.zo.create(ya,this._context)}insertTable(e,n,C,S){pc.a.ej()||pc.a.Kj();C&&1!==C&&pc.a.td();this.mzc();e=this.ld.insertTable(this.Ld,e,n,C,S,this._context,!0);this.OMb();
return e}insertTapObjectFromFileContent(){return null}insertText(e,n){0===this.J6b&&pc.a.sC();1===this.J6b&&2!==n&&3!==n&&4!==n&&(E.ULS.sendTraceTag(508703453,369,15,"AppId:{0}, invalid location for ADDIN FieldRange.InsertText: {1}.",this._context.appId,bt.a[n]),pc.a.td());this.mzc();e=this.nk.create(this.Yc.insertText(this.Ld,e,n,this.u2d,this.Fpb,this.o2d),this._context);1===this.J6b&&(e.J6b=1,e.RAd=this.RAd,e.QAd=this.QAd);this.OMb();return e}intersectWith(e){(e=this.intersectWithOrNullObject(e))||
pc.a.Wk();return e}intersectWithOrNullObject(e){pc.a.ej()||pc.a.Kj();if(!e||!e.Xo.count)return null;if(this.OYi(e)){var n=this.Hl.tL(this.Ld.K(0),!0),C=this.Hl.tL(this.Ld.K(this.Ld.count-1),!1,!0),S=this.Hl.tL(e.Xo.K(0),!0);e=this.Hl.tL(e.Xo.K(e.Xo.count-1),!1,!0);const ja=this.oka(n,S),ya=this.oka(C,e),kb=this.oka(n,e),Rb=this.oka(C,S);if(!ja||1===ja)if(2===Rb||1===Rb)n=S;else return null;else if(2===kb)return null;if(ya){if(kb&&1!==kb)return null;C=e}else if(!Rb)return null;S=this.tyi(n,C);return this.nk.create(S,
this._context)}return null}previewTextReplacement(){}removeHighlight(){this.uPa.AQl(this.Ld,this._context)}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{this.vB.find(this.Ld,e,n,C,this._context)})}_Search2(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{this.vB.Ipb(this.Ld,e,n,C,this._context)})}select(e){this.Lq.select(this.Ld,e)}split(e,n,C,S){pc.a.ej()||pc.a.Kj();e=this.Hl.kyc(this.Ld,e,n,C,S);n=new fb.a;for(C=0;C<e.length;C++)n.add(this.nk.create(e[C],
this._context,C));return new gx(n)}_KeepReference(){this.xp()}_OnAccess(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.C5&&((this.Ld=this.C5.Xo)||E.ULS.sendTraceTag(21824033,369,10,"AppId:{0}, the range is lost for unknown reason using the new range model.",this._context.appId));pc.a.gBc(this.Ld,"InternalRange");for(const e of this.Ld)pc.a.Q0(e.node,"Range")}insertField(e,n,C,S){SC.a.Caa||pc.a.Kj();return this.Xx.insertField(this.Ld,this._context,e,n,C,S)}getTypeName(){return"Microsoft.WordServices.Range"}invokePropertyGet(e){switch(e){case 6:return this.contentControls;
case 22:return this.endnotes;case 23:return this.fields;case 3:return this.font;case 21:return this.footnotes;case 11:return this.hyperlink;case 8:return this.inlinePictures;case 10:return this.isEmpty;case 12:return this.lists;case 5:return this.paragraphs;case 16:return this.parentBody;case 7:return this.parentContentControl;case 18:return this.parentContentControlOrNullObject;case 15:return this.parentTable;case 14:return this.parentTableCell;case 19:return this.parentTableCellOrNullObject;case 20:return this.parentTableOrNullObject;
case 4:return this.style;case 17:return this.styleBuiltIn;case 13:return this.tables;case 9:return this.text;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 11:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.style=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 17:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1011:return this.fIa();case 1019:return this.Cxl(n);case 1012:return this.VC(n);case 1035:return this.D0l();
case 1020:return this.E4l(n);case 1028:return this.F4l(n);case 1026:return this.zjm(n);case 1014:return this.YPb();case 1023:return this.Nvm();case 1022:return this.ZBm(n);case 1030:return this.$Bm(n);case 1040:return this.HPb();case 1042:return this.YJa(n);case 1017:return this.ofa(n);case 1041:return this.MQb(n);case 1025:return this.E4c(n);case 1044:return this.$Qb();case 1032:return this.e1m(n);case 1027:return this.S$m(n);case 1039:return this.can(n);case 1003:return this.RKa(n);case 1038:return this.nan(n);
case 1037:return this.xan(n);case 1008:return this.Qsa(n);case 1024:return this.t$a(n);case 1031:return this.Vbn(n);case 1004:return this.TKa(n);case 1021:return this.Xcn(n);case 1029:return this.Ycn(n);case 1034:return this.Zgo(n);case 1033:return this.Uzo();case 1013:return this.gha(n);case 1018:return this.L0b(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1015:return this.xQb();
case 1009:return this.j$a(n);case 1007:return this.Osa(n);case 1005:return this.m$a(n);case 1010:return this.n$a(n);case 1006:return this.r$a(n);case 1016:return this.Vua(n);case 1036:return this.moa(n);case 1043:return this.oan(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}fIa(){this.clear();return null}Cxl(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Js);return this.compareLocationWith(e)}VC(){this.deleteRange();return null}D0l(){this.endPreview();
return null}E4l(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Js);return this.expandTo(e)}F4l(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Js);return this.expandToOrNullObject(e)}zjm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getBookmarks(n,e)}YPb(){return this.getHtml()}Nvm(){return this.getHyperlinkRanges()}ZBm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getNextTextRange(n,e)}$Bm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getNextTextRangeOrNullObject(n,e)}xQb(){return this.getOoxml()}HPb(){return this.getComments()}YJa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,wo);return this.getContentControls(e)}ofa(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}MQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}E4c(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getTextRanges(n,e)}$Qb(){return this.getTrackedChanges()}e1m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");this.highlight(e);return null}S$m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.insertBookmark(e);return null}can(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.insertComment(e)}j$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(n,e)}RKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int?");return this.insertContentControl(e)}nan(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.insertEndnote(e)}oan(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"boolean");return this.insertField(n,C,S,e)}xan(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.insertFootnote(e)}Osa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(n,e)}m$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(n,e)}n$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(n,e)}r$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(n,e)}Qsa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(n,
e)}t$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(n,C,S,e)}Vbn(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,
"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");return this.insertTapObjectFromFileContent(n,C,e)}TKa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(n,e)}Xcn(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Js);return this.intersectWith(e)}Ycn(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Js);return this.intersectWithOrNullObject(e)}Zgo(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.previewTextReplacement(e);return null}Uzo(){this.removeHighlight();return null}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,
e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}L0b(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"boolean");return this.split(n,C,S,e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();
return null}ikd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.C5&&(this.C5.exb(),this.C5=null)}mzc(){this.C5&&this.C5.exb()}OMb(){this.C5?this.C5.uza(this.Ld):this.C5=this.Smc.create(this.Ld)}OIm(e){let n="";for(let S=0;S<this.Ld.count;S++){var C=this.Ld.K(S);switch(C.contextId){case Ma.a.paragraph:C=this.wx.l8d(C.node,e);n+=C;break;case Ma.a.Cd:C=this.wx.mMf(C.node,e,C.cpBegin,C.cpEnd);n+=C;break;case Ma.a.Zc:C.node.ra.last.Yh&&1==e||C.node.ra.last.Wi&&0==e||(n+=
pc.a.kqc);break;case Ma.a.Vc:break;default:E.ULS.sendTraceTag(545005570,369,10,"The contextId {0} is not supported to get the reviewed text.",C.contextId)}}return n}Pnc(e){return e.contextId===Ma.a.paragraph?!1:!0}Nla(e,n,C){const S=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((ja,ya)=>{const kb=C?0:1;this.px.insertOoxml(this.Ld,e,n,this.Ld.K(0).node,this._context,ja,ya,S,kb,0,!0,this.C5)})}OYi(e){return this.Hl.NYi(this.Xo.K(0),e.Xo.K(0))}oka(e,n){return this.Hl.oka(e,
n)}tyi(e,n){this.oka(e,n);const C=new fb.a;for(const S of this.sh.dX(e,n))C.add(ce.a.create(S));1===C.count?e.cpBegin!==n.cpEnd?n.cpEnd>this.hb.textLength(n.node)?(e.cpBegin<this.hb.textLength(n.node)&&0<e.cpBegin?C.W(0,ce.a.createTextRange(e.node,e.cpBegin,this.hb.textLength(n.node))):e.cpBegin?C.removeAt(0):C.W(0,ce.a.create(e.node)),e.cpBegin<=this.hb.textLength(n.node)&&0<e.cpBegin&&C.add(ce.a.Wl(n.node))):C.W(0,ce.a.createTextRange(e.node,e.cpBegin,n.cpEnd)):e.cpEnd<=this.hb.textLength(n.node)?
C.W(0,e):C.removeAt(0):(e.cpBegin&&(e.cpBegin===this.hb.textLength(e.node)?C.W(0,ce.a.Wl(e.node)):e.cpBegin<this.hb.textLength(e.node)?(C.W(0,ce.a.createTextRange(e.node,e.cpBegin,this.hb.textLength(e.node))),C.insert(1,ce.a.Wl(e.node))):C.removeAt(0)),0<n.cpEnd&&n.cpEnd<=this.hb.textLength(n.node)?C.W(C.count-1,ce.a.createTextRange(n.node,0,n.cpEnd)):n.cpEnd?C.W(C.count-1,ce.a.create(n.node)):C.removeAt(C.count-1));this.Hl.Mwc(e,n,C,!0);return C}Qqb(){let e=[];const n=new fb.a;var C=this.Ld.K(0).node.id;
let S=this.Ld.K(0).node;var ja=this.Ld.K(0);let ya=this.Ld.K(0);for(let kb=0;kb<this.Ld.count;kb++){const Rb=this.Ld.K(kb).node,sc=Rb.id;if(!C.equals(sc)){C=ja.cpBegin;ja.contextId===Ma.a.paragraph?C=0:ja.contextId===Ma.a.Zc&&(C=ja.node.characterData.length);ja=ya.cpEnd;if(ya.contextId===Ma.a.paragraph||ya.contextId===Ma.a.Zc)ja=ya.node.characterData.length;C===ja?n.add(ce.a.Uc(S,C)):n.add(ce.a.createTextRange(S,C,ja));S=Rb;C=sc;ja=this.Ld.K(kb)}ya=this.Ld.K(kb)}C=ja.cpBegin;ja.contextId===Ma.a.paragraph?
C=0:ja.contextId===Ma.a.Zc&&(C=ja.node.characterData.length);ja=ya.cpEnd;if(ya.contextId===Ma.a.paragraph||ya.contextId===Ma.a.Zc)ja=ya.node.characterData.length;C===ja?n.add(ce.a.Uc(S,C)):n.add(ce.a.createTextRange(S,C,ja));for(const kb of n)kb.contextId===Ma.a.Vc&&(e=e.concat.apply(e,this.zTf(kb))),e=e.concat.apply(e,nv.a.Oz(kb,!1));return{returnValue:e,Uag:n}}i_f(){const e=this.Ld.K(0).node.id;for(let n=0;n<this.Ld.count;n++){const C=this.Ld.K(n).node.id;if(!e.equals(C))return!1}return!0}zTf(e){const n=
[],C=nv.a.Oz(e,!0);for(const S of C)S.cpBegin===e.cpBegin&&n.push(S);return n}EUf(e=!1,n=0){this.sh.ngf(this.Ld);this.Ld.count||(E.ULS.sendTraceTag(37777541,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),pc.a.hg());var C=this.Ld.K(0),S=this.Ld.K(this.Ld.count-1);if(C===S&&C.contextId===Ma.a.Vc&&this.sh.W$a(C)){let ya;S=C.node.ra.Dh(C.cpBegin);ya=C.oo()<S.mz?0:1;var ja;S=this.Yc.insertParagraph((ja=new fb.a,ja.add(C),ja),"",ya);C=ce.a.create(S);0<this.hb.wm(S,0)?C.Fb=
C.Tb=this.hb.wm(S,0)/2:C.Fb=C.Tb=-1;return this.sh.sqa(C,C,this._context,n,e)}return C===S&&C.contextId===Ma.a.Zc?(ja=ce.a.Cx(C.node),ja.Fb=ja.Tb=C.oo(),this.sh.W$a(ja)&&pc.a.sC(),this.sh.t5a(ja,this._context,n,e)):this.Pnc(C)?this.sh.t5a(C,this._context,n,e):this.Pnc(S)?this.sh.sqa(C,this.Ld.K(this.Ld.count-2),this._context,n,e):this.sh.sqa(C,S,this._context,n,e)}ILf(e){if(G.AFrameworkApplication.dv){const n=new fb.a;this.ay.B6d(n,e);return n}}Rxp(){this.C5&&(this.Ld=this.C5.Xo)}}Object(F.a)(Js,
"Range",Hh.a,[901]);class Mv{constructor(e){this.iqf=new Map;e.execute(n=>{this.pW=n;this.Olc()})}l3i(){return!1}SFf(){return null}n3i(){return!1}Olc(){}m3i(e,n){if(!e)return!0;if(e instanceof Lv)return this.Gun(e,n);if(this.n3i(e,n))return!0;e=this.sum(e);return 0===e.count?!1:this.Fun(e,n)}Fun(e,n){for(const C of e)if(this.l3i(n,C))return!0;return!1}Gun(e,n){var C=!1;switch(e.type){case 0:C=!0;break;case 1:case 4:C=this.SFf(n,!0),n=this.SFf(n,!1),C=this.b0i(C,e.dWh)?!0:this.b0i(n,e.dWh)}return C}b0i(e,
n){if(!e)return!1;e=Ed.a.eb(e);return e.zb(n.type)&&(e.kd(n.type),e.currentNode.equals(n))?!0:!1}sum(e){return e instanceof Ry?(e=e.psa(),e=new fb.a([ce.a.create(e)])):e instanceof Js?(e.Rxp(),e=e.Xo):e instanceof LG&&e.isValid()?e=e.Ljc():new fb.a}Mab(e,n=0){!0!==this.iqf.get(e)&&(n=new zg.a(5,1,n,()=>{this.iqf.set(e,!1);this.rse(e)}),this.iqf.set(e,!0),G.AFrameworkApplication.pc.$b(n))}rse(){}}Object(F.a)(Mv,"AEventMessageManager",null,[1197]);class QG extends Mv{constructor(e,n,C){super(e);this.Cv=
n;this.YUh=C;this.Enb=400;this.VSc=new Map;this.Tij=(S,ja)=>{if(null!==ja&&void 0!==ja&&ja.annotation&&(S=ja.annotation,S.content&&zt.a.typeGuard(S.content)&&S.content.id))switch(S=S.content.id,ja.opType){case xd.d.getTypeName():this.pW.fireEvent(18,{id:S});break;case "HoverOperation":this.pW.fireEvent(19,{id:S});break;case Vh.a.getTypeName():this.pMh(20,S);this.Mab(20,this.Enb);break;case At.a.getTypeName():this.pMh(21,S),this.Mab(21,this.Enb)}}}tfc(e,n,C){let S=null;switch(e){case 18:case 19:S=
n.id;break;case 20:case 21:S=n.ids}return{eventType:e,eventData:S,Uzb:C}}HSc(){return!1}Olc(){jh.a.Xgf&&(this.Cv&&this.YUh?(this.Cv.jPh(this.Tij),this.YUh.execute(e=>e.R0k(this.Tij))):E.ULS.sendTraceTag(508129623,2250,10,"AnnotationEventMessageManager.hookupToRichApiEvtManager: AnnotationStorage or AugLoopProofingIntentProvider is not initialized yet!"))}pMh(e,n){this.VSc.get(e)||this.VSc.set(e,new Set);this.VSc.get(e).add(n)}rse(e){const n=this.VSc.get(e);n&&(this.pW.fireEvent(e,{ids:Array.from(n)}),
this.VSc.set(e,new Set))}}Object(F.a)(QG,"AnnotationEventMessageManager",Mv,[1197]);var ct=d(616),Su=d(1790);class ix{constructor(){this.replyIds=[]}GMh(e){e.Rf?this.Vlb(e):this.tqa(e)}Vlb(e){this.replyIds.push(e.H7a);this.id||(this.id=Su.a.getInstance().Nqm(e.Rf))}tqa(e){this.id=e.H7a}}Object(F.a)(ix,"CommentDetailInternal",null,[]);var RG=d(1428);class SG extends Mv{constructor(e,n){super(e);this.$6e=new Map;this.qGd=new Map;this.Roa=n}tfc(e,n,C){const S=n.comment,ja=yp.a.instance.L2d(C);if(ja){var ya=
this.Hmm(S);if(this.m3i(ja,ya)&&(8!==e||!this.f_m(C))&&(n=this.ilm(e,n)))return this.EIl(S,C,e,n)}}HSc(e,n){if(e.changeType!==n.changeType)return!1;n.commentDetails=e.commentDetails.concat(n.commentDetails);return!0}Olc(){this.pW.W0k(this.nzp.bind(this));this.pW.lPh(this.wsl.bind(this))}l3i(e,n){switch(n.contextId){case Ma.a.Cd:return this.ehn(e,n);case Ma.a.paragraph:return this.dhn(e,n)}return!1}SFf(e,n){return this.Roa.ud.Eb(n?Gm.k(e):Gm.h(e))}nzp(){for(const e of this.qGd.values())this.XBl(e.eventData);
this.qGd.clear()}EIl(e,n,C,S){var ja,ya=null!==(ja=e.Rf)&&void 0!==ja?ja:e.id;ja=n+"_"+C+"_"+S+"_"+ya;if(ya=this.qGd.get(ja))return ya=ya.eventData.commentDetails[0],ya.GMh(e),null;ya=new ix;ya.GMh(e);ya={Uzb:n,eventType:C,eventData:{source:this.pW.jd,commentDetails:[ya],changeType:S}};this.qGd.set(ja,ya);return ya}wsl(e,n){n.eventType&&9===n.eventType&&(this.$6e=new Map)}f_m(e){return this.$6e.get(e)?!0:(this.$6e.set(e,!0),!1)}Hmm(e){return this.Roa.ud.Eb(e.objectId)}ilm(e,n){if(10!==e)return"none";
if(n.changeType)return n.changeType;e=n.comment;n=n.sij;return e.done!==n.done?e.done?"resolved":"reopened":this.Qrn(e.text[0],n.text[0])?null:e.Rf?"replyEdited":"edited"}XBl(e){const n=e.commentDetails[0];e.commentDetails[0]={id:n.id,replyIds:n.replyIds}}Qrn(e,n){return this.P7h(e)===this.P7h(n)}P7h(e){e=Zk.a.Jqb(e).ops;let n="";for(const C of e)n+=this.nGi(C);return n}nGi(e){let n="";const C=["insert","attributes","optional"];for(const S of Object.keys(e)){const ja=e[S];C.includes(S)||(n+=S);n=
ja instanceof Object?n+this.nGi(ja):n+ja}return n}ehn(e,n){var C=new ct.a;C.add(e.id.toString());e=RG.a.m2c(n.node,n.cpBegin,!0,C);C=(C=RG.a.m2c(n.node,n.cpBegin,!1,C))&&C.Ib.cp<=n.cpEnd;return e&&e.Ib.cp<=n.cpEnd||C}dhn(e,n){const C=Gm.k(e);e=Gm.h(e);n=n.node;return C===n.id||e===n.id}}Object(F.a)(SG,"CommentEventMessageManager",Mv,[1197]);class sB extends Mv{constructor(e,n,C,S,ja,ya){super(e);this.N6a=n;this.uMb=C;this.lb=S;this.C6=ja;this.Jqf=ya;this.Enb=400;this.hlg=[];this.Tec=new Map}Olc(){if(pc.a.I6h()){this.N6a.addHandler(Io.a.D6h,
this.onContentChanged.bind(this));this.lb.AB(this.vP.bind(this));var e=ka.a.jf.Tl;e&&(e.qf(12).Qo(this.BN.bind(this)),e.qf(55).ut((n,C)=>{this.Eed(C.node,!1)}),e.qf(55).wT((n,C)=>{this.Eed(C.node,!0)}))}}HSc(e,n){n.ids=e.ids.concat(n.ids);return!0}tfc(e,n,C){n=n.nodeId?this.uMb.jv(n.nodeId):n.node;const S=this.kHf(n),ja=yp.a.instance.L2d(C);if(this.m3i(ja,n))if(0===e&&this.rzl(n.id))this.pW.fireEvent(0,{node:n});else return{eventType:e,eventData:{source:this.pW.jd,ids:[S]},Uzb:C}}n3i(e,n){return e instanceof
LG?this.kHf(n)===e.id:!1}vP(e,n){if(e=n.Rm.currentSelection){e=this.C6.Evi(e);for(const C of e)this.Kef(1,C),this.hlg.includes(C)||this.pW.fireEvent(12,{nodeId:C});for(const C of this.hlg)e.includes(C)||(this.pW.fireEvent(13,{nodeId:C}),this.Kef(1,C));this.hlg=e}}onContentChanged(e,n){this.Kef(2,n.se)}Kef(e,n){this.Tec.get(e)||this.Tec.set(e,new Set);this.Tec.get(e).add(n);this.Mab(e,this.Enb)}rse(e){const n=this.Tec.get(e);if(n){for(const C of n)this.pW.fireEvent(e,{nodeId:C});this.Tec.set(e,new Set)}}rzl(e){let n=
!1;for(const [C,S]of this.Tec)S.has(e)&&(this.pW.fireEvent(C,{nodeId:e}),S.delete(e),n=!0);return n}BN(e,n){if(n.property===Ee.a.zn&&"Remote"===this.pW.jd){e=ce.a.create(n.node);e=this.Jqf.EDi(e,e);for(const C of e)this.pW.fireEvent(2,{node:C.Xd})}}Eed(e,n){var C,S;null!==(C=this.pW.nv)&&void 0!==C&&C.ud.id.equals(e.Hc.id)&&e&&0!==this.kHf(e)&&(null===(S=this.pW)||void 0===S?void 0:S.fireEvent(n?0:3,{node:e}))}kHf(e){return e.ka(hb.a.Ow,0)}}Object(F.a)(sB,"ContentControlEventMessageManager",Mv,[1197]);
class TG extends Mv{constructor(e,n){super(e);this.b3b=n;this.Bga=(C,S)=>{this.pW.fireEvent(14,{wordCount:S.state.wordCount})}}tfc(e,n,C){return{eventType:e,eventData:{source:this.pW.jd,wordCount:n.wordCount},Uzb:C}}HSc(){return!0}Olc(){this.b3b?this.b3b.cmb(this.Bga):E.ULS.sendTraceTag(508826838,2250,10,"DocumentEventMessageManager.hookupToRichApiEvtManager: WordCountManager is not initialized yet!")}}Object(F.a)(TG,"DocumentEventMessageManager",Mv,[1197]);class UG{constructor(e,n,C,S,ja){this.nwl=
e;this.dnl=n;this.tXl=C;this.e$n=S;this.$5k=ja}vBi(e){let n=null;switch(e){case 11:case 10:case 7:case 8:case 9:n=this.nwl;break;case 3:case 1:case 2:case 0:case 12:case 13:n=this.dnl;break;case 14:n=this.tXl;break;case 15:case 16:case 17:n=this.e$n;break;case 18:case 19:case 20:case 21:n=this.$5k}return n}}Object(F.a)(UG,"EventMessageManagerMapper",null,[]);class VG extends Mv{constructor(e,n){super(e);this.Agd=n;this.Enb=pc.a.gQn;this.xOb=new Map;this.Soe=new Map;this.BN=(C,S)=>{C=S.node;S.property===
Ee.a.zn&&C&&this.hqf(16,C.id)};this.y1n=(C,S)=>{C=S.node;S.kde||!C||C.JWa||this.hqf(15,C.id)};this.B1n=(C,S)=>{(C=S.node)&&!C.JWa&&this.hqf(17,C.id)}}Olc(){if(pc.a.gig){var e=ka.a.jf.Tl;e&&(e=e.qf(12),e.Qo(this.BN),e.ut(this.y1n),e.ly(this.B1n))}}HSc(e,n){if(e.source!==n.source)return!1;n.uniqueLocalIds=[...(new Set(e.uniqueLocalIds.concat(n.uniqueLocalIds)))];return!0}tfc(e,n,C){n=this.Agd.rDi(n.twb);return{eventType:e,eventData:{source:this.pW.jd,uniqueLocalIds:[n]},Uzb:C}}ief(e,n){this.xOb.get(e)||
this.xOb.set(e,new Set);this.xOb.get(e).add(n.toString());this.Soe.set(n.toString(),e)}ICj(e,n){this.xOb.get(e)&&this.xOb.get(e).delete(n.toString());this.Soe.delete(n.toString())}hqf(e,n){const C=this.Soe.get(n.toString());if(C)switch(e){case 17:this.ICj(C,n);15!=C&&(this.ief(e,n),this.Mab(e,this.Enb));break;case 16:17==C&&E.ULS.sendTraceTag(508404E3,369,15,"Trying to modify a deleted paragraph object: {0}",n.toString());break;case 15:17==C?(this.ICj(C,n),this.ief(16,n),this.Mab(16,this.Enb)):E.ULS.sendTraceTag(508403999,
369,15,"Trying to add a new paragraph object: {0} when one already exists",n.toString())}else this.ief(e,n),this.Mab(e,this.Enb)}rse(e){const n=this.xOb.get(e);if(n){for(const C of n)this.pW.fireEvent(e,{twb:C}),this.Soe.delete(C);this.xOb.set(e,new Set)}}}Object(F.a)(VG,"ParagraphEventMessageManager",Mv,[1197]);var CJ=d(1293);class jx{constructor(e,n,C){this.BIc=new eb.a;this.OGd=[];this.DLc=[];this.ZJd=new Map;this.DIe=null;this.Ggh=e;this.wQa=n;this.e6e=C;this.H2m()}get bF(){!this.DIe&&ka.a&&ib.StaticActiveAppFrame.za()&&
ib.StaticActiveAppFrame.za().kb&&ib.StaticActiveAppFrame.za().kb.hd&&ib.StaticActiveAppFrame.za().kb.hd.Ag&&(this.DIe=ib.StaticActiveAppFrame.za().kb.hd.Ag);return this.DIe}get nv(){var e,n;return null===(n=null===(e=ib.StaticActiveAppFrame.za())||void 0===e?void 0:e.kb)||void 0===n?void 0:n.hd}get jd(){return this.bF&&2===this.bF.enabled?"Remote":"Local"}W0k(e){this.BIc.addHandler(jx.ajj,e)}lPh(e){this.BIc.addHandler(jx.Vcg,e)}XBo(e){this.BIc.removeHandler(jx.Vcg,e)}fireEvent(e,n){try{const C=this.Ggh.vBi(e);
if(!C)return null;const S=this.$Nm(e);if(0!==S.length){this.BIc.raiseEvent(jx.Vcg,{eventType:e});for(const ja of S){const ya=C.tfc(e,n,ja);ya&&this.Nko(ja,ya)}this.e6e.gZn()}}catch(C){throw this.yEn(C,{eventType:e}),C;}}Nko(e,n){let C=this.ZJd.get(e);C||(C=[],this.ZJd.set(e,C));C.push(n)}H2m(){this.e6e.$A(this.w4k.bind(this));this.e6e.Hxo();this.aae=this.aae.bind(this);this.lPh(this.aae)}aae(){this.bF&&(this.bF.iRd(this.PPo.bind(this)),CJ.a.instance.mRd(this.P0l.bind(this)),this.XBo(this.aae))}P0l(){0!==
this.OGd.length&&(this.DLc=this.DLc.concat(this.OGd),this.OGd=[])}PPo(){if(0!==this.DLc.length){for(const e of this.DLc)this.yLj(e);this.DLc=[]}}w4k(){this.BIc.raiseEvent(jx.ajj);for(const e of this.ZJd.values()){for(let n=1;n<e.length;n++){const C=e[n-1],S=e[n];this.kRn(C,S)?this.Ggh.vBi(S.eventType).HSc(C.eventData,S.eventData)||this.ywg(C):this.ywg(C)}this.ywg(e[e.length-1])}this.ZJd.clear()}kRn(e,n){return e.eventType===n.eventType}ywg(e){e&&(this.bF&&!this.bF.hH()?this.yLj(e):this.OGd.push(e))}yLj(e){this.wQa.fireEvent(e.Uzb,
e.eventType,e.eventData)}yEn(e,n=null){e={["ErrMsg"]:e.message,["ErrStack"]:e.stack};n&&(e.ExtendMsg=n);E.ULS.sendTraceTag(523072988,369,50,"Exception in event: {0}",e)}$Nm(e){var n;const C=[],S=null!==(n=this.wQa.m_eventIdControlMapByTarget)&&void 0!==n?n:{};for(const ja of Object.keys(S))S[ja][e]&&C.push(ja);return C}}jx.ajj="BAE";jx.Vcg="BFE";Object(F.a)(jx,"RichApiEventManager",null,[1198]);var TC=d(1304),Bt=d(286);class DJ extends TC.a{constructor(){super()}get index(){return 5}run(){this.Zmk()}Hxo(){Bt.a.instance.Zua(this,
3)}$A(e){this.Zmk=e}gZn(){this.r0()}}Object(F.a)(DJ,"RichApiEventTransactionCompletedProcessor",TC.a,[]);var ov=d(1908);class WG extends ov.a{constructor(e,n,C,S,ja,ya,kb){super(ja,e,null,n,C,null,null,S,ya);this.bBd=kb}Ucg(){this._state=0;this.Elb=this.iT.Oie||this.iT.ignoreSpace||this.iT.ignorePunct?this.mja.Euj(this.iT):this.mja.Ghd(this.iT.text)}Gmf(){return this.bBd.K(this.cO)?!1:(this.Vmb(),this._state=2,this.Iyb(!0),!0)}Egg(){this.tPf(this.bBd.K(this.cO).node,0);this.cO++}Vmb(){this.cO=0;this.Elb=
""}WQd(e,n){this.Ak.aRd(n)}Upf(){return this.cO<this.bBd.count}Dcg(){this.cO>=this.bBd.count&&(this.cO=0,this._state=2,this.Iyb(!0))}Ktg(){const e=this.mja.pXb(this.Elb);try{this.O6b=this.P6b.Bkc(e.join("|"),this.iT)}catch(n){E.ULS.sendTraceTag(17339148,313,10,"ExtensionFindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.iT.matchCase,this.iT.matchWholeWord),this.O6b=null,this._state=2,this.Iyb(!0)}return!1}}Object(F.a)(WG,"ExtensionFindManager",
ov.a,[]);class EJ{constructor(e,n,C,S){this.mja=e;this.vq=n;this.P6b=C;this.HZe=S}create(e,n,C){return new WG(this.mja,this.vq,this.HZe,this.P6b,e,n,C)}}Object(F.a)(EJ,"ExtensionFindManagerFactory",null,[]);var XG=d(2148);class FJ extends XG.a{constructor(e,n,C,S){super();this.Rda=this.nT=this.nHd=null;n&&0<n.count&&(this.nHd=this.hCm(n),this.nT=C,this.Rda=new fb.a);this.nk=e;this.lW=S}YUa(e,n){if(!e&&0<n.length)for(e=0;e<n.length;e++){const C=new fb.a,S=n[e].nodeId;if(this.nHd.tb(S)){const ja=this.nHd.K(S);
(ja.contextId===Ma.a.paragraph||ja.contextId===Ma.a.Cd&&n[e].Dc>=ja.cpBegin&&n[e].end<=ja.cpEnd)&&this.KJl(C,S,n[e])}}}KJl(e,n,C){e.add(ce.a.createTextRange(this.nHd.K(n).node,C.Dc,C.end));this.Rda.add(this.nk.create(e,this.lW,this.Rda.count))}dic(){this.nT(this.oil())}oil(){return new gx(this.Rda)}hCm(e){const n=new If.a;for(const C of e)n.add(C.node.id,C);return n}}Object(F.a)(FJ,"ExtensionFindStatusManager",XG.a,[]);class YG{constructor(){this.nk=null}su(e){this.nk=e}create(e,n,C){return new FJ(this.nk,
e,n,C)}}Object(F.a)(YG,"ExtensionFindStatusManagerFactory",null,[]);var Zz=d(1059);class GJ extends Zz.a{constructor(e,n,C,S,ja,ya,kb){super(e,n,C,S,ja);this.nT=ya;this.Mpa=kb}CZh(){this.Mpa(null)}DZh(){this.nT(this.qO.K(0))}EZh(){this.Mpa(null)}}Object(F.a)(GJ,"ExtensionImageSteward",Zz.a,[]);class JE{constructor(e,n,C,S){this.Dk=e;this.Jb=n;this.En=C;this.Fd=S}create(e,n,C){return new GJ(e,this.Dk,this.Jb,this.En,this.Fd,n,C)}}Object(F.a)(JE,"ExtensionImageStewardFactory",null,[]);var nL=d(1950);
class ZG{constructor(){}su(e,n,C,S,ja,ya){this.nk=e;this.Xx=n;this.ld=C;this.sh=S;this.Yc=ja;this.Lq=ya}create(e,n,C=0,S=null){return new nL.a(e,n,C,S,this.nk,this.Xx,this.ld,this.sh,this.Yc,this.Lq)}}Object(F.a)(ZG,"FieldFactory",null,[1080]);var $G=d(340),Nv=d(945),aH=d(1163);class UC{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd){this.RDb=e;this.hb=n;this.sh=C;this.Rh=S;this.aE=ja;this.S5=ya;this.fd=kb;this.QDb=Rb;this.iF=sc;this.DPk=Fc;this.Yc=gd;this.th=td;this.uhh=Bd;this.ga=wd}WHm(e,n,
C){if(!e.ra||!e.o7)return{Fca:null,startCp:0,endCp:0};for(;0<=n;n--){const S=e.ra.Dh(n);if(S&&S.lc)for(let ja=0;ja<S.lc.length;ja++){const ya=S.lc.K(ja);if(!ya.pe&&1===ya.ir)return{Fca:e,startCp:n,endCp:C}}}e=this.hb.pg(e,!0,!0);return this.SEi(e)}psm(e,n,C,S){if(!e.ra)return{Fca:null,startCp:0,endCp:0};for(let ja=n;ja<=e.characterData.length;ja++){const ya=e.ra.Dh(ja);if(ya&&ya.lc)for(let kb=0;kb<ya.lc.length;kb++){const Rb=ya.lc.K(kb);if(!Rb.pe&&1===Rb.ir)return ja>=C?{Fca:null,startCp:0,endCp:0}:
{Fca:e,startCp:ja,endCp:C};if(ja!==n&&!S)return this.WHm(e,n,C)}}return{Fca:null,startCp:0,endCp:0}}V5d(e,n,C,S,ja,ya=!1){const kb=new fb.a;let Rb=e,sc=Rb.ra;if(sc&&Rb.o7){let {Fca:wd,startCp:te,endCp:Le}=this.psm(e,n,C,ja);if(wd){Rb=wd;sc=Rb.ra;var Fc=0;let Oe=null;ja=!0;ya&&C===Rb.characterData.length&&Le++;for(ya=te;ya<Le;ya++){var gd=sc.Dh(ya);if(gd&&gd.lc)for(var td=0;td<gd.lc.length;td++){var Bd=gd.lc.K(td);3===Bd.pe&&1===Bd.ir?(ja=!0,Oe&&Fc!==gd.cp&&(Oe.Ld.add(ce.a.createTextRange(wd,Fc,gd.cp)),
kb.add(Oe))):Bd.pe||1!==Bd.ir?5===Bd.pe&&(Oe.Ld.add(ce.a.createTextRange(wd,Fc,gd.cp)),Oe.Ld.add(ce.a.Wl(wd)),Bd=this.hb.pg(wd,!1,!0),kb.add(this.QCf(Bd,Oe))):(ja=!1,Fc=new fb.a,Oe=this.RDb.create(Fc,S),Fc=gd.cp)}}for(ya=Le;!ja&&ya<=Rb.characterData.length;ya++)if((gd=sc.Dh(ya))&&gd.lc)for(td=0;td<gd.lc.length;td++)Bd=gd.lc.K(td),3===Bd.pe&&1===Bd.ir?(ja=!0,Oe.Ld.add(ce.a.createTextRange(wd,Fc,gd.cp)),kb.add(Oe)):5===Bd.pe&&(Oe.Ld.add(ce.a.createTextRange(wd,Fc,gd.cp)),Oe.Ld.add(ce.a.Wl(wd)),Bd=this.hb.pg(wd,
!1,!0),kb.add(this.QCf(Bd,Oe)))}}if(SC.a.Caa){e=this.pCm(ce.a.createTextRange(e,n,C),S);for(const wd of e)kb.add(wd)}return kb}pCm(e,n){const C=e.node;let S=0,ja=-1,ya=null;const kb=[],Rb=C.ra;for(;Rb&&S<Rb.length;){const Fc=Rb.Ub(S++);if(Fc.wn&&ya){if(ja<e.cpEnd&&e.cpBegin<Fc.cp&&ya){var sc=new fb.a;sc.add(ce.a.createTextRange(C,ja,Fc.cp));kb.push(this.RDb.create(sc,n,0,ya));ya=null}else ja!==e.cpEnd&&e.cpBegin!==Fc.cp||!ya||(sc=new fb.a,sc.add(ce.a.createTextRange(C,ja,Fc.cp)),kb.push(this.RDb.create(sc,
n,0,ya)),ya=null);if(Fc.cp>=e.cpEnd)break}if(Fc.hyperlink&&!Fc.lc||Fc.hyperlink&&!this.IYm(Fc.lc))ja=Fc.cp,ya=Fc.hyperlink}return kb}IYm(e){for(let n=0;n<e.length;n++)if(1===e.K(n).pe){const C=e.K(n).tX;if(C&&C.startsWith(nv.a.bic)&&nv.a.qXa(nv.a.oKa(C)))return!0}return!1}SEi(e){if(!e.ra||!e.o7)return{Fca:null,startCp:0,endCp:0};for(let n=e.characterData.length;0<=n;n--){const C=e.ra.Dh(n);if(C&&C.lc)for(let S=C.lc.length-1;0<=S;S--){const ja=C.lc.K(S);if(!ja.pe&&1===ja.ir)return{Fca:e,startCp:n,
endCp:e.characterData.length}}}e=this.hb.pg(e,!0,!0);return this.SEi(e)}Ejc(e,n,C){return this.V5d(e,0,e.characterData.length,n,C,!0)}QCf(e,n){const C=e.ra;if(!C||!e.o7)return n;let S=0;for(let ja=0;ja<C.length;ja++){const ya=C.Ub(ja);if(ya.lc)for(let kb=0;kb<ya.lc.length;kb++){const Rb=ya.lc.K(kb);if(!(1<Rb.ir))if(4===Rb.pe)S=ya.cp;else{if(3===Rb.pe)return n.Ld.add(ce.a.createTextRange(e,S,ya.cp)),n;if(5===Rb.pe)return n.Ld.add(ce.a.createTextRange(e,S,ya.cp)),n.Ld.add(ce.a.Wl(e)),e=this.hb.pg(e,
!1,!0),this.QCf(e,n)}}}return n}nsm(e,n){const C=e.start,S=e.end;if(C&&S)return e.zg?this.msm(C,S,n):this.V5d(C.node,C.cpBegin,S.cpEnd,n,!1)}msm(e,n,C){n=this.sh.dX(e,n);e=new fb.a;for(const S of n)n=this.Ejc(S,C,!0),e.addRange(n);return e}getNextOrNullObject(e,n){if(!e.Ld||0===e.Ld.count)return null;e=e.Ld.K(e.Ld.count-1);if(e.cpEnd!==e.node.characterData.length){var C=this.V5d(e.node,e.cpEnd,e.node.characterData.length,n,!0);if(0<C.count)return C.K(0)}for(e=this.hb.pg(e.node,!1,!0);e;){C=this.Ejc(e,
n,!0);if(0<C.count)return C.K(0);e=this.hb.pg(e,!1,!0)}return null}ksm(e){var n;if(null===e.Ld||0===e.Ld.count)return"";if(SC.a.Caa&&e.LSf)return"HYPERLINK "+(null===(n=e.LSf)||void 0===n?void 0:n.url);e=e.Ld.K(0);(e=e.node.ra.Dh(-1==e.cpBegin?0:e.cpBegin))&&e.lc||pc.a.hg();const C=[];for(n=0;n<e.lc.length;++n)if(0===e.lc.K(n).pe){const S=new $G.a(e.lc,n);for(const ja of Nv.a.X6a(S,!1))1===ja.vm.pe&&C.push(ja.vm.tX)}return 0===C.length?"":1===C.length?C[0]:C.every(S=>S===C[0])?(E.ULS.sendTraceTag(508347467,
324,15,"Found duplicate field instruction in {0} markers",C.length),C[0]):C.join("")}BUo(e,n){if(null!==e.Ld&&0!==e.Ld.count){e=e.Ld.K(0);var C=e.node.ra.Dh(e.cpBegin);if(C&&C.lc)for(let S of Nv.a.E6(e.node,e.cpBegin))1===S.vm.pe&&(S.vm.tX=n);else pc.a.hg()}}Fxi(e,n,C){const S=new fb.a;for(const ja of this.Rh.wy(e,0,this.Rh.vg(e)-1))S.addRange(this.Gxi(ja,n,C));return S}Gxi(e,n,C){const S=new fb.a;for(const ja of this.aE.KA(e))S.addRange(this.osm(ja,n,C));return S}osm(e,n,C){if(this.S5.gr(e))return null;
const S=this.fd.Ql();S.set(e);var ja=S.je();for(e=new fb.a;ja;)ja=S.je(),12===ja.type?e.addRange(this.Ejc(ja,n,C)):14===ja.type&&e.addRange(this.Fxi(ja,n,C)),S.uc(),ja=S.Tk();return e}insertField(e,n,C,S=31,ja,ya=!1){S=0==S?31:S;this.Yc.FW(e,C,0);const kb=e.K(0),Rb=e.K(e.count-1);let sc=null;({BL:sc}=this.Yc.dN(kb,Rb,C));4==C&&this.Yc.jgc(e);switch(!0){case 31==S||81==S:return this.yan(n,C,S,ja,ya,sc,kb,Rb);case 88==S:return this.Gan(e,n,C,ja);case 13==S:return this.Pbn(sc).then(()=>{var Fc=this.hb.pg(sc.node,
!1,!0);Fc=this.YMm(Fc);return this.RDb.create(Fc,n)});default:pc.a.td()}}i7l(e){switch(e){case 31:return" DATE ";case 81:return" ADDIN ";default:return""}}yan(e,n,C=31,S,ja=!1,ya,kb,Rb){return OfficeExtension.WacRuntime.Utility.createPromise(sc=>{var Fc=this.i7l(C);null!=S&&(Fc+=S);ja||(Fc+=" \\* MERGEFORMAT ");var gd=this.QDb.insertField(ya,Fc,""),td=ce.a.XT(gd.cpBegin,gd.cpEnd,!1,0==n||2==n||4==n?kb.node:Rb.node);if(31==C){if(td=this.uhh.L4c(aH.a.Thc(Fc)))gd=this.QDb.oCf(gd),td.cKg(Fc,gd);Fc=this.QDb.oCf(ya);
Fc=this.RDb.create(Fc,e)}else Fc=new fb.a([td]),Fc=this.RDb.create(Fc,e);sc(Fc)})}Gan(e,n,C,S){return OfficeExtension.WacRuntime.Utility.createPromise(ja=>{var ya=this.Yc.insertText(e,S,C),kb=ya.K(0);kb=this.iF.wF(kb,S,!1,!1,!0,!1);ya=this.RDb.create(ya,n,0,kb);ja(ya)})}Pbn(e){return OfficeExtension.WacRuntime.Utility.createPromise(n=>{if(32!==this.DPk.ISi(0,e,2,null,{resolve:n}))throw pc.a.hg();})}YMm(e){var n,C=null===(n=null===e||void 0===e?void 0:e.ra)||void 0===n?void 0:n.first.Hb;(!C||0>=C.length)&&
pc.a.hg();n=e.ra.first.Hb.K(0);n.zg||(E.ULS.sendTraceTag(508949568,3019,15,"Content control is not block type"),pc.a.hg());n=this.th.dr(n.Xd.id,!1);C=new fb.a;for(C.add(ce.a.create(e));e&&(e=Af.ParagraphReader.pg(e,!1),C.add(ce.a.create(e)),e.id!=n););return C}U5d(e){if(null===e.Ld||0===e.Ld.count)return null;e=e.Ld.K(0);if((e=e.node.ra.Dh(e.cpBegin))&&e.lc){for(let n=0;n<e.lc.length;n++){const C=e.lc.K(n);if(0===C.pe)return C}return null}pc.a.hg()}updateResult(e){const n=this.uhh.L4c(aH.a.Thc(e.code));
if(n)if(SC.a.Caa){const C=this.QDb.oCf(e.Ld.K(0));n.cKg(e.code,C)}else n.cKg(e.code,e.Ld);else 13===e.type&&this.ga.Hf(e.Ld.K(0),pe.a.o2b,2,!1,null,null)}}Object(F.a)(UC,"FieldOperations",null,[1195]);class KE{[Symbol.iterator](){return this}constructor(e,n=!1){this.Hfn=n;e=this.aRn(e);this.J9d=Ed.a.eb(e);this.currentNode=this.fub(e)?e:n?this.wEi():this.mCi()}next(){const e=this.currentNode;return null!=e?(this.currentNode=this.Hfn?this.wEi():this.mCi(),{value:e}):{value:void 0,done:!0}}mCi(){for(;this.J9d.Ci(1);){const e=
this.J9d.currentNode;if(this.fub(e))return e}}wEi(){for(;this.J9d.dP(1);){const e=this.J9d.currentNode;if(this.fub(e))return e}}aRn(e){e=Ed.a.eb(e);return e.zb(10)?e.Dp(10):null}fub(e){return!!e&&10===e.type&&e.sc===cj.a.eia}static create(e,n=!1){return new KE(e,n)}}Object(F.a)(KE,"WordSectionNodeIterator",null,[]);var tB=d(1766);class ru{constructor(e,n,C,S,ja,ya,kb){this.Zi=kb;this.Mpa=this.nT=this._context=this.iDh=this.Lxa=this.sh=this.nk=null;this.gJc=this.FCb=this.JKh=this.Z4=0;this.aJh=!1;
this.vGa=e;this.Yc=n;this.hb=C;this.ay=S;this.XQa=ya}su(e,n,C){this.nk=e;this.sh=n;this.Lxa=C}getHtml(e,n){pc.a.p1c()&&this.Yc.H0f(e[0].node)&&pc.a.aHg();n.Cn.CF();let C="";e=({hWa:C}=this.XQa.fIf(e,!0)).returnValue;n.Cn.Dv();e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pc.a.hg();return C}Vtn(e){if((new RegExp(ru.cBh)).test(e))return!0;const n=new RegExp(ru.bBh,"g");let C=0;for(;n.exec(e)&&1>=C;)C++;return 1<C}Yon(e){return(new RegExp(ru.bBh)).test(e)||(new RegExp(ru.cBh)).test(e)}insertHtml(e,
n,C,S,ja,ya=!1,kb=null){this._context=ja;ja=this.Yon(n)?1:0;this.Yc.FW(e,C,ja);let Rb=new fb.a,sc=!1,Fc=null,gd=13;if(pc.a.iud())4===C&&(this.sh.KNb(),this.Yc.WLb(e),this.sh.tJa(),C=2),ja=new fb.a,ja.addRange(e),sc=this.Yc.dee(ja,C),{BL:Fc,returnValue:gd}=this.Yc.dN(ja.K(0),ja.K(ja.count-1),C),this.Vtn(n)&&(Fc=this.sh.GOa(Fc,e)),Rb.add(Fc),sc&&({BL:Fc,returnValue:gd}=this.Yc.dN(e.K(0),e.K(e.count-1),C));else{ja=e.K(0);const td=e.K(e.count-1);({BL:Fc,returnValue:gd}=this.Yc.dN(ja,td,C));13===gd?Rb=
e:Rb.add(Fc)}kb&&kb.exb();return OfficeExtension.WacRuntime.Utility.createPromise(td=>{const Bd=this.XQa.Nwe(Rb.toArray(),!0,n,(wd,te)=>{wd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&te||(kb&&kb.uza(e),pc.a.hg());wd=new fb.a;for(const Le of te.toArray())wd.add(Le);wd.K(0).contextId===Ma.a.Vc?(wd.clear(),wd.add(Fc)):(this.Yc.Xv(wd.K(0)),this.Yc.Xv(wd.K(wd.count-1)));te=this.nk.create(wd,this._context);td(te);if(ya){if(sc&&(te=wd.K(wd.count-1),te.contextId===Ma.a.paragraph)){let Le;this.Yc.LZd((Le=
new fb.a,Le.add(ce.a.create(this.hb.pg(te.node,!1))),Le))}this.Nxp(e,wd,gd,sc)}kb&&kb.uza(e);pc.a.oP("FileApiOperations.InsertHtml",pc.a.fQ(S),n.length)});Bd!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(kb&&kb.uza(e),Bd===OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection&&pc.a.sC(),pc.a.hg())})}Nxp(e,n,C,S=!1){if(n.count&&(1!==n.count||n.K(0).contextId!==Ma.a.Vc)){var ja=e.K(0),ya=e.K(e.count-1),kb=n.K(n.count-1),Rb=this.hb.pg(kb.node,!1);switch(C){case 0:kb.contextId!==Ma.a.Cd||
S?e.W(0,ce.a.create(Rb)):(e.W(0,ce.a.create(kb.node)),this.Yc.Xv(e.K(0),0),n.removeAt(n.count-1));e.K(0).Tb=ja.qo();e.SA(0,n);break;case 1:case 2:kb.contextId===Ma.a.Cd?(e.W(0,ce.a.Wl(kb.node)),e.K(0).Tb=ja.qo()):kb.contextId===Ma.a.paragraph?e.removeAt(0):kb.contextId===Ma.a.Zc&&n.remove(kb);e.SA(0,n);break;case 3:if(C=ja.cpEnd-ja.cpBegin){if(kb.contextId===Ma.a.Cd)S?(e.W(0,ce.a.createTextRange(Rb,0,C)),n.add(ce.a.Wl(kb.node))):(e.W(0,ce.a.createTextRange(kb.node,kb.cpBegin,kb.cpEnd+C)),n.removeAt(n.count-
1),n.count||(e.K(0).Fb=kb.oo())),1<e.count&&e.K(1).contextId===Ma.a.Zc&&e.W(1,ce.a.Wl(e.K(0).node));else if(kb.contextId===Ma.a.paragraph||kb.contextId===Ma.a.Zc)e.W(0,ce.a.createTextRange(Rb,0,C)),1<e.count&&e.K(1).contextId===Ma.a.Zc&&e.W(1,ce.a.Wl(Rb));e.K(0).Tb=ja.qo()}else e.removeAt(0);e.SA(0,n);break;case 5:case 6:e.W(0,ce.a.Wl(kb.node));this.Yc.wEa(e.K(0));e.K(0).Tb=this.hb.Ex(e.K(0).node);break;case 7:if(C=ja.cpEnd-ja.cpBegin){if(kb.contextId===Ma.a.Cd)S?(e.W(0,ce.a.createTextRange(Rb,0,
C)),e.K(0).Fb=this.hb.vy(Rb)):(e.W(0,ce.a.createTextRange(kb.node,kb.cpEnd,kb.cpEnd+C)),this.Yc.wEa(e.K(0))),1<e.count&&e.K(1).contextId===Ma.a.Zc&&e.W(1,ce.a.Wl(e.K(0).node));else if(kb.contextId===Ma.a.paragraph||kb.contextId===Ma.a.Zc)e.W(0,ce.a.createTextRange(Rb,0,C)),e.K(0).Fb=this.hb.vy(Rb),1<e.count&&e.K(1).contextId===Ma.a.Zc&&e.W(1,ce.a.Wl(Rb));e.K(0).Tb=ja.qo()}else{if(kb.contextId===Ma.a.Cd)e.W(0,ce.a.Uc(kb.node,kb.cpEnd)),this.Yc.wEa(e.K(0));else if(kb.contextId===Ma.a.paragraph||kb.contextId===
Ma.a.Zc)e.W(0,ce.a.Cx(kb.node)),this.Yc.wEa(e.K(0));e.K(0).Tb=e.K(0).oo()+ja.qo()-ja.oo()}break;case 4:kb.contextId!==Ma.a.Cd||S?(e.W(0,ce.a.create(Rb)),e.K(0).Fb=ja.oo(),e.K(0).Tb=ja.qo()):(e.W(0,ce.a.createTextRange(kb.node,kb.cpEnd,this.hb.textLength(kb.node))),this.Yc.wEa(e.K(0)),e.K(0).Tb=ja.qo(),e.insert(1,ce.a.Wl(kb.node)));break;case 9:ya.contextId===Ma.a.Zc?S||(e.removeAt(e.count-1),n.K(0).contextId===Ma.a.Cd&&0<e.count&&e.K(e.count-1).contextId===Ma.a.Cd&&(n.W(0,ce.a.createTextRange(n.K(0).node,
e.K(e.count-1).cpBegin,n.K(0).cpEnd)),n.K(0).Fb=e.K(e.count-1).oo(),e.removeAt(e.count-1))):ya.contextId!==Ma.a.paragraph||S||n.K(0).contextId!==Ma.a.Cd||(e.W(e.count-1,ce.a.createTextRange(n.K(0).node,0,n.K(0).cpEnd)),e.K(e.count-1).Fb=ya.oo(),n.removeAt(0));kb.contextId===Ma.a.Cd&&(S=ce.a.Wl(kb.node),S.Tb=this.hb.Ex(kb.node),n.add(S));e.addRange(n);break;case 10:ya.contextId===Ma.a.Vc?e.removeAt(e.count-1):ya.contextId===Ma.a.Cd&&(n.K(0).contextId===Ma.a.Cd?(e.W(e.count-1,ce.a.createTextRange(n.K(0).node,
ya.cpBegin,n.K(0).cpEnd)),this.Yc.Xv(e.K(e.count-1),1),n.removeAt(0)):n.K(0).contextId===Ma.a.Zc&&e.W(e.count-1,ce.a.createTextRange(n.K(0).node,ya.cpBegin,ya.cpEnd)),e.K(e.count-1).Fb=ya.oo());e.addRange(n);break;case 12:S||(ya.contextId===Ma.a.Vc?e.W(e.count-1,ce.a.Uc(n.K(0).node,ya.cpBegin)):ya.contextId===Ma.a.Cd&&e.W(e.count-1,ce.a.createTextRange(n.K(0).node,ya.cpBegin,ya.cpEnd)),e.K(e.count-1).Fb=ya.oo(),e.K(e.count-1).Tb=ya.qo());break;case 13:e.clear(),e.addRange(n)}}}getOoxml(e,n,C,S,ja){this.w7c(null,
n,C,S,ja);this.vGa.getOoxml(e.toArray(),ya=>{this.nT(ya);this._context.Cn.Dv();pc.a.oP("FileApiOperations.GetOoxml",pc.a.fQ(this.Z4),ya.length)},ya=>{E.ULS.sendTraceTag(17568003,369,10,"AppId:{0}, {1}",this._context.appId,tB.a[ya]);this.Mpa(tB.a[ya]);this._context.Cn.Dv();pc.a.oP("FileApiOperations.GetOoxml",pc.a.fQ(this.Z4),void 0,!1)})}insertOoxml(e,n,C,S,ja,ya,kb,Rb,sc,Fc=0,gd=!1,td=null,Bd=null){this.Yc.FW(e,C,0);td&&td.exb();this.w7c(S,ja,ya,kb,Rb,sc,Fc,C,gd);this._context.Cn.CF();this.kbn(e,
n,td,Bd)}w7c(e,n,C,S,ja,ya=0,kb=0,Rb=0,sc=!1){this.iDh=e?8===e.type||10===e.type?e:this.mLf(e):null;this._context=n;this.nT=C;this.Mpa=S;this.Z4=ja;this.JKh=ya;this.FCb=kb;this.gJc=Rb;this.aJh=sc}kbn(e,n,C,S){let ja=new fb.a;var ya=e.K(0);const kb=e.K(e.count-1);var Rb=null;const sc=({BL:Rb}=this.Yc.dN(ya,kb,this.gJc)).returnValue;let Fc=null,gd=null;13===sc?(ja=e,this.FCb||(this.FCb=this.onm(e)),Rb=ce.a.Uc(ya.node,ya.zj),Rb.Tb=Rb.Fb=ya.Fb,ya=ce.a.Uc(kb.node,kb.Po),ya.Tb=ya.Fb=kb.Tb,Fc=this.sh.pdc(Rb,
void 0,!0),gd=this.sh.pdc(ya,void 0,!1)):(ja.add(Rb),this.FCb||-1===Rb.oo()||(this.gJc=({Ow:this.FCb}=this.nnm(Rb,this.FCb)).returnValue),Fc=this.sh.pdc(Rb,void 0,!0),gd=this.sh.pdc(Rb,void 0,!1));let td=-1,Bd=-1;9===sc&&(td=kb.oo(),Bd=kb.qo());this.vGa.xxe(ja.toArray(),n,this.FCb,this.gJc,this.JKh,S,async wd=>{wd=pc.a.qan()?await this.axm(wd):this.Wzi(wd);this._context.Cn.Dv();if(0===wd.count)return this.Mpa("Can't find the inserted content. Please refresh the page for the result.");this.sh.Hue(wd.K(0),
Fc,void 0,void 0,!0);this.sh.Hue(wd.K(wd.count-1),gd,void 0,void 0,!1);var te=new fb.a;te.addRange(wd);isNull(S)?(te=this.nk.create(te,this._context),this.nT(te)):this.nT(new Rr(this.TJm(te,this.gJc)));this.aJh&&this.vEe(e,wd,sc,td,Bd);C&&C.uza(e);pc.a.oP("FileApiOperations.SetOoxml",pc.a.fQ(this.Z4),n.length)},wd=>{this._context.Cn.Dv();E.ULS.sendTraceTag(17585566,369,10,"AppId:{0}, {1}",this._context.appId,tB.a[wd]);this.Mpa(tB.a[wd]);C&&C.uza(e);pc.a.oP("FileApiOperations.SetOoxml",pc.a.fQ(this.Z4),
n.length,!1)})}axm(e){return OfficeExtension.WacRuntime.Utility.createPromise(n=>{const C=(new Qj.a).create();C.message="Waiting...";C.aM(CommonUIStrings.l_DefaultDialogTitle,()=>{n(new fb.a)},null);var S=pc.a.ran();const ja=pc.a.san();let ya=0;S=new zg.a(2,2,1E3*S,kb=>{const Rb=this.Wzi(e,ya);if(Rb.count)return this.Zi.wf(kb),C.close(),n(Rb);ya++;if(ya>ja)return this.Zi.wf(kb),C.close(),n(new fb.a)});this.Zi.$b(S)})}Wzi(e,n=0){var C=new fb.a;e&&(C=this.hb.Kv(this.iDh,!0,!0),C=this.vGa.Tjc(e,C),C.count||
(C=this.ay.Hyi(),C=this.vGa.Tjc(e,C)));C.count||E.ULS.sendTraceTag(18354846,369,10,"AppId:{0}, Can't find the inserted content when setting ooxml, retryTime:{1}",this._context.appId,n);return C}SIo(e,n,C){this.vGa.aug(e,6,S=>{S?n(S):C("retrieved styles string is empty or null")},S=>{C(tB.a[S])})}TJm(e,n){const C=new fb.a;let S=0;switch(n){case 2:var ja=e.K(e.count-1);for(var ya of KE.create(ja.node,!0))C.add(this.Lxa.create(ya,this._context,S++));break;case 4:case 3:ya=e.K(0);for(ja of KE.create(ya.node))C.add(this.Lxa.create(ja,
this._context,S++))}return C}nnm(e,n){n=null;var C=e.node;let S=4;if(!C.ra)return{returnValue:0,Ow:0};C=C.ra.Dh(e.cpBegin);e=e.oo();if(C&&C.Hb&&0<C.Hb.length){C=C.Hb;const ja=C.length;!e&&C.K(0).Wc&&C.K(0).nq?(n=C.K(0).Xd,S=0):e||C.K(0).Wc||!C.K(0).nq?e<=ja&&0<e&&C.K(e-1).Wc&&C.K(e-1).nq?(n=C.K(e-1).Xd,S=2):e<ja&&0<e&&C.K(e-1).Wc&&!C.K(e-1).nq&&C.K(e).Wc?(n=C.K(e).Xd,S=0):e<=ja&&0<e&&!C.K(e-1).Wc&&(n=C.K(e-1).Xd,S=1):(n=C.K(0).Xd,S=3)}n=n?n.ka(hb.a.Ow,0):0;return{returnValue:S,Ow:n}}onm(e){let n=
null;var C=null;({BL:n}=this.Yc.dN(e.K(0),e.K(e.count-1),2));({BL:C}=this.Yc.dN(e.K(0),e.K(e.count-1),3));e=this.Avi(n,!0);C=this.Avi(C,!1);return e===C?e:0}Avi(e,n){let C=null;var S=e.node;if(!S.ra)return 0;S=S.ra.Dh(e.cpBegin);e=e.oo();if(S&&S.Hb&&0<S.Hb.length){S=S.Hb;const ja=S.length;n&&0<e&&S.K(e-1).Wc&&S.K(e-1).nq?C=S.K(e-1).Xd:!n&&e<ja&&!S.K(e).Wc&&S.K(e).nq&&(C=S.K(e).Xd)}return C?C.ka(hb.a.Ow,0):0}vEe(e,n,C,S=-1,ja=-1){if(!(0>=n.count||1===n.count&&n.K(0).contextId===Ma.a.Vc)){var ya=e.K(0),
kb=e.K(e.count-1),Rb=n.K(0),sc=n.K(n.count-1);switch(C){case 0:sc.contextId===Ma.a.Cd&&(e.W(0,ce.a.create(sc.node)),e.K(0).Tb=ya.qo(),this.Yc.Xv(e.K(0),0),n.removeAt(n.count-1));e.SA(0,n);break;case 1:case 2:sc.contextId===Ma.a.Zc&&e.removeAt(0);e.SA(0,n);break;case 3:(C=ya.cpEnd-ya.cpBegin)?(sc.contextId===Ma.a.Cd?(e.W(0,ce.a.createTextRange(sc.node,sc.cpBegin,sc.cpEnd+C)),n.removeAt(n.count-1)):e.W(0,ce.a.createTextRange(ya.node,0,C)),e.K(0).Tb=ya.qo(),this.Yc.Xv(e.K(0),0)):e.removeAt(0);e.SA(0,
n);break;case 5:case 6:sc.contextId===Ma.a.Cd?(e.W(0,ce.a.Wl(sc.node)),e.K(0).Fb=e.K(0).Tb=this.hb.Ex(sc.node)):e.W(0,n.K(n.count-1));break;case 7:C=ya.cpEnd-ya.cpBegin;sc.contextId===Ma.a.Cd?ya.contextId===Ma.a.Cd?(e.W(0,ce.a.createTextRange(ya.node,sc.cpEnd,sc.cpEnd+C)),this.Yc.wEa(e.K(0)),e.K(0).Tb=ya.qo()):(e.W(0,ce.a.Uc(ya.node,sc.cpEnd)),this.Yc.wEa(e.K(0)),e.K(0).Tb=e.K(0).Fb+ya.qo()-ya.oo()):(ya.contextId===Ma.a.Cd?e.W(0,ce.a.createTextRange(ya.node,0,C)):e.W(0,ce.a.Uc(ya.node,0)),this.Yc.ROa(e.K(0),
ya));break;case 4:sc.contextId===Ma.a.Cd&&(e.W(0,ce.a.createTextRange(sc.node,sc.cpEnd,sc.node.characterData.length)),e.K(0).Tb=ya.qo(),this.Yc.wEa(e.K(0)),e.insert(1,ce.a.Wl(sc.node)));break;case 9:kb.contextId===Ma.a.paragraph?(e.W(e.count-1,ce.a.create(Rb.node)),e.K(e.count-1).Fb=S,e.K(e.count-1).Tb=ja,n.removeAt(0)):e.removeAt(e.count-1);e.addRange(n);break;case 10:ya.contextId===Ma.a.Vc?e.clear():n.K(0).contextId!==Ma.a.Zc?(e.W(e.count-1,ce.a.createTextRange(n.K(0).node,kb.cpBegin,n.K(0).cpEnd)),
n.removeAt(0),e.K(e.count-1).Fb=kb.oo(),this.Yc.Xv(e.K(e.count-1),1)):(e.W(e.count-1,ce.a.createTextRange(n.K(0).node,kb.cpBegin,kb.cpEnd)),e.K(e.count-1).Fb=kb.oo());e.addRange(n);break;case 12:C=kb.cpEnd-kb.cpBegin;e.W(e.count-1,C?ce.a.createTextRange(Rb.node,kb.cpBegin,kb.cpEnd):ce.a.Uc(Rb.node,kb.cpBegin));e.K(e.count-1).Fb=kb.oo();e.K(e.count-1).Tb=kb.qo();break;case 13:e.clear(),e.addRange(n)}}}mLf(e){const n=new Ed.a;n.set(e);e=null;n.zb(10)&&(e=n.Dp(10));return e}}ru.bBh="<(?:p|li)(?:\\s|>|/)";
ru.cBh="<table(?:\\s|>|/)";Object(F.a)(ru,"FileApiOperations",null,[1196]);var VC=d(734),uB=d(402);class um{constructor(){this.RCg=this.formatting=null}}Object(F.a)(um,"TextFormattingActionData",null,[]);var bH=d(803),cH=d(1372),vB;(function(e){e[e.q9p=-1]="mixed";e[e.none=0]="none";e[e.hidden=5]="hidden";e[e.XZp=8]="dotLine";e[e.B_a=1]="single";e[e.word=2]="word";e[e.double=3]="double";e[e.jpq=6]="thick";e[e.Lhi=4]="dotted";e[e.YZp=20]="dottedHeavy";e[e.zYp=7]="dashLine";e[e.AYp=23]="dashLineHeavy";
e[e.BYp=39]="dashLineLong";e[e.CYp=55]="dashLineLongHeavy";e[e.VZp=9]="dotDashLine";e[e.WZp=25]="dotDashLineHeavy";e[e.Rpq=10]="twoDotDashLine";e[e.Spq=26]="twoDotDashLineHeavy";e[e.vrq=11]="wave";e[e.xrq=27]="waveHeavy";e[e.wrq=43]="waveDouble"})(vB||(vB={}));Object(F.b)("UnderlineType",vB);class WC extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd){super();this.U6b=this.Ld=null;this.iCb=e;this.WHb=n;this.Jrk=C;this.vx=S;this._context=ja;this._style=ya;this.ew=kb;this.hb=Rb;this.ga=sc;this.qoa=
Fc;this.BBd=null;this.Yoa=gd;this.vx&&this._context.upc&&(this.U6b=this.vx.Smc.create(this.vx.Xo))}get bold(){if(null!=this._style){if(this._style.hasProperty(Ee.a.bold))return this._style.getValue(Ee.a.bold)}else{var e=this.v_();return e.TTc?null:1===e.bold}}set bold(e){pc.a.Tx(e,"Font.Bold");if(null!=this._style){const n=new Map;n.set(Ee.a.bold,e);this.rD(n)}else this.Pwc(pe.a.bold,e)}get color(){if(null!=this._style){if(this._style.hasProperty(Ee.a.fontColor)){var e=this._style.getValue(Ee.a.fontColor);
return 16777215<e?"#000000":Yk.a.JB(e).toUpperCase()}}else return e=this.v_(),e.ePb?"":16777215<e.fontColor?"#000000":Yk.a.JB(e.fontColor).toUpperCase()}set color(e){e=pc.a.$Oa(e,"Font.Color",this._context);if(null!=this._style){const n=new Map;n.set(Ee.a.fontColor,Number("0x"+e));this.rD(n)}else this.ayg(pe.a.hx,e)}get doubleStrikeThrough(){if(null!=this._style){if(this._style.hasProperty(Ld.a.xu))return this._style.getValue(Ld.a.xu)}else{var e=this.v_();return e.CZc?null:1===e.xu}}set doubleStrikeThrough(e){pc.a.Tx(e,
"Font.DoubleStrikeThrough");if(null!=this._style){const n=new Map;n.set(Ld.a.xu,e);this.rD(n)}else this.Pwc(pe.a.xu,e)}get highlightColor(){if(null!=this._style){if(this._style.hasProperty(Ee.a.highlight)){var e=this._style.getValue(Ee.a.highlight);return 16777215<e?null:Yk.a.JB(e).toUpperCase()}}else return e=this.v_(),e.k6c?"":16777215<e.highlight?null:Yk.a.JB(e.highlight).toUpperCase()}set highlightColor(e){if(e&&""!==e)if(e=pc.a.$Oa(e,"Font.HighlightColor",this._context),null!=this._style){const n=
new Map;n.set(Ee.a.highlight,Number("0x"+e));this.rD(n)}else this.ayg(pe.a.rY,e);else null!=this._style?(e=new Map,e.set(Ee.a.highlight,null),this.rD(e)):this.ayg(pe.a.Vya,"")}get italic(){if(null!=this._style){if(this._style.hasProperty(Ee.a.italic))return this._style.getValue(Ee.a.italic)}else{var e=this.v_();return e.vpc?null:1===e.italic}}set italic(e){pc.a.Tx(e,"Font.Italic");if(null!=this._style){const n=new Map;n.set(Ee.a.italic,e);this.rD(n)}else this.Pwc(pe.a.fA,e)}get name(){if(null!=this._style){if(this._style.hasProperty(Ee.a.font))return this._style.getValue(Ee.a.font)}else{var e=
this.v_();return e.c1c?"":e.fontName}}set name(e){pc.a.hBc(e,"Font.Name");if(null!=this._style){const n=new Map;n.set(Ee.a.font,e);this.rD(n)}else this.ODa(pe.a.font,new VC.a(e))}get size(){if(null!=this._style){if(this._style.hasProperty(Ee.a.fontSize))return this._style.getValue(Ee.a.fontSize)/2}else{var e=this.v_();return e.d1c?null:e.fontSize/2}}set size(e){if(e>WC.BLn||e<WC.mOn)E.ULS.sendTraceTag(36312091,369,50,"Invalid font size: {0}.",e),pc.a.td();if(null!=this._style){const n=new Map;n.set(Ee.a.fontSize,
Math.round(2*e));this.rD(n)}else this.ODa(pe.a.pC,new VC.a(Math.round(2*e)))}get strikeThrough(){if(null!=this._style){if(this._style.hasProperty(Ee.a.strikethrough))return this._style.getValue(Ee.a.strikethrough)}else{var e=this.v_();return e.yyc?null:1===e.strikethrough}}set strikeThrough(e){pc.a.Tx(e,"Font.StrikeThrough");if(null!=this._style){const n=new Map;n.set(Ee.a.strikethrough,e);this.rD(n)}else this.Pwc(pe.a.strikethrough,e)}get subscript(){if(null!=this._style){if(this._style.hasProperty(Ee.a.subscript))return this._style.getValue(Ee.a.subscript)}else{var e=
this.v_();return e.yqd?null:1===e.subscript}}set subscript(e){pc.a.Tx(e,"Font.Subscript");if(null!=this._style){const n=new Map;n.set(Ee.a.subscript,e);this.rD(n)}else this.Pwc(pe.a.subscript,e)}get superscript(){if(null!=this._style){if(this._style.hasProperty(Ee.a.superscript))return this._style.getValue(Ee.a.superscript)}else{var e=this.v_();return e.zqd?null:1===e.superscript}}set superscript(e){pc.a.Tx(e,"Font.SuperScript");if(null!=this._style){const n=new Map;n.set(Ee.a.superscript,e);this.rD(n)}else this.Pwc(pe.a.superscript,
e)}get underline(){const e=[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0];if(null!=this._style){if(this._style.hasProperty(Ee.a.underlineType)){var n=this._style.getValue(Ee.a.underlineType);const C=this.hJi();return e[C.K(vB[n])]}}else return n=this.v_(),n.xV?-1:e[n.underlineType]}set underline(e){var n=this.hJi();n.tb(vB[e])||pc.a.td();null!=this._style?(n=new Map,n.set(Ee.a.underlineType,e),0!=e&&n.set(Ee.a.underline,!0),this.rD(n)):this.ODa(pe.a.sha,n.K(vB[e]))}get _ReferenceId(){return this.Hp?
this.Vp:null}_KeepReference(){this.xp()}_OnAccess(){if(null==this._style)switch(this.iCb){case 0:case 5:case 6:this.Ld=this.hb.NA(this.WHb,!0,!1);break;case 3:this.Ld=new fb.a;this.Ld.add(ce.a.create(this.WHb));break;case 1:this.Ld=this.Jrk.DF();break;case 4:G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.Ld=this.vx.Jsb?this.vx.Jsb.Xo:this.U6b?this.U6b.Xo:this.vx.Xo:this.Ld=this.vx.Xo;break;default:E.ULS.sendTraceTag(21824032,369,15,"AppId:{0}, invalid object type to set font on.",
this._context.appId)}}getTypeName(){return"Microsoft.WordServices.Font"}invokePropertyGet(e){switch(e){case 4:return this.bold;case 6:return this.color;case 11:return this.doubleStrikeThrough;case 12:return this.highlightColor;case 5:return this.italic;case 2:return this.name;case 3:return this.size;case 10:return this.strikeThrough;case 8:return this.subscript;case 9:return this.superscript;case 7:return this.underline;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 4:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 6:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 11:this.doubleStrikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 12:this.highlightColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 5:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 2:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.size=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number?");return;case 10:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 8:this.subscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean?");return;case 9:this.superscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 7:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}hJi(){const e=new fd.a;e.add("single",0);e.add("word",1);e.add("double",2);e.add("thick",3);e.add("dotted",4);e.add("dottedHeavy",5);e.add("dashLine",6);e.add("dashLineHeavy",7);e.add("dashLineLong",8);e.add("dashLineLongHeavy",9);e.add("dotDashLine",10);e.add("dotDashLineHeavy",11);e.add("twoDotDashLine",12);
e.add("twoDotDashLineHeavy",13);e.add("wave",14);e.add("waveHeavy",15);e.add("waveDouble",16);e.add("none",17);return e}Pwc(e,n){n=n?new os.a(1):new os.a(0);pc.a.Qzj()?this.Yoa.ODa(this.Ld,e,n):this.ODa(e,n)}ayg(e,n){this.ODa(e,n)}ODa(e,n){if(this.qoa.cVc(this.Ld,0)){var C=new uB.a;for(let S=0;S<this.Ld.count;S++)this.Ld.K(S).contextId!==Ma.a.Vc&&C.addContext(this.Ld.K(S));this.ga.Llg(C,e,2,!0,new wt.a,n)}}v_(){this._OnAccess();if(!this.BBd)if(pc.a.Qzj()){var e=this.Yoa.v_(this.Ld);e&&(this.BBd=e)}else{e=
[new Lf.Selection(this.Ld.toArray(),!0)];e=new yh.SelectionCollection(e,0);const n=new um;n.formatting=new bH.a;n.RCg=e;32===this.ga.Hf(new uq.a(null),pe.a.Aid,2,!0,new wt.a,n)&&(this.BBd=n.formatting)}return this.BBd}ikd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.U6b&&(this.U6b.exb(),this.U6b=null)}rD(e){const n=this._style.getValue(Ld.a.la),C=new od.ScriptSharpLegacyMap;for(const S of e)C.W(S[0],S[1]);this.ew.ubb(n,C,Gi.a.Np())}}WC.BLn=cH.a.Bcj/2;WC.mOn=1;Object(F.a)(WC,
"Font",Hh.a,[901]);class wB{constructor(e,n,C,S,ja){this.hb=e;this.ga=n;this.qoa=C;this.Yoa=S;this.ew=ja}create(e,n,C,S,ja,ya=null){return new WC(e,n,C,S,ja,ya,this.ew,this.hb,this.ga,this.qoa,this.Yoa)}}Object(F.a)(wB,"FontFactory",null,[]);class $z{constructor(e,n){this.ga=e;this.qoa=n}v_(e){e=[new Lf.Selection(e.toArray(),!0)];e=new yh.SelectionCollection(e,0);const n=new um;n.formatting=new bH.a;n.RCg=e;return 32===this.ga.Hf(new uq.a(null),pe.a.Aid,2,!0,new wt.a,n)?n.formatting:null}ODa(e,n,
C){if(this.qoa.cVc(e,0)){var S=new uB.a;for(let ja=0;ja<e.count;ja++)e.K(ja).contextId!==Ma.a.Vc&&S.addContext(e.K(ja));this.ga.Llg(S,n,2,!0,new wt.a,C)}}}Object(F.a)($z,"FontOperaions",null,[1194]);class xB{constructor(e,n){this.lx=e;this.uaf=n;this.pIh=[]}Dv(e=null,n=15){e||(e=this.lx.value);n=this.uaf.Lc(n);n.Ab(e);this.pIh.push(n)}CF(){this.pIh.pop().dispose()}sec(e){this.CF();this.Dv(e,4)}}Object(F.a)(xB,"GraphTransactionWrapper",null,[1193]);var yB=d(1899);class Ov{constructor(e,n,C,S,ja,ya,
kb,Rb,sc){this.LY=e;this.hq=n;this.hb=C;this.Vu=S;this.AG=ja;this.avk=ya;this.If=kb;this.Aa=Rb;this.$r=sc}KJf(e,n){pc.a.bPa(n,"GraphNode");const C=this.LY.U1c(n,5);this.Rzi(C,n,e)}B6d(e,n){pc.a.Tx(n,"GraphNodeContext");const C=this.LY.Bti(n);this.Rzi(C,n.node,e)}Rzi(e,n,C){for(const S of e){e=!1;const ja=gc.a.instance.Oa("Box4.IFeatureHelper");if(this.hq.knc(S)||this.hq.inc(S)||this.hq.jnc(S)||this.hq.lnc(S)||ja&&ja.isFeatureEnabled(42)&&this.hq.mnc(S))e=!0;e&&(e=S.Ib.cp,C.add(ce.a.createTextRange(n,
e,e+1)))}}lSb(e,n,C,S){pc.a.hBc(e,"imgBase64Str");e=e.trim();return OfficeExtension.WacRuntime.Utility.createPromise((ja,ya)=>{var kb=n.node,Rb=new Ed.a;Rb.set(kb);const sc=this.avk.create(Rb,ja,ya),Fc=document.createElement("img");ja=()=>{const gd=new yB.a(Fc.src,Fc.alt,Fc.width,Fc.height);this.WAf(sc,gd,n,C)};kb=()=>{ya("")};G.AFrameworkApplication.dv&&S?(S.useSourceImageProps&&(S.height=0,S.width=0),this.WAf(sc,this.nwm(e,S),n,C)):(Rb=!1,(Rb=void 0!==Fc.onload&&void 0!==Fc.onerror)?(Fc.onload=
ja,Fc.onerror=kb,Fc.src=String.format("data:image/png;base64,{0}",e)):this.WAf(sc,this.mwm(e),n,C))})}mwm(e){const n=document.createElement("img");n.src=String.format("data:image/{0};base64,{1}","png",e);return new yB.a(n.src,n.alt,n.width,n.height)}nwm(e,n){return new yB.a(e,n.altText?n.altText:"",n.width,n.height)}Qni(e,n){if(n&&5===n.Sh){n=n.id;e=this.LY.U1c(e,5);for(const C of e)if(C.id.equals(n))return C.Ib.cp}return-1}B8l(e,n){let C=this.Qni(e,n);return 0>C&&({node:e,returnValue:C}=this.C8l(n),
0>C)?{returnValue:-1,gMh:e}:{returnValue:C,gMh:e}}C8l(e){var n=this.Hyi();for(const C of n)if(n=this.Qni(C,e),-1!==n)return e=C,{returnValue:n,node:e};return{returnValue:-1,node:null}}t0c(e){const n=(new Date).getTime();let C=null;e=({gMh:C}=this.B8l(e.node,e.blob)).returnValue;pc.a.oP("ImageApiOperations.FindImageContextFromResult",pc.a.fQ(n));return 0>e?(E.ULS.sendTraceTag(17433739,369,10,"the inserted inline picture can't be found"),pc.a.hg(),null):ce.a.createTextRange(C,e,e+1)}getBase64ImageSrc(e,
n,C,S,ja,ya){const kb=this.hq.a9(e.properties,Gh.a.Bu,null);kb?this.hq.g3(kb)?(this.oFi(e,kb,S),C.Cn.Dv(n.node)):(E.ULS.sendTraceTag(23594887,369,15,"AppId:{0}, Not valid ImageDataUrl.",C.appId),pc.a.hg()):this.dwm(n,e,C,S,ja,ya)}dwm(e,n,C,S,ja,ya){const kb=n.properties,Rb=this.hq.VJa(kb,e.node.Hj().ud,this.Aa,this.$r);this.hq.TTb(Rb)?this.hq.Z8a(this.If,Rb,sc=>{let Fc=!0;const gd=sc.data.Pe;2===sc.data.status&&this.hq.g3(gd)?(this.oFi(n,gd,S),kb.setValue(Gh.a.Bu,gd)):(ja(""),Fc=!1);C.Cn.Dv(e.node);
pc.a.oP("ImageApiOperations.GetImageSrcFromServer",pc.a.fQ(ya),void 0,Fc)},()=>{ja("");C.Cn.Dv(e.node);pc.a.oP("ImageApiOperations.GetImageSrcFromServer",pc.a.fQ(ya),void 0,!1)}):(E.ULS.sendTraceTag(23594888,369,15,"AppId:{0}, ImageDataUrl null, but not supported data url request.",C.appId),pc.a.hg())}oFi(e,n,C){let S=null;const ja=document.createElement("img");ja.src=n;ja.onload=()=>{var ya=new ii.a;const kb=ya.xf(this.hq.FF(e.properties),0);ya=ya.xf(this.hq.rL(e.properties),1);const Rb=document.createElement("canvas");
Rb.width=kb;Rb.height=ya;Rb.getContext("2d").drawImage(ja,0,0,kb,ya);S=Rb.toDataURL();C(S.substr(S.indexOf(";base64,")+8))}}Hyi(){const e=new Ed.a;e.set(this.Vu.value);this.AG.ZR(e);return this.hb.Kv(this.AG.qLf(e.currentNode),!0,!0)}WAf(e,n,C,S){e.J_n(n,C);S.Cn.CF();e.pfg()}}Object(F.a)(Ov,"ImageApiOperations",null,[1192]);class XC extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le){super();pc.a.Tx(e,"GraphNodeContext");this.Wq=e;this._context=n;this._id=C;this.zo=S;this.nk=ja;
this.iO=ya;this.hq=kb;this.Dk=Rb;this.yda=this.r6d(this.Wq);this.ay=sc;this.sh=Fc;this.Lq=gd;this.Yc=td;this.px=Bd;this.Hl=wd;this.hb=te;this.ld=Le}get altTextDescription(){return this.hq.AVa(this.yda.properties)}set altTextDescription(e){this.Dk.y_b(this.yda.properties,e)}get altTextTitle(){return this.hq.x_(this.yda.properties)}set altTextTitle(e){this.Dk.g_a(this.yda.properties,e)}get height(){const e=this.hq.rL(this.yda.properties);return oi.a.wbb(e)}set height(e){pc.a.D0a(e,"InlinePicture.Height");
e=oi.a.rua(e);this.lockAspectRatio&&this.Dk.JNa(this.yda.properties,this.width/this.height*e);this.Dk.INa(this.yda.properties,e)}get hyperlink(){return this.hq.Qjc(this.yda.properties)}set hyperlink(e){this.Dk.VVo(this.yda.properties,e)}get imageFormat(){return 0}get lockAspectRatio(){return this.hq.Y$a(this.yda.properties)}set lockAspectRatio(e){this.Dk.eOj(this.yda.properties,e)}get paragraph(){return this.zo.create(this.Wq.node,this._context)}get parentContentControl(){const e=this.parentContentControlOrNullObject;
e||pc.a.Wk();return e}get parentContentControlOrNullObject(){this.qfb();return this.sh.Skc(this.Wq,this.Wq,this._context)}get parentTable(){if(!pc.a.ej())return null;const e=this.parentTableOrNullObject;e||pc.a.Wk();return e}get parentTableCell(){if(!pc.a.ej())return null;const e=this.parentTableCellOrNullObject;e||pc.a.Wk();return e}get parentTableCellOrNullObject(){return pc.a.ej()?this.ld.vkc(this.Wq.node,this._context):null}get parentTableOrNullObject(){return pc.a.ej()?this.ld.drb(this.Wq.node,
this._context):null}get width(){const e=this.hq.FF(this.yda.properties);return oi.a.wbb(e)}set width(e){pc.a.D0a(e,"InlinePicture.Width");e=oi.a.rua(e);this.lockAspectRatio&&this.Dk.INa(this.yda.properties,this.height/this.width*e);this.Dk.JNa(this.yda.properties,e)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}deleteInlinePicture(){this.qfb();const e=this.Wq.node;for(let n=0;n<e.ra.length;n++)if(e.ra.Ub(n).cp===this.Wq.cpBegin){this.Yc.QQl(this.Wq);break}}getBase64ImageSrc(){const e=
(new Date).getTime();this._context.Cn.CF();return OfficeExtension.WacRuntime.Utility.createPromise((n,C)=>{this.ay.getBase64ImageSrc(this.yda,this.Wq,this._context,n,C,e)})}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){pc.a.ej()||pc.a.Kj();const e=this.GBm();return e?this.iO.create(e,this._context):null}getRange(e){pc.a.ej()||pc.a.Kj();1!==e&&2!==e&&e&&(E.ULS.sendTraceTag(18745293,369,15,"AppId:{0}, rangeLocation of InlinePicture.GetRange must be Start/End/Whole.",
this._context.appId),pc.a.td());const n=new fb.a;n.add(this.Wq);this.qfb();return this.nk.create(this.Hl.DPb(n,e),this._context)}insertBreak(e,n){n&&1!==n&&(E.ULS.sendTraceTag(17339015,369,15,"AppId:{0}, insertLocation of InlinePicture.InsertBreak must be Before or After.",this._context.appId),pc.a.td());const C=(new Date).getTime(),S=new fb.a;S.add(this.Wq);this.qfb();return OfficeExtension.WacRuntime.Utility.createPromise((ja,ya)=>{this.Yc.insertBreak(S,e,n,this._context,ja,ya,C)})}insertContentControl(){this.qfb();
const e=new fb.a;e.add(this.Wq);this.sh.ngf(e);1!==e.count&&(E.ULS.sendTraceTag(37777540,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),pc.a.hg());return e.K(0)!==this.Wq?this.sh.sqa(e.K(0),e.K(0),this._context):this.sh.t5a(this.Wq,this._context)}insertFileFromBase64(e,n){"<"===e.charAt(0)&&(E.ULS.sendTraceTag(18130837,369,10,"invalid argument for insertFileFromeBase64 API in InlinePicture class.",this._context.appId),pc.a.td());return this.Nla(e,n,!1)}insertHtml(e,
n){const C=(new Date).getTime();if(!n||1===n){const S=new fb.a;S.add(this.Wq);return this.px.insertHtml(S,e,n,C,this._context)}pc.a.td();return null}insertInlinePictureFromBase64(e,n){if(2===n||3===n)return E.ULS.sendTraceTag(17319648,369,50,"AppId:{0}, insert inline picture with none supported location in InlinePicture class.",this._context.appId),pc.a.td(),null;const C=(new Date).getTime();let S=null;this.qfb();if(4===n){let ja;this.Yc.FW((ja=new fb.a,ja.add(this.Wq),ja),n,0);S=ce.a.Uc(this.Wq.node,
this.Wq.cpBegin);S.Fb=S.Tb=this.Wq.oo();this.deleteInlinePicture()}else{({BL:S}=this.Yc.dN(this.Wq,this.Wq,n));let ja;this.Yc.FW((ja=new fb.a,ja.add(S),ja),n,0)}return this.ay.lSb(e,S,this._context).then(ja=>{this._context.Cn.Dv(this.Wq.node);if(!ja)return E.ULS.sendTraceTag(17433740,369,10,"AppId:{0}, something went wrong when insert iamge into InlinePicture.",this._context.appId),pc.a.oP("InlinePicture.InsertInlinePictureFromBase64",pc.a.fQ(C),e.length,!1),pc.a.hg(),null;pc.a.oP("InlinePicture.InsertInlinePictureFromBase64",
pc.a.fQ(C),e.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.iO.create(this.ay.t0c(ja),this._context))})}insertOoxml(e,n){"<"!==e.charAt(0)&&(E.ULS.sendTraceTag(18130838,369,10,"invalid argument for InsertOoxml API in InlinePicture class.",this._context.appId),pc.a.td());return this.Nla(e,n,!0)}insertParagraph(e,n){n&&1!==n&&(E.ULS.sendTraceTag(21070049,369,15,"AppId:{0}, Invalid insert location for InlinePicture.InsertPparagraph method.",this._context.appId),pc.a.td());
this.qfb();let C;return this.zo.create(this.Yc.insertParagraph((C=new fb.a,C.add(this.Wq),C),e,n),this._context)}insertText(e,n){n&&1!==n&&(E.ULS.sendTraceTag(17339328,369,15,"AppId:{0}, invalid location for InlinePicture.InsertText:{1}.",this._context.appId,bt.a[n]),pc.a.td());this.qfb();let C;return this.nk.create(this.Yc.insertText((C=new fb.a,C.add(this.Wq),C),e,n),this._context)}select(e){const n=new fb.a;n.add(this.Wq);this.Lq.select(n,e)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.Wq.node,
"InlinePicture")}getTypeName(){return"Microsoft.WordServices.InlinePicture"}invokePropertyGet(e){switch(e){case 3:return this.altTextDescription;case 4:return this.altTextTitle;case 5:return this.height;case 6:return this.hyperlink;case 11:return this.imageFormat;case 7:return this.lockAspectRatio;case 10:return this.paragraph;case 9:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 14:return this.parentTable;case 13:return this.parentTableCell;case 16:return this.parentTableCellOrNullObject;
case 17:return this.parentTableOrNullObject;case 8:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 3:this.altTextDescription=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.altTextTitle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 6:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.lockAspectRatio=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 8:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1012:return this.VC(n);case 1015:return this.i7();case 1016:return this.j7();case 1014:return this.ofa(n);case 1004:return this.RKa(n);case 1010:return this.Qsa(n);case 1007:return this.TKa(n);case 1013:return this.gha(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,
n){switch(e){case 1003:return this.Uim();case 1006:return this.j$a(n);case 1011:return this.Osa(n);case 1008:return this.m$a(n);case 1005:return this.n$a(n);case 1009:return this.r$a(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteInlinePicture();return null}Uim(){return this.getBase64ImageSrc()}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}ofa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");
return this.getRange(e)}j$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(n,e)}RKa(){return this.insertContentControl()}Osa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(n,e)}m$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(n,e)}n$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(n,e)}r$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(n,e)}Qsa(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(n,e)}TKa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(n,e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();
return null}r6d(e){return this.hq.eKa(e)}GBm(){if(!this.Wq)return null;const e=new fb.a;if(this.Wq.cpEnd!==this.Wq.node.characterData.length){var n=ce.a.createTextRange(this.Wq.node,this.Wq.cpEnd,this.Wq.node.characterData.length);this.ay.B6d(e,n);if(e.count)return e.K(0)}for(n=this.hb.pg(this.Wq.node,!1,!0);n;){this.ay.KJf(e,n);if(e.count)return e.K(0);n=this.hb.pg(n,!1,!0)}return null}Nla(e,n,C){const S=(new Date).getTime();if(!n||1===n){this.qfb();const ja=new fb.a;ja.add(this.Wq);return OfficeExtension.WacRuntime.Utility.createPromise((ya,
kb)=>{this.px.insertOoxml(ja,e,n,this.Wq.node,this._context,ya,kb,S,C?0:1)})}E.ULS.sendTraceTag(18130839,369,15,"AppId:{0}, InlinePicture.InsertOoxmlOrDocx: undefined location!",this._context.appId);pc.a.td();return null}qfb(){const e=this.hb.wm(this.Wq.node,this.Wq.cpBegin),n=this.hb.wm(this.Wq.node,this.Wq.cpEnd);this.Wq.Fb=0<e?e:-1;this.Wq.Tb=0<n?0:-1}}Object(F.a)(XC,"InlinePicture",Hh.a,[901]);class HJ{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc){this.nk=this.zo=null;this.hq=e;this.Dk=n;this.ay=C;this.sh=
S;this.Lq=ja;this.Yc=ya;this.px=kb;this.Hl=Rb;this.hb=sc;this.ld=Fc}su(e,n){this.zo=e;this.nk=n}create(e,n,C=0){return new XC(e,n,C,this.zo,this.nk,this,this.hq,this.Dk,this.ay,this.sh,this.Lq,this.Yc,this.px,this.Hl,this.hb,this.ld)}}Object(F.a)(HJ,"InlinePictureFactory",null,[1080]);var dH=d(1947),ay=d(336),aA=d(570);class pv{constructor(e,n,C,S,ja,ya){this.nyf=ya;this.Tgb=this.m1a=-1;this.LQe=this.N8e=null;this.IQe=!1;this.Dph=!0;this.GAh=null;this.Rd=n;this.Pi=C;this.nQa=S;this.Lq=ja;this.uza(e)}get cDa(){return this.GAh||
(this.GAh=Wc.a.create())}get nzb(){const e=this.nQa.Eb(this.cDa);return e?this.N8e=this.Pi.value.Eb(e.I_a):null}set nzb(e){this.N8e=e}get Xza(){const e=this.nQa.Eb(this.cDa);return e?this.LQe=this.Pi.value.Eb(e.Wza):null}set Xza(e){this.LQe=e}get Xo(){var e=this.F8d(!0).returnValue;const n=this.F8d(!1).returnValue;if(!e||!n)return null;const C=ce.a.Uc(e.paragraph,e.cp),S=ce.a.Uc(n.paragraph,n.cp);if(!e.Hb||!e.Hb.length)this.m1a=-1;else if(e.Hb&&0<e.Hb.length&&-1===this.m1a||this.m1a>e.Hb.length)this.m1a=
e.Hb.length;if(!n.Hb||!n.Hb.length)this.Tgb=-1;else if(n.Hb&&0<n.Hb.length&&-1===this.Tgb||this.Tgb>n.Hb.length)this.Tgb=0;this.IQe&&this.M3k(n);C.Fb=this.m1a;S.Tb=this.Tgb;e=this.Lq.xyi(C,S,this.IQe);if(!e||!e.count)return null;1===e.count&&(e.K(0).contextId===Ma.a.Zc||e.K(0).contextId===Ma.a.Vc&&(this.Dph||this.Tgb<this.m1a))&&(e.K(0).Fb=e.K(0).Tb=this.m1a);return e}M3k(e){if(!e.ni){const n=this.O6(e.paragraph,e.paragraph.characterData.length);for(let C=0;C<e.mi.length;C++){const S=e.mi.K(C);if(S.uo.equals(this.cDa)){n.mi||
(n.mi=new ay.a(n));n.mi.add(S.Of(n));e.mi.remove(S);e.mi.length||(e.mi=null);break}}}}uza(e){if(G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&e&&e.count){var n=e.K(0),C=e.K(e.count-1);this.nQa.tYk(this.cDa,n.node.id,C.node.id);if(1===e.count)this.eWm(e.K(0));else{switch(n.contextId){case Ma.a.paragraph:e=this.O6(n.node,0);break;case Ma.a.Zc:e=this.O6(n.node,n.node.characterData.length);break;case Ma.a.Cd:e=this.O6(n.node,n.cpBegin);break;case Ma.a.Vc:e=this.O6(n.node,n.cpBegin);
break;default:return}var S=!1;switch(C.contextId){case Ma.a.paragraph:var ja=this.O6(C.node,C.node.characterData.length);S=!0;break;case Ma.a.Cd:ja=this.O6(C.node,C.cpEnd);break;case Ma.a.Zc:ja=this.O6(C.node,C.node.characterData.length);S=!0;break;case Ma.a.Vc:ja=this.O6(C.node,C.cpEnd);break;default:return}this.m1a=n.Fb;this.Tgb=C.Tb;e.mi.add(new aA.a(e,null,this.cDa,this.nQa,!0));ja.mi.add(new aA.a(ja,null,this.cDa,this.nQa,!1,S))}}}eWm(e){let n=!1,C,S;switch(e.contextId){case Ma.a.Vc:C=S=this.O6(e.node,
e.cpBegin);this.Dph=e.Fb===e.Tb;break;case Ma.a.Zc:C=S=this.O6(e.node,e.node.characterData.length);n=!0;break;case Ma.a.Cd:C=this.O6(e.node,e.cpBegin);S=this.O6(e.node,e.cpEnd);break;case Ma.a.paragraph:C=this.O6(e.node,0);S=this.O6(e.node,e.node.characterData.length);n=!0;break;default:return}this.m1a=e.Fb;this.Tgb=e.Tb;C.mi.add(new aA.a(C,null,this.cDa,this.nQa,!0));S.mi.add(new aA.a(S,null,this.cDa,this.nQa,!1,n))}exb(){if(aA.a.qjf){var e=this.PEm();this.nyf.kyo(e,this.cDa)}else{var n=({vua:e}=
this.F8d(!1)).returnValue;this.WBj(n,!1,e);n=({vua:e}=this.F8d(!0)).returnValue;this.WBj(n,!0,e);this.nQa.gV(this.cDa)}}PEm(){const e=this.nzb,n=this.Xza;if(e&&n&&e.id.equals(n.id))return[e];const C=[];e&&C.push(e);n&&C.push(n);return C}WBj(e,n,C){if(e&&e.mi){var S=n?this.nzb:this.Xza;for(let ja=0;ja<e.mi.length;ja++)if(e.mi.K(ja).uo.equals(this.cDa)&&e.mi.K(ja).Wc===n){e.mi.remove(e.mi.K(ja));if(!e.mi.length)if(e.mi=null,e.isEmpty){S.ra.remove(e);break}else if(0<e.cp&&e.FXf&&e.formatting&&C&&e.formatting.equals(C)){if((n=
e.paragraph.ra.Dh(e.cp-1))&&n.blob)break;S.ra.remove(e);break}break}}else E.ULS.sendTraceTag(20813538,369,50,"There should be some DynamicRangeObject on this chp, but unfortunately no.")}F8d(e){let n=null;const C=e?this.nzb:this.Xza;if(!C||!C.ra||!C.ra.length)return{returnValue:null,vua:n};for(let S=0;S<C.ra.length;S++){const ja=C.ra.Ub(S);if(ja.mi)for(let ya=0;ya<ja.mi.length;ya++)if(ja.mi.K(ya).uo.equals(this.cDa)&&ja.mi.K(ya).Wc===e)return e||(this.IQe=ja.mi.K(ya).U9h),1<=S&&(n=C.ra.Ub(S-1).formatting),
{returnValue:ja,vua:n}}return{returnValue:null,vua:n}}O6(e,n){this.Rd.ueb(ce.a.Uc(e,n));e=e.o_(n);e.mi||(e.mi=new ay.a(e));return e}}Object(F.a)(pv,"InternalRange",null,[]);class LE{constructor(e,n,C,S,ja,ya,kb){this.LWb=(Rb,sc)=>{this.Zzd.lgf(sc)};this.Rd=e;this.Pi=C;this.nQa=S;this.Zzd=ja;this.Lq=ya;kb.wff(this.LWb)}create(e){return new pv(e,this.Rd,this.Pi,this.nQa,this.Lq,this.Zzd)}}Object(F.a)(LE,"InternalRangeFactory",null,[]);class dJ{constructor(e,n,C){this.R$g="";this.NAd=0;this.vK=e;this._id=
n;this.tB=C}get id(){return this._id}_RegisterStateChange(){this.NAd||(OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.tB,this._id,1),this.R$g=this.vK.Cua(this._id,e=>{OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(e.featureName,1,e)}));this.NAd++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.NAd--;this.NAd||this.vK.iZb(this._id,this.R$g);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(e){switch(e){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 6:return this.Llk();case 7:return this.Vlk()}e=
this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Llk(){return this._RegisterStateChange()}Vlk(){return this._UnregisterStateChange()}}Object(F.a)(dJ,"LicenseFeature",null,[]);class Ro{get scopes(){return null}set scopes(e){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(e){switch(e){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,
n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(F.a)(Ro,"MsaDeviceTicketOptions",null,[]);class YC{constructor(e,n,C){this.vK=e;this.Z0=n;this.tB=C}getFeatureTier(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{this.vK.getFeatureTier(e,1===n?1:2===n?2:0).then(S=>{C(this.rym(S))},()=>{C(n)})})}getLicenseFeature(e){e=new dJ(this.vK,e,this.tB);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}getMsaDeviceTicket(){pc.a.Kj();
return null}isFeatureEnabled(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{this.vK.isFeatureEnabled(e,n).then(S=>{C(S)},()=>{C(n)})})}isFreemiumUpsellEnabled(){const e=this.vK.isFreemiumUpsellEnabled();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}launchUpsellExperience(e){if(this.Z0.yt.getOsfControl(this.tB).isFirstParty())return this.vK.launchUpsellExperience(e),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null);throw OfficeExtension.WacRuntime.Utility.createRichApiException(qu.a.$Jb,
"Access Denied");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
n){switch(e){case 7:return this.YAm(n);case 6:return this.Slk(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 2:return this.ism(n);case 5:return this.qym(n);case 1:return this.ekn(n);case 3:return this.Zkn();case 4:return this.lzn(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ism(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.getFeatureTier(n,e)}qym(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getLicenseFeature(e)}YAm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,Ro);return this.getMsaDeviceTicket(n,C,e)}ekn(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.isFeatureEnabled(n,e)}Zkn(){return this.isFreemiumUpsellEnabled()}lzn(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.launchUpsellExperience(e)}Slk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this._TestFireStateChangedEvent(e);return null}rym(e){switch(e){case 1:return 1;case 2:return 2;default:return 0}}}Object(F.a)(YC,"License",null,[]);
class zB{constructor(e,n){this.Z0=e;this.Onk=n}create(e){return new YC(this.Onk,this.Z0,e)}}Object(F.a)(zB,"LicenseFactory",null,[]);class eH extends Hh.a{constructor(e,n,C,S,ja,ya,kb){super();pc.a.bPa(e,"List");this.y1a=e;this.d3a=n;this._context=C;this.Xn=S;this.zo=ja;this.Yc=ya;this.hb=kb;this.Ida=this.Xn.wAa(this.d3a,this.y1a)}get id(){return this.d3a}get levelExistences(){if(!this.Ida)return null;const e=Array(pc.a.yma);for(var n=0;n<e.length;n++)e[n]=!1;for(n=0;n<this.Ida.count;n++){const C=
this.Xn.oU(this.Ida.K(n));-1!==C&&(e[C]=!0)}return e}get levelTypes(){return this.Xn.lzm(this.Ida.K(0))}get paragraphs(){const e=new fb.a;for(let n=0;n<this.Ida.count;n++)e.add(this.zo.create(this.Xn.AAa(this.Ida.K(n)),this._context));return new jv(e)}get _ReferenceId(){return this.Hp?this.Vp:null}getLevelFont(){return null}getLevelParagraphs(e){(0>e||e>=pc.a.yma)&&pc.a.td();const n=new fb.a;for(let C=0;C<this.Ida.count;C++)e===this.Xn.oU(this.Ida.K(C))&&n.add(this.zo.create(this.Xn.AAa(this.Ida.K(C)),
this._context));return new jv(n)}getLevelPicture(){return null}getLevelString(e){return this.Xn.getLevelString(this.d3a,this.y1a,e)}insertParagraph(e,n){var C=null;let S=n,ja=null;2!==n&&n?3===n||1===n?(S=1,C=this.Xn.AAa(this.Ida.K(this.Ida.count-1)),ja=this.Yc.$6a(C,!1)):pc.a.td():(S=0,C=this.Xn.AAa(this.Ida.K(0)),ja=this.Yc.$6a(C,!0));var ya=null,kb=!1;n&&1!==n||(kb=n?!1:!0,ya=this.hb.pg(C,kb,!0));let Rb;C=this.Yc.insertParagraph((Rb=new fb.a,Rb.add(ja),Rb),e,S);if(!C)return null;e=this.zo.create(C,
this._context);n&&1!==n||(this.Xn.detachFromList(C),ya&&(n=this.zo.create(ya,this._context),e.style=n.style,ya=ya.ra,kb&&0<ya.length?(kb=ya.Ub(ya.length-1).Zqa(null))&&!kb.formatting&&1<ya.length&&(kb=ya.Ub(ya.length-2).Zqa(null)):kb=ya.first.Zqa(null),C=C.ra,C.Ub(0).formatting=kb.formatting.Of(C.Ub(0)),e.leftIndent=n.leftIndent,e.firstLineIndent=n.firstLineIndent));return e}resetLevelFont(){}setLevelAlignment(e,n){this.Xn.setLevelAlignment(this.d3a,this.y1a,e,this.Qym(n))}setLevelBullet(e,n,C,S){(0>
e||e>=pc.a.yma)&&pc.a.td();0===n&&0>=C&&pc.a.td();this.Xn.setLevelBullet(this.y1a,this.d3a,e,n,C,S)}setLevelIndents(e,n,C){this.Xn.MWo(this.d3a,this.y1a,e,n,C)}setLevelNumbering(e,n,C){(0>e||e>=pc.a.yma)&&pc.a.td();-1!==n||C||pc.a.td();this.Xn.setLevelNumbering(this.y1a,this.Ida.K(0),this.d3a,e,n,C)}setLevelPicture(){}setLevelStartingNumber(e,n){this.Xn.setLevelStartingNumber(this.d3a,this.y1a,e,n)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.y1a,"List");this.Ida=this.Xn.wAa(this.d3a,this.y1a);
pc.a.Tx(this.Ida,"List")}getTypeName(){return"Microsoft.WordServices.List"}invokePropertyGet(e){switch(e){case 1:return this.id;case 5:return this.levelExistences;case 4:return this.levelTypes;case 3:return this.paragraphs;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1010:return this.kym(n);case 1004:return this.mym(n);case 1009:return this.nym(n);case 1007:return this.pym(n);case 1003:return this.Qsa(n);case 1011:return this.XGo(n);case 1012:return this.xWo(n);case 1005:return this.yWo(n);case 1013:return this.zWo(n);case 1006:return this.AWo(n);case 1008:return this.BWo(n);case 1014:return this.DWo(n);
case 1001:return this.jh();case 1002:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}kym(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getLevelFont(e)}mym(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getLevelParagraphs(e)}nym(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");return this.getLevelPicture(e)}pym(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getLevelString(e)}Qsa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(n,e)}XGo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");this.resetLevelFont(n,
e);return null}xWo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this.setLevelAlignment(n,e);return null}yWo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"string");
this.setLevelBullet(n,C,S,e);return null}zWo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"number");this.setLevelIndents(n,C,e);return null}AWo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"Array<any>");this.setLevelNumbering(n,C,e);return null}BWo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");this.setLevelPicture(n,e);return null}DWo(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this.setLevelStartingNumber(n,e);return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();
return null}Qym(e){let n="";switch(e){case 0:n="left";break;case 2:n="right";break;case 1:n="center";break;default:E.ULS.sendTraceTag(21067539,369,10,"AppId:{0}, in function List.SetLevelAlignment, the alignment parameter should be Left/Right/Centered.",this._context.appId),pc.a.td()}return n}}Object(F.a)(eH,"List",Hh.a,[901]);class fH{constructor(e,n){this.zo=this.Xn=null;this.Yc=e;this.hb=n}su(e,n){this.Xn=e;this.zo=n}create(e,n,C){return new eH(e,n,C,this.Xn,this.zo,this.Yc,this.hb)}}Object(F.a)(fH,
"ListFactory",null,[]);class gH extends Hh.a{constructor(e,n,C,S,ja){super();pc.a.bPa(e,"ListItem");this.cja=e;this._context=n;this.Xn=C;this.zo=S;this.JKc=ja}get level(){return this.Xn.oU(this.cja)}set level(e){(e>=pc.a.yma||0>e)&&pc.a.td();this.Xn.oU(this.cja)!==e&&this.Xn.vyg(this.cja,e)}get listString(){const e=this.Xn.rQb(this.cja);return this.JKc.HXa(e).FU}get siblingIndex(){const e=this.Xn.oU(this.cja),n=this.KHf();let C=0;for(let S=0;S<n.count;S++)if(this.Xn.oU(n.K(S))===e){if(this.cja.id.equals(n.K(S).id))return C;
C++}return-1}get _ReferenceId(){return this.Hp?this.Vp:null}getAncestor(e){(e=this.getAncestorOrNullObject(e))||pc.a.Wk();return e}getAncestorOrNullObject(e){const n=this.Xn.oU(this.cja),C=this.KHf();var S=0;for(var ja=0;ja<C.count;ja++)this.cja.id.equals(C.K(ja).id)&&(S=ja);for(--S;0<=S;S--)if(ja=this.Xn.oU(C.K(S)),ja<n&&(e&&ja===n-1||!e))return this.zo.create(this.Xn.AAa(C.K(S)),this._context);return null}getDescendants(e){const n=this.Xn.oU(this.cja),C=this.KHf();var S=0;for(var ja=0;ja<C.count;ja++)this.cja.id.equals(C.K(ja).id)&&
(S=ja);ja=new fb.a;for(S+=1;S<C.count;S++){const ya=this.Xn.oU(C.K(S));if(ya>n)(e&&ya===n+1||!e)&&ja.add(this.zo.create(this.Xn.AAa(C.K(S)),this._context));else break}return new jv(ja)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.cja,"ListItem");const e=this.Xn.rQb(this.cja);pc.a.Q0(e,"ListItem")}getTypeName(){return"Microsoft.WordServices.ListItem"}invokePropertyGet(e){switch(e){case 4:return this.level;case 3:return this.listString;case 2:return this.siblingIndex;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 4:this.level=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.Qhm(n);
case 1005:return this.Rhm(n);case 1004:return this.Qpm(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Qhm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return this.getAncestor(e)}Rhm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return this.getAncestorOrNullObject(e)}Qpm(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return this.getDescendants(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}KHf(){let e;e=uj.ListItemReader.nla(this.cja,{Ara:-1}).listId;const n=new Ed.a;n.set(this.cja);n.Ks();let C=n.mt(36);C||(C=n.mt(8));return this.Xn.wAa(e,C)}}Object(F.a)(gH,"ListItem",Hh.a,[901]);class ME{constructor(e,n){this.zo=null;this.Xn=e;this.JKc=n}su(e){this.zo=e}create(e,n){return new gH(e,n,this.Xn,this.zo,this.JKc)}}
Object(F.a)(ME,"ListItemFactory",null,[]);var NE=d(57);class OE{constructor(e,n,C,S,ja,ya){this.CI=ya;this.hb=e;this.SZe=n;this.lg=C;this.DM=S;this.JKc=ja}getLevelString(e,n,C){(0>C||C>=pc.a.yma)&&pc.a.td();(n=this.wAa(e,n))&&n.count||pc.a.hg();for(var S=0;S<n.count;S++)if(this.oU(n.K(S))===C)return e=this.rQb(n.K(S)),this.JKc.HXa(e).FU;S="";var ja=this.lg.Yy(n.K(0),e,C),ya=Iv.a.naa(ja,null);if(1===ya.listType)S=ya.levelText;else if(ya.listType)pc.a.hg();else if(S=ya.levelText,ja=ja.ka(Ee.a.GU,1),
C+=1,S=Of.a.replaceAll(S,"%"+C,this.J7h(ya,ja)),0<=S.indexOf("%"))for(ya=0;ya<C;ya++)0<=S.indexOf("%"+(ya+1))&&(ja=this.VLm(n.K(0),e,ya),S=Of.a.replaceAll(S,"%"+(ya+1),ja));return S}setLevelAlignment(e,n,C,S){(0>C||C>=pc.a.yma||!S||""===S)&&pc.a.td();(n=this.wAa(e,n))||pc.a.hg();this.lg.Yy(n.K(0),e,C).setValue(hb.a.gga,S);if(!Or.a.getInstance().du){for(e=0;e<n.count;e++)if(this.oU(n.K(e))===C){const ja=this.rQb(n.K(e));ja&&ja.setValue(hb.a.gga,S)}this.BY(this.AAa(n.K(0)))}}setLevelStartingNumber(e,
n,C,S){(0>C||C>=pc.a.yma||0>S)&&pc.a.td();(n=this.wAa(e,n))&&n.count||pc.a.hg();var ja=this.lg.Yy(n.K(0),e,C);ja.setValue(Ee.a.GU,S);if(!Or.a.Ys){var ya=-1;e=S;var kb=pc.a.yma;let sc=!1;ja=Iv.a.naa(ja,null);for(let Fc=0;Fc<n.count;Fc++){kb<C&&(sc=!0);kb=this.oU(n.K(Fc));if(kb===C&&!ja.listType){var Rb=Fc;1!==Rb-ya&&sc&&(e=S,sc=!1);ya=this.Yjc(n.K(Fc));this.CI.mEe(ya,e,e);ya=Fc;e++}Or.a.getInstance().du||(Rb=this.AAa(n.K(Fc)),this.BY(Rb))}}}MWo(e,n,C,S,ja){(0>C||C>=pc.a.yma)&&pc.a.td();(n=this.wAa(e,
n))||pc.a.hg();e=this.lg.Yy(n.K(0),e,C);e.setValue(hb.a.ke,oi.a.fK(S));ja=oi.a.fK(ja);0<=ja?(e.setValue(hb.a.uD,ja),e.removeProperty(hb.a.Jt)):(e.setValue(hb.a.Jt,0-ja),e.removeProperty(hb.a.uD));for(e=0;e<n.count;e++)if(this.oU(n.K(e))===C){var ya=this.AAa(n.K(e));ya.Vf(hb.a.ke);ya.Vf(hb.a.uD);ya.Vf(hb.a.Jt);!Or.a.getInstance().du&&(ya=this.rQb(n.K(e)))&&(ya.setValue(hb.a.ke,oi.a.fK(S)),0<=ja?(ya.setValue(hb.a.uD,ja),ya.removeProperty(hb.a.Jt)):(ya.setValue(hb.a.Jt,0-ja),ya.removeProperty(hb.a.uD)))}Or.a.getInstance().du||
this.BY(this.AAa(n.K(0)))}lzm(e){const n=this.e9a(e),C=Array(pc.a.yma);for(let ja=0;ja<pc.a.yma;ja++){var S=this.lg.Yy(e,n,ja);S=Iv.a.naa(S,null);S.listType?1===S.listType&&(C[ja]=S.l$c?2:0):C[ja]=1}return C}wAa(e,n){n=this.hb.Kv(n,!0,!1);const C=new fb.a;for(const S of n)this.Cpn(S,e)&&C.add(Af.ParagraphReader.ukc(S));return C.count?C:null}rQb(e){return uj.ListItemReader.h7(e)}Yjc(e){const n=new Ed.a;n.set(e);e=null;uj.ListItemReader.Fg(n)&&(this.lg.q0(n),e=n.currentNode);return e}oU(e){let n=-1;
uj.ListItemReader.Fg(e)&&(n=uj.ListItemReader.nla(e,{pUa:-1}).listLevel);return n}AAa(e){const n=new Ed.a;n.set(e);e=null;uj.ListItemReader.Fg(n)&&(e=n.Vb(2));return e}Bsi(e,n){if(!e||!e.count)return null;const C=new fb.a,S=new fb.a;var ja=null;for(let kb=0;kb<e.count;kb++){const Rb=e.K(kb).node;if(!(ja&&Rb&&ja.id.equals(Rb.id))){ja=Rb;var ya=void 0;uj.ListItemReader.De?uj.ListItemReader.isListItem(Rb)&&(ya=Af.ParagraphReader.ukc(Rb),ya=this.e9a(ya),S.contains(ya)||(S.add(ya),C.add(this.$qb(Rb)))):
({nXb:ya}=this.f$c(Rb)).returnValue&&(ya=this.e9a(ya),S.contains(ya)||(S.add(ya),C.add(this.$qb(Rb))))}}e=new fb.a;for(ja=0;ja<S.count;ja++)e.add(this.SZe.create(C.K(ja),S.K(ja),n));return e}e9a(e){let n=-1;e=Ed.a.eb(e);uj.ListItemReader.Fg(e)&&(n=uj.ListItemReader.nla(e,{Ara:-1}).listId);return n}f$c(e){if(!e)return{returnValue:!1,nXb:null};e=Ed.a.eb(e);if(e.zb(11)){const n=e.Dp(11);if((e=n)&&uj.ListItemReader.Fg(n))return{returnValue:!0,nXb:e}}else e=null;return{returnValue:!1,nXb:e}}attachToList(e,
n,C,S){if(C>=pc.a.yma||0>C)return pc.a.td(),null;let ja=null;if(uj.ListItemReader.De){if(uj.ListItemReader.isListItem(e)||!(ja=Af.ParagraphReader.ukc(e)))return pc.a.hg(),null}else if(({nXb:ja}=this.f$c(e)).returnValue||!ja)return pc.a.hg(),null;var ya=new Ed.a;ya.set(ja);ya.Nd();let kb=new kf.DictionaryPropertySet;var Rb=this.lg.xnn(e,n);var sc=this.$qb(e);sc=this.wAa(n,sc);Rb&&sc?(Rb=pe.a.KN,sc=this.rQb(sc.K(sc.count-1)),sc=this.lg.M2(sc),1===sc.listType?Rb=pe.a.$E:sc.listType||(Rb=pe.a.KN),kb=
this.DM.y_c(Rb,kb),{Jla:sc}=this.DM.Bqa(kb,ya,sc,!1)):Rb&&!sc?pc.a.hg():pc.a.td();if(!Or.a.getInstance().Ht)if(ya=this.Yjc(ja))this.CI.JAb(ya,n),this.vyg(ja,C);else return E.ULS.sendTraceTag(20473551,369,10,"AppId:{0}, Something went wrong in native code and failed to create a list node.",S.appId),null;Or.a.getInstance().du&&(this.CI.JAb(e,n),this.vyg(ja,C));e=this.$qb(e);return this.SZe.create(e,n,S)}startNewList(e,n){if(uj.ListItemReader.De){if(uj.ListItemReader.isListItem(e))return pc.a.hg(),null;
var C=Af.ParagraphReader.ukc(e)}else if(({nXb:C}=this.f$c(e)).returnValue)return pc.a.hg(),null;const S=new Ed.a;S.set(C);S.Nd();let ja=Iv.a.OW(1,1),ya=new kf.DictionaryPropertySet;ya=this.DM.y_c(pe.a.$E,ya);({Jla:ja}=this.DM.Bqa(ya,S,ja,!0));e=this.$qb(e);C=this.e9a(C);return this.SZe.create(e,C,n)}detachFromList(e){uj.ListItemReader.Dnn(e)||pc.a.hg();this.DM.sVc(e)}vyg(e,n){var C=this.oU(e);if(-1!==C&&n<pc.a.yma&&-1<n){var S=this.Yjc(e),ja=this.rQb(e);if(S&&ja){var ya=this.e9a(e),kb=this.lg.Yy(ja,
ya,C),Rb=Iv.a.naa(kb,null);kb=this.JCi(e);Or.a.getInstance().Ht||S.setValue(hb.a.listLevel,n);if(Or.a.getInstance().du){var sc=this.AAa(e);this.CI.A_b(sc,ya,n)}if(!this.lg.M2(ja).listType)for({startAt:ja,Sea:ya}=this.zwm(e),Or.a.getInstance().Ht||this.CI.mEe(S,ja,ya),S=this.JCi(e),sc=0;sc<S.count;sc++)if(!Or.a.getInstance().Ht){const Fc=this.Yjc(S.K(sc));this.CI.mEe(Fc,ja+1+sc,ya+1+sc)}if(!Rb.listType&&!this.qun(e)&&n!==C)for(e=0;e<kb.count;e++)Or.a.getInstance().Ht||(n=this.Yjc(kb.K(e)),C=uj.ListItemReader.v9d(n),
Rb=uj.ListItemReader.SOf(n),this.CI.mEe(n,C-1,Rb-1))}}}setLevelNumbering(e,n,C,S,ja,ya){let kb=0,Rb="right";switch(ja){case 0:kb=1;break;case 4:kb=2;break;case 2:kb=3;Rb="left";break;case 3:kb=4;break;case 1:kb=5;Rb="left";break;case -1:kb=1;break;default:pc.a.td()}let sc="";if(ya&&ya.length){let Fc=!1;for(let gd=0;gd<ya.length;gd++)if(Number===Object.getType(ya[gd])){const td=ya[gd];Fc=td===S||Fc;td>S?pc.a.td():-1===ja&&td===S?pc.a.td():td<S&&this.lg.Yy(n,C,td).ka(Gh.a.cC,14)&&pc.a.td();sc=sc+"%"+
(td+1).toString()}else sc+=ya[gd];-1===ja||Fc||pc.a.td()}else sc=null;n="%"+(S+1).toString();sc||(sc=n);this.xOj(0,kb,e,C,S,sc,"Calibri",Rb)}setLevelBullet(e,n,C,S,ja,ya){ya=ya?ya:NE.a.vYc;switch(S){case 258231:ja=61623;ya="Symbol";break;case 131183:ja=111;ya="Courier New";break;case 716967:ja=61607;ya="Wingdings";break;case 716918:ja=61558;ya="Wingdings";break;case 717016:ja=61656;ya="Wingdings";break;case 717052:ja=61692,ya="Wingdings"}this.xOj(1,1,e,n,C,String.fromCharCode(ja),ya,"left")}JCi(e){var n=
this.e9a(e);const C=this.oU(e),S=new fb.a;n=this.wAa(n,this.$qb(e));let ja=!1;for(let ya=0;ya<n.count;ya++){const kb=this.oU(n.K(ya));if(ja&&kb<C)break;kb===C&&(ja&&S.add(n.K(ya)),e.id.equals(n.K(ya).id)&&(ja=!0))}return S}qun(e){var n=this.e9a(e);uj.ListItemReader.De||this.oU(e);n=this.wAa(n,this.$qb(e));return e.id.equals(n.K(0).id)?!0:!1}zwm(e){var n=this.e9a(e),C=this.oU(e);const S=this.wAa(n,this.$qb(e));n=null;for(let ja=0;ja<S.count;ja++)if(this.oU(S.K(ja))===C){if(e.id.equals(S.K(ja).id))break;
n=S.K(ja)}C=e=1;n&&!Or.a.getInstance().Ht&&(n=this.Yjc(n))&&(e=uj.ListItemReader.v9d(n)+1,C=uj.ListItemReader.SOf(n)+1);return{startAt:e,Sea:C}}Cpn(e,n){if(uj.ListItemReader.De)return e?uj.ListItemReader.Jr(e,{Ara:-1}).listId===n:!1;let C=!1,S=null;e&&({nXb:S}=this.f$c(e)).returnValue&&this.e9a(S)===n&&(C=!0);return C}$qb(e){e=Ed.a.eb(e);return e.zb(36)?e.Dp(36):e.zb(38)?e.Dp(38):e.zb(8)?e.Dp(8):null}xOj(e,n,C,S,ja,ya,kb,Rb){var sc=null;const Fc=this.wAa(S,C);Fc||pc.a.hg();for(var gd=0;gd<Fc.count;gd++)if(this.oU(Fc.K(gd))===
ja){sc=Fc.K(gd);break}gd=new kf.DictionaryPropertySet;const td=new Ed.a;if(sc){var Bd=e?pe.a.$E:pe.a.KN;td.set(sc);td.Nd();gd=this.DM.y_c(Bd,gd);Bd=Iv.a.OW(e,n)}else Bd=this.lg.Yy(Fc.K(0),S,ja),Bd=Iv.a.naa(Bd,new kf.DictionaryPropertySet),Bd.tca(e,n);Bd.levelText=ya;Bd.font=kb;Bd.o8c=!0;Bd.Jx=Rb;e=this.lg.Yy(Fc.K(0),S,ja).ka(Ee.a.GU,NE.a.Ok);sc&&({Jla:Bd}=this.DM.Bqa(gd,td,Bd,!1));if(!Or.a.getInstance().du)for(sc=0;sc<Fc.count;sc++)n=this.AAa(Fc.K(sc)),this.BY(n);e!==NE.a.Ok&&this.setLevelStartingNumber(S,
C,ja,e)}BY(e){e&&e.setValue(Ee.a.DU,new Date)}VLm(e,n,C){n=this.lg.Yy(e,n,C);e=Iv.a.naa(n,null);if(e.listType)return"";n=n.ka(Ee.a.GU,1);return this.J7h(e,n)}J7h(e,n){switch(e.vsa()){case 0:return n+"";case 4:return Of.a.tXd(n-1,!0);case 2:return Of.a.UWc(n,!0);case 3:return Of.a.tXd(n-1,!1);case 1:return Of.a.UWc(n,!1);default:return n+""}}}Object(F.a)(OE,"ListOperations",null,[1190]);class Tn extends Hh.a{constructor(e,n,C,S,ja,ya,kb){super();pc.a.bPa(e,"NoteItem");this.IK=e;this._context=n;this._id=
C;this.Yc=kb;this.qQ=S;this.nk=ja;this.Hjb=ya}get type(){return this.Yc.Qaa(this.IK)}get body(){return this.qQ.create(this.IK,this._context)}get reference(){const e=new fb.a;var n=this.IK.esa;n&&(n=n.Ib,e.add(ce.a.createTextRange(n.paragraph,n.cp,n.cp+1)));return this.nk.create(e,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}deleteObject(){this.Yc.VQl(this.IK)}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){const e=
this.Yc.HBm(this.IK,this.type);return e?this.Hjb.create(e,this._context):null}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.IK,"NoteItem")}getTypeName(){return"Microsoft.WordServices.NoteItem"}invokePropertyGet(e){switch(e){case 4:return this.body;case 5:return this.reference;case 3:return this.type;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.VC(n);case 1004:return this.i7();case 1005:return this.j7();case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}VC(){this.deleteObject();
return null}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Tn,"NoteItem",Hh.a,[901]);class bA{constructor(){}su(e,n,C){this.qQ=e;this.nk=n;this.Yc=C}create(e,n,C=0){return new Tn(e,n,C,this.qQ,this.nk,this,this.Yc)}}Object(F.a)(bA,"NoteItemFactory",null,[1080]);class kx{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph){this.uPa=Ph;this.nk=null;this.zC=e;this.iO=n;this.TZe=
C;this.hb=S;this.xv=ja;this.LK=ya;this.Lq=kb;this.cPk=Rb;this.Yc=sc;this.ay=Fc;this.sh=gd;this.vB=td;this.px=Bd;this.Hl=wd;this.ld=te;this.Xn=Le;this.Ot=Oe;this.wx=We;this.Xx=Xf;this.I2e=Gg}su(e){this.nk=e}create(e,n,C=0){return new Ry(e,n,C,this.zC,this.iO,this,this.nk,this.TZe,this.hb,this.xv,this.LK,this.Lq,this.cPk,this.Yc,this.ay,this.sh,this.vB,this.px,this.Hl,this.ld,this.Xn,this.Ot,this.wx,this.Xx,this.I2e,this.uPa)}}Object(F.a)(kx,"ParagraphFactory",null,[1080]);class su{constructor(){this.mbg=
new Map;this.t9i=new Map}rDi(e){if(!this.mbg.has(e)){const n=Tj.a.create();this.mbg.set(e,n.toString());this.t9i.set(n.toString(),e)}return this.mbg.get(e)}jCm(e){return this.t9i.get(e)}}Object(F.a)(su,"ParagraphLocalIdMapping",null,[]);class PE{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj){this.zo=e;this.iO=n;this.zC=C;this.cAk=S;this.hb=ja;this.Lq=ya;this.xB=kb;this.Yc=Rb;this.ay=sc;this.sh=Fc;this.vB=gd;this.px=td;this.Hl=Bd;this.iF=wd;this.ld=te;this.Xn=Le;this.Ep=
Oe;this.Hjb=We;this.Ot=Xf;this.wx=Gg;this.Xx=Ph;this.uPa=Aj}create(e,n,C=0){return new Js(e,n,C,this.zo,this.iO,this.zC,this,this.cAk,this.hb,this.Lq,this.xB,this.Yc,this.ay,this.sh,this.vB,this.px,this.Hl,this.iF,this.ld,this.Xn,this.Ep,this.Hjb,this.Ot,this.wx,this.Xx,this.uPa)}}Object(F.a)(PE,"RangeFactory",null,[1080]);class hH{constructor(){this.meh=this._value=""}get value(){return this._value}set value(e){this._value=e}get Dra(){return this.meh}set Dra(e){this.meh=e}}Object(F.a)(hH,"StringAndDelimiter",
null,[]);class AB{constructor(){this.Vhb=this.Yda=-1;this.loh=!1}get start(){return this.Yda}set start(e){this.Yda=e}get end(){return this.Vhb}set end(e){this.Vhb=e}get IXf(){return this.loh}set IXf(e){this.loh=e}}Object(F.a)(AB,"SubRangeGncLocation",null,[]);class iH{constructor(e,n,C){this.hb=e;this.ga=n;this.iF=C}DPb(e,n){if(!e||0>=e.count)return null;var C=e.count;const S=new fb.a;if(n)if(1===n)S.add(this.tL(e.K(0),!0));else if(2===n)S.add(this.tL(e.K(C-1),!1));else if(5===n){for(n=0;n<C-1;n++)S.add(e.K(n).clone());
n=e.K(C-1).clone();const ja=this.hb.textLength(n.node);switch(n.contextId){case Ma.a.paragraph:if(n=ja?ce.a.createTextRange(n.node,0,ja):1===C?ce.a.Uc(n.node,0):null)n.Fb=this.hb.vy(n.node),n.Tb=this.hb.Ex(n.node);break;case Ma.a.Zc:1===C?(n=ce.a.Cx(n.node),n.Fb=e.K(C-1).Fb,n.Tb=this.hb.Ex(n.node)):n=null}n&&S.add(n)}else if(4===n){C=e.K(C-1).clone();e=null;switch(C.contextId){case Ma.a.paragraph:case Ma.a.Zc:if(C=this.jCi(C.node))e=ce.a.Uc(C.node,0),e.Fb=e.Tb=this.hb.vy(C.node);break;case Ma.a.Vc:case Ma.a.Cd:e=
this.tL(C,!1)}if(e)S.add(e);else return null}else E.ULS.sendTraceTag(18745303,369,15,"rangeLocation of GetChildRange must be Start/End/Whole/Content/After."),pc.a.td();else for(n=0;n<C;n++)S.add(e.K(n).clone());return S}kyc(e,n,C,S,ja,ya=!0,kb=!0,Rb=!1){if(!e||0>=e.count)return E.ULS.sendTraceTag(18745304,369,10,"the Gnc List should contain at least one graph node context."),null;Rb&&(S||C||ya)&&pc.a.hg();var sc=new fb.a;sc.add(e.K(0).node);var Fc=[""],gd=0,td=e.K(0).node.id;for(var Bd=0;Bd<e.count;Bd++){var wd=
e.K(Bd).node,te=wd.id;td.equals(te)||(td=te,gd++,sc.add(wd),Fc[gd]="");switch(e.K(Bd).contextId){case Ma.a.paragraph:wd=this.hb.text(wd);break;case Ma.a.Cd:case Ma.a.Vc:wd=this.hb.text(wd).substring(e.K(Bd).cpBegin,e.K(Bd).cpEnd);break;default:continue}Fc[gd]+=wd}ya||(td=e.K(0).node,Bd=e.K(e.count-1).node,Fc[0]=this.hb.text(td),Fc[Fc.length-1]=this.hb.text(Bd));td=Array(gd+1);for(Bd=0;Bd<gd+1;Bd++)td[Bd]=[],wd=new hH,wd.value=Fc[Bd],td[Bd][0]=wd;for(Fc=0;Fc<n.length;Fc++)for(Bd=n[Fc],wd=0;wd<gd+1;wd++){te=
td[wd];var Le=[];for(var Oe=0;Oe<te.length;Oe++)Le=Le.concat.apply(Le,this.Lcp(Bd,te[Oe]));td[wd]=Le}n=Array(gd+1);for(Fc=0;Fc<gd+1;Fc++)for(n[Fc]=[],Bd=td[Fc],wd=0,ya&&!Fc&&(wd=this.aNf(e.K(0),!0)),te=this.hb.textLength(sc.K(Fc)),ya&&Fc===gd&&(te=this.aNf(e.K(e.count-1),!1)),Le=0;Le<Bd.length;Le++){Oe=new AB;var We=Bd[Le];if(We=We.value.length+We.Dra.length){var Xf=wd+We<te?wd+We:te;Oe.start=wd;Oe.end=Xf;wd+=We}else Oe.start=wd,Oe.end=wd;if(Rb&&0<=Le&&Le<Bd.length-1){We=Bd[Le+1];Xf=We.value.trimStart();
const Gg=We.value.length-Xf.length;Oe.end+=Gg;wd+=Gg;We.value=Xf}n[Fc][Le]=Oe}if(S)for(Fc=0;Fc<gd+1;Fc++)for(Bd=td[Fc],wd=0;wd<Bd.length;wd++)n[Fc][wd].end-=Bd[wd].Dra.length;for(td=0;td<gd+1;td++)if(Bd=sc.K(td),Fc=n[td][n[td].length-1],this.hb.textLength(Bd),td===gd&&(!ya||e.K(e.count-1).contextId===Ma.a.paragraph||e.K(e.count-1).contextId===Ma.a.Zc)||!td&&(0<gd||!ya||e.K(e.count-1).contextId===Ma.a.paragraph||e.K(e.count-1).contextId===Ma.a.Zc)||0<td&&td<gd)Bd=new AB,Bd.start=Fc.end,Bd.end=Fc.end,
Bd.IXf=!0,n[td][n[td].length]=Bd;td=Array(gd+1);for(Fc=0;Fc<gd+1;Fc++)for(td[Fc]=[],Bd=sc.K(Fc),wd=n[Fc],te=0;te<wd.length;te++)Le=new fb.a,Oe=wd[te],Oe=Oe.IXf?ce.a.Wl(Bd):Oe.start||Oe.end!==this.hb.textLength(Bd)?Oe.start===Oe.end?ce.a.Uc(Bd,Oe.start):ce.a.createTextRange(Bd,Oe.start,Oe.end):ce.a.create(Bd),Le.add(Oe),td[Fc][te]=Le;sc=[];gd=0;for(n=0;n<td.length;n++)for(Fc=td[n],Bd=0;Bd<Fc.length;Bd++){if(C&&Bd+1<Fc.length&&Fc[Bd+1].K(0).contextId===Ma.a.Zc)if(wd=new fb.a,n<td.length-1){wd.addRange(Fc[Bd]);
this.hln(Fc[Bd])||wd.K(wd.count-1).contextId===Ma.a.paragraph||(wd.K(wd.count-1).contextId===Ma.a.Vc&&wd.removeAt(wd.count-1),wd.add(Fc[Bd+1].K(0)));wd.addRange(td[n+1][0]);td[n+1][0]=wd;break}else wd=Fc[Bd],wd.K(wd.count-1).contextId===Ma.a.paragraph?Fc.pop():wd.K(wd.count-1).contextId===Ma.a.Vc?(te=Fc.pop(),wd.W(wd.count-1,te.K(0))):wd.K(wd.count-1).contextId===Ma.a.Cd&&(te=Fc.pop(),wd.add(te.K(0)));if(!C){if(Bd+1<Fc.length&&Fc[Bd+1].K(0).contextId===Ma.a.Zc)if(wd=Fc[Bd],wd.K(wd.count-1).contextId===
Ma.a.paragraph)Fc.pop();else if(wd.K(wd.count-1).contextId===Ma.a.Vc){if(te=Fc.pop(),wd.W(wd.count-1,te.K(0)),Rb&&0<Bd){Fc[Bd-1].add(te.K(0));Fc.pop();continue}}else wd.K(wd.count-1).contextId===Ma.a.Cd&&(te=Fc.pop(),wd.add(te.K(0)));S&&this.iDe(td[n][Bd])}ja&&(td[n][Bd]=this.jDe(td[n][Bd],C));!Rb&&ya&&(wd=td[n][Bd],te=e.K(0),Le=e.K(e.count-1),this.Mwc(te,Le,wd,S));kb&&this.eTb(td[n][Bd])||(sc[gd++]=td[n][Bd])}return sc}QNf(e,n,C){if(!e||!e.count)return null;n=this.kyc(e,n,!1,!1,!1,!1,!1,!0);for(var S=
0;S<n.length&&!this.nYf(n[S],e.K(0),!0);)n.shift();for(S=n.length-1;0<=S&&!this.nYf(n[S],e.K(e.count-1),!1);S--)n.pop();if(C){e=[];C=0;for(S=0;S<n.length;S++)n[S]=this.jDe(n[S]),this.eTb(n[S])||(e[C++]=n[S]);n=e}for(e=0;e<n.length;e++)this.Mwc(null,null,n[e],!1);return n}getNextTextRange(e,n,C){if(!e||0>=e.count)return null;var S=new fb.a;S.add(e.K(e.count-1));var ja=this.kyc(S,n,!1,!1,!1,!1,!1,!0);S=new fb.a;var ya=-1;for(let kb=ja.length-1;0<=kb&&!this.nYf(ja[kb],e.K(e.count-1),!1);kb--)ya=kb;if(-1!==
ya){for(;ya<ja.length&&this.eTb(S);ya++)S=ja[ya],C&&(S=this.jDe(S));this.Mwc(null,null,S,!1);if(!this.eTb(S))return S}e=e.K(e.count-1);do{if(e=this.jCi(e.node))for(ja=new fb.a,ja.add(e),ja=this.kyc(ja,n,!1,!1,!1,!1,!0,!0),ya=0;ya<ja.length&&this.eTb(S);ya++)S=ja[ya],C&&(S=this.jDe(S));else return null;this.Mwc(null,null,S,!1)}while(this.eTb(S));return S}eTb(e){for(let n=0;n<e.count;n++)switch(e.K(n).contextId){case Ma.a.paragraph:case Ma.a.Zc:return!1;case Ma.a.Cd:if(e.K(n).cpBegin<e.K(n).cpEnd)return!1;
break;case Ma.a.Vc:if(e.K(n).Fb<e.K(n).Tb)return!1}return!0}tL(e,n=!0,C=!1){if(!e)return null;let S=null;switch(e.contextId){case Ma.a.paragraph:S=n?ce.a.Uc(e.node,0):C?ce.a.Uc(e.node,this.hb.textLength(e.node)+1):ce.a.Cx(e.node);break;case Ma.a.Zc:S=!n&&C?ce.a.Uc(e.node,this.hb.textLength(e.node)+1):ce.a.Cx(e.node);break;case Ma.a.Cd:case Ma.a.Vc:S=n?ce.a.Uc(e.node,e.cpBegin):ce.a.Uc(e.node,e.cpEnd)}S&&n&&-1!==e.Fb?S.Fb=S.Tb=e.Fb:S&&!n&&-1!==e.Tb&&(S.cpEnd===this.hb.textLength(e.node)+1?S.Fb=S.Tb=
-1:S.Fb=S.Tb=e.Tb);return S}Gwe(e){if(e&&e.count){var n=e.K(0);e=e.K(e.count-1);n.Fb=this.hb.vy(n.node);e.Tb=this.hb.Ex(e.node)}}Mwc(e,n,C,S){if(C&&C.count){var ja=C.K(0);C=C.K(C.count-1);var ya=this.tL(ja),kb=this.tL(C,!1),Rb=null,sc=null;e&&(Rb=this.tL(e));n&&(sc=this.tL(n,!1));e&&Rb&&Rb.cpBegin===ya.cpBegin?-1!==e.Fb&&(ja.Fb=e.Fb):(0<this.hb.wm(ja.node,ya.cpBegin)?ja.Fb=0:ja.Fb=-1,ya.cpBegin||(ja.Fb=this.hb.vy(ja.node)));n&&sc&&sc.cpEnd===kb.cpEnd?-1!==n.Tb&&(C.Tb=n.Tb):(e=this.hb.wm(C.node,kb.cpEnd),
0<e?S?(C.Tb=e,kb.cpEnd===this.hb.textLength(kb.node)&&(C.Tb=this.hb.Ex(kb.node))):C.Tb=0:C.Tb=-1)}}YZh(e){return 32!==this.ga.Hf(e,pe.a.JR,1,!1,null,null)?!1:!0}jCi(e){return(e=this.hb.pg(e,!1,!0))?ce.a.create(e):null}iDe(e){let n=!1;if(e&&0<e.count)for(var C=0;C<e.count;){e.K(C).contextId===Ma.a.Zc&&(e.removeAt(C),n=!0);break}if(e&&0<e.count)for(C=e.count-1;0<=C;C--){const S=e.K(C);if(S.contextId===Ma.a.Zc)e.removeAt(C),n=!0;else if(S.contextId===Ma.a.paragraph)if(n=!0,this.hb.textLength(S.node)){e.W(C,
ce.a.createTextRange(S.node,0,this.hb.textLength(S.node)));break}else e.removeAt(C);else break}return n}jDe(e,n=!0){const C=new fb.a;n&&this.iDe(e);if(e&&0<e.count)for(var S=0;S<e.count;){var ja=this.Y2j(e.K(S),!0);if(ja.contextId===Ma.a.Vc)e.removeAt(S);else if(e.W(S,ja),!n)break;if(n&&!this.iDe(e))break}if(e&&0<e.count){do if(S=e.count-1,ja=this.Y2j(e.K(S),!1),ja.contextId===Ma.a.Vc)e.removeAt(S);else if(e.W(S,ja),!n)break;while((!n||n&&this.iDe(e))&&0<e.count)}C.addRange(e);return C}Y2j(e,n){if(!e)return null;
var C=null;switch(e.contextId){case Ma.a.Cd:case Ma.a.paragraph:C=this.tL(e,!0);var S=this.tL(e,!1);const ja=this.hb.text(C.node),ya=ja.substring(C.cpBegin,S.cpBegin);let kb=C.cpBegin;S=S.cpEnd;n?kb+=ya.length-ya.trimStart().length:S=kb+ya.trimEnd().length;C=S-kb?kb||S!==ja.length?ce.a.createTextRange(C.node,kb,S):e:ce.a.Uc(C.node,kb);break;case Ma.a.Zc:case Ma.a.Vc:C=e}return C}nYf(e,n,C){if(0<e.count){const ya=this.tL(e.K(0),!0);var S=this.tL(e.K(e.count-1),!1);if(!ya.node.id.equals(n.node.id))return!1;
var ja=this.aNf(n,C);let kb=e=-1;switch(n.contextId){case Ma.a.Cd:case Ma.a.paragraph:this.hb.text(n.node).length?(e=2*ja+1,kb=2*ja-1):kb=e=0;break;case Ma.a.Zc:case Ma.a.Vc:e=2*ja,kb=2*ja}ja=ya.cpBegin;n=S.cpEnd;0<n-ja?(S=2*ja,ja=2*n-1,n===this.hb.text(ya.node).length&&(ja+=1)):(S=2*ja,ja=2*n);if(C&&e>=S&&e<=ja||!C&&kb>=S&&kb<=ja)return!0}return!1}aNf(e,n){let C=0,S=0;if(e)switch(e.contextId){case Ma.a.paragraph:C=0;S=this.hb.textLength(e.node);break;case Ma.a.Zc:C=this.hb.textLength(e.node);S=this.hb.textLength(e.node);
break;case Ma.a.Cd:case Ma.a.Vc:C=e.cpBegin,S=e.cpEnd}return n?C:S}Lcp(e,n){const C=n.value.split(e),S=[];for(let ja=0;ja<C.length;ja++){const ya=new hH;ya.value=C[ja];ya.Dra=ja!==C.length-1?e:n.Dra;S[ja]=ya}return S}hln(e){for(let n=0;n<e.count;n++)if(e.K(n).contextId===Ma.a.Zc)return!0;return!1}d5h(e,n,C,S){if(this.NYi(e,C)){e=this.tL(e,!0);n=this.tL(n,!1,!0);C=this.tL(C,!0);const ja=this.tL(S,!1,!0);S=this.oka(e,C);const ya=this.oka(n,ja);e=this.oka(e,ja);n=this.oka(n,C);e=S?2===S?2===e?13:1===
e?11:ya?1===ya?6:12:7:ya?1===ya?1:2:5:n?1===n?8:ya?1===ya?3:4:9:10}else e=0;return e}NYi(e,n){e=this.tL(e,!0);n=this.tL(n,!0);return 3!==this.oka(e,n)}oka(e,n){if(e.node.id.equals(n.node.id)){var C=e.cpBegin-n.cpBegin;return C?0<C?2:0:(C=e.oo()-n.oo())?0<C?2:0:1}C=this.sIi(e.node);const S=this.sIi(n.node);C.insert(0,e.node);S.insert(0,n.node);e=C.count;for(n=S.count;0<e&&0<n&&C.K(--e).id.equals(S.K(--n).id););var ja=C.K(e+1);switch(ja.type){case 7:case 35:case 39:return 3;case 8:case 10:const ya=
this.r6h(C),kb=this.r6h(S);if(ya||kb)return 3;ja=Ed.a.eb(ja);return 0<ja.pAa(C.K(e))-ja.pAa(S.K(n))?2:0;default:return ja=Ed.a.eb(ja),0<ja.pAa(C.K(e))-ja.pAa(S.K(n))?2:0}}Qqb(e){let n=[];const C=new fb.a;var S=e.K(0).node.id;let ja=e.K(0).node;var ya=e.K(0);let kb=e.K(0);for(let Rb=0;Rb<e.count;Rb++){const sc=e.K(Rb).node,Fc=sc.id;if(!S.equals(Fc)){S=ya.cpBegin;ya.contextId===Ma.a.paragraph?S=0:ya.contextId===Ma.a.Zc&&(S=ya.node.characterData.length);ya=kb.cpEnd;if(kb.contextId===Ma.a.paragraph||
kb.contextId===Ma.a.Zc)ya=kb.node.characterData.length;S===ya?C.add(ce.a.Uc(ja,S)):C.add(ce.a.createTextRange(ja,S,ya));ja=sc;S=Fc;ya=e.K(Rb)}kb=e.K(Rb)}S=ya.cpBegin;ya.contextId===Ma.a.paragraph?S=0:ya.contextId===Ma.a.Zc&&(S=ya.node.characterData.length);ya=kb.cpEnd;if(kb.contextId===Ma.a.paragraph||kb.contextId===Ma.a.Zc)ya=kb.node.characterData.length;S===ya?C.add(ce.a.Uc(ja,S)):C.add(ce.a.createTextRange(ja,S,ya));for(const Rb of C)Rb.contextId===Ma.a.Vc&&(n=n.concat.apply(n,this.zTf(Rb))),n=
n.concat.apply(n,nv.a.Oz(Rb,!1));return{returnValue:n,Uag:C}}cEi(e,n){let C="";for(let S=0;S<e.count;S++){const ja=e.K(S);switch(ja.contextId){case Ma.a.paragraph:C+=this.hb.AXb(ja.node)+pc.a.kqc;break;case Ma.a.Cd:const ya={yd:ja.cpBegin,endCp:ja.cpEnd};C+=this.hb.AXb(ja.node,void 0,ya).substring(ya.yd,ya.endCp);break;case Ma.a.Zc:C+=pc.a.kqc;break;case Ma.a.Vc:break;default:E.ULS.sendTraceTag(539848968,369,10,"AppId:{0}, the contextId {1} is not supported to get the text.",n.appId,ja.contextId),
pc.a.hg()}}return C}cOj(e,n,C,S){this.i_f(e)||pc.a.hg();if(e.K(0).contextId===Ma.a.Vc||e.K(0).contextId===Ma.a.Zc)E.ULS.sendTraceTag(540377293,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",S.appId),pc.a.hg();if(S=({Uag:e}=this.Qqb(e)).returnValue)for(let ja=0;ja<S.length;ja++)this.iF.fV(S[ja].paragraph,S[ja].hyperlink);n&&""!==n&&e&&0<e.count&&(this.YZh(e.K(0))?(S=!1,C&&0===n.indexOf("#")&&(n=n.substr(1),S=!0),this.iF.wF(e.K(0),n,!1,!1,!1,S)):pc.a.sC())}sIi(e){const n=
new fb.a;e=Ed.a.eb(e);for(e.zb(7);e.uc();)n.add(e.currentNode);return n}r6h(e){for(let n=0;n<e.count;n++)if(35===e.K(n).type)return!0;return!1}zTf(e){const n=[],C=nv.a.Oz(e,!0);for(const S of C)S.cpBegin===e.cpBegin&&n.push(S);return n}i_f(e){const n=e.K(0).node.id;for(let C=0;C<e.count;C++){const S=e.K(C).node.id;if(!n.equals(S))return!1}return!0}}Object(F.a)(iH,"RangeOperations",null,[1189]);class jH{constructor(e){this.controlId=this.appId=null;this.upc=!1;this.Ek=null;this.Cn=e}}Object(F.a)(jH,
"RequestContext",null,[]);var Bo=d(2135);class kr{constructor(){this.noa=null;this.Yac=this.pJb=this.P3b=0;this.$rh=this.Qvk=this.EFc=this.fQc=null;this.qub=[]}get KG(){return this.noa}set KG(e){this.noa=e}get fdf(){return this.P3b}cye(e){this.P3b=e}get Qna(){return this.pJb}gxc(e){this.pJb=e}get Xeb(){return this.Yac}get Gca(){return this.fQc}set Gca(e){this.fQc=e}get H6(){return this.EFc}set H6(e){this.EFc=e}get IJa(){return this.Qvk}get qub(){return this.$rh}set qub(e){this.$rh=e}k9a(){throw Error.notImplemented();
}a8d(){throw Error.notImplemented();}Gjc(){throw Error.notImplemented();}EAi(){throw Error.notImplemented();}aRd(){throw Error.notImplemented();}lMh(){throw Error.notImplemented();}zkd(){throw Error.notImplemented();}gue(){throw Error.notImplemented();}L2h(){throw Error.notImplemented();}Wbj(){throw Error.notImplemented();}Ekc(){throw Error.notImplemented();}FR(){throw Error.notImplemented();}Yxi(){throw Error.notImplemented();}CAb(){throw Error.notImplemented();}iGj(){throw Error.notImplemented();
}}Object(F.a)(kr,"FindResultManagerStub",null,[1542]);class kH extends kr{constructor(e){super();this.gib=e}aRd(e){this.gib&&this.gib.YUa(0,e)}}Object(F.a)(kH,"ExtensionFindResultManager",kr,[]);class Sy{constructor(e,n,C,S){this.$ch=e;this.Ivk=n;this.Ovk=C;this.LKh=S}find(e,n,C,S,ja){if(this.wvn(C)&&this.yvn(n,C)){var ya=0;C&&(ya|=C.matchCase?1:0,ya|=C.matchPrefix?8:0,ya|=C.matchSuffix?16:0,ya|=C.matchWildcards?4:0,ya|=C.matchWholeWord?2:0,ya|=C.ignorePunct?32:0,ya|=C.ignoreSpace?64:0);this.Ipb(e,
n,ya,S,ja)}else E.ULS.sendTraceTag(18629911,344,10,"user have input a invalid search text."),pc.a.td()}Ipb(e,n,C,S,ja){this.xvn(C)&&this.zvn(n,C)?(e=this.Msm(e),0>=e.count?S(new gx(new fb.a)):(S=this.Ovk.create(e,S,ja),ja=new kH(S),this.Ivk.create(S,ja,e).find(this.GHm(n,C)))):(E.ULS.sendTraceTag(545814685,344,10,"user have input an invalid search text."),pc.a.td())}GHm(e,n){let C=Bo.a.none;if(!n)return this.$ch(e,C);n&4&&(C|=Bo.a.nHp);n&1&&(C|=Bo.a.matchCase);n&2&&(C|=Bo.a.hNg);n&8&&(C|=Bo.a.prefix);
n&16&&(C|=Bo.a.suffix);n&64&&(C|=Bo.a.ignoreSpace);n&32&&(C|=Bo.a.ignorePunct);return this.$ch(e,C)}Msm(e){const n=new fb.a;for(const C of e)C.contextId!==Ma.a.paragraph&&C.contextId!==Ma.a.Cd||n.add(C);return n}yvn(e,n){return null===e||""===e||n&&n.matchWildcards&&!this.LKh.dge(e)?!1:!0}wvn(e){return e&&e.matchCase&&e.matchWildcards?!1:!0}zvn(e,n){return null===e||""===e||4===n&&!this.LKh.dge(e)?!1:!0}xvn(e){return 5===e?!1:!0}}Object(F.a)(Sy,"SearchExecutor",null,[1187]);var cA;(function(e){e[e.primary=
0]="primary";e[e.E1p=1]="firstPage";e[e.Y_p=2]="evenPages"})(cA||(cA={}));Object(F.b)("HeaderFooterType",cA);class Tu extends Hh.a{constructor(e,n,C,S,ja,ya,kb){super();pc.a.bPa(e,"Section");this.Eyd=e;this._context=n;this._id=C;this.Lxa=S;this.qQ=ja;this.WQa=ya;this.jp=kb}get body(){return this.qQ.create(this.Eyd,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}getFooter(e){return this.qQ.create(this.WPb(!1,e),this._context)}getHeader(e){return this.qQ.create(this.WPb(!0,
e),this._context)}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){pc.a.ej()||pc.a.Kj();var e=Ed.a.eb(this.Eyd);return e.zb(8)?(e=e.gkc(1))?this.Lxa.create(e,this._context):null:null}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.Eyd,"Section")}getTypeName(){return"Microsoft.WordServices.Section"}invokePropertyGet(e){switch(e){case 3:return this.body;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1004:return this.Ktm(n);case 1003:return this.Zum(n);case 1005:return this.i7();case 1006:return this.j7();case 1002:return this.jh();
case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Ktm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getFooter(e)}Zum(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getHeader(e)}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}jh(){this._KeepReference();
return null}kh(){this._OnAccess();return null}WPb(e,n){const C=new Ed.a;C.set(this.Eyd);let S=1,ja=-1;switch(n){case 0:ja=e?0:3;break;case 1:ja=e?2:5;S=2;break;case 2:ja=e?1:4;S=3;break;default:E.ULS.sendTraceTag(16831117,369,15,"AppId:{0}, the type of header footer is undefined: {1}.",this._context.appId,cA[n]),pc.a.td()}this.WQa.oki(C,S);e=this.jp.RVb(C);n=null;e&&(n=this.jp.WPb(e,ja));return n}}Object(F.a)(Tu,"Section",Hh.a,[901]);class QE{constructor(e,n,C){this.qQ=e;this.WQa=n;this.jp=C}create(e,
n,C=0){return new Tu(e,n,C,this,this.qQ,this.WQa,this.jp)}}Object(F.a)(QE,"SectionFactory",null,[1080]);var IJ=d(857);class JJ{constructor(e,n,C,S,ja){this.ld=null;this.ib=e;this.Qe=n;this.EG=C;this.hb=S;this.ga=ja}su(e){this.ld=e}HDa(e,n){this.LKj(e,n)}KOo(e,n){this.LKj(e,n)}LKj(e,n){const C=14===e.type,S=C?"Table":"Row";e=1===n?this.hb.Zm(e):this.hb.GF(e);const ja=1===n?0:this.hb.textLength(e);e=new Lf.Selection([ce.a.Uc(e,ja)],!0);this.ib.Kc(e);n||32===this.ga.Ob(C?pe.a.HDa:pe.a.g_b,2)||(E.ULS.sendTraceTag(20306081,
369,10,"Commands.Select{0} failed",S),pc.a.hg())}select(e,n){e.count||(E.ULS.sendTraceTag(17094667,369,10,"The gncList is empty when try to select the list."),pc.a.td());const C=e.K(0);e=e.K(e.count-1);switch(n){case 0:var S=new Lf.Selection([C],!0);S=this.Qe.vk(S,!0,!1);var ja=new yh.SelectionCollection([S],0),ya=new Lf.Selection([e],!0);ya=this.Qe.vk(ya,!1,!0);if(({Rm:ja}=this.EG.V1b(ja,ya.Qa)).returnValue){if(1<ja.length&&(S=this.ld.Q2(C.node))){ya=this.hb.Zm(S);const kb=this.hb.GF(S);if(ya===
C.node&&kb===e.node){this.HDa(S,n);break}}this.ib.F0(ja)}else S=this.EG.Vy(S,ya.Qa),this.ib.Kc(S);break;case 1:n=ce.a.Uc(C.node,C.zj);n.Tb=n.Fb=C.oo();S=new Lf.Selection([n],!0);this.ib.Kc(S);break;case 2:n=ce.a.Uc(e.node,e.Po);n.Tb=n.Fb=e.qo();S=new Lf.Selection([n],!0);this.ib.Kc(S);break;default:E.ULS.sendTraceTag(17094670,369,10,"The type of selectionMode is undefined!"),pc.a.td()}}w3c(e){return new IJ.a(this.Qe.vk(this.EG.Uo(e),!0,!1))}ctd(e){this.ib.q1h()||this.ib.Kc(e.restore())}xyi(e,n,C){var S,
ja=this.WLm(e,n,C);C=this.srm(e,n,C);if(!ja||!C)return null;ja.Fb=e.Fb;C.Tb=n.Tb;const ya=new fb.a;if(ja.equals(C))return ja.Tb=C.Tb,ya.add(ja),ya;ya.add(ja);const kb=this.hb.Ex(ja.node);if(ja.node.id.equals(C.node.id))return ja.contextId===Ma.a.Cd&&ja.cpEnd===this.hb.textLength(ja.node)&&C.contextId===Ma.a.Zc&&(ja.Tb=Math.min(kb,C.Tb),C.Tb=C.Fb=C.Tb),ya.add(C),ya;ja.Tb=kb;C.Fb=this.hb.vy(C.node);ja.contextId===Ma.a.Cd&&(ja=ce.a.Wl(ja.node),ja.Tb=ja.Fb=kb,ya.add(ja));e=e.node;n=n.node;do e=null!==
(S=this.hb.pg(e,!1,!0))&&void 0!==S?S:this.MBm(e),e.id.equals(n.id)||(ja=ce.a.create(e),ja.Fb=this.hb.vy(ja.node),ja.Tb=this.hb.Ex(ja.node),ya.add(ja));while(!e.id.equals(n.id));ya.add(C);return ya}WLm(e,n,C){if(!e||!n)return null;if(e.node.id.equals(n.node.id)){if(n.cpBegin===this.hb.textLength(n.node)&&C){if(e.cpBegin===n.cpBegin)return ce.a.Wl(e.node);if(!e.cpBegin)return ce.a.create(e.node)}return e.cpBegin===n.cpBegin?ce.a.Uc(e.node,e.cpBegin):ce.a.createTextRange(e.node,e.cpBegin,n.cpBegin)}return e.cpBegin?
e.cpBegin===this.hb.textLength(e.node)?ce.a.Wl(e.node):ce.a.createTextRange(e.node,e.cpBegin,this.hb.textLength(e.node)):ce.a.create(e.node)}srm(e,n,C){return e&&n?e.node.id.equals(n.node.id)?n.cpBegin===this.hb.textLength(n.node)&&C?e.cpBegin||e.cpBegin===n.cpBegin?ce.a.Wl(e.node):ce.a.create(e.node):e.cpBegin===n.cpBegin?ce.a.Uc(e.node,e.cpBegin):ce.a.createTextRange(e.node,e.cpBegin,n.cpBegin):C?ce.a.create(n.node):n.cpBegin?ce.a.createTextRange(n.node,0,n.cpBegin):ce.a.Uc(n.node,0):null}MBm(e){if(!pc.a.ubi())return null;
e=Ed.a.eb(e);if(!e.zb(37))return null;e.kd(38);return(e=e.Tk())?this.hb.Zm(e):null}}Object(F.a)(JJ,"SelectionApiHelper",null,[1186]);class lH{constructor(){this.zwd=new df;this.dKe=new sg}lAa(e,n){if(!e)return null;if(e.yP)return this.lAa(e.yP,n);if(!e.fma)return null;const C=new Ed.a;C.set(n);for(n=C.Vb(19);n;){const S=this.lXc(n);if(S&&S.RTh(e))return n;n=C.Kf(19)}return null}xsb(e,n){e||pc.a.hg();if(e.yP)return this.xsb(e.yP,n);if(e.fma){const C=this.Qsf(e);this.qdf(C,e,n);return C}return null}ftf(e,
n){const C=this.dKe.create(cj.a.BKb);C.setValue(hb.a.bTc,e);C.setValue(hb.a.Scc,n);return C}rqb(e,n){const C=new Ed.a;C.set(e.value);return n.ZR(C)&&C.Vb(18)?C:null}lXc(e){const n=e.getValue(hb.a.oTa),C=e.getValue(hb.a.cTc),S=e.getValue(hb.a.mmb),ja=e.getValue(hb.a.CKb),ya=e.getValue(hb.a.aTc),kb=e.getValue(hb.a.nmb),Rb=e.ka(dj.a.kjf,null),sc=e.ka(dj.a.ljf,0);e=e.id.toString();let Fc=null;ya||(Fc=new ql(e,e,n,C,S,ja,kb,!0,Rb,sc));return Fc}Qsf(e){const n=this.zwd.create(cj.a.KHa);n.setValue(hb.a.oTa,
e.Rn);n.setValue(hb.a.cTc,e.version);n.setValue(hb.a.mmb,e.store);n.setValue(hb.a.CKb,e.storeType);n.setValue(hb.a.nmb,e.dTc);n.setValue(hb.a.aTc,!1);n.setValue(hb.a.BRh,!1);n.setValue(hb.a.HRh,"");n.setValue(hb.a.MRh,"right");n.setValue(hb.a.PRh,350);n.setValue(hb.a.ORh,1);n.setValue(hb.a.NRh,!1);return n}qdf(e,n,C){const S=new Ed.a;S.set(C);e.anchor?pc.a.td():(n=Wc.a.Bf(n.GRh),Tj.a.compare(n.Gt,Tj.a.nil)&&(n=new Wc.a(Tj.a.create(),1)),S.d6(e,19,n))}}Object(F.a)(lH,"SettingOperations",null,[1185]);
var Hm=d(900);class qv{constructor(e,n,C,S,ja,ya){this.ld=null;this.hy=e;this.ga=n;this.hb=C;this.qoa=S;this.Dz=ja;this.eqa=ya;this.O4a=new id.a(()=>this.Dz.MHi());this.Pyh=new id.a(()=>{const kb=new fd.a,Rb=this.hy.yLf(),sc=this.hy.F7d();for(const Fc of Rb.keys)kb.add(Fc,Rb.K(Fc));for(const Fc of sc.keys)kb.add(Fc,sc.K(Fc));return kb})}get Kg(){return null!=this.s4g?this.s4g:this.s4g=gc.a.instance.Oa("Box4.Styles.StyleSettings")}su(e){this.ld=e}c3c(e){let n="";for(let C=0;C<e.count;C++){if(!this.f0f(e.K(C).contextId))continue;
const S=this.Dyi(e.K(C));""===n&&""!==S&&(n=S);if(S!==n)return""}return n}Dyi(e){if(!this.f0f(e.contextId))return"";const n=new Hm.a;return 2===this.ga.Hf(e,pe.a.XMa,2,!1,new wt.a,n)?this.Dyi(ce.a.create(e.node)):n.uva.getValue(Ld.a.la)}h6d(e){e=this.c3c(e).toLowerCase();return e in qv.QIb?qv.QIb[e]:-1}EHi(e){e=this.Dz.fH(e);return this.Dz.U8d(e)}zNm(e){e=this.EHi(e).toLowerCase();return e in qv.QIb?qv.QIb[e]:-1}XPj(e,n){pc.a.hBc(n,"Table.Style/Table.StyleBuiltIn");n=this.Huj(n);const C=this.Dz.QNm(n);
C?(n=this.Dz.J8d(e,C),this.eqa.U_b(n,e)):this.Qwc(this.hb.NA(e,!0,!1),n)}A_o(e,n){n=this.kBi(n);this.XPj(e,n)}Qwc(e,n){if(this.qoa.cVc(e,0)){n=this.Huj(n);var C=this.hy.ro();this.Kg.vn?(n=C.gv().GAa(n),C=C.nh(Gi.a.Yb.Be(n))):C=C.qKa(n);C||(E.ULS.sendTraceTag(17334858,369,15,"The style is not supported on word wac."),pc.a.td());if(3===this.hy.JF(C)){var S=this.ld.tvi(e.K(0).node);e=this.ld.tvi(e.K(e.count-1).node);S&&e&&S.id===e.id?this.eqa.U_b(C,S):(E.ULS.sendTraceTag(20841048,369,15,"The style only can be applied to table on word wac."),
pc.a.td())}else for(S of e)this.eyg(S,C)}}Ywe(e,n){n=this.kBi(n);this.Qwc(e,n)}kBi(e){let n="";for(const C of Object.keys(qv.QIb))if(qv.QIb[C]===e){n=C;break}e=n.split("-");1<e.length&&(n=e[0]+e[1].substr(1));for(const C of this.Pyh.value.keys)if(C.toLowerCase()===n)return this.Pyh.value.K(C);for(const C of this.O4a.value.keys)if(C.toLowerCase()===n)return this.O4a.value.K(C);return""}eyg(e,n){if(this.f0f(e.contextId)){var C=this.hy.JF(n);if(2===C){if(e.contextId===Ma.a.Vc||e.contextId===Ma.a.Cd){this.eyg(ce.a.create(e.node),
n);return}}else if(1===C){if(e.contextId===Ma.a.paragraph){this.eyg(ce.a.createTextRange(e.node,0,this.hb.textLength(e.node)),n);return}}else{E.ULS.sendTraceTag(17334859,369,10,"Table or other style is not supported on word wac.");return}n=this.hy.Be(n);this.ga.Hf(e,pe.a.zT,2,!1,new wt.a,n)}}Huj(e){if(!(e.trim().toLowerCase()in qv.QIb))return e.trim();let n="";e=e.trim().toLowerCase().split(" ");for(const C of e){for(e=0;e<C.length;e++)n=e?n+C.charAt(e):n+C.charAt(0).toUpperCase();n+=" "}return n.trimEnd()}f0f(e){switch(e){case Ma.a.paragraph:case Ma.a.Cd:case Ma.a.Vc:case Ma.a.view:return!0;
default:return!1}}}qv.QIb=ub.a.V8("other",-1,"normal",0,"heading 1",1,"heading 2",2,"heading 3",3,"heading 4",4,"heading 5",5,"heading 6",6,"heading 7",7,"heading 8",8,"heading 9",9,"toc 1",19,"toc 2",20,"toc 3",21,"toc 4",22,"toc 5",23,"toc 6",24,"toc 7",25,"toc 8",26,"toc 9",27,"footnote text",29,"header",31,"footer",32,"caption",34,"footnote reference",38,"endnote reference",42,"endnote text",43,"title",62,"subtitle",74,"hyperlink",85,"strong",87,"emphasis",88,"no spacing",157,"list paragraph",
179,"quote",180,"intense quote",181,"subtle emphasis",260,"intense emphasis",261,"subtle reference",262,"intense reference",263,"book title",264,"bibliography",265,"toc heading",266,"table grid",154,"plain table 1",267,"plain table 2",268,"plain table 3",269,"plain table 4",270,"plain table 5",271,"table grid light",272,"grid table 1 light",111,"grid table 1 light - accent 1",280,"grid table 1 light - accent 2",287,"grid table 1 light - accent 3",294,"grid table 1 light - accent 4",301,"grid table 1 light - accent 5",
308,"grid table 1 light - accent 6",315,"grid table 2",274,"grid table 2 - accent 1",281,"grid table 2 - accent 2",288,"grid table 2 - accent 3",295,"grid table 2 - accent 4",302,"grid table 2 - accent 5",309,"grid table 2 - accent 6",316,"grid table 3",275,"grid table 3 - accent 1",282,"grid table 3 - accent 2",289,"grid table 3 - accent 3",296,"grid table 3 - accent 4",303,"grid table 3 - accent 5",310,"grid table 3 - accent 6",317,"grid table 4",276,"grid table 4 - accent 1",283,"grid table 4 - accent 2",
290,"grid table 4 - accent 3",297,"grid table 4 - accent 4",304,"grid table 4 - accent 5",311,"grid table 4 - accent 6",318,"grid table 5 dark",277,"grid table 5 dark - accent 1",284,"grid table 5 dark - accent 2",291,"grid table 5 dark - accent 3",298,"grid table 5 dark - accent 4",305,"grid table 5 dark - accent 5",312,"grid table 5 dark - accent 6",319,"grid table 6 colorful",278,"grid table 6 colorful - accent 1",285,"grid table 6 colorful - accent 2",292,"grid table 6 colorful - accent 3",299,
"grid table 6 colorful - accent 4",306,"grid table 6 colorful - accent 5",313,"grid table 6 colorful - accent 6",320,"grid table 7 colorful",279,"grid table 7 colorful - accent 1",286,"grid table 7 colorful - accent 2",293,"grid table 7 colorful - accent 3",300,"grid table 7 colorful - accent 4",307,"grid table 7 colorful - accent 5",314,"grid table 7 colorful - accent 6",321,"list table 1 Light",322,"list table 1 light - accent 1",329,"list table 1 light - accent 2",336,"list table 1 light - accent 3",
343,"list table 1 light - accent 4",350,"list table 1 light - accent 5",357,"list table 1 light - accent 6",364,"list table 2",323,"list table 2 - accent 1",330,"list table 2 - accent 2",337,"list table 2 - accent 3",344,"list table 2 - accent 4",351,"list table 2 - accent 5",358,"list table 2 - accent 6",365,"list table 3",324,"list table 3 - accent 1",331,"list table 3 - accent 2",338,"list table 3 - accent 3",345,"list table 3 - accent 4",352,"list table 3 - accent 5",359,"list table 3 - accent 6",
366,"list table 4",325,"list table 4 - accent 1",332,"list table 4 - accent 2",339,"list table 4 - accent 3",346,"list table 4 - accent 4",353,"list table 4 - accent 5",360,"list table 4 - accent 6",367,"list table 5 dark",326,"list table 5 dark - accent 1",333,"list table 5 dark - accent 2",340,"list table 5 dark - accent 3",347,"list table 5 dark - accent 4",354,"list table 5 Dark - accent 5",361,"list table 5 Dark - accent 6",368,"list table 6 colorful",327,"list table 6 colorful - accent 1",334,
"list table 6 colorful - accent 2",341,"list table 6 colorful - accent 3",348,"list table 6 colorful - accent 4",355,"list table 6 colorful - accent 5",362,"list table 6 colorful - accent 6",369,"list table 7 colorful",328,"list table 7 colorful - accent 1",335,"list table 7 colorful - accent 2",342,"list table 7 colorful - accent 3",349,"list table 7 colorful - accent 4",356,"list table 7 colorful - accent 5",363,"list table 7 colorful - accent 6",370);Object(F.a)(qv,"StyleApiHelper",null,[1184]);
var Uu;(function(e){e[e.top=0]="top";e[e.left=1]="left";e[e.bottom=2]="bottom";e[e.right=3]="right";e[e.OSi=4]="insideHorizontal";e[e.PSi=5]="insideVertical";e[e.a6p=6]="inside";e[e.cqj=7]="outside";e[e.all=8]="all"})(Uu||(Uu={}));Object(F.b)("BorderLocation",Uu);class Np extends Hh.a{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd){super();this.iW=[0,2,1,3];this.Tf=e;this.Jgb=n;this._context=C;this.fd=S;this.Rh=ja;this.aE=ya;this.Dz=kb;this.Nl=Rb;this.S5=sc;this.W4=Fc;this.eqa=gd;this.aLe=new id.a(()=>
this.Jjm());this.$Ke=new id.a(()=>this.Hjm())}get color(){return this.yNf(3).toUpperCase()}set color(e){e=pc.a.$Oa(e,"TableBorder.Color",this._context);this.lzg(3,e)}get type(){let e=this.yNf(2);e||(e="mixed");return this.aLe.value.K(e)}set type(e){-1===e&&pc.a.td();this.lzg(2,this.Ijm(e))}get width(){let e=this.yNf(1);e||(e="0");return parseFloat(e)}set width(e){pc.a.D0a(e,"TableBorder.Width");12<e&&pc.a.td();this.lzg(1,e.toString())}get _ReferenceId(){return this.Hp?this.Vp:null}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.Tf,
"TableBorder")}getTypeName(){return"Microsoft.WordServices.TableBorder"}invokePropertyGet(e){switch(e){case 2:return this.color;case 3:return this.type;case 4:return this.width;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 2:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 3:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}yNf(e){switch(this.Tf.type){case 16:return this.rfa(this.Tf,this.Jgb,e);case 15:return this.IAa(this.Tf,this.Jgb,e);case 14:return this.Tf.hasProperty(hb.a.Kna)?this.zsa(this.Tf,this.Jgb,e):this.w9a(this.Tf,this.Jgb,e);default:return E.ULS.sendTraceTag(20828692,369,10,"AppId:{0}, The node type is invalid when get table border",
this._context.appId),pc.a.hg(),null}}rfa(e,n,C){let S=null;switch(n){case 8:case 7:S=this.KDm(e,C);break;case 1:case 3:case 0:case 2:S=this.Dz.Wqm(wE.a.ZDf(),e,this.$Ke.value.K(Uu[n]),C);3===C&&S===kp.a.e2&&(S="#000000");break;default:E.ULS.sendTraceTag(20828693,369,15,"AppId:{0}, The border location is invalid when get table cell border",this._context.appId),pc.a.td()}return S}IAa(e,n,C){var S=null;switch(n){case 1:case 3:S=this.fd.mg(e);1===n?this.Nl.Uje(S):this.Nl.T8f(S);S=this.rfa(S.currentNode,
n,C);break;case 0:case 2:var ja=this.aE.KA(e);S=this.rfa(ja.K(0),n,C);for(e=1;e<ja.count;e++)if(S!==this.rfa(ja.K(e),n,C))return this.nfa(C);break;case 6:case 5:ja=this.aE.KA(e);1===ja.count&&(E.ULS.sendTraceTag(20828694,369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),pc.a.td());S=this.rfa(ja.K(0),3,C);if(this.Tf.hasProperty(hb.a.Kna))for(n=1;n<ja.count;n++)if(S!==this.rfa(ja.K(n),1,C))return this.nfa(C);for(n=1;n<ja.count-1;n++)if(S!==this.rfa(ja.K(n),
3,C))return this.nfa(C);break;case 7:S=this.IAa(e,this.iW[0],C);for(ja=1;ja<this.iW.length;ja++)if(S!==this.IAa(e,this.iW[ja],C))return this.nfa(C);break;case 8:S=this.IAa(e,7,C);ja=this.aE.KA(e);if(1<ja.count&&S!==this.IAa(e,6,C))return this.nfa(C);break;default:E.ULS.sendTraceTag(20828695,369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),pc.a.td()}return S}w9a(e,n,C){var S=null,ja;let ya;switch(n){case 1:case 3:e=this.Rh.wy(e,0,this.Rh.vg(e)-1);S=
this.IAa(e.K(0),n,C);if(this.oTb(S))break;for(ja=1;ja<e.count;ja++)if(S!==this.IAa(e.K(ja),n,C))return this.nfa(C);break;case 0:case 2:S=this.fd.mg(e);n?this.Nl.V8f(S):this.Nl.PVb(S);S=this.IAa(S.currentNode,n,C);break;case 4:ja=this.Rh.vg(e);1>=ja&&(E.ULS.sendTraceTag(20828696,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),pc.a.td());e=this.Rh.wy(e,0,ja-1);S=this.IAa(e.K(0),2,C);if(this.oTb(S))break;for(n=1;n<ja-1;n++)if(S!==this.IAa(e.K(n),2,C))return this.nfa(C);
break;case 5:ya=this.Rh.Eh(e);1>=ya&&(E.ULS.sendTraceTag(20828697,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),pc.a.td());ja=this.Rh.vg(e);e=this.Rh.wy(e,0,ja-1);S=this.IAa(e.K(0),n,C);if(this.oTb(S))break;for(ja=1;ja<e.count;ja++)if(S!==this.IAa(e.K(ja),n,C))return this.nfa(C);break;case 6:ja=this.Rh.vg(e);ya=this.Rh.Eh(e);if(1===ya&&1===ja)E.ULS.sendTraceTag(20828698,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),
pc.a.td();else if(1===ya)S=this.w9a(e,4,C);else if(1===ja)S=this.w9a(e,5,C);else if(S=this.w9a(e,4,C),!this.oTb(S)&&S!==this.w9a(e,5,C))return this.nfa(C);break;case 7:S=this.w9a(e,this.iW[0],C);if(this.oTb(S))break;for(n=1;n<this.iW.length;n++)if(S!==this.w9a(e,this.iW[n],C))return this.nfa(C);break;case 8:if(S=this.w9a(e,7,C),!this.oTb(S)&&(1<this.Rh.Eh(e)||1<this.Rh.vg(e))&&S!==this.w9a(e,6,C))return this.nfa(C)}return S}zsa(e,n,C){let S=null;switch(n){case 1:case 3:case 0:case 2:case 4:case 5:S=
this.Dz.H5d(wE.a.ZDf(),e,this.$Ke.value.K(Uu[n]),C);3===C&&S===kp.a.e2&&(S="#000000");break;case 6:S=this.zsa(e,4,C);if(S!==this.zsa(e,5,C))return this.nfa(C);break;case 7:S=this.zsa(e,this.iW[0],C);for(n=1;n<this.iW.length;n++)if(S!==this.zsa(e,this.iW[n],C))return this.nfa(C);break;case 8:if(S=this.zsa(e,7,C),!this.oTb(S)&&S!==this.zsa(e,6,C))return this.nfa(C)}return S}KDm(e,n){const C=this.rfa(e,this.iW[0],n);for(let S=1;S<this.iW.length;S++)if(C!==this.rfa(e,this.iW[S],n))return this.nfa(n);
return C}nfa(e){switch(e){case 2:return"mixed";case 1:return"0";case 3:return""}return null}oTb(e){return"0"===e||"mixed"===e||""===e}lzg(e,n){switch(this.Tf.type){case 16:var C=this.fd.mg(this.Tf);C.zb(14);C=this.Nl.getContainingTable(C);this.Nxe(this.Tf,this.Jgb,e,n,!C.hasProperty(hb.a.Kna));break;case 15:this.Dyb(this.Tf,this.Jgb,e,n,!this.Tf.hasProperty(hb.a.Kna));break;case 14:this.Tf.hasProperty(hb.a.Kna)?this.bxc(this.Tf,this.Jgb,e,n):this.V_b(this.Tf,this.Jgb,e,n);break;default:E.ULS.sendTraceTag(20841049,
369,10,"AppId:{0}, The node type is invalid when setting table border",this._context.appId),pc.a.hg()}}Nxe(e,n,C,S,ja=!0){switch(n){case 0:case 2:case 1:case 3:this.SPj(e,n,C,S,ja);break;case 8:case 7:this.SXo(e,C,S,ja);break;default:E.ULS.sendTraceTag(20841050,369,15,"AppId:{0}, The border location is invalid when setting table cell border",this._context.appId),pc.a.td()}}Dyb(e,n,C,S,ja=!0){switch(n){case 1:case 3:ja=this.fd.mg(e);1===n?this.Nl.Uje(ja):this.Nl.T8f(ja);this.S5.gr(ja.currentNode)||
this.Nxe(ja.currentNode,n,C,S);break;case 0:case 2:e=this.aE.KA(e);for(let ya=0;ya<e.count;ya++)this.Nxe(e.K(ya),n,C,S,ja);break;case 6:case 5:e=this.aE.KA(e);1===e.count&&(E.ULS.sendTraceTag(20841051,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),pc.a.td());for(n=0;n<e.count-1;n++)this.Nxe(e.K(n),3,C,S);break;case 7:for(n=0;n<this.iW.length;n++)this.Dyb(e,this.iW[n],C,S,ja);break;case 8:this.Dyb(e,7,C,S,ja);this.Dyb(e,6,C,S,ja);break;default:E.ULS.sendTraceTag(20841052,
369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),pc.a.td()}}V_b(e,n,C,S){var ja;switch(n){case 1:case 3:e=this.Rh.wy(e,0,this.Rh.vg(e)-1);for(ja=0;ja<e.count;ja++)this.Dyb(e.K(ja),n,C,S);break;case 0:case 2:ja=this.fd.mg(e);n?this.Nl.V8f(ja):this.Nl.PVb(ja);this.Dyb(ja.currentNode,n,C,S);break;case 4:ja=this.Rh.vg(e);1>=ja&&(E.ULS.sendTraceTag(20841053,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),
pc.a.td());e=this.Rh.wy(e,0,ja-1);for(n=0;n<ja-1;n++)this.Dyb(e.K(n),2,C,S);break;case 5:var ya=this.Rh.Eh(e);1>=ya&&(E.ULS.sendTraceTag(20841054,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),pc.a.td());ja=this.Rh.vg(e);e=this.Rh.wy(e,0,ja-1);for(ya=0;ya<ja;ya++)this.Dyb(e.K(ya),n,C,S);break;case 6:ja=this.Rh.vg(e);ya=this.Rh.Eh(e);1===ya&&1===ja?(E.ULS.sendTraceTag(20841055,369,15,"AppId:{0}, The border location is invalid when setting table border",
this._context.appId),pc.a.td()):1===ya?this.V_b(e,4,C,S):(1!==ja&&this.V_b(e,4,C,S),this.V_b(e,5,C,S));break;case 7:for(n=0;n<this.iW.length;n++)this.V_b(e,this.iW[n],C,S);break;case 8:this.V_b(e,7,C,S),(1<this.Rh.Eh(e)||1<this.Rh.vg(e))&&this.V_b(e,6,C,S)}}bxc(e,n,C,S){switch(n){case 1:case 3:case 0:case 2:case 4:case 5:this.v_o(e,n,C,S);break;case 6:this.bxc(e,4,C,S);this.bxc(e,5,C,S);break;case 7:for(n=0;n<this.iW.length;n++)this.bxc(e,this.iW[n],C,S);break;case 8:this.bxc(e,6,C,S),this.bxc(e,
7,C,S)}}SPj(e,n,C,S,ja=!0){let ya=null,kb=null;var Rb=null;switch(C){case 3:ya=this.rfa(e,n,2);kb=S;Rb=this.rfa(e,n,1);break;case 1:ya=this.rfa(e,n,2);kb=pc.a.$Oa(this.rfa(e,n,3),"TableBorder.Color",this._context);Rb=S;break;case 2:ya=S,kb=pc.a.$Oa(this.rfa(e,n,3),"TableBorder.Color",this._context),Rb=this.rfa(e,n,1)}C=parseInt(kb,16);Rb=parseFloat(Rb);this.mzg(e,n,ya,Rb,C);ja&&(n=({B3k:e}=this.Rgm(e,n)).returnValue)&&this.mzg(n,e,ya,Rb,C)}mzg(e,n,C,S,ja,ya=!0){n=this.$Ke.value.K(Uu[n]);ya=ya?this.W4.zR(n):
this.W4.$O(n);ya||(E.ULS.sendTraceTag(20841056,369,10,"AppId:{0}, The border property definition is invalid when setting table border",this._context.appId),pc.a.hg());this.eqa.ISo(e,ya,C,S,ja)}Rgm(e,n){e=this.fd.mg(e);e.zb(14);let C=null,S=0;switch(n){case 0:C=this.Nl.$ej(e);S=2;break;case 2:C=this.Nl.Y8f(e);S=0;break;case 1:this.S5.Xla(e)||(C=this.Nl.W8f(e,!0),S=3);break;case 3:this.S5.Xfa(e)||(C=this.Nl.W8f(e,!1),S=1)}return{returnValue:C,B3k:S}}SXo(e,n,C,S=!0){for(let ja=0;ja<this.iW.length;ja++)this.SPj(e,
this.iW[ja],n,C,S)}Ijm(e){for(const n of this.aLe.value.keys)if(this.aLe.value.K(n)===e)return n;return""}v_o(e,n,C,S){let ja=null,ya=null,kb=null;switch(C){case 3:ja=this.zsa(e,n,2);ya=S;kb=this.zsa(e,n,1);break;case 1:ja=this.zsa(e,n,2);ya=pc.a.$Oa(this.zsa(e,n,3),"TableBorder.Color",this._context);kb=S;break;case 2:ja=S,ya=pc.a.$Oa(this.zsa(e,n,3),"TableBorder.Color",this._context),kb=this.zsa(e,n,1)}this.mzg(e,n,ja,parseFloat(kb),parseInt(ya,16),!1)}Hjm(){const e=new fd.a;e.W("top",5);e.W("left",
3);e.W("bottom",0);e.W("right",4);e.W("insideHorizontal",1);e.W("insideVertical",2);return e}Jjm(){const e=new fd.a;e.W("mixed",-1);e.W("none",0);e.W("single",1);e.W("double",3);e.W("dotted",6);e.W("dashed",7);e.W("dotDash",8);e.W("dotDotDash",9);e.W("triple",10);e.W("thinThickSmallGap",11);e.W("thickThinSmallGap",12);e.W("thinThickThinSmallGap",13);e.W("thinThickMediumGap",14);e.W("thickThinMediumGap",15);e.W("thinThickThinMediumGap",16);e.W("thinThickLargeGap",17);e.W("thickThinLargeGap",18);e.W("thinThickThinLargeGap",
19);e.W("wave",20);e.W("doubleWave",21);e.W("dashSmallGap",22);e.W("dashDotStroked",23);e.W("threeDEmboss",24);e.W("threeDEngrave",25);return e}}Object(F.a)(Np,"TableBorder",Hh.a,[901]);class mH{constructor(e,n,C,S,ja,ya,kb,Rb){this.fd=e;this.Rh=n;this.aE=C;this.Dz=S;this.Nl=ja;this.W4=kb;this.eqa=Rb;ya&&ya.execute(sc=>{null==sc?E.ULS.sendTraceTag(523580866,324,10,"ITableCellReader is null after future execution"):this.S5=sc})}create(e,n,C){return new Np(e,n,C,this.fd,this.Rh,this.aE,this.Dz,this.Nl,
this.S5,this.W4,this.eqa)}}Object(F.a)(mH,"TableBorderFactory",null,[]);class Pv extends Hh.a{constructor(e,n,C,S,ja,ya){super();this.YIb=null;this.rh=e;this.N4a=n;this.Upk=C;this._context=S;this.ld=ja;this.Rh=ya}length(){return this.YIb.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){this.n9j();return this.YIb&&this.length()?this.YIb.K(0):null}_GetItem(e){e=pc.a.QN(e);if(e<this.length())return this.YIb.K(e);
E.ULS.sendTraceTag(19969494,369,10,"The index is out of the table row range.");pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){this.n9j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.TableRowCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}n9j(){switch(this.Upk){case 1:let n=null,C=null;for(var e=0;e<this.N4a.count;e++)if(this.N4a.K(e).isConnected){n=this.N4a.K(e);break}for(e=this.N4a.count-
1;0<=e;e--)if(this.N4a.K(e).isConnected){C=this.N4a.K(e);break}if(!n&&!C){this.N4a.clear();this.YIb.clear();break}this.N4a=this.Rh.wMf(this.rh,n,C);this.YIb=this.ld.JHi(this.N4a,this._context);break;case 0:this.YIb=this.ld.JHi(this.Rh.wy(this.rh,0,this.Rh.vg(this.rh)-1),this._context);break;default:E.ULS.sendTraceTag(20756162,369,10,"AppId:{0}, something went wrong when refresh the table row collection.",this._context.appId)}}}Object(F.a)(Pv,"TableRowCollection",Hh.a,[901,931]);class BB extends Hh.a{constructor(e,
n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd){super();pc.a.bPa(e,"TableCell");this.sA=e;this._context=n;this._id=C;this.aea=S;this.qQ=ja;this.fd=ya;this.YGa=kb;this.Nl=Rb;this.S5=sc;this.ld=Fc;this.Rh=gd;this.cqa=td;this.GG=Bd}get body(){return this.qQ.create(this.sA,this._context)}get cellIndex(){return this.ld.Skm(this.sA)}get columnWidth(){var e=this.ld.Q2(this.sA);if(this.Rh.oD(e))return null;var n=this.fd.mg(this.sA);n.zb(14);n=this.cqa.j2c(n);e=this.cqa.$4d(e);return-1===e[n]?0:oi.a.wbb(e[n])}set columnWidth(e){pc.a.D0a(e,
"TableCell.ColumnWidth");const n=this.ld.Q2(this.sA);this.Rh.oD(n)&&pc.a.hg();var C=this.fd.mg(this.sA);C.zb(14);C=this.cqa.j2c(C);var S=this.fd.mg(n);let ja=0;if(S.zb(14)){let ya;const kb=({Krd:ya}=this.ld.z4c(n)).returnValue;ya&&!this.ld.FMi(kb)||pc.a.hg();S=this.ld.gHf(S)-ya+kb[C];0<S?ja=Math.min(oi.a.rua(e),S):pc.a.hg()}else ja=oi.a.rua(e);this.GG.cva(n,C,ja)}get horizontalAlignment(){return this.ld.rJf(this.sA)}set horizontalAlignment(e){this.ld.gyg(this.sA,e)}get parentRow(){return this.ld.nFm(this.sA,
this._context)}get parentTable(){return this.ld.drb(this.sA,this._context)}get rowIndex(){return this.ld.Ft(this.sA)}get shadingColor(){let e=this.ld.SMf(this.sA);return null!=e?e:""}set shadingColor(e){e=pc.a.$Oa(e,"TableCell.ShadingColor",this._context);this.ld.azg(this.sA,e)}get value(){return this.ld.HOf(this.sA)}set value(e){this.ld.Ezg(this.sA,e)}get verticalAlignment(){return this.ld.IOf(this.sA)}set verticalAlignment(e){this.ld.Gzg(this.sA,e)}get width(){return oi.a.wbb(this.ld.y4c(this.sA))}get _Id(){return this._id}get _ReferenceId(){return this.Hp?
this.Vp:null}deleteColumn(){const e=this.ld.Q2(this.sA);this.Rh.oD(e)&&pc.a.hg();this.ld.rei(this.sA)}deleteRow(){var e=this.fd.mg(this.sA);e.zb(15);e=this.Nl.fug(e);this.ld.Avf(e)}getBorder(e){return this.YGa.create(this.sA,e,this._context)}getCellPadding(e){switch(e){case 1:return this.ld.R6d(this.sA);case 3:return this.ld.n8d(this.sA);case 0:return this.ld.hOf(this.sA);case 2:return this.ld.rGf(this.sA);default:return pc.a.td(),null}}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){let e=
null;const n=this.fd.mg(this.sA);n.zb(14);this.S5.Xfa(n)||(e=this.Nl.W8f(n,!1));return e?this.aea.create(e,this._context):null}insertColumns(e,n,C){const S=this.fd.mg(this.sA);S.zb(14);const ja=this.ld.Q2(this.sA);this.Rh.oD(ja)&&(E.ULS.sendTraceTag(20758723,369,15,"The table is complex table when insert columns"),pc.a.hg());this.Nl.PVb(S);this.ld.insertColumns(n,S,e,C,this._context)}insertRows(e,n,C){pc.a.D0a(n,"TableCell.InsertRows()");const S=this.fd.mg(this.sA);S.zb(14);this.Nl.fug(S);e=this.ld.insertRows(n,
S,e,C,this._context);this.Nl.Tue(S);return new Pv(S.currentNode,e,1,this._context,this.ld,this.Rh)}setCellPadding(e,n){this.ld.setCellPadding(this.sA,e,n)}split(e,n){if(0>=e||32767<e||0>=n||63<n)E.ULS.sendTraceTag(521483540,369,15,"The row/column count exceeds the maxium column size"),pc.a.td();const C={};C.rows=e;C.columns=n;this.ld.aOa(this.sA,C)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.sA,"TableCell")}getTypeName(){return"Microsoft.WordServices.TableCell"}invokePropertyGet(e){switch(e){case 8:return this.body;
case 6:return this.cellIndex;case 15:return this.columnWidth;case 12:return this.horizontalAlignment;case 4:return this.parentRow;case 3:return this.parentTable;case 5:return this.rowIndex;case 9:return this.shadingColor;case 7:return this.value;case 14:return this.verticalAlignment;case 16:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,
n){switch(e){case 15:this.columnWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number?");return;case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 9:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 14:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1007:return this.pQl();case 1006:return this.cRl();case 1008:return this.W1c(n);case 1023:return this.d2c(n);case 1011:return this.i7();case 1012:return this.j7();case 1004:return this.aan(n);case 1003:return this.$Uf(n);case 1024:return this.rnd(n);case 1005:return this.L0b(n);
case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}pQl(){this.deleteColumn();return null}cRl(){this.deleteRow();return null}W1c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getBorder(e)}d2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getCellPadding(e)}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}aan(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");this.insertColumns(n,C,e);return null}$Uf(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");
return this.insertRows(n,C,e)}rnd(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");this.setCellPadding(n,e);return null}L0b(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this.split(n,e);return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(BB,"TableCell",
Hh.a,[901]);class Tr{constructor(e,n,C,S,ja,ya,kb){this.ld=this.qQ=null;this.fd=e;this.YGa=n;this.Nl=C;this.Rh=ja;this.cqa=ya;this.GG=kb;S&&S.execute(Rb=>{null==Rb?E.ULS.sendTraceTag(523580865,324,10,"ITableCellReader is null after future execution"):this.S5=Rb})}su(e,n){this.ld=e;this.qQ=n}create(e,n,C=0){return new BB(e,n,C,this,this.qQ,this.fd,this.YGa,this.Nl,this.S5,this.ld,this.Rh,this.cqa,this.GG)}}Object(F.a)(Tr,"TableCellFactory",null,[1080]);var Qv=d(890);class oL extends Hh.a{constructor(e,
n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk,al,Cj){super();pc.a.bPa(e,"Table");this.rh=e;this._context=n;this._id=C;this.zC=ya;this.Fac=S;this.aea=ja;this.fd=kb;this.zo=Rb;this.nk=sc;this.YGa=Fc;this.Hl=gd;this.GG=td;this.Rh=Bd;this.ld=wd;this.aE=te;this.vB=Xf;this.Dz=Le;this.eqa=Oe;this.hb=We;this.Nl=Aj;this.Yc=Gg;this.sh=Ph;this.Lq=Ih;this.cFa=Nm;this.ul=Sk;this.EGa=hk;this.xB=al;this.Xx=Cj}RDa(e){this.eqa.RDa(e,this.rh)}get alignment(){return this.ld.Ygm(this.rh)}set alignment(e){this.ld.cSo(this.rh,
e)}get endnotes(){var e=this.Yc.Hjc(this.rh,1);e=this.Yc.sza(e,this._context);return new Qu(e)}get fields(){return new Wt(this.Xx.Fxi(this.rh,this._context,!1))}get font(){return this.zC.create(5,this.rh,null,null,this._context)}get footnotes(){var e=this.Yc.Hjc(this.rh,0);e=this.Yc.sza(e,this._context);return new Qu(e)}get headerRowCount(){return this.GG.Y8a(this.rh)}set headerRowCount(e){var n=this.Rh.vg(this.rh);if(0>e||e>n)E.ULS.sendTraceTag(20833941,369,15,"Invalid HeaderRowCount when set Table.HeaderRowCount."),
pc.a.td();var C=e;n=this.Rh.wy(this.rh,0,n-1);for(const S of n)n=S.ka(hb.a.Xtb,!1),0<C?n||S.setValue(hb.a.Xtb,!0):n&&S.setValue(hb.a.Xtb,!1),C--;C=this.Dz.O2(this.rh);this.RDa(e?C|32:C&-33)}get horizontalAlignment(){return this.ld.WQb(this.rh,Object(ic.a)(this.ld,this.ld.rJf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(e){this.ld.gyg(this.rh,e)}get isUniform(){return!this.Rh.oD(this.rh)}get nestingLevel(){return this.ld.CHi(this.rh)}get parentBody(){return this.ld.BLf(this.rh,
this._context)}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||pc.a.Wk();return e}get parentContentControlOrNullObject(){const e=ce.a.create(this.hb.Zm(this.rh)),n=ce.a.create(this.hb.GF(this.rh));this.Yc.QOa(e,n);return this.sh.Skc(e,n,this._context)}get parentTable(){const e=this.parentTableOrNullObject;e||pc.a.Wk();return e}get parentTableCell(){const e=this.parentTableCellOrNullObject;e||pc.a.Wk();return e}get parentTableCellOrNullObject(){return this.ld.vkc(this.rh,
this._context)}get parentTableOrNullObject(){return this.ld.drb(this.rh,this._context)}get rowCount(){return this.Rh.vg(this.rh)}get rows(){return new Pv(this.rh,null,0,this._context,this.ld,this.Rh)}get shadingColor(){return this.ld.WQb(this.rh,Object(ic.a)(this.ld,this.ld.SMf,"getShadingColorOfTableCellNode"),"")}set shadingColor(e){e=pc.a.$Oa(e,"Table.ShadingColor",this._context);this.ld.azg(this.rh,e)}get style(){return this.xB.EHi(this.rh)}set style(e){this.xB.XPj(this.rh,e)}get styleBandedColumns(){return this.Dz.O2(this.rh)&
1024?!1:!0}set styleBandedColumns(e){let n=this.Dz.O2(this.rh);this.RDa(e?n&-1025:n|1024)}get styleBandedRows(){return this.Dz.O2(this.rh)&512?!1:!0}set styleBandedRows(e){let n=this.Dz.O2(this.rh);this.RDa(e?n&-513:n|512)}get styleBuiltIn(){return this.xB.zNm(this.rh)}set styleBuiltIn(e){this.xB.A_o(this.rh,e)}get styleFirstColumn(){return this.Dz.O2(this.rh)&128?!0:!1}set styleFirstColumn(e){let n=this.Dz.O2(this.rh);this.RDa(e?n|128:n&-129)}get styleLastColumn(){return this.Dz.O2(this.rh)&256?
!0:!1}set styleLastColumn(e){let n=this.Dz.O2(this.rh);this.RDa(e?n|256:n&-257)}get styleTotalRow(){return this.Dz.O2(this.rh)&64?!0:!1}set styleTotalRow(e){let n=this.Dz.O2(this.rh);this.RDa(e?n|64:n&-65)}get tables(){return new nB(5,this.rh,null,null,this._context,this.ld)}get values(){return this.ld.vJi(this.rh)}set values(e){this.ld.vQj(this.rh,e)}get verticalAlignment(){return this.ld.WQb(this.rh,Object(ic.a)(this.ld,this.ld.IOf,"getVerticalAlignmentOfTableCellNode"),-1)}set verticalAlignment(e){this.ld.Gzg(this.rh,
e)}get width(){let e=0;({Krd:e}=this.ld.z4c(this.rh));return oi.a.wbb(e)}set width(e){pc.a.D0a(e,"Table.Width");var n;const C=({Krd:n}=this.ld.z4c(this.rh)).returnValue;var S=this.fd.mg(this.rh);e=S.zb(14)?Math.min(oi.a.rua(e),this.ld.gHf(S)):oi.a.rua(e);if(n)for(S=0;S<C.length;S++)this.cFa.cva(this.rh,S,C[S]/n*e);else for(n=0;n<C.length;n++)this.cFa.cva(this.rh,n,e/C.length)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}addColumns(e,n,C){this.Rh.oD(this.rh)&&(E.ULS.sendTraceTag(20758721,
369,15,"The table is complext table when add columns"),pc.a.hg());const S=this.fd.mg(this.rh);this.Nl.PVb(S);switch(e){case 2:e=0;this.Nl.Uje(S);break;case 3:e=1;this.Nl.T8f(S);break;default:E.ULS.sendTraceTag(20758722,369,15,"AppId:{0}, Invalid insert location for Table.AddColumns method.",this._context.appId),pc.a.td()}this.ld.insertColumns(n,S,e,C,this._context)}addRows(e,n,C){pc.a.D0a(n,"Table.AddRows()");const S=this.fd.mg(this.rh);switch(e){case 2:e=0;this.Nl.PVb(S);break;case 3:e=1;this.Nl.V8f(S);
break;default:E.ULS.sendTraceTag(20756128,369,15,"AppId:{0}, Invalid insert location for Table.Addrows method.",this._context.appId),pc.a.td()}e=this.ld.insertRows(n,S,e,C,this._context);return new Pv(this.rh,e,1,this._context,this.ld,this.Rh)}autoFitWindow(){var e=this.fd.mg(this.rh),n=0;e.zb(14)?n=this.ld.gHf(e):e.zb(10)?(n=e.Dp(10),n=oi.a.jJg(this.ul.Jv(n)-this.ul.gN(n)-this.ul.hN(n))):e.zb(38)&&(n=e.Dp(38),n=this.EGa.Mkc(n),n=oi.a.Ffa(n.FWc/96));var C;e=({Krd:C}=this.ld.z4c(this.rh)).returnValue;
if(C)for(let S=0;S<e.length;S++)this.cFa.cva(this.rh,S,e[S]/C*n);else for(C=0;C<e.length;C++)this.cFa.cva(this.rh,C,n/e.length)}clear(){this.ld.R2h(this.rh)}deleteObject(){this.ld.RW(this.rh)}deleteColumns(e,n){null===n&&(n=1);var C=this.Rh.Eh(this.rh);(0>e||0>=n||e+n>C)&&pc.a.td();this.Rh.oD(this.rh)&&pc.a.hg();if(n===C)this.ld.RW(this.rh);else{C=this.fd.mg(this.rh);this.Nl.PVb(C);C=this.aE.KA(C.currentNode);for(let S=e;S<e+n;S++)this.ld.rei(C.K(S))}}deleteRows(e,n){null===n&&(n=1);const C=this.Rh.vg(this.rh);
(0>e||0>=n||e+n>C)&&pc.a.td();if(n===C)this.ld.RW(this.rh);else{e=this.Rh.wy(this.rh,e,e+n-1);for(const S of e)this.ld.Avf(S)}}distributeColumns(){this.Rh.oD(this.rh)&&pc.a.hg();let e;const n=({Krd:e}=this.ld.z4c(this.rh)).returnValue;n.length&&e||pc.a.hg();for(let C=0;C<n.length;C++)this.cFa.cva(this.rh,C,e/n.length)}getBorder(e){return this.YGa.create(this.rh,e,this._context)}getCell(e,n){(e=this.getCellOrNullObject(e,n))||pc.a.Wk();return e}getCellOrNullObject(e,n){if(0>e||0>n||e>=this.Rh.vg(this.rh)||
n>=this.Rh.Eh(this.rh))return null;const C=this.fd.mg(this.rh);return(e=this.Nl.Zej(C,e,n))?this.aea.create(e,this._context):null}getCellPadding(e){switch(e){case 1:e=this.ld.WQb(this.rh,Object(ic.a)(this.ld,this.ld.R6d,"getLeftMarginOfTableCellNode"),-1);break;case 3:e=this.ld.WQb(this.rh,Object(ic.a)(this.ld,this.ld.n8d,"getRighttMarginOfTableCellNode"),-1);break;case 0:e=this.ld.WQb(this.rh,Object(ic.a)(this.ld,this.ld.hOf,"getTopMarginOfTableCellNode"),-1);break;case 2:e=this.ld.WQb(this.rh,Object(ic.a)(this.ld,
this.ld.rGf,"getBottomMarginOfTableCellNode"),-1);break;default:return pc.a.td(),null}return-1===e?null:e}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){var e=this.fd.mg(this.rh);return(e=this.Nl.QPn(e))?this.Fac.create(e,this._context):null}getParagraphAfter(){const e=this.getParagraphAfterOrNullObject();e||pc.a.Wk();return e}getParagraphAfterOrNullObject(){const e=this.hb.pg(this.rh,!1,!0,!1);return e?this.zo.create(e,this._context):null}getParagraphBefore(){const e=
this.getParagraphBeforeOrNullObject();e||pc.a.Wk();return e}getParagraphBeforeOrNullObject(){const e=this.hb.pg(this.rh,!0,!0,!0);return e?this.zo.create(e,this._context):null}getRange(e){1!==e&&2!==e&&e&&4!==e&&(E.ULS.sendTraceTag(20506275,369,15,"AppId:{0}, rangeLocation of Table.GetRange must be Start/End/Whole/After.",this._context.appId),pc.a.td());const n=this.hb.NA(this.rh,!0,!1);return(e=this.Hl.DPb(n,e))?this.nk.create(e,this._context):null}insertContentControl(){return this.sh.sqa(this.Yc.qfc(this.hb.Zm(this.rh),
!0),this.Yc.qfc(this.hb.GF(this.rh),!1),this._context)}insertParagraph(e,n){var C=!0;switch(n){case 0:n=1;break;case 1:n=0;C=!1;break;default:E.ULS.sendTraceTag(20509196,369,15,"The type of insert location is not supported in Table.InsertParagraph: {0}.",bt.a[n]),pc.a.td()}var S=this.hb.pg(this.rh,C,!1,!1),ja=new fb.a;ja.add(ce.a.create(this.rh));ja=this.ld.D6d(ja,C);C=ja.node;if(S){let ya;C=this.Yc.insertParagraph((ya=new fb.a,ya.add(ja),ya),e,n)}else S=new fb.a,S.add(ce.a.Uc(C,0)),this.Yc.insertText(S,
e,n);return this.zo.create(C,this._context)}insertTable(e,n,C,S){const ja=new fb.a;ja.add(ce.a.create(this.rh));return this.ld.insertTable(ja,e,n,C,S,this._context)}mergeCells(e,n,C,S){var ja=this.fd.mg(this.rh),ya=this.fd.mg(this.rh);const kb=this.Rh.vg(this.rh),Rb=this.Rh.Eh(this.rh);if(e>=kb||0>e||0>n||n>=Rb||0>C||C>=kb||0>S||S>=Rb||C<e||S<n)E.ULS.sendTraceTag(521483542,369,15,"Invalid Index for {0} {1} {2} {3}",e,n,C,S),pc.a.td();this.Nl.P8f(ja,e,n);this.Nl.P8f(ya,C,S);C=this.Nl.getContainingTable(ja);
ya=this.Rh.oD(C)?Uk.SelectionFactory.Oai(ja,ya):Uk.SelectionFactory.Nai(ja,ya);ya=Kf.a.Odc(ya);ya=Qv.a.DKf(ya);32!==ya.response&&(E.ULS.sendTraceTag(521483541,369,15,"get mergeCell context data fail"),pc.a.td());this.ld.mergeCells(ja.currentNode,ya);ja=this.fd.mg(this.rh);this.Nl.P8f(ja,e,n);return ja.currentNode?this.aea.create(ja.currentNode,this._context):null}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.hb.NA(this.rh,!0,!1);this.vB.find(S,e,n,C,this._context)})}_Search2(e,
n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.hb.NA(this.rh,!0,!1);this.vB.Ipb(S,e,n,C,this._context)})}select(e){this.Lq.HDa(this.rh,e)}setCellPadding(e,n){this.ld.setCellPadding(this.rh,e,n)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.rh,"Table")}getTypeName(){return"Microsoft.WordServices.Table"}invokePropertyGet(e){switch(e){case 33:return this.alignment;case 38:return this.endnotes;case 39:return this.fields;case 24:return this.font;case 37:return this.footnotes;
case 12:return this.headerRowCount;case 22:return this.horizontalAlignment;case 4:return this.isUniform;case 6:return this.nestingLevel;case 32:return this.parentBody;case 25:return this.parentContentControl;case 36:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 7:return this.parentTableCell;case 34:return this.parentTableCellOrNullObject;case 35:return this.parentTableOrNullObject;case 11:return this.rowCount;case 3:return this.rows;case 18:return this.shadingColor;
case 10:return this.style;case 17:return this.styleBandedColumns;case 16:return this.styleBandedRows;case 31:return this.styleBuiltIn;case 14:return this.styleFirstColumn;case 15:return this.styleLastColumn;case 13:return this.styleTotalRow;case 5:return this.tables;case 9:return this.values;case 23:return this.verticalAlignment;case 27:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=
this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 33:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 12:this.headerRowCount=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 22:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 18:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 10:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 17:this.styleBandedColumns=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 16:this.styleBandedRows=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 31:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 14:this.styleFirstColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 15:this.styleLastColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 13:this.styleTotalRow=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 9:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<Array<string>>");return;case 23:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 27:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1004:return this.GVk(n);case 1003:return this.BZk(n);case 1012:return this.Dbl();case 1008:return this.fIa();case 1007:return this.VC(n);case 1010:return this.sQl(n);case 1009:return this.eRl(n);case 1014:return this.sWl();case 1015:return this.W1c(n);
case 1005:return this.Ukm(n);case 1028:return this.Xkm(n);case 1023:return this.d2c(n);case 1025:return this.i7();case 1029:return this.j7();case 1027:return this.sEm();case 1031:return this.tEm();case 1026:return this.vEm();case 1030:return this.wEm();case 1019:return this.ofa(n);case 1020:return this.RKa(n);case 1022:return this.Qsa(n);case 1021:return this.t$a(n);case 1006:return this.JMn(n);case 1017:return this.gha(n);case 1024:return this.rnd(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){switch(e){case 1018:return this.Vua(n);case 1032:return this.moa(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}GVk(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");this.addColumns(n,C,e);return null}BZk(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");return this.addRows(n,C,e)}Dbl(){this.autoFitWindow();return null}fIa(){this.clear();return null}VC(){this.deleteObject();return null}sQl(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int?");this.deleteColumns(n,e);return null}eRl(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int?");this.deleteRows(n,e);return null}sWl(){this.distributeColumns();return null}W1c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getBorder(e)}Ukm(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.getCell(n,e)}Xkm(e){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.getCellOrNullObject(n,e)}d2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getCellPadding(e)}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}sEm(){return this.getParagraphAfter()}tEm(){return this.getParagraphAfterOrNullObject()}vEm(){return this.getParagraphBefore()}wEm(){return this.getParagraphBeforeOrNullObject()}ofa(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}RKa(){return this.insertContentControl()}Qsa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(n,e)}t$a(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(n,C,S,e)}JMn(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"int");return this.mergeCells(n,C,S,e)}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}rnd(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"number");this.setCellPadding(n,e);return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}psa(){return G.AFrameworkApplication.dv?this.rh:null}}Object(F.a)(oL,"Table",Hh.a,[901]);class Ty{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph){this.ld=this.nk=this.zo=null;this.aea=n;this.zC=e;this.fd=C;this.YGa=S;this.GG=ja;this.Rh=ya;this.aE=kb;this.Dz=Rb;this.eqa=sc;this.hb=Fc;this.vB=gd;this.Nl=te;this.Yc=td;this.sh=Bd;this.Hl=wd;this.Lq=Le;this.cFa=
Oe;this.ul=We;this.EGa=Xf;this.xB=Gg;this.Xx=Ph}su(e,n,C){this.ld=e;this.zo=n;this.nk=C}create(e,n,C=0){return new oL(e,n,C,this,this.aea,this.zC,this.fd,this.zo,this.nk,this.YGa,this.Hl,this.GG,this.Rh,this.ld,this.aE,this.Dz,this.eqa,this.hb,this.vB,this.Yc,this.sh,this.Nl,this.Lq,this.cFa,this.ul,this.EGa,this.xB,this.Xx)}}Object(F.a)(Ty,"TableFactory",null,[1080]);var RE=d(189),KJ=d(899),dA;(function(e){e[e.top=0]="top";e[e.left=1]="left";e[e.bottom=2]="bottom";e[e.right=3]="right"})(dA||(dA=
{}));Object(F.b)("CellPaddingLocation",dA);class Uy{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te){this.qQ=null;this.W7l=(Le,Oe)=>{const We=Le.parentNode;return 35===Le.currentNode.type||We&&14===We.type||Oe&&Le.M9a(Oe)?!1:!0};this.hb=e;this.Yc=n;this.Nl=C;this.ga=S;this.fd=ja;this.Lq=ya;this.cqa=kb;this.S5=Rb;this.Fac=sc;this.INd=Fc;this.aea=gd;this.Rh=td;this.aE=Bd;this.Vh=wd;this.sh=te}su(e){this.qQ=e}insertTable(e,n,C,S,ja,ya,kb=!1){let Rb;Rb=this.kak(ja,n,C,S);let sc=this.D6d(e,Rb);sc||
({BL:sc}=this.Yc.dN(e.K(0),e.K(e.count-1),S,!0));sc=this.sh.GOa(sc,e);let Fc;this.Yc.FW((Fc=new fb.a,Fc.add(sc),Fc),S,1);n=this.Rbn(sc,n,C,Rb,e,ya,kb);kb&&this.Lq.select(e,0);ja&&this.vQj(n,ja,!0);return n?this.Fac.create(n,ya):null}uSi(e,n){e=this.fd.mg(e);e.zb(7);e.uc();this.Vh.yy(e,n,!0,null,!1,!1);e.Vb(2);return e.currentNode}D6d(e,n){var C=n?e.K(0):e.K(e.count-1);if(C.contextId!==Ma.a.paragraph&&C.contextId!==Ma.a.table)return null;C=C.node;const S=this.fd.mg(C);S.zb(7);if(14!==C.type){let ja=
null;if(!this.Rh.Ix(S))return null;for(;this.Rh.Ix(S);){this.Nl.Tue(S);const ya=this.hb.Zm(S.currentNode),kb=this.hb.GF(S.currentNode);if(n?C.id.equals(ya.id):C.id.equals(kb.id))for(const Rb of e){const sc=n?kb.id:ya.id;if(Rb.contextId===Ma.a.paragraph&&Rb.node.id.equals(sc)){ja=S.currentNode;break}}else break}ja&&(C=ja)}return 14===C.type?this.xQf(C,n,!0):null}xQf(e,n,C){let S=this.hb.pg(e,n,!1,!1);if(!S&&C||S&&14===S.type)S=this.uSi(e,n);e=null;S&&(n?(e=ce.a.Cx(S),0<this.hb.wm(S,this.hb.textLength(S))?
e.Fb=e.Tb=this.hb.Ex(S):e.Fb=e.Tb=-1):(e=ce.a.Uc(S,0),0<this.hb.wm(S,0)?e.Fb=e.Tb=this.hb.vy(S):e.Fb=e.Tb=-1));return e}XNm(e,n){const C=new fb.a;e=this.Rh.gOf(e);for(let S=0;S<e.count;S++)C.add(this.Fac.create(e.K(S),n,S));return C}OHi(e,n,C){const S=new fb.a;e=this.iPm(e,n);for(n=0;n<e.count;n++)S.add(this.Fac.create(e.K(n),C,n));return S}JHi(e,n){const C=new fb.a;for(let S=0;S<e.count;S++)C.add(this.INd.create(e.K(S),n,S));return C}oNm(e,n){const C=new fb.a;e=this.aE.KA(e);for(let S=0;S<e.count;S++)C.add(this.aea.create(e.K(S),
n,S));return C}drb(e,n,C=null){if(!e)return null;!C||e.id.equals(C.id)?C=this.qla(e,!0):(e=this.fd.mg(e),e.zb(14),C=this.fd.mg(C),C.zb(14),C=this.Nl.mJo(e,C));return C?this.Fac.create(C,n):null}nFm(e,n){e=this.fd.mg(e);e.zb(15);return(e=e.kd(15))?this.INd.create(e,n):null}vkc(e,n,C=null){if(!e)return null;!C||e.id.equals(C.id)?C=this.qla(e,!1):(e=this.fd.mg(e),e.zb(14),C=this.fd.mg(C),C.zb(14),C=this.Nl.nJo(e,C));return C?this.aea.create(C,n):null}Ft(e){const n=this.fd.Ql();n.set(e);n.zb(14);return this.aE.Ft(n)}Skm(e){const n=
this.fd.Ql();n.set(e);n.zb(14);return this.cqa.j2c(n,!0)}HOf(e){if(this.S5.gr(e))return null;const n=this.fd.Ql();n.set(e);var C=n.je();for(e="";C;){C=n.tLa;var S=n.je();if(12===S.type)e+=this.hb.R3(S),C||(e+="\r");else if(14===S.type){C=this.vJi(S);S="";for(let ja=0;ja<C.length;ja++){const ya=C[ja].length;for(let kb=0;kb<ya;kb++)S+=C[ja][kb],S=kb===ya-1?S+"\r":S+"\t"}e+=S}n.uc();C=n.Tk()}return e}wJi(e){const n=new fb.a;for(const C of this.aE.KA(e))n.add(this.HOf(C));return[n.toArray()]}vJi(e){const n=
new fb.a;for(const C of this.Rh.wy(e,0,this.Rh.vg(e)-1))n.add(this.wJi(C)[0]);return n.toArray()}Ezg(e,n,C=!1){this.S5.gr(e)||(C||this.cof(e),C=this.fd.Ql(),C.set(e),C.Vb(1),C=C.je(),e=new fb.a,C=ce.a.XT(0,this.hb.textLength(C),!1,C),e.add(C),this.Yc.insertText(e,n,2))}Fzg(e,n,C=!1){e=this.aE.KA(e);(!n||!n.length||e.count<n[0].length)&&pc.a.td();let S=0;for(const ja of e)S<n[0].length?this.Ezg(ja,n[0][S++],C):C||this.cof(ja)}vQj(e,n,C=!1){const S=this.Rh.vg(e);S<n.length&&pc.a.td();let ja=0;for(const ya of this.Rh.wy(e,
0,S-1))ja<n.length?this.Fzg(ya,[n[ja++]],C):C||this.eof(ya)}cof(e){if(!this.S5.gr(e)){e=this.hb.NA(e,!0,!1);this.Yc.ROa(e.K(0));this.Yc.ROa(e.K(e.count-1));this.Yc.FW(e,4,2);var n=e.K(e.count-1);e.W(e.count-1,ce.a.XT(0,this.hb.textLength(n.node),!1,n.node));e.K(e.count-1).Tb=n.qo();1===e.count&&(e.K(e.count-1).Fb=n.oo());this.Yc.LZd(e)}}eof(e){for(const n of this.aE.KA(e))this.cof(n)}R2h(e){const n=this.Rh.vg(e);for(const C of this.Rh.wy(e,0,n-1))this.eof(C)}Avf(e){var n=this.Q2(e);if(1===this.Rh.vg(n))this.RW(n);
else{var C=RE.TableNodeContext.create(e);e=this.Lq.w3c(C);32!==this.ga.Hf(C,pe.a.deleteRow,2,!0,null,null)&&(n=this.Rh.oD(n),E.ULS.sendTraceTag(20304155,369,10,"Commands.DeleteRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",n,!0),pc.a.hg());this.Lq.ctd(e)}}mergeCells(e,n){const C=this.Q2(e),S=RE.TableNodeContext.create(e);e=this.Lq.w3c(S);32!==this.ga.Hf(S,pe.a.mergeCells,2,!0,null,n)&&(n=this.Rh.oD(C),E.ULS.sendTraceTag(523319324,369,10,"Commands.mergeCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",
n,!0),pc.a.hg());this.Lq.ctd(e)}aOa(e,n){const C=this.Q2(e),S=RE.TableNodeContext.create(e);e=this.Lq.w3c(S);32!==this.ga.Hf(S,pe.a.aOa,2,!0,null,n)&&(n=this.Rh.oD(C),E.ULS.sendTraceTag(523319326,369,10,"Commands.splitCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",n,!0),pc.a.hg());this.Lq.ctd(e)}rei(e){var n=this.Q2(e);1===this.Rh.Eh(n)?this.RW(n):(e=RE.TableNodeContext.create(e),n=this.Lq.w3c(e),32!==this.ga.Hf(e,pe.a.deleteColumn,2,!0,null,null)&&(E.ULS.sendTraceTag(20304157,
369,10,"Commands.DeleteColumn Error."),pc.a.hg()),this.Lq.ctd(n))}RW(e){e=ce.a.create(e);const n=this.Lq.w3c(e);32!==this.ga.Hf(e,pe.a.RW,2,!0,null,null)&&(E.ULS.sendTraceTag(20304159,369,10,"Commands.DeleteTable Error."),pc.a.hg());this.Lq.ctd(n)}iPm(e,n){const C=new fb.a;var S=e.node,ja=n.node;if(S.id.equals(ja.id)){if(this.Pnc(e))return C;n=Ed.a.eb(S);n.zb(14)&&(S=this.Nl.fug(n),ja=this.Nl.i5d(n),this.n6i(e,e,ja,S)&&(e=this.Nl.getContainingTable(n),C.add(e)));return C}let ya,kb;const Rb=({jbd:ya,
Cug:kb}=this.s4d(S,ja)).returnValue,sc=ya[Rb];switch(sc.type){case 14:return C.add(sc),C;case 15:return C.add(ya[Rb-1]),C;case 16:if(this.n6i(e,n,sc,ya[Rb-1]))return C.add(ya[Rb-2]),C}this.ANm(S,ja,ya,kb,Rb,C);return C}tvi(e){let n=null;e=Ed.a.eb(e);e.zb(14)&&(n=nh.getContainingTable(e));return n}s4d(e,n){e=this.mqb(e);n=this.mqb(n);for(let C=0;C<e.length&&C<n.length;++C)if(e[C]!==n[C])return{returnValue:C-1,jbd:e,Cug:n};return{returnValue:0,jbd:e,Cug:n}}n6i(e,n,C,S){const ja=e.node,ya=n.node,kb=
this.hb.Zm(C);C=this.hb.GF(C);return 1!==this.aE.KA(S).count||this.Pnc(e)||this.Pnc(n)||kb!==ja||C!==ya?!1:!0}ANm(e,n,C,S,ja,ya){const kb=this.DHi(C,ja+1);S=this.DHi(S,ja+1);kb&&ya.add(kb);e=Ed.a.eb(e);e.zb(7);C=Tm.a.At(e,C[ja]);for(C.zp(this.W7l,kb);C.moveNext()&&!(14===C.currentNode.type&&ya.add(C.currentNode),S&&C.currentNode===S||C.currentNode.id.equals(n.id)););}DHi(e,n){for(;n<e.length;++n)if(14===e[n].type)return e[n];return null}Pnc(e){return-1===e.cpBegin&&-1===e.cpEnd&&e.contextId===Ma.a.paragraph?
!1:e.contextId===Ma.a.Cd||e.contextId===Ma.a.Zc||e.contextId===Ma.a.Vc}mqb(e){const n=[],C=new Ed.a;C.set(e);for(C.zb(7);C.uc();)n.push(C.currentNode);n.reverse();return n}Rbn(e,n,C,S,ja,ya,kb=!0){const Rb=S?ja.K(0):ja.K(ja.count-1);let sc=0,Fc=!1;if(kb){const gd=Rb.node;sc=this.hb.textLength(gd);gd.id.equals(e.node.id)&&(Fc=!0)}E.ULS.sendTraceTag(21263694,369,50,"AppId:{0}, Insert table with row number: {1}, column number : {2}",ya.appId,n,C);n=Object.assign(new KJ.a,{rows:n,columns:C,Ioc:!0});32!==
this.ga.Hf(e,pe.a.insertTable,2,!1,new wt.a,n)&&(E.ULS.sendTraceTag(19951683,369,10,"Commands.InsertTable failed"),pc.a.hg());e=n.Bp;this.xQf(e,S,!1);this.xQf(e,!S,!1);n=this.hb.pg(e,!1,!1,!1);if(!kb)return e;switch(Rb.contextId){case Ma.a.paragraph:S&&(Fc&&1<ja.count&&!sc?ja.removeAt(0):Fc&&(ja.W(0,ce.a.create(n)),this.Yc.ROa(ja.K(0))));break;case Ma.a.Zc:S&&(1<ja.count?ja.removeAt(0):(ja.W(0,ce.a.Uc(n,0)),this.Yc.ROa(ja.K(0))));break;default:S?(ja.W(0,Rb.contextId===Ma.a.Vc?ce.a.Uc(n,0):ce.a.createTextRange(n,
0,Rb.cpEnd-Rb.cpBegin)),1<ja.count&&ja.K(1).contextId===Ma.a.Zc&&(ja.W(1,ce.a.Wl(n)),ja.K(1).Fb=ja.K(1).Tb=Rb.qo()),this.Yc.ROa(ja.K(0),Rb)):1!==ja.count||ja.K(0).contextId!==Ma.a.Vc||ja.K(0).cpBegin||(ja.W(0,ce.a.Uc(this.hb.Zm(e),0)),this.Yc.ROa(ja.K(0)))}return e}CHi(e){let n=this.Rh.kP(e)?1:0;e=this.fd.mg(e);for(e.zb(7);e.kd(14);)n++;return n}SMf(e){return e.hasProperty(Ee.a.QG)?(e=Yk.a.JB(e.getValue(Ee.a.QG)),null!=e?e.toUpperCase():e):""}azg(e,n){this.ga.Hf(ce.a.create(e),pe.a.w8,2,!0,new wt.a,
n)}IOf(e){switch(e.ka(hb.a.lOa,"top")){case "top":return 0;case "center":return 1;case "bottom":return 2;default:return-1}}Gzg(e,n){switch(n){case 0:n=pe.a.x1f;break;case 1:n=pe.a.v1f;break;case 2:n=pe.a.r1f;break;default:E.ULS.sendTraceTag(20492683,369,15,"The argument for VerticalAlignment must be Top/Center/Bottom.");pc.a.td();return}this.ga.Hf(ce.a.create(e),n,2,!0,new wt.a,{})}rJf(e){e=this.hb.Kv(e,!0,!1);const n=this.hb.Xy(e.K(0));for(let C=1;C<e.count;C++)if(!n||n!==this.hb.Xy(e.K(C)))return-2;
return this.z4i(n)}gyg(e,n){switch(n){case 0:n=pe.a.u1f;break;case 1:n=pe.a.s1f;break;case 2:n=pe.a.w1f;break;case 3:n=pe.a.t1f;break;default:E.ULS.sendTraceTag(20492684,369,15,"The argument for HorizontalAlignment must be Left/Centered/Right/Justified.");pc.a.td();return}this.ga.Hf(ce.a.create(e),n,2,!0,new wt.a,{})}Ygm(e){e=this.Rh.Xy(e);return this.z4i(e)}cSo(e,n){switch(n){case 0:n=pe.a.O7;break;case 1:n=pe.a.X$;break;case 2:n=pe.a.t8;break;default:E.ULS.sendTraceTag(20807900,369,15,"The argument for Alignment must be Left/Centered/Right.");
pc.a.td();return}this.ga.Hf(ce.a.create(e),n,2,!0,new wt.a,{})}R6d(e){const n=this.Q2(e).ka(hb.a.qS,.15);return oi.a.wbb(e.ka(hb.a.qS,n))}n8d(e){const n=this.Q2(e).ka(hb.a.oV,.15);return oi.a.wbb(e.ka(hb.a.oV,n))}hOf(e){const n=this.Q2(e).ka(hb.a.kOa,0);return oi.a.wbb(e.ka(hb.a.kOa,n))}rGf(e){const n=this.Q2(e).ka(hb.a.iOa,0);return oi.a.wbb(e.ka(hb.a.iOa,n))}setCellPadding(e,n,C){if(0>C||1584<C)E.ULS.sendTraceTag(20772256,369,15,"The cell padding value should be between 0 and 1584 in points."),
pc.a.td();C=oi.a.rua(C);switch(e.type){case 14:this.USo(e,Uy.RLe[dA[n]],C);break;case 15:this.MMj(e,Uy.RLe[dA[n]],C);break;case 16:this.LMj(e,Uy.RLe[dA[n]],C);break;default:E.ULS.sendTraceTag(20772257,369,10,"The graph node should be is table, table row or table cell."),pc.a.td()}}USo(e,n,C){e=this.Rh.wy(e,0,this.Rh.vg(e)-1);for(const S of e)this.MMj(S,n,C)}MMj(e,n,C){e=this.aE.KA(e);for(const S of e)this.LMj(S,n,C)}LMj(e,n,C){const S=this.y4c(e);n===hb.a.qS?C=Math.min(S-oi.a.rua(this.n8d(e)),C):
n===hb.a.oV&&(C=Math.min(S-oi.a.rua(this.R6d(e)),C));e.setValue(n,C)}XQb(e,n,C){e=this.aE.KA(e);const S=n(e.K(0));for(let ja=1;ja<e.count;ja++)if(S==C||S!=n(e.K(ja)))return C;return S}WQb(e,n,C){e=this.Rh.wy(e,0,this.Rh.vg(e)-1);let S="number"===typeof C?0:"boolean"===typeof C?!1:null;for(let ja=0;ja<e.count;ja++){const ya=this.aE.KA(e.K(ja));for(let kb=0;kb<ya.count;kb++){const Rb=n(ya.K(kb));ja+kb||(S=Rb);if(S==C||S!=Rb)return C}}return S}Q2(e){return this.qla(e,!0)}qla(e,n){if(!e)return null;e=
this.fd.mg(e);return e.zb(14)?n?this.Nl.getContainingTable(e):this.Nl.i5d(e):null}CLf(e,n,C){return(e=this.ADi(e,n))?this.qQ.create(e,C):null}BLf(e,n){return(e=this.G7d(e))?this.qQ.create(e,n):null}ADi(e,n){if(!e||!n)return null;if(e.id.equals(n.id))return this.G7d(e);n=({jbd:e}=this.s4d(e,n)).returnValue;e=e[n];switch(e.type){case 16:case 36:case 8:case 10:case 37:return e;default:return this.G7d(e)}}G7d(e){let n=null;e=Ed.a.eb(e);e.zb(16)?n=e.Dp(16):e.zb(36)?n=e.Dp(36):e.zb(10)?n=e.Dp(10):e.zb(8)?
(e.kd(8),1!==e.ar()&&(n=e.currentNode)):pc.a.ubi()&&e.zb(38)&&(n=e.Dp(38));return n}gHf(e){e.zb(14);var n=this.Nl.i5d(e);this.fd.mg(n).zb(14);const C=this.Nl.getContainingTable(e);e=this.y4c(n);const S=n.ka(hb.a.qS,C.ka(hb.a.qS,.15));n=n.ka(hb.a.oV,C.ka(hb.a.oV,.15));n=e-S-n;0>=n&&(E.ULS.sendTraceTag(20730644,369,15,"Cell content width is not valid"),pc.a.hg());return n}z4c(e){e=this.cqa.$4d(e);let n=0;if(this.FMi(e))var C=0;else{for(C of e)n+=C;C=n}return{returnValue:e,Krd:C}}y4c(e){var n=this.fd.mg(e);
n.zb(14);n=this.cqa.j2c(n);var C=this.Q2(e);C=this.cqa.$4d(C);e=e.ka(hb.a.colSpan,1);let S=0;for(;e;e--,n++)if(-1===C[n]){S=0;break}else S+=C[n];return S}z4i(e){switch(e){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 9:case 11:case 10:case 7:case 13:return 3;default:return-1}}insertColumns(e,n,C,S,ja){var ya=!1;switch(C){case 0:ya=!0;break;case 1:ya=!1;break;default:E.ULS.sendTraceTag(20758724,369,15,"The type of insert location is undefined: {0}.",bt.a[C]),pc.a.td()}C=this.Nl.getContainingTable(n);
var kb=this.Rh.vg(C);const Rb=this.Rh.Eh(C);if(0>=e||e>63-Rb)E.ULS.sendTraceTag(20758725,369,15,"The insert column count plus original column count exceeds the maxium column size"),pc.a.td();if(S)for(S.length>kb&&(E.ULS.sendTraceTag(20758726,369,15,"The values size is larger than table row size"),pc.a.td()),kb=0;kb<S.length;kb++)S[kb].length>e&&(E.ULS.sendTraceTag(20758727,369,15,"The values size is larger than table size"),pc.a.td());this.$$m(e,n,ya,ja);e=this.cqa.j2c(n);if(S)for(n=0;n<S.length;n++)for(ja=
e;ja<e+S[n].length;ja++)ya=this.fd.mg(C),ya=this.Nl.Zej(ya,n,ja),this.Ezg(ya,S[n][ja-e])}$$m(e,n,C,S){const ja=C?pe.a.Bmc:pe.a.nSb,ya=ce.a.create(n.currentNode);for(let kb=0;kb<e;kb++)32!==this.ga.Hf(ya,ja,2,!1,new wt.a,null)&&pc.a.hg(),1<e&&(S.Cn.CF(),S.Cn.Dv(n.currentNode));if(C)for(C=0;C<e;C++)n.cP();else n.Tk()}FMi(e){for(const n of e)if(-1===n)return!0;return!1}insertRows(e,n,C,S){const ja=n.Dp(14);C=this.kak(S,e+this.Rh.vg(ja),this.aE.KA(n.currentNode).count,C);e=this.Fbn(e,n,C);if(S)for(n=
0;n<S.length;n++)this.Fzg(e.K(n),[S[n]]);return e}Fbn(e,n,C){const S=C?pe.a.Asb:pe.a.s$a,ja=new fb.a;for(let kb=0;kb<e;kb++){var ya=ce.a.create(n.currentNode);ya=this.ga.Hf(ya,S,2,!1,new wt.a,null);32!==ya&&(ya=this.Rh.oD(this.Nl.getContainingTable(n)),E.ULS.sendTraceTag(20756129,369,10,"Commands.InsertRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",ya,!0),pc.a.hg());C?(n.cP(),ja.insert(0,n.currentNode)):(n.Tk(),ja.add(n.currentNode))}return ja}kak(e,n,C,S){if(32767<
n||0>=n||0>=C||63<C)E.ULS.sendTraceTag(20756130,369,15,"Invalid Size for {0}","inserted row"),pc.a.td();if(e)if(e.length>n)E.ULS.sendTraceTag(20756131,369,15,"The values size is larger than {0}'s size","inserted row"),pc.a.td();else for(n=0;n<e.length;n++)e[n].length>C&&(E.ULS.sendTraceTag(20756160,369,15,"The values size is larger than {0}'s sizeinserted row"),pc.a.td());e=!1;switch(S){case 0:e=!0;break;case 1:e=!1;break;default:E.ULS.sendTraceTag(20756161,369,15,"The type of insert location is undefined: {0}.",
bt.a[S]),pc.a.td()}return e}}Uy.RLe=ub.a.V8("left",hb.a.qS,"right",hb.a.oV,"top",hb.a.kOa,"bottom",hb.a.iOa);Object(F.a)(Uy,"TableOperations",null,[1082]);class ZC extends Hh.a{constructor(e,n,C){super();this.wQc=null;this.fw=e;this._context=n;this.ld=C}length(){return this.wQc.count}get _ReferenceId(){return this.Hp?this.Vp:null}getFirst(){const e=this.getFirstOrNullObject();e||pc.a.Wk();return e}getFirstOrNullObject(){this.p6j();return this.wQc&&this.length()?this.wQc.K(0):null}_GetItem(e){e=pc.a.QN(e);
if(e<this.length())return this.wQc.K(e);E.ULS.sendTraceTag(19969491,369,10,"The index is out of the table cell collection range.");pc.a.td();return null}_KeepReference(){this.xp()}_OnAccess(){}getAsyncEnumerator(e,n){this.p6j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ar(e,n,this))}getTypeName(){return"Microsoft.WordServices.TableCellCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.dD();case 1004:return this.eD();case 1:return this.WN(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dD(){return this.getFirst()}eD(){return this.getFirstOrNullObject()}WN(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}p6j(){this.wQc=this.ld.oNm(this.fw,this._context)}}Object(F.a)(ZC,"TableCellCollection",Hh.a,[901,931]);class Ct extends Hh.a{constructor(e,n,
C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We){super();pc.a.bPa(e,"TableRow");this.fw=e;this._context=n;this._id=C;this.zC=ja;this.INd=S;this.fd=ya;this.YGa=kb;this.hb=Rb;this.Nl=gd;this.ld=Fc;this.Yc=sc;this.aE=td;this.vB=Bd;this.Lq=wd;this.cFa=te;this.Rh=Le;this.Xx=Oe;this.aea=We}get cellCount(){return this.aE.KA(this.fw).count}get cells(){return new ZC(this.fw,this._context,this.ld)}get endnotes(){var e=this.Yc.Hjc(this.fw,1);e=this.Yc.sza(e,this._context);return new Qu(e)}get font(){return this.zC.create(6,
this.fw,null,null,this._context)}get fields(){return new Wt(this.Xx.Gxi(this.fw,this._context,!1))}get footnotes(){var e=this.Yc.Hjc(this.fw,0);e=this.Yc.sza(e,this._context);return new Qu(e)}get horizontalAlignment(){return this.ld.XQb(this.fw,Object(ic.a)(this.ld,this.ld.rJf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(e){this.ld.gyg(this.fw,e)}get isHeader(){return this.aE.o9c(this.fw)}get parentTable(){return this.ld.drb(this.fw,this._context)}get preferredHeight(){return this.aE.Fkc(this.fw)}set preferredHeight(e){pc.a.C0a(e,
"TableRow.PreferredHeight");this.cFa.N_b(this.fw,oi.a.rua(e))}get rowIndex(){return this.ld.Ft(this.fw)}get shadingColor(){return this.ld.XQb(this.fw,Object(ic.a)(this.ld,this.ld.SMf,"getShadingColorOfTableCellNode"),"")}set shadingColor(e){e=pc.a.$Oa(e,"TableRow.ShadingColor",this._context);this.ld.azg(this.fw,e)}get values(){return this.ld.wJi(this.fw)}set values(e){this.ld.Fzg(this.fw,e)}get verticalAlignment(){return this.ld.XQb(this.fw,Object(ic.a)(this.ld,this.ld.IOf,"getVerticalAlignmentOfTableCellNode"),
-1)}set verticalAlignment(e){this.ld.Gzg(this.fw,e)}get _Id(){return this._id}get _ReferenceId(){return this.Hp?this.Vp:null}clear(){this.ld.eof(this.fw)}deleteObject(){this.ld.Avf(this.fw)}getBorder(e){return this.YGa.create(this.fw,e,this._context)}getCellPadding(e){switch(e){case 1:e=this.ld.XQb(this.fw,Object(ic.a)(this.ld,this.ld.R6d,"getLeftMarginOfTableCellNode"),-1);break;case 3:e=this.ld.XQb(this.fw,Object(ic.a)(this.ld,this.ld.n8d,"getRighttMarginOfTableCellNode"),-1);break;case 0:e=this.ld.XQb(this.fw,
Object(ic.a)(this.ld,this.ld.hOf,"getTopMarginOfTableCellNode"),-1);break;case 2:e=this.ld.XQb(this.fw,Object(ic.a)(this.ld,this.ld.rGf,"getBottomMarginOfTableCellNode"),-1);break;default:return pc.a.td(),null}return-1===e?null:e}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){var e=this.fd.mg(this.fw);e.zb(14);return(e=this.Nl.Y8f(e))?this.INd.create(e,this._context):null}insertContentControl(){return null}insertRows(e,n,C){pc.a.D0a(n,"TableRow.InsertRows()");
const S=this.fd.mg(this.fw);S.zb(14);e=this.ld.insertRows(n,S,e,C,this._context);this.Nl.Tue(S);return new Pv(S.currentNode,e,1,this._context,this.ld,this.Rh)}merge(){const e=this.fd.mg(this.fw);this.Nl.Uje(e);var n=Uk.SelectionFactory.Tai(this.fw);n=Kf.a.Odc(n);n=Qv.a.DKf(n);32!==n.response&&(E.ULS.sendTraceTag(521483539,369,15,"get mergeCell context data fail"),pc.a.td());this.ld.mergeCells(e.currentNode,n);return this.fw?this.aea.create(this.fw,this._context):null}search(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>
{const S=this.hb.NA(this.fw,!0,!1);this.vB.find(S,e,n,C,this._context)})}_Search2(e,n){return OfficeExtension.WacRuntime.Utility.createPromise(C=>{const S=this.hb.NA(this.fw,!0,!1);this.vB.Ipb(S,e,n,C,this._context)})}select(e){this.Lq.KOo(this.fw,e)}setCellPadding(e,n){this.ld.setCellPadding(this.fw,e,n)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.fw,"TableRow")}getTypeName(){return"Microsoft.WordServices.TableRow"}invokePropertyGet(e){switch(e){case 4:return this.cellCount;case 3:return this.cells;
case 20:return this.endnotes;case 21:return this.fields;case 14:return this.font;case 19:return this.footnotes;case 12:return this.horizontalAlignment;case 16:return this.isHeader;case 5:return this.parentTable;case 17:return this.preferredHeight;case 6:return this.rowIndex;case 8:return this.shadingColor;case 7:return this.values;case 13:return this.verticalAlignment;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=
this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,n){switch(e){case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 17:this.preferredHeight=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 8:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"Array<Array<string>>");return;case 13:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1006:return this.fIa();case 1005:return this.VC(n);case 1009:return this.W1c(n);case 1023:return this.d2c(n);case 1012:return this.i7();
case 1013:return this.j7();case 1025:return this.RKa(n);case 1003:return this.$Uf(n);case 1004:return this.bNn();case 1007:return this.gha(n);case 1024:return this.rnd(n);case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){switch(e){case 1008:return this.Vua(n);case 1026:return this.moa(n)}e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}fIa(){this.clear();
return null}VC(){this.deleteObject();return null}W1c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getBorder(e)}d2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getCellPadding(e)}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}RKa(){return this.insertContentControl()}$Uf(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),C=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");return this.insertRows(n,C,e)}bNn(){return this.merge()}Vua(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,zk.a);return this.search(n,e)}moa(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(n,
e)}gha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}rnd(e){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");this.setCellPadding(n,e);return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(Ct,"TableRow",Hh.a,[901]);class LJ{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd){this.ld=null;this.zC=e;this.fd=
n;this.YGa=C;this.hb=S;this.Yc=ja;this.Nl=ya;this.aE=kb;this.vB=Rb;this.Lq=sc;this.cFa=Fc;this.Rh=gd;this.Xx=td;this.aea=Bd}su(e){this.ld=e}create(e,n,C=0){return new Ct(e,n,C,this,this.zC,this.fd,this.YGa,this.hb,this.Yc,this.ld,this.Nl,this.aE,this.vB,this.Lq,this.cFa,this.Rh,this.Xx,this.aea)}}Object(F.a)(LJ,"TableRowFactory",null,[1080]);var nH=d(1122),SE=d(112);class rv{constructor(e,n,C,S,ja,ya){this.sh=e;this.hb=n;this.Zd=C;this.KC=S;this.DOd=ja;this.VQk=ya}hlm(){return this.Zd.xY?1:this.Zd.AOa?
2:0}ZSo(e,n){const C=nH.a.menuItemId,S={};switch(n){case 0:S[C]=SE.a.pCc;break;case 1:S[C]=SE.a.oCc;break;case 2:S[C]=SE.a.p3b}32!==e.Qb(ha.a.Zha,2,S)&&(E.ULS.sendTraceTag(545043662,369,10,"BuildspkgCommands.updateTrackChangeStatus Error."),pc.a.hg())}mMf(e,n,C,S){if(12!=e.type)return"";if(!this.KC.TWd(e,C,S))return this.e4c(e,C,S);const ja=this.KC.LAa(e,C,S);let ya="";for(const kb of ja)2==kb.Jd.changeType?1==n&&(C<kb.yd&&(ya+=this.e4c(e,C,kb.yd)),C=kb.endCp):1==kb.Jd.changeType&&0==n&&(C<kb.yd&&
(ya+=this.e4c(e,C,kb.yd)),C=kb.endCp);C<S&&(ya+=this.e4c(e,C,S));return ya}l8d(e,n){let C=this.mMf(e,n,0,this.hb.textLength(e));e.ra.last.Yh&&1==n||e.ra.last.Wi&&0==n||(C+=pc.a.kqc);return C}NIm(e,n){let C="";const S=e.start,ja=e.end;return S&&ja?C=e.zg?this.Bhm(S,ja,n):C+this.mMf(S.node,n,S.cpBegin,ja.cpEnd):C}QIi(e,n){const C=new fb.a;for(let ja=0;ja<e.count;ja++){const ya=e.K(ja);var S=this.KC.LAa(ya.node,ya.cpBegin,ya.cpEnd);for(const kb of S)S=this.DOd.create(ya,n,kb,0),C.add(S)}return C}PIi(e,
n){const C=new fb.a;for(let ja=0;ja<e.count;ja++){const ya=e.K(ja);var S=ya.node;S=this.KC.LAa(S,0,this.hb.textLength(S));for(const kb of S)S=this.DOd.create(ya,n,kb,0),C.add(S)}return C}yPm(e){return 2==e.Jd.changeType?2:1==e.Jd.changeType?1:3==e.Jd.changeType?3:0}getNextOrNullObject(e,n,C){const S=this.KC.vR(e.node);for(const ja of S)if(!(ja.yd<n.yd)){if(ja.yd===n.yd){if(ja.Jd.changeType===n.Jd.changeType)continue;if(!this.KC.J9c(n.Jd.changeType,ja.Jd.changeType))continue}return this.DOd.create(ce.a.createTextRange(e.node,
ja.yd,ja.endCp),C,ja,0)}for(e=this.hb.pg(e.node,!1,!0);e;){if(this.KC.TWd(e,0,this.hb.textLength(e)))return n=this.KC.LAa(e,0,this.hb.textLength(e)),this.DOd.create(ce.a.createTextRange(e,0,this.hb.textLength(e)),C,n.K(0),0);e=this.hb.pg(e,!1,!0)}return null}wLh(e,n,C){this.VQk.Hbc(e.node,n,C)}Bhm(e,n,C){let S="";e=this.sh.dX(e,n);for(const ja of e)S+=this.l8d(ja,C);return S}e4c(e,n,C){n={yd:n,endCp:C};return""+this.hb.AXb(e,void 0,n).substring(n.yd,n.endCp)}}Object(F.a)(rv,"TrackChangesOperations",
null,[1079]);class TE extends Hh.a{constructor(e,n,C,S,ja,ya){super();this.wx=this.eea=this.fea=null;pc.a.Tx(e.node,"trackChange GraphNodeContext");this.eea=e;this.fea=C;this.wx=ja;this.nk=ya;this.lW=n}get author(){return this.fea.Jd.authorName}get date(){return this.fea.fk}get text(){return this.wx.e4c(this.eea.node,-1==this.eea.cpBegin?this.fea.yd:Math.max(this.fea.yd,this.eea.cpBegin),-1==this.eea.cpEnd?this.fea.endCp:Math.min(this.fea.endCp,this.eea.cpEnd))}get type(){return this.wx.yPm(this.fea)}get _ReferenceId(){return this.Hp?
this.Vp:null}accept(){this.wx.wLh(this.eea,this.fea,!0)}getNext(){const e=this.getNextOrNullObject();e||pc.a.Wk();return e}getNextOrNullObject(){return this.wx.getNextOrNullObject(this.eea,this.fea,this.lW)}getRange(){let e=new fb.a,n=ce.a.createTextRange(this.eea.node,-1==this.eea.cpBegin?this.fea.yd:Math.max(this.fea.yd,this.eea.cpBegin),-1==this.eea.cpEnd?this.fea.endCp:Math.min(this.fea.endCp,this.eea.cpEnd));e.add(n);return this.nk.create(e,this.lW)}reject(){this.wx.wLh(this.eea,this.fea,!1)}_KeepReference(){this.xp()}_OnAccess(){pc.a.Q0(this.eea.node,
"TrackedChange")}getTypeName(){return"Microsoft.WordServices.TrackedChange"}invokePropertyGet(e){switch(e){case 2:return this.author;case 3:return this.date;case 4:return this.text;case 5:return this.type;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,n){this.invokePropertySet(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,n){switch(e){case 1003:return this.Gcf();case 1006:return this.i7();case 1007:return this.j7();case 1005:return this.ofa(n);case 1004:return this.rqg();case 1002:return this.jh();case 1001:return this.kh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,n){e=this.invokeMethod(e,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Gcf(){this.accept();
return null}i7(){return this.getNext()}j7(){return this.getNextOrNullObject()}ofa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}rqg(){this.reject();return null}jh(){this._KeepReference();return null}kh(){this._OnAccess();return null}}Object(F.a)(TE,"TrackedChange",Hh.a,[901]);class oH{constructor(){}su(e,n){this.wx=e;this.nk=n}create(e,n,C,S=0){return new TE(e,n,C,S,this.wx,this.nk)}}Object(F.a)(oH,"TrackedChangeFactory",null,[]);class CB{constructor(){this.Z=
null}get name(){return"WordEditor.Extension"}init(){if(Rd.a.hud){this.Z.resolve("WordEditor.Extension.RichApiEventManager");var e=this.Z.resolve("WordEditor.Extension.ContentControlFactory"),n=this.Z.resolve("WordEditor.Extension.ContentControlOperations"),C=this.Z.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),S=this.Z.resolve("WordEditor.Extension.InlinePictureFactory"),ja=this.Z.resolve("WordEditor.Extension.ParagraphFactory"),ya=this.Z.resolve("WordEditor.Extension.RangeFactory"),
kb=this.Z.resolve("WordEditor.Extension.SelectionApiHelper"),Rb=this.Z.resolve("WordEditor.Extension.TableFactory"),sc=this.Z.resolve("WordEditor.Extension.TableRowFactory"),Fc=this.Z.resolve("WordEditor.Extension.TableCellFactory"),gd=this.Z.resolve("WordEditor.Extension.FileApiOperations"),td=this.Z.resolve("WordEditor.Extension.InsertApiOperations"),Bd=this.Z.resolve("WordEditor.Extension.TableOperations"),wd=this.Z.resolve("WordEditor.Extension.TrackChangesOperations"),te=this.Z.resolve("WordEditor.Extension.ListOperations"),
Le=this.Z.resolve("WordEditor.Extension.ListFactory"),Oe=this.Z.resolve("WordEditor.Extension.ListItemFactory"),We=this.Z.resolve("WordEditor.Extension.FieldFactory"),Xf=this.Z.resolve("WordEditor.Extension.NoteItemFactory"),Gg=this.Z.resolve("WordEditor.Extension.BodyFactory"),Ph=this.Z.resolve("WordEditor.Extension.SectionFactory"),Aj=this.Z.resolve("WordEditor.Extension.StyleApiHelper"),Ih=this.Z.resolve("WordEditor.Extension.CommentOperations"),Nm=this.Z.resolve("WordEditor.Extension.CommentFactory"),
Sk=this.Z.resolve("WordEditor.Extension.CommentReplyFactory"),hk=this.Z.resolve("WordEditor.Extension.CommentContentRangeFactory"),al=this.Z.resolve("WordEditor.Extension.FieldOperations"),Cj=this.Z.resolve("WordEditor.Extension.TrackedChangeFactory");e.su(ja,ya,S,n,Bd,wd,al);S.su(ja,ya);kb.su(Bd);C.su(ya);We.su(ya,al,Bd,n,td,kb);ja.su(ya);gd.su(ya,n,Ph);td.su(n,Bd);Rb.su(Bd,ja,ya);Le.su(te,ja);sc.su(Bd);Fc.su(Bd,Gg);Oe.su(ja);Xf.su(Gg,ya,td);Bd.su(Gg);Gg.su(Ph);Aj.su(Bd);Nm.su(ya,Ih);Sk.su(Nm,Ih,
hk);hk.su(Ih);Cj.su(wd,ya)}}dispose(){}wc(e){this.Z=e;e.ia("WordEditor.Extension.ExtensionFindManagerFactory",()=>new EJ(new ow.a,new zE.a,lL.a.instance,new id.a(()=>G.AFrameworkApplication.pc))).ha();e.ia("WordEditor.Extension.ExtensionFindStatusManagerFactory",()=>new YG).ha();e.ia("WordEditor.Extension.ParagraphLocalIdMapping",()=>new su).ha();e.ia("WordEditor.Extension.SearchExecutor",()=>new Sy(tJ.a.createQuery,e.resolve("WordEditor.Extension.ExtensionFindManagerFactory"),e.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),
new ow.a)).ha().as("WordEditor.Extension.ISearchExecutor");e.ia("WordEditor.Extension.ContentControlOperations",()=>new DE(e.resolve("WordEditor.ContentControl.IContentControlManager"),e.Oa("Box4.IContentControlDataChangedManager"),e.resolve("WordEditor.Extension.ContentControlFactory"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.IContentControlCharacterPropertiesEditor"),e.resolve("Box4.ContentControl.IContentControlOperator"),()=>e.Oa("Box4.IContentControlConverter"),
e.resolve("Box4.IContentControlChpHelper"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.IOutlineElementNavigator"),e.resolve("WordEditor.Extension.ISelectionApiHelper"))).ha().as("WordEditor.Extension.IContentControlOperations");e.ia("WordEditor.Extension.ListOperations",()=>new OE(e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ListFactory"),e.resolve("Box4.List.IListReader"),e.resolve("Box4.List.IListEditor"),e.resolve("Box4.IListMarkerUtility"),e.resolve("Box4.List.ListItemEditor"))).ha().as("WordEditor.Extension.IListOperations");
e.ia("WordEditor.Extension.RangeOperations",()=>new iH(e.resolve("Box4.IParagraphReader"),G.AFrameworkApplication.va,e.resolve("Box4.HyperlinkEditor"))).ha().as("WordEditor.Extension.IRangeOperations");e.ia("WordEditor.Extension.ExtensionImageStewardFactory",()=>new JE(e.resolve("WordEditor.IImageEditor"),G.AFrameworkApplication.pc,e.resolve("Box4.IUndoManager"),e.Oa("Box4.IFeatureHelper"))).ha();e.ia("WordEditor.Extension.ImageApiOperations",()=>new Ov(e.resolve("Box4.BlobReaderProxy"),e.resolve("Box4.Images.ImageReaderProxy"),
e.resolve("Box4.IParagraphReader"),new id.a(()=>ib.StaticActiveAppFrame.za().kb.hd),Object(sd.a)(),e.resolve("WordEditor.Extension.ExtensionImageStewardFactory"),G.AFrameworkApplication.Fe,G.AFrameworkApplication.J,G.AFrameworkApplication.ua.eWa)).as("WordEditor.Extension.IImageApiOperations").ha();e.ia("WordEditor.Extension.SelectionApiHelper",()=>new JJ(Kf.a.instance,uJ.a.instance,e.resolve("Box4.ISelectionFactory"),e.resolve("Box4.IParagraphReader"),G.AFrameworkApplication.va)).ha().as("WordEditor.Extension.ISelectionApiHelper");
e.ia("WordEditor.Extension.StyleApiHelper",()=>new qv(e.resolve("Box4.Styles.IWACStyleReader"),G.AFrameworkApplication.va,e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),e.resolve("WordEditor.IWACTableStyleReader"),sw.a.instance)).ha().as("WordEditor.Extension.IStyleApiHelper");e.ia("WordEditor.Extension.InsertApiOperations",()=>new dH.a(G.AFrameworkApplication.va,e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("Box4.IParagraphReader"),
e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),e.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),Uc.a.instance,e.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,e.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,wJ.a.instance,BM.a.instance,e.resolve("Box4.BlobReaderProxy"),e.resolve("WordEditor.Extension.NoteItemFactory"),Kf.a.instance,e.resolve("Box4.IFieldEditor"),e.resolve("Box4.FieldCopyPasteHelper"))).ha().as("WordEditor.Extension.IInsertApiOperations");
e.register(UC,"WordEditor.Extension.FieldOperations").ha().as("WordEditor.Extension.IFieldOperations").Ud(()=>new UC(e.resolve("WordEditor.Extension.FieldFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),e.resolve("Box4.ITableCellReader"),new Nb.a,e.resolve("Box4.IFieldEditor"),e.resolve("Box4.IHyperlinkEditor"),e.resolve("WordEditor.TableOfContents.ITableOfContentsActor"),
e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.ContentControlParagraphMapping"),e.resolve("Box4.IFieldUpdaterFactory"),G.AFrameworkApplication.va));e.ia("WordEditor.Extension.FileApiOperations",()=>new ru(e.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ImageApiOperations"),e.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),e.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),
G.AFrameworkApplication.pc)).ha().as("WordEditor.Extension.IFileApiOperations");e.register(rv,"WordEditor.Extension.TrackChangesOperations").ha().as("WordEditor.Extension.ITrackChangesOperations").Ud(()=>new rv(e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,e.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,e.resolve("WordEditor.Extension.TrackedChangeFactory"),e.resolve("WordEditor.TrackChange.ITrackChangeAcceptRejectManager")));
e.ia("WordEditor.Extension.TableOperations",()=>new Uy(e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.InsertApiOperations"),e.resolve("Box4.ITableNavigator"),G.AFrameworkApplication.va,new Nb.a,e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.ITableColumnReader"),e.resolve("Box4.ITableCellReader"),e.resolve("WordEditor.Extension.TableFactory"),e.resolve("WordEditor.Extension.TableRowFactory"),e.resolve("WordEditor.Extension.TableCellFactory"),e.resolve("Box4.TableReaderProxy"),
e.resolve("Box4.TableRowReaderProxy"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("WordEditor.Extension.ContentControlOperations"))).ha().as("WordEditor.Extension.ITableOperations");e.ia("WordEditor.Extension.CommentOperations",()=>new zJ(e.resolve("WordEditor.Comments.IWordEditorCommentModel"),e.Ta("WordEditor.Comments.IEditorCommentManager"),e.resolve("WordEditor.Extension.CommentFactory"),G.AFrameworkApplication.va,Kf.a.instance,e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.RangeOperations"),
e.resolve("WordEditor.Comments.ICommentFormatTranslator"))).ha().as("WordEditor.Extension.ICommentOperations");e.ia("WordEditor.Extension.FontOperations",()=>new $z(G.AFrameworkApplication.va,e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))).ha().as("WordEditor.Extension.IFontOperations");e.ia("WordEditor.Extension.SettingOperations",()=>new lH).ha().as("WordEditor.Extension.ISettingOperations");e.ia("WordEditor.Extension.InlinePictureFactory",()=>new HJ(e.resolve("Box4.Images.IImageReader"),
e.resolve("WordEditor.IImageEditor"),e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ITableOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.InlinePicture,Box4.GraphNodeContext>").ha();
e.ia("WordEditor.Extension.FontFactory",()=>new wB(e.resolve("Box4.IParagraphReader"),G.AFrameworkApplication.va,e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),e.resolve("WordEditor.Extension.IFontOperations"),e.resolve("Box4.Styles.IWACStyleEditor"))).ha();e.ia("WordEditor.Extension.TableBorderFactory",()=>new mH(new Nb.a,e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),e.resolve("WordEditor.IWACTableStyleReader"),e.resolve("Box4.TableNavigatorProxy"),e.Ta("Box4.TableCellReaderProxy"),
kp.a.instance,e.resolve("Box4.TableEditors.IWACTableStyleEditor"))).ha();e.ia("WordEditor.Extension.ParagraphFactory",()=>new kx(e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.InlinePictureFactory"),e.resolve("WordEditor.Extension.ListItemFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.IParagraphEditor"),e.resolve("Box4.ILanguageReader"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),
e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.FileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),e.resolve("WordEditor.Extension.FieldOperations"),
e.resolve("WordEditor.Extension.ParagraphLocalIdMapping"),e.resolve("WordEditor.Extension.IAnnotationOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Paragraph,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.ContentControlFactory",()=>new pB(e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.ContentControl.IContentControlManager"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),
e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.CheckboxContentControlFactory"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.ContentControl,WordEditor.ContentControl.IContentControl>").ha();
e.ia("WordEditor.Extension.CheckboxContentControlFactory",()=>new lv).ha();e.ia("WordEditor.Extension.InternalRangeFactory",()=>new LE(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.IParagraphReader"),new id.a(()=>ib.StaticActiveAppFrame.za()?ib.StaticActiveAppFrame.za().kb.hd.ud:null),e.resolve("Box4.IDynamicRangeObjectSpace"),e.resolve("Box4.IDynamicRangeEditor"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.ITableEditor"))).ha();e.ia("WordEditor.Extension.AnnotationOperations",
()=>new hv(e.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),e.resolve("Box4.Intent.IIntentRangeEditor"),e.resolve("WordEditor.AppsForOffice.WritingAssistanceAddInHelper"))).ha().as("WordEditor.Extension.IAnnotationOperations");e.ia("WordEditor.Extension.RangeFactory",()=>new PE(e.resolve("WordEditor.Extension.ParagraphFactory"),e.resolve("WordEditor.Extension.InlinePictureFactory"),
e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.InternalRangeFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.FileApiOperations"),
e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("Box4.HyperlinkEditor"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("WordEditor.Bookmark.IBookmarkManager"),e.resolve("WordEditor.Extension.NoteItemFactory"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),e.resolve("WordEditor.Extension.FieldOperations"),e.resolve("WordEditor.Extension.IAnnotationOperations"))).ha();
e.ia("WordEditor.Extension.ListFactory",()=>new fH(e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.IParagraphReader"))).ha();e.ia("WordEditor.Extension.ListItemFactory",()=>new ME(e.resolve("WordEditor.Extension.ListOperations"),e.resolve("Box4.IListMarkerUtility"))).ha();e.ia("WordEditor.Extension.NoteItemFactory",()=>new bA).ha();e.ia("WordEditor.Extension.FieldFactory",()=>new ZG).ha();e.ia("WordEditor.Extension.BodyFactory",()=>new np(e.resolve("WordEditor.Extension.ParagraphFactory"),
e.resolve("WordEditor.Extension.RangeFactory"),e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.InlinePictureFactory"),new Nb.a,e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),
e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),e.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Body,Box4.Graph.GraphNode>").ha();
e.ia("WordEditor.Extension.SectionFactory",()=>new QE(e.resolve("WordEditor.Extension.BodyFactory"),e.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),e.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Section,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.TableCellFactory",()=>new Tr(new Nb.a,e.resolve("WordEditor.Extension.TableBorderFactory"),e.resolve("Box4.TableNavigatorProxy"),e.Ta("Box4.TableCellReaderProxy"),
e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.ITableColumnReader"),e.resolve("Box4.ITableEditor"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableCell,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.TableRowFactory",()=>new LJ(e.resolve("WordEditor.Extension.FontFactory"),new Nb.a,e.resolve("WordEditor.Extension.TableBorderFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.TableNavigatorProxy"),e.resolve("Box4.ITableRowReader"),
e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.ITableEditor"),e.resolve("Box4.TableReaderProxy"),e.resolve("WordEditor.Extension.FieldOperations"),e.resolve("WordEditor.Extension.TableCellFactory"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableRow,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.TableFactory",()=>new Ty(e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.TableCellFactory"),
new Nb.a,e.resolve("WordEditor.Extension.TableBorderFactory"),e.resolve("WordEditor.ITableEditor"),e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),e.resolve("Box4.Styles.IWACTableStyleReader"),e.resolve("Box4.TableEditors.IWACTableStyleEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.RangeOperations"),
e.resolve("Box4.TableNavigatorProxy"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.ITableEditor"),zq.a.instance,e.resolve("Box4.SectionAlignedViewPositionProvider"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Table,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.GraphTransactionWrapper",()=>new xB(new id.a(()=>ib.StaticActiveAppFrame.za()?ib.StaticActiveAppFrame.za().kb.hd:
null),new Rg.a)).as("WordEditor.Extension.IGraphTransactionWrapper");e.ia("WordEditor.Extension.RequestContext",()=>new jH(e.resolve("WordEditor.Extension.GraphTransactionWrapper"))).ha();e.ia("WordEditor.Extension.DocumentProperties",()=>new $x(e.resolve("WordEditor.Extension.RequestContext"),e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),new Rg.a,new Ng,G.AFrameworkApplication.J.$("WordEditorAppsForOfficeDocPropertiesIsEnabled"))).ha();e.ia("WordEditor.Extension.AnnotationCollectionFactory",
()=>new Qy(e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),e.resolve("WordEditor.Extension.ParagraphFactory"))).ha();e.ia("WordEditor.Extension.DocumentFactory",()=>new PG(new id.a(()=>ib.StaticActiveAppFrame.za()?ib.StaticActiveAppFrame.za().kb.hd:null),e.resolve("WordEditor.Extension.RequestContext"),e.resolve("WordEditor.Extension.BodyFactory"),e.resolve("WordEditor.Extension.SectionFactory"),e.resolve("WordEditor.Extension.RangeFactory"),G.AFrameworkApplication.va,Kf.a.instance,Object(sd.a)(),
zq.a.instance,e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),vJ.a.fP,e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.DocumentProperties"),e.resolve("WordEditor.Extension.AnnotationCollectionFactory"),e.resolve("WordEditor.Bookmark.IBookmarkManager"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),
e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),e.resolve("WordEditor.Extension.CustomXmlPartFactory"),new Rg.a,e.resolve("WordEditor.Extension.SettingOperations"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("Box4.Styles.IWACStyleEditor"),e.resolve("WordEditor.Extension.FontFactory"),wJ.a.instance,e.resolve("WordEditor.Extension.ParagraphFactory"),e.resolve("WordEditor.Extension.ParagraphLocalIdMapping"),e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),e.resolve("WordEditor.Extension.IAnnotationOperations"))).ha();
e.ia("WordEditor.Extension.DocumentCreatedFactory",()=>new so).ha();e.ia("WordEditor.Extension.AuthenticationServiceFactory",()=>new QC(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Postmessage.IHostPostmessenger"))).ha();e.ia("WordEditor.Extension.LicenseFactory",()=>new zB(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();e.ia("WordEditor.Extension.AppRuntimeServiceFactory",
()=>new kB(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();e.ia("WordEditor.Extension.CommentContentRangeFactory",()=>new Uz(e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IFontOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Comments.IWordEditorCommentModel"))).ha();e.ia("WordEditor.Extension.CommentFactory",()=>new Xm(e.resolve("WordEditor.Extension.CommentReplyFactory"),
e.resolve("WordEditor.Extension.CommentContentRangeFactory"),e.resolve("Box4.IParagraphReader"))).ha();e.ia("WordEditor.Extension.CommentReplyFactory",()=>new Qr(new id.a(()=>ib.StaticActiveAppFrame.za()?ib.StaticActiveAppFrame.za().kb.hd.ud:null))).ha();e.ia("WordEditor.Extension.AppRuntimePersistenceServiceFactory",()=>new HG(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();e.ia("WordEditor.Extension.RichApiEventManager",
()=>new jx(e.resolve("WordEditor.Extension.EventMessageManagerMapper"),OfficeExtension.WacRuntime.RichApi.getEventManager(),new DJ)).ha();e.ia("WordEditor.Extension.EventMessageManagerMapper",()=>new UG(e.resolve("WordEditor.Extension.CommentEventMessageManager"),e.resolve("WordEditor.Extension.ContentControlEventMessageManager"),e.resolve("WordEditor.Extension.DocumentEventMessageManager"),e.resolve("WordEditor.Extension.ParagraphEventMessageManager"),e.resolve("WordEditor.Extension.AnnotationEventMessageManager"))).ha();
e.ia("WordEditor.Extension.CommentEventMessageManager",()=>new SG(e.Ta("WordEditor.Extension.RichApiEventManager"),e.resolve("WordEditor.Comments.EditorCommentModel"))).ha();e.ia("WordEditor.Extension.ParagraphEventMessageManager",()=>new VG(e.Ta("WordEditor.Extension.RichApiEventManager"),e.resolve("WordEditor.Extension.ParagraphLocalIdMapping"))).ha();e.ia("WordEditor.Extension.ContentControlEventMessageManager",()=>new sB(e.Ta("WordEditor.Extension.RichApiEventManager"),e.resolve("Box4.IContentControlDataChangedManager"),
e.resolve("WordEditor.ContentControl.IContentControlGraphManager"),e.resolve("Box4.ISelectionManager"),e.resolve("Box4.IContentControlChpHelper"),e.resolve("WordEditor.Extension.ContentControlOperations"))).ha();e.ia("WordEditor.Extension.DocumentEventMessageManager",()=>new TG(e.Ta("WordEditor.Extension.RichApiEventManager"),this.nrb())).ha();e.ia("WordEditor.Extension.AnnotationEventMessageManager",()=>new QG(e.Ta("WordEditor.Extension.RichApiEventManager"),e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
e.Ta("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"))).ha();e.ia("WordEditor.Extension.CustomXmlPartFactory",()=>new EE(e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).ha();e.ia("WordEditor.Extension.TrackedChangeFactory",()=>new oH).ha()}nrb(){const e=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return e?e.getInstance(0):(E.ULS.sendTraceTag(508827729,2250,10,"Could not resolve wordCountManagerFactory"),null)}static main(){G.AFrameworkApplication.hL||
R.a.instance.Mc(new CB)}}Object(F.a)(CB,"ExtensionPackage",null,[0,1]);var Cr=d(1287),DB=d(1772),pL=d(1622),pH=d(1554),qH=d(1540);class Kg{}Kg.Ig="StatsDialog";Kg.id="id";Kg.ofi="dialogState";Kg.mba="isModal";Kg.iVi="isBlocking";Kg.P_d="DocumentStatsReceivedEvent";Kg.TJg="UnsubscribedFromDocumentStatsEvent";Kg.characterCount="characterCount";Kg.characterWithoutSpacesCount="characterWithoutSpacesCount";Kg.C0h="characterCountSelection";Kg.G0h="characterWithoutSpacesCountSelection";Kg.jol="characterCountIsSupported";
Kg.ezf="emptyDocument";Kg.YU="paragraphCount";Kg.krj="paragraphCountSelection";Kg.Y9n="paragraphCountIsSupported";Kg.zjd="readabilityScore";Kg.Bpo="readabilityIsSupported";Kg.Cpo="readabilityTooltipLanguageSupport";Kg.WDo="renderUpsellFooter";Kg.timeToRead="timeToRead";Kg.ylp="timeToReadIsSupported";Kg.zlp="timeToReadTooltipLanguageSupport";Kg.timeToSpeak="timeToSpeak";Kg.Clp="timeToSpeakIsSupported";Kg.Dlp="timeToSpeakTooltipLanguageSupport";Kg.b2b="uniqueWordCount";Kg.wordCount="wordCount";Kg.Lbk=
"wordCountSelection";Kg.cIp="wordCountIsSupported";Kg.dIp="wordCountTooltipLanguageSupport";Kg.editorScore="editorScore";Kg.Jrd="totalSuggestions";Kg.isSelected="isSelected";Kg.isPremium="isPremium";Kg.isPaneOpen="isPaneOpen";Kg.jOo="seeSuggestionsAction";Kg.wKi="goPremiumLink";Object(F.a)(Kg,"StatsDialogProps",null,[]);class sv{}sv.qdk="AppLinkProps";sv.type="type";sv.id="id";sv.text="text";sv.handler="handler";sv.onExecute="onExecute";Object(F.a)(sv,"StatsDialogAppLinkProps",null,[]);const gk=new Map;
class EB{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc){this.ru=e;this.rT=n;this.sac=C;this.yDb=S;this.ga=ja;this.uv=ya;this.ee=kb;this.pn=Rb;this.ulb=sc;this.A3a=Fc;this.Ai=null;this.UWe=this.uJc=!1;this.Ym=null;this.QKc=0;this.ZZn=()=>{this.uv.execute(gd=>{this.A3a.Jta(ha.a.Syn,!0,void 0,void 0,void 0,void 0,[{name:"StatsDialogActor",string:"LaunchEditorUpsellFromStatsDialog command executed successfully."},{name:"StatsDialogCaller",string:this.kGc}]);this.Ai.hide();this.Iof();gd.launchUpsellExperience("editorinword")})};
this.A6n=()=>{this.Ai.hide();this.Iof();const gd=this.ga.Ob(ha.a.Wye,2);this.A3a.Jta(ha.a.Wye,32===gd,void 0,void 0,void 0,void 0,[{name:"StatsDialogCaller",string:this.kGc}])};this.ohi=(gd,td)=>{this.cBp(td)};this.D5j=()=>{this.tGj()};this.k7n=(gd,td,Bd)=>{this.kGc="StatusBar";return this.Yfd(Bd,ha.a.boe)};this.j7n=(gd,td,Bd)=>{this.kGc="EditorPane";return this.Yfd(Bd,ha.a.aoe)};this.Yfd=(gd,td)=>{if(2!==gd)return this.ulb.sendTraceTag(589105153,2253,50,"OpenStatsDialog command failed to execute, wrong behavior:",
gd),16;if(this.uJc)return 32;this.sac.H0k(this.ohi);this.sac.Y2k(this.D5j);this.sac.ME();this.Ai=new Qh.a(!1,!1,!0);this.Ai.Bd=0;this.ru.hqd();this.rT.hqd();this.UWe||this.Ai.Uh(WordEditorIntl.WordEditorStrings.L_StatsDialogTitle,this.Jof,this.aob(0));this.uJc=!0;this.Ym=this.ee.Xf("UserAction","OpenStatsDialog");this.QKc=0;this.A3a.Jta(td,!0,void 0,void 0,void 0,void 0,[{name:"StatsDialogActor",string:"OpenStatsDialog command executed successfully."}]);return 32};this.Jof=()=>{this.jJo();this.Iof()};
this.Iof=()=>{let gd=0;this.Ym&&(this.Ym.stop(),this.jDb||(this.QKc=this.Ym.Ri),gd=this.Ym.Ri-this.QKc);this.sac.zY();this.tGj();this.sac.MBo(this.ohi);this.sac.PCo(this.D5j);this.A3a.Jta(ha.a.t3h,!0,void 0,void 0,void 0,void 0,[{name:"StatsDialogActor",string:"CloseStatsDialog command executed successfully."},{name:"StatsDialogLoadingStateDuration",int64:this.QKc},{name:"StatsDialogShowStateDuration",int64:gd},{name:"StatsDialogCaller",string:this.kGc}])};this.jDb=2;this.Un={["id"]:Kg.Ig,["dialogState"]:this.jDb,
["isModal"]:!0,["isBlocking"]:!1,["emptyDocument"]:null,["characterCount"]:null,["characterWithoutSpacesCount"]:null,["uniqueWordCount"]:null,["wordCount"]:null,["paragraphCount"]:null,["readabilityScore"]:null,["timeToRead"]:null,["timeToSpeak"]:null,["totalSuggestions"]:null,["characterCountIsSupported"]:null,["characterCountTooltipLanguageSupport"]:null,["wordCountIsSupported"]:null,["wordCountTooltipLanguageSupport"]:null,["timeToReadIsSupported"]:null,["timeToReadTooltipLanguageSupport"]:null,
["timeToSpeakIsSupported"]:null,["timeToSpeakTooltipLanguageSupport"]:null,["readabilityIsSupported"]:null,["readabilityTooltipLanguageSupport"]:null};this.Un.isSelected=!1;this.Un.wordCountSelection=null;this.Un.characterCountSelection=null;this.Un.characterWithoutSpacesCountSelection=null;this.Un.paragraphCountSelection=null;this.Un.editorScore=null;this.ga.Ob(ha.a.iji,2)}Cpl(){this.Un[Kg.wordCount]?v(Kg.wordCount):u(Kg.wordCount);this.Un[Kg.b2b]?v(Kg.b2b):u(Kg.b2b)}aob(e,n=null){var C,S;this.jDb=
e;this.Un[Kg.ofi]=e;n&&(this.y5a(n,Kg.characterCount),this.y5a(n,Kg.characterWithoutSpacesCount),this.y5a(n,Kg.ezf),this.y5a(n,Kg.YU),this.y5a(n,Kg.zjd),this.y5a(n,Kg.timeToRead),this.y5a(n,Kg.timeToSpeak),this.y5a(n,Kg.b2b),this.y5a(n,Kg.wordCount),this.Cpl(),this.YQd(n,Kg.zjd,Kg.Bpo,Kg.Cpo),this.YQd(n,Kg.wordCount,Kg.cIp,Kg.dIp),this.YQd(n,Kg.timeToSpeak,Kg.Clp,Kg.Dlp),this.YQd(n,Kg.timeToRead,Kg.ylp,Kg.zlp),this.Un[Kg.jol]=!0,this.Un[Kg.Y9n]=!0,this.Un[Kg.Jrd]=Kg.Jrd in n?n[Kg.Jrd].count:0);this.Un[Kg.isPaneOpen]=
this.pn.isPaneOpen;this.Un[Kg.isPremium]=this.pn.Gtb;this.Un[Kg.WDo]=this.Sun;this.oFl();this.Un[Kg.jOo]=this.A6n;this.Un[Kg.isSelected]=!1;this.Un[Kg.wordCount]=this.ru.EA;this.Un[Kg.characterCount]=this.ru.$Xc;this.Un[Kg.characterWithoutSpacesCount]=this.ru.ZXc;this.Un[Kg.YU]=this.ru.aYc;this.Un[Kg.editorScore]=(null===(S=null===(C=this.yDb)||void 0===C?void 0:C.sVa())||void 0===S?NaN:S.percentage)|0;0<this.rT.EA&&(this.Un[Kg.isSelected]=!0);this.Un[Kg.Lbk]=this.rT.EA;this.Un[Kg.G0h]=this.rT.ZXc;
this.Un[Kg.C0h]=this.rT.$Xc;this.Un[Kg.krj]=this.rT.aYc;return{["id"]:Kg.Ig,["bodyControls"]:this.Un}}y5a(e,n){var C,S;this.Un[n]=null!==(S=null===(C=e[n])||void 0===C?void 0:C.count)&&void 0!==S?S:null}YQd(e,n,C,S){if(n in e){e=e[n];n=1===e.supportType||!!e.supportedLanguages&&0<e.supportedLanguages.length;if(1!==e.supportType&&n){let ja="",ya="";for(let kb=0;kb<e.supportedLanguages.length;kb++){const Rb=ac.a.Eg(e.supportedLanguages[kb].language).displayName;kb===e.supportedLanguages.length-1?ja=
Rb:ya=kb?ya+(", "+Rb):Rb}this.Un[S]=1===e.supportedLanguages.length?String.format(WordEditorIntl.WordEditorStrings.L_StatsDialogSupportsHelpTextOneDocumentLanguage,ja):String.format(WordEditorIntl.WordEditorStrings.L_StatsDialogSupportsHelpTextMultipleDocumentLanguage,ya,ja)}this.Un[C]=n}else this.Un[S]=null,this.Un[C]=!0}oFl(){this.Un[Kg.wKi]={[sv.type]:sv.qdk,[sv.id]:Kg.wKi,[sv.onExecute]:this.ZZn}}Xb(){this.ga.qa(ha.a.aoe,Ma.a.view,this.j7n);this.ga.qa(ha.a.boe,Ma.a.view,this.k7n)}cBp(e){this.rKn();
0===this.jDb?(this.Ai.hide(),this.uJc=!1,this.Ai=new Qh.a(!1,!1,!0),this.Ai.Bd=0,this.UWe||this.Ai.Uh(WordEditorIntl.WordEditorStrings.L_StatsDialogTitle,this.Jof,this.aob(1,e.stats)),this.uJc=!0):this.UWe||this.Ai.d9(WordEditorIntl.WordEditorStrings.L_StatsDialogTitle,this.Jof,this.aob(1,e.stats))}rKn(){!this.jDb&&this.Ym&&(this.QKc=this.Ym.Ri)}jJo(){switch(this.kGc){case "EditorPane":this.ga.Qb(ha.a.kdb,2,"StatsId")}}tGj(){this.uJc=!1;this.jDb=2;this.Un[Kg.ofi]=this.jDb;this.Un[Kg.characterCount]=
null;this.Un[Kg.characterWithoutSpacesCount]=null;this.Un[Kg.ezf]=null;this.Un[Kg.YU]=null;this.Un[Kg.zjd]=null;this.Un[Kg.timeToRead]=null;this.Un[Kg.timeToSpeak]=null;this.Un[Kg.b2b]=null;this.Un[Kg.wordCount]=null;this.Un[Kg.Jrd]=null;this.Un[Kg.C0h]=null;this.Un[Kg.G0h]=null;this.Un[Kg.krj]=null;this.Un[Kg.Lbk]=null}get Sun(){const e=this.uv.instance;return(null===e||void 0===e?void 0:e.isFreemiumUpsellEnabled())&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatsDialogUpsell",
!1)}}Object(F.a)(EB,"StatsDialogActor",null,[1001]);var UE=d(1722),Dr=d(526),un=d(235);class lx extends Dr.a{constructor(){super();this.allCharacterCount=0;this.H_=Object.assign(new un.a,{T_:lx.getTypeName(),B_:lx.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_CharacterCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(lx,"CharacterCount",Dr.a,[]);class eA extends Dr.a{constructor(){super();this.allCharacterWithoutSpacesCount=0;this.H_=Object.assign(new un.a,
{T_:eA.getTypeName(),B_:eA.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_CharacterWithoutSpacesCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(eA,"CharacterWithoutSpacesCount",Dr.a,[]);class Vy extends Dr.a{constructor(){super();this.allParagraphCount=0;this.H_=Object.assign(new un.a,{T_:Vy.getTypeName(),B_:Vy.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_ParagraphCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(Vy,
"ParagraphCount",Dr.a,[]);class fA extends Dr.a{constructor(){super();this.fleschReadingEase=null;this.H_=Object.assign(new un.a,{T_:fA.getTypeName(),B_:fA.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_ReadabilityScore"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(fA,"ReadabilityScore",Dr.a,[]);class Ks extends Dr.a{constructor(){super();this.timeToRead=0;this.H_=Object.assign(new un.a,{T_:Ks.getTypeName(),B_:Ks.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_TimeToRead"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(F.a)(Ks,"TimeToRead",Dr.a,[]);class gA extends Dr.a{constructor(){super();this.timeToSpeak=0;this.H_=Object.assign(new un.a,{T_:gA.getTypeName(),B_:gA.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_TimeToSpeak"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(gA,"TimeToSpeak",Dr.a,[]);class tu extends Dr.a{constructor(){super();this.wordNumber=0;this.H_=Object.assign(new un.a,{T_:tu.getTypeName(),B_:tu.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_WordCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(F.a)(tu,"WordCount",Dr.a,[]);var Rv=d(1458);class Sv extends Dr.a{constructor(){super();this.isEmpty=!1;this.H_=Object.assign(new un.a,{T_:Sv.getTypeName(),B_:Sv.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(Sv,"EmptyDocumentAnnotation",Dr.a,[]);class ps extends Dr.a{constructor(){super();this.count=0;this.H_=Object.assign(new un.a,{T_:ps.getTypeName(),B_:ps.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(F.a)(ps,"UniqueWordsCountAnnotation",Dr.a,[]);class by extends Sys.EventArgs{constructor(e){super();this.stats=e}}Object(F.a)(by,"DocumentStatsReceivedEventArgs",Sys.EventArgs,[]);class $C{constructor(){this.supportType=this.count=0;this.supportedLanguages=null}}Object(F.a)($C,"Stat",null,[]);class aD{constructor(e,n,C,S){this.MH=null;this.$Pa={};this.Re=e;this.Z5=C;this.ulb=S;this.sa=n;this.O1=!1;this.Iia=new fb.a;this.Iia.add(Sv.getTypeName());this.Iia.add(tu.getTypeName());this.Iia.add(lx.getTypeName());
this.Iia.add(eA.getTypeName());this.Iia.add(Vy.getTypeName());this.Iia.add(Ks.getTypeName());this.Iia.add(gA.getTypeName());this.Iia.add(ps.getTypeName());this.Iia.add(fA.getTypeName());this.Iia.add(Rv.a.getTypeName())}ME(){return this.O1?Promise.resolve(null):this.Z5.im().then(()=>{this.MH={};for(const e of this.Iia)this.Re.ub(this,e),this.Jtj(e);this.Re.addHandler(this,UE.a.getTypeName());this.Jtj(UE.a.getTypeName());this.O1=!0}).catch(e=>{this.ulb.sendTraceTag(589692994,2253,10,"Unable to register stats dialog annotation handlers.",
e)})}zY(){return this.O1?this.Z5.im().then(()=>{this.MH=null;this.O1=!1;this.yno()}).catch(e=>{this.ulb.sendTraceTag(589692995,2253,10,"Unable to unregister stats dialog annotation handlers.",e)}):Promise.resolve(null)}H0k(e){this.sa.addHandler(Kg.P_d,e)}MBo(e){this.sa.removeHandler(Kg.P_d,e)}Y2k(e){this.sa.addHandler(Kg.TJg,e)}PCo(e){this.sa.removeHandler(Kg.TJg,e)}gH(e,n){this.O1&&(n===Vh.a.getTypeName()||n===CC.a.getTypeName())&&this.Drb(e)}Drb(e){if(e){e.annotationType===Sv.getTypeName()&&this.VVa(Kg.ezf,
e.content.isEmpty?1:0);if(e.annotationType===tu.getTypeName()){var n=e.content;if(!n)return;this.VVa(Kg.wordCount,n.wordNumber)}e.annotationType===lx.getTypeName()&&this.VVa(Kg.characterCount,e.content.allCharacterCount);e.annotationType===eA.getTypeName()&&this.VVa(Kg.characterWithoutSpacesCount,e.content.allCharacterWithoutSpacesCount);e.annotationType===Vy.getTypeName()&&this.VVa(Kg.YU,e.content.allParagraphCount);e.annotationType===Ks.getTypeName()&&this.VVa(Kg.timeToRead,e.content.timeToRead);
e.annotationType===gA.getTypeName()&&this.VVa(Kg.timeToSpeak,e.content.timeToSpeak);e.annotationType===ps.getTypeName()&&this.VVa(Kg.b2b,e.content.count);e.annotationType===fA.getTypeName()&&(n=e.content,this.VVa(Kg.zjd,n.fleschReadingEase?n.fleschReadingEase:-1));if(e.annotationType===Rv.a.getTypeName()){n=e.content;this.$Pa[n.categoryName]=n.count;n=0;const C=this.$Pa;for(const S in C)n+=C[S];this.VVa(Kg.Jrd,n)}e.annotationType===UE.a.getTypeName()&&this.CXm(e.content)}else this.ulb.sendTraceTag(589692996,
2253,15,"Annotation is null.")}Jtj(e){this.Z5.im().then(()=>{this.Re.getAnnotationsByType(e).then(n=>{for(const C of n)this.Drb(C)})});Promise.resolve(null)}yno(){this.O1||(this.sa.raiseEvent(Kg.TJg),this.ulb.sendTraceTag(589692999,2253,50,"UnsubscribedFromDocumentStats event raised."))}VVa(e,n){let C=new $C;if(e in this.MH&&(C=this.MH[e],C.count===n))return;C.count=n;this.MH[e]=C;this.ulb.sendTraceTag(589693E3,2253,50,e+" document stat added/updated.");this.sa.raiseEvent(Kg.P_d,new by(this.MH))}LJn(e){return"DistinctWords"===
e?Kg.b2b:"WordCount"===e?Kg.wordCount:"Readability"===e?Kg.zjd:"TimeToRead"===e?Kg.timeToRead:"TimeToSpeak"===e?Kg.timeToSpeak:""}CXm(e){for(const n of e.features)if(e=this.LJn(n.featureName),""!==e){let C=new $C;e in this.MH&&(C=this.MH[e]);C.supportType=n.supportType;C.supportedLanguages=n.supportedLanguages;this.MH[e]=C}this.ulb.sendTraceTag(578065630,2253,50,"Document stats support updated.");this.sa.raiseEvent(Kg.P_d,new by(this.MH))}}Object(F.a)(aD,"StatsDialogAnnotationHandler",null,[1E3,114]);
var tv;(function(e){e[e.Thq=0]="premium";e[e.Bfo=1]="premiumPreview";e[e.q2p=2]="freemium"})(tv||(tv={}));Object(F.b)("AddInLicensingMode",tv);var VE=d(1563);class Ew{constructor(e){this.dSa=e}VRh(e,n){n[e]=Bf.c(this.dSa.Gl)}}Ew.vYh="PremiumPreviewData";Object(F.a)(Ew,"PremiumPreviewDataAppender",null,[950]);var uu;(function(e){e[e.N2j=0]="triggerModel";e[e.Gy=1]="ribbon";e[e.callout=2]="callout";e[e.Drq=3]="windowModeChanged";e[e.contextualCard=4]="contextualCard";e[e.EUp=5]="appLaunch";e[e.bnq=
7]="skittle";e[e.Ynq=8]="statsDialog";e[e.Rqq=9]="upsellCampaignDialog";e[e.fUp=9]="aiFeedbackSkittle"})(uu||(uu={}));Object(F.b)("HowLaunched",uu);class rH{constructor(e,n,C,S){this.BackgroundLaunchTime=S;this.IsBackgroundLoad=C;this.HowLaunched=uu[e];this.PaneLaunchTime=n}}Object(F.a)(rH,"OpenPanePayload",null,[]);class Op{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd=!1,wd=!0,te=!1,Le=!1,Oe=!1,We=!1){this.ui=e;this.Oo=n;this.tW=C;this.qvk=S;this.HMd=ja;this.pn=ya;this.vRc=kb;this.$Se=Rb;this.fNc=
sc;this.I3e=Fc;this.TFa=gd;this.rLe=td;this.vtk=Bd;this.nAk=wd;this.yLk=te;this.ROk=Le;this.RPk=Oe;this.RIk=We;this.onTaskPaneClose=()=>{this.Oo.sendMessage(ei.a.pPi,null);this.pn.isPaneOpen=!1}}init(e){this.SBk=e}get sourceLocationOverrideResourceId(){return this.HMd}load(e){E.ULS.sendTraceTag(40957968,2250,50,"Loading Ideas.");if(this.tW){var n={};n[Pu.a.Byf]=this.pn.ETb.toString();this.$Se.TRh(n);this.I3e.VRh(Ew.vYh,n);Object.assign(n,this.fNc.settings);n=new jd.a((new Wc.a(Tj.a.create(),1)).toString(),
Op.appId,"","",OSF.StoreType.Sdx,n);n.isModernPane=!0;G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb&&G.AFrameworkApplication.ua.Gb.yde&&(n.isResizable=!0,n.resizeMaxWidth=920);n.featureGates=this.qvk;n.featureGates.WACIdeasDictationCorrectionsIsEnabled=this.vtk;n.featureGates.WACIdeasLicensingIsEnabled=!0;n.featureGates.WACIdeasPremiumIsEnabled=this.pn.ETb;n.featureGates.WACIdeasKeypointsIsEnabled=this.nAk;n.featureGates.WACIdeasStatsDialogIsEnabled=this.ROk;n.featureGates.WACTaskPaneBackgroundRefreshIsEnabled=
this.RPk;n.featureGates.WACGoalsIsEnabled=this.TFa.dTb();n.featureGates.WACPremiumPreviewIsEnabled=this.SBk;n.featureGates.WACBxPromoIsEnabled=this.rLe.isEnabled();n.featureGates.WACResumeCritiqueIsEnabled=this.yLk;n.featureGates[Op.qAh]=Op.Aqn();n.featureGates.WordEditorPerspectivesIsEnabled=this.RIk;n.featureGates[Op.Ech]=Op.Nhn();n.featureGates[Op.AGh]=Op.T$c();n.onTaskPaneClose=this.onTaskPaneClose;n.sharedRuntimeId=this.sourceLocationOverrideResourceId;n.sourceLocationOverrideResourceId=this.sourceLocationOverrideResourceId;
this.ui.createUILessSandbox(Op.appId,e,n)}else E.ULS.sendTraceTag(40957969,2250,10,"TaskPaneManager has not initialized before loading the Ideas.")}static Nhn(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate(Op.Ech,!1)}static T$c(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate(Op.AGh,!1)}static Aqn(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate(Op.qAh,!1)}}Op.appId="FA000000029";Op.qAh="Microsoft.Office.WordOnline.ProofingALV2Migration";
Op.Ech="Microsoft.Office.WordOnline.CopilotRibbon";Op.AGh="Microsoft.Office.WordOnline.IsSummarizationCopilotBranded";Object(F.a)(Op,"IdeasAddIn",null,[949]);class qs{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd){var te,Le;this.ga=e;this.pn=n;this.ui=C;this.Aa=S;this.sUe=ja;this.Oo=ya;this.UHb=kb;this.uv=sc;this.$Se=Fc;this.Jb=gd;this.I3e=td;this.fNc=Bd;this.N5=wd;this.pCd=this.ygb=!1;this.B8o=(Oe,We,Xf,Gg,Ph)=>2!==Xf?32:this.ui.c3(Op.appId)?this.H0m():this.sUj(Oe,We,Xf,Gg,Ph);this.sUj=(Oe,We,
Xf,Gg,Ph)=>{if(2!==Xf)return 32;if(!this.ui.c3(Op.appId))return this.sY(Oe,We,Xf,Gg,Ph);this.ui.q2b(Op.appId,this.iDi(Ph));return 32};this.sY=(Oe,We,Xf,Gg,Ph)=>{if(1===Xf)return 32;Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.IdeasPaneWasLaunched"}));We=!!Ph&&1===Ph.ShowPaneBackgroundLoad;Xf=!1;Gg=1;let Aj=!1;switch(Oe){case ha.a.ppd:Gg=0;Aj=!0;break;case ha.a.TBg:Gg=2;break;case ha.a.LBg:Gg=7;break;case ha.a.JBg:Gg=9;break;case ha.a.Qbl:Gg=3;break;case ha.a.z_a:Gg=
4;break;case ha.a.KBg:Gg=5;Aj=!0;break;case ha.a.Wye:Gg=8;break;case ha.a.WTj:Gg=9}Oe=this.iDi(Ph);this.Aa.$("WordEditorSessionLifetimeForIdeasIsEnabled")||this.pCd||(Xf=this.pCd=!0,this.sUe.load(Oe));const Ih=Object.assign(new va.a,{isModernPane:!0,isPaneAutoOpened:Aj,sharedRuntimeId:this.sUe.sourceLocationOverrideResourceId,sourceLocationOverrideResourceId:this.sUe.sourceLocationOverrideResourceId});Ph={};Ph[Pu.a.Byf]=this.pn.ETb.toString();qs.iWo(Ph);this.$Se.TRh(Ph);this.I3e.VRh(Ew.vYh,Ph);Object.assign(Ph,
this.fNc.settings);Ih.QU=Ph;G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb&&G.AFrameworkApplication.ua.Gb.yde&&(Ih.isResizable=!0,Ih.resizeMaxWidth=920);We?(Ih.isPreload=!0,this.pn.u8c=!0,this.pn.SSd=Date.now(),this.Jb.$b(new zg.a(2,1,4E3,()=>{this.pn.u8c&&!this.ui.c3(Op.appId)&&(E.ULS.sendTraceTag(575952149,2250,50,"Background-loaded pane hasn't presented itself within timeout window ({0}ms); opening",4E3),Ih.isPreload=!1,this.ui.E8(Op.appId,Ih,!0))}))):(this.pn.SSd=null,this.pn.u8c=!1);
Ph=this.ui.E8(Op.appId,Ih,!0);this.ui.q2b(Op.appId,Oe);if(!Ph)return E.ULS.sendTraceTag(41238555,2250,10,"Failed to show Ideas (isBackgroundLoad: {0}).",We),16;this.Hqc();this.pn.t6c=Gg;this.pn.isPaneOpen=!0;this.pn.Rhg=(new Date).getTime();Xf||this.Oo.sendMessage(ei.a.PSf,new rH(Gg,this.pn.Rhg,this.pn.u8c,this.pn.SSd));return 32};this.launchUpsellExperience=()=>{this.uv.execute(Oe=>{Oe.launchUpsellExperience("editorinword")});return 32};this.ajd=(Oe,We,Xf,Gg,Ph)=>{if(1===Xf)return 32;Ph&&(Ph[Fa.a.On]=
this.pn.isPaneOpen,Ph[Fa.a.Visible]=!0);return 32};this.opj=()=>{Object(xa.a)("ContinueReviewingEditorSuggestions",!0);this.pn.isPaneOpen||G.AFrameworkApplication.va.Ob(ha.a.keb,2);window.removeEventListener(qs.i7h,this.opj)};this.npj=()=>{Object(xa.a)("ReviewSuggestionsToOpenEditorPaneAfterShare",!0);this.pn.isPaneOpen||G.AFrameworkApplication.va.Ob(ha.a.keb,2);window.removeEventListener(qs.wHj,this.npj)};((null===(te=G.AFrameworkApplication.J)||void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",
!1))||(null===(Le=G.AFrameworkApplication.J)||void 0===Le?0:Le.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIToContinueReviewSuggestionsEnabled",!1)))&&this.addEventListener()}register(e=!1){if(this.ygb)E.ULS.sendTraceTag(50422103,2250,15,"Attempted to register Ideas add-in commands more than once.");else{this.ygb=!0;E.ULS.sendTraceTag(40957965,2250,50,"Registering Ideas commands.");var n={},C=new fb.a;n.Editor="ButtonModel";C.add("btnWordEditor");this.ga.fb(ha.a.keb,X.a.frame,this.B8o,
1028);this.ga.fb(ha.a.ajd,Ma.a.view,this.ajd,1124);this.ga.fb(ha.a.sY,X.a.frame,this.sUj,1028);this.ga.fb(ha.a.ppd,X.a.frame,this.sY,1028);this.ga.fb(ha.a.TBg,X.a.frame,this.sY,1028);this.ga.fb(ha.a.LBg,X.a.frame,this.sY,1028);this.ga.fb(ha.a.JBg,X.a.frame,this.sY,1028);this.ga.fb(ha.a.WTj,X.a.frame,this.sY,1028);this.ga.fb(ha.a.Wye,X.a.frame,this.sY,1028);this.ga.fb(ha.a.z_a,X.a.frame,this.sY,1028);this.Aa.$("GoPremiumInContextualCardIsEnabled")&&this.ga.fb(ha.a.N5i,X.a.frame,this.launchUpsellExperience,
1028);(this.Aa.$("EditorAutoOpenIsEnabled")||this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorProactiveFromTemplateIsEnabled",!1))&&this.ga.fb(ha.a.KBg,X.a.frame,this.sY,1028);e&&this.UHb.SOa(n);VE.a.jd.addHandler(VE.a.Jme,this.Qfd.bind(this))}}static iWo(e){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SendEduUserStateToEditorPane",!0)&&G.AFrameworkApplication.sessionStartInfoSettings&&(e.isEduUser=G.AFrameworkApplication.sessionStartInfoSettings.IsEduUser)}H0m(){this.ui.bMb(Op.appId);
this.pn.isPaneOpen=!1;return 32}iDi(e){let n=this.pn.gdi;e&&(e=e.PaneTitle)&&(n=e);return n}Hqc(){this.N5&&this.N5.execute(e=>{e.logActivity("WordWebEditorSeen",null)})}Qfd(e,n){"View"==n.documentMode&&this.pn.isPaneOpen&&G.AFrameworkApplication.va.Ob(ha.a.keb,2)}addEventListener(){window.addEventListener(qs.wHj,this.npj,!0);window.addEventListener(qs.i7h,this.opj,!0)}}qs.wHj="ReviewSuggestionsToOpenEditorPaneAction";qs.i7h="ContinueReviewingSuggestionsByOpeningEditorPane";Object(F.a)(qs,"AddInCommands",
null,[934]);var Fw=d(129);class sH{constructor(e){this.HostSessionId=e}}Object(F.a)(sH,"HostSessionInitializedPayload",null,[]);class bD{constructor(){this.isVisible=this.isEnabled=!1;this.isEnabled=Fw.a.settings.WordPredIsEnabled;this.isVisible=Fw.a.e1f()}}Object(F.a)(bD,"TextPredictionPayload",null,[]);class cD{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td){this.Oo=e;this.AQk=n;this.qQk=C;this.Gmk=S;this.pn=ja;this.Aa=ya;this.ui=kb;this.pHh=Rb;this.wSe=sc;this.xRe=Fc;this.j8e=gd;this.fNc=td;this.lnh=
!1}get Wsa(){return this.lnh}vVn(){this.lnh=!0;this.pn.Wsa=!0;this.fNc.Wdp()}jD(){E.ULS.sendTraceTag(41437253,2250,50,"AddInLoaded message received from Ideas SDX.");this.Wsa&&E.ULS.sendTraceTag(41437254,2250,15,"AddInLoaded message received more than once.");var e=this.ui.f8a(Op.appId);e&&""!==e?(e=window.document.getElementById(e))?(this.vVn(),this.Oo.Uyl(e),this.Aa.$("WordEditorSessionLifetimeForIdeasIsEnabled")&&this.Gmk.register(!0),this.qQk.execute(()=>{this.AQk.initialize();this.pHh.Gxo();
this.pHh.Xxo();this.$Po();this.xRe.s8m()})):E.ULS.sendTraceTag(40957967,2250,10,"Ideas loaded but the iframe couldn't be reached."):E.ULS.sendTraceTag(40957966,2250,10,"Ideas loaded but the OSF control ID is invalid. {0}",e)}$Po(){this.Oo.sendMessage(ei.a.MOi,new sH(this.pn.sessionId));Fw.a.e1f()&&this.Oo.sendMessage(ei.a.szc,new bD);if(this.pn.isPaneOpen){const e=new rH(this.pn.t6c,this.pn.Rhg,this.pn.u8c,this.pn.SSd);this.Oo.sendMessage(ei.a.PSf,e)}this.wSe.execute(async e=>{const n=await e.isFeatureEnabled("mso_sendASmile",
!0)&&G.AFrameworkApplication.VE;e=e.isFreemiumUpsellEnabled()||this.j8e.fYi();this.Oo.sendMessage(ei.a.k5h,{enableFeedback:n,enableUpsell:e});E.ULS.sendTraceTag(556290514,2250,50,`Compliance requirement state shared with add-in; enableFeedback:${n} enableUpsell:${e}`)})}}Object(F.a)(cD,"AddInLoadedMessageHandler",null,[975]);class tH extends Sys.EventArgs{constructor(e,n){super();this.isPaneOpen=e;this.t0i=n}}Object(F.a)(tH,"PaneToggleEventArgs",Sys.EventArgs,[]);class FB{constructor(e,n,C,S,ja,ya){this.UGa=
e;this.dSa=n;this.C2e=C;this.Kzh=S;this.j8e=ja;this.DBb=ya;this.KJc=this.Wib=this.VD=!1;this.Rhg=this.t6c=0;this.Wsa=!1;this.gdi=null;this.u8c=!1;this.SSd=null;this.Keg=(kb,Rb)=>{this.KJc!==Rb.Gtb&&(this.Gtb=Rb.Gtb)};this.yfd=()=>{const kb=this.o$c();this.hXe!==kb&&(this.hXe=kb,this.E8j())};this.dSa.wKb(this.yfd);this.hXe=this.o$c();this.DBb.bPh(this.Keg)}init(e){this.Gtb=e}get isPaneOpen(){return this.VD}set isPaneOpen(e){this.VD!==e&&(this.VD=e,this.C2e.raiseEvent("OnPaneToggle",new tH(this.VD,
this.Wib,null)))}get sessionId(){return this.UGa}get Gtb(){return this.KJc}set Gtb(e){this.KJc!==e&&(this.KJc=e,this.E8j())}get ETb(){return this.Wib}set ETb(e){throw Error.create("Don't explicitly set this - use IsPremiumUser");}C5a(e){this.C2e.addHandler("OnPaneToggle",e)}Lkd(e){this.C2e.removeHandler("OnPaneToggle",e)}F2k(e){this.Kzh.addHandler("OnPremiumStateChange",e)}o$c(){const e=this.dSa.Gl.state;return 1===e||6===e}E8j(){const e=this.KJc&&!this.j8e.fYi()||this.hXe;this.Wib!==e&&(this.Wib=
e,this.Kzh.raiseEvent("OnPremiumStateChange",new tH(this.VD,this.Wib,null)))}}Object(F.a)(FB,"AddInState",null,[996]);class dD{constructor(e){this.kKk=e}kEm(e){return 1===e?WordEditorIntl.WordEditorStrings.L_EditorPaneTitlePreview:WordEditorIntl.WordEditorStrings.L_EditorPaneTitle}h6j(e){const n=[],C={btnWordIdeas:!0},S=String.format("btnWord{0}","Editor");C[S]=!e;C.grpEditorProofing=!e;C.sbEditorProofing=!e;C.btnEditorProofingSubmenu=!e;C.grpProofing=e;C.sbProofing=e;C.fseaNextSpellingError=e;n.push.apply(n,
this.kKk.n4d(C));n.push(appChrome.actions.updateGroupHiddenState("Editor",!e));appChrome.api.dispatch(n)}}Object(F.a)(dD,"AddInUtils",null,[995]);class Gw{constructor(e,n,C=null){this.qXk=e;this.uii=n;this.vr=C}BIg(){let e=!this.qXk.pCd;e&&this.uii&&this.uii.execute(n=>{e=e&&(null===n||void 0===n?void 0:n.v_i())});e&&this.vr&&this.vr.execute(n=>{n.logActivity(Gw.SZl,null)})}}Gw.SZl="EditorSuggestionsReviewedAndSuggestionsRemaining";Object(F.a)(Gw,"OpenEditorTeachingCallout",null,[]);class uH{constructor(e,
n,C,S){this.rLe=e;this.Jpk=n;this.Oo=C;this.NGc=S;this.XYn=(ja,ya)=>{null!==ya.score&&this.Oo.sendMessage(ei.a.Shg,{editorScore:ya.score.percentage})};this.JQo=()=>{this.Oo.sendMessage(ei.a.Shg,this.settings)}}get settings(){var e,n;const C={};this.rLe.isEnabled()&&(C.BxPromoData=this.Jpk.Mi);C.isDarkMode=!1;Bb.a("isSharedUXDarkModeOn")&&(C.isDarkMode=appChrome.api.isSharedUXDarkModeOn());C.editorScore=null===(n=null===(e=this.NGc.instance)||void 0===e?void 0:e.sVa())||void 0===n?void 0:n.percentage;
return C}Wdp(){Bb.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.JQo);this.NGc.execute(e=>e.Yef(this.XYn))}}Object(F.a)(uH,"PaneSettingsProvider",null,[]);class vH{constructor(e){this.Oo=e}jD(){E.ULS.sendTraceTag(593282780,2250,50,"GetAuthMessage message received");Jp.a.im().then(()=>{Jp.a.MSd.LHf.then(e=>{this.Oo.sendMessage(ei.a.Sif,{IsSuccess:e.isSuccess,ErrorCode:e.errorCode,ErrorMessage:e.errorMessage})}).catch(e=>{E.ULS.sendTraceTag(593282779,2250,10,"Failed to get authenticationCompletionResult",
e);this.Oo.sendMessage(ei.a.Sif,{IsSuccess:!1,ErrorCode:"AuthenticationResultReject",ErrorMessage:"Authentication result promise rejection. Not retriable"})})})}}Object(F.a)(vH,"GetAuthResultMessageHandler",null,[975]);class MJ{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd=!1){this.j5n=(td,Bd)=>{this.Z0.c3(Op.appId)||this.yJk.Qif(2,()=>{if(this.NBk){const wd={};wd.ShowPaneBackgroundLoad=Bd.launchMode;this.k9.Qb(ha.a.ppd,2,wd,null);E.ULS.sendTraceTag(594060358,2250,50,"Editor pane Auto triggered (type: {0})",
Bd.launchMode);this.yGa.Jta(ha.a.ppd,!0,void 0,void 0,void 0,void 0,[Object.assign(new kh.a,{name:"EditorPaneAutoTriggerModel",string:Bd.N2j})])}this.tUe&&!this.tUe.isVisible&&(this.tUe.showCallout(Bd.YLl,()=>{this.bqa.v0(2,new Date)}),this.rna("UserTriggeredCallout"),E.ULS.sendTraceTag(594060357,2250,50,"Editor callout was triggered"))})};this.v0=()=>{this.bqa.v0(4,new Date)};this.Ima=(td,Bd)=>{this.bqa.v0(Bd.isPaneOpen?0:1,new Date)};this.k9=e;this.tUe=n;this.zmk=C;this.bqa=S;this.vRc=ja;this.Oo=
ya;this.pn=kb;this.Z0=Rb;this.yJk=sc;this.yGa=Fc;this.NBk=gd}initialize(){this.zmk.zYk(this.j5n);this.bqa.initialize();this.eY()}jD(e){e.MessageId===ei.a.nZj&&this.bqa.v0(3,new Date)}eY(){this.Oo.Ur(ei.a.nZj,this);this.vRc.c3k(this.v0);this.pn.C5a(this.Ima)}rna(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas."+e}))}}Object(F.a)(MJ,"IdeasAutoTrigger",null,[994,975]);class qL{constructor(e,n){this.yGa=e;this.Kpk=n}jD(){this.yGa.Jta(ha.a.mVl,!0);this.Kpk.hWo()}}Object(F.a)(qL,
"BxPromoDismissedMessageHandler",null,[975]);var rL=d(700),cy=d(1623);class mx extends cy.a{constructor(e,n){super("IdeasCallout");this.numberOfWritingIssuesFound=0;this.buttonPropsList=null;this.numberOfWritingIssuesFound=e;this.buttonPropsList=n}}Object(F.a)(mx,"IdeasCalloutCustomContentProps",cy.a,[]);class rs{constructor(e,n){this.hW=null;this.ey=!1;this.ga=e;this.ZOk=n}get isVisible(){return this.ey}showCallout(e,n){0>e?E.ULS.sendTraceTag(51204740,2250,10,"Number of writing issues cannot be less than zero."):
G.AFrameworkApplication.ua.Gb&&G.AFrameworkApplication.ua.Gb.hXa?this.ZOk.OD.loadScript(rs.YSk).then(()=>{sb.UISurfaces.uL().then(C=>{var S=new rL.a(WordEditorIntl.WordEditorStrings.L_EditorCalloutOpenEditorButtonLabel,()=>{this.ga.Ob(ha.a.TBg,2);this.dismiss()});S=new mx(e,[S]);S=Object.assign(new Db.a,{target:rs.jl,content:S,showCloseIcon:!0,hasFocusableControls:!0,calloutProps:Object.assign(new cb.a,{onDismiss:()=>{n()},isBeakVisible:!1,directionalHint:6})});S=C.callout(S);const ja=Object.assign(new Ta.a,
{telemetryId:"IdeasCallout",onShow:()=>{this.ey=!0}});this.hW=C.addNotification(S,ja);return null}).catch(C=>{E.ULS.sendTraceTag(51204742,2250,10,"Notifications API failed. Error: {0}",C.toString())})}).catch(C=>{E.ULS.sendTraceTag(51401047,2250,10,"Failed to load Ideas callout strings. Error: {0}",C.toString())}):E.ULS.sendTraceTag(51204741,2250,15,"React Notifications API disabled. Cannot show the callout.")}dismiss(){sb.UISurfaces.uL().then(e=>{e.removeNotification(this.hW);this.ey=!1;return this.hW=
null},e=>{E.ULS.sendTraceTag(593352338,2250,10,"Failed to GetNotificationsAPIAsync: {0}",e);return null})}}rs.jl=".WACNotificationBar";rs.YSk="word-ideas-strings";Object(F.a)(rs,"IdeasCallout",null,[993]);var NJ=d(1774);class WE extends bh.a{constructor(e,n){super("DocumentLengthConditionId");this.A$=e;this.Luh=n;this.fud=(C,S)=>{this.pi(S.wordCount>=this.Luh)}}initialize(){super.initialize();this.A$.Xef(this.fud);this.pi(this.A$.EA>=this.Luh)}Wd(){this.A$.xrg(this.fud);super.Wd()}}Object(F.a)(WE,
"DocumentLengthCondition",bh.a,[]);class vn extends bh.a{constructor(e){super("EditorPaneOpenedConditionId");this.c2a=e;this.Ima=(n,C)=>{C.isPaneOpen?(E.ULS.sendTraceTag(546063902,2250,50,"Editor pane opened condition satisfied"),this.pi(!0)):(E.ULS.sendTraceTag(546063903,2250,50,"Editor pane opened condition unsatisfied"),this.pi(!1))}}initialize(){super.initialize();this.c2a.C5a(this.Ima);this.pi(this.c2a.isPaneOpen)}Wd(){this.c2a.Lkd(this.Ima);super.Wd()}}Object(F.a)(vn,"EditorPaneOpenedCondition",
bh.a,[]);var wH=d(1776),XE=d(1773);class YE extends bh.a{constructor(e){super("ProofingDisabledId");this.Vjo=e;this.initialized=!1;this.zYa=()=>{this.initialized&&this.pi(!this.Vjo.c_f)};e.FEg(this.zYa)}initialize(){super.initialize();this.initialized=!0;this.zYa()}Wd(){super.Wd();this.initialized=!1}}Object(F.a)(YE,"ProofingDisabledCondition",bh.a,[]);var Ap;(function(e){e.zHe="ppExpired";e.AHe="ppExpiredMetrics";e.vIe="womppShare";e.rCc="paneOpenAfterPP";e.zCc="skittle";e.HGe="aiFeedbackFRE";e.IGe=
"aiFeedbackSkittle"})(Ap||(Ap={}));const dt={[Ap.zHe]:3,[Ap.AHe]:3,[Ap.vIe]:3,[Ap.rCc]:1,[Ap.zCc]:1,[Ap.HGe]:3,[Ap.IGe]:1},nx={[Ap.zHe]:0,[Ap.AHe]:0,[Ap.vIe]:0,[Ap.rCc]:0,[Ap.zCc]:0,[Ap.HGe]:0,[Ap.IGe]:0};let eD={[Ap.zHe]:!1,[Ap.AHe]:!1,[Ap.vIe]:!1,[Ap.rCc]:!1,[Ap.zCc]:!1,[Ap.HGe]:!1,[Ap.IGe]:!1};class Tv extends bh.a{constructor(e){super("SkittleSuppressionId");this.Lmi=e}initialize(){super.initialize();this.Opl()}async Opl(){const e=!await this.Lmi.FXi(Ap.zCc);this.pi(e)}Jgp(){this.Lmi.Lgp(Ap.zCc);
this.pi(!1)}}Object(F.a)(Tv,"SkittleSuppressedCondition",bh.a,[]);var GB=d(1775);class fD{constructor(e,n,C,S){this.ZQa=S;this.Ved=(ja,ya)=>{for(const kb of ya.yk)ja=kb.intent,9==ja.type&&(ya=ja.MO.intent,this.Xqg(ya.id,ja.Ib.paragraph),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)?this.ZQa.sendMessage(ei.a.Kud,{payload:{annotationId:ya.id,aZj:!0}}):this.Re.n5c(ya,!1,"AugLoop_Core_DeleteOperation",!1))};this.rWb=(ja,ya)=>
{for(const kb of ya.contents)this.uKa(kb.element,kb.intents)};this.Wn=e;this.qih=null;n.fTa(this.rWb);gc.a.instance.resolve("Box4.ICharacterPropertiesEditor").qff(this.Ved);this.Re=C}uKa(e,n){if(n){var C=!1,S=!1,ja=new fb.a;for(const ya of n)9===ya.type&&(C=!0,this.qih===ya.id&&(S=!0),ja.add(ya.id));C&&(e.classList.remove(en.a.MQh,en.a.NQh,en.a.OQh),n=S?en.a.MQh:this.NJf()?en.a.OQh:en.a.NQh,e.classList.add(n));Vm.a.Cm(e,"AIFeedbackIntentManager_CustomDataIntentIds",ja)}}clear(e,n){n?this.Wn.Bsd(C=>
n.equals(C.id),e,9):this.Wn.zAb(e,9)}iCa(e,n,C,S,ja){0>C&&(C=0);S>e.characterData.length&&(S=e.characterData.length);if(!(C>=S)){var ya=Wc.a.create();ja&&(this.qih=ya);this.Wn.XXa(e,new iJ.a(9,C,S,ya,n))}}Szm(e,n){return this.Wn.hKa(n,9,C=>C.MO.intent.id===e)}Xqg(e,n){this.Wn.Bsd(C=>C.MO.intent.id===e,n,9)}NJf(){return Bb.a("isSharedUXDarkModeOn")?appChrome.api.isSharedUXDarkModeOn():!1}}Object(F.a)(fD,"AIFeedbackIntentManager",null,[]);class Jj{constructor(e){this.Doa=e}jD(){E.ULS.sendTraceTag(509380298,
2250,50,"AIFeedBack PaneClosed handleMessage");this.Doa.w6l()}}Object(F.a)(Jj,"AIFeedbackPaneClosedMessageHandler",null,[975]);class xH{constructor(e){this.Doa=e}jD(){E.ULS.sendTraceTag(508838287,2250,50,"AIFeedBack PaneOpened handleMessage");this.Doa.x6l()}}Object(F.a)(xH,"AIFeedbackPaneOpenedMessageHandler",null,[975]);class ZE{constructor(e){this.Doa=e}jD(e){E.ULS.sendTraceTag(508928006,2250,50,"AIFeedback report Feedback card in pane");this.Doa.mFo(e.Values.Payload)}}Object(F.a)(ZE,"AIFeedbackReportFeedbackCardHandler",
null,[975]);class ox{constructor(e){this.Doa=e}jD(e){E.ULS.sendTraceTag(509723598,2250,50,"AIFeedBack GenerateFeedbacks handleMessage");this.Doa.ZEf(e)}}Object(F.a)(ox,"AIGenerateFeedbacksMessageHandler",null,[975]);class HB{constructor(e){this.Doa=e}jD(e){E.ULS.sendTraceTag(509723597,2250,50,"AIFeedBack navigate feeedback handleMessage");this.Doa.lag(e)}}Object(F.a)(HB,"AINavigateFeedbackMessageHandler",null,[975]);class gD{constructor(e){this.Doa=e}jD(e){E.ULS.sendTraceTag(509723596,2250,50,"AIFeedBack rewrite feeedback handleMessage");
this.Doa.sug(e)}}Object(F.a)(gD,"AIRewriteFeedbackMessageHandler",null,[975]);var Uv=d(773),yH=d(370),Vu=d(2151),zH;(function(e){e.Beginner="Beginner";e.Expert="Expert"})(zH||(zH={}));var IB;(function(e){e.Advertisement="Advertisement";e.Blog="Blog";e.Contract="Contract";e.Essay="Essay";e.FAQ="FAQ";e.Letter="Letter";e.Memo="Memo";e.News="News";e.Poem="Poem";e.Proposal="Proposal";e.Report="Report";e.Resume="Resume";e.Story="Story";e.UserManual="User Manual"})(IB||(IB={}));var OJ;(function(e){e.Success=
"Success";e.BlockedByPostfilter="BlockedByPostfilter";e.BlockedByPrefilter="BlockedByPrefilter";e.UnexpectedError="UnexpectedError"})(OJ||(OJ={}));var PJ;(function(e){e.OK="OK";e.BlockedByContentSafety="BlockedByContentSafety";e.BlockedByFilter="BlockedByFilter";e.BlockedByLanguage="BlockedByLanguage";e.BlockedByNPlusFiltering="BlockedByNPlusFiltering";e.BlockedByPromptInjectionCheck="BlockedByPromptInjectionCheck";e.CopilotLicenseNotAvailable="CopilotLicenseNotAvailable";e.OutputTruncated="OutputTruncated";
e.Timeout="Timeout";e.Suppressed="Suppressed";e.UnexpectedError="UnexpectedError";e.UserInputTooSmall="UserInputTooSmall";e.UserInputTruncated="UserInputTruncated"})(PJ||(PJ={}));var Dt=d(2118),Hw=d(1969),Ur=d(2140),hA=d(1974),AH=d(771),Pp=d(49);class BH{constructor(e){this.critiqueSource=null;this.critiqueSource=e}}Object(F.a)(BH,"ContentGenerationAppSurveyData",null,[]);class hD{constructor(e){this.comment=null;this.comment=e}}Object(F.a)(hD,"ContentGenerationSurveyData",null,[]);var QJ=d(1419);
class Iw{constructor(e,n,C,S,ja){this.ZQa=ja;this.Re=e;this.W3b=n;this.sJ=C;this.ib=S;this.DJe=!1;this.aAh=""}rwe(e){this.DJe=e}yYo(e){this.aAh=e}initialize(){const e=Jp.a.im();e&&e.then(()=>{this.Re.ub(this,Dt.b.getTypeName());this.Re.ub(this,Dt.d.getTypeName())})}gH(e=null,n=null){E.ULS.sendTraceTag(509219727,2250,50,"AIFeedBack HandleAnnotationEvent");!e||e.annotationType!==Dt.b.getTypeName()&&e.annotationType!==Dt.d.getTypeName()?E.ULS.sendTraceTag(509219726,2250,15,"AIFeedBack HandleAnnotationEvent - unsupported annotation"):
n===Vh.a.getTypeName()?this.uUm(e):n===At.a.getTypeName()&&this.mVm(e)}uUm(e){this.ogk(e)?this.Kie(e.id,!1):this.Re.n5c(e,!1,"AugLoop_Core_DeleteOperation",!1)}mVm(e){this.U4j(e)}ogk(e){const n=this.kN(e);return n?0>Af.ParagraphReader.text(n).indexOf(e.content.originalText)?(E.ULS.sendTraceTag(509203465,2250,50,"AIFeedBack IsRangeAndContentValid: Text changed before we could apply highlight {0}",e.id),!1):!0:(E.ULS.sendTraceTag(509203468,2250,50,"AIFeedBack IsRangeAndContentValid: paragraphNode could not be retrieved using annotation with Id {0}",
e.id),!1)}kN(e){e=Jp.a.B9a(e.parentPath);return Jp.a.uQb(this.sJ.value,e)}dBm(e){let n=null;e.annotationType===Dt.b.getTypeName()?n=e.content:e.annotationType===Dt.d.getTypeName()?n=e.content:E.ULS.sendTraceTag(509219725,2250,50,"AIFeedBack navigateFeedback annotation are not navigational");return n}Hln(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackHighlightEnabled",!0)&&this.DJe?!0:!1}Kie(e,n){if(this.DJe&&this.Hln()){var C=this.Re.getAnnotationById(e);
if(!C)E.ULS.sendTraceTag(509219724,2250,50,"AIFeedBack navigateFeedback annotation could not be retrieved");else if(this.dBm(C)){var S=this.kN(C);if(S){var ja=Af.ParagraphReader.text(S),ya=C.content.originalText;ja=ja.indexOf(ya);0>ja?(E.ULS.sendTraceTag(508838286,2250,50,"AIFeedBack MarkFeedback: Text changed before we could apply highlight {0}",C.id),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)?this.ZQa.sendMessage(ei.a.Kud,
{payload:{annotationId:e,aZj:!0}}):this.Re.n5c(C,!1,"AugLoop_Core_DeleteOperation",!1)):(ya=ja+ya.length,this.W3b.Xqg(e,S),n&&this.ib.Kc(Uk.SelectionFactory.ue(S,ya)),this.W3b.iCa(S,C,ja,ya,n))}else E.ULS.sendTraceTag(509219723,2250,50,"AIFeedBack navigateFeedback paragraphNode could not be retrieved from tileId")}}}U4j(e){const n=this.kN(e);n?this.W3b.Xqg(e.id,n):E.ULS.sendTraceTag(509219721,2250,50,"AIFeedBack navigateFeedback paragraphNode could not be retrieved from tileId")}gvf(){this.Re.FZd(Dt.a.getTypeName());
this.Re.FZd(Dt.e.getTypeName());this.Re.FZd(Dt.d.getTypeName());this.Re.FZd(Dt.b.getTypeName())}k2h(){[Dt.d.getTypeName(),Dt.b.getTypeName()].forEach(async e=>{(await this.Re.getAnnotationsByType(e)).toArray().forEach(n=>{this.U4j(n)})})}ZCo(){[Dt.d.getTypeName(),Dt.b.getTypeName()].forEach(async e=>{(await this.Re.getAnnotationsByType(e)).toArray().forEach(n=>{this.Kie(n.id,!1)})})}}Object(F.a)(Iw,"AIFeedbackAnnotationHandler",null,[114]);var RJ=d(1032),$E;(function(e){e.ufk="EditorPane";e.sMp="AiInsert";
e.Ribbon="Ribbon"})($E||($E={}));Object(F.b)("Entrypoint",$E);class px{}Object(F.a)(px,"ContentGenerationFeatureStateChanged",null,[]);class Bn{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk,al){this.ga=e;this.A3a=n;this.Yc=C;this.ZQa=S;this.Jb=ja;this.wpa=ya;this.pn=kb;this.ru=Rb;this.Ujb=sc;this.vr=Fc;this.xe=gd;this.Bpa=td;this.ZEa=Bd;this.kda=wd;this.BGh=te;this.En=Le;this.Re=Oe;this.Jc=We;this.Qvd=Xf;this.W3b=Gg;this.sJ=Ph;this.ib=Aj;this.m4b=Ih;this.Rd=
Nm;this.Vh=Sk;this.yo=hk;this.vK=al;this.jOc=[];this.Ai=null;this.gkj=()=>{this.MPe=Date.now()};this.Ima=(Cj,Lg)=>{!Lg.isPaneOpen&&Bn.rce&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackSessionCachingEnabled",!1)?Bn.m9.k2h():Bn.m9.gvf(),Bn.m9.rwe(!1))};E.ULS.sendTraceTag(528762823,2250,100,"ctor");this.MPe=Date.now();this.wcf=0;this.N7b=!1;this.Un={["type"]:"CustomControlsProps",["id"]:"WritersUnblockV2Dialog",["onGenerateContent"]:this.KZn.bind(this),
["onAddToDocument"]:this.wVn.bind(this),["reportFeedback"]:this.xFo.bind(this),["openInputFeedback"]:this.o8o.bind(this,"WordEditorContentGenerationWritersUnblockSurveyCopilotBranded"),["isToneChoiceEnabled"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WritersUnblockToneChoiceEnabled",!0),["isModal"]:!0,["isBlocking"]:!1,["showDebugUI"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WritersUnblockDebugUI",!1)};this.wpa.execute(Cj=>{Cj.IPh(this.gkj)});
this.pn.C5a(this.Ima);Ac.a.instance.removeItem("summaryTuiInteractedByUser");Ac.a.instance.removeItem("writersUnblockTuiInteractedByUser");al.execute(Cj=>{Cj.isFeatureEnabled("Copilot",!1).then(Lg=>{Bn.dde=Lg;this.rdp();Bn.rce&&(Bn.m9=new Iw(Oe,this.W3b,this.sJ,this.ib,this.ZQa),Bn.m9.initialize())})})}static zXf(){return ka.a.wt||ka.a.fn||!!G.AFrameworkApplication.ua&&2===G.AFrameworkApplication.ua.mode}mFf(){return Object.assign(new xd.m,{parentPath:["Signal",hA.GenerateTextAbstractiveSummarySignal.getTypeName()],
items:[Object.assign(new wh.a,{body:new hA.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]})}static get WWf(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)||Bn.dde}static get U$c(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.ContentCreationSummaryEnabled",!1)&&G.AFrameworkApplication.J.$("WordEditorIdeasIsEnabled")&&this.zXf()}static get h1f(){return this.WWf&&
G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.ContentCreationWritersUnblockEnabled",!1)&&G.AFrameworkApplication.J.$("WordEditorIdeasIsEnabled")&&this.zXf()}static get rce(){return this.WWf&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1)&&G.AFrameworkApplication.J.$("WordEditorIdeasIsEnabled")&&this.zXf()}static get yen(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackStreamingEnabled",
!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.AiFeedbackStreaming",!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackOnDemandRewriteEnabled",!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.AiFeedbackUsePromptWithoutRewrite",!1)}static get T$c(){return this.WWf&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsSummarizationCopilotBranded",
!1)}dispose(){var e;E.ULS.sendTraceTag(528762824,2250,100,"disposed");null===(e=this.Ai)||void 0===e?void 0:e.dispose();for(this.Kep();0<this.jOc.length;)e=this.jOc.pop(),this.ga.Fy(e.actionId,e.contextId,e.handler);this.wpa.execute(n=>{n.pCo(this.gkj)});this.pn.Lkd(this.Ima)}Xb(){E.ULS.sendTraceTag(528762825,2250,100,"registering actions");0===this.jOc.length&&(this.jOc.push({actionId:ha.a.Ygg,contextId:Ma.a.view,handler:this.Zgg.bind(this)},{actionId:ha.a.i4d,contextId:Ma.a.view,handler:this.i4d.bind(this)}),
this.jOc.forEach(e=>{this.ga.qa(e.actionId,e.contextId,e.handler);this.ga.Pc(e.actionId,1028)}))}async Uji(){E.ULS.sendTraceTag(528762826,2250,100,"ensure annotation activation");this.O8g||(this.O8g=(async()=>{E.ULS.sendTraceTag(528762827,2250,50,"activating annotations");await Jp.a.im();const e=Uv.a.Nz();await Promise.all([e.activateAnnotation(Object.assign(new AH.a,{annotationType:Hw.WritersUnblockAnnotation.getTypeName(),handler:this.LZn.bind(this)})),e.activateAnnotation(Object.assign(new AH.a,
{annotationType:hA.TextAbstractiveSummaryAnnotation.getTypeName(),handler:this.SWb.bind(this)}))])})());return this.O8g}async KZn(e,n,C,S){E.ULS.sendTraceTag(528762828,2250,50,"requesting content generation");await this.Uji();this.wcf++;e=Object.assign(new Vh.a,{parentPath:["Signal",Hw.WritersUnblockRequest.getTypeName()],items:[Object.assign(new wh.a,{body:new Hw.WritersUnblockRequest({input:e+"\n"+n,outputLength:C||Hw.OutputLength.Medium,tone:S||Hw.DocumentTone.Neutral,contextId:this.wcf.toString()})})]});
Uv.a.Nz().submitOperation(Object.assign(new zz.a,{operation:e}))}async i4d(){E.ULS.sendTraceTag(528762829,2250,50,"requesting summary");await this.Uji();const e=this.mFf();Uv.a.Nz().submitOperation(Object.assign(new zz.a,{operation:e}));this.t9e=!0;this.$xb({summaryState:"Busy"});this.ga.Qb(ha.a.kdb,2,"ContentGenerationElementId-Summary");Bn.T$c?this.logFloodgateActivity("EditorContentGenerationSummarySurveyCopilotBranded"):this.logFloodgateActivity("EditorContentGenerationSummarySurvey")}wVn(e){E.ULS.sendTraceTag(528762830,
2250,50,"adding generated content");qH.a.tBg?this.LSi("WritersUnblock",e,2):this.KSi("WritersUnblock",e,2);this.N7b=!1;this.Ai.hide();this.Ai.d9("",this.Fec.bind(this),this.aob());this.Fec(1);this.logFloodgateActivity("EditorContentGenerationWritersUnblockSurveyCopilotBranded")}logFloodgateActivity(e){const n=this.vr;n&&n.execute(C=>{C.logActivity(e,null)})}o8o(e){const n=this.vr;n&&(this.N7b&&this.Jb.$b(new zg.a(2,1,0,()=>{this.Ai.hide();this.Fec(1)})),n.execute(C=>{C.meb(e,null)}))}Zgg(e,n,C,S,
ja){E.ULS.sendTraceTag(528762831,2250,50,"displaying dialog");if(!Object(RJ.c)(n))return 2;if(1===C)return Bn.h1f?32:8;if(2!==C)return 16;if(this.N7b)return 32;try{32===this.ga.Ob(ha.a.iZc,1)&&this.ga.Ob(ha.a.iZc,2),this.Ai=new Qh.a(!1,!1,!0),this.Ai.Bd=5,ja&&(this.Un.topic=ja.mBa?ja.mBa:void 0,this.Un.entryPoint=ja.entryPoint?ja.entryPoint:$E.ufk),this.Ai.Uh("",this.Fec.bind(this),this.aob()),this.N7b=!0}catch(ya){return 16}this.A3a.Jta(ha.a.Ygg,!0,void 0,void 0,void 0,void 0,[Object.assign(new kh.a,
{name:"ContentGenerationActor",string:"OpenWritersUnblockDialog command executed successfully."})]);return 32}Fec(){E.ULS.sendTraceTag(528762832,2250,50,"closing content generation dialog");this.N7b=!1;this.Un.content=void 0;this.Un.wXp=0;this.Un.HYp=void 0;this.Ai.d9("",this.Fec.bind(this),this.aob());this.ga.Qb(ha.a.kdb,2,"ContentGenerationElementId-WritersUnblock")}SWb(e){E.ULS.sendTraceTag(528762833,2250,100,"summary received");if(this.t9e){var n=e.items[0];if(!xd.b.typeGuard(e))if(Ur.b.typeGuard(n.body)||
hA.TextAbstractiveSummaryAnnotation.typeGuard(n.body)){this.t9e=void 0;const C=n.body;if("Success"!==C.status){E.ULS.sendTraceTag(528762835,2250,10,`Summary failed: ${C.status}, ${C.error}`);this.Jc.logActivity({name:"Summary_Failed"});switch(C.status){case "BlockedByPrefilter":this.$xb({summaryState:"BlockedByPrefilter"});break;case "BlockedByQualityCheck":case "BlockedByPostfilter":this.$xb({summaryState:"BlockedByQualityCheck"});break;default:this.$xb({summaryState:"DisabledDueToError"})}this.ga.Qb(ha.a.kdb,
2,"ContentGenerationElementId-Summary");this.nNd=Date.now()}else E.ULS.sendTraceTag(528762836,2250,50,"inserting summary"),this.Jb.$b(new zg.a(2,1,0,()=>this.ngp(C)))}else E.ULS.sendTraceTag(528762834,2250,10,`unexpected annotation: ${Pp.a.getTypeNameFor(n.body)}`),this.$xb({summaryState:"DisabledDueToError"}),this.nNd=Date.now(),this.ga.Qb(ha.a.kdb,2,"ContentGenerationElementId-Summary")}}ngp(e){e=e.summary.split("\n");qH.a.tBg?this.LSi("Summary",["Summary"].concat(e),0):this.KSi("Summary",["Summary"].concat(e),
0);this.s9e=Date.now();this.Jc.logActivity({name:"Summary_Inserted"});this.En.wcc((n,C)=>{C.actionId===ha.a.zUf&&(E.ULS.sendTraceTag(512311951,2250,50,"Summarization: Reject via undo."),this.Jc.logActivity({name:"Summarization_Reject_via_Undo"}),this.$xb({summaryState:"Reactivated"}))});this.Jb.$b(new zg.a(2,1,0,()=>this.X9o()));Kf.a.instance.cce();this.$xb({summaryState:"DisabledAfterInsertion"});this.ga.Qb(ha.a.kdb,2,"ContentGenerationElementId-Summary")}X9o(){if(!G.AFrameworkApplication.ua.Gb.z7(0)){let e;
e=new Jc.a("Summary inserted","Content generated by AI might contain inaccuracies or sensitive material. Be sure to verify information.",null);e.qdc=4;e.closeable=!0;G.AFrameworkApplication.ua.Gb.rya(e,!0)||E.ULS.sendTraceTag(512349278,306,10,"Failed to add entry to business bar. Summarization message bar could not be shown to user.")}}cPn(e){return e.contextId?e.contextId==this.wcf.toString():!0}LZn(e){E.ULS.sendTraceTag(528762837,2250,100,"generated content received");e=e.items[0].body;if(this.cPn(e)){var n=
[];switch(e.status){case Hw.Status.Success:n=e.tiles;var C=0;break;case Hw.Status.BlockedByPostfilter:case Hw.Status.BlockedByPrefilter:C=2;break;case Hw.Status.UnexpectedError:C=1}var S=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WritersUnblockDebugUI",!1);this.Un={...this.Un,["content"]:n.map(ja=>ja.content),["contentError"]:C,["showDebugUI"]:S,["debugMetadata"]:S?btoa(JSON.stringify({status:e.status,quality:e.statusDetails,sessionId:G.AFrameworkApplication.userSessionId,
R6:G.AFrameworkApplication.R6})):void 0};this.Ai.d9("",this.Fec.bind(this),this.aob())}}aob(){return{["hidden"]:!this.N7b,["bodyControls"]:this.Un,["uiLanguage"]:G.AFrameworkApplication.uiCulture,["id"]:"WritersUnblockV2Dialog"}}KSi(e,n,C){var S;E.ULS.sendTraceTag(528762838,2250,50,"inserting text ({0})",C);const ja=new pj.GraphTransaction(15);ja.Ph="Summary"===e?ha.a.zUf:ha.a.MSi;try{const ya=ib.StaticActiveAppFrame.za().kb.Qc.vd;let kb=ya,Rb;this.isDocumentEmpty()&&2===C&&(C=0);switch(C){case 0:case 1:for(Rb=
0===C?Tm.a.Bo(ya):yH.a.Bo(ya);Rb.moveNext();){const Bd=Rb.currentNode;if(Af.ParagraphReader.S$a(Bd)&&Af.ParagraphReader.Wb(Bd)&&!Af.ParagraphReader.EX(Bd)&&("Summary"!==e||"Title"!==this.xe.GQb(Bd)&&"Subtitle"!==this.xe.GQb(Bd))){kb=Bd;break}}break;case 2:kb=null!==(S=Af.ParagraphReader.GF(Kf.a.instance.gb.currentSelection.Qa.node,!0,!0))&&void 0!==S?S:kb}ja.Ab(kb);if("Summary"!==e&&this.X_i()){const Bd=Ed.a.eb(kb),wd=new Ed.a;wd.nd(Bd);wd.Nd();this.yo.me(wd);this.Vh.yy(wd,!1,!1);kb=this.Vh.dL(wd)}else n=
n.concat(["\n"]);const sc=ce.a.createTextRange(kb,0,0);this.Rd.We(sc,n.join("\n"),!0,!1);if("Summary"===e){const Bd=ce.a.createTextRange(sc.node,0,n.join("\n").length-1);setTimeout(()=>{this.Jb.$b(new zg.a(2,1,0,()=>this.BGh.u7o(Bd)))},1E3)}const Fc="Summary"===e||!this.X_i(),gd=Fc?sc.zj:0,td=Fc?n.join("\n").length-1:n.join("\n").length;this.kda.iCa(sc.node,gd,td,!0)}finally{ja.dispose()}}LSi(e,n,C){var S;E.ULS.sendTraceTag(509155358,2250,50,"inserting text ({0})",C);const ja=new pj.GraphTransaction(15);
ja.Ph="Summary"===e?ha.a.zUf:ha.a.MSi;try{const ya=ib.StaticActiveAppFrame.za().kb.Qc.vd;let kb=ya,Rb;this.isDocumentEmpty()&&2===C&&(C=0);switch(C){case 0:case 1:for(Rb=0===C?Tm.a.Bo(ya):yH.a.Bo(ya);Rb.moveNext();){const gd=Rb.currentNode;if(Af.ParagraphReader.S$a(gd)&&Af.ParagraphReader.Wb(gd)&&!Af.ParagraphReader.EX(gd)&&("Summary"!==e||"Title"!==this.xe.GQb(gd)&&"Subtitle"!==this.xe.GQb(gd))){kb=gd;break}}break;case 2:kb=null!==(S=Af.ParagraphReader.GF(Kf.a.instance.gb.currentSelection.Qa.node,
!0,!0))&&void 0!==S?S:kb}ja.Ab(kb);const sc=this.Yc.qF(n,kb,0===C).toArray().slice(0,n.length),Fc=new fb.a;for(const gd of sc)Fc.add(gd);"Summary"===e?(this.kdm(sc),setTimeout(()=>{this.Jb.$b(new zg.a(2,1,0,()=>this.BGh.iVn(sc,Fc)))},1E3)):"WritersUnblock"===e&&this.ndm(sc)}finally{ja.dispose()}}kdm(e){this.Ujb.Uja(e[0].node,4);for(const n of e.slice(1))this.Ujb.Uja(n.node,13);for(const n of e)this.kda.iCa(n.node,n.zj,n.Po)}ndm(e){for(const n of e)this.Ujb.Uja(n.node,13);for(const n of e)this.kda.iCa(n.node,
n.zj,n.Po)}Ool(){E.ULS.sendTraceTag(528762839,2250,100,"checking document state");if(this.pn.isPaneOpen){const e={};this.t9e?e.summaryState="Busy":300>this.t9d()?e.summaryState="DisabledDueToLength":this.s9e?this.MPe>this.s9e&&(e.summaryState="Reactivated",this.s9e=void 0):this.nNd?this.MPe>this.nNd&&(e.summaryState="Reactivated",this.nNd=void 0):e.summaryState="Ready";this.$xb(e)}}isDocumentEmpty(){return 0===this.t9d()}$xb(e){this.ZQa.sendMessage(ei.a.V6h,e)}Kep(){this.Ozd&&(this.Jb.wf(this.Ozd),
this.Ozd=void 0)}rdp(){!Bn.U$c&&!Bn.h1f||this.Ozd||this.Jb.$b(this.Ozd=new zg.a(3,2,3333,()=>this.Ool()))}t9d(){return this.ru.EA}xFo(e){const n=new BH("Writer's Unblock"),C=e.payload.comment.slice(0,4);this.Bpa.Gha(JSON.stringify(n),JSON.stringify(new hD(C)),"01b65630-d949-4b8c-9b12-dc0414a90898",pH.b);e.option===QJ.a.KOb&&this.ZEa.W0b(e.payload.comment[2],e.payload.comment[3],{start:0,length:e.payload.comment[3].length},"Writer's Unblock",!0)}mFo(e){const n=new BH("AI Feedback Card"),C=e.payload.comment.slice(0,
4);this.Bpa.Gha(JSON.stringify(n),JSON.stringify(new hD(C)),"1a762bc9-d52c-41ab-9104-fd73ad49d108",pH.b);e.option===QJ.a.KOb&&this.ZEa.W0b(e.payload.comment[2],e.payload.comment[3],{start:0,length:e.payload.comment[3].length},"AI Feedback Card",!0)}sLj(e,n,C){this.ZQa.sendMessage(ei.a.Kud,{payload:{annotationId:e,Fbc:n,aZj:C}})}async ZEf(e){E.ULS.sendTraceTag(509723595,2250,50,"AIFeedBack generateFeedbacks");this.m4b&&this.m4b.execute(C=>{C.sJa=!1});Bn.m9.rwe(!0);Bn.m9.gvf();var n=e.Values.Payload.documentType;
e=e.Values.Payload.targetAudience;n=Object.assign(new Vh.a,{parentPath:["Signal",Vu.a.getTypeName()],items:[Object.assign(new wh.a,{body:new Vu.a({documentType:IB[n],targetAudience:zH[e]})})]});await augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new zz.a,{operation:n}));E.ULS.sendTraceTag(509723594,2250,50,"AIFeedBack FeedbackRequest signal submitted")}async lag(e){E.ULS.sendTraceTag(509723593,2250,50,"AIFeedBack navigateFeedback");this.Qvd&&this.Qvd.execute(n=>
{n.dismiss()});e=e.Values.Payload.annotationId;Bn.m9.Kie(Bn.m9.aAh,!1);Bn.m9.Kie(e,!0);Bn.m9.yYo(e)}async sug(e){E.ULS.sendTraceTag(509723592,2250,50,"AIFeedBack rewriteFeedback");const n=e.Values.Payload;if(e=n.annotationId){var C=this.Re.getAnnotationById(e);if(C)if(C.annotationType!==Dt.d.getTypeName()&&C.annotationType!==Dt.b.getTypeName())E.ULS.sendTraceTag(509195930,2250,50,"AIFeedBackRewrite received incorrect annotation, expected rewriteAnnotation");else{var S=Bn.m9.kN(C);if(S)if((e=this.W3b.Szm(e,
S))&&0!==e.count){e=e.K(0);var ja=e.Dc,ya=e.end;this.Qvd&&this.Qvd.execute(kb=>{Bn.yen?kb.lUi(C,ja,ya,n.Fbc,this.sLj.bind(this)):kb.invoke(C,ja,ya,n.Fbc,this.sLj.bind(this))})}else E.ULS.sendTraceTag(509195928,2250,50,"AIFeedBackRewrite no existing Intent range found for rewrite annotation");else E.ULS.sendTraceTag(509195929,2250,50,"AIFeedBackRewrite paragraphNode could not be retrieved for rewrite annotation")}else E.ULS.sendTraceTag(509195931,2250,50,"AIFeedBackRewrite annotation could not be retrieved with Id: {0}",
e)}else E.ULS.sendTraceTag(509195932,2250,50,"AIFeedBackRewrite received empty or null annotationId from AIFeedbackPane")}async w6l(){E.ULS.sendTraceTag(509380297,2250,50,"AIFeedBack feedbackPaneClosed");G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackSessionCachingEnabled",!1)?Bn.m9.k2h():Bn.m9.gvf();Bn.m9.rwe(!1);this.m4b&&this.m4b.execute(e=>{e.sJa=!0})}async x6l(){E.ULS.sendTraceTag(508838285,2250,50,"AIFeedBack feedbackPaneOpened");Bn.m9.rwe(!0);
this.m4b&&this.m4b.execute(e=>{e.sJa=!1});Bn.m9.ZCo()}X_i(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphInsertion",!0)}}Bn.dde=!1;Object(F.a)(Bn,"ContentGenerationActor",null,[10]);var CH=d(1498);class iA extends CH.a{constructor(e){super(e,"ContentGeneration")}}Object(F.a)(iA,"ContentGenerationTelemetryLoggerImpl",CH.a,[]);class DH{constructor(e){this.Doa=e}jD(){E.ULS.sendTraceTag(538183240,2250,50,"TriggerSummarization message received");
this.Doa.i4d()}}Object(F.a)(DH,"SummarizationMessageHandler",null,[975]);class EH{constructor(e){this.ga=e}jD(){E.ULS.sendTraceTag(537450209,2250,50,"OpenWritersUnblockDialog message received");this.ga.Ob(ha.a.Ygg,2)}}Object(F.a)(EH,"WritersUnblockMessageHandler",null,[975]);class FH{constructor(e){this.$P=e}f7o(e){let n="";switch(e){case vh.DocumentTypeLabel.ArticlesAndReports:n="EditorContextualMessagingArticle";break;case vh.DocumentTypeLabel.ContractsAndPolicies:n="EditorContextualMessagingContract";
break;case vh.DocumentTypeLabel.DocumentsDesignedForPrinting:n="EditorContextualMessagingDocument";break;case vh.DocumentTypeLabel.Forms:n="EditorContextualMessagingForm";break;case vh.DocumentTypeLabel.JobDescription:n="EditorContextualMessagingJobDescription";break;case vh.DocumentTypeLabel.Letters:n="EditorContextualMessagingLetter";break;case vh.DocumentTypeLabel.ListsAndNotes:n="EditorContextualMessagingList";break;case vh.DocumentTypeLabel.ManualsAndGuidelines:n="EditorContextualMessagingManual";
break;case vh.DocumentTypeLabel.Resumes:n="EditorContextualMessagingCV";break;default:Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.UnsupportedDocumentType"}));return}null!=this.$P&&(Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.IrisCalloutTriggered"})),this.$P.execute(C=>C.logActivity(n,null)))}}Object(F.a)(FH,"ContextualMessagingHandler",null,[992]);class SJ{constructor(){this.VEh=!1}initialize(){}Dca(){return this.VEh}v0(e){0===
e&&(this.VEh=!0)}}Object(F.a)(SJ,"ContextualMessagingSuppressionModel",null,[971]);class GH{constructor(e,n,C,S){this.qch=e;this.pch=n;this.j6b=C;this.bsk=S;this.Ngh=!1;this.C2j=(ja,ya)=>{ya?ya.wha&&(this.pch.v0(0,new Date),this.fgp()):E.ULS.shipAssertTag(541877534,2250,!1)};this.Ovb=(ja,ya)=>{ya.data.operationType!==xd.a.getTypeName()?E.ULS.shipAssertTag(541877535,2250,!1):ya.data.annotation?ya.data.annotation.annotationType!==vh.DocumentTypeClassifierAnnotation.getTypeName()?E.ULS.shipAssertTag(541877537,
2250,!1):(ja=ya.data.annotation.content)?ja.documentTypeConfidences.length?(ja=ja.documentTypeConfidences,.7<=ja[0].confidence&&this.bsk.f7o(ja[0].documentTypeLabel),Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.DocumentTypeReceivedFromClassifier",dataFields:[Object.assign(new kh.a,{name:"FirstConfidence",double:ja[0].confidence}),Object.assign(new kh.a,{name:"SecondConfidence",double:1<ja.length?ja[1].confidence:0})]})),this.j6b.unregister()):
E.ULS.shipAssertTag(541877539,2250,!1):E.ULS.shipAssertTag(541877538,2250,!1):E.ULS.shipAssertTag(541877536,2250,!1)}}initialize(){this.pch.initialize();this.qch.forEach(e=>{e.vqa(this.C2j);e.initialize()})}Wd(){this.qch.forEach(e=>{e.rDa(this.C2j);e.Wd()})}fgp(){this.j6b.QH(this.Ovb);this.j6b.register();this.Ngh||(Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.DocumentTypeClassifierTriggered"})),this.j6b.Rza(new Hz.a),this.Ngh=!0)}}Object(F.a)(GH,
"ContextualMessagingTriggerManager",null,[991,506]);class Wy extends Nn.a{constructor(e,n,C,S){super(e,n,C,2250,"OnTriggerContextualMessaging");this.Qqh=!1;this.R6m(S)}async R6m(e){const n=G.AFrameworkApplication.J.$("IsO365ConsumerHost");this.Qqh=(await e.JUb).nad&&n}BDa(e=!0){this.Qqh&&!this.bqa.Dca()&&super.BDa(e)}}Object(F.a)(Wy,"ContextualMessagingSequentialTriggerModel",Nn.a,[]);class Vv{constructor(e,n,C){this.rFc=e;this.qd=n;this.JMk=C}jD(e){E.ULS.sendTraceTag(41682307,2250,50,"Handling CritiqueUpsell message.");
var n=e.Values.Payload;this.aPa(n)&&((e=this.JMk.WOn(n.locale,n.critiqueTypeValues))&&e.tRf?void 0!==n.idsOfUpsellCritiqueAnnotations&&null!==n.idsOfUpsellCritiqueAnnotations?(e=this.rFc.NEm(n.idsOfUpsellCritiqueAnnotations),e.length?this.rFc.ZKa(e):E.ULS.sendTraceTag(41682310,2250,15,"No paragraph nodes found based on the given annotation IDs.")):void 0!==n.idsOfParagraphsWithUpsellCritiques&&null!==n.idsOfParagraphsWithUpsellCritiques?(n=this.Vrm(n.idsOfParagraphsWithUpsellCritiques),n=this.rFc.OEm(n),
n.length?(this.rFc.ZKa(n),e.WWh&&this.qd.tha(ib.StaticActiveAppFrame.za().kb.Gw,new Lf.Selection([ce.a.Uc(this.rFc.R8l(n),0)],!1))):E.ULS.sendTraceTag(41682311,2250,15,"No paragraph nodes found based on the given paragraph IDs.")):E.ULS.sendTraceTag(41682312,2250,10,"Critique Upsell payload can't have both paragraph and annotation IDs undefined."):E.ULS.sendTraceTag(41682309,2250,15,"No critique type upsell settings changed"))}Vrm(e){const n=[];for(const C of e)try{n.push(Wc.a.Bf(C))}catch(S){E.ULS.sendTraceTag(41682313,
2250,15,"Malformed ExtendedGuid string.")}return n}aPa(e){return e&&e.locale&&e.critiqueTypeValues&&(e.idsOfParagraphsWithUpsellCritiques||e.idsOfUpsellCritiqueAnnotations)?!0:(E.ULS.sendTraceTag(41682314,2250,10,"Malformed CritiqueTypeUpsellPayload"),!1)}}Object(F.a)(Vv,"CritiqueUpsellMessageHandler",null,[975]);var dy=d(342);class jA{constructor(e,n,C,S,ja,ya){this.Re=e;this.Rc=n;this.IH=C;this.F3e=S;this.gSa=ja;this.Gvk=ya}R8l(e){if(1!==e.length){const n=Date.now(),C=this.F3e(ib.StaticActiveAppFrame.za().kb.Qc.vd);
for(;Date.now()-n<this.Gvk&&C.moveNext();)if(Af.ParagraphReader.Fh(C.iterator))for(const S of e)if(C.iterator===S)return S;E.ULS.sendTraceTag(41682316,2250,50,"First paragraph not found in time, reverting to arbitrary choice.")}return e[0]}NEm(e){const n=[];for(const C of e)(e=this.Re.FXa(C))?(e=e.parent,this.fak(e)&&n.push(e)):E.ULS.sendTraceTag(41682318,2250,15,"Couldn't find the annotation object for the given annotation ID.");return n}OEm(e){const n=[];for(const C of e)e=this.IH.Eb(C),this.fak(e)&&
n.push(e);return n}ZKa(e){const n=this.Rc.Lc(2);try{n.set(e[0].Fk);for(const C of e)this.gSa.ZKa(C);this.gSa.UQd(()=>{for(const C of e)E.ULS.sendTraceTag(50434703,324,50,String.format("Paragraphnode {0} is proofed. Proofing completed task will be set to true",C.$k)),C.Zhd=new dy.a,C.Zhd.vV(!0)})}finally{n&&n.dispose()}}fak(e){return e&&Af.ParagraphReader.Wb(e)?!0:(E.ULS.sendTraceTag(41682321,2250,15,"Node undefined or not a paragraph node."),!1)}}Object(F.a)(jA,"CritiqueUpsellParagraphNodeHelpers",
null,[989]);class sL{constructor(){this.WWh=this.tRf=!1}}Object(F.a)(sL,"SessionUpsellSettingsModificationResult",null,[]);class ey{constructor(e){this.mhb=e}WOn(e,n){var C=ac.a.Eg(e);if(!C)return E.ULS.sendTraceTag(41682324,2250,10,"Malformed locale string."),null;e=new sL;C=C.LCID.toString();const S=this.mhb.kxg;let ja=S[C];ja||(ja={},S[C]=ja);for(const ya of n)ya.Id&&null!==ya.Value?ya.Id in ja&&ja[ya.Id]===ya.Value||(ja[ya.Id]=ya.Value,e.tRf=!0,1===parseInt(ya.Value)&&(e.WWh=!0)):E.ULS.sendTraceTag(41682325,
2250,10,"Malformed CritiqueTypeOption.");e.tRf&&(this.mhb.kxg=S);return e}}Object(F.a)(ey,"SessionUpsellSettingsModifier",null,[990]);class JB{jD(){G.AFrameworkApplication.va.Ob(pe.a.kwb,2)}}Object(F.a)(JB,"EditorSettingsDialogHandler",null,[975]);class vu{}vu.qje=100;vu.Dyf="OnEditorScoreChanged";vu.Fyf="OnEditorSkittleVisibilityChanged";vu.dGe="onWordCountChanged";vu.w7f=1;Object(F.a)(vu,"EditorScoreConstants",null,[]);var TJ=d(1607);class lr{}lr.acronyms="Acronyms";lr.nVc="Clarity";lr.kWc="Conciseness";
lr.formality="Formality";lr.b5c="Grammar";lr.c7c="Inclusiveness";lr.perspectives="Perspectives";lr.Jko="Punctuation Conventions";lr.resume="Resume";lr.gRo="Sensitive Geopolitical References";lr.teb="Spelling";lr.Wtd="Vocabulary";Object(F.a)(lr,"CritiqueCategory",null,[]);class UJ{constructor(e,n){this.percentage=e;this.Vbg=n}}Object(F.a)(UJ,"EditorScore",null,[]);class VJ{constructor(){this.dPf=this.wordCount=this.Wtd=this.vFf=this.fYb=this.perspectives=this.c7c=this.formality=this.kWc=this.nVc=this.acronyms=
this.b5c=this.teb=0}}Object(F.a)(VJ,"EditorScoreArgs",null,[]);class HH{sVa(e,n,C,S=!1){e=Object.assign(new VJ,{nVc:this.hVa(lr.nVc,e),kWc:this.hVa(lr.kWc,e),formality:this.hVa(lr.formality,e),vFf:this.hVa(lr.gRo,e),b5c:this.hVa(lr.b5c,e),c7c:this.hVa(lr.c7c,e),perspectives:this.hVa(lr.perspectives,e),fYb:this.hVa(lr.Jko,e),teb:this.hVa(lr.teb,e),Wtd:this.hVa(lr.Wtd,e),wordCount:C,dPf:n});return this.Ujl(e,S)}hVa(e,n){({value:e}=n.Ec(e,0));return e}Ujl(e,n=!1){if(e.wordCount<vu.qje&&!n)return null;
n=100*(2*e.teb+1*e.b5c+(e.dPf?1===e.dPf?2:1:4)*(.25*(e.nVc+e.formality+e.c7c+e.fYb+e.Wtd)+.2*(e.kWc+e.perspectives+e.vFf)))/e.wordCount;return new UJ(40>=n?Math.floor(105/Math.pow(2,n/10)-5):0,e.teb+e.b5c+e.nVc+e.kWc+e.formality+e.c7c+e.perspectives+e.fYb+e.vFf+e.Wtd)}}Object(F.a)(HH,"EditorScoreCalculator",null,[]);class iD extends Sys.EventArgs{constructor(e,n=!1){super();this.score=e;this.isThinking=n}}Object(F.a)(iD,"EditorScoreChangedEventArg",Sys.EventArgs,[]);var aF=d(2184);class ss{v_i(){var e;
return 1<=(null===(e=this.G$b.sVa(this.$Pa,this.qEb,this.A$.EA,!0))||void 0===e?void 0:e.Vbg)}BIg(){if(this.v_i()){const e=gc.a.instance.Ta("Common.ISystemInitiatedFeedback");e&&e.execute(n=>{n.logActivity(ss.gsp,null)})}}constructor(e,n,C,S,ja,ya){var kb;this.Re=e;this.IY=n;this.A$=C;this.Z5=S;this.sa=ja;this.hqk=ya;this.G$b=new HH;this.$Pa=new fd.a;this.qEb=0;this.O1=!1;this.Bga=()=>{this.tse(new iD(this.G$b.sVa(this.$Pa,this.qEb,this.A$.EA)))};this.x5c=(Rb,sc,Fc)=>{sc!=Fc&&this.tse(new iD(this.G$b.sVa(this.$Pa,
this.qEb,this.A$.EA),1==Fc))};G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)?this.a8g=[]:this.a8g=[Rv.a.getTypeName()];this.Iia=[Rv.a.getTypeName(),TJ.a.getTypeName()];(null===(kb=G.AFrameworkApplication.J)||void 0===kb?0:kb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1))&&aF.a.i0k(this.BIg.bind(this))}initialize(){this.A$.Xef(this.Bga);return this.ME()}Wd(){this.A$.xrg(this.Bga);return this.zY()}ME(){if(!this.O1)return this.Z5.im().then(()=>
{for(const e of this.Iia)-1<this.a8g.indexOf(e)&&this.activateAnnotation(e),this.Re.ub(this,e),this.bkg(e),this.Dne(e,!0);this.O1=!0}).catch(e=>{E.ULS.sendTraceTag(561534340,2250,10,"Unable to register skittle annotation handlers.",e)})}zY(){if(this.O1)return this.Z5.im().then(()=>{for(const e of this.Iia)this.Re.xc(this,e),this.Dne(e,!1);this.O1=!1}).catch(e=>{E.ULS.sendTraceTag(555810840,2250,10,"Unable to unregister skittle annotation handlers.",e)})}activateAnnotation(e){this.IY.getAugLoopRuntimeManager().activateAnnotation({annotationType:e,
handler:n=>{var C;if(0<(null===(C=null===n||void 0===n?void 0:n.items)||void 0===C?void 0:C.length)){for(const S of n.items)n=S.body,Yx.a.getTypeNameFor(n)===e&&this.tUm(n);this.tse(new iD(this.G$b.sVa(this.$Pa,this.qEb,this.A$.EA)))}}})}bkg(e){this.Z5.im().then(()=>{this.Re.getAnnotationsByType(e).then(n=>{for(const C of n)this.Drb(C)})})}tUm(e){Yx.a.getTypeNameFor(e)===Rv.a.getTypeName()&&this.zLi(e)}Drb(e){e?(e.annotationType===Rv.a.getTypeName()&&this.zLi(e.content),e.annotationType===TJ.a.getTypeName()&&
(this.qEb=e.content.critiqueConfiguration.formalityGoal),this.tse(new iD(this.G$b.sVa(this.$Pa,this.qEb,this.A$.EA)))):E.ULS.sendTraceTag(561534341,2250,15,"Annotation is null.")}zLi(e){if(e){var n=this.hqk.X0j(e.categoryName);this.$Pa.W(n,e.count)}else E.ULS.sendTraceTag(554567616,2250,15,"CritiqueCategoryCountAnnotation is null.")}Dne(e,n){n?this.Re.qMh(this.x5c,e):this.Re.CBj(this.x5c,e)}tse(e){this.iFk=e;this.Q9g||(this.Q9g=setTimeout(()=>{this.sa.raiseEvent(vu.Dyf,this.iFk);this.Q9g=null},ss.pkk))}gH(e,
n){!this.O1||n!==Vh.a.getTypeName()&&n!==CC.a.getTypeName()||(e&&e.content?this.Drb(e):E.ULS.sendTraceTag(545527900,2250,10,"Handled annotation is invalid"))}Yef(e){this.sa.addHandler(vu.Dyf,e)}NBo(e){this.sa.removeHandler(vu.Dyf,e)}sVa(){return this.G$b.sVa(this.$Pa,this.qEb,this.A$.EA)}}ss.gsp="PostShareDialogClosedEditorSuggestion";ss.pkk=1E3;Object(F.a)(ss,"EditorScoreHandler",null,[988,114,506]);var kA=d(1036);class KB extends Sys.EventArgs{constructor(e){super();this.isVisible=e}}Object(F.a)(KB,
"EditorSkittleVisibilityChangedEventArg",Sys.EventArgs,[]);class IH{constructor(e,n,C){this.ga=e;this.yDb=n;this.hac=C;this.sa=new eb.a;this.$kb=this.ey=!1;this.zgc=(S,ja,ya=!1)=>{this.lrg();S?this.hac.hide():(this.hac.dispose(),this.$kb=!1,E.ULS.sendTraceTag(558400652,2250,50,"Skittle closed"));ja&&(ya?this.lPk():this.D9e(),E.ULS.sendTraceTag(543504209,2250,50,`Skittle suppressed. Forever: ${ya}`));this.ey=!1;this.Jxj(new KB(!1))};this.tii=(S,ja)=>{this.$kb&&((S=ja.score)?this.Vte(S,ja.isThinking,
!0):this.hac.hide())};this.onClick=()=>{this.ga.Ob(ha.a.LBg,2)};this.onClose=()=>{this.zgc(!1,!0)};this.onClosePermanently=()=>{this.zgc(!1,!0,!0)}}initialize(){this.yDb.Yef(this.tii)}Wd(){this.yDb.NBo(this.tii)}get isVisible(){return this.ey}XOh(e){this.sa.addHandler(vu.Fyf,e)}OBo(e){this.sa.removeHandler(vu.Fyf,e)}showSkittle(e,n){this.D9e=e;this.lPk=n;e=this.yDb.sVa();this.$kb?this.hac.show():(this.Vte(e,!1),this.$kb=!0);this.zef();this.ey=!0;this.Jxj(new KB(!0))}Jxj(e){this.sa.raiseEvent(vu.Fyf,
e)}zef(){var e=pd.a.instance;const n=ae.FocusManager.instance();e.I$(wq.a.qeb);e=n.ie(wq.a.qeb);const C=document.getElementById("ProgressCardWrapper"),S=new Jr.DOMFocusListing(()=>C);S.Uga=!0;S.rn(8);S.rn(2);n.Qmb(C,e,S).rP=!0}lrg(){const e=pd.a.instance,n=ae.FocusManager.instance();n.currentScope.name===wq.a.qeb&&n.Gg(kA.a.Do);e.Dx(wq.a.qeb)}Vte(e,n,C=!1){e?(e={documentScore:e.percentage,critiqueNumber:e.Vbg,isThinking:n,onClick:this.onClick,onClose:this.onClose,onClosePermanently:this.onClosePermanently},
C?this.hac.update(e):this.hac.render(e)):E.ULS.sendTraceTag(558400653,2250,10,"Score cannot be null.")}}Object(F.a)(IH,"EditorSkittleComponent",null,[987,506]);class JH{constructor(e,n,C){this.Tfh=e;this.HIb=n;this.iac=C;this.onClose=()=>this.iac.v0(5,new Date);this.onClosePermanently=()=>this.iac.v0(6,new Date);this.rsd=(S,ja)=>{ja?ja.wha?this.kBg&&this.Tfh.showSkittle(this.onClose,this.onClosePermanently):this.Tfh.zgc(7!==ja.id,!1):E.ULS.shipAssertTag(561071444,2250,!1)}}initialize(){this.iac.initialize();
this.HIb.forEach(e=>{e.vqa(this.rsd);e.initialize()})}Wd(){this.HIb.forEach(e=>{e.rDa(this.rsd);e.Wd()})}get kBg(){return this.HIb.every(e=>e.Ggf())}}Object(F.a)(JH,"EditorSkittleTriggerManager",null,[906,506]);class Qp extends Nn.a{constructor(e,n,C){super(e,n,C,2250,"OnTriggerSkittle")}BDa(e=!0){this.bqa.Dca()||super.BDa(e)}}Object(F.a)(Qp,"SkittleSequentialTriggerModel",Nn.a,[]);class KH{constructor(e,n){this.rOk=n;this.Jch=0;this.IEk=e}initialize(){}Dca(){return this.Jch>=this.IEk?(E.ULS.sendTraceTag(558401298,
2250,50,"Trigger launch was suppressed. Reason: Reached max skittle closed this session."),!0):!1}v0(e){switch(e){case 5:this.o4n();break;case 6:this.p4n()}}p4n(){var e,n;null===(n=null===(e=this.rOk)||void 0===e?void 0:e.Jgp)||void 0===n?void 0:n.call(e);this.rna("UserClosedSkittlePermanently")}o4n(){this.Jch++;this.rna("UserClosedSkittle")}rna(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas."+e}))}}Object(F.a)(KH,"SkittleSuppressionModel",null,[971]);class fy{constructor(){this.actionText=
this.labelText=null}}Object(F.a)(fy,"AddOnFooterData",null,[]);class bF{constructor(e){this.pn=e}Ggm(e){if(!(this.pn.ETb||1!==e&&2!==e&&3!==e||this.pn.isPaneOpen)){if(G.AFrameworkApplication.J.$("GoPremiumInContextualCardIsEnabled"))return Object.assign(new fy,{labelText:WordEditorIntl.WordEditorStrings.L_ContextualCardEditorUpsellGoPremiumLabelText,actionText:WordEditorIntl.WordEditorStrings.L_ContextualCardEditorUpsellGoPremiumActionText});if(G.AFrameworkApplication.J.$("OpenEditorPaneFromContextualCardIsEnabled"))return Object.assign(new fy,
{labelText:WordEditorIntl.WordEditorStrings.L_ContextualCardOpenEditorLabelText,actionText:WordEditorIntl.WordEditorStrings.L_ContextualCardOpenEditorActionText})}return null}lgm(e){return e===WordEditorIntl.WordEditorStrings.L_ContextualCardEditorUpsellGoPremiumActionText?(e=ha.a.N5i,{returnValue:!0,actionId:e}):e===WordEditorIntl.WordEditorStrings.L_ContextualCardOpenEditorActionText?(e=ha.a.z_a,{returnValue:!0,actionId:e}):{returnValue:!1,actionId:0}}}Object(F.a)(bF,"EditorUpsellExperiment",null,
[986]);class LH{constructor(){this.acceptedSimilarityCitations=this.acceptedTextPredictions=this.acceptedRefinements=this.acceptedSpellingAndGrammar=this.autoCorrectedErrors=0}}Object(F.a)(LH,"EditorUsageMetrics",null,[]);class ts{constructor(e,n,C,S){this.O5=e;this.pJk=n;this.dSa=C;this.Sg=S;this.Yil=3E5;this.Uyd=new Map;this.a2n=(ja,ya)=>{ja=1==ya.Gl.state;!this.o9e&&ja&&(this.O5.KPh(this.Xfg),this.x9m());this.o9e&&!ja&&this.O5.uCo(this.Xfg);this.o9e=ja};this.Xfg=(ja,ya)=>{this.eJk||4!==ya.d7c||
(this.Sg.sendTraceTag(557060744,2250,50,"Starting polling for sending metrics"),this.eJk=!0,this.ALj())};this.x9m=()=>{const ja=this.O5.rGi();if(null===ja)this.Sg.sendTraceTag(556323489,2250,15,"Session summary is null!");else{var ya=ja.toArray().find(kb=>4==kb.aQ);ya&&Bm.dhc.forEach(kb=>{var Rb;this.Uyd.set(kb,null!==(Rb=ya.values[kb])&&void 0!==Rb?Rb:0)})}};this.ALj=()=>{this.Sg.sendTraceTag(557060745,2250,50,"Starting metric diff sending");if(this.cTj()){var ja=this.O5.rGi();if(null!==ja){var ya=
ja.toArray().find(Rb=>4==Rb.aQ),kb=new Map;Bm.dhc.forEach(Rb=>{this.tXo(kb,ya,Rb)});Array.from(kb.keys()).some(Rb=>0<kb.get(Rb))&&this.pJk.aSo(kb)}setTimeout(this.ALj,this.Yil)}};this.tXo=(ja,ya,kb)=>{ya&&ya.values[kb]&&(ja.set(kb,ya.values[kb]-this.Uyd.get(kb)),this.Uyd.set(kb,ya.values[kb]))}}initialize(){this.dSa.wKb(this.a2n);this.Uyd=new Map([["E_Spelling_Grammar",0],["E_Refinements",0],["E_TextPrediction",0],["E_AutoCorrect",0],["E_Similarity",0]]);this.cTj()&&(this.o9e=!0,this.O5.KPh(this.Xfg))}cTj(){return 1==
this.dSa.Gl.state}}Object(F.a)(ts,"ExpiryCardMetricAggregator",null,[]);class tL{constructor(e,n,C){this.$nl=(S,ja,ya,kb,Rb)=>{S={data:Rb};this.pn.Wsa&&this.Oo.sendMessage(ei.a.PXb,S);return 32};this.Oo=e;this.pn=n;C.fb(ha.a.PXb,Ma.a.view,this.$nl,96)}}Object(F.a)(tL,"PremiumPreviewStateChangedMessageSender",null,[]);class WJ{constructor(e){this.oJk=e}jD(e){var n;let C=1;if(null===(n=null===e||void 0===e?void 0:e.Values)||void 0===n?0:n.Payload)C=e.Values.Payload;this.oJk.start(C)}}Object(F.a)(WJ,
"TryPremiumPreviewMessageHandler",null,[975]);class XJ{constructor(e){this.lEk=e}Yab(e){if(this.lEk.O5f){var n=console,C=n.log;e=e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e);C.call(n,e)}}}d(2150);(function(){function e(n){this.value=n;this.LRn=0}e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.LRn))};return e})();const Xy=(e=!0)=>({s8p:"ESDK",tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"mockAriaTenantToken",nexusTenantToken:1733},
JYp:"Diagnostic",O5f:!0,t8p:e});class uL{constructor(e=!1){this.$9j=e;this.bch=new XJ(Xy())}DI(e,n,C,S){this.$9j&&this.bch.Yab({message:`${C}.${n}`,data:S})}w$i(e,n,C){this.$9j&&this.bch.Yab({i7p:`${`KPIs.${e}`}.${n}`,engagement:C,data:void 0})}}const Jw=new uL;var Wv;(function(e){e.Host="Host";e.jPa="Authentication";e.kOp="ExceptionHandling";e.Navigation="Navigation";e.oSp="UiRendering";e.S0a="FeatureSuppression";e.iMp="Acronyms";e.EMp="AtAGlance";e.QMp="BxPromo";e.ContentCreation="ContentCreation";
e.vNp="CritiqueUpsell";e.fTp="WritingAnalytics";e.TableStyles="TableStyles";e.yCc="Similarity";e.GOp="Goals";e.Feedback="Feedback";e.kSp="TopProofingIssues";e.zQp="PremiumSquigglesPreview";e.FQp="Proofing";e.aOp="EditorScore";e.yQp="PremiumPreview";e.tOp="FirstRunExperience";e.iSp="TonalRewriteFre";e.eTp="WritersUnblock";e.YLp="AIFeedback"})(Wv||(Wv={}));var MH;(function(e){e[e.Info=0]="Info";e[e.ESp=1]="Warn";e[e.Error=2]="Error";e[e.Debug=3]="Debug"})(MH||(MH={}));var vL=d(1965);let jD;const cF=
()=>{jD||Jw.DI(540582740,"RoamingSettingsUpdatedIsNotSet",Wv.S0a);return jD};Object(vL.debounce)(()=>{Jw.DI(542500293,"IncrementSettingCountBatchedRequest",Wv.S0a);const e=cF();null===e||void 0===e?void 0:e()},1E3);let Yy=(e,n)=>{e?(Object.keys(e).forEach(C=>{nx[C]=e[C]||0}),n?(Object.keys(eD).forEach(C=>{const S=0<=nx[C]&&nx[C]<dt[C];Jw.DI(541676549,"ShouldShowFeatureInternal",Wv.S0a,{feature:C,result:S});eD[C]=S}),Jw.DI(538969749,"SuppressionSettingsInitialized",Wv.S0a)):Jw.DI(538969750,"SuppressionSettingsUpdated",
Wv.S0a)):Jw.DI(538969748,"SuppressionSettingsUndefined",Wv.S0a)};class kD{constructor(e,n){this.ODb=e;this.Sg=n;this.l9j=async(C,S,ja=!1)=>{try{const ya=await this.ODb.Vab()||{};Yy(ya,ja);this.Sg.sendTraceTag(536975169,2253,50,"Editor Feature Suppression settings have changed in messenger.")}catch(ya){ja&&Yy({},ja),this.Sg.sendTraceTag(536975170,2253,10,`Editor Feature Suppression settings failed to send to pane in messenger. Error: ${ya.message}. Stack: ${ya.stack}`)}};jD=this.txp=()=>{this.ODb.saveSettings(nx)};
this.ODb.hff(this.l9j);this.D7m=this.l9j(null,null,!0)}async FXi(e){await this.D7m;return this.hkn(e)}hkn(e){return!eD[e]}Mgp(e){Jw.DI(541636E3,"FeatureSuppressedOnce",Wv.S0a,{feature:e});eD[e]=!1;nx[e]++;999<nx[e]&&(nx[e]=999,Jw.DI(542199968,"IncrementSettingCountError",Wv.S0a,{feature:e}));e=cF();null===e||void 0===e?void 0:e()}Lgp(e){Jw.DI(542500291,"FeatureSuppressedForever",Wv.S0a,{feature:e});eD[e]=!1;nx[e]=-1;e=cF();null===e||void 0===e?void 0:e()}}Object(F.a)(kD,"EditorFeatureSuppression",
null,[]);class dF{constructor(e,n,C){this.Oo=e;this.ODb=n;this.Sg=C;this.s8m=async()=>{this.gMi(null,null,!0)};this.gMi=async(S,ja,ya=!1)=>{try{const kb=await this.ODb.Vab()||{};this.Oo.sendMessage(ei.a.LBf,{settings:kb,initialize:ya});this.Sg.sendTraceTag(542745565,2253,50,"Editor Feature Suppression settings have changed in messenger.")}catch(kb){this.Sg.sendTraceTag(542745566,2253,10,`Editor Feature Suppression settings failed to send to pane in messenger. Error: ${kb.message}. Stack: ${kb.stack}`)}};
this.ODb.hff(this.gMi)}async jD(e){var n,C;try{const S=null===(C=null===(n=null===e||void 0===e?void 0:e.Values)||void 0===n?void 0:n.Payload)||void 0===C?void 0:C.settings;S?(await this.ODb.saveSettings(S),this.Sg.sendTraceTag(542745563,2253,50,"Editor Feature Suppression settings saved in messenger.")):this.Sg.sendTraceTag(542745562,2253,15,"Editor Feature Suppression settings undefined in messenger.")}catch(S){this.Sg.sendTraceTag(542745564,2253,10,`Editor Feature Suppression settings failed to save in messenger. Error: ${S.message}. Stack: ${S.stack}`)}}}
Object(F.a)(dF,"FeatureSuppressionMessenger",null,[]);class NH extends Tt.a{constructor(){super(...arguments);this.v$="Editor Feature Suppression";this.SFb=void 0;this.O8b="FeatureSuppressionSettingsChangedEvent";this.cIc="getEditorFeatureSuppressionSettings";this.D$b="saveEditorFeatureSuppressionSettings";this.Akb=Iy.a.Ayf;this.dgc={}}Vab(){return this.Jbd()}saveSettings(e){this.Mi=e;return this.wmd()}async Bld(e){if(Object.keys(e).length!==Object.keys(this.Mi).length||Object.keys(e).some(n=>this.Mi[n]!==
e[n]))return!0;this.Sg.sendTraceTag(542749394,2250,50,`Resolving conflics for ${this.v$} failed - should not save settings.`);return!1}ncc(){return Object.keys(this.Mi).reduce((e,n)=>{this.Mi[n]&&(e.push(n),e.push(this.Mi[n]));return e},[])}mcc(){return Object.keys(this.Mi).reduce((e,n)=>{this.Mi[n]&&(e[n]=this.PZ(this.Mi[n].toString()));return e},{})}NXc(){return new Mz.a(this.Mi)}Kgd(e){return Object.keys(e).reduce((n,C)=>{e[C]&&(n[C]=this.Pcb(e[C],!0));return n},{})}}Object(F.a)(NH,"FeatureSuppressionSettingsHandler",
Tt.a,[]);class Zy{}Zy.J9n="PaneOpened";Zy.Dfo="PremiumPreviewSurveyNomination";Zy.LZl="EditorInterceptNomination";Object(F.a)(Zy,"IdeasFloodgateActionId",null,[]);class YJ{constructor(e,n){this.j7a=n}jD(e){this.j7a.N_c(n=>{this.xWm(n,e)})}xWm(e,n){n=n.Values.Payload;if(this.aPa(n))switch(n.actionId){case Zy.J9n:case Zy.Dfo:case Zy.LZl:e.logActivity(n.actionId,null);break;default:E.ULS.sendTraceTag(41448147,2250,10,"Invalid IdeasFloodgateActionId")}}aPa(e){return e&&e.actionId&&e.actionId.length?!0:
(E.ULS.sendTraceTag(41448148,2250,10,"Malformed FloodgateMessagePayload"),!1)}}Object(F.a)(YJ,"FloodgateMessageHandler",null,[975]);var qx=d(1543),rx=d(1606);class lD{constructor(e,n,C,S,ja,ya){this.YSe=e;this.Sg=n;this.Oxk=C;this.yGa=S;this.wpa=ja;this.pn=ya}jD(e){this.sUl();this.Sg.sendTraceTag(591683598,2250,50,"GoalSelected message received");var n=e.Values.Payload;if(n&&n.formalityGoal)e=this.KBl(n.formalityGoal);else if(n)e=n.formality;else{this.Sg.sendTraceTag(591683600,2250,10,"GoalSelectedMessagePayload should contain formalityGoal");
return}if(n&&n.version){n=n.version;var C=[];C.push(Object.assign(new kh.a,{name:"FormalityGoal",string:e.toString()}));C.push(Object.assign(new kh.a,{name:"Version",string:n}));this.yGa.Jta(ha.a.nTm,!0,void 0,void 0,void 0,void 0,C);C=Object.assign(new qx.a,{formality:e,version:n});e=Object.assign(new rx.a,{formality:e,version:n});this.Oxk.wZo(e);this.YSe.MLj(C)}else this.Sg.sendTraceTag(591683601,2250,10,"GoalSelectedMessagePayload should contain version")}KBl(e){switch(e){case "Formal":return 0;
case "Polished":return 1;case "Casual":return 2;default:throw Error.create("Unsupported goal!");}}sUl(){this.wpa.instance&&this.wpa.instance.Dij(null,new fb.a,this.pn.ETb)}}Object(F.a)(lD,"GoalSelectedMessageHandler",null,[975]);class ZJ{constructor(){this.selectedGoals=null}}Object(F.a)(ZJ,"GoalSdxSetting",null,[]);class sx{constructor(e){this.version=this.formality=null;this.formality=this.cdm(e.formality);this.version=e.version}cdm(e){switch(e){case 0:return"Formal";case 1:return"Polished";case 2:return"Casual";
default:return"Formal"}}}Object(F.a)(sx,"GoalSelectedOld",null,[]);class eF{constructor(e){this.selectedGoals=null;this.selectedGoals=new sx(e.selectedGoals)}}Object(F.a)(eF,"GoalSdxSettingOld",null,[]);class LB{constructor(e,n){this.TFa=e;this.aCd=n}TRh(e){if(this.TFa.dTb()){var n=this.aCd.GMf();n=Object.assign(new qx.a,{formality:n.formality,version:n.version});n=Object.assign(new ZJ,{selectedGoals:n});e[LB.$il]=Bf.c(new eF(n));e[LB.Zil]=Bf.c(n)}}}LB.$il="PersistedGoals";LB.Zil="Goals";Object(F.a)(LB,
"GoalsSettingsAppender",null,[984]);class $k{constructor(e,n,C){this.wpa=e;this.pn=n;this.Ps=C}aPa(e){return e?e.isSelected&&!e.categoryName?(E.ULS.sendTraceTag(50914531,2250,10,"Malformed CategorySelectionChangedPayload -- IsSelected without CategoryName"),!1):!e.isSelected&&e.pRh?(E.ULS.sendTraceTag(51127880,2250,10,"Malformed CategorySelectionChangedPayload -- !IsSelected with AnnotationsIdsToIgnore"),!1):!0:(E.ULS.sendTraceTag(50914530,2250,10,"Malformed CategorySelectionChangedPayload"),!1)}jD(e){if(this.Ps&&
this.pn.isPaneOpen&&(E.ULS.sendTraceTag(50914560,2250,50,"Handling CategorySelectionChanged message."),e=e.Values.Payload,this.aPa(e))){var n=null,C=null;if(e.isSelected&&(n=e.categoryName,C=new fb.a,e.pRh))for(const S of e.pRh)S&&C.add(S);this.wpa.execute(S=>{S.Dij(n,C,this.pn.ETb)})}}}Object(F.a)($k,"CategorySelectionChangedMessageHandler",null,[975]);class Lh{constructor(e,n,C,S){S&&C.execute(ja=>{ja.IPh(()=>{n.Wsa&&e.sendMessage(ei.a.ihi,null)})})}}Object(F.a)(Lh,"EditsMadeMessageSender",null,
[]);class OH{constructor(e,n,C){this.Ima=(S,ja)=>{ja.isPaneOpen?this.wpa.execute(ya=>{ya.h1n(ja.t0i)}):this.wpa.execute(ya=>{ya.tXn()})};this.xfg=(S,ja)=>{this.wpa.execute(ya=>{ya.xfg(ja.t0i)})};this.wpa=n;C&&(e.C5a(this.Ima),e.F2k(this.xfg))}}Object(F.a)(OH,"PaneToggleHandler",null,[]);class PH{constructor(e,n,C,S){S&&C.execute(ja=>{ja.f1k((ya,kb)=>{n.Wsa&&e.sendMessage(ei.a.oBj,{CategoryName:kb.categoryName})})})}}Object(F.a)(PH,"ReleaseCategoryMessageSender",null,[]);class Kw{constructor(e,n,C,
S){this.kJo=(ja,ya,kb,Rb,sc)=>{this.pn.Wsa&&this.Oo.sendMessage(ei.a.eug,{cardId:sc});return 32};this.Oo=e;this.pn=n;S&&C.fb(ha.a.kdb,Ma.a.view,this.kJo,96)}}Object(F.a)(Kw,"ReturnFocusMessageSender",null,[]);var $J=d(1979);class QH{constructor(){this.mth=new Map;this.FFh=new Map;this.T6m($J)}T6m(e){for(const [n,C]of Object.entries(e))this.mth[n]=new Set(C)}X0j(e){const n=this.FFh.get(e);if(n)return n;for(const [C,S]of Object.entries(this.mth))if(S.has(e))return this.FFh.set(e,C),C;E.ULS.sendTraceTag(524931465,
2250,15,"Category name is not in loccatlist_compressed.json.");return e}}Object(F.a)(QH,"CategoryStandardization",null,[]);class fF{constructor(e,n,C){this.AnnotationType=e;this.OldState=n;this.NewState=C}}Object(F.a)(fF,"AnnotationResultStatePayload",null,[]);class gF{constructor(e,n,C,S){S&&C.execute(ja=>{ja.Y1k((ya,kb)=>{n.Wsa&&e.sendMessage(ei.a.lRh,new fF(kb.annotationType,kb.oldState,kb.newState))})})}}Object(F.a)(gF,"AnnotationResultStateMessageSender",null,[]);class aK{constructor(e,n){this.wpa=
e;this.Ps=n}aPa(e){return e?e.annotationType?!0:(E.ULS.sendTraceTag(571786329,2250,10,"Malformed AnnotationResultStateSubscriptionPayload -- No AnnotationType"),!1):(E.ULS.sendTraceTag(571786328,2250,10,"Malformed AnnotationResultStateSubscriptionPayload"),!1)}jD(e){if(this.Ps){E.ULS.sendTraceTag(571786330,2250,50,"Handling CategorySelectionChanged message.");var n=e.Values.Payload;this.aPa(n)&&this.wpa.execute(C=>{C.Dne(n.annotationType,n.subscribe)})}}}Object(F.a)(aK,"AnnotationResultStateSubscriptionMessageHandler",
null,[975]);class wL{constructor(e,n){this.Pb=e;this.LDe=n}jD(e){try{if(null!==e&&void 0!==e&&e.Values){var n=e.Values.Payload;if(n&&n.actionId){const C=this.Pb.Qb(n.actionId,1,n.additionalData);2===C?this.LDe.sendTraceTag(542749405,2250,15,"Attempting to call an unregistered action from Editor Pane"):this.LDe.sendTraceTag(542737885,2250,50,`Calling action ${n.actionId} from Ideas returned response ${C}`)}}else this.LDe.sendTraceTag(542737884,2250,15,"Attempting to IdeasCallActionMessageHandler without a payload")}catch(C){this.LDe.sendTraceTag(542749406,
2250,10,"Error while attempting to call an action in IdeasCallActionMessageHandler")}}}Object(F.a)(wL,"IdeasCallActionMessageHandler",null,[975]);class bK{constructor(e){this.Koh=!1;this.mlb=null;this.vv=e;this.vv.Lja(Jv.vii);this.vv.Lja(Jv.sii)}Uyl(e){E.ULS.sendTraceTag(41437255,2250,50,"Attempting to connect the Ideas Messenger to Ideas SDX iframe.");e?this.Koh?E.ULS.sendTraceTag(40957973,2250,10,"Attempted to connect the Ideas Messenger to add-in more than once."):(this.mlb=e,this.Koh=!0):E.ULS.sendTraceTag(40957972,
2250,10,"Attempted to connect the Ideas Messenger to undefined add-in iframe.")}Ur(e,n){E.ULS.sendTraceTag(41437256,2250,50,"Attempting to register a handler for MessageTypeId [{0}].",e);if(e&&""!==e)if(n){var C=!1;this.vv.isEnabled()&&(this.vv.Bv(e),C=this.vv.LE(e,Object(ic.a)(n,n.jD,"handleMessage")));C||E.ULS.sendTraceTag(40957976,2250,10,"Failed to register Messenger handler for MessageTypeId [{0}].",e)}else E.ULS.sendTraceTag(41448149,2250,10,"Attempted to register null IIncomingMessageHandler.");
else E.ULS.sendTraceTag(40957974,2250,10,"Attempted to register null or empty MessageTypeId.")}sendMessage(e,n){if(this.mlb){var C=this.mlb.src;this.vv.HZf(C)?Array.contains(Jv.ZQh,e)?this.vv.Gdb(Object.assign(new Gq.a,{MessageId:e,SendTime:Date.now(),Values:{["Payload"]:n}}),this.mlb.contentWindow,N.a.getOrigin(C))||E.ULS.sendTraceTag(41437258,2250,10,"Failed to send a message with MessageTypeId [{0}].",e):E.ULS.sendTraceTag(40957979,2250,10,"Attempted to send a message with unsupported MessageTypeId [{0}].",
e):E.ULS.sendTraceTag(41206103,2250,10,"Attempted to send a message to origin that's not allowed.")}else E.ULS.sendTraceTag(40957978,2250,15,"Attempted to send a message with undefined target iframe element and MessageTypeId [{0}].",e)}}Object(F.a)(bK,"IdeasMessenger",null,[983]);class cK{constructor(e){this.uv=e}aPa(e){return e?e.experienceId?!0:(E.ULS.sendTraceTag(594106403,2250,10,"Malformed InvokeLicensingUpsellPayload using fallback value. Error: ExperienceId is null"),!1):(E.ULS.sendTraceTag(594106432,
2250,10,"Malformed InvokeLicensingUpsellPayload using fallback value. Error: payload is null"),!1)}jD(e){E.ULS.sendTraceTag(594106402,2250,50,"Handling InvokeLicensingUpsell message.");e=e.Values.Payload;const n=this.aPa(e)?e.experienceId:"editorinword";this.uv.execute(C=>{C.launchUpsellExperience(n)})}}Object(F.a)(cK,"InvokeLicensingUpsellMessageHandler",null,[975]);class hF{constructor(e){this.ga=e}jD(){this.ga.Ob(ha.a.sY,2)}}Object(F.a)(hF,"OpenPaneMessageHandler",null,[975]);class RH{constructor(e,
n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf,Gg,Ph,Aj,Ih,Nm,Sk,hk,al,Cj){this.Oo=e;this.Jmk=n;this.wsk=C;this.$vk=S;this.JHk=ja;this.gqk=ya;this.fOk=kb;this.kAk=Rb;this.eOk=sc;this.QOk=Fc;this.Fwk=gd;this.nQk=td;this.KHk=Bd;this.GHk=wd;this.Nxk=te;this.lRk=Le;this.wnk=Oe;this.Lpk=We;this.Yyk=Xf;this.xRe=Gg;this.Ylk=Ph;this.pQk=Aj;this.enk=Ih;this.fnk=Nm;this.gnk=Sk;this.bnk=hk;this.dnk=al;this.cnk=Cj}register(){this.Oo.Ur(ei.a.oPi,this.Jmk);this.Oo.Ur(ei.a.H4j,this.wsk);this.Oo.Ur(ei.a.f2j,
this.$vk);this.Oo.Ur(ei.a.hoe,this.JHk);this.Oo.Ur(ei.a.W_h,this.gqk);this.Oo.Ur(ei.a.R2j,this.fOk);this.Oo.Ur(ei.a.iUi,this.kAk);this.Oo.Ur(ei.a.v_h,this.eOk);this.Oo.Ur(ei.a.Yfd,this.QOk);this.Oo.Ur(ei.a.Zgg,this.Ylk);this.Oo.Ur(ei.a.oFf,this.pQk);this.Oo.Ur(ei.a.kti,this.Fwk);this.Oo.Ur(ei.a.szc,this.nQk);this.Oo.Ur(ei.a.Dpj,this.KHk);this.Oo.Ur(ei.a.C6n,this.GHk);this.Oo.Ur(ei.a.POo,this.Nxk);this.Oo.Ur(ei.a.$Ig,this.lRk);this.Oo.Ur(ei.a.VYj,this.wnk);this.Oo.Ur(ei.a.kVl,this.Lpk);this.Oo.Ur(ei.a.aek,
this.Yyk);this.Oo.Ur(ei.a.LBf,this.xRe);this.Oo.Ur(ei.a.ZEf,this.enk);this.Oo.Ur(ei.a.lag,this.fnk);this.Oo.Ur(ei.a.sug,this.gnk);this.Oo.Ur(ei.a.E4k,this.bnk);this.Oo.Ur(ei.a.G4k,this.dnk);this.Oo.Ur(ei.a.F4k,this.cnk)}}Object(F.a)(RH,"PostMessageHandlers",null,[978]);var mD=d(1434);class MB extends mD.a{constructor(){super();this.category=0;this.documentContext=null;this.userInteracted=this.platform=this.howLaunched=0;this.H_=Object.assign(new un.a,{T_:MB.getTypeName(),B_:MB.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_IdeasEngagementSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(F.a)(MB,"IdeasEngagementSignal",mD.a,[]);var NB;(function(e){e[e.scroll=0]="scroll";e[e.click=1]="click";e[e.lwc=2]="seen";e[e.Gpc=3]="kept"})(NB||(NB={}));Object(F.b)("Engagement",NB);class ho extends Sys.EventArgs{constructor(e=null){super();this.Ruk=e}get eventType(){return this.Ruk||""}}Object(F.a)(ho,"UserEngagementEventArgs",Sys.EventArgs,[]);class SH{constructor(e,n,C){this.sa=new eb.a;this.MZe=this.ubc=this.VD=this.yQe=!1;this.CZe=new fd.a;this.GDb=this.JGb=null;this.Ima=(S,ja)=>{this.VD!==
ja.isPaneOpen&&((this.VD=ja.isPaneOpen)?this.JGb=new Date:(this.JGb=null,this.ZZc()),this.QGo())};this.pn=e;this.Wok=n;e.C5a(this.Ima);C.Ur(ei.a.v$j,this)}get id(){return 2}get Vsc(){return this.JGb}get l_c(){return this.GDb}c3k(e){this.sa.addHandler("UserEngagement",e)}jD(e){e&&e.MessageId===ei.a.v$j&&(e=(e="object"===typeof e.Values.Payload?e.Values.Payload:null)?"string"===typeof e.eventType?e.eventType:null:"scroll",!this.ubc&&this.eXf(e)&&this.mqg())}Fcg(e,n){e=n.annotation;n=60===n.mTa?"kept":
null;!this.ubc&&!Jp.a.Qf(n)&&e&&Yx.a.getTypeNameFor(e.content)===xJ.a.getTypeName()&&this.eXf(n)&&this.mqg()}g0n(e){Pg.a.vh().equals(e,"seen")&&(this.MZe=!0);const n=Pg.a.vh().equals(e,"kept")?this.MZe:!0;!this.ubc&&n&&this.eXf(e)&&this.mqg()}SJn(){this.CZe.add(uu[0],3)}eXf(e){if(!this.pn.isPaneOpen)return!1;const n=uu[this.pn.t6c];return this.CZe.tb(n)?Pg.a.vh().equals(NB[this.CZe.K(n)],e):Pg.a.vh().equals("scroll",e)||Pg.a.vh().equals("click",e)}mqg(){this.GDb=new Date;this.ubc=!0;this.sa.raiseEvent("UserEngagement",
new ho);this.ZZc()}ZZc(){this.yQe||(this.Wok.emit(Object.assign(new MB,{category:0,howLaunched:this.jEm(),platform:0,userInteracted:this.ubc?2:1})),this.yQe=!0)}jEm(){return this.pn.t6c&&5!==this.pn.t6c?1:0}QGo(){this.yQe=this.ubc=this.MZe=!1;this.GDb=null}}Object(F.a)(SH,"UserEngagementMonitor",null,[975,980,981]);class TH{emit(e){return Jp.a.im().then(()=>{Uv.a.Nz().submitOperation(Object.assign(new zz.a,{operation:Object.assign(new Vh.a,{items:[Object.assign(new wh.a,{body:e})],parentPath:["Signal",
MB.getTypeName()]})}))})}}Object(F.a)(TH,"UserEngagementSignalBeacon",null,[982]);var dK=d(1486),eK=d(1574);class lA{}lA.Ncc="SimilarityCheck";Object(F.a)(lA,"SimilarityConstants",null,[]);class OB{constructor(e){this.Re=e}jD(){E.ULS.sendTraceTag(593761943,2250,50,"CancelSimilarityCheck message received");this.Re.releaseAnnotation(dK.a.getTypeName(),lA.Ncc);this.Re.releaseAnnotation(eK.a.getTypeName(),lA.Ncc)}}Object(F.a)(OB,"SimilarityCancelMessageHandler",null,[975]);var CM=d(1802);class lk extends mD.a{constructor(){super();
this.runId=null;this.H_=Object.assign(new un.a,{T_:lk.getTypeName(),B_:lk.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SimilarityCheckSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(F.a)(lk,"SimilarityCheckSignal",mD.a,[]);class Og{constructor(e,n){this.Re=e;this.Lda=n}jD(e){E.ULS.sendTraceTag(593761942,2250,50,"TriggerSimilarityCheck message received");(e=e.Values.Payload)&&e.runId?e=e.runId:(E.ULS.sendTraceTag(593761941,2250,15,"SimilarityCheckMessagePayload should contain runId"),
e=Date.now());const n=Object.assign(new Vh.a,{parentPath:["Signal",lk.getTypeName()],items:[Object.assign(new wh.a,{body:Object.assign(new lk,{runId:e})})]});Jp.a.im().then(()=>{this.Re.activateAnnotation(dK.a.getTypeName(),lA.Ncc).then(()=>{this.Re.activateAnnotation(eK.a.getTypeName(),lA.Ncc).then(()=>{Uv.a.Nz().submitOperation(Object.assign(new zz.a,{operation:n}));this.Lda.jYo(CM.a.Ize)})})})}}Object(F.a)(Og,"SimilarityCheckerMessageHandler",null,[975]);class fK{constructor(e){this.Pb=e}jD(){E.ULS.sendTraceTag(592255044,
2250,50,"OpenStatsDialog message received");this.Pb.Ob(ha.a.aoe,2)}}Object(F.a)(fK,"StatsDialogMessageHandler",null,[975]);class gK{constructor(e,n,C,S=null){this.dSa=e;this.Oo=n;this.pn=C;this.R5j=()=>{this.pn.Wsa&&this.Oo.sendMessage(ei.a.szc,new bD);this.FRk()};this.BBp=()=>{Fw.a.age=this.o$c();this.R5j()};this.o$c=()=>1===this.dSa.Gl.state;this.FRk=null!==S&&void 0!==S?S:()=>{this.ABp()};Fw.a.age=this.o$c();this.dSa.wKb(this.BBp);this.R5j()}ABp(){const e=Fw.a.kge();ib.StaticActiveAppFrame.za().Ge();
const n=Array(2);n[0]="ShowWordPredictionDialog";n[1]=e;G.AFrameworkApplication.va.Qb(pe.a.wAe,2,n);appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("WordPredictionOptions",!e)])}}Object(F.a)(gK,"PremiumPreviewTextPredictionHandler",null,[]);var UH=d(1167);class PB{constructor(e,n){this.ZQa=e;this.pn=n}jD(e){e&&e.MessageId===ei.a.szc&&(e=e.Values.Payload,this.aPa(e)&&(Fw.a.D8j(e.isEnabled,23),ib.StaticActiveAppFrame.za().Ge()))}Xxo(){UH.a.y2k(()=>{this.ZQa.sendMessage(ei.a.eug,{cardId:"shellTextPredictionSettingCard"})})}Gxo(){UH.a.z2k(()=>
{this.pn.Wsa&&this.ZQa.sendMessage(ei.a.szc,new bD)})}aPa(e){return e?!0:(E.ULS.sendTraceTag(591987233,2250,10,"Malformed TextPredictionPayload"),!1)}}Object(F.a)(PB,"TextPredictionComponent",null,[976,975]);var mA=d(1181);class nD{jD(){const e=gc.a.instance.resolve("Box4.WordPredictionActor"),n={};n[mA.a.jfb]=23;e.Zyb(parseInt(pe.a.Zyb),null,2,null,n)}}Object(F.a)(nD,"TextPredictionDialogHandler",null,[975]);class VH{initialize(){return Jp.a.im()}}Object(F.a)(VH,"TileEventsHandler",null,[974]);class nA{constructor(e){this.ywk=
e}execute(e){this.ywk.execute(()=>{e(this)})}}Object(F.a)(nA,"TileViewAdapter",null,[973]);var oD=d(484);class gy{constructor(e,n,C){this.MIb=e;this.Eyc=C;this.VD=this.fFb=!1;this.x1n=(S,ja)=>{this.VD=ja.isPaneOpen;this.Bhj()};this.tGh=[];this.k1j=(S,ja,ya)=>{if(1===ya)return 32;this.fFb=!this.fFb;this.Bhj();S={["ToggleProofingRibbon"]:appChrome.selectors.getModelType("ToggleProofingRibbon")};this.yH.aV(oD.a.l1j);ib.StaticActiveAppFrame.za().eJ(S);return 32};this.NAp=(S,ja,ya,kb,Rb)=>{if(!Rb)return 16;
if(1===ya)return 32;S=this.I8d();S=this.fFb?S.QJo:S.RJo;Rb[gh.a.Visible]=!this.VD;Rb[gh.a.LabelText]=S;Rb=[appChrome.actions.setControlIconSet("ToggleProofingRibbon",{["default"]:this.fFb?"SpellingIssue_20":"HideProofingErrors_20"})];appChrome.api.dispatch(Rb);return 32};this.OAp=(S,ja,ya,kb,Rb)=>{if(!Rb)return 16;if(1===ya)return 32;ja=this.I8d();S=this.fFb?ja.xep:ja.yep;ja=this.fFb?ja.Wmp:ja.Xmp;Rb[gh.a.Visible]=!this.VD;Rb[gh.a.LabelText]=S;Rb[Q.a.customTooltip]=ja;return 32};n.C5a(this.x1n)}get c_f(){return this.fFb&&
!this.VD}get yH(){return this.wja=this.wja||this.MIb()}FEg(e){this.tGh.push(e)}Bhj(){this.tGh.forEach(e=>e());this.Eyc.vue()}Xb(){const e=G.AFrameworkApplication.va;e.qa(ha.a.m1j,Ma.a.view,this.k1j);e.fb(ha.a.qxj,Ma.a.application,this.NAp,96);e.qa(ha.a.j1j,Ma.a.view,this.k1j);e.fb(ha.a.pxj,Ma.a.application,this.OAp,96)}I8d(){return{yep:WordRibbonStrings.ToggleProofingOn,xep:WordRibbonStrings.ToggleProofingOff,Xmp:WordRibbonStrings.ToggleProofingTooltipOn,Wmp:WordRibbonStrings.ToggleProofingTooltipOff,
RJo:WordRibbonStrings.ToggleProofingInRibbonDisable,QJo:WordRibbonStrings.ToggleProofingInRibbonEnable}}}Object(F.a)(gy,"ToggleProofingActor",null,[]);class iF{constructor(e,n,C,S,ja,ya,kb){this.g4e=ja;this.e8g=[];if(0!==this.g4e)switch((kb.$Tb()||ya)&&this.tQd(C),this.tQd(S),this.g4e){case 3:case 5:case 4:this.tQd(e);break;case 1:case 6:case 2:this.tQd(n)}}tQd(e){e?(this.e8g.push(e),e.initialize()):E.ULS.sendTraceTag(539784090,2250,10,"Trying to initialize undefined Ideas trigger model for proactive experiment {0}",
this.g4e)}zYk(e){this.e8g.forEach(n=>{n.vqa(e)})}}Object(F.a)(iF,"ActiveIdeasTriggerModels",null,[]);class uv extends Sys.EventArgs{constructor(e,n,C=""){super();this.YLl=e;this.launchMode=n;this.N2j=C}}Object(F.a)(uv,"TriggerEventArgs",Sys.EventArgs,[]);class Bp{constructor(e,n,C,S,ja,ya){this.sa=new eb.a;this.GYd={};this.Re=e;this.bqa=n;this.k9=C;this.launchMode=S;this.iRk=ja;this.yOk=ya}initialize(){this.k9.fY(this);this.Tuo()}Wd(){}gH(e){e.content&&e.annotationType===Rv.a.getTypeName()&&(e=e.content,
this.GYd[e.categoryName]=e.count)}vqa(e){this.sa.addHandler("OnTriggerIdeas",e)}rDa(e){this.sa.removeHandler("OnTriggerIdeas",e)}E3(){}C3(e){2===e.behavior&&this.m5c(e)}m5c(){}Tuo(){Jp.a.im().then(()=>{Uv.a.Nz().activateAnnotation(Object.assign(new AH.a,{annotationType:Rv.a.getTypeName(),handler:e=>{if(e&&e.items&&0<e.items.length)for(const n of e.items)e=n.body,Yx.a.getTypeNameFor(e)===Rv.a.getTypeName()&&(this.GYd[e.categoryName]=e.count)}}));this.Re.ub(this,Rv.a.getTypeName())})}Lxb(){const e=
this.LDm();(0<e||!this.yOk)&&this.bqa&&!this.bqa.Dca()&&this.sa.xfa&&this.sa.raiseEvent("OnTriggerIdeas",new uv(e,this.launchMode,this.iRk))}LDm(){let e=0;for(const n in this.GYd)e+=this.GYd[n];return e-1}}Object(F.a)(Bp,"TriggerModelBase",null,[857,114,119]);class WH extends Bp{constructor(e,n,C,S,ja,ya=0){super(e,n,C,ya,"CritiqueAcceptNoTypingTriggerModel",!0);this.xDb=new Fv.a;this.xyf=new fb.a;this.Srk=ja;this.sQe=S}initialize(){this.dUf();super.initialize()}m5c(e){this.xDb.contains(e.actionId)&&
(this.xyf.add(e),this.Lxb())}Lxb(){this.dXf()&&super.Lxb()}dXf(){let e=0;const n=Date.now();if(3E4>n-this.Srk.Cge)return!1;for(let C=this.xyf.count-1;0<=C&&!(3E4<n-this.xyf.K(C).startTime.getTime());C--)if(e++,e>=this.sQe)return!0;return!1}dUf(){this.xDb.add(pe.a.Ava);this.xDb.add(pe.a.aJa)}}Object(F.a)(WH,"CritiqueAcceptNoTypingTriggerModel",Bp,[]);class XH extends Bp{constructor(e,n,C,S,ja=0){super(e,n,C,ja,"CritiqueAcceptTriggerModel",!0);this.rQe=0;this.xDb=new Fv.a;this.sQe=S}initialize(){this.dUf();
super.initialize()}m5c(e){this.xDb.contains(e.actionId)&&(this.rQe++,this.Lxb())}Lxb(){this.dXf()&&super.Lxb()}dXf(){return this.rQe>=this.sQe?(this.rQe=0,!0):!1}dUf(){this.xDb.add(pe.a.Ava);this.xDb.add(pe.a.aJa)}}Object(F.a)(XH,"CritiqueAcceptTriggerModel",Bp,[]);class wu extends Dr.a{constructor(){super();this.isIdeasPaneTriggerLaunchSuppressed=!1;this.H_=Object.assign(new un.a,{T_:wu.getTypeName(),B_:wu.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(F.a)(wu,"IdeasPersonalizationSettingsAnnotation",Dr.a,[]);class jF{constructor(e){this.Pph=!1;this.Re=e}get x0i(){return this.Pph}initialize(){Jp.a.im().then(()=>{this.Re.ub(this,wu.getTypeName())})}gH(e){e.content&&e.annotationType===wu.getTypeName()&&(this.Pph=e.content.isIdeasPaneTriggerLaunchSuppressed,E.ULS.sendTraceTag(575193412,2250,50,String.format("Received cross session suppression settings value of {0}",this.x0i)))}}Object(F.a)(jF,"CrossSessionSuppressionHandler",null,[972,114]);
class kF{constructor(){this.mFc=0}Dca(){return 1<=this.mFc?(E.ULS.sendTraceTag(593843599,2250,50,String.format("Trigger launch suppressed. Reason: Max number of callout ({0}) per session reached for freemium user",1)),!0):!1}initialize(){}v0(e){2===e&&this.zQf()}zQf(){this.mFc++;this.rna("UserClosedCallout")}rna(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas."+e}))}}Object(F.a)(kF,"FreemiumSuppressionModel",null,[971]);class Xq{constructor(e,n,C,S){this.CWe=this.NJh=
!1;this.mFc=this.Kch=0;this.QYe=this.RYe=null;this.Ybf=this.lCd=this.uKh=!1;this.k9=e;this.JYd=n;this.Pgj=C;this.Jcj=S}initialize(){this.k9.fY(this);this.JYd&&this.JYd.initialize()}Dca(){return this.Kch>=this.Jcj||this.mFc>=this.Jcj?(E.ULS.sendTraceTag(594060355,2250,50,"Proactive launch was suppressed. Reason: Reached max pane closed reached this session."),!0):this.RYe&&(new Date).getTime()-this.RYe.getTime()<this.Pgj||this.QYe&&(new Date).getTime()-this.QYe.getTime()<this.Pgj?(E.ULS.sendTraceTag(594060354,
2250,50,"Proactive launch was suppressed. Reason: Last proactive launch is within the NoTriggerWindow."),!0):this.uKh?(E.ULS.sendTraceTag(594060353,2250,50,"Proactive launch was suppressed. Reason: No user engagement."),!0):this.NJh?(E.ULS.sendTraceTag(594060352,2250,50,"Proactive launch was suppressed.Reason:User suppressed further proactive launches this session."),!0):this.JYd&&this.JYd.x0i?(E.ULS.sendTraceTag(575193413,2250,50,"Proactive launch was suppressed.Reason:Proactive launch is suppressed across session."),
!0):!1}v0(e,n){switch(e){case 0:this.CWe=!0;break;case 1:this.ZVm(n);break;case 2:this.zQf(n);break;case 4:this.hYm();break;case 3:this.FXm()}}E3(){}C3(e){2===e.behavior&&this.CWe&&(e.actionId===ha.a.sY||e.actionId===ha.a.keb?this.Ybf=!1:e.actionId===ha.a.ppd&&(this.Ybf=!0))}ZVm(e){this.Ybf?(this.Kch++,this.RYe=e,this.lCd?this.rna("TriggerLaunchedIdeasPaneClosedAfterEngagement"):(this.uKh=!0,this.rna("TriggerLaunchedIdeasPaneClosedWithoutEngagement"))):this.lCd?this.rna("UserLaunchedIdeasPaneClosedAfterEngagement"):
this.rna("UserLaunchedIdeasPaneClosedWithoutEngagement");this.lCd=this.CWe=!1}zQf(e){this.mFc++;this.QYe=e;this.rna("UserClosedCallout")}hYm(){this.lCd=!0;this.rna("UserEngagedWithPaneFirstTimeInPaneSession")}FXm(){this.NJh=!0;this.rna("UserClickedToSuppressTheAutoLaunch")}rna(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas."+e}))}}Object(F.a)(Xq,"HeuristicSuppressionModel",null,[971,119]);class lF extends Bp{constructor(e,n,C,S,ja,ya=0){super(e,n,C,ya,"PremiumPreviewExpiredTriggerModel",
!1);this.cSa=S;this.Qfh=ja;this.hoe=()=>{super.Lxb();this.Qfh.Mgp(Ap.rCc)};this.Bpj=async(kb,Rb)=>{kb=2===Rb.Gl.state||5===Rb.Gl.state;Rb=await this.Qfh.FXi(Ap.rCc);kb&&!Rb&&this.hoe()}}initialize(){super.initialize();const e=this.cSa.Gl;e&&4!=e.state?this.Bpj(void 0,new DG(e)):this.cSa.wKb(this.Bpj)}m5c(){}}Object(F.a)(lF,"PremiumPreviewExpiredTriggerModel",Bp,[]);class YH extends Bp{constructor(e,n,C,S,ja=0){super(e,n,C,ja,"PremiumPreviewInProgressTriggerModel",!1);this.a7n=(ya,kb)=>{1===kb.Gl.state&&
super.Lxb()};this.cSa=S}initialize(){super.initialize();this.cSa.wKb(this.a7n)}m5c(){}}Object(F.a)(YH,"PremiumPreviewInProgressTriggerModel",Bp,[]);class Ls{constructor(e){this.I8g=!1;this.D7e=e}Dca(){if(this.I8g)return!0;this.D7e.Dca()||(this.I8g=!0);return this.D7e.Dca()}initialize(){}v0(e,n){this.D7e.v0(e,n)}}Object(F.a)(Ls,"PremiumPreviewSuppressionModel",null,[971]);class pD extends Sys.EventArgs{constructor(e){super();this.wordCount=e}}Object(F.a)(pD,"WordCountAggregationEventArg",Sys.EventArgs,
[]);class et{}et.ygf="awccek";Object(F.a)(et,"WordCountConstants",null,[]);class hy{constructor(e,n,C,S,ja){this.Re=e;this.PK=n;this.c2a=C;this.Z5=S;this.sa=ja;this.O1=!1;this.EA=0;this.Bga=()=>{this.c2a.Wsa||this.jog(this.PK.EA)};this.vkj=(ya,kb)=>{if(kb.isPaneOpen)return this.iAj()}}initialize(){this.PK.cmb(this.Bga);this.c2a.C5a(this.vkj);this.c2a.Wsa?this.iAj():this.jog(this.PK.EA)}Wd(){this.PK.Nte(this.Bga);this.c2a.Lkd(this.vkj);this.c2a.Wsa&&this.Gtp()}iAj(){if(!this.O1)return this.Z5.im().then(()=>
{this.Re.ub(this,tu.getTypeName());this.bkg();this.O1=!0}).catch(e=>{E.ULS.sendTraceTag(541193813,2250,10,"Unable to register word count annotation handler.",e)})}Gtp(){this.O1&&this.Z5.im().then(()=>{this.Re.xc(this,tu.getTypeName());this.O1=!1}).catch(e=>{E.ULS.sendTraceTag(541193814,2250,10,"Unable to unregister word count annotation handler.",e)})}bkg(){this.Z5.im().then(()=>{this.Re.getAnnotationsByType(tu.getTypeName()).then(e=>{for(const n of e)this.Drb(n)})})}gH(e,n){!this.O1||n!==Vh.a.getTypeName()&&
n!==CC.a.getTypeName()||(e&&e.content?this.Drb(e):E.ULS.sendTraceTag(541193815,2250,10,"Handled annotation is invalid"))}Drb(e){e?e.annotationType===tu.getTypeName()&&(e=e.content)&&this.jog(e.wordNumber):E.ULS.sendTraceTag(541193816,2250,15,"Annotation is null.")}jog(e){this.EA=e;this.sa.raiseEvent(et.ygf,new pD(e))}Xef(e){this.sa.addHandler(et.ygf,e)}xrg(e){this.sa.removeHandler(et.ygf,e)}}Object(F.a)(hy,"WordCountOverseer",null,[970,114,506]);class oA{constructor(e,n){this.ga=e;this.nDc=n;this.$kb=
this.ey=!1;this.zgc=(C,S)=>{this.lrg();C?this.nDc.hide():(this.nDc.dispose(),this.$kb=!1,E.ULS.sendTraceTag(509366928,2250,50,"AI Feedback Skittle closed"));S&&(this.D9e(),E.ULS.sendTraceTag(509366927,2250,50,"AI Feedback Skittle suppressed."));this.ey=!1};this.onClick=()=>{const C={};C.PaneTitle=WordEditorIntl.WordEditorStrings.L_AIFeedbackPaneTitle;this.ga.Qb(ha.a.JBg,2,C)};this.onClose=()=>{this.zgc(!1,!0)}}get isVisible(){return this.ey}showSkittle(e){this.D9e=e;this.$kb?this.nDc.show():(this.Vte(!1),
this.$kb=!0);this.zef();this.ey=!0}zef(){var e=pd.a.instance;const n=ae.FocusManager.instance();e.I$(wq.a.KRd);e=n.ie(wq.a.KRd);const C=document.getElementById("AIFeedbackSkittleContainer"),S=new Jr.DOMFocusListing(()=>C);S.Uga=!0;S.rn(8);S.rn(2);n.Qmb(C,e,S).rP=!0}lrg(){const e=pd.a.instance,n=ae.FocusManager.instance();n.currentScope.name===wq.a.KRd&&n.Gg(kA.a.Do);e.Dx(wq.a.KRd)}Vte(e=!1){const n={onClick:this.onClick,onClose:this.onClose};e?this.nDc.update(n):this.nDc.render(n)}}Object(F.a)(oA,
"AIFeedbackSkittleComponent",null,[908]);class ft{}ft.qje=1E3;ft.wLn=4E3;ft.w7f=1;Object(F.a)(ft,"AIFeedbackSkittleConstants",null,[]);class tx{constructor(e,n,C){this.z8g=e;this.HIb=n;this.iac=C;this.onClose=()=>this.iac.v0(7,new Date);this.rsd=(S,ja)=>{ja?ja.wha?this.kBg&&this.z8g.showSkittle(this.onClose):this.z8g.zgc(21!==ja.id,!1):E.ULS.shipAssertTag(509366926,2250,!1)}}initialize(){this.iac.initialize();this.HIb.forEach(e=>{e.vqa(this.rsd);e.initialize()})}Wd(){this.HIb.forEach(e=>{e.rDa(this.rsd);
e.Wd()})}get kBg(){return this.HIb.every(e=>e.Ggf())}}Object(F.a)(tx,"AIFeedbackSkittleTriggerManager",null,[906,506]);class Xv extends bh.a{constructor(e,n){super("DocumentLengthUpperBoundConditionId");this.A$=e;this.juh=n;this.fud=(C,S)=>{this.pi(S.wordCount<=this.juh)}}initialize(){super.initialize();this.A$.Xef(this.fud);this.pi(this.A$.EA<=this.juh)}Wd(){this.A$.xrg(this.fud);super.Wd()}}Object(F.a)(Xv,"DocumentLengthUpperBoundCondition",bh.a,[]);var qD=d(1120);class Un extends Oa.a{constructor(){super(...arguments);
this.K8=()=>{ib.StaticActiveAppFrame.za().kb.bdb(this.K8);this.initInternal()}}get name(){return"WordEditor.Ideas"}BUa(){if(Object(qD.a)()){const e=ib.StaticActiveAppFrame.za().kb;e.uBa?this.initInternal():e.Qja(this.K8)}}async initInternal(){var e;try{this.Z.resolve("WordEditor.Ideas.TextPrediction.PremiumPreviewTextPredictionHandler");const n=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager");try{const C=await n.JUb;this.qva(C.mode)}catch(C){this.BUl()}}catch(n){console.error(null!==
(e=n.message)&&void 0!==e?e:n),E.ULS.sendTraceTag(528561500,2250,10,"Initializing WordEditorIdeasPackage failed.",n)}}AUa(){}zUa(e){var n;this.Z=e;if(Object(qD.a)()){const C=rl.a.qLa;this.Z.ia("WordEditor.Ideas.AddInLoader.IAddInUtils",()=>new dD(new Cr.a(this.Z.resolve("Common.IExternalUICommandDefinitionMapping")))).ha();this.Z.ia("WordEditor.Ideas.TextPrediction.PremiumPreviewTextPredictionHandler",()=>new gK(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),
this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();this.Z.ia("WordEditor.Ideas.Messenger.IMessenger",()=>new bK(new aB.a(null,null))).ha();this.Z.ia("WordEditor.Ideas.Tiling.ITileEventsHandler",()=>new VH).ha();this.Z.ia("WordEditor.Ideas.Tiling.ITileViewAdapter",()=>new nA(this.Z.Ta("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).ha();this.Z.ia("WordEditor.Ideas.TextPrediction.ITextPredictionComponent",()=>new PB(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),
this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();this.Z.register(nD,"WordEditor.Ideas.TextPrediction.TextPredictionDialogHandler").ha();this.Z.register(JB,"WordEditor.Ideas.EditorSettings.EditorSettingsDialogHandler").ha();this.Z.ia("WordEditor.Ideas.IFeatureSuppressionSettingsHandler",()=>new NH(this.Z.resolve("Box4.IRoamingServiceRequestManager"),e.resolve("Box4.RoamingSetting.IRoamingSettingCache"),G.AFrameworkApplication.J,new eb.a,this.Z.resolve("Common.IUlsWrapper"))).ha();
this.Z.ia("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression",()=>new kD(this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionSettingsHandler"),this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ia("WordEditor.Ideas.IFeatureSuppressionMessenger",()=>new dF(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionSettingsHandler"),this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ia("WordEditor.Ideas.AddInLoader.AddInLoadedMessageHandler",()=>
new cD(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.Tiling.ITileEventsHandler"),this.Z.resolve("WordEditor.Ideas.Tiling.ITileViewAdapter"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInCommands"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),G.AFrameworkApplication.J,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.Ideas.TextPrediction.ITextPredictionComponent"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionMessenger"),this.Z.resolve("WordEditor.EditorUpsell.ISimulateFreeUserGate"),this.Z.resolve("WordEditor.Ideas.PaneSettingsProvider"))).ha();this.Z.ia("WordEditor.Ideas.FloodgateMessageHandler",()=>new YJ(this.Z.Ta("Common.ISystemInitiatedFeedback"),ad.a.F2c())).ha();this.Z.ia("WordEditor.Ideas.Messenger.OpenPaneMessageHandler",()=>new hF(G.AFrameworkApplication.va)).ha();this.Z.ia("WordEditor.Ideas.Messenger.IdeasCallActionMessageHandler",()=>new wL(G.AFrameworkApplication.va,
this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ia("WordEditor.Ideas.Cards.CategorySelectionChangedMessageHandler",()=>new $k(this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),C)).ha();this.Z.ia("WordEditor.Ideas.StatsDialog.StatsDialogMessageHandler",()=>new fK(G.AFrameworkApplication.va)).ha();this.Z.ia("WordEditor.Ideas.SimilarityChecker.SimilarityCheckerMessageHandler",()=>new Og(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.Z.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.Z.resolve("Common.ICpuMeter"))).ha();this.Z.ia("WordEditor.Ideas.SimilarityChecker.SimilarityCancelMessageHandler",()=>new OB(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ia("WordEditor.Ideas.Messenger.InvokeLicensingUpsellMessageHandler",()=>new cK(this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();this.Z.ia("WordEditor.Ideas.Auth.GetAuthResultMessageHandler",()=>new vH(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"))).ha();
this.Z.ia("WordEditor.Ideas.Goals.GoalSelectedMessageHandler",()=>new lD(this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.IGoalUpdater"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();this.Z.ia("WordEditor.Ideas.EditorUpsell.TryPremiumPreviewMessageHandler",()=>new WJ(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewAPI"))).ha();
this.Z.ia("WordEditor.Ideas.EditorUpsell.BxPromoDismissedMessageHandler",()=>new qL(this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler"))).ha();this.Z.ia("WordEditor.Ideas.AddInLoader.AddInState",()=>new FB(G.AFrameworkApplication.userSessionId,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"),new eb.a,new eb.a,this.Z.resolve("WordEditor.EditorUpsell.ISimulateFreeUserGate"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).as("WordEditor.Ideas.AddInLoader.IAddInState").ha();
this.Z.ia("WordEditor.Ideas.Cards.ReleaseCategoryMessageSender",()=>new PH(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),C)).ha();this.Z.ia("WordEditor.Ideas.Cards.ReturnFocusMessageSender",()=>new Kw(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),G.AFrameworkApplication.va,C)).ha();this.Z.ia("WordEditor.Ideas.Cards.EditsMadeMessageSender",
()=>new Lh(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),C)).ha();this.Z.ia("WordEditor.Ideas.Cards.AnnotationResultStateSubscriptionMessageHandler",()=>new aK(this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),C)).ha();this.Z.ia("WordEditor.Ideas.Cards.AnnotationResultStateMessageSender",()=>new gF(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),
this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),C)).ha();this.Z.ia("WordEditor.CanvasContextual.OCVFeedbackManager",()=>new pH.a(G.AFrameworkApplication.Fe,G.AFrameworkApplication.pc,G.AFrameworkApplication.J)).ha();this.Z.ia("WordEditor.CanvasContextual.AugLoopAvertHandler",()=>new DB.a(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ia("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager",()=>new pL.a(G.AFrameworkApplication.pc,this.Z.resolve("Box4.Intent.IIntentRangeEditor"),
this.Z.resolve("Box4.ParagraphRenderEvents"))).ha();this.Z.ia("WordEditor.Ideas.ContentGenerationTelemetryLoggerImpl",()=>new iA(this.Z.resolve("Wac.Common.Utils.IOtelWrapper"))).ha();this.Z.ia("WordEditor.CanvasContextual.SummarizationIntentProvider",()=>new qH.a(this.Z.Ta("WordEditor.CanvasContextualProvider.UxManager"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.Ta("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.Ideas.ContentGenerationTelemetryLoggerImpl")));
this.Z.ia("WordEditor.Ideas.AIFeedbackIntentManager",()=>new fD(this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"))).ha();this.Z.ia("WordEditor.Ideas.ContentGenerationActor",()=>new Bn(G.AFrameworkApplication.va,this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),
G.AFrameworkApplication.pc,this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.nrb(),this.Z.resolve("WordEditor.Designer.Style.IParagraphDesigner"),this.Z.Ta("Common.ISystemInitiatedFeedback"),this.Z.resolve("Box4.Styles.IWACStyleReader"),this.Z.Oa("WordEditor.CanvasContextual.OCVFeedbackManager"),this.Z.Oa("WordEditor.CanvasContextual.AugLoopAvertHandler"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"),
this.Z.resolve("WordEditor.CanvasContextual.SummarizationIntentProvider"),this.Z.resolve("Box4.IUndoManager"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.ContentGenerationTelemetryLoggerImpl"),this.Z.Ta("WordEditor.CanvasContextual.AIFeedbackIntentProvider"),this.Z.resolve("WordEditor.Ideas.AIFeedbackIntentManager"),new id.a(()=>ib.StaticActiveAppFrame.za().kb.hd.ud),this.Z.resolve("Box4.ISelectionManager"),this.Z.Ta("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),
this.Z.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("Box4.IOutlineElementNavigator"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(S=>{S.isFeatureEnabled("Copilot",!1).then(ja=>{Bn.dde=ja;if(Bn.U$c||Bn.h1f||Bn.rce)try{this.Z.resolve("WordEditor.Ideas.ContentGenerationActor").Xb()}catch(ya){E.ULS.sendTraceTag(537408325,2250,10,"Failed to register ContentGenerationActor",
origin)}})});this.Z.ia("WordEditor.Ideas.Messenger.IPostMessageHandlers",()=>new RH(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.AddInLoadedMessageHandler"),this.Z.resolve("WordEditor.Ideas.CritiqueUpsell.CritiqueUpsellMessageHandler"),this.Z.resolve("WordEditor.Ideas.FloodgateMessageHandler"),this.Z.resolve("WordEditor.Ideas.Messenger.OpenPaneMessageHandler"),this.Z.resolve("WordEditor.Ideas.Cards.CategorySelectionChangedMessageHandler"),this.Z.resolve("WordEditor.Ideas.SimilarityChecker.SimilarityCheckerMessageHandler"),
this.Z.resolve("WordEditor.Ideas.Messenger.InvokeLicensingUpsellMessageHandler"),this.Z.resolve("WordEditor.Ideas.SimilarityChecker.SimilarityCancelMessageHandler"),this.Z.resolve("WordEditor.Ideas.StatsDialog.StatsDialogMessageHandler"),this.Z.resolve("WordEditor.Ideas.Auth.GetAuthResultMessageHandler"),this.Z.resolve("WordEditor.Ideas.TextPrediction.ITextPredictionComponent"),this.Z.resolve("WordEditor.Ideas.TextPrediction.TextPredictionDialogHandler"),this.Z.resolve("WordEditor.Ideas.EditorSettings.EditorSettingsDialogHandler"),
this.Z.resolve("WordEditor.Ideas.Goals.GoalSelectedMessageHandler"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.TryPremiumPreviewMessageHandler"),this.Z.resolve("WordEditor.Ideas.Cards.AnnotationResultStateSubscriptionMessageHandler"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.BxPromoDismissedMessageHandler"),this.Z.resolve("WordEditor.Ideas.Messenger.IdeasCallActionMessageHandler"),this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionMessenger"),this.Z.resolve("WordEditor.Ideas.WritersUnblockMessageHandler"),
this.Z.resolve("WordEditor.Ideas.SummarizationMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIGenerateFeedbacksMessageHandler"),this.Z.resolve("WordEditor.Ideas.AINavigateFeedbackMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIRewriteFeedbackMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIFeedbackPaneClosedMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIFeedbackReportFeedbackCardHandler"),this.Z.resolve("WordEditor.Ideas.AIFeedbackPaneOpenedMessageHandler"))).ha();this.Z.ia("WordEditor.Ideas.Signals.ISignalBeacon<Microsoft.Office.AugLoop.Signals.IdeasEngagementSignal>",
()=>new TH).ha();this.Z.ia("WordEditor.Ideas.Signals.IUserEngagementMonitor",()=>new SH(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("WordEditor.Ideas.Signals.ISignalBeacon<Microsoft.Office.AugLoop.Signals.IdeasEngagementSignal>"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"))).ha();this.Z.ia("WordEditor.ICanvasContextualFooterData",()=>new bF(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();this.Z.ia("WordEditor.Ideas.Cards.PaneToggleHandler",
()=>new OH(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),C)).ha();this.Z.ia("WordEditor.Ideas.AddInLoader.IIdeasAddIn",()=>new Op(this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),ib.StaticActiveAppFrame.za().Leb,G.AFrameworkApplication.J.RIf(Op.appId),G.AFrameworkApplication.J.jb("WordEditorIdeasSourceLocationOverrideResourceId"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),
this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor"),this.Z.resolve("WordEditor.Ideas.Goals.IGoalsSettingsAppender"),this.Z.resolve("WordEditor.Ideas.PaneSettingsProvider"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.PremiumPreviewDataAppender"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate"),G.AFrameworkApplication.J.$("DictationCorrectionsInEditorPaneIsEnabled"),G.AFrameworkApplication.J.$("KeypointsEnabledForHost"),!1,G.AFrameworkApplication.J.$("StatsDialogIsEnabled"),
G.AFrameworkApplication.J.$("TaskPaneBackgroundRefreshIsEnabled"),this.aqn())).ha();(null===(n=G.AFrameworkApplication.J)||void 0===n?0:n.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIToContinueReviewSuggestionsEnabled",!1))&&this.Z.ia("WordEditor.Ideas.AddInLoader.OpenEditorTeachingCallout",()=>new Gw(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInCommands"),this.Z.Ta("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),this.Z.Ta("Common.ISystemInitiatedFeedback"))).ha();this.Z.ia("WordEditor.Ideas.AddInLoader.IAddInCommands",
()=>new qs(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),G.AFrameworkApplication.J,this.Z.resolve("WordEditor.Ideas.AddInLoader.IIdeasAddIn"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("Common.IRibbonButtonUpdater"),this.Z.Ta("WordEditor.IIdeasCardsMessageHandler"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("WordEditor.Ideas.Goals.IGoalsSettingsAppender"),
G.AFrameworkApplication.pc,this.Z.resolve("WordEditor.Ideas.EditorUpsell.PremiumPreviewDataAppender"),this.Z.resolve("WordEditor.Ideas.PaneSettingsProvider"),this.Z.Ta("Common.ISystemInitiatedFeedback"))).ha();this.Z.ia("WordEditor.Ideas.CritiqueUpsell.ICritiqueUpsellParagraphNodeHelpers",()=>new jA(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),ib.StaticActiveAppFrame.za().kb.hd.ud,Tm.a.createInstance,this.Z.resolve("Box4.IProofingManager"),
G.AFrameworkApplication.J.jc("CritiqueTypeUpsellFindFirstParagraphTimeoutMs",30))).ha();this.Z.ia("WordEditor.Ideas.CritiqueUpsell.ISessionUpsellSettingsModifier",()=>new ey(this.Z.resolve("Box4.Proofing.ICritiqueTypeSettings"))).ha();this.Z.ia("WordEditor.Ideas.CritiqueUpsell.CritiqueUpsellMessageHandler",()=>new Vv(this.Z.resolve("WordEditor.Ideas.CritiqueUpsell.ICritiqueUpsellParagraphNodeHelpers"),Object(Zh.a)(),this.Z.resolve("WordEditor.Ideas.CritiqueUpsell.ISessionUpsellSettingsModifier"))).ha();
this.Z.ia("WordEditor.Ideas.WritersUnblockMessageHandler",()=>new EH(G.AFrameworkApplication.va));this.Z.ia("WordEditor.Ideas.SummarizationMessageHandler",()=>new DH(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.AIGenerateFeedbacksMessageHandler",()=>new ox(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.AINavigateFeedbackMessageHandler",()=>new HB(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.AIRewriteFeedbackMessageHandler",
()=>new gD(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.AIFeedbackPaneClosedMessageHandler",()=>new Jj(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.AIFeedbackReportFeedbackCardHandler",()=>new ZE(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.AIFeedbackPaneOpenedMessageHandler",()=>new xH(e.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ia("WordEditor.Ideas.Goals.IGoalsSettingsAppender",
()=>new LB(this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Goals.IGoalReader"),this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).ha();this.Z.ia("WordEditor.Ideas.EditorUpsell.PremiumPreviewDataAppender",()=>new Ew(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"))).ha();this.Z.ia("WordEditor.Ideas.PaneSettingsProvider",()=>new uH(this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsReader"),
this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.Ta("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"))).ha();this.Z.ia("WordEditor.Ideas.Cards.PremiumPreviewStateChangedMessageSender",()=>new tL(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),G.AFrameworkApplication.va)).ha();this.Z.ia("WordEditor.EditorUpsell.ExpiryCardMetricAggregator",()=>new ts(this.Z.resolve("WordEditor.SignalAggregator.ISignalAggregator"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater"),
this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"),this.Z.resolve("Common.IUlsWrapper"))).ha()}}BUl(){E.ULS.sendTraceTag(594597057,2250,50,"Disabling Editor in Word: {0}","Licensing defines Feature as disabled for Subscription type");this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInUtils").h6j(!1)}async qva(e){E.ULS.sendTraceTag(40957964,2250,50,"Editor package initialized: {0}",tv[e]);var n=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInUtils"),C=2!==e;e=n.kEm(e);n.h6j(!0);
n=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState");n.gdi=e;n.init(C);const S=this.Z.resolve("WordEditor.Ideas.AddInLoader.IIdeasAddIn");n=await this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate").YZf();S.init(n);G.AFrameworkApplication.J.$("WordEditorSessionLifetimeForIdeasIsEnabled")?S.load(e):this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInCommands").register(!0);this.jpl();this.Z.resolve("WordEditor.Ideas.Messenger.IPostMessageHandlers").register();this.Z.resolve("WordEditor.Ideas.Cards.PaneToggleHandler");
this.Z.resolve("WordEditor.Ideas.Cards.ReleaseCategoryMessageSender");this.Z.resolve("WordEditor.Ideas.Cards.ReturnFocusMessageSender");n&&this.Z.resolve("WordEditor.Ideas.Cards.PremiumPreviewStateChangedMessageSender");this.Z.resolve("WordEditor.Ideas.Cards.EditsMadeMessageSender");this.Z.resolve("WordEditor.Ideas.Cards.AnnotationResultStateMessageSender");e=this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor");this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").iPh(Object(ic.a)(e,
e.Fcg,"onAnnotationLocalStateChangedEventHandler"));if(C=this.aHm(C))this.eqg(C),this.Qxo(C);this.Z.ia("Office.Word.Online.Ideas.ToggleProofingActor",()=>new gy(()=>this.Z.resolve("WordEditor.IStatusBarUser"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Box4.Proofing.SuggestionRerenderer"))).ha();this.Z.resolve("Office.Word.Online.Ideas.ToggleProofingActor").Xb();this.lwo();this.Buo();this.juo();n&&this.Z.resolve("WordEditor.EditorUpsell.ExpiryCardMetricAggregator").initialize()}jpl(){if(this.pun())this.U5i(),
Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:"Office.Word.Online.Ideas.ProactivePaneOpenFromResumeTemplate"}));else if(G.AFrameworkApplication.J.$("EditorAutoOpenIsEnabled")){const e=this.iEm();e?E.ULS.sendTraceTag(574099531,2250,50,"Default launch of Editor is disabled. Status: {0}",e):this.U5i()}}pun(){let e=!1;if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorProactiveFromTemplateIsEnabled",!1)){const n=G.AFrameworkApplication.fMa;!Jp.a.Qf(n)&&Pg.a.vh().equals(n,
"tm55635225")&&(e=!0)}return e}U5i(){Jk.a.get_instance().Sk(7,()=>{G.AFrameworkApplication.va.Qb(ha.a.KBg,2,{ShowPaneBackgroundLoad:0},null)})}iEm(){return G.AFrameworkApplication.J.appSettings.BootActivityNavigationId?1:G.AFrameworkApplication.BI?2:G.AFrameworkApplication.J.$("IsDocumentOwner")?this.RMi()?this.aYf()?Un.Wfn()?6:0:5:4:3}nrb(){const e=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return e?e.getInstance(0):(E.ULS.sendTraceTag(574099532,2250,10,"Could not resolve wordCountManagerFactory"),
null)}HKm(){const e=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return e?e.getInstance(1):(E.ULS.sendTraceTag(556323991,2250,10,"Could not resolve wordCountManagerFactory"),null)}RMi(){const e=this.nrb();if(e&&-1!==e.EA){const n=G.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.EditorAutoOpenMinWordCount",100);return e.EA>=n}E.ULS.sendTraceTag(574198867,2250,50,"WordCountManager is not fully initialized: {0}",!e);return!0}aYf(){const e=ae.FocusManager.instance();
return!!e&&!(void 0===e.currentScope||null===e.currentScope)&&!(void 0===e.currentScope.name||null===e.currentScope.name)&&$w.AFrame.Do===e.currentScope.name}eqg(e){this.zxo(e);this.Mxo(e);const n=2===e;n&&this.Z.ia("WordEditor.Ideas.Callout.IIdeasCallout",()=>new rs(G.AFrameworkApplication.va,this.Z.resolve("Common.IDynamicScriptLoaderProvider"))).ha();this.Z.ia("WordEditor.Ideas.AutoTrigger.IIdeasAutoTrigger",()=>new MJ(G.AFrameworkApplication.va,n?this.Z.resolve("WordEditor.Ideas.Callout.IIdeasCallout"):
null,this.Z.resolve("WordEditor.Ideas.TriggerModels.IActiveIdeasTriggerModels"),this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"),this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),
this.yqn(e))).ha();this.Z.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager").CAj(this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor"));this.Z.resolve("WordEditor.Ideas.AutoTrigger.IIdeasAutoTrigger").initialize()}lwo(){const e=G.AFrameworkApplication.J.$("EditorGoalsEnabled"),n=this.nrb(),C=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocOwnerOmniPresentScoreExperimentEnabled",!1),S=G.AFrameworkApplication.J.$("IsDocumentOwner");S||G.AFrameworkApplication.$c("c02a6503;b1bh3863");
const ja=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isSkittleAutomation",!1);if(n){if(this.Z.ia("WordEditor.Ideas.WordCount.IWordCountOverseer",()=>new hy(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),n,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),new eb.a)).ha(),this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer").initialize(),this.Z.ia("WordEditor.Ideas.Localization.ICategoryStandardization",
()=>new QH).ha(),this.Z.ia("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler",()=>new ss(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),new eb.a,this.Z.resolve("WordEditor.Ideas.Localization.ICategoryStandardization"))).ha(),this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler").initialize(),(C||
S||ja)&&e){this.Z.Ta("CanvasContextual.ISkittleControllerV2").execute(kb=>{this.Z.Ta("Common.IZoomManager").execute(Oe=>{Oe.gY(kb.reposition)});var Rb=new Tv(this.Z.resolve("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression"));this.Z.ia("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent",()=>new IH(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),kb)).ha();const sc=new KH(vu.w7f,Rb),Fc=new WE(this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),
vu.qje),gd=new XE.a(ib.StaticActiveAppFrame.za().Leb),td=new NJ.a(this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("WordEditor.Sidetrack.SidetrackEventsActor")),Bd=new GB.a(G.AFrameworkApplication.va.mode);var wd=new wH.a(this.Z.resolve("WordEditor.IMainViewModeManager")),te=new fb.a;te.add(Fc);te.add(gd);te.add(td);te.add(Bd);te.add(Rb);Rb=new fb.a;Rb.add(wd);wd=this.Z.resolve("Office.Word.Online.Ideas.ToggleProofingActor");te.add(new YE(wd));te=new Qp(3,te,sc);wd=new Qp(7,
Rb,sc);const Le=[te,wd];this.Z.ia("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager",()=>new JH(this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent"),Le,sc)).ha();this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent").initialize();this.Z.resolve("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager").initialize()});let ya=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0);this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(kb=>
{kb.isFeatureEnabled("Copilot",!1).then(Rb=>{Bn.dde=Rb;(ya=ya&&Bn.rce)&&this.Rto()})})}}else E.ULS.sendTraceTag(558401300,2250,10,"WordEditorIdeasPackage - Failed to get word count manager so omnipresent editor score is not initialized")}Rto(){this.Z.Ta("CanvasContextual.IAIFeedbackSkittleController").execute(e=>{this.Z.Ta("Common.IZoomManager").execute(td=>{td.gY(e.reposition)});this.Z.Ta("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent").execute(td=>{td.XOh(e.reposition)});this.Z.ia("WordEditor.Ideas.AIFeedbackSkittle.IAIFeedbackSkittleComponent",
()=>new oA(G.AFrameworkApplication.va,e)).ha();var n=new Tv(this.Z.resolve("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression"));const C=new WE(this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),ft.qje),S=new Xv(this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),ft.wLn),ja=new XE.a(ib.StaticActiveAppFrame.za().Leb),ya=new NJ.a(this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("WordEditor.Sidetrack.SidetrackEventsActor")),kb=new GB.a(G.AFrameworkApplication.va.mode);
var Rb=new wH.a(this.Z.resolve("WordEditor.IMainViewModeManager"));const sc=new KH(ft.w7f,n);var Fc=new fb.a;Fc.add(C);Fc.add(S);Fc.add(ja);Fc.add(ya);Fc.add(kb);Fc.add(n);n=new fb.a;n.add(Rb);Rb=this.Z.resolve("Office.Word.Online.Ideas.ToggleProofingActor");Fc.add(new YE(Rb));Fc=new Qp(3,Fc,sc);Rb=new Qp(7,n,sc);const gd=[Fc,Rb];this.Z.ia("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager",()=>new tx(this.Z.resolve("WordEditor.Ideas.AIFeedbackSkittle.IAIFeedbackSkittleComponent"),gd,sc)).ha();
this.Z.resolve("WordEditor.Ideas.AIFeedbackSkittle.IAIFeedbackSkittleComponent");this.Z.resolve("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager").initialize()})}juo(){if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextualMessagingShadowTrafic",!1)){const e=new vn(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState")),n=new fb.a;n.add(e);const C=new SJ,S=[new Wy(5,n,C,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))];this.Z.ia("WordEditor.Ideas.TriggerModels.IContextualMessagingHandler",
()=>new FH(this.Z.Ta("Common.ISystemInitiatedFeedback"))).ha();this.Z.ia("WordEditor.Ideas.TriggerModels.IContextualMessagingTriggerManager",()=>new GH(S,C,this.Z.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").vaa,this.Z.resolve("WordEditor.Ideas.TriggerModels.IContextualMessagingHandler"))).ha();this.Z.resolve("WordEditor.Ideas.TriggerModels.IContextualMessagingTriggerManager").initialize()}}Mxo(e){const n=3===e||5===e?1:2;this.Z.ia("WordEditor.Ideas.TriggerModels.CritiqueAcceptTriggerModel",
()=>new XH(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"),G.AFrameworkApplication.va,n,1)).ha();this.Z.ia("WordEditor.Ideas.TriggerModels.CritiqueAcceptNoTypingTriggerModel",()=>new WH(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"),G.AFrameworkApplication.va,2,this.Z.resolve("Box4.ContentEditableViewTypingState"),1)).ha();this.Z.ia("WordEditor.Ideas.TriggerModels.PremiumPreviewSuppressionModel",
()=>new Ls(this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"))).ha();this.Z.ia("WordEditor.Ideas.TriggerModels.PremiumPreviewInProgressTriggerModel",()=>new YH(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewSuppressionModel"),G.AFrameworkApplication.va,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),1)).ha();this.Z.ia("WordEditor.Ideas.TriggerModels.PremiumPreviewExpiredTriggerModel",()=>
new lF(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewSuppressionModel"),G.AFrameworkApplication.va,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),this.Z.resolve("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression"),1)).ha();this.Z.ia("WordEditor.Ideas.TriggerModels.IActiveIdeasTriggerModels",()=>new iF(this.Z.resolve("WordEditor.Ideas.TriggerModels.CritiqueAcceptTriggerModel"),this.Z.resolve("WordEditor.Ideas.TriggerModels.CritiqueAcceptNoTypingTriggerModel"),
this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewInProgressTriggerModel"),this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewExpiredTriggerModel"),e,this.RMi(),this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"))).ha()}zxo(e){if(e)if(2===e)this.Z.ia("WordEditor.Ideas.TriggerModels.ISuppressionModel",()=>new kF).ha();else{this.Z.ia("WordEditor.Ideas.TriggerModels.ICrossSessionSuppressionHandler",()=>new jF(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();
const n=6===e?!1:!0;this.Z.ia("WordEditor.Ideas.TriggerModels.ISuppressionModel",()=>new Xq(G.AFrameworkApplication.va,n?this.Z.resolve("WordEditor.Ideas.TriggerModels.ICrossSessionSuppressionHandler"):null,18E5,2)).ha()}}aHm(e){return G.AFrameworkApplication.uiCulture.toLowerCase().startsWith("en")?4:e?0:9}aqn(){return G.AFrameworkApplication.uiCulture.toLowerCase().startsWith("en-us")&&G.AFrameworkApplication.J.$("WordEditorPerspectivesIsEnabled")}Qxo(e){const n=this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor");
6!==e&&4!==e||n.SJn()}yqn(e){return!!e&&2!==e}Buo(){if(G.AFrameworkApplication.J.$("StatsDialogIsEnabled")){this.Z.ia("WordEditor.DocumentDialog.IStatsDialogAnnotationHandler",()=>new aD(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),new eb.a,this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Common.IUlsWrapper"))).ha();var e=this.nrb(),n=this.HKm();this.Z.ia("WordEditor.DocumentDialog.IStatsDialogActor",()=>new EB(e,n,this.Z.resolve("WordEditor.DocumentDialog.IStatsDialogAnnotationHandler"),
this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),G.AFrameworkApplication.va,this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"))).ha();this.Z.Oa("WordEditor.DocumentDialog.IStatsDialogActor").Xb()}}static main(){G.AFrameworkApplication.hL||Object(qD.a)()&&
R.a.instance.Mc(new Un)}static Wfn(){const e=G.AFrameworkApplication.J.jb("UserPrincipalName");return e?e.toLowerCase().endsWith("linkedin.biz"):!1}}Object(F.a)(Un,"WordEditorIdeasPackage",Oa.a,[]);class QB extends pb.StandardDialog{constructor(e){super();this.VQe=e;this.Bd=0;this.Ke(1,CommonUIStrings.l_DialogClose)}iR(e){this.Iy(e,CommonUIStrings.l_DefaultDialogTitle,this.VQe,null,!1,!0)}}Object(F.a)(QB,"ErrorDialog",pb.StandardDialog,[932]);class mF{}Object(F.a)(mF,"LearningToolsExtraInfoContext",
null,[2039]);class Yv{static requestFullscreen(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.requestFullscreen?e.requestFullscreen():E.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():
document.exitFullscreen?document.exitFullscreen():E.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}}Object(F.a)(Yv,"FullscreenUtils",null,[]);var rD=d(90),ZH=d(1113),$H=d(25);class pA{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le,Oe,We,Xf){this.WFh=this.APe=0;this.zgh=this.tl=this._iframe=this.Z=this.BRa=null;this.PNn=Gg=>{if(Gg.data===rD.a.Uli)return E.ULS.sendTraceTag(20490002,306,50,"Postmessage sent with param: {0}",Gg.data),this.v3h(),!0;if(Gg.data===
rD.a.Ipo)return this.qqh=!0,this.UVl(),this.P2j(),!0;if(Gg.data===rD.a.aGo)Yv.requestFullscreen(this.Z);else if(Gg.data===rD.a.n4l)Yv.exitFullscreen();else{let Ph=null;try{Ph=JSON.parse(Gg.data)}catch(Aj){return E.ULS.sendTraceTag(21320706,306,100,"Postmessage generated exception: "+Aj),!1}if(Ph&&(Gg=Ph.storageIdReceivedToContentLoadedDurationInMs))return this.Qnh=!0,this.wNe=Gg,E.ULS.sendTraceTag(22905240,306,50,"contentLoadedDuration:{0}",this.wNe),!0}E.ULS.sendTraceTag(20490003,306,100,"Postmessage fired with irrelevant param");
return!1};this._title=e;this.e9b=n;this.If=C;this.nqa=S;this.Ym=ja;this.mCb=ya;this.Pac=kb;this.hQk=Rb;this.WDc=sc;this.KIc=Fc;this.VQe=gd;this.Qnh=!1;this.wNe=0;this.Zb=Bd;this.FKc=Tj.a.create().toString();this.LZe=wd;this.ugb=Oe;this.POk=td+"?appId="+Oe;this.tSk=te;this.Avh=Le;this.tbc=We;this.S$b=Xf;this.qqh=!1;this.vpk=ac.a.Eg(this.WDc).name;this.s1=!1}leb(){this.tl=(new Qj.a).create();this.tl.Bd=5;this.tl.Au=!1;this.tl.aM(null,null,null)}Eec(){this.tl&&(this.tl.close(),this.tl=null)}Tyn(){this.zgh=
new QB(this.VQe);this.zgh.iR(Na.a.l6i)}launch(e){E.ULS.sendTraceTag(2049E4,306,50,"Learning Tools service launched");this.Ym.start();this.APe=(new Date).getTime();this.leb();var n={};n.title=this._title;n.chunks=this.hQk;n.StartingChunkIndex=this.LZe.SelectionChunkIndex;n.StartingCharIndex=this.LZe.SelectionCharIndex;var C="",S="",ja="";this.tbc?(C={},C.data=n,n=Bf.c(C),C="&useV2Endpoint=1",this.S$b&&(S="&sendDocxFile=1",ja="&startIndex="+this.LZe.SelectionCharIndex)):n=Bf.c(n);S=this.nqa+"OneNoteS2SHandler.ashx?action="+
e+"&appId="+this.ugb+"&enabledConfig=WordEditorLearningToolsIsEnabled&"+G.AFrameworkApplication.rm+C+S+ja;ja={"Content-Type":"application/json; charset=utf-8"};ja.LearningToolsSessionId=this.FKc;this.If.Xj(S,2,n,ja,!1,2,ya=>{this.Ybb(ya)},ya=>{this.TU(ya)},e,void 0,void 0,void 0,this.Pac);e=this.POk+"&exitCallback="+rD.a.Uli+"&omkt="+this.vpk+"&sessionId="+this.FKc+"&showFeedback="+G.AFrameworkApplication.VE.toString();this.tSk&&(e+="&v=2");this.bzn(e)}Ybb(e){var n=pA.vxm(e.data.Pe);this.BRa={};this.s1=
!1;if(this.Avh)this.BRa.readerModel=n;else{e=Object(Jg.a)(String,n.url);const C=Object(Jg.a)(String,n.storageId),S=Object(Jg.a)(String,n.version);n=Object(Jg.a)(String,n.processingHost);if(!e){$H.b(20259850,200,10,"{0}",{["Desc"]:"NoUrl"});return}this.BRa.storageId=C;this.BRa.apiVersion=S;this.BRa.processingHost=n}this.P2j()}bzn(e){G.AFrameworkApplication.Wde=!0;this.Z=document.createElement("div");this._iframe=document.createElement("iframe");this.Z.appendChild(this._iframe);document.body.appendChild(this.Z);
pA.hOj(this.Z);pA.hOj(this._iframe);this._iframe.id="ImmersiveReader-iframe";this._iframe.title=this.KIc;this._iframe.tabIndex=0;this._iframe.src=e;this._iframe.setAttribute("allowfullscreen","true");this._iframe.setAttribute("aria-modal","true");this.uBn()}TU(e){this.bYj(!1);E.ULS.sendTraceTag(20259852,201,10,"{0}",this.bsm(e));this.Eec();5!==e.data.status||this.s1?this.Tyn():(this.s1=!0,this.v3h(),this.launch(Object(Jg.a)(String,e.data.state)))}bsm(e){let n=-1;e&&e.data&&(n=e.data.He);500===n?E.ULS.sendTraceTag(37065042,
201,10,"Failed to load the immersive reader for app {0} due to a 500 internal server error response from the LT service with LearningToolsSessionId {1}",this.ugb,this.FKc):408===n&&E.ULS.sendTraceTag(37065043,201,10,"Failed to load the immersive reader for app {0} due to a 408 request timeout from the LT service with LearningToolsSessionId {1}",this.ugb,this.FKc);return{["desc"]:"LT failure",["status"]:n,["LearningToolsSessionId"]:this.FKc}}uBn(){this.e9b.IUh(this.PNn)}P2j(){if(this.BRa&&this.qqh){this.Zb.bV("LearningToolsStaticReader");
this.bYj(!0);this.BRa.launchToPostMessageSentDurationInMs=this.Ym.Ri;var e={};let n="";if(this.Avh)if(this.tbc){const C=this.BRa.readerModel;C.launchToPostMessageSentDurationInMs=this.Ym.Ri;n="LinguisticModel";e.messageValue=C}else n="ReaderModel2",e.messageValue=this.BRa;else n="Data",e.messageValue=this.BRa;e.messageType=n;this.FLj(e);this._iframe&&(e=this.Zb.ie("LearningTools"),e.parent=$w.AFrame.UK,e.J$(()=>{this._iframe.focus()}),this.Zb.EN("LearningTools",!1));this.FLj({messageType:"SetFocus"})}}FLj(e){if(this._iframe&&
this._iframe.contentWindow){const n=N.a.getOrigin(this._iframe.src);this._iframe.contentWindow.postMessage(JSON.stringify(e),n)}}UVl(){this.Eec();const e=this.Zb.ie("LearningToolsStaticReader");e.parent=$w.AFrame.UK;e.J$(()=>{this._iframe.focus()});this.Z.style.visibility="visible";this._iframe.style.visibility="visible";this.Zb.EN("LearningToolsStaticReader",!1);E.ULS.sendTraceTag(20490001,306,50,"Learning Tools iFrame loaded");this.WFh=(new Date).getTime()-this.APe}bYj(e){const n=new ZH.a,C=new mF;
e?(C.RequestSucceeded=!0,C.DocumentCharCount=this.mCb,C.StartToDisplayIFrameDuration=this.WFh):C.RequestSucceeded=!1;n.ExtraInfoContext=C;this.Ym.Mep(n)}v3h(){tb.a.xD(this._iframe);tb.a.xD(this.Z);this.e9b.Xei();const e={};e.learningToolsSessionDurationInMs=(new Date).getTime()-this.APe;e.isContentLoaded=this.Qnh;e.contentLoadedDuration=this.wNe;this.Zb.bV("LearningTools");G.AFrameworkApplication.Wde=!1;E.ULS.sendTraceTag(21320707,306,50,JSON.stringify(e))}static hOj(e){e.style.position="absolute";
e.style.width="100%";e.style.height="100%";e.style.left="0";e.style.top="0";e.style.borderWidth="0";e.style.visibility="hidden";e.style.zIndex="1000";e.style.background="white"}static vxm(e){var n=null;e=({av:n}=Bf.d(e)).returnValue;n=Object(Jg.a)(Object,n);return n?n:($H.b(20259851,200,10,"{0}",{["desc"]:"CouldntParse",["serialized"]:e}),null)}}Object(F.a)(pA,"LearningToolsLauncher",null,[]);class sD{constructor(){this.LanguageRunsList=null;this.SelectionCharIndex=this.SelectionChunkIndex=0;this.LanguageRunsList=
new fb.a;this.SelectionCharIndex=this.SelectionChunkIndex=0}}Object(F.a)(sD,"LearningToolsDocumentData",null,[]);var tD=d(940);class iy{}Object(F.a)(iy,"LearningToolsLanguageRun",null,[]);class RB{static jgl(e){let n=null;var C=Ed.a.eb(e);if(!C.zb(8))throw Error("Could not locate page content node for given paragraph");for(C=Tm.a.At(C,C.origin);C.moveNext();)Af.ParagraphReader.Fh(C.iterator)&&(e=C.currentNode,e=this.rhl(e),n=this.AWk(e,n));return n}static AWk(e,n){null!=e&&(null==n&&(n=document.createElement("div")),
n.appendChild(e));return n}static gzm(e){var n=new Ed.a;n.set(e);n.zb(11);n.kd(11);var C="";n=e.Pd.Uw(n);if(null!=n){({listLevel:e}=uj.ListItemReader.Jr(uj.ListItemReader.De?e:e.hE));const S=n.Kx;switch(n.listType){case 0:switch(n.listStyle){case 1:C="decimal";break;case 2:C="loweralpha";break;case 3:C="lowerroman";break;case 4:C="upperalpha";break;case 5:C="upperroman";break;default:C="decimal"}C=`lt:${C};in:${e};li:${S}`;break;case 1:switch(n.listStyle){case 1:C="disc";break;case 2:C="circle";break;
case 3:C="square";break;default:C="disc"}C=`lt:${C};in:${e}`}}return C}static oIi(e){let n=e.isBold?"b:1;":"";n+=e.isItalic?"i:1;":"";n+=e.isUnderline?"u:1;":"";n+=e.isStrikethrough?"s:1;":"";n+=e.isSuperscript?"sup:1;":"";return n+=e.isSubscript?"sub:1;":""}static rhl(e){let n=null;const C=Af.ParagraphReader.text(e);let S=0;for(;null!=e.ra&&S<e.ra.length;){var ja=e.ra.Ub(S);var ya=ja.cp;var kb=S<e.ra.length-1?e.ra.Ub(S+1).cp:Af.ParagraphReader.textLength(e);let Rb="";null!=ja.formatting?Rb=this.oIi(ja.formatting.cache):
({formatting:ja}=e.ra.T8a(ja.cp),null!=ja&&(Rb=this.oIi(ja.cache)));kb=C.substring(ya,kb);0<kb.length&&(ya=document.createElement("span"),ya.setAttribute("style",Rb),ya.innerText=kb,null==n&&(n=document.createElement("p")),n.appendChild(ya));S++}null!=n&&Af.ParagraphReader.DX(e)&&n.setAttribute("style",this.gzm(e));return n}}Object(F.a)(RB,"ImmersiveReaderUtility",null,[]);class Zv{get k5m(){return`${ka.a.webServiceBase}OneNoteS2SHandler.ashx?action=${this.TPi}&appId=${this.j6}&enabledConfig=WordEditorLearningToolsIsEnabled&${G.AFrameworkApplication.rm}`}constructor(e,
n,C){this.nXl=e;this.OT=n;this.timeoutMs=C;this.j6="Word WAC";this.TPi="immersivereader"}launch(){const e=this.leb(WordEditorIntl.WordEditorStrings.l_LearningToolsLoadingMessage);this.G6l().then(n=>{e.close();return this.nzn(n)}).catch(n=>{E.ULS.sendTraceTag(509661463,209,10,"Immersive Reader failed to launch. Error msg: "+this.kfa(n));e.close();(new QB(WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage)).iR(Na.a.l6i)})}G6l(){return new Promise((e,n)=>{this.OT.Xj(this.k5m,1,null,null,!1,
2,C=>e(C.data.Pe),n,this.TPi,void 0,void 0,void 0,this.timeoutMs)})}async sCn(){if(window.immersiveReader)return window.immersiveReader;G.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?await appResourceLoader.loadChunk("immersiveReader"):await gc.a.instance.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("immersiveReader");return window.immersiveReader}async nzn(e){var n,C,S;const {["v0_7_0"]:{["launchAsync"]:ja,["CookiePolicy"]:ya}}=await this.sCn(),kb=null===(n=this.nXl.body.paragraphs.getFirstOrNullObject())||
void 0===n?void 0:n.psa();n={["title"]:(null===WordRibbonStrings||void 0===WordRibbonStrings?void 0:WordRibbonStrings.ImmersiveView)||"Immersive Reader",["chunks"]:[{["content"]:null===(C=RB.jgl(kb))||void 0===C?void 0:C.innerHTML,["mimeType"]:"text/html"}]};C={["uiLang"]:null===(S=G.AFrameworkApplication.J)||void 0===S?void 0:S.appSettings.UICulture,["cookiePolicy"]:ya.Enable,["allowFullscreen"]:!0};await ja(e,n,C)}leb(e){const n=(new Qj.a).create();n.Bd=5;n.Au=!1;n.message=e;n.aM(null,null,null);
return n}kfa(e){if("object"!==typeof e)return""+e;if("message"in e)return""+e.message;try{return JSON.stringify(e)}catch(n){return"'Could not JSON serialize the error'"}}}Object(F.a)(Zv,"ImmersiveReaderSDKLauncher",null,[]);class SB{constructor(){this.Ym=this.nqa=this.If=this.e9b=this.EGc=null;this.WDc=this.Pac=this.mCb=0;this.Zb=this.W8e=this.KIc=null;this.S$b=this.tbc=this.y0e=this.Cbf=!1;this.I5l=(e,n,C)=>{if(1===C)return qn.SessionStatusManager.instance.Jk?8:32;if(!Kf.a.instance||!Kf.a.instance.gb||
!Kf.a.instance.gb.currentSelection)return 8;if(this.oDp)return this.ERn.launch(),32;e=this.EGc.getSelection();this.S$b?Qc.a.iU(Sb.a.y0a,!0,this.BUb,this.FWb,e):(n=this.c4c(),C=this.VGi(e),e=this.rqm(n,C,e),n=this.tOm(e.LanguageRunsList),C=Of.a.qL(G.AFrameworkApplication.Et.zA),(new pA(C,this.e9b,this.If,this.nqa,this.Ym,this.mCb,this.Pac,n,this.WDc,this.KIc,WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage,this.W8e,this.Zb,e,this.Cbf,this.y0e,"Word WAC",this.tbc,this.S$b)).launch("learningtools"));
return 32};this.BUb=e=>{const n=new sD;e=this.Zfm(Object(Jg.a)(Js,e));n.SelectionCharIndex=e;e=Of.a.qL(G.AFrameworkApplication.Et.zA);(new pA(e,this.e9b,this.If,this.nqa,this.Ym,this.mCb,this.Pac,[],this.WDc,this.KIc,WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage,this.W8e,this.Zb,n,this.Cbf,this.y0e,"Word WAC",this.tbc,this.S$b)).launch("learningtools")};this.FWb=(e,n)=>{E.ULS.sendTraceTag(41418846,209,10,"Error saving the docx file, status code: "+n);this.BUb(e)}}get oDp(){return null!=
this.y6g?this.y6g:this.y6g=G.AFrameworkApplication.J.$("LearningToolsNewImmersiveReaderSDKIsEnabled")}get ERn(){return null!=this.P0g?this.P0g:this.P0g=(()=>new Zv(this.EGc,this.If,this.Pac))()}get name(){return"WordEditor.LearningToolsContentExtractor"}wc(){}init(){Rd.a.P2f&&(this.Xb(),this.EGc=gc.a.instance.nf("WordEditor.Extension.DocumentFactory").value.create(),this.e9b=tD.a.instance,this.If=G.AFrameworkApplication.Fe,this.nqa=ka.a.webServiceBase,this.Ym=G.AFrameworkApplication.ua.Vr.UXa("LoadResource",
"ImmersiveReader"),this.Pac=G.AFrameworkApplication.J.jc("LearningToolsTimeoutMs",3E4),this.WDc=G.AFrameworkApplication.lcid,this.KIc=WoncaIntl.WoncaStrings.L_ImmersiveView,this.W8e=G.AFrameworkApplication.J.jb("LearningToolsStaticUrl"),this.Zb=ae.FocusManager.instance(),this.y0e=G.AFrameworkApplication.J.$("WordEditorLearningToolsNewDataFlowIsEnabled"),this.tbc=G.AFrameworkApplication.J.$("LearningToolsV2EndpointIsEnabled"),this.S$b=G.AFrameworkApplication.J.$("LearningToolsSendDocxFileIsEnabled"));
this.Cbf=G.AFrameworkApplication.J.$("WordEditorLearningToolsReactUIIsEnabled")}c4c(){this.mCb=0;const e=this.EGc.body.paragraphs,n=e.length(),C=Array(n);for(let S=0;S<n;S++)C[S]=e._GetItem(S),this.mCb+=C[S].text.length;return C}Zfm(e){const n=e.paragraphs.getFirst();if(n){let C=0,S=0;const ja=this.EGc.body.paragraphs,ya=ja.length();for(let kb=0;kb<ya;kb++){const Rb=ja._GetItem(kb);if(n.psa().equals(Rb.psa()))return C+=this.VGi(e),C+=Rb.text.length?S:0;Rb.text.length?(C+=Rb.text.length+S,S=0):S++}}return 0}rqm(e,
n,C){const S=new sD;if(1===e.length&&!e[0].text.length)return n=new iy,n.Run="",S.LanguageRunsList.add(n),S;let ja=-1;C=C.paragraphs.getFirst();let ya=0;for(const Rb of e){e=Rb.language();for(let sc=0;sc<e.length;sc++){const Fc=e[sc],gd=Fc.Dc,td=Fc.end;var kb=Fc.lcid;let Bd=0;const wd=new iy;let te="und";try{te=ac.a.Eg(kb).name}catch(Le){E.ULS.sendTraceTag(25557076,209,10,"error "+Le+" while reading lcid: "+kb)}wd.Lang=te;kb=Rb.text.substring(gd,td);kb.length||Rb.isListItem?ya=0:ya++;2>=ya&&(td===
Rb.text.length||sc===e.length-1)&&(kb+="\n");!gd&&Rb.isListItem?Bd=SB.MSo(Rb,wd,kb):wd.Run=kb;S.LanguageRunsList.add(wd);ja++;C.psa().equals(Rb.psa())&&n>=gd&&n<=td&&(S.SelectionChunkIndex=ja,S.SelectionCharIndex=n-Fc.Dc+Bd)}}return S}dispose(){}Xb(){G.AFrameworkApplication.va.qa(pe.a.BUb,Ma.a.application,this.I5l)}VGi(e){let n=0;(e=e.Xo)&&0<e.count&&(n=e.K(0).zj);return n}tOm(e){const n=[];for(const C of e)n.push({["content"]:C.Run,["lang"]:C.Lang});return n}static MSo(e,n,C){const S=e.list,ja=e.listItem;
let ya="";S&&ja&&(ya=S.levelTypes[ja.level]?e.listItem.listString+" ":"\u2022 ");n.Run=ya+C;return ya.length}static main(){G.AFrameworkApplication.hL||R.a.instance.Mc(new SB)}}Object(F.a)(SB,"LearningToolsContentExtractorPackage",null,[0,1]);class vv{constructor(e,n){this.Ead=e;this.lb=n;this.Z=null;this.KDo=(C,S,ja)=>{if(1===ja)return this.iRo(this.lb.gb.currentSelection)?32:16;2===ja&&this.Z.Ta("WordEditor.INeuralRewriteMessageHandler").execute(ya=>{ya.Q_n()});return 32}}iRo(e){if(!this.npc(e)||
e.LWa)return!1;e=e.Qa;if(Af.ParagraphReader.en(e)||Ge.a.mf(e)||Ge.a.Zl(e)){switch((this.Ead.iKa(e)||G.AFrameworkApplication.lcid)&1023){case 9:return!0;case 10:if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}npc(e){return e.FL||2<e.length||!e.length||2===e.length&&!Ge.a.pl(e.Xc)||1===e.length&&Ge.a.pl(e.Xc)?!1:this.S0f(e.Qa)}S0f(e){return Af.ParagraphReader.Wb(e.node)?""!==Af.ParagraphReader.text(e.node).trim():
!1}get name(){return"WordEditor.NeuralRewrite"}wc(e){this.Z=e}init(){const e=G.AFrameworkApplication.J;(e.$("RewriteIsEnabled")||e.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled(Pu.a.ggj,!1).then(C=>{C&&G.AFrameworkApplication.va.fb(ha.a.rewrite,X.a.frame,this.KDo,1028);return null})})}dispose(){}static main(){R.a.instance.Mc(new vv(gc.a.instance.resolve("Box4.ILanguageReader"),
gc.a.instance.resolve("Box4.ISelectionManager")))}}Object(F.a)(vv,"NeuralRewritePackage",null,[0,1]);class Yq{constructor(e,n){this.Boa=this.ei=null;this.pfd=(C,S)=>{if(10===S.type&&(C="boolean"===typeof S.jA?S.jA?1:0:S.jA,this.Boa!==C)){S="";switch(C){case null:case 0:S="Session not connected to OCS.";break;case 1:S="Session connected to OCS.";break;case 2:S="Session connected to OCS (WPM).";break;default:E.ULS.shipAssertTag(523120715,337,!1,"Unexpected hint value {0}",C)}E.ULS.sendTraceTag(523120716,
337,50,S);this.Boa=C;this.wja.aV(oD.a.hcg)}};this.xMa=(C,S)=>{S.newState||(E.ULS.sendTraceTag(36806805,337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.Boa=null,this.wja.aV(oD.a.hcg))};this.Dzp=(C,S,ja,ya,kb)=>{if(1===ja)return 32;kb[V.a.Visible]=null!=this.Boa;switch(this.Boa){case null:case 0:kb[V.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsNotConnected;break;case 1:kb[V.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsConnected;break;case 2:kb[V.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsFluidConnected;
break;default:kb[V.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsNotConnected,E.ULS.shipAssertTag(523120717,337,!1,"Unexpected hint value {0}",this.Boa)}kb[Q.a.labelText]=kb[V.a.Value];return 32};this.ga=e;this.wja=n}init(e){e?(this.ei=e,this.ei.AO(this.pfd),this.ei.QZ(this.xMa),this.ga.fb(ha.a.gxj,Ma.a.application,this.Dzp,96)):E.ULS.sendTraceTag(36282374,306,10,"Null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.ei&&this.ei.sDa(this.pfd)}}Object(F.a)(Yq,"OcsConnectionStatusManager",
null,[10]);class uD{constructor(){this.Boa=this.ei=null;this.pfd=(e,n)=>{10===n.type&&("boolean"===typeof n.jA?this.Boa=e=n.jA?1:0:e=n.jA,this.Boa=e,E.ULS.sendTraceTag(508826904,337,50,"Ocs connection status:"+this.Boa))};this.xMa=(e,n)=>{n.newState||(E.ULS.sendTraceTag(508826903,337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.Boa=null)}}init(e){e?(this.ei=e,this.ei.AO(this.pfd),this.ei.QZ(this.xMa)):E.ULS.sendTraceTag(508826905,306,10,"Ocs State Manager null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.ei&&
this.ei.sDa(this.pfd)}}Object(F.a)(uD,"OcsStateManager",null,[10]);class Zt{constructor(){this.Z=null}get name(){return"WordEditor.OcsConnectionStatusPackage"}wc(e){this.Z=e;this.Z.ia("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager",()=>new Yq(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.IStatusBarUser"))).ha();this.Z.ia("WordEditor.OcsConnectionStatus.OcsStateManager",()=>new uD).ha()}init(){const e=this.Z.resolve("Common.IAppSettingsManager");this.U9m();e.$("WordEditorShowOcsConnectionStatus")&&
this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}U9m(){const e=this.Z.resolve("WordEditor.OcsConnectionStatus.OcsStateManager");this.Z.Ta("Box4.Presence.IRtcProxyProvider").execute(n=>{n.gD().continueWith(()=>{const C=n.gD().result;e.init(C)})})}Ho(){const e=this.Z.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager");this.Z.Ta("Box4.Presence.IRtcProxyProvider").execute(n=>{n.gD().continueWith(()=>{const C=n.gD().result;e.init(C)})})}dispose(){}static main(){R.a.instance.Mc(new Zt)}}
Object(F.a)(Zt,"OcsConnectionStatusPackage",null,[0,1]);var xL=d(1109);class $v{constructor(e,n){this.clientId=e;this.R0=n}}Object(F.a)($v,"VectorClockInfo",null,[]);class nF{constructor(e,n,C){this.R$b=e;this.fd=n;this.nxk=C}S5m(){let e=this.IKm();return e||(e=this.hKl(),e)?this.T5m(e):(E.ULS.sendTraceTag(25723860,381,10,"Cannot create client vector clock graph node."),!1)}iGi(){return this.Nui(this.R$b)}Nui(e){const n=this.i6d();if(n&&n.Vb(1)){do{const C=n.currentNode,S=C.getValue(hb.a.AFe);if(S==
e)return e=C.getValue(hb.a.R0),new $v(S,e)}while(n.Kf(1))}return null}Jhm(){const e=this.i6d();if(!e)return null;if(!e.Vb(1))return Zi.empty();const n=new fb.a;do{var C=e.currentNode;const S=C.getValue(hb.a.AFe);C=C.getValue(hb.a.R0);S?n.add(new $v(S,C)):E.ULS.sendTraceTag(25723861,381,15,"A vector clock node with null client id is present in the graph.")}while(e.Kf(1));return n}hKl(){const e=this.i6d();if(!e)return null;const n=new xL.a;n.setValue(hb.a.AFe,this.R$b);n.setValue(hb.a.R0,0);e.Wf(n,
1);return n}IKm(){const e=this.i6d();if(e&&e.Vb(1)){do{const n=e.currentNode;if(n.getValue(hb.a.AFe)==this.R$b)return n}while(e.Kf(1))}return null}T5m(e){if(!e)return E.ULS.sendTraceTag(25723862,381,10,"Client vector clock node is null."),!1;const n=e.getValue(hb.a.R0)+1;e.setValue(hb.a.R0,n);return!0}i6d(){var e=this.nxk();if(!e)return E.ULS.sendTraceTag(25723864,381,10,"Cannot get an iterator since page content node is null."),null;e=this.fd.osa(e,7,7);return e.Vb(33)?e:(E.ULS.sendTraceTag(25723865,
381,10,"Ocs Vector clock container node doesn't exist."),null)}}Object(F.a)(nF,"ClientGraphOcsVectorClockHandler",null,[1003]);class oF{constructor(e,n,C,S){this.doa=e;this.kyf=n;this.aZl=C;this.ALo=S}}Object(F.a)(oF,"VectorClockBroadcastData",null,[]);class aI{Eqm(e){if(!e)return E.ULS.sendTraceTag(25557077,381,15,"Unable to parse vector clock update message {0}",e),null;if(!e.SL1&&!e.SL2)return E.ULS.sendTraceTag(42243083,381,50,"Save Latency Message is null. [Message: {0}]",e),null;if(e.SL2)return this.xJi(e.SL2);
E.ULS.sendTraceTag(508833934,381,50,"Found save latency message with older SL1 format.");return this.xJi(e.SL1)}xJi(e){return new oF(new $v(e.VCE.I.toUpperCase(),e.VCE.V),e.E,e.ER,e.SAG)}oJm(e){return e?{SL2:{E:e.kyf,ER:e.aZl,SAG:e.ALo,VCE:{I:e.doa.clientId,V:e.doa.R0}}}:null}}Object(F.a)(aI,"OcsVectorClockRtcMessageConverter",null,[1002]);class pF extends Sys.EventArgs{constructor(e){super();this.lfl=e}}Object(F.a)(pF,"OcsVectorClockRtcEventArgs",Sys.EventArgs,[]);class vD{constructor(e){this.sa=
new eb.a;this.ei=null;this.Zbf=this.vi=!1;this.MCh=e}v2k(e){this.sa.addHandler("OnVectorClockRtcReceivedEventKey",e)}CCo(e){this.sa.removeHandler("OnVectorClockRtcReceivedEventKey",e)}k2k(e){this.sa.addHandler("OnSuccessfulSaveToOcsEventKey",e)}wCo(e){this.sa.removeHandler("OnSuccessfulSaveToOcsEventKey",e)}r2k(e){this.sa.addHandler("OnTransitionInToOcsEventKey",e)}zCo(e){this.sa.removeHandler("OnTransitionInToOcsEventKey",e)}s2k(e){this.sa.addHandler("OnTransitionOutOfOcsEventKey",e)}ACo(e){this.sa.removeHandler("OnTransitionOutOfOcsEventKey",
e)}init(e){this.vi?E.ULS.sendTraceTag(25557078,381,10,"Trying to initialize OcsVectorClock Rtc Notification Handler again after it's already initialized."):e?(this.vi=!0,this.ei=e,this.ei.AO((n,C)=>{this.y3n(C)})):E.ULS.sendTraceTag(25557079,381,10,"Null rtcProxy. Cannot initialize OcsVectorClock Rtc Notification Handler.")}uwc(e){this.ei&&e&&this.ei.oC(8,this.MCh.oJm(e))}y3n(e){8===e.type?(e=this.MCh.Eqm(e.jA))&&this.sa.raiseEvent("OnVectorClockRtcReceivedEventKey",new pF(e)):10===e.type?((e="boolean"===
typeof e.jA?e.jA:0!==e.jA)?this.Zbf||this.sa.raiseEvent("OnTransitionInToOcsEventKey"):this.Zbf&&this.sa.raiseEvent("OnTransitionOutOfOcsEventKey"),this.Zbf=e):11===e.type&&this.sa.raiseEvent("OnSuccessfulSaveToOcsEventKey")}}Object(F.a)(vD,"OcsVectorClockRtcNotificationHandler",null,[999]);class hK{constructor(e,n,C,S,ja){this.PGa=C;this.vG=S;this.RY=ja;this.mmh=(ya,kb)=>{n.D5n(kb.lfl)};this.lmh=()=>{n.y_n()};this.gyh=()=>{e.B4n()};this.zxh=()=>{e.qgg();n.qgg()};this.Axh=()=>{e.rgg();n.rgg()};this.Lwh=
()=>{e.Ile()}}ydm(){this.PGa.v2k(this.mmh);this.vG.pRd(this.lmh);this.PGa.k2k(this.gyh);this.PGa.r2k(this.zxh);this.PGa.s2k(this.Axh);this.RY.lRd(this.Lwh)}Rca(){this.PGa&&(this.PGa.CCo(this.mmh),this.PGa.wCo(this.gyh),this.PGa.zCo(this.zxh),this.PGa.ACo(this.Axh));this.vG&&this.vG.TDj(this.lmh);this.RY&&this.RY.Grg(this.Lwh)}}Object(F.a)(hK,"OcsVectorClockTelemetryEventForwarder",null,[]);class jy{constructor(e,n){this.VAb=e;this.nTn=n}}Object(F.a)(jy,"JournalEntry",null,[]);class wD{constructor(e,
n,C,S,ja,ya,kb){this.zia=!0;this.R$b=e;this.em=n;this.R4b=C;this.Abf=S;this.icg=ya;this.gF=kb}D5n(e){if(!this.zia){var n=this.gF(),C=e.doa.clientId;if(C===this.R$b)E.ULS.sendTraceTag(25723870,381,100,"Receiving own broadcast. Ignoring!");else if(this.Mvn(C))E.ULS.sendTraceTag(25723871,381,100,"Receiving vector clock broadcast from a WAC client {0}. Ignoring!",C);else{var S=this.R4b.Nui(C);S&&S.R0>=e.doa.R0?E.ULS.sendTraceTag(25723872,381,100,"Receiving late vector clock broadcast for client {0} with vector clock value {1}. Ignoring!",
C,e.doa.R0):this.Abf.Iz(new jy(e,n))}}}y_n(){if(!this.zia){var e=this.gF(),n=this.R4b.Jhm();if(n)for(const C of n){if(n=this.Abf.wdo(C.clientId,C.R0))for(const S of n)this.CFn(S,e)}else E.ULS.sendTraceTag(25798300,381,10,"Cannot fetch vector clocks from graph. Disabling OcsVectorClockTelemetryInboundManager."),this.zia=!0}}qgg(){E.ULS.sendTraceTag(36712913,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryInboundManager.");this.zia=!1}rgg(){E.ULS.sendTraceTag(36712914,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryInboundManager.");
this.zia=!0;this.Abf.qrl()}CFn(e,n){var C;n=n.getTime()-e.nTn.getTime();if(0>n)E.ULS.sendTraceTag(25723873,381,100,"Received content before broadcast for VC {0} of client {1}. Ignoring!",e.VAb.doa.R0,e.VAb.doa.clientId);else{var S=Math.round(e.VAb.kyf/1E3),ja=S+n,ya=null;ya=this.icg.Boa;var kb=null===(C=G.AFrameworkApplication.J)||void 0===C?void 0:C.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldTriggerFluidCoauthSurvey",!1);G.AFrameworkApplication.$c("7d2eh734;0egbh454");kb&&2==ya&&(C=
gc.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&C.execute(Rb=>{Rb.logActivity("FluidOnWebCoauthSentimentSurvey",null)});E.ULS.sendTraceTag(25723874,381,50,"Ocs Replication: {0}",wD.Fsf(e.VAb.doa.clientId,this.R$b,e.VAb.doa.R0,S,n,ja,ya))}}Mvn(e){return(e=this.em.hA.ojc(wD.Qlm(e)))&&e.Capabilities?e.Capabilities.SupportsAppInnerLoop:!1}static Qlm(e){return"{"+e.toLowerCase()+"}"}static Fsf(e,n,C,S,ja,ya,kb){return{["S"]:e,["R"]:n,["V"]:C,["OT"]:kb,["ST"]:S,["RT"]:ja,["T"]:ya}}}Object(F.a)(wD,
"OcsVectorClockTelemetryInboundManager",null,[]);var TB=d(1141);class iK extends TC.a{constructor(e){super();this.xzk=e}get index(){return 0}run(){this.xzk()}QI(){this.r0()}}Object(F.a)(iK,"OcsVectorClockUpdateProcessor",TC.a,[]);class ux{constructor(e,n,C,S,ja,ya){this.vi=!1;this.zia=!0;this.Q6b=this.Y0e=null;this.Bbf=!0;this.VBp=()=>{this.zia||this.Bbf||(this.R4b.S5m()?this.Bbf=!0:(E.ULS.sendTraceTag(25557084,381,10,"Cannot update vector clock graph node. Disabling OcsVectorClockTelemetryOutboundManager."),
this.zia=!0))};this.P9=e;this.R4b=n;this.PGa=C;this.icg=ja;this.gF=ya}init(){this.vi?E.ULS.sendTraceTag(25557082,381,10,"Trying to initialize OcsVectorClockTelemetryOutboundManager again after it's already initialized."):(this.J2m(),this.vi=!0)}PLo(){const e=this.R4b.iGi();e?(TB.a.StaticVarVectorClockClientId=e.clientId,TB.a.StaticVarVectorClockValue=e.R0):(TB.a.StaticVarVectorClockClientId=null,TB.a.StaticVarVectorClockValue=null);TB.a.StaticVarFirstEditTime=new Date}J2m(){this.Y0e=new iK(this.VBp);
this.P9.Zua(this.Y0e,7)}Ile(){this.PLo();this.zia||this.Q6b||(this.Q6b=this.gF(),this.Bbf=!1,this.Y0e.QI())}B4n(){!this.zia&&this.Q6b&&(this.mfl(),this.Q6b=null)}qgg(){E.ULS.sendTraceTag(36712918,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryOutboundManager.");this.Q6b=null;this.zia=!1}rgg(){E.ULS.sendTraceTag(36712919,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryOutboundManager.");this.zia=!0}mfl(){var e;if(!this.zia){var n=this.R4b.iGi();if(n){var C=1E3*(this.gF().getTime()-
this.Q6b.getTime());n=new oF(n,C,0,"{CCCCCCCC-CCCC-CCCC-CCCC-FFFFFFFFFFFF}");this.PGa.uwc(n);C=null===(e=G.AFrameworkApplication.J)||void 0===e?void 0:e.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldTriggerFluidCoauthSurvey",!1);G.AFrameworkApplication.$c("7d2eh734;0egbh454");e=null;e=this.icg.Boa;C&&2==e&&(C=gc.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&C.execute(S=>{S.logActivity("FluidOnWebCoauthSentimentSurvey",null)});E.ULS.sendTraceTag(36712920,381,50,"Vector clock broadcast: {0}",
ux.Fsf(n.doa.clientId,n.doa.R0,n.kyf,e))}else E.ULS.sendTraceTag(25557086,381,10,"Unable to get self vector clock from graph. Disabling OcsVectorClockTelemetryOutboundManager."),this.zia=!0}}static Fsf(e,n,C,S){return{["S"]:e,["V"]:n,["OT"]:S,["ST"]:C}}}Object(F.a)(ux,"OcsVectorClockTelemetryOutboundManager",null,[]);var jK=d(1946);class ak{constructor(){this.cKc=new fd.a;this.EGd=new fd.a}Iz(e){const n=e.VAb.doa.clientId,C=e.VAb.doa.R0;let S;({value:S}=this.cKc.Ec(n,S)).returnValue||(S=new jK.a,
this.cKc.W(n,S));if(30<=S.count)E.ULS.sendTraceTag(25723905,381,50,"Already {0} pending entries in the journal for client {1}. Ignoring the new entry with vector clock value {2}!",S.count,n,C);else{var ja;({value:ja}=this.EGd.Ec(n,0)).returnValue&&ja>=C||(S.enqueue(e),this.EGd.W(n,C))}}wdo(e,n){let C;if(!({value:C}=this.cKc.Ec(e,C)).returnValue||!C||!C.count)return null;for(e=new fb.a;!C.isEmpty;){const S=C.$U();if(S.VAb.doa.R0>n)break;e.add(S);C.dequeue()}return e}qrl(){for(const e of this.cKc.keys)this.cKc.remove(e);
for(const e of this.EGd.keys)this.EGd.remove(e)}}Object(F.a)(ak,"VectorClockJournal",null,[895]);class to{constructor(){this.Z=null;this.Np=()=>{const e=ib.StaticActiveAppFrame.za().kb.Qc;return e?e.vd:null}}get name(){return"WordEditor.OcsVectorClockTelemetry"}get clientId(){return G.AFrameworkApplication.userSessionId.toUpperCase()}wc(e){this.Z=e;e.ia("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler",()=>new nF(this.clientId,e.resolve("Box4.Graph.IGraphIteratorFactory"),this.Np)).ha();
e.ia("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter",()=>new aI).ha();e.ia("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler",()=>new vD(e.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter"))).ha();e.ia("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal",()=>new ak);e.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager",()=>new ux(e.resolve("Box4.Graph.IGraphTransactionManager"),e.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),
e.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),e.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),e.resolve("WordEditor.OcsConnectionStatus.OcsStateManager"),()=>new Date)).ha();e.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager",()=>new wD(this.clientId,wg.a.xd(),e.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),e.resolve("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal"),
e.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),e.resolve("WordEditor.OcsConnectionStatus.OcsStateManager"),()=>new Date)).ha();e.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder",()=>new hK(e.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager"),e.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager"),e.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),
CJ.a.instance,e.resolve("Box4.ContentEditableViewEventSource"))).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){this.n7m();const e=this.Z.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler");this.Z.Ta("Box4.Presence.IRtcProxyProvider").execute(n=>{n.gD().continueWith(()=>{const C=n.gD().result;e.init(C)})});this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder").ydm()}n7m(){this.Z.resolve("Common.IAppSettingsManager");
this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager").init();this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager")}dispose(){if(this.Z){var e=this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder");e&&e.Rca()}}static main(){R.a.instance.Mc(new to)}}Object(F.a)(to,"OcsVectorClockTelemetryPackage",null,[0,1]);var wv=d(1798);class xD{}xD.Cho="Microsoft.Office.WordOnline.ProactiveUxOpenedCooldownMilliseconds";
xD.Bho="Microsoft.Office.WordOnline.ProactiveUxEngagedCooldownMilliseconds";Object(F.a)(xD,"Constants",null,[]);class Vg{constructor(e,n=null){this.kOc=new fb.a;this.Aa=e;this.gF=n?n:()=>new Date;this.oSk=this.Aa.getIntFeatureGate(xD.Cho,24E4);this.mSk=this.Aa.getIntFeatureGate(xD.Bho,6E4)}CAj(e){this.kOc.contains(e)||this.kOc.add(e)}Qif(e,n){if(1===this.kOc.count&&this.kOc.K(0).id===e)n();else{E.ULS.sendTraceTag(572339906,3025,50,"{0} attempted to trigger proactively",e);var C=this.gF(),S=null,ja=
null,ya=null;for(const kb of this.kOc){if(kb.id===e&&kb.Vsc){E.ULS.shipAssertTag(572592797,3025,!1,"{0} is already open",e);return}this.NXi(kb.Vsc,S?S.Vsc:null)&&(S=kb);this.NXi(kb.l_c,ja?ja.l_c:null)&&(ja=kb)}S&&this.XRj(C,S.Vsc,this.oSk)?ya=S:ja&&this.XRj(C,ja.l_c,this.mSk)&&(ya=ja);ya?E.ULS.sendTraceTag(572838542,3025,50,JSON.stringify({mSp:e,LMp:ya.id,MMp:ya.Vsc,KMp:ya.l_c})):n()}}NXi(e,n){return!!e&&(!n||e>n)}XRj(e,n,C){return!!n&&+e-+n<C}}Object(F.a)(Vg,"ProactiveUxManager",null,[925]);class bI{get name(){return"WordEditor.ProactiveUxGovernance"}init(){}wc(e){e?
e.ia("WordEditor.ProactiveUxGovernance.IProactiveUxManager",()=>new Vg(G.AFrameworkApplication.J)).ha():E.ULS.shipAssertTag(572838541,3025,!1)}dispose(){}}Object(F.a)(bI,"PackageManager",null,[0,1]);class kK{constructor(e){this.name=e;this.gii=1;this._lcidMap=[]}AYk(e,n){if(!n)throw Error.argumentNull(n.toLocaleString());this._lcidMap[e]=n}t5d(e){return this._lcidMap[e&1023]}isValid(){return this.name&&this._lcidMap?!0:!1}}Object(F.a)(kK,"LanguageModel",null,[1048,1047]);class yD{constructor(){this.Nvg=
this.nrc=this.hZc=this.iwc=this.JNg=0}isValid(){return 0>=this.JNg||0>=this.iwc||0>=this.Nvg||this.nrc>this.iwc?!1:!0}}Object(F.a)(yD,"ObjectCountParameterSet",null,[1047]);class lK{constructor(){this.Tsk=this.Qsk=this.Zsk=this.Ysk=0}create(e){switch(e){case 1:return this.bFl();default:throw Error.notImplemented("algorithmType");}}bFl(){const e=new kK("Default language model based on word, image and table count");this.qc(e,0,0);this.qc(e,1,138);this.qc(e,2,184);this.qc(e,3,218);this.qc(e,4,158);this.qc(e,
5,166);this.qc(e,6,199);this.qc(e,7,179);this.qc(e,8,184);this.qc(e,9,228);this.qc(e,10,218);this.qc(e,11,161);this.qc(e,12,195);this.qc(e,13,187);this.qc(e,14,161);this.qc(e,15,179);this.qc(e,16,188);this.qc(e,17,193);this.qc(e,18,193);this.qc(e,19,202);this.qc(e,20,199);this.qc(e,21,166);this.qc(e,22,181);this.qc(e,23,228);this.qc(e,24,188);this.qc(e,25,184);this.qc(e,26,180);this.qc(e,27,180);this.qc(e,28,180);this.qc(e,29,199);this.qc(e,30,193);this.qc(e,31,166);this.qc(e,32,138);this.qc(e,33,
228);this.qc(e,34,184);this.qc(e,35,184);this.qc(e,36,180);this.qc(e,37,161);this.qc(e,38,180);this.qc(e,39,180);this.qc(e,40,228);this.qc(e,41,138);this.qc(e,42,193);this.qc(e,43,138);this.qc(e,44,138);this.qc(e,45,166);this.qc(e,46,228);this.qc(e,47,180);this.qc(e,48,228);this.qc(e,49,228);this.qc(e,50,228);this.qc(e,51,228);this.qc(e,52,228);this.qc(e,53,228);this.qc(e,54,202);this.qc(e,55,184);this.qc(e,56,199);this.qc(e,57,228);this.qc(e,58,228);this.qc(e,59,228);this.qc(e,60,228);this.qc(e,
61,179);this.qc(e,62,228);this.qc(e,63,184);this.qc(e,64,184);this.qc(e,65,228);this.qc(e,66,228);this.qc(e,67,184);this.qc(e,68,184);this.qc(e,69,228);this.qc(e,70,228);this.qc(e,71,228);this.qc(e,72,228);this.qc(e,73,228);this.qc(e,74,228);this.qc(e,75,228);this.qc(e,76,228);this.qc(e,77,228);this.qc(e,78,228);this.qc(e,79,228);this.qc(e,80,166);this.qc(e,81,228);this.qc(e,82,228);this.qc(e,83,228);this.qc(e,84,228);this.qc(e,85,193);this.qc(e,86,218);this.qc(e,87,228);this.qc(e,88,228);this.qc(e,
89,228);this.qc(e,90,228);this.qc(e,91,228);this.qc(e,92,228);this.qc(e,93,228);this.qc(e,94,228);this.qc(e,95,228);this.qc(e,96,228);this.qc(e,97,228);this.qc(e,98,228);this.qc(e,99,228);this.qc(e,100,228);this.qc(e,101,228);this.qc(e,102,228);this.qc(e,103,228);this.qc(e,104,228);this.qc(e,105,228);this.qc(e,106,228);this.qc(e,107,228);this.qc(e,108,228);this.qc(e,109,228);this.qc(e,110,228);this.qc(e,111,228);this.qc(e,112,228);this.qc(e,113,228);this.qc(e,114,228);this.qc(e,115,228);this.qc(e,
116,228);this.qc(e,117,228);this.qc(e,118,228);this.qc(e,119,228);this.qc(e,120,228);this.qc(e,121,228);this.qc(e,122,228);this.qc(e,124,228);this.qc(e,126,228);this.qc(e,127,228);this.qc(e,128,228);this.qc(e,129,228);this.qc(e,130,228);this.qc(e,131,228);this.qc(e,132,228);this.qc(e,133,228);this.qc(e,134,228);this.qc(e,135,228);this.qc(e,136,228);this.qc(e,140,228);this.qc(e,145,228);this.qc(e,146,228);this.qc(e,147,228);return e}qc(e,n,C){e.AYk(n,Object.assign(new yD,{JNg:C,iwc:this.Ysk,Nvg:this.Zsk,
hZc:this.Qsk,nrc:this.Tsk}))}}Object(F.a)(lK,"LanguageModelFactory",null,[1009]);class Ud{constructor(){this.Myj=this.mVf=this.wNb=0}}Object(F.a)(Ud,"ReadingTimeValue",null,[]);class ky{constructor(){this.gii=this.Agf=1;this.HFg=this.cTf=this.pNg=this.WHg=-1}}Object(F.a)(ky,"ReadingTimeOutput",null,[]);class qF{constructor(){this.Xvh=!1;this.yxl=(e,n)=>n.wNb>e.wNb?1:e.wNb>n.wNb?-1:0}get Agf(){return 1}ZLf(e,n,C){if(!e)throw Error.argumentNull("ReadingTimeInput");if(!n)throw Error.argumentNull("ObjectCountParameterSet");
if(!C)throw Error.argumentNull("Language model is null");var S=new fb.a,ja=0;for(var ya=0;ya<e.Hab.count;ya++){var kb=C.t5d(e.Hab.K(ya));void 0!==kb&&null!==kb?ja+=e.hBb.K(ya)/C.t5d(e.Hab.K(ya)).JNg:this.Xvh||(this.Xvh=!0,E.ULS.sendTraceTag(41554646,338,50,"Language in paragraph is not supported in language model and is holding {0} words",e.hBb.K(ya)))}this.pef(S,ja,0);ja=C=0;ya=n.iwc;0<n.hZc&&(C=Math.floor((n.iwc-n.nrc)/n.hZc),ja=(n.iwc-n.nrc)%n.hZc,ya=n.nrc);ya=Math.max(0,(e.zL-C)*ya);for(kb=C;kb>=
Math.max(0,C-e.zL+1);--kb)ya+=n.nrc+ja+kb*n.hZc;this.pef(S,ya/60,1);this.pef(S,e.Jca*n.Nvg/60,2);e=this.Dkl(S);S.Sc(this.yxl);n=this.Ekl(S);e=Object.assign(new ky,{Agf:this.Agf,gii:1,WHg:e});n=Math.round(n);for(const Rb of S){S=Rb.mVf+(0<n?1:0);switch(Rb.Myj){case 0:e.pNg=S;break;case 1:e.cTf=S;break;case 2:e.HFg=S}0<n&&n--}return e}pef(e,n,C){e.add(Object.assign(new Ud,{Myj:C,mVf:this.jEi(n,Math.floor),wNb:n%1}))}Dkl(e){let n=0;for(const C of e)n+=C.mVf+C.wNb;return this.jEi(n,Math.ceil)}Ekl(e){let n=
0;for(const C of e)n+=C.wNb;return n}jEi(e,n){e=n(e);if(!this.isSafeInteger(e)||0>e)throw Error.argumentOutOfRange("result is not a positive safe integer");return e}isSafeInteger(e){return isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=this.MAX_SAFE_INTEGER}get MAX_SAFE_INTEGER(){return 9007199254740991}}Object(F.a)(qF,"ObjectCountReadingTimeStrategy",null,[927]);class rF{constructor(e,n){if(!e)throw Error.argumentNull("IReadingTimeStrategy");if(!n)throw Error.argumentNull("ILanguageModel");if(!n.isValid())throw Error.argument("ILanguageModel");
this.pKk=e;this.NYe=n}ZLf(e){if(this.isValid(e)){if(this.qmn(e))return new ky;if(!this.C$k(e))throw Error.argument("Input fields are in invalid state");}else throw Error.argument("ReadingTimeInput is null");let n=this.NYe.t5d(e.LCID);if(void 0===n||null===n)n=this.NYe.t5d(0);return this.pKk.ZLf(e,n,this.NYe)}isValid(e){return e?!0:!1}qmn(e){return 0>e.zL&&0>e.Jca&&!e.Hab&&!e.hBb}C$k(e){return 0<=e.zL&&0<=e.Jca&&!!e.LCID}}Object(F.a)(rF,"ReadingTimeAlgorithm",null,[926]);class mK{constructor(e){this.lrh=
e}create(e){if(!this.lrh)throw Error.argumentNull("ILanguageModelFactory");switch(e){case 1:return this.createInstance(new qF,this.lrh.create(e));default:throw Error.notImplemented("WordCount");}}createInstance(e,n){if(!e)throw Error.argumentNull("IReadingTimeStrategy");if(!n)throw Error.argumentNull("LanguageModel");return new rF(e,n)}}Object(F.a)(mK,"ReadingTimeFactory",null,[892]);var nK=d(380);class qA{constructor(){this.Evb=this.Cvb=this.numWords=this.Oip=this.e5m=this.cLp=this.pZa=-1}}Object(F.a)(qA,
"ReadingTimeStats",null,[945]);class cI{constructor(){this.Y8=new qA;this.u8=new qA;this.eak=this.dak=!1}get Phj(){return this.akc(this.u8.numWords,this.Y8.numWords,"WC",this.N$c())}get Hpo(){return this.$Lf(this.u8.pZa,this.Y8.pZa,this.u8.numWords+this.u8.Cvb+this.u8.Evb,this.Y8.numWords+this.Y8.Cvb+this.Y8.Evb,"RTSB")}get Epo(){return this.$Lf(this.u8.pZa,this.Y8.pZa,this.u8.numWords+this.u8.Cvb+this.u8.Evb,this.Y8.numWords+this.Y8.Cvb+this.Y8.Evb,"RTDB",!0)}get Fpo(){return this.VHm(this.u8.pZa,
this.Y8.pZa,this.u8.numWords+this.u8.Cvb+this.u8.Evb,this.Y8.numWords+this.Y8.Cvb+this.Y8.Evb)}get Dpo(){return this.N$c()?WordEditorIntl.WordEditorStrings.L_ReadingTimeStatsDialogSelectionDescription:WordEditorIntl.WordEditorStrings.L_ReadingTimeStatsDialogDescription}usi(e,n,C,S){return S?this.lMg(e,n,C):this.Ltd(n,C)}akc(e,n,C,S){return this.usi(e,n,C,S).toLocaleString()}aMf(e,n,C,S,ja,ya,kb=!1){e=this.usi(e,n,ja,ya);C=ya?C:S;S=Math.floor(e/1440);ja=e%1440;e=Math.floor(ja/60);ja%=60;if(0<S)return e?
String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultComposite,String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultDay,S),String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,e)):String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultDay,S);if(0<e)return ja?String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultComposite,String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,e),String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMin,
ja)):String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,e);n=ya&&60>n&&!kb?WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMinWithoutAbbreviation:WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMin;return!ja&&0<C?WordEditorIntl.WordEditorStrings.L_ReadingTimeLessThanOneMin:String.format(n,ja)}$Lf(e,n,C,S,ja,ya=!1){const kb=this.N$c(),Rb=this.aMf(e,n,C,S,ja,kb);e=kb?this.aMf(e,n,C,S,ja,!1):Rb;n=ya?WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionDialogBox:WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionStatusBar;
ya=ya?e:WordEditorIntl.WordEditorStrings.L_ReadingTimeStatusBar;ya=kb?n:ya;return kb?String.format(ya,Rb,e):String.format(ya,Rb)}VHm(e,n,C,S){const ja=this.aMf(e,n,C,S,"RTDT",this.N$c(),!0);return this.N$c()?String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionDialogBoxTitle,ja):this.$Lf(e,n,C,S,"RTDT")}lMg(e,n,C){e=this.Ltd(e,C);return e>n?(this.eak||(this.eak=!0,E.ULS.sendTraceTag(40916112,338,15,"Sel>Total for {0}",C)),n):e}Ltd(e,n){0>e&&!this.dak&&(this.dak=!0,E.ULS.sendTraceTag(40916113,
338,15,"{0}<0",n));return Math.max(e,0)}N$c(){return 0<this.u8.numWords+this.u8.Cvb+this.u8.Evb}}Object(F.a)(cI,"ReadingTimeStatsFacade",null,[]);class sF{}sF.Gpo="ReadingTimeButton";Object(F.a)(sF,"ReadingTimeConstants",null,[]);class dI{constructor(e,n,C,S,ja,ya){this.oIc=this.P7b=!1;this.oXe=!0;this.fKd="";this.oze=(kb,Rb,sc)=>{if(1===sc)return this.Eoc?32:8;kb=this.ee.Xf("UserAction","Show Reading Time Dialog.");kb.start();Rb=this.Htj();if(!Rb||0>Rb.Y8.pZa)return 8;this.R1.MBa&&E.ULS.sendTraceTag(40916104,
338,50,"Open reading time dialog with total reading time of {0}.",Rb.Y8.pZa);sc=new pb.StandardDialog;sc.Bd=0;sc.Cna(Rb.Fpo,String.format(Rb.Dpo,Rb.Epo),null);kb.stop();return 32};this.HCe=(kb,Rb,sc)=>{if(1===sc)return this.MBa?32:8;this.Eoc?this.HUl():this.d0l();ib.StaticActiveAppFrame.za().eJ({ShowReadingTime:"CheckboxModel"});return 32};this.Ire=(kb,Rb,sc,Fc,gd)=>{if(1===sc)return this.MBa?32:8;gd[Fa.a.On]=this.Eoc;return 32};this.Hre=(kb,Rb,sc,Fc,gd)=>{if(1===sc)return 32;gd[gh.a.Visible]=this.fKd!==
WordEditorIntl.WordEditorStrings.L_ReadingTimeHidden;gd[gh.a.LabelText]=this.fKd;return 32};this.v2n=()=>{this.Zsd()};this.Smj=()=>{this.Zsd()};this.R1=e;this.mPc=n;this.JNe=S;this.KNe=C;this.MIb=ja;this.ee=ya;this.R1.J2k(this.v2n);this.mPc.MBa&&this.mPc.RPh(this.Smj);this.R1.RPh(this.Smj);this.Zsd()}get Suf(){return!Dk.a.C7}Xb(){const e=G.AFrameworkApplication.va;e.qa(ha.a.oze,Ma.a.view,this.oze);e.fb(ha.a.Hre,Ma.a.application,this.Hre,96);e.qa(ha.a.HCe,Ma.a.application,this.HCe);e.fb(ha.a.Ire,Ma.a.application,
this.Ire,96)}d0l(){this.MBa&&(this.QQj(!0),this.Qwe(!0),this.Zsd())}HUl(){this.QQj(!1);this.Qwe(!1);this.Zsd()}get Eoc(){this.P7b||(this.oXe=this.JNe("WACReadingTimeEnabled",this.Suf),this.P7b=!0);return this.oXe}QQj(e){this.oXe=e}get MBa(){return this.R1.MBa}get yH(){return null!=this.Y3g?this.Y3g:this.Y3g=(()=>this.MIb())()}Htj(){const e=new cI;this.i9j(e.Y8,this.R1);this.mPc.MBa&&this.i9j(e.u8,this.mPc);return e}i9j(e,n){e.pZa=n.Aza.WHg;e.cLp=n.Aza.pNg;e.e5m=n.Aza.cTf;e.Oip=n.Aza.HFg;e.numWords=
n.EA;e.Cvb=n.gNb;e.Evb=n.kNb}jdm(){this.R1.JEe();this.mPc.JEe();const e=this.Htj();return this.Eoc&&this.MBa?0>e.Y8.pZa?WordEditorIntl.WordEditorStrings.L_ReadingTimeCalculating:e.Hpo:WordEditorIntl.WordEditorStrings.L_ReadingTimeHidden}Zsd(){dI.ml.le(()=>{this.o4o(this.R1)&&(E.ULS.sendTraceTag(40916106,338,50,"Reading time document stats: {0}",{["totalReadingTime"]:this.R1.Aza?this.R1.Aza.WHg:-1,["wordReadingTime"]:this.R1.Aza?this.R1.Aza.pNg:-1,["imageReadingTime"]:this.R1.Aza?this.R1.Aza.cTf:-1,
["tableReadingTime"]:this.R1.Aza?this.R1.Aza.HFg:-1,["words"]:this.R1.EA,["images"]:this.R1.gNb,["tables"]:this.R1.kNb}),this.oIc=!0);const e=this.jdm();this.yH&&e!==this.fKd&&(this.fKd=e,this.yH.aV(sF.Gpo))},"RIA:URTD")}Qwe(e){this.KNe("WACReadingTimeEnabled",e?"true":"false",nk.a.$Xa)}o4o(e){return!this.oIc&&-1!==e.gNb&&-1!==e.EA&&-1!==e.kNb}static get ml(){return nK.a.instance}}Object(F.a)(dI,"ReadingTimeActor",null,[]);class eI{constructor(){this.LCID=1033;this.Jca=this.zL=-1;this.hBb=new fb.a;
this.Hab=new fb.a}}Object(F.a)(eI,"ReadingTimeInput",null,[]);class rA extends Sys.EventArgs{constructor(e){super();this.isEnabled=e}}Object(F.a)(rA,"ReadingTimeAvailabilityChangedEventArg",Sys.EventArgs,[]);class aw extends Sys.EventArgs{constructor(e){super();this.state=e}}Object(F.a)(aw,"ReadingTimeChangedEventArg",Sys.EventArgs,[]);class vx{constructor(e,n,C,S,ja,ya){this.eKd=null;this.TCb=new ky;this.PK=null;this.EAd=!1;this.sa=new eb.a;this.Ssc=()=>{this.MBa?this.$A():this.Rca();this.JEe();
this.coo(this.MBa)};this.Bga=()=>{this.JEe();this.doo(this.TCb)};this.LK=e;this.ib=n;try{this.eKd=C.create(1)}catch(kb){this.eKd=null,E.ULS.sendTraceTag(40916107,338,15,"Error when retrieving the reading time algorithm: [message: {0}] [callstack: {1}].",kb.message,kb.stack)}this.C2a=ya.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.pMk=ya.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.GKh=ja;S.execute(kb=>{this.PK=kb.getInstance(this.GKh);this.Ssc(this,null)})}$A(){this.EAd||
(this.PK.Sff(this.Ssc),this.PK.cmb(this.Bga),this.EAd=!0)}Rca(){this.EAd&&(this.PK.QCo(this.Ssc),this.PK.Nte(this.Bga),this.EAd=!1)}Jxm(){return this.LK.iKa(this.ib.Pg)}JEe(){if(this.MBa){var e=new eI;e.zL=this.gNb;e.Jca=this.kNb;e.LCID=this.Jxm();e.hBb=this.ZMl;e.Hab=this.Ztf;try{if(this.TCb=this.eKd.ZLf(e),void 0===this.TCb||null===this.TCb)this.TCb=new ky}catch(n){this.TCb=new ky,E.ULS.sendTraceTag(40916108,338,15,"Error when retrieving reading time: [message: {0}] [callstack: {1}].",n.message,
n.stack)}}}doo(e){this.sa.raiseEvent("rttek",new aw(e))}coo(e){this.sa.raiseEvent("rtac",new rA(e))}RPh(e){this.sa.addHandler("rttek",e)}J2k(e){this.sa.addHandler("rtac",e)}get Aza(){return this.TCb}get EA(){return this.PK?this.PK.EA:-1}get Ztf(){return this.PK?this.PK.Ztf:null}get ZMl(){return this.PK?this.PK.$Ml:null}get gNb(){return this.PK?this.PK.gNb:-1}get kNb(){return this.PK?this.PK.kNb:-1}get MBa(){return!!this.eKd&&this.sXa&&!(1===this.GKh&&!this.pMk)}get sXa(){return this.C2a&&!!this.PK&&
this.PK.sXa}}Object(F.a)(vx,"ReadingTimeManager",null,[887]);class bw{constructor(){this.O4e=this.Z=null;this.K8=()=>{this.qva()}}get name(){return"WordEditor.ReadingTime"}init(){if(this.Eoc()){const e=ib.StaticActiveAppFrame.za().kb;e.uBa?(e.bdb(this.K8),this.qva()):e.Qja(this.K8);E.ULS.sendTraceTag(40916109,338,50,"Reading time package initialized.")}}Eoc(){return G.AFrameworkApplication.J.$("ReadingTimeIsEnabled")&&G.AFrameworkApplication.J.$("EnableTimeToReadAsPremiumFeature")}dispose(){}wc(e){this.Z=
e;this.Z.ia("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory",()=>new lK).ha();this.Z.ia("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory",()=>new mK(this.Z.resolve("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory"))).ha();this.Z.ia("WordEditor.ReadingTime.IReadingTimeManager",()=>new vx(gc.a.instance.resolve("Box4.ILanguageReader"),Kf.a.instance,this.Z.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.Z.Ta("WordEditor.WordCount.IWordCountManagerFactory"),0,gc.a.instance.resolve("Common.IAppSettingsManager"))).ha()}qva(){ka.a.jf?
this.O4e?E.ULS.sendTraceTag(40916111,306,15,"ReadingTimeActor is alreadyd initialized. Skipping feature bootstrapping."):(this.O4e=new dI(gc.a.instance.resolve("WordEditor.ReadingTime.IReadingTimeManager"),new vx(gc.a.instance.resolve("Box4.ILanguageReader"),Kf.a.instance,this.Z.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.Z.Ta("WordEditor.WordCount.IWordCountManagerFactory"),1,gc.a.instance.resolve("Common.IAppSettingsManager")),nk.a.q_a,nk.a.oAa,()=>gc.a.instance.Oa("WordEditor.IStatusBarUser"),
gc.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")),this.O4e.Xb()):E.ULS.sendTraceTag(40916110,306,15,"TheNotebookManager is null. Reading Time will not be available.")}static main(){R.a.instance.Mc(new bw)}}Object(F.a)(bw,"ReadingTimePackage",null,[0,1]);class xv{constructor(){this.jo=null}GHa(e,n){this.jo||(this.jo={});this.jo[n]||(this.jo[n]=0);this.jo[n]+=e}getData(){return this.jo}reset(){this.jo=null}}Object(F.a)(xv,"MultiSumDataAggregator",null,[899]);class Bh extends Sys.EventArgs{constructor(){super();
this.qC=null}}Object(F.a)(Bh,"DocumentSignalReadyEventArgs",Sys.EventArgs,[]);class $y extends Sys.EventArgs{constructor(){super()}}Object(F.a)($y,"SignalAddedToBatchWindowEventArgs",Sys.EventArgs,[]);var UB;(function(e){e[e.Wjq=0]="rest";e[e.add=1]="add";e[e.Rob=2]="edit";e[e.document=3]="document";e[e.j_p=4]="editorAccept"})(UB||(UB={}));Object(F.b)("SignalCategory",UB);class VB extends Sys.EventArgs{constructor(){super();this.d7c=this.aQ=0}}Object(F.a)(VB,"SignalReadyEventArgs",Sys.EventArgs,[]);
class sA{constructor(){this.startTime=null;this.aQ=this.lyf=0;this.values=null;this.d7c=0}get endTime(){return this.startTime.getTime()+this.lyf}}Object(F.a)(sA,"SignalSummary",null,[]);class fI{constructor(e,n,C,S,ja=null){this.K$e=null;this.phb=0;this.EFb=this.vFc=null;this.sa=new eb.a;this.Fpl=()=>{const ya=this.gF(),kb=this.mIf(this.EFb,ya);kb>this.hLe&&(this.phb&&this.oHi(0,ya,kb),this.EFb=ya)};this.Jb=e;this.hLe=n;this.Uok=C;this.dJk=S;this.hBh={};this.QPe={};this.WLd=new Gb.a;this.bxd=new xv;
this.RKe=new fb.a;this.kCd=!1;ja||(ja=()=>new Date);this.gF=ja}bxb(e){3===e.aQ&&1!==e.xya?E.ULS.sendTraceTag(590401570,389,10,"Signal Aggregator: Signals at the document level should be of aggregation type Last. SignalId{0}",e.qC):(E.ULS.sendTraceTag(590401571,389,50,"Signal Aggregator: Registered a signal type: SignalId: {0}, SignalCategory: {1}, SignalDescription: {2}, AggregationType: {3}",e.qC,e.aQ,e.oeb,e.xya),this.hBh[e.qC]=e)}init(e=null){e||(e=this.gF());this.phb=0;this.EFb=this.vFc=e;this.kCd=
!0}rGi(){if(!this.kCd)return E.ULS.sendTraceTag(590401601,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),null;const e=new fb.a;e.add(Object.assign(new sA,{aQ:3,values:this.QPe}));for(const n of this.WLd){const C=Object.assign(new sA,{aQ:n.key,values:n.value.getData()});e.add(C)}return e}Twi(){return this.kCd?Object.assign(new sA,{aQ:3,values:this.QPe}):(E.ULS.sendTraceTag(574419076,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),
null)}track(e){if(this.kCd){var n=this.hBh[e.qC];if(!n)E.ULS.sendTraceTag(590401603,389,10,"Signal Aggregator: Recieved a signal that was never registered: {0}",e.qC);else if(1===n.xya)this.QPe[e.qC]=e.value,this.sa.raiseEvent("DocumentSignalReadyEventKey",Object.assign(new Bh,{qC:e.qC}));else if(!n.xya){this.TZk(e,n.aQ);const C=this.mIf(this.EFb,e.timestamp);(n.aQ!==this.phb||C>this.hLe)&&this.oHi(n.aQ,e.timestamp,C);this.EFb=e.timestamp;this.bxd.GHa(e.value,e.qC);this.e2l()}}else E.ULS.sendTraceTag(590401602,
389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first.")}TZk(e,n){this.WLd.tb(n)||this.WLd.W(n,new xv);this.WLd.K(n).GHa(e.value,e.qC)}mIf(e,n){return+n-+e}e2l(){this.K$e||(this.K$e=new zg.a(4,2,this.dJk,this.Fpl,193),this.Jb.$b(this.K$e))}oHi(e,n,C){C>this.hLe&&e&&(this.WVd(0,n),this.bxd.reset(),this.vFc=this.EFb,this.phb=0);C=Object.assign(new VB,{aQ:this.phb,d7c:e});this.Lul(e,n);this.bxd.reset();this.vFc=n;this.phb=e;this.sa.raiseEvent("SignalReadyEventKey",C)}WVd(e,
n){this.phb&&(n=this.EFb);e=Object.assign(new sA,{aQ:this.phb,values:this.bxd.getData(),startTime:this.vFc,lyf:this.mIf(this.vFc,n),d7c:e});this.RKe.add(e);n=new $y(e);this.sa.raiseEvent("SignalAddedToBatchWindowEventKey",n);E.ULS.sendTraceTag(590401605,389,50,"New Signal Bucket Added. SignalCategory: {0}, Values: {1}, StartTime: {2}, Duration (ms): {3}, IncomingCategory: {4}",UB[e.aQ],e.values,e.startTime,e.lyf,UB[e.d7c]);return e.endTime}Lul(e,n){for(e=this.WVd(e,n)-this.Uok;this.RKe.K(0).endTime<
e;)this.RKe.removeAt(0)}KPh(e){this.sa.addHandler("SignalReadyEventKey",e)}uCo(e){this.sa.removeHandler("SignalReadyEventKey",e)}wPh(e){this.sa.addHandler("DocumentSignalReadyEventKey",e)}Irg(e){this.sa.removeHandler("DocumentSignalReadyEventKey",e)}}Object(F.a)(fI,"SignalAggregator",null,[1012]);var gI=d(478),Il=d(221),WB=d(1770);class $t{constructor(e,n=1){this.qC=e;this.timestamp=new Date;this.value=n}}Object(F.a)($t,"SignalEntry",null,[]);class cw{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd){this.KDk=
Rb;this.wok=sc;this.UZ=Fc;this.Ubl=gd;this.FGa=td;this.$d=Bd;this.zQ=new Fv.a;this.tih=0;this.HI=()=>{const wd=new $t(Bm.F0h);this.O5.track(wd)};this.Jma=()=>{const wd=new $t(Bm.erj);this.O5.track(wd)};this.Zvb=()=>{const wd=new $t(Bm.lrj);this.O5.track(wd)};this.Bga=(wd,te)=>{wd=new $t(Bm.wordCount,te.state.wordCount);this.O5.track(wd);wd=new $t(Bm.YU,te.state.YU);this.O5.track(wd)};this.nWn=(wd,te)=>{te.action==gI.b.Apply&&(wd=new $t(this.Ubj(te.category),1),this.O5.track(wd))};this.h0n=(wd,te)=>
{te.action==WB.a.Gpc&&(wd=new $t(this.Ubj(te.category),1),this.O5.track(wd))};this.O4n=()=>{const wd=new $t("E_TextPrediction",1);this.O5.track(wd)};this.$ij=()=>{const wd=new $t("E_AutoCorrect",1);this.O5.track(wd)};this.O5=e;this.Gm=n;this.ru=C;this.Ns=S;this.ga=ja;this.Re=ya;this.Aa=kb;this.$A()}async $A(){var e;const n=this.Gm.qf(12);n.ut(this.Jma);n.ly(this.Zvb);this.ru.cmb(this.Bga);this.Ns.addHandler(Il.a.JDe,this.HI);this.$d.hYf()&&(this.F7m(),this.ga.fY(this));this.Aa.$("SignalAggregatorCritiqueCountIsEnabled")&&
Jp.a.im().then(()=>{this.Re.ub(this,Rv.a.getTypeName())});await (null===(e=this.FGa)||void 0===e?void 0:e.YZf())&&(this.wok.execute(C=>C.T0k(this.nWn)),this.KDk.execute(C=>C.A1k(this.h0n)),Fw.a.x2k(this.O4n),this.UZ.kff(this.$ij),this.Ubl.kff(this.$ij))}E3(){}C3(e){2===e.behavior&&this.zQ.contains(e.actionId)&&(this.tih++,e=new $t(Bm.A3d,this.tih),this.O5.track(e))}gH(e){e&&e.content&&e.annotationType===Rv.a.getTypeName()&&(e=e.content,e=new $t(e.categoryName,e.count),this.O5.track(e))}Ubj(e){switch(e){case "Spelling":case "Grammar":return"E_Spelling_Grammar";
case "Similarity":return"E_Similarity";default:return"E_Refinements"}}F7m(){this.zQ.add(pe.a.font);this.zQ.add(pe.a.pC);this.zQ.add(pe.a.S2);this.zQ.add(pe.a.l4);this.zQ.add(pe.a.fE);this.zQ.add(pe.a.bold);this.zQ.add(pe.a.fA);this.zQ.add(pe.a.underline);this.zQ.add(pe.a.strikethrough);this.zQ.add(pe.a.subscript);this.zQ.add(pe.a.superscript);this.zQ.add(pe.a.q6a);this.zQ.add(pe.a.aIa);this.zQ.add(pe.a.bIa);this.zQ.add(pe.a.Sya);this.zQ.add(pe.a.r6a);this.zQ.add(pe.a.rY);this.zQ.add(pe.a.sca);this.zQ.add(pe.a.hx);
this.zQ.add(pe.a.eva);this.zQ.add(pe.a.zT)}}Object(F.a)(cw,"SignalAggregatorEventCoordinator",null,[119,1011]);class Ms{constructor(){this.qC=null;this.aQ=0;this.oeb=null;this.xya=0}}Object(F.a)(Ms,"SignalDef",null,[]);class tF{constructor(){this.Z=null}get name(){return"WordEditor.SignalAggregator"}wc(e){this.Z=e;e=this.Z.resolve("Common.IAppSettingsManager");const n=e.jc("SignalAggregatorBucketThresholdMilliseconds",1E4),C=e.jc("SignalAggregatorBatchWindowMilliseconds",12E4),S=e.jc("SignalAggregatorPollingIntervalMilliseconds",
6E3);this.Z.ia("WordEditor.SignalAggregator.SignalAggregator",()=>new fI(G.AFrameworkApplication.pc,n,C,S)).as("WordEditor.SignalAggregator.ISignalAggregator").ha()}init(){if(ka.a.jf){var e=ka.a.jf.Tl;if(e){var n=this.Z.resolve("WordEditor.SignalAggregator.SignalAggregator");this.uxo(n);n.init();var C=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0);new cw(n,e,C,this.Z.resolve("Box4.EditStateEventManager"),G.AFrameworkApplication.va,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
G.AFrameworkApplication.J,this.Z.Ta("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.Z.Ta("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("Box4.IAutoCorrectScheduler"),this.Z.resolve("Box4.AutocorrectActionExecutor"),this.Z.Oa("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.Z.resolve("WordEditor.Designer.IDesignerControl"))}else E.ULS.sendTraceTag(590401569,306,15,"Graph is null. Signal Aggregator will not be available")}else E.ULS.sendTraceTag(590401568,
306,15,"TheNotebookManager is null. Signal Aggregator will not be available")}uxo(e){let n=Object.assign(new Ms,{qC:Bm.F0h,aQ:2,oeb:"The number of characters that have been typed",xya:0});e.bxb(n);n=Object.assign(new Ms,{qC:Bm.erj,aQ:2,oeb:"The number of paragraphs that have been added",xya:0});e.bxb(n);n=Object.assign(new Ms,{qC:Bm.lrj,aQ:2,oeb:"The number of paragraphs that have been deleted",xya:0});e.bxb(n);n=Object.assign(new Ms,{qC:Bm.A3d,aQ:3,oeb:"The total count of font formatting changes that have been applied",
xya:1});e.bxb(n);n=Object.assign(new Ms,{qC:Bm.wordCount,aQ:3,oeb:"The latest word count of the document",xya:1});e.bxb(n);n=Object.assign(new Ms,{qC:Bm.YU,aQ:3,oeb:"The latest paragraph count of the document",xya:1});e.bxb(n);if(G.AFrameworkApplication.J.$("SignalAggregatorCritiqueCountIsEnabled"))for(var C=0;C<Bm.Btf.length;C++)n=Object.assign(new Ms,{qC:Bm.Btf[C],aQ:3,oeb:String.format("The latest {0} critique count of the document",Bm.Btf[C]),xya:1}),e.bxb(n);for(C=0;C<Bm.dhc.length;C++)n=Object.assign(new Ms,
{qC:Bm.dhc[C],aQ:4,oeb:String.format("Accepted {0} count",Bm.dhc[C]),xya:0}),e.bxb(n)}dispose(){}static main(){R.a.instance.Mc(new tF)}}Object(F.a)(tF,"SignalAggregatorPackage",null,[0,1]);class xn{}Object(F.a)(xn,"ApplicationProperties",null,[]);class hI{}Object(F.a)(hI,"EnterpriseUserInfo",null,[]);class tA{}Object(F.a)(tA,"FeatureGates",null,[]);class ly{constructor(e,n,C=!0){this.GHg=9E5;this.IHg=3E5;this.w6f=null;this.Saj="";this.u6f=0;this.tob=Date.now;this.Cba=e;this.QXa=n;C&&this.TFf()}jLm(){const e=
this.tob();if(e<this.u6f+this.GHg)return e>this.u6f+this.IHg&&this.TFf(),this.Saj;this.TFf();return""}TFf(){this.w6f=this.w6f||new Promise(e=>{this.kLm().then(n=>{this.Saj=n;this.u6f=this.tob();this.w6f=null;e(n)})})}kLm(){return this.QXa&&this.QXa.length?new Promise(e=>{this.Cba.tV("SmartLookup",this.QXa).then(n=>{n.IsSuccess?n.Token||(e(""),E.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(E.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
n.ErrorCode+": "+n.ErrorMessage),e(""));e(n.Token)}).catch(n=>{n=Bf.c(n);E.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+n);e("")})}):(E.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(F.a)(ly,"SmartLookupAuthenticationManager",null,[1906]);class XB{static ALm(){switch(G.AFrameworkApplication.J.$("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":G.AFrameworkApplication.J.$("SmartLookupEnableProdSourceLocationOverride")?
"PROD":G.AFrameworkApplication.J.$("SmartLookupEnableIntSourceLocationOverride")?"INT":XB.jxi()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static jxi(){switch(Object(Jg.a)(String,G.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(G.AFrameworkApplication.J){let e=G.AFrameworkApplication.J.jb("UserPrincipalName");e=Of.a.xh(e);const n=G.AFrameworkApplication.J.my("SmartLookupINTEnabledForSKITeam")?G.AFrameworkApplication.J.hD("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(n,e)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static OKm(){switch(G.AFrameworkApplication.J.$("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":G.AFrameworkApplication.J.$("IntentSvcEnableProdSourceLocationOverride")?"PROD":G.AFrameworkApplication.J.$("IntentSvcEnableIntSourceLocationOverride")?"INT":XB.jxi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(F.a)(XB,"Utils",null,[]);class uA{constructor(e){E.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Qub=G.AFrameworkApplication.J.$("IsTellMeUpSellEnterpriseEnabled");this.EIn=G.AFrameworkApplication.J.jb("SmartLookupApprovedOriginPattern");this.QXa=G.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint");this.M6f=N.a.nU(G.AFrameworkApplication.J.jb("AppCatalogUrl")||"");
this.oj=new tA;this.oj.EnableAllTabV2=!0;this.oj.EnableIntentService=!0;this.oj.EnableInDocumentSearch=G.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch");this.oj.EnableLocalSearch=G.AFrameworkApplication.J.$("SmartLookupEnableLocalSearch");this.oj.IntentServiceEndpoint=XB.OKm();this.VIn=new ly(e,this.QXa)}get approvedOriginPattern(){return this.EIn}uim(){const e=new xn;e.anid="";e.applicationVersion=G.AFrameworkApplication.buildVersion;e.appCorrelationId=Tj.a.create().toString();e.themePlatform=
uA.sGp;e.lcid=G.AFrameworkApplication.lcid;e.launchUtcTime=(new Date).toUTCString();e.featureGates=this.oj;var n=ac.a.Eg(G.AFrameworkApplication.lcid);n=n?n.name:null;e.market=this.Xvi(n);e.uiLanguage=n;e.sessionId=G.AFrameworkApplication.userSessionId;e.themeId=0;e.parentalControl=uA.xig;const C=new hI;C.CountryCode=this.Xvi(n);C.ServiceEndpoint=this.QXa;C.IsGoLocal=!1;C.IsEnabled=this.Qub;C.IsEnterpriseEnabled=this.Qub;C.TenantRoot=this.M6f;e.enterpriseUserInfo=C;e.accessToken=this.VIn.jLm();return e}Xvi(e){e=
e.split("-");return e[e.length-1]}}uA.sGp="web";uA.xig="yes";Object(F.a)(uA,"SmartLookupManager",null,[1870]);class Wu{constructor(){this.Z=null}get name(){return"Common.App.SmartLookup"}wc(e){this.Z=e;E.ULS.sendTraceTag(41521356,1313,50,"SmartLookupPackage - Initialize");this.Z.register(1870,"Common.App.SmartLookup.ISmartLookupManager").ha().Ud(()=>new uA(this.Z.resolve("Common.App.OAuth.IOAuthManager")))}dispose(){}}Object(F.a)(Wu,"SmartLookupPackage",null,[0,1]);class YB{}Object(F.a)(YB,"Selection",
null,[]);class zj{}Object(F.a)(zj,"ConfigurationProvider",null,[]);var uF=d(302);class az{static rwc(e){const n=new uF.a;n.name="Office.Insights.SmartLookup.LaunchPane";n.samplingPolicy=2;const C=[];(e=Ad.a.Naa("AppCorrelationId",e,2))&&Array.add(C,e);n.dataFields=C;Yd.a.sendActivityEvent(n)}}Object(F.a)(az,"LoggingUtils",null,[]);var uo=d(1733),zD=d(1895);class cp{constructor(e,n,C,S,ja,ya){this.i6c=(kb,Rb,sc)=>{if(2!==sc)return 32;this.wTb()&&this.ui.bMb(cp.appId);return 32};this.Wxc=(kb,Rb,sc)=>
{if(2!==sc)return 32;kb=(new zD.a).getSelectedText();kb=Object.assign(new YB,{neighborhood:kb.neighborhood,mentionStart:kb.mentionStart,mentionLength:kb.mentionLength});this.e_b=Object.assign(new uo.a,{selection:kb,entryPoint:0});return this.bbd()};this.cLa=(kb,Rb,sc)=>{if(2!==sc)return 32;kb=(new zD.a).getSelectedText();kb=Object.assign(new YB,{neighborhood:kb.neighborhood,mentionStart:kb.mentionStart,mentionLength:kb.mentionLength});this.e_b=Object.assign(new uo.a,{selection:kb,entryPoint:10});
return this.bbd()};this.bba=(kb,Rb,sc,Fc,gd)=>{if(1===sc)return qn.SessionStatusManager.instance.Jk?8:32;kb=gd.CommandValueId;try{this.e_b=Bf.a(kb)}catch(td){return E.ULS.sendTraceTag(41521359,1313,15,"SmartLookup application interface [{0}] is not in proper format",kb),8}return this.bbd()};this.xpd=(kb,Rb,sc,Fc,gd)=>{if(1===sc)return 32;try{this.e_b=gd}catch(td){return E.ULS.sendTraceTag(41694411,1313,15,td.message),8}return this.bbd()};this.wpd=(kb,Rb,sc,Fc,gd)=>{if(1===sc)return 32;if(!gd)return 8;
kb=gd.query?gd.query:"";kb=Object.assign(new YB,{neighborhood:kb,mentionStart:0,mentionLength:kb.length});this.e_b=Object.assign(new uo.a,{selection:kb,entryPoint:0});return this.bbd()};this.ga=e;this.ui=n;this.Cbj=C;this.e_b=null;this.xcd=new va.a;this.sourceLocationOverrideResourceId=XB.ALm();this.xcd.sourceLocationOverrideResourceId=this.sourceLocationOverrideResourceId;this.xcd.pV=CommonUIStrings.L_SmartLookupPaneTitle;this.xcd.taskPaneWidth=400;this.Eaj=ja;this.isFirstLaunch=!0;e=Object.assign(new zj,
{channelId:"SmartLookup",approvedOriginPattern:this.Cbj.approvedOriginPattern});this.LOi=SmartLookupHostRuntime.setup(e,[ya])}hxo(){E.ULS.sendTraceTag(41521357,1303,50,"Registering SmartLookup ribbon button.");this.ga.qa(ha.a.Wxc,X.a.frame,this.Wxc);this.ga.qa(ha.a.i6c,X.a.frame,this.i6c);this.ga.qa(T.a.bba,X.a.frame,this.bba);this.ga.qa(T.a.cLa,X.a.frame,this.cLa);this.ga.qa(T.a.xpd,X.a.frame,this.xpd);this.ga.qa(T.a.wpd,X.a.frame,this.wpd);this.cBo()}cBo(){this.ga.X3("mso_smartLookup",!0,ha.a.Wxc,
X.a.frame,this.Wxc,e=>{ib.StaticActiveAppFrame.za().m2b(e,Object(ic.a)(this.Eaj,this.Eaj.Dqb,"getCommandById"))});this.ga.X3("mso_smartLookup",!0,ha.a.i6c,X.a.frame,this.i6c,()=>{});this.ga.X3("mso_smartLookup",!0,T.a.bba,X.a.frame,this.bba,()=>{});this.ga.X3("mso_smartLookup",!0,T.a.cLa,X.a.frame,this.cLa,()=>{});this.ga.X3("mso_smartLookup",!0,T.a.xpd,X.a.frame,this.xpd,()=>{});this.ga.X3("mso_smartLookup",!0,T.a.wpd,X.a.frame,this.wpd,()=>{})}Sxc(){if(!this.wTb()){const n=this.Cbj.uim();var e=
{};n.applicationName=cp.Yeo;n.isFirstLaunch=this.isFirstLaunch;n.themeId=5;e[cp.Wap]=this.e_b;e[cp.R6k]=n;this.xcd.QU=e;e=G.AFrameworkApplication.J.$("SmartLookupSdxFlowIsEnabled");this.ui.E8(cp.appId,this.xcd,e);this.isFirstLaunch=!1;az.rwc(n.appCorrelationId)}this.LOi.onPaneStateChanged(!0)}wTb(){return this.ui.c3(cp.appId+"."+this.sourceLocationOverrideResourceId)}bbd(){this.wTb()?this.LOi.search(this.e_b):this.Sxc();return 32}}cp.R6k="AppProperties";cp.Yeo="Word";cp.Wap="SmartLookupApplicationInterface";
cp.appId="FA000000006";Object(F.a)(cp,"SmartLookupAddIn",null,[1013]);class vA{getId(){return"SerpletExecutor"}}vA.ZNi="FA000000012";vA.queryPrefix="AssetID=";Object(F.a)(vA,"BaseSerpletExecutor",null,[922,923]);class yL extends vA{constructor(e){super();this.S1=e}openHelpTaskPane(e){const n={};n.query=vA.queryPrefix+e;e=new va.a;e.QU=n;this.S1.E8(vA.ZNi,e)}}Object(F.a)(yL,"WordSerpletExecutor",vA,[]);class bz extends Wu{constructor(){super();this.PPa=null}get name(){return"WordEditor.SmartLookup"}init(){bz.isFeatureEnabled()&&
this.qva()}wc(e){super.wc(e);this.PPa=e;bz.isFeatureEnabled()&&(this.PPa.ia("WordEditor.SmartLookup.WordSerpletExecutor",()=>new yL(this.PPa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"))).as("Common.App.SmartLookup.ISerpletExecutor").ha(),this.PPa.ia("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn",()=>new cp(G.AFrameworkApplication.va,this.PPa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.PPa.resolve("Common.App.SmartLookup.ISmartLookupManager"),
this.PPa.resolve("Common.IAppSettingsManager"),this.PPa.resolve("Common.IExternalUICommandDefinitionMapping"),this.PPa.resolve("Common.App.SmartLookup.ISerpletExecutor"),ib.StaticActiveAppFrame.za().Leb)).ha())}qva(){E.ULS.sendTraceTag(41497102,1303,50,"SmartLookup package initialized.");this.PPa.resolve("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn").hxo()}static main(){bz.isFeatureEnabled()&&R.a.instance.Mc(new bz)}static isFeatureEnabled(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")}}
Object(F.a)(bz,"WordEditorSmartLookupPackage",Wu,[]);class ZB{constructor(e,n,C,S,ja,ya){this.ygb=!1;this.aze=(kb,Rb,sc)=>2!==sc?32:this.$Qc&&this.$4a?this.$4a.wTb?this.$Qc.S0m(sc):this.$Qc.k$o(sc):16;this.Guc=(kb,Rb,sc,Fc,gd)=>this.$Qc?this.$Qc.Guc(kb,Rb,sc,Fc,gd):16;this.ga=e;this.$Qc=n;this.UHb=C;this.$4a=S;this.cbc=ja;this.$Ak=ya}register(e=!1){if(this.ygb)E.ULS.sendTraceTag(51667738,3011,15,"Attempted to register Transcription add-in commands more than once.");else{this.ygb=!0;E.ULS.sendTraceTag(51667739,
3011,50,"Registering Transcription add-in commands.");this.cbc&&(this.$Ak?this.cbc.i$o():this.cbc.j$o());var n={},C=new fb.a;n.Transcription="ButtonModel";C.add("btnWordTranscription");this.ga&&(this.ga.qa(ha.a.aze,X.a.frame,this.aze),this.ga.fb(ha.a.Guc,Ma.a.view,this.Guc,96));e&&this.UHb&&this.UHb.SOa(n)}}}Object(F.a)(ZB,"TranscriptionAddInCommands",null,[1007]);class op{constructor(e,n){this.CHb=e;this.dw=n}IAm(e,n){Object(Wo.a)(2,()=>this.dw.j9a(),!0,()=>!0).then(C=>{e[op.Cje]=C;n(e)}).catch(C=>
{E.ULS.sendTraceTag(528859138,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",C)})}HAm(e,n){this.CHb.j9a().then(C=>{e[op.Cje]=C;n(e)})}gYk(e,n,C){Object(Wo.a)(2,()=>this.dw.oSc(e[op.Uke]),!1,()=>!0).then(()=>{Object(Wo.a)(2,()=>this.dw.j9a(),!0,()=>!0).then(S=>{this.dw.LOb();n[op.Cje]=S;C(n)}).catch(S=>{E.ULS.sendTraceTag(528859139,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",S)})}).catch(S=>{E.ULS.sendTraceTag(528859140,3011,
10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",S)})}fYk(e,n,C){this.CHb.oSc(e[op.Uke]).then(()=>{this.CHb.j9a().then(S=>{this.CHb.LOb();n[op.Cje]=S;C(n)})})}eYm(e,n){return new Promise((C,S)=>{const ja={};switch(e){case op.GAm:Object(Wo.b)()?this.IAm(ja,C):this.HAm(ja,C);break;case op.eYk:if(void 0===n[op.Uke]||null===n[op.Uke]){S(op.BTi);break}Object(Wo.b)()?this.gYk(n,ja,C):this.fYk(n,ja,C);break;case op.xBp:if(void 0===n[op.iGg]||null===n[op.iGg]){S(op.BTi);break}C=
n[op.iGg];!isNaN(C)&&isFinite(C)&&nk.a.set("TeachingUIShowCount",C.toString());break;default:S(op.Vup)}})}}op.GAm="GetMonthlyMinutesUsed";op.Cje="monthlyMinutesUsed";op.eYk="AddMinutesUsed";op.Uke="numMinutesUsed";op.xBp="UpdateTeachingUIShowCount";op.iGg="teachingUIShowCountNew";op.BTi="invalidArgs";op.Vup="unsupportedRequestType";Object(F.a)(op,"TranscriptionAddInRequestHandler",null,[1006]);class xu{constructor(e,n,C){this.sessionId=e;this.locale=C;this.ui=n;this.eFb=this.HZm=!1}get woc(){return this.eFb}set woc(e){this.eFb=
e}get wTb(){return this.ui?this.ui.c3(kk.hwc):!1}}Object(F.a)(xu,"TranscriptionAddInState",null,[]);class AD{i$o(){appChrome.showTranscribeAsSplitButton()}j$o(){appChrome.showTranscribeAsStandaloneGroup()}aSf(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShowHideTranscriptionPane",!0))}}Object(F.a)(AD,"TranscriptionButtonEnabler",null,[1005]);class gt{constructor(e){this.JOb=n=>{this.MWe=n.isEnabled};this.MWe=this.S7b=!1;this.initialized=e?new Promise((n,C)=>{e.execute(S=>{this.S7b=
S.isFreemiumUpsellEnabled();const ja=S.isFeatureEnabled(Pu.a.k2j,!1);S.Cua(Pu.a.k2j,this.JOb);this.O8m(ja).then(()=>{n(!0)}).catch(ya=>{E.ULS.sendTraceTag(555054277,3011,10,"Failed to initialize transcription licensed user using isFeatureEnabled "+ya.toString());C("Failed to initialize transcription licensed user")})})}):Promise.resolve(!0)}get isFreemiumUpsellEnabled(){return this.S7b}get YYf(){return this.MWe}O8m(e){return new Promise(n=>{e.then(C=>{this.MWe=C?!0:!1;n(!0)})})}}Object(F.a)(gt,"TranscriptionLicenseState",
null,[]);class my{constructor(e){this.p7c=0;this.dw=e}LOb(){return this.j9a().then(e=>{this.p7c=e}).catch(e=>{E.ULS.sendTraceTag(587310852,3011,10,"Failed to get initial monthly minutes used: "+e.toString())})}j9a(){return new Promise((e,n)=>{this.dw?this.dw.bRb(my.nOf,0).continueWith(C=>{C.Yi?n(C.wk):e(parseInt(C.result))},8):e(0)})}oSc(e){return new Promise((n,C)=>{this.dw?this.dw.wna(my.pvg,e.toString()).continueWith(S=>{S.Yi?(E.ULS.sendTraceTag(540375233,3011,10,"SaveTranscriptionMinutes: TaskFaulted. ExceptionDetails:{0} Stack:{1}",
S.wk,S.wk.stack),C(S.wk)):n(null)},8):n(null)})}}my.nOf="getTranscriptionQuota";my.pvg="saveTranscriptionQuota";Object(F.a)(my,"TranscriptionMonthlyQuotaManager",null,[]);class Ns{constructor(){this.vaf="";this.aRc="Office.Voice.Transcription."}pQo(e){this.vaf=Tj.a.create().toString();e=[this.CYd(),this.dai(!1)].concat(this.H$h(e));Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:this.aRc+"PaneOpened",dataFields:e}))}RPo(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:this.aRc+"PaneOpened",
dataFields:[this.CYd(),this.dai(!0),this.SIl(e)]}))}qQo(e){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:this.aRc+"PaneOpened",dataFields:[this.CYd(),this.TIl(e)]}))}nQo(e){this.cRo(e)}wQo(e,n,C){Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:this.aRc+"Preinitialization",dataFields:[Object.assign(new kh.a,{name:"DurationMs",int64:e}),Object.assign(new kh.a,{name:"IsRibbonButtonDisabled",bool:n}),Object.assign(new kh.a,{name:"DisabledReason",string:C})]}))}cRo(e){const n=this.H$h(e);n.push(this.RIl(e),
this.CYd());Yd.a.sendTelemetryEvent(Object.assign(new Vd.a,{name:this.aRc+"PaneClosed",dataFields:n}))}RIl(e){return Object.assign(new kh.a,{name:"PaneOpenDurationInSecs",string:e.PaneOpenDurationInSecs})}CYd(){return Object.assign(new kh.a,{name:"TranscriptionSessionId",string:this.vaf})}dai(e){return Object.assign(new kh.a,{name:"PaneOpenedFinalEvent",bool:e})}TIl(e){return Object.assign(new kh.a,{name:"PaneOpenSucceeded",bool:e})}SIl(e){return Object.assign(new kh.a,{name:"IsLicensedUser",bool:e})}H$h(e){return[Object.assign(new kh.a,
{name:"DeviceNetDownLinkInMbPerSec",double:e.DeviceNetDownLink}),Object.assign(new kh.a,{name:"EffectiveNetworkType",string:e.EffectiveNetworkType}),Object.assign(new kh.a,{name:"IsOnline",bool:e.IsOnline})]}}Object(F.a)(Ns,"TranscriptionTelemetryHelper",null,[1004]);var bm=d(1117);class BD{constructor(){this.Ilb=this.qJb=this.cbc=this.eya=this.R4a=this.$Gd=this.Z=null;this.K8=()=>{ib.StaticActiveAppFrame.za().kb.bdb(this.K8);this.guj()};this.cbc=new AD}get name(){return"WordEditor.Transcription"}init(){if(ka.a.fad()){const e=
ib.StaticActiveAppFrame.za().kb;e.uBa?this.guj():e.Qja(this.K8);E.ULS.sendTraceTag(51667727,3011,50,"Transcription package initialized.")}}dispose(){}AFi(){const e=G.AFrameworkApplication.J.$("IsAnonymousUser"),n=G.AFrameworkApplication.J.$("IsRoamingServiceEnabled");return e||!n?null:this.Z.resolve("Box4.IRoamingServiceRequestManager")}wc(e){this.Z=e;if(ka.a.fad()){const n=this.Z.resolve("Box4.ILanguageReader").iKa(this.Z.resolve("Box4.ISelectionManager").Pg);this.Z.ia("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState",
()=>new xu(G.AFrameworkApplication.userSessionId,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),ac.a.Eg(n).b4d)).as("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState").ha();this.$Gd=new my(this.AFi());this.qJb=new bm.a(this.AFi());let C;C=new op(this.$Gd,this.qJb);this.R4a=new Ns;this.eya=new gt(this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"));this.Ilb=e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager");this.Z.ia("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn",
()=>new kk(this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.Extension.DocumentProperties"),this.R4a,G.AFrameworkApplication.J,this.$Gd,C,this.eya,this.qJb,this.Ilb)).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").ha();this.Z.ia("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands",()=>{var S;return new ZB(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),
this.Z.resolve("Common.IRibbonButtonUpdater"),this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),null!==(S=this.cbc)&&void 0!==S?S:new AD,Rd.a.LWi()&&Rd.a.MWi())}).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").ha();E.ULS.sendTraceTag(51667730,3011,50,"Transcription package configured.")}}guj(){if(ka.a.fad()){var e=Date.now();this.tZb(!0);var n=[];var C=Object(Wo.b)()?this.qJb.LOb().then(()=>({name:"QuotaCheck",succeeded:!0})):this.$Gd.LOb().then(()=>
({name:"QuotaCheck",succeeded:!0}));n.push(C);C=G.AFrameworkApplication.J.$("IsO365ConsumerHost");var S=G.AFrameworkApplication.J.$("IsAnonymousUser");C&&!S&&n.push(this.L6l());Promise.all(n).then(ja=>{ja=ja.filter(kb=>!kb.succeeded).map(kb=>kb.name);const ya=Date.now()-e;this.R4a.wQo(ya,0<ja.length,ja.join(","));0===ja.length?this.qva():(new AD).aSf();this.tZb(!1)}).catch(ja=>{E.ULS.sendTraceTag(555055175,3011,10,"Failed to initialize transcription feature "+ja.toString());(new AD).aSf();this.tZb(!1)})}}async L6l(){try{return await this.eya.initialized,
{name:"UpsellLicenseCheck",succeeded:this.eya.isFreemiumUpsellEnabled||this.eya.YYf}}catch(e){return E.ULS.sendTraceTag(555054278,3011,10,"Failed to get/initialize transcription license state "+e.toString()),Promise.reject("Failed to get/initialize transcription license state")}}qva(){this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").load();this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").register()}tZb(e){appChrome.api.setAsyncRequestStatus("transcribe",
e)}static main(){ka.a.fad()?(R.a.instance.Mc(new BD),E.ULS.sendTraceTag(51667728,3011,50,"Transcription package registered with PackageLifecycleManager.")):(E.ULS.sendTraceTag(51667729,3011,50,"Skip Transcription package registration, because the feature is disabled."),(new AD).aSf())}}Object(F.a)(BD,"WordEditorTranscriptionPackage",null,[0,1]);class zL{constructor(e,n){this.text=n}}Object(F.a)(zL,"ListTransformationContent",null,[]);class CD{constructor(e,n,C,S,ja,ya){this.Vh=n;this.GG=C;this.eqa=
S;this.Rd=ja;this.xv=ya;this.jT=e}}Object(F.a)(CD,"TableConstructor",null,[891]);class DD{constructor(){this.Z=null}get name(){return"WordEditor.Transformation"}wc(e){this.Z=e;this.Z.ia("WordEditor.Transformation.ITableConstructor",()=>new CD(this.Z.resolve("Box4.IOutlineEditor"),this.Z.resolve("Box4.IOutlineElementEditor"),this.Z.resolve("Box4.ITableEditor"),this.Z.resolve("Box4.TableEditors.IWACTableStyleEditor"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.IParagraphEditor"))).ha()}init(){}dispose(){this.Z=
null}static main(){R.a.instance.Mc(new DD)}}Object(F.a)(DD,"TransformationPackage",null,[0,1]);class ny extends Dr.a{constructor(){super();this.language=null;this.percentage=this.characterCount=0;this.H_=Object.assign(new un.a,{T_:ny.getTypeName(),B_:ny.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(ny,"LanguageCountAnnotation",Dr.a,[]);const cz=(e,n)=>-1===e.indexOf("-")&&-1===n.indexOf("-")?
e===n:e.startsWith(n)||n.startsWith(e)?!0:!1;class oy{constructor(){this.Mhb=new If.a}UXk(e){void 0===e||null===e||void 0===e.language||null===e.language||void 0===e.percentage||null===e.percentage||void 0===e.characterCount||null===e.characterCount?E.ULS.sendTraceTag(42500685,399,10,"AddNewLanguage: Null or undefined languageCountAnnotation parameter."):this.Mhb.W(e.language.toLowerCase(),e)}yqm(){let e=0;for(let n=0;n<this.Mhb.count;n++)e+=this.Mhb.values.K(n).percentage;return e}zqm(e){if(!e)return E.ULS.sendTraceTag(42500686,
399,10,"GetDocumentLanguageCompositionPercentageForKnownLanguages: Null or undefined knownLanguageTags parameter."),0;let n=0;for(const C of e)for(e=0;e<this.Mhb.count;e++)if(cz(this.Mhb.keys.K(e),C)){const S=this.Mhb.values.K(e);S&&(n+=S.percentage)}return n}him(){let e=0;for(let n=0;n<this.Mhb.count;n++)e+=this.Mhb.values.K(n).characterCount;return e}}Object(F.a)(oy,"IntelligentSuggestionsDocumentLanguageComposition",null,[]);var oK=d(1894);class dz extends pb.StandardDialog{constructor(){super()}Uh(e,
n,C,S,ja){if(void 0===e||null===e)return E.ULS.sendTraceTag(42500737,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined standardDialogHandler parameter."),!1;if(void 0===n||null===n)return E.ULS.sendTraceTag(42823903,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined reactDialogHandler parameter."),!1;if(void 0===C||null===C||!C.length)return E.ULS.sendTraceTag(42500738,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined fromLanguage parameter."),
!1;if(void 0===S||null===S||!S.length)return E.ULS.sendTraceTag(42500739,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined toLanguage parameter."),!1;E.ULS.sendTraceTag(42500740,399,50,"TranslatorIntelligentSuggestionsReactDialog: Trying to display the translation suggestion dialog.");ja?(ja={["messageText"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage},ja.pathText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,ja.sentenceEndText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod,
e=new Qh.a(!1,!1,!0),e.Bd=4,e.Ke(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,C)),e.Ke(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),C={["id"]:"TranslatorIntelligentSuggestionsDialog",["icon"]:{["iconName"]:"Translator_32",["ariaLabel"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText},["bodyControls"]:ja},e.Uh(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,S),n,C)):(this.Bd=
4,this.Ke(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,C)),this.Ke(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),this.bvb(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,S),String.format("{0} {1}{2}",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod),
"Translator_32x32x32",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText,e,null));return!0}}Object(F.a)(dz,"TranslatorIntelligentSuggestionsReactDialog",pb.StandardDialog,[]);var ez;(function(e){e[e.ok=0]="ok";e[e.Ydq=1]="neverFrom";e[e.cancel=2]="cancel"})(ez||(ez={}));Object(F.b)("UserAction",ez);class Cp{constructor(e,n,C,S,ja,ya,kb,Rb,sc,Fc,gd,td,Bd,wd,te,Le){this.Akh=!1;this.dQa=this.LH=null;this.YIm=Oe=>{try{if(6===Oe.status){const We=Oe.result;We&&We.length?this.LH=
Bf.b(We):E.ULS.sendTraceTag(42500693,399,15,"GetRoamingSettingsFrom: Roaming settings are null or empty which might mean that the user cannot access the Roaming Service due to the type of the account they have.")}else E.ULS.sendTraceTag(42500694,399,10,"GetRoamingSettingsFrom: Could not retrieve the Roaming Settings as the task run status is: {0}",Oe.status);this.LH?this.wgi():(E.ULS.sendTraceTag(42783172,399,10,"RoamingSettings are null so quiting: {0}",{["ProcessingTime"]:this.AZ.Ri}),this.nfb())}catch(We){E.ULS.sendTraceTag(42500695,
399,10,"GetRoamingSettingsFrom: Failed to deserialize the Roaming Settings. Exception: {0}. ProcessingTime: {1}",We,this.AZ.Ri),this.nfb()}};this.Lcn=Oe=>{this.hTi(Oe,null)};this.hTi=Oe=>{this.c9e.stop();Oe=1===Oe?0:2===Oe?1:2;this.iTi(Oe,"DialogBox");E.ULS.sendTraceTag(42500705,399,50,"IntelligentSuggestionsHandleDialog: Pressed {0}",ez[Oe])};this.Re=e;this.xIc=C;this.GOd=n;this.tIh=S;this.AZ=ya.UXa("Task","TranslatorIntelligentSuggestionsAugLoop");this.c9e=ya.UXa("DialogShown","TranslatorIntelligentSuggestionsDialogBox");
this.wg=ja;this.huh=kb;this.VGd=Rb;this.cFk=sc;this.Kuh=Fc;this.eCk=gd;this.nRa=td;this.WBk=wd;this.BCk=te;this.iuh=Le;({value:this.dQa}=Cp.n0a.Ec(Bd.toLocaleLowerCase())).returnValue||(this.dQa=Bd,-1!==this.dQa.lastIndexOf("-")&&(this.dQa=this.dQa.substring(0,this.dQa.lastIndexOf("-"))))}initialize(){var e=this.tIh.FPm();if(!e)return E.ULS.sendTraceTag(42500687,399,10,"Initialize: Not able to get the roaming settings (check user type)."),null;e.continueWith(this.YIm,8);e=new zg.a(2,1,500,()=>{js.Xrd.nGo()});
G.AFrameworkApplication.pc.$b(e);return Jp.a.im().then(()=>{this.Re.ub(this,"AugLoop_Text_LanguageCountAnnotation");this.AZ.start();E.ULS.sendTraceTag(42500688,399,50,"TranslatorAugLoopRuntimeManager: Registerd Handler for AL runtime manager at {0}.",Date.now())})}gH(e,n){try{if(n===Vh.a.getTypeName()){var C=e.content;void 0===C||null===C||void 0===C.language||null===C.language||void 0===C.percentage||null===C.percentage||void 0===C.characterCount||null===C.characterCount?E.ULS.sendTraceTag(42500689,
399,10,"HandleAnnotationEvent: Null or undefined languageCountAnnotation parameter."):(E.ULS.sendTraceTag(42500690,399,50,"HandleAnnotationEvent: Annotation received: {0}",C),C.language=C.language.toLocaleLowerCase(),C.percentage>this.xIc.percentage&&(this.xIc=C),cz(this.dQa,C.language)&&C.percentage>this.VGd?(E.ULS.sendTraceTag(42500691,399,50,"HandleAnnotationEvent: {0}.",{["MinKnownLangPer"]:this.VGd,["ActualUILangPer"]:C.percentage,["ProcessingTime"]:this.AZ.Ri}),this.nfb()):(this.GOd.UXk(C),
this.wgi()))}}catch(S){E.ULS.sendTraceTag(42500692,399,10,"HandleAnnotationEvent: Exception: {0}",S)}}wgi(){if(this.P$k()&&this.f6o()){const C=this.VJf(this.xIc.language);if(C&&C.displayName&&C.displayName.length){var e=this.VJf(this.YIi());if(e&&e.displayName&&e.displayName.length)if(E.ULS.sendTraceTag(42783173,399,50,"DisplayIntelligentSuggestionsIfReady: Ready to show callout or dialog if flight is enabled. ProcessingTime:{0}",this.AZ.Ri),this.WBk&&this.BCk)this.AZ.Ri>this.iuh?E.ULS.sendTraceTag(51512477,
399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the teaching callout as it took too long to process the document {0}",{["MaxWaitTime"]:this.iuh,["ActualWaitTime"]:this.AZ.Ri}):this.l$o(C.displayName,e.displayName);else if(void 0!==this.wg&&null!==this.wg&&this.wg.Z6h)E.ULS.sendTraceTag(50644368,399,50,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog as the user has already started editing the document. ProcessingTime:{0}",this.AZ.Ri);else{if(this.eCk)if(this.AZ.Ri>this.huh)E.ULS.sendTraceTag(42823902,
399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog box as it took too long to process the document {0}",{["MaxWaitTime"]:this.huh,["ActualWaitTime"]:this.AZ.Ri});else{this.c9e.start();var n=new dz;n.Uh(this.Lcn,this.hTi,C.displayName,e.displayName,this.nRa)||(this.c9e.stop(),n.dispose())}}else E.ULS.sendTraceTag(42500697,399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for the language we want to translate to.")}else E.ULS.sendTraceTag(42500696,
399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for document main language.")}}P$k(){return this.LH?void 0===this.LH.NeverShowCallout||null===this.LH.NeverShowCallout||this.LH.NeverShowCallout?(E.ULS.sendTraceTag(42500698,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as 'never show callout' setting is set to true. ProcessingTime:{0}",this.AZ.Ri),this.nfb(),!1):this.Akh?(E.ULS.sendTraceTag(42500699,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as translation suggestion has already been attempted. ProcessingTime:{0}",
this.AZ.Ri),this.nfb(),!1):"1"===N.a.vL(window.self.location.href,"translatorRedirect")?(E.ULS.sendTraceTag(42783174,399,50,"Translated document - pressed show Original: {0}",{["ProcessingTime"]:this.AZ.Ri}),this.nfb(),!1):12E4<this.AZ.Ri?(E.ULS.sendTraceTag(42500700,399,15,"AreTranslationSuggestionsPrerequisitesSatisfied: Stopping from listening to annotations as it took too long to process the document {0}",{["MaxWaitTime"]:12E4,["ActualWaitTime"]:this.AZ.Ri}),this.nfb(),!1):!0:!1}f6o(){const e=
this.GOd.yqm();E.ULS.sendTraceTag(42500701,399,50,"ShouldSuggestTranslation: DocProcessedPer {0}.",e);if(e>this.cFk){var n=this.nhm();n=this.GOd.zqm(n);const C=100*Math.trunc((this.GOd.him()+50)/100);E.ULS.sendTraceTag(42500702,399,50,"ShouldSuggestTranslation: {0}.",{["MinKnownLangPer"]:this.VGd,["ActualKnownLangPer"]:n,["NoChars"]:C,["DocProcessedPer"]:e});if(n<this.VGd)return this.Akh=!0,E.ULS.sendTraceTag(42783175,399,50,"Known languages composition less than default bar, one final check pending: {0}",
{["ProcessingTime"]:this.AZ.Ri}),this.nfb(),C<this.Kuh?(E.ULS.sendTraceTag(42500703,399,15,"ShouldSuggestTranslation: The number of characters of the annotations are less than the minimum required: {0}",{["MinNoChars"]:this.Kuh,["ActualNoChars"]:C}),!1):!0;E.ULS.sendTraceTag(42783176,399,50,"Known languages composition greater than default bar, : {0}",{["ProcessingTime"]:this.AZ.Ri});this.nfb()}return!1}iTi(e,n){try{if(!e){const C=new zg.a(2,1,100,()=>{js.u2j(this.YIi())});G.AFrameworkApplication.pc.$b(C)}else if(1===
e){const C=this.VJf(this.xIc.language);if(C&&C.name&&C.name.length){let S=C.name.toLocaleLowerCase();"no"===S&&(S="nb");this.tIh.vJj(S)}else E.ULS.sendTraceTag(42500704,399,10,"IntelligentSuggestionsUserAction: Could not retrieve/match language information from Translator for document main language.")}E.ULS.sendTraceTag(51512478,399,50,"IntelligentSuggestionsUserAction: UserSelected:{0}, SourcePrompt:{1}, Language:{2}",ez[e],n,this.xIc.language)}catch(C){E.ULS.sendTraceTag(51512479,399,10,"IntelligentSuggestionsUserAction: Exception: {0}",
C)}}nfb(){this.Re.xc(this,"AugLoop_Text_LanguageCountAnnotation");E.ULS.sendTraceTag(42500706,399,50,"UnregisterAugmentationLoopHandler: Unregisterd Handler for AL runtime manager at {0}",Date.now())}nhm(){const e=new fb.a;if(void 0!==this.LH.LanguageTagsExcluded&&null!==this.LH.LanguageTagsExcluded)for(var n=0;n<this.LH.LanguageTagsExcluded.length;n++)e.add(this.LH.LanguageTagsExcluded[n].toLowerCase());e.contains(this.dQa)||e.add(this.dQa);void 0!==this.LH.AlwaysTranslatePreference&&null!==this.LH.AlwaysTranslatePreference&&
this.LH.AlwaysTranslatePreference&&void 0!==this.LH.DocumentTargetLanguage&&null!==this.LH.DocumentTargetLanguage&&(n=this.LH.DocumentTargetLanguage.toLocaleLowerCase(),Cp.VXa.tb(n)&&(n=Cp.VXa.K(n)),e.contains(n)||e.add(n));return e}YIi(){if(void 0!==this.LH.AlwaysTranslatePreference&&null!==this.LH.AlwaysTranslatePreference&&this.LH.AlwaysTranslatePreference&&void 0!==this.LH.DocumentTargetLanguage&&null!==this.LH.DocumentTargetLanguage){let e=this.LH.DocumentTargetLanguage.toLocaleLowerCase();Cp.VXa.tb(e)&&
(e=Cp.VXa.K(e));return e}return this.dQa}VJf(e){if(!e||!e.length)return E.ULS.sendTraceTag(42500707,399,10,"GetLanguageInfoFromTranslator: Provided null or empty parameter."),null;e=e.toLocaleLowerCase();const n=js.Xrd.Mxm();if(!n)return E.ULS.sendTraceTag(42500736,399,10,"GetLanguageInfoFromTranslator: Could not retrieve the language names from Ogma/BRS"),null;for(let C=0;C<n.length;C++){let S=n[C].name.toLowerCase();Cp.VXa.tb(S)&&(S=Cp.VXa.K(S),n[C].name=S);if(cz(S,e))return n[C]}return null}l$o(e,
n){sb.UISurfaces.uL().then(C=>{let S=null;const ja=()=>{S?C.removeNotification(S):E.ULS.sendTraceTag(51512480,399,15,"ShowTranslatorTeachingCallout: Attempting to close callout but id is null.")};var ya=this.$Ii(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate,0,ja);const kb=this.$Ii(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutSecondaryButton,e),1,ja);ya=Object.assign(new Db.a,{target:"button[data-unique-id=Review]",content:CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutMessage,
title:String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutTitle,n),primaryButtonProps:ya,secondaryButtonProps:kb,useTeachingStyles:!0,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new cb.a,{preventDismissOnScroll:!0,directionalHint:5,onDismiss:()=>{this.rjp(ja)}})});ya=C.callout(ya);S=C.addNotification(ya);return null}).catch(C=>{E.ULS.sendTraceTag(51512481,399,10,"ShowTranslatorTeachingCallout: Error while showing the teaching callout. ErrorMessage:{0}",
C);return!1});E.ULS.sendTraceTag(51512482,399,50,"ShowTranslatorTeachingCallout: Teaching Callout Shown. ProcessingTime:{0}",this.AZ.Ri)}$Ii(e,n,C){return Object.assign(new oK.a,{label:e,onExecute:()=>{this.iTi(n,"TeachingCallout");C()}})}rjp(e){E.ULS.sendTraceTag(51512483,399,50,"TeachingCalloutDismiss: Action:{0}, ProcessingTime:{1}","CalloutClosed",this.AZ.Ri);e()}static aF(){Cp.VXa=new If.a;Cp.VXa.add("zh-cht","zh-hant");Cp.VXa.add("zh-chs","zh-hans");Cp.VXa.add("nb","no");Cp.n0a=new If.a;Cp.n0a.add("zh-tw",
"zh-hant");Cp.n0a.add("zh-cn","zh-hans");Cp.n0a.add("zh-sg","zh-hans");Cp.n0a.add("zh-mo","zh-hant");Cp.n0a.add("zh-hk","zh-hant");Cp.n0a.add("nb-no","no");Cp.n0a.add("nn-no","no");Cp.n0a.add("pt-br","pt")}}Cp.VXa=null;Cp.n0a=null;Object(F.a)(Cp,"TranslatorAugLoopRuntimeManager",null,[890,114]);Cp.aF();class dw{constructor(){this.sIh=this.Z=null}get name(){return"WordEditor.Translator"}init(){G.AFrameworkApplication.J.vp(()=>{if(dw.KYf())try{this.sIh=this.Z.resolve("WordEditor.Translator.TranslatorAugLoopRuntimeManager"),
this.sIh.initialize()}catch(e){E.ULS.sendTraceTag(42500741,399,10,"TranslatorPackage: Failed to initialize AL runtime manager. Exception: {0}",e)}})}dispose(){}wc(e){this.Z=e;dw.KYf()&&(this.Z.ia("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition",()=>new oy).ha(),this.Z.ia("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation",()=>new ny).ha(),this.Z.ia("WordEditor.Translator.TranslatorAugLoopRuntimeManager",()=>new Cp(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.Z.resolve("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition"),this.Z.resolve("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation"),this.Z.resolve("WordEditor.TranslatorRoamingServiceManager"),this.Z.resolve("Box4.IEditViewStateManager"),G.AFrameworkApplication.ua.Vr,G.AFrameworkApplication.J.jc("LanguageIntelligentSuggestionMaxWaitTimeAnnotationsMs",5E3),G.AFrameworkApplication.J.jc("LanguageIntelligentSuggestionMinKnownLangCompositionPercentage",10)/100,G.AFrameworkApplication.J.jc("LanguageIntelligentSuggestionMinProcessedDocLangCompositionPercentage",
95)/100,G.AFrameworkApplication.J.jc("LanguageIntelligentSuggestionMinDocumentCharCountFromAnnotations",1E3),!0,!!G.AFrameworkApplication.ua&&G.AFrameworkApplication.ua.Gb.kH,G.AFrameworkApplication.uiCulture,G.AFrameworkApplication.ua.Gb.hXa,!0,G.AFrameworkApplication.J.jc("LanguageIntelligentSuggestionMaxWaitTimeTeachingCalloutMs",1E4))).as("WordEditor.Translator.ITranslatorAugLoopRuntimeManager").ha())}static main(){dw.KYf()&&R.a.instance.Mc(new dw)}static KYf(){return!G.AFrameworkApplication.hL&&
!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("LanguageIntelligentSuggestionIsEnabled")&&G.AFrameworkApplication.J.$("LanguageTranslationIsEnabled")&&G.AFrameworkApplication.J.$("AugLoopServerSideSeedingIsEnabled")}}Object(F.a)(dw,"WordEditorTranslatorPackage",null,[0,1]);var vF=d(1869);class iI{constructor(e,n){this.Xia=e;this.USk=n;this.GWb=this.GWb.bind(this);this.HWb=this.HWb.bind(this);this.OWb=this.OWb.bind(this)}ete(){this.Xia.Wpg(this.GWb);this.Xia.Xpg(this.HWb);this.Xia.gqg(this.OWb)}Oee(){return!1}GWb(e,
n,C){1<e.length&&"!"===e.trimEnd()?this.Xia.reset():"."===e.charAt(e.length-1)&&this.USk.kQo(e,C)}HWb(){}OWb(){}}Object(F.a)(iI,"WordAiAssistantInitHandler",null,[378]);var jI=d(1980);class $B{constructor(e){Pp.a.assign($B,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Pp.a.matchesTypesFor(e,[$B.getTypeName()])}}$B.H_={T_:$B.getTypeName(),B_:$B.getBaseTypes()};class aC{constructor(e){Pp.a.assign(aC,
this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiMultiModalityModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Pp.a.matchesTypesFor(e,[aC.getTypeName()])}}aC.H_={T_:aC.getTypeName(),B_:aC.getBaseTypes()};class wA{constructor(e){Pp.a.assign(wA,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiTextModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Pp.a.matchesTypesFor(e,
[wA.getTypeName()])}}wA.H_={T_:wA.getTypeName(),B_:wA.getBaseTypes()};class fz{constructor(e){Pp.a.assign(fz,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiEmbeddingsModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_OpenAiModelConfig","AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Pp.a.matchesTypesFor(e,[fz.getTypeName()])}}fz.H_={T_:fz.getTypeName(),B_:fz.getBaseTypes()};class py{constructor(e){Pp.a.assign(py,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiChatModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Pp.a.matchesTypesFor(e,
[py.getTypeName()])}}py.H_={T_:py.getTypeName(),B_:py.getBaseTypes()};var kI;(function(e){e[e.TextChatDavinci002=0]="TextChatDavinci002";e[e.TextDavinci001=1]="TextDavinci001";e[e.TextDavinci002=2]="TextDavinci002";e[e.TextDavinci003=3]="TextDavinci003";e[e.TextCurie001=4]="TextCurie001";e[e.TextBabbage001=5]="TextBabbage001";e[e.TextAda001=6]="TextAda001";e[e.CodeDavinci002=7]="CodeDavinci002";e[e.CodeCushman001=8]="CodeCushman001";e[e.Custom=9]="Custom";e[e.TextSimilarityAda001=10]="TextSimilarityAda001";
e[e.TextSimilarityBabbage001=11]="TextSimilarityBabbage001";e[e.TextSimilarityCurie001=12]="TextSimilarityCurie001";e[e.TextSimilarityDavinci001=13]="TextSimilarityDavinci001";e[e.TextSearchAdaDoc001=14]="TextSearchAdaDoc001";e[e.TextSearchAdaQuery001=15]="TextSearchAdaQuery001";e[e.TextSearchBabbageDoc001=16]="TextSearchBabbageDoc001";e[e.TextSearchBabbageQuery001=17]="TextSearchBabbageQuery001";e[e.TextSearchCurieDoc001=18]="TextSearchCurieDoc001";e[e.TextSearchCurieQuery001=19]="TextSearchCurieQuery001";
e[e.TextSearchDavinciDoc001=20]="TextSearchDavinciDoc001";e[e.TextSearchDavinciQuery001=21]="TextSearchDavinciQuery001";e[e.CodeSearchAdaCode001=22]="CodeSearchAdaCode001";e[e.CodeSearchAdaText001=23]="CodeSearchAdaText001";e[e.CodeSearchBabbageCode001=24]="CodeSearchBabbageCode001";e[e.CodeSearchBabbageText001=25]="CodeSearchBabbageText001";e[e.TextEmbeddingAda002=26]="TextEmbeddingAda002";e[e.Gpt35Turbo=27]="Gpt35Turbo";e[e.Gpt4_32k=28]="Gpt4_32k";e[e.Gpt4_0203=29]="Gpt4_0203";e[e.Gpt4_0314_4k=
30]="Gpt4_0314_4k";e[e.Gpt4_0314_32k=31]="Gpt4_0314_32k";e[e.Gpt4_DV3_FP_Variant=32]="Gpt4_DV3_FP_Variant";e[e.Gpt4_DV3_FP=33]="Gpt4_DV3_FP";e[e.Gpt4_PPO_FP_Variant=34]="Gpt4_PPO_FP_Variant";e[e.Gpt4_PPO_FP=35]="Gpt4_PPO_FP";e[e.GptV=36]="GptV"})(kI||(kI={}));var lI=d(2146);class wF{static create(e){const n=new wF(e);return n.activateAnnotation(e.responseType).then(()=>n)}constructor(e){this.config=e;this.nextMessageId=0;this.responseCallbacks=new Map;const n=["session","chats"],C=Wc.a.create().toString(),
S=[...n,C];this.messagesPath=[...S,"messages"];this.config.session.submitOperations([new xd.a({parentPath:n,items:[{id:C,body:e.chat}]}),new xd.a({parentPath:S,items:[{id:"messages",body:new lI.a}]})])}send(e,n){const C=`${this.nextMessageId++}`;this.responseCallbacks.set(C,n);this.config.session.submitOperations([new xd.a({parentPath:this.messagesPath,items:[{id:C,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,
{callback:n=>{if(xd.a.typeGuard(n)&&this.isUnderSubtree(n.parentPath,this.messagesPath))for(const C of n.items){const S=n.parentPath[n.parentPath.length-1],ja=this.responseCallbacks.get(S);ja&&(ja(C.body),this.responseCallbacks.delete(S))}}}).then(({token:n})=>{this.activatedAnnotationToken=n})}isUnderSubtree(e,n){if(e.length<n.length)return!1;for(let C=0;C<n.length;C++)if(e[C]!==n[C])return!1;return!0}}Object(F.a)(wF,"ChatHelper",null,[]);class xF{constructor(e,n){this.ib=e;this.XQa=n}kQo(e,n){var C,
S;const ja=null===(S=null===(C=this.ib.gb)||void 0===C?void 0:C.currentSelection)||void 0===S?void 0:S.Xc;ja&&(C=ja.node,Af.ParagraphReader.Wb(C)&&(C=Af.ParagraphReader.text(C),0>n||n>C.length||(C=C.substring(0,n),this.createChatHelper({chat:new jI.BasicChat({modelConfig:new wA({model:kI.TextDavinci003,parameters:{temperature:.9}}),context:C,prefixText:"\u00acHuman\u00ac",suffixText:"\u00acAI\u00ac",historyDepth:0}),responseType:jI.BasicChatResponse.getTypeName()}).then(ya=>{ya.send(new lI.b({message:"Give response to this query as a HTML element to be put inside a paragraph- "+
e}),kb=>{kb=kb.text.replace(/^\n/,"");kb=kb.replace(/\n$/,"");const Rb=ce.a.createTextRange(ja.node,0,n+e.length);this.XQa.Nwe([Rb],!0,kb,()=>{})})}).catch(()=>{E.ULS.sendTraceTag(508944669,389,15,"WordAiAssistantTextHandler::sendMsg - could not process the request.")}))))}createChatHelper(e){return Uv.a.Nz().getSession().then(n=>wF.create({session:n,...e}))}}Object(F.a)(xF,"WordAiAssistantTextHandler",null,[]);class bC extends Oa.a{get name(){return"WordEditor.WordAiAssistantPackage"}zUa(e){const n=
new vF.a(e.resolve("Box4.IEditingDomManager"),e.resolve("Box4.ICaretPositionManager"),e.resolve("Box4.BackspaceDeleteEventSource"),Object(Zh.a)(),"!",["!"]);n.sdc(ib.StaticActiveAppFrame.za().kb,vq.KeyInputManager.instance);e.ia("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler",()=>new iI(n,e.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler"))).ha();e.ia("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler",()=>new xF(e.resolve("Box4.ISelectionManager"),
e.resolve("WordEditor.AppsForOffice.HtmlDataGetSetProvider")));e.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler").ete()}BUa(){}AUa(){}static main(){G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordAiAssistantPackage",!1)&&R.a.instance.Mc(new bC)}}Object(F.a)(bC,"WordAiAssistantPackage",Oa.a,[]);var pK=d(85);class ew{constructor(e,n,C,S,ja,ya,kb,Rb,sc=null,Fc){this.ga=e;this.ui=n;this.Aa=C;this.uv=S;this.Jb=ja;this.Cv=
ya;this.Qqk=kb;this.Cyd=Rb;this.PK=sc;this.Dch=Fc;this.pCd=this.ygb=!1;this.VVe=void 0;this.A8o=(gd,td,Bd,wd,te)=>2!==Bd?32:this.ui.c3(ew.jfc)?this.x0m():this.MTj(gd,td,Bd,wd,te);this.Dmo=(gd,td,Bd,wd,te)=>{if(1===Bd)return 32;te&&(te[Fa.a.On]=this.ui.c3(ew.jfc),te[Fa.a.Visible]=!0);return 32};this.bom=(gd,td)=>{const Bd={};this.rYi()?Bd.HandoffMessageId=G.AFrameworkApplication.uQf:Bd.HandoffMessageId="";Bd.AugLoopCloudALServiceUrl=this.Aa.jb("AugLoopCloudALServiceUrl");Bd.IsProductionEnvironment=
(2===G.AFrameworkApplication.R6).toString();G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)?Bd.triggerSummary=gd===ha.a.$ne:(Bd.triggerSummary=gd===ha.a.$ne&&!!td.summary,Bd.summary=td.summary);Bd.wacSessionId=G.AFrameworkApplication.sessionStartInfoSettings.WACSessionID;Bd.canonicalUserId=G.AFrameworkApplication.J.jb("LoggableUserId");Bd.serverDocID=G.AFrameworkApplication.sessionStartInfoSettings.ServerDocId;
this.PK&&(Bd.initialWordCount=this.PK.EA);Bd.isCopilotContentGenerationDisabledbyAdminControl=this.VVe;return Bd};this.MTj=(gd,td,Bd,wd,te)=>{if(1===Bd)return 32;const Le=performance.now();pK.Health.instance.addQosPillar("Copilot:Chat Pane:Chat Pane");E.ULS.sendTraceTag(508347790,3050,50,"Opening Copilot Chat pane");gd=Object.assign(new va.a,{taskPaneWidth:400,isResizable:!0,resizeMinWidth:320,resizeMaxWidth:920,isModernPane:!0,pV:appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddTaskpaneHeaderPreviewTag")?
WordRibbonStrings.Copilot:WordEditorIntl.WordEditorStrings.L_CopilotPaneTitle,QU:this.bom(gd,te),onTaskPaneClose:this.rol,showResizeChatButton:!0,w_j:OfficeCommonStrings.PreviewTaskpaneHeaderTag});Jp.a.im().then(()=>{Uv.a.Nz().activateAnnotation(Object.assign(new AH.a,{annotationType:tu.getTypeName()}))});this.ui.E8(ew.jfc,gd,!0);this.Jb.$b(new zg.a(2,1,5E3,()=>{if(this.ui.c3(ew.jfc)){const Oe=this.slm();Oe&&this.MDn(Oe,Le)}}));return 32};this.MDn=(gd,td)=>{gd.onload=()=>{const Bd=performance.now();
E.ULS.sendTraceTag(508347789,3050,50,"User Load time of the Copilot Chat pane is: {0} ms",Bd-td)}};this.slm=()=>{const gd=this.ui.f8a(ew.jfc);return gd&&""!==gd?window.document.getElementById(gd):null};this.rol=()=>{this.aQl();this.Cyd.endCopilotOperation("")};this.aQl=async()=>{const gd=await this.Cv.getAnnotationsByType(zt.b.getTypeName());for(const td of gd)td.content.categoryName===ew.zXd&&this.Cv.qUa(td,!1)};this.rYi=()=>{G.AFrameworkApplication.$c("ec206969;47ja1358");return!!G.AFrameworkApplication.J&&
G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HandoffEnabled",!1)&&G.AFrameworkApplication.uQf}}register(){this.ygb?E.ULS.sendTraceTag(508347795,3050,15,"Attempted to register Copilot Chat add-in commands more than once."):(this.ygb=!0,E.ULS.sendTraceTag(508347794,3050,50,"Registering Copilot Chat commands."),this.ga.fb(ha.a.Xmg,Ma.a.view,this.Dmo,1124),D()&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",
!1)?this.Dch.F4j():this.$dn(),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)?this.d8m():(this.VVe=!1,this.pAj(),this.E2j())))}E2j(){if(this.rYi()){const e=G.AFrameworkApplication.va.Qb(ha.a.Zne,2,{});E.ULS.sendTraceTag(508303002,3050,50,"Launched Copilot with response "+JSON.stringify(e))}}pAj(){this.ga.fb(ha.a.Zne,X.a.frame,this.A8o,1028);this.ga.fb(ha.a.$ne,X.a.frame,this.MTj,1028)}d8m(){this.Qqk.execute(e=>{let n=Date.now();e.cN("CopilotContentGeneration",
!0).then(C=>{n=Date.now()-n;E.ULS.sendTraceTag(508347793,3050,50,"[Copilot Chat] Copilot OCPS setting check latency: "+n.toString());this.VVe=C}).finally(()=>{this.pAj();this.E2j()})})}$dn(){this.Aa.vp(()=>{!this.Aa.$("IsAnonymousUser")&&this.uv&&this.uv.execute(e=>{let n=Date.now();e.isFeatureEnabled("Copilot",!1).then(C=>{n=Date.now()-n;E.ULS.sendTraceTag(508347792,3050,50,"[Copilot Chat] Copilot license check latency: "+n.toString());this.Jmp(C);C&&this.Dch.F4j()})})})}Jmp(e){Object(Bb.c)()?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ChatPane",
!e)):E.ULS.sendTraceTag(508347791,3050,50,"[Copilot Chat] App chrome is not loaded yet. Cannot update the visibility of the copilot pane button in the ribbon.")}x0m(){this.ui.bMb(ew.jfc);return 32}}ew.jfc="FA000000125";ew.zXd="CopilotHighlight";Object(F.a)(ew,"CopilotChatAddInCommands",null,[874]);class yv{constructor(e,n){this.dHg=e;this.ih=n}startCopilotOperation(){if(this.ih.wtb())return E.ULS.sendTraceTag(508347799,3050,10,"Multi Step operation already running."),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0);
this.dHg.XEj();this.ih.Hdp();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0)}endCopilotOperation(){if(!this.ih.wtb())return E.ULS.sendTraceTag(508347798,3050,10,"Multi Step operation must be running before attempting to end it."),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0);this.ih.y0l();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0)}}Object(F.a)(yv,"CopilotOperationLifecycleHandler",null,[873]);class wx{constructor(e){this.Aa=
e;this.W7h="CopilotFREDialog"}F4j(){try{const e=this.uum();E.ULS.sendTraceTag(508302215,3050,50,"Copilot FRE governance status {0}.",e);if("OkToDisplay"===e||"OkToDisplayForDebug"===e)(new Qh.a(!1,!1,!0)).Uh("",this.CZb,{["id"]:this.W7h,["bodyControls"]:{["id"]:this.W7h,["uiLanguage"]:G.AFrameworkApplication.uiCulture}}),Object(xa.a)("ShowCopilotFREDialog",!0),Ac.a.instance.setItem(wx.X7h,wx.Y7h)}catch(e){E.ULS.sendTraceTag(508302216,3050,15,"Failed to trigger Copilot FRE.",e)}}CZb(e){1===e?xa.a("CopilotFREDialogGotItButtonClicked"):
0===e&&xa.a("CopilotFREDialogCloseButtonClicked")}uum(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotFREDialogDebugIsEnabled",!1)?"OkToDisplayForDebug":this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotFREDialogIsEnabled",!1)?G.AFrameworkApplication.rN?"MeetingLiveSession":G.AFrameworkApplication.sessionStartInfoSettings?"Automation"===G.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup?"Automation":Ac.a.instance.localStorage?Ac.a.instance.getItem(wx.X7h)===
wx.Y7h?"FREShownBefore":"OkToDisplay":"NoAccessToLocalStorage":"SessionStartInfoNotAvailable":"FeatureNotEnabled"}}wx.X7h="IsCopilotFREAlreadyShown";wx.Y7h="V1";Object(F.a)(wx,"CopilotFREManager",null,[]);class mI extends Oa.a{constructor(){super(...arguments);this.K8=()=>{ib.StaticActiveAppFrame.za().kb.bdb(this.K8);this.initInternal()}}get name(){return"Copilot.Chat"}BUa(){if(D()){var e=ib.StaticActiveAppFrame.za().kb;e.uBa?this.initInternal():e.Qja(this.K8)}}initInternal(){try{this.qva()}catch(e){E.ULS.sendTraceTag(508347797,
3050,10,"Initializing CopilotChatPackage failed.",e)}}AUa(){}zUa(e){this.Z=e;D()&&(this.Z.ia("WordEditor.CopilotOperationLifecycleHandler",()=>new yv(this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"),this.Z.resolve("Box4.IUndoManager"))).ha(),this.Z.ia("WordEditor.Copilot.CopilotFREManager",()=>new wx(G.AFrameworkApplication.J)).ha(),this.Z.ia("WordEditor.CopilotOperationLifecycleHandler",()=>new yv(this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"),
this.Z.resolve("Box4.IUndoManager"))).ha(),this.Z.ia("WordEditor.Copilot.ICopilotChatAddInCommands",()=>new ew(G.AFrameworkApplication.va,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),G.AFrameworkApplication.J,this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),G.AFrameworkApplication.pc,e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.Ta("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Z.resolve("WordEditor.CopilotOperationLifecycleHandler"),
this.nrb(),this.Z.Oa("WordEditor.Copilot.CopilotFREManager"))).ha())}qva(){this.Z.resolve("WordEditor.Copilot.ICopilotChatAddInCommands").register()}nrb(){const e=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return e?e.getInstance(0):(E.ULS.sendTraceTag(508347796,3050,10,"Could not resolve wordCountManagerFactory"),null)}static main(){!G.AFrameworkApplication.hL&&D()&&R.a.instance.Mc(new mI)}}Object(F.a)(mI,"CopilotChatPackage",Oa.a,[]);Type.registerNamespace("B4Apps");Type.registerNamespace("ResumeAssistant.AppForOffice");
Type.registerNamespace("WEAFO");Type.registerNamespace("WECX");Type.registerNamespace("WELT");Type.registerNamespace("Wonca.AddInCommands");Type.registerNamespace("Wonca.AppsForOffice");Type.registerNamespace("WordEditor.AcronymsWeb");Type.registerNamespace("WordEditor.AddInCommands");Type.registerNamespace("WordEditor.Assistance");Type.registerNamespace("WordEditor.ConditionalTriggering");Type.registerNamespace("WordEditor.Designer");Type.registerNamespace("WordEditor.EditorUpsell");Type.registerNamespace("WordEditor.Extension");
Type.registerNamespace("WordEditor.Ideas");Type.registerNamespace("WordEditor.Ideas.TriggerModels");Type.registerNamespace("WordEditor.ListTransformationSuggestion");Type.registerNamespace("WordEditor.NeuralRewrite");Type.registerNamespace("WordEditor.OcsConnectionStatus");Type.registerNamespace("WordEditor.OcsVectorClockTelemetry");Type.registerNamespace("WordEditor.Policy");Type.registerNamespace("WordEditor.ProactiveUxGovernance");Type.registerNamespace("WordEditor.ReadingTime");Type.registerNamespace("WordEditor.ResumeAssistant");
Type.registerNamespace("WordEditor.SmartLookup");Type.registerNamespace("WordEditor.SmartLookup.SmartLookupManager");Type.registerNamespace("WordEditor.UpsellCampaign");Type.registerNamespace("WordEditor.Transcription");Type.registerNamespace("WordEditor.Transcription.SDXAddInLoader");Type.registerNamespace("WordEditor.Transformation");Type.registerNamespace("WordEditor.Translator");Type.registerNamespace("WordEditor.DocumentAssemblyEditor");Type.registerNamespace("Common.App.ContentSecurityPolicy");
U.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.DisplayEnvironmentName");W.main();Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("CommandUI.AddInCommands");kg.main();Da.main();"undefined"==typeof OfficeExtension&&Type.registerNamespace("OfficeExtension");"undefined"==typeof OfficeExtension.WacRuntime&&(OfficeExtension.WacRuntime={},Type.registerNamespace("OfficeExtension.WacRuntime"));
"undefined"==typeof OfficeExtension.WacRuntime.IAsyncEnumerator&&(OfficeExtension.WacRuntime.IAsyncEnumerator=function(){},OfficeExtension.WacRuntime.IAsyncEnumerator.prototype={get_current:null,moveNext:null},OfficeExtension.WacRuntime.IAsyncEnumerator.registerInterface("OfficeExtension.WacRuntime.IAsyncEnumerator"));CB.main();Pr.main();window.WordEditor.Extension.Range=Js;window.WordEditor.Extension.AutomationUtility=y;window.WordEditor.Extension.SearchOptions=zk.a;window.WordEditor.Extension.AutomationTransaction=
jB;G.AFrameworkApplication.hL||R.a.instance.Mc(new Fb);Zt.main();to.main();Type.registerNamespace("Common.App.LearningTools");R.a.instance.Mc(new Ne);SB.main();Object(aa.a)();wv.a.main();bw.main();try{R.a.instance.Mc(new bI)}catch(e){E.ULS.shipAssertTag(572838543,3025,!1,e.message)}ra.main();if(!G.AFrameworkApplication.hL)if(ib.StaticActiveAppFrame.za())try{R.a.instance.Mc(new zG(Jk.a.get_instance(),new Kc,ib.StaticActiveAppFrame.za().kb))}catch(e){E.ULS.shipAssertTag(592720736,3016,!1,String.format("{0} {1}",
e.message,e.stack))}else E.ULS.shipAssertTag(592558211,3016,!1);BD.main();dw.main();bz.main();DD.main();vv.main();tF.main();Xw.main();Un.main();Ra.main();lq.main();mI.main();Type.registerNamespace("Common.App.AppLoadStateTracker");window.Common.App.AppLoadStateTracker.AppLoadStateTracker=H.a;R.a.instance.Mc(new K,7);bC.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23047711/wdjs/WordEditorDS.box4.dll3.js.map