'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[16],{1989:function(I){function J(){J.init.call(this)}function d(D){if("function"!==typeof D)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D);}function m(D,y,H,F){d(H);var G=D.ig;if(void 0===G)G=D.ig=Object.create(null),D.KFa=0;else{void 0!==G.Zdq&&(D.emit("newListener",y,H.listener?H.listener:H),G=D.ig);var K=G[y]}void 0===K?(G[y]=H,++D.KFa):("function"===typeof K?
K=G[y]=F?[H,K]:[K,H]:F?K.unshift(H):K.push(H),H=void 0===D.yGd?J.LYp:D.yGd,0<H&&K.length>H&&!K.NGp&&(K.NGp=!0,H=Error("Possible EventEmitter memory leak detected. "+K.length+" "+String(y)+" listeners added. Use emitter.setMaxListeners() to increase limit"),H.name="MaxListenersExceededWarning",H.y_p=D,H.type=y,H.count=K.length,console&&console.warn&&console.warn(H)));return D}function f(){if(!this.Joi)return this.target.removeListener(this.type,this.Ack),this.Joi=!0,0===arguments.length?this.listener.call(this.target):
this.listener.apply(this.target,arguments)}function a(D,y,H){D={Joi:!1,Ack:void 0,target:D,type:y,listener:H};y=f.bind(D);y.listener=H;return D.Ack=y}function l(D,y,H){"function"===typeof D.on&&w(D,"error",y,H)}function w(D,y,H,F){if("function"===typeof D.on)if(F.once)D.once(y,H);else D.on(y,H);else if("function"===typeof D.addEventListener)D.addEventListener(y,function R(K){F.once&&D.removeEventListener(y,R);H(K)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+
typeof D);}var z="object"===typeof Reflect?Reflect:null,x=z&&"function"===typeof z.apply?z.apply:function(D,y,H){return Function.prototype.apply.call(D,y,H)},u=Number.isNaN||function(D){return D!==D};I.exports=J;I.exports.once=function(D,y){return new Promise(function(H,F){function G(R){D.removeListener(y,K);F(R)}function K(){"function"===typeof D.removeListener&&D.removeListener("error",G);H([].slice.call(arguments))}w(D,y,K,{once:!0});"error"!==y&&l(D,G,{once:!0})})};J.EventEmitter=J;J.prototype.ig=
void 0;J.prototype.KFa=0;J.prototype.yGd=void 0;var v=10;Object.defineProperty(J,"defaultMaxListeners",{enumerable:!0,get:function(){return v},set:function(D){if("number"!==typeof D||0>D||u(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");v=D}});J.init=function(){if(void 0===this.ig||this.ig===Object.getPrototypeOf(this).ig)this.ig=Object.create(null),this.KFa=0;this.yGd=this.yGd||void 0};J.prototype.emit=function(D){for(var y=
[],H=1;H<arguments.length;H++)y.push(arguments[H]);var F="error"===D;H=this.ig;if(void 0!==H)F=F&&void 0===H.error;else if(!F)return!1;if(F){var G;0<y.length&&(G=y[0]);if(G instanceof Error)throw G;y=Error("Unhandled error."+(G?" ("+G.message+")":""));y.context=G;throw y;}H=H[D];if(void 0===H)return!1;if("function"===typeof H)x(H,this,y);else{G=H.length;F=Array(G);for(var K=0;K<G;++K)F[K]=H[K];for(H=0;H<G;++H)x(F[H],this,y)}return!0};J.prototype.addListener=function(D,y){return m(this,D,y,!1)};J.prototype.on=
J.prototype.addListener;J.prototype.Cuj=function(D,y){return m(this,D,y,!0)};J.prototype.once=function(D,y){d(y);this.on(D,a(this,D,y));return this};J.prototype.ngo=function(D,y){d(y);this.Cuj(D,a(this,D,y));return this};J.prototype.removeListener=function(D,y){var H;d(y);var F=this.ig;if(void 0===F)return this;var G=F[D];if(void 0===G)return this;if(G===y||G.listener===y)0===--this.KFa?this.ig=Object.create(null):(delete F[D],F.removeListener&&this.emit("removeListener",D,G.listener||y));else if("function"!==
typeof G){var K=-1;for(H=G.length-1;0<=H;H--)if(G[H]===y||G[H].listener===y){var R=G[H].listener;K=H;break}if(0>K)return this;if(0===K)G.shift();else{for(;K+1<G.length;K++)G[K]=G[K+1];G.pop()}1===G.length&&(F[D]=G[0]);void 0!==F.removeListener&&this.emit("removeListener",D,R||y)}return this};J.prototype.off=J.prototype.removeListener;J.prototype.ste=function(D){var y=this.ig;if(void 0===y)return this;if(void 0===y.removeListener)return 0===arguments.length?(this.ig=Object.create(null),this.KFa=0):
void 0!==y[D]&&(0===--this.KFa?this.ig=Object.create(null):delete y[D]),this;if(0===arguments.length){var H=Object.keys(y);for(y=0;y<H.length;++y){var F=H[y];"removeListener"!==F&&this.ste(F)}this.ste("removeListener");this.ig=Object.create(null);this.KFa=0;return this}H=y[D];if("function"===typeof H)this.removeListener(D,H);else if(void 0!==H)for(y=H.length-1;0<=y;y--)this.removeListener(D,H[y]);return this};J.prototype.Zz=function(D){var y=this.ig;if(void 0===y)D=[];else if(D=y[D],void 0===D)D=
[];else if("function"===typeof D)D=[D.listener||D];else{y=Array(D.length);for(var H=0;H<y.length;++H)y[H]=D[H].listener||D[H];D=y}return D}},1990:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.AutoreplaceAnnotation=J.TextToSpeechAnnotation=J.IdeasPersonalizationSettingsAnnotation=J.EmptyDocumentAnnotation=J.UniqueWordsCountAnnotation=J.CritiqueCategoryCountAnnotation=J.NeuralRewriteCritique=J.Critique=J.SuggestionsAnnotation=J.Definition=J.LanguageCountAnnotationLocalized=J.LanguageCountAnnotation=
J.LanguageDetectionSummaryAnnotation=J.MultiTileRangeAnnotation=J.RangeAnnotation=void 0;const m=d(418);class f{constructor(E){m.SchemaObject.assign(f,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[f.getTypeName()])}}J.RangeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(E){m.SchemaObject.assign(a,
this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[a.getTypeName()])}}J.MultiTileRangeAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(E){m.SchemaObject.assign(l,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,
[l.getTypeName()])}}J.LanguageDetectionSummaryAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(E){m.SchemaObject.assign(w,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[w.getTypeName()])}}J.LanguageCountAnnotation=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(E){m.SchemaObject.assign(z,
this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[z.getTypeName()])}}J.LanguageCountAnnotationLocalized=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(E){m.SchemaObject.assign(x,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=
E}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[x.getTypeName()])}}J.Definition=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class u{constructor(E){m.SchemaObject.assign(u,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[u.getTypeName()])}}J.SuggestionsAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class v{constructor(E){m.SchemaObject.assign(v,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,
[v.getTypeName()])}}J.Critique=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class D{constructor(E){m.SchemaObject.assign(D,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[D.getTypeName()])}}J.NeuralRewriteCritique=
D;D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class y{constructor(E){m.SchemaObject.assign(y,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[y.getTypeName()])}}J.CritiqueCategoryCountAnnotation=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class H{constructor(E){m.SchemaObject.assign(H,this,
E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[H.getTypeName()])}}J.UniqueWordsCountAnnotation=H;H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class F{constructor(E){m.SchemaObject.assign(F,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,
[F.getTypeName()])}}J.EmptyDocumentAnnotation=F;F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class G{constructor(E){m.SchemaObject.assign(G,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[G.getTypeName()])}}J.IdeasPersonalizationSettingsAnnotation=G;G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};
class K{constructor(E){m.SchemaObject.assign(K,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[K.getTypeName()])}}J.TextToSpeechAnnotation=K;K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class R{constructor(E){m.SchemaObject.assign(R,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique",
"AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return m.SchemaObject.matchesTypesFor(E,[R.getTypeName()])}}J.AutoreplaceAnnotation=R;R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()}},1991:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,
z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1992),J);f(d(1993),J)},1992:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1993:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.GetThemesSignal=J.ExcludeThemes=J.SelectedTheme=J.GetImageJsonResponse=J.GetImageResponse=J.GetSuggestionsJsonResponse=
void 0;const m=d(418);class f{constructor(u){m.SchemaObject.assign(f,this,u)}get metadata(){return this.M_}set metadata(u){this.M_=u}static getTypeName(){return"AugLoop_QuickStart_GetSuggestionsJsonResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(u){return m.SchemaObject.matchesTypesFor(u,[f.getTypeName()])}}J.GetSuggestionsJsonResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(u){m.SchemaObject.assign(a,this,u)}get metadata(){return this.M_}set metadata(u){this.M_=
u}static getTypeName(){return"AugLoop_QuickStart_GetImageResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(u){return m.SchemaObject.matchesTypesFor(u,[a.getTypeName()])}}J.GetImageResponse=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(u){m.SchemaObject.assign(l,this,u)}get metadata(){return this.M_}set metadata(u){this.M_=u}static getTypeName(){return"AugLoop_QuickStart_GetImageJsonResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(u){return m.SchemaObject.matchesTypesFor(u,
[l.getTypeName()])}}J.GetImageJsonResponse=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(u){m.SchemaObject.assign(w,this,u)}static getTypeName(){return"AugLoop_QuickStart_SelectedTheme"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(u){return m.SchemaObject.matchesTypesFor(u,[w.getTypeName()])}}J.SelectedTheme=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(u){m.SchemaObject.assign(z,this,u)}static getTypeName(){return"AugLoop_QuickStart_ExcludeThemes"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(u){return m.SchemaObject.matchesTypesFor(u,
[z.getTypeName()])}}J.ExcludeThemes=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(u){m.SchemaObject.assign(x,this,u)}static getTypeName(){return"AugLoop_QuickStart_GetThemesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(u){return m.SchemaObject.matchesTypesFor(u,[x.getTypeName()])}}J.GetThemesSignal=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},2165:function(I,J,d){function m(M){return M?wb.None:wb.k4l}function f(M,fa){const Va=new pb.a;Va.dataFields=
[];if(!(1>M.length)){var Fb=sb.a.hI?sb.a.hI.sessionID:"";Va.dataFields.push(Object.assign(new tb.a,{name:"SessionID",string:Fb}));Va.dataFields.push(Object.assign(new tb.a,{name:"ContextType",string:fa}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 1",int64:M[0]}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 1 CmdName",string:nb[M[0]]}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 2",int64:2<=M.length?M[1]:4}));Va.dataFields.push(Object.assign(new tb.a,
{name:"Suggestion 2 CmdName",string:2<=M.length?nb[M[1]]:""}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 3",int64:3<=M.length?M[2]:4}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 3 CmdName",string:3<=M.length?nb[M[2]]:""}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 4",int64:4<=M.length?M[3]:4}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 4 CmdName",string:4<=M.length?nb[M[3]]:""}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 5",
int64:5<=M.length?M[4]:4}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 5 CmdName",string:5<=M.length?nb[M[4]]:""}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 6",int64:6<=M.length?M[5]:4}));Va.dataFields.push(Object.assign(new tb.a,{name:"Suggestion 6 CmdName",string:6<=M.length?nb[M[5]]:""}));Va.name="Office.Voice.Online.ALDictationProactiveCommandSuggestions";cb.a.sendActivityEvent(Va)}}function a(M,fa,Va,Fb,Vb){var wc=fa.length;var Xc=M.length;var vd=fa.length,
Dd=0,Ce=0;for(var ea=0;ea<Math.min(Xc,vd)&&M.charAt(ea)===fa.charAt(ea);ea++)Dd++,F.a.Zw(M.charCodeAt(ea))&&(Ce=Dd);Xc=Ce;vd=Math;Dd=vd.min;Ce=M.length;ea=fa.length;var Xa=0,yb=0;for(var Ub=0;Ub<Math.min(Ce,ea)&&M.charAt(Ce-Ub-1)===fa.charAt(ea-Ub-1);Ub++)Xa++,F.a.Zw(M.charCodeAt(Ce-Ub-1))&&(yb=Xa);Dd=Dd.call(vd,yb,Math.min(wc,M.length)-Xc);vd=Xc+Dd;Ce=Math.min(130,wc-vd);ea=Math.min(150-Ce,vd);let yc;Xa=Math.min(ea,Xc);yb=Math.min(ea,Dd);Ub=ea/2;Xa<Ub&&yb<Ub||(Xa<Ub?yb=Math.min(yb,ea-Xa):yb<Ub?Xa=
Math.min(Xa,ea-yb):yb=Xa=Ub);({CUk:yc,DUk:Xa}={CUk:Xa,DUk:yb});var ad=fa.substring(Xc-yc,Xc);ea=fa.substring(Xc,wc-Dd);wc=fa.substring(wc-Dd,wc-Dd+Xa);yb=ad;let md=ea;Ub=wc;Xc>yc&&(yb=l(ad,0,ad.length,!0),yb="..."+ad.substring(yb,ad.length));ea.length>Ce&&(ad=l(ea,0,Ce/2,!1),Ce=l(ea,Ce/2,ea.length,!0),md=ea.substring(0,ad)+"..."+ea.substring(Ce,ea.length));Dd>Xa&&(Dd=l(wc,0,wc.length,!1),Ub=wc.substring(0,Dd)+"...");return new hn(yb,md,Ub,ea,Xc,M.length-vd,Fb,M,fa,{start:Va?Va.startInContext:null,
length:Va?Va.contextLength:null},Va?Va.$fd.substring(Va.startInContext,Va.startInContext+Va.contextLength):null,Vb?Vb:null)}function l(M,fa,Va,Fb){if(Fb){for(;" "!==M.charAt(fa)&&fa<Va;)++fa;return fa}for(Fb=Va;" "!==M.charAt(Va)&&Va>fa;)--Va;Va+1<=Fb&&++Va;return Va}function w(M,fa,Va){M=a(M,fa);return"b1634cf9-5f68-42f4-82ca-e668f893d28f"===Va?[{start:M.FIg.length,length:M.GIg.length,fontWeight:Te.d.Bold,cssColor:"#5A45B6"}]:[]}d.r(J);var z=d(2),x=d(178),u=d(0),v=d(1189),D=d(17);class y{constructor(M){this.id=
M}}Object(u.a)(y,"DictationCommand",null,[]);var H=d(71),F=d(16);class G{constructor(){this.VCa=null;this.X2f=this.Bgd=this.r2=0;this.cNb=null}}Object(u.a)(G,"PhraseInfo",null,[]);class K{}K.word="word";K.character="character";K.sentence="sentence";K.paragraph="paragraph";K.$Yc="phrase";K.Qdc="bullet";Object(u.a)(K,"SelectionType",null,[]);var R=d(7),E=d(26),N=d(174),O=d(240),U=d(20);class X{constructor(M,fa,Va,Fb,Vb){this.ib=M;this.Qe=fa;this.oqa=Va;this.A4a=Fb;this.kDb=Vb}nVa(M,fa,Va){let Fb=!1,
Vb=null;if(!this.ib.gb||!this.ib.gb.currentSelection)return{returnValue:null,Sdd:Fb,DA:Vb};var wc=this.ib.gb.currentSelection;let Xc=wc.Qa;const vd=8==Va,Dd=5!==Va&&!vd;if(!Xc||!R.ParagraphReader.Wb(Xc.node))return{returnValue:null,Sdd:Fb,DA:Vb};this.Qe.Zl(Xc)&&M!==K.paragraph&&(wc=this.Qe.vk(wc,M==K.word&&Dd||M==K.sentence&&vd,!0),Xc=wc.Qa);Vb=Xc.node;let Ce=null;6===Va&&M===K.paragraph&&Xc.cpEnd&&(Ce=this.Qe.T2d(wc),Xc=Ce.Qa);if(!Xc.cpEnd&&Dd&&0!==Va){wc=this.NPn(null!==Ce&&void 0!==Ce?Ce:wc,Dd);
if(!wc||!R.ParagraphReader.Wb(wc.node)||wc.node.id===Xc.node.id)return{returnValue:null,Sdd:Fb,DA:Vb};Xc=wc;Fb=!0}wc=new H.a;switch(M){case K.paragraph:case K.word:case K.character:wc.addRange(Dd?this.uEi(Xc,fa,M,Va):this.eCi(Xc,fa,M));break;case K.sentence:wc.addRange(Dd?this.uEi(Xc,fa,M,Va):vd?this.vrm(Xc,fa):this.eCi(Xc,fa,M));break;case K.$Yc:wc.add(this.aqm());break;default:wc.add(Xc)}return{returnValue:wc,Sdd:Fb,DA:Vb}}etn(){if(!this.ib.gb||!this.ib.gb.currentSelection)return!1;const M=this.ib.gb.currentSelection.Qa;
return this.Qe.UA(M.node,M,!1)}Wnc(){if(!this.ib.gb||!this.ib.gb.currentSelection)return!1;var M=this.ib.gb.currentSelection.Qa;if(!this.Qe.mf(M)||!M.cpEnd||!R.ParagraphReader.Wb(M.node))return!1;var fa=R.ParagraphReader.text(M.node);const Va=fa.charAt(M.cpBegin-1);fa=fa.charAt(M.cpEnd);const Fb=this.Qe.UA(M.node,M,!1);M=this.Qe.UA(M.node,M,!0);return Fb||M?!1:!F.a.bga(Va)&&!F.a.bga(fa)}Ptb(){if(!this.ib.gb||!this.ib.gb.currentSelection)return!1;var M=this.ib.gb.currentSelection;return M&&1<M.length?
!0:(M=M.Qa)?!this.Qe.mf(M):!1}xqn(){if(!this.ib.gb||!this.ib.gb.currentSelection)return!1;const M=this.ib.gb.currentSelection.Qa,fa=R.ParagraphReader.text(M.node);return M.cpEnd?-1!==X.uhc.indexOf(fa.charAt(M.cpEnd-1)):!1}Sfn(){return this.ib.gb&&this.ib.gb.currentSelection?this.Qe.B$a(this.ib.gb.currentSelection.Qa):!1}NPn(M,fa){(M=this.Qe.iic(M,fa,!1,!0))&&(M=this.Qe.S2d(M,!1));return M?M.Qa:null}pg(M,fa){return(M=R.ParagraphReader.pg(M.node,fa,!0,!0))?E.a.create(M):null}RJi(M){var fa=M.cpEnd;if(!fa)return null;
const Va=new H.a,Fb=R.ParagraphReader.text(M.node),Vb=O.a.foc(M,null);var wc=this.oqa.E8a(Fb,fa,Vb);if(wc===fa)return null;fa=this.oqa.W8a(Fb,wc,Vb);if(fa<=wc)return null;wc=new N.a(wc,fa);return wc.sad()?(Va.add(E.a.createTextRange(M.node,wc.Dc,wc.end)),Va):null}uEi(M,fa,Va,Fb){if(!fa)return new H.a;var Vb=R.ParagraphReader.text(M.node);let wc=M.cpEnd,Xc;const vd=O.a.foc(M,null);if(Va===K.paragraph)0==wc&&0!==Fb?(M=this.pg(M,!0),Xc=R.ParagraphReader.textLength(M.node)):(wc=0,Xc=Vb.length);else if(Va===
K.sentence)Fb=this.A4a.JCf(Vb,wc),Xc=wc==Fb?wc:this.A4a.C0c(Vb,Fb);else if(Va===K.word)6===Fb&&this.Wnc()&&(wc=this.oqa.E8a(Vb,wc,vd)),0!==wc&&(Fb=this.oqa.E8a(Vb,wc,vd),Xc=this.oqa.W8a(Vb,Fb,vd));else if(Va===K.character)Xc=wc;else return new H.a;for(Fb=new H.a;0<fa;fa--){if(0===wc){Vb=new N.a(wc,Xc);Vb.sad()&&Fb.add(E.a.createTextRange(M.node,Vb.Dc,Vb.end));Vb=M;M=this.pg(M,!0);if(!M||!R.ParagraphReader.Wb(M.node)||M.node.id===Vb.node.id)return Fb;Vb=R.ParagraphReader.text(M.node);wc=Xc=Vb.length}wc=
this.wkm(Vb,wc,Va,vd);if(-1===wc)return new H.a}Va!==K.paragraph&&Fb.add(E.a.createTextRange(M.node,wc,Xc));const Dd=new H.a;Fb.toArray().reverse().forEach(Ce=>{Dd.add(Ce)});return Dd}wkm(M,fa,Va,Fb){switch(Va){case K.paragraph:return 0;case K.sentence:return fa-=this.A4a.LCi(M,fa),this.A4a.JCf(M,fa);case K.word:return this.aym(M,fa,Fb);case K.character:return fa-1;default:return-1}}aym(M,fa,Va){do{var Fb=fa;fa=this.oqa.E8a(M,fa,Va);if(0===Fb)break;Fb=M.substring(fa,Fb)}while(!F.a.p8c(Fb.charAt(0)));
return fa}eCi(M,fa,Va){if(!fa)return new H.a;var Fb=R.ParagraphReader.text(M.node);let Vb=M.cpBegin;let wc=Fb.length;const Xc=O.a.foc(M,null);if(Va===K.paragraph)if(0!==Vb){M=this.pg(M,!1);var vd=0;Vb=wc=R.ParagraphReader.textLength(M.node)}else vd=0,Vb=Fb.length;else if(Va===K.sentence){vd=this.A4a.C0c(Fb,Vb);var Dd=this.A4a.LCi(Fb,vd);Dd=this.A4a.JCf(Fb,vd-Dd);vd=Vb>Dd?Vb=vd:Vb=Dd}else if(Va===K.word)vd=this.oqa.W8a(Fb,Vb,Xc),Dd=this.oqa.E8a(Fb,vd,Xc),vd=Vb>Dd?Vb=vd:Vb=Dd;else if(Va===K.character)vd=
Vb;else return new H.a;for(Dd=new H.a;0<fa;fa--){if(Vb==wc){Fb=new N.a(vd,Vb);Fb.sad()&&Dd.add(E.a.createTextRange(M.node,Fb.Dc,Fb.end));Fb=M;M=this.pg(M,!1);if(!M||!R.ParagraphReader.Wb(M.node)||M.node.id===Fb.node.id)return Dd;Fb=R.ParagraphReader.text(M.node);Vb=vd=0;wc=Fb.length}Vb=this.Zti(Fb,Vb,Va,Xc);Va===K.word&&Vb===wc&&fa++;if(-1===Vb)return new H.a}Va!==K.paragraph&&Dd.add(E.a.createTextRange(M.node,vd,Vb));return Dd}vrm(M,fa){if(!fa)return new H.a;const Va=R.ParagraphReader.text(M.node);
let Fb=M.cpBegin,Vb;const wc=O.a.foc(M,null);Vb=Fb=this.A4a.C0c(Va,Fb);const Xc=new H.a;for(;0<fa;fa--)if(Fb=this.Zti(Va,Fb,K.sentence,wc),-1===Fb)return new H.a;Xc.add(E.a.createTextRange(M.node,Vb,Fb));return Xc}Zti(M,fa,Va,Fb){switch(Va){case K.paragraph:return M.length;case K.sentence:return this.A4a.C0c(M,fa);case K.word:return this.cCm(M,fa,Fb);case K.character:return fa+1;default:return-1}}cCm(M,fa,Va){const Fb=M.length;do{var Vb=fa;if(Vb===Fb)return Fb;fa=this.oqa.W8a(M,fa,Va);Vb=M.substring(Vb,
fa)}while(!F.a.p8c(Vb.charAt(0)));return fa}oVa(M){let fa=0;const Va=[];if(!M||!M.length)return{returnValue:Va,JUa:fa};if((M=this.bNf(M))&&-1!==M.r2){const Fb=new N.a(M.r2,M.r2+M.X2f);fa=M.Bgd;Va.push(E.a.createTextRange(M.cNb,Fb.Dc,Fb.end))}return{returnValue:Va,JUa:fa}}Hnm(M,fa){const Va=[];if(!M||!M.length)return{returnValue:Va,JUa:0};if((M=this.bNf(M))&&-1!==M.r2){const Vb=new N.a(M.r2,M.r2+M.X2f);var Fb=R.ParagraphReader.text(M.cNb).toLowerCase();0==Vb.Dc&&fa||!fa&&Vb.end==Fb.length-1?Va.push(E.a.createTextRange(M.cNb,
Vb.Dc,Vb.end)):fa?(fa=-1!==X.uhc.indexOf(Fb.charAt(Vb.Dc-2))?Vb.Dc-2:Vb.Dc-1,Fb=this.oqa.E8a(Fb,fa,!1),Va.push(E.a.createTextRange(M.cNb,Fb,Vb.Dc-1))):(fa=-1!==X.uhc.indexOf(Fb.charAt(Vb.end))?Vb.end+2:Vb.end+1,Fb=this.oqa.W8a(Fb,fa,!1),Va.push(E.a.createTextRange(M.cNb,Vb.end+1,Fb)))}return{returnValue:Va,JUa:0}}s2c(M,fa){let Va=0,Fb;const Vb=[];if(!(M&&fa&&M.length&&fa.length))return{returnValue:Vb,JUa:Va};const wc=this.bNf(M);if(!wc||wc&&-1===wc.r2)return{returnValue:Vb,JUa:Va};let Xc=wc.cNb;var vd=
wc.r2;for(Fb=wc.Bgd;Xc;){const Ce=R.ParagraphReader.text(Xc).toLowerCase();var Dd=Ce;let ea;Fb===wc.Bgd?(Dd=this.F7h(wc.r2,Ce,this.Shj(M),!1),{Aub:ea,returnValue:Dd}=this.Zvi(Dd,fa),-1!==Dd&&(Dd+=vd+wc.VCa.length)):{Aub:ea,returnValue:Dd}=this.Zvi(Dd,fa);if(-1===Dd)Fb===wc.Bgd?(vd=new N.a(vd,Ce.length),Vb.push(E.a.createTextRange(Xc,vd.Dc,vd.end)),Vb.push(E.a.Wl(Xc))):Vb.push(E.a.create(Xc)),vd=0,Fb++,Xc=R.ParagraphReader.pg(Xc,!1);else return vd=new N.a(vd,Dd+ea),Vb.push(E.a.createTextRange(Xc,vd.Dc,
vd.end)),Va=Fb,{returnValue:Vb,JUa:Va}}Array.clear(Vb);return{returnValue:Vb,JUa:Va}}bNf(M){let fa=null;if(!M||!M.length)return fa;let Va=0;const Fb=this.ujc();if(!Fb||!Fb.node)return fa;let Vb=Fb.node;for(;Vb;){var wc=R.ParagraphReader.text(Vb).toLowerCase();let Xc=wc;Va||(Xc=this.F7h(Fb.cpBegin,wc,this.Shj(M),!0));const vd=({Aub:wc}=this.oom(Xc,M)).returnValue;if(-1!==vd){fa=new G;fa.VCa=Xc.substring(vd,vd+wc);fa.r2=vd;fa.Bgd=Va;fa.X2f=wc;fa.cNb=Vb;break}Va--;Vb=R.ParagraphReader.pg(Vb,!0)}return fa}ujc(){if(!this.ib||
!this.ib.gb)return null;const M=this.ib.gb.currentSelection;return M?M.Qa:null}iwi(){const M=this.ujc();return M&&M.node&&R.ParagraphReader.Wb(M.node)?R.ParagraphReader.textLength(M.node):0}F7h(M,fa,Va,Fb){if(""===fa||!fa)return"";for(;M!==fa.length&&(!this.atb(fa.charAt(M))||Va);){if(this.atb(fa.charAt(M)))if(M<fa.length-1&&this.atb(fa.charAt(M+1))){M++;continue}else Va--;M++}return Fb?fa.substring(0,M):fa.substring(M,fa.length)}atb(M){return F.a.bga(M)||"-"===M||"\u2014"===M||-1!==X.uhc.indexOf(M)}oom(M,
fa){let Va=0,Fb=0,Vb=!1;if(!M||""===M)return{returnValue:-1,Aub:Va};M=this.Pri(M);fa=this.t1j(fa);let wc=M.count-1,Xc=fa.length-1;for(;0<=wc&&0<=Xc;)if(M.K(wc).VCa===fa[Xc]){if(!Xc)return Va=Vb?Va+(Fb-M.K(wc).r2):M.K(wc).VCa.length,{returnValue:M.K(wc).r2,Aub:Va};Vb||(Va=M.K(wc).VCa.length,Fb=M.K(wc).r2,Vb=!0);wc--;Xc--}else Xc===fa.length-1?wc--:(Xc=fa.length-1,Vb=!1);return{returnValue:-1,Aub:Va}}Zvi(M,fa){let Va=0,Fb=0,Vb=!1;if(""===M||!M)return{returnValue:-1,Aub:Va};M=this.Pri(M);fa=this.t1j(fa);
let wc=0,Xc=0;for(;wc<M.count&&Xc<fa.length;)if(M.K(wc).VCa===fa[Xc]){if(Xc===fa.length-1)return Va=Vb?M.K(wc).r2-Fb+M.K(wc).VCa.length:M.K(wc).VCa.length,{returnValue:M.K(wc-Xc).r2,Aub:Va};Vb||(Fb=M.K(wc).r2,Vb=!0);wc++;Xc++}else Xc?(Xc=0,Vb=!1):wc++;return{returnValue:-1,Aub:Va}}Pri(M){const fa=new H.a;if(""===M||!M)return fa;let Va=0;for(var Fb=0;Fb<M.length;Fb++)if(this.atb(M.charAt(Fb))){if(Va===Fb){Va=Fb+1;continue}const Vb=M.substring(Va,Fb),wc=new G;wc.VCa=Vb;wc.r2=Va;fa.add(wc);Va=Fb+1}Fb=
new G;Fb.VCa=M.substring(Va,M.length);Fb.r2=Va;fa.add(Fb);return fa}t1j(M){return M.split(" ")}Shj(M){let fa=0;if(!M||!M.length)return fa;for(let Va=0;Va<M.length;Va++)F.a.bga(M.charAt(Va))&&fa++;return fa}aqm(){if(!this.kDb)return null;var M=this.kDb.pZe;if(!M)return null;var fa=U.StaticActiveAppFrame.za().kb.Qc.vd;if(fa&&(fa=fa.Hc.Eb(M.oSn))){const Va=R.ParagraphReader.text(fa),Fb=M.VCa,Vb=M.vu;M=M.vu+Fb.length;if(Vb>Va.length||M>Va.length)return null;if(Va.substring(Vb,M)===Fb)return E.a.createTextRange(fa,
Vb,M)}return null}vpl(M,fa){if(!M||0>fa)return!1;let Va=R.ParagraphReader.text(M.node);if(M.cpEnd==Va.length){for(;0<fa;){M=this.pg(M,!1);if(!M)break;Va=R.ParagraphReader.text(M.node);if(""!==Va||0!==Va.length)return!1;fa--}return!0}return!1}}X.uhc="?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61),;";Object(u.a)(X,"CommandSelectionUtil",null,[]);class V{static Sl(M,fa=null){V.Pb.b3=5;M=fa?V.Pb.Qb(M,2,fa):V.Pb.Ob(M,2);V.Pb.b3=
0;return M}}V.Pb=null;Object(u.a)(V,"ProcessActionByDictation",null,[]);var Q=d(3);class T extends y{constructor(M,fa,Va,Fb,Vb,wc){super(39);this.Rc=M;this.Vl=new X(fa,Va,Fb,Vb,wc)}executeCommand(M){M=(M=(M=M?M.K("command"):null)?M.selection:null)&&M.count?M.count:1;if(1>M||1E3<M)return!1;let fa=!0;const Va=this.Vl.ujc(),Fb=this.Rc.Lc(15);try{for(Fb.Ab(Va.node);0<M;)fa=fa&&32===V.Sl(Q.a.backspace),M--}finally{Fb&&Fb.dispose()}return fa}}Object(u.a)(T,"BackspaceCommand",y,[]);class ba extends y{constructor(){super(41)}executeCommand(){return 32===
V.Sl(Q.a.S2)}}Object(u.a)(ba,"GrowFontCommand",y,[]);class W extends y{constructor(){super(42)}executeCommand(){return 32===V.Sl(Q.a.l4)}}Object(u.a)(W,"ShrinkFontCommand",y,[]);class aa extends y{constructor(){super(38)}executeCommand(){return 32===V.Sl(Q.a.KI)}}Object(u.a)(aa,"DecreaseIndentCommand",y,[]);class Y extends y{constructor(){super(37)}executeCommand(){return 32===V.Sl(Q.a.eR)}}Object(u.a)(Y,"IncreaseIndentCommand",y,[]);class da extends y{constructor(){super(18)}executeCommand(){return 32===
V.Sl(Q.a.X$)}}Object(u.a)(da,"CenterJustifyCommand",y,[]);class ka extends y{constructor(){super(17)}executeCommand(){return 32===V.Sl(Q.a.TJa)}}Object(u.a)(ka,"FullJustifyCommand",y,[]);class qa extends y{constructor(){super(19)}executeCommand(){return 32===V.Sl(Q.a.O7)}}Object(u.a)(qa,"LeftJustifyCommand",y,[]);class ua extends y{constructor(){super(20)}executeCommand(){return 32===V.Sl(Q.a.t8)}}Object(u.a)(ua,"RightJustifyCommand",y,[]);var Pa=d(21),Ja;(function(M){M[M.current=0]="current";M[M.left=
1]="left";M[M.right=2]="right";M[M.uTk=3]="above";M[M.Ycl=4]="below";M[M.next=5]="next";M[M.Vv=6]="previous";M[M.start=7]="start";M[M.end=8]="end";M[M.up=9]="up";M[M.down=10]="down";M[M.before=11]="before";M[M.after=12]="after"})(Ja||(Ja={}));Object(u.b)("CommandDirection",Ja);class Ca{static H8a(M){switch(M){case "current":return Ja.current;case "up":return Ja.up;case "down":return Ja.down;case "above":return Ja.uTk;case "below":return Ja.Ycl;case "left":return Ja.left;case "right":return Ja.right;
case "start":return Ja.start;case "end":return Ja.end;case "next":return Ja.next;case "previous":return Ja.Vv;case "before":return Ja.before;case "after":return Ja.after;default:return Ja.current}}}Object(u.a)(Ca,"DirectionHelper",null,[]);var ra=d(6);class Ea{constructor(M){this.ib=M}X6d(M){const fa=this.j6d();if(!fa)return null;const Va=new ra.a;Va.set(fa);Va.zb(11);Va.kd(11);return M.Uw(Va)}NZf(){const M=this.j6d();return!R.ParagraphReader.textLength(M)}j6d(){if(!this.ib||!this.ib.gb)return null;
var M=this.ib.gb.currentSelection;return(M=M?M.Qa:null)&&R.ParagraphReader.Wb(M.node)?M.node:null}vrc(M){M=Pa.SelectionFactory.ue(M,R.ParagraphReader.textLength(M));this.ib.Kc(M)}}Object(u.a)(Ea,"GraphTraversalUtil",null,[]);class xa{static sAi(M){const fa=new ra.a;fa.set(M);if(fa.Nd())return fa.kd(11),fa}static wFe(M){M=parseInt(M);isNaN(M)&&(M=1);return M}}Object(u.a)(xa,"CommonHelper",null,[]);var Ma=d(42);class ha{}ha.bPf=(M,fa)=>{if(fa){if(null==M.E9d())return null}else if(null==M.JKi())return null;
return Ma.ListItemReader.Fg(M)?M:ha.bPf(M,fa)};Object(u.a)(ha,"BulletHelper",null,[]);class la extends y{constructor(M,fa,Va,Fb,Vb){super(11);this.Vl=null;this.Vl=new X(M,fa,Va,Fb,Vb);this.ib=M;this.Q9=new Ea(M)}executeCommand(M){const fa=(M=(M=M?M.K("command"):null)?M.selection:null)&&M.count?M.count:1;if(!M)return!1;const Va=Ca.H8a(null===M||void 0===M?void 0:M.which);switch(M.type){case K.word:5==Va?V.Sl(Q.a.d7a):6==Va&&V.Sl(Q.a.kob);break;case K.paragraph:5==Va?V.Sl(Q.a.Ifc):6==Va?V.Sl(Q.a.XXc):
8==Va&&V.Sl(Q.a.Oje);break;case K.Qdc:5==Va?this.FKi(!0):6==Va&&this.FKi(!1);break;case K.sentence:this.oPn(Va);break;case void 0:return this.mPn(Va,xa.wFe(fa));default:return!1}return!0}oPn(M){var fa=this.Vl.nVa(K.sentence,1,M).returnValue;!fa||1>fa.count||(fa=fa.K(0),M=Pa.SelectionFactory.ue(fa.node,5==M?fa.cpEnd:fa.cpBegin),this.ib.Kc(M))}mPn(M,fa){let Va=0;switch(M){case 3:case 9:Va=Q.a.BAb;break;case 4:case 10:Va=Q.a.DUa;break;case 1:Va=Q.a.cCa;break;case 2:Va=Q.a.dha}if(!Va||0>=fa)return!1;
for(M=0;M<fa;M++)V.Sl(Va);return!0}FKi(M){var fa=this.Q9.j6d();fa=xa.sAi(fa);null!=ha.bPf(fa,M)&&null!=fa.Vb(2)&&12==fa.currentNode.type&&this.Q9.vrc(fa.currentNode)}}Object(u.a)(la,"NavigationCommand",y,[]);var Fa=d(50),Ga=d(27),va=d(31),pa=d(202),Oa=d(15);class Ra{static get nob(){return Ra.jdh}static vrc(M){M=Pa.SelectionFactory.ue(M,R.ParagraphReader.textLength(M));Fa.a.instance.Kc(M)}static Nxg(){Ra.jdh=Fa.a.instance.gb.currentSelection.Qa}static yYf(){return Ga.TableReader.xtb(Ra.nob.node)}static c2c(){var M=
ra.a.eb(Ra.nob.node);if(!M.zb(14))return null;M=Oa.returnToCell(M);M=ra.a.eb(M);M.zb(14);return M}static ENf(){const M=ra.a.eb(Ra.nob.node);if(!M.zb(14))return null;Oa.returnToContainingTable(M);return M}static H8f(M){pa.OutlineNavigator.U8f(M);va.OutlineElementNavigator.Me(M);12===M.currentNode.type&&Ra.vrc(M.currentNode)}static qNm(M){switch(M){case "table":return 0;case "row":return 1;case "column":return 2;case "cell":return 3;default:return 0}}}Ra.jdh=null;Object(u.a)(Ra,"TableHelper",null,[]);
var fb=d(73),qb=d(53);class mb extends y{constructor(M){super(9);this.Rc=M}executeCommand(M){Ra.Nxg();if(!Ra.yYf())return!0;M=(M=M?M.K("command"):null)?M.selection:null;if(!M||"table"!==M.type&&"row"!==M.type&&"column"!==M.type&&"cell"!==M.type)return!1;M.which=void 0===M.which||null===M.which?"current":M.which;const fa=Ca.H8a(M.which);switch(M.type){case "table":return V.Sl(Q.a.RW),!0;case "cell":return this.nVd(),!0;case "row":if(!fa||3===fa||4===fa)return this.eei(!0,xa.wFe(M.count),fa),!0;break;
case "column":if(!fa||1===fa||2===fa)return this.eei(!1,xa.wFe(M.count),fa),!0}return!1}eei(M,fa,Va){var Fb=Ra.ENf();const Vb=ra.a.eb(Ra.nob.node);if(Fb&&Ga.TableReader.isTable(Fb)){var wc=Ra.c2c();wc=M?qb.a.Ft(wc):fb.a(wc);Fb=M?Ga.TableReader.vg(Fb.currentNode):Ga.TableReader.Eh(Fb.currentNode);if(Va)if(4===Va||2===Va){if(wc+1+fa>Fb)return;Fb=wc+1}else{if(wc<fa)return;Fb=wc-fa}else{if(wc+fa>Fb)return;Fb=wc}fa=Fb+fa-1;wc=this.Rc.Lc(15);try{if(wc.Ab(Ra.nob.node),!Va||this.cml(M,Fb))for(Va=Fb;Va<=fa;Va++)V.Sl(M?
Q.a.deleteRow:Q.a.deleteColumn)}finally{wc&&wc.dispose()}Vb.zb(14)&&(M=Ra.c2c(),Ra.H8f(M))}}nVd(){const M=this.Rc.Lc(15);try{M.Ab(Ra.nob.node),V.Sl(Q.a.Lmd),V.Sl(Q.a.gI)}finally{M&&M.dispose()}}cml(M,fa){if(0>fa)return!1;const Va=Ra.c2c(),Fb=Ra.c2c();M?(Oa.moveToRowByIndex(Fb,fa),M=Fb.currentNode===Va.currentNode?null:Fb.currentNode):M=Oa.moveToColumnByIndex(Fb,fa);return M?(Fb.set(M),Ra.H8f(Fb),!0):!1}}Object(u.a)(mb,"DeleteTableCommand",y,[]);var eb=d(899);class bb extends y{constructor(M){super(8);
this.Rc=M}executeCommand(M){Ra.Nxg();var fa=M?M.K("command"):null;if(fa=fa?fa.tableParameters:null)return this.insertTable(fa);if(!Ra.yYf())return!0;M=(M=M?M.K("command"):null)?M.selection:null;if(!M)return!1;M.which=void 0===M.which||null===M.which?"current":M.which;return"row"!==M.type&&"column"!==M.type?!1:this.$an("row"===M.type,xa.wFe(M.count),Ca.H8a(M.which))}insertTable(M){const fa=new eb.a;fa.rows=1;fa.columns=1;M&&(fa.rows=10<M.rows?10:M.rows,fa.columns=10<M.columns?10:M.columns);return 32===
V.Sl(Q.a.insertTable,fa)}$an(M,fa,Va){let Fb=0;M?3!==Va&&4!==Va&&Va||(Fb=3===Va?Q.a.Asb:Q.a.s$a):1!==Va&&2!==Va&&Va||(Fb=1===Va?Q.a.H7c:Q.a.I7c);if(!Fb)return!1;M=this.Rc.Lc(15);try{for(M.Ab(Ra.nob.node),Va=1;Va<=fa;Va++)V.Sl(Fb)}finally{M&&M.dispose()}return!0}}Object(u.a)(bb,"InsertTableCommand",y,[]);class Wa extends y{constructor(){super(10)}executeCommand(M){Ra.Nxg();if(!Ra.yYf())return!0;if(M=(M=M?M.K("command"):null)?M.selection:null){if("table"!==M.type&&"row"!==M.type&&"column"!==M.type&&
"cell"!==M.type)return!1;M.which=void 0===M.which||null===M.which?"current":M.which;this.nPn(Ra.qNm(M.type),Ca.H8a(M.which));return!0}return!1}o4l(){var M=ra.a.eb(Ra.nob.node);M.zb(14)&&(M=Oa.getContainingTable(M),(M=R.ParagraphReader.pg(M,!1,!0,!1))&&Ra.vrc(M))}nPn(M,fa){let Va=Ra.c2c();switch(M){case 0:switch(fa){case 7:Va=this.Sej(0,0);break;case 8:M=Ra.ENf();Va=this.Sej(Ga.TableReader.vg(M.currentNode)-1,Ga.TableReader.Eh(M.currentNode)-1);break;case 0:this.o4l();return}break;case 1:switch(fa){case 7:Oa.moveToFirstColumn(Va);
break;case 8:Oa.moveToLastColumn(Va);break;case 5:Oa.moveToNextRow(Va);break;case 6:Oa.moveToPreviousRow(Va)}break;case 2:switch(fa){case 7:Oa.moveToFirstRow(Va);break;case 8:Oa.moveToLastRow(Va);break;case 5:Oa.moveToNextColumn(Va);break;case 6:Oa.moveToPreviousColumn(Va)}break;case 3:switch(fa){case 5:Oa.moveToNextOrPreviousCell(Va,!1);break;case 6:Oa.moveToNextOrPreviousCell(Va,!0)}}Va&&Ra.H8f(Va)}Sej(M,fa){const Va=Ra.ENf();Va&&Ga.TableReader.isTable(Va)&&0<=M&&M<Ga.TableReader.vg(Va.currentNode)&&
0<=fa&&fa<Ga.TableReader.Eh(Va.currentNode)&&Oa.moveToCell(Va,M,fa);return Va}}Object(u.a)(Wa,"NavigateTableCommand",y,[]);var Za=d(344),Na=d(8),Db=d(103),nb;(function(M){M[M.lhq=0]="pauseDictation";M[M.d0p=1]="exitDictationMode";M[M.undo=2]="undo";M[M.Sga=3]="redo";M[M.none=4]="none";M[M.bold=5]="bold";M[M.fA=6]="setItalic";M[M.paste=7]="paste";M[M.insertTable=8]="insertTable";M[M.RW=9]="deleteTable";M[M.Sdq=10]="navigateTable";M[M.navigation=11]="navigation";M[M.dMa=12]="newComment";M[M.underline=
13]="underline";M[M.ajq=14]="removeBold";M[M.bjq=15]="removeItalic";M[M.gjq=16]="removeUnderline";M[M.TJa=17]="fullJustify";M[M.X$=18]="centerJustify";M[M.O7=19]="leftJustify";M[M.t8=20]="rightJustify";M[M.superscript=21]="superscript";M[M.subscript=22]="subscript";M[M.strikethrough=23]="strikethrough";M[M.djq=24]="removeStrikethrough";M[M.ejq=25]="removeSubscript";M[M.Y5p=26]="insertBullet";M[M.Vli=27]="exitList";M[M.bYp=28]="createBulletList";M[M.cYp=29]="createNumberList";M[M.fjq=30]="removeSuperscript";
M[M.delete=31]="delete";M[M.showHelp=32]="showHelp";M[M.xmq=33]="showCommands";M[M.fE=34]="clearFormatting";M[M.ceq=35]="nextLine";M[M.$5p=36]="insertSpace";M[M.I5m=37]="increaseIndent";M[M.XNl=38]="decreaseIndent";M[M.backspace=39]="backspace";M[M.beq=40]="nextBullet";M[M.Y3p=41]="growFont";M[M.Bmq=42]="shrinkFont";M[M.select=43]="select";M[M.allCaps=44]="allCaps";M[M.Hlq=45]="sentenceCase";M[M.x8p=46]="lowerCase";M[M.highlight=47]="highlight";M[M.removeHighlight=48]="removeHighlight";M[M.tab=49]=
"tab";M[M.xiq=50]="readBack";M[M.z_p=51]="emoji";M[M.ssq=52]="zoomIn";M[M.tsq=53]="zoomOut";M[M.zmq=54]="showOutline";M[M.MNj=55]="setFont";M[M.fcb=56]="pageBreak";M[M.clq=57]="scrollUp";M[M.alq=58]="scrollDown";M[M.insertText=59]="insertText";M[M.quote=60]="quote";M[M.Xjq=61]="resumeDictation";M[M.zT=62]="applyStyle";M[M.Eei=63]="deselect";M[M.UXp=64]="correction";M[M.correctionOption=65]="correctionOption";M[M.Mnq=66]="spellOut";M[M.Amq=67]="showSuggestions";M[M.$dq=68]="newParagraph"})(nb||(nb=
{}));Object(u.b)("DictationCommandId",nb);class Ta extends y{constructor(M,fa,Va){super(M);this.lg=fa;this.Q9=new Ea(Va)}executeCommand(){var M=this.Q9.X6d(this.lg),fa=this.Q9.NZf();if(M)return!0;if(fa)return 32===V.Sl(this.iqb(),this.gqb());M=32===V.Sl(Q.a.vE);fa=32===V.Sl(this.iqb(),this.gqb());return M&&fa}iqb(){switch(this.id){case 28:return Q.a.$E;case 29:return Q.a.KN;default:return Na.ULS.shipAssertTag(593048596,394,!1),0}}gqb(){const M=new Za.DictionaryPropertySet;M.setValue(Db.a.Cta,"dictation");
M.setValue(Db.a.qma,nb[this.id]);return M}}Object(u.a)(Ta,"CreateListCommand",y,[]);var cb=d(185),sb=d(131),pb=d(302),tb=d(30),wb;(function(M){M[M.None=0]="None";M[M.k4l=1]="executionFailed";M[M.Blq=2]="selectionPhraseNotFound";M[M.Clq=3]="selectionRangeNotFound";M[M.loq=4]="suggestionIntentNotAvailable"})(wb||(wb={}));Object(u.b)("DictationCommandErrorCode",wb);class gc{constructor(M,fa){this.eMc=0;this.$qk="Office.Voice.Online.DictationCommand";this.zFd=0;this.jPk=this.kPk=this.jYe=!1;this.En=M;
this.WVc=fa;this.Czd=new Map}Hq(M){this.Czd.set(M.id,M)}I5n(){this.Czd.get(50).cdp()}J5n(){this.Czd.get(50).Gep()}executeCommand(M,fa,Va){const Fb=(new Date).getTime();var Vb=this.Czd.get(M),wc=1;Vb?(this.jYe=!0,this.Zsp(),wc=Vb.executeCommand(fa),Na.ULS.sendTraceTag(537678860,394,50,`Executing voice command: ${M} using command handler ${Vb.id}`),wc="boolean"===typeof wc?m(wc):wc,0===wc&&(this.zFd=M),this.jYe=!1):Na.ULS.sendTraceTag(537678861,394,10,`Could not find command handler to execute voice command: ${M}`);
Vb=(new Date).getTime();fa&&fa.tb("skipTelemetry")&&!0===fa.K("skipTelemetry")||this.owg(M,wc,Vb-Fb,Va);return wc}Y0f(){return this.jYe}get lkn(){return this.jPk}get Ppn(){return Array.contains(gc.Fao,this.zFd)||this.kPk}qWo(){this.zFd=59}WGo(){this.zFd=59}GZn(){this.eMc++}N1n(){this.eMc=0}Zsp(){for(;this.eMc&&this.En.V2&&this.En.Eka===Q.a.ZYc;)this.eMc--,this.En.undo();this.eMc=0}sHn(M,fa){this.owg(4,m(!0),M,fa)}gGn(M,fa){this.owg(68,m(!0),M,fa)}get sessionID(){return sb.a.hI?sb.a.hI.sessionID:""}get HOa(){return sb.a.hI?
sb.a.hI.HOa:""}owg(M,fa,Va,Fb){const Vb=new pb.a;Vb.succeeded=0===fa;Vb.dataFields=[];Vb.durationMs=Va;Vb.dataFields.push(Object.assign(new tb.a,{name:"CommandID",int64:M}));Vb.dataFields.push(Object.assign(new tb.a,{name:"SessionID",string:this.sessionID}));Vb.dataFields.push(Object.assign(new tb.a,{name:"TurnID",string:this.HOa}));Vb.dataFields.push(Object.assign(new tb.a,{name:"CommandName",string:nb[M]}));Vb.dataFields.push(Object.assign(new tb.a,{name:"ErrorCode",int64:fa}));Fb&&Vb.dataFields.push(Object.assign(new tb.a,
{name:"PhraseID",string:Fb}));Vb.name=this.$qk;Vb.samplingPolicy=2;cb.a.sendActivityEvent(Vb)}}gc.Fao=[58,57];Object(u.a)(gc,"DictationCommandManager",null,[963]);var vc=d(524),Pc=d(280);class ld{constructor(){this.commandId=0;this.Nrj=null}}Object(u.a)(ld,"ParsedDictationCommand",null,[]);class Dc{constructor(M,fa){this.H4i=M;this.commandId=fa}}Object(u.a)(Dc,"CommandDefinition",null,[]);class ic{}ic.definitions=[new Dc("Pause voice typing",0),new Dc("Pause voice mode",0),new Dc("Pause dictation",
0),new Dc("Stop voice typing",0),new Dc("Stop voice mode",0),new Dc("Stop dictation",0),new Dc("Stop dictating",0),new Dc("\u6682\u505c\u8bed\u97f3\u8f93\u5165",0),new Dc("\u6682\u505c\u8bed\u97f3\u6a21\u5f0f",0),new Dc("\u6682\u505c\u542c\u5199",0),new Dc("\u505c\u6b62\u8bed\u97f3\u8f93\u5165",0),new Dc("\u505c\u6b62\u8bed\u97f3\u6a21\u5f0f",0),new Dc("\u505c\u6b62\u542c\u5199",0),new Dc("Pon en pausa la escritura por voz",0),new Dc("Pon en pausa el modo de voz",0),new Dc("Pon en pausa el dictado",
0),new Dc("Det\u00e9n la escritura por voz",0),new Dc("Det\u00e9n el modo de voz",0),new Dc("Det\u00e9n el dictado",0),new Dc("Det\u00e9n el modo de dictado",0),new Dc("Pausa la escritura por voz",0),new Dc("Pausa el modo de voz",0),new Dc("Pausa el dictado",0),new Dc("Mettre en pause la saisie vocale",0),new Dc("Mettre en pause le mode vocal",0),new Dc("Mettre en pause la dict\u00e9e",0),new Dc("Arr\u00eater la saisie vocale",0),new Dc("Arr\u00eater le mode vocal",0),new Dc("Arr\u00eater la dict\u00e9e",
0),new Dc("Arr\u00eater le mode dict\u00e9e",0),new Dc("Suspendre la dict\u00e9e vocale",0),new Dc("Suspendre le mode vocal",0),new Dc("Suspendre la dict\u00e9e",0),new Dc("Arr\u00eater la dict\u00e9e vocale",0),new Dc("Pause de la dict\u00e9e",0),new Dc("Spracheingabe pausieren",0),new Dc("Sprachmodus pausieren",0),new Dc("Diktat pausieren",0),new Dc("Spracheingabe stoppen",0),new Dc("Sprachmodus stoppen",0),new Dc("Diktat stoppen",0),new Dc("Diktieren stoppen",0),new Dc("Sospendi dettatura",0),
new Dc("Sospendi modalit\u00e0 voce",0),new Dc("Termina dettatura",0),new Dc("Termina modalit\u00e0 voce",0),new Dc("\u97f3\u58f0\u5165\u529b\u3092\u4e00\u6642\u505c\u6b62",0),new Dc("\u97f3\u58f0\u30e2\u30fc\u30c9\u3092\u4e00\u6642\u505c\u6b62",0),new Dc("\u30c7\u30a3\u30af\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4e00\u6642\u505c\u6b62",0),new Dc("\u97f3\u58f0\u5165\u529b\u3092\u505c\u6b62",0),new Dc("\u97f3\u58f0\u30e2\u30fc\u30c9\u3092\u505c\u6b62",0),new Dc("\u30c7\u30a3\u30af\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u505c\u6b62",
0),new Dc("Pausar a digita\u00e7\u00e3o por voz",0),new Dc("Pausar modo de voz",0),new Dc("Pausar ditado",0),new Dc("Parar digita\u00e7\u00e3o por voz",0),new Dc("Parar modo de voz",0),new Dc("Parar ditado",0),new Dc("Parar de ditar",0),new Dc("Stans diktering midlertidig",0),new Dc("Stopp diktering midlertidig",0),new Dc("Pause diktering",0),new Dc("Paus diktering",0),new Dc("Stopp diktering",0),new Dc("Stans diktering",0),new Dc("Pausa diktering",0),new Dc("Pausa r\u00f6stinmatning",0),new Dc("Pausa r\u00f6stl\u00e4ge",
0),new Dc("Avsluta r\u00f6tsinmatning",0),new Dc("Sluta skriva med r\u00f6sten",0),new Dc("Avsluta r\u00f6stl\u00e4ge",0),new Dc("Avsluta diktering",0),new Dc("Sluta diktera",0),new Dc("S\u00e6t diktering p\u00e5 pause",0),new Dc("Afbryd diktering midlertidigt",0),new Dc("S\u00e6t taletilstand p\u00e5 pause",0),new Dc("Afryd taletilstand midlertidigt",0),new Dc("Stop diktering",0),new Dc("S\u00e6t diktat p\u00e5 pause",0),new Dc("Afbryd diktat midlertidigt",0),new Dc("Stop diktat",0),new Dc("Dicteren onderbreken",
0),new Dc("Dicteren pauzeren",0),new Dc("Spraakmodus onderbreken",0),new Dc("Spraakmodus pauzeren",0),new Dc("Dicteermodus onderbreken",0),new Dc("Dicteermodus pauzeren",0),new Dc("Dicteerfunctie onderbreken",0),new Dc("Dicteerfunctie pauzeren",0),new Dc("Keskeyt\u00e4 sanelu",0),new Dc("Keskeyt\u00e4 puheen kirjoittaminen",0),new Dc("Keskeyt\u00e4 puhetila",0),new Dc("Pys\u00e4yt\u00e4 puheen kirjoittaminen",0),new Dc("Pys\u00e4yt\u00e4 puhetila",0),new Dc("Pys\u00e4yt\u00e4 sanelu",0),new Dc("Pys\u00e4yt\u00e4 saneleminen",
0),new Dc("Exit voice mode",1),new Dc("Exit voice typing",1),new Dc("Exit voice",1),new Dc("Exit dictation",1),new Dc("Close voice mode",1),new Dc("Close voice typing",1),new Dc("Close voice",1),new Dc("Close dictation",1),new Dc("Close dictate",1),new Dc("\u9000\u51fa\u8bed\u97f3\u6a21\u5f0f",1),new Dc("\u9000\u51fa\u8bed\u97f3\u8f93\u5165",1),new Dc("\u9000\u51fa\u8bed\u97f3",1),new Dc("\u9000\u51fa\u542c\u5199",1),new Dc("\u5173\u95ed\u8bed\u97f3\u6a21\u5f0f",1),new Dc("\u5173\u95ed\u8bed\u97f3\u8f93\u5165",
1),new Dc("\u5173\u95ed\u8bed\u97f3",1),new Dc("\u5173\u95ed\u542c\u5199",1),new Dc("Sal del modo de voz",1),new Dc("Sal de la escritura por voz",1),new Dc("Sal de la voz",1),new Dc("Sal del dictado",1),new Dc("Cierra el modo de voz",1),new Dc("Cierra la escritura por voz",1),new Dc("Cierra la voz",1),new Dc("Cierra el dictado",1),new Dc("Cierra el modo de dictado",1),new Dc("Quitter le mode vocal",1),new Dc("Quitter la saisie vocale",1),new Dc("Quitter le vocal",1),new Dc("Quitter la dict\u00e9e",
1),new Dc("Fermer le mode vocal",1),new Dc("Fermer la saisie vocale",1),new Dc("Fermer le vocal",1),new Dc("Fermer la dict\u00e9e",1),new Dc("Fermer le mode dict\u00e9e",1),new Dc("Quitter la dict\u00e9e vocale",1),new Dc("Quitter la reconnaissance vocale",1),new Dc("Fermer la dict\u00e9e vocale",1),new Dc("Fermer la reconnaissance vocale",1),new Dc("Arr\u00eat de la dict\u00e9e",1),new Dc("Sprachmodus beenden",1),new Dc("Spracheingabe beenden",1),new Dc("Voice beenden",1),new Dc("Diktat beenden",
1),new Dc("Sprachmodus schlie\u00dfen",1),new Dc("Spracheingabe schlie\u00dfen",1),new Dc("Sprache schlie\u00dfen",1),new Dc("Diktat schlie\u00dfen",1),new Dc("Diktieren schlie\u00dfen",1),new Dc("Esci da modalit\u00e0 voce",1),new Dc("Esci da dettatura",1),new Dc("Chiudi modalit\u00e0 voce",1),new Dc("Chiudi dettatura",1),new Dc("\u97f3\u58f0\u30e2\u30fc\u30c9\u3092\u7d42\u4e86",1),new Dc("\u97f3\u58f0\u5165\u529b\u3092\u7d42\u4e86",1),new Dc("\u30dc\u30a4\u30b9\u3092\u7d42\u4e86",1),new Dc("\u30c7\u30a3\u30af\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u7d42\u4e86",
1),new Dc("\u97f3\u58f0\u30e2\u30fc\u30c9\u3092\u9589\u3058\u308b",1),new Dc("\u97f3\u58f0\u5165\u529b\u3092\u9589\u3058\u308b",1),new Dc("\u30dc\u30a4\u30b9\u3092\u9589\u3058\u308b",1),new Dc("\u30c7\u30a3\u30af\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u9589\u3058\u308b",1),new Dc("Sair do modo de voz",1),new Dc("Sair da digita\u00e7\u00e3o por voz",1),new Dc("Sair do recurso voz",1),new Dc("Sair do ditado",1),new Dc("Fechar modo de voz",1),new Dc("Fechar digita\u00e7\u00e3o por voz",1),new Dc("Fechar recurso voz",
1),new Dc("Fechar ditado",1),new Dc("Fechar recurso ditar",1),new Dc("Avslutt diktering",1),new Dc("Stopp diktering",1),new Dc("Stans diktering",1),new Dc("Lukk diktering",1),new Dc("Avsluta r\u00f6stl\u00e4ge",1),new Dc("Avsluta r\u00f6stinmatning",1),new Dc("Avsluta r\u00f6st",1),new Dc("Avsluta diktering",1),new Dc("St\u00e4ng r\u00f6stl\u00e4ge",1),new Dc("St\u00e4ng r\u00f6stinmatning",1),new Dc("St\u00e4ng r\u00f6st",1),new Dc("St\u00e4ng diktering",1),new Dc("Afslut taletilstand",1),new Dc("Afslut tale",
1),new Dc("Afslut diktat",1),new Dc("Luk taletilstand",1),new Dc("Luk tale",1),new Dc("Luk diktat",1),new Dc("Dicteren afsluiten",1),new Dc("Dicteren stoppen",1),new Dc("Spraakmodus afsluiten",1),new Dc("Spraakmodus stoppen",1),new Dc("Dicteermodus afsluiten",1),new Dc("Dicteermodus stoppen",1),new Dc("Dicteerfunctie afsluiten",1),new Dc("Dicteerfunctie stoppen",1),new Dc("Poistu puhetilasta",1),new Dc("Lopeta puheen kirjoittaminen",1),new Dc("Lopeta puhe",1),new Dc("Lopeta sanelu",1),new Dc("Sulje puhetila",
1),new Dc("Sulje puheen kirjoittaminen",1),new Dc("Sulje puhetoiminto",1),new Dc("Sulje sanelu",1)];Object(u.a)(ic,"DictationCommandsDefinition",null,[]);class mc{JCf(M,fa){let Va=0;fa>=M.length&&(fa=M.length-1);let Fb=!1;for(;0<=fa;fa--){if(mc.H$c(M.charAt(fa))&&!mc.jXf(M,fa)){if(!Va)continue;Fb=!0;break}F.a.Zw(M.charCodeAt(fa))||(Va=fa)}return Fb?Va:0}C0c(M,fa){let Va=M.length;for(;fa<M.length;fa++)if(mc.H$c(M.charAt(fa))&&!mc.jXf(M,fa)){Va=fa+1;break}for(;Va<M.length&&(mc.H$c(M.charAt(Va))||F.a.Zw(M.charCodeAt(Va))||
mc.jXf(M,Va));)Va++;return Va}LCi(M,fa){fa--;if(1>fa||M.length<fa)return 0;let Va=0;for(;!mc.H$c(M.charAt(fa))&&0<fa;){if(!F.a.Zw(M.charCodeAt(fa)))return 0;fa--;Va++}return Va}static H$c(M){return-1!==mc.uhc.indexOf(M)}static jXf(M,fa){return"."===M.charAt(fa)&&fa+1<M.length&&-1!==mc.oUl.indexOf(M.charAt(fa+1))}}mc.uhc="?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61";mc.oUl="0123456789";Object(u.a)(mc,"SentenceBreaker",
null,[]);class Rc{constructor(){this.fl=new vc.a(Pc.a.vh());for(const M of ic.definitions)this.fl.tb(M.H4i)||this.fl.add(M.H4i,M.commandId)}oao(M){let fa=4;M=this.rgo(M);return({value:fa}=this.fl.Ec(M,fa)).returnValue?Object.assign(new ld,{commandId:fa,Nrj:M}):null}rgo(M){if(!M.length)return M;M=M.toLowerCase().replace(/[!"#$%&'()*+,-./:;<=>?@[\]^_{|}~`]/g,"");let fa=M.length-1;for(;0<=fa&&mc.H$c(M.charAt(fa));)fa--;return 0<fa&&fa<M.length-1?M.substring(0,fa+1):M}}Object(u.a)(Rc,"DictationCommandParser",
null,[962]);var rb=d(11);class Cb{constructor(M){this.bKj=(fa,Va)=>{Va=Va.view.container;const Fb=Va.offsetHeight,Vb=Va.scrollTop;fa===Q.a.pwf?Va.scrollTop=Vb+Fb:fa===Q.a.qwf&&(Va.scrollTop=Vb-Fb);return 32};this.ga=M}Xb(){this.ga.qa(Q.a.pwf,rb.a.view,this.bKj);this.ga.qa(Q.a.qwf,rb.a.view,this.bKj)}static createInstance(M){return Cb._instance||(Cb._instance=new Cb(M))}}Cb._instance=null;Object(u.a)(Cb,"DictationCommandsActor",null,[961]);class Kb{constructor(){this.Elk="Office.Voice.Online.ALDictationCommandResult";
this.Flk="Office.Voice.Online.ALDictationCommandSuggestions";this.$Ah=0;this.AFd=null}get U1f(){return this.AFd}set U1f(M){this.AFd=M}setRecordingStartTime(M){this.$Ah=M}onCommandFinished(M,fa,Va,Fb,Vb){Va=(new Date).getTime()-(this.$Ah+(Va+Fb)/1E4);Fb=new pb.a;Fb.dataFields=[];Fb.dataFields.push(Object.assign(new tb.a,{name:"SessionID",string:this.sessionID}));Fb.dataFields.push(Object.assign(new tb.a,{name:"CommandName",string:M}));Fb.dataFields.push(Object.assign(new tb.a,{name:"CommandUserPerceivedLatency",
int64:Va}));Vb&&Fb.dataFields.push(Object.assign(new tb.a,{name:"PhraseID",string:Vb}));Fb.succeeded=fa;Fb.name=this.Elk;cb.a.sendActivityEvent(Fb)}onCommandSuggestionsChanged(M,fa,Va){fa=new pb.a;fa.dataFields=[];fa.dataFields.push(Object.assign(new tb.a,{name:"SessionID",string:this.sessionID}));fa.dataFields.push(Object.assign(new tb.a,{name:"IsFlightEnabled",bool:M}));fa.dataFields.push(Object.assign(new tb.a,{name:"LastExecutedCommand",string:this.AFd?this.AFd:""}));fa.dataFields.push(Object.assign(new tb.a,
{name:"1stPill",string:1<=Va.length?Va[0]:""}));fa.dataFields.push(Object.assign(new tb.a,{name:"2ndPill",string:2<=Va.length?Va[1]:""}));fa.dataFields.push(Object.assign(new tb.a,{name:"3rdPill",string:3<=Va.length?Va[2]:""}));fa.dataFields.push(Object.assign(new tb.a,{name:"4thPill",string:4<=Va.length?Va[3]:""}));fa.dataFields.push(Object.assign(new tb.a,{name:"5thPill",string:5<=Va.length?Va[4]:""}));fa.dataFields.push(Object.assign(new tb.a,{name:"6thPill",string:6<=Va.length?Va[5]:""}));fa.dataFields.push(Object.assign(new tb.a,
{name:"7thPill",string:7<=Va.length?Va[6]:""}));fa.dataFields.push(Object.assign(new tb.a,{name:"8thPill",string:8<=Va.length?Va[7]:""}));fa.name=this.Flk;cb.a.sendActivityEvent(fa)}get sessionID(){return sb.a.hI?sb.a.hI.sessionID:""}}Object(u.a)(Kb,"DictationCommandsTelemetry",null,[960]);var $b=d(165),ab=d(92),ia=d(119);class La extends y{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce){super(M);this.ib=fa;this.Qe=Va;this.Rc=Fb;this.Rd=Vb;this.xl=Xc;this.Vh=vd;this.Vl=new X(fa,Va,wc,Dd,Ce)}executeCommand(M){var fa=
M?M.K("command"):null;if(fa=fa?fa.formatRangeParameters:null)return this.i4l(fa.startWord.toLowerCase(),fa.endWord.toLowerCase(),fa.isPhraseOnly);M=(M=M?M.K("command"):null)?M.selection:null;fa=!0;const Va=this.Vl.ujc(),Fb=this.Rc.Lc(15);try{Fb.Ab(Va.node),fa=this.F3l(M)}finally{Fb&&Fb.dispose()}return m(fa)}F3l(M){const fa=(null===M||void 0===M?void 0:M.count)||1,Va=Ca.H8a(null===M||void 0===M?void 0:M.which);return M&&M.type&&"this"!==M.type&&"that"!==M.type?this.Vl.Ptb()?!0:this.D1d(M.type,null,
fa,Va):!M||"this"!==M.type&&"that"!==M.type?this.Vl.Ptb()||this.Vl.xqn()||this.Vl.Sfn()||this.Vl.etn()?32===V.Sl(Q.a.backspace):this.D1d(K.word,null,fa,Va):this.Vl.Ptb()?32===V.Sl(Q.a.backspace):this.Vl.Wnc()?this.D1d(K.word,null,fa,Va):this.D1d(K.$Yc,K.sentence,fa,Va)}i4l(M,fa,Va){const Fb=this.Vl.iwi();let Vb;const wc=this.Vl.ujc();if(!wc)return 1;const Xc=wc.cpBegin;if(wc.node&&R.ParagraphReader.Wb(wc.node))R.ParagraphReader.textLength(wc.node);else return 1;Va?({JUa:Va,returnValue:Vb}=this.Vl.oVa(M),
M=2):({JUa:Va,returnValue:Vb}=this.Vl.s2c(M,fa),Vb.length||M!==fa||({JUa:Va,returnValue:Vb}=this.Vl.oVa(M)),M=3);if(!Vb||!Vb.length)return M;M=this.Rc.Lc(15);try{M.Ab(Vb[0].node);const vd=new $b.Selection(Vb,!0);this.ib.Kc(vd);if(2===V.Sl(Q.a.Bra))return 1;this.jMi(Vb[0]);const Dd=this.Vl.iwi();this.yPn(wc,Xc,Vb,Va,Fb-Dd)}finally{M&&M.dispose()}return 0}jMi(M){(M=this.Hpp(M))&&this.xl.apc(M)&&this.Rd.We(M,0===M.cpBegin?"":" ")}Hpp(M){var fa=R.ParagraphReader.text(M.node);const Va=/\s/;let Fb=M.cpBegin-
1;for(;0<=Fb&&Va.test(fa[Fb]);)Fb--;-1!=Fb&&Va.test(fa[Fb])||Fb++;let Vb=M.cpBegin;for(;Vb<fa.length&&Va.test(fa[Vb]);)Vb++;(Vb==fa.length-1||void 0!==fa[Vb]&&!Va.test(fa[Vb]))&&Vb--;fa=new N.a(Fb,Vb+1);return fa.sad()?E.a.createTextRange(M.node,fa.Dc,fa.end):null}yPn(M,fa,Va,Fb,Vb){0>Fb?(fa=Pa.SelectionFactory.ue(M.node,fa),this.ib.Kc(fa)):!Fb&&fa>Va[Va.length-1].cpEnd&&(M=this.Vl.ujc())&&(fa=Pa.SelectionFactory.ue(M.node,fa-Vb),this.ib.Kc(fa))}D1d(M,fa=null,Va,Fb){var Vb,wc,Xc;let vd,Dd=({Sdd:M,
DA:vd}=this.Vl.nVa(M,Va,Fb)).returnValue;!Dd&&fa&&({Sdd:M,DA:vd,returnValue:Dd}=this.Vl.nVa(fa,Va,Fb));if(!Dd||1>Dd.count)return!1;fa=null!==(Xc=null===(wc=null===(Vb=this.ib.gb)||void 0===Vb?void 0:Vb.currentSelection)||void 0===wc?void 0:wc.Qa.cpBegin)&&void 0!==Xc?Xc:-1;if(!this.qRl(Dd))return!1;Vb=Dd.K(0);M&&(this.hNn(Vb.node,vd),wc=Pa.SelectionFactory.ue(Vb.node,-1===fa?0:fa),this.ib.Kc(wc));this.jMi(Vb);return!0}qRl(M){if(!M||1>M.count||!M.K(0))return!1;const fa=this.Rc.Lc(15);try{fa.Ab(M.K(0).node);
for(const Vb of M){if(!Vb||!this.xl.apc(Vb))return!1;this.Rd.We(Vb,"")}const Va=M.K(M.count-1),Fb=Pa.SelectionFactory.ue(Va.node,Va.cpBegin);this.ib.Kc(Fb)}finally{fa&&fa.dispose()}return!0}hNn(M,fa){if(this.Vh){var Va=new ra.a;Va.set(M);if(this.Qe.Ou(Va)&&(va.OutlineElementNavigator.me(Va),M=new ia.a,M.set(fa),this.Qe.Ou(M))){va.OutlineElementNavigator.me(M);fa=this.Rc.Lc(15);try{fa.ju(M);const Fb=new ra.a;Fb.nd(M);Fb.uc();this.Vh.merge(Va,M,!1,!1);ab.a.sN(Fb)&&!Fb.QA()&&M.Tg()}finally{fa&&fa.dispose()}}}}}
Object(u.a)(La,"DictationDeleteCommand",y,[]);class Mb{constructor(M,fa,Va){this.VCa=M;this.vu=fa;this.oSn=Va}}Object(u.a)(Mb,"DictationTextInserted",null,[]);class Ha{constructor(){this.pZe=null}Jso(M,fa,Va){this.pZe=null;Va&&""!==M&&(this.pZe=new Mb(M,fa,Va.id))}}Object(u.a)(Ha,"DictationEventRecorder",null,[959]);class zb extends y{constructor(){super(1)}executeCommand(){return 32===V.Sl(Q.a.sfi)}}Object(u.a)(zb,"ExitDictationModeCommand",y,[]);class ac extends y{constructor(M,fa){super(27);this.lg=
M;this.Q9=new Ea(fa)}executeCommand(){return this.Q9.X6d(this.lg)?this.Vli():!1}Vli(){var M=this.Q9.j6d();M=xa.sAi(M);let fa;do{fa=M.currentNode;var Va=ha.bPf(M,!0)}while(null!==Va);return(Va=R.ParagraphReader.pg(fa,!1,!0,!0))?(this.Q9.vrc(Va),!0):null!=M.Vb(2)&&12==M.currentNode.type?(this.Q9.vrc(M.currentNode),32===V.Sl(Q.a.vE)&&32===V.Sl(Q.a.vE)):!1}}Object(u.a)(ac,"ExitListCommand",y,[]);var nc=d(373),Gb=d(803),tc=d(78);class Qb extends y{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce){super(M);this.Vl=
null;this.Rwa=0;this.rhb=[];this.$kh=tc.a.Qrb(nc.a.tud);this.yIc=nc.a.tud;fa&&Va&&Fb&&(this.Vl=new X(fa,Va,Fb,vd,Dd));this.EZ=Vb;this.Ee=wc;this.Rc=Xc;this.N2a=Ce;this.hVo();this.kdh=new Map([[0,Q.a.bold],[2,Q.a.fA],[5,Q.a.strikethrough],[3,Q.a.subscript],[4,Q.a.superscript],[1,Q.a.underline]])}executeCommand(M){var fa=M?M.K("command"):null;fa=fa?fa.formatRangeParameters:null;this.jlo();if(fa)return this.S3l(fa.startWord.toLowerCase(),fa.endWord.toLowerCase(),fa.isPhraseOnly);M=(M=M?M.K("command"):
null)?M.selection:null;fa=(null===M||void 0===M?void 0:M.count)||1;"string"===typeof fa&&(fa=parseInt(fa));const Va=Ca.H8a(null===M||void 0===M?void 0:M.which);return M&&M.type&&"this"!==M.type&&"that"!==M.type?this.UAf(M.type,fa,Va):!M||"this"!==M.type&&"that"!==M.type?this.Cli():this.Vl.Wnc()?this.UAf(K.word,fa,Va):this.Vl.Ptb()?this.Cli():this.UAf(K.sentence,fa,Va)}S3l(M,fa,Va){let Fb=0;Va?({returnValue:Va}=this.Vl.oVa(M),Fb=2):({returnValue:Va}=this.Vl.s2c(M,fa),Va.length||M!==fa||({returnValue:Va}=
this.Vl.oVa(M)),Fb=3);if(!Va||!Va.length)return Fb;M=this.Rc.Lc(15);try{for(fa=0;fa<Va.length;fa++)if(fa||M.Ab(Va[fa].node),Va[fa].contextId===rb.a.paragraph){const Vb=E.a.createTextRange(Va[fa].node,0,R.ParagraphReader.textLength(Va[fa].node));this.EZ.AW(Vb,wc=>{this.Kwc(wc)},!1)}else Va[fa].contextId===rb.a.Cd&&this.EZ.AW(Va[fa],Vb=>{this.Kwc(Vb)},!1)}finally{M&&M.dispose()}return 0}UAf(M,fa=1,Va){M=this.Vl.nVa(M,fa,Va).returnValue;if(!M||1>M.count)return 1;fa=this.Rc.Lc(15);try{fa.Ab(M.K(0).node);
Va=!0;for(const Fb of M){this.EZ.AW(Fb,wc=>{this.Kwc(wc)},!1);const Vb=this.iqb();Va=Vb===Q.a.sca?32===V.Sl(Vb,this.yIc):!0;if(!Va)return 1}}finally{fa&&fa.dispose()}return 0}Cli(){const M=this.iqb();if(M===Q.a.fE)return this.C3l();let fa=this.png();if(!this.N2a&&!fa)return 0;if(2===fa){for(let Va=0;2>Va&&32===(M===Q.a.sca?V.Sl(M,this.yIc):V.Sl(M));Va++)if(fa=this.png(),this.N2a&&(1===fa||!fa)||!this.N2a&&!fa)return 0;return 1}return M===Q.a.sca?m(32===V.Sl(M,this.yIc)):m(32===V.Sl(M))}png(){const M=
new Gb.a;return 32===V.Sl(Q.a.lZa,M)?(this.BTo(M),this.aMm(M)):2}iqb(){switch(this.Rwa){case 0:return Q.a.bold;case 2:return Q.a.fA;case 1:return Q.a.underline;case 5:return Q.a.strikethrough;case 3:return Q.a.subscript;case 4:return Q.a.superscript;case 6:return Q.a.fE;case 7:return Q.a.sca;case 8:return Q.a.Vya;default:return Na.ULS.shipAssertTag(595206285,394,!1),0}}BTo(M){1==M.bold&&this.rhb.push(0);1==M.italic&&this.rhb.push(2);1==M.strikethrough&&this.rhb.push(5);1==M.subscript&&this.rhb.push(3);
1==M.superscript&&this.rhb.push(4);1==M.underline&&this.rhb.push(1)}C3l(){let M=m(32===V.Sl(Q.a.fE));this.png();for(const fa of this.rhb)this.kdh.has(fa)||(M=1),M=M&&m(32===V.Sl(this.kdh.get(fa)));this.rhb=[];return M}aMm(M){switch(this.Rwa){case 0:return M.bold;case 2:return M.italic;case 1:return M.underline;case 5:return M.strikethrough;case 3:return M.subscript;case 4:return M.superscript;case 7:case 8:return M.highlight;default:return Na.ULS.shipAssertTag(595206284,394,!1),2}}Kwc(M){switch(this.Rwa){case 0:this.Ee.HN(M,
this.N2a);break;case 2:this.Ee.fA(M,this.N2a);break;case 1:this.Ee.C8(M,this.N2a);break;case 4:this.Ee.hva(M,this.N2a);break;case 3:this.Ee.NNa(M,this.N2a);break;case 5:this.Ee.una(M,this.N2a);break;case 7:this.Ee.NDa(M,this.yIc);break;case 8:this.Ee.sVd(M);break;case 6:this.Ee.Wqa(M)}}hVo(){switch(this.id){case 5:case 14:this.Rwa=0;break;case 6:case 15:this.Rwa=2;break;case 13:case 16:this.Rwa=1;break;case 22:case 25:this.Rwa=3;break;case 21:case 30:this.Rwa=4;break;case 23:case 24:this.Rwa=5;break;
case 47:this.Rwa=7;break;case 48:this.Rwa=8;break;case 34:this.Rwa=6}}jlo(){const M={};z.AFrameworkApplication.va.Qb(Q.a.lZa,2,M);this.$kh=M&&0<=M.highlight&&16777215>=M.highlight?M.highlight:tc.a.cha(tc.a.Qrb(`#${nc.a.tud}`));this.yIc=F.a.JJ(this.$kh,6)}}Object(u.a)(Qb,"FormatCommand",y,[]);class Yb extends y{constructor(M,fa){super(26);this.lg=M;this.Q9=new Ea(fa)}executeCommand(){var M=this.Q9.X6d(this.lg),fa=this.Q9.NZf();if(M)return fa?!0:32===V.Sl(Q.a.vE);if(fa)return 32===V.Sl(Q.a.$E,this.gqb());
M=32===V.Sl(Q.a.vE);fa=32===V.Sl(Q.a.$E,this.gqb());return M&&fa}gqb(){const M=new Za.DictionaryPropertySet;M.setValue(Db.a.Cta,"dictation");M.setValue(Db.a.qma,nb[this.id]);return M}}Object(u.a)(Yb,"InsertBulletCommand",y,[]);class fc extends y{constructor(M,fa,Va){super(36);this.Rd=M;this.ib=fa;this.Rc=Va}executeCommand(){let M,fa,Va;({selection:M,context:fa,cp:Va}=this.jwi());if(1<M.length){if(2===V.Sl(Q.a.Bra))return!1;({selection:M,context:fa,cp:Va}=this.jwi())}const Fb=this.Rc.Lc(15);try{Fb.Ab(fa.node),
this.Rd.We(fa,"\u00a0"),M=Pa.SelectionFactory.ue(fa.node,Va+1),this.ib.Kc(M)}finally{Fb&&Fb.dispose()}return!0}jwi(){const M=this.ib.gb.currentSelection,fa=M.Qa;return{selection:M,context:fa,cp:fa.cpBegin}}}Object(u.a)(fc,"InsertSpaceCommand",y,[]);class ib extends y{constructor(M,fa){super(40);this.lg=M;this.Q9=new Ea(fa)}executeCommand(){var M=this.Q9.X6d(this.lg),fa=this.Q9.NZf();if(M)return fa?!0:32===V.Sl(Q.a.vE);if(fa)return 32===V.Sl(Q.a.$E,this.gqb());M=32===V.Sl(Q.a.vE);fa=32===V.Sl(Q.a.$E,
this.gqb());return M&&fa}gqb(){const M=new Za.DictionaryPropertySet;M.setValue(Db.a.Cta,"dictation");M.setValue(Db.a.qma,nb[this.id]);return M}}Object(u.a)(ib,"NextBulletCommand",y,[]);class Jc extends y{constructor(){super(35)}executeCommand(){return 32===V.Sl(Q.a.vE)}}Object(u.a)(Jc,"NextLineCommand",y,[]);class jd extends y{constructor(){super(7)}executeCommand(){return 32===V.Sl(Q.a.Ybe)}}Object(u.a)(jd,"PasteCommand",y,[]);class Wc extends y{constructor(){super(0)}executeCommand(){return 32===
V.Sl(Q.a.owf)}}Object(u.a)(Wc,"PauseDictationCommand",y,[]);var Ad=d(1989),Yd;(function(M){M.NotStarted="Not_Started";M.fQg="Playing";M.Paused="Paused";M.NHe="Resumed";M.COg="Completed";M.Afk="Errored"})(Yd||(Yd={}));Object(u.b)("AudioPlaybackStatus",Yd);class ke extends y{constructor(M,fa=null){super(50);this.EDc=Yd.NotStarted;this.UUh=Va=>{try{if((""===this.$V.src||Va.origin===(new URL(this.$V.src)).origin)&&null!=Va.data)switch(Va.data.type){case "OnEnded":this.E6b.emit("OnEnded");break;case "OnError":this.E6b.emit("OnError",
Va.data.message);Na.ULS.sendTraceTag(559162828,394,10,`Received error from audio player. Message: ${Va.data.message}. ${this.R1c()}`);break;default:Na.ULS.sendTraceTag(556281949,394,10,`Received unrecognized event type: ${Va.data.type}. ${this.R1c()}`)}}catch(Fb){Na.ULS.sendTraceTag(556281950,394,15,`${Fb}. ${this.R1c()}`)}};this.E6b=new Ad.EventEmitter;this.OY=M;this.gXe=this.GRc=!1;this.$V=fa}get iab(){return this.gXe}R1c(){return`Audio is Playing: ${this.gXe}. WindowMessageEventHandlerAdded: ${this.GRc}`}cdp(){if(!this.$V){var M=
document.createElement("iframe");M.src=`${z.AFrameworkApplication.L8}audioPlayer.html?parentOrigin=${window.location.origin}`;M.allow="autoplay";document.body.appendChild(M);this.$V=M}this.WUk()}WUk(){this.GRc||(window.addEventListener("message",this.UUh),this.GRc=!0)}Gep(){this.GRc&&(window.removeEventListener("message",this.UUh),this.GRc=!1)}executeCommand(M){if(!this.$V)return Na.ULS.sendTraceTag(538485832,394,10,`AudioPlayer iframe was not set. ${this.R1c()}`),!1;if(!M.K("command"))return!1;M=
M.K("command");switch(M.audioMode){case "resume":this.EDc==Yd.Paused?(this.Zmd({type:"Play"}),this.aVb(Yd.NHe),this.Ind(!0)):this.aVb(Yd.NHe,!0);return;case "pause":this.EDc==Yd.fQg||this.EDc==Yd.NHe?(this.Zmd({type:"Pause"}),this.aVb(Yd.Paused),this.Ind(!1)):this.aVb(Yd.Paused,!0);return}M=M.wavDataBase64;if(!M)return!1;M="data:audio/wav;base64,"+M;const fa=(new Blob([M])).size;this.Ind(!0);this.Zmd({type:"Pause"});this.Zmd({type:"SetSrc",src:M});this.E6b.once("OnEnded",()=>{this.aVb(Yd.COg);this.Ind(!1)});
this.E6b.once("OnError",Va=>{this.aVb(Yd.Afk);this.Ind(!1);Na.ULS.sendTraceTag(556281951,394,10,`Received error while playing: ${Va}. ${this.R1c()}`)});this.Zmd({type:"Play"});this.aVb(Yd.fQg);this.BDn(M,fa);return!0}Ind(M){(this.gXe=M)?this.OY.WVc.zOh(["playingAudio"]):setTimeout(()=>{this.OY.WVc.fCj(["playingAudio"])},200)}BDn(M,fa){const Va=new Audio;Va.addEventListener("loadedmetadata",()=>{Na.ULS.sendTraceTag(537678859,394,50,`Playing audio length: ${Va.duration} seconds. Bytes ${fa} bytes`)});
Va.src=M}aVb(M,fa=!1){Na.ULS.sendTraceTag(527278872,394,50,`Current AudioPlaybackStatus: "${this.EDc}" - New AudioPlaybackStatus: "${M}"`);fa||(this.EDc=M)}Zmd(M){this.$V.contentWindow.postMessage(M,""!=this.$V.src?(new URL(this.$V.src)).origin:"*")}}Object(u.a)(ke,"ReadBackCommand",y,[]);class bf extends y{constructor(){super(3)}executeCommand(){return 32===V.Sl(Q.a.Sga)}}Object(u.a)(bf,"RedoCommand",y,[]);class od extends y{constructor(){super(58)}executeCommand(){return 32===V.Sl(Q.a.pwf)}}Object(u.a)(od,
"ScrollDownCommand",y,[]);class Vf extends y{constructor(){super(57)}executeCommand(){return 32===V.Sl(Q.a.qwf)}}Object(u.a)(Vf,"ScrollUpCommand",y,[]);class ah extends y{constructor(M,fa,Va,Fb,Vb,wc,Xc){super(M);this.ib=fa;this.Rc=Fb;this.Vl=new X(fa,Va,Vb,wc,Xc)}executeCommand(M){var fa=M?M.K("command"):null;fa=fa?fa.formatRangeParameters:null;M=(M=M?M.K("command"):null)?M.selection:null;const Va=(null===M||void 0===M?void 0:M.count)||1,Fb=Ca.H8a(null===M||void 0===M?void 0:M.which);return fa?this.j4l(fa.startWord.toLowerCase(),
fa.endWord.toLowerCase(),fa.isPhraseOnly,Fb):M&&M.type&&"this"!==M.type&&"that"!==M.type?this.YAf(M.type,null,Va,Fb):!M||"this"!==M.type&&"that"!==M.type?1:this.Vl.Ptb()?0:this.Vl.Wnc()?this.YAf(K.word,null,Va,Fb):this.YAf(K.$Yc,K.sentence,Va,Fb)}j4l(M,fa,Va,Fb){11==Fb||12==Fb?({returnValue:Va}=this.Vl.Hnm(M,11==Fb),M=2):Va?({returnValue:Va}=this.Vl.oVa(M),M=2):({returnValue:Va}=this.Vl.s2c(M,fa),Va.length||M!==fa||({returnValue:Va}=this.Vl.oVa(M)),M=3);if(!Va||!Va.length)return M;M=this.Rc.Lc(15);
try{M.Ab(Va[0].node);const Vb=new $b.Selection(Va,!0);this.ib.Kc(Vb)}finally{M&&M.dispose()}return 0}YAf(M,fa=null,Va=1,Fb){M=this.Vl.nVa(M,Va,Fb).returnValue;!M&&fa&&(M=this.Vl.nVa(fa,Va,Fb).returnValue);if(!M||!M.count)return 1;fa=this.Rc.Lc(15);try{fa.Ab(M.K(0).node);const Vb=new $b.Selection(M.toArray(),!0);this.ib.Kc(Vb)}finally{fa&&fa.dispose()}return 0}}Object(u.a)(ah,"SelectCommand",y,[]);var Bf=d(734);class Of extends y{constructor(){super(55)}executeCommand(M){M=M.K("command");if(M.fontParameters&&
M.fontParameters.size)return M=new Bf.a(2*M.fontParameters.size),32===V.Sl(Q.a.pC,M);if(M.fontParameters&&M.fontParameters.color)return 32===V.Sl(Q.a.hx,tc.a.Nvc(M.fontParameters.color));if(M.fontParameters&&M.fontParameters.highlight)return"NONE"===M.fontParameters.highlight.toUpperCase()?32===V.Sl(Q.a.Vya):32===V.Sl(Q.a.sca,tc.a.Nvc(M.fontParameters.highlight));Na.ULS.sendTraceTag(562414018,394,15,"No font parameters received for ditation SetFontCommand");return!1}}Object(u.a)(Of,"SetFontCommand",
y,[]);class Qf extends y{constructor(){super(33)}executeCommand(){return 32===V.Sl(Q.a.swf,"DictationSettingsHelpShowCommands")}}Object(u.a)(Qf,"ShowCommandsCommand",y,[]);class Jg extends y{constructor(){super(32)}executeCommand(){return 32===V.Sl(Q.a.rwf,"DictationSettingsHelp")}}Object(u.a)(Jg,"ShowHelpCommand",y,[]);class jf extends y{constructor(){super(49)}executeCommand(){return 32===V.Sl(Q.a.tab)}}Object(u.a)(jf,"TabCommand",y,[]);class $i extends y{constructor(){super(2)}executeCommand(){return 32===
V.Sl(Q.a.undo)}}Object(u.a)($i,"UndoCommand",y,[]);var Vd=d(12);class eh extends y{constructor(){super(52)}executeCommand(){return 32===V.Sl(Vd.a.osb)}}Object(u.a)(eh,"ZoomInCommand",y,[]);class rd extends y{constructor(){super(53)}executeCommand(){return 32===V.Sl(Vd.a.vob)}}Object(u.a)(rd,"ZoomOutCommand",y,[]);var Gc=d(231),Wd=d(254);class Ye extends y{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd){super(M);this.Vl=null;this.Vl=new X(fa,Va,Fb,Vb,wc);this.ib=fa;this.Rc=Xc;this.Rd=vd}executeCommand(M){var fa=
null,Va=null===M||void 0===M?void 0:M.K("command");if(Va=Va?Va.formatRangeParameters:null)return fa=this.iJf(Va.startWord.toLowerCase(),Va.endWord.toLowerCase(),Va.isPhraseOnly),this.QNh(fa),!0;const Fb=(M=M?M.K("command"):null)?M.selection:null;M=(null===Fb||void 0===Fb?void 0:Fb.count)||1;Va=Ca.H8a(null===Fb||void 0===Fb?void 0:Fb.which);(null===Fb||void 0===Fb?0:Fb.type)&&"this"!==Fb.type&&"that"!==Fb.type?fa=this.e3c(Fb.type,null,M,Va):!Fb||"this"!==Fb.type&&"that"!==Fb.type||(fa=this.ib.gb.currentSelection.Qa,
fa=this.Vl.Wnc()?this.Vl.RJi(fa).toArray():this.Vl.Ptb()?this.ib.gb.currentSelection._selectionContexts:this.e3c(K.$Yc,K.sentence,M,Va));null!==fa&&0!==fa.length&&(M=this.a3j(fa.shift()),fa.unshift(M),1<fa.length&&(M=this.a3j(fa.pop()),fa.push(M)));this.QNh(fa);return!0}a3j(M){var fa=R.ParagraphReader.text(M.node);fa=fa.substring(M.cpBegin,M.cpEnd);const Va=fa.match(/^\s*/)[0].length;fa=fa.match(/\s*$/)[0].length;return E.a.createTextRange(M.node,M.cpBegin+Va,M.cpEnd-fa)}QNh(M){if(null!=M){var fa=
Fa.a.instance.gb.currentSelection.Qa,Va=this.Rc.Lc(15),Fb=0;if(1==M.length){var Vb=M[0];M="\u201c"+R.ParagraphReader.text(Vb.node).substring(Vb.cpBegin,Vb.cpEnd)+"\u201d";try{Va.Ab(fa.node),this.Rd.We(Vb,M)}finally{Va&&Va.dispose()}if(fa.node==Vb.node){if(fa.cpBegin<Vb.cpBegin)return;Fb=fa.cpBegin>=Vb.cpEnd?2:1}}else{Fb=M[0];M=M[M.length-1];try{Va.Ab(fa.node),Vb="\u201c"+R.ParagraphReader.text(Fb.node).substring(Fb.cpBegin,Fb.cpEnd),this.Rd.We(Fb,Vb),Vb=R.ParagraphReader.text(M.node).substring(M.cpBegin,
M.cpEnd)+"\u201d",this.Rd.We(M,Vb)}finally{Va&&Va.dispose()}if(fa.node==Fb.node&&fa.cpBegin>=Fb.cpBegin||fa.node==M.node&&fa.cpBegin>=M.cpEnd)Fb=1;else return}fa=Pa.SelectionFactory.ue(fa.node,fa.cpBegin+Fb);this.ib.Kc(fa)}}iJf(M,fa,Va){Va?{returnValue:Va}=this.Vl.oVa(M):({returnValue:Va}=this.Vl.s2c(M,fa),Va.length||M!==fa||({returnValue:Va}=this.Vl.oVa(M)));return Va&&Va.length?Va:null}e3c(M,fa=null,Va=1,Fb){M=this.Vl.nVa(M,Va,Fb).returnValue;!M&&fa&&(M=this.Vl.nVa(fa,Va,Fb).returnValue);return!M||
1>M.count?null:M.toArray()}}Object(u.a)(Ye,"QuoteCommand",y,[]);class yg extends y{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd){super(M);this.Vl=null;this.Vl=new X(fa,Va,Fb,Vb,wc);this.ib=fa;this.Rc=Xc;this.Rd=vd}executeCommand(M){var fa=null,Va=null===M||void 0===M?void 0:M.K("command");if(Va=Va?Va.formatRangeParameters:null)return fa=this.iJf(Va.startWord.toLowerCase(),Va.endWord.toLowerCase(),Va.isPhraseOnly),this.I_h(fa),!0;const Fb=(M=M?M.K("command"):null)?M.selection:null;M=(null===Fb||void 0===Fb?
void 0:Fb.count)||1;Va=Ca.H8a(null===Fb||void 0===Fb?void 0:Fb.which);(null===Fb||void 0===Fb?0:Fb.type)&&"this"!==Fb.type&&"that"!==Fb.type?fa=this.e3c(Fb.type,null,M,Va):!Fb||"this"!==Fb.type&&"that"!==Fb.type||(fa=this.ib.gb.currentSelection.Qa,fa=this.Vl.Wnc()?this.Vl.RJi(fa).toArray():this.Vl.Ptb()?this.ib.gb.currentSelection._selectionContexts:this.e3c(K.$Yc,K.sentence,M,Va));this.I_h(fa);return!0}I_h(M){if(null!=M&&0!=M.length){var fa=this.Rc.Lc(15);try{fa.Ab(M[0].node);for(const Va of M){const Fb=
R.ParagraphReader.text(Va.node).substring(Va.cpBegin,Va.cpEnd),Vb=this.Lkm(Fb);this.Rd.We(Va,Vb)}}catch(Va){}finally{fa&&fa.dispose()}}}Lkm(M){switch(this.id){case 44:return M.toUpperCase();case 46:return M.toLowerCase();case 45:return M.replace(/(^\w|\s\w)(\S*)/g,(fa,Va,Fb)=>Va.toUpperCase()+Fb.toLowerCase());default:return M}}iJf(M,fa,Va){Va?{returnValue:Va}=this.Vl.oVa(M):({returnValue:Va}=this.Vl.s2c(M,fa),Va.length||M!==fa||({returnValue:Va}=this.Vl.oVa(M)));return Va&&Va.length?Va:null}e3c(M,
fa=null,Va=1,Fb){M=this.Vl.nVa(M,Va,Fb).returnValue;!M&&fa&&(M=this.Vl.nVa(fa,Va,Fb).returnValue);return!M||1>M.count?null:M.toArray()}}Object(u.a)(yg,"CaseCommand",y,[]);class yf extends y{constructor(){super(61)}executeCommand(){V.Sl(Q.a.Oje);return!0}}Object(u.a)(yf,"ResumeDictationCommand",y,[]);class re{static Be(M){return this.ojk.get(M)}}re.ojk=new Map([["normal","Normal"],["heading 1","heading 1"],["heading 2","heading 2"],["heading 3","heading 3"],["list paragraph","List Paragraph"],["no spacing",
"No Spacing"],["quote","Quote"],["subtitle","Subtitle"],["title","Title"],["emphasis","Emphasis"],["strong","Strong"],["subtle reference","Subtle Reference"],["intense reference","Intense Reference"],["book title","Book Title"],["intense quote","Intense Quote"],["intense emphasis","Intense Emphasis"],["subtle emphasis","Subtle Emphasis"],["comment text","comment text"],["header","header"],["footer","footer"],["hyperlink","Hyperlink"],["mention","Mention"]]);Object(u.a)(re,"StyleTypeId",null,[]);class Xe extends y{constructor(){super(62)}executeCommand(M){if(M=
(M=(M=(M=M?M.K("command"):null)?M.styleParameter:null)?M.style:null)?re.Be(M):null)return 32===V.Sl(Q.a.zT,M);Na.ULS.sendTraceTag(538063176,394,15,"No style parameters received for dictation ApplyStyleCommand");return!1}}Object(u.a)(Xe,"ApplyStyleCommand",y,[]);class dc extends y{constructor(M,fa,Va,Fb,Vb){super(63);this.Vl=new X(M,fa,Va,Fb,Vb)}executeCommand(){return this.Vl.Ptb()?32===V.Sl(Q.a.dha):!0}}Object(u.a)(dc,"DeselectCommand",y,[]);class Ac{constructor(){this.Ebh=new Set;this.P3a=new Set}V7m(){const M=
this.tmm();this.Ebh=new Set(M);this.P3a=new Set}zOh(M){const fa=[...this.P3a].join();M.forEach(Fb=>this.P3a.add(Fb));const Va=[...this.P3a].join();Na.ULS.sendTraceTag(527779713,394,50,`addToPriorityCommandSet - Added values: ${M.join()} InitialPrioritySet: ${fa}, CurrentPrioritySet: ${Va}`)}fCj(M){const fa=[...this.P3a].join();M.forEach(Fb=>this.P3a.delete(Fb));const Va=[...this.P3a].join();Na.ULS.sendTraceTag(527779714,394,50,`removeFromPriorityCommandSet - Removed values: ${M.join()} InitialPrioritySet: ${fa}, CurrentPrioritySet: ${Va}`)}getCommandSet(){return this.P3a.size?
Array.from(this.P3a):Array.from(this.Ebh)}tmm(){const M=["$word"];Ga.TableReader.xtb(Fa.a.instance.gb.currentSelection.Qa.node)&&M.push("$table");Na.ULS.sendTraceTag(527779715,394,50,`CommandSetFromIP - ${M.join()}`);return M}}Object(u.a)(Ac,"CommandSetManager",null,[]);class dd{constructor(){this.Feh=this.Z=null}get name(){return"Box4.DictationCommands"}wc(M){this.Z=M;this.Z.ia("Box4.DictationCommands.ICommandSetManager",()=>new Ac).ha();this.Z.ia("Box4.DictationCommands.IDictationCommandManager",
()=>new gc(this.Z.resolve("Box4.IUndoManager"),this.Z.resolve("Box4.DictationCommands.ICommandSetManager"))).ha();this.Z.ia("Box4.DictationCommands.IDictationCommandParser",()=>new Rc).ha();this.Z.ia("Box4.DictationCommands.IDictationCommandsTelemetry",()=>new Kb).ha();this.Z.ia("Box4.DictationCommands.IDictationEventRecorder",()=>new Ha).ha()}init(){this.Feh=Cb.createInstance(z.AFrameworkApplication.va);this.Feh.Xb();const M=this.Z.resolve("Box4.DictationCommands.IDictationCommandManager");this.Z.resolve("Box4.Graph.IGraphTransactionFactory");
const fa=this.Z.resolve("Box4.List.IListReader"),Va=new mc;V.Pb=z.AFrameworkApplication.va;M.Hq(new zb);M.Hq(new Wc);M.Hq(new $i);M.Hq(new bf);M.Hq(new jd);M.Hq(new bb(this.Z.resolve("Box4.Graph.IGraphTransactionFactory")));M.Hq(new mb(this.Z.resolve("Box4.Graph.IGraphTransactionFactory")));M.Hq(new Wa);M.Hq(new la(Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder")));M.Hq(new Yb(fa,Fa.a.instance));M.Hq(new ac(fa,Fa.a.instance));M.Hq(new Ta(28,
fa,Fa.a.instance));M.Hq(new Ta(29,fa,Fa.a.instance));M.Hq(new da);M.Hq(new ka);M.Hq(new qa);M.Hq(new ua);M.Hq(new Ye(60,Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Box4.ICharacterPropertiesEditor")));this.ana(M,5,Va);this.ana(M,13,Va);this.ana(M,6,Va);this.ana(M,23,Va);this.ana(M,22,Va);this.ana(M,21,Va);this.ana(M,14,Va);this.ana(M,16,Va);this.ana(M,15,Va);this.ana(M,
24,Va);this.ana(M,25,Va);this.ana(M,34,Va);this.ana(M,47,Va);this.ana(M,48,Va);M.Hq(new La(31,Fa.a.instance,Gc.a.instance,this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),v.a.instance,Wd.a.instance,this.Z.resolve("Box4.IOutlineElementEditor"),Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder")));M.Hq(new ah(43,Fa.a.instance,Gc.a.instance,this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder")));
M.Hq(new Jg);M.Hq(new Qf);M.Hq(new Jc);M.Hq(new fc(this.Z.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance,this.Z.resolve("Box4.Graph.IGraphTransactionFactory")));M.Hq(new aa);M.Hq(new Y);M.Hq(new T(this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder")));M.Hq(new ib(fa,Fa.a.instance));M.Hq(new ba);M.Hq(new W);M.Hq(new jf);(D.a.au||D.a.Nr||D.a.nj)&&M.Hq(new ke(M));M.Hq(new eh);M.Hq(new rd);
M.Hq(new Of);M.Hq(new od);M.Hq(new Vf);M.Hq(new yg(44,Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Box4.ICharacterPropertiesEditor")));M.Hq(new yg(45,Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Box4.ICharacterPropertiesEditor")));M.Hq(new yg(46,
Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Box4.ICharacterPropertiesEditor")));M.Hq(new yf);M.Hq(new Xe);M.Hq(new dc(Fa.a.instance,Gc.a.instance,v.a.instance,Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder")))}dispose(){}ana(M,fa,Va){M.Hq(new Qb(fa,Fa.a.instance,Gc.a.instance,v.a.instance,this.Z.resolve("Box4.TextFormattingHelper"),this.Z.resolve("Box4.IFormattingEditor"),
this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),Va,this.Z.resolve("Box4.DictationCommands.IDictationEventRecorder"),!0))}}Object(u.a)(dd,"DictationCommandsPackageManager",null,[0,1]);var fd=d(19),Fd=d(1272),cf=d(83),Bg=d(142),me=d(464),mf=d(283),ug=d(1915),Bi=d(1755),Zf=d(477),zf=d(633),xh=d(94),Vj=d(207),Ui=d(348),Bb=d(493),Pb=d(74),zc=d(421),$c=d(10),Ae=d(114),Gf=d(91),jg=d(195),hi=d(228),xj=d(98),xg=d(41),fj=d(134),dg=d(5),Nf=d(13),pg=d(80),ye=d(604),qh=d(108),qg=d(82),dl=d(63),Jk=d(543),
Ni=d(61),Wh=d(643),gh=d(166);const th=["ErrorAudioPermissionDeniedError","ErrorAudioNotReadableError","ErrorAudioDevicesNotFoundError","initializeErrorAudio"],li=["AugloopNotConnected","Cancelled","Message is dropped as oldest in full queue"],rg=(M,...fa)=>{const Va="string"===typeof M?M:M.message;return"string"===typeof Va&&fa.some(Fb=>Fb.some(Vb=>Va.includes(Vb)))?15:10},jj=M=>{const fa=`${M}`.trimLeft();if(fa.startsWith("[object "))try{const Va=(null===M||void 0===M?0:M.name)&&(null===M||void 0===
M?0:M.message)?`${M.name}: ${M.message}`:(null===M||void 0===M?0:M.message)?M.message:(null===M||void 0===M?0:M.name)?M.name:JSON.stringify(M);return Va?fa+" "+Va:fa}catch(Va){return M=`stringifyException error: ${Va.name}: ${Va.message}`,Na.ULS.sendTraceTag(523593434,394,10,M),fa+" "+M}return fa},Jl=M=>new Promise(fa=>setTimeout(fa,M));var Af;(function(M){M.Persistent="Persistent";M.Discardable="Discardable"})(Af||(Af={}));Object(u.b)("CommandSuggestionDisplayType",Af);var kl;(function(M){M.NONE=
"none";M.BLANK="blankDocument";M.PARAGRAPH="paragraph";M.LIST="list";M.TABLE="table";M.WHATCANISAY="whatCanISay"})(kl||(kl={}));Object(u.b)("CommandSuggestionContextType",kl);const xi={"new paragraph":68,"read back this paragraph":50,"start numbered list":29,"what can i say":67,"apply style title":62,"add a 3 by 4 table":8,"delete last sentence":31,undo:2,"bold last word":5,"highlight <phrase>":47,"increase font size":41,"correct <word>":64,"select last word":43,"underline last sentence":13,"italicize last 3 words":6,
"set font color red":55,"select <word>":43,"set highlight color green":47,"uppercase last 2 words":44,"lowercase last paragraph":46,"strikethrough last sentence":23,"start list":28,"set font size 16":55,"highlight this paragraph":47,"unselect <word>":63,"increase indent":37,"all caps <word>":44,"go to end of paragraph":11,"superscript last word":21,"capitalize last sentence":45,"show more commands":33};class Eh{static get M0a(){Eh.UJb||(Eh.UJb=document.getElementById("PageContentContainer"));return Eh.UJb}static get $Ab(){Eh.VJb||
(Eh.VJb=Eh.Wsf());return Eh.VJb}static get Oea(){Eh.lya||(Eh.lya=fd.a.instance.Ta("Common.IZoomManager"));return Eh.lya.instance?Eh.lya.instance.nl:1}static get lb(){Eh.ib||(Eh.ib=Fa.a.instance);return Eh.ib}static get Pvl(){Eh.Vl||(Eh.Vl=new X(Eh.lb,null,null,null,null));return Eh.Vl}static LQf(){Eh.D7&&(window.clearTimeout(Eh.cPc),Eh.cPc=window.setTimeout(()=>{},200))}static async I_b(M){return new Promise(fa=>{window.requestAnimationFrame(()=>{var Va;let Fb=!1;switch(M){case "paragraph":Fb=Eh.qrj();
break;case "blankDocument":Fb=Eh.tdl();break;case "whatCanISay":const Vb=null===(Va=Eh.lb.gb)||void 0===Va?void 0:Va.currentSelection;Eh.Pvl.vpl(Vb?Vb.Qa:null,Eh.nUn)&&(Fb=Eh.qrj())}Eh.D7=Fb;fa(Fb)})})}static tdl(){const M=Eh.$Ab;var fa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");var Va=(fa=fa?null===(Va=fa.getElementsByClassName("EOP"))||void 0===Va?void 0:Va.item(0):null)?fa.getBoundingClientRect():null;fa=Eh.M0a?Eh.M0a.getBoundingClientRect():null;if(M&&Va&&fa)return M.style.top=
(Va.top-fa.top)/Eh.Oea+"px",M.style.left=(Va.left-fa.left)/Eh.Oea+"px",Na.ULS.sendTraceTag(521203975,394,50,"blankDocumentPositionPrediction - Successfully placed container"),!0;Na.ULS.sendTraceTag(521203974,394,50,`blankDocumentPositionPrediction - Could not container -> targetContainer-${!!M} clientRect-${!!Va} containerRect-${!!fa}`);return!1}static qrj(){const M=Eh.$Ab;var fa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");fa=fa?fa.getBoundingClientRect():null;const Va=Eh.M0a?
Eh.M0a.getBoundingClientRect():null;if(M&&fa&&Va)return M.style.top=(fa.bottom-Va.top)/Eh.Oea+"px",M.style.left=(fa.left-Va.left)/Eh.Oea+"px",Na.ULS.sendTraceTag(512341251,394,50,"paragraphPositionPrediction - Successfully placed container"),!0;Na.ULS.sendTraceTag(512341250,394,50,`paragraphPositionPrediction - Could not container -> targetContainer-${!!M} clientRect-${!!fa} containerRect-${!!Va}`);return!1}static Wsf(){var M=Eh.M0a;const fa=document.createElement("div");if(M){M.appendChild(fa);fa.setAttribute("id",
"textareaCaretTracker");fa.className="hidePanel";fa.setAttribute("role","alert");M=document.createElement("button");M.setAttribute("disabled",!0);M.setAttribute("aria-disabled",!0);M.setAttribute("aria-hidden",!0);M.className="inlinePredictedWordButton";const Va=document.createElement("span");Va.setAttribute("aria-disabled",!0);Va.setAttribute("aria-hidden",!0);Va.setAttribute("id","inlinePredictedWord");Va.className="inlinePredictedWord";M.appendChild(Va);fa.appendChild(M);(M=document.getElementById("WACViewPanel"))&&
$addHandler(M,"scroll",Eh.LQf)}return fa}static async w7o(M){var fa,Va;if(M&&M.commandText&&M.preText){var Fb=Eh.$Ab,Vb=document.getElementById("inlinePredictedWord");if(Fb&&Vb){const vd=`${"blankDocument"===M.displayContext?"":"\n\n"}${M.preText}: ${M.commandText}`;Vb.innerText=vd;var wc=document.getElementById("WACViewPanel_EditingElement_WrappingDiv"),Xc=wc?null===(fa=wc.getElementsByClassName("EOP"))||void 0===fa?void 0:fa.item(0):null;Xc&&(Vb.style.fontSize=Xc.style.fontSize,Vb.style.fontFamily=
Xc.style.fontFamily,Vb.style.fontStyle="italic",Vb.style.whiteSpace="pre",Vb.parentNode.parentNode.setAttribute("aria-label",vd));Vb=await Eh.I_b(M.displayContext);fa=null===Xc||void 0===Xc?void 0:Xc.getBoundingClientRect().x;Xc=null===Xc||void 0===Xc?void 0:Xc.getBoundingClientRect().y;Vb&&(await Jl(M.displayAfterMs||1E3),wc=wc?null===(Va=wc.getElementsByClassName("EOP"))||void 0===Va?void 0:Va.item(0):null,Va=null===wc||void 0===wc?void 0:wc.getBoundingClientRect().x,wc=null===wc||void 0===wc?void 0:
wc.getBoundingClientRect().y,Va!==fa||wc!==Xc?Na.ULS.sendTraceTag(512341249,394,50,"showCommandSuggestion - Command Suggestion not shown because EOP Position changed during pause"):(Fb.className="textareaCaretTracker",Va=Fb.getBoundingClientRect().bottom,wc=Eh.M0a.getBoundingClientRect().bottom,Va<=wc?(Na.ULS.sendTraceTag(521203973,394,50,`showCommandSuggestion - ${M.commandText} shown`),Fb=[xi[M.commandText.slice(1,M.commandText.length-1).toLowerCase()]],f(Fb,M.displayContext)):(Na.ULS.sendTraceTag(521203972,
394,50,`showCommandSuggestion - targetContainer is overflowing from main container -> targetContainerBottom-${Va} mainContainerBottom-${wc}`),Fb.className="hidePanel")))}}else Na.ULS.sendTraceTag(521184657,394,10,`showCommandSuggestion - invalid command suggestion ${M?JSON.stringify(M):"Empty Command Suggestion"}`)}static fOi(){if(Eh.D7){const M=document.getElementById("textareaCaretTracker");M&&(M.className="textareaCaretTracker hidePanel",Eh.D7=!1)}}}Eh.Vl=null;Eh.lya=null;Eh.UJb=null;Eh.VJb=null;
Eh.ib=null;Eh.D7=!1;Eh.cPc=0;Eh.nUn=4;Object(u.a)(Eh,"CommandSuggestionManagerV2",null,[]);var Kj=d(101),Vi=d(173);class Qh{constructor(M,fa,Va,Fb,Vb,wc){const Xc=new Vi.a(!1,!1,!0);Vb={["id"]:"DictationErrorDialog",["contentLabel"]:Va,["primaryButtonLabel"]:Vb};if(wc){Vb.dialogIcon=0;wc={["micPermissionsDialogImageSrc"]:wc,["micPermissionsDialogImageAltText"]:Box4Intl.Box4Strings.L_DictationMicPermissionsErrorImageAltText};let vd="";D.a.Usb?vd="#ID0EABAAA=Microsoft_Edge":D.a.Nr?vd="#ID0EABAAA=Chrome":
D.a.nj&&(vd="#ID0EABAAA=Firefox");wc.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:Box4Intl.Box4Strings.L_DictationMicPermissionsErrorLearnMore,["onExecute"]:()=>{Na.ULS.sendTraceTag(544278599,394,50,"");window.open("https://support.microsoft.com/article/5e69be5f-4357-43f0-a99a-ed903443cd9b"+vd,"_blank")}};Vb.microphoneErrorDialogProps=wc}else Vb.dialogIcon=1;Na.ULS.sendTraceTag(572303203,394,50,"ReactDictationErrorDialog triggered with dialogType: "+M+" and content: "+Va);
Xc.Uh(fa,Fb,Vb)}}Object(u.a)(Qh,"ReactDictationErrorDialog",null,[]);class Mh{static Y6o(){Mh.showDialog(1,Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage,CommonUIStrings.l_DialogClose)}static y7o(){Mh.showDialog(2,Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage,CommonUIStrings.l_DialogClose)}static W8o(M){M===Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage?Mh.showDialog(3,
Box4Intl.Box4Strings.L_DictationMicPermissionsErrorDialogTitle,Box4Intl.Box4Strings.L_DictationMicPermissionsErrorDialogContent,Box4Intl.Box4Strings.L_DictationMicPermissionsErrorTryAgain,Kj.a.Dea("MicPermissionsDialogImage.svg"),Box4Intl.Box4Strings.L_DictationHelpText_DEBUG,"https://office.visualstudio.com/DefaultCollection/OC/_wiki/wikis/OC.wiki/22688/Using-Dictation-on-your-DevBox-in-Blue-Chicken"):Mh.showDialog(4,Box4Intl.Box4Strings.L_DictationErrorDialogTitle,M,CommonUIStrings.l_DialogClose,
void 0,Box4Intl.Box4Strings.L_DictationHelpText_DEBUG,"https://office.visualstudio.com/DefaultCollection/OC/_wiki/wikis/OC.wiki/22688/Using-Dictation-on-your-DevBox-in-Blue-Chicken")}static HTj(){Mh.showDialog(5,Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAugloopActivateAnnotationsErrorMessage,CommonUIStrings.l_DialogClose)}static gVj(){Mh.showDialog(0,Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage,CommonUIStrings.l_DialogClose)}static showDialog(M,
fa,Va,Fb,Vb=null,wc=null,Xc=null){Mh.I4e||(Mh.I4e=new Qh(M,fa,Va,Mh.Ttl,Fb,Vb,wc,Xc),Mh.fPe=M)}static Ttl(M){Mh.I4e=null;Na.ULS.sendTraceTag(572303232,394,50,"CloseDialogHandler triggered on dialogType: "+Mh.fPe+" error dialog with "+M);Mh.fPe=0;2===M&&z.AFrameworkApplication.va.Ob(Q.a.eAb,2)}}Mh.I4e=null;Mh.fPe=0;Object(u.a)(Mh,"Dialogs",null,[]);class Ch{}Ch.Hjo="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-AU en-IN".split(" ");Ch.Sgo="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");
Ch.Mhd=[];Ch.MMg=["en-US","en-CA","en-GB","en-AU","en-IN"];Ch.Fbl=[];Ch.Gbl="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP nb-NO da-DK sv-SE fi-FI nl-NL ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");Ch.Ijo="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP nb-NO da-DK sv-SE fi-FI nl-NL".split(" ");
Ch.DOl="en-US";Ch.bUl="DictationFloatieToggle";Ch.cUl="DictationTranscriptionSplit";Ch.WTl="Insertaudio_32x32x32";Ch.VTl="Insertaudio_16x16x32";Ch.Pbp="speechOn.wav";Ch.Obp="speechOff.wav";Object(u.a)(Ch,"DictationConstants",null,[]);class Al{constructor(M){this.languageTag=M;this.displayName=(M=zf.a.Eg(M))?M.displayName:this.languageTag;this.LCID=M?M.LCID:Al.Kzn}}Al.Kzn=1033;Object(u.a)(Al,"DictationLanguage",null,[]);class Rj extends Vi.a{constructor(){super(!1,!1,!0);const M={["id"]:"DictationSettingsDialog",
["ProductionSupportLanguages"]:this.twf(Rj.Oe.omg),["PreviewLanguagesHeader"]:Box4Intl.Box4Strings.L_DictationPreviewLanguages,["PreviewSupportLanguages"]:this.twf(Rj.Oe.$kg),["LanguageState"]:Rj.Oe.$T,["MicrophoneState"]:Rj.Oe.AYc,["AutoPunctuationState"]:Rj.Oe.useAutoPunctuation,["ProfanityFilterState"]:Rj.Oe.QAb,["QuickAccessInterfaceState"]:Rj.Oe.nze};Rj.Oe.a_f&&(M.PrivatePreviewLanguagesHeader="Private Preview Languages",M.PrivatePreviewSupportLanguages=this.twf(Rj.Oe.Mhd));M.MicProblemsLink=
{["type"]:"AppLinkProps",["id"]:"micProblemsLink",["text"]:Box4Intl.Box4Strings.L_DictationSettingsDialogMicProblemsText,["handler"]:{["href"]:"https://support.microsoft.com/article/d59106af-81ee-4ec3-8350-571ed47bece2#bkmk_troubleshooting",["target"]:"_blank"}};this.Uh(Box4Intl.Box4Strings.L_DictationSettingsDialogTitle,Rj.aul,M)}twf(M){const fa=[];let Va=0;for(const Fb of M)M={},M.Tag=Fb.languageTag,M.Name=Fb.displayName,fa[Va++]=M;return fa}static Hrf(M){Rj.Oe=M;new Rj}static aul(M,fa){1===M&&
(Rj.Oe.$T!==fa.LanguageState&&(Rj.Oe.$T=fa.LanguageState),Rj.Oe.AYc!==fa.MicrophoneState&&(Rj.Oe.AYc=fa.MicrophoneState),Rj.Oe.useAutoPunctuation!==fa.AutoPunctuationState&&(Rj.Oe.useAutoPunctuation=fa.AutoPunctuationState),Rj.Oe.QAb!==fa.ProfanityFilterState&&(Rj.Oe.QAb=fa.ProfanityFilterState),Rj.Oe.nze!==fa.QuickAccessInterfaceState&&(Rj.Oe.nze=fa.QuickAccessInterfaceState));Rj.Oe=null}}Rj.Oe=null;Object(u.a)(Rj,"DictationSettingsDialog",Vi.a,[]);var qk;(function(M){M[M.Success=0]="Success";M[M.zOp=
1]="FragmentInsertionFailed";M[M.AOp=2]="FragmentParaIsNull";M[M.COp=3]="FragmentRandomException";M[M.BOp=4]="FragmentParaTextChanged";M[M.QOp=5]="HypothesisInsertionFailed";M[M.ROp=6]="HypothesisParaIsNull";M[M.TOp=7]="HypothesisRandomException";M[M.SOp=8]="HypothesisParaTextChanged";M[M.oOp=9]="FinalTextInsertionFailed";M[M.pOp=10]="FinalTextParaIsNull";M[M.rOp=11]="FinalTextRandomException";M[M.qOp=12]="FinalTextParaTextChanged"})(qk||(qk={}));Object(u.b)("DictationTextInsertionFailureReason",
qk);var eg;(function(M){M[M.success=0]="success";M[M.ueq=1]="noScriptLoader";M[M.T0p=2]="failedToLoadSpeechClientModule";M[M.R0p=3]="failedToCreateSpeechClient";M[M.meq=4]="noDictationHost";M[M.H5p=5]="initializeError";M[M.I5p=6]="initializeErrorAudio";M[M.ADf=7]="focusLostWhileStarting"})(eg||(eg={}));Object(u.b)("StartDictationResult",eg);class qf{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub,yc){this.ND=this.LFd=null;this.Vvd=this.qOd=!1;this.lDh=this.Zia=0;this.qd=Object(Ni.a)();this.oe=
Bg.KeyInputManager.instance;this.mHh=U.StaticActiveAppFrame.za().Bzc;this.Dzd=null;this.ouc=(ad,md,Sd,ze,Ne)=>{if(1===Sd)return 32;Ne&&(this.ND?Ne[me.a.On]=this.ND.isVisible():(ad=this.l5.BR(),md=2===ad,Ne[me.a.On]=md||1===ad,Ne[mf.a.IconSet]=md?(new ug.a("JotInsertAudioRecordingShort_20")).iconSet:(new ug.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet));return 32};this.Yqe=(ad,md,Sd,ze,Ne)=>{if(1===Sd)return 32;Ne&&this.ND&&(Ne[me.a.On]=this.ND.isVisible());return 32};this.eAb=(ad,md,Sd)=>
{if(({Hz:ad}=this.gSj(md)).returnValue)return ad;if(2===Sd)if(this.ND)this.FBc(this.g1j);else return this.TAf("ToggleDictation");return 32};this.showDictationFloatie=(ad,md,Sd)=>{if(({Hz:ad}=this.gSj(md)).returnValue)return ad;2===Sd&&this.ND&&!this.ND.isVisible()&&this.FBc(()=>this.Yye(!1));return 32};this.ECe=(ad,md,Sd)=>2!==Sd?32:this.TAf("FloatieMicButton");this.Qyn=(ad,md,Sd)=>{if(1===Sd)return 32;z.AFrameworkApplication.va.Ob(Q.a.owf,2);Rj.Hrf(this.Sf);return 32};this.Rpe=(ad,md,Sd,ze,Ne)=>
{if(1===Sd)return 32;this.Ldo(Ne);return 32};this.Kre=(ad,md,Sd,ze,Ne)=>{if(1===Sd)return 32;Ne&&((ad=Ne.MenuItemId)&&ad===this.Sf.$T?(Ne[me.a.On]=!0,this.LFd=Ne.SourceControlId):Ne[me.a.On]=!1);return 32};this.Kwe=(ad,md,Sd,ze,Ne)=>{if(1===Sd)return 32;Ne&&(ad=Ne.SourceControlId,this.LFd!==ad&&(this.Sf.$T=Ne.MenuItemId,this.N7j(this.LFd),this.N7j(ad),this.LFd=ad,2===this.l5.BR()&&this.rzb(!0,"SetDictationLanguage")));return 32};this.showHelpPane=(ad,md,Sd,ze,Ne)=>{if(1===Sd||!Ne)return 32;ad=qf.zwk;
this.Sf.BEa&&(ad=this.Sf.jDp?qf.bAk:qf.bvk);if(!z.AFrameworkApplication.hL)try{const ng=this.ui.value;if(!ng)return 0;const Ng=new Bi.a;Ng.QU.query=`AssetID=${ad}`;ng.E8(qf.MTe,Ng);return 32}catch(ng){Na.ULS.sendTraceTag(553788752,394,rg(ng,th,li),`Failed to show help in taskPane: ${ng}`)}Zf.Redirect.showHelp(ad);return 32};this.xYn=(ad,md,Sd)=>{2===Sd&&(this.shc("FloatieDismissed"),qf.vJc&&qf.Ehb===qf.HGd&&(this.O7o(),qf.vJc=!1));return 32};this.H1n=(ad,md,Sd)=>{2===Sd&&2===this.l5.BR()&&this.rzb(!0,
"OnPauseDictationCommand");return 32};this.iZn=(ad,md,Sd)=>{2===Sd&&this.shc("ExitDictationCommand");return 32};this.f3n=(ad,md,Sd)=>{2===Sd&&(this.l5.BR()||this.FBc(this.jzb));return 32};this.isc=(ad,md,Sd)=>{2===Sd&&this.shc(null);return 32};this.kZn=(ad,md,Sd,ze,Ne)=>{2===Sd&&this.rzb(!0,Ne?qk[Ne]:"FailedToInsertText");return 32};this.AYn=(ad,md,Sd)=>{2===Sd&&(this.ND&&this.ND.Dbg(),this.pEe());return 32};this.BYn=(ad,md,Sd)=>{2===Sd&&(this.ND&&this.ND.Fbg(),this.rzb(!1,null));return 32};this.zYn=
(ad,md,Sd,ze,Ne)=>{2===Sd&&Ne&&(ad=zf.a.Eg(this.Sf.$T),this.Ee.kxe(this.zM.Vs(Ne),ad.LCID,Ne.cpEnd));return 32};this.yYn=(ad,md,Sd)=>{2===Sd&&this.rzb(!0,"OnDictationFocusLost");return 32};this.DYn=(ad,md,Sd)=>{2===Sd&&this.rzb(!0,"OnDictationTimeout");return 32};this.wua=(ad,md)=>{qf.UNa("Select",md);Eh.fOi()};this.Amb=ad=>{this.lDh=this.Zia;this.Zia=ad.Lb.keyCode;ad.Lb.rawEvent&&(ad=ad.Lb.rawEvent,this.llj(this.Zia,ad.ctrlKey,ad.shiftKey,ad.altKey));return!1};this.njf=(ad,md)=>{this.Zia=md.sWf?
xh.a.JD:md.isDelete?xh.a.I4:this.Zia;this.llj(this.Zia)};this.Eva=ad=>{var md=ad.Lb.rawEvent.inputType;if(!(void 0!==md&&null!==md||this.Zia!==xh.a.JD&&this.Zia!==xh.a.I4)||"deleteContentBackward"===md||"deleteContentForward"===md)return!1;md=this.kf.Fx().innerText;ad=this.el.hjc(2,ad.Lb.target);F.a.Zw(md.charCodeAt(ad-1))?this.g$o(md,ad):this.f$o(md,ad);return!0};this.CYn=(ad,md,Sd)=>2===Sd&&this.Sf&&this.Sf.oXf?this.ND&&!this.ND.isVisible()?(this.FBc(this.g1j),32):this.TAf("KeyboardShortcut"):32;
this.M7o=ad=>{!ad||ad.Yi||ad.Zo||(qf.Ehb=ad.result,ad=fd.a.instance.Ta("Common.ISystemInitiatedFeedback"),z.AFrameworkApplication.BI&&qf.Ehb<qf.HGd?(Na.ULS.sendTraceTag(572002957,394,50,"Dictation floatie launch automatically"),qf.vJc=!0,z.AFrameworkApplication.va.Ob(Q.a.showDictationFloatie,2),this.X5b&&this.X5b.bJj(qf.Ehb+1),ad&&(ad.execute(md=>{md.logActivity("ShowDictationFloatieCallout","")}),Na.ULS.sendTraceTag(572002958,394,50,"Callout shown for dictation floatie load")),xg.a("ShowDictationFloatieOnDocumentLoad",
!0)):qf.Ehb===qf.HGd&&ad&&(ad.execute(md=>{md.logActivity("DismissDictationFloatieCallout","")}),Na.ULS.sendTraceTag(572002959,394,50,"Callout shown for dictation floatie dismiss")))};this.ga=M;this.k5=sb.a.A1b;this.Z5b=sb.a.hI;this.l5=Va;this.UHb=fa;this.Ee=Fb;this.zM=Vb;this.Sf=Xc;this.Zb=Dd;this.X5b=Ce;this.kf=ea;this.el=Xa;this.KDc=yb;qf.oB=Ub;this.ND=wc;this.ui=vd;qf.CSa=yc;qf.ux.add("~","tilde, tilde symbol");qf.ux.add("`","backquote, backtick");qf.ux.add("!","exclamation mark, exclamation point");
qf.ux.add("@","at sign, at mention");qf.ux.add("#","pound sign, number sign");qf.ux.add("$","dollar sign");qf.ux.add("%","percent sign");qf.ux.add("^","caret, caret symbol");qf.ux.add("&","ampersand, and sign");qf.ux.add("*","asterisk");qf.ux.add("(","open parenthesis");qf.ux.add(")","close parenthesis");qf.ux.add("-","hyphen");qf.ux.add("_","underscore");qf.ux.add("=","equal sign");qf.ux.add("+","plus sign");qf.ux.add("{","left brace, left curly brace");qf.ux.add("}","right brace, right curly brace");
qf.ux.add("[","left bracket, left square bracket");qf.ux.add("]","right bracket, right square bracket");qf.ux.add("\\","backslash");qf.ux.add("|","vertical bar sign, pipe character");qf.ux.add(";","semicolon");qf.ux.add(":","colon");qf.ux.add('"',"open quote, close quote");qf.ux.add("'","open single quote, close single quote");qf.ux.add("<","left angle bracket, open angle bracket");qf.ux.add(">","right angle bracket, close angle bracket");qf.ux.add(",","comma");qf.ux.add(".","period, full stop");
qf.ux.add("/","forward slash");qf.ux.add("?","question mark");for(const ad of qf.ux){M=ad.value.split(", ");for(const md of M)qf.EIh.add(md)}}Xb(){if(D.a.ZAe){this.ga.fb(Q.a.Rpe,rb.a.view,this.Rpe,96);this.ga.fb(Q.a.Kwe,rb.a.view,this.Kwe,1028);this.ga.fb(Q.a.Kre,rb.a.view,this.Kre,96);this.ga.fb(Q.a.eAb,rb.a.view,this.eAb,1028);this.ga.fb(Q.a.ouc,rb.a.view,this.ouc,96);this.ga.fb(Q.a.Yqe,rb.a.view,this.Yqe,96);this.ga.fb(Q.a.mwf,rb.a.view,this.isc,64);this.ga.fb(Q.a.wfi,rb.a.view,this.isc,64);this.ga.fb(Q.a.Afi,
rb.a.view,this.AYn,64);this.ga.fb(Q.a.Bfi,rb.a.view,this.BYn,64);this.ga.fb(Q.a.xfi,rb.a.view,this.zYn,64);this.ga.fb(Q.a.ufi,rb.a.view,this.yYn,64);this.ga.fb(Q.a.Dfi,rb.a.view,this.kZn,64);this.ga.fb(Q.a.yfi,rb.a.view,this.DYn,64);this.ga.fb(Q.a.showDictationFloatie,rb.a.view,this.showDictationFloatie,4);this.ga.fb(Q.a.tfi,rb.a.view,this.Qyn,96);this.ga.fb(Q.a.rwf,rb.a.view,this.showHelpPane,96);this.ga.fb(Q.a.swf,rb.a.view,this.showHelpPane,96);this.ga.fb(Q.a.ECe,rb.a.view,this.ECe,1028);this.ga.fb(Q.a.nwf,
rb.a.view,this.xYn,1028);this.ga.fb(Q.a.owf,rb.a.view,this.H1n,96);this.ga.fb(Q.a.sfi,rb.a.view,this.iZn,96);this.ga.fb(Q.a.XTl,rb.a.view,this.f3n,96);var M=this.Zb.ie(Vj.AFrame.Gq),fa=Bg.KeyInputManager.oc(xh.a.aMg,1);M.bindAction(fa,Q.a.Cfi);this.ga.fb(Q.a.Cfi,rb.a.view,this.CYn,1028);this.KDc.kPh(this.njf)}else Na.ULS.sendTraceTag(560579552,394,15,"Not registering dictation actions in unsupported browser")}async FBc(M,fa=!1){var Va;try{await M.apply(this)}catch(Fb){if(Na.ULS.sendTraceTag(553747904,
394,rg(Fb,th,li),`${Fb}`),this.shc(Fb),!fa)switch(null!==(Va=null===Fb||void 0===Fb?void 0:Fb.message)&&void 0!==Va?Va:Fb){case "AugloopNotConnected":Mh.HTj();break;default:Mh.gVj()}}}y5d(){return Ch.bUl}gSj(M){if(!this.Sf.oXf)return{returnValue:!0,Hz:2};M=Object(pg.a)(Jk.a,M);if(!M)return{returnValue:!0,Hz:2};M=Object(pg.a)(Wh.MainView,M.view);if(!M||!M.ve)return{returnValue:!0,Hz:2};M=M.lb;if(!M)return qf.Ac.fc(qg.a.Ne,{["Reason"]:dl.a.qga}),{returnValue:!0,Hz:8};M=M.Pg;if(!M)return qf.Ac.fc(qg.a.Ne,
{["Reason"]:dl.a.Qn}),{returnValue:!0,Hz:8};if(M.Al){const fa=Object(gh.a)().h5d(M);if(R.ParagraphReader.Wb(fa)&&fa.ka(dg.a.gQ,null))return{returnValue:!0,Hz:8}}return Object(gh.a)().wIa(R.ParagraphReader.xX,M)?(qf.Ac.fc(qg.a.Ne,{["Reason"]:dl.a.XQ}),{returnValue:!0,Hz:8}):{returnValue:!1,Hz:32}}tWk(){const M=Object.assign(new Ui.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),fa=Object.assign(new Bb.a,{Id:"DictationLanguageList_"+
this.y5d(),ExternalId:"DictationLanguageList_"+this.y5d(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:Q.a.eAb.toString(),MenuItemId:this.y5d(),QueryCommand:Q.a.ouc.toString(),Image16by16Class:xj.getImageClass(Ch.VTl),Image32by32Class:xj.getImageClass(Ch.WTl),Visible:!0,AriaLabel:Pb.a.gal});M.ControlList.push(fa);return M}Ldo(M){M.MenuItems=Object.assign(new zc.a,{Id:"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});var fa=this.tWk();M.MenuItems.MenuSectionList.push(fa);
fa=this.Sf.omg;0<fa.length&&(fa=qf.rza(fa,"dictationProductionLanguages",""),M.MenuItems.MenuSectionList.push(fa));fa=this.Sf.$kg;0<fa.length&&(fa=qf.rza(fa,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages),M.MenuItems.MenuSectionList.push(fa));this.Sf.a_f&&(fa=qf.rza(this.Sf.Mhd,"dictationPrivatePreviewLanguages","Private Preview Languages"),M.MenuItems.MenuSectionList.push(fa));M.PopulationXML=hi.o(M.MenuItems)}pEe(){const M=this.UHb.value;if(M){const fa={};fa[this.y5d()]=
"ToggleButtonModel";sb.a.fad()&&(fa[Ch.cUl]="SplitButtonModel");M.SOa(fa)}}N7j(M){const fa=this.UHb.value;if(fa){const Va={};Va[M]="ToggleButtonModel";fa.SOa(Va)}}async g1j(){try{this.qOd||(this.qOd=!0,this.ND.isVisible()?(1===this.l5.BR()&&Na.ULS.sendTraceTag(523293635,394,10,"Ending dictation floatie session while dictation starting"),this.shc("RibbonClicked"),this.qOd=!1):await this.Yye(),this.pEe())}finally{this.qOd=!1}}async Yye(M=!0){var fa;Na.ULS.sendTraceTag(553747905,394,50,`Show dictation floatie triggered, has focus: ${window.self.document.hasFocus()}`);
window.self.document.hasFocus()||(Na.ULS.sendTraceTag(522847071,394,15,"Window does not have focus at the time of starting Dictation!"),z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationForceFocusIfMissing",!1)&&window.self.focus());await this.ND.Yye((new Al(this.Sf.$T)).displayName);if(this.Z5b){this.Z5b.pAe();const Va=new Date;this.Sf.Pad=Va;this.Sf.nic||(this.Sf.nic=Va)}if(0===this.l5.BR())if(M){if(M=await this.jzb(),0!==M)throw Error(eg[M]);}else this.ND&&this.ND.shj();
null===(fa=this.k5)||void 0===fa?void 0:fa.qdp()}TAf(M){const fa=this.l5.BR();if(1===fa||3===fa)return 1;fa?(qf.CSa.FLb("pause dictation"),this.rzb(!0,M)):this.FBc(this.jzb);return 32}shc(M){const fa=this.l5.BR();1!==fa&&(this.ND&&this.ND.hideFloatie(),this.k5&&this.k5.Jep(),fa&&this.rzb(!0,M),this.Z5b&&this.Z5b.Pl(),this.pEe())}rzb(M=!0,fa=null){this.FBc(()=>this.l5.jqd(M,fa),!0);this.pEe();this.Fsp();Eh.fOi();this.Dzd&&(xg.a("DictationUsageTime",!0,void 0,[Object.assign(new tb.a,{name:"DictationSessionDuration",
double:window.performance.now()-this.Dzd}),Object.assign(new tb.a,{name:"IsDictationFloatieShownOnAppLoad",bool:qf.vJc})]),this.Dzd=null)}Eto(){this.Vvd||(this.hqg(),this.oe.ub($c.a.WK,this.qd.Ie.editingElement,this.Amb),this.ga.fY(qf.CSa),this.mHh.ub($c.a.input,this.qd.Ie.editingElement,this.Eva,null),this.Vvd=!0)}Fsp(){this.Vvd&&(this.JJg(),this.oe.xc($c.a.WK,this.qd.Ie.editingElement,this.Amb),this.ga.d2b(qf.CSa),this.mHh.xc($c.a.input,this.qd.Ie.editingElement,this.Eva),this.Vvd=!1)}hqg(){this.l5.hqg();
qf.ib.AB(this.wua)}JJg(){this.l5.JJg();qf.ib.gna(this.wua)}g$o(M,fa){var Va=M.substring(0,fa-1).split(qf.space);const Fb=Va.length;(M=Va[Fb-1])&&!this.wCg(M)&&(fa=Va[Fb-2])&&!this.wCg(fa+" "+M)&&(Va=Va[Fb-3])&&this.wCg(Va+" "+fa+" "+M)}f$o(M,fa){M=M.substring(fa-1,fa);if(fa=this.bRm(M))qf.CSa.FLb(fa),this.l5.updateTooltipTelemetry("Punctuation",M)}wCg(M){if(qf.EIh.contains(M)){const fa=fj.e(M.charAt(0).toString())+M.substring(1,M.length);qf.CSa.FLb("Type out "+fa);this.l5.updateTooltipTelemetry("TypeOut",
M);return!0}return!1}bRm(M){let fa;return({value:fa}=qf.ux.Ec(M,fa)).returnValue?fa:null}async jzb(){let M=0;try{if(this.Sf&&this.Sf.oXf)Na.ULS.sendTraceTag(553747907,394,50,"Starting dictation"),this.ND&&this.ND.Ebg(),M=await this.l5.jzb();else{const fa=D.a.ZAe,Va=z.AFrameworkApplication.J.$("UserCanUseDictation");Na.ULS.sendTraceTag(553747906,394,10,`Failed to start dictation due to disabled shortcut:
userCanUseDictation: '${Va}'
supportsMicrophoneAccessInIframe: '${fa}'
userAgent: '${window.navigator.userAgent}'`);M=fa?5:6}0===M&&(this.ND&&this.Eto(),qf.vJc&&this.VTo(qf.HGd),this.Z5b&&(alVoiceClient.DictationSettingsManager.dictationSettings.properties.ClientSessionId=this.Z5b.sessionID),this.Dzd=window.performance.now())}finally{0!==M&&this.ND&&this.shc(`${eg[M]}`)}return M}PZk(){Ae.a.instance.$b(new Gf.a(5,1,z.AFrameworkApplication.J.jc("DictationUxAutoLoadDelayTimeMs",7E3),()=>{if(this.X5b){const M=this.X5b.$pm();M&&M.continueWith(this.M7o,0)}}))}llj(M,fa=!1,
Va=!1,Fb=!1){if(!fa&&!Fb){fa="";switch(M){case xh.a.Pu:Va||(fa=this.lDh===M?"new paragraph":"new line");break;case xh.a.JD:case xh.a.I4:qf.UNa("Delete")||(fa="delete, backspace")}""!==fa&&qf.CSa.FLb(fa)}}VTo(M){this.X5b&&this.X5b.bJj(M)}O7o(){const M=fd.a.instance.Ta("Common.ISystemInitiatedFeedback");M&&(M.execute(fa=>{fa.logActivity("DismissDictationFloatieCallout","")}),Na.ULS.sendTraceTag(573190861,394,50,"Callout shown for dictation floatie dismiss"))}static get Ac(){return jg.a.instance}static get ib(){return Fa.a.instance}static get Qe(){return Gc.a.instance}static createInstance(M,
fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub){return qf._instance||(qf._instance=new qf(z.AFrameworkApplication.va,M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub))}static rza(M,fa,Va){Va=Object.assign(new Ui.a,{DisplayMode:"Menu",Title:Va,Id:fa,ControlsId:"ctr"+fa,ControlList:[]});for(const Fb of M){M=fa+"_"+Fb.languageTag;const Vb=Fb.displayName,wc=Fb.languageTag;M=Object.assign(new Bb.a,{Id:M,ExternalId:M,LabelText:Vb,Command:Q.a.Kwe.toString(),MenuItemId:wc,QueryCommand:Q.a.Kre.toString(),Visible:!0,AriaLabel:Pb.a.umb});
Va.ControlList.push(M)}return Va}static UNa(M,fa){if(qf.X3m()){fa=(fa=O.a.instance.currentSelection)?fa.Qa?fa.Qa:null:null;var Va=E.a.XT(fa.cpBegin,fa.cpEnd,!1,fa.node),Fb=["Capitalize","Lowercase","Uppercase"];if(!Va)return!1;fa=qf.getSelectedText(Va);fa=fa.replace(qf.wSn,"");fa=fa.replace(qf.fYb," ");fa=fa.replace(qf.Qpd," ");if(""===fa||" "===fa)return!1;20<fa.length&&(fa=fa.substring(0,20)+"...");let Vb=M;if("Bold Italics Underline Strikethrough Subscript Superscript".split(" ").includes(M)){if("Bold"!==
M&&"Italics"!==M&&!qf.uZf())return!1;Vb=qf.fOf(Va,M,fa);if(""===Vb)return!1}else if(Fb.includes(M)&&qf.uZf())if(Va=this.getSelectedText(Va,!0),Fb=new mc,M=M.toLowerCase(),Fb.C0c(Va,0)>Va.length-1)Vb=`${M} ${fa.toLowerCase()}, ${M} that`;else if(null===qf.Uzh)Vb=`${M} this paragraph`;else return!1;else Vb=Vb+" "+fa;qf.CSa.FLb(Vb);return!0}qf.ib.gb&&qf.ib.gb.currentSelection&&qf.Qe.mf(qf.ib.gb.currentSelection.Qa)&&fa&&0<fa.VP.length&&(qf.Uzh=1==fa.VP.length?null:fa.VP[0].context.node);return!1}static fOf(M,
fa,Va=""){""!==Va&&(Va=" "+Va);M=qf.hum(M);switch(fa){case "Bold":fa=1===M.bold?"bold"+Va+", bold that":"unbold"+Va+", unbold that";break;case "Italics":fa=1===M.italic?"italicize"+Va+", italicize that":"unitalicize"+Va+", unitalicize that";break;case "Underline":fa=1==M.underline?"underline"+Va+", underline that":"clear formatting, clear formatting from this";break;case "Strikethrough":fa=1==M.strikethrough?"strike"+Va+", strikethrough"+Va:"clear formatting, clear formatting from this";break;case "Subscript":fa=
1==M.subscript?"subscript"+Va+", subscript that":"clear formatting, clear formatting from this";break;case "Superscript":fa=1==M.superscript?"superscript"+Va+", superscript that":"clear formatting, clear formatting from this";break;default:fa=""}return fa}static hum(M){M=qh.FormattingReader.Vs(M);if(!M)return null;M=M.cache;const fa=new Gb.a;let Va;Va=qf.oB.rI(Nf.a.bold,M.isBold);fa.bold=Va?1:0;Va=qf.oB.rI(Nf.a.italic,M.isItalic);fa.italic=Va?1:0;Va=qf.oB.rI(Nf.a.underline,M.isUnderline);fa.underline=
Va?1:0;Va=qf.oB.rI(Nf.a.strikethrough,M.isStrikethrough);fa.strikethrough=Va?1:0;Va=qf.oB.rI(Nf.a.subscript,M.isSubscript);fa.subscript=Va?1:0;Va=qf.oB.rI(Nf.a.superscript,M.isSuperscript);fa.superscript=Va?1:0;return fa}static getSelectedText(M,fa){if(qf.Qe.mf(M)||!M.cpEnd||!R.ParagraphReader.Wb(M.node))return"";const Va=R.ParagraphReader.text(M.node);return-1!==M.cpBegin||-1!==M.cpEnd||fa?Va.substring(M.cpBegin,M.cpEnd):Va.substring(0,20)}static X3m(){if(!qf.ib.gb||!qf.ib.gb.currentSelection)return!1;
var M=qf.ib.gb.currentSelection;return M&&1<M.length?!0:(M=M.Qa)?!qf.Qe.mf(M):!1}static uZf(){return z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableNewReactiveSuggestions",!1)}static bNi(M){return M&&M.Lb.rawEvent?(M=M.Lb.rawEvent,M.ctrlKey||M.shiftKey||M.altKey||M.metaKey):!1}}qf._instance=null;qf.vJc=!1;qf.Ehb=0;qf.CSa=null;qf.oB=null;qf.fYb=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]","g");qf.wSn=RegExp("[^\\x00-\\x7F]","g");qf.space=RegExp("\\s",
"g");qf.Qpd=RegExp("\\s{2,}","g");qf.MTe="FA000000012";qf.zwk="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";qf.bAk="78766431-0933-4603-abf5-5bcc1dee9dda";qf.bvk="d59106af-81ee-4ec3-8350-571ed47bece2";qf.Uzh=null;qf.EIh=new ye.a(Pc.a.vh());qf.ux=new vc.a(Pc.a.vh());qf.HGd=2;Object(u.a)(qf,"DictationActor",null,[938]);var kg=d(35),Wi=d(420),ql=d(1897),hg=d(67);class Km{constructor(M,fa){this.vM=null;this.axa=!1;this.B9=null;this.ki=0;this.wtk=M;this.Sf=fa}isVisible(){return this.axa}t7(){return this.axa&&
!!this.vM}v1l(){if(this.vM)return!0;this.vM=this.wtk.value;if(!this.vM)return!1;this.vM.P_o(Q.a.ECe);this.vM.JUo(Q.a.nwf);this.Sf.Pin||kg.a.addHandler(window.self,$c.a.resize,()=>{this.C5c()});const M=cf.FocusManager.instance().ie(hg.a.w7a);M.Nja(fa=>{this.Uam(fa)});M.w5a((fa,Va)=>{this.Sam(Va)});M.IL=!0;M.Iue=!0;Wi.a.instance.I$(hg.a.w7a,!0);Wi.a.instance.Dx(hg.a.w7a);return!0}Uam(M){this.t7()&&M.name!==Vj.AFrame.Oga&&this.vM.focus()}Sam(M){this.t7()&&M.name!==Vj.AFrame.Oga&&this.vM.blur()}async Yye(M){if(!this.axa){if(!this.v1l())throw Error("Unable to find the dictation floatie controller");
await this.vM.i8m();this.vM.showDictationFloatie(this.xVa(),this.Sf.AXi,M,this.Sf.useAutoPunctuation);this.B9=M;this.axa=!0;Wi.a.instance.QK(hg.a.w7a);this.ki=Date.now()}}hideFloatie(){if(this.t7()){var M=Date.now()-this.ki;this.ki=0;xg.c(Q.a.nwf,void 0,void 0,void 0,void 0,M);this.vM.dismissDictationFloatie();Wi.a.instance.Dx(hg.a.w7a);this.axa=!1}}Ebg(){this.t7()&&this.vM.Ebg()}Dbg(){if(this.t7()&&(this.vM.Dbg(),this.Sf.JSc))this.Sf.JSc.onDictationStarted()}Fbg(){this.shj();if(this.Sf.JSc)this.Sf.JSc.onDictationStopped()}shj(){this.t7()&&
this.vM.Fbg()}Rke(){this.t7()&&this.vM.Rke()}Nbg(){this.t7()&&this.vM.Nbg()}showDictationWarning(M){this.t7()&&this.vM.showDictationWarning(M)}showDictationInfo(M){this.t7()&&this.vM.showDictationInfo(M)}Oke(M){this.t7()&&this.vM.Oke(M)}onDictationLanguageChanged(M){this.B9=M;if(this.t7())this.vM.onDictationLanguageChanged(this.B9)}onCommandSuggestionsChanged(M){if(this.t7())this.vM.onCommandSuggestionsChanged(M)}xVa(){var M=U.StaticActiveAppFrame.za().Kka.getBoundingClientRect();let fa;fa=M.left+
M.width-126;M=M.top+24;return Object.assign(new ql.a,{x:fa,y:M})}C5c(){this.axa&&this.vM&&(this.vM.dismissDictationFloatie(),this.vM.showDictationFloatie(this.xVa(),this.Sf.AXi,this.B9,this.Sf.useAutoPunctuation))}}Object(u.a)(Km,"DictationFloatieManager",null,[]);var zg=d(264),Kd=d(1187);class Cg{constructor(M,fa){this.Ehb=0;this.Wbb=Va=>Va.result?Va.result.Value:0;this.rMa=Va=>{if(Va.Zo||Va.Yi)return Na.ULS.sendTraceTag(573415828,394,15,"Failed to get dictationFloatie settings options from Roaming Service."),
2;this.zYh(Va.result);Na.ULS.sendTraceTag(573415829,394,50,"Load to get dictationFloatie settings options from Roaming Service successfully");return this.Ehb};this.dw=M;this.NK=fa}$pm(){return this.NWi()?this.NK.Wcb(zg.a.YYc).CWRCo(this.Wbb,0).CWRCo(this.rMa,0):null}H4(M){this.NK&&this.NK.H4(zg.a.YYc,new Kd.a(zg.a.YYc,M))}bJj(M){this.NWi()&&(this.dw.wna("saveDictationFloatieSetting",M.toString()),Na.ULS.sendTraceTag(573415826,394,50,"Try to save dictationFloatie settings value to Roaming Service."),
this.zYh(M),this.H4(M))}NWi(){const M=z.AFrameworkApplication.J.$("IsAnonymousUser");if(z.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(M)Na.ULS.sendTraceTag(573415827,394,50,"User is anonymous ");else return!0;return!1}zYh(M){this.Ehb=M}}Object(u.a)(Cg,"DictationFloatieSettingInfo",null,[915]);var wl=d(725),Kl=d(118);class ae{constructor(){this.dataFields=this.name=null}}Object(u.a)(ae,"Contract",null,[]);class pd{constructor(){this.rGa=this.t3a=0;this.C6b=null;this.fxa=!0;this.Mvd="";
this.MRa=this.zpa=this.iib=this.qt=this.ki=0;this.vAd=this.CH="";this.fOc=this.Coa=0;this.sRe=this.pBd=this.cSe=!1;this.y8e="";this.xia=null;this.VMe=this.WMe=0;this.yNc=this.QHc=this.ee=null;this.G$e=this.o9g=this.ZNe=this.DGd=this.CGd=this.haf=this.fIh=this.oJb=this.nJb=0;sb.a.hI.cop(this)}get P5h(){return this.CH}set P5h(M){this.CH=M}get ADf(){return this.pBd}get sessionID(){return sb.a.hI?sb.a.hI.sessionID:""}get y_m(){return 0<this.zpa+this.MRa}get ADp(){return 0<this.WMe+this.VMe}get HOa(){return sb.a.hI?
sb.a.hI.HOa:""}set HOa(M){sb.a.hI&&(sb.a.hI.HOa=M)}onFragment(M){this.iib||(this.iib=(new Date).getTime());this.QHc&&(this.QHc.stop(),this.nJb+=this.QHc.Ri,this.QHc.start());this.t3a++;this.MRa+=M.split(" ").length}onFinalPhrase(M){this.iib||(this.iib=(new Date).getTime());this.yNc&&(this.yNc.stop(),this.oJb+=this.yNc.Ri,this.yNc.start());this.MRa=0;this.rGa++;this.zpa+=M.split(" ").length}onConnectionStarted(M){this.Coa=(new Date).getTime();this.P5h=M;this.ee&&(this.QHc=this.ee.Xf("WebServiceCall",
"FragmentResponse"),this.yNc=this.ee.Xf("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.fOc=(new Date).getTime()}setAsyncScriptLoadDuration(M){this.o9g=M}onMicrophoneError(M){this.onCustomError("MicrophoneError",M,15)}onCustomError(M,fa=null,Va=10){Na.ULS.sendTraceTag(588649347,394,Va,`OnCustomError: ${M} (was: ${this.C6b})`);this.fxa=!1;this.C6b=M;this.setEndReason(fa||M)}setEndReason(M){Na.ULS.sendTraceTag(588649348,394,15,`SetEndReason: ${M} (was: ${this.vAd})`);this.vAd=M;sb.a.hI.Znp(M)}onTextInsertionError(M){this.onCustomError("FailedToInsertText",
qk[M])}onTextInserted(M,fa){this.ZNe=fa;M?(this.haf+=fa,fa>this.DGd&&(this.DGd=fa)):(this.fIh=fa,fa>this.CGd&&(this.CGd=fa))}onFocusLost(){this.cSe=!0}onFocusLostWhileStarting(){this.pBd=!0}onFailedToStartTurn(){this.sRe=!0}onSpeechSessionStarted(M){this.y8e=M;this.G$e||(this.G$e=Date.now())}setDictationLatency(M){this.xia=M}onTileSubmitFailed(){}endActivity(){}onCommandCalled(){this.WMe++}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(M=
""){this.VMe++;Na.ULS.sendTraceTag(588649349,394,10,`OnCommandError: ${M}`)}updateTooltipTelemetry(){}}Object(u.a)(pd,"AbstractDictationSessionTelemetry",null,[951]);class el{}el.lwc="Seen";el.z2j="Tried";el.Gpc="Kept";Object(u.a)(el,"FunnelStatus",null,[]);class Yg extends pd{constructor(M,fa){super();this.t9g=!1;this.E_e=this.z_e=this.Z4e=0;this.Y_e=this.X_e=2147483647;this.gaf=this.daf=0;this.XJd={};this.KOd={};this.HHh=0;this.Sf=M;this.ki=(new Date).getTime();this.ee=fa;this.HOa=Kl.a.create().toString();
this.Ji=new pb.a;this.Ji.dataFields=[];this.Mvd="Office.Voice.Online.ALDictationSession";this.Ji.dataFields.push(Object.assign(new tb.a,{name:"Language",string:this.Sf.$T}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"IsUsingFloatie",bool:!0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"UseAutoPunctuation",bool:this.Sf.useAutoPunctuation}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"UseProfanityFilter",bool:this.Sf.QAb}));this.Ji.dataFields.push(Object.assign(new tb.a,
{name:"ServiceLoggingEnabled",bool:this.Sf.oji}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AppliedLabel",string:this.Sf.sensitivityLabel}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"UseVoiceCommands",bool:this.Sf.useVoiceCommands}));void 0!==this.Sf.nic&&null!==this.Sf.nic&&this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FirstSeen",string:this.Sf.nic.toISOString()}));void 0!==this.Sf.Pad&&null!==this.Sf.Pad&&this.Ji.dataFields.push(Object.assign(new tb.a,{name:"LastSeen",
string:this.Sf.Pad.toISOString()}))}onFinalResultAnnotationResponse(M,fa,Va){M=M+this.ZNe-(this.Z4e+(fa+Va)/1E4);this.daf+=M;this.z_e<M&&(this.z_e=M);this.X_e>M&&(this.X_e=M)}onPartialResultAnnotationResponse(M,fa,Va){M=M+this.ZNe-(this.Z4e+(fa+Va)/1E4);this.gaf+=M;this.E_e<M&&(this.E_e=M);this.Y_e>M&&(this.Y_e=M)}setRecordingStartTime(M){this.Z4e=M}onAugloopError(M){let fa=M;if(null===M||void 0===M?0:M.message)fa=`{message} ${M.message}`;else if(null===M||void 0===M?0:M.vOb)fa=`{errorMsg} ${M.vOb}`;
else if(null===M||void 0===M?0:M.error)fa=`{error} ${M.error}`;Na.ULS.sendTraceTag(588649350,394,10,`OnAugloopError: ${fa} (was: ${this.C6b}) (${jj(M)}))`);this.fxa=!1;this.t9g=!0;this.C6b=fa}onTileSubmitFailed(){this.HHh++}endActivity(){this.zpa+=this.MRa;this.qt=(new Date).getTime();this.Ji.succeeded=this.fxa;this.Ji.durationMs=this.qt-this.ki;this.saveTooltipTelemetry();this.Ji.dataFields.push(Object.assign(new tb.a,{name:"Success",bool:this.fxa}));this.fxa||this.Ji.dataFields.push(Object.assign(new tb.a,
{name:"error",string:this.C6b}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"SessionID",string:this.sessionID}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"SpeechSessionID",string:this.y8e}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TurnID",string:this.HOa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"NumberOfWords",int64:0<this.MRa?this.MRa+this.zpa:this.zpa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"NumberOfFragments",int64:this.t3a}));
this.Ji.dataFields.push(Object.assign(new tb.a,{name:"NumberOfFinalPhrases",int64:this.rGa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"connectionID",string:this.CH}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"IsFrontdoor",bool:!0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"EndReason",string:this.vAd}));this.iib&&this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TimeToGetFirstResult",int64:this.iib-this.Coa}));this.fxa&&(this.Ji.dataFields.push(Object.assign(new tb.a,
{name:"TimeToStartRecording",int64:this.fOc-this.ki})),this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TimeToOpenConnection",int64:this.Coa-this.fOc})));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FocusLost",bool:this.cSe}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FocusLostWhileStarting",bool:this.pBd}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FailedToStartTurn",bool:this.sRe}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MaxTimeToInsertFragment",
int64:this.CGd}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MaxTimeToInsertPhrase",int64:this.DGd}));var M=el.lwc;this.fxa&&0<this.zpa&&(M=0<this.rGa?el.Gpc:el.z2j);this.Ji.dataFields.push(Object.assign(new tb.a,{name:"DictationFunnel",contract:Object.assign(new ae,{name:"Office.System.Funnel",dataFields:[Object.assign(new tb.a,{name:"Name",string:"Dictation"}),Object.assign(new tb.a,{name:"State",string:M})]})}));this.Ji.name=this.Mvd;this.Ji.samplingPolicy=2;this.Ji.dataFields.push(Object.assign(new tb.a,
{name:"AugloopFailed",bool:this.t9g}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"CommandsUsedCount",int64:this.WMe}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"CommandsFailedCount",int64:this.VMe}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.z_e}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MinFinalResultUserPerceivedLatency",int64:this.X_e}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MaxPartialResultUserPerceivedLatency",
int64:this.E_e}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.Y_e}));M=0<this.rGa?this.daf/this.rGa:0;const fa=0<this.t3a?this.gaf/this.t3a:0;this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AverageFinalResultUserPerceivedLatency",double:M}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AveragePartialResultUserPerceivedLatency",double:fa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TileSubmissionFailures",int64:this.HHh}));
this.Sf.Ffi&&(this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AsyncScriptLoadDuration",int64:this.o9g})),this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TimeToSpeechSessionID",int64:this.G$e-this.ki})),this.audioPerfTracker&&(M={Ybl:{partials:this.audioPerfTracker.partials.getAverages(),finals:this.audioPerfTracker.finals.getAverages()},min:{partials:this.audioPerfTracker.partials.min,finals:this.audioPerfTracker.finals.min},max:{partials:this.audioPerfTracker.partials.max,finals:this.audioPerfTracker.finals.max}},
this.Ji.dataFields.push(Object.assign(new tb.a,{name:"Latency",string:JSON.stringify(M)}))));cb.a.sendActivityEvent(this.Ji)}updateTooltipTelemetry(M,fa){fa=fa.toLowerCase();switch(M){case "Punctuation":this.XJd[fa]=this.XJd[fa]+1||1;break;case "TypeOut":this.KOd[fa]=this.KOd[fa]+1||1}}saveTooltipTelemetry(){this.Ji.dataFields.push({name:"PunctuationsTypedDuringDictation",string:rh(this.XJd)});this.Ji.dataFields.push({name:"TypeOutWordsTypedDuringDictation",string:rh(this.KOd)});this.Ji.dataFields.push({name:"NumberOfPunctuationsTypedDuringDictation",
int64:Object.values(this.XJd).reduce((M,fa)=>M+fa,0)});this.Ji.dataFields.push({name:"NumberOfTypeOutWordsTypedDuringDictation",int64:Object.values(this.KOd).reduce((M,fa)=>M+fa,0)})}}Object(u.a)(Yg,"AugloopDictationTelemetry",pd,[]);const rh=M=>Object.keys(M).map(fa=>`${fa.split(" ").map(Va=>Va.charAt(0).toUpperCase()+Va.substr(1)).join("")}:${M[fa]}`).join(" ");var Mf=d(1673),mi=d(147);class Ag{constructor(M){this.Ff=M}play(){this.Ff.play()}pause(){this.Ff.pause()}get paused(){return this.Ff.paused}get currentTime(){return this.Ff.currentTime}set currentTime(M){this.Ff.currentTime=
M}get duration(){return this.Ff.duration}get error(){const M=this.Ff.error;return M?M.code:0}get readyState(){return this.Ff.readyState}get src(){return this.Ff.getAttribute("src")}set src(M){this.Ff.setAttribute("src",M)}get preload(){return this.Ff.getAttribute("preload")}set preload(M){this.Ff.setAttribute("preload",M)}}Object(u.a)(Ag,"AudioElement",null,[]);var Hf=d(29);class Pg{constructor(){this.X0e=this.V0e=this.oJb=this.nJb=this.nPe=0}onAudioData(){this.nPe||(this.nPe=(new Date).getTime())}onFragment(M){this.nJb+=
this.zIi(M);this.V0e++}M1n(M){this.oJb+=this.zIi(M);this.X0e++}qti(){return this.X0e?this.oJb/this.X0e:0}Nim(){return this.V0e?this.nJb/this.V0e:this.qti()}zIi(M){if(!M)return 0;const fa=(new Date).getTime();let Va=null;return({av:Va}=Hf.d(M)).returnValue?fa-this.nPe-(Va.Offset+Va.Duration)/1E4:0}}Object(u.a)(Pg,"DictationLatency",null,[]);class bk{constructor(M,fa){this.Moa=0;this.w8e=this.x8e=null;this.WJc=!1;this.TGd=null;this.pEd=!1;this.xia=this.xq=null;this.Ckj=()=>{if(1===this.Moa){if(this.xq)this.xq.onFocusLostWhileStarting()}else 2===
this.Moa&&(this.AJg(),this.mB.onFocusLost())};this.mB=fa;this.HK=M}onFinalText(M,fa){if(2===this.Moa){var Va=M.size;if(1!==Va&&(Na.ULS.sendTraceTag(51442337,394,10,`Final text mapping has invalid size of ${Va}`),!Va))return;fa=fa.get("JsonResult");this.xia&&this.xia.M1n(fa);this.mB.onFinalPhrase(M.values().next().value,fa)}}onFragmentText(M,fa){if(2===this.Moa){var Va=M.size;if(1!==Va&&(Na.ULS.sendTraceTag(51442338,394,10,`Fragment text mapping has invalid size of ${Va}`),!Va))return;fa=fa.get("JsonResult");
if(this.xia)this.xia.onFragment(fa);this.mB.onFragment(M.values().next().value)}}onError(M){if(this.Moa&&3!==this.Moa&&"ErrorNone"!==M){this.Moa=3;switch(M){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.mB.pVn(M);break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.mB.SXn(M);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.mB.zga(M);
break;case "ErrorInitialSilenceTimeout":this.mB.C_n(M);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.mB.onMicrophoneError(M);break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.mB.heg("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.mB.heg("NotFoundError");break;case "ErrorAudioNotReadableError":this.mB.heg("NotReadableError");
break;case "ErrorAugloopActivateAnnotations":this.mB.Zij(M);break;default:this.mB.v5n(M)}this.Moa=0}}onSpeechRecognitionStarted(M){if(bk._isFocusLostIgnored||window.self.document.hasFocus())this.Moa=2,this.WJc=!1,this.mB.onRecordingStarted(),this.mB.onConnectionStarted(M),this.x8e||(this.x8e=Object.assign(new Ag(document.createElement("audio")),{src:mi.a.Aj(Ch.Pbp)})),this.x8e.play();else{Na.ULS.sendTraceTag(522847070,394,15,"Stopping Dictation on start due to focus lost");if(this.xq)this.xq.onFocusLostWhileStarting();
this.AJg();this.mB.onFocusLost()}}onSpeechEnd(){this.AJg();0!==this.BR()&&(this.Moa=3,this.HK&&this.HK.Rke(),this.mB.B2n(),this.Moa=0,this.w8e||(this.w8e=Object.assign(new Ag(document.createElement("audio")),{src:mi.a.Aj(Ch.Obp)})),this.w8e.play())}onAudioData(M){if(this.xia)this.xia.onAudioData();this.mB.onAudioData(M);if(this.HK){var fa=0;for(const Va of M)fa+=Math.pow(Va,2);M=Math.sqrt(fa/M.length)>bk.rbp;!this.WJc&&M?(this.HK.Nbg(),this.WJc=!0,this.TGd=null):this.WJc&&!M&&(this.TGd?(new Date).getTime()>=
this.TGd+bk.gOn&&(this.HK.Rke(),this.WJc=!1):this.TGd=(new Date).getTime())}}onSpeechSessionStarted(M){const fa=M.speechSessionId;if(fa)this.mB.onSpeechSessionStarted(fa);else this.mB.onSpeechSessionStarted(M)}onEventUpdate(M){if(this.HK&&"QualityStatusUpdate"===M.eventName)switch(M.shortCode){case 13:case 2:this.HK.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.HK.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;
case 8:case 6:case 7:this.HK.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}startDictationSession(M,fa){this.mB.KUa(!1);this.mB.Wv=M;this.mB.LUi=fa;this.Ruo();this.xq=M;this.Moa=1;this.xia=new Pg;this.xq&&this.xq.setDictationLatency(this.xia)}BR(){return this.Moa}Ruo(){this.pEd||(kg.a.addHandler(window.self,$c.a.blur,this.Ckj),this.pEd=!0)}AJg(){this.pEd&&(kg.a.removeHandler(window.self,$c.a.blur,this.Ckj),this.pEd=!1)}showPermissionPrompt(){this.HK.showDictationWarning("MicPermissionNeeded")}}
bk.rbp=350;bk.gOn=350;bk._isFocusLostIgnored=!1;Object(u.a)(bk,"FrontdoorSpeechClientObserver",null,[941,942]);class Sj extends bk{constructor(M,fa){super(M,fa);this.KQa=new bk(M,fa)}onFinalText(M,fa){this.KQa.onFinalText(M,fa)}onFragmentText(M,fa){this.KQa.onFragmentText(M,fa)}onError(M){this.KQa.onError(M)}onSpeechRecognitionStarted(M){this.KQa.onSpeechRecognitionStarted(M)}onSpeechEnd(){this.KQa.onSpeechEnd()}onAudioData(M){this.KQa.onAudioData(M)}startDictationSession(M,fa){this.KQa.startDictationSession(M,
fa)}BR(){return this.KQa.BR()}onEventUpdate(M){this.KQa.onEventUpdate(M)}showPermissionPrompt(){this.KQa.showPermissionPrompt()}}Object(u.a)(Sj,"AugloopFrontdoorSpeechObserverAbstractDecorator",bk,[]);class gj extends Sj{constructor(M,fa,Va){super(M,fa);this.Xvk=M;this.ib=Va;this.DOk=fa}onFinalText(M,fa){super.onFinalText(M,fa)}onFragmentText(M,fa){if(this.nsn())super.onFragmentText(M,fa)}onError(M){var fa,Va,Fb,Vb;if("string"===typeof M)super.onError(M);else{const wc=null!==(Va=null!==(fa=null===
M||void 0===M?void 0:M.vOb)&&void 0!==fa?fa:null===M||void 0===M?void 0:M.message)&&void 0!==Va?Va:jj(M);fa=null!==(Vb=null!==(Fb=null===M||void 0===M?void 0:M.errorType)&&void 0!==Fb?Fb:null===M||void 0===M?void 0:M.name)&&void 0!==Vb?Vb:typeof M;switch(fa){case "ErrorAugloopActivateAnnotations":this.DOk.Zij(wc);break;default:Na.ULS.sendTraceTag(545051919,394,rg(wc,li),`Unknown errorType - ${fa}: ${wc}`)}}}onWarning(M){var fa;switch(null===M||void 0===M?void 0:M.errorType){case "ErrorAugloopActivateAnnotations":Na.ULS.sendTraceTag(545404100,
394,15,M.vOb);break;default:const Va=null!==(fa=null===M||void 0===M?void 0:M.vOb)&&void 0!==fa?fa:M;Na.ULS.sendTraceTag(545051920,394,15,Va)}}onSpeechRecognitionStarted(M=null){const fa=Kl.a.create().toString();super.onSpeechRecognitionStarted(M?M:fa)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(M){super.onAudioData(M)}startDictationSession(M,fa){super.startDictationSession(M,fa)}BR(){return super.BR()}onEventUpdate(M){super.onEventUpdate(M)}showDictationWarning(M,fa){"ExplicitlyDisabled"===M&&
"NoCommanding"===fa&&this.Xvk.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningNoCommanding)}nsn(){const M=this.ib.gb.currentSelection.Qa;return M.cpEnd!==M.cpBegin?!1:!0}}Object(u.a)(gj,"AugloopFrontdoorSpeechObserverDecorator",Sj,[]);class Yi{constructor(M){this.cKh=M}onVoiceCommand(M,fa){this.cKh.onVoiceCommand(M,fa)}setDictationSessionTelemetry(M){this.cKh.setDictationSessionTelemetry(M)}}Object(u.a)(Yi,"AugloopVoiceCommandObserverAbstractDecorator",null,[952]);class Bl extends Yi{constructor(M){super(M)}onVoiceCommand(M,
fa){super.onVoiceCommand(M,fa)}setDictationSessionTelemetry(M){super.setDictationSessionTelemetry(M)}}Object(u.a)(Bl,"AugloopVoiceCommandObserverDecorator",Yi,[]);class Ll{constructor(M){this.Sf=M}T9i(M){const fa=z.AFrameworkApplication.Fe;if(fa){var Va=this.Sf.fri;Va&&""!==Va&&fa.Xj(`https://${Va}/SpeechHandler.ashx?action=SendCorrectionTelemetry`,2,M,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(u.a)(Ll,"FrontdoorCorrectionsTelemetryLogger",null,[953]);class fn{constructor(){this.properties=
this.useVoiceCommands=this.useCorrections=this.useAutoPunctuation=this.dictationLanguage=null}}Object(u.a)(fn,"SpeechDictationSettings",null,[]);var Yn=d(282),Tl=d(281),jm=d(403);class Kk{constructor(M,fa,Va,Fb){this.mPe=this.fl=null;this.OY=M;this.HK=fa;this.mB=Va;this.kwa=Fb;this.initializeCommandsDictionary()}onVoiceCommand(M,fa){if(this.mPe)this.mPe.onCommandCalled();var Va=4;if(({value:Va}=this.fl.Ec(M.commandId,Va)).returnValue&&4!==Va){var Fb=new vc.a(Pc.a.vh());Fb.add("command",M);M.sourceText&&
this.HK.Oke(66===Va?`Spell out ${M.sourceText}`:M.sourceText.toLowerCase());51===Va||66===Va?(Fb=this.TRi(Va,M),this.mB.KUa(!1)):(this.mB.KUa(!1),Fb=this.OY.executeCommand(Va,Fb,fa),(64===Va&&4===Fb||67===Va&&1===Fb)&&(Fb=this.TRi(Va,M)));Va=Object.assign(new tb.a,{name:"VoiceCommandId",string:M.commandId});xg.d(Q.a.TTl,!0,xg.e,5,8,0,[Va]);M.offset&&M.duration&&(this.kwa.onCommandFinished(M.commandId,0===Fb,M.offset,M.duration,fa),this.kwa.U1f=M.commandId)}}setDictationSessionTelemetry(M){this.mPe=
M}TRi(M,fa){let Va=1;switch(M){case 51:M=fa.emojiValues;M=void 0!==M&&null!==M?M.emojiUtf16Value:null;fa=void 0!==M&&null!==M?M["0"]:"";break;case 64:case 66:fa=fa.sourceText;break;default:fa=fa.sourceText,Yn.a.sendTraceTag(512505093,Tl.a.eag,jm.a.Warning,`VoiceCommandWithInsertText.getTextToInsert - setting default command sourcetext as no handling found for commandId: ${nb[M]}`)}M=fa;void 0!==M&&null!==M&&(Va=this.mB.X9d(M,null));return Va}initializeCommandsDictionary(){this.fl=new vc.a(Pc.a.vh());
this.fl.add("Word.Editing.Undo",2);this.fl.add("Word.Editing.Bold",5);this.fl.add("Word.Editing.Italics",6);this.fl.add("Word.Editing.Underline",13);this.fl.add("Word.Editing.StrikeThrough",23);this.fl.add("Word.Editing.Subscript",22);this.fl.add("Word.Editing.Superscript",21);this.fl.add("Word.Editing.Highlight",47);this.fl.add("Word.Editing.SetFont",55);this.fl.add("Word.Editing.RemoveBold",14);this.fl.add("Word.Editing.RemoveUnderline",16);this.fl.add("Word.Editing.RemoveItalics",15);this.fl.add("Word.Editing.RemoveStrikeThrough",
24);this.fl.add("Word.Editing.RemoveSubscript",25);this.fl.add("Word.Editing.RemoveSuperscript",30);this.fl.add("Word.Editing.RemoveHighlight",48);this.fl.add("Word.Editing.Delete",31);this.fl.add("Word.Editing.Paste",7);this.fl.add("Word.Editing.Table.Insert",8);this.fl.add("Word.Editing.Table.Delete",9);this.fl.add("Word.Editing.Table.Navigate",10);this.fl.add("Word.Editing.Navigation",11);this.fl.add("Word.Editing.InsertComment",12);this.fl.add("Word.Editing.InsertBullet",26);this.fl.add("Word.Editing.FullJustify",
17);this.fl.add("Word.Editing.CenterJustify",18);this.fl.add("Word.Editing.LeftJustify",19);this.fl.add("Word.Editing.RightJustify",20);this.fl.add("Command.Exit",1);this.fl.add("Command.Pause",0);this.fl.add("Command.ShowHelp",32);this.fl.add("Command.ShowCommand",33);this.fl.add("Word.Editing.RemoveFormatting",34);this.fl.add("Word.Editing.ExitList",27);this.fl.add("Word.Editing.CreateBulletList",28);this.fl.add("Word.Editing.CreateNumberedList",29);this.fl.add("Word.Editing.NextLine",35);this.fl.add("Word.Editing.InsertSpace",
36);this.fl.add("Word.Editing.IncreaseIndent",37);this.fl.add("Word.Editing.DecreaseIndent",38);this.fl.add("Word.Editing.Backspace",39);this.fl.add("Word.Editing.NextBullet",40);this.fl.add("Word.Editing.GrowFont",41);this.fl.add("Word.Editing.ShrinkFont",42);this.fl.add("Word.Editing.Select",43);this.fl.add("Word.Editing.AllCaps",44);this.fl.add("Word.Editing.SentenceCase",45);this.fl.add("Word.Editing.LowerCase",46);this.fl.add("Word.Editing.Tab",49);this.fl.add("Word.Editing.ReadBack",50);this.fl.add("Word.Editing.InsertEmoji",
51);this.fl.add("Word.Editing.PageBreak",56);this.fl.add("Word.Editing.Quote",60);this.fl.add("Word.View.ZoomIn",52);this.fl.add("Word.View.ZoomOut",53);this.fl.add("Word.View.ShowOutline",54);this.fl.add("Word.View.ScrollDown",58);this.fl.add("Word.View.ScrollUp",57);this.fl.add("Word.Editing.ResumeDictation",61);this.fl.add("Word.Editing.Style",62);this.fl.add("Word.Editing.Deselect",63);this.fl.add("Word.Editing.Correction",64);this.fl.add("Word.Editing.CorrectionOption",65);this.fl.add("Word.Editing.SpellOut",
66);this.fl.add("Word.Editing.ShowSuggestions",67)}}Object(u.a)(Kk,"VoiceCommandObserver",null,[952]);class gn{onCommandSuggestion(M){(null===M||void 0===M?0:M.suggestionList)&&Eh.w7o(M.suggestionList[0])}onError(M){Na.ULS.sendTraceTag(521203971,394,10,`onCommandSuggestion - onError ${M}`)}onWarning(M){Na.ULS.sendTraceTag(521203970,394,15,`onCommandSuggestion - onWarning ${M}`)}}Object(u.a)(gn,"CommandSuggestionsObserver",null,[954]);var io=d(773);const rl=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.Voice.EnableCommandSuggestions",
!1),vm=(M,fa)=>new Promise((Va,Fb)=>{if(!M||0==M.length)return Promise.resolve();let Vb=0,wc=null;for(const Xc of M)Xc.catch(vd=>{fa&&fa(vd);null===wc&&(wc="");wc+=vd}).finally(()=>{Vb++;Vb>=M.length&&(null===wc?Va():Fb(wc))})});class Lj{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd){var Dd;this.xq=this.tCb=this.DRc=null;this.W3m=0;this.Thb=!1;this.aSn="0";this.SUn="2";this.kwa=wc;this.Sf=vd;this.EK=M;this.Loa=Va;this.YTl();this.Upa=new gj(fa,Xc,Vb);this.dKh=new Bl(new Kk(Va,fa,Xc,this.kwa),Va,Vb);this._augLoopRuntimeManager=
io.a.Nz();this.Thb=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSetAnnotationsFromALVoiceClient",!0)||z.AFrameworkApplication.J.$("SetAnnotationsFromALVoiceClient");z.AFrameworkApplication.$c("gg007760;f4gj0613");this.Thb||(this.Q8g=Array(Fb),this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Mf.a,{handler:Ce=>{for(const ea of this.Q8g)ea.onAnnotationResult(Ce)}})));this.IIb=new alVoiceClient.SpeechToTextClient(this._augLoopRuntimeManager,
this.Upa,vd.BEa,!1,this.Thb);this.Thb||this.pdf(this.IIb.getAnnotationObserver());M=new H.a;this.Sf.Zjn&&(M.add("ChangeViews"),M.add("PageBreak"));this.Sf.Tqn&&M.add("ReadBack");this.Sf.atn&&M.add("SpellOut");this.Sf.Svn&&M.add("Discovery");this.LJb=new alVoiceClient.VoiceCommandingClient(this._augLoopRuntimeManager,this.dKh,this.Upa,M.toArray(),this.Thb);this.Thb||this.pdf(this.LJb.getAnnotationObserver());rl&&(M=new gn,this.tCb=new alVoiceClient.CommandSuggestionClient(this._augLoopRuntimeManager,
M,this.Thb),this.Thb||this.pdf(this.tCb.getAnnotationObserver()));vd=new Ll(vd);null===(Dd=sb.a.A1b)||void 0===Dd?void 0:Dd.OAj(vd)}async jRi(M){this.ZTl();this.xq=M;this.Sf.useVoiceCommands&&this.dKh.setDictationSessionTelemetry(this.xq);this.DRc=new alVoiceClient.VoiceSession(this._augLoopRuntimeManager,this.Upa,this.Sf.BEa,this.kwa,this.xq);if(!1===(await this._augLoopRuntimeManager.getSession()).isConnected)throw Error("AugloopNotConnected");return 0}async jzb(M){var fa,Va,Fb,Vb;try{if(!this.IIb)return 3;
this.Loa&&this.Loa.WGo();this.Upa.startDictationSession(this.xq,M);const wc=this.Sf.useVoiceCommands;M=wc?[1]:[1,0];this.Loa.WVc.V7m();const Xc=[this.DRc.startVoiceSessionFromMicrophoneInput(null,this.Sf.AYc,this.Loa.WVc),this.IIb.initializeAsync(M,this.xq)];wc&&(Xc.push(this.LJb.initializeAsync(this.xq)),this.EK&&this.EK.czg(!0),this.Sf.BEa&&this.Loa.I5n());rl&&Xc.push(this.tCb.initializeAsync(this.xq));await vm(Xc,this.kMi);if(!1===this.IIb.initialized||wc&&!1===this.LJb.initialized)return Na.ULS.sendTraceTag(538518433,
394,15,`this._speechToTextClient.initialized: ${this.IIb.initialized}, useVoiceCommanding: ${wc}, this._voiceCommandingClient.initialized: ${null===(fa=this.LJb)||void 0===fa?void 0:fa.initialized}, focusLostWhileStarting: ${null===(Va=this.xq)||void 0===Va?void 0:Va.ADf}`),(null===(Fb=this.xq)||void 0===Fb?0:Fb.ADf)?7:5;rl&&!1===this.tCb.initialized&&Na.ULS.sendTraceTag(521417156,394,10,`this._commandSuggestionClient.initialized: ${this.tCb.initialized}, useVoiceCommanding: ${wc}, this._voiceCommandingClient.initialized: ${null===
(Vb=this.LJb)||void 0===Vb?void 0:Vb.initialized}`);this.Pbl();return 0}catch(wc){throw this.kMi(wc),await this.jqd(!0),fa=Error,Va=eg,Fb=wc,Fb="string"===typeof Fb&&Fb.startsWith("ErrorAudio")||Fb&&"initializeErrorAudio"===Fb.message,fa(Va[Fb?6:5]);}}kMi(M){Na.ULS.sendTraceTag(554775300,394,rg(M,th),`${M}`)}async jqd(M){if(M&&this.Upa)this.Upa.onSpeechEnd();this.DRc&&(await this.DRc.stopVoiceSession(),this.DRc=null);M=[];this.LJb&&(this.Sf.BEa&&this.Loa.J5n(),M.push(this.LJb.uninitializeAsync()));
this.IIb&&M.push(this.IIb.uninitializeAsync());this.tCb&&rl&&M.push(this.tCb.uninitializeAsync());await vm(M);this.xq=null;this.EK&&this.EK.czg(!1)}BR(){return this.Upa.BR()}pdf(M){this.Q8g[this.W3m++]=M}YTl(){alVoiceClient.DictationSettingsManager.dictationSettings=new fn;alVoiceClient.DictationSettingsManager.dictationSettings.useCorrections="true";alVoiceClient.DictationSettingsManager.dictationSettings.properties={};this.Sf.ILg&&(alVoiceClient.DictationSettingsManager.dictationSettings.properties["SpeechContext-PhraseOutput.interimResults.resultType"]=
"Hypothesis");this.Sf.Bnc&&(alVoiceClient.DictationSettingsManager.dictationSettings.properties.EnableAudioLogging=this.Sf.Bnc.toString());this.Sf.iDg&&""!==this.Sf.iDg&&(alVoiceClient.DictationSettingsManager.dictationSettings.properties.setFeature=this.Sf.iDg);this.Sf.Dif&&""!==this.Sf.Dif&&(alVoiceClient.DictationSettingsManager.dictationSettings.properties.wdAsrDomain=this.Sf.Dif);this.Sf.QAb||(alVoiceClient.DictationSettingsManager.dictationSettings.properties.Profanity="raw")}ZTl(){alVoiceClient.DictationSettingsManager.dictationSettings.dictationLanguage=
this.Sf.$T;alVoiceClient.DictationSettingsManager.dictationSettings.useAutoPunctuation=this.Sf.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings.useVoiceCommands=this.Sf.useVoiceCommands?"true":"false";alVoiceClient.DictationSettingsManager.dictationSettings.properties||(alVoiceClient.DictationSettingsManager.dictationSettings.properties={});alVoiceClient.DictationSettingsManager.dictationSettings.properties.Profanity=this.Sf.QAb?"masked":"raw";alVoiceClient.DictationSettingsManager.dictationSettings.properties["SpeechConfig-Context.DataCollection.Mode"]=
this.Sf.oji?this.SUn:this.aSn;this.EK&&(alVoiceClient.DictationSettingsManager.dictationSettings.properties.DictationInsertionPointLeft=this.EK.KNf(),alVoiceClient.DictationSettingsManager.dictationSettings.properties.DictationInsertionPointRight=this.EK.fIi())}Pbl(){if(this.Loa&&this.Sf.useVoiceCommands&&this.Sf.cjf){const M=new vc.a(Pc.a.vh());M.W("skipTelemetry",!0);this.Loa.executeCommand(32,M);this.Sf.cjf=!1}}}Object(u.a)(Lj,"AugloopSpeechClientProxy",null,[940]);class wm{constructor(M,fa,Va){this.ND=
M;this.Sf=fa;this.kwa=Va;this.pHb=0}W9c(M){const fa=new ra.a;fa.set(M);fa.zb(11);fa.kd(11);return!!fd.a.instance.resolve("Box4.List.IListReader").Uw(fa)}bpc(M){return M&&M.length?1<M.length?!0:(M=M.Qa)&&M.cpBegin!==M.cpEnd?!0:!1:!1}gAc(M){if(Array.contains(Ch.MMg,this.Sf.$T)){var fa="comma;period;new line;delete;bold that;start list;show help".split(";"),Va="default";switch(M){case 1:fa=["next line","delete that","indent","exit list"];Va="list";break;case 2:fa="delete capitalize lowercase uppercase bold underline italicize strikethrough".split(" "),
Va="selection"}this.ND.onCommandSuggestionsChanged(fa);this.kwa.onCommandSuggestionsChanged(this.Sf.Ygn,Va,fa)}}Wop(M){const fa=M?M.Qa?M.Qa.node:null:null;if(fa)switch(this.pHb){case 0:if(this.W9c(fa)||this.bpc(M))this.bpc(M)?(this.gAc(2),this.pHb=2):this.W9c(fa)&&(this.gAc(1),this.pHb=1);break;case 1:this.W9c(fa)||this.bpc(M)?this.bpc(M)&&(this.gAc(2),this.pHb=2):(this.gAc(0),this.pHb=0);break;case 2:this.W9c(fa)||this.bpc(M)?!this.bpc(M)&&this.W9c(fa)&&(this.gAc(1),this.pHb=1):(this.gAc(0),this.pHb=
0)}}}Object(u.a)(wm,"CommandSuggestionsManager",null,[]);class aj extends pd{constructor(M,fa){super();this.Sf=M;this.ki=(new Date).getTime();this.ee=fa;this.HOa=Kl.a.create().toString();this.Ji=new pb.a;this.Ji.dataFields=[];this.Mvd="Office.Voice.Online.DictationSession"}endActivity(){this.zpa+=this.MRa;this.qt=(new Date).getTime();this.Ji.succeeded=this.fxa;this.Ji.durationMs=this.qt-this.ki;this.Ji.dataFields.push(Object.assign(new tb.a,{name:"Success",bool:this.fxa}));this.fxa||this.Ji.dataFields.push(Object.assign(new tb.a,
{name:"error",string:this.C6b}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"SessionID",string:this.sessionID}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"SpeechSessionID",string:this.y8e}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TurnID",string:this.HOa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"NumberOfWords",int64:0<this.MRa?this.MRa+this.zpa:this.zpa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"NumberOfFragments",int64:this.t3a}));
this.Ji.dataFields.push(Object.assign(new tb.a,{name:"NumberOfFinalPhrases",int64:this.rGa}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"Language",string:this.Sf.$T}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"connectionID",string:this.CH}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"IsFrontdoor",bool:!0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"IsUsingFloatie",bool:!0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"UseAutoPunctuation",bool:this.Sf.useAutoPunctuation}));
this.Ji.dataFields.push(Object.assign(new tb.a,{name:"UseProfanityFilter",bool:this.Sf.QAb}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"EndReason",string:this.vAd}));this.iib&&this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TimeToGetFirstResult",int64:this.iib-this.Coa}));this.fxa&&(this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TimeToStartRecording",int64:this.fOc-this.ki})),this.Ji.dataFields.push(Object.assign(new tb.a,{name:"TimeToOpenConnection",int64:this.Coa-this.fOc})));
this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FocusLost",bool:this.cSe}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FocusLostWhileStarting",bool:this.pBd}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"FailedToStartTurn",bool:this.sRe}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AverageFragmentLatency",double:this.xia?this.xia.Nim():0<this.t3a?this.nJb/this.t3a:0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AveragePhraseLatency",double:this.xia?
this.xia.qti():0<this.rGa?this.oJb/this.rGa:0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AveragePhraseInsertionLatency",double:0<this.rGa?this.haf/this.rGa:0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"AverageFragmentInsertionLatency",double:0<this.t3a?this.fIh/this.t3a:0}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MaxTimeToInsertFragment",int64:this.CGd}));this.Ji.dataFields.push(Object.assign(new tb.a,{name:"MaxTimeToInsertPhrase",int64:this.DGd}));let M=
el.lwc;this.fxa&&0<this.zpa&&(M=0<this.rGa?el.Gpc:el.z2j);this.Ji.dataFields.push(Object.assign(new tb.a,{name:"DictationFunnel",contract:Object.assign(new ae,{name:"Office.System.Funnel",dataFields:[Object.assign(new tb.a,{name:"Name",string:"Dictation"}),Object.assign(new tb.a,{name:"State",string:M})]})}));this.Ji.name=this.Mvd;this.Ji.samplingPolicy=2;cb.a.sendActivityEvent(this.Ji)}}Object(u.a)(aj,"DictationSessionTelemetry",pd,[]);var sl=d(706);class yi{constructor(M,fa){this.Ijb=M;this.BAk=
fa}getAccessToken(M){this.BAk&&this.Ijb?this.Ijb.tV("OfficeDictation",z.AFrameworkApplication.J.jb("DictationResourceID")).then(fa=>{fa.IsSuccess?M(fa.Token):M(yi.iyf)}).catch(()=>{M(yi.iyf)}):M(yi.iyf)}}yi.iyf="dictation access token";Object(u.a)(yi,"AuthenticationProvider",null,[]);var Dk=d(557);class fi{constructor(M){this.ZAk=M;this.POd=new Dk.a}debugAssertTag(M,fa,Va,Fb){this.BGe(Fb);this.POd.debugAssertTag(M,fa,Va,Fb)}debugTraceTag(M,fa,Va,Fb){this.BGe(Fb);this.POd.debugTraceTag(M,fa,Va,Fb)}sendTraceTag(M,
fa,Va,Fb){this.BGe(Fb);this.POd.sendTraceTag(M,fa,Va,Fb)}shipAssertTag(M,fa,Va,Fb){this.BGe(Fb);this.POd.shipAssertTag(M,fa,Va,Fb)}BGe(M){if(this.ZAk){const fa=window.console;fa&&fa.log(`FDSpeechService: ${M}`)}}}Object(u.a)(fi,"FrontdoorExternalLogger",null,[219]);class Dg{constructor(){this.accessToken=null}}Object(u.a)(Dg,"IAuthenticationProvider",null,[]);class yk{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=
this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(u.a)(yk,"ISpeechConfig",null,[]);class Ym{constructor(M,fa,Va,Fb){var Vb;this.xq=this.mac=null;this.b9e=!1;this.EK=M;this.Sf=fa;this.Upa=Va;this.Eok=new yi(Fb,fa.Nin);M=new Ll(fa);null===(Vb=sb.a.A1b)||void 0===Vb?void 0:Vb.OAj(M)}jRi(M){return new Promise(fa=>{this.Eok.getAccessToken(Va=>{fa(this.j8m(M,Va))})})}j8m(M,
fa){this.xq=M;this.mac=this.createSpeechClient(this.GEl(),fa);return this.mac?0:(Na.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}async jzb(M){if(!this.mac)return 3;this.Upa.startDictationSession(this.xq,M);this.mac.startSpeechRecognition();return 0}async jqd(M){if(!this.b9e){this.b9e=!0;if(this.mac)try{this.mac.stopSpeechRecognition()}catch(fa){Na.ULS.shipAssertTag(593277727,394,!1,fa.message)}if(M&&this.Upa)this.Upa.onSpeechEnd();this.xq=null;this.b9e=!1}}BR(){return this.Upa.BR()}GEl(){const M=
new yk;M.speechMode="Dictation";M.sourceLanguage=this.Sf.$T;const fa=this.Sf.fri;fa&&""!==fa&&(M.speechFDBase=`wss://${fa}/`);M.properties=new Map;this.EK&&(M.properties.set("DictationInsertionPointLeft",this.EK.KNf()),M.properties.set("DictationInsertionPointRight",this.EK.fIi()));M.properties.set("Corrections","true");M.properties.set("punctuation",this.Sf&&this.Sf.useAutoPunctuation?"Intelligent":"Explicit");this.Sf.Bnc&&M.properties.set("EnableAudioLogging",this.Sf.Bnc.toString());switch(sl.a.uhf){case "Word":M.clientApp=
1;break;case "PowerPoint":M.clientApp=0;break;case "OneNote":M.clientApp=2}return M}createSpeechClient(M,fa){fa=Object.assign(new Dg,{accessToken:fa});const Va=new fi(this.Sf.Bnc);return(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(M,this.Upa,fa,null,Va)}}Object(u.a)(Ym,"FrontdoorSpeechClientProxy",null,[940]);var we=d(617),ri=d(253);class Tj{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd){this.nGb=this.fbc=!1;this.k4b=[];this.Wv=this.BFh=null;this.EK=M;this.LUi=fa;this.ga=Va;this.Mgb=Fb;this.Sf=
Vb;this.OY=wc;this.REc=Xc;this.HK=vd;this.yAh=new we.a;for(M=0;M<Tj.ux.length;M++)this.yAh.add(Tj.ux.charAt(M).toString())}onFinalPhrase(M,fa=null){var Va,Fb;let Vb=!0;const wc=fa?JSON.parse(fa).Id:void 0;if(this.Wv)this.Wv.onFinalPhrase(M);if(this.REc&&this.OY){var Xc=this.REc.oao(M);if(Xc){this.KUa(!1);this.HK&&this.HK.Oke(Xc.Nrj);M=new vc.a(Pc.a.vh());M.add("command",Xc);this.OY.executeCommand(Xc.commandId,M,wc);return}}if(!this.OY.lkn){Xc=(new Date).getTime();if(1===M.length&&"\n"===M)this.OY?
(this.KUa(!1),this.OY.executeCommand(35,null,wc),null===(Va=this.Wv)||void 0===Va?void 0:Va.onCommandCalled()):(this.X9d("",null),this.Fli());else{Va=M.indexOf("\n");const vd=2===M.length&&"\n\n"===M;for(0<Va&&Va!==M.length-1&&(Vb=!1);0<=Va;)this.X9d(M.substr(0,Va),Vb?fa:null),this.Fli(),M=M.substr(Va+1),Va=M.indexOf("\n"),Vb=!1;0===this.X9d(M,Vb?fa:null)&&this.OY&&(vd?(this.OY.gGn((new Date).getTime()-Xc,wc),null===(Fb=this.Wv)||void 0===Fb?void 0:Fb.onCommandCalled()):this.OY.sHn((new Date).getTime()-
Xc,wc))}if(this.Wv)this.Wv.onTextInserted(!0,(new Date).getTime()-Xc)}}onFragment(M){if(!this.OY.Ppn){if(this.fbc)var fa=this.Sf.ILg?this.nGb?this.F4c(M):M:this.F4c(M);else{if(!this.tAe())return;fa=this.nGb?this.F4c(M):M}if(this.Wv)this.Wv.onFragment(M);M=!0;var Va=(new Date).getTime();this.EK&&(fa=this.Sf.ILg?this.EK.C7k(fa):this.EK.B7k(fa),0!==fa&&(this.JLi(fa),M=!1));fa=(new Date).getTime();if(this.Wv)this.Wv.onTextInserted(!1,fa-Va);M&&this.OY&&this.OY.GZn()}}onRecordingStarted(){this.ga.Ob(Q.a.Afi,
2);if(this.Wv)this.Wv.onRecordingStarted()}onMicrophoneError(M=""){this.TLi(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,M)}isc(M){if(this.Wv)this.Wv.onCustomError(M);this.ga.Qb(Q.a.mwf,2,M)}Zij(M){if(this.Wv)this.Wv.onAugloopError(M);this.ga.Qb(Q.a.mwf,2,M);Mh.HTj()}pVn(M){this.isc(M);Mh.Y6o()}SXn(M){this.isc(M);Mh.y7o()}v5n(M){this.isc(M);Mh.gVj()}zga(M){this.Wv&&this.Wv.setEndReason(M);this.ga.Qb(Q.a.yfi,2,M)}C_n(M){this.zga(M);this.O9o()}B2n(){this.KUa(!1);this.ga.Ob(Q.a.Bfi,2);this.$Yl()}onConnectionStarted(M){if(this.Wv)this.Wv.onConnectionStarted(M)}heg(M){this.TLi(this.mAm(M),
M)}onFocusLost(){if(this.Wv)this.Wv.onFocusLost();this.ga.Ob(Q.a.ufi,2)}dpn(M){return"\u201c"===M||"("===M||"["===M||"{"===M}Ogn(M){return"\u201d"===M||")"===M||"]"===M||"}"===M}Ysn(M){return this.LUi&&!F.a.bga(M)&&!this.yAh.contains(M.toString())&&!this.Ogn(M.toString())}F4c(M){return 0<M.length&&this.Ysn(M.charAt(0))?" "+M:M}tAe(){if(this.fbc)return!0;if(this.EK){var M=this.EK.KNf();this.nGb=!1;M&&0<M.length&&(M=M.charAt(M.length-1),this.nGb=!F.a.bga(M)&&!this.dpn(M.toString()));return this.fbc=
this.EK.tAe()}if(this.Wv)this.Wv.onFailedToStartTurn();this.OY&&this.OY.N1n();return!1}KUa(M){this.nGb=this.fbc=!1;this.EK&&(M&&this.EK.ROn(),this.EK.KUa())}onSpeechSessionStarted(M){if(this.Wv)this.Wv.onSpeechSessionStarted(M);this.IBg(M);this.BFh=M}TLi(M,fa=""){if(this.Wv)this.Wv.onMicrophoneError(fa);this.ga.Ob(Q.a.wfi,2);Mh.W8o(M)}onAudioData(M){this.Sf.sxc&&this.k4b.push(...(M||[]))}mAm(M){M=M.trimStart();return M.startsWith("NotAllowedError")||M.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:
M.startsWith("NotFoundError")||M.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:M.startsWith("NotReadableError")||M.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}O9o(){this.Mgb&&this.Mgb.execute(M=>{M.N7o()})}IBg(M){if(this.Sf.Bnc||this.Sf.sxc){var fa=this.Sf.sxc?Box4Intl.Box4Strings.L_DictationDataCollectionNotice:`ServiceSessionID:${M} ClientSessionId: ${this.etl}`;
this.Mgb&&this.Mgb.execute(Va=>{Va.IBg(fa)});if(this.Sf.sxc)this.onFinalPhrase(`\n\n<SpeechSessionId= ${M}, TimeStamp=${(new Date).toUTCString()}/>\n`,null)}}X9d(M,fa){if(!this.fbc&&!this.tAe())return 1;var Va=9;this.EK&&(Va=this.nGb?this.F4c(M):M,Va=Object(ri.a)(939,this.EK)?this.EK.cSi(Va,fa,0<M.length&&M.charAt(0)!==Va.charAt(0)):this.EK.van(this.nGb?this.F4c(M):M),0!==Va?this.JLi(Va):this.OY.qWo());this.KUa(!0);return 0===Va?0:1}JLi(M){if(this.Wv)this.Wv.onTextInsertionError(M);this.ga.Qb(Q.a.Dfi,
2,M)}Fli(){this.ga.Ob(Q.a.vE,2)}get etl(){return sb.a.hI?sb.a.hI.sessionID:""}$Yl(){if(this.Sf.sxc&&this.k4b.length){var M=this.Mfm();this.KLo(M);this.k4b=[]}}KLo(M){M=new Blob([new Int8Array(M)],{type:"audio/wav"});const fa=document.createElement("a");fa.href=URL.createObjectURL(M);fa.setAttribute("download",`${this.BFh}.wav`);document.body.appendChild(fa);fa.click();document.body.removeChild(fa)}Mfm(){var M=this.MRm();const fa=this.Eim(this.k4b),Va=Array(M.length+fa.length);let Fb=0;for(let Vb=
0;Vb<M.length;Vb++)Va[Fb++]=M[Vb];for(M=0;M<fa.length;M++)Va[Fb++]=fa[M];return Va}MRm(){const M=Array(44);this.TNg(M,0,"RIFF");this.qud(M,4,M.length+2*this.k4b.length);this.TNg(M,8,"WAVEfmt ");this.qud(M,16,16);this.rud(M,20,1);this.rud(M,22,1);this.qud(M,24,16E3);this.qud(M,28,32E3);this.rud(M,32,2);this.rud(M,34,16);this.TNg(M,36,"data");this.qud(M,40,2*this.k4b.length);return M}TNg(M,fa,Va){for(let Fb=0;Fb<Va.length;Fb++)M[fa+Fb]=Va.charCodeAt(Fb)}qud(M,fa,Va){for(let Fb=0;4>Fb;Fb++){const Vb=
Va&255;M[fa+Fb]=Vb;Va=(Va-Vb)/256}}rud(M,fa,Va){for(let Fb=0;2>Fb;Fb++){const Vb=Va&255;M[fa+Fb]=Vb;Va=(Va-Vb)/256}}Eim(M){const fa=Array(2*M.length);for(let Va=0;Va<M.length;Va++)this.rud(fa,2*Va,M[Va]);return fa}}Tj.ux='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u0964';Object(u.a)(Tj,"SpeechClientObserverController",null,[]);class vf{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa){this.REc=this.Loa=this.HK=this.xq=this.alb=null;this.wua=(yb,Ub)=>{2===this.BR()&&this.Sf.useVoiceCommands&&
this.Zqk.Wop(Ub.Rm.currentSelection)};this.OD=M;this.xtk=fa;this.ib=Va;this.Mgb=Fb;this.ee=Vb;this.Sf=wc;this.Ijb=ea;this.dMd=Xa;this.REc=Dd;this.HK=Xc;this.Sf.BEa&&(this.Loa=vd);this.kwa=Ce;this.Zqk=new wm(this.HK,this.Sf,this.kwa)}hqg(){this.ib.AB(this.wua)}JJg(){this.ib.gna(this.wua)}async jzb(){this.Mgb&&this.Mgb.execute(fa=>fa.y0m());var M=0;if(!this.alb){M=Date.now();await this.vCn();M=Date.now()-M;const fa=this.BKl();if(0!==fa)return fa}this.xq=new aj(this.Sf,this.ee);this.Sf.BEa&&(this.xq=
new Yg(this.Sf,this.ee));this.Sf.Ffi&&this.xq.setAsyncScriptLoadDuration(M);M=await this.alb.jRi(this.xq);return 0!==M?M:await this.alb.jzb(this.d4i())}updateTooltipTelemetry(M,fa){this.Sf.BEa&&this.xq&&this.xq.updateTooltipTelemetry(M,fa)}vCn(){return this.Sf.BEa?this.s7i("alVoiceClient",!0):this.s7i("PPTSpeechClient")}s7i(M,fa=!1){return!fa&&this.dMd?(fa=z.AFrameworkApplication.mC(M,2),wl.a(this.dMd.yqc(fa))):this.OD?z.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(M):
this.OD.loadScript(M):new Promise((Va,Fb)=>{Na.ULS.sendTraceTag(573682464,394,10,`Unable to load speech client script "${M}" due to missing SharedDependencyScriptLoader`);Fb("Unable to load speech client "+M)})}async jqd(M=!0,fa=null){this.BR()&&(this.xq&&void 0!==fa&&null!==fa&&this.xq.setEndReason(fa),this.alb&&await this.alb.jqd(M),this.xq&&(this.xq.endActivity(),this.xq=null),this.kwa&&(this.kwa.U1f=null))}BR(){return this.alb?this.alb.BR():0}Y0f(){return this.Loa.Y0f()}d4i(){return"zh-CN"!==
this.Sf.$T&&"ja-JP"!==this.Sf.$T}BKl(){var M=this.xtk.value;if(!M)return 4;var fa=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationTextRangeChanged",!0);M=M.pFl(fa);fa=new Tj(M,this.d4i(),z.AFrameworkApplication.va,this.Mgb,this.Sf,this.Loa,this.REc,this.HK);this.alb=this.Sf.BEa?new Lj(M,this.HK,this.Loa,2,this.ib,this.kwa,fa,this.Sf):new Ym(M,this.Sf,new bk(this.HK,fa),this.Ijb);return 0}}Object(u.a)(vf,"DictationManager",null,[]);var ff=d(507);const Kf="ErrorAudioCaptureAsync ErrorConnectionRetryFailure ExitDictationCommand FloatieDismissed FloatieMicButton focusLostWhileStarting KeyboardShortcut NotAllowedError NotFoundError NotReadableError OnDictationFocusLost OnPauseDictationCommand RibbonClicked SpeechRecognitionStopped".split(" ");
class Rg{constructor(M){this.o3e=[];this._sessionID="";this.SGd=[];this.Sf=M;this.HOa="";this.vfi=ff.a.getInstance({topLevelKpiName:"Dictation",featureName:"Dictation",crewAlias:"inconcerteng",vetoPillar:"ContentCreation"})}pAe(){this._sessionID=Kl.a.create().toString();this.o3e=[];this.SGd=[];this.vhc=void 0}Pl(){this.jEn();this._sessionID=""}TYk(M){this.o3e.push(M)}get sessionID(){return this._sessionID}get Vsj(){return this.o3e}cop(M){this.SGd.push(M)}Znp(M){Kf.includes(M)||this.vhc||(this.vhc=
M)}jEn(){var M=!1;let fa=!1;for(const Va of this.SGd)M=M||Va.y_m,fa=fa||Va.ADp;0!==this.SGd.length||this.vhc||(this.vhc="FailedToStart");M=new Map([["dictationSessionId",this._sessionID],["dictationLanguage",this.Sf.$T],["hasWords",M.toString()],["usedCommands",fa.toString()]]);this.vhc?this.vfi.logKpiFailure({kpiName:"dictationSession",errorName:this.vhc,optionalProperties:{additionalValues:{extendedProperties:M}}}):this.vfi.logKpiSuccess({kpiName:"dictationSession",optionalProperties:{additionalValues:{extendedProperties:M}}})}}
Object(u.a)(Rg,"DictationSessionInfo",null,[914]);var ob=d(236);class Nb{constructor(M){this.utk="Office.Voice.Online.DictationAlLifeEvent";this.A8g=M}onDictationStarted(){this.A8g.gNa(this)}onDictationStopped(){this.A8g.eup(this)}onSessionClose(){this.Grf("OnSessionClose")}onSessionConnect(){this.Grf("OnSessionConnect")}onSessionDisconnect(){this.Grf("OnSessionDisconnect")}Grf(M){cb.a.sendTelemetryEvent(Object.assign(new ob.a,{name:this.utk,dataFields:[Object.assign(new tb.a,{name:M,bool:!0})]}))}}
Object(u.a)(Nb,"DictationAlLifeEventObserver",null,[374]);class cc{constructor(M,fa,Va,Fb,Vb,wc,Xc){this.iPd=this.Clb=!1;this.hMd=null;this.obf=this.pRc=!1;this.B9="";this.J9g="AutoShowHelpPane";this.dFh="QuickAccessInterface";this.JSc=this.UFc=null;this.Awk="f42aa342-8706-4288-bd11-ebb85995028c";this.YJk="87867195-f2b8-4ac2-b0b6-6bb73cb33afc";this.Aa=M?M:z.AFrameworkApplication.J;this.gW=fa?fa:Fd.a.instance;this.LK=Va;this.ib=Fb;this.RLd=Vb;this.Y5b=Xc;wc&&(this.JSc=new Nb(wc))}get useAutoPunctuation(){var M,
fa;if(!this.$Ui)return!1;if(this.ZUi&&!this.iPd&&this.Qod)return!0;if(this.iPd)return this.Mtb?null===(M=this.Y5b)||void 0===M?void 0:M.z5d(0,this.Clb):this.Clb;M=this.gW.getItem("WACDictationFUseAutoPunctuation");this.Clb=void 0===M||null===M?Array.contains(Ch.Fbl,this.$T):Boolean.parse(M);this.iPd=!0;return this.Mtb?null===(fa=this.Y5b)||void 0===fa?void 0:fa.z5d(0,this.Clb):this.Clb}set useAutoPunctuation(M){var fa;this.$Ui&&(this.Clb=M,this.iPd=!0,this.ZUi&&!1===M&&this.Qod&&(this.Qod=!1),this.Mtb&&
(null===(fa=this.Y5b)||void 0===fa?void 0:fa.sNj(this.Clb,0)),this.gW.setItem("WACDictationFUseAutoPunctuation",this.Clb.toString()))}get QAb(){if(!this.D0i)return!0;if(this.obf)return this.pRc;const M=this.gW.getItem("WACDictationFUseProfanityFilter");this.pRc=void 0===M||null===M?!0:Boolean.parse(M);this.obf=!0;return this.pRc}set QAb(M){this.D0i&&(this.pRc=M,this.obf=!0,this.gW.setItem("WACDictationFUseProfanityFilter",this.pRc.toString()))}get useVoiceCommands(){const M=this.Kvn;return M?this.Aa.$("WacBox4DictationVoiceCommandingDefaultOnIsEnabled")&&
M:!1}get nze(){const M=this.gW.getItem(this.dFh);return void 0===M||null===M?!0:Boolean.parse(M)}set nze(M){this.gW.setItem(this.dFh,M.toString())}get AYc(){this.UFc||(this.UFc=this.gW.getItem("WACDictationDefaultMicDeviceId"));return this.UFc}set AYc(M){this.UFc=M;this.gW.setItem("WACDictationDefaultMicDeviceId",this.UFc)}get cjf(){const M=this.gW.getItem(this.J9g);return void 0===M||null===M?!0:Boolean.parse(M)}set cjf(M){this.gW.setItem(this.J9g,M.toString())}get $Ui(){return Array.contains(Ch.Gbl,
this.$T)}get D0i(){return Array.contains(Ch.Ijo,this.$T)}get Kvn(){return this.BEa&&Array.contains(Ch.MMg,this.$T)}get $T(){var M,fa;if(""!==this.B9)return this.Mtb?null===(M=this.Y5b)||void 0===M?void 0:M.z5d(1,this.B9):this.B9;M=this.gW.getItem("WACDictationLanguage");this.B9=void 0===M||null===M?this.Epm():M;return this.Mtb?null===(fa=this.Y5b)||void 0===fa?void 0:fa.z5d(1,this.B9):this.B9}set $T(M){var fa;M&&""!==M&&(this.B9=M,this.Mtb&&(null===(fa=this.Y5b)||void 0===fa?void 0:fa.sNj(this.B9,
1)),this.gW.setItem("WACDictationLanguage",this.B9))}get a_f(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationPreviewLanguage",!1)}get Mtb(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationRoamingSettings",!1)}get jDp(){return this.Aa.$("WacBox4DictationInternalArticle")}get fri(){return this.Aa.jb("DictationFrontdoorDomain")}get Dif(){return this.Aa.jb("DictationAsrDomain")}get iDg(){let M=",",fa=this.Aa.jb("SpeechFlightId");fa||(M=fa="");const Va=
this.Aa.getStringFeatureGate("Microsoft.Office.SharedOnline.SpeechFlight","");""!=Va&&(fa+=M+Va,M=",");this.asn&&(fa+=M+"offtrt");return fa}get asn(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SegmentationV3SpeechFlight",!1)}get ZUi(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAutoPunctuationByDefault",!1)}get AXi(){return this.Aa.$("WacBox4DictationExpandedFloatie")}get Tqn(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.Voice.EnableReadBackCommand",
!1)}get atn(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.Voice.DictationSpellOutCommand",!1)}get Zjn(){return this.Aa.$("WacBox4DictationExperimentalVoiceCommandSetIsEnabled")}get Pin(){return z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationFloatieReposition",!1)}get Svn(){return z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.Voice.EnableWhatCanISayDiscoveryCommand",!1)}get BEa(){return this.Aa.$("WacBox4DictationUseAugloopServiceWithFrontdoor")||
this.sxc}get ILg(){return this.Aa.$("WacBox4DictationUseHypothesis")&&this.BEa}get Nin(){return this.Aa.$("WacDictationAuthenticationEnabled")}get Bnc(){return this.Aa.$("DictationDebugModeEnabled")}get omg(){return this.tNf(Ch.Hjo)}get $kg(){return this.tNf(Ch.Sgo)}get Mhd(){return this.tNf(Ch.Mhd)}get oXf(){return D.a.ZAe&&this.Aa.$("UserCanUseDictation")}get sxc(){return this.Aa.$("DictationDumpAudioFileEnabled")}get nic(){return this.qwi("WACDictationFirstSeen")}set nic(M){this.pNj("WACDictationFirstSeen",
M)}get Pad(){return this.qwi("WACDictationLastSeen")}set Pad(M){this.pNj("WACDictationLastSeen",M)}pNj(M,fa){void 0!==fa&&null!==fa&&fa.getTime()?(fa=fa.toISOString(),this.gW.setItem(M,fa)):this.gW.removeItem(M)}qwi(M){M=this.gW.getItem(M);return void 0===M||null===M?null:new Date(M)}tNf(M){const fa=[];for(const Va of M)fa.push(new Al(Va));fa.sort((Va,Fb)=>Va.displayName.localeCompare(Fb.displayName));return fa}Epm(){if(this.LK&&this.ib){const M=this.LK.iKa(this.ib.Pg);for(const fa of this.omg)if(fa.LCID===
M)return fa.languageTag;for(const fa of this.$kg)if(fa.LCID===M)return fa.languageTag;if(this.a_f)for(const fa of this.Mhd)if(fa.LCID===M)return fa.languageTag}return Ch.DOl}get sensitivityLabel(){if(!this.Aa.$("DictationServiceLoggingEnabled")||!this.RLd)return"";const M=this.RLd.value;return M?M.Gxm():""}get oji(){if(!this.Aa.$("DictationServiceLoggingEnabled")||!this.RLd)return!1;var M=this.RLd.value;if(!M)return!1;M=M.Ixm();return M===this.YJk||M===this.Awk}get Ygn(){return this.Aa.$("WacBox4DictationCommandSuggestionsEnabled")}get Ffi(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationUserPerceivedLatencies",
!0)}get Qod(){if(null===this.hMd){const M=this.gW.getItem("WACDictationEnableAutoPunctuationForSmartSegmentation");null===M||void 0===M?(this.Qod=!0,Na.ULS.sendTraceTag(509203217,394,20,"Auto-punctuation enabled for dictation language:{0}",this.B9)):this.hMd=Boolean.parse(M)}return this.hMd}set Qod(M){this.gW.setItem("WACDictationEnableAutoPunctuationForSmartSegmentation",M.toString());(this.hMd=M)||Na.ULS.sendTraceTag(509203216,394,20,"Auto-punctuation disabled for dictation language:{0}",this.B9)}}
Object(u.a)(cc,"DictationSettings",null,[]);var Lc=d(801);class Uc{constructor(M,fa,Va,Fb){this.kPe=!1;this.kcf="";this.d$e=new Map;this.qbf=new Set;this.vGh=new Set;this.dw=M;this.NK=fa;this.auh=Va;this.gW=Fb;this.a7m()}sNj(M,fa){const Va=this.tGi(fa),Fb=this.uGi(fa),Vb=this.fum(fa,M);this.dw.wna("setDictationSetting",Vb);Na.ULS.sendTraceTag(521417240,394,50,`Try to save ${Fb} setting value to Roaming Service.`);this.qbf.add(fa);this.AYh(fa,M);this.NK&&this.NK.H4(Va,new Lc.a(Va,Vb))}z5d(M,fa){switch(M){case 0:return this.K1i(M)||
(this.kPe=fa),this.kPe;case 1:return this.K1i(M)||(this.kcf=fa),this.kcf}}BFi(M){switch(M){case 0:return this.Umi(M);case 1:return this.Umi(M)}}a7m(){this.d$e.set(0,this.BFi(0));this.d$e.set(1,this.BFi(1))}K1i(M){return this.d$e.get(M).isCompleted&&this.vGh.has(M)||this.qbf.has(M)}AYh(M,fa){this.auh.has(M)&&this.gW.setItem(this.auh.get(M),fa.toString());switch(M){case 0:this.kPe=fa;break;case 1:this.kcf=fa}}mIm(M,fa){switch(M){case 0:return fa.Qbp.d5k;case 1:return fa.$Tl}}Umi(M){const fa=this.uGi(M);
return this.NK.Wcb(this.tGi(M)).CWRCo(Va=>{if(Va.Zo||Va.Yi||6!==Va.status)Na.ULS.sendTraceTag(521417243,394,15,`Failed to get ${fa} setting options from Roaming Service. Task status: ${Va.status}.`);else if(Va=JSON.parse(Va.result))Va.code&&5010===Va.code?Na.ULS.sendTraceTag(521417242,394,15,`Failed to get ${fa} setting options from Roaming Service. Code: ${Va.code}. Message: ${Va.message}.`):(Va.code&&Na.ULS.sendTraceTag(521413568,394,50,`Getting ${fa} setting options from Roaming Service. Code returned: ${Va.code}. Message: ${Va.message}.`),
Va=this.mIm(M,Va),null===Va||void 0===Va?Na.ULS.sendTraceTag(521412703,394,15,`Failed to get ${fa} setting options from Roaming Service. Returned ${Va}.`):this.qbf.has(M)?Na.ULS.sendTraceTag(521410274,394,50,`User already set ${fa}.`):(this.AYh(M,Va),Na.ULS.sendTraceTag(521417241,394,50,`Loaded ${fa} setting options from Roaming Service successfully`),this.vGh.add(M)))},8)}tGi(M){switch(M){case 0:return zg.a.NMg;case 1:return zg.a.rNg}}uGi(M){switch(M){case 0:return"dictationAllowAutoPunctuation";
case 1:return"wordDictationLanguage"}}fum(M,fa){switch(M){case 0:return JSON.stringify({Qbp:{d5k:fa}});case 1:return JSON.stringify({KWp:"Word",$Tl:fa})}}}Object(u.a)(Uc,"DictationRoamingSettingInfo",null,[913]);class sd{constructor(M,fa,Va){this.pPe=this.qPe=this.oPe=this.XCd=!1;this.d4e="";this.osh=0;this.l5=M;this.Sf=fa;this.ND=Va}E3(){}C3(M){var fa=O.a.instance.currentSelection;fa=fa?fa.Qa?fa.Qa:null:null;if(!this.XCd&&2===M.behavior&&32===M.response){switch(M.actionId){case Q.a.undo:this.MVo();
break;case Q.a.bold:qf.UNa("Bold")||qf.fOf(fa,"Bold");break;case Q.a.fA:qf.UNa("Italics")||qf.fOf(fa,"Italics");break;case Q.a.Mhf:this.oPe=!0;break;case Q.a.MDe:this.qPe=!0;break;case Q.a.nFg:this.pPe=!0;break;case Q.a.$E:case Q.a.KN:this.oPe?this.oPe=!1:this.qPe?this.qPe=!1:this.pPe&&(this.pPe=!1);break;case Q.a.rY:case Q.a.sca:this.tvm(M.rd);break;case Q.a.hx:this.Ctm(M.rd)}fa=this.zBm(M);""!==fa&&5!=M.b3&&this.FLb(fa)}}zBm(M){if(!qf.uZf())return"";switch(M.actionId){case Q.a.underline:if(qf.UNa("Underline"))break;
return"underline";case Q.a.strikethrough:if(qf.UNa("Strikethrough"))break;return"strikethrough";case Q.a.subscript:if(qf.UNa("Subscript"))break;return"subscript";case Q.a.superscript:if(qf.UNa("Superscript"))break;return"superscript";case Q.a.Sya:qf.UNa("Capitalize");break;case Q.a.aIa:qf.UNa("Lowercase");break;case Q.a.bIa:qf.UNa("Uppercase");break;case Q.a.pC:return"set font size to "+M.rd.rd/2;case Q.a.O7:return"align left, left align";case Q.a.t8:return"align right, right align";case Q.a.X$:return"align center, center align";
case Q.a.eR:return"increase Indent";case Q.a.KI:return"decrease Indent";case Q.a.zT:if(M=M.rd,["Title","heading 1","heading 2","heading 3"].includes(M))return`apply style ${M.toLowerCase()}`}return""}FLb(M){""!==M&&this.G5o(M)&&this.opl()&&this.ND.showDictationInfo(M)}MVo(){this.XCd||(this.XCd=!0,window.setTimeout(()=>{this.XCd=!1},10))}G5o(M){const fa=(new Date).getTime();return this.d4e!==M||this.d4e===M&&4E3<=fa-this.osh?(this.d4e=M,this.osh=fa,!0):!1}opl(){return!this.l5.Y0f()&&2===this.l5.BR()&&
this.ND&&this.ND.isVisible()&&this.Sf.useVoiceCommands&&Array.contains(Ch.MMg,this.Sf.$T)?!0:!1}tvm(M){tc.a.Nvc(M)}Ctm(M){tc.a.Nvc(M)}}Object(u.a)(sd,"SpecialActionEventListener",null,[119]);class id{constructor(){this.jPe=this.Z=null}get name(){return"Box4.Dictation"}wc(M){this.Z=M;const fa=fd.a.instance.Oa("Common.IDynamicScriptLoaderProvider");let Va=null;fa&&(Va=fa.OD);const Fb=fd.a.instance.nf("Box4.Dictation.IDictationHostFactory"),Vb=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationRoamingSettings",
!1);if(Vb){const vd=new Map;vd.set(0,"WACDictationFUseAutoPunctuation");this.Z.ia("Box4.Dictation.DictationRoamingSettingInfo",()=>new Uc(M.resolve("Box4.IRoamingServiceRequestManager"),M.resolve("Box4.RoamingSetting.IRoamingSettingCache"),vd,Fd.a.instance)).as("Box4.Dictation.IDictationRoamingSettingInfo").ha()}this.Z.ia("Box4.Dictation.DictationSettings",()=>new cc(this.Z.resolve("Common.IAppSettingsManager"),Fd.a.instance,this.Z.resolve("Box4.ILanguageReader"),this.Z.resolve("Box4.ISelectionManager"),
this.Z.nf("Box4.Dictation.IDictationSensitivityProvider"),this.Z.Oa("Box4.AugmentationLoop.IAlSessionLifeEventNotifier"),Vb?this.Z.Oa("Box4.Dictation.IDictationRoamingSettingInfo"):void 0)).ha();const wc=fd.a.instance.nf("Common.IDictationFloatieController");this.Z.ia("Box4.Dictation.DictationFloatieManager",()=>new Km(wc,this.Z.resolve("Box4.Dictation.DictationSettings"))).ha();this.Z.ia("Box4.Dictation.DictationManager",()=>new vf(Va,Fb,this.Z.resolve("Box4.ISelectionManager"),M.Ta("Box4.IBusinessBarController"),
M.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Z.resolve("Box4.Dictation.DictationSettings"),this.Z.resolve("Box4.Dictation.DictationFloatieManager"),this.Z.Oa("Box4.DictationCommands.IDictationCommandManager"),this.Z.Oa("Box4.DictationCommands.IDictationCommandParser"),this.Z.Oa("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Z.resolve("Common.App.OAuth.IOAuthManager"),this.Z.resolve("Common.ISharedDependencyLoader"))).ha();this.Z.ia("Box4.Dictation.IDictationSessionInfo",
()=>new Rg(this.Z.resolve("Box4.Dictation.DictationSettings"))).ha();this.Z.ia("Box4.Dictation.DictationFloatieSettingInfo",()=>new Cg(M.resolve("Box4.IRoamingServiceRequestManager"),M.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("Box4.Dictation.IDictationFloatieSettingInfo").ha();const Xc=this.Z.resolve("Box4.Dictation.DictationSettings");this.Z.ia("Box4.Dictation.SpecialActionEventListener",()=>new sd(this.Z.resolve("Box4.Dictation.DictationManager"),Xc,this.Z.resolve("Box4.Dictation.DictationFloatieManager"))).ha()}init(){this.Z.resolve("Box4.Dictation.IDictationSessionInfo");
this.jPe=qf.createInstance(this.Z.nf("Common.IRibbonButtonUpdater"),this.Z.resolve("Box4.Dictation.DictationManager"),this.Z.resolve("Box4.IFormattingEditor"),this.Z.resolve("Box4.IFormattingReader"),this.Z.resolve("Box4.Dictation.DictationFloatieManager"),this.Z.resolve("Box4.Dictation.DictationSettings"),this.Z.nf("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),cf.FocusManager.instance(),this.Z.Oa("Box4.Dictation.IDictationFloatieSettingInfo"),this.Z.resolve("Box4.IEditingDomManager"),this.Z.resolve("Box4.ICaretPositionManager"),
this.Z.resolve("Box4.BackspaceDeleteEventSource"),this.Z.resolve("Box4.IInsertionPointFormatting"),this.Z.resolve("Box4.Dictation.SpecialActionEventListener"));this.jPe.Xb();U.StaticActiveAppFrame.za().Ge();z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",!1)||this.jPe.PZk()}dispose(){}}Object(u.a)(id,"DictationPackageManager",null,[0,1]);var Ld=d(127);class ne{constructor(){this.returnFocusToCanvas=this.notifyDictationFloatieDismissed=this.onDictationToggleButtonClicked=
null}}Object(u.a)(ne,"DictationFloatieUIProps",null,[]);var kf=d(196),vg=d(1608);class Sh{constructor(){this.zPe=this.U$e=0;this.zFa=null;this.m5=!1;this.c5n=()=>{this.U$e&&z.AFrameworkApplication.va.Ob(this.U$e,2)};this.uZn=()=>{this.zPe&&z.AFrameworkApplication.va.Ob(this.zPe,2)};this.returnFocusToCanvas=()=>{cf.FocusManager.instance().Gg(Vj.AFrame.Do)}}get Ign(){return Ld.a.get_instance().isCompleted(7)}i8m(){return new Promise((M,fa)=>{this.Ign?this.m5?M(null):kf.UISurfaces.Oaa().then(Va=>{Va.loadDictationResources().then(()=>
{Va.initializeDictationUI(this.cqm(),Object.assign(new ne,{onDictationToggleButtonClicked:this.c5n,notifyDictationFloatieDismissed:this.uZn,returnFocusToCanvas:this.returnFocusToCanvas}));this.m5=!0;M(null)}).catch(()=>{fa("failed to load dictation resources")});return null}).catch(()=>{fa("failed to load dictation-floatie script")}):fa("Chrome not ready!")})}showDictationFloatie(M,fa,Va,Fb=!1){this.m5&&kf.UISurfaces.Oaa().then(Vb=>{appChrome.api.dispatch(Vb.showDictationFloatie(M,fa,Va,Fb));return null})}dismissDictationFloatie(){this.m5&&
kf.UISurfaces.Oaa().then(M=>{appChrome.api.dispatch(M.dismissDictationFloatie());return null})}switchDictationFloatieView(M){this.m5&&kf.UISurfaces.Oaa().then(fa=>{appChrome.api.dispatch(fa.switchDictationFloatieView(M));return null})}Ebg(){this.m5&&kf.UISurfaces.Oaa().then(M=>{appChrome.api.dispatch(M.onDictationStarting());return null})}Fbg(){this.m5&&kf.UISurfaces.Oaa().then(M=>{appChrome.api.dispatch(M.onDictationStopped());return null})}Dbg(){this.m5&&(z.AFrameworkApplication.$c("DictationFloatieUIV3SharedTreatment;DictationFloatieUIV3SharedCF"),
kf.UISurfaces.Oaa().then(M=>{appChrome.api.dispatch(M.onDictationStarted());return null}))}Nbg(){this.m5&&kf.UISurfaces.Oaa().then(M=>{appChrome.api.dispatch(M.onUserSpeaking());return null})}Rke(){this.m5&&kf.UISurfaces.Oaa().then(M=>{appChrome.api.dispatch(M.onSilence());return null})}showDictationWarning(M){this.m5&&kf.UISurfaces.Oaa().then(fa=>{appChrome.api.dispatch(fa.showDictationWarning(M));return null})}showDictationInfo(M){this.m5&&kf.UISurfaces.Oaa().then(fa=>{appChrome.api.dispatch(fa.showDictationInfo(M));
return null})}Oke(M){this.m5&&kf.UISurfaces.Oaa().then(fa=>{appChrome.api.dispatch(fa.onDictationCommandHeard(M));return null})}focus(){this.m5&&kf.UISurfaces.Oaa().then(M=>{M.focus();return null})}blur(){this.m5&&kf.UISurfaces.Oaa().then(M=>{M.blur();return null})}P_o(M){this.U$e=M}JUo(M){this.zPe=M}onCommandSuggestionsChanged(M){this.m5&&kf.UISurfaces.Oaa().then(fa=>{appChrome.api.dispatch(fa.onCommandSuggestionsChanged(M));return null})}onDictationLanguageChanged(M){this.m5&&kf.UISurfaces.Oaa().then(fa=>
{appChrome.api.dispatch(fa.onDictationLanguageChanged(M));return null})}cqm(){if(this.zFa)return this.zFa;this.zFa=vg.a("div");this.zFa.id="ReactDictationFloatieDiv";this.zFa.style.position="absolute";const M=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DictationFloatieUIV3",!1)||z.AFrameworkApplication.J.$("WacBox4DictationFloatieUIV3IsEnabled"),fa=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DictationFloatieReposition",!1);M&&fa?
(this.zFa.style.right="0",this.zFa.style.top="0",this.zFa.style.bottom="0",document.getElementById("WACDocumentPanelContent").appendChild(this.zFa)):document.body.insertBefore(this.zFa,document.body.firstChild);return this.zFa}}Object(u.a)(Sh,"DictationFloatieController",null,[1816]);var Ei=d(1573),pj=d(36);class Ed{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce){this.Od=null;this.Tu=this.Yk=-1;this.DQa=!1;this.Aaf=new Sys.StringBuilder;this.ekb="";this.TEb=this.cDb=!1;this.Rd=M;this.ib=fa;this.ga=Va;this.pGc=
vd;this.Wn=Fb;this.Bwa=Vb;this.jMd=Xc;this.lDd=!1;this.oB=wc;this.kDb=Dd;this.CEh=Ce}get vu(){return this.Tu}set vu(M){this.Tu=M}get cpEnd(){return this.Yk}set cpEnd(M){this.Yk=M}KNf(){return this.hIi(!1)}fIi(){return this.hIi(!0)}tAe(){this.Od&&this.KUa();const M=this.ib.gb.currentSelection;if(M){const fa=M.Qa;if(fa&&R.ParagraphReader.Wb(fa.node))return this.Od=fa.node,this.Tu=M.Qa.zj,this.Yk=M.Qa.Po,this.DQa=!0,this.Aaf.clear(),!0}return!1}KUa(){this.Ckd();this.Od=null;this.DQa=!1;this.Yk=this.Tu=
-1;this.ekb="";this.TEb=this.cDb=!1}B7k(M){let fa=1;if(this.Od){const Va=new pj.GraphTransaction(15);try{Va.Ab(this.Od);Va.Ph=Q.a.ZYc;if(!this.DQa&&this.qig())return this.Ckd(),4;const Fb=this.DQa&&this.Tu!==this.Yk?E.a.createTextRange(this.Od,this.Tu,this.Yk):E.a.Uc(this.Od,this.Yk);this.Rd.We(Fb,M,this.pGc);this.Yk=this.DQa?this.Tu+M.length:this.Yk+M.length;this.oB&&this.oB.S5c()&&this.oB.Ihf(E.a.createTextRange(this.Od,this.Tu,this.Yk));this.jNh();const Vb=Pa.SelectionFactory.ue(this.Od,this.Yk);
this.ib.Kc(Vb);this.DQa=!1;this.Aaf.append(M);return 0}catch(Fb){Na.ULS.sendTraceTag(520734415,394,10,`FragmentRandomException: ${Fb.message}`),fa=3}finally{Va&&Va.dispose()}}else fa=2,Na.ULS.sendTraceTag(590213576,394,15,"AppendTextFragment _paragraphNode is null.");return fa}C7k(M){let fa=5;if(this.Od){const Va=new pj.GraphTransaction(15);try{Va.Ab(this.Od);Va.Ph=Q.a.ZYc;if(!this.DQa)if(this.CEh)this.Efi()&&(this.cDb&&this.Q6j(),this.TEb&&this.R6j());else if(this.qig())return this.Ckd(),8;const Fb=
this.Tu!==this.Yk?E.a.createTextRange(this.Od,this.Tu,this.Yk):E.a.Uc(this.Od,this.Yk);this.Rd.We(Fb,M,this.pGc);this.Yk=this.Tu+M.length;this.oB&&this.oB.S5c()&&this.oB.Ihf(E.a.createTextRange(this.Od,this.Tu,this.Yk));this.jNh();const Vb=Pa.SelectionFactory.ue(this.Od,this.Yk);this.ib.Kc(Vb);this.DQa=!1;this.ekb=R.ParagraphReader.text(this.Od);this.TEb=this.cDb=!1;return 0}catch(Fb){Na.ULS.sendTraceTag(520734414,394,10,`HypothesisRandomException: ${Fb.message}`),fa=7}finally{Va&&Va.dispose()}}else fa=
6,Na.ULS.sendTraceTag(590213577,394,15,"AppendTextHypothesis: _paragraphNode is null.");return fa}van(M){return this.cSi(M,null,!1)}cSi(M,fa,Va){let Fb=9;if(this.Od){const Vb=new pj.GraphTransaction(15);try{Vb.Ab(this.Od);Vb.Ph=Q.a.zfi;if(!this.DQa)if(this.CEh)this.Efi()&&(this.cDb&&this.Q6j(),this.TEb&&this.R6j());else if(this.qig())return this.Ckd(),12;const wc=this.Tu!==this.Yk?E.a.createTextRange(this.Od,this.Tu,this.Yk):E.a.Uc(this.Od,this.Yk);this.Rd.We(wc,M,this.pGc);this.Yk=this.Tu+M.length;
this.Ckd();this.qKn(fa,Va);this.kDb&&this.kDb.Jso(M,this.Tu,this.Od);const Xc=Pa.SelectionFactory.ue(this.Od,this.Yk);this.ib.Kc(Xc);this.DQa=!1;this.ekb=R.ParagraphReader.text(this.Od);this.lDd=this.TEb=this.cDb=!1;return 0}catch(wc){Na.ULS.sendTraceTag(520734413,394,10,`FinalTextRandomException: ${wc.message}`),Fb=11}finally{Vb&&Vb.dispose()}}else Fb=10,Na.ULS.sendTraceTag(590213578,394,15,"InsertFinalTextWithCorrection _paragraphNode is null.");return Fb}Q6j(){let M=0,fa=0;({aH:M,bH:fa}=F.a.ckc(this.ekb,
R.ParagraphReader.text(this.Od)));this.Uwp(M,this.ekb.length-fa-1)}Uwp(M,fa){if(fa<=this.Tu)M=fa-M+1,this.Tu-=M,this.Yk-=M;else if(M>=this.Tu&&fa<=this.Yk)this.Yk-=fa-M+1;else if(M<this.Tu&&fa<=this.Yk)if(fa===this.Yk)this.Yk=this.Tu=M;else{const Va=this.Yk;this.Tu=M;this.Yk=this.Tu+(Va-fa)-1}else M<this.Tu&&fa>this.Yk?this.Yk=this.Tu=M:M>=this.Tu&&M<this.Yk&&fa>this.Yk?this.Yk=M===this.Tu?this.Tu:M-1:fa>this.Yk&&M>=this.Yk&&!(M>this.Yk)&&(this.Yk=M-1)}R6j(){var M=0,fa=0;({aH:M,bH:fa}=F.a.ckc(this.ekb,
R.ParagraphReader.text(this.Od)));fa=R.ParagraphReader.text(this.Od).length-fa-1;this.Vwp(M,fa)}Vwp(M,fa){M<=this.Tu?(M=fa-M+1,this.Tu+=M,this.Yk+=M):M>this.Tu&&M<=this.Yk&&(this.Yk+=fa-M+1)}qKn(M,fa){M&&this.Bwa&&(M=this.Bwa.bio(M,fa?this.Tu+1:this.Tu),this.Bwa.pKn(this.Od,M))}jNh(){if(this.Od&&this.jMd){const M=this.Od,fa=new H.a;fa.add(new Ei.a(2,this.Tu,this.Yk));this.Wn.c7f(M,fa);this.lDd=!0}}Ckd(){this.Od&&this.jMd&&this.lDd&&this.Wn.zAb(this.Od,2);this.lDd=!1}ROn(){var M=this.bqm();this.ga&&
M&&M.zj!==M.Po&&0<=M.zj&&(M=E.a.createTextRange(M.node,M.zj,M.Po),this.ga.Qb(Q.a.xfi,2,M))}bqm(){return this.Od?this.Tu!==this.Yk?E.a.createTextRange(this.Od,this.Tu,this.Yk):E.a.Uc(this.Od,this.Yk):null}hIi(M){var fa=this.ib.gb.currentSelection;if(fa){var Va=fa.Qa;if(Va&&(fa=Va.node,R.ParagraphReader.Wb(fa)&&(Va=M?Va.Po:Va.zj,fa=R.ParagraphReader.text(fa),Va<=fa.length)))return M?fa.substring(Va,fa.length):fa.substring(0,Va)}return""}qig(){const M=R.ParagraphReader.text(this.Od),fa=this.Aaf.toString();
if(this.Tu+fa.length>M.length)return Na.ULS.sendTraceTag(590213579,394,15,`Paragraph text too short: ${this.Tu} + ${fa.length} > ${M.length}`),!0;for(let Va=0;Va<fa.length;Va++)if(fa.charAt(Va)!==M.charAt(Va+this.Tu))return Na.ULS.sendTraceTag(590213580,394,15,`Paragraph text mismatch at character #${Va} (length ${fa.length} vs ${M.length})`),!0;return!1}Efi(){const M=R.ParagraphReader.text(this.Od);return M.length<this.ekb.length?(this.cDb=!0,this.TEb=!1,!0):M.length>this.ekb.length?(this.cDb=!1,
this.TEb=!0):!1}czg(){throw Error.notImplemented();}}Object(u.a)(Ed,"DefaultDictationHost",null,[939,1567]);class ni extends Ed{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea){super(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce);this.kJb=ea}czg(M){this.kJb.QZo(M)}}Object(u.a)(ni,"DictationHost",Ed,[]);class Ee{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd){this.Rd=M;this.ib=fa;this.Wn=Va;this.Bwa=Fb;this.oB=Vb;this.jMd=wc;this.pGc=Xc;this.kDb=vd;this.kJb=Dd}pFl(M){return new ni(this.Rd,this.ib,z.AFrameworkApplication.va,this.Wn,
this.Bwa,this.oB,this.jMd,this.pGc,this.kDb,M,this.kJb)}}Object(u.a)(Ee,"DictationHostFactory",null,[964]);class hh{constructor(M){this.$h=M}Ixm(){if(!this.$h)return"";var M=this.$h.value;return M?(M=M.Fw)?M.AppliedPolicyId:"":""}Gxm(){if(!this.$h)return"";var M=this.$h.value;if(!M)return"";M=M.Fw;if(!M&&""===M.AppliedPolicyId)return"";for(const fa of M.SensitivityLabels)if(fa.Id===M.AppliedPolicyId)return fa.DisplayName;return""}}Object(u.a)(hh,"DictationSensitivityLabelProvider",null,[911]);class Mj{constructor(){this.Z=
null}get name(){return"WordEditor.DictationHost"}wc(M){this.Z=M;this.Z.ia("WordEditor.DictationHost.DictationHostFactory",()=>new Ee(this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Z.resolve("Box4.IInsertionPointFormatting"),z.AFrameworkApplication.J.$("WacBox4DictationFloatieIsEnabled"),!0,this.Z.Oa("Box4.DictationCommands.IDictationEventRecorder"),
this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.Dictation.IDictationHostFactory").ha();this.Z.ia("Common.IDictationFloatieController",()=>new Sh).as("Common.IDictationFloatieController").ha();this.Z.ia("Box4.Dictation.IDictationSensitivityProvider",()=>new hh(this.Z.nf("Common.App.Policy.Contracts.IPolicyManager"))).as("Box4.Dictation.IDictationSensitivityProvider").ha()}init(){}dispose(){}}Object(u.a)(Mj,"DictationHostPackageManager",
null,[0,1]);var Bj=d(1582),Zl=d(629);class kj extends y{constructor(M,fa,Va){super(12);this.ga=M;this.ib=fa;this.Nq=Va}executeCommand(M){M=M?M.K("command"):null;if(!M)return 32===this.ga.Ob(Vd.a.dMa,2);const fa=new pj.GraphTransaction(15);try{fa.Ab(Zl.a.hm.kb.Qc.vd);const Va=this.ib.gb.currentSelection;if(Va&&Va.Qa&&R.ParagraphReader.Wb(Va.Qa.node)&&R.ParagraphReader.Wb(Va.Xc.node)){const Fb=this.Nq.ufc(Va),Vb=new Bj.a;Vb.Ola(M.comment.content+"\n");this.Nq.v6j(Fb,Vb.gQa);return!0}}finally{fa&&fa.dispose()}return!1}}
Object(u.a)(kj,"NewCommentCommand",y,[]);var Ci=d(18);class Ek extends y{constructor(M){super(56);this.ga=M}executeCommand(){return 32===this.ga.Ob(Ci.a.SKa,2)}}Object(u.a)(Ek,"PageBreakCommand",y,[]);class zi extends y{constructor(M){super(54);this.ga=M}executeCommand(){return 32===this.ga.Ob(Ci.a.b0a,2)}}Object(u.a)(zi,"ShowOutlineCommand",y,[]);class Sg extends y{constructor(M,fa){super(64);this.gSa=M;this.LNe=fa}executeCommand(M){var fa,Va,Fb=M?M.K("command"):null;Fb=Fb?Fb.formatRangeParameters:
null;M=M?null===(Va=null===(fa=M.K("command"))||void 0===fa?void 0:fa.selection)||void 0===Va?void 0:Va.type:null;const Vb="this"!==M&&"that"!==M&&(null===Fb||void 0===Fb?0:Fb.isPhraseOnly)?Fb.startWord.toLowerCase():void 0;fa=!1;z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)?fa=this.LNe.XVb(Vb):this.gSa.P$c?fa=this.LNe.XVb(Vb):(this.gSa.UQd(()=>{this.LNe.XVb(Vb)||Na.ULS.sendTraceTag(527278860,394,10,null)}),fa=!0);return fa?0:4}}Object(u.a)(Sg,
"CorrectionCommand",y,[]);class km{constructor(){this.Sae=this.Vae=this.Uae=!1;this.XYc=this.tjd=this.$hd=null}}Object(u.a)(km,"SuggestionFilter",null,[]);class Je{constructor(M,fa,Va,Fb){this.k1=Va;this.rB=fa;this.mx=M;this.HM=Fb}XVb(M){const fa=Fb=>!M||M===(null===Fb||void 0===Fb?void 0:Fb.toLowerCase()),Va=new km;Va.Uae=!0;Va.Sae=!0;Va.Vae=!0;Va.$hd=Fb=>this.rB.k0b(Fb)&&fa(Fb.token);Va.XYc=Fb=>this.k1.IUa&&fa(Fb.source);Va.tjd=Fb=>{var Vb;return this.mx.VDa(Fb)&&fa(null===(Vb=null===Fb||void 0===
Fb?void 0:Fb.context)||void 0===Vb?void 0:Vb.substring(Fb.startInContext,Fb.startInContext+Fb.range.length))};return this.HM.oag(Va,this.mx,this.rB,this.k1,M?8:7,!1)}}Object(u.a)(Je,"CorrectionCommandSuggestionNavigator",null,[]);class Mc{constructor(M,fa){this.Fbh=M;this.CSa=fa}ZGo(){this.i1e=null}EXo(M){this.i1e=M}invokeBadgeId(M){this.i1e&&this.i1e(M)}$Go(){this.m1e=null}GXo(M){this.m1e=M}Udn(M){this.m1e&&this.m1e(M)}nOj(M,fa){fa?M?this.Fbh.zOh(["showingContextualCard"]):this.Fbh.fCj(["showingContextualCard"]):
M&&this.CSa.FLb("Correct that")}}Object(u.a)(Mc,"CorrectionCommandUxStateManager",null,[]);class Aa extends y{constructor(M){super(65);this.Hch=M}executeCommand(M){M=M?M.K("command"):null;const fa=null===M||void 0===M?void 0:M.correctionOption;fa?this.Hch.invokeBadgeId(fa):this.Hch.Udn(M.sourceText);return 0}}Object(u.a)(Aa,"CorrectionOptionCommand",y,[]);class jb extends y{constructor(M,fa){super(67);this.ib=M;this.fVl=fa}executeCommand(M){if(M=(M=(M=M?M.K("command"):null)?M.suggestionsParameters:
null)?M.suggestionList:null)return Na.ULS.sendTraceTag(512267807,394,15,"suggestionList parameters received for dictation WhatCanISay Command",M),this.fVl.showContextMenu(this.ib.gb.currentSelection.Qa,M)?(M=M.map(fa=>xi[fa.toLowerCase()]),f(M,"whatCanISay"),0):1;Na.ULS.sendTraceTag(512300627,394,15,"No suggestionList parameters received for dictation WhatCanISay Command");return 1}}Object(u.a)(jb,"DiscoverySuggestionCommand",y,[]);class lc{constructor(){this.Z=null}get name(){return"WordEditor.DictationCommands"}wc(M){this.Z=
M;this.Z.ia("WordEditor.DictationCommands.CorrectionCommandUxStateManager",()=>new Mc(this.Z.resolve("Box4.DictationCommands.IDictationCommandManager").WVc,this.Z.resolve("Box4.Dictation.SpecialActionEventListener"))).ha()}init(){const M=this.Z.resolve("Box4.DictationCommands.IDictationCommandManager"),fa=this.Z.resolve("WordEditor.Comments.EditorCommentModel");M.Hq(new kj(z.AFrameworkApplication.va,Fa.a.instance,fa));M.Hq(new zi(z.AFrameworkApplication.va));M.Hq(new Ek(z.AFrameworkApplication.va));
M.Hq(new Sg(this.Z.resolve("Box4.IProofingManager"),new Je(this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.DictationCorrectionIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"))));M.Hq(new Aa(this.Z.resolve("WordEditor.DictationCommands.CorrectionCommandUxStateManager")));M.Hq(new jb(Fa.a.instance,this.Z.resolve("WordEditor.CanvasContextual.DiscoveryCommandIntentProvider")))}dispose(){}}
Object(u.a)(lc,"DictationCommandsPackageManager",null,[0,1]);var Nc=d(559),qd=d(346),Rd=d(1276),Me=d(398),df=d(37),Cf=d(2147);class sg{static get mh(){return Vi.a.uy(sg.lo)}}sg.lo="<div class='WACDialogRow' id='emojiGallery'> <div id='emojiGroupHeader' class='WACEmojisHeadContent' role='tablist' aria-hidden='false'></div> <div id='emojisContainer-0' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_0' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-1' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_1' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-2' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_2' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-3' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_3' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-4' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_4' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-5' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_5' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-6' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_6' aria-hidden='true' tabindex='-1'></div> <div id='emojisContainer-7' class='WACEmojisTabContent' role='tabpanel' aria-labelledby='emoji_h_7' aria-hidden='true' tabindex='-1'></div> </div>";
Object(u.a)(sg,"InsertEmojisDialogHtml",null,[]);var lg=d(347);class Ia extends Cf.a{constructor(M,fa,Va){super(!1);this.yFb=this.mKc=this.sQa=this.v6b=null;this.w0d=Fb=>{if(Fb.target.id.startsWith("emoji_h_")){var Vb=parseInt(Fb.target.id.substr(Fb.target.id.lastIndexOf("_")+1));if(Vb!==Ia.jjb||Ia.SRe){Ia.SRe=!1;this.mKc&&(this.Sxg(this.mKc.id,!1),this.mKc=null,Ia.uKc=-1);var wc=document.querySelectorAll(".EmojiGalleryHeader");for(var Xc=0;Xc<wc.length;Xc++)wc[Xc].setAttribute("aria-selected","false"),
wc[Xc].tabIndex=-1;Fb.target.setAttribute("aria-selected","true");Fb.target.tabIndex=0;this.LN(Fb.target);Fb=Fb.target.getAttribute("aria-controls");wc=document.querySelectorAll(".WACEmojisTabContent");for(Xc=0;Xc<wc.length;Xc++)wc[Xc].id===Fb?(wc[Xc].setAttribute("aria-hidden","false"),this.yFb=wc[Xc]):wc[Xc].setAttribute("aria-hidden","true");Ia.jjb=Vb;this.sIf("emoji_g_"+Ia.jjb+"_0").tabIndex=0}}else Fb.target!==this.mKc&&((Vb=this.Zb.$t())&&Vb.Uk&&Vb.Uk.iA(Fb.target),this.mKc=Fb.target),this.Q3n(Fb.target.id)};
this.E_l=Fb=>{Fb=Fb.Df;if("a"!==Fb.tagName.toLowerCase())return!1;Fb.id.startsWith("emoji_h_")||this.blj(Fb.id);Fb.focus();return!0};this.G_l=Fb=>{const Vb=Fb.Df;if("a"!==Vb.tagName.toLowerCase())return!1;const wc=parseInt(Vb.id.substr(Vb.id.lastIndexOf("_")+1)),Xc=parseInt(Vb.id.substring(Vb.id.lastIndexOf("_")-1,Vb.id.lastIndexOf("_"))),vd=Fb.Df.id.startsWith("emoji_h_");if(Fb.Lb.keyCode===xh.a.GEa||Fb.Lb.keyCode===xh.a.Ftd||Fb.Lb.altKey||Fb.Lb.keyCode>=xh.a.B3b&&Fb.Lb.keyCode<=xh.a.C3b)return!1;
if(Fb.eventName===$c.a.ij){const Dd=Fb.Lb.keyCode;vd?this.I_l(Dd,wc):this.H_l(Vb,Dd,wc,Xc,Fb.Lb.ctrlKey)}return!0};this.ga=M;this.Zb=fa;this.F9=Va;this.Shb=8;this.Bd=5;this.Ig="InsertEmojisDialog";Ia.cFc={"Smileys and People":"emojisContainer-0","Animals and Nature":"emojisContainer-1","Food and Drink":"emojisContainer-2","Travel and Places":"emojisContainer-3",Activities:"emojisContainer-4",Objects:"emojisContainer-5",Symbols:"emojisContainer-6",Flags:"emojisContainer-7"};this.mh=sg.mh}dispose(){this.ga=
this.F9=null;super.dispose()}y_a(){this.Uh(Box4Intl.Box4Strings.L_EmojiSingle,null,null);0<=Ia.jjb?(document.querySelector("#emoji_h_"+Ia.jjb).focus(),0<=Ia.uKc&&document.querySelector("#emoji_g_"+Ia.jjb+"_"+Ia.uKc).focus()):document.querySelector("#emoji_h_"+Ia.$sk).focus()}iCj(M,fa,Va){if(M=document.getElementById(M))if(M=M.getElementsByTagName("a"))for(let Fb=0;Fb<M.length;Fb++)kg.a.removeHandler(M[Fb],fa,Va)}hide(){this.iCj("emojiGroupHeader",$c.a.focus,this.w0d);const M=lg.a(Ia.cFc);for(const fa of M)this.iCj(Ia.cFc[fa],
$c.a.focus,this.w0d);Ia.SRe=!0;super.hide()}get zRf(){return!0}get tub(){return Ia.zKc}set tub(M){Ia.zKc=M}get nub(){return Ia.pKc}set nub(M){Ia.pKc=M}JN(){super.JN();const M=document.getElementById(this.Bj("WACDialogPanel"));M.style.minWidth=String.format("{0}px",Ia.hPe);M.style.width="auto"}Jba(){super.Jba();var M=document.getElementById("emojiGroupHeader");if(M&&(M.innerHTML=this.F9.wgl(),M=M.getElementsByTagName("a")))for(var fa=0;fa<M.length;fa++)kg.a.addHandler(M[fa],$c.a.focus,this.w0d);M=
lg.a(Ia.cFc);for(const Va of M)if(fa=Ia.cFc[Va],M=document.getElementById(fa),fa=parseInt(fa.substr(fa.lastIndexOf("-")+1)),M&&(M.innerHTML=this.F9.bgl(Va,fa),M=M.getElementsByTagName("a")))for(fa=0;fa<M.length;fa++)kg.a.addHandler(M[fa],$c.a.focus,this.w0d)}Lqa(){const M=document.getElementById("emojiGallery");M&&(this.v6b||(this.v6b=this.E_l,this.rr.ub($c.a.click,M,this.v6b)),this.sQa||(this.sQa=this.G_l,this.oe.ub($c.a.ij,M,this.sQa),this.oe.ub($c.a.lv,M,this.sQa),this.oe.ub($c.a.gi,M,this.sQa)));
super.Lqa()}Fob(){const M=document.getElementById("emojiGallery");M&&(this.v6b&&(this.rr.xc($c.a.click,M,this.v6b),this.v6b=null),this.sQa&&(this.oe.xc($c.a.ij,M,this.sQa),this.oe.xc($c.a.lv,M,this.sQa),this.oe.xc($c.a.gi,M,this.sQa),this.sQa=null));super.Fob()}Q3n(M){this.Sxg("emoji_g_"+Ia.jjb+"_"+Ia.uKc,!1);Ia.uKc=parseInt(M.substr(M.lastIndexOf("_")+1));this.Sxg(M,!0)}irm(M,fa){return M?1===M?this.P8a(this.F9.l_.Yii.value,fa):2===M?this.P8a(this.F9.l_.$ii.value,fa):3===M?this.P8a(this.F9.l_.cji.value,
fa):4===M?this.P8a(this.F9.l_.Xii.value,fa):5===M?this.P8a(this.F9.l_.aji.value,fa):6===M?this.P8a(this.F9.l_.bji.value,fa):7===M?this.P8a(this.F9.l_.Zii.value,fa):this.P8a(this.F9.l_.J_l.value,fa):this.P8a(this.F9.l_.Zyf.value,fa)}P8a(M,fa){const Va=lg.a(M);return M[Va[fa]]}LN(M){let fa=this.Zb.$t();if(fa&&fa.Uk)return fa.Uk.iA(M),!0;this.sya();return(fa=this.Zb.$t())&&fa.Uk?(fa.Uk.iA(M),!0):!1}I_l(M,fa){let Va=fa;Ia.jjb=fa;M===Sys.UI.Key.left?Va=z.AFrameworkApplication.isRtl?fa+1:fa-1:M===Sys.UI.Key.right?
Va=z.AFrameworkApplication.isRtl?fa-1:fa+1:M===Sys.UI.Key.home?Va=z.AFrameworkApplication.isRtl?7:0:M===Sys.UI.Key.end&&(Va=z.AFrameworkApplication.isRtl?0:7);Va!==fa&&(M=document.getElementById("emoji_h_"+(Va%8+8)%8))&&M.focus()}H_l(M,fa,Va,Fb,Vb){let wc=null,Xc=-1;fa===Sys.UI.Key.enter||fa===Sys.UI.Key.space?(this.blj(M.id),M.focus()):(fa===Sys.UI.Key.up?Xc=Va-this.Shb:fa===Sys.UI.Key.down?Xc=Va+this.Shb:fa===Sys.UI.Key.left?Xc=z.AFrameworkApplication.isRtl?Va+1:Va-1:fa===Sys.UI.Key.right?Xc=z.AFrameworkApplication.isRtl?
Va-1:Va+1:fa===Sys.UI.Key.home?Vb?wc=(M=(M=this.yFb?this.yFb.querySelector("table"):null)&&0<M.rows.length?M.rows[0].firstChild:null)?M.querySelector("a"):null:Xc=Va-Va%this.Shb:fa===Sys.UI.Key.end&&(Vb?wc=(M=(M=this.yFb?this.yFb.querySelector("table"):null)&&0<M.rows.length?M.rows[M.rows.length-1].lastChild:null)?M.querySelector("a"):null:Xc=Va-Va%this.Shb+(this.Shb-1)),wc||(wc=this.sIf("emoji_g_"+Fb+"_"+Xc)),wc&&wc.focus())}blj(M){var fa=M.split("_");M=parseInt(fa[2]);fa=parseInt(fa[3]);const Va=
this.irm(M,fa),Fb={};Fb.SourceControlId="emoji_"+M+"_"+fa+"_"+Va.kOb;Fb.MenuItemId=Va.kOb;this.ga.Qb(Q.a.ysb,2,Fb);this.Zb.EN(this.aN,!0)}sIf(M){return this.yFb?this.yFb.querySelector("#"+M):null}Sxg(M,fa){if(M=this.sIf(M))fa?(M.setAttribute("selected","true"),M.setAttribute("aria-selected","true"),M.tabIndex=0):(M.removeAttribute("selected"),M.setAttribute("aria-selected","false"),M.tabIndex=-1)}}Ia.cFc=null;Ia.uKc=-1;Ia.jjb=-1;Ia.$sk=0;Ia.SRe=!0;Ia.zKc=null;Ia.pKc=null;Ia.hPe=345;Object(u.a)(Ia,
"InsertEmojisDialog",Cf.a,[]);var Zb=d(1065);class Qc{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub){this.dgh=!1;this.rAd=null;this.Owj=(yc,ad,md,Sd,ze)=>{if(1===md)return 32;yc=String.format(this.F9.F_l,ze.MenuItemId);ze[Rd.a.InnerHTML]=yc;ze[Rd.a.On]=!1;return 32};this.rWa=(yc,ad,md,Sd,ze)=>{if(({ge:md,selected:Ng,rWa:uh}=this.tYc(ad,md)).returnValue)return uh;const Ne=df.a.mf(Ng);let ng=!0;var Ng=8;var uh=this.Rc.Lc(15);uh.Ab(md.vd);Zb.a.Nod&&(uh.Ph=yc);Ne||(Ng=this.ga.Hf(ad,Q.a.Bra,2,!0,
Sd,null),ng=32===Ng);ng&&(yc=md.lb.Pg,ad=df.a.mf(yc),Ng=8,ad&&(Ng=this.ga.Hf(yc,Q.a.ysb,2,!1,Sd,ze),32===Ng&&cf.FocusManager.instance().Gg(md.nL)));uh.dispose();return Ng};this.bSi=(yc,ad,md,Sd,ze)=>{if(1===md)return 32;if(df.a.B$a(ad))return 2;ze=ze.MenuItemId;Sd=this.fd.mg(ad.node);Sd.zb(11);yc=this.Rc.Lc(15);yc.ju(Sd);this.Rd.We(ad,ze);md=ad.node;ze=ze.length;ad=ad.cpBegin;let Ne,ng,Ng,uh=({W1f:Ne,jVc:ng}=Me.a.qDe(md.ra,ad)).returnValue;if(!Ne)return 16;const Oh=Ne.cache.pI;let Hj=ng>=md.ra.length;
uh&&"Segoe UI Emoji"!==Ne.cache.pI?({jVc:Ng,returnValue:uh}=Me.a.qDe(md.ra,ad+ze),Hj=Ng>=md.ra.length,uh||Hj?!uh&&Hj&&Na.ULS.sendTraceTag(39686730,324,15,"TryGetChpAndLastFormattingAtCp was unsuccessful and completed with chpIdx2 out of bounds in InsertEmojiHandler"):this.Rd.G0(md,Ng,ad+ze,Ne),this.Ee.lha(md.ra.Ub(ng).formatting,"Segoe UI Emoji")):Hj||"Segoe UI Emoji"===Ne.cache.pI?"Segoe UI Emoji"!==Ne.cache.pI&&(Na.ULS.sendTraceTag(39686734,324,15,"TryGetChpAndLastFormattingAtCp was unsuccessful and completed with chpIdx out of bounds in InsertEmojiHandler"),
this.Ee.lha(md.ra.last.formatting,"Segoe UI Emoji")):(Ne=this.Rd.G0(md,ng,ad,Ne),{jVc:Ng,returnValue:uh}=Me.a.qDe(md.ra,ad+ze),Hj=Ng>=md.ra.length,uh||Hj?!uh&&Hj&&Na.ULS.sendTraceTag(39686732,324,15,"TryGetChpAndLastFormattingAtCp was unsuccessful and completed with chpIdx2 out of bounds in InsertEmojiHandler"):this.Rd.G0(md,Ng,ad+ze,Ne),this.Ee.lha(md.ra.Ub(ng).formatting,"Segoe UI Emoji"));Sd=Pa.SelectionFactory.ue(Sd.currentNode,ad+ze);this.ib.Kc(Sd);Oh&&this.oB.Twe(Oh);this.Zd.Bg&&this.kq.vna(md,
ad,ad+ze,1);this.sM.ETa&&this.sM.ava(md,ad,ad+ze);yc.dispose();return 32};this.FXb=(yc,ad,md,Sd,ze)=>{if(1===md)return 32;ze.MenuItems=this.AQe.BQe;return 32};this.dji=(yc,ad,md)=>{({rWa:yc}=this.tYc(ad,md));return yc};this.vUj=(yc,ad,md)=>{yc=this.tnf();32===yc&&2===md&&(new Ia(this.ga,cf.FocusManager.instance(),fd.a.instance.resolve("Box4.Emojis.IEmojisUIBuilder"))).y_a();return yc};this.suc=()=>this.tnf();this.ga=M;this.fd=Va;this.Rc=Fb;this.F9=Vb;this.xl=wc;this.ib=Xc;this.Rd=vd;this.Ee=Dd;this.AQe=
Ce;this.Zd=ea;this.kq=Xa;this.sM=yb;this.oB=Ub}get mV(){return z.AFrameworkApplication.ua.Vr}Xb(){this.ga.fb(Q.a.suc,rb.a.application,this.suc,96);this.ga.qa(Q.a.FXb,rb.a.view,this.FXb);this.ga.qa(Q.a.x0d,rb.a.view,this.dji);this.ga.qa(Q.a.Zqe,rb.a.view,this.Owj);this.ga.qa(Q.a.ysb,rb.a.view,this.rWa);this.ga.qa(Q.a.FXb,rb.a.Vc,this.FXb);this.ga.qa(Q.a.x0d,rb.a.Vc,this.dji);this.ga.qa(Q.a.Zqe,rb.a.Vc,this.Owj);this.ga.qa(Q.a.ysb,rb.a.Vc,this.bSi);this.ga.qa(Q.a.ysb,rb.a.Cd,this.bSi);this.ga.Pc(Q.a.FXb,
1124);this.ga.Pc(Q.a.x0d,1124);this.ga.Pc(Q.a.Zqe,1124);this.ga.Pc(Q.a.ysb,1028);this.ga.qa(Q.a.O7c,rb.a.view,this.vUj);this.ga.qa(Q.a.O7c,rb.a.Vc,this.vUj);this.ga.Pc(Q.a.O7c,1124)}tYc(M,fa){let Va,Fb=null;M.view.ve&&(Fb=M.view);Va=null;if(!Fb||!Fb.lb)return{returnValue:!0,ge:Fb,selected:Va,rWa:8};Va=Fb.lb.Pg;if(!Va)return{returnValue:!0,ge:Fb,selected:Va,rWa:2};if(this.xl.p2(Va)||this.xl.ama(Va))return{returnValue:!0,ge:Fb,selected:Va,rWa:8};if(Fb.lb.gb.GL||df.a.B$a(M.Lk))return{returnValue:!0,
ge:Fb,selected:Va,rWa:2};if(Object(gh.a)().HEa(R.ParagraphReader.xX,Va))return M=8,Qc.Ac.fc(qg.a.Ne,{["Reason"]:dl.a.XQ}),{returnValue:!0,ge:Fb,selected:Va,rWa:M};M=32;return 1===fa?(M=this.tnf(),{returnValue:!0,ge:Fb,selected:Va,rWa:M}):{returnValue:!1,ge:Fb,selected:Va,rWa:M}}tnf(){let M=32;this.dgh||(this.rAd||(this.rAd=this.mV.Xf("LoadResource","EmojiButtonEnabled")),this.AQe.BQe?(this.rAd&&this.rAd.stop(),this.dgh=!0,M=32):(this.AQe.ugl(),M=8));return M}static get Ac(){return jg.a.instance}}
Object(u.a)(Qc,"EmojisActor",null,[1034]);class ed{constructor(M,fa,Va){this.BQe=null;this.oFb=this.TFb=!1;this.Pwn=Fb=>{Fb?(this.oFb=!0,this.LQi(),this.mLg(),Na.ULS.sendTraceTag(38015519,324,50,"EmojiIntl downloaded")):Na.ULS.sendTraceTag(38015520,324,15,"EmojiIntl download failed");this.TFb=!1};this.Nj=M;this.uuk=fa;this.F9=Va}ugl(){this.LQi()||this.D4f()}krm(){return this.F9.jrm()}D4f(){this.TFb||(this.TFb=!0,this.uuk.Z_d(this.Pwn))}LQi(){return this.oFb?(this.BQe=this.krm(),!0):!1}mLg(){this.Nj.Ge()}}
Object(u.a)(ed,"EmojisDropDownManager",null,[1035]);var Pd=d(272);class hb{constructor(M,fa,Va){this.kOb=M;this.altText=fa;this.group=Va}}Object(u.a)(hb,"Emoji",null,[]);class Id{constructor(){this.zQe=null;this.egh=new Pd.a(()=>Id.Z6a(255));this.Zyf=new Pd.a(()=>Id.Z6a(1));this.Yii=new Pd.a(()=>Id.Z6a(2));this.$ii=new Pd.a(()=>Id.Z6a(4));this.cji=new Pd.a(()=>Id.Z6a(8));this.Xii=new Pd.a(()=>Id.Z6a(16));this.aji=new Pd.a(()=>Id.Z6a(32));this.bji=new Pd.a(()=>Id.Z6a(64));this.Zii=new Pd.a(()=>Id.Z6a(128));
this.K_l=new Pd.a(Id.DFl)}get J_l(){return this.egh}vAi(M){this.zQe||(this.zQe=lg.a(this.egh.value));return Array.indexOf(this.zQe,M)}static DFl(){const M={};M["\ud83d\ude0a"]=new hb("\ud83d\ude0a",EmojiStrings.l_SlightlySmilingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1);M["\ud83d\udc38"]=new hb("\ud83d\udc38",EmojiStrings.l_FrogFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalAmphibian,!1,!1);M["\u2615"]=new hb("\u2615",EmojiStrings.l_HotBeverage,EmojiStrings.l_FoodAndDrink,
EmojiStrings.l_Drink,!1,!1);M["\ud83d\udea2"]=new hb("\ud83d\udea2",EmojiStrings.l_Ship,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportWater,!1,!1);M["\u26bd"]=new hb("\u26bd",EmojiStrings.l_SoccerBall,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1);M["\ud83d\udca1"]=new hb("\ud83d\udca1",EmojiStrings.l_LightBulb,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1);M["\ud83d\udd23"]=new hb("\ud83d\udd23",EmojiStrings.l_InputSymbols,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,
!1,!1);M["\ud83c\udfc1"]=new hb("\ud83c\udfc1",EmojiStrings.l_ChequeredFlag,EmojiStrings.l_Flags,EmojiStrings.l_Flag,!1,!1);return M}static Z6a(M){const fa={};1===(M&1)&&(fa["\ud83d\ude00"]=new hb("\ud83d\ude00",EmojiStrings.l_GrinningFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude01"]=new hb("\ud83d\ude01",EmojiStrings.l_GrinningFaceWithSmilingEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude02"]=new hb("\ud83d\ude02",EmojiStrings.l_FaceWithTearsOfJoy,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83e\udd23"]=new hb("\ud83e\udd23",EmojiStrings.l_RollingOnTheFloorLaughing,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude03"]=new hb("\ud83d\ude03",EmojiStrings.l_SmilingFaceWithOpenMouth,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude04"]=new hb("\ud83d\ude04",EmojiStrings.l_SmilingFaceWithOpenMouthAndSmilingEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,
!1,!1),fa["\ud83d\ude05"]=new hb("\ud83d\ude05",EmojiStrings.l_SmilingFaceWithOpenMouthAndColdSweat,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude06"]=new hb("\ud83d\ude06",EmojiStrings.l_SmilingFaceWithOpenMouthAndClosedEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude09"]=new hb("\ud83d\ude09",EmojiStrings.l_WinkingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude0a"]=new hb("\ud83d\ude0a",
EmojiStrings.l_SmilingFaceWithSmilingEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude0b"]=new hb("\ud83d\ude0b",EmojiStrings.l_FaceSavouringDeliciousFood,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude0e"]=new hb("\ud83d\ude0e",EmojiStrings.l_SmilingFaceWithSunglasses,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude0d"]=new hb("\ud83d\ude0d",EmojiStrings.l_SmilingFaceWithHeartEyes,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude18"]=new hb("\ud83d\ude18",EmojiStrings.l_FaceBlowingAKiss,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude17"]=new hb("\ud83d\ude17",EmojiStrings.l_KissingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude19"]=new hb("\ud83d\ude19",EmojiStrings.l_KissingFaceWithSmilingEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude1a"]=new hb("\ud83d\ude1a",
EmojiStrings.l_KissingFaceWithClosedEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83d\ude42"]=new hb("\ud83d\ude42",EmojiStrings.l_SlightlySmilingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83e\udd17"]=new hb("\ud83e\udd17",EmojiStrings.l_HuggingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FacePositive,!1,!1),fa["\ud83e\udd14"]=new hb("\ud83e\udd14",EmojiStrings.l_ThinkingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,
!1,!1),fa["\ud83d\ude10"]=new hb("\ud83d\ude10",EmojiStrings.l_NeutralFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude11"]=new hb("\ud83d\ude11",EmojiStrings.l_ExpressionlessFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude36"]=new hb("\ud83d\ude36",EmojiStrings.l_FaceWithoutMouth,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude44"]=new hb("\ud83d\ude44",EmojiStrings.l_FaceWithRollingEyes,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude0f"]=new hb("\ud83d\ude0f",EmojiStrings.l_SmirkingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude23"]=new hb("\ud83d\ude23",EmojiStrings.l_PerseveringFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude25"]=new hb("\ud83d\ude25",EmojiStrings.l_DisappointedButRelievedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude2e"]=new hb("\ud83d\ude2e",EmojiStrings.l_FaceWithOpenMouth,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83e\udd10"]=new hb("\ud83e\udd10",EmojiStrings.l_ZipperMouthFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude2f"]=new hb("\ud83d\ude2f",EmojiStrings.l_HushedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude2a"]=new hb("\ud83d\ude2a",EmojiStrings.l_SleepyFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude2b"]=new hb("\ud83d\ude2b",
EmojiStrings.l_TiredFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude34"]=new hb("\ud83d\ude34",EmojiStrings.l_SleepingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude0c"]=new hb("\ud83d\ude0c",EmojiStrings.l_RelievedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83e\udd13"]=new hb("\ud83e\udd13",EmojiStrings.l_NerdFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude1b"]=
new hb("\ud83d\ude1b",EmojiStrings.l_FaceWithStuckOutTongue,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude1c"]=new hb("\ud83d\ude1c",EmojiStrings.l_FaceWithStuckOutTongueAndWinkingEye,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude1d"]=new hb("\ud83d\ude1d",EmojiStrings.l_FaceWithStuckOutTongueAndClosedEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83e\udd24"]=new hb("\ud83e\udd24",EmojiStrings.l_DroolingFace,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude12"]=new hb("\ud83d\ude12",EmojiStrings.l_UnamusedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude13"]=new hb("\ud83d\ude13",EmojiStrings.l_FaceWithColdSweat,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude14"]=new hb("\ud83d\ude14",EmojiStrings.l_PensiveFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude15"]=new hb("\ud83d\ude15",
EmojiStrings.l_ConfusedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude43"]=new hb("\ud83d\ude43",EmojiStrings.l_UpsideDownFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83e\udd11"]=new hb("\ud83e\udd11",EmojiStrings.l_MoneyMouthFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,!1),fa["\ud83d\ude32"]=new hb("\ud83d\ude32",EmojiStrings.l_AstonishedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNeutral,!1,
!1),fa["\ud83d\ude41"]=new hb("\ud83d\ude41",EmojiStrings.l_SlightlyFrowningFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude16"]=new hb("\ud83d\ude16",EmojiStrings.l_ConfoundedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude1e"]=new hb("\ud83d\ude1e",EmojiStrings.l_DisappointedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude1f"]=new hb("\ud83d\ude1f",EmojiStrings.l_WorriedFace,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude24"]=new hb("\ud83d\ude24",EmojiStrings.l_FaceWithSteamFromNose,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude22"]=new hb("\ud83d\ude22",EmojiStrings.l_CryingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude2d"]=new hb("\ud83d\ude2d",EmojiStrings.l_LoudlyCryingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude26"]=new hb("\ud83d\ude26",EmojiStrings.l_FrowningFaceWithOpenMouth,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude27"]=new hb("\ud83d\ude27",EmojiStrings.l_AnguishedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude28"]=new hb("\ud83d\ude28",EmojiStrings.l_FearfulFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude29"]=new hb("\ud83d\ude29",EmojiStrings.l_WearyFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude2c"]=new hb("\ud83d\ude2c",
EmojiStrings.l_GrimacingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude30"]=new hb("\ud83d\ude30",EmojiStrings.l_FaceWithOpenMouthAndColdSweat,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude31"]=new hb("\ud83d\ude31",EmojiStrings.l_FaceScreamingInFear,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude33"]=new hb("\ud83d\ude33",EmojiStrings.l_FlushedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,
!1,!1),fa["\ud83d\ude35"]=new hb("\ud83d\ude35",EmojiStrings.l_DizzyFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude21"]=new hb("\ud83d\ude21",EmojiStrings.l_PoutingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude20"]=new hb("\ud83d\ude20",EmojiStrings.l_AngryFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceNegative,!1,!1),fa["\ud83d\ude20"]=new hb("\ud83d\ude07",EmojiStrings.l_SmilingFaceWithHalo,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_FaceRole,!1,!1),fa["\ud83e\udd21"]=new hb("\ud83e\udd21",EmojiStrings.l_ClownFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceRole,!1,!1),fa["\ud83e\udd25"]=new hb("\ud83e\udd25",EmojiStrings.l_LyingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceRole,!1,!1),fa["\ud83d\ude37"]=new hb("\ud83d\ude37",EmojiStrings.l_FaceWithMedicalMask,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceSick,!1,!1),fa["\ud83e\udd12"]=new hb("\ud83e\udd12",EmojiStrings.l_FaceWithThermometer,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceSick,!1,!1),fa["\ud83e\udd15"]=new hb("\ud83e\udd15",EmojiStrings.l_FaceWithHeadBandage,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceSick,!1,!1),fa["\ud83e\udd22"]=new hb("\ud83e\udd22",EmojiStrings.l_NauseatedFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceSick,!1,!1),fa["\ud83e\udd27"]=new hb("\ud83e\udd27",EmojiStrings.l_SneezingFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_FaceSick,!1,!1),fa["\ud83d\ude08"]=new hb("\ud83d\ude08",
EmojiStrings.l_SmilingFaceWithHorns,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udc7f"]=new hb("\ud83d\udc7f",EmojiStrings.l_AngryFaceWithHorns,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udc79"]=new hb("\ud83d\udc79",EmojiStrings.l_Ogre,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udc7a"]=new hb("\ud83d\udc7a",EmojiStrings.l_Goblin,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),
fa["\ud83d\udc80"]=new hb("\ud83d\udc80",EmojiStrings.l_Skull,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udc7b"]=new hb("\ud83d\udc7b",EmojiStrings.l_Ghost,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udc7d"]=new hb("\ud83d\udc7d",EmojiStrings.l_Alien,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udc7e"]=new hb("\ud83d\udc7e",EmojiStrings.l_AlienMonster,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,
!1,!1),fa["\ud83e\udd16"]=new hb("\ud83e\udd16",EmojiStrings.l_RobotFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\udca9"]=new hb("\ud83d\udca9",EmojiStrings.l_PileOfPoo,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CreatureFace,!1,!1),fa["\ud83d\ude3a"]=new hb("\ud83d\ude3a",EmojiStrings.l_SmilingCatFaceWithOpenMouth,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude38"]=new hb("\ud83d\ude38",EmojiStrings.l_GrinningCatFaceWithSmilingEyes,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude39"]=new hb("\ud83d\ude39",EmojiStrings.l_CatFaceWithTearsOfJoy,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude3b"]=new hb("\ud83d\ude3b",EmojiStrings.l_SmilingCatFaceWithHeartEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude3c"]=new hb("\ud83d\ude3c",EmojiStrings.l_CatFaceWithWrySmile,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude3d"]=
new hb("\ud83d\ude3d",EmojiStrings.l_KissingCatFaceWithClosedEyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude40"]=new hb("\ud83d\ude40",EmojiStrings.l_WearyCatFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude3f"]=new hb("\ud83d\ude3f",EmojiStrings.l_CryingCatFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,!1,!1),fa["\ud83d\ude3e"]=new hb("\ud83d\ude3e",EmojiStrings.l_PoutingCatFace,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_CatFaces,
!1,!1),fa["\ud83d\ude48"]=new hb("\ud83d\ude48",EmojiStrings.l_SeeNoEvilMonkey,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_MonkeyFaces,!1,!1),fa["\ud83d\ude49"]=new hb("\ud83d\ude49",EmojiStrings.l_HearNoEvilMonkey,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_MonkeyFaces,!1,!1),fa["\ud83d\ude4a"]=new hb("\ud83d\ude4a",EmojiStrings.l_SpeakNoEvilMonkey,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_MonkeyFaces,!1,!1),fa["\ud83d\udc66"]=new hb("\ud83d\udc66",EmojiStrings.l_Boy,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc67"]=new hb("\ud83d\udc67",EmojiStrings.l_Girl,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc68"]=new hb("\ud83d\udc68",EmojiStrings.l_Man,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc69"]=new hb("\ud83d\udc69",EmojiStrings.l_Woman,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc74"]=new hb("\ud83d\udc74",EmojiStrings.l_OldMan,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,
!0,!1),fa["\ud83d\udc75"]=new hb("\ud83d\udc75",EmojiStrings.l_OldWoman,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc76"]=new hb("\ud83d\udc76",EmojiStrings.l_Baby,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc7c"]=new hb("\ud83d\udc7c",EmojiStrings.l_BabyAngel,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Person,!0,!1),fa["\ud83d\udc6e"]=new hb("\ud83d\udc6e",EmojiStrings.l_PoliceOfficer,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,
!0,!0),fa["\ud83d\udc82"]=new hb("\ud83d\udc82",EmojiStrings.l_Guard,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!0),fa["\ud83d\udc77"]=new hb("\ud83d\udc77",EmojiStrings.l_ConstructionWorker,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!0),fa["\ud83d\udc73"]=new hb("\ud83d\udc73",EmojiStrings.l_PersonWearingTurban,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!0),fa["\ud83d\udc71"]=new hb("\ud83d\udc71",EmojiStrings.l_BlondHairedPerson,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_PersonRole,!0,!0),fa["\ud83c\udf85"]=new hb("\ud83c\udf85",EmojiStrings.l_SantaClaus,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83e\udd36"]=new hb("\ud83e\udd36",EmojiStrings.l_MrsClaus,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83d\udc78"]=new hb("\ud83d\udc78",EmojiStrings.l_Princess,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83e\udd34"]=new hb("\ud83e\udd34",EmojiStrings.l_Prince,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_PersonRole,!0,!1),fa["\ud83d\udc70"]=new hb("\ud83d\udc70",EmojiStrings.l_BrideWithVeil,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83e\udd35"]=new hb("\ud83e\udd35",EmojiStrings.l_ManInTuxedo,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83e\udd30"]=new hb("\ud83e\udd30",EmojiStrings.l_PregnantWoman,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83d\udc72"]=new hb("\ud83d\udc72",EmojiStrings.l_ManWithChineseCap,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonRole,!0,!1),fa["\ud83d\ude4d"]=new hb("\ud83d\ude4d",EmojiStrings.l_PersonFrowning,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\ude4e"]=new hb("\ud83d\ude4e",EmojiStrings.l_PersonPouting,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\ude45"]=new hb("\ud83d\ude45",EmojiStrings.l_PersonGesturingNO,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\ude46"]=
new hb("\ud83d\ude46",EmojiStrings.l_PersonGesturingOK,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\udc81"]=new hb("\ud83d\udc81",EmojiStrings.l_PersonTippingHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\ude4b"]=new hb("\ud83d\ude4b",EmojiStrings.l_PersonRaisingHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\ude47"]=new hb("\ud83d\ude47",EmojiStrings.l_PersonBowing,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83e\udd26"]=new hb("\ud83e\udd26",EmojiStrings.l_PersonFacepalming,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83e\udd37"]=new hb("\ud83e\udd37",EmojiStrings.l_PersonShrugging,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonGesture,!0,!0),fa["\ud83d\udc86"]=new hb("\ud83d\udc86",EmojiStrings.l_PersonGettingMassage,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!0,!0),fa["\ud83d\udc87"]=new hb("\ud83d\udc87",
EmojiStrings.l_PersonGettingHaircut,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!0,!0),fa["\ud83d\udeb6"]=new hb("\ud83d\udeb6",EmojiStrings.l_PersonWalking,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!0,!0),fa["\ud83c\udfc3"]=new hb("\ud83c\udfc3",EmojiStrings.l_PersonRunning,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!0,!0),fa["\ud83d\udc83"]=new hb("\ud83d\udc83",EmojiStrings.l_WomanDancing,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,
!0,!1),fa["\ud83d\udd7a"]=new hb("\ud83d\udd7a",EmojiStrings.l_ManDancing,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!0,!1),fa["\ud83d\udc6f"]=new hb("\ud83d\udc6f",EmojiStrings.l_PeopleWithBunnyEarsPartying,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!1,!0),fa["\ud83d\udc64"]=new hb("\ud83d\udc64",EmojiStrings.l_BustInSilhouette,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!1,!1),fa["\ud83d\udc65"]=new hb("\ud83d\udc65",EmojiStrings.l_BustsInSilhouette,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonActivity,!1,!1),fa["\ud83e\udd3a"]=new hb("\ud83e\udd3a",EmojiStrings.l_PersonFencing,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!1,!1),fa["\ud83c\udfc7"]=new hb("\ud83c\udfc7",EmojiStrings.l_HorseRacing,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!1),fa["\ud83c\udfc2"]=new hb("\ud83c\udfc2",EmojiStrings.l_Snowboarder,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!1),fa["\ud83c\udfc4"]=new hb("\ud83c\udfc4",
EmojiStrings.l_PersonSurfing,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83d\udea3"]=new hb("\ud83d\udea3",EmojiStrings.l_PersonRowingBoat,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83c\udfca"]=new hb("\ud83c\udfca",EmojiStrings.l_PersonSwimming,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83d\udeb4"]=new hb("\ud83d\udeb4",EmojiStrings.l_PersonBiking,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,
!0),fa["\ud83d\udeb5"]=new hb("\ud83d\udeb5",EmojiStrings.l_PersonMountainBiking,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83e\udd38"]=new hb("\ud83e\udd38",EmojiStrings.l_PersonCartwheeling,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83e\udd3c"]=new hb("\ud83e\udd3c",EmojiStrings.l_PeopleWrestling,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!1),fa["\ud83e\udd3d"]=new hb("\ud83e\udd3d",EmojiStrings.l_PersonPlayingWaterPolo,
EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83e\udd3e"]=new hb("\ud83e\udd3e",EmojiStrings.l_PersonPlayingHandball,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83e\udd39"]=new hb("\ud83e\udd39",EmojiStrings.l_PersonJuggling,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_PersonSport,!0,!0),fa["\ud83d\udc6b"]=new hb("\ud83d\udc6b",EmojiStrings.l_ManAndWomanHoldingHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Family_,!1,!1),fa["\ud83d\udc6c"]=
new hb("\ud83d\udc6c",EmojiStrings.l_TwoMenHoldingHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Family_,!1,!1),fa["\ud83d\udc6d"]=new hb("\ud83d\udc6d",EmojiStrings.l_TwoWomenHoldingHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Family_,!1,!1),fa["\ud83d\udc8f"]=new hb("\ud83d\udc8f",EmojiStrings.l_Kiss,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Family_,!1,!1),fa["\ud83d\udc91"]=new hb("\ud83d\udc91",EmojiStrings.l_CoupleWithHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Family_,
!1,!1),fa["\ud83d\udc6a"]=new hb("\ud83d\udc6a",EmojiStrings.l_Family,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Family_,!1,!1),fa["\ud83d\udcaa"]=new hb("\ud83d\udcaa",EmojiStrings.l_FlexedBiceps,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd33"]=new hb("\ud83e\udd33",EmojiStrings.l_Selfie,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc48"]=new hb("\ud83d\udc48",EmojiStrings.l_BackhandIndexPointingLeft,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,
!0,!1),fa["\ud83d\udc49"]=new hb("\ud83d\udc49",EmojiStrings.l_BackhandIndexPointingRight,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc46"]=new hb("\ud83d\udc46",EmojiStrings.l_BackhandIndexPointingUp,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc47"]=new hb("\ud83d\udc47",EmojiStrings.l_BackhandIndexPointingDown,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd1e"]=new hb("\ud83e\udd1e",EmojiStrings.l_CrossedFingers,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Body,!0,!1),fa["\ud83d\udd96"]=new hb("\ud83d\udd96",EmojiStrings.l_VulcanSalute,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd18"]=new hb("\ud83e\udd18",EmojiStrings.l_SignOfTheHorns,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd19"]=new hb("\ud83e\udd19",EmojiStrings.l_CallMeHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\u270b"]=new hb("\u270b",EmojiStrings.l_RaisedHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,
!0,!1),fa["\ud83d\udc4c"]=new hb("\ud83d\udc4c",EmojiStrings.l_OKHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc4d"]=new hb("\ud83d\udc4d",EmojiStrings.l_ThumbsUp,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc4e"]=new hb("\ud83d\udc4e",EmojiStrings.l_ThumbsDown,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\u270a"]=new hb("\u270a",EmojiStrings.l_RaisedFist,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc4a"]=
new hb("\ud83d\udc4a",EmojiStrings.l_OncomingFist,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd1b"]=new hb("\ud83e\udd1b",EmojiStrings.l_LeftFacingFist,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd1c"]=new hb("\ud83e\udd1c",EmojiStrings.l_RightFacingFist,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd1a"]=new hb("\ud83e\udd1a",EmojiStrings.l_RaisedBackOfHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),
fa["\ud83d\udc4b"]=new hb("\ud83d\udc4b",EmojiStrings.l_WavingHand,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc4f"]=new hb("\ud83d\udc4f",EmojiStrings.l_ClappingHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc50"]=new hb("\ud83d\udc50",EmojiStrings.l_OpenHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\ude4c"]=new hb("\ud83d\ude4c",EmojiStrings.l_RaisingHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,
!0,!1),fa["\ud83d\ude4f"]=new hb("\ud83d\ude4f",EmojiStrings.l_FoldedHands,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83e\udd1d"]=new hb("\ud83e\udd1d",EmojiStrings.l_Handshake,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!1,!1),fa["\ud83d\udc85"]=new hb("\ud83d\udc85",EmojiStrings.l_NailPolish,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc42"]=new hb("\ud83d\udc42",EmojiStrings.l_Ear,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),
fa["\ud83d\udc43"]=new hb("\ud83d\udc43",EmojiStrings.l_Nose,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!0,!1),fa["\ud83d\udc63"]=new hb("\ud83d\udc63",EmojiStrings.l_Footprints,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!1,!1),fa["\ud83d\udc40"]=new hb("\ud83d\udc40",EmojiStrings.l_Eyes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!1,!1),fa["\ud83d\udc45"]=new hb("\ud83d\udc45",EmojiStrings.l_Tongue,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!1,!1),fa["\ud83d\udc44"]=
new hb("\ud83d\udc44",EmojiStrings.l_Mouth,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Body,!1,!1),fa["\ud83d\udc8b"]=new hb("\ud83d\udc8b",EmojiStrings.l_KissMark,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc98"]=new hb("\ud83d\udc98",EmojiStrings.l_HeartWithArrow,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc93"]=new hb("\ud83d\udc93",EmojiStrings.l_BeatingHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc94"]=
new hb("\ud83d\udc94",EmojiStrings.l_BrokenHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc95"]=new hb("\ud83d\udc95",EmojiStrings.l_TwoHearts,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc96"]=new hb("\ud83d\udc96",EmojiStrings.l_SparklingHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc97"]=new hb("\ud83d\udc97",EmojiStrings.l_GrowingHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),
fa["\ud83d\udc99"]=new hb("\ud83d\udc99",EmojiStrings.l_BlueHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc9a"]=new hb("\ud83d\udc9a",EmojiStrings.l_GreenHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc9b"]=new hb("\ud83d\udc9b",EmojiStrings.l_YellowHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc9c"]=new hb("\ud83d\udc9c",EmojiStrings.l_PurpleHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,
!1,!1),fa["\ud83d\udda4"]=new hb("\ud83d\udda4",EmojiStrings.l_BlackHeart,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc9d"]=new hb("\ud83d\udc9d",EmojiStrings.l_HeartWithRibbon,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc9e"]=new hb("\ud83d\udc9e",EmojiStrings.l_RevolvingHearts,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc9f"]=new hb("\ud83d\udc9f",EmojiStrings.l_HeartDecoration,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc8c"]=new hb("\ud83d\udc8c",EmojiStrings.l_LoveLetter,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udca4"]=new hb("\ud83d\udca4",EmojiStrings.l_Zzz,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udca2"]=new hb("\ud83d\udca2",EmojiStrings.l_AngerSymbol,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udca3"]=new hb("\ud83d\udca3",EmojiStrings.l_Bomb,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udca5"]=new hb("\ud83d\udca5",EmojiStrings.l_Collision,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udca6"]=new hb("\ud83d\udca6",EmojiStrings.l_SweatDroplets,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udca8"]=new hb("\ud83d\udca8",EmojiStrings.l_DashingAway,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udcab"]=new hb("\ud83d\udcab",EmojiStrings.l_Dizzy,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udcac"]=new hb("\ud83d\udcac",EmojiStrings.l_SpeechBalloon,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udcad"]=new hb("\ud83d\udcad",EmojiStrings.l_ThoughtBalloon,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Emotion,!1,!1),fa["\ud83d\udc53"]=new hb("\ud83d\udc53",EmojiStrings.l_Glasses,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc54"]=new hb("\ud83d\udc54",EmojiStrings.l_Necktie,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc55"]=new hb("\ud83d\udc55",EmojiStrings.l_TShirt,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc56"]=new hb("\ud83d\udc56",EmojiStrings.l_Jeans,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc57"]=new hb("\ud83d\udc57",EmojiStrings.l_Dress,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc58"]=new hb("\ud83d\udc58",EmojiStrings.l_Kimono,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc59"]=new hb("\ud83d\udc59",EmojiStrings.l_Bikini,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc5a"]=new hb("\ud83d\udc5a",EmojiStrings.l_WomansClothes,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc5b"]=new hb("\ud83d\udc5b",EmojiStrings.l_Purse,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc5c"]=new hb("\ud83d\udc5c",EmojiStrings.l_Handbag,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc5d"]=new hb("\ud83d\udc5d",EmojiStrings.l_ClutchBag,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83c\udf92"]=new hb("\ud83c\udf92",EmojiStrings.l_SchoolBackpack,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc5e"]=new hb("\ud83d\udc5e",EmojiStrings.l_MaNSShoe,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc5f"]=new hb("\ud83d\udc5f",EmojiStrings.l_RunningShoe,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc60"]=new hb("\ud83d\udc60",EmojiStrings.l_HighHeeledShoe,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc61"]=new hb("\ud83d\udc61",EmojiStrings.l_WomaNSSandal,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc62"]=new hb("\ud83d\udc62",EmojiStrings.l_WomaNSBoot,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc51"]=new hb("\ud83d\udc51",EmojiStrings.l_Crown,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc52"]=new hb("\ud83d\udc52",EmojiStrings.l_WomaNSHat,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83c\udfa9"]=new hb("\ud83c\udfa9",EmojiStrings.l_TopHat,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83c\udf93"]=new hb("\ud83c\udf93",EmojiStrings.l_GraduationCap,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udcff"]=new hb("\ud83d\udcff",EmojiStrings.l_PrayerBeads,EmojiStrings.l_SmileysAndPeople,
EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc84"]=new hb("\ud83d\udc84",EmojiStrings.l_Lipstick,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc8d"]=new hb("\ud83d\udc8d",EmojiStrings.l_Ring,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1),fa["\ud83d\udc8e"]=new hb("\ud83d\udc8e",EmojiStrings.l_GemStone,EmojiStrings.l_SmileysAndPeople,EmojiStrings.l_Clothing,!1,!1));2===(M&2)&&(fa["\ud83d\udc35"]=new hb("\ud83d\udc35",EmojiStrings.l_MonkeyFace,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc12"]=new hb("\ud83d\udc12",EmojiStrings.l_Monkey,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd8d"]=new hb("\ud83e\udd8d",EmojiStrings.l_Gorilla,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc36"]=new hb("\ud83d\udc36",EmojiStrings.l_DogFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc15"]=new hb("\ud83d\udc15",EmojiStrings.l_Dog,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc29"]=new hb("\ud83d\udc29",EmojiStrings.l_Poodle,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc3a"]=new hb("\ud83d\udc3a",EmojiStrings.l_WolfFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd8a"]=new hb("\ud83e\udd8a",EmojiStrings.l_FoxFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc31"]=new hb("\ud83d\udc31",EmojiStrings.l_CatFace,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc08"]=new hb("\ud83d\udc08",EmojiStrings.l_Cat,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd81"]=new hb("\ud83e\udd81",EmojiStrings.l_LionFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc2f"]=new hb("\ud83d\udc2f",EmojiStrings.l_TigerFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc05"]=new hb("\ud83d\udc05",EmojiStrings.l_Tiger,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc06"]=new hb("\ud83d\udc06",EmojiStrings.l_Leopard,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc34"]=new hb("\ud83d\udc34",EmojiStrings.l_HorseFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc0e"]=new hb("\ud83d\udc0e",EmojiStrings.l_Horse,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd8c"]=new hb("\ud83e\udd8c",EmojiStrings.l_Deer,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd84"]=new hb("\ud83e\udd84",EmojiStrings.l_UnicornFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc2e"]=new hb("\ud83d\udc2e",EmojiStrings.l_CowFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc02"]=new hb("\ud83d\udc02",EmojiStrings.l_Ox,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc03"]=new hb("\ud83d\udc03",EmojiStrings.l_WaterBuffalo,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc04"]=new hb("\ud83d\udc04",EmojiStrings.l_Cow,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc37"]=new hb("\ud83d\udc37",EmojiStrings.l_PigFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc16"]=new hb("\ud83d\udc16",EmojiStrings.l_Pig,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc17"]=new hb("\ud83d\udc17",EmojiStrings.l_Boar,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc3d"]=new hb("\ud83d\udc3d",EmojiStrings.l_PigNose,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc0f"]=new hb("\ud83d\udc0f",EmojiStrings.l_Ram,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc11"]=new hb("\ud83d\udc11",EmojiStrings.l_Sheep,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc10"]=new hb("\ud83d\udc10",EmojiStrings.l_Goat,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc2a"]=new hb("\ud83d\udc2a",EmojiStrings.l_Camel,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc2b"]=new hb("\ud83d\udc2b",EmojiStrings.l_TwoHumpCamel,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc18"]=new hb("\ud83d\udc18",EmojiStrings.l_Elephant,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd8f"]=new hb("\ud83e\udd8f",EmojiStrings.l_Rhinoceros,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc2d"]=new hb("\ud83d\udc2d",EmojiStrings.l_MouseFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc01"]=new hb("\ud83d\udc01",EmojiStrings.l_Mouse,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc00"]=new hb("\ud83d\udc00",EmojiStrings.l_Rat,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc39"]=new hb("\ud83d\udc39",EmojiStrings.l_HamsterFace,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc30"]=new hb("\ud83d\udc30",EmojiStrings.l_RabbitFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc07"]=new hb("\ud83d\udc07",EmojiStrings.l_Rabbit,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd87"]=new hb("\ud83e\udd87",EmojiStrings.l_Bat,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc3b"]=new hb("\ud83d\udc3b",EmojiStrings.l_BearFace,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc28"]=new hb("\ud83d\udc28",EmojiStrings.l_Koala,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc3c"]=new hb("\ud83d\udc3c",EmojiStrings.l_PandaFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83d\udc3e"]=new hb("\ud83d\udc3e",EmojiStrings.l_PawPrints,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMammal,!1,!1),fa["\ud83e\udd83"]=new hb("\ud83e\udd83",EmojiStrings.l_Turkey,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc14"]=new hb("\ud83d\udc14",EmojiStrings.l_Chicken,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc13"]=new hb("\ud83d\udc13",EmojiStrings.l_Rooster,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc23"]=new hb("\ud83d\udc23",EmojiStrings.l_HatchingChick,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc24"]=new hb("\ud83d\udc24",EmojiStrings.l_BabyChick,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc25"]=new hb("\ud83d\udc25",EmojiStrings.l_FrontFacingBabyChick,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc26"]=new hb("\ud83d\udc26",EmojiStrings.l_Bird,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc27"]=new hb("\ud83d\udc27",EmojiStrings.l_Penguin,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83e\udd85"]=new hb("\ud83e\udd85",EmojiStrings.l_Eagle,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83e\udd86"]=new hb("\ud83e\udd86",EmojiStrings.l_Duck,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83e\udd89"]=new hb("\ud83e\udd89",EmojiStrings.l_Owl,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBird,!1,!1),fa["\ud83d\udc38"]=new hb("\ud83d\udc38",EmojiStrings.l_FrogFace,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalAmphibian,!1,!1),fa["\ud83d\udc0a"]=new hb("\ud83d\udc0a",EmojiStrings.l_Crocodile,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalReptile,!1,!1),fa["\ud83d\udc22"]=new hb("\ud83d\udc22",EmojiStrings.l_Turtle,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalReptile,!1,!1),fa["\ud83e\udd8e"]=new hb("\ud83e\udd8e",EmojiStrings.l_Lizard,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalReptile,!1,!1),fa["\ud83d\udc0d"]=new hb("\ud83d\udc0d",EmojiStrings.l_Snake,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalReptile,!1,!1),fa["\ud83d\udc32"]=new hb("\ud83d\udc32",EmojiStrings.l_DragonFace,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalReptile,!1,!1),fa["\ud83d\udc09"]=new hb("\ud83d\udc09",EmojiStrings.l_Dragon,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalReptile,!1,!1),fa["\ud83d\udc33"]=new hb("\ud83d\udc33",EmojiStrings.l_SpoutingWhale,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc0b"]=new hb("\ud83d\udc0b",EmojiStrings.l_Whale,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc2c"]=new hb("\ud83d\udc2c",EmojiStrings.l_Dolphin,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc1f"]=new hb("\ud83d\udc1f",EmojiStrings.l_Fish,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc20"]=new hb("\ud83d\udc20",EmojiStrings.l_TropicalFish,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc21"]=new hb("\ud83d\udc21",EmojiStrings.l_Blowfish,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83e\udd88"]=new hb("\ud83e\udd88",EmojiStrings.l_Shark,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc19"]=new hb("\ud83d\udc19",EmojiStrings.l_Octopus,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83d\udc1a"]=new hb("\ud83d\udc1a",EmojiStrings.l_SpiralShell,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83e\udd80"]=new hb("\ud83e\udd80",EmojiStrings.l_Crab,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83e\udd90"]=new hb("\ud83e\udd90",EmojiStrings.l_Shrimp,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83e\udd91"]=new hb("\ud83e\udd91",EmojiStrings.l_Squid,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalMarine,!1,!1),fa["\ud83e\udd8b"]=new hb("\ud83e\udd8b",EmojiStrings.l_Butterfly,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83d\udc0c"]=new hb("\ud83d\udc0c",EmojiStrings.l_Snail,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83d\udc1b"]=new hb("\ud83d\udc1b",EmojiStrings.l_Bug,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83d\udc1c"]=new hb("\ud83d\udc1c",EmojiStrings.l_Ant,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83d\udc1d"]=new hb("\ud83d\udc1d",EmojiStrings.l_Honeybee,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83d\udc1e"]=new hb("\ud83d\udc1e",EmojiStrings.l_LadyBeetle,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83e\udd82"]=new hb("\ud83e\udd82",EmojiStrings.l_Scorpion,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_AnimalBug,!1,!1),fa["\ud83d\udc90"]=new hb("\ud83d\udc90",EmojiStrings.l_Bouquet,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf38"]=new hb("\ud83c\udf38",EmojiStrings.l_CherryBlossom,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83d\udcae"]=new hb("\ud83d\udcae",EmojiStrings.l_WhiteFlower,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf39"]=new hb("\ud83c\udf39",EmojiStrings.l_Rose,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83e\udd40"]=new hb("\ud83e\udd40",EmojiStrings.l_WiltedFlower,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf3a"]=new hb("\ud83c\udf3a",EmojiStrings.l_Hibiscus,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf3b"]=new hb("\ud83c\udf3b",EmojiStrings.l_Sunflower,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf3c"]=new hb("\ud83c\udf3c",EmojiStrings.l_Blossom,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf37"]=new hb("\ud83c\udf37",EmojiStrings.l_Tulip,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantFlower,!1,!1),fa["\ud83c\udf31"]=new hb("\ud83c\udf31",EmojiStrings.l_Seedling,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf32"]=new hb("\ud83c\udf32",EmojiStrings.l_EvergreenTree,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf33"]=new hb("\ud83c\udf33",EmojiStrings.l_DeciduousTree,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf34"]=new hb("\ud83c\udf34",EmojiStrings.l_PalmTree,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf35"]=new hb("\ud83c\udf35",EmojiStrings.l_Cactus,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf3e"]=new hb("\ud83c\udf3e",EmojiStrings.l_SheafOfRice,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf3f"]=new hb("\ud83c\udf3f",EmojiStrings.l_Herb,EmojiStrings.l_AnimalsAndNature,
EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf40"]=new hb("\ud83c\udf40",EmojiStrings.l_FourLeafClover,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf41"]=new hb("\ud83c\udf41",EmojiStrings.l_MapleLeaf,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf42"]=new hb("\ud83c\udf42",EmojiStrings.l_FallenLeaf,EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1),fa["\ud83c\udf43"]=new hb("\ud83c\udf43",EmojiStrings.l_LeafFlutteringInWind,
EmojiStrings.l_AnimalsAndNature,EmojiStrings.l_PlantOther,!1,!1));4===(M&4)&&(fa["\ud83c\udf47"]=new hb("\ud83c\udf47",EmojiStrings.l_Grapes,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf48"]=new hb("\ud83c\udf48",EmojiStrings.l_Melon,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf49"]=new hb("\ud83c\udf49",EmojiStrings.l_Watermelon,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf4a"]=new hb("\ud83c\udf4a",EmojiStrings.l_Tangerine,
EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf4b"]=new hb("\ud83c\udf4b",EmojiStrings.l_Lemon,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf4c"]=new hb("\ud83c\udf4c",EmojiStrings.l_Banana,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf4d"]=new hb("\ud83c\udf4d",EmojiStrings.l_Pineapple,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf4e"]=new hb("\ud83c\udf4e",EmojiStrings.l_RedApple,EmojiStrings.l_FoodAndDrink,
EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf4f"]=new hb("\ud83c\udf4f",EmojiStrings.l_GreenApple,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf50"]=new hb("\ud83c\udf50",EmojiStrings.l_Pear,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf51"]=new hb("\ud83c\udf51",EmojiStrings.l_Peach,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf52"]=new hb("\ud83c\udf52",EmojiStrings.l_Cherries,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,
!1,!1),fa["\ud83c\udf53"]=new hb("\ud83c\udf53",EmojiStrings.l_Strawberry,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83e\udd5d"]=new hb("\ud83e\udd5d",EmojiStrings.l_KiwiFruit,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83c\udf45"]=new hb("\ud83c\udf45",EmojiStrings.l_Tomato,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodFruit,!1,!1),fa["\ud83e\udd51"]=new hb("\ud83e\udd51",EmojiStrings.l_Avocado,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,
!1,!1),fa["\ud83c\udf46"]=new hb("\ud83c\udf46",EmojiStrings.l_Eggplant,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,!1,!1),fa["\ud83e\udd54"]=new hb("\ud83e\udd54",EmojiStrings.l_Potato,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,!1,!1),fa["\ud83e\udd55"]=new hb("\ud83e\udd55",EmojiStrings.l_Carrot,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,!1,!1),fa["\ud83c\udf3d"]=new hb("\ud83c\udf3d",EmojiStrings.l_EarOfCorn,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,
!1,!1),fa["\ud83e\udd52"]=new hb("\ud83e\udd52",EmojiStrings.l_Cucumber,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,!1,!1),fa["\ud83c\udf44"]=new hb("\ud83c\udf44",EmojiStrings.l_Mushroom,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,!1,!1),fa["\ud83e\udd5c"]=new hb("\ud83e\udd5c",EmojiStrings.l_Peanuts,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,!1,!1),fa["\ud83c\udf30"]=new hb("\ud83c\udf30",EmojiStrings.l_Chestnut,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodVegetable,
!1,!1),fa["\ud83c\udf5e"]=new hb("\ud83c\udf5e",EmojiStrings.l_Bread,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd50"]=new hb("\ud83e\udd50",EmojiStrings.l_Croissant,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd56"]=new hb("\ud83e\udd56",EmojiStrings.l_BaguetteBread,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd5e"]=new hb("\ud83e\udd5e",EmojiStrings.l_Pancakes,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,
!1,!1),fa["\ud83e\uddc0"]=new hb("\ud83e\uddc0",EmojiStrings.l_CheeseWedge,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf56"]=new hb("\ud83c\udf56",EmojiStrings.l_MeatOnBone,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf57"]=new hb("\ud83c\udf57",EmojiStrings.l_PoultryLeg,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd53"]=new hb("\ud83e\udd53",EmojiStrings.l_Bacon,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,
!1,!1),fa["\ud83c\udf54"]=new hb("\ud83c\udf54",EmojiStrings.l_Hamburger,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf5f"]=new hb("\ud83c\udf5f",EmojiStrings.l_FrenchFries,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf55"]=new hb("\ud83c\udf55",EmojiStrings.l_Pizza,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf2d"]=new hb("\ud83c\udf2d",EmojiStrings.l_HotDog,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,
!1,!1),fa["\ud83c\udf2e"]=new hb("\ud83c\udf2e",EmojiStrings.l_Taco,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf2f"]=new hb("\ud83c\udf2f",EmojiStrings.l_Burrito,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd59"]=new hb("\ud83e\udd59",EmojiStrings.l_StuffedFlatbread,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd5a"]=new hb("\ud83e\udd5a",EmojiStrings.l_Egg,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,
!1,!1),fa["\ud83c\udf73"]=new hb("\ud83c\udf73",EmojiStrings.l_Cooking,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd58"]=new hb("\ud83e\udd58",EmojiStrings.l_ShallowPanOfFood,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf72"]=new hb("\ud83c\udf72",EmojiStrings.l_PotOfFood,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83e\udd57"]=new hb("\ud83e\udd57",EmojiStrings.l_GreenSalad,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,
!1,!1),fa["\ud83c\udf7f"]=new hb("\ud83c\udf7f",EmojiStrings.l_Popcorn,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodPrepared,!1,!1),fa["\ud83c\udf71"]=new hb("\ud83c\udf71",EmojiStrings.l_BentoBox,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf58"]=new hb("\ud83c\udf58",EmojiStrings.l_RiceCracker,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf59"]=new hb("\ud83c\udf59",EmojiStrings.l_RiceBall,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,
!1,!1),fa["\ud83c\udf5a"]=new hb("\ud83c\udf5a",EmojiStrings.l_CookedRice,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf5b"]=new hb("\ud83c\udf5b",EmojiStrings.l_CurryRice,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf5c"]=new hb("\ud83c\udf5c",EmojiStrings.l_SteamingBowl,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf5d"]=new hb("\ud83c\udf5d",EmojiStrings.l_Spaghetti,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,
!1,!1),fa["\ud83c\udf60"]=new hb("\ud83c\udf60",EmojiStrings.l_RoastedSweetPotato,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf62"]=new hb("\ud83c\udf62",EmojiStrings.l_Oden,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf63"]=new hb("\ud83c\udf63",EmojiStrings.l_Sushi,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf64"]=new hb("\ud83c\udf64",EmojiStrings.l_FriedShrimp,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,
!1,!1),fa["\ud83c\udf65"]=new hb("\ud83c\udf65",EmojiStrings.l_FishCakeWithSwirl,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf61"]=new hb("\ud83c\udf61",EmojiStrings.l_Dango,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodAsian,!1,!1),fa["\ud83c\udf66"]=new hb("\ud83c\udf66",EmojiStrings.l_SoftIceCream,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf67"]=new hb("\ud83c\udf67",EmojiStrings.l_ShavedIce,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,
!1,!1),fa["\ud83c\udf68"]=new hb("\ud83c\udf68",EmojiStrings.l_IceCream,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf69"]=new hb("\ud83c\udf69",EmojiStrings.l_Doughnut,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf6a"]=new hb("\ud83c\udf6a",EmojiStrings.l_Cookie,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf82"]=new hb("\ud83c\udf82",EmojiStrings.l_BirthdayCake,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,
!1,!1),fa["\ud83c\udf70"]=new hb("\ud83c\udf70",EmojiStrings.l_Shortcake,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf6b"]=new hb("\ud83c\udf6b",EmojiStrings.l_ChocolateBar,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf6c"]=new hb("\ud83c\udf6c",EmojiStrings.l_Candy,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf6d"]=new hb("\ud83c\udf6d",EmojiStrings.l_Lollipop,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,
!1,!1),fa["\ud83c\udf6e"]=new hb("\ud83c\udf6e",EmojiStrings.l_Custard,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf6f"]=new hb("\ud83c\udf6f",EmojiStrings.l_HoneyPot,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_FoodSweet,!1,!1),fa["\ud83c\udf7c"]=new hb("\ud83c\udf7c",EmojiStrings.l_BabyBottle,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83e\udd5b"]=new hb("\ud83e\udd5b",EmojiStrings.l_GlassOfMilk,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),
fa["\u2615"]=new hb("\u2615",EmojiStrings.l_HotBeverage,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf75"]=new hb("\ud83c\udf75",EmojiStrings.l_TeacupWithoutHandle,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf76"]=new hb("\ud83c\udf76",EmojiStrings.l_Sake,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf7e"]=new hb("\ud83c\udf7e",EmojiStrings.l_BottleWithPoppingCork,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf77"]=
new hb("\ud83c\udf77",EmojiStrings.l_WineGlass,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf78"]=new hb("\ud83c\udf78",EmojiStrings.l_CocktailGlass,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf79"]=new hb("\ud83c\udf79",EmojiStrings.l_TropicalDrink,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf7a"]=new hb("\ud83c\udf7a",EmojiStrings.l_BeerMug,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf7b"]=new hb("\ud83c\udf7b",
EmojiStrings.l_ClinkingBeerMugs,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83e\udd42"]=new hb("\ud83e\udd42",EmojiStrings.l_ClinkingGlasses,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83e\udd43"]=new hb("\ud83e\udd43",EmojiStrings.l_TumblerGlass,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Drink,!1,!1),fa["\ud83c\udf74"]=new hb("\ud83c\udf74",EmojiStrings.l_ForkAndKnife,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Dishware,!1,!1),fa["\ud83e\udd44"]=new hb("\ud83e\udd44",
EmojiStrings.l_Spoon,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Dishware,!1,!1),fa["\ud83d\udd2a"]=new hb("\ud83d\udd2a",EmojiStrings.l_KitchenKnife,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Dishware,!1,!1),fa["\ud83c\udffa"]=new hb("\ud83c\udffa",EmojiStrings.l_Amphora,EmojiStrings.l_FoodAndDrink,EmojiStrings.l_Dishware,!1,!1));8===(M&8)&&(fa["\ud83c\udf0d"]=new hb("\ud83c\udf0d",EmojiStrings.l_GlobeShowingEuropeAfrica,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceMap,!1,!1),fa["\ud83c\udf0e"]=
new hb("\ud83c\udf0e",EmojiStrings.l_GlobeShowingAmericas,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceMap,!1,!1),fa["\ud83c\udf0f"]=new hb("\ud83c\udf0f",EmojiStrings.l_GlobeShowingAsiaAustralia,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceMap,!1,!1),fa["\ud83c\udf10"]=new hb("\ud83c\udf10",EmojiStrings.l_GlobeWithMeridians,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceMap,!1,!1),fa["\ud83d\uddfe"]=new hb("\ud83d\uddfe",EmojiStrings.l_MapOfJapan,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceMap,
!1,!1),fa["\ud83c\udf0b"]=new hb("\ud83c\udf0b",EmojiStrings.l_Volcano,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceGeographic,!1,!1),fa["\ud83d\uddfb"]=new hb("\ud83d\uddfb",EmojiStrings.l_MountFuji,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceGeographic,!1,!1),fa["\ud83c\udfe0"]=new hb("\ud83c\udfe0",EmojiStrings.l_House,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe1"]=new hb("\ud83c\udfe1",EmojiStrings.l_HouseWithGarden,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe2"]=new hb("\ud83c\udfe2",EmojiStrings.l_OfficeBuilding,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe3"]=new hb("\ud83c\udfe3",EmojiStrings.l_JapanesePostOffice,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe4"]=new hb("\ud83c\udfe4",EmojiStrings.l_PostOffice,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe5"]=new hb("\ud83c\udfe5",EmojiStrings.l_Hospital,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe6"]=new hb("\ud83c\udfe6",EmojiStrings.l_Bank,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe8"]=new hb("\ud83c\udfe8",EmojiStrings.l_Hotel,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfe9"]=new hb("\ud83c\udfe9",EmojiStrings.l_LoveHotel,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfea"]=new hb("\ud83c\udfea",EmojiStrings.l_ConvenienceStore,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfeb"]=new hb("\ud83c\udfeb",EmojiStrings.l_School,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfec"]=new hb("\ud83c\udfec",EmojiStrings.l_DepartmentStore,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfed"]=new hb("\ud83c\udfed",EmojiStrings.l_Factory,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udfef"]=new hb("\ud83c\udfef",
EmojiStrings.l_JapaneseAstle,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83c\udff0"]=new hb("\ud83c\udff0",EmojiStrings.l_Castle,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83d\udc92"]=new hb("\ud83d\udc92",EmojiStrings.l_Wedding,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83d\uddfc"]=new hb("\ud83d\uddfc",EmojiStrings.l_TokyoTower,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\ud83d\uddfd"]=
new hb("\ud83d\uddfd",EmojiStrings.l_StatueOfLiberty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceBuilding,!1,!1),fa["\u26ea"]=new hb("\u26ea",EmojiStrings.l_Church,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceReligious,!1,!1),fa["\ud83d\udd4c"]=new hb("\ud83d\udd4c",EmojiStrings.l_Mosque,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceReligious,!1,!1),fa["\ud83d\udd4d"]=new hb("\ud83d\udd4d",EmojiStrings.l_Synagogue,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceReligious,!1,!1),
fa["\ud83d\udd4b"]=new hb("\ud83d\udd4b",EmojiStrings.l_Kaaba,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceReligious,!1,!1),fa["\u26f2"]=new hb("\u26f2",EmojiStrings.l_Fountain,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\u26fa"]=new hb("\u26fa",EmojiStrings.l_Tent,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf01"]=new hb("\ud83c\udf01",EmojiStrings.l_Foggy,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf03"]=
new hb("\ud83c\udf03",EmojiStrings.l_NightWithStars,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf04"]=new hb("\ud83c\udf04",EmojiStrings.l_SunriseOverMountains,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf05"]=new hb("\ud83c\udf05",EmojiStrings.l_Sunrise,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf06"]=new hb("\ud83c\udf06",EmojiStrings.l_CityscapeAtDusk,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,
!1,!1),fa["\ud83c\udf07"]=new hb("\ud83c\udf07",EmojiStrings.l_Sunset,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf09"]=new hb("\ud83c\udf09",EmojiStrings.l_BridgeAtNight,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udf0c"]=new hb("\ud83c\udf0c",EmojiStrings.l_MilkyWay,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udfa0"]=new hb("\ud83c\udfa0",EmojiStrings.l_CarouselHorse,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,
!1,!1),fa["\ud83c\udfa1"]=new hb("\ud83c\udfa1",EmojiStrings.l_FerrisWheel,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udfa2"]=new hb("\ud83c\udfa2",EmojiStrings.l_RollerCoaster,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83d\udc88"]=new hb("\ud83d\udc88",EmojiStrings.l_BarberPole,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udfaa"]=new hb("\ud83c\udfaa",EmojiStrings.l_CircusTent,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udfad"]=new hb("\ud83c\udfad",EmojiStrings.l_PerformingArts,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udfa8"]=new hb("\ud83c\udfa8",EmojiStrings.l_ArtistPalette,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83c\udfb0"]=new hb("\ud83c\udfb0",EmojiStrings.l_SlotMachine,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_PlaceOther,!1,!1),fa["\ud83d\ude82"]=new hb("\ud83d\ude82",EmojiStrings.l_Locomotive,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude83"]=new hb("\ud83d\ude83",EmojiStrings.l_RailwayCar,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude84"]=new hb("\ud83d\ude84",EmojiStrings.l_HighSpeedTrain,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude85"]=new hb("\ud83d\ude85",EmojiStrings.l_HighSpeedTrainWithBulletNose,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude86"]=
new hb("\ud83d\ude86",EmojiStrings.l_Train,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude87"]=new hb("\ud83d\ude87",EmojiStrings.l_Metro,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude88"]=new hb("\ud83d\ude88",EmojiStrings.l_LightRail,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude89"]=new hb("\ud83d\ude89",EmojiStrings.l_Station,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,
!1,!1),fa["\ud83d\ude8a"]=new hb("\ud83d\ude8a",EmojiStrings.l_Tram,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude9d"]=new hb("\ud83d\ude9d",EmojiStrings.l_Monorail,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude9e"]=new hb("\ud83d\ude9e",EmojiStrings.l_MountainRailway,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude8b"]=new hb("\ud83d\ude8b",EmojiStrings.l_TramCar,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude8c"]=new hb("\ud83d\ude8c",EmojiStrings.l_Bus,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude8d"]=new hb("\ud83d\ude8d",EmojiStrings.l_OncomingBus,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude8e"]=new hb("\ud83d\ude8e",EmojiStrings.l_Trolleybus,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude90"]=new hb("\ud83d\ude90",EmojiStrings.l_Minibus,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude91"]=new hb("\ud83d\ude91",EmojiStrings.l_Ambulance,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude92"]=new hb("\ud83d\ude92",EmojiStrings.l_FireEngine,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude93"]=new hb("\ud83d\ude93",EmojiStrings.l_PoliceCar,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude94"]=new hb("\ud83d\ude94",
EmojiStrings.l_OncomingPoliceCar,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude95"]=new hb("\ud83d\ude95",EmojiStrings.l_Taxi,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude96"]=new hb("\ud83d\ude96",EmojiStrings.l_OncomingTaxi,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude97"]=new hb("\ud83d\ude97",EmojiStrings.l_Automobile,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,
!1),fa["\ud83d\ude98"]=new hb("\ud83d\ude98",EmojiStrings.l_OncomingAutomobile,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude99"]=new hb("\ud83d\ude99",EmojiStrings.l_SportUtilityVehicle,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude9a"]=new hb("\ud83d\ude9a",EmojiStrings.l_DeliveryTruck,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude9b"]=new hb("\ud83d\ude9b",EmojiStrings.l_ArticulatedLorry,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude9c"]=new hb("\ud83d\ude9c",EmojiStrings.l_Tractor,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udeb2"]=new hb("\ud83d\udeb2",EmojiStrings.l_Bicycle,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udef4"]=new hb("\ud83d\udef4",EmojiStrings.l_KickScooter,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udef5"]=new hb("\ud83d\udef5",
EmojiStrings.l_MotorScooter,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\ude8f"]=new hb("\ud83d\ude8f",EmojiStrings.l_BusStop,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\u26fd"]=new hb("\u26fd",EmojiStrings.l_FuelPump,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udea8"]=new hb("\ud83d\udea8",EmojiStrings.l_PoliceCarLight,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udea5"]=
new hb("\ud83d\udea5",EmojiStrings.l_HorizontalTrafficLight,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udea6"]=new hb("\ud83d\udea6",EmojiStrings.l_VerticalTrafficLight,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\udea7"]=new hb("\ud83d\udea7",EmojiStrings.l_Construction,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportGround,!1,!1),fa["\ud83d\uded1"]=new hb("\ud83d\uded1",EmojiStrings.l_StopSign,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_TransportGround,!1,!1),fa["\u2693"]=new hb("\u2693",EmojiStrings.l_Anchor,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportWater,!1,!1),fa["\u26f5"]=new hb("\u26f5",EmojiStrings.l_Sailboat,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportWater,!1,!1),fa["\ud83d\udef6"]=new hb("\ud83d\udef6",EmojiStrings.l_Canoe,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportWater,!1,!1),fa["\ud83d\udea4"]=new hb("\ud83d\udea4",EmojiStrings.l_Speedboat,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_TransportWater,!1,!1),fa["\ud83d\udea2"]=new hb("\ud83d\udea2",EmojiStrings.l_Ship,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportWater,!1,!1),fa["\ud83d\udeeb"]=new hb("\ud83d\udeeb",EmojiStrings.l_AirplaneDeparture,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\udeec"]=new hb("\ud83d\udeec",EmojiStrings.l_AirplaneArrival,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\udcba"]=new hb("\ud83d\udcba",EmojiStrings.l_Seat,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\ude81"]=new hb("\ud83d\ude81",EmojiStrings.l_Helicopter,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\ude9f"]=new hb("\ud83d\ude9f",EmojiStrings.l_SuspensionRailway,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\udea0"]=new hb("\ud83d\udea0",EmojiStrings.l_MountainCableway,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\udea1"]=new hb("\ud83d\udea1",
EmojiStrings.l_AerialTramway,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\ude80"]=new hb("\ud83d\ude80",EmojiStrings.l_Rocket,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_TransportAir,!1,!1),fa["\ud83d\udeaa"]=new hb("\ud83d\udeaa",EmojiStrings.l_Door,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Hotels,!1,!1),fa["\ud83d\udecc"]=new hb("\ud83d\udecc",EmojiStrings.l_PersonInBed,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Hotels,!1,!1),fa["\ud83d\udebd"]=new hb("\ud83d\udebd",
EmojiStrings.l_Toilet,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Hotels,!1,!1),fa["\ud83d\udebf"]=new hb("\ud83d\udebf",EmojiStrings.l_Shower,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Hotels,!1,!1),fa["\ud83d\udec0"]=new hb("\ud83d\udec0",EmojiStrings.l_PersonTakingBath,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Hotels,!1,!1),fa["\ud83d\udec1"]=new hb("\ud83d\udec1",EmojiStrings.l_Bathtub,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Hotels,!1,!1),fa["\u231b"]=new hb("\u231b",EmojiStrings.l_Hourglass,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\u23f3"]=new hb("\u23f3",EmojiStrings.l_HourglassWithFlowingSand,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\u231a"]=new hb("\u231a",EmojiStrings.l_Watch,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\u23f0"]=new hb("\u23f0",EmojiStrings.l_AlarmClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd5b"]=new hb("\ud83d\udd5b",EmojiStrings.l_TwelveOClock,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd67"]=new hb("\ud83d\udd67",EmojiStrings.l_TwelveThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd50"]=new hb("\ud83d\udd50",EmojiStrings.l_OneOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd5c"]=new hb("\ud83d\udd5c",EmojiStrings.l_OneThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd51"]=new hb("\ud83d\udd51",EmojiStrings.l_TwoOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,
!1,!1),fa["\ud83d\udd5d"]=new hb("\ud83d\udd5d",EmojiStrings.l_TwoThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd52"]=new hb("\ud83d\udd52",EmojiStrings.l_ThreeOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd5e"]=new hb("\ud83d\udd5e",EmojiStrings.l_ThreeThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd53"]=new hb("\ud83d\udd53",EmojiStrings.l_FourOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,
!1,!1),fa["\ud83d\udd5f"]=new hb("\ud83d\udd5f",EmojiStrings.l_FourThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd54"]=new hb("\ud83d\udd54",EmojiStrings.l_FiveOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd60"]=new hb("\ud83d\udd60",EmojiStrings.l_FiveThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd55"]=new hb("\ud83d\udd55",EmojiStrings.l_SixOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,
!1),fa["\ud83d\udd61"]=new hb("\ud83d\udd61",EmojiStrings.l_SixThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd56"]=new hb("\ud83d\udd56",EmojiStrings.l_SevenOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd62"]=new hb("\ud83d\udd62",EmojiStrings.l_SevenThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd57"]=new hb("\ud83d\udd57",EmojiStrings.l_EightOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,
!1),fa["\ud83d\udd63"]=new hb("\ud83d\udd63",EmojiStrings.l_EightThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd58"]=new hb("\ud83d\udd58",EmojiStrings.l_NineOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd64"]=new hb("\ud83d\udd64",EmojiStrings.l_NineThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd59"]=new hb("\ud83d\udd59",EmojiStrings.l_TenOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),
fa["\ud83d\udd65"]=new hb("\ud83d\udd65",EmojiStrings.l_TenThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd5a"]=new hb("\ud83d\udd5a",EmojiStrings.l_ElevenOClock,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83d\udd66"]=new hb("\ud83d\udd66",EmojiStrings.l_ElevenThirty,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_Time,!1,!1),fa["\ud83c\udf11"]=new hb("\ud83c\udf11",EmojiStrings.l_NewMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,
!1,!1),fa["\ud83c\udf12"]=new hb("\ud83c\udf12",EmojiStrings.l_WaxingCrescentMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf13"]=new hb("\ud83c\udf13",EmojiStrings.l_FirstQuarterMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf14"]=new hb("\ud83c\udf14",EmojiStrings.l_WaxingGibbousMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf15"]=new hb("\ud83c\udf15",EmojiStrings.l_FullMoon,EmojiStrings.l_TravelAndPlaces,
EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf16"]=new hb("\ud83c\udf16",EmojiStrings.l_WaningGibbousMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf17"]=new hb("\ud83c\udf17",EmojiStrings.l_LastQuarterMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf18"]=new hb("\ud83c\udf18",EmojiStrings.l_WaningCrescentMoon,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf19"]=new hb("\ud83c\udf19",EmojiStrings.l_CrescentMoon,
EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf1a"]=new hb("\ud83c\udf1a",EmojiStrings.l_NewMoonFace,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf1b"]=new hb("\ud83c\udf1b",EmojiStrings.l_FirstQuarterMoonWithFace,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf1c"]=new hb("\ud83c\udf1c",EmojiStrings.l_LastQuarterMoonWithFace,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf1d"]=
new hb("\ud83c\udf1d",EmojiStrings.l_FullMoonWithFace,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf1e"]=new hb("\ud83c\udf1e",EmojiStrings.l_SunWithFace,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\u2b50"]=new hb("\u2b50",EmojiStrings.l_WhiteMediumStar,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf1f"]=new hb("\ud83c\udf1f",EmojiStrings.l_GlowingStar,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,
!1,!1),fa["\ud83c\udf20"]=new hb("\ud83c\udf20",EmojiStrings.l_ShootingStar,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\u26c5"]=new hb("\u26c5",EmojiStrings.l_SunBehindCloud,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf00"]=new hb("\ud83c\udf00",EmojiStrings.l_Cyclone,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf08"]=new hb("\ud83c\udf08",EmojiStrings.l_Rainbow,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,
!1,!1),fa["\ud83c\udf02"]=new hb("\ud83c\udf02",EmojiStrings.l_ClosedUmbrella,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\u2614"]=new hb("\u2614",EmojiStrings.l_UmbrellaWithRainDrops,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\u26a1"]=new hb("\u26a1",EmojiStrings.l_HighVoltage,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\u26c4"]=new hb("\u26c4",EmojiStrings.l_SnowmanWithoutSnow,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,
!1,!1),fa["\ud83d\udd25"]=new hb("\ud83d\udd25",EmojiStrings.l_Fire,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83d\udca7"]=new hb("\ud83d\udca7",EmojiStrings.l_Droplet,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1),fa["\ud83c\udf0a"]=new hb("\ud83c\udf0a",EmojiStrings.l_WaterWave,EmojiStrings.l_TravelAndPlaces,EmojiStrings.l_SkyAndWeather,!1,!1));16===(M&16)&&(fa["\ud83c\udf83"]=new hb("\ud83c\udf83",EmojiStrings.l_JackOLantern,EmojiStrings.l_Activities,
EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf84"]=new hb("\ud83c\udf84",EmojiStrings.l_ChristmasTree,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf86"]=new hb("\ud83c\udf86",EmojiStrings.l_Fireworks,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf87"]=new hb("\ud83c\udf87",EmojiStrings.l_Sparkler,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\u2728"]=new hb("\u2728",EmojiStrings.l_Sparkles,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf88"]=
new hb("\ud83c\udf88",EmojiStrings.l_Balloon,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf89"]=new hb("\ud83c\udf89",EmojiStrings.l_PartyPopper,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf8a"]=new hb("\ud83c\udf8a",EmojiStrings.l_ConfettiBall,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf8b"]=new hb("\ud83c\udf8b",EmojiStrings.l_TanabataTree,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf8d"]=new hb("\ud83c\udf8d",
EmojiStrings.l_PineDecoration,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf8e"]=new hb("\ud83c\udf8e",EmojiStrings.l_JapaneseOlls,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf8f"]=new hb("\ud83c\udf8f",EmojiStrings.l_CarpStreamer,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf90"]=new hb("\ud83c\udf90",EmojiStrings.l_WindChime,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf91"]=new hb("\ud83c\udf91",EmojiStrings.l_MoonViewingCeremony,
EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf80"]=new hb("\ud83c\udf80",EmojiStrings.l_Ribbon,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udf81"]=new hb("\ud83c\udf81",EmojiStrings.l_WrappedGift,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udfab"]=new hb("\ud83c\udfab",EmojiStrings.l_Ticket,EmojiStrings.l_Activities,EmojiStrings.l_Event,!1,!1),fa["\ud83c\udfc6"]=new hb("\ud83c\udfc6",EmojiStrings.l_Trophy,EmojiStrings.l_Activities,EmojiStrings.l_AwardMedal,
!1,!1),fa["\ud83c\udfc5"]=new hb("\ud83c\udfc5",EmojiStrings.l_SportsMedal,EmojiStrings.l_Activities,EmojiStrings.l_AwardMedal,!1,!1),fa["\ud83e\udd47"]=new hb("\ud83e\udd47",EmojiStrings.l_1stPlaceMedal,EmojiStrings.l_Activities,EmojiStrings.l_AwardMedal,!1,!1),fa["\ud83e\udd48"]=new hb("\ud83e\udd48",EmojiStrings.l_2ndPlaceMedal,EmojiStrings.l_Activities,EmojiStrings.l_AwardMedal,!1,!1),fa["\ud83e\udd49"]=new hb("\ud83e\udd49",EmojiStrings.l_3rdPlaceMedal,EmojiStrings.l_Activities,EmojiStrings.l_AwardMedal,
!1,!1),fa["\u26bd"]=new hb("\u26bd",EmojiStrings.l_SoccerBall,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\u26be"]=new hb("\u26be",EmojiStrings.l_Baseball,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfc0"]=new hb("\ud83c\udfc0",EmojiStrings.l_Basketball,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfd0"]=new hb("\ud83c\udfd0",EmojiStrings.l_Volleyball,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfc8"]=new hb("\ud83c\udfc8",
EmojiStrings.l_AmericanFootball,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfc9"]=new hb("\ud83c\udfc9",EmojiStrings.l_RugbyFootball,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfbe"]=new hb("\ud83c\udfbe",EmojiStrings.l_Tennis,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfb1"]=new hb("\ud83c\udfb1",EmojiStrings.l_Pool8Ball,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfb3"]=new hb("\ud83c\udfb3",EmojiStrings.l_Bowling,
EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfcf"]=new hb("\ud83c\udfcf",EmojiStrings.l_Cricket,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfd1"]=new hb("\ud83c\udfd1",EmojiStrings.l_FieldHockey,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfd2"]=new hb("\ud83c\udfd2",EmojiStrings.l_IceHockey,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfd3"]=new hb("\ud83c\udfd3",EmojiStrings.l_PingPong,EmojiStrings.l_Activities,
EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udff8"]=new hb("\ud83c\udff8",EmojiStrings.l_Badminton,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83e\udd4a"]=new hb("\ud83e\udd4a",EmojiStrings.l_BoxingGlove,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83e\udd4b"]=new hb("\ud83e\udd4b",EmojiStrings.l_MartialArtsUniform,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83e\udd45"]=new hb("\ud83e\udd45",EmojiStrings.l_GoalNet,EmojiStrings.l_Activities,EmojiStrings.l_Sport,
!1,!1),fa["\ud83c\udfaf"]=new hb("\ud83c\udfaf",EmojiStrings.l_DirectHit,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\u26f3"]=new hb("\u26f3",EmojiStrings.l_FlagInHole,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfa3"]=new hb("\ud83c\udfa3",EmojiStrings.l_FishingPole,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfbd"]=new hb("\ud83c\udfbd",EmojiStrings.l_RunningShirt,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfbf"]=new hb("\ud83c\udfbf",
EmojiStrings.l_Skis,EmojiStrings.l_Activities,EmojiStrings.l_Sport,!1,!1),fa["\ud83c\udfae"]=new hb("\ud83c\udfae",EmojiStrings.l_VideoGame,EmojiStrings.l_Activities,EmojiStrings.l_Game,!1,!1),fa["\ud83c\udfb2"]=new hb("\ud83c\udfb2",EmojiStrings.l_GameDie,EmojiStrings.l_Activities,EmojiStrings.l_Game,!1,!1),fa["\ud83c\udccf"]=new hb("\ud83c\udccf",EmojiStrings.l_Joker,EmojiStrings.l_Activities,EmojiStrings.l_Game,!1,!1),fa["\ud83c\udc04"]=new hb("\ud83c\udc04",EmojiStrings.l_MahjongRedDragon,EmojiStrings.l_Activities,
EmojiStrings.l_Game,!1,!1),fa["\ud83c\udfb4"]=new hb("\ud83c\udfb4",EmojiStrings.l_FlowerPlayingCards,EmojiStrings.l_Activities,EmojiStrings.l_Game,!1,!1));32===(M&32)&&(fa["\ud83d\udd07"]=new hb("\ud83d\udd07",EmojiStrings.l_MutedSpeaker,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udd08"]=new hb("\ud83d\udd08",EmojiStrings.l_SpeakerLowVolume,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udd09"]=new hb("\ud83d\udd09",EmojiStrings.l_SpeakerMediumVolume,EmojiStrings.l_Objects,
EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udd0a"]=new hb("\ud83d\udd0a",EmojiStrings.l_SpeakerHighVolume,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udce2"]=new hb("\ud83d\udce2",EmojiStrings.l_Loudspeaker,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udce3"]=new hb("\ud83d\udce3",EmojiStrings.l_Megaphone,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udcef"]=new hb("\ud83d\udcef",EmojiStrings.l_PostalHorn,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,
!1),fa["\ud83d\udd14"]=new hb("\ud83d\udd14",EmojiStrings.l_Bell,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83d\udd15"]=new hb("\ud83d\udd15",EmojiStrings.l_BellWithSlash,EmojiStrings.l_Objects,EmojiStrings.l_Sound,!1,!1),fa["\ud83c\udfbc"]=new hb("\ud83c\udfbc",EmojiStrings.l_MusicalScore,EmojiStrings.l_Objects,EmojiStrings.l_Music,!1,!1),fa["\ud83c\udfb5"]=new hb("\ud83c\udfb5",EmojiStrings.l_MusicalNote,EmojiStrings.l_Objects,EmojiStrings.l_Music,!1,!1),fa["\ud83c\udfb6"]=new hb("\ud83c\udfb6",
EmojiStrings.l_MusicalNotes,EmojiStrings.l_Objects,EmojiStrings.l_Music,!1,!1),fa["\ud83c\udfa4"]=new hb("\ud83c\udfa4",EmojiStrings.l_Microphone,EmojiStrings.l_Objects,EmojiStrings.l_Music,!1,!1),fa["\ud83c\udfa7"]=new hb("\ud83c\udfa7",EmojiStrings.l_Headphone,EmojiStrings.l_Objects,EmojiStrings.l_Music,!1,!1),fa["\ud83d\udcfb"]=new hb("\ud83d\udcfb",EmojiStrings.l_Radio,EmojiStrings.l_Objects,EmojiStrings.l_Music,!1,!1),fa["\ud83c\udfb7"]=new hb("\ud83c\udfb7",EmojiStrings.l_Saxophone,EmojiStrings.l_Objects,
EmojiStrings.l_MusicalInstrument,!1,!1),fa["\ud83c\udfb8"]=new hb("\ud83c\udfb8",EmojiStrings.l_Guitar,EmojiStrings.l_Objects,EmojiStrings.l_MusicalInstrument,!1,!1),fa["\ud83c\udfb9"]=new hb("\ud83c\udfb9",EmojiStrings.l_MusicalKeyboard,EmojiStrings.l_Objects,EmojiStrings.l_MusicalInstrument,!1,!1),fa["\ud83c\udfba"]=new hb("\ud83c\udfba",EmojiStrings.l_Trumpet,EmojiStrings.l_Objects,EmojiStrings.l_MusicalInstrument,!1,!1),fa["\ud83c\udfbb"]=new hb("\ud83c\udfbb",EmojiStrings.l_Violin,EmojiStrings.l_Objects,
EmojiStrings.l_MusicalInstrument,!1,!1),fa["\ud83e\udd41"]=new hb("\ud83e\udd41",EmojiStrings.l_Drum,EmojiStrings.l_Objects,EmojiStrings.l_MusicalInstrument,!1,!1),fa["\ud83d\udcf1"]=new hb("\ud83d\udcf1",EmojiStrings.l_MobilePhone,EmojiStrings.l_Objects,EmojiStrings.l_Phone,!1,!1),fa["\ud83d\udcf2"]=new hb("\ud83d\udcf2",EmojiStrings.l_MobilePhoneWithArrow,EmojiStrings.l_Objects,EmojiStrings.l_Phone,!1,!1),fa["\ud83d\udcde"]=new hb("\ud83d\udcde",EmojiStrings.l_TelephoneReceiver,EmojiStrings.l_Objects,
EmojiStrings.l_Phone,!1,!1),fa["\ud83d\udcdf"]=new hb("\ud83d\udcdf",EmojiStrings.l_Pager,EmojiStrings.l_Objects,EmojiStrings.l_Phone,!1,!1),fa["\ud83d\udce0"]=new hb("\ud83d\udce0",EmojiStrings.l_FaxMachine,EmojiStrings.l_Objects,EmojiStrings.l_Phone,!1,!1),fa["\ud83d\udd0b"]=new hb("\ud83d\udd0b",EmojiStrings.l_Battery,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83d\udd0c"]=new hb("\ud83d\udd0c",EmojiStrings.l_ElectricPlug,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83d\udcbb"]=
new hb("\ud83d\udcbb",EmojiStrings.l_LaptopComputer,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83d\udcbd"]=new hb("\ud83d\udcbd",EmojiStrings.l_ComputerDisk,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83d\udcbe"]=new hb("\ud83d\udcbe",EmojiStrings.l_FloppyDisk,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83d\udcbf"]=new hb("\ud83d\udcbf",EmojiStrings.l_OpticalDisk,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83d\udcc0"]=new hb("\ud83d\udcc0",
EmojiStrings.l_Dvd,EmojiStrings.l_Objects,EmojiStrings.l_Computer,!1,!1),fa["\ud83c\udfa5"]=new hb("\ud83c\udfa5",EmojiStrings.l_MovieCamera,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83c\udfac"]=new hb("\ud83c\udfac",EmojiStrings.l_ClapperBoard,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udcfa"]=new hb("\ud83d\udcfa",EmojiStrings.l_Television,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udcf7"]=new hb("\ud83d\udcf7",EmojiStrings.l_Camera,
EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udcf8"]=new hb("\ud83d\udcf8",EmojiStrings.l_CameraWithFlash,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udcf9"]=new hb("\ud83d\udcf9",EmojiStrings.l_VideoCamera,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udcfc"]=new hb("\ud83d\udcfc",EmojiStrings.l_Videocassette,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udd0d"]=new hb("\ud83d\udd0d",EmojiStrings.l_LeftPointingMagnifyingGlass,
EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udd0e"]=new hb("\ud83d\udd0e",EmojiStrings.l_RightPointingMagnifyingGlass,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udd2c"]=new hb("\ud83d\udd2c",EmojiStrings.l_Microscope,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udd2d"]=new hb("\ud83d\udd2d",EmojiStrings.l_Telescope,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udce1"]=new hb("\ud83d\udce1",EmojiStrings.l_SatelliteAntenna,
EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udca1"]=new hb("\ud83d\udca1",EmojiStrings.l_LightBulb,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udd26"]=new hb("\ud83d\udd26",EmojiStrings.l_Flashlight,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83c\udfee"]=new hb("\ud83c\udfee",EmojiStrings.l_RedPaperLantern,EmojiStrings.l_Objects,EmojiStrings.l_LightAndVideo,!1,!1),fa["\ud83d\udcd4"]=new hb("\ud83d\udcd4",EmojiStrings.l_NotebookWithDecorativeCover,
EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd5"]=new hb("\ud83d\udcd5",EmojiStrings.l_ClosedBook,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd6"]=new hb("\ud83d\udcd6",EmojiStrings.l_OpenBook,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd7"]=new hb("\ud83d\udcd7",EmojiStrings.l_GreenBook,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd8"]=new hb("\ud83d\udcd8",EmojiStrings.l_BlueBook,EmojiStrings.l_Objects,
EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd9"]=new hb("\ud83d\udcd9",EmojiStrings.l_OrangeBook,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcda"]=new hb("\ud83d\udcda",EmojiStrings.l_Books,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd3"]=new hb("\ud83d\udcd3",EmojiStrings.l_Notebook,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd2"]=new hb("\ud83d\udcd2",EmojiStrings.l_Ledger,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,
!1,!1),fa["\ud83d\udcc3"]=new hb("\ud83d\udcc3",EmojiStrings.l_PageWithCurl,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcdc"]=new hb("\ud83d\udcdc",EmojiStrings.l_Scroll,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcc4"]=new hb("\ud83d\udcc4",EmojiStrings.l_PageFacingUp,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcf0"]=new hb("\ud83d\udcf0",EmojiStrings.l_Newspaper,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcd1"]=
new hb("\ud83d\udcd1",EmojiStrings.l_BookmarkTabs,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udd16"]=new hb("\ud83d\udd16",EmojiStrings.l_Bookmark,EmojiStrings.l_Objects,EmojiStrings.l_BookPaper,!1,!1),fa["\ud83d\udcb0"]=new hb("\ud83d\udcb0",EmojiStrings.l_MoneyBag,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb4"]=new hb("\ud83d\udcb4",EmojiStrings.l_YenBanknote,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb5"]=new hb("\ud83d\udcb5",
EmojiStrings.l_DollarBanknote,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb6"]=new hb("\ud83d\udcb6",EmojiStrings.l_EuroBanknote,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb7"]=new hb("\ud83d\udcb7",EmojiStrings.l_PoundBanknote,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb8"]=new hb("\ud83d\udcb8",EmojiStrings.l_MoneyWithWings,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb3"]=new hb("\ud83d\udcb3",EmojiStrings.l_CreditCard,
EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb9"]=new hb("\ud83d\udcb9",EmojiStrings.l_ChartIncreasingWithYen,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb1"]=new hb("\ud83d\udcb1",EmojiStrings.l_CurrencyExchange,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udcb2"]=new hb("\ud83d\udcb2",EmojiStrings.l_HeavyDollarSign,EmojiStrings.l_Objects,EmojiStrings.l_Money,!1,!1),fa["\ud83d\udce7"]=new hb("\ud83d\udce7",EmojiStrings.l_EMail,EmojiStrings.l_Objects,
EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udce8"]=new hb("\ud83d\udce8",EmojiStrings.l_IncomingEnvelope,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udce9"]=new hb("\ud83d\udce9",EmojiStrings.l_EnvelopeWithArrow,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udce4"]=new hb("\ud83d\udce4",EmojiStrings.l_OutboxTray,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udce5"]=new hb("\ud83d\udce5",EmojiStrings.l_InboxTray,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,
!1),fa["\ud83d\udce6"]=new hb("\ud83d\udce6",EmojiStrings.l_Package,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udceb"]=new hb("\ud83d\udceb",EmojiStrings.l_ClosedMailboxWithRaisedFlag,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udcea"]=new hb("\ud83d\udcea",EmojiStrings.l_ClosedMailboxWithLoweredFlag,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udcec"]=new hb("\ud83d\udcec",EmojiStrings.l_OpenMailboxWithRaisedFlag,EmojiStrings.l_Objects,EmojiStrings.l_Mail,
!1,!1),fa["\ud83d\udced"]=new hb("\ud83d\udced",EmojiStrings.l_OpenMailboxWithLoweredFlag,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udcee"]=new hb("\ud83d\udcee",EmojiStrings.l_Postbox,EmojiStrings.l_Objects,EmojiStrings.l_Mail,!1,!1),fa["\ud83d\udcdd"]=new hb("\ud83d\udcdd",EmojiStrings.l_Memo,EmojiStrings.l_Objects,EmojiStrings.l_Writing,!1,!1),fa["\ud83d\udcbc"]=new hb("\ud83d\udcbc",EmojiStrings.l_Briefcase,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc1"]=
new hb("\ud83d\udcc1",EmojiStrings.l_FileFolder,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc2"]=new hb("\ud83d\udcc2",EmojiStrings.l_OpenFileFolder,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc5"]=new hb("\ud83d\udcc5",EmojiStrings.l_Calendar,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc6"]=new hb("\ud83d\udcc6",EmojiStrings.l_TearOffCalendar,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc7"]=new hb("\ud83d\udcc7",
EmojiStrings.l_CardIndex,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc8"]=new hb("\ud83d\udcc8",EmojiStrings.l_ChartIncreasing,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcc9"]=new hb("\ud83d\udcc9",EmojiStrings.l_ChartDecreasing,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcca"]=new hb("\ud83d\udcca",EmojiStrings.l_BarChart,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udccb"]=new hb("\ud83d\udccb",EmojiStrings.l_Clipboard,
EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udccc"]=new hb("\ud83d\udccc",EmojiStrings.l_Pushpin,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udccd"]=new hb("\ud83d\udccd",EmojiStrings.l_RoundPushpin,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udcce"]=new hb("\ud83d\udcce",EmojiStrings.l_Paperclip,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udccf"]=new hb("\ud83d\udccf",EmojiStrings.l_StraightRuler,EmojiStrings.l_Objects,EmojiStrings.l_Office,
!1,!1),fa["\ud83d\udcd0"]=new hb("\ud83d\udcd0",EmojiStrings.l_TriangularRuler,EmojiStrings.l_Objects,EmojiStrings.l_Office,!1,!1),fa["\ud83d\udd12"]=new hb("\ud83d\udd12",EmojiStrings.l_Locked,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd13"]=new hb("\ud83d\udd13",EmojiStrings.l_Unlocked,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd0f"]=new hb("\ud83d\udd0f",EmojiStrings.l_LockedWithPen,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd10"]=new hb("\ud83d\udd10",
EmojiStrings.l_LockedWithKey,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd11"]=new hb("\ud83d\udd11",EmojiStrings.l_Key,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd28"]=new hb("\ud83d\udd28",EmojiStrings.l_Hammer,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd2b"]=new hb("\ud83d\udd2b",EmojiStrings.l_Pistol,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83c\udff9"]=new hb("\ud83c\udff9",EmojiStrings.l_BowAndArrow,EmojiStrings.l_Objects,
EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd27"]=new hb("\ud83d\udd27",EmojiStrings.l_Wrench,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd29"]=new hb("\ud83d\udd29",EmojiStrings.l_NutAndBolt,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udd17"]=new hb("\ud83d\udd17",EmojiStrings.l_Link,EmojiStrings.l_Objects,EmojiStrings.l_Tool,!1,!1),fa["\ud83d\udc89"]=new hb("\ud83d\udc89",EmojiStrings.l_Syringe,EmojiStrings.l_Objects,EmojiStrings.l_Medical,!1,!1),fa["\ud83d\udc8a"]=
new hb("\ud83d\udc8a",EmojiStrings.l_Pill,EmojiStrings.l_Objects,EmojiStrings.l_Medical,!1,!1),fa["\ud83d\udeac"]=new hb("\ud83d\udeac",EmojiStrings.l_Cigarette,EmojiStrings.l_Objects,EmojiStrings.l_OtherObject,!1,!1),fa["\ud83d\uddff"]=new hb("\ud83d\uddff",EmojiStrings.l_Moai,EmojiStrings.l_Objects,EmojiStrings.l_OtherObject,!1,!1),fa["\ud83d\udd2e"]=new hb("\ud83d\udd2e",EmojiStrings.l_CrystalBall,EmojiStrings.l_Objects,EmojiStrings.l_OtherObject,!1,!1),fa["\ud83d\uded2"]=new hb("\ud83d\uded2",
EmojiStrings.l_ShoppingCart,EmojiStrings.l_Objects,EmojiStrings.l_OtherObject,!1,!1));64===(M&64)&&(fa["\ud83c\udfe7"]=new hb("\ud83c\udfe7",EmojiStrings.l_ATMSign,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udeae"]=new hb("\ud83d\udeae",EmojiStrings.l_LitterInBinSign,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udeb0"]=new hb("\ud83d\udeb0",EmojiStrings.l_PotableWater,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\u267f"]=new hb("\u267f",
EmojiStrings.l_WheelchairSymbol,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udeb9"]=new hb("\ud83d\udeb9",EmojiStrings.l_MeNSRoom,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udeba"]=new hb("\ud83d\udeba",EmojiStrings.l_WomeNSRoom,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udebb"]=new hb("\ud83d\udebb",EmojiStrings.l_Restroom,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udebc"]=new hb("\ud83d\udebc",
EmojiStrings.l_BabySymbol,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udebe"]=new hb("\ud83d\udebe",EmojiStrings.l_WaterCloset,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udec2"]=new hb("\ud83d\udec2",EmojiStrings.l_PassportControl,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udec3"]=new hb("\ud83d\udec3",EmojiStrings.l_Customs,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udec4"]=new hb("\ud83d\udec4",
EmojiStrings.l_BaggageClaim,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udec5"]=new hb("\ud83d\udec5",EmojiStrings.l_LeftLuggage,EmojiStrings.l_Symbols,EmojiStrings.l_TransportSign,!1,!1),fa["\ud83d\udeb8"]=new hb("\ud83d\udeb8",EmojiStrings.l_ChildrenCrossing,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\u26d4"]=new hb("\u26d4",EmojiStrings.l_NoEntry,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udeab"]=new hb("\ud83d\udeab",EmojiStrings.l_Prohibited,
EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udeb3"]=new hb("\ud83d\udeb3",EmojiStrings.l_NoBicycles,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udead"]=new hb("\ud83d\udead",EmojiStrings.l_NoSmoking,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udeaf"]=new hb("\ud83d\udeaf",EmojiStrings.l_NoLittering,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udeb1"]=new hb("\ud83d\udeb1",EmojiStrings.l_NonPotableWater,EmojiStrings.l_Symbols,
EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udeb7"]=new hb("\ud83d\udeb7",EmojiStrings.l_NoPedestrians,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udcf5"]=new hb("\ud83d\udcf5",EmojiStrings.l_NoMobilePhones,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udd1e"]=new hb("\ud83d\udd1e",EmojiStrings.l_NoOneUnderEighteen,EmojiStrings.l_Symbols,EmojiStrings.l_Warnings,!1,!1),fa["\ud83d\udd03"]=new hb("\ud83d\udd03",EmojiStrings.l_ClockwiseVerticalArrows,EmojiStrings.l_Symbols,
EmojiStrings.l_Arrow,!1,!1),fa["\ud83d\udd04"]=new hb("\ud83d\udd04",EmojiStrings.l_AnticlockwiseArrowsButton,EmojiStrings.l_Symbols,EmojiStrings.l_Arrow,!1,!1),fa["\ud83d\udd19"]=new hb("\ud83d\udd19",EmojiStrings.l_BACKArrow,EmojiStrings.l_Symbols,EmojiStrings.l_Arrow,!1,!1),fa["\ud83d\udd1a"]=new hb("\ud83d\udd1a",EmojiStrings.l_ENDArrow,EmojiStrings.l_Symbols,EmojiStrings.l_Arrow,!1,!1),fa["\ud83d\udd1b"]=new hb("\ud83d\udd1b",EmojiStrings.l_ONArrow,EmojiStrings.l_Symbols,EmojiStrings.l_Arrow,
!1,!1),fa["\ud83d\udd1c"]=new hb("\ud83d\udd1c",EmojiStrings.l_SOONArrow,EmojiStrings.l_Symbols,EmojiStrings.l_Arrow,!1,!1),fa["\ud83d\udd1d"]=new hb("\ud83d\udd1d",EmojiStrings.l_TOPArrow,EmojiStrings.l_Symbols,EmojiStrings.l_Arrow,!1,!1),fa["\ud83d\uded0"]=new hb("\ud83d\uded0",EmojiStrings.l_PlaceOfWorship,EmojiStrings.l_Symbols,EmojiStrings.l_Religion,!1,!1),fa["\ud83d\udd4e"]=new hb("\ud83d\udd4e",EmojiStrings.l_Menorah,EmojiStrings.l_Symbols,EmojiStrings.l_Religion,!1,!1),fa["\ud83d\udd2f"]=
new hb("\ud83d\udd2f",EmojiStrings.l_DottedSixPointedStar,EmojiStrings.l_Symbols,EmojiStrings.l_Religion,!1,!1),fa["\u2648"]=new hb("\u2648",EmojiStrings.l_Aries,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u2649"]=new hb("\u2649",EmojiStrings.l_Taurus,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u264a"]=new hb("\u264a",EmojiStrings.l_Gemini,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u264b"]=new hb("\u264b",EmojiStrings.l_Cancer,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,
!1,!1),fa["\u264c"]=new hb("\u264c",EmojiStrings.l_Leo,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u264d"]=new hb("\u264d",EmojiStrings.l_Virgo,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u264e"]=new hb("\u264e",EmojiStrings.l_Libra,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u264f"]=new hb("\u264f",EmojiStrings.l_Scorpius,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u2650"]=new hb("\u2650",EmojiStrings.l_Sagittarius,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,
!1,!1),fa["\u2651"]=new hb("\u2651",EmojiStrings.l_Capricorn,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u2652"]=new hb("\u2652",EmojiStrings.l_Aquarius,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u2653"]=new hb("\u2653",EmojiStrings.l_Pisces,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\u26ce"]=new hb("\u26ce",EmojiStrings.l_Ophiuchus,EmojiStrings.l_Symbols,EmojiStrings.l_Zodiac,!1,!1),fa["\ud83d\udd00"]=new hb("\ud83d\udd00",EmojiStrings.l_ShuffleTracksButton,
EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udd01"]=new hb("\ud83d\udd01",EmojiStrings.l_RepeatButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udd02"]=new hb("\ud83d\udd02",EmojiStrings.l_RepeatSingleButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\u23e9"]=new hb("\u23e9",EmojiStrings.l_FastForwardButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\u23ea"]=new hb("\u23ea",EmojiStrings.l_FastReverseButton,EmojiStrings.l_Symbols,
EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udd3c"]=new hb("\ud83d\udd3c",EmojiStrings.l_UpButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\u23eb"]=new hb("\u23eb",EmojiStrings.l_FastUpButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udd3d"]=new hb("\ud83d\udd3d",EmojiStrings.l_DownButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\u23ec"]=new hb("\u23ec",EmojiStrings.l_FastDownButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83c\udfa6"]=
new hb("\ud83c\udfa6",EmojiStrings.l_Cinema,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udd05"]=new hb("\ud83d\udd05",EmojiStrings.l_DimButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udd06"]=new hb("\ud83d\udd06",EmojiStrings.l_BrightButton,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udcf6"]=new hb("\ud83d\udcf6",EmojiStrings.l_AntennaBars,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udcf3"]=new hb("\ud83d\udcf3",
EmojiStrings.l_VibrationMode,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udcf4"]=new hb("\ud83d\udcf4",EmojiStrings.l_MobilePhoneOff,EmojiStrings.l_Symbols,EmojiStrings.l_AVSymbol,!1,!1),fa["\ud83d\udcdb"]=new hb("\ud83d\udcdb",EmojiStrings.l_NameBadge,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\ud83d\udd30"]=new hb("\ud83d\udd30",EmojiStrings.l_JapaneseYmbolForBeginner,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\ud83d\udd31"]=new hb("\ud83d\udd31",
EmojiStrings.l_TridentEmblem,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2b55"]=new hb("\u2b55",EmojiStrings.l_HeavyLargeCircle,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2705"]=new hb("\u2705",EmojiStrings.l_WhiteHeavyCheckMark,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u274c"]=new hb("\u274c",EmojiStrings.l_CrossMark,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u274e"]=new hb("\u274e",EmojiStrings.l_CrossMarkButton,EmojiStrings.l_Symbols,
EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2795"]=new hb("\u2795",EmojiStrings.l_HeavyPlusSign,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2796"]=new hb("\u2796",EmojiStrings.l_HeavyMinusSign,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2797"]=new hb("\u2797",EmojiStrings.l_HeavyDivisionSign,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u27b0"]=new hb("\u27b0",EmojiStrings.l_CurlyLoop,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u27bf"]=
new hb("\u27bf",EmojiStrings.l_DoubleCurlyLoop,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2753"]=new hb("\u2753",EmojiStrings.l_QuestionMark,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2754"]=new hb("\u2754",EmojiStrings.l_WhiteQuestionMark,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2755"]=new hb("\u2755",EmojiStrings.l_WhiteExclamationMark,EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\u2757"]=new hb("\u2757",EmojiStrings.l_ExclamationMark,
EmojiStrings.l_Symbols,EmojiStrings.l_OtherSymbols,!1,!1),fa["\ud83d\udd1f"]=new hb("\ud83d\udd1f",EmojiStrings.l_Keycap10,EmojiStrings.l_Symbols,EmojiStrings.l_KeyCap,!1,!1),fa["\ud83d\udcaf"]=new hb("\ud83d\udcaf",EmojiStrings.l_HundredPoints,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83d\udd20"]=new hb("\ud83d\udd20",EmojiStrings.l_InputLatinUppercase,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83d\udd21"]=new hb("\ud83d\udd21",EmojiStrings.l_InputLatinLowercase,
EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83d\udd22"]=new hb("\ud83d\udd22",EmojiStrings.l_InputNumbers,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83d\udd23"]=new hb("\ud83d\udd23",EmojiStrings.l_InputSymbols,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83d\udd24"]=new hb("\ud83d\udd24",EmojiStrings.l_InputLatinLetters,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd8e"]=new hb("\ud83c\udd8e",EmojiStrings.l_ABButtonBloodType,
EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd91"]=new hb("\ud83c\udd91",EmojiStrings.l_CLButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd92"]=new hb("\ud83c\udd92",EmojiStrings.l_COOLButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd93"]=new hb("\ud83c\udd93",EmojiStrings.l_FREEButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd94"]=new hb("\ud83c\udd94",EmojiStrings.l_IDButton,EmojiStrings.l_Symbols,
EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd95"]=new hb("\ud83c\udd95",EmojiStrings.l_NEWButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd96"]=new hb("\ud83c\udd96",EmojiStrings.l_NGButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd97"]=new hb("\ud83c\udd97",EmojiStrings.l_OKButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd98"]=new hb("\ud83c\udd98",EmojiStrings.l_SOSButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,
!1,!1),fa["\ud83c\udd99"]=new hb("\ud83c\udd99",EmojiStrings.l_UpButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\udd9a"]=new hb("\ud83c\udd9a",EmojiStrings.l_VSButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude01"]=new hb("\ud83c\ude01",EmojiStrings.l_JapaneseHereButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude36"]=new hb("\ud83c\ude36",EmojiStrings.l_JapaneseNotFreeOfChargeButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,
!1,!1),fa["\ud83c\ude2f"]=new hb("\ud83c\ude2f",EmojiStrings.l_JapaneseReservedButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude50"]=new hb("\ud83c\ude50",EmojiStrings.l_JapaneseBargainButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude39"]=new hb("\ud83c\ude39",EmojiStrings.l_JapaneseDiscountButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude1a"]=new hb("\ud83c\ude1a",EmojiStrings.l_JapaneseFreeOfChargeButton,EmojiStrings.l_Symbols,
EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude32"]=new hb("\ud83c\ude32",EmojiStrings.l_JapaneseProhibitedButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude51"]=new hb("\ud83c\ude51",EmojiStrings.l_JapaneseAcceptableButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude38"]=new hb("\ud83c\ude38",EmojiStrings.l_JapaneseApplicationButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude34"]=new hb("\ud83c\ude34",EmojiStrings.l_JapanesePassingGradeButton,
EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude33"]=new hb("\ud83c\ude33",EmojiStrings.l_JapaneseVacancyButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude3a"]=new hb("\ud83c\ude3a",EmojiStrings.l_JapaneseOpenForBusinessButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\ud83c\ude35"]=new hb("\ud83c\ude35",EmojiStrings.l_JapaneseNoVacancyButton,EmojiStrings.l_Symbols,EmojiStrings.l_Alphanum,!1,!1),fa["\u25fd"]=new hb("\u25fd",EmojiStrings.l_WhiteMediumSmallSquare,
EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\u25fe"]=new hb("\u25fe",EmojiStrings.l_BlackMediumSmallSquare,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\u2b1b"]=new hb("\u2b1b",EmojiStrings.l_BlackLargeSquare,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\u2b1c"]=new hb("\u2b1c",EmojiStrings.l_WhiteLargeSquare,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd36"]=new hb("\ud83d\udd36",EmojiStrings.l_LargeOrangeDiamond,EmojiStrings.l_Symbols,
EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd37"]=new hb("\ud83d\udd37",EmojiStrings.l_LargeBlueDiamond,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd38"]=new hb("\ud83d\udd38",EmojiStrings.l_SmallOrangeDiamond,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd39"]=new hb("\ud83d\udd39",EmojiStrings.l_SmallBlueDiamond,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd3a"]=new hb("\ud83d\udd3a",EmojiStrings.l_RedTrianglePointedUp,EmojiStrings.l_Symbols,
EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd3b"]=new hb("\ud83d\udd3b",EmojiStrings.l_RedTrianglePointedDown,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udca0"]=new hb("\ud83d\udca0",EmojiStrings.l_DiamondWithADot,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd18"]=new hb("\ud83d\udd18",EmojiStrings.l_RadioButton,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd32"]=new hb("\ud83d\udd32",EmojiStrings.l_BlackSquareButton,EmojiStrings.l_Symbols,
EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd33"]=new hb("\ud83d\udd33",EmojiStrings.l_WhiteSquareButton,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\u26aa"]=new hb("\u26aa",EmojiStrings.l_WhiteCircle,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\u26ab"]=new hb("\u26ab",EmojiStrings.l_BlackCircle,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),fa["\ud83d\udd34"]=new hb("\ud83d\udd34",EmojiStrings.l_RedCircle,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1),
fa["\ud83d\udd35"]=new hb("\ud83d\udd35",EmojiStrings.l_BlueCircle,EmojiStrings.l_Symbols,EmojiStrings.l_Geometric,!1,!1));128===(M&128)&&(fa["\ud83c\udfc1"]=new hb("\ud83c\udfc1",EmojiStrings.l_ChequeredFlag,EmojiStrings.l_Flags,EmojiStrings.l_Flag,!1,!1),fa["\ud83d\udea9"]=new hb("\ud83d\udea9",EmojiStrings.l_TriangularFlag,EmojiStrings.l_Flags,EmojiStrings.l_Flag,!1,!1),fa["\ud83c\udf8c"]=new hb("\ud83c\udf8c",EmojiStrings.l_CrossedFlags,EmojiStrings.l_Flags,EmojiStrings.l_Flag,!1,!1),fa["\ud83c\udff4"]=
new hb("\ud83c\udff4",EmojiStrings.l_BlackFlag,EmojiStrings.l_Flags,EmojiStrings.l_Flag,!1,!1));return fa}}Object(u.a)(Id,"EmojisLoader",null,[875]);var he=d(304),Cd=d(607);class Wg{constructor(){this.sAd=this.BMc=null;this.vga=(M,fa)=>{this.BMc(fa.succeeded);this.sAd&&(this.sAd.stop(),this.sAd=null)}}get mV(){return z.AFrameworkApplication.ua.Vr}Z_d(M){this.BMc=M;M="EmojiIntl";z.AFrameworkApplication.J.my("IsServerFlavorDebug")&&z.AFrameworkApplication.J.$("IsServerFlavorDebug")&&(M+=".debug");M=
z.AFrameworkApplication.mC(M,3);const fa=he.a.create(M,null,null);fa.Z1(this.vga);Cd.a.m_(fa);this.sAd=this.mV.Xf("LoadResource","EmojiResourceDownload");Na.ULS.sendTraceTag(38015523,324,100,"Emojis - Downloading JS from: {0}",M)}}Object(u.a)(Wg,"EmojisResourceDownloadManager",null,[867]);var cd=d(208),If=d(647),Rf=d(1371);class ih{constructor(M){this.l_=M;this.Shb=8}get F_l(){return'<div class="EmojiButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}jrm(){const M=Object.assign(new zc.a,
{Id:"menuEmojisDropDown",MenuSectionList:[]});M.MenuSectionList.push(this.CWk());M.MenuSectionList.push(this.hYk());return M}wgl(){const M=new Sys.StringBuilder;M.append('<table class="WACEmojiGalleryHeaderAccessible">');M.append('<tr role="presentation">');const fa=this.l_.K_l.value,Va=lg.a(fa);let Fb=0;for(;Fb<Va.length;){const Vb=fa[Va[Fb]];M.append(String.format('<td unselectable="on" role="presentation">\r\n\t\t\t\t<a class="EmojiGalleryHeader" id="{0}" title="{2}" aria-label="{2}" aria-selected="{3}" aria-controls="{4}" role="tab" tabindex="-1" unselectable="on">{1}</a>\r\n\t\t\t</td>',
"emoji_h_"+Fb,F.a.P_(Vb.kOb),F.a.P_(Vb.group),!Fb,"emojisContainer-"+Fb));Fb++}M.append("</tr>");M.append("</table>");return M.toString()}Fum(M){return"Smileys and People"===M?this.l_.Zyf.value:"Animals and Nature"===M?this.l_.Yii.value:"Food and Drink"===M?this.l_.$ii.value:"Travel and Places"===M?this.l_.cji.value:"Activities"===M?this.l_.Xii.value:"Objects"===M?this.l_.aji.value:"Symbols"===M?this.l_.bji.value:"Flags"===M?this.l_.Zii.value:null}bgl(M,fa){const Va=new Sys.StringBuilder;Va.append('<table role="grid" class="WACEmojiTableAccessible">');
if(M=this.Fum(M)){const Fb=lg.a(M);let Vb=0;for(;Vb<Fb.length;){Vb%this.Shb||Va.append('<tr role="row" unselectable="on">');const wc=M[Fb[Vb]];Va.append(String.format('<td unselectable="on" role="presentation">\r\n\t\t\t\t\t<a id="{0}" title="{2}" aria-selected="false" role="gridcell" tabindex="-1" unselectable="on">{1}</a>\r\n\t\t\t</td>',"emoji_g_"+fa+"_"+Vb,F.a.P_(wc.kOb),F.a.P_(wc.altText)));Vb++;Vb%this.Shb&&Vb!==Fb.length||Va.append("</tr>")}}Va.append("</table>");return Va.toString()}hYk(){const M=
Object.assign(new Ui.a,{Id:"msMoreEmojis",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreEmojis",ControlList:[]}),fa=Object.assign(new cd.a,{Id:"btnMoreEmojis",Command:Q.a.O7c.toString(),QueryCommand:Q.a.suc.toString(),LabelText:F.a.yf(Box4Intl.Box4Strings.L_InsertMoreEmojis),Alt:F.a.yf(Box4Intl.Box4Strings.L_InsertMoreEmojis),Image16by16:mi.a.Aj("box42.png"),Image16by16Class:xj.getImageClassWithCluster("box42","SendASmile_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreEmojisKeytip});M.ControlList.push(fa);
return M}CWk(){const M=Object.assign(new Ui.a,{Id:"msEmojisPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),fa=Object.assign(new If.a,{Type:1,Id:"galleryEmojisPosition",ExternalId:"InsertEmojis",ExternalGalleryId:"InsertEmojiGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Va=this.l_.Zyf.value,Fb=lg.a(Va),Vb=Math.min(25,Fb.length);for(let Xc=0;Xc<Vb;Xc++){var wc=Va[Fb[Xc]];wc=Object.assign(new Rf.a,{Id:String.format("{0}{1}_{2}","emoji_d_",Xc,wc.kOb),Character:wc.kOb,Command:Q.a.ysb.toString(),
QueryCommand:Q.a.Zqe.toString(),Alt:wc.altText,MenuItemId:wc.kOb,InnerHTML:""});fa.GalleryItems.push(wc)}M.ControlList.push(fa);return M}}Object(u.a)(ih,"EmojisUiBuilder",null,[863]);class mh{constructor(){this.Z=null}get name(){return"Box4.Emojis"}init(){this.Z.resolve("Box4.Emojis.IEmojisActor").Xb()}dispose(){}wc(M){this.Z=M;this.Z.register(Id,"Box4.Emojis.EmojisLoader").as("Box4.Emojis.IEmojisLoader").ha();this.Z.ia("Box4.Emojis.EmojisUiBuilder",()=>new ih(this.Z.resolve("Box4.Emojis.IEmojisLoader"))).as("Box4.Emojis.IEmojisUIBuilder").ha();
this.Z.ia("Box4.Emojis.EmojisActor",()=>new Qc(z.AFrameworkApplication.va,z.AFrameworkApplication.J,new Nc.a,new qd.a,this.Z.resolve("Box4.Emojis.IEmojisUIBuilder"),Wd.a.instance,Fa.a.instance,this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.IFormattingEditor"),this.Z.resolve("Box4.Emojis.IEmojisDropDownManager"),this.Z.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.Z.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,this.Z.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
this.Z.resolve("Box4.IInsertionPointFormatting"))).as("Box4.Emojis.IEmojisActor").ha();this.Z.ia("Box4.Emojis.EmojisDropDownManager",()=>new ed(z.AFrameworkApplication.ua,this.Z.resolve("Box4.Emojis.IEmojisResourceDownloadManager"),this.Z.resolve("Box4.Emojis.IEmojisUIBuilder"))).as("Box4.Emojis.IEmojisDropDownManager").ha();this.Z.register(Wg,"Box4.Emojis.EmojisResourceDownloadManager").as("Box4.Emojis.IEmojisResourceDownloadManager").ha()}static main(){x.a.instance.Mc(new mh)}}Object(u.a)(mh,"EmojisPackage",
null,[0,1]);class Wk{constructor(M,fa,Va){this.ELc=null;this.Jul=()=>{try{this.Kul()}catch(Fb){Na.ULS.sendTraceTag(39081435,324,50,"Exception caught in CollectAllMetrics. Message: {0}",Fb.message)}};this.FCa=()=>{this.ELc&&(this.Jb.wf(this.ELc),this.ELc=null)};this.Jb=fa;Va.execute(Fb=>{Fb.$lb(this.FCa)});this.shh=new H.a;this.YEk=M.jc("WordEditorFidelityMetricCollectionCadence",3E4)}Ddp(){this.ELc=new Gf.a(3,2,this.YEk,this.Jul);this.Jb.$b(this.ELc)}register(M){M.isEnabled&&this.shh.add(M)}Kul(){const {DQi:M,
returnValue:fa}=this.Vjl();-1!==fa&&(Na.ULS.sendTraceTag(39081436,324,50,"{0}",fa),Na.ULS.sendTraceTag(39081437,324,50,"{0}",M))}Vjl(){let M=0,fa=0;const Va={};for(const vd of this.shh){var Fb=vd.result;const Dd=vd.Pdj;if(Fb){var Vb=Fb=Fb.uiq,wc=vd.$kq,Xc=vd.Aeq;Xc?2===Xc?(Vb=0>Vb?0:Vb>wc?wc:Vb,wc=Math.floor(Vb*Vb/(wc*wc)*100)):(Vb=0>Vb?0:Vb>wc?wc:Vb,wc=Math.floor(Vb/wc*100)):(Vb=0>Vb?0:Vb>wc?wc:Vb,wc=Math.floor(Math.sqrt(Vb)/Math.sqrt(wc)*100));wc=100-wc;M+=wc;fa++;this.w7k(Va,Dd,Fb,wc);vd.Veq()}}return fa?
{returnValue:M/fa,DQi:Va}:{returnValue:-1,DQi:Va}}w7k(M,fa,Va,Fb){const Vb={};Vb.RawScore=Va;Vb.NormalizedScore=Fb;M[fa]=Vb}}Object(u.a)(Wk,"FidelityMetricManager",null,[912]);class na{constructor(){this.Z=null}get name(){return"WordEditor.FidelityMetrics"}get oIp(){return z.AFrameworkApplication.J.$("WordEditorFidelityMetricCollectionIsEnabled")}wc(M){this.Z=M;this.Z.ia("WordEditor.FidelityMetrics.FidelityMetricManager",()=>new Wk(z.AFrameworkApplication.J,Ae.a.instance,this.Z.Ta("Common.ISessionExpirationManager"))).as("WordEditor.FidelityMetrics.IFidelityMetricManager").ha()}init(){this.oIp&&
this.Z.resolve("WordEditor.FidelityMetrics.FidelityMetricManager").Ddp()}dispose(){}}Object(u.a)(na,"PackageManager",null,[0,1]);var db=d(380),Ob=d(728),Sb=d(1990),qc=d(1772),Ic=d(1047);class xc{constructor(M,fa,Va){this.ORa=this.sQ=null;this.hb=M;this.Wn=fa;this.Rk=Va}reset(M){this.hb.Wb(M.node)?this.sQ=M.node:this.sQ=null}rEa(M){let fa=null;if(!this.sQ)return{returnValue:!1,JG:fa};if(!this.ORa||this.Rk!==this.ORa.type||M<this.ORa.Dc||M>this.ORa.end){const Va=this.Wn.hKa(this.sQ,this.Rk,Fb=>M>=Fb.Dc&&
M<=Fb.end&&this.ZYi(Fb.intent));io.a.F0e++;(this.ORa=0<Va.count?Va.K(0):null)&&!this.ZYi(this.ORa.intent)&&(this.ORa=null)}if(!this.ORa)return{returnValue:!1,JG:fa};fa=Object.assign(new Ic.a,{dG:this.key,contentObject:this.ORa,description:this.qAl});return{returnValue:!0,JG:fa}}}Object(u.a)(xc,"AIntentRangeDetailsProvider",null,[299,300]);var vb=d(636),Qd=d(1463);class Ze extends xc{constructor(M,fa,Va){super(fa,Va,0);this.mx=M}get key(){return"INTENT ANNOTATION CRITIQUE"}get Fv(){return WordEditorIntl.WordEditorStrings.L_IntentAnnotationCritique}get qAl(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}get u2b(){return null!=
this.u6g?this.u6g:this.u6g=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}ZYi(M){if(!M||!this.mx.isPaneOpen)return!1;if(this.u2b){const fa=M.content;if(Qd.a.wfe(fa)||Qd.a.Nde(fa))return!1}return!!M&&vb.a(M.annotationType)}}Object(u.a)(Ze,"AugLoopProofingIntentDetailsProvider",xc,[]);var Be=d(86),Ve=d(479),Pe=d(43),Lf=d(1486),pe=d(312),Zh=d(319),Te=d(478),Gi=d(1857),fe=d(2126),Fe=d(1856),mg=d(795),bj=d(359),Jh=d(1130),Gh=d(1085),cj=d(107),
Uj=d(84);class Xk{constructor(){this.Value=this.Name=null}}Object(u.a)(Xk,"Metadatum",null,[]);class Lk extends Sys.EventArgs{constructor(M,fa){super();this.action=M;this.category=fa}}Object(u.a)(Lk,"AugloopProofingActionEventArgs",Sys.EventArgs,[]);class ii{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd=null,Dd=null){this.annotationId=M;this.Hx=fa;this.language=Va;this.Rja=Fb;this.L$c=Vb;this.nYi=wc;this.suggestions=vd;this.sources=Dd;this.Ifi=!1}}Object(u.a)(ii,"AnnotationContentData",null,[]);class lj{constructor(M,
fa,Va){this.categoryName=null;this.inChainMode=this.isPaneOpen=!1;this.categoryName=M;this.isPaneOpen=fa;this.inChainMode=Va}}Object(u.a)(lj,"AnnotationTelemetryData",null,[]);class Od{}Object(u.a)(Od,"SimilaritySurveyAppData",null,[]);class Nj{constructor(M){this.comment=null;this.comment=M}}Object(u.a)(Nj,"SimilaritySurveyData",null,[]);var yh=d(1451),Th=d(1419),Tf=d(1427);class pp{constructor(){this.value=this.name=this.id=null}}Object(u.a)(pp,"CritiqueTypeOption",null,[]);class jk{constructor(){this.cdh=
{"en-us":[{id:"c4301606-9bc2-4389-bb1a-c08370627172",name:"Adverb placement",value:"true"},{id:"7f6d979b-d0de-4367-aa9d-589b5134b7a6",name:"Complex words",value:"true"},{id:"0da5de95-d496-4d23-8f93-693ef6592ae6",name:"Double negation",value:"true"},{id:"3be567ea-4951-4e59-bdab-6b99c790f28d",name:"Jargon",value:"true"},{id:"28c70cb7-e358-4b32-8756-725aa7af1d69",name:"Sentence structure",value:"true"},{id:"6bdf8d88-1ed5-4506-9b5f-a17e7f8c2a48",name:"Words expressing uncertainty",value:"true"},{id:"79dd443b-0b94-45a1-90ad-02807565324d",
name:"Split infinitives",value:"true"},{id:"67718619-a6b1-43ec-af18-1c48bbc27acd",name:"Colloquial verb phrase",value:"true"},{id:"e24fd819-cc17-4be9-afec-dd103055198e",name:"Conjunction overuse",value:"true"},{id:"007c6707-7280-4c94-b469-8caee77d8313",name:"Use of euphemisms",value:"true"},{id:"f4aa4a0a-f81a-41ac-b710-de4a60b99282",name:"Contractions",value:"true"},{id:"6d60d9da-9e38-4d1e-bfc5-05a04120eef9",name:"Informal language",value:"true"},{id:"d124712e-74ac-43eb-9bb6-373b2398f448",name:"Opinion markers",
value:"true"},{id:"aa4e5a53-9b76-49fe-8bf1-2f35fd0d091d",name:"Slang",value:"true"},{id:"c68edc3b-9340-4b68-9d18-268bb82e2d94",name:"Subjunctive mood",value:"true"},{id:"dd116cd6-2adb-4be9-809f-7b8de7cace91",name:"Ethnic slurs",value:"true"},{id:"e77bbc2a-f896-4012-a711-6041ea1e8964",name:"Gender-specific language",value:"true"},{id:"f47353f1-e9b7-4fff-8129-b6d109ece435",name:"Mental health bias",value:"true"},{id:"3f2e6b47-fc23-4f99-ad25-1758e7f179b6",name:"Comma with adverbials",value:"true"},{id:"55aa25a5-e28a-4f22-8410-34a4df965e30",
name:"Oxford comma",value:"true"},{id:"3fd9c226-3925-4855-ba1e-49eb9ee46d24",name:"Unnecessary comma",value:"true"},{id:"5b75d94a-856d-461b-9bb4-879f4502b4c3",name:"Punctuation required with quotes",value:"true"},{id:"a44ac718-8213-42ff-87a5-1e5d6592c352",name:"Space between sentences",value:"true"},{id:"923cc720-1624-4973-946a-30a0c6ec4163",name:"Cliches",value:"true"},{id:"9725ea09-959d-48b9-9678-1844896547b3",name:"Vague adjectives",value:"true"},{id:"64213f24-0943-4585-8dd4-ee4f26b47a37",name:"Vague or unnecessary adverbs",
value:"true"},{id:"2e33dc1f-0106-4182-b52a-ad94e479fb9a",name:"Weak verbs",value:"true"},{id:"fe818c82-737a-47e1-ad57-e84269f3ecb2",name:"Geopolitical references",value:"true"},{id:"b1634cf9-5f68-42f4-82ca-e668f893d28f",name:"Proactive Conciseness",value:"true"}],"fr-fr":[{id:"b056f406-8798-46b2-b3cb-53f69a8bd912",name:"Disability bias",value:"true"}]};this.VNe={};Object.keys(this.cdh).forEach(M=>{this.cdh[M].forEach(fa=>{this.VNe[fa.id]=!0})})}aXf(M){return this.VNe&&M&&M in this.VNe}}Object(u.a)(jk,
"DEXCritiqueConfiguration",null,[]);const lm=M=>({I2b:M[0],DEa:M[1],ICa:M[2],H9d:M[3]});class ce{constructor(M,fa,Va,Fb){this.modelVersion=this.modelName=this.critiqueSource=this.range=null;this.range=M;this.critiqueSource=fa;this.modelName=Va;this.modelVersion=Fb}}Object(u.a)(ce,"GrammarSurveyAppData",null,[]);class Ge{constructor(M){this.comment=null;this.comment=M}}Object(u.a)(Ge,"GrammarSurveyData",null,[]);const Vc=M=>({I2b:M[0],DEa:M[1],ICa:M[2],KZb:M[3]});class Ii{constructor(M,fa,Va){this.modelVersion=
this.modelName=this.range=null;this.range=M;this.modelName=fa;this.modelVersion=Va}}Object(u.a)(Ii,"RewriteSurveyAppData",null,[]);class Wj{constructor(M){this.comment=null;this.comment=M}}Object(u.a)(Wj,"RewriteSurveyData",null,[]);class hn{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa){this.FIg=M;this.GIg=fa;this.Mpp=Va;this.substring=Fb;this.startInContext=Vb;this.length=wc;this.index=Xc;this.originalText=vd;this.Iba=Dd;this.j1m={start:Ce.start,length:Ce.length};this.modelName=Xa}}Object(u.a)(hn,
"RewriteSuggestionContentData",null,[]);var Cm=d(1605),Cl=d(876),Uk=d(1093),Ml;(function(M){M[M.High=0]="High";M[M.Medium=1]="Medium";M[M.Low=2]="Low";M[M.Informational=3]="Informational"})(Ml||(Ml={}));var jo;(function(M){M[M.NotificationOnly=0]="NotificationOnly";M[M.Delete=1]="Delete";M[M.Ignore=2]="Ignore";M[M.IgnoreAll=4]="IgnoreAll";M[M.IgnoreCritiqueType=8]="IgnoreCritiqueType";M[M.AddToDictionary=16]="AddToDictionary";M[M.ShowDetails=32]="ShowDetails"})(jo||(jo={}));var tl;(function(M){M[M.None=
0]="None";M[M.ChangeOnce=1]="ChangeOnce";M[M.ChangeAll=2]="ChangeAll";M[M.AutoCorrect=4]="AutoCorrect";M[M.ReadAloud=8]="ReadAloud";M[M.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"})(tl||(tl={}));var fl=d(805),Uh=d(560),nh;(function(M){M[M.R7p=0]="leftClickOnText";M[M.Q7p=1]="leftClickOnIndicator";M[M.hkq=2]="rightClickMenu";M[M.J1f=3]="keyboardShortcut";M[M.navigation=4]="navigation";M[M.tooltip=5]="tooltip";M[M.hover=6]="hover";M[M.STl=7]="dictationCorrectThatCommand";M[M.RTl=8]="dictationCorrectPhraseCommand";
M[M.uZp=9]="discoveryWhatCanISayCommand";M[M.unknown=10]="unknown"})(nh||(nh={}));Object(u.b)("ContextualIntentInvocationSource",nh);const Ke=M=>M===nh.STl||M===nh.RTl;var cg;(function(M){M[M.Seen=0]="Seen";M[M.Accepted=1]="Accepted";M[M.Rejected=2]="Rejected"})(cg||(cg={}));Object(u.b)("TelemetryActionForCritiqueCommands",cg);class ub extends Tf.a{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne,ng,Ng,uh,Oh,Hj,Da,Ib,hc,Kc,zd,ue,Ue,Re,wg,Xg,fk,vh,ig,bh,Ij,Mo){var Mn;super();
this.ga=M;this.ZEa=fa;this.KD=Va;this.Re=Fb;this.FH=Vb;this.s9=wc;this.Rd=Xc;this.kk=vd;this.xFa=Dd;this.RQa=Ce;this.wxa=ea;this.Rc=Xa;this.kda=yb;this.Bpa=Ub;this.Wn=yc;this.LK=ad;this.hja=md;this.BGa=Sd;this.NId=ze;this.vHb=Ne;this.n4e=ng;this.o4e=Ng;this.ib=uh;this.HM=Oh;this.vr=Hj;this.Jb=Da;this.Fd=Ib;this.zkb=Re;this.xl=wg;this.DTh=Xg;this.NGc=fk;this.rah=ig;this.ADb=bh;this.jW=this.Zx=null;this.X9=this.CQe=!1;this.y6b=null;this.EDb=this.FDb=!1;this.nCb=Th.a.U1h;this.P4b=Th.a.mVc;this.w$g=!1;
this.onDismiss=null;this.VD=this.Rqj=!1;this.yIe=new jk;this.IMd=[];this.dCd=[];this.gNd=[];this.Mch=0;this.DAg=ol=>{var Bk;const zm=ol.annotationType,qo=ol.content;if(z.AFrameworkApplication.J&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1)&&Qd.a.rWf(qo))return!0;if(!vb.a(zm))return!1;if(this.nD()){if(this.VD&&this.yIe.aXf(qo.typeId))return!0;if(!this.VD&&(null===(Bk=this.ADb)||void 0===Bk?0:Bk.c2)&&this.ADb.$Wf(qo.typeId)||!this.VD&&!this.yIe.aXf(qo.typeId))return!1}Bk=
qo.M_.state;return null==Bk?(Na.ULS.sendTraceTag(50857984,341,15,"No annotation state for critique"),!1):!this.KD.Atb(ol)&&!this.KD.Utb(ol,Bk)};this.VDa=ol=>{var Bk;if(this.Bqn(ol)||this.kfn(ol)||this.Rtb(ol)||this.Xln(ol)||!this.VD&&Qd.a.Rtb(ol)||Qd.a.d9c(ol)||vb.a(pe.a.getTypeNameFor(ol))&&(this.Vhn(ol)||this.Whn(ol)||Qd.a.$mc(ol)&&(!this.DTh.instance||!this.DTh.instance.JUi(ol.addInId))))return!1;if((null===(Bk=this.ADb)||void 0===Bk?0:Bk.c2)&&!this.VD)return this.ADb.$Wf(ol.typeId);Bk=Qd.a.gui(ol);
if(this.nD()&&(!this.VD&&!this.yIe.aXf(ol.typeId)&&!Qd.a.Rtb(ol)||!this.oOb&&(this.FDb&&Qd.a.wfe(ol)||this.EDb&&Qd.a.Nde(ol)))||this.sJa&&!Qd.a.Rtb(ol)||this.y6b===Bk)return!0;let zm="";this.rah&&this.rah.execute(qo=>{zm=qo.X0j(this.y6b)});this.oOb!==Bk&&zm===Bk&&z.AFrameworkApplication.$c("3e3f8156;890a2982");return this.rjn?zm===Bk:!1};this.msc=(ol,Bk)=>{var zm;null!==(zm=Bk.element)&&void 0!==zm&&zm.classList.contains(yh.a.s5a)&&Bk.data&&(ol=this.Re.qsi(Bk.data))&&this.sa.raiseEvent("AnnotationFocusOrHoverOperationEvent",
new Gi.a(ol,"HoverOperation"))};this.Rvb=()=>{this.n4e.Rvb(this.TIb)};this.yfd=()=>{this.o4e.bMi(this.TIb)};this.Exh=Mo;this.Qjg=hc;this.sa=vh||new Be.a;Ij.U0k(this.Z3l.bind(this));ue&&ue.cN("SurveyEnabled").then(ol=>{this.X9=z.AFrameworkApplication.J.$("IsO365ConsumerHost")||ol;return null});zd&&zd.execute(ol=>{ol.isFeatureEnabled("FloodgateSurvey",!0).then(Bk=>{this.X9=Bk&&this.X9;return null})});if(this.xFa&&(M=this.xFa.tpo(),0<M.length))switch(M){case Th.a.mVc:this.P4b=Th.a.mVc;break;case Th.a.Nnf:this.P4b=
Th.a.Nnf;break;case Th.a.Onf:this.P4b=Th.a.Onf;break;default:this.P4b=Th.a.mVc}Ue.execute(ol=>{this.V$e=ol;ol.FEg(this.$Ka)});Kc.aff(this.Rvb);null===(Mn=this.wxa)||void 0===Mn?void 0:Mn.Bff(this.yfd);this.Rk=Th.a.mxc;this.zJ=[this.Rk];this.Lia=[new fe.a(yh.a.gmb,yh.a.gmb),new fe.a(yh.a.hyc,yh.a.hyc),new fe.a(yh.a.llc,yh.a.llc)];this.TIc=new ye.a(Pc.a.vh());this.Wn.Vvo(this);this.PAj();this.IMd[cg.Accepted]=Q.a.kDg;this.IMd[cg.Rejected]=Q.a.lDg;this.IMd[cg.Seen]=Q.a.bAe;this.dCd[cg.Accepted]=Q.a.gPf;
this.dCd[cg.Rejected]=Q.a.hPf;this.dCd[cg.Seen]=Q.a.G9d;this.gNd[cg.Accepted]=Q.a.qEg;this.gNd[cg.Rejected]=Q.a.rEg;this.gNd[cg.Seen]=Q.a.GAe;this.NGc&&this.NGc.execute(ol=>{ol&&(this.yDb=ol,this.yDb.Yef(this.NZl.bind(this)))})}NZl(M,fa){fa&&fa.score&&0<fa.score.Vbg&&z.AFrameworkApplication.$c("75bbb705;a8g97181")}get isPaneOpen(){return this.VD}set isPaneOpen(M){if(this.VD!==M){this.VD=M;if(Fe.a.Jph=M)Fe.a.skh=!0;z.AFrameworkApplication.$c("a00h5479;jg8fb145");this.sjn||this.xyp()}}get sjn(){if(null!=
this.FZg)var M=this.FZg;else{var fa;M=this.FZg=null===(fa=z.AFrameworkApplication.J)||void 0===fa?void 0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorCritiqueCountFixEnabled",!1)}return M}get types(){return this.zJ}get JRb(){return this.Lia}get sJa(){return this.CQe}set sJa(M){this.CQe!==M&&(this.CQe=M,this.$Ka())}get oOb(){return this.y6b}set oOb(M){this.y6b!==M&&(this.y6b=M,this.$Ka())}get Rra(){return this.FDb}set Rra(M){this.FDb!==M&&(this.FDb=M,this.$Ka())}get Qra(){return this.EDb}set Qra(M){this.EDb!==
M&&(this.EDb=M,this.$Ka())}get I6c(){return this.TIc}set I6c(M){if(this.TIc!==M&&(this.TIc.clear(),M))for(const fa of M)this.TIc.add(fa)}get XSc(){return this.nD()?1!=z.AFrameworkApplication.ua.mode:(this.sJa||!!this.y6b)&&!z.AFrameworkApplication.eta}MAg(M){return this.nD()||this.VD?!0:!this.DAg(M.intent)}xyp(){this.VD?(this.Rqj&&this.Re.zKn(Zh.a.getTypeName(),this.DAg),this.Rqj=!0):this.Re.ztp(Zh.a.getTypeName(),this.DAg)}Bqn(M){var fa;return(null===(fa=this.V$e)||void 0===fa?0:fa.c_f)?(Fe.a.Gqc(M,
0),!0):!1}kfn(M){return M?!1:(Fe.a.Gqc(M,1),!0)}Rtb(M){return Cm.a.Lcc(M)&&pe.a.getTypeNameFor(M)!==Lf.a.getTypeName()?(Fe.a.Gqc(M,2),!0):!1}Xln(M){return this.TIc.contains(M.id)?(Fe.a.Gqc(M,3),!0):!1}Vhn(M){return null!==this.RQa&&!this.RQa.cXf(M.typeId,M.categoryName)&&this.isPaneOpen?(Fe.a.Gqc(M,4),!0):!1}Whn(M){return null===this.wxa||this.wxa.bXf(M.typeId,M.categoryName,M.language)?!1:(Fe.a.Gqc(M,5),!0)}iVc(M){return!!M.yk&&0<M.yk.cDl()&&!!this.HM.ksi(M.yk.K(0),null)}dxb(M){this.Zx||(this.Zx=
M,mg.a.Xgf&&this.Zx.rff(this.msc),this.BGa.fTa((fa,Va)=>{fa=Va.paragraphNode;const Fb=Va.bna;for(const Vb of Va.contents)1!=Vb.kI&&0!=Vb.kI||Qd.a.GQf(Vb.element,fa,Vb.intents,this.XSc,this.VDa,this.HM,this.Zx,Fb,!0,this.Rk)}))}bkd(M){this.jW||(this.jW=M)}RWa(M,fa){return Qd.a.RWa(M,fa,this.Rk)}c7a(M,fa){const Va=Qd.a.$ic(M,!1,this.Rk);return Va&&Va.contains(fa)?M.classList.contains(yh.a.xVj)||M.classList.contains(yh.a.yVj)?yh.a.M$o:M.classList.contains(yh.a.zVj)||M.classList.contains(yh.a.AVj)?yh.a.L$o:
M.classList.contains(yh.a.Uq)||M.classList.contains(yh.a.mDg)?yh.a.hyc:M.classList.contains(yh.a.OAl)||M.classList.contains(yh.a.Zqf)?yh.a.llc:M.classList.contains(yh.a.MXk)?yh.a.DXk:M.classList.contains(yh.a.KXk)?yh.a.BXk:M.classList.contains(yh.a.JXk)?yh.a.AXk:M.classList.contains(yh.a.LXk)?yh.a.CXk:M.classList.contains(yh.a.IXk)?yh.a.zXk:yh.a.gmb:null}wom(M,fa,Va,Fb){const Vb=[];let wc=!1;const Xc=[Te.b.Apply];for(const vd of M.suggestions)wc=0==vd.suggestionActions&&(M.critiqueActions&jo.Delete)===
jo.Delete,Vb.push({id:"Suggestion-"+Vb.length,title:vd.text,titleFormatting:w(M.context,vd.text,M.typeId),description:vd.description,supportedActions:vd.suggestionActions?Xc:[]});return{...Te.g,id:Qd.a.TMf(M.priority,wc),suggestionGroups:[{type:this.nD()?Qd.a.TMf(M.priority,wc):Th.a.mxc,id:this.nD()?Qd.a.TMf(M.priority,wc):Th.a.mxc,icon:this.MYf(M.critiqueMetadata)?{resourceId:"Inference",width:0,height:0}:null,title:M.explanationTitle,description:M.explanationLabel,explanation:M.explanationBody,
snippet:M.context,snippetFormatting:[{...Te.h,start:M.startInContext,length:M.range.length,underlineType:Qd.a.fQm(M)}],suggestions:Vb,supportedActions:this.nD()?Qd.a.QMm(M.priority,this.l0i()):[Te.b.IgnoreOnce],contentData:Va,telemetryData:Fb,isContentPending:!1,cardHeader:fa,critiqueSubType:M.typeId}]}}MYf(M){return this.LYf()&&M&&M.CritiqueSource&&"Inference"===M.CritiqueSource}get rjn(){if(null!=this.EZg)var M=this.EZg;else{var fa;M=this.EZg=null===(fa=z.AFrameworkApplication.J)||void 0===fa?void 0:
fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorCategoryLocalizationIssueFix",!1)}return M}LYf(){var M;const fa=null!==(M=z.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)&&void 0!==M?M:"";return"Automation"===fa||"Dogfood"===fa||"Microsoft"===fa}nLm(M,fa,Va,Fb){const Vb=[];Vb.push({type:ub.obi,id:ub.JRi,supportedActions:[Te.b.Apply]});Vb.push({type:ub.obi,id:ub.jri,supportedActions:[Te.b.Apply]});const wc=[];var Xc=0;wc.push({id:"Source-"+Xc++,description:M.sourceTitle,
snippet:M.sourceSnippet,url:M.sourceUrl});if(M.sources)for(const vd of M.sources)wc.push({id:"Source-"+Xc++,description:vd.sourceTitle,snippet:vd.sourceSnippet,url:vd.sourceUrl});Xc=M.M_.state;return{...Te.g,id:"Intent-"+Th.a.Ejg,suggestionGroups:[{type:Th.a.Ejg,id:Th.a.Ejg,title:M.sourceTitle,description:M.sourceTitle,snippet:M.sourceSnippet,url:M.sourceUrl,suggestions:Vb,supportedActions:60===Xc||70===Xc?this.X9?[Te.b.LearnMore,Te.b.Report]:[Te.b.LearnMore]:this.X9?[Te.b.IgnoreOnce,Te.b.LearnMore,
Te.b.Report]:[Te.b.IgnoreOnce,Te.b.LearnMore],sources:wc,contentData:Va,telemetryData:Fb,isContentPending:!1,cardHeader:fa}]}}hxm(M){return Qd.a.Ben(M)?{text:WordEditorIntl.WordEditorStrings.L_ContextualCardAcronymsHelpLinkText,url:ub.gUk}:null}zS(M){let fa,Va,Fb;var Vb=this.ib.gb.Qya;Vb=Vb&&(Vb.contextId==rb.a.s4||Vb.contextId==rb.a.I0);if(!this.XSc||Ve.SessionStatusManager.instance.Jk||Vb||!({annotation:fa,nwj:Va,Vgf:Fb}=this.HM.k2d(M.Hx,M.LAf,this.VDa)).returnValue)return!1;mg.a.Xgf&&fa.annotationType===
Cl.a.getTypeName()&&this.sa.raiseEvent("AnnotationFocusOrHoverOperationEvent",new Gi.a(fa,Uk.d.getTypeName()));if(Qd.a.xce(Va)||Qd.a.$mc(Va))return!1;if(M.byc)return!0;var wc=0;let Xc=0;const vd=Fb.node;M.Rja&&({index:Xc,count:wc}=this.jW.RYc(vd,Fb.cpBegin,this,Xc,wc));const Dd=Qd.a.gui(Va);var Ce=Qd.a.wfe(Va);const ea=Qd.a.Nde(Va);Vb=Qd.a.Rtb(Va);const Xa=new ii(fa.id,Fb,this.AAi(Fb,Va),M.Rja,Vb,ea,Ce,Vb?Va.suggestions:null,Vb?Va.sources:null);Ce=new lj(Dd,this.isPaneOpen,M.Rja);Ce=Vb?this.nLm(Va,
Dd,Xa,Ce):this.wom(Va,Dd,Xa,Ce);Ce.setSize=wc;Ce.positionInSet=Xc;Ce.helpLink=this.hxm(Va);wc=!1;this.ga.t_(Ci.a.z_a)&&(wc=!0);this.bLa=M.source;Vb||this.Nub(Va,cg.Seen,this.bLa);return this.qj.Dna(Fb,Ce,this,M.uXa,M.xUa,()=>{var yb=new H.a;yb.add(vd);this.Zx.MNa(this.Rk,yb,Va.id);yb=fa.content.M_.state;(!yb||40>yb)&&this.Re.Sca(fa,40);this.qj.Hqc()},yb=>{const Ub=new H.a;Ub.add(vd);this.Zx.MNa(this.Rk,Ub,null);this.e5f(Xa);Xa.nYi&&"EN-US"===Xa.language.toUpperCase()&&this.k5f();if(this.onDismiss)this.onDismiss(Dd,
!!yb)},void 0,void 0,yb=>{yb.citationStyle=this.P4b},wc,void 0,void 0,Ke(M.source),M.source)}k5f(){const M=Gf.a.paa(0,()=>{const fa=this.vr;fa&&fa.execute(Va=>{Va.logActivity("GrammarSuggestionsInteracted",null)})},0,195);this.Jb.$b(M)}e5f(M){if(!M.Ifi&&!M.L$c){xg.c(Q.a.pwj,!0,void 0,void 0,void 0,void 0,{[ub.Source]:nh[this.bLa]});this.bLa=null;var fa=M.Hx;(M=this.Re.getAnnotationById(M.annotationId))&&this.Dwg(fa,M.content)}}iVm(M,fa,Va,Fb){const Vb=M.node,wc=Va?Va:M.cpBegin;M=this.Rd.We(null!=
Va&&"undefined"!=typeof Va?E.a.createTextRange(Vb,Va,Fb):M,fa,!0,!1,Q.a.Ava,null,!0);this.ib.Kc(Pa.SelectionFactory.ue(Vb,wc+fa.length+M));this.kda.iCa(Vb,wc,wc+fa.length)}uVm(M){const fa=M.node;let Va=M.cpBegin;" "===R.ParagraphReader.text(fa).charAt(Va-1)&&Va--;M=this.Rd.We(E.a.createTextRange(fa,0<M.cpBegin?M.cpBegin-1:0,M.cpEnd),"",!0,!1,null,null,!0);this.ib.Kc(Pa.SelectionFactory.ue(fa,M+Va))}gWm(M,fa,Va,Fb,Vb=!1){if(fa&&Va){var wc=fa.node;if(wc.Hc){var Xc=this.Fd.isFeatureEnabled(53);Xc||this.hja.tae(wc);
var vd=fa.zj;fa=fa.Po;var Dd=wc.characterData;if(!(vd>=fa||fa>Dd.length)){Fb&&(Fb=E.a.createTextRange(wc,vd,vd+1),Xc&&this.hja.tae(wc),this.Rd.We(Fb,"\u201c"+Dd.charAt(vd),!0,!1,Q.a.Ava,null,!0),fa++,Fb=E.a.createTextRange(wc,fa-1,fa),Xc&&this.hja.tae(wc),this.Rd.We(Fb,Dd.charAt(fa-2)+"\u201d",!0,!1,Q.a.Ava,null,!0),fa++,Xc&&(M=this.Re.getAnnotationById(M)))&&(Fb=bj.a.ofc(wc.characterData.substring(vd,fa)),this.Re.pvp(M,Fb));M=!0;for(Fb=!1;Vb&&fa<Dd.length;){if(!F.a.Zw(Dd.charCodeAt(fa))){Fb=!0;break}M=
!1;fa++}Dd=Va;M&&(Dd=" "+Dd);Xc&&this.hja.tae(wc);this.Rd.We(E.a.Uc(wc,fa),Dd,!0,!1,Q.a.Ava,null,!0);if(!Vb||!Fb||this.NId.H_a(E.a.Uc(wc,fa+Va.length))){Va=wc;if(Vb&&0<vd){Va=this.NId.H_a(E.a.Uc(wc,Vb?vd:fa));if(!Va)return;Va=wc.Hc.Eb(Va);if(!Va)return}Vb?(Vb=Vb?Q.a.eR:Q.a.Cyb,this.ib.Kc(Pa.SelectionFactory.ue(Va,Va.characterData.length)),32===this.ga.Ob(Vb,1)&&this.ga.Ob(Vb,2),this.kda.iCa(Va,0,Va.characterData.length)):(this.ib.Kc(Pa.SelectionFactory.ue(Va,fa)),this.kda.iCa(Va,vd,fa))}}}}}S9d(M,
fa,Va,Fb,Vb,wc,Xc){var vd,Dd;const Ce=fa.node;fa=E.a.createTextRange(Ce,fa.cpBegin,fa.cpEnd);const ea=this.Rc.Lc(15);let Xa=!1;try{if(ea.Ab(Ce),Va){const yb=M.suggestionGroup.contentData,Ub=M.descriptorData-1;switch(M.objectFulfillment){case ub.JRi:let yc;yc=0>Ub||Ub>=yb.sources.length?yb.suggestions.Inline.suggestions[this.nCb]:yb.sources[Ub].suggestions.Inline.suggestions[this.nCb];this.gWm(yb.annotationId,fa,yc.citationText,yc.isIdentical,M.suggestion.id===ub.Edl);break;case ub.jri:let ad;ad=0>
Ub||Ub>=yb.sources.length?yb.suggestions.Full.suggestions[this.nCb]:yb.sources[Ub].suggestions.Full.suggestions[this.nCb];ad.citationText&&this.kk.sCl(ad.citationText)}}else Fb?this.uVm(fa):(this.iVm(fa,M?M.suggestion.title:Vb,wc,Xc),Xa=!0)}finally{if(ea&&ea.dispose(),Xa&&(z.AFrameworkApplication.$c("7hg7j973;266ic546"),null===(vd=z.AFrameworkApplication.J)||void 0===vd?0:vd.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIToContinueReviewSuggestionsEnabled",!1)))this.Mch++,3===this.Mch&&(null==
this.Exh?Na.ULS.sendTraceTag(512338137,375,15,"OpenEditorTeachingCallout is null"):null===(Dd=this.Exh)||void 0===Dd?void 0:Dd.BIg())}}Xjo(M,fa){if(!M&&!fa)return 12;if(fa)return this.FEi(fa);switch(M.actionType){case Te.b.AddToDictionary:return 2;case Te.b.IgnoreOnce:return 0;case Te.b.IgnoreAll:return 1;case Te.b.Apply:fa=M.suggestionGroup.suggestions;if(M.suggestionGroup.type===Th.a.eye)return 3;if(({vhf:M}=this.Ari(fa,M.suggestion,fa.length)).returnValue)return this.FEi(M)}return 14}FEi(M){switch(M){case 0:return 4;
case 1:return 5;case 2:return 6;default:return 7}}AAi(M,fa){fa=fa.language;!fa&&(M=this.LK.iKa(M),M=zf.a.Eg(M))&&(fa=M.name);return fa}Dwg(M,fa,Va,Fb,Vb){const wc=M.node;M=Object.assign(new Jh.a,{TraceId:fa.id,LanguageId:this.AAi(M,fa),CritiqueTypeId:fa.typeId,EventId:this.Xjo(Va,Fb),FlaggedText:wc.characterData.substring(M.cpBegin,M.cpEnd),SuggestionText:Va?ub.lgp(Va):Vb?Vb:"",OriginalText:wc.characterData,Suggestions:ub.mgp(fa),CritiquePriority:fa.priority,Metadata:this.yom(fa.critiqueMetadata)});
this.vHb.rwg(M)}yom(M){const fa=[];if(M)for(const Va in M){const Fb=new Xk;Fb.Name=Va;Fb.Value=M[Va];fa.push(Fb)}return fa}executeAction(M,fa,Va){if(!fa)return!1;var Fb=M.suggestionGroup.contentData,Vb=this.Re.getAnnotationById(Fb.annotationId);switch(M.actionType){case Te.b.Next:case Te.b.Previous:return this.jW.gfb(this,fa,Va,M.actionType===Te.b.Previous),!0;case Te.b.AddToDictionary:if(!this.l0i())return!1;var wc=Fb.Hx;if(!wc)return Na.ULS.sendTraceTag(539828740,375,10,"Unable to extract critique context from content data."),
!1;var Xc=wc.node;if(!Xc)return Na.ULS.sendTraceTag(539828741,375,10,"Unable to extract current paragraph node from critique context."),!1;wc=Xc.characterData.substring(wc.cpBegin,wc.cpEnd);this.zkb.MOh(wc)?(this.zkb.rvg("Unused correlation id."),this.Re.NBj()):Na.ULS.sendTraceTag(540645317,375,15,"[Add to Dictionary] Unable to add word to dictionary. Word already in dictionary: {0}",this.zkb.brd(wc));case Te.b.IgnoreAll:case Te.b.Apply:case Te.b.IgnoreOnce:z.AFrameworkApplication.$c("634j8931;09717904");
if(this.xl.jba(Fb.Hx))return Na.ULS.sendTraceTag(509650131,375,15,"Failed to process action ID {0} since it was performed over a locked range",M.actionType),!1;Fb.Ifi=!0;if(this.nD()&&M.actionType==Te.b.IgnoreAll){M=this.ga.Ob(Q.a.Hsa,1);if(32!==M){Na.ULS.sendTraceTag(528023651,375,15,"Failed to process action ID {0} since it is apparently disabled: {1}",Q.a.Hsa,M);break}this.ga.Qb(Q.a.Hsa,2,6===this.bLa?Fb.Hx:null);break}wc=Fb.Hx;Xc=M.actionType===Te.b.Apply;if(Vb){const Dd=Xc?60:70;this.Re.Sca(Vb,
Dd);this.ZIg(Vb,Dd,M.actionType,fa.Hc);this.sa.raiseEvent("AugloopProofingActionEventKey",new Lk(M.actionType,Fb.L$c?Qd.a.wVj:Vb.content.categoryName));Fb.L$c||(Vb=Vb.content,M.actionType==Te.b.Apply?this.Nub(Vb,cg.Accepted,this.bLa):M.actionType==Te.b.IgnoreOnce&&this.Nub(Vb,cg.Rejected,this.bLa),this.Dwg(wc,Vb,M))}else Na.ULS.sendTraceTag(589112198,375,15,"Unable to find annotation for proofing suggestion");Xc&&(this.S9d(M,wc,Fb.L$c,M.suggestionGroup.type===Th.a.eye),this.ga&&this.ga.Ob(Q.a.Ava,
2));M=this.Rc.Lc(3);try{var vd=wc.node;M.Ab(vd);vd.Xl(16,!0)}finally{M&&M.dispose()}this.bLa=null;break;case Te.b.LearnMore:return Pe.a.Tm(ub.learnMoreUrl,void 0,void 0,"AugLoopProofing.LearnMore"),!0;case Te.b.Toggle:switch(M.objectFulfillment){case Th.a.mVc:this.nCb=Th.a.U1h;this.xFa.M5b?this.xFa.ssg("MLA","MLASeventhEditionOfficeOnline.xsl","7"):this.xFa.Nsf(ub.kNl);break;case Th.a.Nnf:this.nCb=Th.a.Rql;this.xFa.M5b?this.xFa.ssg("APA","APASixthEditionOfficeOnline.xsl","6"):this.xFa.Nsf(ub.iNl);
break;case Th.a.Onf:this.nCb=Th.a.Sql,this.xFa.M5b?this.xFa.ssg("Chicago","CHICAGO.XSL","16"):this.xFa.Nsf(ub.jNl)}this.P4b=M.objectFulfillment;this.w$g||(this.s9.execute(Dd=>{Dd.v7o()}),this.w$g=!0);return!0;case Te.b.Report:return Fb.L$c?(Fb=new Od,Va=JSON.parse(M.descriptorData),Va=[Va.comments,Va.option,void 0,Va.snippet,void 0,void 0,Va.url],this.Bpa.Gha(JSON.stringify(Fb),JSON.stringify(new Nj(Va)),ub.R$o),Vb&&(this.Re.Sca(Vb,70),this.ZIg(Vb,70,M.actionType,fa.Hc))):(fa=null===Vb||void 0===
Vb?void 0:Vb.content,vd=Vb=Va="",fa.critiqueMetadata&&(Va=fa.critiqueMetadata.ModelName||"",Vb=fa.critiqueMetadata.ModelVersion||"",vd=fa.critiqueMetadata.CritiqueSource||""),M=JSON.parse(M.descriptorData),Fb.nYi?(Fb=new ce({start:fa.startInContext,length:fa.range.length},vd,Va,Vb),Vb=[],M=lm(M.payload.comment),Vb.push(M.I2b,M.DEa,M.ICa,M.H9d),this.Bpa.Gha(JSON.stringify(Fb),JSON.stringify(new Ge(Vb)),ub.iPf),M.DEa===Th.a.KOb&&this.ZEa.W0b(M.ICa,M.H9d,{start:fa.startInContext,length:fa.range.length},
Va,!0)):(Fb=new Ii({start:fa.startInContext,length:fa.range.length},Va,Vb),Vb=[],M=Vc(M.payload.comment),Vb.push(M.I2b,M.DEa,M.ICa,M.KZb,void 0),this.Bpa.Gha(JSON.stringify(Fb),JSON.stringify(new Wj(Vb)),ub.tug),M.DEa===Th.a.KOb&&this.ZEa.W0b(M.ICa,M.KZb,{start:fa.startInContext,length:fa.range.length},Va,!1))),!0;case Te.b.SelectSource:return this.qj.LKg(),!0;case Te.b.OpenEditorPane:return 32!==this.ga.Ob(Ci.a.z_a,2)?(Na.ULS.sendTraceTag(576213522,341,15,"Failed to launch editor pane from contextual card"),
!1):!0;case Te.b.Options:return 32!==this.ga.Ob(Q.a.kwb,2)?(Na.ULS.sendTraceTag(540583896,341,15,"Failed to open customize setting from contextual card"),!1):!0;case Te.b.ShowExplanation:M=null===Vb||void 0===Vb?void 0:Vb.content;if(!M)return Na.ULS.sendTraceTag(545399640,341,15,"Critique is undefined for ShowExplanation"),!1;Va=fa=Fb="";M.critiqueMetadata&&(Fb=M.critiqueMetadata.ModelName||"",fa=M.critiqueMetadata.ModelVersion||"",Va=M.critiqueMetadata.CritiqueSource||"");xg.c(Ci.a.DUj,void 0,void 0,
void 0,void 0,void 0,{GQp:M.language,uNp:M.typeId,tNp:Va,KPp:Fb,MPp:fa});return!0;default:return Na.ULS.sendTraceTag(590434769,341,15,"Failed to process action of type {0} since it is not known to us.",M.actionType),!1}Fb.Rja&&(this.jW.gfb(this,fa,Va,!1)||this.jW.gfb(this,fa,Va,!0));return!0}static mgp(M){const fa=[];if(!M.suggestions)return fa;for(const Va of M.suggestions)fa.push(Va.text);return fa}static lgp(M){switch(M.actionType){case Te.b.Apply:return M.suggestion.title;default:return""}}nD(){return!!z.AFrameworkApplication.J&&
z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}l0i(){var M,fa;return(null===(fa=null===(M=this.zkb)||void 0===M?void 0:M.hBi)||void 0===fa?void 0:fa.call(M))===fl.a.lCc}get bLa(){return this.iAk}set bLa(M){this.iAk=M}ZIg(M,fa,Va,Fb){this.KD.Utb(M,fa)||(fa=0);Va===Te.b.IgnoreAll&&xg.c(Q.a.BWj,!0,void 0,void 0,void 0,void 0,{[ub.Source]:null!==this.bLa?nh[this.bLa]:"rightClickMenu"});if(Va=this.KD.Ivi(M,Va===Te.b.IgnoreAll?1:0)){const Vb=new Gh.a;
Vb.contentDescriptor=Va;Vb.annotationType=M.annotationType;Vb.state=fa;this.FH.setState(Fb,Vb)}}T0k(M){this.sa.addHandler("AugloopProofingActionEventKey",M)}R0k(M){this.sa.addHandler("AnnotationFocusOrHoverOperationEvent",M)}Z3l(M,fa){M=fa.Rxk;const Va=fa.kB,Fb=fa.hgb===Te.b.Apply;if(Va){this.Re.Sca(Va,Fb?60:70);this.ZIg(Va,Fb?60:70,fa.hgb,M.node.Hc);const Vb=Va.content;this.sa.raiseEvent("AugloopProofingActionEventKey",new Lk(fa.hgb,Vb.categoryName));fa.hgb==Te.b.Apply?this.Nub(Vb,cg.Accepted,2):
fa.hgb==Te.b.IgnoreOnce&&this.Nub(Vb,cg.Rejected,2);this.Dwg(M,Vb,null,fa.WIe,this.cGi(Va,fa.WIe,fa.hgb));Fb?this.S9d(null,M,!1,!1,this.cGi(Va,fa.WIe,fa.hgb),fa.Wzk,fa.Xzk):fa.hgb===Te.b.IgnoreAll&&(fa=this.gnm(M.node),this.Ooo(fa))}else Na.ULS.sendTraceTag(538817697,375,15,"Unable to find annotation for proofing suggestion")}gnm(M){const fa=(new Nc.a).Ql();if(!fa)return null;fa.set(M);if(fa.zb(35))return fa.Dp(35);fa.set(M);return fa.zb(37)?fa.Dp(37):null}Ooo(M){var fa=U.StaticActiveAppFrame.za().kb.hd;
fa=Object(cj.a)().qU(fa);M&&(M=Uj.a.Bo(M),this.VTi(M,fa));M=Uh.b(fa);this.VTi(M,fa)}VTi(M,fa){if(M){var Va=this.Rc.Lc(2);try{for(Va.Ab(fa);M.moveNext();)R.ParagraphReader.Fh(M.iterator)&&M.currentNode.Xl(16,!0)}finally{Va&&Va.dispose()}}}cGi(M,fa,Va){return Va===Te.b.Apply&&M&&M.content[ub.suggestions].length>fa?M.content[ub.suggestions][fa][ub.text]:""}hOm(M,fa){switch(Qd.a.h8d(M)){case 0:return this.IMd[fa];case 1:return this.dCd[fa];case 3:break;default:return this.gNd[fa]}}Nub(M,fa,Va){this.ga&&
(fa=this.hOm(M,fa))&&(xg.c(fa,!0,void 0,void 0,void 0,void 0,{[ub.Source]:nh[Va],[ub.critiqueTypeId]:M.typeId}),Qd.a.Zoc(M)?Na.ULS.sendTraceTag(527796422,375,50,"AugloopProofingIntentProvider: Logging command {0}, typeId {1}, priority {2}, ALV2 flight {3}, categoryName {4}.",fa,M.typeId,M.priority,this.nD(),M.categoryName):Na.ULS.sendTraceTag(527212896,375,50,"AugloopProofingIntentProvider: unknown critique."))}}ub.learnMoreUrl="https://aka.ms/similaritychecker";ub.gUk="https://support.microsoft.com/office/find-acronym-definitions-89062352-e1ce-4f59-b58c-f94869521404";
ub.Edl="BlockQuotation";ub.jri="FullCitation";ub.JRi="InlineCitation";ub.obi="CritiqueItem";ub.R$o="9b78c03f-58bc-44d7-80da-1c242f54f77f";ub.tug="c2b5d2e7-e528-43f9-9114-3b12b15a3208";ub.iPf="4688e793-8cb9-4109-8efe-7f3b3d8c24d9";ub.kNl='<b:Sources xmlns:b="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" xmlns="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" SelectedStyle="\\MLASeventhEditionOfficeOnline.xsl" StyleName="MLA" Version="7"><b:Source><b:Tag></b:Tag><b:SourceType>Book</b:SourceType><b:Guid></b:Guid><b:Author><b:Author><b:NameList><b:Person><b:Last></b:Last></b:Person></b:NameList></b:Author></b:Author><b:Title></b:Title><b:Year></b:Year><b:City></b:City><b:RefOrder>1</b:RefOrder></b:Source></b:Sources>';
ub.iNl='<b:Sources xmlns:b="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" xmlns="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" SelectedStyle="\\APASixthEditionOfficeOnline.xsl" StyleName="APA" Version="6"><b:Source><b:Tag></b:Tag><b:SourceType>Book</b:SourceType><b:Guid></b:Guid><b:Author><b:Author><b:NameList><b:Person><b:Last></b:Last></b:Person></b:NameList></b:Author></b:Author><b:Title></b:Title><b:Year></b:Year><b:City></b:City><b:RefOrder>1</b:RefOrder></b:Source></b:Sources>';
ub.jNl='<b:Sources xmlns:b="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" xmlns="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" SelectedStyle="\\CHICAGO.XSL" StyleName="Chicago" Version="16"><b:Source><b:Tag></b:Tag><b:SourceType>Book</b:SourceType><b:Guid></b:Guid><b:Author><b:Author><b:NameList><b:Person><b:Last></b:Last></b:Person></b:NameList></b:Author></b:Author><b:Title></b:Title><b:Year></b:Year><b:City></b:City><b:RefOrder>1</b:RefOrder></b:Source></b:Sources>';
ub.suggestions="suggestions";ub.text="text";ub.Source="Source";ub.critiqueTypeId="critiqueTypeId";Object(u.a)(ub,"AugLoopProofingIntentProvider",Tf.a,[331,1062]);var ec=d(1402),Tc=d(880),bd=d(235);class le extends Zh.a{constructor(){super();this.H_=Object.assign(new bd.a,{T_:le.getTypeName(),B_:le.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}}Object(u.a)(le,"AutoreplaceAnnotation",Zh.a,[]);var tf=d(1642);class pf{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce){this.Re=M;this.KY=fa;this.Rd=Va;this.Rc=Fb;this.sJ=Vb;this.ib=wc;this.Sg=Xc;this.LC=vd;this.kda=Ce}initialize(){this.LC.im().then(()=>{this.Re.ub(this,le.getTypeName())}).catch(M=>{this.Sg.sendTraceTag(558179978,375,10,"Autoreplace - EnsureAugLoopRuntimeManager threw exception when registering to AutoreplaceAnnotation. {0}",M.toString())})}gH(M,fa){this.V3o(M,
fa)&&(this.Re.Sca(M,40),this.R7k(M))}R7k(M){this.Sg.sendTraceTag(558131086,375,100,"Autoreplace - applyAutoReplace: applying autoreplace {0}",M.id);const fa=M.content;this.We(fa.suggestions[0].text,fa.context.substr(fa.startInContext,fa.range.length),M,!0)&&(this.Re.Sca(M,60),tf.a.a5f())}c$k(M){this.Sg.sendTraceTag(554210189,375,100,"Autoreplace - applyUndo: applying undo for {0}",M.id);const fa=M.content;return this.We(fa.context.substr(fa.startInContext,fa.range.length),fa.suggestions[0].text,M,
!1)?(this.Re.Sca(M,70),!0):!1}We(M,fa,Va,Fb){var Vb=Tc.a.B9a(Va.parentPath);Vb=Tc.a.uQb(this.sJ.value,Vb);if(!Vb)return this.Sg.sendTraceTag(558179980,375,15,"Autoreplace - replaceTextRange: Unable to get node from tileId for {0}.",Va.id),!1;const wc=Va.content;if(Vb.characterData.substr(wc.range.start,fa.length)!==fa)return this.Sg.sendTraceTag(558179981,375,50,"Autoreplace - replaceTextRange: context does not match paragraph text for {0}.",Va.id),!1;Va=this.Rc.Lc(15);let Xc=!1;try{Va.Ab(Vb);const vd=
E.a.createTextRange(Vb,wc.range.start,wc.range.start+fa.length);this.Rd.We(vd,M,!0,!1,Q.a.Ava);const Dd=pf.vQm(this.ib.gb.currentSelection.Qa,M.length-fa.length,wc.range.start+fa.length,Vb);null!==Dd&&this.ib.Kc(Dd);Xc=!0;Fb&&this.kda.iCa(Vb,wc.range.start,wc.range.start+M.length)}finally{return Va&&Va.dispose(),Xc}}V3o(M,fa){return fa!==ec.a.getTypeName()?!1:M&&M.content?this.KY.JZa?Qd.a.rWf(M.content):!1:(this.Sg.sendTraceTag(558179979,375,10,"Autoreplace - Handled annotation is invalid"),!1)}static vQm(M,
fa,Va,Fb){if(M.contextId!=rb.a.Cd&&M.contextId!=rb.a.Vc)return null;if(0!==fa){let Vb=M.cpBegin,wc=M.cpEnd;if(M.node==Fb&&wc>=Va)return Vb=Vb<Va?Vb:Vb+fa,wc+=fa,Pa.SelectionFactory.eL(Fb,Vb,wc)}return null}}Object(u.a)(pf,"AutoreplaceHandler",null,[114]);var rf=d(110);class Hg extends Tf.a{constructor(M,fa,Va,Fb){super();this.HM=M;this.Re=fa;this.Kok=Va;this.BGa=Fb;this.Rk=Th.a.Jbl;this.zJ=[this.Rk];this.Lia=[new fe.a(yh.a.QSd,yh.a.QSd)]}get types(){return this.zJ}get JRb(){return this.Lia}zS(M){if(!z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",
!1))return!1;this.HM.k2d(M.Hx,M.LAf,()=>!0)}executeAction(M,fa){return fa?M.actionType==Te.b.Undo?(M=M.suggestionGroup.contentData,fa=this.Re.getAnnotationById(M.annotationId),null==fa?(Na.ULS.sendTraceTag(546080609,375,10,"Autoreplace - Could not find annotation by id: {0}",M.annotationId),!1):this.Kok.c$k(fa)):!1:!1}dxb(M){this.Zx||(this.Zx=M,this.BGa.fTa((fa,Va)=>{fa=Va.paragraphNode;const Fb=Va.bna;for(const Vb of Va.contents)Qd.a.GQf(Vb.element,fa,Vb.intents,!0,this.VDa,this.HM,this.Zx,Fb,!1,
this.Rk)}))}RWa(M){M=(M=Qd.a.$ic(M,!1,this.Rk))?rf.firstOrDefault(M):null;return{returnValue:!!M,type:M?this.Rk:null,data:M}}c7a(M,fa){return(M=Qd.a.$ic(M,!1,this.Rk))&&M.contains(fa)?yh.a.QSd:null}VDa(M){return Qd.a.rWf(M)}}Object(u.a)(Hg,"AutoReplaceIntentProvider",Tf.a,[]);var Fh=d(77),Ef=d(32);class Bc extends Tf.a{constructor(M){super();this.ga=M;this.zJ=[Th.a.cel]}get types(){return this.zJ}zS(M){if(null!==M.Vo){const fa={};M=M.Vo.U7a;fa.location=M.clientPoint;if(0<=Fh.a.ifa(M.Df).search(Ef.a.lTd))return this.ga.Qb(Ci.a.Sye,
2,fa),!0}return!1}executeAction(){throw Error("Method not implemented.");}}Object(u.a)(Bc,"BookmarkIntentProvider",Tf.a,[]);var Qm=d(1472);class mm{constructor(M,fa,Va,Fb,Vb){this.pB=fa;this.qd=Va;this.ib=Fb;this.Glb=Vb;this.cxa=!1;this.p5=null;this.gfd=(wc,Xc)=>{z.AFrameworkApplication.$c("ei5i4882;aeig4817");!Xc.U7a.Lb||Xc.U7a.Lb.button||Xc.U7a.Lb.type===$c.a.contextMenu?this.Glb.dismiss():this.ib.gb&&this.ib.gb.length&&this.ib.gb.K(0)&&this.ib.gb.K(0).length&&(wc=this.ib.gb.K(0).Qa,this.zS(wc,
0,!0,Xc))};this.mfd=()=>{z.AFrameworkApplication.$c("75bbb705;a8g97181")};this.lJc=new H.a;if(M)for(const wc of M)this.lJc.add(wc);this.Glb.jff(this.mfd)}zS(M,fa,Va,Fb){if(!this.ib.gb||1!==this.ib.gb.length||1!==this.ib.gb.K(0).length||1===U.StaticActiveAppFrame.za().mode||!R.ParagraphReader.Wb(M.node))return!1;M=new Qm.a(M,fa,Va,!1,!1,!1,!1,Fb);for(const Vb of this.lJc)if(Vb.zS(M))break;return!0}Bmb(){this.p5=this.qd.Ie.editingElement;this.pB.gRd(this.gfd)}sdc(M){this.cxa||(this.cxa=!0,M.uBa?this.Bmb():
M.Qja(()=>{this.Bmb()}))}dispose(){this.p5&&(this.pB.xDj(this.gfd),this.Glb.zDj(this.mfd))}}Object(u.a)(mm,"CanvasActionListener",null,[10]);class Eg{constructor(M,fa,Va){this.P8o=(Fb,Vb,wc,Xc,vd)=>{Fb=null;Vb=({Hx:Fb}=this.qEp(Vb)).returnValue;if(32!==Vb)return Vb;if(1===wc)return 32;wc=vd?3:2;Vb=new Qm.a(Fb,wc,!1,!1);for(const Dd of this.lJc)if((3!==wc||Dd.eqe===vd)&&Dd.zS(Vb))return 32;return 2};this.ga=M;this.Zb=fa;this.lJc=new H.a;if(Va)for(const Fb of Va)this.lJc.add(Fb)}Xb(){this.ga.qa(Ci.a.hze,
rb.a.view,this.P8o);this.Zb.ie(hg.a.AF).MTc(Bg.KeyInputManager.oc(xh.a.K2b,1),Ci.a.hze,()=>1)}qEp(M){let fa=null;M=M.view.ve?M.view:null;if(!M||!M.lb)return{returnValue:8,Hx:fa};M=M.lb;if(1!==M.gb.length||1!==M.gb.K(0).length)return{returnValue:2,Hx:fa};fa=M.gb.K(0).Qa;return R.ParagraphReader.Wb(fa.node)?{returnValue:32,Hx:fa}:{returnValue:2,Hx:fa}}}Object(u.a)(Eg,"CanvasContextualActor",null,[]);var Xh=d(128),rq=d(1384),on=d(2127),Dl=d(723);class Zm{constructor(){this.data=this.gt=this.type=this.element=
null}}Object(u.a)(Zm,"ContextualHighlightState",null,[]);class tj extends Sys.EventArgs{constructor(M,fa,Va,Fb){super();this.element=M;this.paragraphNode=fa;this.type=Va;this.data=Fb}}Object(u.a)(tj,"ElementHighlightedEventArgs",Sys.EventArgs,[]);class qj extends rq.a{constructor(M,fa,Va,Fb=new Be.a){super();this.z4a=this.A2a=null;this.Srh=this.Rrh=0;this.Gma=Vb=>{if(!(Vb&&Vb.Lb&&Vb.Lb.target&&Vb.uq)||1===sb.a.ua.mode)return!1;const wc=Vb.Lb.screenX,Xc=Vb.Lb.screenY;if(wc===this.Rrh&&Xc===this.Srh)return this.A2a&&
this.A2a.element&&this.zKg(null,Vb.uq),!1;this.Rrh=wc;this.Srh=Xc;this.zKg(Vb.Lb.target,Vb.uq);return!1};this.Hma=Vb=>{if(!(Vb&&Vb.Lb&&Vb.Lb.target&&Vb.uq))return!1;this.A2a&&this.A2a.element===Vb.Lb.target&&this.zKg(null,Vb.uq);return!1};this.sa=Fb;this.p$=[];this.Lia=[];this.XD=Va;for(const Vb of fa)this.p$.push(Vb),this.Lia.push(...(Vb.JRb||[])),Vb.dxb(this);0<this.p$.length&&M.Vcb(this)}rff(M){this.sa.addHandler(qj.Udg,M)}JDj(M){this.sa.removeHandler(qj.Udg,M)}wno(M,fa,Va,Fb){this.sa.raiseEvent(qj.Udg,
new tj(M,fa,Va,Fb))}get Afa(){return!Ve.SessionStatusManager.instance.Jk}get Xrb(){return 2}get U9a(){return this.Lia}wwj(M,fa){if(fa)for(const Va of this.p$)if(Array.contains(Va.types,fa.type)){const Fb=Va.c7a(M,fa.data);if(Fb)return Fb}return null}XSl(M){return this.wwj(M,this.A2a)||this.wwj(M,this.z4a)}wMa(M,fa){if(this.vs.OIa){M=fa.WMa("*");for(let Va=0,Fb=M.length;Va<Fb;Va++){const Vb=M[Va],wc=this.XSl(Vb);this.Inc(Vb,fa,wc)&&this.AVo(Vb,wc)}}}AVo(M,fa){this.vs.BZa(M);var Va=Xh.a.Eb(M,qj.ouf);
Va&&(M.style.backgroundColor=Va,Xh.a.Cm(M,qj.ouf,null));if(Va=Xh.a.Eb(M,qj.qNb))M.classList.remove(Va),Xh.a.Cm(M,qj.qNb,null);fa&&(Xh.a.Cm(M,qj.ouf,M.style.backgroundColor),Xh.a.Cm(M,qj.qNb,fa),M.classList.add(fa),M.style.backgroundColor=null)}p9a(M,fa){if((M=Object(pg.a)(Zm,M))&&M.gt)for(const Va of M.gt)fa.add(Va)}zKg(M,fa){if(!M||!this.A2a||M!==this.A2a.element){var Va=null;if(M)for(var Fb of this.p$){let Vb,wc;const Xc=new H.a;if(({type:Vb,data:wc}=Fb.RWa(M,Xc)).returnValue){Xc.count||Xc.add(fa);
Va=Object.assign(new Zm,{element:M,type:Vb,gt:Xc,data:wc});break}}Fb=Object.assign(new on.a,{action:Va?2:3,type:2,$B:Va,VL:this.A2a});this.A2a=Va;this.vs.vH(Fb);this.wno(M,fa,Va?Va.type:null,Va?Va.data:null)}}X0d(M,fa,Va){Xh.a.Eb(M,qj.bci)||(Va($c.a.w3,M,this.Gma,fa),Va($c.a.MU,M,this.Hma,fa));Xh.a.Cm(M,qj.bci,this)}MNa(M,fa,Va){let Fb=null;if(M&&fa&&Va){if(this.z4a&&this.z4a.type===M&&this.z4a.gt===fa&&this.z4a.data===Va)return;Fb=Object.assign(new Zm,{element:null,type:M,gt:fa,data:Va});M=Object.assign(new on.a,
{action:0,type:2,$B:Fb,VL:this.z4a})}else{if(!this.z4a)return;M=Object.assign(new on.a,{action:1,type:2,$B:null,VL:this.z4a})}this.z4a=Fb;this.vs.vH(M)}Inc(M,fa,Va){return(1===Dl.a(M)||this.p$.some(Fb=>Fb.Inc(M)))&&!(this.XD&&fa.ic.so&&Va==yh.a.gmb)}}qj.bci="HighlightActor";qj.ouf="CanvasContextualHighlightActor_BackgroundColor";qj.qNb="CanvasContextualHighlightActor_HighlightClass";qj.Udg="OnElementHighlighted";Object(u.a)(qj,"CanvasContextualHighlightActor",rq.a,[]);var Fk=d(1601);class Jq{constructor(M,
fa,Va,Fb,Vb){this.ua=M;this.ml=fa;this.Xs=Va;this.vXa=Fb;this.w1j=Vb;this.zze=!1;this.editingElement=this.Yua=this.targetElement=this.containerElement=null;this.Foj=(wc,Xc)=>{wc=Xc.data;wc.isVisible?this.tze(wc.elements,wc.content):this.vU()};this.Tv=()=>{this.vU()};this.u0=()=>{this.vU()};this.onBlur=()=>{this.vU()};this.HI=wc=>{wc&&wc.Lb&&wc.Lb.keyCode===xh.a.J4&&this.vU();return!1}}initialize(){this.w1j.o2k(this.Foj)}Wd(){this.w1j.yCo(this.Foj)}dispose(){this.Wd()}tze(M,fa){this.zze&&this.vU();
if(M=Fk.a(M,"OfficeContextualTooltipTarget"))this.ua.a2(this.Tv),(this.Yua=this.Xs.Gd.container)&&kg.a.addHandler(this.Yua,$c.a.scroll,this.u0),this.editingElement=this.Xs.Ie.editingElement,kg.a.addHandler(this.editingElement,$c.a.blur,this.onBlur),this.containerElement=document.createElement("div"),this.containerElement.id="OfficeContextualTooltipContainer",this.targetElement=M,document.body.appendChild(this.containerElement),document.body.appendChild(this.targetElement),appChrome.renderToolTip(this.containerElement,
"OfficeContextualTooltip",fa,this.targetElement,0,!1,!1),this.vXa.ub($c.a.WK,this.editingElement,this.HI),this.zze=!0}vU(){try{this.zze&&this.ml.le(()=>{this.vXa.xc($c.a.WK,this.editingElement,this.HI);appChrome.clearToolTip(this.containerElement);kg.a.removeHandler(this.editingElement,$c.a.blur,this.onBlur);this.editingElement=null;this.Yua&&kg.a.removeHandler(this.Yua,$c.a.scroll,this.u0);this.ua.Yga(this.Tv);document.body.removeChild(this.containerElement);document.body.removeChild(this.targetElement);
this.targetElement=this.containerElement=null;this.zze=!1},"CCTAL:HT")}catch(M){Na.ULS.sendTraceTag(520632028,3016,15,"CanvasContextualTooltipActionListener.hideTooltip fails! Exception: {0}",M)}}}Object(u.a)(Jq,"CanvasContextualTooltipActionListener",null,[506,10]);var Zr=d(1366);class kc{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb){this.GIb=this.IHb=!1;this.o$=this.p5=this.pPc=this.zQc=this.xK=null;this.Tv=()=>{this.vU()};this.u0=()=>{this.vU()};this.onBlur=()=>{this.vU()};this.msc=(Ub,yc)=>
{this.fac&&(this.Glb.zI||Ve.SessionStatusManager.instance.Jk||(yc.element?yc.element.classList.contains(yh.a.Z7h)||mg.a.FD&&yc.element.classList.contains(yh.a.s5a)||this.tze([yc.element],WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick):this.vU()))};this.gfd=()=>{this.$Rf()};this.c8=()=>{this.o$||(this.o$=new Gf.a(3,1,1200,()=>{this.o$=null;this.g$d()},149),this.Jb.$b(this.o$),this.vU())};this.mfd=()=>{this.$Rf()};this.Nj=M;this.Zx=fa;this.tk=Va;this.pB=Fb;this.qd=Vb;this.oe=wc;
this.ib=Xc;this.fac=vd;this.Jb=Dd;this.Vih=Ce;this.Glb=ea;this.p$=[];this.HI=this.HI.bind(this);this.Weh=yb;this.p$.push(...Xa);Zr.a.x4d().then(()=>{try{var Ub=!(!appChrome.renderToolTip||!appChrome.clearToolTip)}catch(yc){Ub=!1}Ub&&(this.fac&&this.Zx.rff(this.msc),this.IHb=!0,this.pB.gRd(this.gfd),this.ib.AB(this.c8),this.Glb.jff(this.mfd))})}get eVj(){return this.fac}set eVj(M){(this.fac=M)?this.Zx.rff(this.msc):this.Zx.JDj(this.msc)}dispose(){this.IHb&&(this.$Rf(),this.fac&&this.Zx.JDj(this.msc),
this.pB.xDj(this.gfd),this.ib.gna(this.c8),this.Glb.zDj(this.mfd))}h$o(M,fa){this.tk.le(()=>{this.GIb&&this.vU();const Va=Fk.c(M.node,M.zj,M.Po);Va&&Va.length&&this.tze(Va,fa)},"CCTM:STWC")}tze(M,fa){this.GIb&&this.vU();if(M=Fk.a(M,"OfficeContextualTooltipTarget"))this.Nj.a2(this.Tv),this.qd.Gd&&(this.pPc=this.qd.Gd.container)&&kg.a.addHandler(this.pPc,$c.a.scroll,this.u0),this.p5=this.qd.Ie.editingElement,kg.a.addHandler(this.p5,$c.a.blur,this.onBlur),this.xK=document.createElement("div"),this.xK.id=
"OfficeContextualTooltipContainer",this.zQc=M,document.body.appendChild(this.xK),document.body.appendChild(this.zQc),appChrome.renderToolTip(this.xK,"OfficeContextualTooltip",fa,this.zQc,0,!1,!1),this.Weh&&this.oe.ub($c.a.WK,this.p5,this.HI),this.GIb=!0}vU(){this.GIb&&this.tk.le(()=>{this.Weh&&this.oe.xc($c.a.WK,this.p5,this.HI);appChrome.clearToolTip(this.xK);kg.a.removeHandler(this.p5,$c.a.blur,this.onBlur);this.p5=null;this.pPc&&kg.a.removeHandler(this.pPc,$c.a.scroll,this.u0);this.Nj.Yga(this.Tv);
document.body.removeChild(this.xK);document.body.removeChild(this.zQc);this.zQc=this.xK=null;this.GIb=!1},"CCTM:HT")}$Rf(){this.vU();this.o$&&(this.Jb.wf(this.o$),this.o$=null)}g$d(){var M,fa;if(!this.Glb.zI&&this.ib.gb&&1===this.ib.gb.length&&1===this.ib.gb.K(0).length&&(!this.Vih.instance||this.GIb||!this.Vih.instance.Oee())){var Va=this.ib.gb.K(0).Qa;if(R.ParagraphReader.Wb(Va.node)&&!((null===(M=z.AFrameworkApplication.J)||void 0===M?0:M.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsAiRewriteEnabled",
!1))||(null===(fa=z.AFrameworkApplication.J)||void 0===fa?0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",!1)))){var Fb=!1,Vb=null;this.tk.le(()=>{const wc=new Qm.a(Va,5,!1,void 0,!0);for(const Xc of this.p$)if(Xc.zS(wc)){Fb=!0;Vb=Xc.XKj;break}},"CCTM:HSC");Fb!==this.GIb&&(Fb?this.h$o(Va,Vb):this.vU())}}}HI(M){M&&M.Lb&&M.Lb.keyCode===xh.a.J4&&this.vU();return!1}}Object(u.a)(kc,"CanvasContextualTooltipManager",null,[10]);var ck=d(1560);class pn{constructor(M){this.wl=
this.M5b=this.WCb=null;this.Fsk=M}get h7a(){this.wl||(this.wl=this.Fsk.instance);return this.wl}tpo(){let M="",fa;if(this.h7a){fa=this.h7a.I1c();if(!fa)return M;for(let Va=0;Va<fa.length;Va++){const Fb=fa[Va];this.h7a.hXf(Fb)||-1===Fb.P0a.indexOf("StyleName=")||(this.WCb=Fb.P0a,this.M5b=Fb.id,M=Sys.Net.XMLDOM(this.WCb).documentElement.attributes.getNamedItem("StyleName").nodeValue)}}else Na.ULS.sendTraceTag(0,344,15,"readSavedCitationStyle cannot be completed because CustomXmlNodeHelper was not initialized.");
return M}ssg(M,fa,Va){if(this.WCb)if(this.h7a){const Fb=Sys.Net.XMLDOM(this.WCb);this.setAttribute(Fb,"StyleName",M);this.setAttribute(Fb,"SelectedStyle",fa);this.setAttribute(Fb,"Version",Va);this.WCb=(new XMLSerializer).serializeToString(Fb);this.h7a.HTo(this.M5b,this.WCb)}else Na.ULS.sendTraceTag(0,344,15,"replaceCitationStyleWithCurrentSelection cannot be completed because CustomXmlNodeHelper was not initialized.")}Nsf(M){let fa=null;this.h7a?({ced:fa}=this.h7a.Bdf(M)).returnValue||(this.M5b=
fa.getValue(dg.a.rNb),this.WCb=fa.getValue(dg.a.i7a)):Na.ULS.sendTraceTag(0,344,15,"createNewCustomXmlNode cannot be completed because CustomXmlNodeHelper was not initialized.")}setAttribute(M,fa,Va){const Fb=M.documentElement.attributes.getNamedItem(fa);Fb?Fb.nodeValue=Va:(fa=M.createAttribute(fa),fa.value=Va,M.documentElement.attributes.setNamedItem(fa))}}Object(u.a)(pn,"CustomXmlNodeHelper",null,[]);var Ul=d(1769),Kq=d(1795),Tm=d(1721),Eo=d(1473);class Dn{constructor(M,fa){this.Uda=M;this.HM=fa}YSl(M){let fa=
0,Va=1;this.Uda.fkc(M,!1)&&Va++;this.Uda.fkc(M,!0)&&(fa++,Va++);return new Tm.a(fa,Va)}fkc(M,fa){return this.Uda.fkc(M,fa)}Wfj(M,fa){if(!fa)return!1;fa=Eo.a.create(fa).Hx;M.qj.v_b(!0);return this.HM.XVb(fa,M)}}Object(u.a)(Dn,"DesignerReviewNavigator",null,[838]);class vo{constructor(M){this.Rja=M}}Object(u.a)(vo,"DictationCorrectionContentData",null,[]);class pc extends Tf.a{constructor(M,fa,Va,Fb){super();this.kwf="SpellingErrorHighlight";this.onDismiss=this.jW=this.Zx=null;this.ga=M;this.BGa=fa;
this.Chb=Va;this.kgh=!0;this.Heh=Fb;this.zJ=[Th.a.Lyb];this.Lia=[new fe.a(this.kwf,this.kwf)];this.aqa=[Q.a.czc,Q.a.dzc,Q.a.ezc,Q.a.fzc,Q.a.gzc]}get types(){return this.zJ}get JRb(){return this.Lia}jSj(){return this.Heh&&this.IUa}get IUa(){return this.kgh}set IUa(M){this.Heh&&(this.kgh=M,this.$Ka())}iVc(M){return!!M.Hv}dxb(M){this.Zx||(this.Zx=M,this.BGa.n1k((fa,Va)=>{Va.aXc.vF&&this.IUa&&(this.Zx.X0d(Va.element,Va.paragraphNode,Va.bna),Xh.a.Cm(Va.element,pc.jwf,Va.aXc),Va.element.classList.add(pc.Gtf))}))}bkd(M){this.jW||
(this.jW=M)}RWa(M){let fa=null;if(M=Xh.a.Eb(M,pc.jwf))fa=Th.a.Lyb;return{returnValue:!!M,type:fa,data:M}}c7a(M,fa){return Xh.a.Eb(M,pc.jwf)===fa?this.kwf:null}zS(M){if(!this.IUa)return!1;const fa=M.Hx,Va=this.Chb.$Ja(fa);return!Va||Ve.SessionStatusManager.instance.Jk?!1:M.byc?!0:this.invoke(fa.node,Va,M.uXa,M.xUa,M.Rja,M.source)}invoke(M,fa,Va,Fb,Vb,wc){if(!this.IUa)return!1;var Xc=[Te.b.IgnoreOnce,Te.b.Apply],vd=Te.f.None,Dd=[];const Ce=fa.vF,ea=Ce.suggestions;let Xa=!1;for(let yb=0,Ub=Math.min(this.aqa.length,
ea.count);yb<Ub;++yb){const yc=ea.K(yb);""===yc.suggestion?Xa=!0:Dd.push({id:"DictationCorrectionSuggestion-"+yb,title:yc.suggestion,description:yc.suggestion,supportedActions:[Te.b.Apply]})}Xa&&Xc.push(Te.b.Deleted);Xc=[{type:Th.a.Lyb,id:Th.a.Lyb+"Suggestions",title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle,snippet:Ce.source,snippetFormatting:[{...Te.h,start:fa.vu,length:Ce.source.length,underlineType:vd}],suggestions:Dd,supportedActions:Xc,contentData:new vo(Vb),telemetryData:null,isContentPending:!1}];
Dd=vd=0;Vb&&({index:Dd,count:vd}=this.jW.RYc(M,fa.vu,this,Dd,vd));Vb={...Te.g,id:"Intent-"+Th.a.Lyb,suggestionGroups:Xc,setSize:vd,positionInSet:Dd};Xc=E.a.createTextRange(M,fa.vu,fa.cpEnd);return this.qj.Dna(Xc,Vb,this,Va,Fb,()=>{let yb;this.Zx.MNa(Th.a.Lyb,(yb=new H.a,yb.add(M),yb),fa)},yb=>{let Ub;this.Zx.MNa(Th.a.Lyb,(Ub=new H.a,Ub.add(M),Ub),null);yb&&yb||this.ga.Ob(Q.a.Fof,2);if(this.onDismiss)this.onDismiss(fa,!!yb&&yb)},void 0,void 0,void 0,void 0,void 0,void 0,Ke(wc),wc)}executeAction(M,
fa,Va){if(!fa)return!1;if(M.actionType===Te.b.Next||M.actionType===Te.b.Previous)return this.jW.gfb(this,fa,Va,M.actionType===Te.b.Previous),!0;if(!({actionId:Fb}=this.lFf(M,fa,Va)).returnValue)return!1;this.qj.v_b(!0);this.ga.Ob(Fb,2);var Fb=M.suggestionGroup.contentData;pc.sAg(M.actionType)&&Fb.Rja&&(this.jW.gfb(this,fa,Va,!1)||this.jW.gfb(this,fa,Va,!0));return!0}lFf(M,fa,Va){let Fb=0;if(M.actionType===Te.b.Apply){fa=M.suggestionGroup.suggestions;for(Va=0;Va<fa.length;Va++)if(fa[Va]===M.suggestion)return Fb=
this.aqa[Va],{returnValue:!0,actionId:Fb};Na.ULS.sendTraceTag(595341767,341,15,"Didn't find suggestion inside suggestion group. Null suggestion: {0}",!M.suggestion)}else{if(M.actionType===Te.b.IgnoreOnce)return Fb=Q.a.l1b,{returnValue:!0,actionId:Fb};if(M.actionType===Te.b.Deleted&&(M=E.a.Uc(fa,Va),M=this.Chb.$Ja(M)))for(M=M.vF.suggestions,fa=0;fa<M.count;fa++)if(""===M.K(fa).suggestion&&fa<this.aqa.length)return Fb=this.aqa[fa],{returnValue:!0,actionId:Fb}}return{returnValue:!1,actionId:Fb}}static sAg(M){return M===
Te.b.Apply||M===Te.b.IgnoreOnce||M===Te.b.IgnoreAll}}pc.Gtf="DictationCorrection";pc.jwf="DictationCorrectionDataName";Object(u.a)(pc,"DictationCorrectionIntentProvider",Tf.a,[]);class Dm extends Sys.EventArgs{constructor(M){super();this.categoryName=M}}Object(u.a)(Dm,"IdeasCardDismissedEventArgs",Sys.EventArgs,[]);class wo extends Sys.EventArgs{constructor(M,fa,Va){super();this.annotationType=M;this.oldState=fa;this.newState=Va}}Object(u.a)(wo,"ResultStateUpdateEventArgs",Sys.EventArgs,[]);var Zn=
d(1563);class zk{constructor(M,fa,Va,Fb,Vb,wc){this.Wib=!1;this.owj=this.qj=null;this.x5c=(Xc,vd,Dd)=>{this.sa.raiseEvent("OnResultStateUpdate",new wo(Xc,vd,Dd))};this.rB=M;this.mx=fa;this.k1=Va;this.hja=Fb;this.sa=new Be.a;this.Re=Vb;this.mhb=wc;Zn.a.jd.addHandler(Zn.a.Jme,this.Qfd.bind(this));this.rB.onDismiss=(Xc,vd)=>{vd||(1===Xc.proofingType?this.oRb(zk.AWj):2===Xc.proofingType&&this.oRb(zk.QKi))};this.mx.onDismiss=(Xc,vd)=>{vd||this.oRb(Xc)};this.k1.onDismiss=(Xc,vd)=>{vd||this.oRb(Th.a.qfi)};
this.hja.Afd=()=>{this.CVm()};this.C0d()}fji(){this.rB.Rra=!0;this.rB.Qra=!0;this.rB.fpb=!1;this.mx.sJa=!0;this.mx.oOb=null;this.mx.I6c=null;this.mx.Rra=!0;this.mx.Qra=!0;this.k1.IUa=!0}h1n(M){this.rB.isPaneOpen=!0;this.mx.isPaneOpen=!0;this.mhb.isPaneOpen=!0;this.mzf(M)}Dij(M,fa,Va){M?this.owj.SUm(M,fa):(this.mzf(Va),this.qj.zI&&this.qj.dismiss())}mzf(M){(this.Wib=M)?this.fji():this.C0d()}MUl(){this.rB.Rra=!1;this.rB.Qra=!1;this.rB.fpb=!1;this.mx.sJa=!1;this.mx.oOb=null;this.mx.I6c=null;this.mx.Rra=
!1;this.mx.Qra=!1}C0d(){this.rB.Rra=!0;this.rB.Qra=!0;this.rB.fpb=!0;this.mx.sJa=!1;this.mx.oOb=null;this.mx.I6c=null;this.mx.Rra=!0;this.mx.Qra=!0;this.k1.IUa=!0}Qfd(M,fa){"View"==fa.documentMode?this.MUl():this.mhb.isPaneOpen&&this.Wib?this.fji():this.C0d()}tXn(){this.rB.isPaneOpen=!1;this.mx.isPaneOpen=!1;this.mhb.isPaneOpen=!1;this.C0d()}oRb(M){this.sa.raiseEvent("OnCardDismissed",new Dm(M))}f1k(M){this.sa.addHandler("OnCardDismissed",M)}CVm(){this.sa.raiseEvent("OnRealEditsMade")}IPh(M){this.sa.addHandler("OnRealEditsMade",
M)}pCo(M){this.sa.removeHandler("OnRealEditsMade",M)}Y1k(M){this.sa.addHandler("OnResultStateUpdate",M)}xfg(M){this.mzf(M)}Dne(M,fa){fa?this.Re.qMh(this.x5c,M):this.Re.CBj(this.x5c,M)}}zk.AWj="Spelling";zk.QKi="Grammar";zk.Lnl="ChainAll";Object(u.a)(zk,"IdeasCardsMessageHandler",null,[1046]);var Rk=d(1622),Mk=d(124);class Um extends Tf.a{constructor(M,fa){super();this.KK=M;this.ga=fa;this.zJ=[];this.ga.fb(Ci.a.eTi,rb.a.view,Mk.ActionManager.cU,4);this.ga.fb(Ci.a.gTi,rb.a.view,Mk.ActionManager.cU,
4)}get types(){return this.zJ}zS(M){if(Ve.SessionStatusManager.instance.Jk)return!1;var fa=M.Hx,Va=this.KK.t4c(fa,!0);if(1!==Va.count)return!1;if(M.byc)return M=Va.K(0),fa=this.KK.t4d(fa.node.Hc,M),Pc.a.T4c().equals(fa,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?!1:!0;Va={...Te.g,id:"ActionSet",suggestionGroups:[{type:"ActionSet",id:"ActionSetGroup",suggestions:[{type:"MarkCompleteRemoveTextItem",id:"ActionSet",title:WordEditorIntl.WordEditorStrings.L_MarkCompleteIntelligentPlaceholderRemoveText},
{type:"MarkCompleteKeepTextItem",id:"ActionSet",title:WordEditorIntl.WordEditorStrings.L_MarkCompleteIntelligentPlaceholderKeepText},{type:"OpenNavPaneItem",id:"ActionSet",title:WordEditorIntl.WordEditorStrings.L_OpenNavPaneIntelligentPlaceholderTab}],isContentPending:!1}]};this.ga.Ob(Ci.a.gTi,2);return this.qj.Dna(fa,Va,this,M.uXa,!1)}executeAction(M,fa){if(!fa)return!1;M=M.suggestion.type;this.ga.Ob(Ci.a.eTi,2);switch(M){case "OpenNavPaneItem":return 32===this.ga.Ob(Ci.a.Rxc,2);case "MarkCompleteItem":case "MarkCompleteRemoveTextItem":return 32===
this.ga.Ob(Ci.a.a7f,2);case "MarkCompleteKeepTextItem":return 32===this.ga.Ob(Ci.a.bcj,2);default:return Na.ULS.sendTraceTag(50995855,341,15,"Failed to process action of type {0} since it is not known to us.",M),!1}}}Object(u.a)(Um,"IntelligentPlaceholderProvider",Tf.a,[]);var Tg=d(727),nm=d(152),xm=d(1412),xf=d(1770);class em extends Sys.EventArgs{constructor(M,fa){super();this.action=M;this.category=fa}}Object(u.a)(em,"LegacyProofingActionEventArgs",Sys.EventArgs,[]);class Ug{constructor(M,fa){this.f_d=
!1;this.errorDetails=M;this.Rja=fa}}Object(u.a)(Ug,"ProofingContentData",null,[]);class El{constructor(M,fa,Va,Fb=null,Vb=null,wc=null,Xc=null,vd=0){this.categoryName=null;this.inChainMode=this.isPaneOpen=!1;this.cultureName=this.typeId=this.traceId=this.action=null;this.suggestionCount=0;this.categoryName=M;this.isPaneOpen=fa;this.inChainMode=Va;this.action=Fb;this.traceId=Vb;this.typeId=wc;this.cultureName=Xc;this.suggestionCount=vd}}Object(u.a)(El,"ProofingTelemetryData",null,[]);class mk extends Tf.a{constructor(M,
fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub,yc,ad,md,Sd,ze,Ne){var ng;super();this.ga=M;this.ZEa=fa;this.NLe=Va;this.RQa=Fb;this.wxa=Vb;this.kda=wc;this.Oo=Xc;this.vRc=vd;this.Bpa=Dd;this.BGa=Ce;this.n4e=ea;this.o4e=Xa;this.HM=yb;this.vr=Ub;this.Jb=yc;this.ADb=Ne;this.jW=this.Zx=null;this.igh=this.EDb=this.FDb=!1;this.onDismiss=null;this.isPaneOpen=!1;this.Rvb=()=>{this.n4e.Rvb(this.TIb)};this.Cmj=()=>{this.o4e.bMi(this.TIb)};this.Qjg=md;null===ad||void 0===ad?void 0:ad.aff(this.Rvb);null===(ng=this.wxa)||
void 0===ng?void 0:ng.Bff(this.Cmj);this.Faf=Th.a.PRj;this.JOd=Th.a.ORj;this.Baf=Th.a.mxc;this.Daf=Th.a.eye;this.zJ=[this.Faf,this.JOd,this.Baf,this.Daf];this.Lia=[new fe.a(yh.a.hyc,yh.a.hyc),new fe.a(yh.a.llc,yh.a.llc)];this.bHh=[Q.a.Rzb,Q.a.Szb,Q.a.Tzb,Q.a.m1b,Q.a.n1b];this.y4a=new nm.a;this.y4a.W(1,Q.a.bAe);this.y4a.W(2,Q.a.G9d);this.y4a.W(3,Q.a.GAe);M=new nm.a;M.W(Te.b.IgnoreOnce,Q.a.eBa);M.W(Te.b.IgnoreAll,Q.a.Hsa);M.W(Te.b.AddToDictionary,Q.a.wOh);fa=new nm.a;fa.W(Te.b.IgnoreOnce,Q.a.eBa);fa.W(Te.b.Options,
Q.a.kwb);Va=new nm.a;Va.W(Te.b.IgnoreOnce,Q.a.eBa);Va.W(Te.b.Options,Q.a.kwb);this.Xvd=new nm.a;this.Xvd.W(1,M);this.Xvd.W(2,fa);this.Xvd.W(3,Va);this.PAj();this.sa=ze||new Be.a;Sd.execute(Ng=>{this.V$e=Ng;Ng.FEg(this.$Ka)})}get types(){return this.zJ}get JRb(){return this.Lia}get Rra(){return this.FDb}set Rra(M){this.FDb=M;this.$Ka()}get Qra(){return this.EDb}set Qra(M){this.EDb=M;this.$Ka()}get fpb(){return this.igh}set fpb(M){this.igh=M;this.$Ka()}get n6k(){return this.Rra||this.Qra||this.fpb}k0b(M){var fa,
Va;if((null===(fa=this.V$e)||void 0===fa?0:fa.c_f)||M.X$a()||z.AFrameworkApplication.eta)return!1;if(Object(ri.a)(Tg.a,M)){if(fa=Object(pg.a)(Tg.a,M),!this.Djn(fa)||!this.Gjn(fa))return!1}else Na.ULS.sendTraceTag(591011907,341,50,"Error details is not EditorServiceErrorDetails");if((null===(Va=this.ADb)||void 0===Va?0:Va.c2)&&!this.isPaneOpen){Va=Object(pg.a)(Tg.a,M);if(!Va)return!1;if(Va.lcid&&zf.a.Eg(Va.lcid).name)return this.ADb.$Wf(Va.wu.TypeId);Na.ULS.sendTraceTag(528782659,375,10,"Missing language name for critique in LegacyProofingIntentProvider.")}return this.Rra&&
1===M.proofingType||this.Qra&&2===M.proofingType||this.fpb&&3===M.proofingType}Djn(M){return null!==this.RQa&&!this.RQa.cXf(M.typeId,M.wu.CategoryTitle)&&this.isPaneOpen?!1:!0}Gjn(M){const fa=zf.a.Eg(M.lcid);return!this.wxa||this.wxa.bXf(M.typeId,M.wu.CategoryTitle,null===fa||void 0===fa?void 0:fa.Ppc)}iVc(M){return!!M.Uq&&!!M.Uq.errorDetails&&(1===M.Uq.errorDetails.proofingType||2===M.Uq.errorDetails.proofingType||3===M.Uq.errorDetails.proofingType)}AXm(M,fa,Va,Fb){if((Va=Object(pg.a)(Tg.a,Va.errorDetails))&&
this.k0b(Va)){switch(Va.proofingType){case 1:var Vb=yh.a.mDg;var wc=mk.ruf;break;case 2:Vb=yh.a.Zqf;wc=mk.puf;break;case 3:Vb=yh.a.FRd;wc=mk.nuf;break;default:return}this.Zx.X0d(M,fa,Fb);Xh.a.Cm(M,wc,Va);M.classList.add(Vb);this.u2b&&this.rdf(M,Va.proofingType);Ob.a.mcd()}}get u2b(){if(null!=this.v6g)var M=this.v6g;else{var fa,Va;M=this.v6g=null!==(Va=null===(fa=z.AFrameworkApplication.J)||void 0===fa?void 0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1))&&
void 0!==Va?Va:!1}return M}rdf(M,fa){switch(fa){case 1:M.setAttribute("aria-invalid","spelling");break;case 2:M.setAttribute("aria-invalid","grammar")}}dxb(M){this.Zx||(this.Zx=M,this.BGa.P0k((fa,Va)=>{fa=Va.paragraphNode;const Fb=Va.bna;for(const Vb of Va.contents)this.AXm(Vb.element,fa,Vb.Uq,Fb)}))}bkd(M){this.jW||(this.jW=M)}RWa(M){let fa=Xh.a.Eb(M,mk.ruf);if(fa)return M=this.Faf,{returnValue:!0,type:M,data:fa};if(fa=Xh.a.Eb(M,mk.puf))return M=this.JOd,{returnValue:!0,type:M,data:fa};M=(fa=Xh.a.Eb(M,
mk.nuf))?this.Baf:null;return{returnValue:!!fa,type:M,data:fa}}c7a(M,fa){return Xh.a.Eb(M,mk.ruf)===fa?yh.a.hyc:Xh.a.Eb(M,mk.puf)===fa?yh.a.llc:Xh.a.Eb(M,mk.nuf)===fa?yh.a.gmb:null}zS(M){if(!this.n6k||Ve.SessionStatusManager.instance.Jk)return!1;z.AFrameworkApplication.$c("SpellCheckDisableInViewingMode;SpellCheckDisableInViewingModecf");if(1==sb.a.ua.mode)return!1;const fa=M.Hx,Va=this.HM.msa(fa);if(!Va)return!1;const Fb=Va.errorDetails;return Fb.wu&&this.k0b(Fb)?M.byc?!0:this.invoke(fa.node,Va,
M.uXa,M.xUa,M.Rja,M.source):!1}k5f(){const M=Gf.a.paa(0,()=>{const fa=this.vr;fa&&fa.execute(Va=>{Va.logActivity("GrammarSuggestionsInteracted",null)})},0,195);this.Jb.$b(M)}Nub(M,fa,Va){if(Va===xf.a.lwc){({value:Fb}=this.y4a.Ec(M.proofingType,0)).returnValue&&(this.ga.Ob(Fb,2),Na.ULS.sendTraceTag(527799888,375,50,"LegacyProofingIntentProvider: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",Fb,M.typeId,M.proofingType,this.nD()));var Fb=zf.a.Eg(M.lcid);if(Fb)var Vb=Fb.name;Vb&&
"EN-US"===Vb.toUpperCase()&&2===M.proofingType&&this.k5f()}this.isPaneOpen&&(Vb=zf.a.Eg(M.lcid),this.Oo.sendMessage(xm.a.Xgj,new El(M.wu.CategoryTitle,this.isPaneOpen,fa,Va,M.wu.TraceId,M.wu.TypeId,Vb?Vb.name:null,M.wu&&M.wu.Suggestions?M.wu.Suggestions.length:0)),this.vRc&&this.vRc.g0n(Va));this.sa.raiseEvent("LegacyProofingActionEventKey",new em(Va,M.wu.CategoryTitle))}LYf(){var M;const fa=null!==(M=z.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)&&void 0!==M?M:"";return"Automation"===
fa||"Dogfood"===fa||"Microsoft"===fa}MYf(M){if(this.LYf()&&M&&0<M.length)for(const fa of M)if(fa&&"CritiqueSource"===fa.Name&&"Inference"===fa.Value)return!0;return!1}invoke(M,fa,Va,Fb,Vb,wc){const Xc=fa.errorDetails;var vd=Xc.wu;if(!vd||!this.k0b(Xc))return!1;let Dd,Ce,ea;switch(Xc.proofingType){case 1:Xc.errorType?(Dd=this.Faf,Ce=[Te.b.IgnoreOnce,Te.b.IgnoreAll,Te.b.AddToDictionary]):(Dd=this.Daf,Ce=[Te.b.IgnoreOnce]);ea=Te.f.SpellingSquiggle;break;case 2:Dd=this.JOd;Ce=[Te.b.IgnoreOnce,Te.b.Options];
ea=Te.f.GrammarSquiggle;break;case 3:Dd=this.Baf;Ce=[Te.b.IgnoreOnce,Te.b.Options];ea=Te.f.CritiqueSquiggle;break;default:return!1}const Xa=[];var yb=[Te.b.Apply];for(var Ub of vd.Suggestions)Xa.push({id:"Suggestion-"+Xa.length,title:Ub.Text,titleFormatting:w(vd.Context,Ub.Text,vd.TypeId),description:Ub.Description,supportedActions:Ub.Action?yb:[]});Ub=yb=0;Vb&&({index:Ub,count:yb}=this.jW.RYc(M,fa.Dc,this,Ub,yb));const yc=new Ug(Xc,Vb);vd={id:"Intent-"+Dd,suggestionGroups:[{type:Dd,id:Dd,icon:this.MYf(vd.Metadata)?
{resourceId:"Inference",width:0,height:0}:null,title:vd.ExplanationTitle,description:vd.ExplanationLabel,explanation:vd.Explanation,snippet:vd.Context,snippetFormatting:[{...Te.h,start:vd.StartInContext,length:vd.Length,underlineType:ea}],suggestions:Xa,supportedActions:Ce,contentData:yc,telemetryData:new El(vd.CategoryTitle,this.isPaneOpen,Vb),isContentPending:!1,cardHeader:vd.CategoryTitle,critiqueSubType:vd.TypeId}],setSize:yb,positionInSet:Ub};const ad=E.a.createTextRange(M,fa.Dc,fa.end);this.Nub(Xc,
Vb,xf.a.lwc);fa=!1;this.ga.t_(Ci.a.z_a)&&(fa=!0);return this.qj.Dna(ad,vd,this,Va,Fb,()=>{const md=new H.a;md.add(M);this.Zx.MNa(Dd,md,Xc);this.qj.Hqc()},md=>{const Sd=new H.a;Sd.add(M);this.Zx.MNa(Dd,Sd,null);this.e5f(yc,ad);if(this.onDismiss)this.onDismiss(Xc,!!md)},void 0,void 0,md=>{if(this.NLe){const Sd=this.NLe.Ggm(Xc.proofingType);Sd&&(md.addOnFooterData={labelText:Sd.labelText,actionText:Sd.actionText})}},fa,void 0,void 0,Ke(wc),wc)}e5f(M,fa){M.f_d||this.ga.Hf(fa,Q.a.ymg,2,!1,null,null)}lFf(M){let fa=
0;if(M.actionType===Te.b.Apply){if(M.suggestionGroup.type===this.Daf)return fa=Q.a.aJa,{returnValue:!0,actionId:fa};if(({vhf:M}=this.Ari(M.suggestionGroup.suggestions,M.suggestion,this.bHh.length)).returnValue)return fa=this.bHh[M],{returnValue:!0,actionId:fa}}else{if(M.actionType===Te.b.InvokeOnAddOnFooter)return this.NLe.lgm(M.objectFulfillment);let Va;if(!({value:Va}=this.Xvd.Ec(M.suggestionGroup.contentData.errorDetails.proofingType,Va)).returnValue)return Na.ULS.sendTraceTag(527799889,375,50,
"LegacyProofingIntentProvider|from mapping: Logging {0} command.",fa),{returnValue:!1,actionId:fa};if(({value:fa}=Va.Ec(M.actionType,0)).returnValue)return Na.ULS.sendTraceTag(527799890,375,50,"LegacyProofingIntentProvider|from actionDescriptor: Logging {0} command.",fa),{returnValue:!0,actionId:fa};Na.ULS.sendTraceTag(50857990,341,15,"Failed to process action of type {0} since it is not known to us.",M.actionType)}return{returnValue:!1,actionId:fa}}executeAction(M,fa,Va){if(M.actionType===Te.b.Report){var Fb=
M.suggestionGroup.contentData.errorDetails,Vb="",wc="",Xc="";for(var vd=0;vd<Fb.metadata.length;vd++)switch(Fb.metadata[vd].Name){case "CritiqueSource":Xc=Fb.metadata[vd].Value;break;case "ModelName":Vb=Fb.metadata[vd].Value;break;case "ModelVersion":wc=Fb.metadata[vd].Value}vd=JSON.parse(M.descriptorData);M.suggestionGroup.type===this.JOd?(wc=new ce({start:Fb.wu.StartInContext,length:Fb.wu.Length},Xc,Vb,wc),Xc=[],vd=lm(vd.payload.comment),Xc.push(vd.I2b,vd.DEa,vd.ICa,vd.H9d),this.Bpa.Gha(JSON.stringify(wc),
JSON.stringify(new Ge(Xc)),mk.iPf),vd.DEa===Th.a.KOb&&this.ZEa.aVi()&&this.ZEa.W0b(vd.ICa,vd.H9d,{start:Fb.wu.StartInContext,length:Fb.wu.Length},Vb,!0)):(wc=new Ii({start:Fb.wu.StartInContext,length:Fb.wu.Length},Vb),Xc=[],vd=Vc(vd.payload.comment),Xc.push(vd.I2b,vd.DEa,vd.ICa,vd.KZb,void 0),this.Bpa.Gha(JSON.stringify(wc),JSON.stringify(new Wj(Xc)),mk.tug),vd.DEa===Th.a.KOb&&this.ZEa.W0b(vd.ICa,vd.KZb,{start:Fb.wu.StartInContext,length:Fb.wu.Length},Vb,!1))}if(M.actionType===Te.b.ShowExplanation){M=
M.suggestionGroup.contentData.errorDetails;Fb=Va=fa="";for(Vb=0;Vb<M.metadata.length;Vb++)switch(M.metadata[Vb].Name){case "CritiqueSource":Fb=M.metadata[Vb].Value;break;case "ModelName":fa=M.metadata[Vb].Value;break;case "ModelVersion":Va=M.metadata[Vb].Value}xg.c(Ci.a.DUj,void 0,void 0,void 0,void 0,void 0,{["ProofingLanguage"]:M.lcid.toString(),["CritiqueTypeID"]:M.typeId,["CritiqueSource"]:Fb,["ModelName"]:fa,["ModelVersion"]:Va});return!0}if(!fa)return!1;if(M.actionType===Te.b.Next||M.actionType===
Te.b.Previous)return this.jW.gfb(this,fa,Va,M.actionType===Te.b.Previous),!0;if(M.actionType===Te.b.OpenEditorPane)return 32!==this.ga.Ob(Ci.a.z_a,2)?(Na.ULS.sendTraceTag(50857991,341,15,"Failed to launch editor pane from contextual card"),!1):!0;if(!({actionId:Fb}=this.lFf(M)).returnValue)return!1;Vb=this.ga.Ob(Fb,1);if(32!==Vb)return Na.ULS.sendTraceTag(576583361,341,15,"Failed to process action ID {0} since it is apparently disabled: {1}",Fb,Vb),!1;this.ga.Ob(Fb,2);Fb=null;Vb=M.suggestionGroup.contentData;
M.actionType===Te.b.Apply?(z.AFrameworkApplication.$c("634j8931;09717904"),this.kda.iCa(fa,Va,Va+M.suggestion.title.length),Fb=xf.a.Gpc,Vb.f_d=!0):M.actionType===Te.b.IgnoreAll||M.actionType===Te.b.IgnoreOnce?(z.AFrameworkApplication.$c("634j8931;09717904"),Fb=xf.a.mte,Vb.f_d=!0):M.actionType===Te.b.AddToDictionary&&(Fb=xf.a.mte,Vb.f_d=!0);mk.sAg(M.actionType)&&Vb.Rja&&(this.jW.gfb(this,fa,Va,!1)||this.jW.gfb(this,fa,Va,!0));Fb&&this.Nub(Vb.errorDetails,Vb.Rja,Fb);return!0}static sAg(M){return M===
Te.b.Apply||M===Te.b.IgnoreOnce||M===Te.b.IgnoreAll}A1k(M){this.sa.addHandler("LegacyProofingActionEventKey",M)}nD(){return!!z.AFrameworkApplication.J&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}mk.ruf="LegacyProofingIntentProvider_SpellingError";mk.puf="LegacyProofingIntentProvider_GrammarError";mk.nuf="LegacyProofingIntentProvider_AdvancedError";mk.iPf="4688e793-8cb9-4109-8efe-7f3b3d8c24d9";mk.tug="c2b5d2e7-e528-43f9-9114-3b12b15a3208";
Object(u.a)(mk,"LegacyProofingIntentProvider",Tf.a,[331]);var Em=d(1160),To=d(104),Lm=d(879),ko=d(1434);class $n extends ko.a{constructor(){super();this.context=null;this.length=this.start=0;this.languageId=this.trackId=null;this.suppressGrammaticalSuggestions=!1;this.H_=Object.assign(new bd.a,{T_:$n.getTypeName(),B_:$n.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_NeuralRewriteSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(u.a)($n,"NeuralRewriteSignal",ko.a,
[]);class Uo extends Zh.a{constructor(){super();this.neuralRewriteSuggestions=this.trackId=null;this.editorResponseStatusCode=0;this.H_=Object.assign(new bd.a,{T_:Uo.getTypeName(),B_:Uo.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}}Object(u.a)(Uo,"NeuralRewriteCritique",Zh.a,[]);var qp=d(878);class cr{constructor(M,
fa){this.Vta=M;this.Uua=fa}}Object(u.a)(cr,"NeuralRewriteContentData",null,[]);var ll;(function(M){M[M.disabled=0]="disabled";M[M.Eeq=1]="notInitiated";M[M.K5p=2]="initiated";M[M.succeeded=3]="succeeded";M[M.TB=4]="failed";M[M.VXp=5]="correlationIdMismatch";M[M.A_p=6]="emptyCritiqueList";M[M.Mdq=7]="multipleCritiquesReturned";M[M.n8p=8]="localModelRequestInitiated";M[M.m8p=9]="localModelFailed";M[M.Nlq=10]="serviceClientNotAvailable";M[M.$qq=11]="usingLocalSuggestions";M[M.Qlq=12]="serviceFeatureGateDisabled";
M[M.dhq=13]="parentCritiqueTypeNotAvailable";M[M.Plq=14]="serviceFailureResponse";M[M.Yeq=15]="nullCritique";M[M.B6p=16]="invalidSuggestionCount";M[M.oeq=17]="noInternetConnection";M[M.BXp=18]="contextLengthExceededLimit"})(ll||(ll={}));Object(u.b)("ServiceCallStatus",ll);class jh{constructor(){this.TrackId=null;this.serviceCallStatus=1;this.contextLength=this.originalSpanLength=this.originalSpanStart=this.flagLength=this.flagStart=this.cardSuggestionCount=this.serviceSuggestionCount=this.suggestionIndex=
this.editorResponseStatusCode=-1;this.FlaggedText=this.Context=null;this.suggestions=new H.a;this.suggestionSuppressed=new H.a;this.modelNames=new H.a;this.modelVersions=new H.a}bP(){const M=new pb.a;M.name="Office.Word.Online.RewriteTelemetryData";M.dataFields=[];M.dataFields.push(Object.assign(new tb.a,{name:"CorrelationId",string:this.TrackId}));M.dataFields.push(Object.assign(new tb.a,{name:"ServiceCallStatus",int64:this.serviceCallStatus}));M.dataFields.push(Object.assign(new tb.a,{name:"EditorResponseStatusCode",
int64:this.editorResponseStatusCode}));M.dataFields.push(Object.assign(new tb.a,{name:"SuggestionIndex",int64:this.suggestionIndex}));M.dataFields.push(Object.assign(new tb.a,{name:"ServiceSuggestionCount",int64:this.serviceSuggestionCount}));M.dataFields.push(Object.assign(new tb.a,{name:"CardSuggestionCount",int64:this.cardSuggestionCount}));M.dataFields.push(Object.assign(new tb.a,{name:"FlagStart",int64:this.flagStart}));M.dataFields.push(Object.assign(new tb.a,{name:"FlagLength",int64:this.flagLength}));
M.dataFields.push(Object.assign(new tb.a,{name:"OriginalSpanStart",int64:this.originalSpanStart}));M.dataFields.push(Object.assign(new tb.a,{name:"OriginalSpanLength",int64:this.originalSpanLength}));M.dataFields.push(Object.assign(new tb.a,{name:"ContextLength",int64:this.contextLength}));for(let fa=0;fa<this.modelNames.count;fa++)M.dataFields.push(Object.assign(new tb.a,{name:String.format("Suggestion_{0}_Suppressed",fa),bool:this.suggestionSuppressed.K(fa)})),M.dataFields.push(Object.assign(new tb.a,
{name:String.format("Suggestion_{0}_ModelName",fa),string:this.modelNames.K(fa)})),M.dataFields.push(Object.assign(new tb.a,{name:String.format("Suggestion_{0}_ModelVersion",fa),string:this.modelVersions.K(fa)}));return M}EMm(){const M={};M.ParentTypeID=jh.CritiqueTypeId;M.CorrelationId=this.TrackId;M.ServiceStatus=ll[this.serviceCallStatus];M.SuggestionIndex=this.suggestionIndex.toString();M.ServiceSuggestionCount=this.serviceSuggestionCount.toString();M.CardSuggestionCount=this.cardSuggestionCount.toString();
M.FlagStart=this.flagStart.toString();M.FlagLength=this.flagLength.toString();M.OriginalSpanStart=this.originalSpanStart.toString();M.OriginalSpanLength=this.originalSpanLength.toString();M.ContextLength=this.contextLength.toString();M.Context=this.Context;for(let fa=0;fa<this.suggestions.count;fa++)M[String.format("Suggestion{0}",fa)]=this.suggestions.K(fa),M[String.format("Suggestion{0}Suppressed",fa)]=this.suggestionSuppressed.K(fa).toString(),M[String.format("Suggestion{0}ModelName",fa)]=this.modelNames.K(fa),
M[String.format("Suggestion{0}ModelVersion",fa)]=this.modelVersions.K(fa);return M}}jh.substrateEventName="OfficeNLTextRewriteCritique";jh.CritiqueTypeId="89726517-db4e-467c-9f49-081c1ccc6686";Object(u.a)(jh,"RewriteRuntimeData",null,[]);class $r{constructor(M,fa,Va,Fb,Vb){this.r1b=null;this.Vta=M;this.$fd=fa;this.startInContext=Va;this.contextLength=Fb;this.trackId=Vb;this.creationDate=new Date;this.Uua=new jh;this.Uua.serviceCallStatus=2;this.Uua.originalSpanStart=Va;this.Uua.originalSpanLength=
Fb;this.Uua.contextLength=fa.length;this.Uua.TrackId=Vb;this.Uua.Context=fa;this.Uua.FlaggedText=fa.substring(Va,Fb)}}Object(u.a)($r,"ReactiveNeuralRewriteContentData",null,[]);class Vl extends Tf.a{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub,yc,ad,md){super();this.ga=M;this.Re=fa;this.vK=Va;this.Aa=Fb;this.ZEa=Vb;this.Rd=wc;this.ko=Xc;this.Rc=vd;this.kda=Dd;this.Wn=Ce;this.LK=ea;this.Bpa=Xa;this.ukb=yb;this.vHb=Ub;this.ikb=yc;this.ib=ad;this.Jb=md;this.Rk=Th.a.i2o;this.zJ=[this.Rk];this.ga.fb(Ci.a.BHj,
rb.a.view,Mk.ActionManager.cU,4);this.ga.fb(Ci.a.CHj,rb.a.view,Mk.ActionManager.cU,4);this.X9=!1;this.vK.execute(Sd=>{Sd.isFeatureEnabled("FloodgateSurvey",!0).then(ze=>{this.X9=ze})})}uKa(M,fa){Em.a.NIf(fa,5)&&(M.classList.add(yh.a.Eyj,yh.a.Dyj),M.style.backgroundColor=null)}initialize(){this.ukb.fTa((M,fa)=>{for(const Va of fa.contents)this.uKa(Va.element,Va.intents)});Tc.a.im().then(()=>{this.Re.ub(this,Uo.getTypeName())})}get types(){return this.zJ}get eqe(){return 0}zS(){return!1}X3k(M,fa,Va,
Fb){if(M>=Fb)M=Fb-1,fa=Fb;else{for(;M<fa&&(" "===Va.charAt(M)||"\u00a0"===Va.charAt(M));)M++;if(M===fa){for(;M<Fb&&(" "===Va.charAt(M)||"\u00a0"===Va.charAt(M));)M++;fa=M+1}else for(;fa>M&&(" "===Va.charAt(fa-1)||"\u00a0"===Va.charAt(fa-1));)fa--}return{c4k:M,d4k:fa}}U9l(M,fa,Va){var Fb=M.length-M.trimStart().length;var Vb=M.trimEnd().length;({c4k:fa,d4k:Ce}=this.X3k(fa,Va,M,Vb));var wc=!1;Va=this.ikb.findBeginBoundary(M,fa,Fb);var Xc=this.ikb.findEndBoundary(M,Ce-1,Vb);-1===Xc&&(Xc=M.length,wc=!0);
const vd=M.substring(0,Xc).trimEnd().length;Fb=this.ikb.findBeginBoundary(M,vd-1,Fb);Xc=wc?Xc:this.ikb.findEndBoundary(M,vd-1,Vb);const Dd=!M.substring(Fb,Ce).trim().length;if(Fb===Va||Dd){Vb=fa-Va;wc=Ce-fa;var Ce=Va;Dd?(Va=M.substring(Va,Fb).trimEnd().length+Va,M=this.ikb.findEndBoundary(M,fa,Va)):M=vd}else Vb=0,wc=Ce-Fb,Ce=Fb,M=M.substring(0,Xc).trimEnd().length;return{startInContext:Vb,contextLength:wc,VOo:Ce,WOo:M}}jTl(M){const fa=M.node;var Va=M.zj,Fb=M.Po;let Vb,wc;M=R.ParagraphReader.text(fa);
({startInContext:Va,contextLength:Fb,VOo:Vb,WOo:wc}=this.U9l(M,Va,Fb));if(Vb>wc)return null;const Xc=new $r(E.a.createTextRange(fa,Vb,wc),M.substring(Vb,wc),Va,Fb,Kl.a.create().toString());Xc.r1b=new Gf.a(2,1,1E4,()=>{Xc.r1b&&(this.uXm(Xc),Xc.r1b=null)},152);return Xc}r_h(M){M.r1b&&(this.Jb.wf(M.r1b),M.r1b=null)}Uhm(){if(!this.ib.gb||1!==this.ib.gb.length)return null;for(const M of this.ib.gb.K(0))if(R.ParagraphReader.Wb(M.node))return M;return null}mBm(){return this.Aa.jc("NeuralRewriteLengthThreshold",
300)}Bpl(M){if(!M)return!1;const fa=M.cpBegin,Va=M.cpEnd;return!!this.ko.f7(M.node,Fb=>Fb.errorDetails.X$a()||2!==Fb.errorDetails.proofingType&&1!==Fb.errorDetails.proofingType||fa>Fb.end||Va<Fb.Dc?!1:!0).length}M5f(M){cb.a.sendActivityEvent(M.bP())}invoke(){const M=this.Uhm();if(!M)return Na.ULS.sendTraceTag(51524505,341,50,"Trying to rewrite with invalid selection"),this.M5f(new jh),!1;const fa=this.jTl(M);if(!fa)return Na.ULS.sendTraceTag(51524506,341,50,"Trying to rewrite with invalid sentence"),
this.M5f(new jh),!1;var Va=fa.$fd.length>=this.mBm();this.qj.zI&&this.qj.dismiss();if(Va)Va={...Te.g,id:"Intent-"+this.Rk,suggestionGroups:[{type:this.Rk,id:this.Rk,suggestions:[],isContentPending:!1,contentData:fa,errorMessage:WordEditorIntl.WordEditorStrings.L_RewriteErrorMsgLength}]};else{const Xc=Object.assign(new ec.a,{parentPath:["Signal",$n.getTypeName()],items:[Object.assign(new Lm.a,{id:M.node.id.toString(),body:Object.assign(new $n,{context:fa.$fd,start:fa.startInContext,length:fa.contextLength,
trackId:fa.trackId,languageId:this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.zAi(M):"en-US",suppressGrammaticalSuggestions:this.Bpl(fa.Vta)})})]});Tc.a.im().then(()=>{fa.Uua.serviceCallStatus=2;io.a.Nz().submitOperation(Object.assign(new qp.a,{operation:Xc}))});this.Jb.$b(fa.r1b);Va={...Te.g,id:"Intent-"+this.Rk,suggestionGroups:[{type:this.Rk,id:this.Rk,suggestions:[{id:"Suggestion-0",title:"<placeholder>",description:"<placeholder>"},{id:"Suggestion-1",
title:"<placeholder>",description:"<placeholder>"},{id:"Suggestion-2",title:"<placeholder>",description:"<placeholder>"}],isContentPending:!0,contentData:fa}]}}const Fb=new H.a,Vb=fa.Vta,wc=Object(pg.a)(To.AParagraphNode,Vb.node);Fb.add(new Ei.a(5,Vb.zj,Vb.Po));this.Wn.c7f(wc,Fb);this.ib.Kc(Pa.SelectionFactory.ue(wc,Vb.Po));return this.qj.Dna(Vb,Va,this,!1,!1,()=>{this.qj.Hqc()},()=>{this.r_h(fa);var Xc=fa.Uua;this.M5f(Xc);Xc=Object.assign(new Jh.a,{LanguageId:this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.zAi(M):"en-US",EventId:-1!=Xc.suggestionIndex?4:12,CritiquePriority:2,SubstrateEventName:jh.substrateEventName,TraceId:Xc.TrackId,CritiqueTypeId:jh.CritiqueTypeId,FlaggedText:Xc.FlaggedText,SuggestionText:Xc.suggestions.K(Xc.suggestionIndex),SubstrateEventCustomFields:Xc.EMm(),IsNeural:!0});this.vHb.rwg(Xc);this.Wn.zAb(wc,5)},void 0,!0)}uXm(M){Vl.xFi(this.qj.definition,this.Rk)===M&&(Na.ULS.sendTraceTag(51495324,341,50,"Timed out while waiting for Neural Rewrite response"),M.Uua.serviceCallStatus=
14,this.qj.definition={...Te.g,id:"Intent-"+this.Rk,suggestionGroups:[{type:this.Rk,id:this.Rk,suggestions:[],contentData:M,errorMessage:WordEditorIntl.WordEditorStrings.L_RewriteErrorMsgTimeout,isContentPending:!1}]})}RGn(M){this.ga.Ob(Ci.a.BHj,2);Na.ULS.sendTraceTag(51524507,341,50,"Rewrite card invoked with {0} suggestions",M)}SGn(){this.ga.Ob(Ci.a.CHj,2);Na.ULS.sendTraceTag(51524508,341,50,"Rewrite card suggestion selected")}gH(M,fa){if(pe.a.getTypeNameFor(M.content)===Uo.getTypeName()&&fa===
ec.a.getTypeName())if(fa=Vl.xFi(this.qj.definition,this.Rk)){var Va=M.content;if(Va.trackId!==fa.trackId)Na.ULS.sendTraceTag(51524510,341,50,"Rewrite card invoked with another track before we got suggestions back");else{this.r_h(fa);var Fb=fa.Uua;Fb.serviceCallStatus=3;Fb.editorResponseStatusCode=Va.editorResponseStatusCode;var Vb=fa.Vta,wc=R.ParagraphReader.text(Vb.node);if(Vb.cpEnd>wc.length)Na.ULS.sendTraceTag(51524511,341,50,"Text deleted or changed before we got suggestions back");else if(wc=
wc.substring(Vb.cpBegin,Vb.cpEnd),fa.$fd!==wc)Na.ULS.sendTraceTag(51524512,341,50,"Text changed before we got suggestions back");else{Na.ULS.sendTraceTag(51524513,341,50,"Rewrite latency {0}",+new Date-+fa.creationDate);var Xc=0,vd=[];for(const Dd of Va.neuralRewriteSuggestions){const Ce=a(wc,Dd.text,fa,Xc,Dd.modelName),ea=Vl.jYl(Vb,Ce.startInContext,Ce.length);Fb.suggestions.add(Dd.text);Fb.suggestionSuppressed.add(ea);Fb.modelNames.add(Dd.modelName);Fb.modelVersions.add(Dd.modelVersion);ea?Na.ULS.sendTraceTag(51443290,
341,50,"Annotation {0} removed since it overlaps an object",M.id):vd.push({id:"Suggestion-"+vd.length,title:Ce.FIg+Ce.GIg+Ce.Mpp,titleFormatting:[{start:Ce.FIg.length,length:Ce.GIg.length,fontWeight:Te.d.Bold,cssColor:"#5A45B6"}],description:Dd.modelLabel,supportedActions:this.X9?[Te.b.Apply,Te.b.Report]:[Te.b.Apply],contentData:Ce});Xc++}Fb.serviceSuggestionCount=Va.neuralRewriteSuggestions.length;Fb.cardSuggestionCount=vd.length;0<vd.length&&this.RGn(vd.length);vd.length||(Fb.serviceCallStatus=
6);this.qj.definition={...Te.g,id:"Intent-"+this.Rk,suggestionGroups:[{type:this.Rk,id:this.Rk,snippet:fa.$fd,snippetFormatting:[],suggestions:vd,contentData:new cr(Vb,Fb),isContentPending:!1}]};this.qj.focus()}}}else Na.ULS.sendTraceTag(51524509,341,50,"Rewrite card dismissed before we got suggestions back")}executeAction(M){if(M.suggestionGroup.isContentPending)return!1;var fa=M.suggestionGroup.contentData;const Va=M.suggestion.contentData;if(!fa||!Va)return!0;switch(M.actionType){case Te.b.Apply:M=
fa.Uua;M.suggestionIndex=Va.index;M.flagStart=Va.startInContext;M.flagLength=Va.length;this.SGn();M=this.Rc.Lc(15);try{var Fb=fa.Vta,Vb=Fb.node;const wc=Fb.cpBegin+Va.startInContext,Xc=wc+Va.length,vd=wc===Xc?E.a.Uc(Vb,wc):E.a.createTextRange(Vb,wc,Xc);M.Ab(Vb);this.Rd.We(vd,Va.substring,!0,!1,Q.a.Ava);this.ib.Kc(Pa.SelectionFactory.ue(Vb,wc+Va.substring.length));this.kda.iCa(Vb,wc,wc+Va.substring.length)}finally{M&&M.dispose()}break;case Te.b.Report:fa=new Ii(Va.j1m,Va.modelName),Fb=JSON.parse(M.descriptorData),
Vb=Vc(Fb.payload.comment),Fb=[Vb.I2b,Vb.DEa,Vb.ICa,Vb.KZb,void 0],this.Bpa.Gha(JSON.stringify(fa),JSON.stringify(new Wj(Fb)),Vl.gFg),Vb.DEa===Th.a.KOb&&this.ZEa.W0b(Vb.ICa,Vb.KZb,{start:Va.startInContext,length:Va.length},Va.modelName,!1)}return!0}static xFi(M,fa){if(!M||!M.suggestionGroups||1!==M.suggestionGroups.length)return null;M=M.suggestionGroups[0];return M.type===fa&&M.isContentPending?M.contentData:null}zAi(M){M=this.LK.iKa(M)||z.AFrameworkApplication.lcid;return zf.a.Eg(M).name}static jYl(M,
fa,Va){const Fb=Object(pg.a)(To.AParagraphNode,M.node);if(!Fb||!Fb.ra||!Fb.ra.length)return!1;M=fa+M.cpBegin;Va=M+Va;for(fa=0;fa<Fb.ra.length-1;fa++){const Vb=Fb.ra.Ub(fa),wc=Fb.ra.Ub(fa+1).cp;if(!(Va<=Vb.cp||wc<=M)&&(Fb.ra.Ub(fa).hyperlink||Fb.ra.Ub(fa).wn||Vb.Ch&&0<Vb.Ch.length||Vb.Ue&&0<Vb.Ue.length||Vb.Hb&&0<Vb.Hb.length))return!0}return!1}}Vl.gFg="c2b5d2e7-e528-43f9-9114-3b12b15a3208";Object(u.a)(Vl,"NeuralRewriteIntentProvider",Tf.a,[114]);class Fp{constructor(M){this.xFk=M}Q_n(){this.xFk.invoke()}}
Object(u.a)(Fp,"NeuralRewriteMessageHandler",null,[1045]);var tq=d(1554),ao=d(109);class sh{constructor(M,fa,Va,Fb){this.txd=!1;this.k1=Va;this.rB=fa;this.mx=M;this.HM=Fb;this.rB.bkd(this);this.mx.bkd(this);this.k1.bkd(this)}ZSl(M,fa){return this.txd?this.HM.afi(M,this.mx,this.rB,this.k1):fa}w$h(){return Object.assign(new km,{Uae:!0,$hd:Object(ao.a)(this.rB,this.rB.k0b,"shouldEnableForErrorDetails")})}Mrf(){return Object.assign(new km,{Vae:!0,tjd:Object(ao.a)(this.mx,this.mx.VDa,"shouldEnableForAnnotation")})}B9h(){return Object.assign(new km,
{Sae:!0,XYc:Object(ao.a)(this.k1,this.k1.jSj,"shouldEnableForDictationCorrectionDetails")})}i9h(){return Object.assign(new km,{Vae:!0,Uae:!0,Sae:!0,$hd:Object(ao.a)(this.rB,this.rB.k0b,"shouldEnableForErrorDetails"),tjd:Object(ao.a)(this.mx,this.mx.VDa,"shouldEnableForAnnotation"),XYc:Object(ao.a)(this.k1,this.k1.jSj,"shouldEnableForDictationCorrectionDetails")})}mHi(M){return this.txd?this.i9h():Object.getType(M)===Object.getType(this.mx)?this.Mrf():Object.getType(M)===Object.getType(this.k1)?this.B9h():
this.w$h()}RUm(){this.rB.Rra=!0;this.rB.Qra=!0;this.rB.fpb=!0;this.mx.sJa=!0;this.k1.IUa=!0;const M=this.i9h();this.HM.oag(M,this.mx,this.rB,this.k1)}TUm(M){const fa=M===zk.AWj,Va=M===zk.QKi,Fb=this.nD()||!fa&&!Va,Vb=M===Th.a.qfi;this.rB.Rra=fa;this.rB.Qra=Va;this.rB.fpb=!1;this.mx.sJa=!1;this.mx.oOb=Fb?M:null;this.k1.IUa=Vb;M=fa||Va?this.nD()?this.Mrf():this.w$h():Vb?this.B9h():this.Mrf();this.HM.oag(M,this.mx,this.rB,this.k1)}nD(){return!!z.AFrameworkApplication.J&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}SUm(M,fa){this.mx.I6c=fa;(this.txd=M===zk.Lnl)?this.RUm():this.TUm(M)}RYc(M,fa,Va,Fb,Vb){({index:Fb,count:Vb}=this.HM.RYc(M,fa,this.mHi(Va)));return{index:Fb,count:Vb}}gfb(M,fa,Va,Fb){const Vb=this.mHi(M);fa=this.HM.VKf(fa,Va,Vb,Fb);if(!fa)return!1;M=this.ZSl(fa,M);M.qj.v_b(!0);return this.HM.XVb(fa,M)}}Object(u.a)(sh,"ProofingChainingOrchestrator",null,[]);class Tp{constructor(M,fa,Va){this.rB=M;this.yok=fa;this.HM=Va}nD(){return!!z.AFrameworkApplication.J&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}zgo(M,fa,Va){if(!fa||!fa.Nw||!Va.vj)return!1;const Fb=fa.Qa;return R.ParagraphReader.Wb(Fb.node)?this.HM.$Jj(Fb,()=>{if(this.nD()){const Vb=new Qm.a(Fb,3,!1,!0,!1,!1,!1,null);this.yok.zS(Vb)}else this.rB.invoke(Fb.node,M,!1,!1,!0)}):!1}}Object(u.a)(Tp,"ProofingErrorPresenter",null,[1044]);class Fm{constructor(M){this.Sg=M}Rvb(M){M?M.PVf():this.Sg.sendTraceTag(589105152,2250,10,"Suggestion render is null when goal changed")}}Object(u.a)(Fm,"ProofingIntentGoalChangeListener",null,[1043]);class uq{constructor(M){this.Sg=
M}bMi(M){M?M.PVf():this.Sg.sendTraceTag(543470851,2250,10,"Suggestion render is null when premium preview state changed")}}Object(u.a)(uq,"ProofingIntentPremiumPreviewStateChangeHandler",null,[1042]);var dj=d(56);class an{constructor(M,fa,Va){this.Rc=M;this.Jb=fa;this.LDd=null;this.Edn=()=>{const Fb=[];var Vb=document.querySelectorAll("p");this.LDd=null;for(let Xc=0;Xc<Vb.length;Xc++){var wc=dj.a(Vb[Xc]);wc&&(wc=wc.Cb,R.ParagraphReader.Wb(wc)&&this.i$n(wc)&&Fb.push(wc))}if(0<Fb.length){Vb=this.Rc.Lc(2);
try{Vb.Ab(U.StaticActiveAppFrame.za().kb.Qc.vd);for(const Xc of Fb)Xc.Xl(16,!0)}finally{Vb&&Vb.dispose()}}};this.p$=new H.a;for(const Fb of Va)this.p$.add(Fb),Fb.Vxo(this)}i$n(M){M=M.ra;for(let fa=0;fa<M.length;fa++)for(const Va of this.p$)if(Va.iVc(M.Ub(fa)))return!0;return!1}PVf(){this.LDd||(this.LDd=new Gf.a(2,1,0,this.Edn,148),this.Jb.$b(this.LDd))}}Object(u.a)(an,"SuggestionRenderer",null,[1041]);var lo=d(48),ma=d(120),Ua=d(153),xb=d(123),Xb=d(76),rc=d(112),Zc;(function(M){M[M.aPp=0]="Insertion";
M[M.NNp=1]="Deletion";M[M.Replace=2]="Replace"})(Zc||(Zc={}));Object(u.b)("TrackChangeTypeForPreview",Zc);const Hd={type:null,data:null,returnValue:!1};var Jd=d(542);class Xd extends Tf.a{get p_n(){var M;return null===(M=z.AFrameworkApplication.J)||void 0===M?void 0:M.getBooleanFeatureGate("Microsoft.Office.WordOnline.onHoverDelayShowForTrackChangeCard",!1)}constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea){super();this.Pb=M;this.Qd=fa;this.ti=Va;this.rrj=Fb;this.lb=Vb;this.Mfa=wc;this.iua=Xc;this.Mrd=
vd;this.pEa=Dd;this.$zc=Ce;this.mAb=ea;this.Ahe={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric"};this.AKa=null;this.Hna=this.Nrd=this.ika=void 0;this.Rmf=0;this.Gra=Xa=>{Xa||(this.mnb(),this.AKa.MNa(this.a2b,null,null));const yb=Date.now()-this.Rmf;this.Rmf=0;this.r2h();xg.a("TrackChangeCardDismissed",!0,yb,[{...(new tb.a),name:"actionTaken",bool:!!Xa}])};this.rWb=(Xa,yb)=>{for(const Ub of yb.contents)this.U4l(Ub.element,Ub.intents,Ub.kI)};this.Q5l=(Xa,yb,Ub)=>{for(const yc of Xa.Aii)yc.classList.add(Jd.a.V1j),
yc.classList.remove(Jd.a.W1j);for(const yc of Xa.Tyf)yc.classList.add(Jd.a.V1j),yc.style.opacity="0";z.AFrameworkApplication.pc.$b(new Gf.a(0,1,333,()=>{this.yTh(yb,Ub)},202))};this.a2b=Th.a.dIg;this.Lia=[];this.zJ=[this.a2b];this.f8m();this.rrj.fTa(this.rWb)}get JRb(){return this.Lia}get types(){return this.zJ}iVc(M){return!!M.Wi||!!M.Yh||!!M.jk}cYm(M,fa,Va,Fb,Vb,wc){!Fb&&Va&&Xh.a.Cm(M,Ua.a.Bza,{uniqueId:fa.$k,...Va});Fb&&Xh.a.Cm(M,Ua.a.VIa,{uniqueId:fa.$k,...Fb});Vb&&Xh.a.Cm(M,Ua.a.rob,{uniqueId:fa.$k,
...Vb});1===this.Qd.Gk&&this.AKa.X0d(M,fa,wc)}dxb(M){this.AKa||(this.AKa=M,this.rrj.q2k((fa,Va)=>{2!==this.Qd.Gk&&this.cYm(Va.element,Va.paragraphNode,Va.jVd,Va.hVd,Va.iVd,Va.bna)}))}RWa(M,fa){if(this.Hna||0===this.Qd.Gk||2===this.Qd.Gk)return Hd;for(const Va of[Ua.a.Bza,Ua.a.VIa,Ua.a.rob]){const Fb=this.mCm(M,Va,fa);if(Fb.returnValue)return Fb}return Hd}mCm(M,fa,Va){M=Xh.a.Eb(M,fa);if(!M)return Hd;try{this.pEa.logKpiUsage(Xb.b.tCi,0,void 0,xb.a),Va.addRange(this.ti.hkc(M))}catch(Fb){throw this.pEa.logKpiFailure(Xb.b.tCi,
"UnexpectedError",{isInternal:!0},{name:Xb.c.Tw,errorNameOverride:"GetNodesToInvalidateForIntentProviderFailure",isInternal:!0},xb.a),Fb;}return{returnValue:!0,type:this.a2b,data:M}}Inc(M){M=Fh.a.ifa(M);return-1!==M.indexOf(Ua.a.W_a)||-1!==M.indexOf(Ua.a.pzc)}c7a(M,fa){let Va;fa&&"ChpTrackChangeInfo"===fa.Jfa&&(Va=fa);try{!Va&&this.Hna||this.pEa.logKpiUsage(Xb.b.czi,0,void 0,xb.a);if(null!=Va)return this.Jtf(M,Va);if(this.Hna)return null;if(null!=fa&&fa.type===Th.a.Zzc&&0!=fa.m8)return this.Itf(fa,
M)}catch(Fb){throw this.pEa.logKpiFailure(Xb.b.czi,"UnexpectedError",{isInternal:!0},{name:Xb.c.Tw,errorNameOverride:"GetHighlightCssClassForIntentProviderFailure",isInternal:!0},xb.a),Fb;}return null}Jtf(M,fa){let Va;if(this.mAb.SZc(M,Ua.a.Bza,fa))Va=M.classList.contains(Ua.a.W_a)?Jd.a.Z1j:Jd.a.eIg;else if(this.mAb.SZc(M,Ua.a.VIa,fa))Va=M.classList.contains(Ua.a.pzc)?Jd.a.Z1j:Jd.a.eIg;else if(this.mAb.SZc(M,Ua.a.rob,fa))return Jd.a.Yzc;return Va?(M=this.Qd.UJa(fa.authorName,ma.a.YO(),"None"),this.mAb.j$h(Va,
M)):null}Itf(M,fa){const Va=this.Qgo[M.m8];return M.$eb.e0?this.qEi(fa,M,Va,Ua.a.Bza,Ua.a.W_a,2,1)||this.qEi(fa,M,Va,Ua.a.VIa,Ua.a.pzc,1,2):1==M.$eb.changeType?this.pEi(fa,M,Va,Ua.a.W_a,0,Ua.a.Bza):2==M.$eb.changeType?this.pEi(fa,M,Va,Ua.a.pzc,1,Ua.a.VIa):null}qEi(M,fa,Va,Fb,Vb,wc,Xc){return this.mAb.SZc(M,Fb,fa.Zeb)?this.h3i(M,Vb)?fa.m8===wc?Jd.a.X1j:Va[2]:fa.m8===Xc?this.rOi[fa.m8]:null:null}pEi(M,fa,Va,Fb,Vb,wc){return this.mAb.SZc(M,wc,fa.Zeb)?this.h3i(M,Fb)?Va[Vb]:this.rOi[fa.m8]:null}zS(M){var fa;
return Ve.SessionStatusManager.instance.Jk||0===this.Qd.Gk||this.Hna||2===this.Qd.Gk||!R.ParagraphReader.Wb(null===(fa=M.Hx)||void 0===fa?void 0:fa.node)||M.source!==(this.p_n?6:0)&&3!==M.source&&5!==M.source?!1:(fa=this.Qd.h9d(M.Hx.node,M.Hx.cpBegin,M.Hx.Fb))&&fa.jbb?M.byc?!0:this.invoke(M.Vo,M.Hx,fa,M.uXa,M.xUa,M.Rja):!1}invoke(M,fa,Va,Fb,Vb){var wc,Xc;try{this.pEa.logKpiUsage(Xb.b.gUi,0,void 0,xb.a);const vd=this.ti.Zqb(fa.node,fa.cpBegin,fa.Fb);if(!vd||!vd.Jd)return!1;const Dd=this.ti.OFf(fa.node,
vd),{text:Ce,tEf:ea}=this.$zc.rFf(Va),Xa=rc.a.Tee(vd.Jd)?this.Mrd.s0j:this.Mrd.t0j;this.ika={$eb:Va,arj:Dd,Zeb:vd.Jd,LEf:this.ti.r8(fa.node,vd)};this.Rmf=Date.now();const yb=null!==(wc=Va.mHg)&&void 0!==wc?wc:Va.timestamp,Ub={authorName:Va.authorName,authorColor:this.Qd.UJa(Va.authorName,ma.a.Oq(null===M||void 0===M?void 0:M.ge)),changeDescriptor:{formatting:ea,text:Ce,localizedDate:null!==(Xc=null===yb||void 0===yb?void 0:yb.toLocaleDateString(z.AFrameworkApplication.dataCulture,this.Ahe))&&void 0!==
Xc?Xc:""},theme:Xa,acceptDisabled:sb.a.fn,rejectDisabled:sb.a.fn&&!rc.a.HTa(Va.authorName)},yc={id:Th.a.Zzc,suggestionGroups:[{type:Th.a.Zzc,contentData:Ub,isContentPending:!1}],setSize:0,positionInSet:0},ad=E.a.Uc(fa.node,fa.zj);return this.qj.Dna(ad,yc,this,Fb,Vb,()=>{this.AKa.MNa(this.a2b,Dd,vd.Jd)},this.Gra)}catch(vd){throw this.pEa.logKpiFailure(Xb.b.gUi,"UnexpectedError",{isInternal:!0},{name:Xb.c.Tw,errorNameOverride:"InvokeForIntentProviderFailure",isInternal:!0},xb.a),vd;}}executeAction(M){try{switch(this.pEa.logKpiUsage(Xb.b.NAf,
0,void 0,xb.a),M.actionType){case Te.b.Accepted:this.Bij(Ci.a.Olb);break;case Te.b.Rejected:this.Bij(Ci.a.cZb);break;case Te.b.Toggle:if(M.objectName===Th.a.Zzc)switch(M.objectFulfillment){case "AcceptMouseOver":this.Cij(1);break;case "AcceptMouseOut":case "RejectMouseOut":this.nVn();break;case "RejectMouseOver":this.Cij(2)}}}catch(fa){throw this.pEa.logKpiFailure(Xb.b.NAf,"UnexpectedError",{isInternal:!0},{name:Xb.c.Tw,errorNameOverride:"ExecuteActionForIntentProviderFailure",isInternal:!0},xb.a),
fa;}return!0}Cij(M){this.ika&&rc.a.Tee(this.ika.Zeb)&&(this.Nrd={m8:M,$eb:this.ika.$eb,Zeb:this.ika.Zeb,type:Th.a.Zzc},this.AKa.MNa(this.a2b,this.ika.arj,this.Nrd))}nVn(){this.Hna||(this.mnb(),this.AKa.MNa(this.a2b,this.ika.arj,this.ika.Zeb))}Bij(M){if(this.ika)if(!rc.a.Tee(this.ika.Zeb))this.yTh(M,this.lb.gb);else if(D.a.Di||this.Nrd)this.Hna={...(this.Nrd||{m8:0,$eb:this.ika.$eb,Zeb:this.ika.Zeb,type:Th.a.Zzc}),LEf:this.ika.LEf,Aii:[],Tyf:[],jTi:[]},this.mnb(),this.r2h(),this.mKn(M),Object(Ni.a)().Ie.editingElement.contentEditable=
"false",z.AFrameworkApplication.pc.$b(new Gf.a(1,1,150,()=>{this.Q5l(this.Hna,M,this.lb.gb)},201)),this.qj.v_b(!0),this.qj.dismiss()}mKn(M){var fa,Va;const Fb=this.Hna.LEf,Vb=this.iua.jbi(Fb.Ej,!1);if(Vb){do{const wc=lo.a.create(),Xc=Vb.DA===Fb.Ej?Fb.yd:0,vd=Vb.DA===Fb.Mp?Fb.endCp:null!==(Va=null===(fa=Vb.DA.characterData)||void 0===fa?void 0:fa.length)&&void 0!==Va?Va:0;this.Hna.jTi.push({kTi:wc,paragraphNode:Vb.DA});this.Mfa.XXa(Vb.DA,new Ei.a(6,Xc,vd,wc,M))}while(Vb.DA!==Fb.Mp&&Vb.Ala())}else this.pEa.logKpiFailure(Xb.b.NAf,
"MarkIntentsFailedBecauseIteratorIsEmpty",{isInternal:!0},void 0,xb.a)}U4l(M,fa,Va){if(fa)for(const Fb of fa)if(6===Fb.type){2===Va?this.Fjo(M):this.Bio(M);break}}Fjo(M){const fa=this.Hna;var Va=this.Jyl[fa.m8];if(fa.$eb.e0){const Fb=M.classList.contains(Ua.a.pzc),Vb=M.classList.contains(Ua.a.W_a);Va=1===fa.m8&&Fb||2===fa.m8&&Vb?Jd.a.X1j:Va[2]}else 1===fa.$eb.changeType?(Va=Va[0],2===fa.m8&&fa.Tyf.push(M)):(Va=Va[1],1===fa.m8&&fa.Tyf.push(M));M.classList.add(Va)}Bio(M){M.classList.remove(Jd.a.XCe,
Jd.a.Yzc);M.classList.add(Jd.a.W1j);this.Hna.Aii.push(M)}yTh(M,fa){this.mnb();this.Pb.Qb(M,2,{SourceControlId:"CanvasCard",gb:fa});this.AKa.MNa(this.a2b,null,null);if(this.Hna)for(const Va of this.Hna.jTi)this.Mfa.zAb(Va.paragraphNode,6);this.Dsl();df.a.ym(this.lb.gb.currentSelection)||this.lb.Kc(df.a.vk(this.lb.gb.currentSelection,!1,!1,void 0,!0));Object(Ni.a)().Ie.editingElement.contentEditable="true"}mnb(){this.Nrd=void 0}r2h(){this.ika=void 0}Dsl(){this.Hna=void 0}h3i(M,fa){return M.classList.contains(fa)}f8m(){const M=
{[0]:void 0,[1]:void 0,[2]:void 0},fa={[0]:Jd.a.nAb,[1]:Jd.a.$1j,[2]:Jd.a.nAb},Va={[0]:Jd.a.c2j,[1]:Jd.a.nAb,[2]:Jd.a.nAb};this.Qgo={[0]:M,[1]:{[0]:Jd.a.nAb,[1]:Jd.a.$1j,[2]:Jd.a.nAb},[2]:{[0]:Jd.a.c2j,[1]:Jd.a.nAb,[2]:Jd.a.nAb}};this.Jyl={[0]:M,[1]:fa,[2]:Va};this.rOi={[0]:void 0,[1]:Jd.a.XCe,[2]:Jd.a.Yzc}}}Object(u.a)(Xd,"TrackChangeIntentProvider",Tf.a,[]);var je=d(1540);class af extends Tf.a{constructor(){super();this.zJ=[Th.a.Lyb]}get types(){return this.zJ}zS(M){if(!this.SEc)return!1;var fa=
[];for(let Va=0;Va<this.SEc.length;Va++)fa.push({id:"discoverySuggestions-"+Va,title:'"'+this.SEc[Va]+'"',description:this.SEc[Va],supportedActions:[Te.b.Apply]});fa=[{type:Th.a.Mwf,id:Th.a.Mwf+"Suggestions",title:"Try saying:",suggestions:fa,contentData:new vo(M.Rja),isContentPending:!1}];M=this.qj.Dna(this.rdh,{...Te.g,id:Th.a.Mwf,suggestionGroups:fa,setSize:0,positionInSet:0},this,!1,!1,()=>{},()=>{},void 0,void 0,Va=>{Va.showEditorBranding=!1;Va.showDesignerButton=!1;Va.showEditorBranding=!1},
!1,void 0,void 0,!1,M.source);this.SEc=null;return M}executeAction(){return!1}showContextMenu(M,fa){this.rdh=M;this.SEc=fa;this.uMn=new Qm.a(this.rdh,9,!1,!1,void 0,!1,!1,null);return this.qj.zI?!0:this.zS(this.uMn)}}Object(u.a)(af,"DiscoveryCommandIntentProvider",Tf.a,[]);var Wf=d(2118),Mg;(function(M){M[M.Success=0]="Success";M[M.BlockedByPostfilter=1]="BlockedByPostfilter";M[M.CopilotLicenseNotAvailable=2]="CopilotLicenseNotAvailable";M[M.ErrorDuringExecution=3]="ErrorDuringExecution";M[M.NoRewriteFromModel=
4]="NoRewriteFromModel";M[M.ReceivedInvalidInput=5]="ReceivedInvalidInput"})(Mg||(Mg={}));const bi=(M,fa)=>{const Va=[];var Fb=0,Vb=0,wc=!1;for(var Xc=0;Xc<fa.length;Xc++)/\s/.test(fa.charAt(Xc))?wc&&(Va.push({startIndex:Fb,endIndex:Vb}),wc=!1):(wc||(Fb=Xc,wc=!0),Vb=Xc);wc&&Va.push({startIndex:Fb,endIndex:Vb});Fb=[];Vb=[];wc=[];for(Xc=0;Xc<=M.length;Xc++)Vb[Xc]=[Xc],wc[Xc]=[[Xc-1,0]];for(Xc=0;Xc<=fa.length;Xc++)Vb[0][Xc]=Xc,wc[0][Xc]=[0,Xc-1];for(Xc=1;Xc<=M.length;Xc++)for(var vd=1;vd<=fa.length;vd++)if(M.charAt(Xc-
1)===fa.charAt(vd-1))Vb[Xc][vd]=Vb[Xc-1][vd-1],wc[Xc][vd]=[Xc-1,vd-1];else{var Dd=Math.min(Vb[Xc-1][vd],Vb[Xc][vd-1],Vb[Xc-1][vd-1]);Vb[Xc][vd]=Dd+1;Vb[Xc-1][vd]===Dd?wc[Xc][vd]=[Xc-1,vd]:Vb[Xc][vd-1]===Dd?wc[Xc][vd]=[Xc,vd-1]:Vb[Xc-1][vd-1]===Dd&&(wc[Xc][vd]=[Xc-1,vd-1])}const {yVb:Ce,Ey:ea}={yVb:Vb,Ey:wc};Vb=fa.length;for(wc=M.length;0<=wc&&0<=Vb;)for(Vb=fa.length;0<=wc&&0<=Vb;)Fb.push({Wma:wc,dZa:Vb}),Xc=wc,wc=ea[wc][Vb][0],Vb=ea[Xc][Vb][1];Fb=Fb.reverse();for(Vb=0;Vb<Fb.length;Vb++){var Xa=Fb[Vb-
1];wc=Fb[Vb];if(0!==Vb){Xc=wc.Wma===Xa.Wma+1;vd=wc.dZa===Xa.dZa+1;Dd=Ce[wc.Wma][wc.dZa]!==Ce[Xa.Wma][Xa.dZa];var yb=wc.Wma===Xa.Wma;Xa=wc.dZa===Xa.dZa;Xc&&vd&&Dd?wc.type=zh.Replace:yb&&vd?wc.type=zh.Insert:Xc&&Xa&&(wc.type=zh.Delete)}}wc=Fb;Fb=[];Vb=[];vd=Xc=-1;for(Dd=0;Dd<wc.length;Dd++)if(yb=wc[Dd],-1===Xc||yb.Wma!==Xc?(Xc=yb.Wma,void 0!==yb.type&&yb.type!==zh.Insert&&Fb.push({position:yb.Wma,type:yb.type})):Dd+2<wc.length&&yb.type===zh.Insert&&wc[Dd+1].Wma===yb.Wma+1&&void 0===wc[Dd+1].type&&wc[Dd+
2].Wma===yb.Wma+2&&wc[Dd+2].type===zh.Delete&&M.charAt(wc[Dd+2].Wma-1)===fa.charAt(yb.dZa-1)&&(wc[Dd].type=zh.VHe,wc[Dd+1].type=zh.VHe,wc[Dd+2].type=zh.VHe),-1===vd||yb.dZa!==vd)vd=yb.dZa,void 0!==yb.type&&yb.type!==zh.Delete&&Vb.push({position:yb.dZa,type:yb.type});a:if(!Fb.length||!Vb.length)if(Fb.length||Vb.length)if(wc=Fb.length?zh.Delete:zh.Insert,Xc=Fb.length?Fb:Vb,vd=Fb.length?M:fa,Xc[0].type===wc&&1===Xc[0].position){for(Dd=1;Dd<Xc.length;Dd++)if(Xc[Dd].type!==wc||Xc[Dd].position!==Xc[Dd-
1].position+1)break a;Dd=vd.substring(0,Xc[Xc.length-1].position);if(vd.endsWith(Dd))for(yb=0;yb<Xc.length;yb++)Xc[yb]={position:vd.length-Dd.length+yb+1,type:wc}}const {Kam:Ub,bFo:yc}={Kam:Fb,bFo:Vb};Ah(M,Ub);fa=Ah(fa,yc);Fb=0;M=[];for(var ad of fa)ad.pye&&M.push({startIndex:Fb,endIndex:Fb+ad.Lgd.length-1}),Fb+=ad.Lgd.length;ad=[];for(const md of Va)for(const Sd of M){if(md.endIndex<Sd.startIndex)break;if(md.startIndex<=Sd.endIndex&&Sd.startIndex<=md.endIndex){ad.push(md);break}}return ad};var zh;
(function(M){M[M.Replace=0]="Replace";M[M.Insert=1]="Insert";M[M.Delete=2]="Delete";M[M.VHe=3]="Switch"})(zh||(zh={}));Object(u.b)("EditType",zh);const Ah=(M,fa)=>{const Va=[];let Fb=0;if(0===fa.length)return Va.push({Lgd:M,pye:!1}),Va;for(let Vb=0;Vb<fa.length;Vb++){let wc=M.substring(Fb,fa[Vb].position-1);0!==wc.length&&Va.push({Lgd:wc,pye:!1});let Xc=Vb+1;for(wc=M.charAt(fa[Vb].position-1);Xc<fa.length&&fa[Xc].type===fa[Vb].type&&fa[Vb].position+Xc-Vb===fa[Xc].position;)wc+=M.charAt(fa[Xc].position-
1),Xc++;Xc--;Fb=fa[Xc].position;Vb=Xc;Va.push({Lgd:wc,pye:!0})}M=M.substring(fa[fa.length-1].position);""!==M&&Va.push({Lgd:M,pye:!1});return Va};var Zi;(function(M){M[M.Jhk=0]="ModelQualityError";M[M.Zik=1]="ServiceQualityError"})(Zi||(Zi={}));Object(u.b)("ErrorType",Zi);class sk extends Tf.a{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea){super();this.ga=M;this.vK=fa;this.Rd=Va;this.Rc=Fb;this.kda=Vb;this.Bpa=wc;this.ukb=Xc;this.ib=vd;this.sJ=Dd;this.jmk=Ce;this.IIe=ea;this.Rk=Th.a.mxc;this.zJ=[this.Rk];
this.ga.fb(Ci.a.$Kh,rb.a.view,Mk.ActionManager.cU,4);this.ga.fb(Ci.a.aLh,rb.a.view,Mk.ActionManager.cU,4);this.ga.fb(Ci.a.bLh,rb.a.view,Mk.ActionManager.cU,4);this.X9=!1;this.vK.execute(Xa=>{Xa.isFeatureEnabled("FloodgateSurvey",!0).then(yb=>{this.X9=yb})})}uKa(M,fa){Em.a.NIf(fa,5)&&(M.classList.add(yh.a.Eyj,yh.a.Dyj),M.style.backgroundColor=null)}jsi(M,fa,Va,Fb,Vb,wc){return{Vta:E.a.createTextRange(M,fa,Va),annotation:Fb,Fbc:Vb,rLj:wc,trackId:Kl.a.create().toString()}}Xfm(M){if(!M||!M.suggestionGroups||
1!==M.suggestionGroups.length)return null;M=M.suggestionGroups[0];return M.critiqueSubType===Th.a.Mlb&&M.isContentPending?M.contentData:null}Yfm(M){return{Iba:M}}kN(M){M=Tc.a.B9a(M.parentPath);return Tc.a.uQb(this.sJ.value,M)}bP(M,fa){const Va={};Va.AnnotationId=M;Va.AIFeedbackSessionId=fa;return Va}A9i(M,fa){M=this.bP(M,fa);this.ga.Ob(Ci.a.$Kh,2,M);Na.ULS.sendTraceTag(509363331,2250,50,"AIFeedbackRewrite card dismissed: {0}",Hf.c(M))}hDn(M,fa){M=this.bP(M,fa);this.ga.Ob(Ci.a.aLh,2,M);Na.ULS.sendTraceTag(509363330,
2250,50,"AIFeedbackRewrite card invoked: {0}",Hf.c(M))}iDn(M,fa){M=this.bP(M,fa);this.ga.Ob(Ci.a.bLh,2,M);Na.ULS.sendTraceTag(509363329,2250,50,"AIFeedbackRewrite card suggestion selected: {0}",Hf.c(M))}initialize(){this.ukb.fTa((M,fa)=>{for(const Va of fa.contents)this.uKa(Va.element,Va.intents)})}get types(){return this.zJ}get eqe(){return 0}zS(){return!1}dismiss(){this.qj.zI&&this.qj.dismiss()}invoke(M,fa,Va,Fb,Vb){this.qj.zI&&this.qj.dismiss();const wc=M.id;if(M.annotationType!==Wf.d.getTypeName())return Na.ULS.sendTraceTag(508905667,
2250,50,"AIFeedBackRewrite received incorrect annotation, expected rewriteAnnotation"),!1;var Xc=M.content;const vd=this.kN(M);if(!vd)return Na.ULS.sendTraceTag(509363297,2250,50,"AIFeedBackRewrite paragraphNode could not be retrieved for rewrite annotation"),!1;if(R.ParagraphReader.text(vd).substring(fa,Va)!==Xc.originalText)return Na.ULS.sendTraceTag(509362850,2250,50,"AIFeedbackRewrite: Text changed before we could apply rewrite {0}",wc),Vb(wc,Fb,!0),!1;M=this.jsi(vd,fa,Va,M,Fb,Vb);Xc=this.nMf(wc,
Fb,M,Xc.originalText,Xc.suggestions,Xc.hallucinationScore,Xc.hallucinationReason);this.ib.Kc(Pa.SelectionFactory.ue(vd,M.Vta.Po));return this.qj.Dna(M.Vta,Xc,this,!1,!1,()=>{this.qj.Hqc()},()=>{Vb(wc,Fb,!1);this.A9i(wc,Fb)},void 0,!0)}async lUi(M,fa,Va,Fb,Vb){this.qj.zI&&this.qj.dismiss();const wc=M.id;if(M.annotationType!==Wf.b.getTypeName())Na.ULS.sendTraceTag(508901448,2250,50,"AIFeedBackOnDemandRewrite received incorrect annotation, expected feedbackAnnotation");else{var Xc=M.content,vd=this.kN(M);
if(vd)if(R.ParagraphReader.text(vd).substring(fa,Va)!==Xc.originalText)Na.ULS.sendTraceTag(508905672,2250,50,"AIFeedBackOnDemandRewrite: Text changed before we could apply rewrite {0}",wc),Vb(wc,Fb,!0);else{M=this.jsi(vd,fa,Va,M,Fb,Vb);Va={...Te.g,id:Th.a.Mlb,suggestionGroups:[{type:this.Rk,id:this.Rk,contentData:M,isContentPending:!0,critiqueSubType:Th.a.Mlb}]};var Dd={title:Xc.title,feedback:Xc.description,example:Xc.originalText};if(fa=this.IIe.has(Dd))Na.ULS.sendTraceTag(508905671,2250,50,"AIFeedBackOnDemandRewrite: Rewrite found in Cache: {0}",
wc),Va=this.IIe.get(Dd),Va=this.nMf(wc,Fb,M,Xc.originalText,[{text:Va.rewrite}],Va.hallucinationScore,Va.hallucinationReason);this.ib.Kc(Pa.SelectionFactory.ue(vd,M.Vta.Po));this.qj.Dna(M.Vta,Va,this,!1,!1,void 0,()=>{Vb(wc,Fb,!1);this.A9i(wc,Fb)},void 0,!0);fa||(vd=await this.jmk.generate(M.trackId,Xc.title,Xc.description,Xc.originalText),Na.ULS.sendTraceTag(508904902,2250,50,"AIFeedBackOnDemandRewrite: Received onDemandRewrite annotation with status: {0}, trackId: {1} and feedbackAnnotationId: {2}",
Mg[vd.status],vd.trackId,Xc.id),this.EWm(wc,Fb,Xc,vd))}else Na.ULS.sendTraceTag(508905673,2250,50,"AIFeedBackOnDemandRewrite paragraphNode could not be retrieved for rewrite annotation")}}EWm(M,fa,Va,Fb){const Vb=this.Xfm(this.qj.definition);if(Vb)if(Vb.trackId!==Fb.trackId)Na.ULS.sendTraceTag(508905669,2250,50,"AIFeedBackOnDemandRewrite: User clicked on another Rewrite button");else{var wc=Fb.status;wc!==Mg.Success?this.qj.definition={...Te.g,id:Th.a.Mlb,suggestionGroups:[{type:this.Rk,id:this.Rk,
contentData:Vb,errorMessage:this.Krm(wc),isContentPending:!1,critiqueSubType:Th.a.Mlb}]}:(this.IIe.wZk({title:Va.title,feedback:Va.description,example:Va.originalText},{rewrite:Fb.rewrite,hallucinationScore:Fb.hallucinationScore,hallucinationReason:Fb.hallucinationReason}),this.qj.definition=this.nMf(M,fa,Vb,Va.originalText,[{text:Fb.rewrite}],Fb.hallucinationScore,Fb.hallucinationReason),this.qj.focus())}else Na.ULS.sendTraceTag(508905670,2250,50,"AIFeedBackOnDemandRewrite: Rewrite card dismissed before we could get back suggestion")}Krm(M){return M===
Mg.BlockedByPostfilter||M===Mg.NoRewriteFromModel?Zi[Zi.Jhk]:Zi[Zi.Zik]}nMf(M,fa,Va,Fb,Vb,wc,Xc){const vd=[],Dd=this.X9?[Te.b.Apply,Te.b.Report]:[Te.b.Apply];for(const Ce of Vb){Vb=this.Yfm(Ce.text);const ea=this.UOm(Fb,Ce.text);vd.push({id:"Suggestion-"+vd.length,title:Ce.text,titleFormatting:ea,supportedActions:Dd,contentData:Vb})}0<vd.length&&this.hDn(M,fa);M="";fa=z.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.AiFeedbackHallucinationThreshold",3);Number.isFinite(wc)&&
wc>=fa&&(M=Xc);return{...Te.g,id:Th.a.Mlb,suggestionGroups:[{type:this.Rk,id:this.Rk,explanation:M,snippet:Fb,snippetFormatting:[],suggestions:vd,contentData:Va,isContentPending:!1,critiqueSubType:Th.a.Mlb,supportedActions:Dd}]}}UOm(M,fa){return z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackRewriteDiffEnabled",!0)?bi(M,fa).map(Va=>({start:Va.startIndex,length:Va.endIndex-Va.startIndex+1,cssColor:"#5A45B6"})):[{start:0,length:fa.length}]}executeAction(M){var fa=
M.suggestionGroup.contentData;if(!fa)return Na.ULS.sendTraceTag(509363296,2250,50,"AIFeedbackRewrite: Unable to extract contentData from action"),!1;switch(M.actionType){case Te.b.Apply:M=M.suggestion.contentData;if(!M)return Na.ULS.sendTraceTag(508862551,2250,50,"AIFeedbackRewrite: Unable to extract SuggestionContentData from action"),!1;this.iDn(fa.annotation.id,fa.Fbc);const Va=this.Rc.Lc(15);try{const Fb=fa.Vta,Vb=Fb.node,wc=E.a.createTextRange(Vb,Fb.cpBegin,Fb.cpEnd);Va.Ab(Vb);this.Rd.We(wc,
M.Iba,!0,!1,Q.a.Ava);this.ib.Kc(Pa.SelectionFactory.ue(Vb,Fb.cpBegin+M.Iba.length));this.kda.iCa(Vb,Fb.cpBegin,Fb.cpBegin+M.Iba.length)}finally{Va&&Va.dispose()}fa.rLj(fa.annotation.id,fa.Fbc,!0);break;case Te.b.Options:Na.ULS.sendTraceTag(508862550,2250,50,"AIFeedbackRewrite: Retrying OnDemandRewrite for annotationId: {0}",fa.annotation.id);this.lUi(fa.annotation,fa.Vta.cpBegin,fa.Vta.cpEnd,fa.Fbc,fa.rLj);break;case Te.b.Report:fa=JSON.parse(M.descriptorData);fa=Vc(fa.payload.comment);this.Bpa.Gha(void 0,
JSON.stringify(new Wj([fa.I2b,fa.DEa,fa.ICa,fa.KZb,void 0])),sk.gFg,tq.b);break;default:return Na.ULS.sendTraceTag(509363295,2250,15,"AIFeedbackRewrite: Failed to process action of type {0} since it is not known to us.",M.actionType),!1}return!0}}sk.gFg="1a762bc9-d52c-41ab-9104-fd73ad49d108";Object(u.a)(sk,"AIFeedbackIntentProvider",Tf.a,[]);var gm=d(2151),Gj=d(49);class En{constructor(){this.completion=new Promise((M,fa)=>{this.resolve=M;this.reject=fa});this.d1i=!1}}Object(u.a)(En,"ControlledPromise",
null,[]);class Rm{constructor(M,fa,Va){this.Cv=M;this.yya=fa;this.isInitialized=!1;this.jIg=new Map;this.Jb=Va}async initialize(){this.isInitialized||(await Tc.a.im(),this.Cv.ub(this,Wf.c.getTypeName()),this.isInitialized=!0)}kXc(M,fa,Va,Fb){fa=new gm.b({trackId:M,rewriteData:{title:fa,feedback:Va,example:Fb}});M=new Uk.a({parentPath:[ko.a.getTypeName(),Gj.a.getTypeNameFor(fa)],items:[{id:M,body:fa}]});return Object.assign(new qp.a,{operation:M})}async generate(M,fa,Va,Fb){await this.initialize();
this.yya.getAugLoopRuntimeManager().submitOperation(this.kXc(M,fa,Va,Fb));const Vb=new En;Vb.mEa=new Gf.a(2,1,15E3,()=>{Vb.mEa&&(Na.ULS.sendTraceTag(508904903,2250,50,"AIFeedBackOnDemandRewrite: Timed out while waiting for AL response for trackId: {0}",M),Vb.resolve(new Wf.c({trackId:M,status:Mg.ErrorDuringExecution,rewrite:""})),Vb.d1i=!0,Vb.mEa=null)});this.Jb.$b(Vb.mEa);this.jIg.set(M,Vb);return Vb.completion}vml(M){M.mEa&&(this.Jb.wf(M.mEa),M.mEa=null)}gH(M,fa){if(M)if(fa!==Uk.a.getTypeName())Na.ULS.shipAssertTag(508905666,
2250,!1);else if(M=M.content,Wf.c.typeGuard(M)){fa=M.trackId;var Va=this.jIg.get(fa);Va&&!Va.d1i&&(this.vml(Va),this.jIg.delete(fa),Va.resolve(M))}else Na.ULS.shipAssertTag(508905665,2250,!1)}}Object(u.a)(Rm,"AIFeedbackRewriteGenerator",null,[114]);class Si{constructor(){this.qr=new Map}wZk(M,fa){this.qr.set(JSON.stringify(M),fa)}has(M){return this.qr.has(JSON.stringify(M))}get(M){return this.qr.get(JSON.stringify(M))}}Object(u.a)(Si,"AIFeedbackRewriteCache",null,[]);let rp,Ji;class Fn{constructor(M,
fa,Va){this.xxa=M;this.Wn=fa;this.q3o=Va;this.key=Fn.keys.K(this.xxa);this.Fv=Fn.Sqf.K(this.xxa)}reset(M){M=M.node;this.Yzk=this.Wn.Ujc(M,0,0,M.characterData.length);io.a.Rvh++}rEa(M){var fa=Fn.WCf(this.Yzk,Va=>this.Qhn(M,Va));fa=this.REl(fa);return{returnValue:!!fa,JG:fa}}Qhn(M,fa){M=fa.Dc<=M&&M<=fa.end;const Va=fa.intent.content,Fb=Qd.a.Zoc(Va);return M&&Fb&&this.q3o(fa.intent.content)?this.xxa===Va.priority||2==this.xxa&&3==Va.priority:!1}REl(M){return M?Object.assign(new Ic.a,{dG:this.key,contentObject:M.intent,
description:this.mVa()}):null}mVa(){return Ob.a.qLa?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static WCf(M,fa){for(const Va of M)if(fa(Va))return Va;return null}}Fn.keys=(Ji=new nm.a,Ji.add(0,"SPELLINGERROR"),Ji.add(1,"GRAMMATICALERROR"),Ji.add(2,"ADVANCEDERROR"),Ji);Fn.Sqf=(rp=new nm.a,rp.add(0,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),rp.add(1,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),rp.add(2,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),
rp);Object(u.a)(Fn,"CritiqueDetailsProvider",null,[299,300]);var ml=d(1498),jn=d(771),Gn=d(1858),gl;(function(M){M[M.previewUrl=1]="previewUrl";M[M.thumbnailUrl=2]="thumbnailUrl"})(gl||(gl={}));class rj{constructor(M){Gj.a.assign(rj,this,M)}get metadata(){return this.M_}set metadata(M){this.M_=M}static getTypeName(){return"AugLoop_UrlPreviewAndThumbnail_PreviewAndThumbnailURLAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(M){return Gj.a.matchesTypesFor(M,[rj.getTypeName()])}}
rj.H_={T_:rj.getTypeName(),B_:rj.getBaseTypes()};class tk{constructor(M){Gj.a.assign(tk,this,M)}static getTypeName(){return"AugLoop_UrlPreviewAndThumbnail_PreviewAndThumbnailSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(M){return Gj.a.matchesTypesFor(M,[tk.getTypeName()])}}tk.H_={T_:tk.getTypeName(),B_:tk.getBaseTypes()};var fp=d(1032),mj=d(1094);class xs{constructor(M,fa){this.yya=M;this.Pb=fa;this.isInitialized=!1;this.azb=new Map}Xb(){this.Pb.qa(Q.a.Y7d,rb.a.application,
this.Y7d.bind(this))}async Y7d(M,fa,Va,Fb,Vb){if(!this.uvn(Vb))return 8;if(1===Va)return 32;M=await this.iFf(Vb.url,gl.thumbnailUrl);await this.iFf(Vb.url,gl.previewUrl);await this.iFf(Vb.url,gl.previewUrl,M.itemId,M.driveId);return 32}uvn(M){const fa=M.urlType,Va=M.itemId,Fb=M.driveId;return M.url||Va&&Fb&&fa===gl.previewUrl}async initialize(){this.isInitialized||(await Tc.a.im(),this.yya.getAugLoopRuntimeManager().activateAnnotation(Object.assign(new jn.a,{annotationType:rj.getTypeName(),handler:this.Kho.bind(this)})),
this.isInitialized=!0)}Kho(M){M=new Gn.a(M);for(const Va of M.annotations){const Fb=Object(fp.a)(Va.parentPath);var fa=M.TRd;const Vb=this.azb.get(Fb);if(!Vb||fa!==Uk.a.getTypeName())break;if(Va.annotationType===rj.getTypeName()){fa=null===Va||void 0===Va?void 0:Va.content;if(!rj.typeGuard(fa)){Vb.reject(Error("Wrong annotation type"));this.azb.delete(Fb);break}Vb.resolve(fa)}this.azb.delete(Fb)}}async iFf(M,fa,Va,Fb){await this.initialize();const Vb=lo.a.create().toString(),wc=new En;this.azb.set(Vb,
wc);this.yya.getAugLoopRuntimeManager().submitOperation(this.kXc(Vb,M,fa,Va,Fb));return wc.completion}kXc(M,fa,Va,Fb,Vb){fa=new tk({url:fa,requestIdentifier:Va,itemId:Fb,driveId:Vb});M=new Uk.a({parentPath:[mj.b.getTypeName(),Gj.a.getTypeNameFor(fa)],items:[{id:M,body:fa}]});return Object.assign(new qp.a,{operation:M})}}Object(u.a)(xs,"AugloopUrlPreviewAndThumbnailHandler",null,[]);class qr{constructor(){this.tOd=this.bGd=null;this.IJk="ALProofing"}get name(){return"WordEditor.CanvasContextual"}wc(M){var fa;
this.Z=M;this.Z.ia("WordEditor.CanvasContextual.IntelligentPlaceholderProvider",()=>new Um(this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),z.AFrameworkApplication.va)).ha();this.Z.ia("WordEditor.CanvasContextual.SuggestionNavigator",()=>new Cm.a(this.Z.resolve("Box4.IParagraphIteratorFactory"),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.Proofing.IErrorRangeEditor"),this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),
this.Z.resolve("Box4.IGraphNodeSelector"),this.Z.resolve("Box4.IDocumentKindCalculator"),this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ia("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager",()=>new Rk.a(z.AFrameworkApplication.pc,this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.ParagraphRenderEvents"))).ha();this.Z.ia("WordEditor.CanvasContextual.TrackChangeIntentProvider",()=>new Xd(z.AFrameworkApplication.va,this.Z.resolve("Box4.TrackChange.ITrackChangeManager"),
this.Z.resolve("Box4.TrackChange.ITrackChangeReader"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.IParagraphIteratorFactory"),this.Z.resolve("WordEditor.CanvasContextual.TrackChangeCardThemeProvider"),this.Z.resolve("WordEditor.TrackChange.IFeatureUsageAndHealthLogger"),this.Z.resolve("WordEditor.TrackChange.ITrackChangeInfoViewModelGenerator"),this.Z.resolve("WordEditor.TrackChange.ITrackChangeHighlightProvider"))).ha();
const Va=this.Z.resolve("Box4.Proofing.IEditorSettingsManagerActor");this.Z.ia("WordEditor.CanvasContextual.LegacyProofingIntentProvider",()=>new mk(z.AFrameworkApplication.va,this.Z.resolve("WordEditor.CanvasContextual.AugLoopAvertHandler"),this.Z.Oa("WordEditor.ICanvasContextualFooterData"),this.Z.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.Oa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"),this.Z.Oa("WordEditor.Ideas.Messenger.IMessenger"),
this.Z.Oa("WordEditor.Ideas.Signals.IUserEngagementMonitor"),this.Z.resolve("WordEditor.CanvasContextual.OCVFeedbackManager"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("WordEditor.CanvasContextual.IProofingIntentGoalChangeListener"),this.Z.resolve("WordEditor.CanvasContextual.IProofingIntentPremiumPreviewStateChangeHandler"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"),this.Z.Ta("Common.ISystemInitiatedFeedback"),z.AFrameworkApplication.pc,this.Z.Oa("WordEditor.Goals.IGoalChangeSource"),
this.Z.Ta("Common.App.Policy.Contracts.IPolicyManager"),this.Z.Ta("Office.Word.Online.Ideas.ToggleProofingActor"),null,Va)).as("WordEditor.CanvasContextual.ILegacyProofingActionEventSource").ha();this.Z.ia("WordEditor.CanvasContextual.OCVFeedbackManager",()=>new tq.a(z.AFrameworkApplication.Fe,z.AFrameworkApplication.pc,z.AFrameworkApplication.J)).ha();this.Z.ia("WordEditor.CanvasContextual.CustomXmlNodeHelper",()=>new pn(this.Z.Ta("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).ha();this.Z.ia("WordEditor.CanvasContextual.AugLoopProofingIntentProvider",
()=>{var Fb;return new ub(z.AFrameworkApplication.va,this.Z.resolve("WordEditor.CanvasContextual.AugLoopAvertHandler"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.Ta("WordEditor.IBusinessBarController"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.IClipboardDataHelper"),this.Z.resolve("WordEditor.CanvasContextual.CustomXmlNodeHelper"),this.Z.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.Z.Oa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"),this.Z.resolve("WordEditor.CanvasContextual.OCVFeedbackManager"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.ILanguageReader"),this.Z.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("WordEditor.IParagraphSplitHelper"),
this.Z.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.Z.resolve("WordEditor.CanvasContextual.IProofingIntentGoalChangeListener"),this.Z.resolve("WordEditor.CanvasContextual.IProofingIntentPremiumPreviewStateChangeHandler"),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"),this.Z.Ta("Common.ISystemInitiatedFeedback"),z.AFrameworkApplication.pc,this.Z.resolve("Box4.IFeatureHelper"),this.Z.Ta("Common.App.Policy.Contracts.IPolicyManager"),
this.Z.Oa("WordEditor.Goals.IGoalChangeSource"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Z.Ta("Office.Word.Online.Ideas.ToggleProofingActor"),this.Z.resolve("IRoamingDictionary"),Wd.a.instance,this.Z.Ta("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.Ta("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),null,this.Z.Ta("WordEditor.Ideas.Localization.ICategoryStandardization"),
Va,this.Z.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),...((null===(Fb=z.AFrameworkApplication.J)||void 0===Fb?0:Fb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIToContinueReviewSuggestionsEnabled",!1))?[this.Z.Oa("WordEditor.Ideas.AddInLoader.OpenEditorTeachingCallout")]:[]))}).ha();this.Z.ia("WordEditor.CanvasContextual.NeuralRewriteIntentProvider",()=>new Vl(z.AFrameworkApplication.va,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("WordEditor.CanvasContextual.AugLoopAvertHandler"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.Proofing.IErrorRangeEditor"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.ILanguageReader"),this.Z.resolve("WordEditor.CanvasContextual.OCVFeedbackManager"),this.Z.resolve("Box4.ParagraphRenderEvents"),
this.Z.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.Z.resolve("Box4.Proofing.IProofingSentenceSeparator"),this.Z.resolve("Box4.ISelectionManager"),z.AFrameworkApplication.pc)).ha();this.Z.ia("WordEditor.CanvasContextual.AIFeedbackRewriteGenerator",()=>new Rm(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),z.AFrameworkApplication.pc)).ha();this.Z.ia("WordEditor.CanvasContextual.AIFeedbackRewriteCache",()=>new Si).ha();
this.Z.ia("WordEditor.CanvasContextual.AIFeedbackIntentProvider",()=>new sk(z.AFrameworkApplication.va,this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"),this.Z.resolve("WordEditor.CanvasContextual.OCVFeedbackManager"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("Box4.ISelectionManager"),
new Pd.a(()=>U.StaticActiveAppFrame.za().kb.hd.ud),this.Z.resolve("WordEditor.CanvasContextual.AIFeedbackRewriteGenerator"),this.Z.resolve("WordEditor.CanvasContextual.AIFeedbackRewriteCache"))).ha();this.Z.ia("WordEditor.CanvasContextual.DictationCorrectionIntentProvider",()=>new pc(z.AFrameworkApplication.va,this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),z.AFrameworkApplication.J.$("DictationCorrectionsInEditorPaneIsEnabled"))).ha();
this.Z.ia("WordEditor.CanvasContextual.DiscoveryCommandIntentProvider",()=>new af).ha();this.Z.ia("WordEditor.CanvasContextual.ProofingErrorPresenter",()=>new Tp(this.Z.resolve("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"))).as("Box4.Actors.IProofingErrorPresenter").ha();this.Z.ia("WordEditor.CanvasContextual.IdeasCardsMessageHandler",()=>new zk(this.Z.resolve("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),
this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.DictationCorrectionIntentProvider"),this.Z.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.Proofing.ICritiqueTypeSettings"))).as("WordEditor.IIdeasCardsMessageHandler").ha();this.Z.ia("WordEditor.INeuralRewriteMessageHandler",()=>new Fp(this.Z.resolve("WordEditor.CanvasContextual.NeuralRewriteIntentProvider"))).as("WordEditor.INeuralRewriteMessageHandler").ha();
this.Z.ia("WordEditor.CanvasContextual.AugLoopAvertHandler",()=>new qc.a(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ia("WordEditor.CanvasContextual.ProofingIntentGoalChangeListener",()=>new Fm(this.Z.resolve("Common.IUlsWrapper"))).as("WordEditor.CanvasContextual.IProofingIntentGoalChangeListener").ha();this.Z.register(Fm,"WordEditor.CanvasContextual.ProofingIntentPremiumPreviewStateChangeHandler").as("WordEditor.CanvasContextual.IProofingIntentPremiumPreviewStateChangeHandler").ha().Ud(()=>
new uq(this.Z.resolve("Common.IUlsWrapper")));this.Z.ia("WordEditor.CanvasContextual.BookmarkIntentProvider",()=>new Bc(z.AFrameworkApplication.va,this.Z.resolve("Box4.IFeatureHelper"))).ha();this.Z.ia("WordEditor.CanvasContextual.CanvasContextualTooltipActionListener",()=>new Jq(z.AFrameworkApplication.ua,db.a.instance,Object(Ni.a)(),Bg.KeyInputManager.instance,this.Z.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();M.ia("WordEditor.Copilot.Summarization.EditorAiTelemetryLogger",
()=>new ml.a(M.resolve("Wac.Common.Utils.IOtelWrapper"),"Summarization")).ha();this.Z.ia("WordEditor.CanvasContextual.AutoreplaceHandler",()=>new pf(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),M.resolve("Box4.IAutoCorrectOptionsInfo"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),new Pd.a(()=>U.StaticActiveAppFrame.za().kb.hd.ud),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"))).ha();this.Z.ia("WordEditor.CanvasContextual.AutoReplaceIntentProvider",()=>new Hg(this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.CanvasContextual.AutoreplaceHandler"),this.Z.resolve("Box4.ParagraphRenderEvents"))).ha();ck.a.VGe()&&this.Z.ia("WordEditor.CanvasContextual.ContextIQIntentProvider",
()=>new ck.a(z.AFrameworkApplication.va,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.IHyperlinkEditor"),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.Z.Ta("Common.App.People.IExternalPeopleAPI"),
this.Z.Ta("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("Box4.AugmentationLoop.IAlSessionLifeEventNotifier"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),Object(Ni.a)(),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();je.a.KQg()&&this.Z.ia("WordEditor.CanvasContextual.SummarizationIntentProvider",
()=>new je.a(this.Z.Ta("WordEditor.CanvasContextualProvider.UxManager"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.Ta("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.Copilot.Summarization.EditorAiTelemetryLogger"))).ha();if(null===(fa=z.AFrameworkApplication.J)||void 0===fa?0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AugloopPreviewAndThumbnail",!1))this.Z.ia("WordEditor.CanvasContextual.AugloopUrlPreviewAndThumbnailHandler",
()=>new xs(this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),z.AFrameworkApplication.va)).ha(),this.Z.resolve("WordEditor.CanvasContextual.AugloopUrlPreviewAndThumbnailHandler").Xb();(this.Rvf=this.Z.resolve("WordEditor.Designer.IDesignerControl").isEnabled())&&this.Ayl()}Ayl(){this.Z.register(838,"WordEditor.CanvasContextual.IDesignerReviewNavigator").ha().Ud(()=>new Dn(this.Z.resolve("WordEditor.Designer.Review.IReviewManager"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator"))).ha();
this.Z.ia("WordEditor.CanvasContextual.DesignerIntentProvider",()=>new Kq.a(this.Z.resolve("Common.IActionManager"),this.Z.resolve("WordEditor.Designer.IDesignerControl"),this.Z.resolve("WordEditor.CanvasContextual.IDesignerReviewNavigator"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),this.Z.resolve("WordEditor.Designer.OnCanvas.ITriageOptionProvider"),this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
this.Z.resolve("WordEditor.Designer.IDesignerTaskPane"),this.Z.resolve("WordEditor.Designer.Review.IReviewTraverser"),this.Z.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();this.Z.ia("WordEditor.CanvasContextual.IDesignerActionListener",()=>new Ul.a(z.AFrameworkApplication.va,this.Z.resolve("WordEditor.CanvasContextual.DesignerIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.IDesignerReviewNavigator"),
this.Z.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),this.Z.resolve("WordEditor.Designer.Style.PullQuotesManager"),this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.Z.resolve("WordEditor.Designer.DocumentInfo"))).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){var M;z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1)&&this.Z.resolve("WordEditor.CanvasContextual.AutoreplaceHandler").initialize();
const fa=Ob.a.qLa,Va=z.AFrameworkApplication.J.$("RewriteIsEnabled")||z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1),Fb=null===(M=z.AFrameworkApplication.J)||void 0===M?void 0:M.getBooleanFeatureGate("Microsoft.Office.WordOnline.onHoverDelayShowForTrackChangeCard",!1),Vb=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1)&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackRewriteEnabled",
!0);this.Z.Ta("CanvasContextual.ICanvasContextualController").execute(()=>{this.Z.Ta("WordEditor.CanvasContextualProvider.UxManager").execute(wc=>{this.oYn(fa,Va,Fb,Vb,wc)})})}oYn(M,fa,Va,Fb,Vb){const wc=[],Xc=[],vd=new H.a;Va&&wc.push(this.Z.Ta("WordEditor.CanvasContextual.TrackChangeIntentProvider"));M&&(Xc.push(this.Z.resolve("WordEditor.CanvasContextual.LegacyProofingIntentProvider")),Xc.push(this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider")),Xc.push(this.Z.resolve("WordEditor.CanvasContextual.DictationCorrectionIntentProvider")),
wc.push(this.Z.Ta("WordEditor.CanvasContextual.LegacyProofingIntentProvider")),wc.push(this.Z.Ta("WordEditor.CanvasContextual.AugLoopProofingIntentProvider")),z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1)&&Xc.push(this.Z.resolve("WordEditor.CanvasContextual.AutoReplaceIntentProvider")),ck.a.VGe()&&Xc.push(this.Z.resolve("WordEditor.CanvasContextual.ContextIQIntentProvider")),je.a.KQg()&&Xc.push(this.Z.resolve("WordEditor.CanvasContextual.SummarizationIntentProvider")),
Ob.a.iWf()||vd.add(new Ze(this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"))));Xc.push(this.Z.resolve("WordEditor.CanvasContextual.DiscoveryCommandIntentProvider"));Xc.push(this.Z.resolve("WordEditor.CanvasContextual.TrackChangeIntentProvider"));Va||wc.push(this.Z.Ta("WordEditor.CanvasContextual.TrackChangeIntentProvider"));fa&&(Xc.push(this.Z.resolve("WordEditor.CanvasContextual.NeuralRewriteIntentProvider")),
this.Z.resolve("WordEditor.CanvasContextual.NeuralRewriteIntentProvider").initialize(),this.Z.resolve("WordEditor.INeuralRewriteMessageHandler"));Fb&&(Xc.push(this.Z.resolve("WordEditor.CanvasContextual.AIFeedbackIntentProvider")),this.Z.resolve("WordEditor.CanvasContextual.AIFeedbackIntentProvider").initialize());wc.push(this.Z.Ta("WordEditor.CanvasContextual.IntelligentPlaceholderProvider"));Xc.push(this.Z.resolve("WordEditor.CanvasContextual.IntelligentPlaceholderProvider"));this.Rvf&&(Xc.push(this.Z.resolve("WordEditor.CanvasContextual.DesignerIntentProvider")),
this.Z.resolve("WordEditor.CanvasContextual.IDesignerActionListener").initialize());Xc.push(this.Z.resolve("WordEditor.CanvasContextual.BookmarkIntentProvider"));this.bGd=new mm(Xc,this.Z.resolve("Box4.IInteractiveEventHandler"),Object(Ni.a)(),this.Z.resolve("Box4.ISelectionManager"),Vb);new an(this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),z.AFrameworkApplication.pc,Xc);Va=new qj(this.Z.resolve("Box4.Highlight.IHighlightManager"),Xc,!!sb.a.instance&&sb.a.instance.LBa);Fb=z.AFrameworkApplication.J.$("CanvasContextualDismissOnEscapeIsEnabled");
this.Z.resolve("WordEditor.CanvasContextual.CanvasContextualTooltipActionListener").initialize();this.tOd=new kc(z.AFrameworkApplication.ua,Va,db.a.instance,this.Z.resolve("Box4.IInteractiveEventHandler"),Object(Ni.a)(),Bg.KeyInputManager.instance,this.Z.resolve("Box4.ISelectionManager"),!0,z.AFrameworkApplication.pc,this.Z.Ta("WordEditor.AtMentions.IWordEditorAtMentionsHandler"),Vb,Xc,Fb);!M&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&
(this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider").dxb(Va),this.tOd.eVj=!1);this.bGd.sdc(U.StaticActiveAppFrame.za().kb);for(var Dd of Xc)Dd.qj=Vb;M&&(this.Z.resolve("Box4.Actors.IProofingErrorPresenter"),Dd=new sh(this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.DictationCorrectionIntentProvider"),this.Z.resolve("WordEditor.CanvasContextual.SuggestionNavigator")),
Va=this.Z.resolve("WordEditor.IIdeasCardsMessageHandler"),Va.qj=Vb,Va.owj=Dd);(M||fa)&&(new Eg(z.AFrameworkApplication.va,cf.FocusManager.instance(),Xc)).Xb();fa=this.Z.Ta("Box4.Accessibility.IAccessibilityContextManager");if(Ob.a.iWf()){Vb=this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider");const Ce=Vb.VDa.bind(Vb),ea=this.Z.resolve("Box4.Intent.IIntentRangeEditor");fa.execute(Xa=>{Xa.dY(new Fn(0,ea,Ce));Xa.dY(new Fn(1,ea,Ce));Xa.dY(new Fn(2,ea,Ce))})}else fa.execute(Ce=>
{for(const ea of vd)Ce.dY(ea)});z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").activateAnnotation(Sb.Critique.getTypeName(),this.IJk);M&&(M=this.Z.resolve("Box4.Actors.ProofingActor"),z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)?(fa=this.Z.resolve("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),fa=fa.VDa.bind(fa)):
(fa=this.Z.resolve("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),fa=fa.k0b.bind(fa)),M.sxo(fa))}dispose(){this.bGd&&this.bGd.dispose();this.tOd&&this.tOd.dispose();this.Z.resolve("WordEditor.CanvasContextual.CanvasContextualTooltipActionListener").dispose();this.Rvf&&this.Z.resolve("WordEditor.CanvasContextual.IDesignerActionListener").dispose()}static main(){x.a.instance.Mc(new qr)}}Object(u.a)(qr,"PackageManager",null,[0,1]);var Up=d(151),dr=d(1027),Fi=d(175),bo=d(87);class gp extends Vi.a{constructor(M,
fa,Va,Fb){super(!1,!1,!0);this.INe=this.GNe=this.C1a=null;this.ndh=0;this.rga=(Vb,wc)=>{1!==wc.$rc&&1===wc.zbb&&this.heb(3,"No Internet")};this.Bqc=Vb=>{Vb||(this.Hhe(0),this.soa.q$j=!0,this.hide())};this.r0j=(Vb,wc)=>{1===Vb?(this.M2a=!1,this.EBg(!1),this.O$b=wc.selectedThemeMetadata,this.zHh=Date.now(),this.soa.Ycf(this.O$b)):(this.Hhe(1),this.XY=!0,this.hide());this.$Ga.reset()};this.U7h=Vb=>{Vb||(this.soa.iCg=!1,this.Hhe(2),this.XY=!0,this.hide())};this.afo=Vb=>{1===Vb?(this.XY=!0,this.hide(),
z.AFrameworkApplication.ua.MX(!0,this.GNc,!0),xg.a("ConvertToPPTLaunchClicked",!0)):(this.Hhe(4),this.XY=!0,this.hide())};this.KOm=(Vb,wc)=>this.$Ga.q0j.length>=this.wQk?8:0==Vb.length&&0==wc.length?this.UMi()?7:6:1;this.XPm=(Vb,wc)=>this.$Ga.isEmpty()||0!=Vb.length||0!=wc.length?0:this.a5a;this.UJm=Vb=>{if(7===Vb)return WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorSeeMoreThemesFailureTextAfterMaxRetry;if(6==Vb)return WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorSeeMoreThemesFailureTextWithRetry;
if(8==Vb)return WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorSeeMoreThemesMaxThemesLoaded};this.Ilj=()=>{this.d9(this.C1a,this.r0j,{["id"]:"ConvertToPPTDialog",["bodyControls"]:{["dialogState"]:5,["convertDialogTopMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTDialogTopMessage},["dialogButtonsOption"]:1,["actionButtonProps"]:{["type"]:"AppButtonProps",["id"]:"ThemeSuggestionsConvertButton",["label"]:this.GNe}});this.soa.YRc()};this.M0n=()=>{this.a5a+=1;this.Ilj()};this.soa=M;this.Jb=
fa;this.$Ga=Fb;this.wQk=z.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.ThemeMaxLimitWordToPPT",18);this.vda=!1;this.j5b=new H.a;this.j5b.add(WordEditorIntl.WordEditorStrings.L_ConvertingToPPTDialogMessagePreparingSlides);this.j5b.add(WordEditorIntl.WordEditorStrings.L_ConvertingToPPTDialogMessageSummarizeContent);this.j5b.add(WordEditorIntl.WordEditorStrings.L_ConvertingToPPTDialogMessageAddDesignTheme);this.zch=Kj.a.Dea("wordToPptPrint.gif");this.Ach=Kj.a.Dea("wordToPptPrint.svg");
this.Agh=Kj.a.Dea("ErrorGenericColor.svg");this.eDk=Kj.a.Dea("PptLaunch.svg");this.lf=Va;this.w5b=0;this.Loh=!1;this.O$b=null;this.M2a=!1;this.a5a=0;this.GNc=null;this.lf.Zlb(this.rga);this.C1a=WordEditorIntl.WordEditorStrings.L_ExportToPPTDialogHeader;this.GNe=WordEditorIntl.WordEditorStrings.L_ExportButtonText;this.INe=WordEditorIntl.WordEditorStrings.L_ExportingToPPTDialogHeader;this.zHh=this.PKc=-1}$6d(){return{["id"]:"ConvertToPPTDialog",["bodyControls"]:{["dialogState"]:0,["convertDialogTopMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTLoadingDialogText},
["dialogButtonsOption"]:6}}leb(){this.$Ga.reset();this.Uh(this.C1a,this.Bqc,this.$6d());this.cVb(0);this.soa.YRc()}dVj(M,fa){if(!this.M2a){this.Loh=!0;this.GNc=null;this.a5a=this.XPm(M,fa);var Va=this.KOm(M,fa);this.d9(this.C1a,this.r0j,{["id"]:"ConvertToPPTDialog",["bodyControls"]:{["dialogState"]:Va,["themeThumbnails"]:M,["themeMetadata"]:fa,["convertDialogTopMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTDialogTopMessage,["convertDialogBottomMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTDialogBottomMessage,
["themeSuggestionImgAltText"]:WordEditorIntl.WordEditorStrings.L_ThemeSuggestionsAltText,["seeMoreThemesActionResultMessage"]:this.UJm(Va),["seeMoreThemesButtonLabel"]:WordEditorIntl.WordEditorStrings.L_SeeMoreThemesButtonText,["onMoreThemesButtonClicked"]:this.Ilj,["onMoreThemesErrorTryAgainClicked"]:this.M0n},["dialogButtonsOption"]:1,["actionButtonProps"]:{["type"]:"AppButtonProps",["id"]:"ThemeSuggestionsConvertButton",["label"]:this.GNe}});this.cVb(Va)}}EBg(M){this.w5b=0;M||(this.a5a=0);this.cVb(2);
M={["id"]:"ConvertToPPTDialog",["bodyControls"]:{["dialogState"]:2,["dialogImageSource"]:this.zch,["dialogImageReducedMotionSource"]:this.Ach,["dialogImageAltText"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTProgressDialogImageAltText,["convertingToPPTDialogTopMessage"]:this.j5b.K(this.w5b),["convertingToPPTDialogMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertingToPPTDialogMessageConversionAlmostDone},["dialogButtonsOption"]:6};this.w5b++;this.d9(this.INe,this.U7h,M);this.Jb.$b(new Gf.a(3,
1,3500,()=>{this.k9j()}));this.XY=!0}f9o(M){this.GNc=M;M={["id"]:"ConvertToPPTDialog",["bodyControls"]:{["dialogState"]:4,["dialogImageSource"]:this.eDk,["dialogImageAltText"]:WordEditorIntl.WordEditorStrings.L_LaunchPPTImageAltText,["convertingToPPTDialogTopMessage"]:WordEditorIntl.WordEditorStrings.L_LaunchPPTTopMessage,["convertingToPPTDialogMessage"]:WordEditorIntl.WordEditorStrings.L_LaunchPPTBottomMessage},["dialogButtonsOption"]:1,["actionButtonProps"]:{["type"]:"AppButtonProps",["id"]:"LaunchPresentationtButton",
["label"]:WordEditorIntl.WordEditorStrings.L_LaunchPPTBottonText}};this.cVb(4);this.d9(this.C1a,this.afo,M)}k9j(){if(!this.GNc&&!this.M2a){var M={["dialogState"]:2,["dialogImageSource"]:this.zch,["dialogImageReducedMotionSource"]:this.Ach,["dialogImageAltText"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTProgressDialogImageAltText,["convertingToPPTDialogTopMessage"]:this.j5b.K(this.w5b),["convertingToPPTDialogMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertingToPPTDialogMessageConversionAlmostDone};
this.d9(this.INe,this.U7h,{["id"]:"ConvertToPPTDialog",["bodyControls"]:M,["dialogButtonsOption"]:6});this.w5b++;this.w5b<this.j5b.count&&this.Jb.$b(new Gf.a(3,1,3500,()=>{this.k9j()}))}}heb(M,fa,Va=null){if(!(this.M2a||1===M&&this.Loh||2===M&&this.GNc)){this.M2a=!0;this.soa.iCg=!1;if(Va){switch(Va.ErrorCode){case 400:M=0;break;case 401:case 408:case 500:break;default:Na.ULS.sendTraceTag(579216210,3020,10,"Received an unknown error code: {0} | reason: {1}",Va.ErrorCode,Va.ErrorString)}Va=[Object.assign(new tb.a,
{name:"ErrorData",int64:Va.ErrorCode,string:Va.ErrorString})];xg.a("ConvertToPPTReachedErrorState",!1,void 0,Va)}switch(M){case 0:Va=this.Wnm();var Fb=Vb=>{this.a3l(Vb)};break;case 1:Va=this.yHf(WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorFetchThemeFailureTextWithoutDismiss,WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorFetchThemeFailureTextWithDismiss);Fb=(Vb,wc)=>{this.Z2l(Vb,wc)};break;case 2:Va=this.yHf(WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorFailedToConvertTextWithoutDismiss,
WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorFailedToConvertTextWithDismiss);Fb=(Vb,wc)=>{this.Y2l(Vb,wc)};break;case 3:Va=this.yHf(WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorNoInternetText,WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorNoInternetText);Fb=(Vb,wc)=>{this.$2l(Vb,wc)};break;default:Na.ULS.sendTraceTag(579428552,3020,10,"Attempted to show Error Dialog with an unknown reason: {0}",M);this.hide();return}this.d9(this.C1a,Fb,Va);M=[Object.assign(new tb.a,{name:"ConvertToPPTErrorDialogState",
int64:M}),Object.assign(new tb.a,{name:"ConvertToPPTErrorDescription",string:fa}),Object.assign(new tb.a,{name:"ConvertToPPTStateBeforeError",int64:this.ndh})];xg.a("ConvertToPPTReachedDialogState",!1,void 0,M)}}Wnm(){return{["id"]:"ConvertToPPTDialog",["bodyControls"]:{["dialogState"]:3,["dialogImageSource"]:this.Agh,["dialogImageAltText"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorDialogImageAltText,["convertDialogBottomMessage"]:WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorUnsupportedConversionText},
["dialogButtonsOption"]:0,["actionButtonProps"]:{["type"]:"AppButtonProps",["id"]:"ErrorFromConvertingOkButton",["label"]:WordEditorIntl.WordEditorStrings.L_OkButtonText}}}yHf(M,fa){fa={["dialogState"]:3,["convertDialogBottomMessage"]:fa};M!==WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorNoInternetText&&(fa.dialogImageSource=this.Agh,fa.dialogImageAltText=WordEditorIntl.WordEditorStrings.L_ConvertToPPTErrorDialogImageAltText);const Va={["type"]:"AppButtonProps",["id"]:"ErrorFromConvertingCancelButton",
["label"]:WordEditorIntl.WordEditorStrings.L_DismissButtonText};let Fb=null,Vb=6;this.UMi()||(Fb={["type"]:"AppButtonProps",["id"]:"ErrorFromConvertingOkButton",["label"]:WordEditorIntl.WordEditorStrings.L_TryAgainButtonText},Va.label=WordEditorIntl.WordEditorStrings.L_CancelButtonText,Vb=1,fa.convertDialogBottomMessage=M);return{["id"]:"ConvertToPPTDialog",["bodyControls"]:fa,["dialogButtonsOption"]:Vb,["actionButtonProps"]:Fb,["cancelButtonProps"]:Va}}UMi(){return 2<=this.a5a}a3l(M){this.M2a=!1;
1===M&&(this.Ghe(0),this.XY=!0,this.hide())}Z2l(M,fa){this.M2a=!1;1===M&&(this.a5a++,fa=this.$6d(),this.PKc=Date.now(),this.d9(this.C1a,this.Bqc,fa),this.cVb(0),this.soa.YRc());M||(this.Ghe(1),this.XY=!0,this.hide(),this.$Ga.reset())}Y2l(M,fa){this.M2a=!1;1===M?(this.a5a++,F.a.baa(this.O$b)?(fa=this.$6d(),this.PKc=Date.now(),this.d9(this.C1a,this.Bqc,fa),this.cVb(0),this.soa.YRc(),Na.ULS.sendTraceTag(579216211,3020,10,"ConvertToPPTDialog somehow forgot what the selectedThemeMetaData was when converting")):
(this.EBg(!0),this.soa.Ycf(this.O$b))):M||(this.Ghe(2),this.XY=!0,this.hide())}$2l(M,fa){this.M2a=!1;1===M?(this.a5a++,F.a.baa(this.O$b)?(fa=this.$6d(),this.PKc=Date.now(),this.d9(this.C1a,this.Bqc,fa),this.cVb(0),this.soa.YRc()):(this.EBg(!0),this.soa.Ycf(this.O$b))):M||(this.Ghe(3),this.XY=!0,this.hide())}cVb(M){this.ndh=M;var fa=-1;M?1===M?fa=this.PKc:4===M&&(fa=this.zHh):this.PKc=Date.now();fa=-1===fa?0:Date.now()-fa;M=[Object.assign(new tb.a,{name:"ConvertToPPTDialogState",int64:M})];xg.a("ConvertToPPTReachedDialogState",
!0,fa,M)}Hhe(M){M=[Object.assign(new tb.a,{name:"ConvertToPPTDialogStateOnCancel",int64:M})];xg.a("ConvertToPPTReachedDialogStateCancel",!1,void 0,M)}Ghe(M){M=[Object.assign(new tb.a,{name:"ConvertToPPTDialogErrorReasonCancel",int64:M})];xg.a("ConvertToPPTReachedDialogErrorReasonCancel",!1,void 0,M)}dispose(){this.lf.Erg(this.rga);super.dispose()}}Object(u.a)(gp,"ConvertToPPTDialog",Vi.a,[933]);class ci{static L8a(){return ci.bOe}static EDl(M,fa,Va,Fb){ci.bOe=new gp(M,fa,Va,Fb);ci.bOe.leb()}}ci.bOe=
null;Object(u.a)(ci,"ConvertToPPTDialogManager",null,[]);class Mm{constructor(M,fa,Va,Fb,Vb,wc,Xc){this.Q7h="ConvertToPPTButtonEnabledActivity";this.wko="IsProtectedFile";this.WYm="HasEmergencyViewModeBeenDeployed";this.PGp="WasAugloopAuthSuccessful";this.Wbf=!0;this.xch=null;this.TWc=(vd,Dd,Ce)=>{if(1===Ce)return this.hzf()?32:8;if(this.eq.$("IsAnonymousUser"))return Na.ULS.sendTraceTag(579432723,3020,50,"Unsigned user clicked on Transform to Presentation button"),vd=new Fi.StandardDialog,vd.Bd=
0,vd.Cna(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_ConvertToPPTSignInNeeded,null),32;ci.EDl(this.soa,this.Jb,this.lf,this.$Ga);return 32};this.R5n=()=>{var vd=appChrome.selectors.getVisibleControlIds();this.eq.$("IsConvertWordToPPTAllowed")&&this.hzf()&&0<=vd.indexOf("ConvertToPPT")&&(vd=fd.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&vd.execute(Dd=>{Dd.logActivity("ExportWordToPPTActivity",null)})};this.ldp=()=>{32!==this.ga.Ob(Ci.a.TWc,2)&&Na.ULS.sendTraceTag(561563487,
3020,10,"Could not start convert to ppt workflow")};this.ga=M;this.soa=fa;this.eq=Va;this.Jb=Fb;this.lf=Vb;this.bMk=wc;this.$Ga=Xc}Xb(){z.AFrameworkApplication.dV?Na.ULS.sendTraceTag(579432721,3020,50,"Disabling Transform to Presentation button because document has protection."):this.eq.$("DisablePrintBasedOnPolicy")&&this.eq.$("DisablePrint")?Na.ULS.sendTraceTag(579432722,3020,50,"Disabling Transform to Presentation button because print is disabled."):(this.ga.fb(Ci.a.TWc,bo.a.frame,this.TWc,4),
this.eq.$("UseNewCommandForWordFileMenuSaveAs")&&(this.bMk.w2k(this.R5n),window.addEventListener&&(this.xch=this.ldp,window.addEventListener("ShowWordToPPTLoadingScreen",this.xch,!0))))}hzf(){const M=!z.AFrameworkApplication.cG&&!this.lf.Jk&&this.Wbf&&!z.AFrameworkApplication.eta;if(M)xg.a(this.Q7h,!0);else{const fa=[Object.assign(new tb.a,{name:this.wko,bool:z.AFrameworkApplication.cG}),Object.assign(new tb.a,{name:this.WYm,bool:this.lf.Jk}),Object.assign(new tb.a,{name:this.PGp,bool:this.Wbf})];
xg.a(this.Q7h,!1,void 0,fa)}return M}vxg(M){this.Wbf=M}}Object(u.a)(Mm,"ConvertToPPTActor",null,[]);var ys=d(46),di=d(526);class Vp extends di.a{constructor(){super();this.Error=this.Themes=null;this.H_=Object.assign(new bd.a,{T_:Vp.getTypeName(),B_:Vp.getBaseTypes()})}static getTypeName(){return"AugLoop_QuickStart_GetImageJsonResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Vp,"GetImageJsonResponse",di.a,[]);class zs extends di.a{constructor(){super();this.Error=this.DownloadUrl=
this.WebUrl=null;this.H_=Object.assign(new bd.a,{T_:zs.getTypeName(),B_:zs.getBaseTypes()})}static getTypeName(){return"AugLoop_QuickStart_GetSuggestionsJsonResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(zs,"GetSuggestionsJsonResponse",di.a,[]);class sp{constructor(M,fa,Va,Fb,Vb){this.OEg=this.fTf="";this.NPc=!0;this.rnf=this.wnf=null;this.Kwd=this.Mwd=0;this.uRc=!1;this.Jb=M;this.LC=fa;this.lf=Va;this.mKh=6E4;this.$Ga=Fb;this.ych=Vb}get iCg(){return this.NPc}set iCg(M){this.NPc=
M}get q$j(){return this.uRc}set q$j(M){this.uRc=M}hLl(){return this.ych.NFl(this.$Ga.q0j.map(M=>M.Xkp))}YRc(){if(this.lf.Jk)ci.L8a().heb(3,"Theme: No Internet");else{this.uRc=!1;this.wnf=new Gf.a(3,1,this.mKh,()=>{this.uRc||this.Kfd("Theme: Timeout")});this.Jb.$b(this.wnf);var M=this.hLl();this.Mwd=Date.now();this.LC.im().then(()=>{const fa=io.a.Nz();""!==this.fTf&&this.fTf?(fa.submitOperation(Object.assign(new qp.a,{operation:M})),Na.ULS.sendTraceTag(575488451,3020,50,"Signal sent for theme workflow")):
fa.activateAnnotation(Object.assign(new jn.a,{annotationType:Vp.getTypeName(),handler:Va=>{if(Va&&Va.items&&0<Va.items.length&&Va.items[0]&&Va.items[0].body){this.Jb.wf(this.wnf);const Fb=ci.L8a(),Vb=new H.a,wc=new H.a;Va=Va.items[0].body;xg.a("AugLoopThemeRequest",!0,Date.now()-this.Mwd);if(!this.uRc)if(Va.Error)this.Kfd("Theme: Error in annotation",Va.Error);else{for(const Xc of Va.Themes)this.$Ga.u_k(Xc.Thumbnail,Xc.ThemeMetadata),Vb.add(Xc.Thumbnail),wc.add(Xc.ThemeMetadata);0<Vb.count&&0<wc.count?
Fb.dVj(Vb.toArray(),wc.toArray()):this.Kfd("Theme: Different thumbnail and metadata count")}}}})).then(Va=>{fa.submitOperation(Object.assign(new qp.a,{operation:M}));Na.ULS.sendTraceTag(575488450,3020,50,"ThemeJsonAnnotation activated and signal sent");this.fTf=Va.token}).catch(Va=>{xg.a("AugLoopThemeRequest",!1,Date.now()-this.Mwd);this.Kfd("Theme: Failed to activate annotation. Error details: "+Va.toString())})}).catch(fa=>{xg.a("AugLoopThemeRequest",!1,Date.now()-this.Mwd);this.Kfd("Theme: RuntimeManager not ready. Error details: "+
fa.toString())})}}Ycf(M){if(this.lf.Jk)ci.L8a().heb(3,"Suggestion: No Internet");else{this.NPc=!0;this.rnf=new Gf.a(3,1,this.mKh,()=>{const Va=ci.L8a();this.NPc&&Va.heb(2,"Suggestion: Timeout")});this.Jb.$b(this.rnf);var fa=this.ych.fKl(M);this.Kwd=Date.now();this.LC.im().then(()=>{const Va=io.a.Nz();""!==this.OEg&&this.OEg?(Va.submitOperation(Object.assign(new qp.a,{operation:fa})),Na.ULS.sendTraceTag(575488453,3020,50,"Signal sent for suggestion workflow")):Va.activateAnnotation(Object.assign(new jn.a,
{annotationType:zs.getTypeName(),handler:Fb=>{if(Fb&&Fb.items&&0<Fb.items.length&&Fb.items[0]&&Fb.items[0].body){this.Jb.wf(this.rnf);const Vb=ci.L8a();Fb=Fb.items[0].body;xg.a("AugLoopPPTUrlRequest",!0,Date.now()-this.Kwd);this.NPc&&(Fb.Error?Vb.heb(2,"Suggestion: Error in annotation",Fb.Error):Fb.WebUrl&&""!==Fb.WebUrl&&F.a.GX(Fb.WebUrl)?(Na.ULS.sendTraceTag(587236548,3020,50,"AugLoop Suggestions workflow Load success"),Vb.f9o(Fb.WebUrl)):Vb.heb(2,"Suggestion: Non-linkable URL. Host name: "+ys.a.nU(Fb.WebUrl)))}}})).then(Fb=>
{Va.submitOperation(Object.assign(new qp.a,{operation:fa}));Na.ULS.sendTraceTag(575488452,3020,50,"SuggestionJsonAnnotation activated and signal sent");this.OEg=Fb.token}).catch(Fb=>{xg.a("AugLoopPPTUrlRequest",!1,Date.now()-this.Kwd);ci.L8a().heb(2,"Suggestion: Failed to activate annotation. Error details: "+Fb.toString())})}).catch(Va=>{xg.a("AugLoopPPTUrlRequest",!1,Date.now()-this.Kwd);ci.L8a().heb(2,"Suggestion: RuntimeManager not ready. Error details: "+Va.toString())})}}Kfd(M,fa=null){this.$Ga.isEmpty()?
ci.L8a().heb(1,M,fa):ci.L8a().dVj([],[])}}Object(u.a)(sp,"ConvertToPPTAugloopHelper",null,[861]);var Lq=d(1991);class Ak extends ko.a{constructor(){super();this.H_=Object.assign(new bd.a,{T_:Ak.getTypeName(),B_:Ak.getBaseTypes()})}static getTypeName(){return"AugLoop_QuickStart_GetThemesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(u.a)(Ak,"GetThemesSignal",ko.a,[]);class Jr extends ko.a{constructor(){super();this.Metadata=null;this.H_=Object.assign(new bd.a,{T_:Jr.getTypeName(),
B_:Jr.getBaseTypes()})}static getTypeName(){return"AugLoop_QuickStart_SelectedTheme"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(u.a)(Jr,"SelectedTheme",ko.a,[]);var Vo=d(883);class vq{NFl(M=[]){M=Object.assign(new Lq.ExcludeThemes,{ThemeMetadatas:M});return Object.assign(new Vo.a,{parentPath:["session",Lq.ExcludeThemes.getTypeName()],items:[Object.assign(new Lm.a,{body:M})]})}fKl(M){M=Object.assign(new Jr,{Metadata:M});return Object.assign(new Vo.a,{parentPath:["session",Jr.getTypeName()],
items:[Object.assign(new Lm.a,{body:M})]})}}Object(u.a)(vq,"ConvertToPPTAugloopSignalProvider",null,[]);class rr{constructor(M,fa){this.Xkp=fa}}Object(u.a)(rr,"ThemeInfo",null,[]);class om{constructor(){this.eOd=[]}get q0j(){return this.eOd}u_k(M,fa){this.eOd.push(new rr(M,fa))}reset(){this.eOd=[]}isEmpty(){return 0==this.eOd.length}}Object(u.a)(om,"ConvertToPPTThemeInfoContainer",null,[]);class qn{constructor(){this.actor=this.Z=null;this.mWn=(M,fa)=>{M=fa.fbl;M.isSuccess&&M.tokenType===dr.a.YLg?
(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("ConvertToPPT",!1)),this.actor.vxg(!0)):(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("ConvertToPPT",!0)),this.actor.vxg(!1))}}get name(){return"WordEditor.ConvertToPpt"}wc(M){this.Z=M;this.Z.ia("WordEditor.ConvertToPpt.ConvertToPPTThemeInfoContainer",()=>new om).ha();this.Z.ia("WordEditor.ConvertToPpt.ConvertToPPTAugloopSignalProvider",()=>new vq).ha();this.Z.ia("WordEditor.ConvertToPpt.IConvertToPPTAugloopHelper",
()=>new sp(z.AFrameworkApplication.pc,this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),Ve.SessionStatusManager.instance,this.Z.resolve("WordEditor.ConvertToPpt.ConvertToPPTThemeInfoContainer"),this.Z.resolve("WordEditor.ConvertToPpt.ConvertToPPTAugloopSignalProvider"))).ha();this.Z.ia("WordEditor.ConvertToPpt.ConvertToPPTActor",()=>new Mm(z.AFrameworkApplication.va,this.Z.resolve("WordEditor.ConvertToPpt.IConvertToPPTAugloopHelper"),z.AFrameworkApplication.J,z.AFrameworkApplication.pc,Ve.SessionStatusManager.instance,
this.Z.resolve("WordEditor.Actors.WordFileSaveAsActor"),this.Z.resolve("WordEditor.ConvertToPpt.ConvertToPPTThemeInfoContainer"))).ha()}init(){this.actor=this.Z.resolve("WordEditor.ConvertToPpt.ConvertToPPTActor");this.actor.Xb();Up.c()&&this.actor.hzf()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("ConvertToPPT",!1));z.AFrameworkApplication.J.$("IsAnonymousUser")||(Tc.a.MSd.LHf.then(M=>{M.isSuccess&&M.tokenType===dr.a.YLg||(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("ConvertToPPT",
!0)),this.actor.vxg(!1))}),Tc.a.MSd.i2k(this.mWn))}dispose(){}static main(){x.a.instance.Mc(new qn);Na.ULS.sendTraceTag(575488449,3020,50,"Convert to PPT package has been loaded.")}}Object(u.a)(qn,"PackageManager",null,[0,1]);var as=d(1365),pm=d(1299),oj=d(179),Uf=d(85),si=d(222),$l=d(93),Wp=d(1578),$f=d(1579),co=d(549);class ji{constructor(M,fa,Va){this.jmf=this.hW=null;this.aW=!1;this.show=()=>{this.WJ&&this.dismiss();this.lf.Jk&&(kf.UISurfaces.uL().then(Fb=>{var Vb=Object.assign(new Wp.a,{target:"[data-unique-id=QueryNetworkConnectionStatus]",
title:this.jmf,content:this.XTd,showCloseIcon:!0,preventLightDismiss:!0,calloutProps:Object.assign(new $f.a,{onDismiss:()=>{this.dismiss()},preventDismissOnScroll:!0,preventDismissOnLostFocus:!0})});Vb=Fb.callout(Vb);const wc=Object.assign(new co.a,{onShow:()=>{this.aW=!0},expirationOptions:null});this.hW=Fb.addNotification(Vb,wc);this.Iw.sendNotification(this.XTd,!1);return null}),this.dja&&this.dja.IXa(587790340,3036,50),Na.ULS.sendTraceTag(587790340,3036,50,"Emergency Mode Callout Show: "+(new Date).getTime().toString()))};
this.XTd="";this.dja=M;this.Jb=fa;this.lf=Va}get Iw(){return null!=this.WRg?this.WRg:this.WRg=fd.a.instance.resolve("Common.Utils.IAriaNotifier")}get WJ(){return this.aW}KDl(){this.GLe=new Gf.a(4,1,500,this.show,180);this.Jb.$b(this.GLe)}bRl(){this.GLe&&this.Jb.wf(this.GLe)}dismiss(){this.WJ&&this.hW&&(kf.UISurfaces.uL().then(M=>{M.removeNotification(this.hW);this.aW=!1;return null}),this.dja&&this.dja.IXa(587790341,3036,50),Na.ULS.sendTraceTag(587790341,3036,50,"Emergency Mode Callout Dismiss: "+
(new Date).getTime().toString()))}}Object(u.a)(ji,"ReactOfflineModalCallOutControl",null,[969]);var tp=d(1282),Hn=d(484);class nk{constructor(M,fa,Va){this.oe=this.jCb=this.XFh=null;this.xHd=this.wHd=0;this.ixp=(Fb,Vb,wc,Xc,vd)=>{if(1===wc)return 32;vd[tp.a.Visible]=this.kFb;vd[tp.a.Value]=this.SLc;vd[mf.a.labelText]=vd[tp.a.Value];vd[mf.a.customTooltip]=this.SLc;return 32};this.yme=Fb=>{if(!Fb)return!1;if(Fb.znc||Fb.Sfa||Fb.LXi)return!0;if(!Fb.Lb)return!1;Fb=Fb.Lb;const Vb=Fb.rawEvent;if(Fb.ctrlKey||
Fb.altKey||Vb.metaKey)return!0;Fb=Fb.keyCode;if(Fb==xh.a.pFe||Fb==xh.a.fBc)return!0;if(xh.a.cfn(Fb)||Fb in nk.tZl)this.wHd+=1,this.a5.WJ&&(this.xHd+=1);return!0};this.pdo=()=>{this.lf.Jk||(this.kFb=!1,this.SLc="",this.elb.execute(Fb=>{Fb.aV(Hn.a.Bag)}))};this.Bdd=Fb=>{if(this.MBh)switch(Fb.mode){case 2:this.lf.Jk&&Uf.Health.instance.recordKpiFailure("ToggleEmergencyViewMode","Toggle to Edit Failed",!1,!1,null);break;case 1:this.lf.Jk||Uf.Health.instance.recordKpiFailure("ToggleEmergencyViewMode",
"Toggle to Reading Failed",!1,!1,null);break;default:Uf.Health.instance.recordKpiFailure("ToggleEmergencyViewMode","Unexpected Mode reached",!1,!1,null)}};this.elb=fd.a.instance.Ta("WordEditor.IStatusBarUser");this.Xb();this.SLc="";this.MBh=this.kFb=!1;this.elb.execute(Fb=>{Fb.aV(Hn.a.Bag)});this.kXe=z.AFrameworkApplication.qw;this.Jb=fa;this.lf=M;this.a5=Va;z.AFrameworkApplication.ua&&z.AFrameworkApplication.ua.A5a(this.Bdd)}Xb(){z.AFrameworkApplication.va.fb(Ci.a.zng,rb.a.application,this.ixp,96)}f1j(M){this.lf.Jk!==
M&&(Uf.Health.instance.recordKpiUsage("ToggleEmergencyViewMode",0,nk.UB,null),z.AFrameworkApplication.$c("WordEditorEmergencyViewEnhancement;WordEditorEmergencyViewEnhancementcf"),z.AFrameworkApplication.$c("EmergencyViewKickoutOnReplicationFailureDuringReconnect;EmergencyViewKickoutOnReplicationFailureDuringReconnectcf"),this.MBh=!0,(this.lf.Jk=M)?(this.TEe(!0,1),this.XFh=new Date,z.AFrameworkApplication.fh.sKn()):(this.TEe(!1,2),Na.ULS.sendTraceTag(571283100,3036,50,"Total Time in Emergency View :"+
(+new Date-+this.XFh).toString())))}TEe(M,fa){M&&(this.kXe=z.AFrameworkApplication.qw);U.StaticActiveAppFrame.za()&&(this.kXe||(z.AFrameworkApplication.qw=M,U.StaticActiveAppFrame.za().N8(fa)),U.StaticActiveAppFrame.za().kb.Gw&&U.StaticActiveAppFrame.za().kb.Gw.vj&&U.StaticActiveAppFrame.za().kb.Gw.mUf(),U.StaticActiveAppFrame.za().Ge(),null==this.jCb&&(this.jCb=document.getElementById("EditorContainer")),null==this.oe&&(this.oe=U.StaticActiveAppFrame.za().YE),null!=this.jCb&&null!=this.oe&&(1==fa?
(this.xHd=this.wHd=0,this.oe.ub($c.a.ij,this.jCb,this.yme),this.oe.ub($c.a.gi,this.jCb,this.yme)):(this.oe.xc($c.a.ij,this.jCb,this.yme),this.oe.xc($c.a.gi,this.jCb,this.yme))))}n2b(M,fa){this.kFb=M;this.SLc=fa;this.elb.execute(Va=>{Va.aV(Hn.a.Bag)})}ntj(){this.JDl()}JDl(){const M=new Gf.a(4,1,7E3,this.pdo,178);this.Jb.$b(M)}Zbd(){const M={};M.statusVisible=this.kFb.toString();M.statusLabel=this.SLc;M.isProtectDocumentEnabled=this.kXe.toString();M.isEmergencyView=this.lf.Jk.toString();return Hf.c(M)}get tUn(){return this.wHd}get uUn(){return this.xHd}}
nk.UB="wwrelfc";nk.tZl=[xh.a.cMg,xh.a.F$j,xh.a.eBc,xh.a.rFe,xh.a.aMg,xh.a.oFe,xh.a.bMg,xh.a.qFe,xh.a.H$j,xh.a.J4,xh.a.I4,xh.a.JD,xh.a.Pu,xh.a.B0a];Object(u.a)(nk,"WordEditorEmergencyViewActor",null,[]);class ej{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd=null,Dd=null){this.uk=null;this.ZDd=!1;this.lT=null;this.Tia=!1;this.BBh=this.Czh=10;this.rac=null;this.s8e=this.nac=this.qXe=!1;this.dOc=this.xQe=0;this.rPe=this.clb=!1;this.dHc=this.zHd=0;this.Vpk=3500;this.j8b=!1;this.Muk="Callout";this.rga=(Ce,ea)=>{this.lf.$o?
this.Ihe("OnAppNetworkChanged"):(Ce=ea.$rc,ea=ea.zbb,Ce===ea||1===Ce&&3===ea||(this.a5.WJ&&this.a5.dismiss(),this.oId="Network:"+as.a[ea],this.lf.Jk?(this.rej(ea),this.RUd()):this.zIg()))};this.F_=(Ce,ea)=>{this.lf.$o?this.Ihe("OnAppVisibilityChanged"):(Ce=0===ea.newState||1===ea.newState,z.AFrameworkApplication.Fqd||(Ce&&(this.oId="Visibility:"+pm.a[ea.newState],this.lf.Jk?this.RUd():this.zIg()),ea.newState||(this.ZDd&&(this.qda.ntj(),this.ZDd=!1),!this.BIb||z.AFrameworkApplication.Wde||this.j8b||
(this.Jb.$b(this.W7e),this.j8b=!0))),0!==ea.newState&&1!==ea.newState||this.clb||(this.O8e=new Date,this.clb=!0))};this.qdo=()=>{let Ce=!1;this.lf.$o?(this.Ihe("Poll Viability"),Ce=!0,this.BIb=!1,this.a5.WJ&&this.a5.dismiss(),this.qda.n2b(!0,WordEditorIntl.WordEditorStrings.L_NetworkStatusLabelDisconnected),this.bnd("Kicked Out"),this.gwe(!1,"Kicked Out")):this.GBa?(Ce=!0,this.bnd("Network Disconnected")):this.Dye()?(this.Jqc(),this.$ze(),this.qBj(),Ce=!0):(this.uk.isVisible&&!this.clb&&(this.O8e=
new Date,this.clb=!0),this.Jqc(),this.xoh&&(this.xoh=!1),this.z3e+=1,this.kta()&&!this.JFd&&(this.J0h(),this.$ze()),this.yGn());this.Tia&&Ce&&(this.Tia=!1,this.Jb.wf(this.wEc),Na.ULS.sendTraceTag(574395792,3036,50,"Stop Polling for EV"))};this.t0=()=>{this.jYj();this.Tia&&(this.Tia=!1,this.Jb.wf(this.wEc),Na.ULS.sendTraceTag(561551376,3036,50,"Stop Polling for EV"),this.bnd("Kicked Out"),this.gwe(!1,"Kicked Out"));this.qda.n2b(!1,"")};this.m7o=()=>{this.BIb&&0===this.uk.vA?(this.a5.KDl(),this.rPe=
!0,this.BIb=!1,this.uvf()):this.BIb||this.uvf()};this.P7j=(Ce,ea)=>{ea?(Ce=ea.httpStatusCode,oj.a.Mce(Ce)||oj.a.qfe(Ce)?Na.ULS.sendTraceTag(556119906,3036,15,String.format("Failed updating last successful replication time - {0} - EV State - {1} ShouldTriggerEv - {2}",Ce,this.lf.Jk,this.xTj())):Ce!==oj.a.qz||ea.$j||(this.a3a=this.lT.Nad(),this.lf.Jk&&this.eXi&&(ea=this.Dye(),Na.ULS.sendTraceTag(573899224,3036,50,String.format("In Ev and Updating last successful replication time - {0}. Viability state to release EV {1}",
Ce,ea)),this.QZd(),this.Jqc()))):Na.ULS.sendTraceTag(573899221,3036,50,"Failed updating last successful replication time - Event Args are null")};this.Lma=()=>{this.lf.hba||(this.s8e=!1,Na.ULS.sendTraceTag(571269952,3036,50,String.format("New Access Token Received, EV state: {0}",this.qda.Zbd())),this.lf.Jk&&this.eXi&&(this.Jqc(),Na.ULS.sendTraceTag(556119907,3036,50,"Time taken to perform token refresh:"+(+new Date-+this.rac).toString()),this.$ze(),this.QZd()))};this.lf=M;this.Fz=fa;this.Jb=Va;this.dja=
Fb;this.K1=Vb;this.lT=Dd;this.Qpa=Xc;this.D8b=wc;this.H9=new Map;this.wQ=new Map;vd.execute(Ce=>this.yi=Ce);this.$A();this.a5=new ji(Fb,Va,this.lf);this.qda=new nk(this.lf,Va,this.a5);this.BIb=!1;this.tOk=7;this.BBh=this.Czh=10;this.a3a=new Date;this.JFd=!1;this.wEc=new Gf.a(4,2,1E3*this.Czh,this.qdo,179);this.W7e=new Gf.a(4,2,this.Vpk,this.m7o,180)}$A(){this.lf.Zlb(this.rga);this.lf.AHa(this.t0);this.Fz.execute(M=>{this.uk=M;this.uk.BHa(this.F_)});this.K1&&this.K1.execute(M=>{M.gTa(this.Lma);M.Aff((fa,
Va)=>{(this.aZe=Va)&&3E4<Va.hdo&&(this.lf.Jk||(this.oId="TokenRefreshPolling",this.zIg(),this.RUd()),this.s8e||(this.s8e=!0,fa={},fa["Network State"]=this.GBa?"Disconnected":"Connected",fa["Visibility State"]=this.uk?pm.a[this.uk.vA]:"_visibilityMananger is null",fa["Replication State"]=this.kta()?"Pending":"UpToDate",fa["Replication Pending Time"]=this.a3a.toString(),fa["Kicked Out"]=this.lf.$o.toString(),fa["EmergencyView State"]=this.qda.Zbd(),fa["App Idle State"]=z.AFrameworkApplication.kma.toString(),
fa.HasEVBeenDeployed=this.lf.Jk.toString(),Na.ULS.sendTraceTag(542732697,3036,50,"Detected a slow token refresh. Application status: "+Hf.c(fa))))})});this.lT&&(Na.ULS.sendTraceTag(573895435,3036,50,String.format("Replicator used in EV {0}",this.lT.Tta)),this.lT.tcc(this.P7j));U.StaticActiveAppFrame.za()&&U.StaticActiveAppFrame.za().uS&&U.StaticActiveAppFrame.za().uS.ub(1,()=>{this.lf.Jk&&this.Tia&&(Na.ULS.sendTraceTag(557167392,3036,50,"User is trying to navigate away while in Emergency View : "+
this.qda.Zbd()),this.bnd("User Navigated Away"),this.gwe(!1,"User Navigated Away"))},null)}r5i(){Uf.Health.instance.recordKpiSuccess("ForceFetchLastSavedRevisionId",null);this.Jqc();this.QZd();this.JFd=!0}get GBa(){return 1===this.lf.networkState||3===this.lf.networkState}get eXi(){return this.Tia}kta(){if(this.lT){const M=+new Date-+this.a3a>6E4*this.BBh;return this.lT.kta()&&M}return!1}xTj(){return this.lf.Jk||this.uk&&!this.uk.isVisible?!1:this.GBa||!this.lf.XBa||this.kta()?!0:!1}Dye(){return this.GBa||
!this.lf.XBa||this.kta()&&!this.JFd?!1:!0}KUi(){return!!this.uk&&!this.uk.vA}$ze(){if(!this.lf.XBa||this.GBa)Na.ULS.sendTraceTag(556896707,3036,50,"Not speeding replication - Network State: {0} Token Expired: {1} IsViable: {2} ",this.GBa,this.lf.hba,this.lf.XBa);else if(this.lT&&!this.nac){this.lT.Xkd();this.nac=!0;const M=this.lT.Zzf();Na.ULS.sendTraceTag(571269923,3036,50,"EV is speeding inbound replication - Inbound State Pending : {0}",M)}}RUd(){this.Dye()?(this.Tia?this.Jqc():(this.rac=new Date,
this.clb=!1),this.QZd()):3==this.uk.vA?this.Tia&&(this.bnd("Browser frozen"),this.Jb.wf(this.wEc),this.Tia=!1):2!==this.uk.vA&&(this.Bol(),this.J0h(),this.$ze())}qyc(){this.Tia||(this.xoh=!0,this.z3e=0,this.aZe=null,this.rac=new Date,this.nac=this.qXe=!1,this.zHd+=1,Na.ULS.sendTraceTag(524162444,3036,50,"Ensuring App is awake if not already."),z.AFrameworkApplication.Xji(),this.Jb.$b(this.wEc),this.Tia=!0,this.clb=!1,this.uk.isVisible&&(this.O8e=new Date,this.clb=!0),this.wQ=new Map,this.wQ.set("EmergencyViewVersion",
"1.x."+this.xQe),this.dOc+=1,this.wQ.set("EVReconnectAttemptCount",this.dOc.toString()),this.wQ.set("HasTokenExpired",this.lf.hba.toString()),this.wQ.set("IsTokenExpiring",0<z.AFrameworkApplication.Gz?si.a.instance.rfe(z.AFrameworkApplication.Gz,z.AFrameworkApplication.l5a).toString():"Token is invalid"),this.wQ.set("ReplicationPending",this.kta().toString()),this.wQ.set("VisibilityState",this.uk?pm.a[this.uk.vA]:"visibilityMananger is null"),this.wQ.set("ReasonInEV",this.TEi()),this.wQ.set("OriginatingEvent",
this.oId),this.wQ.set("EmergencyViewIdentifier",this.dHc.toString()),Uf.Health.instance.recordKpiUsage("WordEditorEmergencyViewReconnect",1,ej.UB,this.wQ),Uf.Health.instance.recordKpiUsage("WordEditorEmergencyViewSlowReconnect",0,ej.UB,this.wQ))}Bol(){!this.lf.Jk||this.GBa||this.lf.$o||this.qyc()}J0h(){if(!this.GBa&&!this.lf.$o){const M=new Map;Uf.Health.instance.recordKpiUsage("ForceFetchLastSavedRevisionId",1,ej.UB,M);this.D8b.Dic().then(()=>{this.r5i()}).catch(async fa=>{1===fa?(Na.ULS.sendTraceTag(522303692,
3036,50,"Retrying to get Last Saved To Host Details"),Uf.Health.instance.recordKpiFailure("ForceFetchLastSavedRevisionId","Retrying to get Last Saved To Host Details",!1,!1,null),Uf.Health.instance.recordKpiUsage("ForceFetchLastSavedRevisionId",1,ej.UB,M),this.D8b.Dic().then(()=>{this.r5i()}).catch(()=>{Na.ULS.sendTraceTag(521414157,3036,50,"Not retrying to get LastSavedToHostDetails since we have already retried.");Uf.Health.instance.recordKpiFailure("ForceFetchLastSavedRevisionId","Not retrying to get LastSavedToHostDetails since we have already retried.",
!1,!1,null)})):(Na.ULS.sendTraceTag(521474209,3036,50,"Not Retrying to get LastSavedToHostDetails since retry strategy is {0}",fa.toString()),Uf.Health.instance.recordKpiFailure("ForceFetchLastSavedRevisionId",String.format("Not retrying to get LastSavedToHostDetails since retry strategy is {0}",fa.toString()),!1,!1,null))})}}rej(M){let fa="";switch(M){case 1:fa=WordEditorIntl.WordEditorStrings.L_NetworkStatusLabelDisconnected;break;case 3:case 2:case 0:fa=WordEditorIntl.WordEditorStrings.L_NetworkStatusLabelReconnecting}this.qda.n2b(!0,
fa)}zIg(){if(this.lf.$o)this.Ihe("Trigger EV");else if(this.xTj()){this.nac=this.JFd=!1;this.BIb=!0;this.zHd=0;this.dHc+=1;this.rPe=!1;this.JOk=new Date;const M=this.lf.networkState;this.rej(M);this.qda.f1j(!0);this.nzl();Uf.Health.instance.recordKpiUsage("WordEditorEmergencyView",1,ej.UB,this.H9);this.a5.WJ&&this.a5.dismiss();const fa=this.hasPendingChanges()||this.KZm();this.NSl(M,fa);!this.KUi()||z.AFrameworkApplication.Wde||this.j8b||(this.Jb.$b(this.W7e),this.j8b=!0);this.GBa&&this.dja&&this.dja.IXa(575944902,
3036,50);this.baj();this.RUd()}}NSl(M,fa){1===M?(this.a5.jmf=WordEditorIntl.WordEditorStrings.L_NetworkStatusCallOutTitleCheckConnection,this.a5.XTd=fa?WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextNotSaved+" "+WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextReconnectToInternet:WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextSaved+" "+WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextReconnectToInternet):(this.a5.jmf=WordEditorIntl.WordEditorStrings.L_NetworkStatusCallOutTitleEnsureViable,
this.a5.XTd=fa?WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextPleaseWait+" "+WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextNotSaved:WordEditorIntl.WordEditorStrings.L_EmergencyViewCallOutTextSaved)}uvf(){this.j8b&&(this.Jb.wf(this.W7e),this.j8b=!1)}jYj(){this.BIb=!1;this.a5.bRl();this.a5.WJ&&this.a5.dismiss();this.uvf()}QZd(){this.Dye()&&(this.qBj(),this.Tia&&(this.Jb.wf(this.wEc),this.Tia=!1,Na.ULS.sendTraceTag(574395792,3036,50,"Stop Polling for EV")))}qBj(){this.jYj();
this.qda.f1j(!1);this.qda.n2b(!0,WordEditorIntl.WordEditorStrings.L_NetworkStatusLabelConnected);if(this.Tia){const M=(+new Date-+this.rac).toString();let fa="0";this.clb&&(fa=(+new Date-+this.O8e).toString());this.wQ.set("ReconnectTime",M);this.wQ.set("ReconnectTimeSinceActive",fa);this.wQ.set("EVReconnectAttemptCount",this.dOc.toString());Uf.Health.instance.recordKpiSuccess("WordEditorEmergencyViewReconnect",Object.assign(new $l.a,{extendedProperties:this.wQ}));Na.ULS.sendTraceTag(574423244,3036,
50,"Time from reconnecting to connected is "+M)}this.gwe(!0);this.ZDd=!0;this.baj();this.KUi()&&(this.qda.ntj(),this.ZDd=!1)}Jqc(){if(+new Date-+this.rac>1E3*this.tOk&&!this.qXe){Na.ULS.sendTraceTag(573179203,3036,50,"Detected a slow reconnect.");const M=this.H9.get("ReasonGoingIntoEV");Uf.Health.instance.recordKpiFailure("WordEditorEmergencyViewSlowReconnect",M,!1,!1,null);Uf.Health.instance.recordQosError("SlowReconnect_"+M,["LimitedInteractivity"],!1,!1,!1,!1,null);this.qXe=!0}}baj(){const M={};
M["Network State"]=this.GBa?"Disconnected":"Connected";M["Visibility State"]=this.uk?pm.a[this.uk.vA]:"_visibilityMananger is null";M["Replication State"]=this.kta()?"Pending":"UpToDate";M["Replication Pending Time"]=this.a3a.toString();this.lT&&(M["Is Replication State Pending"]=this.lT.kta());M["Session Viability"]=this.lf.XBa.toString();M["EmergencyView State"]=this.qda.Zbd();M["App Idle State"]=z.AFrameworkApplication.kma;M["Has Sped Up Replication"]=this.nac.toString();Na.ULS.sendTraceTag(575944902,
3036,50,Hf.c(M))}yGn(){var M={};M["Network State"]=this.GBa?"Disconnected":"Connected";M["Session Viability"]=this.lf.XBa.toString();M["Replication Pending Time"]=this.a3a.toString();this.lT&&(M["Is Replication State Pending"]=this.lT.kta());M["Has Sped Up Replication"]=this.nac.toString();this.lf.hba&&this.aZe&&(M["Last Known Token Refresh Poll State"]=this.aZe.K3a);M["Polling Attempt"]=this.z3e;M=Hf.c(M);Na.ULS.sendTraceTag(574395793,3036,50,M);this.O5f(M)}O5f(M){if(window.console&&window.console.log){const fa=
new Date;window.console.log(`(${fa.toTimeString()}:${fa.getMilliseconds()}) ${M}`)}}bnd(M){this.wQ.set("ReconnectTime",(+new Date-+this.rac).toString());this.wQ.set("EmergencyViewVersion","1.x."+this.xQe);this.wQ.set("EVReconnectAttemptCount",this.dOc.toString());this.wQ.set("EmergencyViewState",this.qda.Zbd());this.wQ.set("EmergencyViewIdentifier",this.dHc.toString());Uf.Health.instance.recordKpiFailure("WordEditorEmergencyViewReconnect",M,!1,!1,Object.assign(new $l.a,{extendedProperties:this.wQ}))}gwe(M,
fa=null){this.H9.set("EmergencyViewVersion","1.x."+this.xQe);this.H9.set("TimeInEV",(+new Date-+this.JOk).toString());this.H9.set("NoOfReconnectsAttempted",this.zHd.toString());this.H9.set("NoOfAttemptsToEditDocument",this.qda.tUn.toString());this.H9.set("DidShowCallout",this.rPe.toString());this.H9.set("NoOfAttemptsToEditDocumentWhileMessageWasVisible",this.qda.uUn.toString());M?Uf.Health.instance.recordKpiSuccess("WordEditorEmergencyView",Object.assign(new $l.a,{extendedProperties:this.H9})):Uf.Health.instance.recordKpiFailure("WordEditorEmergencyView",
fa,!1,!1,Object.assign(new $l.a,{extendedProperties:this.H9}))}Ihe(M){Na.ULS.sendTraceTag(543429713,3036,50,"The client has already been kicked out, not performing {0} action",M)}hasPendingChanges(){let M=!1;this.Qpa&&(M=!this.Qpa.TR);return M}KZm(){return this.yi&&this.yi.$y?!0:!1}nzl(){this.H9=new Map;this.H9.set("CalloutType",this.Muk);this.H9.set("HasPendingChanges",this.hasPendingChanges().toString());this.H9.set("OriginatingEvent",this.oId);this.H9.set("ReasonGoingIntoEV",this.TEi());this.H9.set("EmergencyViewIdentifier",
this.dHc.toString())}TEi(){return this.GBa?"NetworkDisconnected ":this.lf.hba?"WaitingForTokenRefresh":this.kta()?"PendingReplication":""}dispose(){this.lf.Erg(this.rga);this.uk.Kte(this.F_);this.lT&&this.lT.Ikd(this.P7j);this.K1&&this.K1.execute(M=>{M.mZb(this.Lma)})}static yum(){let M=null;if(U.StaticActiveAppFrame.za()&&U.StaticActiveAppFrame.za().kb){const fa=U.StaticActiveAppFrame.za().kb.hd;fa&&(M=fa.Ag)}return M}static get instance(){return null!=ej.fYg?ej.fYg:ej.fYg=new ej(fd.a.instance.Oa("Common.ISessionStatus")||
Ve.SessionStatusManager.instance,fd.a.instance.Ta("Common.App.VisibilityManagement.IVisibilityManager"),z.AFrameworkApplication.pc,z.AFrameworkApplication.bCe,fd.a.instance.Ta("Common.ISessionExpirationManager"),fd.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"),fd.a.instance.Oa("Box4.Revision.RevisionSequenceNumberManager"),fd.a.instance.Ta("WordEditor.Comments.IEditorCommentModel"),ej.yum())}}ej.UB="wwrelfc";Object(u.a)(ej,"WordEditorOfflineManagerV2",null,[860,10]);class Wo{constructor(){this.FHd=
this.Z=null}get name(){return"WordEditor.EmergencyView"}wc(M){this.Z=M;this.FHd=ej.instance;this.Z.ia("WordEditor.IWordEditorOfflineManager",()=>this.FHd).ha()}init(){this.Z.Oa("WordEditor.IWordEditorOfflineManager")}dispose(){this.FHd&&this.FHd.dispose()}static main(){x.a.instance.Mc(new Wo)}}Object(u.a)(Wo,"EmergencyViewPackage",null,[0,1]);var Ki=d(1791),kk=d(1221),kn=d(1222);class bs{constructor(M,fa){this.ga=M;this.N4=fa}Xb(){try{this.ga.fb(Ci.a.Qng,bo.a.frame,this.N4.e$d,1028),this.ga.fb(Ci.a.QBg,
rb.a.view,this.N4.h$d,1028),this.ga.qa(Ci.a.l$a,rb.a.view,this.N4.a$d),this.ga.qa(Ci.a.l$a,rb.a.Vc,this.N4.$9d),this.ga.qa(Ci.a.inputEquationLoaded,rb.a.view,this.N4.Z9d),this.ga.qa(Ci.a.y4f,rb.a.view,this.N4.c$d),this.ga.qa(Ci.a.jvg,rb.a.view,this.N4.f$d),this.ga.qa(Ci.a.xif,rb.a.view,this.N4.T9d),this.ga.Pc(Ci.a.l$a,1028)}catch(M){Na.ULS.sendTraceTag(545043224,kk.a.Hba,kn.a.error,"Registering actions failed",M.message)}}mfb(){this.ga.Fy(Ci.a.Qng,bo.a.frame,this.N4.e$d);this.ga.Fy(Ci.a.QBg,bo.a.frame,
this.N4.h$d);this.ga.Fy(Ci.a.l$a,rb.a.view,this.N4.a$d);this.ga.Fy(Ci.a.l$a,rb.a.Vc,this.N4.$9d);this.ga.Fy(Ci.a.inputEquationLoaded,rb.a.view,this.N4.Z9d);this.ga.Fy(Ci.a.y4f,rb.a.view,this.N4.c$d);this.ga.Fy(Ci.a.jvg,rb.a.view,this.N4.f$d);this.ga.Fy(Ci.a.xif,rb.a.view,this.N4.T9d)}dispose(){this.N4=this.ga=null}}Object(u.a)(bs,"EquationToolsActionDelegator",null,[1040,10]);var ln=d(1514),wq=d(1515);class qm{constructor(){this.structures=this.symbols=""}}Object(u.a)(qm,"EquationToolsRoamingListSettings",
null,[1061]);class mo extends ln.a{constructor(M,fa,Va,Fb,Vb){super(M,fa,Va,Fb,Vb);this.cIc="getEquationToolsSettings";this.D$b="saveEquationToolsSettings";this.O8b="EquationToolsRoamingListSettingsChangedEvent";this.SFb=["Symbols","Structures"];this.v$="Word Equation Tools";this.Akb=zg.a.vNg}async rUo(M){this.Mi||(this.Mi=new qm);this.Mi=M;this.wmd()}get dgc(){return new qm}ncc(){return["Symbols",this.Mi.symbols,"Structures",this.Mi.structures]}mcc(){return{["Symbols"]:this.PZ(this.Mi.symbols),["Structures"]:this.PZ(this.Mi.structures)}}async Bld(M){const fa=
this.PZ(this.Mi.symbols).localeCompare(M.symbols);M=this.PZ(this.Mi.structures).localeCompare(M.structures);return 0!==fa||0!==M}NXc(){return new wq.a}Kgd(M){return{symbols:M.Symbols,structures:M.Structures}}}Object(u.a)(mo,"EquationToolsRoamingListSettingsHandler",ln.a,[]);var no=d(768),Io;(function(M){M[M.qeq=0]="noRender";M[M.jrq=2]="view_NoPageLayoutChange";M[M.view=3]="view";M[M.thq=4]="persistenceOnly";M[M.Ypq=8]="undoActionOnly";M[M.shq=7]="persistence";M[M.Y4j=15]="undoAction"})(Io||(Io={}));
Object(u.b)("TransactionType",Io);var Nl=d(1372),nl=d(148),Ol=d(115),cs=d(298),ds=d(125),Nk;(function(M){M[M.POa=1]="unsupportedObject";M[M.B7c=2]="ink";M[M.P5p=3]="inkSpace";M[M.M5p=4]="inkEndOfLine";M[M.image=5]="image";M[M.pAn=6]="lineBreak";M[M.e1c=7]="footnoteEndnote";M[M.fcb=8]="pageBreak";M[M.Aqj=9]="pageNumbers";M[M.g2p=10]="footnoteEndnoteReferenceMark";M[M.U2l=11]="equationObject";M[M.tab=12]="tab"})(Nk||(Nk={}));Object(u.b)("BlobObjectType",Nk);var er=d(1004),es=d(75),up=d(1380),Wl=d(2033);
class Jo{constructor(M,fa,Va,Fb,Vb,wc,Xc,vd,Dd,Ce,ea,Xa,yb,Ub,yc){this.ib=null;this.eF=M;this.ib=Va;this.yoa=fa;this.Rc=Fb;this.fd=Vb;this.ZGc=wc;this.pLc=Xc;this.xl=vd;this.ga=Dd;this.Vn=Ce;this.QLk=ea;this.Qp=Ub;this.ygh=new mo(this.QLk,Xa,yb,new Be.a,yc);this.e$d=this.e$d.bind(this);this.h$d=this.h$d.bind(this);this.a$d=this.a$d.bind(this);this.$9d=this.$9d.bind(this);this.Z9d=this.Z9d.bind(this);this.c$d=this.c$d.bind(this);this.f$d=this.f$d.bind(this);this.T9d=this.T9d.bind(this)}e$d(M,fa,Va,
Fb,Vb){Vb&&(Vb[me.a.On]=this.eF.isVisible);return 32}h$d(M,fa,Va){var Fb,Vb;if(1==Va)return no.a.iba(fa)?(this.eF.isVisible&&this.eF.hide(),2):fa.contextId===rb.a.view&&(null===(Fb=fa.view)||void 0===Fb?0:Fb.ve)&&(M=null===(Vb=fa.view.lb)||void 0===Vb?void 0:Vb.Pg)&&(this.xl.p2(M)||this.xl.ama(M))?8:32;try{const wc=this.Qal(fa),Xc=this.eF.isVisible&&!wc;wc&&this.eF.isVisible&&xg.a("LoadOrBuildupWhileEquationToolsPaneIsOpen");Xc?(this.eF.hide(),xg.a("HideEquationToolsPane")):this.eF.show();Wl.b.fCc()&&
(Xc?Wl.b.Cse(Wl.a.nPg):Wl.b.Cse(Wl.a.DQg))}catch(wc){return Na.ULS.sendTraceTag(545043213,kk.a.Hba,kn.a.error,"ShowHideEquationToolsPane failed",wc.message),8}return 32}a$d(M,fa,Va,Fb,Vb){Va=null;fa.view.ve&&(Va=fa.view);if(!Va||!Va.lb)return Na.ULS.sendTraceTag(545043214,kk.a.Hba,kn.a.info,"The context passed in was {0} which does not contain a selection manager",fa.toString()),8;var wc=Va.lb.Pg;if(!wc||this.xl.p2(wc))return 8;if(Va.lb.gb.GL||this.Vn&&this.Vn.instance&&this.Vn.instance.zX(wc))return 2;
const Xc=df.a.mf(wc);let vd=!0;wc=8;const Dd=this.Rc.Lc(Io.Y4j);Dd.Ab(Va.vd);Zb.a.Nod&&(Dd.Ph=M);Xc||(wc=this.ga.Hf(fa,Q.a.Bra,2,!0,Fb,null),M=32===wc,Na.ULS.shipAssertTag(545043215,kk.a.Hba,M,"DeleteForReplace did not succeed. Response is {0}",wc),vd=M);vd&&(M=Va.lb.Pg,fa=df.a.mf(M),Na.ULS.shipAssertTag(545043216,kk.a.Hba,fa,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",M.contextId),wc=8,fa&&(wc=this.ga.Hf(M,Ci.a.l$a,2,!1,Fb,Vb),Na.ULS.shipAssertTag(545043217,kk.a.Hba,
32===wc,"Insertion at IP context did not succeed. Response is {0}",wc),32===wc&&(cf.FocusManager.instance().Gg(Va.nL),xg.a("InsertEquationWithSelection",!0))));Dd.dispose();return wc}$9d(M,fa,Va,Fb,Vb){if(1===Va)return 32;if(df.a.B$a(fa))return Na.ULS.sendTraceTag(545043218,kk.a.Hba,kn.a.info,"Insertion with InsertionPoint attempted with selected Blob or Image"),2;const wc=fa.node;M=null;Va=new Nl.a;M=new nl.a(wc.ra.last,lo.a.create());Va.Uwc(M,!0);const Xc=new Ol.a;Xc.setValue(Nf.a.Mca,!0);Xc.setValue(dg.a.Tki,
22);Xc.setValue(dg.a.jt,cs.a.eLn);Xc.setValue(dg.a.V2l,!0);const vd=wc.node.Hc.hu(Xc,lo.a.create());this.eF.Jdb(0);const Dd=Vb.EquationLatex;if(!Dd)return 8;Vb=er.a.construct(up.a.F5i,Dd,null);const Ce=this.pLc.KWc(Vb);Ce.continueWith(ea=>{if(Ce.Yi)this.eF.Jdb(1),Na.ULS.sendTraceTag(545043219,kk.a.Hba,kn.a.warning,"Insertion failed, could not convert LaTeX equation to OMML"),xg.a("InsertEquation",!1);else{var Xa=new Gf.a(2,1,0,()=>{const yb=ea.result.response.PostConversionMathText;var Ub=this.fd.mg(fa.node);
Ub.zb(ds.a.outline);const yc=this.Rc.Lc(Io.Y4j);yc.ju(Ub);this.yoa.Lla(fa,ad=>{wc.Q0d();ad=this.ZGc.M$h(ad,Xc);ad.pxp(yb);ad.oRi(Xc,vd);return ad});wc.MUa();Pa.SelectionFactory.ue(Ub.currentNode,fa.cpBegin+1);Pa.SelectionFactory;this.eF.qyb(!1);this.eF.Odb(Dd);Ub=E.a.createTextRange(fa.node,fa.cpBegin,fa.cpBegin+1);Ub=Pa.SelectionFactory.Uo(Ub);this.ib.Kc(Ub);xg.a("InsertEquation",!0);Wl.b.fCc()&&Wl.b.Cse(Wl.a.vPg);yc.dispose()});z.AFrameworkApplication.pc.$b(Xa)}});return 32}T9d(M,fa,Va,Fb,Vb){this.Qp.sendNotification(Vb.message,
Vb.isAssertive);return 32}c$d(M,fa,Va,Fb,Vb){M=this.ygh.Jbd();Vb.Recents=M;return 32}f$d(M,fa,Va,Fb,Vb){this.ygh.rUo(Vb.Recents);Wl.b.fCc()&&this.eF&&!this.eF.isVisible&&Wl.b.Cse(Wl.a.zQg);return 32}Z9d(M,fa,Va,Fb,Vb){this.eF.qyb(!1);this.eF.Odb("");Vb.Success||this.eF.Jdb(2);return 32}dispose(){this.eF=null}Qal(M){if(M&&M.contextId===rb.a.view){M=M.Lk;if(!M||M.contextId===rb.a.Vc)return!1;if(M.contextId===rb.a.Cd){var fa=es.c(M);if(fa&&fa.Sh===Nk.U2l){M=fa.kxi();M=er.a.construct(up.a.zij,M,null);
const Fb=this.pLc.KWc(M);Fb.continueWith(Vb=>{Fb.Yi?(this.eF.Jdb(2),this.eF.qyb(!0),this.eF.Odb(""),Na.ULS.sendTraceTag(545043220,kk.a.Hba,kn.a.warning,"Equation load failed, could not convert OMML equation to LaTeX"),xg.a("LoadEquation",!1)):(Vb=Vb.result.response.PostConversionMathText,this.eF.Jdb(0),this.eF.qyb(!0),this.eF.Odb(Vb),xg.a("LoadEquation",!0))});return!0}}if(M.contextId===rb.a.paragraph||M.contextId===rb.a.Cd){var Va=O.a.instance.cfa;if(Va)if(M=Va.zj,fa=Va.Po-M,0<fa){Va=Va.node;if(R.ParagraphReader.Wb(Va)){M=
er.a.construct(up.a.DAn,Va.characterData.substr(M,fa),null);const Fb=this.pLc.KWc(M);Fb.continueWith(Vb=>{Fb.Yi?(this.eF.Jdb(2),this.eF.qyb(!0),this.eF.Odb(""),Na.ULS.sendTraceTag(544761947,kk.a.Hba,kn.a.warning,"Equation build-up failed"),xg.a("BuildupEquation",!1)):(Vb=Vb.result.response.PostConversionMathText,this.eF.Jdb(0),this.eF.qyb(!0),this.eF.Odb(Vb),xg.a("BuildupEquation",!0))});return!0}Na.ULS.sendTraceTag(545043221,kk.a.Hba,kn.a.error,"Buildup failed, selected graphNode is not a paragraph")}else Na.ULS.sendTraceTag(545043222,
kk.a.Hba,kn.a.error,"Buildup failed, selection length is not greater than 0")}else Na.ULS.sendTraceTag(545043223,kk.a.Hba,kn.a.error,"Buildup failed, unsupported context type",M.contextId)}return!1}}Object(u.a)(Jo,"EquationToolsActionHandler",null,[1039,10]);var rn=d(1893),rm=d(1527),In=d(155);class Sm{}Sm.vyj="EquationTools";Sm.x_j="EquationToolsTaskPaneProps";Sm.rS=In.a.D_c;Sm.taskPaneLocation=2;Sm.taskPaneWidth=400;Object(u.a)(Sm,"EquationToolsConstants",null,[]);class Fo{constructor(M,fa,Va,Fb){this.ey=
this.vi=!1;this.ii=M;this.Zb=fa;this.V5=Va;this.HC=new rn.a;this.Xhb=Fb;this.C5c=this.C5c.bind(this);window.addEventListener("resize",this.C5c)}get isVisible(){return this.ey}r_a(M){M!==this.ey&&(this.ey=M)}show(){this.isVisible?this.rca():(this.initialize(),this.lCg())}hide(){this.Odb("");kf.UISurfaces.Lv().then(M=>{M.hideTaskPane(Sm.rS,Sm.taskPaneLocation);return null})}wtg(){this.Xhb.wtg()&&this.isVisible&&this.Ysd(this.Xhb.tla())}Jdb(M){this.Xhb.Jdb(M)}Odb(M){this.Xhb.Odb(M);this.isVisible&&this.Ysd(this.Xhb.tla())}qyb(M){this.Xhb.qyb(M)}initialize(){this.vi||
(this.g2(),this.xna(),this.vi=!0)}g2(){this.V5.iUa();this.V5.Dfc(this.Zb)}xna(){this.Zb.ie(Sm.rS).parent=Vj.AFrame.Gq}rca(){this.Zb.Gg(Sm.rS)}lCg(){const M=this.Xhb.tla();kf.UISurfaces.Lv().then(fa=>{fa.showTaskPane(Sm.rS,this.LB(M));return null})}C5c(){this.isVisible&&this.Ysd(this.Xhb.tla())}Ysd(M){this.isVisible&&kf.UISurfaces.Lv().then(fa=>{fa.updateTaskPane(Sm.rS,this.LB(M));return null})}LB(M){this.HC.yyb(M);let fa=Sm.taskPaneWidth;window.innerWidth<Sm.taskPaneWidth&&window.innerWidth>window.innerHeight&&
(fa=window.innerWidth);return Object.assign(new rm.a,{title:WordEditorIntl.WordEditorStrings.L_EquationTools,hideHeader:!1,width:fa,location:Sm.taskPaneLocation,contentProps:M,onOpen:this.Nog.bind(this),onClose:this.Mog.bind(this),enableResize:!1,isModernPane:!0,isPaneAutoOpened:!1})}Nog(){this.r_a(!0);this.rca();this.ii.Ge()}Mog(){this.r_a(!1);this.wtg();this.ii.Ge()}dispose(){}}Object(u.a)(Fo,"EquationToolsTaskPane",null,[1038,10]);var sm;(function(M){M[M.isEnabled=1]="isEnabled";M[M.execute=2]=
"execute";M[M.animation=3]="animation"})(sm||(sm={}));Object(u.b)("ActionBehavior",sm);class Xo{constructor(M){this.ga=M}l$a(M){this.ga.Qb(Ci.a.l$a,sm.execute,{EquationLatex:M})}C$m(M){this.ga.Qb(Ci.a.inputEquationLoaded,sm.execute,{Success:M})}loadRecentsFromRoamingService(){const M={Recents:null};this.ga.Qb(Ci.a.y4f,sm.execute,M);return M.Recents}saveRecentsToRoamingService(M){this.ga.Qb(Ci.a.jvg,sm.execute,{Recents:M})}ariaNotify(M,fa){this.ga.Qb(Ci.a.xif,sm.execute,{message:M,isAssertive:fa})}}
Object(u.a)(Xo,"EquationToolsPropsActions",null,[1036]);class eo{constructor(){this.type="EquationToolsTaskPaneProps";this.ariaNotify=this.saveRecentsToRoamingService=this.loadRecentsFromRoamingService=this.insertEquationAction=this.inputEquationLoaded=this.onFocus=this.isTeamsSession=this.isLoadingEquation=this.inputEquation=this.errorCode=this.id=null}}Object(u.a)(eo,"EquationToolsTaskPaneProps",null,[]);class fr{constructor(){this.message="";this.isAssertive=!1}}Object(u.a)(fr,"AriaNotifyData",
null,[]);class bn{constructor(M){this.Aja=null;this.aHc=M}tla(){this.Aja||(this.Aja=this.Pmb());return this.Aja}wtg(){this.Aja=this.Pmb();return!0}Jdb(M){this.Aja||(this.Aja=this.Pmb());this.Aja.errorCode!==M&&(this.Aja.errorCode=M)}Odb(M){this.Aja||(this.Aja=this.Pmb());this.Aja.inputEquation=M}qyb(M){this.Aja||(this.Aja=this.Pmb());this.Aja.isLoadingEquation=M}Pmb(){const M=new eo;return Object.assign(M,{errorCode:0,inputEquation:"",isTeamsSession:z.AFrameworkApplication.J.$("IsTeamsSession"),isLoadingEquation:!1,
insertEquationAction:fa=>{this.aHc.l$a(fa)},inputEquationLoaded:fa=>{this.aHc.C$m(fa)},loadRecentsFromRoamingService:()=>this.aHc.loadRecentsFromRoamingService(),saveRecentsToRoamingService:fa=>{this.aHc.saveRecentsToRoamingService(fa)},ariaNotify:fa=>{this.aHc.ariaNotify(fa.message,fa.isAssertive)}})}dispose(){}}Object(u.a)(bn,"EquationToolsPropsManager",null,[1037]);class Ig{constructor(){this.Z=null}get name(){return"WordEditor.EquationTools"}wc(M){Ig.wAf()&&(this.Z=M,this.Z.ia("WordEditor.EquationTools.IEquationToolsTaskPane",
()=>new Fo(this.Z.resolve("Box4.IAppFrame"),cf.FocusManager.instance(),Ki.a.instance,this.Z.resolve("WordEditor.EquationTools.IEquationToolsPropsManager"))).ha(),this.Z.ia("WordEditor.EquationTools.IEquationToolsActionHandler",()=>new Jo(this.Z.resolve("WordEditor.EquationTools.IEquationToolsTaskPane"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.ISelectionManager"),new qd.a,new Nc.a,this.Z.resolve("Box4.Equations.IEquationBlobManager"),this.Z.resolve("Box4.Equations.IMathConversionServiceAdapter"),
Wd.a.instance,z.AFrameworkApplication.va,this.Z.Ta("Box4.IExternalSelectionManager"),this.Z.resolve("Box4.IRoamingServiceRequestManager"),this.Z.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("Common.Utils.IAriaNotifier"),this.Z.resolve("Common.IUlsWrapper"))).ha(),this.Z.ia("WordEditor.EquationTools.IEquationToolsActionDelegator",()=>new bs(z.AFrameworkApplication.va,this.Z.resolve("WordEditor.EquationTools.IEquationToolsActionHandler"))).ha(),
this.Z.ia("WordEditor.EquationTools.IEquationToolsPropsManager",()=>new bn(this.Z.resolve("WordEditor.EquationTools.IEquationToolsPropsActions"))).ha(),this.Z.ia("WordEditor.EquationTools.IEquationToolsPropsActions",()=>new Xo(z.AFrameworkApplication.va)).ha())}init(){if(Ig.wAf()){try{this.Z.resolve("WordEditor.EquationTools.IEquationToolsActionDelegator").Xb()}catch(M){Na.ULS.sendTraceTag(545043212,kk.a.Hba,kn.a.error,"Initializing package failed",M.message)}xg.a("InitializeEquationToolsPackage",
!0)}}dispose(){Ig.wAf()&&this.Z&&(this.Z.resolve("WordEditor.EquationTools.IEquationToolsActionDelegator").mfb(),this.Z.resolve("WordEditor.EquationTools.IEquationToolsTaskPane").dispose(),this.Z.resolve("WordEditor.EquationTools.IEquationToolsActionHandler").dispose(),this.Z.resolve("WordEditor.EquationTools.IEquationToolsActionDelegator").dispose());this.Z=null}static wAf(){return z.AFrameworkApplication.J.$("EquationToolsIsEnabled")}static main(){x.a.instance.Mc(new Ig)}}Object(u.a)(Ig,"EquationToolsPackageManager",
null,[0,1]);var vp=d(655),Ko=d(68);class Go{constructor(M,fa,Va,Fb,Vb,wc,Xc){this.GQ=null;this.UKd=!1;this.QY=0;this.snh=!1;this.a9g=0;this.Sia=!1;this.F_=(vd,Dd)=>{!this.Sia||this.GQ||0!==Dd.newState&&1!==Dd.newState||(this.$8h(),this.Vzj(this.GQ))};this.zbo=(vd,Dd,Ce)=>{if(!this.Sia||this.P_f)return 2;2===Ce&&this.Wsg(!0);return 32};this.Vzj=()=>{this.P_f?this.stop():this.Fz.instance&&2===this.Fz.instance.vA?this.fDj():this.Wsg(!1)};this.Ied=vd=>{if(vd&&vd.data&&vd.data.Pe){var Dd,Ce=({correlationId:Dd}=
Go.E3j(vd.data.wi)).returnValue;Na.ULS.sendTraceTag(591209492,208,50,"AppSettings refresh succeeded. {0}",{["Status"]:vd.data.status,["HttpStatus"]:vd.data.He,["ResponseLength"]:vd.data.Pe?vd.data.Pe.length:-1,["CorrelationId"]:Ce?Dd:"N/A"});try{var ea=Hf.b(vd.data.Pe)}catch(Xa){this.e2j();Na.ULS.sendTraceTag(591209493,208,10,"AppSettings refresh JSON parse failed. Consecutive errors {0}.  {1}",this.QY,Xa);return}this.snh=({CRn:vd}=Go.Eqp(vd.data.wi)).returnValue;this.a9g=vd;this.pO.$zp(ea);this.d2h()}else this.bsc(new vp.a(vd?
vd.data:null))};this.bsc=vd=>{const Dd={};if(vd&&vd.data){Dd.Status=vd.data.status;Dd.HttpStatus=vd.data.He;const ea=({correlationId:Ce}=Go.E3j(vd.data.wi)).returnValue;Dd.CorrelationId=ea?Ce:"N/A";if(vd.data.He===oj.a.$Sn){this.d2h();Na.ULS.sendTraceTag(591209499,208,50,"AppSettingsRefresh: No change. {0}",Dd);return}var Ce=this.P_f;Dd.IsSessionValid=Ce;Dd.RetriedCanary=this.UKd;if(vd.data.He===oj.a.l8&&Ce&&!this.UKd){this.UKd=!0;vd=vd.data.request.get_url();vd="1"===ys.a.vL(vd,"skipCache");Na.ULS.sendTraceTag(590931157,
208,50,"AppSettingsRefresh: Retriable canary failure. {0}",Dd);this.Wsg(vd);return}if(this.Sia&&vd.data.He===oj.a.Odj){Na.ULS.sendTraceTag(590931158,208,15,"AppSettingsRefresh: Endpoint disabled. {0}",Dd);this.stop();return}}this.e2j();Dd.ConsecutiveFailures=this.QY;Na.ULS.sendTraceTag(591209500,208,15,"AppSettingsRefresh: Failed. {0}",Dd)};this.Jb=M;this.Aa=fa;this.pO=Va;this.V$b=Fb;this.If=Vb;this.kuh=fa.jc("AppSettingsRefreshMaxConsecutiveFailures",10);this.Fz=Xc;this.Fz.execute(vd=>{vd.BHa(this.F_)});
wc.qa(Vd.a.T6k,bo.a.frame,this.zbo)}get P_f(){return!!this.V$b&&!this.V$b.XBa}start(){this.pO.X0i&&(this.Sia=!0,this.$8h())}$8h(){this.GQ=new Gf.a(5,2,1E3*this.Aa.jc("AppSettingsRefreshIntervalSec",480),this.Vzj,164);this.Jb.$b(this.GQ)}Wsg(M){const fa=this.xim(M);fa?this.If.Xj(fa,1,null,this.snh?{["Wac-AppSettings-ETag"]:this.a9g.toString()}:null,!1,M?2:5,this.Ied,this.bsc,null,void 0,void 0,void 0,void 0,"35",void 0,void 0,void 0,["Wac-AppSettings-ETag",Ko.a.q2]):(Na.ULS.sendTraceTag(591209491,
208,15,"Failed to get full appsettings service url"),this.stop())}xim(M){var fa=z.AFrameworkApplication.rm;if(!fa)return null;fa=this.Aa.jb("WebServiceBase")+"appsettings.ashx?"+fa+"&refresh=1";M&&(fa+="&skipCache=1");return fa}e2j(){this.QY++;this.QY===this.kuh&&(Na.ULS.sendTraceTag(591209496,208,10,"AppSettingsRefresh: Stopping after hit max consecutive errors of {0}.",this.kuh),this.stop())}d2h(){this.UKd=!1;this.QY=0}stop(){this.fDj();this.Sia=!1}fDj(){this.GQ&&(this.Jb.wf(this.GQ),this.GQ=null)}static E3j(M){let fa;
fa=null;if(M){fa=(M[Ko.a.q2]||"").toString();if(fa.length)return{returnValue:!0,correlationId:fa};fa=null}return{returnValue:!1,correlationId:fa}}static Eqp(M){let fa,Va=!1;fa=0;M&&(fa=parseInt((M["Wac-AppSettings-ETag"]||"").toString()),isNaN(fa)||!isFinite(fa)?fa=0:Va=!0);return{returnValue:Va,CRn:fa}}}Object(u.a)(Go,"AppSettingsRefresher",null,[965]);class As{constructor(M,fa){this.SMk=["RequestedCallThrottling","HostServiceLevel","WacServiceLevel"];this.YLi=(Va,Fb)=>{this.SV.HadSettingsRefresh=
!0;Va=null;for(const Vb of this.SMk)Fb.jXa(Vb)&&(Va||(Va={}),Va[Vb]={["OldValue"]:Fb.xij.jb(Vb),["NewValue"]:Fb.aWb.jb(Vb)});Va&&Na.ULS.sendTraceTag(588646417,208,15,"RefreshedAppSettingsTelemetry: {0}",Va)};this.pO=M;this.SV=fa;this.pO.ASc(this.YLi)}dispose(){this.pO.Jrg(this.YLi)}}Object(u.a)(As,"RefreshedAppSettingsTelemetry",null,[10]);class Us{constructor(){this.Z=null;this.iz=()=>{this.Z.resolve("Common.App.AppSettingsRefresh.IAppSettingsRefresher").start()}}get name(){return"Common.App.AppSettingsRefresh"}wc(M){this.Z=
M;this.Z.register(Go,"Common.App.AppSettingsRefresh.AppSettingsRefresher").as("Common.App.AppSettingsRefresh.IAppSettingsRefresher").ha().Ud(()=>new Go(z.AFrameworkApplication.pc,z.AFrameworkApplication.J,M.resolve("Common.IRefreshableAppSettings"),M.Oa("Common.ISessionStatus"),z.AFrameworkApplication.Fe,z.AFrameworkApplication.va,M.Ta("Common.App.VisibilityManagement.IVisibilityManager")));this.Z.register(As,"Common.App.AppSettingsRefresh.RefreshedAppSettingsTelemetry").ha().Ud(()=>new As(M.resolve("Common.IRefreshableAppSettings"),
z.AFrameworkApplication.fh))}init(){const M=z.AFrameworkApplication.J;z.AFrameworkApplication.J.P$a?this.iz():M.vp(this.iz);this.Z.resolve("Common.App.AppSettingsRefresh.RefreshedAppSettingsTelemetry")}dispose(){const M=this.Z.Oa("Common.App.AppSettingsRefresh.RefreshedAppSettingsTelemetry");M&&M.dispose()}static main(){z.AFrameworkApplication.J&&z.AFrameworkApplication.J.$("AppSettingsRefreshIsEnabled")&&x.a.instance.Mc(new Us)}}Object(u.a)(Us,"AppSettingsRefreshPackage",null,[0,1]);var Nt=d(436);
class Mq extends Nt.a{constructor(M){super(M)}get bXc(){return!1}createElement(){const M=document.createElement("link");M.setAttribute("rel","stylesheet");M.setAttribute("type","text/css");M.setAttribute("href",this.eG);return M}qsf(){return null}pte(){this.element.setAttribute("href","");this.element.setAttribute("href",this.jY.eG)}}Object(u.a)(Mq,"CssResource",Nt.a,[]);var Gp=d(138);class cn{constructor(){this.vJd=this.jBd=null}SBn(){this.jBd||(Na.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.jBd=Gp.Task.WAA(cn.dCn(),cn.HBn()),this.jBd.continueWith(M=>{Na.ULS.sendTraceTag(21030599,324,10,"{0}",F.a.R5d(M.wk))},5));return this.jBd}VBn(){if(!this.vJd)try{Na.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.vJd=Gp.Task.WAA(cn.Fzf(he.a.create(z.AFrameworkApplication.J.jb("DimeUrl"),null,null))),this.vJd.continueWith(M=>{Na.ULS.sendTraceTag(39978391,324,10,"{0}",F.a.R5d(M.wk))},5)}catch(M){Na.ULS.sendTraceTag(594874951,324,10,"{0}",F.a.R5d(M))}return this.vJd}static dCn(){var M=
cn.getUrl("inproductmessaging.js");M=he.a.create(M,null,null);return cn.Fzf(M)}static HBn(){var M=cn.getUrl("inproductmessaging.css");M=new Mq(M);return cn.Fzf(M)}static getUrl(M){return Kj.a.Mec(String.format("ipm/{0}",M))}static Fzf(M){Cd.a.m_(M);return M.Uab}}Object(u.a)(cn,"DependencyDownloader",null,[968]);class hp{}hp.q8n="inProductMessagingOverlayDiv";hp.Uco="PlayButtonImage";hp.cFo="ReplayButtonImage";Object(u.a)(hp,"Constants",null,[]);class tm{constructor(){this.aFh=this.Xuh=this.H9g=!0;
this.dFo=this.Wco=null;this.OQn=!1;this.locale=null;this.Q4j={}}get mVh(){return this.H9g}set mVh(M){this.H9g=M}get oej(){return this.Xuh}set oej(M){this.Xuh=M}get BUj(){return this.aFh}set BUj(M){(this.aFh=M)&&this.rYo()}rYo(){this.HOh(hp.Uco,this.Wco);this.HOh(hp.cFo,this.dFo)}HOh(M,fa){fa&&(this.Q4j[M]=fa)}}Object(u.a)(tm,"FirstRunExperienceUISettings",null,[967]);class ip{constructor(){this.completed=this.Dyo=!1}}Object(u.a)(ip,"FirstRunExperienceViewData",null,[937]);class pt{constructor(M,fa,
Va){this.S$l=(Fb,Vb,wc,Xc,vd)=>{2===wc&&this.kDd.czn(vd);return 32};this.rUl=(Fb,Vb,wc,Xc,vd)=>{2===wc&&this.kDd.azn(vd);return 32};this.t5m=(Fb,Vb,wc)=>2===wc?this.kDd.G8f():32;this.s5m=(Fb,Vb,wc)=>2===wc?this.kDd.E8f():32;this.ga=M;this.Nj=fa;this.kDd=Va}Xb(){this.ga.fb(Vd.a.T$l,bo.a.frame,this.S$l,64);this.ga.qa(Vd.a.Soi,bo.a.frame,this.t5m);this.ga.qa(Vd.a.Roi,bo.a.frame,this.s5m);this.ga.qa(Vd.a.qUl,bo.a.frame,this.rUl);this.ga.qa(Vd.a.gFj,bo.a.frame,Mk.ActionManager.eg);this.ga.qa(Vd.a.yFo,
bo.a.frame,Mk.ActionManager.eg);this.ga.qa(Vd.a.zFo,bo.a.frame,Mk.ActionManager.eg);this.Nj&&this.Nj.Ge()}}Object(u.a)(pt,"InProductMessagingActor",null,[]);class xo{constructor(){this.Yuc=this.zld=this.t_j=this.Mge=this.instance=null}}Object(u.a)(xo,"DimeExperienceUISettings",null,[]);var Ot=d(1053);class Fl{constructor(M,fa,Va,Fb,Vb){this.e4d=!1;this.dZc=null;this.ga=M;this.tJb=fa;this.PKd=Va;this.WEa=Fb;this.vDc=Vb}F8m(M){Up.b("getHeaderApi")?M.isFeatureEnabled("MsoPremiumBadge",!0).then(fa=>{const Va=
M.isFreemiumUpsellEnabled();Va&&(appChrome.getHeaderApi().then(Fb=>{Fb.updatePremiumStatus(fa,Va);return null}),M.Cua("MsoPremiumBadge",Fb=>{appChrome.getHeaderApi().then(Vb=>{Vb.updatePremiumStatus(Fb.isEnabled,Va);return null})}));return null}):Na.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}czn(M){this.PKd.SBn().continueWith(()=>{this.tJb.m$o(M)})}azn(M){let fa="gopremium",Va=null,Fb=()=>{};M?(M.experience&&""!==Object(pg.a)(String,M.experience)&&(fa=Object(pg.a)(String,M.experience)),
M.onTaskComplete&&(Fb=M.onTaskComplete),M.campaignId&&""!==Object(pg.a)(String,M.campaignId)&&(Va=Object(pg.a)(String,M.campaignId))):Na.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.L5i(fa,Fb,Va)}L5i(M,fa,Va=null){if(this.e4d&&this.dZc){const Fb={};Fb.experience=M||"gopremium";Fb.campaignId=Va||Ot.b(this.WEa,this.vDc,Object(pg.a)(String,Fb.experience),!0);this.ga.Ob(Vd.a.gFj,2);Na.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Fb.experience);
try{const Vb=Object.assign(new xo,{instance:this.dZc,Mge:Fb,t_j:fa||(()=>{}),zld:wc=>{Na.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+wc.status)},Yuc:()=>{Na.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.e4d=!1;this.dZc=null}});this.tJb.s8o(Vb)}catch(Vb){Na.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Vb.message),this.e4d=!1,this.dZc=null,this.ga.Qb(Vd.a.f4d,2,{["experience"]:Fb.experience})}}else Na.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),
this.ga.Qb(Vd.a.f4d,2,{["experience"]:M})}i7i(){this.PKd.VBn().continueWith(()=>{try{var M=F.a.xh(z.AFrameworkApplication.uiCulture);const Fb=Ot.c(this.WEa);if(Fb){var fa={};fa.partnerId=Fb;fa.language=M;fa.sessionId=z.AFrameworkApplication.userSessionId;fa.authHint=z.AFrameworkApplication.J.jb("UserPrincipalName");var Va=z.AFrameworkApplication.J.jb("Puid")||"";""!==Va&&(M={},M.puid=Va,fa.userInfo=M);this.dZc=new Dime(fa);this.e4d=!0;Na.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else Na.ULS.sendTraceTag(51675409,
324,15,"App not supported")}catch(Fb){Na.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Fb.message)}},3)}G8f(){return this.tJb.G8f()}E8f(){return this.tJb.E8f()}}Object(u.a)(Fl,"InProductMessagingUIManager",null,[966]);class Ec{constructor(){this.iIh=0;this.K8b=Array(5);this.K8b[0]=10;this.K8b[1]=15;this.K8b[2]=50;this.K8b[3]=100;this.K8b[4]=200}Init(M){this.iIh=M}SendTrace(M,fa){Na.ULS.sendTraceTag(34182235,this.iIh,this.K8b[M],"{0}",fa)}}Object(u.a)(Ec,"DefaultNetworkingManager",
null,[936]);var fs=d(375);class gs{constructor(M){this.rWe=!1;this.Zb=M}get iYf(){return this.rWe}m$o(M){M&&(InProductMessaging.Networking.NetworkingMgr=new Ec,InProductMessaging.Networking.NetworkingMgr.Init(387),this.rWe=!0,InProductMessaging.Init(M.BUj,M.oej,M.mVh,M.OQn,M.locale,Object(ao.a)(this,this.HYn,"onDismissFirstRunExperience"),M.Q4j),this.Ldb(hp.q8n,!0))}s8o(M){if(M&&M.instance&&M.Mge){let fa=document.getElementById("wacDimeContainer");fa||(fa=document.createElement("div"),fa.id="wacDimeContainer",
document.body.appendChild(fa));z.AFrameworkApplication.J.$("DimeFocusManagerIsEnabled")&&this.Ldb("wacDimeContainer",!1);M.Mge.parentElementId="wacDimeContainer";M.instance.launch(M.Mge,M.t_j).then(Va=>{this.FZa();document.body.removeChild(fa);M.zld(Va)}).catch(Va=>{this.FZa();document.body.removeChild(fa);M.Yuc(Va)})}else throw Error.argument("DimeExperienceUISettings");}Ldb(M,fa){if(this.Zb&&M&&(M=document.getElementById(M),this.v8m(M),M=this.Zb.getRegion("InProductMessagingFocusId"))){const Va=
this.Zb.currentScope;Va&&"InProductMessagingFocusId"===Va.name||this.Zb.EN("InProductMessagingFocusId",!1);fa&&this.bNa(M.scope)}}v8m(M){var fa=this.Zb.ie("InProductMessagingFocusId");fa.parent=Vj.AFrame.UK;const Va=new fs.DOMFocusListing(()=>M);Va.Uga=!1;Va.rn(3);Va.rn(2);Va.rn(4);fa=this.Zb.Rqa(()=>M,fa,Va);fa.AZa();fa.rP=!0;fa.K6a=!0}bNa(M){M.ot(cf.FocusManager.instance().BZ);M.ot(cf.FocusManager.instance().CZ);M.bindAction(cf.FocusManager.instance().BZ,Vd.a.Soi);M.bindAction(cf.FocusManager.instance().CZ,
Vd.a.Roi)}FZa(){this.Zb&&(this.Zb.bV("InProductMessagingFocusId"),this.Zb.jxb("InProductMessagingFocusId"))}HYn(M,fa){this.rWe=!1;this.FZa();M=Object.assign(new ip,{completed:M,Dyo:fa});z.AFrameworkApplication.va.Qb(Vd.a.R$l,2,M)}G8f(){const M=document.activeElement,fa=this.Zb.$t();return M&&fa&&fa.Uk&&M===fa.Uk.Spc?(fa.Uk.iA(M),fa.urc()?32:8):4}E8f(){const M=document.activeElement,fa=this.Zb.$t();return M&&fa&&fa.Uk&&M===fa.Uk.$ka?(fa.Uk.iA(M),fa.rrc()?32:8):4}}Object(u.a)(gs,"InProductMessagingUIWrapper",
null,[909]);class dk{constructor(){this.Z=null}get name(){return"Common.App.InProductMessaging"}wc(M){M.register(cn,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ha().Ud(()=>new cn);M.register(gs,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ha().Ud(()=>new gs(cf.FocusManager.instance()));M.register(Fl,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ha().Ud(()=>
new Fl(z.AFrameworkApplication.va,M.resolve("Common.IInProductMessagingUIWrapper"),M.resolve("Common.App.InProductMessaging.IDependencyDownloader"),z.AFrameworkApplication.ua.Gb.Mk,z.AFrameworkApplication.ua.Gb.Dma));M.register(pt,"Common.App.InProductMessaging.InProductMessagingActor").ha().Ud(()=>new pt(z.AFrameworkApplication.va,z.AFrameworkApplication.ua,M.resolve("Common.IInProductMessagingUIManager")));M.register(tm,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ha().Ud(()=>
new tm);M.register(ip,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ha().Ud(()=>new ip);this.Z=M}init(){this.Z.resolve("Common.App.InProductMessaging.InProductMessagingActor").Xb();z.AFrameworkApplication.J.vp(()=>{z.AFrameworkApplication.ua.Gb.tN&&Ld.a.get_instance().Sk(15,()=>{this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(M=>{this.Z.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").F8m(M)})});
z.AFrameworkApplication.J.$("FreemiumUpsellShowDialogIsEnabled")&&Ot.a()&&!D.a.Wfa&&1!==z.AFrameworkApplication.ua.Gb.Mk&&this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(M=>{M.isFeatureEnabled("MsoPremiumBadge",!0).then(fa=>{!fa&&M.isFreemiumUpsellEnabled()&&this.Z.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").i7i();return null})})})}dispose(){}static main(){x.a.instance.Mc(new dk)}}Object(u.a)(dk,"InProductMessagingPackage",null,[0,1]);class Kn{constructor(M,
fa){this.a7i=(Va,Fb,Vb,wc,Xc)=>{if(!Xc||3===Vb)return 2;if(1===Vb)return this.Kbc(this.Q8b.f_h(Xc.upn||Xc.aadObjectId||Xc.smtp));if(!this.f2l(Xc))return 8;switch(Xc.action){case 0:return this.Kbc(this.Q8b.pVk(Xc));case 1:return this.Kbc(this.Q8b.oVk(Xc));case 2:return this.Kbc(this.Q8b.qVk(Xc));case 3:return this.Kbc(this.Q8b.t6n(Xc));case 4:return this.Kbc(this.Q8b.bzo(Xc));default:return 2}};this.ga=M;this.Q8b=fa}Xb(){this.ga.qa(Vd.a.qhe,bo.a.frame,this.a7i)}mfb(){this.ga.Fy(Vd.a.qhe,bo.a.frame,
this.a7i)}f2l(M){const fa=M.upn||M.aadObjectId||M.smtp;return M.targetElement&&(4===M.action||fa&&""!==fa)?!0:!1}Kbc(M){return M?32:8}}Object(u.a)(Kn,"LivePersonaCardActor",null,[]);var ek=d(342);class am{}Object(u.a)(am,"BootstrapperConfig",null,[]);class hm{}Object(u.a)(hm,"LivePersonaCardInitializerResult",null,[]);class sr{}sr.nWh=null;Object(u.a)(sr,"LivePersonaCardModule",null,[]);class yj{constructor(M,fa,Va,Fb=null){this.i1n=()=>{const Vb=sr.nWh;if(Vb){const wc=this.Cjm();try{Vb.initializeLivePersonaCardAsync(wc).then(()=>
{this.Mq.gg(Object.assign(new hm,{isInitialized:!0,isEnabled:!0}))}).catch(Xc=>{const vd=Object(pg.a)(String,Xc);vd?this.Mq.setException(Error.create(vd)):this.Mq.setException(Error.create(JSON.stringify(Xc)))})}catch(Xc){this.Mq.setException(Xc)}}else this.Mq.gg(Object.assign(new hm,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};this.logMessage=(Vb,wc,Xc)=>{Vb=JSON.stringify({["Log Type"]:Vb,["Log Result Type"]:wc,["Message"]:Xc});Na.ULS.sendTraceTag(50431106,
3006,50,Vb)};this.getAuthToken=(Vb,wc)=>{z.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?this.dIc.continueWith(Xc=>{Xc.Zo||Xc.Yi?wc("LokiTokenManagerTask is either canceled or faulted.",z.AFrameworkApplication.userSessionId):this.dIc.result.vKf().then(vd=>{vd.isSuccess&&vd.token&&vd.token.length?Vb(vd.token,z.AFrameworkApplication.userSessionId):wc(vd.errorMessage,z.AFrameworkApplication.userSessionId)}).catch(vd=>Na.ULS.sendTraceTag(539617039,
3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(vd)))}):this.nEk.vKf().then(Xc=>{Xc.isSuccess&&Xc.token&&Xc.token.length?Vb(Xc.token,z.AFrameworkApplication.userSessionId):wc(Xc.errorMessage,z.AFrameworkApplication.userSessionId)}).catch(Xc=>Na.ULS.sendTraceTag(50431107,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Xc)))};this.Mq=new ek.a;this.fIk=M;this.nEk=fa;this.Aa=Va;this.dIc=Fb}init(){this.BZi()?this.fIk.pCn().continueWith(this.i1n):
this.Mq.gg(Object.assign(new hm,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));return this.Mq.task}Cjm(){const M=zf.a.Eg(z.AFrameworkApplication.lcid);return Object.assign(new am,{culture:M?M.name.toLocaleLowerCase():"en-us",clientType:this.Aa.jb("LivePersonaCardClientType"),clientContextType:"Generic",clientCorrelationId:z.AFrameworkApplication.userSessionId,complianceEnvironment:this.Vmm(),logMessage:this.logMessage,getAuthToken:this.getAuthToken})}BZi(){if(!this.Aa.$("LivePersonaCardIsEnabled")||
!this.m6k())return!1;const M=this.Aa.jb("SovereignEnvironmentName");return M&&""!==M?M.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||M.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0}m6k(){return this.Aa.$("CoauthorGalleryLivePersonaCardIsEnabled")||!!z.AFrameworkApplication.ua&&z.AFrameworkApplication.ua.Gb.l0b}Vmm(){return this.Aa.jb("LivePersonaCardComplianceEnvironment")}}Object(u.a)(yj,"LivePersonaCardInitializer",null,[]);class hs{}Object(u.a)(hs,"Behavior",null,[]);class Nq{}
Object(u.a)(Nq,"Identifiers",null,[]);class wk{}Object(u.a)(wk,"LivePersonaCardParameters",null,[]);class Xp{}Object(u.a)(Xp,"PersonaInfo",null,[]);class Yp{constructor(M){this.Lzk=M}f_h(M){return this.Lzk.BZi()&&M&&""!==M?!!window.self.LPC:!1}pVk(M){return this.hsd("addedPersonaToPageV2",M,0)}oVk(M){return this.hsd("addedPersonaToPageV2",M,1)}qVk(M){return this.hsd("addedPersonaToPageV2",M,2)}t6n(M){return this.hsd("openCard",M)}bzo(M){return this.hsd("removedPersonaFromPage",M)}rll(M){return!!M.targetElement&&
(this.f_h(M.upn||M.aadObjectId||M.smtp)||4===M.action)}hsd(M,fa,Va=3){if(!this.rll(fa))return!1;Va=4!==fa.action?this.wHl(fa,Va):null;const Fb=window.self.LPC;if(Fb&&Fb[M]){if(Va)Fb[M](fa.targetElement,Va);else Fb[M](fa.targetElement);return!0}return!1}wHl(M,fa=3){const Va=Object.assign(new Nq,{PersonaType:"User",Upn:M.upn,AadObjectId:M.aadObjectId,Smtp:M.smtp});return Object.assign(new wk,{personaInfo:Object.assign(new Xp,{identifiers:Va,displayName:M.name,personaCoinColor:M.color}),behavior:Object.assign(new hs,
{onCardOpen:()=>{Na.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(M.onCardOpen)M.onCardOpen()},onCardClose:M.onCardClose,disableClick:2===fa||3===fa,disableHover:0===fa||3===fa}),clientScenario:M.clientScenario})}}Object(u.a)(Yp,"LivePersonaCardManager",null,[]);class qt{constructor(M){this.dMd=M}pCn(){const M=z.AFrameworkApplication.mC("midgardbootstrapper.js",5);return this.dMd.yqc(M).continueWith(()=>{sr.nWh=window.self.MidgardBootstrapper})}}Object(u.a)(qt,"LivePersonaCardPackageLoader",
null,[905]);var yn=d(546);class Oq{constructor(){this.Z=null;this.iz=()=>{let M;M=z.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new yj(new qt(this.Z.resolve("Common.ISharedDependencyLoader")),null,z.AFrameworkApplication.J,yn.a.sq(this.Z.Ta("Common.ILokiTokenManager"))):new yj(new qt(this.Z.resolve("Common.ISharedDependencyLoader")),this.Z.resolve("Common.ILokiTokenManager"),z.AFrameworkApplication.J);M.init().continueWith(fa=>{fa.Yi&&fa.wk?
Na.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",fa.wk.message):((fa=fa.result)||Na.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),fa.isInitialized?Na.ULS.sendTraceTag(50431109,3006,100,"Successfully initialized LivePersonaCard"):Na.ULS.sendTraceTag(595067867,3006,fa.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",fa.failureMessage))});(new Kn(z.AFrameworkApplication.va,new Yp(M))).Xb()}}get name(){return"Common.App.LivePersonaCard"}init(){z.AFrameworkApplication.J&&
z.AFrameworkApplication.J.vp(this.iz)}dispose(){}wc(M){this.Z=M}static main(){x.a.instance.Mc(new Oq)}}Object(u.a)(Oq,"LivePersonaCardPackage",null,[0,1]);class Li extends Sys.EventArgs{constructor(M){super();this.isConnected=M}}Object(u.a)(Li,"BrowserNetworkConnectivityChangedEventArgs",Sys.EventArgs,[]);class oo{constructor(M,fa,Va){this.uk=this.kHb=null;this.ljj=()=>{!window.navigator.onLine&&this.Nph&&this.LDl();this.sa.raiseEvent("BNCC",new Li(window.navigator.onLine))};this.mdo=()=>{const Fb=
window.navigator.onLine;(this.uk.isVisible||Fb)&&Na.ULS.sendTraceTag(543990533,306,15,"Polling Network State - ClientNetworkState: "+(Fb?"online":"offline"));Fb&&(this.sa.raiseEvent("BNCC",new Li(!0)),this.Jb.wf(this.kHb))};this.sa=new Be.a;this.Jb=M;this.lf=fa;Va.execute(Fb=>{this.uk=Fb});this.Nph=!1;z.AFrameworkApplication.J&&(this.Nph=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorNavigatorPollingEnabled",!1));for(const Fb of $c.a.fgj)$addHandler(window,
Fb,this.ljj)}O0k(M){this.sa.addHandler("BNCC",M)}LDl(){this.kHb=new Gf.a(2,2,5E3,this.mdo,205);this.Jb.$b(this.kHb)}dispose(){for(const M of $c.a.fgj)$removeHandler(window,M,this.ljj)}}Object(u.a)(oo,"NetworkConnectivityManager",null,[904,10]);class po{constructor(){this.Z=null}get name(){return"Common.App.NetworkConnectivity"}init(){this.Z.resolve("Common.App.NetworkConnectivity.INetworkConnectivityProvider")}dispose(){const M=this.Z.Oa("Common.App.NetworkConnectivity.NetworkConnectivityManager");
M&&M.dispose()}wc(M){this.Z=M;const fa=this.Z.Oa("Common.ISessionStatus"),Va=z.AFrameworkApplication.pc,Fb=this.Z.Ta("Common.App.VisibilityManagement.IVisibilityManager");this.Z.register(oo,"Common.App.NetworkConnectivity.NetworkConnectivityManager").as("Common.App.NetworkConnectivity.INetworkConnectivityProvider").Ud(()=>new oo(Va,fa,Fb)).ha()}static main(){x.a.instance.Mc(new po)}}Object(u.a)(po,"NetworkConnectivityManagerPackage",null,[0,1]);var hl=d(122);class Ln{constructor(M){this.lVb=this.G6f=
this.oVb=this.tie=0;this.A6f=this.rbj=null;this.W1n=fa=>{"pen"!==fa.pointerType||this.oVb||(this.oVb=Math.floor(this.tob()/1E3),this.oVb<=this.tie&&(this.oVb=this.tie),this.G6f=0)};this.X1n=()=>{this.$Li()};this.F_=(fa,Va)=>{0!==Va.newState&&this.$Li()};this.rGn=()=>{0<this.lVb&&this.ELj(this.lVb);this.lVb=0};M?(this.Aie=M,this.tob=Date.now,this.aJl(),this.Nwo()):Na.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}hYo(){this.rbj="Office.Word.Online.Data.Activity.PenMinutes"}Nwo(){window.document.body.addEventListener("pointerenter",
this.W1n);window.document.body.addEventListener("pointerleave",this.X1n);fd.a.instance.Ta("Common.App.VisibilityManagement.IVisibilityManager").execute(M=>{M.BHa(this.F_)})}$Li(){const M=Math.ceil(this.tob()/1E3);this.oVb&&M>this.tie&&(this.G6f=M,this.lVb+=this.G6f-this.oVb);this.tie=M;this.oVb=0}aJl(){this.A6f=new Gf.a(4,2,6E4,this.rGn);this.Aie.$b(this.A6f)}ELj(M){const fa=new pb.a;fa.name=this.rbj;const Va=[];(M=hl.a.Naa("PenInputSec",M.toString(),3))&&Array.add(Va,M);fa.dataFields=Va;cb.a.sendActivityEvent(fa)}dispose(){0<
this.lVb&&this.ELj(this.lVb);this.Aie.wf(this.A6f)}}Object(u.a)(Ln,"PenMinutesManager",null,[856]);class wp{constructor(){this.$2e=this.Z=null}get name(){return"Common.App.PenMinutesManager"}wc(M){this.Z=M;const fa=z.AFrameworkApplication.pc;this.Z.register(856,"Common.App.PenMinutesManager.IPenMinutesManager").ha().Ud(()=>new Ln(fa))}init(){this.$2e=this.Z.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.$2e&&this.$2e.dispose()}static main(){x.a.instance.Mc(new wp)}}Object(u.a)(wp,
"PenMinutesManagerPackage",null,[0,1]);class Hp{}Hp.visible="visible";Hp.hidden="hidden";Object(u.a)(Hp,"PlatformVisibilityState",null,[]);class eq extends Sys.EventArgs{constructor(M,fa){super();this.qth={};this.iGk=M;this.DFk=fa}get oldState(){return this.iGk}get newState(){return this.DFk}report(M,fa){this.qth[M]=fa}toString(){return Hf.c(this.qth)}}Object(u.a)(eq,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class Vs{constructor(M,fa,Va,Fb){this.KHh=this.wlb=null;this.FEh=!0;this.$me=Vb=>
{this.eAc(Vb.type,this.NOf())};this.umj=Vb=>{this.eAc(Vb.type,0)};this.vmj=Vb=>{3!==this.vA&&(this.S2h(),this.eAc(Vb.type,2),this.eAc(Vb.type,3),z.AFrameworkApplication.fh.MKn())};this.jYm=()=>{this.wlb=null;this.eAc("TaskItem",this.NOf())};this.vHn=Vb=>{Na.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",Vb.a6f,+new Date-+this.KHh,Ve.SessionStatusManager.instance.Jk)};this.sa=new Be.a;this.Jb=M;this.MSe=fa;this.aeh=Va;this.FSk=Fb;this.Oph=!1;
z.AFrameworkApplication.J&&(this.Oph=z.AFrameworkApplication.J.$("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),this.FEh=z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.d9g=0;this.IHh=new Date;this.MSe()===Hp.hidden&&this.W8h();$addHandler(window,"focus",this.umj);$addHandler(window,"blur",this.$me);$addHandler(document,"freeze",this.vmj);$addHandler(document,"visibilitychange",Object(ao.a)(this,this.wmj,"onPlatformVisibilityChangeHandler"));
this.FEh&&($addHandler(document,"pageshow",this.$me),$addHandler(document,"resume",this.$me))}get vA(){return this.d9g}get isVisible(){return 2!==this.vA}BHa(M){this.sa.addHandler("VST",M)}Kte(M){this.sa.removeHandler("VST",M)}NOf(){return this.MSe()===Hp.hidden?2:document.hasFocus()?0:1}eAc(M,fa){const Va=this.vA;this.d9g=fa;if(Va!==this.vA){3===Va&&this.Oph&&this.UMo();const Fb=new Date,Vb=new eq(Va,this.vA);Vb.report("FromState",pm.a[Va]);Vb.report("ToState",pm.a[fa]);Vb.report("OriginatingEvent",
M);Vb.report("TimeInState",(+Fb-+this.IHh).toString());this.IHh=Fb;this.FSk.daj(Vb);this.sa.raiseEvent("VST",Vb)}}wmj(M){this.MSe()===Hp.hidden?this.wlb?this.Jb.Z3(this.wlb,this.aeh):this.W8h():(this.S2h(),this.eAc(M?M.type:"",this.NOf()))}dispose(){$removeHandler(window,"focus",this.umj);$removeHandler(window,"blur",this.$me);$removeHandler(document,"freeze",this.vmj);$removeHandler(document,"visibilitychange",Object(ao.a)(this,this.wmj,"onPlatformVisibilityChangeHandler"))}S2h(){this.wlb&&(this.Jb.wf(this.wlb),
this.wlb=null)}W8h(){this.wlb=new Gf.a(4,1,this.aeh,this.jYm,157);this.Jb.$b(this.wlb)}UMo(){this.KHh=new Date;this.Jb.$b(this.PXc(0,"Realtime"));this.Jb.$b(this.PXc(1,"AboveNormal"));this.Jb.$b(this.PXc(2,"Normal"));this.Jb.$b(this.PXc(3,"Background"));this.Jb.$b(this.PXc(4,"Low"))}PXc(M,fa){return new Gf.a(M,1,0,this.vHn,0,fa)}}Object(u.a)(Vs,"VisibilityManager",null,[907,10]);class xp{daj(){}}Object(u.a)(xp,"NullVisibilityManagerTelemetry",null,[903]);class xq{constructor(){this.sa=new Be.a}daj(M){Na.ULS.sendTraceTag(590901976,
324,50,M.toString())}static create(){return new xq}}Object(u.a)(xq,"VisibilityManagerTelemetry",null,[903]);class tr{constructor(){this.Z=null}get name(){return"Common.App.VisibilityManager"}init(){this.Z.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const M=this.Z.Oa("Common.App.VisibilityManagement.VisibilityManager");M&&M.dispose()}wc(M){this.Z=M;this.Z.register(xq,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").Ud(()=>
xq.create()).ha();this.Z.register(Vs,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").Ud(()=>new Vs(z.AFrameworkApplication.pc,()=>window.document.visibilityState,6E4*z.AFrameworkApplication.J.jc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Z.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ha()}static main(){x.a.instance.Mc(new tr)}}Object(u.a)(tr,"VisibilityManagerPackage",null,[0,1]);class Qj{constructor(){this.MaxUsedJSHeapSize=
this.MaxTotalJSHeapSize=this.InitialUsedJSHeapSize=this.InitialTotalJSHeapSize=this.JsHeapSizeLimit=0}}Object(u.a)(Qj,"MemoryUsageData",null,[]);class fg{constructor(M,fa,Va=null,Fb=null,Vb=3E5){this.ji=!1;this.WFb=null;this.k3a=new Qj;this.D4a=null;this.TWe=!1;this.f3a=0;this.FCa=()=>{this.WFb&&this.q5j(1)};this.Lma=()=>{this.WFb||this.cxb()};this.b8j=()=>{this.TWe&&this.u5f(2);this.WDh&&(this.WDh.MemoryUsageData=this.k3a)};if(void 0===M||null===M)throw Error.argumentNull("taskManager is null");
this.Jb=M;if(void 0===fa||null===fa)throw Error.argumentNull("sessionExpirationManager is null");this.Wda=fa;this.Wda.$lb(this.FCa);this.Wda.gTa(this.Lma);this.WDh=Va;Fb&&(this.D4a=Fb,this.D4a.nPh(this.b8j));if(0>=Vb)throw Error.argumentNull("wordMemorySamplingIntervalMS is less than or equal to zero.");this.HKh=Vb;void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.memory&&null!==window.performance.memory&&(this.TWe=!0)}cxb(){this.TWe&&Pe.a.tue()&&!this.Wda.ARf()&&
(this.WFb=new Gf.a(3,2,this.HKh,()=>{window.requestIdleCallback(()=>{this.ji||this.u5f(0)},{["timeout"]:this.HKh})},155,null,!0),this.Jb.$b(this.WFb))}u5f(M){const fa=window.performance.memory;Na.ULS.sendTraceTag(593049030,306,50,"JsHeapSizeLimit={0} Bytes, TotalJSHeapSize={1} Bytes, UsedJSHeapSize={2} Bytes, Source={3}, Log#{4}",fa.jsHeapSizeLimit,fa.totalJSHeapSize,fa.usedJSHeapSize,M,++this.f3a);this.k3a.JsHeapSizeLimit||(this.k3a.JsHeapSizeLimit=fa.jsHeapSizeLimit,this.k3a.InitialTotalJSHeapSize=
fa.totalJSHeapSize,this.k3a.InitialUsedJSHeapSize=fa.usedJSHeapSize);this.k3a.MaxTotalJSHeapSize<fa.totalJSHeapSize&&(this.k3a.MaxTotalJSHeapSize=fa.totalJSHeapSize);this.k3a.MaxUsedJSHeapSize<fa.usedJSHeapSize&&(this.k3a.MaxUsedJSHeapSize=fa.usedJSHeapSize)}q5j(M){this.u5f(M);this.Jb.wf(this.WFb);this.WFb=null;Na.ULS.sendTraceTag(593049029,306,50,"LogMemoryUsage task unregistered")}dispose(){this.ji||(this.Wda.Kkd(this.FCa),this.Wda.mZb(this.Lma),this.D4a&&this.D4a.DDj(this.b8j),this.WFb&&this.q5j(3),
this.ji=!0)}get zs(){return this.ji}}Object(u.a)(fg,"AppMemoryProfiler",null,[10]);class ym{constructor(){this.uDc=null}get name(){return"Common.App.MemoryProfileTelemetry"}init(){z.AFrameworkApplication.J.vp(()=>{this.uDc=ym.Z.resolve("Common.App.MemoryProfileTelemetry.AppMemoryProfiler");this.uDc.cxb()})}dispose(){this.uDc&&(this.uDc.dispose(),this.uDc=null)}wc(M){ym.Z=M;ym.Z.register(fg,"Common.App.MemoryProfileTelemetry.AppMemoryProfiler").ha().Ud(()=>new fg(Ae.a.instance,M.resolve("Common.ISessionExpirationManager"),
z.AFrameworkApplication.fh,si.a.instance,z.AFrameworkApplication.J.jc("WordMemorySamplingInterval",3E5)))}static main(){x.a.instance.Mc(new ym)}}ym.Z=null;Object(u.a)(ym,"MemoryProfileTelemetryPackage",null,[0,1]);class Yo{static I4d(M){try{return caches.open(Yo.D$g).then(fa=>fa.match(M))}catch(fa){return Promise.reject(null)}}static yqb(M,fa){try{return Yo.I4d(M).then(Va=>Va&&Number.parseInvariant(Va.headers.get("cachedTime"))>Date.now()-fa?Promise.resolve(Va.text().toLocaleString()):Promise.reject("Not found")).catch(()=>
Promise.reject("Cache returned undefined"))}catch(Va){return Promise.reject(null)}}static store(M,fa){try{return caches.open(Yo.D$g).then(Va=>{Va.put(M,fa).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(Va){return Promise.resolve(!0)}}static Xep(M,fa){const Va={};Va.body=fa;const Fb={};Fb.cachedTime=Date.now().toString();Va.headers=Fb;fa=new Response(fa,Va);Yo.store(M,fa).then(()=>!0)}}Yo.D$g="ConsentState";Object(u.a)(Yo,"CacheManager",null,[]);class is{constructor(){this.message=null;
this.httpStatusCode=0}}Object(u.a)(is,"HttpRequstToPromiseRejectData",null,[]);class hu{constructor(M){this.es=M}Ita(M,fa,Va,Fb,Vb,wc){cb.a.sendTelemetryEvent(Object.assign(new ob.a,{name:"Office.Online."+M,dataFields:[Object.assign(new tb.a,{name:"EventMessage",string:fa}),Object.assign(new tb.a,{name:"FormFactor",string:this.es.formFactor}),Object.assign(new tb.a,{name:"CorrelationId",string:this.es.correlationId}),Object.assign(new tb.a,{name:"AccountType",string:this.es.accountType}),Object.assign(new tb.a,
{name:"OSVersion",string:this.es.osVersion}),Object.assign(new tb.a,{name:"AppId",string:this.es.appId}),Object.assign(new tb.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new tb.a,{name:"ConsentLanguage",string:this.es.consentLanguage}),Object.assign(new tb.a,{name:"EventCode",string:Va}),Object.assign(new tb.a,{name:"Region",string:this.es.region}),Object.assign(new tb.a,{name:"ModelType",string:Fb}),Object.assign(new tb.a,{name:"ModelId",string:Vb}),Object.assign(new tb.a,{name:"Platform",
string:this.es.os}),Object.assign(new tb.a,{name:"ReConsentReason",string:""}),Object.assign(new tb.a,{name:"ConsentType",string:wc})]}))}}Object(u.a)(hu,"TelemetryLogger",null,[]);class js{constructor(M,fa,Va){this.zrk="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Aa=M;this.If=fa;this.Hlb=Va;this.W5=new hu(Va)}NMb(M,fa){return new Promise((Va,Fb)=>{const Vb=this.Aa.jc("UCNoticeCheckinCallTimeoutMs",5E3);let wc=this.Aa.jb("UCNoticeCheckinStateUrl");wc&&wc.length||(wc=this.zrk);
this.If.x5a(wc,1,null,this.l3c(M),null,0,Xc=>{try{if(void 0===Xc||null===Xc||void 0===Xc.data||null===Xc.data||void 0===Xc.data.Pe||null===Xc.data.Pe){this.W5.Ita("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const Dd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Fb(this.m7(Dd,Xc))}else if(Xc.data.He!==oj.a.qz){this.W5.Ita("UnifiedConsent.ConsentGetFailed",
"CheckInApi : HTTP failure",Xc.data.He.toString(),null,null,null);const Dd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Xc.data.He,"UnifiedConsent.ConsentGetFailed");Fb(this.m7(Dd,Xc))}else{var vd=fa(Xc.data.Pe);if(vd)Va(vd);else{this.W5.Ita("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const Dd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Fb(this.m7(Dd,Xc))}}}catch(Dd){this.W5.Ita("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Dd,"UnifiedConsent.ConsentGetFailed"),Fb(this.m7(vd,Xc))}},Xc=>{this.W5.Ita("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Xc.data.He.toString(),null,null,null);const vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Xc.data.He,"UnifiedConsent.ConsentGetFailed");Fb(this.m7(vd,Xc))},void 0,void 0,2500,Vb)})}m7(M,fa){const Va=new is;Va.message=M;Va.httpStatusCode=fa&&fa.data?fa.data.He:-1;return Va}l3c(M){const fa={};fa["Accept-Language"]=this.Hlb.consentLanguage;fa.consentsurface="AppStart";fa.platform="Web";fa.formfactor=D.a.O9c?"Mobile":"Desktop";fa["x-Cid"]=this.Hlb.correlationId;fa.Authorization="Bearer "+M;return fa}}Object(u.a)(js,"HttpRequestToPromiseUtility",null,[]);class Ws{constructor(){this.accountType=
"MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(u.a)(Ws,"WebSdkAdapterProps",null,[]);class Lo{constructor(M,fa,Va,Fb){this.Clh=this.x1a=this.nGa=this.kxa=null;this.R$n=Vb=>{if(void 0===Vb||null===Vb)return this.W5.Ita(Lo.rFb,"Checkin response undefined or null",
"705",this.kxa,this.nGa,this.x1a),null;try{const {av:wc}=Hf.d(Vb);return wc}catch(wc){this.W5.Ita(Lo.rFb,"Checkin response parse error : "+wc.message,"706",this.kxa,this.nGa,this.x1a)}return null};this.c4b=Fb;this.Aa=M;this.Cok=Va;this.If=fa;this.Hlb=this.getDimensions();this.W5=new hu(this.Hlb)}z7o(){"MSA"===(this.Aa.jb("HostAuthType")||"").toUpperCase()&&Yo.yqb(this.Hlb.userId,this.Aa.jc("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.W5.Ita(Lo.rFb,"CacheFound","701",this.kxa,this.nGa,this.x1a);
return{}}).catch(()=>{this.Cok.execute(M=>{M.tV("Consent",Lo.IPk).then(fa=>{fa.IsSuccess?(this.W5.Ita(Lo.rFb,"CheckInTokenSuccess","702",this.kxa,this.nGa,this.x1a),this.cnm(fa.Token).then(Va=>{this.zAm(Va);this.kxa&&""!==this.kxa&&M.tV("Consent",Lo.LPk).then(Fb=>{Fb.IsSuccess?(this.W5.Ita(Lo.rFb,"WebTokenSuccess","703",this.kxa,this.nGa,this.x1a),this.a9o(Fb,this.kxa)):this.W5.Ita(Lo.rFb,"WebTokenFailed : "+Fb.ErrorMessage,Fb.ErrorCode,this.kxa,this.nGa,this.x1a);return{}});return{}})):this.W5.Ita(Lo.rFb,
"CheckInTokenFailed : "+fa.ErrorMessage,fa.ErrorCode,this.kxa,this.nGa,this.x1a);return{}})})})}cnm(M){this.Clh=new js(this.Aa,this.If,this.Hlb);return this.Clh.NMb(M,this.R$n).then(fa=>Promise.resolve(fa),fa=>Promise.reject("Error while getting result"+fa))}zAm(M){for(const fa of M.consentValues)if(fa.needConsent&&!fa.maxPromptsReached){this.nGa=fa.id;this.x1a=fa.consentType;this.kxa=fa.modelType;return}Yo.Xep(this.Hlb.userId,Hf.c(M))}a9o(M,fa){if(Up.a("showConsentNotice")){const Va=document.createElement("div");
document.body.appendChild(Va);appChrome.api.showConsentNotice(this.hqm(M.Token,fa),Va)}else this.W5.Ita(Lo.hxa,"1JS : ShowConsentNotice API not found","704",this.kxa,this.nGa,this.x1a)}hqm(M,fa){const Va=this.Hlb;Va.token=M;Va.modelType=fa;return Va}getDimensions(){const M=this.TTf(this.Aa.jb("SessionStartInfoJson"));return Object.assign(new Ws,{emailId:this.Aa.jb("UserPrincipalName"),userId:this.Aa.jb("LoggableUserId"),accountType:"AAD"===(this.Aa.jb("HostAuthType")||"").toUpperCase()?"AAD":"MSA",
appId:this.Aa.jb("OfficeApplicationId"),appVersion:this.Aa.jb("appVersion"),appName:"Application"in M?M.Application:"",appEnv:this.c4b,consentLanguage:this.Aa.jb("UICulture")||"en-US",formFactor:D.a.O9c?"Mobile":"Desktop",os:"Os"in M?M.Os:"",osVersion:"OsVersion"in M?M.OsVersion:"",region:this.Aa.jb("region"),correlationId:Kl.a.create().toString(),isDarkMode:this.Aa.$("DarkModeIsOn"),useCache:!0})}TTf(M){let fa={};try{fa=Hf.b(M)}catch(Va){}return fa}}Lo.LPk="https://consentservice.microsoft.com/web";
Lo.IPk="https://consentservice.microsoft.com/checkin";Lo.hxa="UnifiedConsent.ConsentGetFailed";Lo.rFb="UnifiedConsent.AuthTokenStatus";Object(u.a)(Lo,"ConsentNoticeManager",null,[902]);class Kr{constructor(){this.Z=null}get name(){return"Common.App.ConsentNoticeDialog"}wc(M){this.Z=M;M.register(Lo,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ha().Ud(()=>new Lo(z.AFrameworkApplication.J,z.AFrameworkApplication.Fe,M.Ta("Common.App.OAuth.IOAuthManager"),
z.AFrameworkApplication.R6))}init(){this.Z.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){x.a.instance.Mc(new Kr)}}Object(u.a)(Kr,"ConsentNoticeDialogPackage",null,[0,1]);class Pq{constructor(){this.D4a=this.Wda=null;this.kph=!1;this.FCa=this.FCa.bind(this);this.qne=this.qne.bind(this)}get name(){return"WordEditor.GraphNodeConnectLogger"}init(){}dispose(){this.Wda&&this.Wda.Kkd(this.FCa);this.D4a&&this.D4a.DDj(this.qne)}wc(M){this.Wda=M.resolve("Common.ISessionExpirationManager");
this.Wda.$lb(this.FCa);this.D4a=si.a.instance;this.D4a.nPh(this.qne)}FCa(){this.D$i()}qne(){this.D$i()}D$i(){!this.kph&&z.AFrameworkApplication.fh.GraphNodeConnectPerf&&(Na.ULS.sendTraceTag(528799697,324,50,"{0}",{["Metric"]:"OnConnect",["Max"]:1E3*z.AFrameworkApplication.fh.GraphNodeConnectPerf.MaxOnConnectTime,["Avg"]:1E3*z.AFrameworkApplication.fh.GraphNodeConnectPerf.AvgOnConnectTime}),this.kph=!0)}static main(){x.a.instance.Mc(new Pq)}}Object(u.a)(Pq,"GraphNodeConnectLogger",null,[0,1]);var Ip=
d(59);class iu{eJf(){return"Comments"}C4o(M,fa){for(;fa!==M;){if(!fa){Na.ULS.sendTraceTag(523286082,306,15,"ShouldParseRevisions: iterRevision is null");break}if(20===fa.m8d())for(const Va of fa.OUb())if(this.q2i(Va))return!0;fa=fa.OG}return!1}U$n(M,fa){const Va={["AddedComment"]:0,["AddedCommentReply"]:0,["EditedComment"]:0,["EditedCommentReply"]:0,["DeletedComment"]:0,["DeletedCommentReply"]:0};for(;fa&&fa!==M;){if(20!==fa.m8d()){fa=fa.sm;continue}const Fb=new Set;for(const Vb of fa.OUb()){if(!Vb||
!this.q2i(Vb))continue;const wc=this.Rxm(fa,Vb.id);if(Vb.sc===Ip.a.mka){const {Tff:Xc,Yrg:vd}=this.iUl(wc,Vb);for(const Dd of Xc)this.Xae(Va,Fb,"AddedComment",fa.Eb(Dd));for(const Dd of vd)this.Xae(Va,Fb,"DeletedComment",fa.Eb(Dd))}else Vb.sc===Ip.a.ZK&&(null==wc?this.Xae(Va,Fb,"AddedComment",Vb):this.Xae(Va,Fb,"EditedComment",Vb))}fa=fa.sm}return Va}q2i(M){return M.sc===Ip.a.ZK||M.sc===Ip.a.mka}Xae(M,fa,Va,Fb){const Vb=Fb.id.toString();fa.has(Vb)||(fa.add(Vb),fa=this.fhn(Fb),M[Va+(fa?"Reply":"")]++)}fhn(M){return null!=
M.zf(dg.a.HO)}iUl(M,fa){let Va=[],Fb=[];M=null!=M&&M.hasProperty(Nf.a.rg)?M.getValue(Nf.a.rg):[];fa=null!=fa&&fa.hasProperty(Nf.a.rg)?fa.getValue(Nf.a.rg):[];if(0===fa.length)return Fb=Fb.concat(M),{Tff:Va,Yrg:Fb};if(0===M.length)return Va=Va.concat(fa),{Tff:Va,Yrg:Fb};for(const Vb of fa)M.find(wc=>Vb.equals(wc))||Va.push(Vb);for(const Vb of M)fa.find(wc=>Vb.equals(wc))||Fb.push(Vb);return{Tff:Va,Yrg:Fb}}Rxm(M,fa){return M.sm?M.sm.Eb(fa):null}}Object(u.a)(iu,"CommentRevisionDataLossParser",null,[855]);
var gq=d(894);class Ka{constructor(M,fa,Va,Fb){this.AJo=M;this.c4=fa;this.zDa=Va;this.EUb=Fb}initialize(){this.c4.AHa(this.t0.bind(this))}Wd(){this.c4.kZb(this.t0.bind(this))}get Tj(){return this.EUb.value}t0(){const M=this.Tj.Mm;if(M){var fa=this.aKf();fa||Na.ULS.sendTraceTag(512325714,306,15,"Unable to retrieve lastSavedRevision.");var Va={};for(const Fb of this.AJo)Fb.C4o(fa,M)&&(Va[Fb.eJf()]=Fb.U$n(fa,M));0===Object.keys(Va).length?Na.ULS.sendTraceTag(523081567,306,50,"No information was extracted from unsaved revisions"):
Na.ULS.sendTraceTag(523286081,306,15,JSON.stringify(Va))}else Na.ULS.sendTraceTag(512325715,306,50,"No unsaved changes since latestRevision is null.")}aKf(){const M=this.zDa.Gge;if(!M.equals(lo.a.nil)){const fa=this.Tj.store;return fa?fa.getRevision(M):(Na.ULS.sendTraceTag(512321539,306,15,"Object space store is null."),null)}return gq.a.qMf(this.Tj)}}Object(u.a)(Ka,"RevisionDataLossManager",null,[854]);class $a{constructor(){this.XKd=this.Z=null}get name(){return"WordEditor.RevisionDataLoss"}init(){this.XKd=
this.Z.resolve("WordEditor.RevisionDataLoss.IRevisionDataLossManager");this.XKd.initialize()}wc(M){this.Z=M;M.ia("WordEditor.RevisionDataLoss.RevisionDataLossManager",()=>new Ka([new iu],this.Z.resolve("Common.ISessionStatus")||Ve.SessionStatusManager.instance,this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),new Pd.a(()=>U.StaticActiveAppFrame.za().kb.hd.ud))).as("WordEditor.RevisionDataLoss.IRevisionDataLossManager").ha()}dispose(){this.XKd&&this.XKd.Wd()}static main(){x.a.instance.Mc(new $a)}}
Object(u.a)($a,"WordEditorRevisionDataLossPackage",null,[0,1]);class Hb{constructor(M,fa){this.c4=M;this.zDa=fa}initialize(){this.c4.AHa(this.t0.bind(this))}dispose(){this.c4.kZb(this.t0.bind(this))}async t0(){this.zDa.p$d(3E3).then(M=>{M&&(Na.ULS.sendTraceTag(509374796,306,15,`Session was kicked out with stuck data: [RevisionsWithoutSRSN: ${this.zDa.mfc()}]`),this.DFp())})}DFp(){const M=new $l.a;M.inStaging=!0;Uf.Health.instance.recordQosError("UnconfirmedDataOnSessionEnd",["DataStuck"],!1,!0,!1,
!0,M)}}Object(u.a)(Hb,"DisconnectedOperationManager",null,[79]);class uc{constructor(){this.Gzd=this.Z=null}get name(){return"WordEditor.DisconnectedOperation"}init(){this.Gzd=this.Z.resolve("WordEditor.DisconnectedOperation.IDisconnectedOperationManager");this.Gzd.initialize()}wc(M){this.Z=M;M.ia("WordEditor.DisconnectedOperation.DisconnectedOperationManager",()=>new Hb(this.Z.resolve("Common.ISessionStatus")||Ve.SessionStatusManager.instance,this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).as("WordEditor.DisconnectedOperation.IDisconnectedOperationManager").ha()}dispose(){this.Gzd&&
this.Gzd.dispose()}static main(){x.a.instance.Mc(new uc)}}Object(u.a)(uc,"DisconnectedOperationPackage",null,[0,1]);Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCommands");Type.registerNamespace("Box4.Emojis");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("WordEditor.CanvasContextual");Type.registerNamespace("WordEditor.ConvertToPpt");Type.registerNamespace("WordEditor.SendToKindle");
Type.registerNamespace("WordEditor.DictationCommands");Type.registerNamespace("WordEditor.DictationHost");Type.registerNamespace("WordEditor.EmergencyView");Type.registerNamespace("WordEditor.EquationTools");Type.registerNamespace("WordEditor.FidelityMetrics");Type.registerNamespace("WordEditor.Prague");x.a.instance.Mc(new dd);x.a.instance.Mc(new id);x.a.instance.Mc(new Mj);x.a.instance.Mc(new lc);mh.main();Ig.main();x.a.instance.Mc(new na);qr.main();$a.main();qn.main();Wo.main();Pq.main();Type.registerNamespace("Common.App.AppSettingsRefresh");
Us.main();Type.registerNamespace("Common.App.InProductMessaging");dk.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");Type.registerNamespace("Common.App.LivePersonaCard");Oq.main();Type.registerNamespace("Common.App.NetworkConnectivity");po.main();Type.registerNamespace("Common.App.VisibilityManagement");tr.main();Type.registerNamespace("Common.App.MemoryProfileTelemetry");ym.main();null!=z.AFrameworkApplication.J&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",
!1)&&(Type.registerNamespace("Common.App.PenMinutesManager"),wp.main());z.AFrameworkApplication.J&&z.AFrameworkApplication.J.$("DisconnectedScenarioIsEnabled")&&(Type.registerNamespace("WordEditor.DisconnectedOperation"),uc.main());null!=z.AFrameworkApplication.J&&z.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowUnifiedConsent",!1)&&(Type.registerNamespace("Common.App.ConsentNoticeDialog"),Kr.main())}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23047711/wdjs/WordEditorDS.box4.dll4.js.map