'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1061:function(I,J,d){function m(N,O=self){O.addEventListener("message",function V(X){if(X&&X.data){var {id:Q,type:T,path:ba}=Object.assign({path:[]},X.data),W=(X.data.WTh||[]).map(x);try{const Y=ba.slice(0,-1).reduce((ka,qa)=>ka[qa],N),da=ba.reduce((ka,qa)=>ka[qa],N);switch(T){case "GET":var aa=da;break;case "SET":Y[ba.slice(-1)[0]]=x(X.data.value);aa=!0;break;case "APPLY":aa=da.apply(Y,W);break;case "CONSTRUCT":const ka=
new da(...W);aa=Object.assign(ka,{[D]:!0});break;case "ENDPOINT":const {port1:qa,port2:ua}=new MessageChannel;m(N,ua);aa=w(qa,[qa]);break;case "RELEASE":aa=void 0;break;default:return}}catch(Y){aa={value:Y,[F]:0}}Promise.resolve(aa).catch(Y=>({value:Y,[F]:0})).then(Y=>{const [da,ka]=z(Y);O.postMessage(Object.assign(Object.assign({},da),{id:Q}),ka);"RELEASE"===T&&(O.removeEventListener("message",V),"MessagePort"===O.constructor.name&&O.close())})}});O.start&&O.start()}function f(N){if(N)throw Error("Proxy has been released and is not useable");
}function a(N,O=[],U=function(){}){let X=!1;const V=new Proxy(U,{get(Q,T){f(X);if(T===H)return()=>u(N,{type:"RELEASE",path:O.map(ba=>ba.toString())}).then(()=>{"MessagePort"===N.constructor.name&&N.close();X=!0});if("then"===T){if(0===O.length)return{then:()=>V};Q=u(N,{type:"GET",path:O.map(ba=>ba.toString())}).then(x);return Q.then.bind(Q)}return a(N,[...O,T])},set(Q,T,ba){f(X);const [W,aa]=z(ba);return u(N,{type:"SET",path:[...O,T].map(Y=>Y.toString()),value:W},aa).then(x)},apply(Q,T,ba){f(X);Q=
O[O.length-1];if(Q===y)return u(N,{type:"ENDPOINT"}).then(x);if("bind"===Q)return a(N,O.slice(0,-1));const [W,aa]=l(ba);return u(N,{type:"APPLY",path:O.map(Y=>Y.toString()),WTh:W},aa).then(x)},construct(Q,T){f(X);const [ba,W]=l(T);return u(N,{type:"CONSTRUCT",path:O.map(aa=>aa.toString()),WTh:ba},W).then(x)}});return V}function l(N){N=N.map(z);return[N.map(O=>O[0]),Array.prototype.concat.apply([],N.map(O=>O[1]))]}function w(N,O){R.set(N,O);return N}function z(N){for(const [O,U]of K)if(U.XZh(N)){const [X,
V]=U.serialize(N);return[{type:"HANDLER",name:O,value:X},V]}return[{type:"RAW",value:N},R.get(N)||[]]}function x(N){switch(N.type){case "HANDLER":return K.get(N.name).deserialize(N.value);case "RAW":return N.value}}function u(N,O,U){return new Promise(X=>{const V=v();N.addEventListener("message",function ba(T){T.data&&T.data.id&&T.data.id===V&&(N.removeEventListener("message",ba),X(T.data))});N.start&&N.start();N.postMessage(Object.assign({id:V},O),U)})}function v(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}I=d(0);const D=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),H=Symbol("Comlink.releaseProxy"),F=Symbol("Comlink.thrown"),G=N=>"object"===typeof N&&null!==N||"function"===typeof N,K=new Map([["proxy",{XZh:N=>G(N)&&N[D],serialize(N){const {port1:O,port2:U}=new MessageChannel;m(N,O);return[U,[U]]},deserialize(N){N.start();return a(N,[],void 0)}}],["throw",{XZh:N=>G(N)&&F in N,serialize({value:N}){return[N instanceof Error?
{MWa:!0,value:{message:N.message,name:N.name,stack:N.stack}}:{MWa:!1,value:N},[]]},deserialize(N){if(N.MWa)throw Object.assign(Error(N.value.message),N.value);throw N.value;}}]]),R=new WeakMap;d.d(J,"a",function(){return E});class E{static Clk(N){E.Whb=N;E.dTk=a(N,[],void 0)}static get Endpoint(){return E.Whb}static get Dlk(){return E.dTk}}Object(I.a)(E,"WorkerUtils",null,[])},1073:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}Object(I.a)(m,"WaterlineOverrideSettings",null,[])},
1074:function(I,J,d){I=d(0);var m=d(431),f=d(415),a=d(590),l=d(258),w=d(458);class z extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}Om(){return w.a.EFf}static qka(H,F,G){const K=new z;K.FileId=H;K.HighWaterline=F;K.LowWaterline=G;return K}}Object(I.a)(z,"GetActivitiesRequest",l.a,[]);class x extends l.a{constructor(H,F,G){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=H;this.Waterline=F;this.Settings=G}Om(){return w.a.gMf}static qka(H,F,
G){return new x(H,F,G)}}Object(I.a)(x,"GetRelevantActivitiesRequest",l.a,[]);class u extends l.a{constructor(H,F){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=H;this.WaterlineOverrideSettings=F}Om(){return w.a.tSm}static qka(H,F){return new u(H,F)}}Object(I.a)(u,"GetWywaActivitiesRequest",l.a,[]);class v{}Object(I.a)(v,"RelevantActivitiesSettings",null,[]);class D extends l.a{constructor(){super();this.FileId=null}Om(){return w.a.itd}static qka(H){const F=new D;F.FileId=H;return F}}
Object(I.a)(D,"UpdateWaterlineRequest",l.a,[]);d.d(J,"a",function(){return y});class y{constructor(H,F,G,K,R){this.wFk=H;this.dLd=F;this.w5e=G;this.vDc=K;this.qah=R}requestWYWAActivities(H){H=u.qka(this.dLd(),H);return m.a.then(this.taa(H,"wywa"),F=>F)}requestActivities(H,F){H=z.qka(this.dLd(),H,F);return m.a.then(this.taa(H,"activities"),G=>G)}pGo(){const H=D.qka(this.dLd());return m.a.then(this.taa(H,"waterline"),F=>F)}requestRelevantActivities(H,F){F=Object.assign(new v,{FirstDocumentOpen:F,MockDataEnabled:!1});
H=x.qka(this.dLd(),H,F);return m.a.then(this.taa(H,"relevant"),G=>G)}updateActivityState(H){return m.a.krd(this.qah,F=>F.evp(H.itemIds,H.activityStatesToSet,H.activityStatesToReset,H.resetUnseenCount))}requestActivityFeed(){return m.a.krd(this.qah,H=>H.FFf(null))}taa(H,F){const G={"Content-Type":"application/json; charset=utf-8"};return m.a.then(m.a.krd(this.wFk,K=>K.Hs(this.w5e,G,f.a.V5h(H,this.vDc),F)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.Pe))return null;({group:K}=a.a.D4(K.args.data.Pe));
return K&&K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(I.a)(y,"SharedActivityRepository",null,[])},1307:function(I,J,d){d.d(J,"a",function(){return f});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.XOp=1]="Inference"})(m||(m={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.ASp=1]="VoiceDictationBadge";a[a.BSp=2]="VoiceDictationPhrase"})(f||(f={}))},1509:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(2),f=d(6);class a{static get Vzb(){return!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.$("WordDesignerTelemetryPerConstructIsEnabled")}static Fqb(l,w=!1){const z=f.a.eb(l);z.Nd();return(w?z.Vb(4):z.zla(4))?4:f.a.eb(l).zb(36)?16:f.a.eb(l).zb(14)?2:f.a.eb(l).zb(38)?32:1}}Object(I.a)(a,"ConstructTypeHelper",null,[])},1537:function(I,J,d){d.d(J,"a",function(){return X});I=d(0);var m=d(195),f=d(19),a=d(238),l=d(2),w=d(219),z=d(5),x=d(71),u=d(11),v=d(768),D=d(130),y=d(257),H=d(3),F=d(82),G=d(63),K=d(36),R=d(462),E=d(166),N=d(20),O=d(254),U=d(7);class X{static get tg(){return O.a.instance}static get Ac(){return m.a.instance}static xy(){return X.Vn||
(X.Vn=f.a.instance.Ta("Box4.IExternalSelectionManager"))}static get jC(){return null!=X.h2g?X.h2g:X.h2g=f.a.instance.resolve("Box4.IParagraphIndentationReader")}static WOm(){this.KQ||(this.KQ=new x.a,this.KQ.add(H.a.pC),this.KQ.add(H.a.font),this.KQ.add(H.a.rY),this.KQ.add(H.a.Vya),this.KQ.add(H.a.bold),this.KQ.add(H.a.fA),this.KQ.add(H.a.superscript),this.KQ.add(H.a.subscript),this.KQ.add(H.a.r6a),this.KQ.add(H.a.Sya),this.KQ.add(H.a.aIa),this.KQ.add(H.a.cnf),this.KQ.add(H.a.bIa),this.KQ.add(H.a.q6a),
this.KQ.add(H.a.S2),this.KQ.add(H.a.l4),this.KQ.add(H.a.fE),this.KQ.add(H.a.lnb),this.KQ.add(H.a.qVc));return this.KQ}static snc(V){return X.WOm().contains(V)?!0:!1}static zx(V,Q,T,ba,W){var aa=!0;if(!Q.view.ve)return 2;var Y=Q.view,da=Y.lb;da&&da.gb.currentSelection||(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.Qn}),aa=!1);Object(E.a)().wIa(D.a.u9c,Y.lb.Pg)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.yqf}),aa=!1);if(Object(E.a)().wIa(D.a.y$a,Y.lb.Pg))return X.Ac.fc(F.a.Ne,{["Reason"]:G.a.uWc}),8;var ka=!X.snc(V);X.tg.xnc(Y.lb.Pg,
ka)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.UG}),aa=!1);Object(E.a)().wIa(D.a.Bde,Y.lb.Pg)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.sqf}),aa=!1);Object(E.a)().wIa(y.c,Y.lb.Pg)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.tqf}),aa=!1);Object(E.a)().wIa(v.a.XXf,Y.lb.Pg)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.rqf}),aa=!1);Object(E.a)().HEa(U.ParagraphReader.xX,Y.lb.Pg)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.XQ}),aa=!1);X.xy()&&X.xy().instance&&X.xy().instance.zX(Y.lb.Pg)&&(X.Ac.fc(F.a.Ne,{["Reason"]:G.a.Z7a}),aa=!1);var qa=null;da&&da.gb.currentSelection&&
(qa=da.gb.currentSelection);if(1===T||!aa||!qa)return aa?32:8;aa=V===H.a.iqc||V===H.a.pec||V===H.a.Pvc||V===H.a.Pic;Y=V===H.a.dYb||V===H.a.FNb||V===H.a.avc;ka=V===H.a.l_a||V===H.a.m_a||V===H.a.UE;const ua=new K.GraphTransaction(15);ua.Ab(qa.Qa.node);qa=new x.a;let Pa=!1;if(aa||Y||ka)a.a.mark(7121),Q=Object(E.a)().xri(Q.Lk);else{a.a.mark(7119);Q=R.OutlineElementGeneralizer.cla(da.gb,!0);if(!Q)return X.Ac.fc(F.a.asa,{["Reason"]:G.a.Y1d}),ua.dispose(),8;da=V===H.a.e$a||V===H.a.psb;Q.Ww&&da&&(Pa=X.xZm(qa,
Q))}(V===H.a.O7||V===H.a.iqc||V===H.a.X$||V===H.a.pec||V===H.a.t8||V===H.a.Pvc||V===H.a.TJa||V===H.a.Pic)&&Q.Ww&&1<Q.length&&X.yZm(Q)&&(W||(W={}),Object.getType(W)===Object&&(W.InContextSet=!0));l.AFrameworkApplication.va.Hf(Q,V,T,!0,ba,W);Pa&&X.KSn(qa,Q,W);ua.dispose();N.StaticActiveAppFrame.za().Ge();aa||Y||ka?a.a.mark(7122):a.a.mark(7120);return 32}static xZm(V,Q){if(!Q.Ww)return!1;let T=!1,ba=!1;for(let aa=0;aa<Q.length;aa++)if(Q.getContext(aa).Al){var W=Q.getContext(aa).node;W&&(W=X.jC.Sqb(W),
2===W.specialIndentType?(T=!0,V.add(aa)):1!==W.specialIndentType&&W.specialIndentType||(ba=!0))}return ba&&T}static KSn(V,Q,T){if(Q.Ww)for(let W=0;W<V.count;W++){var ba=Q.getContext(V.K(W));if(!ba.Al)continue;ba=ba.node;const aa=X.jC.Sqb(ba);2!==aa.specialIndentType||w.a.xBa(T.value,aa.RA)||ba.setValue(z.a.ke,aa.RA-aa.yha)}}static BAg(V,Q){let T=!0;Q.contextId!==u.a.paragraph?T=!1:X.tg.gab(Q)?(X.Ac.fc(F.a.Pn,{["Reason"]:G.a.UG}),T=!1):X.xy()&&X.xy().instance&&X.xy().instance.zX(Q)?(X.Ac.fc(F.a.Pn,
{["Reason"]:G.a.Z7a}),T=!1):Q.Al&&(Q=Q.node,U.ParagraphReader.Wb(Q)&&Q.RT&&(X.Ac.fc(F.a.Pn,{["Reason"]:G.a.XQ}),T=!1));return{returnValue:1!==V&&T,Hz:T?32:8}}static yZm(V){if(!V.Ww)return!1;let Q=1;for(let ba=0;ba<V.length;ba++){var T=V.getContext(ba);if(T&&T.Al&&T.contextId===u.a.paragraph&&(T=T.node))if(T=U.ParagraphReader.Xy(T),!ba)Q=T;else if(T!==Q)return!0}return!1}}X.Vn=null;X.KQ=null;Object(I.a)(X,"FormattingActionHelper",null,[])},1541:function(I,J,d){d.d(J,"a",function(){return f});d.d(J,
"b",function(){return a});var m=d(2);const f=l=>{switch(l){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var l;return null===(l=m.AFrameworkApplication.J)||void 0===l?void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}},1561:function(I,J,d){I=d(0);class m{constructor(z,x,u,v){this.csk=z;this.wLk=x;this.uLk=u;this.xLk=v}get nXd(){return this.csk}get Nue(){return this.wLk}get Lue(){return this.uLk}get resultType(){return this.xLk}}Object(I.a)(m,"SearchContext",null,[1904]);class f{xYd(z,x,u,v){var D=u-x;let y;if(100<=D)D=x,y=u;else{D=Math.max(0,x+Math.ceil(D/2)-50);y=Math.min(z.length,D+100);D=Math.max(0,y-100);let F;if(D&&" "!==z.charAt(D-1)){F=Math.min(x,D+10);for(var H=D;H<F;++H)if(" "===z.charAt(H)){D=H+
1;break}}if(y!==z.length&&" "!==z.charAt(y))for(F=Math.max(u,y-10),H=y-1;H>=F;--H)if(" "===z.charAt(H)){y=H;break}}z=z.substring(D,y);return new m(z,x-D,u-D,v)}yYd(z){return this.xYd(z.SCi(),z.Dc,z.end,"")}}Object(I.a)(f,"SearchContextFactory",null,[1891]);var a=d(104),l=d(1541);d.d(J,"a",function(){return w});class w extends f{constructor(){super()}yYd(z){let x=z.Dc,u=z.end;const v=({Dc:x,end:u}=w.rEm(z,x,u)).returnValue;z=l.a(z.type);return this.xYd(v,x,u,z)}static get instance(){return null!=w.jYg?
w.jYg:w.jYg=new w}static rEm(z,x,u){z=z.SCi();return w.ZBj(z,x,u)}static ZBj(z,x,u){const v=a.AParagraphNode.KP(z);if(v.length<z.length){z=z.substring(0,x);const D=a.AParagraphNode.KP(z);z=z.length-D.length;x-=z;u-=z}return{returnValue:v,Dc:x,end:u}}}Object(I.a)(w,"EditorSearchContextFactory",f,[])},1564:function(I,J,d){I=d(0);var m=d(2),f=d(19),a=d(399),l=d(734),w=d(21),z=d(20),x=d(140),u=d(50),v=d(559),D=d(202),y=d(229),H=d(79),F=d(26),G=d(7),K=d(3),R=d(5),E=d(59),N=d(481),O=d(1056);class U{create(){return new O.a}}
Object(I.a)(U,"FootnoteEndnoteContainerNodeFactory",null,[284]);var X=d(545);d.d(J,"a",function(){return V});class V{constructor(Q,T,ba,W,aa,Y,da,ka,qa){this.WOd=null;V.ga=Q;this.uG=ba;this.w2e=W;this.Frk=Y;this.fd=da;this.ib=aa;this.qFk=ka;this.Usk=qa;V.ii=T}Wje(Q,T){this.C1l(Q);Q.Vb(7);this.uG.aYi(Q,T)||Q.Kf(7)}C1l(Q){if(this.w2e.Q_i(Q)){var T=!1,ba=!1;if(Q.Vb(7)){do{const W=Q.currentNode;if(37===W.type)switch(W.getValue(R.a.Y6)){case 0:ba=!0;break;case 1:T=!0}}while(Q.Ci(7))}ba||this.HMh(Q,0);
T||this.HMh(Q,1)}}HMh(Q,T){const ba=this.Frk.create(E.a.PJa);ba.setValue(R.a.Y6,T);Q.Wf(ba,7)}BOo(Q){Q&&this.CKj(Q.esa)}CKj(Q){Q&&(Q=w.SelectionFactory.ue(Q.Ib.paragraph,Q.Ib.cp+1),this.ib.Kc(Q))}cRn(Q){let T=this.qFk(Q);void 0!==T&&null!==T?this.uG.ata(T)&&(T=this.uG.oDi(T)):T=Q;return this.Usk(T)}p$o(){this.WOd?V.ii.$J.removeEntry(this.WOd):this.WOd=V.ii.$J.yka(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);V.ii.$J.Iz(this.WOd)}m8k(Q,T){Q=this.fd.osa(Q,37,
37);let ba=!1;if(Q.je()){do{const W=Q.currentNode;this.uG.g0f(W)?this.MSh(W,T):ba=!0}while(Q.Tk())}ba&&this.p$o()}MSh(Q,T){N.f(Q,ba=>{V.hdm(ba,T);return!0},12)}eZm(Q,T){Q=this.uG.Z2c(Q,T);return Q?(Q=this.fd.mg(Q))?Q.QA():!1:!1}Pxi(Q,T){Q=this.uG.Z2c(Q,T);Q=this.fd.mg(Q);if(Q.je()){do if(T=Q.currentNode,1===T.getValue(R.a.fsa))return T;while(Q.Tk())}return null}static $2c(){return new V(m.AFrameworkApplication.va,z.StaticActiveAppFrame.za(),X.a.instance,x.PageReader.instance,u.a.instance,new U,new v.a,
D.OutlineNavigator.XQn,y.WordSectionNavigator.Tuf)}static get instance(){return null!=V.tYg?V.tYg:V.tYg=V.$2c()}static get ql(){return null!=V.c2g?V.c2g:V.c2g=f.a.instance.resolve("Box4.IParagraphEditor")}static hdm(Q,T){T.Irb?V.ql.fr.jha(Q,H.OutlineReader.u_(Q)):V.ql.fr.jha(Q,0);Q=F.a.createTextRange(Q,0,G.ParagraphReader.textLength(Q));V.ga.Hf(Q,K.a.font,2,!0,new a.a,new l.a(T.fontName));V.ga.Hf(Q,K.a.pC,2,!0,new a.a,new l.a(T.fontSize))}}V.ga=null;V.ii=null;Object(I.a)(V,"FootnoteEndnoteEditor",
null,[493])},1599:function(I,J,d){d.d(J,"a",function(){return E});I=d(0);var m=d(19),f=d(48),a=d(66),l=d(58),w=d(36),z=d(614),x=d(140),u=d(559),v=d(115),D=d(107),y=d(5),H=d(895),F=d(787),G=d(545),K=d(1491),R=d(1564);class E{constructor(N,O,U,X,V,Q){this.uG=N;this.IQa=U;this.w2e=X;this.HOe=V;this.fd=Q}static get Kg(){return null!=E.p4g?E.p4g:E.p4g=m.a.instance.Oa("Box4.Styles.StyleSettings")}abn(N,O,U){const X=this.oAi(O,N.node),V=N.node.Hc;if(!V)return null;const Q=new w.GraphTransaction(15);Q.Ab(N.node);
Q.Ph=U;U=this.bbn(X,O);E.cbn(U,V,N,O);Q.dispose();return U}oAi(N,O){const U=this.fd.Ql();U.set(O);U.zb(7);U.kd(7);this.IQa.Wje(U,N);return U}bbn(N,O){const U=F.a.createNode();U.properties.setValue(y.a.Y6,O);N.Wf(U,8);this.HOe.aFl(U,O);return U}static get Cg(){return null!=E.ASg?E.ASg:E.ASg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get U0(){return E.vT||(E.vT=new z.WACStyleSet)}static set U0(N){E.vT=N}static $2c(){const {FootnoteEndnoteDefaultContentInserter:N}=d(1716);return new E(G.a.instance,
K.a.instance,R.a.instance,x.PageReader.instance,N.instance,new u.a)}static get instance(){return null!=E.cZg?E.cZg:E.cZg=E.$2c()}static cbn(N,O,U,X){a.a.xd().xm&&a.a.xd().Bk.IG(U.node);const V=new v.a;V.setValue(y.a.yic,N.id);V.setValue(y.a.Y6,X);const Q=O.hu(V,f.a.create());E.Cg.Lla(U,T=>H.a.getInstance(T,Q,N.id),E.vui(U.node,X,Object(D.a)()))}static vui(N,O,U){let X=null;if(N=U.Iu(N))if(N=E.U0.Uaa(N))O=O?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference,
this.Kg.vn?(O=N.gv().GAa(O),X=N.nh(l.a.Yb.Be(O))):X=N.qKa(O);return X}}E.vT=null;Object(I.a)(E,"FootnoteEndnoteInserter",null,[668])},1604:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{static wEo(f,a){m.c2e=f;m.p5e=a}static tEo(f,a){m.m5e=f;m.W4a=a}static kFi(){return m.m5e===m.W4a?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,m.W4a,m.c2e,m.p5e):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,m.m5e,m.W4a,m.c2e,m.p5e)}}m.m5e=0;m.W4a=0;m.c2e=
null;m.p5e=null;Object(I.a)(m,"ReplaceAllContext",null,[])},1643:function(I,J,d){d.r(J);I=d(0);var m=d(2131),f=d(48),a=d(2),l=d(464),w=d(19),z=d(2176),x=d(20),u=d(8),v=d(272),D=d(2133),y=d(12),H=d(18),F=d(1561);class G{constructor(rb="",Cb="",Kb=!1,$b=!1){this.jon=Kb;this.Yrn=$b;this.actionId=rb;this.ZNa=Cb}}Object(I.a)(G,"SearchEntryPointContext",null,[]);class K{constructor(rb){this.tja=null;this.ey=!1;this.mQ=rb}initialize(){this.g2();this.$A();this.Y$(0)}$A(){this.tja.$A()}dispose(){this.mQ=null}n4c(){return!1}get eI(){return this.tja?
this.tja.eI:0}Y$(rb){this.tja.Y$(rb)}get isVisible(){return this.ey}yef(rb){this.tja&&this.tja.YTp(rb)}ZCj(rb){this.tja&&this.tja.cjq(rb)}Y8j(rb){this.tja&&this.tja.Kqq(rb)}n2h(){this.tja&&this.tja.FWp()}Tve(rb){this.tja&&this.tja.Tve(rb)}}Object(I.a)(K,"FindReplacePane",null,[684,10]);var R=d(83),E=d(86),N=d(1893),O=d(1282),U=d(207),X=d(196),V=d(1527),Q=d(91),T=d(114),ba=d(85),W=d(41),aa=d(1393),Y=d(880),da=d(1433),ka=d(1402),qa=d(1439),ua=d(1436),Pa=d(95),Ja=d(1084);class Ca{constructor(rb){this.fXk=
(Cb,Kb)=>{this.XOd.tb(Cb)?this.XOd.W(Cb,Kb):this.XOd.add(Cb,Kb);(Cb=this.aim(Cb))&&this.cUi(Kb,Cb,this.s7h(ka.a.getTypeName()))};this.XOd=new Pa.a;this.JY=new Pa.a;this.annotationType=da.RoleDetectionAnnotation.getTypeName();rb.Yto(this.fXk)}gH(rb,Cb){let Kb;const $b=rb.parentPath.substr(rb.parentPath.lastIndexOf("\\")+1),ab=rb.content;if(!ab||this.Drn(ab))""!==$b&&({value:Kb}=this.XOd.Ec($b,Kb)).returnValue&&this.cUi(Kb,rb,this.s7h(Cb)),Cb===ka.a.getTypeName()?(Cb=null,({value:Cb}=this.JY.Ec($b,
Cb)).returnValue?this.JY.W($b,rb):this.JY.add($b,rb)):Cb===qa.a.getTypeName()&&this.JY.remove($b)}cUi(rb,Cb,Kb){const $b=this.lym(Cb);Cb=this.bim(Cb);0<Cb&&rb(Kb,$b,Cb)}bim(rb){try{return Number.parseInvariant(rb.id.substr(2))}catch(Cb){u.ULS.sendTraceTag(554747009,367,10,Cb.toString())}return-1}aim(rb){let Cb;return({value:Cb}=this.JY.Ec(rb,Cb)).returnValue?Cb:null}Chd(rb){if(rb)for(const Cb of rb)this.gH(Cb,"AugLoop_Core_AddOperation")}lym(rb){if(rb=rb.content)switch(rb.roleType){case da.RoleType.Heading1:return 1;
case da.RoleType.Heading2:return 2;case da.RoleType.Heading3:return 3;case da.RoleType.Heading4:return 4;case da.RoleType.Heading5:return 5;case da.RoleType.Heading6:return 6;case da.RoleType.Heading7:return 7;case da.RoleType.Heading8:return 8;case da.RoleType.Heading9:return 9}return-1}Drn(rb){rb=rb.roleType;return rb===da.RoleType.Heading1||rb===da.RoleType.Heading2||rb===da.RoleType.Heading3||rb===da.RoleType.Heading4||rb===da.RoleType.Heading5||rb===da.RoleType.Heading6||rb===da.RoleType.Heading7||
rb===da.RoleType.Heading8||rb===da.RoleType.Heading9}s7h(rb){if(rb===ka.a.getTypeName()||rb===ua.a.getTypeName())return Ja.a.HNh;if(rb===qa.a.getTypeName())return Ja.a.pvf;throw Error.create("Invalid operation type");}}Object(I.a)(Ca,"RoleDetectionAnnotationHandler",null,[114]);var ra=d(147),Ea=d(61),xa=d(1791),Ma=d(50),ha=d(71),la=d(109);class Fa{constructor(rb){this.JY=new Pa.a;this.Cwh=rb}gH(rb,Cb){Cb===ka.a.getTypeName()?(Cb=null,({value:Cb}=this.JY.Ec(rb.id,Cb)).returnValue?this.JY.W(rb.id,rb):
this.JY.add(rb.id,rb)):Cb===qa.a.getTypeName()&&this.JY.remove(rb.id);this.Cwh&&this.Cwh()}Chd(rb){if(rb)for(const Cb of rb)this.gH(Cb,ka.a.getTypeName())}getAnnotations(){var rb;const Cb=[];if(0<(null===(rb=this.JY)||void 0===rb?void 0:rb.count))for(const Kb of this.JY.values)Cb.push(Kb);return Cb}}Object(I.a)(Fa,"ContractEntityAnnotationHandler",null,[114]);var Ga=d(3),va=d(1650);class pa{constructor(rb){this.ga=rb}pXn(){this.nUd()}qZn(rb){this.ga.Qb(H.a.B9d,2,rb)}w1n(){va.a.CDe();this.nUd()}nUd(){this.ga.Ob(Ga.a.eec,
2)}K3n(){this.ga.Ob(Ga.a.xCf,2)}onSearchQueryChanged(rb){this.ga.Qb(Ga.a.yCf,2,rb)}o5n(){this.ga.Ob(H.a.replace,2)}p5n(){this.ga.Ob(H.a.replaceAll,2)}k5n(){this.ga.Ob(y.a.tCf,2)}l5n(){this.ga.Ob(y.a.NCf,2)}n5n(){this.ga.Ob(Ga.a.dlg,2)}m5n(){this.ga.Ob(Ga.a.abg,2)}zuc(rb){this.ga.Qb(H.a.zuc,2,rb)}}Object(I.a)(pa,"FindReplaceActions",null,[722]);var Oa=d(155);class Ra{}Ra.rS=Oa.a.Jpb;Ra.ktc=0;Ra.Cza="FindReplaceTaskPaneData";Ra.pV=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(I.a)(Ra,
"FindReplaceConstants",null,[]);var fb=d(783);class qb{J3j(rb){var Cb,Kb,$b;return Y.a.m9a(null===($b=null===(Kb=null===(Cb=x.StaticActiveAppFrame.za())||void 0===Cb?void 0:Cb.kb)||void 0===Kb?void 0:Kb.hd)||void 0===$b?void 0:$b.ud,rb)}clearSelection(){if(this.jZe){const rb=this.J3j(this.jZe);rb&&rb.Xqa()}this.jZe=this.wDh=null}sOo(rb){this.clearSelection();if(rb){const Cb=this.J3j(rb.parentPath);if(Cb){const Kb=rb.content;Kb&&(this.wDh=rb.id,Cb.f_a([new fb.a(Kb.range.start,Kb.range.start+Kb.range.length)]),
Cb.U6f(0,1));this.jZe=rb.parentPath}}}}Object(I.a)(qb,"RangeAnnotationContentSelector",null,[]);var mb=d(1604);class eb{constructor(rb){this.zDk=rb}get Ak(){return this.zDk.value}VBm(rb){rb=this.Ak.k9a(rb);return this.Ckn(rb)?null:rb}Ckn(rb){return rb.id===this.Ak.IJa.id}static get instance(){return null!=eb.NXg?eb.NXg:eb.NXg=eb.YG()}static YG(){const rb=new v.a(()=>z.a.instance.Ak);return new eb(rb)}}Object(I.a)(eb,"SearchResultOrder",null,[]);var bb=d(7),Wa=d(104),Za=d(240);class Na{constructor(rb){this.GZe=
rb}get uH(){return this.GZe.value}getSelectedText(){var rb,Cb=this.uH.cfa;const Kb=null===(rb=a.AFrameworkApplication.J)||void 0===rb?void 0:rb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isImageSelectedTextFixEnabled",!1);if(Cb){rb=Cb.cpBegin;const $b=Cb.cpEnd-rb;if(0<$b&&(Cb=Cb.node,bb.ParagraphReader.Wb(Cb)))return Cb=Cb.characterData.substr(rb,$b),Kb?Wa.AParagraphNode.KP(Cb,""):Cb}return null}static getInstance(){return Na.Qm()}static Qm(){const rb=new v.a(()=>Za.a.instance);return new Na(rb)}}
Object(I.a)(Na,"SelectionHelper",null,[]);var Db=d(30),nb=d(93),Ta=d(878),cb=d(883),sb=d(312),pb=d(879),tb=d(1910);Oa=d(199);var wb=d(237),gc=d(346),vc=d(107),Pc=d(661);class ld extends Oa.a{constructor(rb,Cb,Kb){super(rb,Cb,wb.a.Asa());this.aNa=Kb;this.ZMi=!1}get d1f(){return!0}get Rla(){return super.Rla|248}static VJl(rb){var Cb=x.StaticActiveAppFrame.za().kb.hd;const Kb=gc.a.instance.Lc(3);Cb&&(Cb=Object(vc.a)().qU(Cb))&&(rb=new ld(new Pc.a,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),rb),
Kb.zod(rb.Ic),rb.rF(Cb),Kb.dispose(),rb.ZMi=!0)}}Object(I.a)(ld,"WordNavigationPaneReactHeadingsView",Oa.a,[150,80,10]);class Dc extends Sys.EventArgs{constructor(){super()}}Object(I.a)(Dc,"FindReplaceToggleEventArgs",Sys.EventArgs,[]);class ic extends K{constructor(rb,Cb,Kb,$b,ab,ia,La,Mb,Ha,zb,ac,nc,Gb,tc){var Qb,Yb;super(rb);this.UDb=Ra.rS;this.UPk="FindReplaceTaskPaneProps";this.Zb=R.FocusManager.instance();this.B1a=this.qSa=this.D1=this.u9e=null;this.jd=new E.a;this.GCf="findReplacePaneToggled";
this.l4b=a.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled");this.Tnk=a.AFrameworkApplication.J.$("AutoDetectedHeadingsIsEnabled");this.oFk=null===(Qb=a.AFrameworkApplication.J)||void 0===Qb?void 0:Qb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.h9b=null===(Yb=a.AFrameworkApplication.J)||void 0===Yb?void 0:Yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneAutoFocusOnScroll",!1);this.I7j=()=>{this.isVisible&&this.UYd===D.a.intelligentPlaceholder&&
this.Um()};this.HC=new N.a;this.Fjh=Cb;this.bQa=D.a.headings;this.ARc=m.a.initial;this.Mwa=new ha.a;this.yQ="";this.xHc={matchCase:!1,matchWholeWord:!1};this.o5e="";this.b7e=null;this.V5=Kb;this.cFh=!1;this.Jkb=$b;this.ib=ab;this.GFk=ia;this.kHa=La;this.KK=Mb;this.XHd=!0;this.e$=this.d$=!1;this.Re=Ha;this.YD=zb;this.Jb=ac;this.IY=nc;this.rch=Gb;this.Fl=tc;this.pKe&&this.kHa.Pxo(()=>{this.Um()});this.h9b&&(this.Yme=this.Yme.bind(this))}get b$e(){return 1}get pKe(){return this.l4b&&this.Tnk&&!!this.Re}get qKe(){return this.l4b&&
this.oFk&&!!this.Re}W2k(rb){this.jd.addHandler(this.GCf,rb)}OCo(rb){this.jd.removeHandler(this.GCf,rb)}eyj(rb){this.jd.raiseEvent(this.GCf,new Dc(rb))}Jxo(rb){this.W2k(rb)}tBo(rb){this.OCo(rb)}get headingsReady(){return this.YD?this.YD.headingsReady:!1}set headingsReady(rb){this.YD&&(this.YD.headingsReady=rb)}get UYd(){return this.bQa}lUj(){this.bQa=D.a.headings;this.Um()}E7o(){this.bQa=D.a.contracts;this.Um()}cUj(){this.bQa=D.a.find;W.a("NavigationPaneFind");this.Um()}TUj(){this.bQa=D.a.replace;
this.Um()}yUj(){this.bQa=D.a.intelligentPlaceholder;this.Um()}mpd(rb){this.cFh=rb;this.Um()}n4c(){return this.UYd===D.a.replace}get eI(){return this.ARc}Y$(rb){this.ARc=rb;this.Um()}yef(rb){this.GZk(rb);this.Um()}GZk(rb){const Cb=this.GFk(rb[rb.length-1]);if(Cb){let Kb=-1;for(let $b=0;$b<this.Mwa.count;$b++)if(Cb.id===this.Mwa.K($b).id){Kb=$b;break}-1===Kb?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Mwa.SA(Kb,this.S7h(rb))}else this.Mwa.addRange(this.S7h(rb))}ZCj(rb){for(const Cb of rb)for(rb=
this.Mwa.count-1;0<=rb;rb--)if(this.Mwa.K(rb).id===Cb.id){this.Mwa.removeAt(rb);break}this.Um()}Y8j(rb){for(const Cb of rb)for(rb=this.Mwa.count-1;0<=rb;rb--)if(this.Mwa.K(rb).id===Cb.id){this.Mwa.W(rb,this.R7h(Cb));break}this.Um()}n2h(){this.Mwa.clear();this.b7e=null;this.Um()}Tve(rb){this.b7e=rb?rb.id:null;this.Um()}S7h(rb){if(!rb)return new ha.a;const Cb=new ha.a;for(const Kb of rb)Cb.add(this.R7h(Kb));return Cb}R7h(rb){const Cb=this.Jkb.yYd(rb);return{id:rb.id,searchBeginIndex:Cb.Nue,searchEndIndex:Cb.Lue,
searchResult:Cb.nXd}}uEe(){}lBp(){var rb={};this.mQ.zuc(rb);rb=rb[O.a.Value];this.u9e=aa.c(rb)?"":rb;this.Um()}uVa(){return this.yQ}KQb(){return this.o5e}Xxg(rb){this.yQ=rb;this.Um()}gIa(){}initialize(){this.yMd=window.performance.now();const rb=this.Zb.ie(this.UDb);rb.parent=U.AFrame.Gq;rb.IL=!0;this.g2();this.Y$(m.a.initial)}mS(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),X.UISurfaces.Lv().then(rb=>{rb.setSelectedTaskPane(this.UDb,
this.b$e);this.rca();this.XHd&&this.wPj(!0);return null}).catch(rb=>{ic.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],rb)})):(this.upd(),this.XHd&&this.wPj(!1))}wPj(rb){var Cb;const Kb=this.Fjh();Kb?this.yQ=Kb:rb&&this.yQ||(this.yQ="");if(null===(Cb=a.AFrameworkApplication.J)||void 0===Cb||!Cb.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontFindOnPaneOpenWithEmptyQuery",!1)||rb||this.yQ)this.mQ.onSearchQueryChanged(this.yQ)}Fsa(){X.UISurfaces.Lv().then(rb=>{rb.hideTaskPane(this.UDb,
this.b$e);return null}).catch(rb=>{ic.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],rb)})}g2(){this.V5.iUa();this.D1=this.V5.Dfc(this.Zb);this.QWk()}upd(){X.UISurfaces.Lv().then(rb=>{this.yMd=window.performance.now();rb.showTaskPane(this.UDb,this.LB());rb=[Object.assign(new Db.a,{name:"Tab",string:this.bQa})];const Cb=window.performance.now()-this.yMd;W.a("NavigationPaneOpen",!0,Cb,rb);return null}).catch(rb=>{ic.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],
rb)})}Um(){X.UISurfaces.Lv().then(rb=>{rb.updateTaskPane(this.UDb,this.LB());return null}).catch(rb=>{ic.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],rb)})}LB(){var rb;const Cb={activeTab:D.a.initial};this.HC.yyb(Cb);a.AFrameworkApplication.$c("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");const Kb=null===(rb=a.AFrameworkApplication.J)||void 0===rb?void 0:rb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",
!1);return Object.assign(new V.a,{title:Ra.pV,hideHeader:!1,width:320,location:this.b$e,contentProps:Cb,onOpen:()=>{var $b;this.ey=!0;this.lxo();this.luo();this.XHd&&this.rca();(null===($b=a.AFrameworkApplication.J)||void 0===$b?0:$b.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneToggleAlignCanvas",!1))&&this.eyj(!0);a.AFrameworkApplication.$c("NavPaneAutoFocusOnScroll-tf;NavPaneAutoFocusOnScroll-cf");this.h9b&&this.ewo();x.StaticActiveAppFrame.za().Ge();x.StaticActiveAppFrame.za().B5a(this.I7j)},
onClose:()=>{var $b;try{const ab=window.performance.now();this.kha();this.ey=!1;this.Ltp();this.mup();this.h9b&&this.dup();this.mQ.w1n();this.u9e="";this.ARc=m.a.initial;x.StaticActiveAppFrame.za().hvc(this.I7j);x.StaticActiveAppFrame.za().Ge();(null===($b=a.AFrameworkApplication.J)||void 0===$b?0:$b.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneToggleAlignCanvas",!1))&&this.eyj(!1);const ia=window.performance.now()-ab;W.a("NavigationPaneClose",!0,ia)}catch(ab){ic.recordQosError("NavPaneCloseActionFailure",
["NavPaneInteractionFailed"],ab)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0,isNonClosablePane:Kb,showBackButton:Kb,onManualClose:()=>{Kb&&W.a("NavPaneBackButtonPressed")}})}lxo(){this.pKe&&!this.qSa&&Y.a.im().then(()=>{this.qSa=new Ca(this.kHa);this.Re.ub(this.qSa,this.qSa.annotationType);this.Re.getAnnotationsByType(this.qSa.annotationType).then(rb=>{this.qSa.Chd(rb)})})}mup(){this.pKe&&this.qSa&&(this.Re.xc(this.qSa,this.qSa.annotationType),this.qSa=null)}Yop(){if(this.qKe){var rb=
new tb.ContractEntitySignal;rb=Object.assign(new cb.a,{parentPath:["Signal",sb.a.getTypeNameFor(rb)],items:[Object.assign(new pb.a,{body:rb})]});this.IY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ta.a,{operation:rb}))}}luo(){this.qKe&&!this.B1a&&Y.a.im().then(()=>{this.B1a=new Fa(this.Um);this.Re.ub(this.B1a,tb.ContractEntityAnnotation.getTypeName());this.Yop();this.Re.getAnnotationsByType(tb.ContractEntityAnnotation.getTypeName()).then(rb=>{this.B1a.Chd(rb)})})}get hi(){return this.Fl}ewo(){this.hi.s0k(this.Yme)}dup(){this.hi.HBo(this.Yme)}Ltp(){this.qKe&&
this.B1a&&(this.Re.xc(this.B1a,tb.ContractEntityAnnotation.getTypeName()),this.B1a=null)}QWk(){this.HC.FN(this.Hsm());this.HC.FN(this.Jsm());this.HC.FN(this.mvm());this.HC.FN(this.Qnm());this.HC.FN(this.gxm());this.HC.FN(this.vgm());this.HC.FN(this.onLinkExecute());this.HC.FN(this.onPivotTabExecute());this.HC.FN(this.hLm());this.HC.FN(this.gOm());this.HC.FN(this.Lwm());this.HC.FN(this.ZOm());this.HC.FN(this.sIm())}ZOm(){return rb=>{rb.autoDetectedHeadingsToggleDisabled=this.kHa?!this.kHa.xbl():!0}}gOm(){return rb=>
{rb.type=this.UPk}}onLinkExecute(){return rb=>{rb.onLinkExecute=()=>{this.mQ.K3n()}}}Yme(){this.hi.gwc||(this.ZTe&&this.Jb.wf(this.ZTe),this.ZTe=new Q.a(0,1,0,()=>{this.YD.uOi(this.hi.Qri());this.Um()}),this.Jb.$b(this.ZTe))}onPivotTabExecute(){return rb=>{rb.onPivotTabExecute=Cb=>{switch(Cb){case D.a.headings:this.lUj();break;case D.a.replace:this.TUj();break;case D.a.contracts:this.E7o();break;case D.a.intelligentPlaceholder:this.yUj();break;default:this.cUj()}aa.b(this.yQ)&&(this.yQ=this.Fjh(),
this.yQ||(this.yQ=""),aa.b(this.yQ)||(this.mQ.onSearchQueryChanged(this.yQ),this.Um()))}}}hLm(){return rb=>{rb.showOutOfSyncNotification=this.cFh}}Jsm(){return rb=>{rb.findSearchBoxContent={onSearchQueryChanged:Cb=>{this.yQ=Cb;this.Um();this.mQ.onSearchQueryChanged(Cb)},findOptions:this.xHc,matchCase:this.d$,matchWholeWord:this.e$,findSearchText:this.yQ,onClearButtonExecute:()=>{void 0!==this.yQ&&null!==this.yQ&&""!==this.yQ&&(this.yQ="",this.ib.Kc(null),this.mQ.pXn())},onMatchCaseExecute:()=>{this.xHc.matchCase=
!this.xHc.matchCase;this.d$=!this.d$;this.Um();this.mQ.k5n()},onMatchWholeWordExecute:()=>{this.xHc.matchWholeWord=!this.xHc.matchWholeWord;this.e$=!this.e$;this.Um();this.mQ.l5n()},onMenuClose:()=>{if(this.D1)this.D1.onMenuClose()},onMenuOpen:()=>{if(this.D1)this.D1.onMenuOpen()}}}}vgm(){return rb=>{rb.activeTab=this.UYd}}Lwm(){return rb=>{rb.autoDetectedHeadingsToggleState=this.kHa?this.kHa.ybl:!1;this.YD.Q_c=rb.autoDetectedHeadingsToggleState;!rb.autoDetectedHeadingsToggleState&&this.kHa&&this.kHa.yrd(!1)}}Hsm(){return rb=>
{const Cb={onReplaceAllExecute:()=>{this.mQ.p5n()},onReplaceExecute:()=>{this.mQ.o5n()},onReplaceQueryChanged:Kb=>{this.o5e=Kb;this.Um()},replaceSearchText:this.o5e};rb.findReplaceContent={searchResults:this.Mwa.toArray(),replaceSearchBoxContent:Cb,onNextSearchResultExecute:()=>{this.mQ.m5n()},onPrevSearchResultExecute:()=>{this.mQ.n5n()},onSearchResultSelected:Kb=>{const {FindReplaceUIManager:$b}=d(1643);this.mQ.qZn(Kb);$b.R$i(1)},selectedResultId:this.b7e,summaryLabel:this.u9e,explanationText:this.Trm(this.ARc),
haveTooManySearchResults:this.ARc===m.a.Uha}}}Trm(rb){switch(rb){case m.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case m.a.hYa:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case m.a.mvc:return mb.a.kFi();case m.a.Uha:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}sIm(){return rb=>{rb.replaceFollowUpsWithCommentsIsEnabled=!0}}gxm(){return rb=>{var Cb=this.KK.mhm();const Kb=[];for(const $b of Cb)Cb=this.KK.t4d($b.Hc,$b.id),Kb.push({id:$b.id.toString(),
intelligentPlaceholderAnchorText:Cb});rb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Kb,onIntelligentPlaceholderInputExecute:$b=>{this.yQ=$b;this.bQa=D.a.find;this.Um();this.mQ.onSearchQueryChanged($b)},onSearchResultSelected:$b=>{this.Um();$b=f.a.Bf($b);this.KK.COo($b)}}}}mvm(){return rb=>{var Cb;let Kb=()=>{};this.kHa&&(Kb=Object(la.a)(this.kHa,this.kHa.yrd,"toggleAutoDetectedHeadings"));const $b=null===(Cb=a.AFrameworkApplication.J)||void 0===Cb?void 0:Cb.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",
!1);rb.headingsContent={onHeaderInputExecute:ab=>{this.yQ=ab;this.bQa=D.a.find;this.Um();W.a("NavigationPaneFind");this.mQ.onSearchQueryChanged(ab)},renderHeadingContent:(ab,ia,La)=>{this.Jb.$b(new Q.a(0,1,100,()=>{var Mb=window.performance.now()-this.yMd;if($b)this.headingsReady=!0,this.Um();else{var Ha=this.YD.O3;this.headingsReady=!0;this.h9b&&this.Jb.$b(new Q.a(0,1,0,()=>{const zb=this.hi.Qri();this.YD.uOi(zb);this.Um()}));this.Um();La.style.display="none";Ha.first&&(ab.style.display="block")}this.Jb.$b(new Q.a(1,
1,0,()=>{ld.VJl(this)}));Ha=window.performance.now()-this.yMd;W.a("NavigationPaneHeadingsLoaded",!0,Ha,[Object.assign(new Db.a,{name:"NavPaneReactHeadings",bool:!0})]);Mb=[Object.assign(new Db.a,{name:"HeadingFetchStart",double:Mb}),Object.assign(new Db.a,{name:"HeadingFetchFinished",double:Ha})];W.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Mb)}))},autoDetectedHeadingsToggle:Kb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.YD.O3,onHeadingChevronClick:ab=>
{this.YD.s4l(ab);this.Um()},onClickHeading:ab=>{this.hi.gwc=this.h9b;if(this.Jb.Yz){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",ab);const ia=window.performance.now();this.Jb.$b(new Q.a(0,1,0,()=>{this.YD.onClickHeading(ab);this.Um();const La=window.performance.now()-ia;W.a("NavigationPaneAsyncOnClickHeadingItem",!0,La)}))}else this.YD.onClickHeading(ab),this.Um()},onClickBookmark:ab=>{this.hi.gwc=this.h9b;if(this.Jb.Yz){u.ULS.sendTraceTag(512328289,
312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",ab);const ia=window.performance.now();this.Jb.$b(new Q.a(0,1,0,()=>{this.YD.onClickBookmark(ab);this.Um();const La=window.performance.now()-ia;W.a("NavigationPaneAsyncOnClickHeadingItem",!0,La)}))}else this.YD.onClickBookmark(ab),this.Um()},onShareHeadingClick:ab=>{this.YD.onShareHeadingClick(ab)},bookmarkIconUrl:ra.a.Aj("BookmarkDefault.png")}}}Pnm(){var rb,Cb=null===(rb=this.B1a)||void 0===rb?void 0:
rb.getAnnotations();if(Cb){rb=Array(Cb.length);let Kb=0;for(const $b of Cb)(Cb=$b.content)&&(rb[Kb++]={id:$b.id,type:Cb.type,value:Cb.value});return rb}return null}Qnm(){return rb=>{rb.contractsContent={onHeaderInputExecute:Cb=>{this.yQ=Cb;this.bQa=D.a.find;this.Um();W.a("NavigationPaneFind");this.mQ.onSearchQueryChanged(Cb)},contractEntities:this.Pnm(),selectedEntityId:this.rch.wDh,onEntitySelected:Cb=>{var Kb;const $b=null===(Kb=this.B1a)||void 0===Kb?void 0:Kb.getAnnotations();if($b)for(const ab of $b)if(ab.id===
Cb){this.rch.sOo(ab);break}this.Um()}}}}POj(rb){this.XHd=rb}xzp(rb){this.Jb.$b(new Q.a(0,1,0,()=>{this.YD.NKg(rb)&&this.Um()}))}CLi(rb){this.Jb.$b(new Q.a(0,1,0,()=>{const Cb=this.YD.gYb;this.YD.fei(rb)?this.Um():0===this.YD.gYb&&0<Cb&&this.Um()}))}YJg(rb,Cb){this.Jb.$b(new Q.a(0,1,0,()=>{const Kb=this.YD.gYb;this.YD.YJg(rb,Cb)?this.Um():0<this.YD.gYb&&0===Kb&&this.Um()}))}iQl(rb){this.Jb.$b(new Q.a(0,1,0,()=>{const Cb=this.YD.gYb;this.YD.jQl(rb)?this.Um():0===this.YD.gYb&&0<Cb&&this.Um()}))}Q_o(rb){this.YD.omp(rb);
this.Um()}xKg(rb){this.YD.xKg(rb)&&this.Um()}MZd(rb){this.YD.MZd(rb)&&this.Um()}Kko(){return 0<this.YD.gYb}rca(){this.Zb.Gg(this.UDb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}kha(){if(this.wab()){var rb;(rb=Object(Ea.a)().Gd)?(rb=rb.nL,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(rb=this.Zb.QW,u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Zb.Gg(rb)}}wab(){return!!this.Zb.currentScope&&
this.Zb.currentScope.name===this.UDb}static getInstance(){return ic.Qm()}static Qm(){var rb,Cb;return new ic(new pa(a.AFrameworkApplication.va),Object(la.a)(Na.getInstance(),Na.getInstance().getSelectedText,"getSelectedText"),xa.a.instance,F.a.instance,Ma.a.instance,Object(la.a)(eb.instance,eb.instance.VBm,"getNextSearchResult"),w.a.instance.Oa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),w.a.instance.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
w.a.instance.Oa("Box4.AugmentationLoop.IAnnotationStorage"),w.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),T.a.instance,w.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new qb,null===(Cb=null===(rb=x.StaticActiveAppFrame.za())||void 0===rb?void 0:rb.kb)||void 0===Cb?void 0:Cb.Qc)}static recordQosError(rb,Cb,Kb){const $b=Object.assign(new nb.a,{extendedProperties:new Map});Kb&&$b.extendedProperties.set("exception",Kb);ba.Health.instance.recordQosError(rb,Cb,!1,
!0,!1,!1,$b)}}Object(I.a)(ic,"ReactFindReplacePane",K,[683,684,10]);var mc=d(1541);d.d(J,"FindReplaceUIManager",function(){return Rc});class Rc{constructor(rb,Cb,Kb=null,$b=null,ab=null,ia=null){this.Ryd=this.y5=0;this.e$=this.d$=this.eJb=!1;this.Ym=this.Zvh=this.noa=null;this.oLa=this.zXe=!1;this.Pj=rb;this.Qp=Kb;this.Jkb=$b;this.Ksh=ab;this.ee=ia;Rc.Vdc=new G}get x_f(){return this.zXe}set x_f(rb){rb!==this.zXe&&(this.zXe=rb,this.T0h())}Wxe(rb){this.y5=rb;this.update();this.y5||this.eI!==m.a.Txb&&
this.eI!==m.a.Uha?0<this.y5&&this.eI===m.a.hYa?this.Y$(m.a.Txb):this.y5>Rc.u1j&&this.eI!==m.a.Uha&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.Y$(m.a.Uha)):this.Y$(m.a.hYa)}uwe(rb){this.Ryd=rb;this.oLa&&this.update();this.Ksh&&!this.Ksh.value.Vkd&&this.txg()}reset(){}LCf(){this.ee&&(this.Ym=this.ee.Xf("UserAction","Find"));if(this.oLa||!this.eI)this.oLa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.Y$(m.a.jKj)}dic(){var rb;this.oLa=!0;let Cb=this.y5?m.a.Txb:
m.a.hYa;if(this.eI!==m.a.Uha&&z.a.instance){const Kb=z.a.instance.Ak;0<Kb.Qna&&(Kb.Qna>Rc.u1j?Cb=m.a.Uha:this.vAp(Kb))}this.Y$(Cb);this.update();this.Ym&&(this.Ym.stop(),this.Ym=null);Rc.gKj=f.a.create().toString();Rc.R$i(0,this.Vfc,this.uVa().length,this.y5);Object(mc.b)()&&(null===(rb=this.Pj)||void 0===rb?0:rb.isVisible)&&(rb={},a.AFrameworkApplication.va.Qb(y.a.Yre,2,rb),rb[l.a.On]&&a.AFrameworkApplication.va.Qb(y.a.kce,2,{CommandValueId:{query:this.uVa(),matchCase:this.d$,matchWholeWordOnly:this.e$,
totalResultLimit:-1}}))}vAp(rb){const Cb=rb.IJa;let Kb=Cb;const $b=[];do $b[$b.length]=Kb,Kb=rb.k9a(Kb);while(Cb!==Kb);this.Pj.yef($b);this.noa&&this.Pj.Tve(this.noa)}update(){this.Pj&&this.Pj.lBp()}get eI(){return this.Pj.eI}get Vfc(){return this.Pj.UYd}Ayb(rb){this.x_f=rb}T0h(){if(this.x_f)switch(this.eI){case m.a.Txb:case m.a.hYa:case m.a.Uha:this.Pj.mpd(!0)}else this.Pj.mpd(!1)}Y$(rb){if(this.Pj.isVisible){switch(rb){case m.a.hYa:case m.a.Txb:this.eI===m.a.Uha&&(rb=m.a.Uha)}this.Pj&&(this.Pj.Y$(rb),
this.T0h());this.update();this.txg()}}YUa(rb,Cb){const Kb=this.oLa&&this.eI!==m.a.Uha;switch(rb){case 0:Kb&&this.Pj.yef(Cb);break;case 1:Kb&&this.Pj.ZCj(Cb);break;case 4:Kb&&this.Pj.Y8j(Cb);break;case 2:this.Pj.n2h();break;case 3:this.noa=Cb[0],Kb&&0<this.y5&&this.Pj.Tve(this.noa)}}get matchCase(){return this.d$}set matchCase(rb){this.d$!==rb&&(this.d$=rb,this.b7j())}get matchWholeWord(){return this.e$}set matchWholeWord(rb){this.e$!==rb&&(this.e$=rb,this.b7j())}b7j(){this.Pj.uEe()}uVa(){return this.Pj.uVa()}KQb(){return this.Pj.KQb()}Xxg(rb){this.Pj.Xxg(rb)}gIa(){this.Pj.gIa()}get UUj(){return 0<
this.y5&&this.eI!==m.a.nvc&&this.eI!==m.a.mvc}sSo(rb){let Cb="";rb?Cb=0<this.y5?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.uVa(),this.KQb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.uVa(),this.KQb()):rb||0<this.y5&&(Cb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.txg(Cb)}dispose(){this.Pj.dispose()}n4c(){return this.Pj.n4c()}pXo(rb,Cb=!0){rb!==this.Vfc&&(rb===D.a.headings?
(u.ULS.sendTraceTag(9056651,367,50,""),this.Pj.lUj()):rb===D.a.find?this.Pj.cUj():rb===D.a.replace?this.Pj.TUj():rb===D.a.intelligentPlaceholder&&(Cb||this.Pj.POj(Cb),this.Pj.yUj()))}gA(rb,Cb=!0){this.Pj.POj(Cb);rb?(this.eJb||this.pUf(),this.Pj.mS(),this.y5||this.eI===m.a.hYa?a.AFrameworkApplication.J&&a.AFrameworkApplication.J.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.Pj.Y$(m.a.Txb):this.Y$(m.a.initial)):this.Pj.Fsa()}pUf(){this.eJb||(this.Pj.initialize(),this.eJb=!0)}txg(rb=""){var Cb=
this.IIm();Cb&&(rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,rb,Cb));this.Jkb&&Cb&&this.noa&&this.eI!==m.a.Uha&&this.eI!==m.a.nvc&&(Cb=this.Jkb.yYd(this.noa),rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,rb,Cb.nXd));(Cb=this.Srm())&&(rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,rb,Cb));this.Qp&&rb&&this.Zvh!==rb&&(this.Zvh=rb,this.Qp.sendNotification(rb,
!0))}IIm(){let rb="";switch(this.eI){case m.a.EXj:rb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case m.a.Txb:rb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.Ryd,this.y5);break;case m.a.Uha:this.oLa&&(rb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.Ryd,this.y5));break;case m.a.hYa:rb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case m.a.nvc:rb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;
case m.a.mvc:rb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return rb}Srm(){let rb="";switch(this.eI){case m.a.initial:rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.Bsm());break;case m.a.hYa:rb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case m.a.mvc:rb=mb.a.kFi();break;case m.a.Uha:rb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return rb}Bsm(){let rb=
"";this.d$&&this.e$?rb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.d$?rb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.e$&&(rb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return rb}static getInstance(rb){return Rc.Qm(rb)}static Qm(rb){w.a.instance.ia("WordEditor.FindReplace.FindReplacePane",
()=>ic.getInstance()).as("WordEditor.FindReplace.FindReplacePane").ha();return new Rc(w.a.instance.resolve("WordEditor.FindReplace.FindReplacePane"),rb,w.a.instance.resolve("Common.Utils.IAriaNotifier"),F.a.instance,new v.a(()=>z.a.instance.oZb),x.StaticActiveAppFrame.za().Vr)}static R$i(rb,Cb=-1,Kb=-1,$b=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:rb,["SearchComplete.ResultsCount"]:$b,["SearchOpsCorrelation"]:Rc.gKj,["ActionId"]:Rc.Vdc.actionId,["SourceControlId"]:Rc.Vdc.ZNa,["IsNavPanOpenedAlready"]:Rc.Vdc.jon,
["IsSearchFromNavPane"]:Rc.Vdc.Yrn,["CurrentTab"]:Cb,["QueryLength"]:Kb})}static pjl(rb,Cb,Kb){Cb=void 0!==Cb&&null!==Cb?void 0===Cb.SourceControlId||null===Cb.SourceControlId?"Unknown":Cb.SourceControlId:rb===H.a.Xyb?"FindKeyboardShorcut":rb===H.a.Yyb?"ReplaceKeyboardShorcut":"Unknown";switch(rb){case H.a.Oxc:rb="ShowHeadingsPane";break;case H.a.Xyb:rb="ShowFindPane";break;case H.a.Yyb:rb="ShowReplacePane";break;case H.a.Rxc:rb="ShowIntelligentPlaceholderPane";break;case H.a.b0a:rb="ToggleNavigationPane";
break;default:rb="Unknown"}Rc.Vdc=new G(rb,Cb,Kb,!0)}}Rc.u1j=100;Rc.gKj=null;Rc.Vdc=null;Object(I.a)(Rc,"FindReplaceUIManager",null,[646,350,10])},1645:function(I,J,d){d.r(J);I=d(0);var m=d(207),f=d(142),a=d(94),l=d(2),w=d(19),z=d(83),x=d(1087),u=d(67),v=d(20),D=d(8),y=d(18),H=d(490),F=d(1491),G=d(1864),K=d(74),R=d(375),E=d(10),N=d(467),O=d(37),U=d(268),X=d(746),V=d(50),Q=d(155),T=d(545),ba=d(1717);class W{constructor(bb,Wa,Za,Na,Db,nb,Ta){this.Hvh=this.Tzh=this.Iih=this.IK=this.fgb=this.G3b=this.gSe=
this.cOe=this.JPe=this.cZ=this.$ia=this.lja=null;this.hEe=()=>{const cb=this.Cxa.Ijc(this.IK),sb=this.Cxa.Ttm(this.IK);this.cOe.innerText=cb.toString();this.gSe.innerText=sb.toString();G.a.r_b(this.lja,1===cb?!1:!0);G.a.r_b(this.$ia,cb===sb?!1:!0)};this.NUo=()=>{const cb=this.Zb.getRegion(Q.a.o8a);let sb;if(this.cZ&&!this.cZ.disabled)sb=this.cZ;else if(this.lja.disabled){if(this.$ia.disabled)return;sb=this.$ia}else sb=this.lja;sb.focus();cb.Uk.iA(sb)};this.wua=(cb,sb)=>{(cb=sb.Rm.currentSelection)&&
this.cZ&&G.a.r_b(this.cZ,O.a.ym(cb)?!0:!1)};this.kof=()=>{if(!this.$ia.disabled){const cb=this.Cxa.itb(this.IK)?y.a.jke:y.a.ike;this.ga.Ob(cb,2)}return!0};this.lof=()=>{if(!this.lja.disabled){const cb=this.Cxa.itb(this.IK)?y.a.lke:y.a.kke;this.ga.Ob(cb,2)}return!0};this.jof=()=>{this.cZ&&!this.cZ.disabled&&this.ga.Ob(y.a.R5i,2);return!0};this.Zb=bb;this.ga=Na;this.$g=Db;this.oe=nb;this.ib=Ta;this.Cxa=Za;this.kaa=document.createElement("div");this.kaa.classList.add("FootnoteEndnoteActionBarControl");
this.kaa.style.zIndex=String(U.a.n0d);this.kaa.style.position="relative";this.CGc=document.createElement("div");this.CGc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.kaa.appendChild(this.CGc);this.qDl();this.kaa.appendChild(this.G3b);this.kaa.appendChild(this.fgb);this.r1=f.KeyInputManager.oc(a.a.J4,0);this.x8m();this.w8m()}Vka(bb){D.ULS.shipAssertTag(4520065,308,this.Cxa.ata(bb));if(this.IK!==bb){this.IK=bb;this.hEe();bb=this.Cxa.itb(this.IK);this.fGl(bb);this.IK.APh(this.hEe);
let Wa="",Za="";const Na=this.Cxa.Ijc(this.IK);-1!==Na&&(Wa=(Na-1).toString(),Za=(Na+1).toString());bb?(this.$ia.title=this.$ia.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Za),this.lja.title=this.lja.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Wa)):(this.$ia.title=this.$ia.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,
Za),this.lja.title=this.lja.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Wa));this.axb()}}JNb(){this.IK&&(this.cZ&&this.cZ.parentNode===this.G3b&&this.G3b.removeChild(this.cZ),this.NOa(),this.IK.iCo(this.hEe),this.IK=null)}dispose(){this.Zb.ie(Q.a.o8a).ot(this.r1)}fGl(bb){3===this.ga.mode&&(bb=bb?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.cZ=this.Erf("FootnoteEndnoteFormattingOptionButton",
"FootnoteEndnoteActionBarFormattingButton",bb,null),K.a.Is(this.cZ,K.a.Wja,bb),this.G3b.appendChild(this.cZ))}qDl(){this.G3b=document.createElement("div");this.G3b.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.fgb=document.createElement("div");this.fgb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.lja=this.Erf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");
this.fgb.appendChild(this.lja);this.cOe=N.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.fgb.appendChild(this.cOe);this.JPe=N.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.JPe.innerText=" / ";this.fgb.appendChild(this.JPe);this.gSe=N.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.fgb.appendChild(this.gSe);this.$ia=this.Erf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");
this.fgb.appendChild(this.$ia)}Erf(bb,Wa,Za,Na){bb=G.a.W6a(bb,Wa,Za,Na,void 0===Na||null===Na);bb.setAttribute(K.a.Wh,K.a.N$);return bb}x8m(){const bb=this.Zb.ie(Q.a.o8a);bb.parent=X.a.Gq;bb.bindAction(this.r1,y.a.L6);bb.Nja(this.NUo)}w8m(){var bb=new R.DOMFocusListing(()=>this.kaa);bb.Uga=!1;bb.rn(2);bb.rn(1);bb=this.Zb.Qmb(this.kaa,this.Zb.ie(Q.a.o8a),bb);bb.AZa();bb.rP=!0}axb(){this.cZ&&(this.$g.ub(E.a.click,this.cZ,this.jof),this.Iih=this.oe.$wb(this.cZ,this.jof,a.a.Pu));this.$g.ub(E.a.click,
this.lja,this.lof);this.Tzh=this.oe.$wb(this.lja,this.lof,a.a.Pu);this.$g.ub(E.a.click,this.$ia,this.kof);this.Hvh=this.oe.$wb(this.$ia,this.kof,a.a.Pu);this.ib.AB(this.wua)}NOa(){this.cZ&&(this.$g.xc(E.a.click,this.cZ,this.jof),this.oe.AAb(this.cZ,this.Iih));this.$g.xc(E.a.click,this.lja,this.lof);this.oe.AAb(this.lja,this.Tzh);this.$g.xc(E.a.click,this.$ia,this.kof);this.oe.AAb(this.$ia,this.Hvh);this.ib.gna(this.wua)}static Otm(){return W.Ptm()}static Ptm(){return new W(z.FocusManager.instance(),
ba.a.instance,T.a.instance,l.AFrameworkApplication.va,v.StaticActiveAppFrame.za().XE,v.StaticActiveAppFrame.za().YE,V.a.instance)}}Object(I.a)(W,"FootnoteEndnoteActionBarControl",null,[673]);var aa=d(303),Y=d(12),da=d(1564),ka=d(1814);class qa{constructor(bb,Wa,Za,Na,Db,nb,Ta,cb,sb,pb,tb,wb){this.xG=null;this.aW=!1;this.ox=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.E9b=bb;this.Zgc=Wa;this.WCc=Za;this.kHk=Na;this.p1e=Db;this.Hm=nb;this.rib=Ta;this.$g=cb;this.zyh=sb;this.Htk=tb;this.Ms=
this.E9b.ownerDocument.createElement("div");this.Ms.id="FootnoteEndnoteControlOverlay";this.Ms.className="EditingSurfaceOverlay";this.xK=this.Rnm();this.d4(!1);this.E9b.appendChild(this.Ms);this.E9b.appendChild(this.xK);this.Zgc.bind();this.Ai=null;this.ga=wb;this.IQa=pb}bHo(){const bb=this.zyh();bb&&bb.vj&&(bb.Qxb=0,bb.ERd())}c6j(bb){if(this.CTc){const Wa=this.CTc.esa;Wa&&(Wa.eYf=bb)}}get WJ(){return this.aW}get CTc(){return this.xG}get dialog(){return this.Ai}get eo(){return null!=this.EWg?this.EWg:
this.EWg=w.a.instance.Ta("Common.IZoomManager")}gsf(){this.Ai=ka.a.Xtm()}vld(){this.Ai=null}show(bb=!0){this.aW||(this.c6j(!0),this.Htk(),this.d4(!0),this.$A(),bb&&this.setFocus())}setFocus(){this.aW&&(this.Zgc.pyb(),this.kHk())}update(){this.aW&&(this.xG.isConnected?this.WCc.hEe():this.dismiss())}dismiss(bb=!1,Wa=!1){this.aW&&(this.c6j(!1),this.Rca(),this.bHo(),this.d4(!1),this.p1e(Wa),this.Ai&&(this.ga.Ob(Y.a.TYc,2),this.Ai=null),!bb&&this.xG&&this.xG.isConnected&&this.IQa.BOo(this.xG),this.JNb())}PFo(bb){const Wa=
null!==this.eo.instance?this.eo.instance.nl:1;this.xK.style.width=bb.g6h*Wa+"px";this.ox.style.width=bb.FWc*Wa+"px";this.xK.style.marginLeft=bb.Wec*Wa+"px";this.Hm?this.ox.style.marginRight=bb.Rqf*Wa+"px":this.ox.style.marginLeft=bb.efc*Wa+"px";if(bb=this.zyh())bb=bb.NI,this.xK.style.bottom=bb.offsetHeight-bb.clientHeight+"px"}Vka(bb){D.ULS.shipAssertTag(4520073,308,this.rib.ata(bb));this.xG!==bb&&(this.xG=bb,this.Zgc.Vka(bb),this.WCc.Vka(this.xG))}dispose(){this.dismiss();this.Zgc.dispose();this.WCc.dispose()}$A(){this.$g&&
this.$g.ub(E.a.click,this.Ms,this.onClick)}Rca(){this.$g&&this.$g.xc(E.a.click,this.Ms,this.onClick)}Rnm(){let bb;bb=document.createElement("div");bb.classList.add("FootnoteEndnoteControl");this.ox=document.createElement("div");this.ox.classList.add("FootnoteEndnoteContent");this.ox.appendChild(this.Zgc.kaa);this.ox.appendChild(this.WCc.kaa);bb.appendChild(this.ox);return bb}d4(bb){bb=(this.aW=bb)?"":"none";this.Ms.style.display=bb;this.xK.style.display=bb}JNb(){this.xG&&(this.Zgc.JNb(),this.WCc.JNb(),
this.xG=null)}static y7d(){const bb=v.StaticActiveAppFrame.za().kb.Qc;return bb&&bb.vj?bb:null}static Stm(bb,Wa,Za,Na,Db){return new qa(bb,Wa,Za,Na,Db,l.AFrameworkApplication.isRtl,T.a.instance,aa.a.instance,qa.y7d,da.a.instance,qa.CVl,l.AFrameworkApplication.va)}static CVl(){l.AFrameworkApplication.va.Qb(Y.a.Trb,2,!0)}}Object(I.a)(qa,"FootnoteEndnoteControl",null,[672]);var ua=d(826),Pa=d(6),Ja=d(202),Ca=d(31),ra=d(7),Ea=d(21),xa=d(75),Ma=d(1716),ha=d(325),la=d(976),Fa=d(595),Ga=d(1361),va=d(61),
pa=d(253);class Oa extends ha.a{constructor(bb,Wa,Za,Na,Db,nb,Ta,cb,sb,pb,tb,wb,gc,vc,Pc,ld,Dc){super(Q.a.ala,Za,Na,Db,Ta,cb,sb,pb,tb,wb,gc,vc,Pc,ld,Dc);this.uch=bb;this.f4a=nb;this.f4a.Vqd=this;Wa(this);this.features.XEg=!0}get bYi(){return!0}LOf(){const bb=this.uch.bFf(this);return la.ViewReference.dH(this,bb)}Rwf(bb){Object(pa.a)(Oa,bb)||this.uch.Owf()}s4c(){return Fa.a.iej}Tv(){super.Tv();this.f4a.Bki()}rF(bb,Wa=null){super.rF(bb,Wa);this.f4a.nki(this.vd.Fk)}detach(){this.f4a.Aki();super.detach()}U3d(){this.Tv()}static U6a(){const {FootnoteEndnoteControlManager:bb}=
d(1645);return new Oa(bb.instance,Ga.a.cqf,v.StaticActiveAppFrame.za().kb,Object(va.a)(),()=>w.a.instance.resolve("Box4.IUndoManager"),w.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),l.AFrameworkApplication.va,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),w.a.instance.resolve("Box4.IInteractiveEventNotifier"),w.a.instance.Ta("Box4.ITextMetricsAdapter"),w.a.instance.resolve("Box4.IRotatingCoordinateConverter"),w.a.instance.Ta("Common.IZoomManager"),w.a.instance.Oa("Box4.IContentControlViewElementManager"),
w.a.instance.Oa("Box4.CpConversionManagerImpl"),w.a.instance.Oa("Box4.ContentControlConfigSettings"),w.a.instance.Oa("Box4.IContentControlReader"),w.a.instance.Oa("Box4.IContentControlBoundaryNavigator"))}}Object(I.a)(Oa,"FootnoteEndnoteEditView",ha.a,[]);class Ra{constructor(bb,Wa,Za,Na=!1){this.bEb=null;this.qWe=this.k$g=!1;this.ucm=()=>{const Db=String.format("{0} {1}",this.qWe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Iw.sendNotification(Db,!0)};this.Zb=bb;this.Cxa=Wa;this.Hia=Za();this.ODd=Na;this.kaa=document.createElement("div");this.kaa.classList.add("FootnoteEndnoteEditControl");this.CGc=document.createElement("div");this.CGc.classList.add("FootnoteEndnoteEditControlDividerElement");this.IJb=(new ua.a(this.kaa,"WACViewPanel_FootnoteEndnoteEditControl")).rK;this.kaa.appendChild(this.CGc);this.kaa.appendChild(this.IJb)}get Iw(){return null!=
this.TRg?this.TRg:this.TRg=w.a.instance.resolve("Common.Utils.IAriaNotifier")}Vka(bb){D.ULS.shipAssertTag(4520077,308,this.Cxa.ata(bb));this.bEb!==bb&&(this.bEb=bb,this.Pif(this.bEb),this.qWe=this.Cxa.itb(this.bEb),this.ODd?(this.Hia.w_b(K.a.ySd),this.Zb.ie(Q.a.ala).J$(this.ucm)):this.Hia.yNj(this.qWe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,K.a.ySd))}JNb(){const bb=T.a.instance.itb(this.bEb)?
"Footnote":"Endnote";D.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:bb,["CalloutHeight"]:this.kaa.scrollHeight});this.Gob();this.bEb=null}bind(){this.k$g||(this.Hia.vdc(this.IJb),this.k$g=!0)}pyb(){const bb=this.oKm();bb?this.Hia.Kc(bb):this.Hia.kod()}dispose(){this.Gob()}Pif(bb){this.Gob();this.Hia.rF(bb,bb.Fk)}Gob(){this.Hia.detach()}oKm(){let bb=0;var Wa=null,Za=Pa.a.eb(this.bEb);Ja.OutlineNavigator.Gba(Za);if((Za=Ca.OutlineElementNavigator.Me(Za))&&ra.ParagraphReader.Wb(Za)){if(Wa=Ra.Oxm(Za)){bb=
Wa.Ib.cp+1;Wa=Ma.FootnoteEndnoteDefaultContentInserter.sdi;const Na=Wa.length;bb+Na<=ra.ParagraphReader.textLength(Za)&&Za.characterData.substr(bb,Na)===Wa&&(bb+=Na)}Wa=Ea.SelectionFactory.ue(Za,bb)}return Wa}static Utm(){return Ra.Vtm()}static Vtm(){return new Ra(z.FocusManager.instance(),T.a.instance,()=>Oa.U6a(),l.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static Oxm(bb){bb=xa.i(bb,10);return 0<bb.length?bb[bb.length-1]:null}}Object(I.a)(Ra,"FootnoteEndnoteEditControl",
null,[669]);var fb=d(1146);class qb{constructor(bb,Wa){this.EGa=bb;this.Hm=Wa}Mkc(bb,Wa){bb=this.EGa.Mkc(bb);var Za=Wa.clientWidth;const Na=Wa.scrollLeft,Db=bb.g6h;let nb=bb.Wec,Ta=bb.Wec,cb=qb.f8f,sb=qb.g8f,pb=Db,tb=bb.FWc;this.Hm?sb=bb.Rqf-Ta:cb=bb.efc-nb;Za<Db&&(nb=Math.max(nb-Na,0),pb=Za-nb,this.Hm?(Za=Wa.scrollWidth-Na-Za,Ta=Wa.scrollWidth-bb.Wec-Db,sb=Math.max(bb.Rqf-Za-Ta,qb.g8f),tb=pb-sb-qb.f8f):(cb=Math.max(bb.efc-Na-nb,qb.f8f),tb=pb-cb-qb.g8f));return new fb.a(nb,pb,cb,sb,tb)}}qb.f8f=25;
qb.g8f=50;Object(I.a)(qb,"FootnoteEndnoteViewPositionProvider",null,[]);class mb{constructor(bb,Wa=0,Za=0){this.clientWidth=bb;this.scrollLeft=Wa;this.scrollWidth=Za?Za:bb}}Object(I.a)(mb,"PageViewScrollContainerSizeInfo",null,[]);d.d(J,"FootnoteEndnoteControlManager",function(){return eb});class eb{constructor(bb,Wa,Za,Na,Db,nb,Ta,cb){this.rG=null;this.rca=()=>{this.gq.QK(Q.a.ala);this.gq.QK(Q.a.o8a);this.gq.Dx(m.AFrame.Do);this.Zb.VRc(Q.a.ala);this.Zb.Gg(Q.a.ala)};this.VUo=sb=>{this.gq.Dx(Q.a.ala);
this.gq.Dx(Q.a.o8a);this.gq.QK(m.AFrame.Do);this.Zb.mYc(Q.a.ala);(sb||this.Zb.currentScope&&(this.Zb.currentScope.name===Q.a.ala||this.Zb.currentScope.name===Q.a.o8a))&&this.Zb.Gg(m.AFrame.Do)};this.Zb=bb;this.gq=Wa;this.Wwk=Za;this.Xwk=Na;this.Vwk=Db;this.EGa=nb;this.Qwa=Ta;this.F1=cb;this.r1=f.KeyInputManager.oc(a.a.J4,0);this.hUf();this.xW()}get control(){return this.rG}get dialog(){return this.control.dialog}get iWi(){return this.control.WJ}gsf(){this.control.gsf()}vld(){this.control.vld()}bind(bb){this.gzl(bb)}DBg(bb){if(this.control.CTc!==
bb.P6a)this.control.dismiss();else if(this.iWi)return;this.ygc();this.control.Vka(bb.P6a);this.control.show(bb.oye)}ygc(){if(this.F1){const bb=new x.a(!0);this.F1.$Ma(bb)}}E0(){this.control.setFocus()}Lsd(){this.control.update()}Owf(bb,Wa=!1){this.ygc();this.control.dismiss(bb,Wa)}NFo(bb){const Wa=eb.y7d().NI;bb=this.EGa.Mkc(bb,new mb(Wa.clientWidth,Wa.scrollLeft,Wa.scrollWidth));this.control.PFo(bb)}dispose(){this.control.dispose();this.Zb.ie(Q.a.ala).ot(this.r1)}bFf(bb){D.ULS.shipAssertTag(4520074,
308,!!this.control);D.ULS.shipAssertTag(4520075,308,!!this.control.CTc);return this.cFf(this.control.CTc.id,bb)}gzl(bb){const Wa=this.Xwk(),Za=this.Vwk();this.rG=this.Wwk(bb,Wa,Za,this.rca,this.VUo)}hUf(){const bb=this.Zb.ie(Q.a.ala);bb.parent=3===l.AFrameworkApplication.va.mode?u.a.AF:u.a.Puc;this.Zb.Kdf(Q.a.ala);bb.bindAction(this.r1,y.a.L6)}xW(){this.gq.xW(Q.a.ala);this.gq.xW(Q.a.o8a)}cFf(bb,Wa){return()=>{const Za=eb.y7d().vd.Hc.Eb(bb);this.Qwa.zhc();if(!Za.isConnected)return D.ULS.sendTraceTag(4520076,
308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.DBg(new H.a(Za,!0));return Wa}}static Qm(){const bb=new qb(w.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),l.AFrameworkApplication.isRtl);return new eb(z.FocusManager.instance(),v.StaticActiveAppFrame.za().Ky,qa.Stm,Ra.Utm,W.Otm,bb,F.a.instance,w.a.instance.resolve("Box4.IPasteFloatieEventSource"),w.a.instance.resolve("Common.IAppSettingsManager"))}static y7d(){const bb=v.StaticActiveAppFrame.za().kb.Qc;
return bb&&bb.vj?bb:null}static get instance(){return null!=eb.RYg?eb.RYg:eb.RYg=eb.Qm()}}Object(I.a)(eb,"FootnoteEndnoteControlManager",null,[615])},1650:function(I,J,d){function m(G,K){var R=u.a.instance;const E=v.FocusManager.instance();R.I$(G);G=E.ie(G);R=new D.DOMFocusListing(()=>K);R.Uga=!0;R.rn(8);R.rn(2);E.Qmb(K,G,R).rP=!0}I=d(0);var f=d(452),a=d(2),l=d(18),w=d(41),z=d(1032),x={get interop(){var G=null===fishBowlUx||void 0===fishBowlUx?void 0:fishBowlUx.interop;if(!G)throw Error("fishBowlUx chunk is accessed before loading");
return G}},u=d(420),v=d(83),D=d(375),y=d(1036);d.d(J,"a",function(){return H});class H{static initialize(G,K,R,E){f.a.z7c("ribbon",this.Xug);this.fia=K;this.$z=R;this.xrj=E;this.zvg=G;this.LMa=document.getElementById(this.xrj);try{this.ovb=document.createElement("div"),this.ovb.id=this.kag,this.ovb.classList.add(this.$$l),this.LMa.append(this.ovb),this.JCn().then(()=>{this.interop=null===x||void 0===x?void 0:x.interop;this.controller=this.interop.renderFishBowlNavButton(this.ovb,{onclick:this.QQn,
onVisibilityChange:this.fGp});this.Xzg();this.M1o();this.RTn();w.a("MicroNavIconShown")})}catch{w.a("MicroNavFloatieInitializationFailed")}}static async Xzg(){this.fia&&this.fia.execute(G=>{G.gY(()=>{setTimeout(this.controller.reposition,10)})})}static async M1o(){this.$z&&this.$z.execute(G=>{G.ySc((K,R)=>this.bNj(R))})}static bNj(G){0==G.ybb?this.controller.changeContentContainer(!1):this.controller.changeContentContainer(!0)}static async JCn(){return a.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("fishBowlUx"):(await Object(z.b)(this.zvg)).OD.loadScript("fishBowlUx")}}var F=H;H.xrj="";H.kag="FishBowlNavButton";H.fia=null;H.$z=null;H.$$l="FishBowlNavButton";H.controller=null;H.interop=null;H.ovb=null;H.LMa=null;H.sde=!1;H.Xug="NavFloatie";H.yIj=!1;H.RTn=()=>{F.yIj||(f.a.Fbb("ribbon",F.Xug),f.a.hWb("ribbon",F.Xug),F.yIj=!0)};H.fGp=(G,K)=>{!G||K||F.sde||(F.sde=!0,m(F.kag,F.ovb));if((!G||K)&&F.sde){F.sde=!1;G=F.kag;K=u.a.instance;const R=v.FocusManager.instance();R.currentScope.name===
G&&R.Gg(y.a.Do);K.Dx(G)}};H.QQn=()=>{a.AFrameworkApplication.va.Qb(l.a.b0a,2,null,void 0)};H.dispose=()=>{F.ovb&&F.controller&&(F.$z.execute(G=>{G.Ite((K,R)=>F.bNj(R))}),F.fia.execute(G=>{G.hNa(()=>{F.controller.reposition()})}),F.interop.dispose(F.ovb))};H.Tqp=()=>{F.controller&&F.controller.hide()};H.CDe=()=>{F.controller&&F.controller.show()};Object(I.a)(H,"NavButton",null,[])},1674:function(I,J,d){d.d(J,"a",function(){return u});I=d(0);var m=d(8),f=d(207),a=d(2),l=d(10),w=d(262),z=d(151),x=d(19);
class u{constructor(v,D){this.Uu=null;this.qKd=!1;this.vjb=0;this.prh="";this.BLe={};this.Dwj=()=>{this.Zb&&this.Zb.EN(f.AFrame.Oga,!0)};this.Hme=()=>{this.jZc();this.hgi();this.mdg();this.lyb();return!0};this.Ime=()=>{this.jZc();this.hgi();this.mdg();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.lyb()},0)});return!0};this.Weg=y=>{y.stopPropagation()};this.$_e=v;this.Zb=D;this.Ywh=this.Weg;this.gqh=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Gb.PBa;this.nA=!!a.AFrameworkApplication.ua&&
a.AFrameworkApplication.ua.Gb.F7;this.hqh=!!a.AFrameworkApplication.J&&a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1);this.Aa=a.AFrameworkApplication.J;this.yyk=new Set(["2759860553"])}onMenuOpen(){0<this.vjb?this.vjb++:(this.vjb++,a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(this.Dwj,0)}):this.Dwj(),this.showModal())}yun(){const v=
document.getElementById("WACToolbarContainer");return!!v&&"block"===v.style.display}getRibbonMode(){return this.hqh&&this.yun()?"Toolbar":z.f()}Akm(){const v=this.getRibbonMode(),D=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.gqh&&D.isActive&&0!==D.state?"_ShyRibbon":"")}lPm(v){var D=0;if(this.nA){if(this.BLe[v])return this.BLe[v];(D=document.getElementById("BusinessBar"))||m.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");
D=D?D.offsetTop:0;this.BLe[v]=D}return D}showModal(){if(!this.Uu)if(this.Uu=this.createElement("div"),this.Uu.setAttribute("id","ReactModalDiv"),this.Uu.style.position="absolute",this.Uu.style.bottom="0px",this.Uu.style.left="0px",this.Uu.style.right="0px",this.Uu.style.backgroundColor="white",this.Uu.style.opacity="0.0",this.nA){var v=document.getElementById("regionComposerRoot");v&&v.appendChild(this.Uu)}else this.$_e.appendChild(this.Uu);v=this.Akm();if(v!==this.prh){const y=this.lPm(v);var D=
appChrome.selectors.getShyState();this.gqh&&D.isActive&&0!==D.state?(D=this.hqh?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(z.f()),this.Uu.style.top=String.format("{0}px",y+D)):this.Uu.style.top=String.format("{0}px",y);this.prh=v}this.Uu.style.display="block";this.Uu.style.visibility="visible";this.Uu.style.zIndex="1000";this.qKd||(window.addEventListener("wheel",this.Ywh,!0),this.qee()?w.a.instance.ub(l.a.EP,this.Uu,this.Ime):
w.a.instance.ub(l.a.kt,this.Uu,this.Hme),this.qKd=!0)}onMenuClose(){this.vjb--;0<this.vjb||(0>this.vjb?this.vjb=0:this.mOi())}mdg(){this.vjb=0;this.Nwf();this.mOi()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}lOi(){this.Zb&&this.Zb.currentScope&&this.Zb.currentScope.name===f.AFrame.Oga&&!a.AFrameworkApplication.pc.Yz&&this.Zb.bV(f.AFrame.Oga,!1);this.Uu&&(this.Uu.style.zIndex="-1",this.Uu.style.visibility="hidden",this.Uu.style.display="none");this.qKd&&
(window.removeEventListener("wheel",this.Ywh,!0),this.qee()?w.a.instance.xc(l.a.EP,this.Uu,this.Ime):w.a.instance.xc(l.a.kt,this.Uu,this.Hme),this.qKd=!1)}mOi(){this.qee()||this.tYf()||this.Dln()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.lOi()},0)}):this.lOi()}lyb(){4===a.AFrameworkApplication.ua.Gb.Mk&&a.AFrameworkApplication.J.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?a.AFrameworkApplication.ua.lyb():this.Zb.Gg(f.AFrame.Do)}jZc(){const v=x.a.instance.Oa("Common.IReactContextualUILauncher");
v&&v.jZc()}Nwf(){const v=x.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.Nwf()}hgi(){a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Gb.gXa&&(this.qee()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}qee(){return a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}Dln(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScope",
!1)}tYf(){var v,D;return(null!==(D=null===(v=a.AFrameworkApplication.J)||void 0===v?void 0:v.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScopeAsyncEnabled",!1))&&void 0!==D?D:!1)&&null!=window&&null!=window.Event&&null!=window.Event.ActionCommandId&&this.yyk.has(window.Event.ActionCommandId)}}Object(I.a)(u,"ReactModalDiv",null,[])},1704:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(1047),f=d(5);class a{constructor(l,w){this.sQ=this.wMc=null;this.hb=l;this.Zgb=
w}get key(){return"COMMENT"}get Fv(){return WordEditorIntl.WordEditorStrings.L_Comment}get TO(){return this.sQ}reset(l){this.sQ=l.node}rEa(l){let w=null;if(this.wMc&&this.oWi(l,this.TO,this.wMc))return w=Object.assign(new m.a,{dG:this.key,contentObject:this.wMc}),{returnValue:!0,JG:w};this.wMc=null;const z=this.Zgb.Asf(this.TO);if(this.Zgb.JWf(z)){let x=z.je();for(;x;){if(this.oWi(l,this.TO,x))return this.wMc=x,w=Object.assign(new m.a,{dG:this.key,contentObject:x,description:this.mVa()}),{returnValue:!0,
JG:w};x=z.Tk()}}return{returnValue:!1,JG:w}}oWi(l,w,z){if(this.nTj(z))return!1;const x=this.Zgb.Pkc(z,!0),u=this.Zgb.Pkc(z,!1);return x&&u&&this.hb.e$c(w,x,u)&&(w=this.Zgb.qAa(x,z.id,!0))&&(x!==this.TO||w.Ib.cp<=l)&&(z=this.Zgb.qAa(u,z.id,!1))&&(u!==this.TO||z.Ib.cp>l||z.Ib.cp>=l)?!0:!1}nTj(l){return l.ka(f.a.yI,!1)}mVa(){return null}}Object(I.a)(a,"CommentDetailsProvider",null,[299,300])},1711:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);J=d(526);var m=d(235);class f extends J.a{constructor(){super();
this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(I.a)(f,"DocumentTypeClassifierAnnotation",J.a,[])},1715:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.pM:x.writable||x.configurable))x=
{enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1901),J);f(d(1902),J)},1716:function(I,J,d){d.r(J);d.d(J,"FootnoteEndnoteDefaultContentInserter",function(){return K});I=d(0);var m=d(19),f=d(48),a=d(2),l=d(31),w=d(107),z=d(559),x=d(26),u=d(5),v=d(13),
D=d(59),y=d(109),H=d(1162),F=d(904),G=d(1599);class K{constructor(R,E,N,O,U=null){this.fd=R;this.sqk=E;this.Hm=N;K.Vh=O;this.Xch=U||K.dHl}get DN(){return null!=this.Z0g?this.Z0g:this.Z0g=m.a.instance.resolve("Box4.IOutlineEditor")}aFl(R,E){var N=this.fd.Ql();N.set(R);this.DN.rSb(N,null,!0);K.Vh.P_b(N.currentNode,this.Hm);R=l.OutlineElementNavigator.Me(N);K.p4.pod(E?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,R);N=this.Xch(N.currentNode);K.Cg.We(N,K.sdi);
this.dbn(R,E)}dbn(R,E){var N=this.sqk(D.a.Rma);N.setValue(u.a.jt,1===E?36:35);N.setValue(u.a.hka,!0);N.setValue(v.a.Mca,!0);const O=R.Hc.hu(N,f.a.create());N=this.Xch(R);K.Cg.Lla(N,U=>F.a.getInstance(U,O,!0),G.a.vui(R,E,Object(w.a)()))}static Qm(){return new K(new z.a,Object(y.a)(H.a.instance,H.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get p4(){return null!=K.$3g?K.$3g:K.$3g=m.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Cg(){return null!=
K.BSg?K.BSg:K.BSg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=K.dZg?K.dZg:K.dZg=K.Qm()}static dHl(R){return x.a.Uc(R,0)}}K.sdi=" ";K.Vh=null;Object(I.a)(K,"FootnoteEndnoteDefaultContentInserter",null,[692])},1717:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=d(559),f=d(545),a=d(1491),l=d(1599);class w{constructor(z,x){this.Qwa=x}F9d(z,x,u){return(z=this.Qwa.cCi(z.node,u?z.cpBegin:z.cpEnd,x))?z.g7():null}NKi(z,x){return(z=this.Qwa.KGm(z.node,
z.cpBegin,x))?z.g7():null}static $2c(){return new w(f.a.instance,a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=w.CYg?w.CYg:w.CYg=w.$2c()}}Object(I.a)(w,"FootnoteEndnoteNavigator",null,[666])},1729:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=d(2179),f=d(2),a=d(40),l=d(19);class w{constructor(z,x,u,v,D,y){this.oxa=z;this.pxa=x;this.nUe=u;this.b1=v;this.Azd=D;this.e4b=y}get mUj(){return!this.pxa&&!this.nUe}get eij(){return 2===this.e4b?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get Xki(){return CommonUIStrings.l_OICErrorMessageNoOffice}get hPi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Prb(){return CommonUIStrings.l_OICErrorHelpLink}get $Ni(){return"OICFailure"}get icon(){return 3}get $Pd(){return 2===this.e4b?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}apo(z){this.qij(z)}cAn(z){this.qij(z)}qij(z){let x=
10;1===z?(l.a.instance.resolve("Common.IOfficeTrialExperience").r2f(this.e4b),x=3):2===z&&((!this.nUe||this.nUe(this.b1))&&this.pxa&&m.a.instance.vIl(this.pxa,this.oxa,this.b1),x=5);(0===z||1===z)&&this.oxa&&this.oxa(this.b1);f.AFrameworkApplication.hld(a.a.wpj,this.Azd,x);this.dispose()}dispose(){this.b1=this.pxa=this.oxa=null}}Object(I.a)(w,"AOICErrorDialogWithTrial",null,[10])},1814:function(I,J,d){I=d(0);var m=d(173),f=d(16),a=d(74),l=d(19),w=d(2),z=d(228),x=d(629);class u{static get mh(){return m.a.uy(u.lo,
WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.lo="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(I.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var v=d(18),D=d(3);d.d(J,"a",function(){return y});class y extends m.a{constructor(H,F,G){super();this.mkh=!1;this.bZ=null;this.rcm=K=>{switch(K){case 1:this.ga.Ob(v.a.cqi,2);break;case 2:this.ga.Ob(v.a.dqi,2);break;case 0:this.ga.Ob(v.a.eqi,2)}};this.zv=F;this.TV=!1;this.W6b=y.Zbm;this.ii=H;this.ga=G;this.Ig="FootnoteEndnoteFormattingOptionsDialog";this.Bd=2;this.mh=u.mh;this.Ke(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ke(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Uh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.rcm,null);this.Irb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.bZ}set fontName(H){this.bZ=H;if(H=document.getElementById("FontSizeComboBox"))H.focus(),this.ii.Ge()}get fontSize(){return this.W6b}get Irb(){return this.mkh}set Irb(H){this.mkh=H;this.jdo()}Jba(){this.BTd("FontStyleComboBox",
"FontPlaceholder",v.a.H3d.toString(),v.a.Twj.toString(),v.a.qhd.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.BTd("FontSizeComboBox","FontPlaceholder",v.a.I3d.toString(),D.a.zid.toString(),v.a.rhd.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.P_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.P_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.kUc("NoStyle","IndentPlaceholderStyles",
v.a.gqi.toString(),v.a.Uwj.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.kUc("FirstLineIndent","IndentPlaceholderStyles",v.a.fqi.toString(),v.a.nng.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}BTd(H,F,G,K,R,E,N){G=z.c(H,G,!0,!0,K,R,f.a.yf(E),!0,N);this.bYd(H,F,G,"Medium")}kUc(H,F,G,K,R,E,N){G=z.f(H,G,K,f.a.yf(R),f.a.yf(E),N);this.bYd(H,F,G,"Large",E)}bYd(H,F,G,K,R=null){F=document.getElementById(F);
this.zv.r5a(H,G);G=this.zv.OPb(H,K);R&&a.a.bSd(G,String.format("{0}Label",H),R);F.appendChild(G);this.zv.tua(H)}jdo(){this.zv.tua("NoStyle");this.zv.tua("FirstLineIndent")}dispose(){this.TV||(this.zv.B0("FontStyleComboBox"),this.zv.B0("FontSizeComboBox"),this.zv.B0("NoStyle"),this.zv.B0("FirstLineIndent"),this.TV=!0);this.ii.Ge();super.dispose()}static get Z_a(){return l.a.instance.resolve("Common.IStandaloneRootController").uha}static Ytm(){return new y(x.a.hm,y.Z_a,w.AFrameworkApplication.va)}static Xtm(){return y.Ytm()}}
y.Zbm=-1;Object(I.a)(y,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1853:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.ki=this.TFd=0;this.Hjh=a;this.MPk=f}pvb(){return this.TFd-this.ki>=this.MPk}reset(){this.ki=this.TFd=this.Hjh()}update(){this.TFd=this.Hjh()}}Object(I.a)(m,"TimeBasedTaskYieldStrategy",null,[318])},1870:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||
("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1871),J);f(d(1872),J)},1871:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1872:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});
J.EndnoteSubDocument=J.FootnoteSubDocument=J.ShapeSubDocument=J.TextboxSubDocument=J.CommentSubDocument=J.HeaderFooterSubDocument=J.MainSubDocument=void 0;const m=d(418);class f{constructor(v){m.SchemaObject.assign(f,this,v)}static getTypeName(){return"AugLoop_Word_MainSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[f.getTypeName()])}}J.MainSubDocument=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(v){m.SchemaObject.assign(a,
this,v)}static getTypeName(){return"AugLoop_Word_HeaderFooterSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[a.getTypeName()])}}J.HeaderFooterSubDocument=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(v){m.SchemaObject.assign(l,this,v)}static getTypeName(){return"AugLoop_Word_CommentSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[l.getTypeName()])}}J.CommentSubDocument=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(v){m.SchemaObject.assign(w,this,v)}static getTypeName(){return"AugLoop_Word_TextboxSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[w.getTypeName()])}}J.TextboxSubDocument=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(v){m.SchemaObject.assign(z,this,v)}static getTypeName(){return"AugLoop_Word_ShapeSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[z.getTypeName()])}}J.ShapeSubDocument=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(v){m.SchemaObject.assign(x,this,v)}static getTypeName(){return"AugLoop_Word_FootnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[x.getTypeName()])}}J.FootnoteSubDocument=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class u{constructor(v){m.SchemaObject.assign(u,this,v)}static getTypeName(){return"AugLoop_Word_EndnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[u.getTypeName()])}}J.EndnoteSubDocument=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1901:function(I,J){Object.defineProperty(J,"__esModule",{value:!0});J.ObjectSchemaType=J.ObjectSemantic=J.SequenceType=J.IntentIds=void 0;(function(d){d.Logging="Logging";d.ZeroTermMenu="ZeroTermMenu";d.Floatie="Floatie"})(J.IntentIds||(J.IntentIds={}));(function(d){d.CommandId="CommandId";d.ControlId="ControlId"})(J.SequenceType||(J.SequenceType={}));(function(d){d.CommandIdHistory="CommandIdHistory";d.ControlIdHistory=
"ControlIdHistory";d.FilteredCommandIdHistory="FilteredCommandIdHistory";d.CanvasContext="CanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.GenericSuggestions="GenericSuggestions"})(J.ObjectSemantic||(J.ObjectSemantic={}));(function(d){d.CommandExecutionSequence="CommandExecutionSequence";d.WordCanvasContext="WordCanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.RankedSuggestion="RankedSuggestion"})(J.ObjectSchemaType||(J.ObjectSchemaType=
{}))},1902:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.SearchSuggestionAnnotation=J.SearchSuggestionSignal=void 0;const m=d(418);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}J.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,
this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}J.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1910:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||
("get"in x?!l.pM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1911),J);f(d(1912),J);f(d(1913),J);f(d(1914),J)},1911:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1912:function(I,J){Object.defineProperty(J,
"__esModule",{value:!0})},1913:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntityAnnotation=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
J.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1914:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntitySignal=void 0;const m=d(418);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()}},1916:function(I,J,d){d.r(J);d.d(J,"ReactOICErrorDialogWithTrial",function(){return l});I=d(0);var m=d(109);J=d(1729);var f=d(477),a=d(173);class l extends J.a{constructor(w,z,x,u,v,D){super(w,z,x,u,v,D);z={["errorMessage"]:this.Xki,["offerString"]:this.eij};w=new a.a(!1,!1,!0);this.mUj?(w.Bd=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Prb,["onExecute"]:()=>{f.Redirect.showHelp(this.$Ni)}}):(w.Bd=4,w.Ke(2,this.hPi));w.Ke(1,this.$Pd);w.Ig=this.id;z={["id"]:this.id,
["dialogIcon"]:this.icon,["bodyControls"]:z};w.Uh(this.dialogTitle,Object(m.a)(this,this.apo,"reactOICErrorDialogWithTrialHandler"),z)}}Object(I.a)(l,"ReactOICErrorDialogWithTrial",J.a,[])},1917:function(I,J,d){d.r(J);d.d(J,"OICErrorDialogWithTrial",function(){return a});I=d(0);var m=d(109);J=d(1729);var f=d(175);class a extends J.a{constructor(l,w,z,x,u,v){super(l,w,z,x,u,v);l=document.createElement("span");l.innerText=this.Xki;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));
w=document.createElement("span");w.innerText=this.eij;l.appendChild(w);w=new f.StandardDialog;this.mUj?(w.Bd=1,w.KQd(this.Prb,this.$Ni)):(w.Bd=4,w.Ke(2,this.hPi));w.Ke(1,this.$Pd);w.Ig=this.id;w.sw(this.dialogTitle,null,this.icon,Object(m.a)(this,this.cAn,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(I.a)(a,"OICErrorDialogWithTrial",J.a,[])},1919:function(I,J,d){var m=this&&this.lQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[w]}})}:
function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1920),J);f(d(1921),J)},1920:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1921:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.SearchProviderAnnotation=J.SearchProviderSignal=void 0;const m=d(418);class f{constructor(l){m.SchemaObject.assign(f,
this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}J.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[a.getTypeName()])}}J.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},2019:function(I,J,d){function m(ma){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ma?Ga.Gwo():Ga.main();pd.main(ma);Wi.main(ma);xa.a.instance.Mc(new lo,0,ma);xa.a.instance.Mc(new El,0,ma);Zn(ma);vo(ma)}var f=d(0),a=d(8),l=d(1340),w;(function(ma){ma[ma.unknown=0]="unknown";ma[ma.supported=1]="supported";ma[ma.Yqq=
2]="userUnsupportedAnonymous";ma[ma.Zqq=3]="userUnsupportedNoLoginHint";ma[ma.U4p=4]="hostUnsupported";ma[ma.ohq=5]="perfAutomation"})(w||(w={}));Object(f.b)("SupportStatus",w);var z=d(927),x=d(1485);class u{constructor(ma){this.dFk=ma}initialize(){return Promise.resolve(0)}rhe(){return Promise.resolve(0)}tV(){a.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.dFk}))}vDe(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}aBe(){return!1}v4c(){return"MockAuthTokenStrategy"}}Object(f.a)(u,"MockAuthTokenStrategy",null,[246]);var v=d(1652);class D{static get(ma,Ua,xb){if(!xb)return ma;let Xb=0;return Promise.race([ma,new Promise(rc=>{Xb=window.setTimeout(()=>{rc(Ua)},xb)})]).then(rc=>{window.clearTimeout(Xb);return Promise.resolve(rc)}).catch(()=>{window.clearTimeout(Xb);
return Promise.resolve(Ua)})}}Object(f.a)(D,"PromiseWithTimeout",null,[]);var y=d(2),H=d(634);class F{constructor(ma,Ua,xb,Xb,rc){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ma;this.scope=Ua;this.silentLogin=xb;this.options=Xb;this.correlationId=rc}}Object(f.a)(F,"TokenRequestParameters",null,[247]);var G=d(17),K=d(19);class R{constructor(){this.zKh=null;let ma=y.AFrameworkApplication.J.jb(y.AFrameworkApplication.Yha),Ua=y.AFrameworkApplication.J.jb(y.AFrameworkApplication.KDe);
this.vac=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ma&&""!==ma?ma:"Unspecified",Ua&&""!==Ua?Ua:"Unspecified")}initialize(){return new Promise(ma=>{K.a.instance.Ta("Common.App.WopiIdentity.IWopiIdentity").execute(Ua=>{this.zKh=Ua;ma(0)})})}ie(ma){const Ua=["HTTPS:","API:"];let xb=!1;const Xb=ma.toLocaleUpperCase();for(const rc of Ua)if(Xb.startsWith(rc)){xb=!0;break}return xb||this.qln(ma)?ma+"/.default":ma}qln(ma){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ma)}rhe(){return Promise.resolve(0)}tV(ma,
Ua,xb,Xb,rc,Zc,Hd){if(G.a.mXa){rc=H.a.pGp;if(!rc)return Ua=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ua);if(!Array.contains(rc,ma))return Ua=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ma}),Promise.resolve(Ua)}ma=this.ie(xb);xb=new F(xb,ma,!Xb,null,y.AFrameworkApplication.userSessionId);return this.zKh.getAccessToken(xb,Ua,Hd).then(Jd=>Object.assign(new x.a,
{IsSuccess:!0,Token:Jd.accessToken}),Jd=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Jd}))}vDe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}aBe(){return!1}v4c(){return this.vac}}Object(f.a)(R,"ParentFrameTokenStrategy",null,[246]);var E=d(774),N=d(71);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.lwj=this.vVh=
null}}Object(f.a)(O,"PromiseWrapper",null,[]);class U{constructor(ma=0){this.wz=0;this.qNc=!1;this.Bz=new N.a;this._timeout=ma}enqueue(ma){return new Promise((Ua,xb)=>{this.Bz.add(Object.assign(new O,{lwj:ma,resolve:Ua,reject:xb}));this.process()})}process(){if(this.qNc||this.wz===this.Bz.count)return!1;const ma=this.Bz.K(this.wz++);try{this.qNc=!0,ma.lwj().then(Ua=>{this.qNc=!1;this.Hpf(ma,Ua,null,!0)}).catch(Ua=>{this.qNc=!1;this.Hpf(ma,null,Ua,!1)})}catch(Ua){this.qNc=!1,this.Hpf(ma,null,Ua,!1)}return!0}Hpf(ma,
Ua,xb,Xb){if(Xb){const rc=()=>{ma.resolve(Ua);this.process()};0<this._timeout?window.setTimeout(()=>{rc()},this._timeout):rc()}else{const rc=()=>{ma.reject(xb);this.process()};0<this._timeout?window.setTimeout(()=>{rc()},this._timeout):rc()}}}Object(f.a)(U,"PromiseQueue",null,[]);class X{constructor(){this.correlationId=this.resolve=null}}Object(f.a)(X,"ResolveWithCorrelation",null,[]);var V=d(80),Q=d(173),T=d(956),ba=d(90);class W extends Q.a{constructor(ma,Ua,xb,Xb,rc,Zc){super(!1,!1,!0);this.Deh=
this.rFa=null;this.f4n=()=>{this.xqi()};this.hGl=()=>this.vJ;this.a2o=Hd=>{0===Hd&&(this.kRk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.UEb(null))};this.Oxa=ma;this.FJk=xb;this.vv=Xb;this.kRk=rc;this.UEb=Zc;this.vJ=document.createElement("iframe");this.vJ.id="SharedAuthInteractiveFrame";this.vJ.setAttribute("name","SharedAuthInteractiveFrame");this.vJ.setAttribute("title","SharedAuthInteractiveFrame");this.vJ.setAttribute("sandbox",
"allow-scripts allow-same-origin allow-forms allow-popups");this.vJ.style.border="0";this.vJ.style.height="48px";this.vJ.style.width="190px";$addHandler(this.vJ,"error",this.f4n);ma=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Oxa,Ua,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",y.AFrameworkApplication.userType);this.vJ.src=ma;this.ttk=new Promise(Hd=>{this.Deh=Hd});this.Eeh=!1}y_a(){this.rFa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.FJk,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:y.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.hGl,["resolveDialogStyles"]:this.Deh}};this.Bd=5;this.Uh(CommonUIStrings.l_SignIn,this.a2o,this.rFa)}G8j(ma=!1,Ua=5){this.rFa&&this.rFa.bodyControls&&(!0!==Object(V.a)(Object,this.rFa.bodyControls).frameLoaded&&(Object(V.a)(Object,this.rFa.bodyControls).frameLoaded=!0),ma!==Object(V.a)(Object,this.rFa.bodyControls).frameLoadSuccess&&(Object(V.a)(Object,this.rFa.bodyControls).frameLoadSuccess=
ma),Ua!==this.rFa.dialogButtonsOption&&(this.rFa.dialogButtonsOption=null,this.Bd=Ua),this.update(this.rFa))}M9o(ma,Ua){const xb=new T.a(ba.a.e2o);xb.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:y.AFrameworkApplication.isRtl,["messageCorrelationId"]:ma,["dialogStyles"]:Ua};this.vv.Gdb(xb,this.vJ.contentWindow,this.Oxa)}xqi(){this.G8j(!1,6)}get pRj(){return this.vJ}get KTl(){return this.ttk.then(ma=>{this.Eeh=!0;return ma})}get LTl(){return this.Eeh}}
Object(f.a)(W,"SharedAuthConsentDialog",Q.a,[248]);var aa=d(978),Y=d(85),da=d(877),ka=d(43),qa=d(118),ua=d(93);class Pa{}Pa.kpiName="OAuthManager";Object(f.a)(Pa,"OAuthManagerConstants",null,[]);class Ja{constructor(){this.vJ=null;this.PCd=0;this.X8b=this.ebc=this.vKe=this.UEb=this.Xda=this.yIh=null;this.r_n=()=>{const ma=ka.a.Je()-this.PCd;a.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ma)};this.Uvb=ma=>{const Ua=ka.a.Je()-this.PCd,xb=Object.assign(new ua.a,
{durationMs:Ua});Y.Health.instance.recordKpiFailure(Pa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,xb);a.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Ua,this.jgh?JSON.stringify(ma):"")};this.J3n=ma=>{const Ua=this.hkb.loadFrame;var xb=ka.a.Je()-Ua.startTime,Xb=ma.Values.AuthLibrary.toString();ma=ma.Values.Success.toString();a.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ma,Xb,xb);
Xb&&(this.vac="SharedAuthTokenStrategy "+Xb);Xb=Boolean.parse(ma);Xb||(ma=da.a.XG(),void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.v4c()),xb=Object.assign(new ua.a,{durationMs:xb,extendedProperties:ma}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,xb)));Ua.resolve(Xb?0:1)};this.I3n=ma=>{if(ma.Values.interactive&&this.ebc&&this.ebc.Values.messageCorrelationId){const xb=this.ebc.Values.messageCorrelationId.toString();if(ma.Values.interactive&&this.Xda){this.Xda.KTl.then(Xb=>
{this.vv.Gdb(this.ebc,this.Xda.pRj.contentWindow,this.Oxa);this.Xda.M9o(xb,Xb);this.Xda.G8j(!0);this.ebc=null});return}}ma=this.hkb.initFrame;const Ua=ka.a.Je()-ma.startTime;a.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ua);ma.resolve(0)};this.VZn=ma=>{if(ma.Values.messageCorrelationId&&ma.Values.messageCorrelationId.toString()){var Ua=ma.Values.messageCorrelationId.toString(),xb=this.hkb[Ua];if(xb){var Xb=ka.a.Je()-xb.startTime;a.ULS.sendTraceTag(573112906,
3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Xb);ma.Values.isSuccess&&ma.Values.isSuccess?xb.resolve(ma.Values.response):xb.reject(ma.Values.response);this.k4j(Ua)}else a.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.O_n=()=>{if(this.Xda.LTl)this.Xda.xqi();else if(this.vKe&&
this.Xda){const ma=new T.a(ba.a.sRj);ma.Values=this.bVh(this.vKe,!0);this.vv.Gdb(ma,this.Xda.pRj.contentWindow,this.Oxa)}};this.g_n=()=>{this.Xda&&this.Xda.T$d()};this.ndg=ma=>{ma.Values.cancelled&&ma.Values.cancelled&&ma.Values.messageCorrelationId&&this.k4j(ma.Values.messageCorrelationId.toString());this.Xda&&this.Xda.hide()};this.q0n=ma=>{if(ma.Values.messageCorrelationId&&ma.Values.messageCorrelationId.toString()){var Ua=this.hkb[ma.Values.messageCorrelationId.toString()];if(Ua){var xb=ka.a.Je()-
Ua.startTime;a.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",xb);ma.Values.isSuccess&&ma.Values.isSuccess?Ua.resolve(ma.Values.response):Ua.reject(ma.Values.response)}else a.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.vv=new aa.a(null,null);this.vac=
"SharedAuthTokenStrategy Unloaded";this.Oxa=H.a.c2o;this.sEh=H.a.b2o;this.jgh=H.a.enableConsoleLogging;this.Cuk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.qOk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.eSk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.hkb={};this.$zk=new U(1500)}v4c(){return this.vac}initialize(){if("loadFrame"in
this.hkb)return this.hkb.loadFrame.vVh;if(!this.Oxa)return Y.Health.instance.recordKpiFailure(Pa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),a.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const ma=this.DAe("loadFrame");this.PCd=ka.a.Je();var Ua=this.Oxa+this.sEh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+y.AFrameworkApplication.userSessionId+"&WacUserType="+y.AFrameworkApplication.userType;
this.eSk&&(Ua+="&webworker=1");this.vJ=document.createElement("iframe");this.fUf(this.vJ);this.vJ.style.cssText="height:0;width:0;display:none;";this.vJ.id="SharedAuthFrame";this.vJ.setAttribute("name","SharedAuthFrame");this.vJ.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.vJ.setAttribute("title","SharedAuthFrame");this.vJ.src=Ua;document.body.appendChild(this.vJ);Ua=ka.a.Je()-this.PCd;a.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
Ua,this.vJ.src);return ma}rhe(ma){this.vKe=ma;const Ua=new T.a(ba.a.sRj);Ua.Values=this.bVh(ma);ma=this.DAe("initFrame");this.vv.Gdb(Ua,this.vJ.contentWindow,this.Oxa);a.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ma}tV(ma,Ua,xb,Xb,rc,Zc){const Hd=new T.a(ba.a.f2o),Jd=this.lFi();Hd.Values=this.P3j(ma,Ua,xb,Xb,rc,Zc,Jd);ma=this.DAe(Jd);Xb&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.$zk.enqueue(()=>new Promise(Xd=>{this.Pqp(Zc,Hd,Xd,Jd)})):(this.vv.Gdb(Hd,this.vJ.contentWindow,this.Oxa),a.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ua));return ma}Pqp(ma,Ua,xb,Xb){const rc=this.hkb[Xb];rc&&(this.ebc=Ua,this.UEb=Object.assign(new X,{resolve:xb,correlationId:Xb}),this.Xda=new W(this.Oxa,this.sEh,ma,this.vv,rc,xb),this.Xda.y_a())}lFi(){return qa.a.create().toString()}P3j(ma,Ua,xb,Xb,rc,Zc,Hd){const Jd={};Jd.appName=
ma;Jd.appId=Ua;Jd.target=xb;Jd.withPopup=Xb;Jd.claims=rc;Jd.promptMessage=Zc;Jd.messageCorrelationId=Hd;return Jd}fUf(ma){$addHandler(ma,"load",this.r_n);$addHandler(ma,"error",this.Uvb);this.vv.Lja(this.Oxa);this.vv.Bv(ba.a.vRj);this.vv.LE(ba.a.vRj,this.J3n);this.vv.Bv(ba.a.uRj);this.vv.LE(ba.a.uRj,this.I3n);this.vv.Bv(ba.a.qRj);this.vv.LE(ba.a.qRj,this.VZn);this.vv.Bv(ba.a.wRj);this.vv.LE(ba.a.wRj,this.q0n);this.vv.Bv(ba.a.tRj);this.vv.LE(ba.a.tRj,this.O_n);this.vv.Bv(ba.a.rRj);this.vv.LE(ba.a.rRj,
this.g_n);this.vv.Bv(ba.a.oRj);this.vv.LE(ba.a.oRj,this.ndg)}DAe(ma){const Ua=new O;Ua.startTime=ka.a.Je();const xb=new Promise((Xb,rc)=>{Ua.resolve=Xb;Ua.reject=rc});Ua.vVh=xb;this.hkb[ma]=Ua;return xb}bVh(ma,Ua=!1){const xb={};xb.appIds=this.rim();xb.upn=ma.loginHint;xb.authority=ma.authority;xb.authorityType=Object(l.a)(z.a,ma.authorityType);xb.tenantId=ma.tenantId;xb.correlationId=y.AFrameworkApplication.userSessionId;xb.enableConsoleLogging=this.jgh;xb.enablePopupFlash=this.Cuk;xb.skipUpnCheck=
this.qOk;xb.interactive=Ua;return xb}rim(){const ma=[],Ua=H.a.fhf;for(const Xb in Ua){var xb=Ua[Xb];Array.contains(ma,xb)||Array.add(ma,xb)}return ma}vDe(ma,Ua,xb,Xb,rc,Zc){const Hd=new T.a(ba.a.d2o),Jd=this.lFi();Hd.Values=this.P3j(ma,Ua,xb,Xb,rc,Zc,Jd);this.yIh=Hd;ma=this.DAe(Jd);a.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ua);this.l7o();return ma}aBe(){return!0}l7o(){this.X8b||(this.X8b=new E.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.X8b.id=16,this.X8b.R9c=!1,this.X8b.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{a.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.vv.Gdb(this.yIh,this.vJ.contentWindow,this.Oxa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),y.AFrameworkApplication.ua.Gb.rya(this.X8b,!0)||a.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}k4j(ma){this.UEb&&
this.UEb.correlationId===ma&&(this.UEb.resolve(null),this.UEb=null)}}Object(f.a)(Ja,"SharedAuthTokenStrategy",null,[246]);class Ca{constructor(ma){this.q$=ma;this.vac="UnsupportedAuthTokenStrategy Reason="+w[this.q$]}initialize(){return Promise.resolve(0)}rhe(){return Promise.resolve(0)}tV(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:w[this.q$],ErrorMessage:"Unable to get a token. Reason: ["+w[this.q$]+"]"}))}vDe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,
ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}aBe(){return!1}v4c(){return this.vac}}Object(f.a)(Ca,"UnsupportedAuthTokenStrategy",null,[246]);var ra=d(1415);class Ea{constructor(ma=null){this.U4=0;this.bda=null;this.PHb=0;this.Lph=!!window.location.search.match(RegExp("wdpa=1","gi"));const Ua=ka.a.Je();this.Gzk=this.JSl(ma).then(xb=>xb?this.x6m():(a.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.PJ(),Math.floor(ka.a.Je()-Ua)),xb=da.a.XG(),void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.PJ()),xb=Object.assign(new ua.a,{durationMs:Math.floor(ka.a.Je()-Ua),extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"StrategyPickFailed",!1,!0,xb)),Promise.resolve(1))).then(xb=>0!==xb?Promise.resolve(xb):this.yBn())}KSl(){if(this.Lph)this.U4=5,this.bda=new Ca(this.U4);else{var ma=H.a.GOn;ma&&0<ma.length?(this.U4=1,this.bda=new u(ma)):y.AFrameworkApplication.J.$("IsO365ConsumerHost")||
y.AFrameworkApplication.J.$("IsO365CommercialHost")?y.AFrameworkApplication.J.$("IsAnonymousUser")?(this.U4=2,this.bda=new Ca(this.U4)):(ma=v.a.getAuthContext().loginHint)&&ma.length?H.a.r6c?(this.U4=1,this.bda=new R):(this.U4=1,this.bda=new Ja):(this.U4=3,this.bda=new Ca(this.U4)):(this.U4=4,this.bda=new Ca(this.U4))}}PJ(){return this.bda?this.bda.v4c()||"Unknown":"None"}JSl(ma=null){a.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ua=ka.a.Je();return y.AFrameworkApplication.J.kum().then(xb=>
{xb?(this.KSl(),ma&&(this.bda=ma),a.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",H.a.clientVersion,H.a.appVersion,H.a.sXl,this.PJ(),Math.floor(ka.a.Je()-Ua))):a.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ka.a.Je()-Ua));return Promise.resolve(xb)},()=>{a.ULS.sendTraceTag(562128580,
3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ka.a.Je()-Ua));return Promise.resolve(!1)})}x6m(){a.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.PJ());const ma=ka.a.Je();return D.get(this.bda.initialize(),2,H.a.umg).then(Ua=>{if(0===Ua)a.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.PJ(),Math.floor(ka.a.Je()-ma));else if(1===Ua){a.ULS.sendTraceTag(527827291,
3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.PJ(),Math.floor(ka.a.Je()-ma));var xb=da.a.XG();void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.PJ()),xb=Object.assign(new ua.a,{durationMs:Math.floor(ka.a.Je()-ma),extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"StrategyInitFailed",!1,!0,xb))}else 2===Ua&&(a.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.PJ(),Math.floor(ka.a.Je()-ma)),xb=da.a.XG(),void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.PJ()),xb=Object.assign(new ua.a,{durationMs:Math.floor(ka.a.Je()-ma),extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"StrategyInitTimedOut",!1,!0,xb)));return Promise.resolve(Ua)},()=>{a.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.PJ(),Math.floor(ka.a.Je()-ma));return Promise.resolve(1)})}yBn(){a.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.PJ());const ma=ka.a.Je();return D.get(this.bda.rhe(v.a.getAuthContext()),2,H.a.umg).then(Ua=>{if(0===Ua)a.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.PJ(),Math.floor(ka.a.Je()-ma));else if(1===Ua){a.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.PJ(),Math.floor(ka.a.Je()-ma));var xb=da.a.XG();void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.PJ()),xb=Object.assign(new ua.a,
{durationMs:Math.floor(ka.a.Je()-ma),extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"StrategyLoadFailed",!1,!0,xb))}else 2===Ua&&(a.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.PJ(),Math.floor(ka.a.Je()-ma)),xb=da.a.XG(),void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.PJ()),xb=Object.assign(new ua.a,{durationMs:Math.floor(ka.a.Je()-ma),extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,
"StrategyLoadTimedOut",!1,!0,xb)));return Promise.resolve(Ua)},()=>{a.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.PJ(),Math.floor(ka.a.Je()-ma));return Promise.resolve(1)})}tV(ma,Ua,xb=null,Xb){return this.sAc(ma,Ua,!1,Xb,"",xb)}Q3j(ma,Ua,xb,Xb,rc=null){return this.sAc(ma,Ua,!0,xb,Xb,rc)}sAc(ma,Ua,xb,Xb,rc,Zc,Hd=0){Hd+=1;a.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
ma,this.XZb(ma,Ua),this.PJ(),Hd);var Jd=da.a.XG();void 0!==Jd&&null!==Jd&&(Jd.set("AuthLibrary",this.PJ()),Jd.set("AppName",ma),Jd.set("Target",this.XZb(ma,Ua)),Y.Health.instance.recordKpiUsage(Pa.kpiName,0,"WacOAuthFC",Jd));if(!H.a.isEnabled||this.Lph){var Xd;return this.i5f((Xd=new x.a,Xd.IsSuccess=!1,Xd.Token=null,Xd.ErrorCode="NotEnabled",Xd.ErrorMessage="OAuthManager is disabled.",Xd),ma)}const je=H.a.fhf[ma];if(void 0===je||null===je){a.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ma);var af;return this.i5f((af=new x.a,af.IsSuccess=!1,af.Token=null,af.ErrorCode="DisallowedApp",af.ErrorMessage="Disallowed appName: "+ma,af),ma)}const Wf=ka.a.Je();let Mg=Wf;const bi=this;Jd=this.Gzk.then(sk=>{Mg=ka.a.Je();return bi.pen(ma,je,Ua,xb,Xb,rc,Zc,sk)});Xd=xb?0:H.a.umg;let zh;af=(zh=new x.a,zh.IsSuccess=!1,zh.Token=null,zh.ErrorCode="authTokenStrategy_timeout",zh.ErrorMessage="Auth Strategy timed out after ["+Xd+"] ms when fetching token",zh);const Ah=this,Zi=this;return D.get(Jd,af,
Xd).then(sk=>Hd<=Ea.YLn&&(sk.ErrorCode===Ea.N0j||sk.ErrorCode===Ea.lfp)?(a.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Hd,Math.floor(ka.a.Je()-Wf)),Ah.sAc(ma,Ua,xb,Xb,rc,Zc,Hd)):sk.ErrorCode===Ea.p4i&&!xb&&(a.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Hd,Ea.lji),Ea.a0l&&Ah.bda.aBe()&&Ah.bda.vDe(ma,je,Ua,xb,Xb,rc).then(gm=>Promise.resolve(Ah.$he(gm,ma,Ua,je,Wf,Mg))).catch(()=>
{let gm;const Gj=(gm=new x.a,gm.IsSuccess=!1,gm.Token=null,gm.ErrorCode="authTokenStrategy_failure",gm.ErrorMessage="LoginPopup failed, GetToken could not be called",gm);return Promise.resolve(Ah.$he(Gj,ma,Ua,je,Wf,Mg))}),Ea.lji)?Ah.sAc(ma,Ua,!0,Xb,rc,Zc,Hd):Promise.resolve(Ah.$he(sk,ma,Ua,je,Wf,Mg))).catch(()=>{let sk;const gm=(sk=new x.a,sk.IsSuccess=!1,sk.Token=null,sk.ErrorCode="authTokenStrategy_failure",sk.ErrorMessage="Auth Strategy failed with an unknown error",sk);return Promise.resolve(Zi.$he(gm,
ma,Ua,je,Wf,Mg))})}pen(ma,Ua,xb,Xb,rc,Zc,Hd,Jd){return 1===Jd||2===Jd?this.i5f(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Jd?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ma):this.bda.tV(ma,Ua,xb,Xb,rc,Zc,Hd).then(Xd=>Promise.resolve(this.chj(Xd,!0,ma))).catch(Xd=>Promise.resolve(this.chj(Xd,!1,ma)))}$he(ma,Ua,xb,Xb,rc,Zc){const Hd={},Jd=ka.a.Je()-Zc;Hd.IsSuccess=ma.IsSuccess;Hd.ErrorCode=ma.IsSuccess?"Success":ma.ErrorCode||"";Hd.ErrorMessage=
ma.IsSuccess?"Success":this.XZb(Ua,ma.ErrorMessage||"");Hd.Target=this.XZb(Ua,xb||"");Hd.TimeInMS=Math.floor(Jd);Hd.LoadTimeInMS=Math.floor(Zc-rc);Hd.AuthLibrary=this.PJ();Hd.AppName=Ua;Hd.AuthorityType=Object(l.a)(z.a,v.a.D4d());Hd.UserType=this.SQm(v.a.getAuthContext());Hd.IsAuthSupportedInSession=w[this.U4];Hd.RequestCount=++this.PHb;Hd.AppId=Xb;a.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Hd));ma.IsSuccess||(xb=da.a.XG(),void 0!==xb&&null!==xb&&(xb.set("AppName",Ua),xb.set("AuthLibrary",
this.PJ()),xb.set("ErrorCode",ma.ErrorCode),xb.set("ErrorMessage",this.XZb(Ua,ma.ErrorMessage)),Ua=Object.assign(new ua.a,{durationMs:Jd,extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"TryGetTokenFailure",!1,!0,Ua)));return ma}i5f(ma,Ua){a.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ua,this.XZb(Ua,ma.ErrorMessage));const xb=da.a.XG();void 0!==xb&&null!==xb&&(xb.set("AppName",Ua),xb.set("AuthLibrary",this.PJ()),
xb.set("ErrorCode",ma.ErrorCode),xb.set("ErrorMessage",this.XZb(Ua,ma.ErrorMessage)),Ua=Object.assign(new ua.a,{extendedProperties:xb}),Y.Health.instance.recordKpiFailure(Pa.kpiName,"FailureBeforeGetToken",!1,!0,Ua));return Promise.resolve(ma)}cYi(ma){return ma===ra.a.mCe}XZb(ma,Ua){return this.cYi(ma)&&Ua?"REDACTED":Ua}SQm(ma){return y.AFrameworkApplication.J.$("IsAnonymousUser")?"anonymous":!ma.loginHint||1>ma.loginHint.length?"empty":-1<ma.loginHint.indexOf("guest#")?"guest":-1<ma.loginHint.indexOf("ext#")?
"external":0>ma.upn.indexOf("@")?"no-at":"supported"}Afn(){return 1===this.U4}chj(ma,Ua,xb){let Xb=null,rc=null,Zc=null,Hd=null;ma?ma.ErrorCode||ma.ErrorMessage?(rc=ma.ErrorCode?ma.ErrorCode:Ea.wli,Zc=ma.ErrorMessage?ma.ErrorMessage:"No message"):ma.Token?Ua?Xb=ma.Token:(rc=Ea.fyo,Zc="A rejected promise returned a token."):(rc=Ea.wli,Zc=JSON.stringify(ma)):(rc=Ea.fSn,Zc="No result came from Auth Token Strategy");ma&&ma.Telemetry&&!this.cYi(xb)&&(Hd=ma.Telemetry,a.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(Hd)));if(rc===Ea.bPn||rc===Ea.Pmp)rc=Ea.N0j,Zc="Auth Library Timed Out";rc===Ea.dbl&&-1<Zc.indexOf(Ea.pTk)&&(rc=Ea.p4i);if(rc||Zc)Xb=null;return Object.assign(new x.a,{IsSuccess:!!Xb,Token:Xb,ErrorCode:rc,ErrorMessage:Zc,Telemetry:Hd})}static get lji(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get a0l(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ea.Pmp="token_renewal_error";Ea.wli="Exception";Ea.fSn="NoResult";Ea.fyo="RejectToken";Ea.bPn="monitor_window_timeout";Ea.N0j="Timeout";Ea.lfp="authTokenStrategy_timeout";Ea.dbl="login_required";Ea.pTk="AADSTS50058";Ea.p4i="Cookies Disabled";Ea.YLn=2;Object(f.a)(Ea,"OAuthManager",null,[244]);var xa=d(178),Ma=d(29),ha=d(46),la=d(81),Fa=d(95);class Ga{get name(){return"Common.App.OAuth.OAuthPackage"}wc(ma){ma.register(244,"Common.App.OAuth.IOAuthManager").ha().Ud(()=>new Ea)}init(){const ma=K.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Urp(ma);this.Trp(ma)}Trp(ma){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Ua=y.AFrameworkApplication.J.jb("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Ua){var xb=H.a.KXd;if(xb&&xb.IsEnabled){var Xb=xb.Application,rc=H.a.authority;if(void 0!==Xb&&null!==Xb&&Xb.length&&void 0!==rc&&null!==rc&&rc.length){var Zc=
w[ma.U4],Hd=G.a.cE,Jd=ma.PJ();rc=JSON.stringify({access_token:{["xms_cc"]:{values:["cp1"]}}});var Xd=ka.a.Je();ma.tV("CAETest",Xb,null,rc).then(je=>{const af=Math.floor(ka.a.Je()-Xd);Zc=w[ma.U4];Hd=G.a.cE;Jd=ma.PJ();a.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',af,je.IsSuccess,Zc,je.ErrorCode,Ua,Hd,Jd);if(je.IsSuccess){je="Bearer "+
je.Token;var Wf=xb.Endpoint;if(Wf){var Mg=ka.a.Je();je={["Authorization"]:je};var bi=new Fa.a;bi.add("EnforceCAE","1");bi.add("IsCAEToken","1");Wf=ha.a.eef(Wf,bi);y.AFrameworkApplication.Fe.oKb(Wf,1,null,je,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(zh=>{var Ah=Math.floor(ka.a.Je()-Mg),Zi=null;zh.Zo?zh="Canceled":zh.Yi?zh="Faulted":(Zi=zh.result,zh=Zi.succeeded?"Completed":"Failed");Ah={["TaskResult"]:zh,["BrowserTokenDurationMS"]:af,["BrowserValidationDurationMS"]:Ah};Zi&&
(Ah.HttpStatus=Zi.args.data.He,Zi.succeeded&&(Zi=Ma.a(Zi.args.data.Pe),Ah.ServerValidationDurationMS=Zi.ElapsedMilliseconds,Ah.ServerValidationResult=Zi.ValidatedToken,Ah.KMSI=Zi.KMSI,Ah.Scopes=Zi.Scopes,Ah.TokenExpirationS=Math.floor(parseInt(Zi.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(508950354,3E3,"Completed"===zh?50:15,la.a.toJSON(Ah))})}}else a.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",je.ErrorCode,je.ErrorMessage)}).catch(je=>
{const af=Math.floor(ka.a.Je()-Xd);a.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",je.toString(),af)})}}}}}Urp(ma){const Ua=y.AFrameworkApplication.J.jb("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Ua){var xb=H.a.KXd;if(xb&&xb.IsEnabled){var Xb=xb.Application,rc=H.a.authority;if(void 0!==Xb&&null!==Xb&&Xb.length&&void 0!==rc&&null!==rc&&rc.length){var Zc=w[ma.U4],Hd=G.a.cE,Jd=ma.PJ();
try{var Xd=new Map;void 0!==Xd&&null!==Xd?(Xd.set("SupportStatus",Zc),Xd.set("Browser",Hd),Xd.set("AuthStrategy",Jd)):Xd=null}catch(af){Xd=null}Y.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Xd);var je=ka.a.Je();ma.tV("Core",Xb).then(af=>{const Wf=Math.floor(ka.a.Je()-je);Zc=w[ma.U4];Hd=G.a.cE;Jd=ma.PJ();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Wf,af.IsSuccess,Zc,af.ErrorCode,Ua,Hd,Jd);Xd&&(Xd.set("SupportStatus",Zc),Xd.set("Browser",Hd),Xd.set("AuthStrategy",Jd));var Mg=Object.assign(new ua.a,{durationMs:Wf,extendedProperties:Xd});if(af.IsSuccess){if(Y.Health.instance.recordKpiSuccess("WacCorePFT",Mg),af="Bearer "+af.Token,y.AFrameworkApplication.Fe.$td=af,Mg=xb.Endpoint){var bi=ka.a.Je();y.AFrameworkApplication.Fe.oKb(Mg,1,null,{["Authorization"]:af},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(zh=>{var Ah=Math.floor(ka.a.Je()-
bi),Zi=null;zh.Zo?zh="Canceled":zh.Yi?zh="Faulted":(Zi=zh.result,zh=Zi.succeeded?"Completed":"Failed");Ah={["TaskResult"]:zh,["BrowserTokenDurationMS"]:Wf,["BrowserValidationDurationMS"]:Ah};Zi&&(Ah.HttpStatus=Zi.args.data.He,Zi.succeeded&&(Zi=Ma.a(Zi.args.data.Pe),Ah.ServerValidationDurationMS=Zi.ElapsedMilliseconds,Ah.ServerValidationResult=Zi.ValidatedToken,Ah.KMSI=Zi.KMSI,Ah.Scopes=Zi.Scopes,Ah.TokenExpirationS=Math.floor(parseInt(Zi.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===zh?50:15,la.a.toJSON(Ah))})}}else Y.Health.instance.recordKpiFailure("WacCorePFT",af.ErrorCode,!1,!1,Mg)}).catch(af=>{var Wf=Math.floor(ka.a.Je()-je);Wf=Object.assign(new ua.a,{durationMs:Wf,extendedProperties:Xd});Y.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+af.toString(),!1,!1,Wf)})}}}}dispose(){}static main(){xa.a.instance.Mc(new Ga)}static Gwo(){xa.a.instance.Mc(new Ga,0,!0)}}Object(f.a)(Ga,"OAuthPackage",null,[0,1]);var va=d(380),pa=d(364),Oa=d(16);class Ra{constructor(){new pa.a}}
Object(f.a)(Ra,"SdxPaneSuppressionManager",null,[]);var fb=d(272),qb=d(263),mb=d(131);class eb{constructor(ma){this.I0e=0;this.RFk=ma}pvb(){return this.I0e>=this.RFk}reset(){this.I0e=0}update(){this.I0e++}}Object(f.a)(eb,"NodeCountBasedTaskYieldStrategy",null,[318]);var bb=d(1853);class Wa{constructor(){this.pnd=new Set}gNa(ma){this.pnd.add(ma)}eup(ma){this.pnd.delete(ma)}X3n(){return()=>{this.pnd.forEach(ma=>{ma.onSessionClose()})}}Y3n(){return()=>{this.pnd.forEach(ma=>{ma.onSessionConnect()})}}Z3n(){return()=>
{this.pnd.forEach(ma=>{ma.onSessionDisconnect()})}}}Object(f.a)(Wa,"AlSessionLifeEventNotifier",null,[254]);var Za=d(1802),Na=d(86),Db=d(91),nb=d(48),Ta=d(5),cb=d(13),sb=d(1433),pb=d(526),tb=d(1402),wb=d(1439),gc=d(1436),vc=d(312),Pc=d(1458),ld=d(802),Dc=d(639),ic=d(771);class mc{constructor(){this.token=null}}Object(f.a)(mc,"ReleaseAnnotationParameters",null,[]);class Rc{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(Rc,"SetAnnotationMetadataParameters",null,[]);class rb{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(f.a)(rb,"SetAnnotationStateParameters",null,[]);var Cb=d(604),Kb=d(280),$b=d(481),ab=d(1573),ia=d(315),La=d(636),Mb=d(7),Ha=d(880);class zb extends Sys.EventArgs{constructor(ma,Ua){super();this.annotation=ma;this.mTa=Ua}}Object(f.a)(zb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var ac=d(1858);class nc extends Sys.EventArgs{constructor(ma){super();this.annotationType=ma}}Object(f.a)(nc,"AnnotationActivationEventArgs",Sys.EventArgs,[]);var Gb=
d(1857);class tc{constructor(){this.newState=this.oldState=0;this.handlers=new N.a}}Object(f.a)(tc,"AnnotationResultStateUpdateData",null,[]);var Qb=d(617),Yb=d(998);class fc{constructor(){this.Wgf=this.d6k=this.Ygf=null}}Object(f.a)(fc,"AnnotationCallbacks",null,[]);class ib{constructor(ma,Ua,xb,Xb,rc,Zc){this.Bbc=null;this.jNc=new pa.a(0);this.JRc=new pa.a;this.uwd=new pa.a;this.fJd=new Qb.a;this.rfg=null;this.tk=ma;this.iRa=Ua;this.FH=xb;this.KD=Xb;this.sJ=rc;this.Fd=Zc}TGp(ma,Ua,xb,Xb){this.KD.dnc(ma)&&
this.tk.le(()=>{if(!this.Bbc){this.Bbc=new pa.a;var rc=Mb.ParagraphReader.Kv(Ha.a.getRootNode(),!0,!0);for(const Zc of rc)Zc&&(rc=Zc.ka(Ta.a.ed,0))&&(this.Bbc.add(rc,Zc.id),this.jNc.W(Zc.id.toString(),rc))}this.iRa.qfg(ma,(Zc,Hd)=>{if(Zc){var Jd=this.KD.lBi(ma);Zc.contentDescriptor.ax===Jd&&((Jd=this.xum(Zc))?Zc.jmb?(Jd=this.Krf(Zc,Jd))&&(Hd?xb(Hd,Zc.contentDescriptor):Ua(Jd,Zc.contentDescriptor)):Xb(Zc.contentDescriptor):this.DPl(Zc,Object.assign(new fc,{Ygf:Ua,d6k:xb,Wgf:Xb})))}})},"PAS:FEPAOT")}xum(ma){if(3===
ma.contentDescriptor.ax){let Ua;return({value:Ua}=this.Bbc.Ec(ma.contentDescriptor.paragraphId)).returnValue?Ua:null}if(4===ma.contentDescriptor.ax)return nb.a.nil;a.ULS.sendTraceTag(592525442,ib.mj,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}mln(ma,Ua){if(3===ma.contentDescriptor.ax)return Ua=this.sJ.value.Eb(Ua).getValue(Ta.a.Vj),ma.contentDescriptor.Vj===Ua;if(4===ma.contentDescriptor.ax&&Ua===nb.a.nil)return!0;a.ULS.sendTraceTag(592525443,ib.mj,15,"IsGraphNodeValidForAnnotation: Unsupported content type");
return!1}DPl(ma,Ua){if(3===ma.contentDescriptor.ax){const xb=ma.contentDescriptor.paragraphId;this.JRc.tb(xb)||this.JRc.add(xb,new N.a);this.JRc.K(xb).add(Xb=>{12===Xb.type&&this.Bbc.add(xb,Xb.id);ma.jmb?(Xb=this.Krf(ma,Xb.id))&&Ua.Ygf(Xb,ma.contentDescriptor):Ua.Wgf(ma.contentDescriptor)})}else if(4===ma.contentDescriptor.ax)if(ma.jmb){const xb=this.Krf(ma,nb.a.nil);xb&&Ua.Ygf(xb,ma.contentDescriptor)}else Ua.Wgf(ma.contentDescriptor);else a.ULS.sendTraceTag(592525444,ib.mj,15,"DelayCallbackForAnnotation: Unsupported content type")}Krf(ma,
Ua){if(this.mln(ma,Ua)){if(Ua=this.KD.sSn(ma.jmb,ma.contentDescriptor,Ua.toString()))return this.uwd.W(Ua.id,ma.Xcb),Ua}else this.Fd.isFeatureEnabled(81)&&this.FH.mSc(ma);return null}x8j(ma,Ua){const xb=this.KD.m5d(ma);xb&&(Ua===wb.a.getTypeName()?this.cqp(ma,xb):this.Npp(ma,xb))}cqp(ma,Ua){this.KD.dnc(ma.annotationType)&&(this.FH.CZa(this.sJ.value,Ua,ma.annotationType),this.uwd.remove(ma.id))}Npp(ma,Ua){if(this.KD.dnc(ma.annotationType)){Ua=Object.assign(new Yb.a,{jmb:this.KD.h6k(ma),contentDescriptor:Ua,
annotationType:ma.annotationType});Ua=this.FH.addAnnotation(this.sJ.value,Ua);this.uwd.W(ma.id,Ua);const xb=this.KD.WJi(ma.annotationType);xb&&this.fJd.contains(xb)&&(this.tk.le(()=>{var Xb=Mb.ParagraphReader.Kv(Ha.a.getRootNode(),!0,!0);if(Xb&&0<Xb.count){const rc=new N.a;for(const Zc of Xb)(Xb=ib.E7d(Zc))&&rc.add(Xb);0<rc.count&&this.FH.INh(this.sJ.value,xb,rc.toArray())}},"PAS:TAOCPA"),this.fJd.remove(xb))}}$vb(ma){if(this.Bbc)if(ma){var Ua=ma.ka(Ta.a.ed,0);if(Ua&&(this.jNc.W(ma.id.toString(),
Ua),({value:Ua}=this.JRc.Ec(Ua)).returnValue))for(const xb of Ua)xb(ma)}else a.ULS.sendTraceTag(592525445,ib.mj,10,"OnParagraphNodeConnected: Invalid node")}lmj(ma,Ua){if(ma){var xb=ma.id.toString();ma=ma.ka(Ta.a.ed,0);var Xb=0;({value:Xb}=this.jNc.Ec(xb)).returnValue&&(3===Ua?(this.JRc.remove(Xb),this.jNc.remove(xb)):2===Ua?this.jNc.W(xb,ma):a.ULS.sendTraceTag(592525447,ib.mj,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,ib.mj,
10,"UpdatePersistedAnnotations: Invalid node")}nIm(ma){let Ua;return({value:Ua}=this.uwd.Ec(ma)).returnValue?Ua:nb.a.nil}bCp(ma,Ua,xb){ma?Ua?this.iRa.PDi(ma,Xb=>{if(Xb){const Hd=ib.E7d(Ua,xb);if(Hd){var rc=Array(Xb.length),Zc=!1;for(let Jd=0;Jd<Xb.length;Jd++)if(Zc||Hd!==Xb[Jd])rc[Jd]=Xb[Jd];else{const Xd=ib.E7d(Ua);if(!Xd)return;Zc=!0;rc[Jd]=Xd;Xb[Jd]=Xd}Zc&&this.FH.INh(this.sJ.value,ma,rc)}}}):a.ULS.sendTraceTag(588863697,ib.mj,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,
ib.mj,10,"UpdateWorkflowParagraphVersion: null workflowType")}jYo(ma){ma?this.fJd.add(ma):a.ULS.sendTraceTag(588863698,ib.mj,10,"SetPendingWorkflow: null workflowType")}rsl(ma){ma?this.fJd.remove(ma):a.ULS.sendTraceTag(588105731,ib.mj,10,"ClearPendingWorkflow: null workflowType")}static E7d(ma,Ua=0){if(!ma)return null;Ua||(Ua=ma.ka(Ta.a.Vj,0));ma=Mb.ParagraphReader.rU(ma);if(Ua&&ma)return String.format("{0}{1}{2}",ma,ib.x$n,Ua);a.ULS.sendTraceTag(588091606,ib.mj,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",
Ua?"valid":"0",ma?"valid":"0");return null}}ib.mj=389;ib.x$n="-";Object(f.a)(ib,"PersistedAnnotationStorage",null,[313]);class Jc{constructor(){this.config=this.token=null}}Object(f.a)(Jc,"UpdateAnnotationConfigParameters",null,[]);var jd=d(129),Wc=d(805),Ad=d(319),Yd=d(1298),ke=d(1346),bf=d(240),od=d(773),Vf=d(2118),ah=d(1856),Bf=d(876),Of=d(795),Qf=d(550),Jg=d(36);class jf{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf=null,Mg,bi=null,zh=null){this.zkb=Mg;this.sa=new Na.a;this.VEa=new Fa.a;this.n9=
new Fa.a;this.LD=new Fa.a;this.ccc=new Fa.a;this.YJe=new Fa.a;this.dGc=new Cb.a(Kb.a.vh());this.e2e=new N.a;this.$3b=new Fa.a;this.UJe=new Fa.a;this.vwd=new Fa.a;this.a4b=new Fa.a;this.tDc=new Fa.a;this.wwd=new Fa.a;this.Hyd=new Fa.a;this.pHd=[];this.qHd=[];this.jLc=null;this.SFk=new Cb.a(Kb.a.vh());this.WJe=new Map;this.aGc=new Map;this.DEc=null;this.poa=new Fa.a;this.cYc=null;this.Zyh=this.anh=0;this.Pda=this.r4a=null;this.AMl=()=>{if(this.pHd.length||this.qHd.length)try{0<this.pHd.length&&this.wKn(),
0<this.qHd.length&&this.ytp()}finally{this.Esl()}else this.Jb.wf(this.jLc),this.jLc=null};this.Bsl=()=>{const Ah=new N.a;for(const Zi of this.LD.values)if(Ah.add(Zi),Ah.count===jf.aGk)break;for(const Zi of Ah)this.qUa(Zi),this.j_b(Zi,wb.a.getTypeName());this.LD.count||(this.Jb.wf(this.DEc),this.DEc=null)};this.Ved=(Ah,Zi)=>{for(const sk of Zi.yk)Ah=sk.intent,!Ah.type&&this.$2o(Ah.intent,sk.cpBegin,sk.cpEnd,sk.HUb)&&this.qUa(Ah.intent)};this.xAk=ma.$("AugLoopAnnotationsAttachingIsEnabled");this.yMk=
ma.hD("SendReleaseMessageAnnotationList")||[];this.Fd=je;this.xPa=Wf;this.iRa=Zc;this.FH=Hd;this.Wn=xb;this.KD=Jd;this.Lda=Xd;this.sJ=Xb;this.tk=Ua;this.Jb=rc;K.a.instance.resolve("Box4.ICharacterPropertiesEditor").qff(this.Ved);this.Yo=af;this.vnk=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.mAk=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.gCk=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",
!1);this.lph=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.zkb&&this.UWm();this.rA=bf.a.instance;this.Pda=bi;null!==this.Pda&&this.Pda.iHm();this.Ee=zh}get hBj(){return this.a4b}set hBj(ma){this.a4b=ma}ub(ma,Ua){a.ULS.sendTraceTag(41521862,jf.mj,50,"New registration for annotation type: {0}.",Ua);this.addHandler(ma,Ua);this.Vcf(Ua).catch(xb=>{a.ULS.sendTraceTag(594396739,jf.mj,10,"Failed to activate annotation type {0}: {1}",Ua,xb.toString())})}addHandler(ma,
Ua){if(ma&&Ua&&""!==Ua){var xb=null;({value:xb}=this.a4b.Ec(Ua,xb)).returnValue?xb.add(ma):(xb=new N.a,xb.add(ma),this.a4b.add(Ua,xb))}else a.ULS.sendTraceTag(41521861,jf.mj,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ma,!Ua,""===Ua)}xc(ma,Ua){a.ULS.sendTraceTag(41521863,jf.mj,50,"Unregister handler for annotation type: {0}.",Ua);let xb=null;({value:xb}=this.a4b.Ec(Ua,xb)).returnValue&&(xb.remove(ma),xb.count||(a.ULS.sendTraceTag(41521864,
jf.mj,50,"Unregister all handlers for annotation type: {0}.",Ua),this.a4b.remove(Ua),this.YVn(Ua)))}NPj(ma){this.cYc||(this.cYc=this.Yo.Lc(2),this.cYc.Ab(ma))}Esl(){var ma;null===(ma=this.cYc)||void 0===ma?void 0:ma.dispose();this.cYc=null}g9h(){this.jLc||(this.jLc=new Db.a(4,2,100,this.AMl,141),this.Jb.$b(this.jLc))}wKn(){let ma;ma=Array.dequeue(this.pHd);const Ua=Ha.a.uQb(this.sJ.value,ma);if(Ua)if(Ua.Fk){this.NPj(Ua);var xb=null;if(({value:xb}=this.tDc.Ec(ma,xb)).returnValue){this.tDc.remove(ma);
for(const Xb of xb)this.xKn(Ua,Xb)}else a.ULS.sendTraceTag(50663568,jf.mj,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.SFk.add(ma);else a.ULS.sendTraceTag(50436127,jf.mj,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}xKn(ma,Ua){try{const xb=Ua.content.range,Xb=new ab.a(0,xb.start,xb.start+xb.length,nb.a.create(),Ua,rc=>{this.YJe.W(Ua.id,rc.toString())});this.Wn.XXa(ma,Xb);ah.a.Azb(Ua,2);this.sa.xfa&&this.sa.raiseEvent(jf.asc,new Gb.a(Ua,tb.a.getTypeName()))}catch(xb){ah.a.$bd(xb,
[Ua],!0)}}fcj(ma){const Ua=Ha.a.B9a(ma.parentPath);let xb=null;({value:xb}=this.tDc.Ec(Ua,xb)).returnValue||(xb=new N.a,this.tDc.add(Ua,xb),this.pHd.push(Ua));xb.add(ma);this.g9h()}zKn(ma,Ua){this.tk.le(()=>{let xb;if(({value:xb}=this.n9.Ec(ma,xb)).returnValue){var Xb=this.YSj(ma);for(const rc of xb){let Zc;({value:Zc}=this.LD.Ec(rc,Zc)).returnValue&&Ua(Zc)&&jf.BSb(Zc)&&(this.fcj(Zc),Xb&&this.sa.raiseEvent(jf.asc,new Gb.a(Zc,wb.a.getTypeName())))}}},"AS:MIFAT")}ztp(ma,Ua){this.tk.le(()=>{let xb;if(({value:xb}=
this.n9.Ec(ma,xb)).returnValue)for(const Xb of xb){let rc;({value:rc}=this.LD.Ec(Xb,rc)).returnValue&&Ua(rc)&&jf.BSb(rc)&&(this.xJg(rc),ah.a.Azb(rc,4))}},"AS:UIFAT")}eWn(ma){var Ua=Ha.a.eH(ma);let xb=null;if(({value:xb}=this.VEa.Ec(Ua,xb)).returnValue){Ua=0;for(var Xb=new N.a;xb.count>Ua;){var rc=xb.K(Ua),Zc=null;({value:Zc}=this.LD.Ec(rc,Zc)).returnValue&&jf.BSb(Zc)?this.KD.Pod(ma,Zc)?this.qUa(Zc,!this.Fd.isFeatureEnabled(81)):(rc=Zc.content.range,Zc=new ab.a(0,rc.start,rc.start+rc.length,nb.a.create(),
Zc),Xb.add(Zc),Ua++):Ua++}0<Xb.count&&this.Wn.c7f(ma,Xb)}}ytp(){let ma=null;try{let Ua="";Ua=Array.dequeue(this.qHd);const xb=Ha.a.uQb(this.sJ.value,Ua);xb&&12===xb.type?(this.NPj(xb),({value:ma}=this.wwd.Ec(Ua,ma)).returnValue?(this.Wn.Bsd(Xb=>ma.contains(Xb.intent),xb,0)&&ma.toArray().forEach(Xb=>{ah.a.Azb(Xb,4)}),this.wwd.remove(Ua)):a.ULS.sendTraceTag(50663570,jf.mj,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")):a.ULS.sendTraceTag(50436128,jf.mj,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}catch(Ua){ah.a.$bd(Ua,
ma.toArray(),!0)}}xJg(ma){let Ua;({value:Ua}=this.YJe.Ec(ma.id,Ua)).returnValue||(Ua=Ha.a.B9a(ma.parentPath));this.YJe.remove(ma.id);var xb=null;({value:xb}=this.wwd.Ec(Ua,xb)).returnValue||(xb=new N.a,this.wwd.add(Ua,xb),this.qHd.push(Ua));xb.add(ma);this.g9h();xb=null;({value:xb}=this.tDc.Ec(Ua,xb)).returnValue&&xb.remove(ma)}wce(ma){var Ua;return Of.a.Tsi&&(null===ma||void 0===ma?0:ma.content)&&Bf.a.typeGuard(ma.content)&&(null===(Ua=ma.content)||void 0===Ua?0:Ua.id)?!0:!1}mYk(ma){const Ua=ma.id;
var xb=ma.annotationType;const Xb=ma.parentPath;if(this.KD.Atb(ma)){var rc=Ha.a.m9a(this.sJ.value,Xb);if(rc&&(rc=rc.ka(Ta.a.Vj,0).toString(),ma.parentRevId&&rc!==ma.parentRevId))return!1}rc=null;({value:rc}=this.n9.Ec(xb,rc)).returnValue||(rc=new N.a,this.n9.add(xb,rc));rc.add(Ua);xb=null;({value:xb}=this.VEa.Ec(Xb,xb)).returnValue||(xb=new N.a,this.VEa.add(Xb,xb));xb.add(Ua);this.LD.add(Ua,ma);this.wce(ma)&&this.ccc.add(ma.content.id,Ua);this.SGp(ma);return!0}get ioc(){return Qf.a.xua&&null!==this.Pda&&
this.Pda.QLf()}Obo(ma){var Ua=ma.parentPath;if(this.ioc&&Object(Qf.e)(ma)&&(Ua=Ha.a.m9a(this.sJ.value,Ua))&&!1===Object(Qf.f)(Ua)){const rc=Ua.ra?Ua.ra.length:0;ma=Object(Qf.b)(ma.content,Ua);var xb=null===Ua||void 0===Ua?void 0:Ua.Hc;if(ma&&xb)for(xb=0;xb<rc;xb++){var Xb=Ua.ra.Ub(xb);const Zc=Xb.formatting;Zc&&!1===Object(Qf.c)(Zc)&&!1===Xb.ni&&ma!==Object(Qf.d)(Zc)&&null!==this.Ee&&(Xb=new Jg.GraphTransaction(4),Xb.set(mb.a.jf.Tl),this.Ee.Cl(Zc,cb.a.RF,ma),Xb.dispose())}}}SGp(ma){const Ua=this.KD.Gsi(ma);
if(0===Ua.length)this.ngi(ma);else{let xb=!1;this.iRa.L1n(Ua,ma.annotationType,(Xb,rc)=>{this.LD.tb(ma.id)?(rc=this.KD.Utb(ma,Ha.a.eim(ma)),!Xb&&rc?(y.AFrameworkApplication.$c("3c7ef686;a13cd815"),this.Vln&&(xb=!1),this.JKg(ma,10,!1)):Xb&&this.JKg(ma,Xb),xb||(this.ngi(ma),xb=!0)):rc.w_a=!0})}}get Vln(){if(null!=this.QZg)var ma=this.QZg;else{var Ua;ma=this.QZg=null===(Ua=y.AFrameworkApplication.J)||void 0===Ua?void 0:Ua.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreAllFix",!1)}return ma}ngi(ma){const Ua=
jf.BSb(ma);Ua&&this.fcj(ma);!Ua&&this.sa.xfa&&this.sa.raiseEvent(jf.asc,new Gb.a(ma,tb.a.getTypeName()))}V5j(ma,Ua,xb,Xb){let rc=!0;this.tk.le(()=>{if(Xb.startsWith(Ha.a.RNb)){var Zc=ma.id,Hd=null;if(Ua===wb.a.getTypeName())this.qUa(ma);else if(({value:Hd}=this.LD.Ec(Zc,Hd)).returnValue)a.ULS.sendTraceTag(41418891,jf.mj,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Zc,ma.annotationType),this.LD.W(Zc,ma);else if(this.Obo(ma),!this.mYk(ma)){rc=!1;return}xb&&Ua===tb.a.getTypeName()&&
Xb!==Ha.a.RNb&&this.e2e.add(ma.annotationType)}this.j_b(ma,Ua)},"AS:UAS");return rc}vTo(ma){if(ma)for(const Ua of ma)this.j_b(Ua,gc.a.getTypeName()),ma=Ua.content,this.Hyd.tb(ma.categoryName)?this.Hyd.W(ma.categoryName,Ua):this.Hyd.add(ma.categoryName,Ua);else a.ULS.sendTraceTag(592802119,jf.mj,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}jPh(ma){this.sa.addHandler(jf.asc,ma)}iPh(ma){this.sa.addHandler(jf.Sij,ma)}cnc(ma){return this.$3b.tb(ma)}Q0k(ma){this.sa.addHandler(jf.qle,
ma)}UBo(ma){this.sa.removeHandler(jf.qle,ma)}YSj(ma){return!Ha.a.Qf(ma)&&La.a(ma)&&this.sa.xfa}qUa(ma,Ua=!0){if(this.LD.tb(ma.id)){var xb=this.LD.K(ma.id);this.wce(ma)&&this.ccc.remove(ma.content.id);this.LD.remove(ma.id);var Xb=null;({value:Xb}=this.VEa.Ec(ma.parentPath,Xb)).returnValue?(Xb.remove(ma.id),jf.BSb(xb)&&this.xJg(xb)):a.ULS.sendTraceTag(50734169,jf.mj,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Xb=null;({value:Xb}=this.n9.Ec(ma.annotationType,Xb)).returnValue?
Xb.remove(ma.id):a.ULS.sendTraceTag(50734170,jf.mj,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.YSj(ma.annotationType)?this.sa.raiseEvent(jf.asc,new Gb.a(xb,wb.a.getTypeName())):this.j_b(ma,wb.a.getTypeName());Ua&&this.Lda.x8j(xb,wb.a.getTypeName())}}WFf(ma,Ua,xb=!1){const Xb=new N.a;var rc;if(!({value:rc}=this.n9.Ec(ma,rc)).returnValue)return Xb;for(const Zc of rc)this.LD.tb(Zc)?(ma=this.LD.K(Zc),(rc=this.KD.m5d(ma))&&(Ua.equals(rc)||xb&&Ua.overlaps(rc))&&
Xb.add(ma)):a.ULS.sendTraceTag(577843217,jf.mj,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Zc);return Xb}FZd(ma){let Ua=null;if(({value:Ua}=this.n9.Ec(ma,Ua)).returnValue){ma=Ua.toArray();for(const xb of ma){let Xb;({value:Xb}=this.LD.Ec(xb,Xb)).returnValue&&this.qUa(Xb)}}}Shn(ma){return vc.a.getTypeNameFor(ma)===Ad.a.getTypeName()}pWi(ma){var Ua,xb;return(null===(xb=null===(Ua=this.zkb)||void 0===Ua?void 0:Ua.hBi)||void 0===xb?void 0:xb.call(Ua))===Wc.a.lCc&&
ma&&0===ma.priority?this.zkb.brd(ma.context.substr(ma.startInContext,ma.range.length)):!1}Yvj(ma,Ua){this.tk.le(()=>{a.ULS.k4(jf.mj,100)&&a.ULS.sendTraceTag(41418894,jf.mj,100,"Operation of type {0} with path {1} received",vc.a.getTypeNameFor(ma),ma.parentPath.join("\\"));try{const xb=new ac.a(ma);for(const Xb of xb.annotations)if(Xb.annotationType===ke.b.getTypeName()){const rc=Xb.content.results.map(Zc=>{var Hd;const Jd=null===(Hd=Zc.M_)||void 0===Hd?void 0:Hd.seq;Hd=void 0===Jd?Xb.id:Xb.id+"_"+
Jd;return{id:Hd,body:{...Zc,id:Hd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.Yvj({items:rc,parentPath:ma.parentPath,parentRevId:ma.parentRevId,H_:ma.H_},Ua)}else xb.TRd===tb.a.getTypeName()&&this.S5o(Xb)?(y.AFrameworkApplication.$c("g8469255;j5hhe441"),this.lph&&(this.r4a||(this.r4a=od.a.Nz()),this.anh++,this.r4a.uQd("AnnotationSkippedDueToInvalidContextCount",this.anh.toString()))):this.n5c(Xb,Ua,xb.TRd,!0)}catch(xb){a.ULS.sendTraceTag(41418898,jf.mj,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",
xb.message,xb.stack)}},"AS:PO")}S5o(ma){var Ua;y.AFrameworkApplication.$c("01dfc961;05c12706");if(this.gCk&&La.a(ma.annotationType)){var xb;let rc=xb=null;if(this.rA){xb=this.rA.cfa;var Xb=null===xb||void 0===xb?void 0:xb.node;xb=Ha.a.B9a(ma.parentPath);if(Ha.a.uQb(this.sJ.value,xb)!==Xb)return!1;ma=ma.content;xb=ma.context.substring(ma.startInContext,ma.startInContext+ma.range.length);rc=null===(Ua=null===Xb||void 0===Xb?void 0:Xb.characterData)||void 0===Ua?void 0:Ua.substring(ma.range.start,ma.range.start+
ma.range.length);this.lph&&ma&&0===ma.priority&&(Ua=0<ma.range.start?Xb.characterData.charAt(ma.range.start-1):null,Xb=ma.range.start+ma.range.length<Xb.characterData.length?Xb.characterData.charAt(ma.range.start+ma.range.length):null,"en-us"==ma.language.toLocaleLowerCase()&&rc&&xb&&rc===xb&&(Ua&&Ua.match("[A-Za-z0-9]")||Xb&&Xb.match("[A-Za-z0-9]"))&&(this.r4a||(this.r4a=od.a.Nz()),this.Zyh++,this.r4a.uQd("partialWordAnnotationsCount",this.Zyh.toString())))}return rc&&xb&&rc!==xb?!0:!1}return!1}n5c(ma,
Ua,xb,Xb){if(this.Shn(ma.content)&&this.pWi(ma.content))this.Sca(ma,70);else{var rc=ma.parentPath;xb!==wb.a.getTypeName()&&Xb||this.TBj(ma);Xb&&xb===tb.a.getTypeName()&&La.a(ma.annotationType)&&ma.content.isHotCritique&&this.mAk?this.aGc.set(ma.id,{annotation:ma,time:Date.now()}):(Xb=ma.annotationType,Ha.a.Qf(Xb)||Xb!==Pc.a.getTypeName()?!Ha.a.Qf(Xb)&&La.a(Xb)&&ma.content&&0==ma.content.priority&&jd.a.D7?(ma=Ha.a.B9a(rc))&&ma==jd.a.ugm()&&a.ULS.sendTraceTag(539870169,jf.mj,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):
xb!==wb.a.getTypeName()&&this.dGc.contains(rc)?a.ULS.sendTraceTag(41418897,jf.mj,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",rc,ma.id):this.T5j(ma,rc,xb,Ua):a.ULS.sendTraceTag(595342670,jf.mj,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",rc))}}Tyo(ma){if(ma&&ma.annotationType&&this.KD.dnc(ma.annotationType)){var Ua;if(({value:Ua}=this.n9.Ec(ma.annotationType,Ua)).returnValue&&(ma=this.KD.m5d(ma)))for(const xb of Ua){let Xb;
({value:Xb}=this.LD.Ec(xb,Xb)).returnValue&&(Ua=this.KD.m5d(Xb))&&(ma.equals(Ua)||ma.overlaps(Ua))&&this.qUa(Xb)}}}j_b(ma,Ua){this.tk.le(()=>{let xb=null;if(({value:xb}=this.hBj.Ec(ma.annotationType,xb)).returnValue)for(const Xb of xb)Xb.gH(ma,Ua)},"AS:SATH")}Asl(){a.ULS.sendTraceTag(50860999,jf.mj,50,"ClearStorage: Initiated Clearing Storage");this.DEc||(this.DEc=new Db.a(4,2,100,this.Bsl,142),this.Jb.$b(this.DEc))}activateAnnotation(ma,Ua){let xb;if(({value:xb}=this.vwd.Ec(ma,xb)).returnValue){if(xb.contains(Ua))return Promise.resolve(null);
xb.add(Ua)}else{let Xb;this.vwd.add(ma,(Xb=new N.a,Xb.add(Ua),Xb))}return this.Vcf(ma)}Vcf(ma){a.ULS.sendTraceTag(41521865,jf.mj,50,"ActivateAnnotation: Activating annotation type {0}.",ma);if(this.$3b.tb(ma))return Promise.resolve(null);var Ua=null;if(({value:Ua}=this.UJe.Ec(ma,Ua)).returnValue)return Ua;this.tUk(ma);if(Ua=this.xPa?this.xPa():null){const xb=new ic.a;xb.annotationType=ma;this.vnk&&(this.poa.tb(ma)||this.poa.W(ma,new tc),xb.stateUpdateHandler=(Xb,rc)=>{this.poa.K(ma).oldState=Xb;this.poa.K(ma).newState=
rc;for(const Zc of this.poa.K(ma).handlers)Zc(ma,Xb,rc)});Ua=Ua.activateAnnotation(xb);this.UJe.add(ma,Ua);return Ua.then(Xb=>{this.UJe.remove(ma);this.$3b.add(ma,Xb.token);this.U5j(Xb.token,ma);this.sa.raiseEvent(jf.qle,new nc(ma,!0));this.SWm(ma);return Xb})}return Promise.reject(Error.create("Error during annotation activation"))}SWm(ma){const Ua=this.KD.WJi(ma);Ua&&this.iRa.PDi(Ua,xb=>{if(this.Lda.rfg){var Xb=Mb.ParagraphReader.Kv(Ha.a.getRootNode(),!0,!0);if(Xb&&0<Xb.count){let rc=0;for(const Zc of Xb){Xb=
ib.E7d(Zc);if(!Xb)continue;let Hd=!1;for(;rc<xb.length;){if(Xb===xb[rc]){Hd=!0;break}rc++}if(!Hd){this.Lda.rfg(Ua);break}rc++}}}})}tUk(ma){this.Lda.TGp(ma,(Ua,xb)=>{0<this.WFf(ma,xb,!0).count||this.V5j(Ua,tb.a.getTypeName(),!0,Ua.parentPath)},(Ua,xb)=>{if(3!==xb.ax)a.ULS.sendTraceTag(591541786,jf.mj,15,"Annotation moved to unsupported location type: {0}",xb.ax);else if(Ua.ax!==xb.ax)a.ULS.sendTraceTag(591541787,jf.mj,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",
Ua.ax,xb.ax);else{Ua=this.WFf(ma,Ua);for(const rc of Ua){const Zc=rc.content;Ua=Ha.a.m9a(this.sJ.value,rc.parentPath);if(!Ua){a.ULS.sendTraceTag(591541788,jf.mj,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Wn.Bsd(Hd=>Hd.intent===Zc,Ua,0))break;var Xb=xb.Cya;Xb=new ab.a(0,Xb,Xb+xb.Bya,null,Zc);this.Wn.XXa(Ua,Xb)}}},Ua=>{for(const xb of this.WFf(ma,Ua))this.qUa(xb,!1)})}releaseAnnotation(ma,Ua){let xb;if(({value:xb}=this.vwd.Ec(ma,xb)).returnValue){xb.contains(Ua)&&
xb.remove(Ua);if(0<xb.count)return Promise.resolve(!1);this.vwd.remove(ma)}a.ULS.sendTraceTag(593790408,jf.mj,50,"ReleaseAnnotation: Releasing annotation type {0}.",ma);return this.ILj(ma)}YVn(ma){var Ua=null;if(({value:Ua}=this.n9.Ec(ma,Ua)).returnValue){a.ULS.sendTraceTag(41418899,jf.mj,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",ma);for(const xb of Ua)if(Ua=null,({value:Ua}=this.LD.Ec(xb,Ua)).returnValue){const Xb=Ua.parentPath;let rc=null;({value:rc}=this.VEa.Ec(Xb,
rc)).returnValue&&(rc.remove(xb),rc.count||this.VEa.remove(Xb));this.wce(Ua)&&this.ccc.remove(Ua.content.id);this.LD.remove(xb);jf.BSb(Ua)&&this.xJg(Ua)}this.n9.remove(ma)}Array.contains(this.yMk,ma)&&this.ILj(ma)}ILj(ma){let Ua=null;const xb=this.xPa?this.xPa():null;if(xb){if(({value:Ua}=this.$3b.Ec(ma,Ua)).returnValue){const Xb=new mc;Xb.token=Ua;this.$3b.remove(ma);this.sa.raiseEvent(jf.qle,new nc(ma,!1));return xb.releaseAnnotation(Xb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}D6i(){this.tk.le(()=>
{if(this.xAk){var ma=Ha.a.getRootNode();if(ma){var Ua=new Fa.a;$b.f(ma,xb=>{var Xb=Ha.a.eH(xb),rc=null;if(({value:rc}=this.VEa.Ec(Xb,rc)).returnValue)for(const Zc of rc)Xb=null,({value:Xb}=this.LD.Ec(Zc,Xb)).returnValue&&(Xb.parent=xb,Xb.utb=!0,Xb.oXb=2,Ua.tb(Xb.annotationType)||Ua.W(Xb.annotationType,new N.a),Ua.K(Xb.annotationType).add(Zc),rc=null,({value:rc}=this.n9.Ec(Xb.annotationType,rc)).returnValue&&rc.remove(Xb.id));return!0},12);for(const xb of this.n9.keys)if(ma=null,({value:ma}=this.n9.Ec(xb,
ma)).returnValue)for(const Xb of ma)if(ma=null,({value:ma}=this.LD.Ec(Xb,ma)).returnValue){let rc=null;ma.parentPath===Ha.a.RNb?(ma.oXb=1,ma.parent=null):({value:rc}=this.LD.Ec(ma.parentPath,rc)).returnValue?(ma.oXb=3,ma.parent=rc):(ma.oXb=0,ma.parent=null,a.ULS.sendTraceTag(41554060,jf.mj,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",ma.id));ma.utb=!0;Ua.tb(ma.annotationType)||Ua.W(ma.annotationType,new N.a);Ua.K(ma.annotationType).add(Xb)}else a.ULS.sendTraceTag(41997840,
jf.mj,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Xb);else a.ULS.sendTraceTag(41997841,jf.mj,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",xb);this.n9=Ua;this.e2e.clear()}else a.ULS.sendTraceTag(41554058,jf.mj,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,jf.mj,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}g6k(ma){this.Yvj(ma,!0)}T4n(ma,
Ua){this.tk.le(()=>{const xb=Ua?Ua+String.format("\\{0}",ma.id):Ha.a.eH(ma);a.ULS.sendTraceTag(41418900,jf.mj,50,"OnTileDeleted: Tile delete event received for tile {0}.",xb);this.dGc.contains(xb)||this.dGc.add(xb);var Xb=null;if(({value:Xb}=this.VEa.Ec(xb,Xb)).returnValue){a.ULS.sendTraceTag(41418901,jf.mj,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Xb.count,xb);for(const rc of Xb)Xb=null,({value:Xb}=this.LD.Ec(rc,Xb)).returnValue&&(this.j_b(Xb,wb.a.getTypeName()),this.sa.xfa&&
this.sa.raiseEvent(jf.asc,new Gb.a(Xb,wb.a.getTypeName())),this.wce(Xb)&&this.ccc.remove(Xb.content.id),this.LD.remove(rc));this.VEa.remove(xb)}},"AS:OTD")}S4n(ma){ma=Ha.a.eH(ma);this.dGc.remove(ma)&&a.ULS.sendTraceTag(41418902,jf.mj,50,"OnTileAdded: Deleted tile {0} was re-added.",ma)}hAp(ma){if(ma){a.ULS.sendTraceTag(50436131,jf.mj,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ma.count);var Ua=new Fa.a;for(var xb of ma)ma=null,({value:ma}=Ua.Ec(xb.parentPath,ma)).returnValue||
(ma=new Fa.a,Ua.add(xb.parentPath,ma)),ma.W(xb.id,xb);for(const Xb of Ua){Ua=Ha.a.m9a(this.sJ.value,Xb.key);if(!Ua){a.ULS.sendTraceTag(50436160,jf.mj,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}xb=new ia.a([0]);for(let rc=0,Zc=Ua.ra.length;rc<Zc;rc++)ma=Ua.ra.Ub(rc),ma.yk&&xb.w0a(ma.yk,void 0,(Hd,Jd)=>{if(Jd){var Xd=null,je=Jd.intent;je&&({value:Xd}=Xb.value.Ec(je.id,Xd)).returnValue&&(je=new ld.a,je.start=Jd.Ib.cp,je.length=Hd.Ib.cp-je.start,Xd.content.range=je,Xd.oga=
!1)}})}}else a.ULS.sendTraceTag(50436130,jf.mj,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ma){a.ULS.sendTraceTag(593049729,jf.mj,50,"GetAnnotationsByType: Method called for type {0}.",ma);return this.Vcf(ma).then(()=>{const Ua=new N.a;this.tk.le(()=>{if(Ha.a.Qf(ma)||ma!==Pc.a.getTypeName()){this.e2e.contains(ma)&&this.D6i();var xb=null;if(({value:xb}=this.n9.Ec(ma,xb)).returnValue){a.ULS.sendTraceTag(41418903,jf.mj,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",
ma);var Xb=new N.a;for(const rc of xb)xb=null,({value:xb}=this.LD.Ec(rc,xb)).returnValue&&(xb.oga&&Xb.add(xb),Ua.add(xb));Xb&&0<Xb.count&&jf.BSb(Xb.K(0))&&this.hAp(Xb)}}else for(Xb of this.Hyd.values)Ua.add(Xb);Ua.count||a.ULS.sendTraceTag(41418904,jf.mj,50,"GetAnnotationsByType: No annotations found for type {0}!",ma)},"AS:GABT");return Ua},Ua=>{a.ULS.sendTraceTag(41418905,jf.mj,10,"Exception occurred while fetching annotations of type {0}: {1}",ma,Ua);return null})}getAnnotationById(ma){let Ua=
null;return({value:Ua}=this.LD.Ec(ma,Ua)).returnValue?Ua:null}qsi(ma){let Ua=null;return({value:Ua}=this.ccc.Ec(ma,Ua)).returnValue?(ma=null,({value:ma}=this.LD.Ec(Ua,ma)).returnValue?ma:null):null}w4d(ma){let Ua=null;if(this.VEa.tb(ma))for(const xb of this.VEa.K(ma))if(ma=this.getAnnotationById(xb))Ua||(Ua=new N.a),Ua.add(ma);return Ua}FXa(ma){return(ma=this.getAnnotationById(ma))?(ma.utb||this.D6i(),ma):null}Sca(ma,Ua){this.d_o(ma,Ua);this.JKg(ma,Ua);this.j_b(ma,gc.a.getTypeName())}ovp(ma,Ua){this.czp(ma,
Ua);this.jXo(ma,Ha.a.dim(ma));this.j_b(ma,gc.a.getTypeName())}pvp(ma,Ua){ma=this.KD.Gsi(ma);for(const xb of ma)this.FH.wKg(this.sJ.value,xb,Ua)}d_o(ma,Ua){const xb=this.xPa?this.xPa():null;xb&&(ma=this.fim(ma,Ua))&&xb.setAnnotationState(ma)}JKg(ma,Ua,xb=!0){if(ma&&jf.cVi(ma)){var Xb=this.getAnnotationById(ma.id);!ma.content||Xb&&ma.content===Xb.content||Ha.a.setAnnotationState(ma,Ua);Xb&&Xb.content&&Ha.a.setAnnotationState(Xb,Ua);xb&&this.sa.xfa&&(70===Ua||60===Ua)&&this.sa.raiseEvent(jf.Sij,new zb(ma,
Ua))}}fim(ma,Ua){let xb=null;ma&&(xb=Object.assign(new rb,{id:ma.id,value:Ua}),Ha.a.Qf(ma.parentPath)||(xb.parentPath=ma.parentPath.split("\\")));return xb}jXo(ma,Ua){const xb=this.xPa?this.xPa():null;xb&&(ma=this.cim(ma,Ua))&&xb.setAnnotationMetadata(ma)}czp(ma,Ua){if(ma&&jf.cVi(ma)){var xb=this.getAnnotationById(ma.id);!ma.content||xb&&ma.content==xb.content||Ha.a.rMj(ma,Ua);xb&&xb.content&&Ha.a.rMj(xb,Ua)}}cim(ma,Ua){if(!ma)return null;const xb=new Rc;xb.id=ma.id;xb.value=Ua;Ha.a.Qf(ma.parentPath)||
(xb.parentPath=ma.parentPath.split("\\"));return xb}$2o(ma,Ua,xb,Xb){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)&&(ma.annotationType===Vf.b.getTypeName()||ma.annotationType===Vf.d.getTypeName()))return!1;const rc=ma.content;if(this.KD.Atb(ma)&&rc){const Zc=rc.range.start+rc.range.length;if(0<Xb&&Zc<=xb||0>Xb&&Zc<=xb+Xb)return!1;if(0<Xb&&rc.range.start>=Ua||0>Xb&&rc.range.start>=xb)return rc.range.start+=Xb,!1}return!this.Fd.isFeatureEnabled(53)&&
rc&&rc.M_?(ma=this.KD.Utb(ma,60),!(60===rc.M_.state&&ma)):!0}qMh(ma,Ua){this.poa.tb(Ua)||this.poa.W(Ua,new tc);this.poa.K(Ua).handlers.add(ma);ma(Ua,this.poa.K(Ua).oldState,this.poa.K(Ua).newState)}CBj(ma,Ua){this.poa.tb(Ua)&&this.poa.K(Ua).handlers.contains(ma)&&this.poa.K(Ua).handlers.remove(ma)}static cVi(ma){ma=vc.a.getBaseTypesFor(ma.content);return Array.contains(ma,pb.a.getTypeName())}static BSb(ma){if(void 0===ma.content||null===ma.content||""===Ha.a.B9a(ma.parentPath))return!1;const Ua=vc.a.getBaseTypesFor(ma.content);
return Array.contains(Ua,Dc.a.getTypeName())&&ma.annotationType!==sb.RoleDetectionAnnotation.getTypeName()}nvp(ma){ma?(this.WJe.AugLoop_Text_Critique=ma,ma=this.cnc("AugLoop_Text_Critique")?this.$3b.K("AugLoop_Text_Critique"):null,this.U5j(ma,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,jf.mj,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}U5j(ma,Ua){if(ma&&this.WJe[Ua]){const xb=new Jc;xb.token=ma;xb.config=this.WJe[Ua];this.xPa&&(this.xPa().updateAnnotationConfig(xb),
a.ULS.sendTraceTag(540615553,jf.mj,50,"Annotation configuration has been updated for annotation type: {0}.",Ua))}}TBj(ma){let Ua=null;({value:Ua}=this.LD.Ec(ma.id,Ua)).returnValue&&(ma.annotationType=Ua.annotationType);this.aGc.has(ma.id)&&this.aGc.delete(ma.id)}T5j(ma,Ua,xb,Xb){this.Tyo(ma);this.V5j(ma,xb,Xb,Ua)&&this.Lda.x8j(ma,xb)}CZa(ma){const Ua=ma.parentPath,xb=wb.a.getTypeName();this.TBj(ma);this.Sca(ma,70);this.dGc.contains(Ua)||this.T5j(ma,Ua,xb,!0)}ozm(ma){const Ua=new N.a;ma=this.n9.Ec(ma).value;
if(null===ma)return Ua;for(const xb of ma)ma=this.LD.Ec(xb).value,null!==ma&&Ua.push(ma);return Ua}async UWm(){await Object(Yd.b)();this.NBj()}NBj(){const ma=this.ozm(Ad.a.getTypeName());for(const Ua of ma)this.pWi(Ua.content)&&this.CZa(Ua)}}jf.mj=389;jf.asc="OnAnnotationOperation";jf.Sij="OnAnnotationLocalStateChange";jf.qle="OnAnnotationActivationChange";jf.aGk=20;Object(f.a)(jf,"AnnotationStorage",null,[315]);class $i{constructor(){this.Pve=null;this.Zod=!1}}Object(f.a)($i,"AugmentationLoopStateManager",
null,[314]);var Vd=d(179),eh=d(590),rd=d(110),Gc=d(608),Wd=d(458),Ye=d(258);class yg extends Ye.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}Om(){return Wd.a.kOo}static construct(ma,Ua,xb,Xb,rc,Zc){const Hd=new yg;Hd.ExpectedEndRevisionId=ma;Hd.OriginString=Ua;Hd.Authorization=
xb;Hd.AugLoopSeedUrl=Xb;Hd.FileId=rc;Hd.SeedBatchesInParallelIsEnabled=Zc;Hd.AddDocumentKindTypeToPathIsEnabled=!0;Hd.CheckOnDemandNodeVersionEnabled=!0;Hd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Hd}}Object(f.a)(yg,"FullFileAugLoopSeedingRequest",Ye.a,[]);class yf{constructor(){this.authToken=this.url=this.Npj=null}}Object(f.a)(yf,"ReseedingTaskInfo",null,[]);var re=d(20);class Xe{constructor(ma,Ua,xb,Xb,rc,Zc){this.bF=null;this.Tih=!1;this.V5b=null;this.G5e=0;this.Whd=(Hd,Jd)=>{Hd=Jd.sea;
this.V5b&&rd.AT(Hd,Xd=>Xd===this.V5b)&&(Jd.httpStatusCode!==Vd.a.qz||Jd.$j||2!==Jd.Cpe?Jd.httpStatusCode!==Vd.a.qz||Jd.$j||1!==Jd.Cpe?this.nHj(()=>{a.ULS.sendTraceTag(50861003,Xe.mj,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",Jd.httpStatusCode,Jd.$j,Jd.Cpe,Jd.Lm)}):(this.FQ.Zod=!1,this.bF.Ikd(this.Whd),this.Re.Asl(),a.ULS.sendTraceTag(50861002,Xe.mj,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),
Hd=Object(V.a)(yf,this.V5b),this.xxj(Jd.zHj,Hd.Npj,Hd.url,Hd.authToken)):this.nHj(()=>{a.ULS.sendTraceTag(50861001,Xe.mj,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.z7l=Hd=>{if(void 0===Hd||null===Hd||void 0===Hd.data||null===Hd.data||void 0===Hd.data.Pe||null===Hd.data.Pe)a.ULS.sendTraceTag(41445393,Xe.mj,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Hd.data.He!==Vd.a.qz)a.ULS.sendTraceTag(41445394,
Xe.mj,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Hd.data.He);else try{let Jd;({group:Jd}=eh.a.D4(Hd.data.Pe)).returnValue?Jd.Responses&&Jd.Responses.length?(Hd=null,Jd&&Jd.Responses&&Jd.Responses.length&&(Hd=Jd.Responses[0])?(this.HH.r0a(Hd),Hd.StatusCode?a.ULS.sendTraceTag(41445398,Xe.mj,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Hd.StatusCode):a.ULS.sendTraceTag(41445399,Xe.mj,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",
Hd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,Xe.mj,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,Xe.mj,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,Xe.mj,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(Jd){a.ULS.sendTraceTag(41445400,
Xe.mj,10,"FileSeedingSuccessCallback: {0}",Jd.message)}};this.y7l=Hd=>{void 0===Hd||null===Hd||void 0===Hd.data||null===Hd.data||void 0===Hd.data.Pe||null===Hd.data.Pe?a.ULS.sendTraceTag(41445401,Xe.mj,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,Xe.mj,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Hd.data.He)};this.uok=ma.$("AugLoopServerSideSeedingIsEnabled");this.sok=ma.$("AugLoopReseedingIsEnabled");
this.tok=ma.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.suh=ma.jc("MaxReseedingRetries",1);this.If=Ua;this.JCd=xb;this.FQ=Xb;this.HH=rc;this.Re=Zc;re.StaticActiveAppFrame.za()&&re.StaticActiveAppFrame.za().kb&&re.StaticActiveAppFrame.za().kb.hd&&re.StaticActiveAppFrame.za().kb.hd.Ag&&(this.bF=re.StaticActiveAppFrame.za().kb.hd.Ag)}W9m(ma,Ua,xb){if(this.uok){var Xb=this.FQ.Pve;Xb&&Xb.trim().length?this.Tih?this.sok&&(a.ULS.sendTraceTag(50861E3,Xe.mj,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),
this.G5e=0,this.bF?(this.FQ.Zod=!0,this.bF.tcc(this.Whd),this.V5b=Object.assign(new yf,{Npj:ma,url:Ua,authToken:xb}),this.bF.bD(null,null,this.V5b)):a.ULS.sendTraceTag(592814793,Xe.mj,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,Xe.mj,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.xxj(Xb,ma,Ua,xb),this.Tih=!0):a.ULS.sendTraceTag(41445391,Xe.mj,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
Xe.mj,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}nHj(ma){this.G5e<this.suh?(a.ULS.sendTraceTag(594384E3,Xe.mj,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.G5e,this.suh),this.bF.bD(null,null,this.V5b)):(this.FQ.Zod=!1,this.bF.Ikd(this.Whd),ma())}xxj(ma,Ua,xb,Xb){const rc=yg.construct(ma,Ua,Xb,xb,y.AFrameworkApplication.rootQuerySignature,this.tok);
a.ULS.sendTraceTag(595178454,Xe.mj,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.JCd.h$a.execute(()=>{this.HZk(rc)})}HZk(ma){a.ULS.sendTraceTag(595178453,Xe.mj,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.If.Xj(mb.a.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Gc.b(ma),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.z7l,this.y7l,ma);a.ULS.sendTraceTag(42016906,
Xe.mj,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}Xe.mj=389;Object(f.a)(Xe,"FullFileAugLoopSeedingService",null,[]);class dc{constructor(){}}Object(f.a)(dc,"RuntimeManagerInitializationTracker",null,[]);class Ac{getAugLoopRuntimeManager(){return od.a.Nz()}}Object(f.a)(Ac,"AlFactoryWrapper",null,[310]);class dd{im(){return Ha.a.im()}}Object(f.a)(dd,"UtilsWrapper",null,[309]);var fd=d(633),Fd=d(54),cf=d(39),Bg=d(157),me=d(2117),mf=d(6),ug=d(108),Bi=d(26),Zf=d(363),zf=d(411),
xh=d(100),Vj=d(42);class Ui{constructor(ma,Ua,xb,Xb,rc,Zc=null){this.Pda=null;this.Aa=ma;this.lg=xb;this.Sp=Xb;this.xe=rc;this.Ysa=this.Aa.$("WordDesignerCaptionDetectionEnabled");this.Pda=Zc}jVo(ma,Ua){ma.listType=this.hzm(Ua);ma.outlineLevel=Mb.ParagraphReader.zAa(Ua);ma.indentation=Ui.DJf(this.Sp.fX(Ua));ma.alignment=Ui.JFf(Mb.ParagraphReader.Xy(Ua));ma.isInsideTable=this.isInsideTable(Ua);ma.isInsideTOC=Ua.Fq;ma.rightIndentation=Ui.DJf(this.Sp.v9a(Ua));var xb=this.Sp.Okc(Ua);ma.specialIndentType=
Ui.FLm(xb);ma.specialIndentBy=Ui.DJf(xb);ma.listType!==me.e.NoList&&this.QWo(Ua,ma);this.YZo(Ua,ma);xb=[];this.Ysa&&(xb=this.Iho(Ua));ma.formattedRanges=this.eum(Ua,xb);this.Ysa&&null!=xb&&(ma.objectReferences=0<xb.length?xb:void 0)}eum(ma,Ua){var xb=ma.ra?ma.ra.length:0,Xb=ug.FormattingReader.Vs(Bi.a.create(ma));let rc=xh.a.KJ,Zc=0,Hd=!1,Jd=xh.a.VO/2;Xb&&(Jd=ug.FormattingReader.Ug(Xb,cb.a.fontSize,xh.a.VO)/2,rc=ug.FormattingReader.Ug(Xb,cb.a.font,xh.a.KJ),Zc=ug.FormattingReader.language(Xb),this.ioc&&
(Hd=Object(Qf.c)(Xb)));Xb="Normal";var Xd=this.xe.Cq(ma);Xd&&(Xb=Xd.getValue(cf.a.la)||"Normal",Xd.hasProperty(cb.a.font)&&(rc=Xd.getValue(cb.a.font)));if(xb){--xb;Xd=[];let Ah=null,Zi=void 0,sk=null;this.Ysa&&ma.hasProperty(cb.a.Sn)&&(sk=ma.getValue(cb.a.Sn));const gm=ma.properties.ka(Ta.a.Hka,null);for(let Gj=0;Gj<xb;Gj++){var je=ma.ra.Ub(Gj),af=ma.Hc,Wf=null;this.Ysa&&(Wf=Ui.RNf(ma,sk,Gj));je.Ue&&(Ah=Ui.Kwp(af,je.Ue,Ah));je.hyperlink&&je.hyperlink.url?Zi=je.hyperlink.url:je.wn&&(Zi=void 0);var Mg=
ma.ra.Ub(Gj+1).cp-1;af=je.cp;Mg=Mg-je.cp+1;let En=!1,Rm=!1,Si=!1,rp=Jd,Ji=0,Fn=0,ml=Xb,jn=void 0,Gn=Zc,gl=rc,rj,tk=Hd;if(je.formatting){var bi=je.formatting;En=ug.FormattingReader.Ug(bi,cb.a.bold,!1);Rm=ug.FormattingReader.Ug(bi,cb.a.italic,!1);Si=ug.FormattingReader.Ug(bi,cb.a.underline,!1);rp=ug.FormattingReader.Ug(bi,cb.a.fontSize,2*Jd)/2;Ji=ug.FormattingReader.Ug(bi,cf.a.capitalization,0);Fn=ug.FormattingReader.Ug(bi,cb.a.fontColor,0);Gn=ug.FormattingReader.language(bi)||Zc;this.ioc&&(tk=Object(Qf.c)(bi));
gl=ug.FormattingReader.Ug(bi,cb.a.font,rc);ml=Xb;var zh=bi.mo;zh&&(zh=zh.ka(cf.a.Lw,null))&&!zh.equals(nb.a.nil)&&bi.paragraph.Hc&&(bi=this.xe.ro().wla(zh,bi.paragraph.Hc))&&(ml=bi.getValue(cf.a.la))}this.Ysa&&(rj=this.eLf(Wf),null!=rj&&this.yOh(Ua,Wf,rj,Xd.length,me.b.Inline));Ah&&(jn=0<Ah.count);je={isDeleted:this.win(gm,je,Gj,Zi),fontFamily:gl,fontWeight:En?me.d.Bold:me.d.Normal,fontSize:rp,italic:Rm,underline:Si?me.h.SingleLine:me.h.None,capitalization:Ui.O7h(Ji),color:Fn,styleName:ml,isFollowUp:jn,
languageId:Ui.D7h(Gn),...(this.ioc?{isUserOverriddenLanguage:tk}:{}),start:af,length:Mg,link:Zi,isReference:Ui.isReference(je)?!0:void 0,objectType:null!==rj&&void 0!==rj?rj:void 0};Wf=0<Xd.length?Xd[Xd.length-1]:void 0;Ui.Kll(Wf,je)?Wf.length+=je.length:Xd.push(je)}return Xd}return[{fontFamily:rc,fontWeight:me.d.Normal,fontSize:Jd,italic:!1,underline:me.h.None,capitalization:Ui.O7h(0),color:0,styleName:Xb,isFollowUp:void 0,languageId:Ui.D7h(Zc),start:0,length:ma.characterData.length,...(this.ioc?
{isUserOverriddenLanguage:Hd}:{})}]}get ioc(){return Qf.a.xua&&null!==this.Pda&&this.Pda.QLf()}win(ma,Ua,xb,Xb){if(this.nD()){if(Ua.blob||Ua.formatting&&Ua.formatting.cache&&Ua.formatting.cache.rTb||Xb)return!0;if(ma&&xb<ma.length)return ma[xb]}return Ua.BU?!0:Ua.Yh?!0:!1}nD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static Kll(ma,Ua){return!!ma&&!!Ua&&ma.start+ma.length===Ua.start&&ma.isDeleted===Ua.isDeleted&&
ma.fontFamily===Ua.fontFamily&&ma.fontWeight===Ua.fontWeight&&ma.fontSize===Ua.fontSize&&ma.italic===Ua.italic&&ma.underline===Ua.underline&&ma.capitalization===Ua.capitalization&&ma.color===Ua.color&&ma.highlightColor===Ua.highlightColor&&ma.styleName===Ua.styleName&&void 0===ma.link&&void 0===Ua.link&&ma.languageId===Ua.languageId&&!ma.isReference&&!Ua.isReference&&!ma.isFollowUp&&!Ua.isFollowUp&&void 0===ma.objectType&&void 0===Ua.objectType}hzm(ma){const Ua=new mf.a;Ua.set(ma);Ua.zb(11);Ua.kd(11);
return(ma=this.lg.Uw(Ua))?Ui.WBl(ma.listType):me.e.NoList}QWo(ma,Ua){var xb=Vj.ListItemReader.De?ma:this.lg.mfa(ma);if(Vj.ListItemReader.isListItem(xb)){if(Vj.ListItemReader.De){if(xb=Vj.ListItemReader.Jr(xb))Ua.listId=xb.listId.toString()}else xb.hasProperty(Ta.a.listID)&&(Ua.listId=xb.getValue(Ta.a.listID).toString());xb=this.SAi(ma,cb.a.font);ma=this.SAi(ma,cb.a.fontSize);xb&&(Ua.bulletAndNumberFontFamily=xb);ma&&(Ua.bulletAndNumberFontSize=ma)}}isInsideTable(ma){const Ua=new mf.a;Ua.set(ma);return Ua.zb(14)}YZo(ma,
Ua){Ua.spacingBeforeParagraph=this.KGi(ma,Ta.a.Hga,Ta.a.M3,Ta.a.Uj);Ua.spacingAfterParagraph=this.KGi(ma,Ta.a.Gga,Ta.a.L3,Ta.a.ta);Ua.lineSpacing=this.pQb(ma)}KGi(ma,Ua,xb,Xb){if(Mb.ParagraphReader.Ug(ma,Ua,!1))return 0;Ua=Mb.ParagraphReader.Ug(ma,xb,-1);if(0<=Ua)return Ua*Zf.a.kXb/100;ma=Mb.ParagraphReader.Ug(ma,Xb,-1);return 0<=ma?ma/20:0}SAi(ma,Ua){ma=this.Rqm(ma);if(null!=ma&&null!=ma.cache)return ma.cache.getValue(Ua)}Rqm(ma){var Ua;ma=null===(Ua=ma.ra)||void 0===Ua?void 0:Ua.last;return null!=
ma&&ma.ni?ma.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}pQb(ma){const Ua=Mb.ParagraphReader.Ug(ma,Ta.a.ya,Zf.a.ya);ma=Mb.ParagraphReader.Ug(ma,Ta.a.xa,Zf.a.lineSpacing);switch(Ua){case 0:return ma/240;case 1:return ma/20;default:return 0}}static Kwp(ma,Ua,xb){for(let Xb=0;Xb<Ua.length;Xb++){const rc=Ua.K(Xb),Zc=rc.pk,Hd=ma.Eb(Zc);Hd&&Hd.ka(Ta.a.yI,!1)&&(xb||(xb=new Cb.a(new zf.a)),rc.Wc?xb.add(Zc):xb.remove(Zc))}return xb}static D7h(ma){return(ma=
fd.a.Eg(ma))&&ma.name?ma.name.toLowerCase():void 0}static DJf(ma){return ma?2===ma.unit?Math.floor(Fd.a.RLb(ma.value)/20):Math.floor(ma.value/20):0}static FLm(ma){if(!ma)return me.g.Initial;switch(ma.specialIndentType){case 1:return me.g.FirstLine;case 2:return me.g.Hanging;default:return me.g.Initial}}static O7h(ma){switch(ma){case 2:return me.c.AllCaps;case 1:return me.c.SmallCaps;default:return me.c.NoCaps}}static JFf(ma){switch(ma){case 1:return me.a.Left;case 3:return me.a.Right;case 2:return me.a.Center;
case 6:return me.a.Justified;case 0:return me.a.None;default:return me.a.Other}}static WBl(ma){switch(ma){case 15:return me.e.Any;case 1:return me.e.Bullet;case 42:return me.e.Invalid;case 13:return me.e.Lim;case 14:return me.e.Nil;case 16:return me.e.NoList;case 0:return me.e.Numbered;default:return me.e.Invalid}}static isReference(ma){return ma.blob&&(7===ma.blob.Sh||10===ma.blob.Sh)||ma.Ch&&0<ma.Ch.length||ma.Ue&&0<ma.Ue.length||ma.Hb&&0<ma.Hb.length?!0:!1}static RNf(ma,Ua,xb){return null==Ua?
null:Ua[xb]&&!Ua[xb].equals(nb.a.nil)&&ma.Hc?ma.Hc.Eb(Ua[xb]):null}eLf(ma){if(null==ma)return null;if(ma.hasProperty(Ta.a.jt)){var Ua=ma.getValue(Ta.a.jt);if(Ui.etj.has(Ua))return Ui.etj.get(Ua)}if(ma.hasProperty(Ta.a.yic)&&null!=ma.getValue(Ta.a.yic))return me.f.FootnoteEndnote;if(ma.hasProperty(Ta.a.fcb)&&ma.getValue(Ta.a.fcb))return me.f.PageBreak;if(ma.hasProperty(Ta.a.VTb)&&ma.getValue(Ta.a.VTb))return me.f.Tab;Ua=!1;ma.hasProperty(Bg.a.Vfa)?Ua=ma.getValue(Bg.a.Vfa):ma.hasProperty(Ta.a.Zla)&&
(Ua=ma.getValue(Ta.a.Zla));return Ua&&ma.hasProperty(Ta.a.imageType)&&1==ma.getValue(Ta.a.imageType)?me.f.Image:null}static uln(ma){return ma.hasProperty(Ta.a.Flc)&&0<=ma.getValue(Ta.a.Flc)?!0:!1}r2i(ma){return Ui.ygp.has(ma)}W$h(ma,Ua,xb,Xb){return null==ma||null==Ua?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):Xb===me.b.Inline&&null==xb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),
null):Xb===me.b.Floating&&null!=xb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>xb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Ui.uln(ma)?null:this.r2i(Ua)?{referencedPath:["session","doc","main",ma.id.toString()],formattedRangeIndex:xb,anchorMode:null!==Xb&&void 0!==Xb?Xb:me.b.Unspecified,anchoredObjectType:Xb==me.b.Floating?Ua:
void 0}:null}yOh(ma,Ua,xb,Xb,rc){Ua=this.W$h(Ua,xb,Xb,rc);null!=Ua&&null!=ma&&ma.push(Ua)}Iho(ma){const Ua=[];if(null==ma)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),Ua;let xb=null;ma.hasProperty(Ta.a.i6)&&(xb=ma.getValue(Ta.a.i6));if(null!=xb)for(let Xb=0;Xb<xb.length;++Xb){const rc=Ui.RNf(ma,xb,Xb),Zc=this.eLf(rc);null!=Zc&&this.yOh(Ua,rc,Zc,null,me.b.Floating)}return Ua}s6h(ma){if(null==ma||!ma.hasProperty(cb.a.Sn))return!1;const Ua=
ma.getValue(cb.a.Sn);for(let Xb=0;Xb<Ua.length;Xb++){var xb=Ui.RNf(ma,Ua,Xb);xb=this.eLf(xb);if(this.r2i(xb))return!0}return!1}}Ui.etj=new Map([[5,me.f.Image],[11,me.f.TextBox],[7,me.f.Chart],[6,me.f.SmartArt],[10,me.f.Drawing],[2,me.f.EquationObject],[4,me.f.Ink],[19,me.f.PageBreak],[23,me.f.FootnoteEndnote],[24,me.f.FootnoteEndnote],[35,me.f.FootnoteEndnoteReferenceMark],[36,me.f.FootnoteEndnoteReferenceMark],[0,me.f.Other]]);Ui.ygp=new Set([me.f.Image,me.f.TextBox,me.f.Chart,me.f.SmartArt,me.f.Drawing,
me.f.Ink]);Object(f.a)(Ui,"FormattingExtractor",null,[308]);var Bb=d(1190);class Pb extends Sys.EventArgs{constructor(ma){super();this.ylc=ma}}Object(f.a)(Pb,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class zc extends Sys.EventArgs{constructor(ma){super();this.gba=ma}}Object(f.a)(zc,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class $c{constructor(ma,Ua,xb){this.eed=ma;this.graphNode=Ua;this.fullPath=xb}}Object(f.a)($c,"NodeEvent",null,[320]);class Ae{constructor(){this.PVe=this.yTe=!1;this.DFb=
null;this.sa=new Na.a;this.Gda=new pa.a(0);this.mib=new Bb.a(Kb.a.vh());this.qGb=new Bb.a(Kb.a.vh());this.oHd=[]}aPh(ma){this.sa.addHandler("IsCollectingNodeEventsChangedKey",ma)}gsl(){this.Gda=new pa.a(0);this.ylc=!1}get ylc(){return this.yTe}set ylc(ma){this.yTe!==ma&&(this.yTe=ma,this.sa.raiseEvent("HasNodeEventsChangedKey",new Pb(ma),this))}get gba(){return this.PVe}set gba(ma){this.PVe!==ma&&(this.PVe=ma,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new zc(ma),this))}ZZb(ma,Ua){this.mib.tb(ma)||
this.mib.W(ma,Ua)}aMo(ma,Ua){this.qGb.W(ma,Ua)}Whm(ma){let Ua=null;this.qGb.tb(ma)&&(Ua=this.qGb.K(ma),this.qGb.remove(ma));return Ua}Vse(ma,Ua){if(ma)if(this.gba){var xb=3!==Ua&&4!==Ua&&5!==Ua||!this.mib.tb(String.format("{0}",ma.id))?Ha.a.eH(ma):this.mib.K(String.format("{0}",ma.id));if(({value:Xb}=this.Gda.Ec(xb)).returnValue)if(Xb||3!==Ua)if(5===Xb&&3===Ua){if(ma=xb.split("\\").pop(),this.qGb.tb(ma)){var Xb=this.qGb.K(ma);Xb===xb?(this.Z5f(xb,Ua),this.Gda.add(xb,Ua)):(this.qGb.W(ma,xb),this.mib.W(ma,
Xb),this.haj(xb),this.Gda.remove(xb),this.Z5f(xb,Ua),this.Gda.add(Xb,5))}}else Xb&&(4!==Xb||0!==Ua&&3!==Ua&&5!==Ua)&&(this.Z5f(xb,Ua),this.Gda.add(xb,Ua));else this.haj(xb),this.Gda.remove(xb);else this.aIn(xb,Ua),this.oHd.push(ma),this.Gda.add(xb,Ua);this.ylc=0<this.Gda.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}aIn(ma,Ua){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",
ma,Ua)}Z5f(ma,Ua){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ma,Ua)}haj(ma){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ma)}tzl(){let ma=null;var Ua=!1;let xb=null;for(;this.oHd.length&&!Ua;){xb=Array.dequeue(this.oHd);if(!xb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.mib.tb(String.format("{0}",xb.id))?(ma=this.mib.K(String.format("{0}",xb.id)),this.mib.remove(String.format("{0}",
xb.id)),this.oHd.push(xb)):ma=Ha.a.eH(xb);Ua=this.Gda.tb(ma)}if(!Ua)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.gsl(),null;Ua=this.Gda.K(ma);this.Gda.remove(ma);this.ylc=0<this.Gda.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ma,Ua);return new $c(Ua,xb,ma)}Yro(ma){this.DFb=ma}uzl(){if(!this.DFb)return null;for(var ma=0;ma<this.DFb.length;ma++){var Ua=this.DFb.K(ma);Ua=Ha.a.eH(Ua.node);if(this.Gda.tb(Ua))return null}ma=
this.DFb;this.DFb=null;return ma}ysl(){this.DFb=null}jdp(){this.gba=!0}Vjn(ma){return this.Gda.tb(ma.id.toString())}}Object(f.a)(Ae,"NodeEventsCollection",null,[307]);var Gf=d(1386),jg=d(1304),hi=d(359),xj=d(88);class xg extends jg.a{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af){super();this.YCd=new Gf.a;this.Yhb=!1;this.MGc=null;this.Jma=(Wf,Mg)=>{(Wf=Mg.node)&&this.feb(Wf)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),Ha.a.O4o(Wf,this.Dpa.gba,this.l4b,this.mMk)&&(this.Dpa.Vse(Wf,
0),this.V6j(Wf)));this.Dpa.gba&&this.Lda.$vb(Wf)};this.cjj=(Wf,Mg)=>{Wf=Mg.node;this.Dpa.ZZb(String.format("{0}",Wf.id),Ha.a.eH(Wf))};this.uYa=(Wf,Mg)=>{(Wf=Mg.node)&&this.feb(Wf)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Dpa.gba&&this.Dpa.Vse(Wf,3));this.Dpa.gba&&this.Lda.lmj(Wf,3)};this.BN=(Wf,Mg)=>{Wf=Mg.node;Mg=Mg.property;Wf&&this.Nnk.has(Mg)&&this.feb(Wf)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Dpa.gba&&(this.Dpa.Vse(Wf,
2),Mg===Ta.a.Vj&&this.V6j(Wf)));this.Dpa.gba&&Mg===Ta.a.ed&&this.Lda.lmj(Wf,2)};this.djj=(Wf,Mg)=>{(Wf=Mg.node)&&Mb.ParagraphReader.Wb(Wf)&&!this.tGc.has(Wf)&&!this.PQe.has(Wf)&&(this.tGc.add(Wf),this.r0())};this.nmj=(Wf,Mg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Wf=Mg.node)&&this.Re.eWn(Wf)};this.lbg=()=>{this.$od()?this.eY():this.Yhb&&!this.Dpa.gba&&this.Csd()};this.ZD=Ua;this.Dpa=xb;this.mMk=xj.b(Xb.Pve);this.l4b=ma.$("AugLoopOperationsAreEnabled");this.Re=rc;this.Lda=
Zc;this.KD=Hd;this.Jb=Jd;this.Wn=Xd;this.FH=je;this.tGc=new Set;this.PQe=new Set;af.Zua(this,7);this.Nnk=new Set([cb.a.zn,cb.a.bold,cb.a.italic,cb.a.underline,cb.a.font,cb.a.fontSize,cb.a.fontColor,cf.a.capitalization,cb.a.si,cb.a.Sn,Ta.a.Hga,Ta.a.M3,Ta.a.Uj,Ta.a.Gga,Ta.a.L3,Ta.a.ta,Ta.a.ya,Ta.a.xa,Ta.a.listID,Ta.a.WU,Ta.a.ke,Ta.a.OCa,Ta.a.Uv,Ta.a.Vj])}get index(){return 7}get Afd(){return this.MGc}set Afd(ma){this.MGc=ma;this.Lda.rfg=ma?()=>{this.MGc()}:null}init(){this.$od()&&this.eY();this.Dpa.aPh(this.lbg)}eY(){this.ZD?
(this.Yhb=!0,this.ZD.ut(this.Jma),this.ZD.wT(this.cjj),this.ZD.ly(this.uYa),this.ZD.Qo(this.BN),this.ZD.GPh(this.nmj),this.ZD.c1k(this.djj)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}Csd(){this.ZD?(this.Yhb=!1,this.ZD.kS(this.Jma),this.ZD.Xga(this.cjj),this.ZD.Hua(this.uYa),this.ZD.LP(this.BN),this.ZD.ODj(this.nmj),this.ZD.$Bo(this.djj)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}tae(ma){ma&&
this.YCd.add(ma.id,ma.ka(Ta.a.Vj,0))}V6j(ma){this.YCd.tb(ma.id)?(this.Lda.bCp(Za.a.Ize,ma,this.YCd.K(ma.id)),this.YCd.remove(ma.id)):(this.Lda.rsl(Za.a.Ize),this.Afd&&this.Afd())}feb(ma){const Ua=re.StaticActiveAppFrame.za().kb.Qc;return!!Ua&&Ua.ow&&!!Ua.vd&&!!Ua.vd.Hc&&!!ma&&!!ma.Hc&&ma.Hc.id===Ua.vd.Hc.id}run(){if(0!==this.tGc.size){var ma=[];for(const Ua of this.tGc)ma.push(Ua),this.PQe.add(Ua),100<=ma.length&&(this.Oji(ma),ma=[]);0<ma.length&&this.Oji(ma);this.tGc.clear()}}Oji(ma){const Ua=new Db.a(4,
1,500,()=>{for(const xb of ma)this.PQe.delete(xb),this.rvp(xb)},158);this.Jb.$b(Ua)}rvp(ma){var Ua=this.Wn.hKa(ma,0,Xb=>this.y6o(Xb.intent));if(0<Ua.count)for(const Xb of Ua){Ua=this.Lda.nIm(Xb.intent.id);var xb=ma.Nra;const rc=Mb.ParagraphReader.rU(ma);Xb.end<Xb.Dc||(xb=hi.a.JXc(rc,xb,Xb.Dc,Xb.end-Xb.Dc,Xb.Dc,Xb.end-Xb.Dc,ma),this.FH.zqg(ma.Hc,Ua,xb))}}y6o(ma){return!!ma&&this.KD.Atb(ma)&&!!ma.content}$od(){return!this.Yhb&&this.Dpa.gba}}Object(f.a)(xg,"ParagraphNodeEventHandler",jg.a,[257]);var fj=
d(988),dg=d(479),Nf=d(953),pg=d(235);class ye extends Nf.a{constructor(){super();this.H_=Object.assign(new pg.a,{T_:ye.getTypeName(),B_:ye.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(f.a)(ye,"DeltaUpdateOperation",Nf.a,[]);var qh=d(879);class qg{constructor(){this.referencedPath=null}}Object(f.a)(qg,"ItemReference",null,[]);class dl extends qh.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=
null}}Object(f.a)(dl,"ItemWithPath",qh.a,[]);var Jk=d(1575);class Ni extends Jk.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new pg.a,{T_:Ni.getTypeName(),B_:Ni.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(f.a)(Ni,"MoveOperation",Jk.a,[]);var Wh=d(1434);class gh extends Wh.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new pg.a,
{T_:gh.getTypeName(),B_:gh.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(gh,"SelectionSignal",Wh.a,[]);class th extends gh{constructor(){super();this.content=null;this.H_=Object.assign(new pg.a,{T_:th.getTypeName(),B_:th.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}Object(f.a)(th,
"SelectionContentSignal",gh,[]);class li{constructor(){this.range=this.tileReference=null}}Object(f.a)(li,"TextTileRange",null,[]);var rg=d(1673),jj=d(878),Jl=d(31),Af=d(37);class kl{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd){this._augLoopRuntimeManager=this.dBd=null;this.O7e=!1;this.Tpa=this.lZe=this.NLd=null;this.beh=2E3;this.z$l=()=>{if(mb.a.LX||dg.SessionStatusManager.instance&&dg.SessionStatusManager.instance.$o)od.a.Nz().closeSession(),a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),
this.Jb.wf(this.dBd);this.tk.le(()=>{var Xd;const je=bf.a.instance.cfa;this.nD()&&this.vGo();for(this.CQc.reset();this.r3a.ylc&&!this.CQc.pvb();){let Mg;Mg=this.r3a.tzl();if(!Mg||!Mg.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.CQc.update();continue}if(!this.u4o(Mg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",Mg.graphNode.id);this.CQc.update();continue}const bi=
Mg.graphNode.id.toString();var af=-1,Wf=!0;je&&Af.a.mf(je)&&bi==je.node.id.toString()&&(af=je.cpBegin,Wf=!1);let zh=null;if(this.iIb.contains(bi))switch(Mg.eed){case 3:this.iIb.remove(bi);zh=3;break;default:zh=Mg.eed}else switch(Mg.eed){case 0:case 1:this.iIb.add(bi);zh=0;break;case 2:this.iIb.add(bi);zh=0;break;case 3:this.iIb.remove(bi);zh=3;break;default:zh=Mg.eed}if(null!=zh){af=this.PCi(Mg.graphNode,Mg.fullPath,zh,af,Wf);if(4==zh||5==zh){if(af.prevParentPath.join()!==af.parentPath.join()){Wf=
Object.assign(new wb.a,{parentPath:af.prevParentPath,items:af.items});const Ah=Object.assign(new tb.a,{parentPath:af.parentPath,items:af.items,prevId:af.prevId,nextId:af.nextId});bi!==af.prevId&&bi!==af.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",zh,bi,af.prevId,af.nextId,Mg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,{operation:Wf}));
this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,{operation:Ah}));14===Mg.graphNode.type&&this.tLj(Mg.graphNode,af.parentPath).forEach(Zi=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,{operation:Zi}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,{operation:af}));if(this.Qwd&&this.Tpa&&this.Tpa[0]==bi)switch(zh){case 3:this.Tpa=null;break;case 0:case 1:case 2:case 4:case 5:this.Tpa[1]=null===(Xd=this.Gjb.Wqb(Mg.graphNode))||void 0===
Xd?void 0:Xd.r2c(Mg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",vc.a.getTypeNameFor(af),bi);switch(zh){case 0:case 4:case 5:this.Re.S4n(Mg.graphNode);break;case 3:this.Re.T4n(Mg.graphNode,af.parentPath.join("\\"))}}this.CQc.update()}(Xd=this.r3a.uzl())&&this.oFj(Xd)},"TV:FPEFO")};this.wua=(Xd,je)=>{var af;if(je.Rm&&je.Rm.length){if(this.Qwd)if(Xd=Ha.a.fCm(je.Rm),!Xd)this.Tpa=null;else if(!this.Tpa||this.Tpa[0]!=
Xd.id.toString()){const Wf=this.r3a.Vjn(Xd)?null:null===(af=this.Gjb.Wqb(Xd))||void 0===af?void 0:af.r2c(Xd);this.Tpa=[Xd.id.toString(),Wf]}this.O7e&&this.r3a.Yro(je.Rm.currentSelection)}};this.Aa=ma;this.r3a=Ua;this.Jb=xb;this.CQc=Xb;this.rok=this.Aa.$("AugLoopOperationsAreEnabled");this.iIb=new Cb.a(Kb.a.vh());this.Re=rc;this.tk=Zc;this.Gjb=Hd;this.ib=Jd;this.Qwd=this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.AB(this.wua);Ha.a.im().then(()=>{this._augLoopRuntimeManager=
od.a.Nz();this.Aa.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new rg.a,{handler:Xd=>{this.Re.g6k(Xd)}}));this.rok&&this.r3a.jdp();this.bep()}).catch(()=>{});this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.beh=5E3)}vGo(){const ma=this.Re.aGc.entries();for(let Ua=0;Ua<this.Re.aGc.size;Ua++){const xb=ma.next();y.AFrameworkApplication.$c("gi204158;ef1e2812");Date.now()-xb.value[1].time>=
this.beh&&this.Re.n5c(xb.value[1].annotation,!0,tb.a.getTypeName(),!1)}}u4o(ma){return 3===ma.eed||Ha.a.vTj(ma.graphNode)}bep(){!this.dBd&&this.r3a.gba&&(this.dBd=new Db.a(4,2,this.Aa.jc("NodeEventsFiringInterval",500),this.z$l,131),this.Jb.$b(this.dBd))}tLj(ma,Ua){var xb,Xb=[];const rc=mf.a.eb(ma),Zc=rc.ar();for(var Hd=0;Hd<Zc;Hd++){let Jd=rc.ZB(Hd);11===Jd.type&&(Jd=Jl.OutlineElementNavigator.Me(rc));const Xd=Jd.id.toString(),je=null===(xb=this.Gjb.Wqb(Jd))||void 0===xb?void 0:xb.Tnb(Jd);Xb.push(Object.assign(new qh.a,
{body:je,id:Xd,revId:Ha.a.aOf(Jd)}));rc.kd(ma.type)}Ua.push(ma.id.toString());xb=[];xb.push(Object.assign(new tb.a,{parentPath:Ua.slice(),items:Xb,prevId:null}));for(Xb=0;Xb<Zc;Xb++)Hd=rc.ZB(Xb),11===Hd.type&&(Hd=Jl.OutlineElementNavigator.Me(rc)),0<rc.ar()&&(xb=xb.concat(this.tLj(Hd,Ua))),rc.kd(ma.type);Ua.pop();return xb}kKa(ma){return ma.split("\\").slice(0,-1)}PCi(ma,Ua,xb,Xb=-1,rc=!0){var Zc;let Hd=null,Jd=null;const Xd=ma.id.toString();var je=null;3!==xb&&(je=Ha.a.jil(ma));if(je)for(let af=
0;af<je.length;af++)if(je[af]===Xd){Jd=af+1<je.length?je[af+1]:null;Hd=af?je[af-1]:null;break}Xd!==Hd&&Xd!==Jd||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",xb,Xd,Hd,Jd,ma.type);je=null===(Zc=this.Gjb.Wqb(ma))||void 0===Zc?void 0:Zc.Tnb(ma,Xb,rc);Xb=[Object.assign(new qh.a,{body:je,id:Xd,revId:Ha.a.aOf(ma)})];switch(xb){case 0:case 1:return Object.assign(new tb.a,{parentPath:this.kKa(Ua),
items:Xb,prevId:Hd,nextId:Jd});case 4:return Object.assign(new Ni,{parentPath:this.kKa(Ha.a.eH(ma)),prevParentPath:this.kKa(Ua),items:Xb,prevId:Hd,nextId:Jd});case 5:return xb=this.r3a.Whm(Xd),Object.assign(new Ni,{parentPath:this.kKa(null!==xb&&void 0!==xb?xb:Ha.a.eH(ma)),prevParentPath:this.kKa(Ua),items:Xb,prevId:Hd,nextId:Jd});case 2:return Object.assign(new gc.a,{parentPath:this.kKa(Ua),items:Xb});case 3:return Object.assign(new wb.a,{parentPath:this.kKa(Ua),items:Xb});default:return a.ULS.sendTraceTag(42084322,
389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",xb,Xd),Object.assign(new Jk.a,{parentPath:this.kKa(Ua),items:Xb,prevId:Hd,nextId:Jd})}}BPm(ma){return this.Tpa&&this.Tpa[0]===ma?this.Tpa[1]:null}TQo(ma){var Ua;if(!this.Qwd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Ha.a.vTj(ma))return!1;const xb=ma.id.toString();var Xb=this.iIb.contains(xb)?2:0;Xb=this.PCi(ma,Ha.a.eH(ma),Xb);this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,
{operation:Xb}));this.iIb.add(xb);this.Tpa=[xb,null===(Ua=this.Gjb.Wqb(ma))||void 0===Ua?void 0:Ua.r2c(ma)];return!0}LPo(ma,Ua){var xb;if(this.Qwd){var Xb=ma.id.toString(),rc=this.kKa(Ha.a.eH(ma));Ua=[Object.assign(new dl,{id:Xb,revId:Ha.a.aOf(ma),parentPath:rc,delta:Ua})];rc=Object.assign(new ye,{parentPath:rc,items:Ua});this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,{operation:rc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Xb);this.Tpa=[Xb,null===
(xb=this.Gjb.Wqb(ma))||void 0===xb?void 0:xb.r2c(ma)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}N$k(ma,Ua){if(ma.tileReference.referencedPath.length!==Ua.tileReference.referencedPath.length||ma.range.start!==Ua.range.start||ma.range.length!==Ua.range.length||ma.range.isInsertionPoint!==Ua.range.isInsertionPoint)return!1;for(let xb=0;xb<ma.tileReference.referencedPath.length;xb++)if(ma.tileReference.referencedPath[xb]!==Ua.tileReference.referencedPath[xb])return!1;
return!0}I$k(ma,Ua){if(ma.selectedRanges.length!==Ua.selectedRanges.length||ma.content!==Ua.content)return!1;for(let xb=0;xb<ma.selectedRanges.length;xb++)if(!this.N$k(ma.selectedRanges[xb],Ua.selectedRanges[xb]))return!1;return!0}oFj(ma){ma=this.getSelection(ma);if(!this.lZe||!this.I$k(ma,this.lZe)){var Ua=this.NLd?this.NLd:nb.a.create().toString(),xb=[Object.assign(new qh.a,{body:ma,id:Ua})];this.NLd?Ua=Object.assign(new gc.a,{parentPath:["session","doc"],items:xb}):(this.NLd=Ua,Ua=Object.assign(new tb.a,
{parentPath:["session","doc"],items:xb}));this._augLoopRuntimeManager.submitOperation(Object.assign(new jj.a,{operation:Ua}));this.lZe=ma}}getSelection(ma){var Ua;if(!ma)return null;const xb=new N.a;let Xb="";for(let Hd=0;Hd<ma.length;Hd++){var rc=ma.K(Hd),Zc=(null===(Ua=this.Gjb.Wqb(rc.node))||void 0===Ua?void 0:Ua.Tnb(rc.node)).content;Xb+=Zc;Zc=rc.cpBegin<Zc.length?rc.cpBegin:-1;Zc=Object.assign(new ld.a,{start:Zc,length:rc.cpEnd-rc.cpBegin});Object.assign(Zc,{isInsertionPoint:Af.a.mf(rc)||Af.a.pl(rc)});
const Jd=rc.node.id.toString();rc=this.kKa(Ha.a.eH(rc.node));rc.push(Jd);xb.add(Object.assign(new li,{range:Zc,tileReference:Object.assign(new qg,{referencedPath:rc})}))}return Object.assign(new th,{selectedRanges:xb.toArray(),content:Xb})}QZo(ma){(this.O7e=ma)?this.XEj():this.r3a.ysl()}XEj(){this.oFj(this.ib.gb.currentSelection)}I2(){var ma,Ua,xb=null===(ma=this.ib.gb)||void 0===ma?void 0:ma.currentSelection;if(xb){ma=new N.a;var Xb="";for(const rc of xb){xb=(null===(Ua=this.Gjb.Wqb(rc.node))||void 0===
Ua?void 0:Ua.Tnb(rc.node)).content;Xb+=xb;xb=Object.assign(new ld.a,{start:rc.zj,length:rc.Po-rc.zj});const Zc=rc.node.id.toString(),Hd=this.kKa(Ha.a.eH(rc.node));Hd.push(Zc);ma.add(Object.assign(new li,{range:xb,tileReference:Object.assign(new qg,{referencedPath:Hd})}))}return Object.assign(new th,{selectedRanges:ma.toArray(),content:Xb})}}nD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(f.a)(kl,
"TileView",null,[259]);var xi=d(33),Eh=d(49);class Kj{constructor(ma){Eh.a.assign(Kj,this,ma)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ma){return Eh.a.matchesTypesFor(ma,[Kj.getTypeName()])}}Kj.H_={T_:Kj.getTypeName(),B_:Kj.getBaseTypes()};class Vi{constructor(ma){Eh.a.assign(Vi,this,ma)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ma){return Eh.a.matchesTypesFor(ma,[Vi.getTypeName()])}}
Vi.H_={T_:Vi.getTypeName(),B_:Vi.getBaseTypes()};class Qh{constructor(ma){Eh.a.assign(Qh,this,ma)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ma){return Eh.a.matchesTypesFor(ma,[Qh.getTypeName()])}}Qh.H_={T_:Qh.getTypeName(),B_:Qh.getBaseTypes()};class Mh{constructor(ma){Eh.a.assign(Mh,this,ma)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ma){return Eh.a.matchesTypesFor(ma,
[Mh.getTypeName()])}}Mh.H_={T_:Mh.getTypeName(),B_:Mh.getBaseTypes()};class Ch{constructor(ma){Eh.a.assign(Ch,this,ma)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ma){return Eh.a.matchesTypesFor(ma,[Ch.getTypeName()])}}Ch.H_={T_:Ch.getTypeName(),B_:Ch.getBaseTypes()};var Al;(function(ma){ma[ma.Top=0]="Top";ma[ma.Center=1]="Center";ma[ma.Bottom=2]="Bottom"})(Al||(Al={}));var Rj;(function(ma){ma[ma.none=
0]="none";ma[ma.firstRow=32]="firstRow";ma[ma.lastRow=64]="lastRow";ma[ma.firstCol=128]="firstCol";ma[ma.lastCol=256]="lastCol";ma[ma.neq=512]="noHBand";ma[ma.xeq=1024]="noVBand";ma[ma.nwCell=160]="nwCell";ma[ma.neCell=288]="neCell";ma[ma.swCell=192]="swCell";ma[ma.seCell=320]="seCell";ma[ma.KOl=1184]="defaultLook"})(Rj||(Rj={}));Object(f.b)("TableLookFlags",Rj);class qk{Tnb(ma){if(ma)switch(ma.type){case 14:return this.XKl(ma);case 15:return new Kj;case 16:return this.WKl(ma)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}XKl(ma){var Ua=ma.aI||[];let xb=0;for(let Xb=0;Xb<Ua.length;Xb++)xb+=Ua[Xb];Ua=Ua.map((Xb,rc)=>({columnId:rc.toString(),widthPercent:0!=xb?100*Xb/xb:0}));return new Mh({columnDefs:Ua,tableLook:ma.properties.ka(Ta.a.tableLook,Rj.KOl),complexTable:ma.properties.ka(Ta.a.complexTable,!1),floatingTable:ma.properties.ka(Ta.a.WXi,!1)})}WKl(ma){return new Vi({rowspan:ma.properties.ka(Ta.a.rowSpan,1),colspan:ma.properties.ka(Ta.a.colSpan,1),borderInfo:{topBorder:{color:ma.properties.ka(Ta.a.j1b,
0),size:ma.properties.ka(Ta.a.Wyc,4),style:ma.properties.ka(Ta.a.Nzb,"single")},leftBorder:{color:ma.properties.ka(Ta.a.h1b,0),size:ma.properties.ka(Ta.a.Uyc,4),style:ma.properties.ka(Ta.a.Lzb,"single")},rightBorder:{color:ma.properties.ka(Ta.a.i1b,0),size:ma.properties.ka(Ta.a.Vyc,4),style:ma.properties.ka(Ta.a.Mzb,"single")},bottomBorder:{color:ma.properties.ka(Ta.a.g1b,0),size:ma.properties.ka(Ta.a.Tyc,4),style:ma.properties.ka(Ta.a.Kzb,"single")}},verticalAlignment:ma.properties.ka(Ta.a.lOa,Al.Top),
ghostCell:ma.properties.ka(Ta.a.ghostCell,!1),renderCell:ma.properties.ka(Ta.a.renderCell,!1),skippedCell:ma.properties.ka(Ta.a.skippedCell,!1),fillColor:ma.properties.ka(cb.a.QG,0),verticalMerge:ma.properties.ka(xi.a.vMerge,null)})}r2c(ma){return null===ma||void 0===ma?void 0:ma.properties}}Object(f.a)(qk,"TableElementNodeToTileConverter",null,[258]);class eg{constructor(ma,Ua,xb){this.Pq=Ua;this.fEa=xb;this.r1d=!1;this.MGc=null;this.qoj=(Xb,rc)=>{this.fDa(rc.node,0)};this.moj=(Xb,rc)=>{Xb=rc.node;
this.fEa.ZZb(Xb.id.toString(),Ha.a.eH(Xb))};this.roj=(Xb,rc)=>{this.fDa(rc.node,3)};this.Hne=(Xb,rc)=>{this.fDa(rc.node,2)};this.toj=(Xb,rc)=>{this.fDa(rc.node,0)};this.uoj=(Xb,rc)=>{this.fDa(rc.node,3)};this.soj=(Xb,rc)=>{Xb=rc.node;this.fEa.ZZb(Xb.id.toString(),Ha.a.eH(Xb))};this.Ine=(Xb,rc)=>{this.fDa(rc.node,2)};this.ooj=(Xb,rc)=>{this.fDa(rc.node,0)};this.noj=(Xb,rc)=>{Xb=rc.node;this.fEa.ZZb(Xb.id.toString(),Ha.a.eH(Xb))};this.poj=(Xb,rc)=>{this.fDa(rc.node,3)};this.Fne=(Xb,rc)=>{var Zc;Xb=
rc.node;if(rc.property===Ta.a.ghostCell){if(rc=Xb.Ng?Xb:null===(Zc=Xb.jCa)||void 0===Zc?void 0:Zc.LO){Zc=mf.a.eb(rc);var Hd=Zc.ar();for(var Jd=0;Jd<Hd;Jd++){Zc.ZB(Jd);var Xd=Jl.OutlineElementNavigator.Me(Zc);this.fEa.ZZb(Xd.id.toString(),String.format("{0}\\{1}",Ha.a.eH(rc),Xd.id));this.fDa(Xd,4);Zc.kd(16)}}}else if(rc.property===cb.a.rg){rc=mf.a.eb(Xb);Zc=rc.ar();let je=null;Hd=[];for(Jd=0;Jd<Zc;Jd++){rc.ZB(Jd);Xd=Jl.OutlineElementNavigator.Me(rc);this.fEa.aMo(Xd.id.toString(),String.format("{0}\\{1}",
Ha.a.eH(Xb),Xd.id));if(14!==Xd.type){if(je=Ha.a.eH(Xd))this.fEa.ZZb(Xd.id.toString(),je),this.fDa(Xd,5)}else Hd.push(Xd);rc.kd(16)}je&&Hd.forEach(af=>{this.fEa.ZZb(af.id.toString(),String.format("{0}\\{1}",je.split("\\").slice(0,-1).join("\\"),af.id));this.fDa(af,5)})}this.fDa(Xb,2)};this.lbg=()=>{this.$od()?this.eY():this.r1d&&!this.fEa.gba&&this.Csd()};this.l4b=ma.$("AugLoopOperationsAreEnabled")}get Afd(){return this.MGc}init(){this.$od()&&this.eY();this.fEa.aPh(this.lbg)}eY(){const {g_j:ma,DBe:Ua,
VZj:xb}=this.pxi();if(ma&&Ua&&xb){this.r1d=!0;var Xb=this.moj,rc=this.roj,Zc=this.Hne;ma.ut(this.qoj);ma.wT(Xb);ma.ly(rc);ma.Qo(Zc);Xb=this.soj;rc=this.uoj;Zc=this.Ine;Ua.ut(this.toj);Ua.wT(Xb);Ua.ly(rc);Ua.Qo(Zc);Xb=this.noj;rc=this.poj;Zc=this.Fne;xb.ut(this.ooj);xb.wT(Xb);xb.ly(rc);xb.Qo(Zc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}Csd(){const {g_j:ma,DBe:Ua,VZj:xb}=this.pxi();if(ma&&Ua&&xb){this.r1d=!1;var Xb=this.moj,rc=this.roj,
Zc=this.Hne;ma.kS(this.qoj);ma.Xga(Xb);ma.Hua(rc);ma.LP(Zc);Xb=this.soj;rc=this.uoj;Zc=this.Ine;Ua.kS(this.toj);Ua.Xga(Xb);Ua.Hua(rc);Ua.LP(Zc);Xb=this.noj;rc=this.poj;Zc=this.Fne;xb.kS(this.ooj);xb.Xga(Xb);xb.Hua(rc);xb.LP(Zc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}fDa(ma,Ua){ma&&this.feb(ma)&&this.fEa.gba&&this.l4b&&this.fEa.Vse(ma,Ua)}pxi(){return{g_j:this.Pq.qf(14),DBe:this.Pq.qf(15),VZj:this.Pq.qf(16)}}feb(ma){const Ua=re.StaticActiveAppFrame.za().kb.Qc;
return!!Ua&&Ua.ow&&!!Ua.vd&&!!Ua.vd.Hc&&!!ma&&!!ma.Hc&&ma.Hc.id===Ua.vd.Hc.id}$od(){return!this.r1d&&!!this.fEa.gba}}Object(f.a)(eg,"TableNodeEventHandler",null,[257]);class qf{constructor(ma,Ua){this.prj=ma;this.gip=Ua}Wqb(ma){return ma?14===ma.type||15===ma.type||16===ma.type?this.gip:12===ma.type?this.prj:null:null}}Object(f.a)(qf,"NodeToTileConverterHolder",null,[256]);var kg=d(346);class Wi{get name(){return"Box4.AugmentationLoop"}wc(ma){this.Z=ma;const Ua=this.Z.resolve("Common.IAppSettingsManager"),
xb=Ua.$("AugLoopTaskUseTimeBasedYieldStrategy"),Xb=new Ae,rc=xb?new bb.a(Ua.jc("AugLoopTaskAllowedRunTimeBeforeYielding",10),ka.a.Je):new eb(Ua.jc("AugLoopTaskNodesToRunBeforeYielding",10));this.Z.ia("Common.ICpuMeter",()=>va.a.instance).ha();this.Z.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new $i).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.Z.ia("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new xg(Ua,mb.a.jf.Tl.qf(12),Xb,this.Z.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),
this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.pc,this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();Ha.a.sye()&&this.Z.ia("Box4.AugmentationLoop.TableNodeEventHandler",
()=>new eg(Ua,mb.a.jf.Tl,Xb)).ha();this.Z.ia("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new Ra).ha();let Zc=null,Hd=null;Qf.a.xua&&(Zc=this.Z.resolve("Box4.Proofing.IProofingLanguageAutoDetectSettingsInfo"),Hd=ma.resolve("Box4.IFormattingEditor"));this.Z.ia("Box4.AugmentationLoop.IFormattingExtractor",()=>new Ui(this.Z.resolve("Common.IAppSettingsManager"),this.Z.Oa("Box4.IFeatureHelper"),this.Z.resolve("Box4.List.IListReader"),this.Z.resolve("Box4.IParagraphIndentationReader"),
this.Z.resolve("Box4.Styles.IWACStyleReader"),Zc)).ha();this.Z.ia("Box4.AugmentationLoop.IAnnotationPolicies",()=>new Za.a(new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),this.Z.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.Z.ia("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new ib(this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.IIntelligenceReader"),this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),
ma.resolve("Box4.IFeatureHelper"))).ha();const Jd=this.Z.resolve("IRoamingDictionary");this.Z.ia("Box4.AugmentationLoop.IAnnotationStorage",()=>new jf(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),y.AFrameworkApplication.pc,this.Z.Oa("Box4.IIntelligenceReader"),this.Z.Oa("Box4.IIntelligenceEditor"),this.Z.Oa("Box4.AugmentationLoop.IAnnotationPolicies"),this.Z.Oa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),
ma.resolve("Box4.IFeatureHelper"),kg.a.instance,()=>{try{return od.a.Nz()}catch(Xd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Xd),null}},Jd,Zc,Hd)).ha();this.Z.ia("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new qf(new fj.a(this.Z.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new qk)).ha();this.Z.ia("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",
()=>new kl(Ua,Xb,y.AFrameworkApplication.pc,rc,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.Z.resolve("Box4.ISelectionManager"))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.Z.ia("Box4.AugmentationLoop.IUtilsWrapper",()=>new dd).ha();this.Z.ia("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new Ac).ha()}init(){if(y.AFrameworkApplication.VH.BootFailed)a.ULS.sendTraceTag(512624089,
389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ma=new Xe(this.Z.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.Fe,mb.a.Nca,this.Z.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),qb.a.instance,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage")),Ua=new Wa;this.Z.register(254,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().PDp(()=>
Ua);y.AFrameworkApplication.$c("b8afb343;bjdjj400");const xb=Ha.a.wBn(this.Z.resolve("Common.IDynamicScriptLoaderProvider").OD,this.Z.resolve("Common.App.OAuth.IOAuthManager"),ma,this.Z.resolve("Common.ISharedDependencyLoader"),Ua);this.Z.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new dc(xb)).ha();this.Z.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Ha.a.sye()&&this.Z.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.Z.resolve("Box4.IIntelligenceReader").init();
this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ma){xa.a.instance.Mc(new Wi,0,ma);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(Wi,"Box4AugmentationLoopPackage",null,[0,1]);var ql=d(616),hg=d(11),Km=d(488),zg=d(1671);class Kd{constructor(ma,Ua,xb,Xb=null,rc=null,Zc=null){this.MO=new zg.a(Ua,Xb,rc,Zc);this.Ib=ma;this.Wc=xb}get type(){return this.MO.type}get id(){return this.MO.id}get intent(){return this.MO.intent}Of(ma){return new Kd(ma,
this.type,this.Wc,this.id,this.intent,this.MO.uCa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.MO,this.Wc)}}Object(f.a)(Kd,"IntentObject",null,[68]);var Cg=d(495),wl=d(152),Kl=d(255);class ae{constructor(){this.wHc=new wl.a}MQd(ma,Ua,xb,Xb,rc=null,Zc=null,Hd=null){ma=ma.o_(Ua,ma.ra.Xpp(Ua));ma.yk||(ma.yk=new Cg.a(ma));ma.yk.add(new Kd(ma,xb,Xb,rc,Zc,Hd));ma.O$a=!0}sCj(ma){return ma.Ib&&ma.Ib.yk&&ma.Ib.yk.Gkd(Ua=>Ua===ma,[ma.type])?!0:!1}tCj(ma,Ua){if(ma.type===Ua.type&&ma.Wc&&
!Ua.Wc&&ma.Ib&&ma.Ib.yk&&ma.Ib.yk.contains(ma)&&Ua.Ib&&Ua.Ib.yk&&Ua.Ib.yk.contains(Ua)){var xb=[ma.type];ma.Ib.yk.Gkd(Xb=>Xb===ma,xb);Ua.Ib.yk.Gkd(Xb=>Xb===Ua,xb)}}IEp(ma,Ua,xb){if(!Ua)return!1;xb=new ia.a([xb]);for(let Xb=0;Xb<ma.length;Xb++){const rc=ma.Ub(Xb);if(!rc.yk)continue;let Zc=!0;xb.w0a(rc.yk,void 0,Hd=>{Hd.id&&Ua.equals(Hd.id)&&(Zc=!1)});if(!Zc)return!1}return!0}Tfo(ma,Ua,xb,Xb){let rc=null,Zc=null;Ua=new ia.a([Ua]);const Hd=ma.ra;for(let Jd=0;Jd<Hd.length;Jd++){const Xd=Hd.Ub(Jd);if(!Xd.yk)continue;
let je=!0;Ua.w0a(Xd.yk,void 0,(af,Wf)=>{if(Wf){var Mg=Wf.Ib.cp<xb,bi=af.Ib.cp>Xb;Mg&&af.Ib.cp<=xb||Wf.Ib.cp>=Xb&&bi||(Mg&&bi?je=!1:Mg?rc=af:bi?Zc=Wf:this.tCj(Wf,af))}});if(!je)return!1}if(rc){if(!this.sCj(rc))return!1;this.MQd(ma,xb,rc.type,rc.Wc,rc.id,rc.intent,rc.MO.uCa)}if(Zc){if(!this.sCj(Zc))return!1;this.MQd(ma,Xb,Zc.type,Zc.Wc,Zc.id,Zc.intent,Zc.MO.uCa)}return!0}MAg(ma){let Ua;return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:Ua}=
this.wHc.Ec(ma.type,Ua)).returnValue?Ua.MAg(ma):!0}yKn(ma,Ua){if(this.MAg(Ua)){var xb=Ua.id,Xb=Ua.type,rc=Ua.Dc,Zc=Ua.end;if(({cpEnd:Zc}=ae.$$j(ma,rc,Zc)).returnValue){if(Km.a(Xb)){if(!this.IEp(ma.ra,xb,Xb))return}else if(!this.Tfo(ma,Xb,rc,Zc))return;this.MQd(ma,rc,Xb,!0,xb,Ua.intent,Ua.MO.uCa);this.MQd(ma,Zc,Xb,!1,xb,Ua.intent,Ua.MO.uCa)}}}$gd(ma,Ua){re.StaticActiveAppFrame.za().Izf(ma,()=>{const xb=new Jg.GraphTransaction(2);try{xb.Ab(ma);const Xb=ma.H0();try{const rc=ma.J6();try{Ua()}finally{rc&&
rc.dispose()}}finally{Xb&&Xb.dispose()}}finally{xb&&xb.dispose()}})}XXa(ma,Ua){this.$gd(ma,()=>{this.yKn(ma,Ua)})}AKn(ma,Ua){if(Ua.count){var xb=new Qb.a,Xb=new Kl.a;for(var rc of Ua){var Zc=rc.value;Km.a(rc.key)||Zc.Sc((Jd,Xd)=>Jd.Dc!==Xd.Dc?Jd.Dc-Xd.Dc:Jd.end-Xd.end);if(ae.NEp(Zc))for(var Hd of Zc)Zc=Hd.end,({cpEnd:Zc}=ae.$$j(ma,Hd.Dc,Zc)).returnValue&&(Zc=Zc!==Hd.end?new ab.a(Hd.type,Hd.Dc,Zc,Hd.id,Hd.intent,Hd.MO.uCa):Hd,xb.add(Zc.Dc),xb.add(Zc.end),ae.QXk(Xb,Zc))}ma.R0d(xb);ma=ma.ra;for(xb=0;xb<
ma.length;xb++){rc=ma.Ub(xb);if(Hd=rc.yk)for(const Xd of Ua.keys)Hd.lDj(Xd);let Jd;({value:Jd}=Xb.Ec(rc.cp,Jd)).returnValue||(Jd=null);if(Jd){Hd||(Hd=rc.yk=new Cg.a(rc));for(const Xd of Jd)Hd.add(Xd.Of(rc))}rc.O$a=!0}}}c7f(ma,Ua){const xb=new wl.a;for(const Xb of Ua){let rc;({value:rc}=xb.Ec(Xb.type,rc)).returnValue||(rc=new N.a,xb.W(Xb.type,rc));rc.add(Xb)}this.$gd(ma,()=>{this.AKn(ma,xb)})}Atp(ma,Ua,xb){ma=ma.ra;const Xb=new ia.a([8]);Ua===xb&&(xb+=1);for(let rc=0;rc<ma.length;rc++){const Zc=ma.Ub(rc);
Zc.yk&&Xb.w0a(Zc.yk,void 0,(Hd,Jd)=>{Jd&&Math.max(Jd.Ib.cp,Ua)<Math.min(Hd.Ib.cp,xb)&&this.tCj(Jd,Hd)})}}yJg(ma,Ua,xb){this.$gd(ma,()=>{this.Atp(ma,Ua,xb)})}Ctp(ma,Ua){ma=ma.ra;for(let xb=0;xb<ma.length;xb++){const Xb=ma.Ub(xb);Xb.yk&&Xb.yk.lDj(Ua)}}zAb(ma,Ua){this.$gd(ma,()=>{this.Ctp(ma,Ua)})}Btp(ma,Ua,xb){let Xb=!1;Ua=Ua.ra;xb=[xb];for(let rc=0;rc<Ua.length;rc++){const Zc=Ua.Ub(rc);Zc.yk&&(Xb=Zc.yk.Gkd(ma,xb)||Xb)}return Xb}Bsd(ma,Ua,xb){let Xb=!1;this.$gd(Ua,()=>{Xb=this.Btp(ma,Ua,xb)});return Xb}Ujc(ma,
Ua,xb,Xb){return!ma||0>xb||Xb>ma.characterData.length||xb>Xb?new N.a:this.hKa(ma,Ua,rc=>Math.max(rc.Dc,xb)<=Math.min(rc.end,Xb))}hKa(ma,Ua,xb){return ae.jxm(ma,Ua,xb)}static jxm(ma,Ua,xb){const Xb=new N.a;ma=ma.ra;Ua=new ia.a([Ua]);if(!ma)return Xb;for(let rc=0;rc<ma.length;rc++){const Zc=ma.Ub(rc);Zc.yk&&Ua.w0a(Zc.yk,void 0,(Hd,Jd)=>{Jd&&(Hd=new ab.a(Jd.type,Jd.Ib.cp,Hd.Ib.cp,Jd.id,Jd.intent,Jd.MO.uCa),xb(Hd)&&Xb.add(Hd))})}return Xb}u3c(ma,Ua){const xb=new N.a;if(!ae.dvn(ma.contextId))return xb;
let Xb;const rc=ma.node;ma.contextId!==hg.a.paragraph?(Xb=ma.cpBegin,ma=ma.cpEnd):(Xb=0,ma=rc.characterData.length);xb.addRange(this.Ujc(rc,Ua,Xb,ma));return xb}Vvo(ma){this.wHc.tb(0)||this.wHc.W(0,ma)}static $$j(ma,Ua,xb){ma=Mb.ParagraphReader.textLength(ma);if(Ua>=ma)return{returnValue:!1,cpEnd:xb};xb>ma&&(xb=ma);return{returnValue:!0,cpEnd:xb}}static NEp(ma){if(!ma.count)return!0;const Ua=new ql.a,xb=ma.K(0).type,Xb=Km.a(xb);let rc=-1;for(const Zc of ma){if(Zc.type!==xb||(Km.c(Zc.type)?Zc.Dc>Zc.end:
Zc.Dc>=Zc.end))return!1;if(Xb){ma=Zc.id;if(!ma||ma.equals(nb.a.nil)||Ua.contains(ma))return!1;Ua.add(ma)}else if(-1===rc)rc=Zc.end;else if(rc>Zc.Dc)return!1}return!0}static QXk(ma,Ua){let xb;({value:xb}=ma.Ec(Ua.Dc,xb)).returnValue||(xb=new N.a,ma.W(Ua.Dc,xb));xb.add(new Kd(null,Ua.type,!0,Ua.id,Ua.intent,Ua.MO.uCa));({value:xb}=ma.Ec(Ua.end,xb)).returnValue||(xb=new N.a,ma.W(Ua.end,xb));xb.add(new Kd(null,Ua.type,!1,Ua.id,Ua.intent,Ua.MO.uCa))}static dvn(ma){return ma===hg.a.Cd||ma===hg.a.Vc||ma===
hg.a.paragraph}}Object(f.a)(ae,"IntentRangeEditor",null,[260]);class pd{constructor(){this.Z=null}get name(){return"Box4.Intent"}wc(ma){this.Z=ma;this.Z.ia("Box4.Intent.IntentRangeEditor",()=>new ae).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.Z.resolve("Box4.IProofingManager")}dispose(){}static main(ma){xa.a.instance.Mc(new pd,0,ma);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(f.a)(pd,"PackageManager",null,[0,1]);var el=d(1025),Yg=d(253),rh=d(1306);class Mf{constructor(ma){this.OIn=
ma;this.KIn=[]}get handler(){return this.OIn}get Yra(){return this.KIn}}Object(f.a)(Mf,"RegisteredListener",null,[]);class mi{constructor(ma,Ua){this.type=0;this.payload=null;this.type=ma;this.payload=Ua}}Object(f.a)(mi,"OfficeSharedCommentsEvent",null,[1742]);class Ag{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(Ag,"ViewContainerEvent",null,[1742]);var Hf=d(596);class Pg{constructor(ma){this.y6f=!1;this.Kta=new N.a;this.Aie=ma}ovo(ma){ma=
new Mf(ma);this.Kta.add(ma)}n5j(ma){for(let Ua=0;Ua<this.Kta.count;++Ua)if(this.Kta.K(Ua).handler===ma){this.Kta.removeAt(Ua);break}}YZa(ma=!1){const Ua=()=>{if(y.AFrameworkApplication.Yl)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let rc=0;rc<this.Kta.count;++rc){const Zc=this.Kta.K(rc);for(;0<Zc.Yra.length;){var xb=Array.dequeue(Zc.Yra);if(Object(Yg.a)(Ag,xb)){var Xb=Zc.handler;Xb(xb)}else Object(Yg.a)(mi,xb)&&(Xb=Zc.handler,
Xb(xb.type,xb.payload))}}};ma?Ua():this.y6f||(this.y6f=!0,Hf.a.f6(this.Aie,()=>{Ua();this.y6f=!1},rh.a.lbm))}}Object(f.a)(Pg,"GenericEventHost",null,[]);class bk{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=
null}}Object(f.a)(bk,"BasicEventPayload",null,[1786]);class Sj{constructor(ma){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ma}}Object(f.a)(Sj,"CommentContextDetails",null,[]);class gj{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(f.a)(gj,"ContextChangeWithSelectedThreadIndex",null,[1786]);class Yi{constructor(){this.tasks=
this.comments=null}}Object(f.a)(Yi,"LoadCommentsNoVirtualization",null,[1786]);class Bl extends Pg{constructor(ma){super(ma);this.yCh=0}cZo(){this.yCh=1656}bwo(ma,Ua,xb,Xb,rc,Zc){ma=new Mf(ma);Zc&&Array.enqueue(ma.Yra,this.oEl(Zc,this.yCh));Zc=Ua?Ua.length:0;Array.enqueue(ma.Yra,this.r9h(Zc,xb,Xb,0));Zc&&Array.enqueue(ma.Yra,this.z$h(Ua,rc));this.Kta.add(ma);this.YZa()}d2b(ma){this.n5j(ma)}DPo(ma,Ua,xb,Xb=0){this.oSb(this.r9h(ma,Ua,xb,Xb));this.YZa()}EPo(ma,Ua,xb){this.oSb(this.MEl(ma,Ua,xb));this.YZa()}dQo(ma,
Ua){this.oSb(this.z$h(ma,Ua));this.YZa()}selectComment(ma){this.oSb(this.yai(ma,6));this.YZa()}highlightComment(ma){this.oSb(this.yai(ma,7));this.YZa()}OKg(ma,Ua){this.oSb(this.lIl(ma,Ua));this.YZa()}nkg(ma,Ua){this.oSb(this.yKl(ma,Ua));this.YZa()}oEl(ma,Ua=0){const xb=new bk;xb.modelCapabilityFlags=ma;xb.richTextCapabilityFlags=Ua;return new mi(12,xb)}r9h(ma,Ua,xb,Xb){const rc=new bk;rc.numberOfComments=ma;rc.numberOfThreads=Ua;rc.contextDetails=Object.assign(new Sj(xb),{nextPopulatedContextDetails:Xb});
rc.contextDrafts=null;rc.rehydrationDrafts=null;return new mi(0,rc)}MEl(ma,Ua,xb){const Xb=new bk;Xb.comments=ma;Xb.numberOfThreads=Ua;Xb.tasks=xb;return new mi(2,Xb)}z$h(ma,Ua){const xb=new Yi;xb.comments=ma;xb.tasks=Ua;return new mi(1,xb)}yai(ma,Ua){const xb=new bk;xb.commentId="";ma&&(xb.commentId=ma);return new mi(Ua,xb)}lIl(ma,Ua){const xb=new bk;xb.changes=[];xb.contextDetails=Object.assign(new Sj(Ua),{nextPopulatedContextDetails:ma});return new mi(10,xb)}yKl(ma,Ua){const xb=new bk;xb.commentId=
ma;xb.smartReplies=Ua;return new mi(15,xb)}oSb(ma){for(let Ua=0;Ua<this.Kta.count;++Ua)Array.enqueue(this.Kta.K(Ua).Yra,ma)}}Object(f.a)(Bl,"OfficeSharedCommentsEventHost",Pg,[1775]);var Ll=d(303),fn=d(204),Yn=d(305);class Tl{constructor(){this.A7e=this.b8g=!1;this.N5=this.eq=this.Emh=this.jth=this.vPd=this.H9b=this.gHh=this.Kbh=this.OD=this.yPc=null}initialize(ma,Ua,xb,Xb=null,rc=null,Zc=null,Hd=null,Jd=null,Xd=null,je=null){this.OD=ma;this.Kbh=Ua;this.gHh=xb;this.H9b=Xb;this.vPd=rc;this.jth=Zc;
this.Emh=Hd;this.eq=Jd;this.b8g=!0;this.N5=Xd;this.yPc=je}Lbe(){if(!this.b8g)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((ma,Ua)=>{Ua(Hf.a.xF(-2130915313))});if(this.A7e)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.yPc||(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?this.yPc=appResourceLoader.loadChunk("sharedComments"):
this.yPc=this.OD.loadScript("sharedComments"));return this.yPc.then(()=>{this.Unj()})}Unj(ma,Ua){ma&&ma();this.A7e||(this.N5&&this.N5.execute(xb=>{xb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Ua&&Ua(),sharedComments.instantiate(this.Kbh,this.gHh,this.H9b,this.vPd,this.jth,this.Emh,this.eq));this.A7e=!0}}Object(f.a)(Tl,"CommentActivationManager",null,[1832]);class jm extends Pg{constructor(ma){super(ma)}Txo(ma){this.ovo(ma)}uup(ma){this.n5j(ma)}yQj(ma){ma=
this.JEl(ma);for(let Ua=0;Ua<this.Kta.count;++Ua)Array.enqueue(this.Kta.K(Ua).Yra,ma);this.YZa(!0)}JEl(ma){const Ua=new Ag;Ua.eventType=3;Ua.viewContainerVisibilityState=ma;return Ua}Kbm(){const ma=this.GLl();for(let Ua=0;Ua<this.Kta.count;++Ua)Array.enqueue(this.Kta.K(Ua).Yra,ma);this.YZa(!0)}GLl(){const ma=new Ag;ma.eventType=2;return ma}}Object(f.a)(jm,"ViewContainerEventHost",Pg,[1722]);class Kk{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(Kk,"CommentUIActionPayload",null,
[]);var gn=d(313);class io{constructor(ma,Ua){this.LLh=(xb,Xb,rc,Zc,Hd)=>{if(this.ZCc.tb(xb)){var Jd=this.ZCc.K(xb);if(!this.yBb.tb(Jd))return 8;const Xd=this.yBb.K(Jd);if(Xd.preCallback){const je=Xd.preCallback(xb,Xb,rc,Zc,Hd);if(2!==je)return je}if(!Xd.registeredCallback)return 1===rc?8:2;Jd=Object.assign(new Kk,{actionType:Jd});1===rc&&(Jd.actionBehavior=1);Jd=Xd.registeredCallback(Jd);return Xd.postCallback?Xd.postCallback(Jd,xb,Xb,rc,Zc,Hd):Jd?32:8}return 2};this.ga=ma;this.yBb=Ua;this.ZCc=new gn.a;
for(const xb of this.yBb)this.ZCc.W(xb.value.canvasActionId,xb.key),ma=xb.value,ma.delayActionsUntilRegistration||this.qa(ma)}qa(ma){ma.withFlags?this.ga.fb(ma.canvasActionId,ma.canvasContextId,this.LLh,97):this.ga.qa(ma.canvasActionId,ma.canvasContextId,this.LLh)}xZa(ma,Ua){this.yBb.tb(ma)&&(this.yBb.K(ma).delayActionsUntilRegistration&&this.qa(this.yBb.K(ma)),this.yBb.K(ma).registeredCallback=Ua)}}Object(f.a)(io,"OfficeSharedCommentsActionHost",null,[1777]);var rl=d(1861),vm=d(83),Lj=d(127),wm=
d(1377),aj=d(12),sl=d(23),yi=d(559),Dk=d(1791),fi=d(67),Dg=d(316),yk=d(50),Ym=d(15),we=d(1046),ri=d(1039),Tj=d(1528),vf=d(207),ff=d(10),Kf=d(32),Rg=d(723),ob=d(422),Nb=d(18),cc=d(2126);class Lc{constructor(ma){this.dZ=ma;this.Jtc=new pa.a;this.T9a=new pa.a;this.K8m();this.c1m=[new cc.a(Kf.a.A4h,Kf.a.rwl),new cc.a(Kf.a.nWd,Kf.a.qwl),new cc.a(Kf.a.s4h,Kf.a.ewl),new cc.a(Kf.a.hWd,Kf.a.dwl),new cc.a(Kf.a.B4h,Kf.a.twl),new cc.a(Kf.a.oWd,Kf.a.swl)]}BZa(ma){this.dZ.BZa(ma);this.gzo(ma)}GZf(ma,Ua){return!!ma&&
!!ma.objectId&&Ua.contains(nb.a.Bf(ma.objectId))}oXa(ma){ma=Object(V.a)(294,ma);return!!ma&&!!ma.objectId}gzo(ma){for(const Ua of this.c1m)ma.classList.remove(Ua.className,Ua.j5c);ma.classList.remove(Kf.a.Mjg,Kf.a.qWd,Kf.a.lpf,Kf.a.pWd,Lc.sPg)}K8m(){const ma=new pa.a,Ua=new pa.a;ma.add(0,null);ma.add(1,Kf.a.nWd);ma.add(2,Kf.a.A4h);ma.add(3,Kf.a.qWd);Ua.add(0,null);Ua.add(1,Kf.a.hWd);Ua.add(2,Kf.a.s4h);Ua.add(3,Kf.a.lpf);this.T9a.W(1,ma);this.T9a.W(2,Ua);this.T9a.W(3,Ua);this.Jtc.add(0,null);this.Jtc.add(1,
Kf.a.oWd);this.Jtc.add(2,Kf.a.B4h);this.Jtc.add(3,Kf.a.pWd)}}Lc.sPg="CommentImportant";Object(f.a)(Lc,"CommentHighlightUtils",null,[]);class Uc{constructor(){this.t0d=0;this.hMb=null}}Object(f.a)(Uc,"CommentGuidsInElementInfo",null,[]);class sd{constructor(){this.aNi=!1;this.dra=this.XWb=null;this.bZa=this.KRb=0}}Object(f.a)(sd,"HighlightInfoForElement",null,[]);class id{constructor(){this.vQi=this.xQi=this.wQi=-1;this.tOi=[];this.Kec=[];this.i7c=this.j7c=-1;this.LVi=!1}}Object(f.a)(id,"HighlightInfoForElementsInPara",
null,[]);class Ld{constructor(){this.vJg=this.Xeg=null}}Object(f.a)(Ld,"OnAnchorMouseOutData",null,[]);var ne=d(1414);class kf{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd){this.ZMe=ma;this.gda=Ua;this.Xm=xb;this.o5=Xb;this.ga=rc;this.Jb=Zc;this.Dj=Hd;this.x3a=this.Cj=null;this.CXn=Xd=>{if(!this.Cj||this.o5.Vde)return!0;if(Xd=Xd.uq){if(this.Cj.eB&&Xd[0].toString()===this.Cj.eB.objectId)return!0;this.x3a&&Xd[0].equals(this.x3a.vJg[0])?this.Jb.wf(this.x3a.Xeg):(this.x3a&&(this.Jb.wf(this.x3a.Xeg),this.ga.Qb(aj.a.rWd,
2,this.x3a.vJg)),this.Cj.Lp.NVi(Xd[0])&&!this.Dj.an||this.ga.Qb(aj.a.opf,2,Xd));this.x3a=null}return!0};this.BXn=Xd=>{if(this.o5.Vde)return!0;const je=Xd.uq;je&&(Xd=new Db.a(2,1,0,()=>{this.ga.Qb(aj.a.rWd,2,je);this.x3a=null}),this.Jb.$b(Xd),this.x3a=Object.assign(new Ld,{Xeg:Xd,vJg:je}));return!0};this.Fjj=Xd=>{const je=new Db.a(2,1,0,()=>{if(this.Cj&&!this.Cj.Lp.$y){var af=Xd.uq;if(!af)af=re.StaticActiveAppFrame.za().tq.currentScope,this.Cj.eB&&(!af||af.name!==vf.AFrame.sR&&af.name!==vf.AFrame.xt)&&
this.Cj.clearSelection();else if(!this.Cj.eB||af.toString()!==this.Cj.eB.objectId)if(af=this.Cj.Lp.G2(af.toString()))af=Object.assign(new wm.a,{commentId:af.id,i4:!1,qca:1}),this.ga.Qb(Nb.a.selectComment,2,af)}});this.Jb.$b(je);return!1};Jd.execute(Xd=>{this.Cj=Xd})}wXh(ma,Ua,xb,Xb){const rc=new id,Zc=[],Hd=this.gda.oXa(Ua)?Ua.objectId:null;for(let je=0,af=ma.length;je<af;je++){var Jd=ma[je],Xd=ne.g(Jd);const Wf=ne.d(Jd);Jd=new ql.a;const Mg=new sd;if(Xd){const bi=new ob.a(ne.c);Xd=this.Cni(Xd,Hd,
bi);0<Xd.length&&(this.ayp(Xd,xb,Jd,Mg,Hd,Xb),Zc.push(Object.assign(new Uc,{t0d:je,hMb:bi})))}Wf&&(Xd=this.Cni(Wf,Hd),0<Xd.length&&(this.cyp(Xd,xb,Jd,Mg,rc,Hd,Xb,je),this.twp(Zc,Xd,je,Mg)));0<xb.count&&this.dyp(Ua,xb,Mg,Xb);this.rwp(Zc,Mg);rc.tOi.push(Mg)}return rc}QSh(ma,Ua,xb){let Xb=!1;for(let rc=0,Zc=ma.length;rc<Zc;rc++){const Hd=ma[rc],Jd=Ua.tOi[rc],Xd=Rg.a(Hd);if(1!==Xd&&2!==Xd&&3!==Xd)continue;const je=3===Xd||2===Xd&&-1!==Hd.className.indexOf(Kf.a.mWa);this.gda.BZa(Hd);this.UYk(Hd,Jd,je,
Xb);this.iXk(Hd,rc,Xd,Jd,Ua,xb);this.jXk(Hd,rc,Ua,Jd);Xb=je}}Cni(ma,Ua,xb=null){const Xb=[];for(let rc=0;rc<ma.length;rc++)this.ZMe.VRj(ma[rc],ma[rc].toString()===Ua)&&(Xb.push(ma[rc]),xb&&xb.add(ma[rc]));return Xb}ayp(ma,Ua,xb,Xb,rc,Zc){var Hd;let Jd=!1,Xd=!1;for(const af of ma){Ua.add(af);xb.add(af);var je=af.toString();je===rc?(je=Zc?1:2,Xb.bZa=je,Xb.KRb=je):this.GZf(this.Cj.eB,Ua)&&(je===(null===(Hd=this.Cj.eB)||void 0===Hd?void 0:Hd.objectId)&&(Xd=!0),Jd=!0)}0<ma.length&&!Xb.bZa&&(Xb.bZa=Xd?
1:3,Xb.KRb=Jd?1:3)}cyp(ma,Ua,xb,Xb,rc,Zc,Hd,Jd){var Xd,je;const af=new ob.a(ne.c);Hd=Hd?1:2;let Wf=!1;for(const Mg of ma){const bi=Mg.toString();Ua.contains(Mg)||(bi===Zc?rc.vQi=Jd:(rc.wQi=Jd,Xb.bZa=3,(null===(Xd=this.Cj.eB)||void 0===Xd?void 0:Xd.objectId)===bi&&(rc.xQi=Jd,Xb.bZa=1)),af.add(Mg));bi===(null===(je=this.Cj.eB)||void 0===je?void 0:je.objectId)&&(Wf=!0);Ua.remove(Mg);xb.contains(Mg)&&this.byp(Xb,Mg,bi,Zc,Hd);bi===Zc&&(Xb.bZa=Hd)}0<ma.length&&!Xb.bZa&&(Xb.bZa=Wf?1:3);0<af.count&&rc.Kec.push(Object.assign(new Uc,
{t0d:Jd,hMb:af}))}twp(ma,Ua,xb,Xb){0!==ma.length&&(Ua.forEach(rc=>{for(let Zc=ma.length-1;0<=Zc;Zc--){const Hd=ma[Zc];if(Hd.hMb.contains(rc)){Hd.t0d===xb&&(Xb.dra?Xb.dra.push(rc):Xb.dra=[rc]);Hd.hMb.remove(rc);break}}}),ma=ma.filter(rc=>0<rc.hMb.count))}dyp(ma,Ua,xb,Xb){var rc,Zc;this.GZf(ma,Ua)?xb.KRb=Xb?1:2:xb.KRb||(xb.KRb=null!=(null===(rc=this.Cj.eB)||void 0===rc?void 0:rc.objectId)&&Ua.contains(nb.a.Bf(null===(Zc=this.Cj.eB)||void 0===Zc?void 0:Zc.objectId))?1:3);xb.XWb||(xb.XWb=[]);for(const Hd of Ua)xb.XWb.push(Hd)}rwp(ma,
Ua){if(0<ma.length){Ua.dra||(Ua.dra=[]);for(const xb of ma[ma.length-1].hMb)Ua.dra.push(xb)}}byp(ma,Ua,xb,Xb,rc){ma.aNi=!0;ma.XWb||(ma.XWb=[]);ma.XWb.push(Ua);xb===Xb&&(ma.KRb=rc)}GZf(ma,Ua){return!!ma&&!!ma.objectId&&Ua.contains(nb.a.Bf(ma.objectId))}UYk(ma,Ua,xb,Xb){!Ua.bZa||xb||Xb||((xb=this.gda.Jtc.K(Ua.bZa))&&ma.classList.add(xb),Ua.aNi&&ma.classList.add(Kf.a.Mjg))}iXk(ma,Ua,xb,Xb,rc,Zc){Xb=this.gda.T9a.K(xb).K(Xb.KRb);Ua<rc.vQi?Xb=Zc?this.gda.T9a.K(xb).K(1):this.gda.T9a.K(xb).K(2):Ua<rc.wQi&&
!Xb&&(Xb=Ua<rc.xQi?this.gda.T9a.K(xb).K(1):this.gda.T9a.K(xb).K(3));Xb&&(Ua=rc.LVi,ma.classList.add(Xb),Ua&&ma.classList.add(Lc.sPg))}jXk(ma,Ua,xb,Xb){Xb.dra||(Xb.dra=this.Jmm(Ua,xb)||Xb.XWb);Ua=null;Xb.dra&&0<Xb.dra.length&&(this.Xm.ub(ff.a.x3,ma,this.CXn,Xb.dra),this.Xm.ub(ff.a.kCa,ma,this.BXn,Xb.dra),Ua=Xb.dra[0]);this.Xm.ub(ff.a.click,ma,this.Fjj,Ua);this.Xm.ub(ff.a.hM,ma,this.Fjj,Ua)}Jmm(ma,Ua){for(;0<Ua.Kec.length&&Ua.Kec[0].t0d===ma;)Ua.Kec.splice(0,1);if(0<Ua.Kec.length){ma=[];for(const xb of Ua.Kec[0].hMb)ma.push(xb);
return ma}return null}}Object(f.a)(kf,"AllMarkupModeHighlightChangeHandler",null,[286]);var vg=d(1381);class Sh extends vg.a{constructor(ma){super(100,25);this.XCc=new pa.a(0);this.ank=6E4;this.gbm=()=>{const Ua=this.XCc.keys;if(Ua.length){var xb="";for(let Xb=0;Xb<Ua.length;Xb++)xb+=Ua.K(Xb)+":"+this.XCc.K(Ua.K(Xb))+";";this.Aua(xb);this.XCc=new pa.a(0)}};this.IBb=new N.a;this.IBb.add(1);this.IBb.add(6);this.IBb.add(2);this.IBb.add(4);this.IBb.add(10);this.IBb.add(11);this.fj=ma;ma.fpg&&window.setInterval(this.gbm,
this.ank)}cNa(ma){this.fj.msp&&this.fj.fpg&&(this.IBb.contains(ma)?this.Xpo(ma):this.Aua(ma+""))}Xpo(ma){this.XCc.W(ma,this.XCc.P2(ma,0)+1)}}Object(f.a)(Sh,"CommentActionInTypingRecorder",vg.a,[301]);var Ei=d(1582),pj=d(219);class Ed{static tAo(ma){ma&&ma.atmention&&delete ma.atmention.isCurrentUser;return ma}}Object(f.a)(Ed,"DeltaFormatHelpers",null,[]);class ni{constructor(){this.optional=this.attributes=null}}Object(f.a)(ni,"Operation",null,[]);class Ee extends ni{constructor(){super();this.insert=
null}}Object(f.a)(Ee,"DeltaOperation",ni,[]);class hh{constructor(){this.ops=null}}Object(f.a)(hh,"Delta",null,[]);var Mj=d(168),Bj=d(148),Zl=d(52),kj=d(78),Ci=d(102),Ek=d(510),zi=d(59),Sg=d(1162),km=d(1580),Je=d(1815);class Mc extends km.ACommentFormatTranslator{constructor(ma,Ua,xb){super(ma,xb);this.xe=Ua}qHg(ma){const Ua=new Ei.a;for(let xb=0;xb<ma.length;xb++){const Xb=ma[xb];Xb.TSb=!0;this.p7k(Ua,Xb);Ua.Ola("\n")}return[Ua.xjc()]}amp(ma,Ua){ma=Ei.a.Jqb(ma[0]);ma=this.Duj(ma);const xb=new N.a;
let Xb=0,rc=null,Zc=null;for(;Xb<ma.ops.length;){const Hd=ma.ops[Xb];rc||(rc=Sg.a.instance.createInstance(zi.a.paragraphNode),rc.TSb=!0,rc.Wg(Ta.a.ed,pj.a.wD()),Ua(rc),rc.ra.clear(),rc.bva(""));"\n"===Hd.insert?(Zc=this.x4f(rc,Zc),this.D0o(rc),xb.add(rc),rc=null):Zc=this.FCn(rc,Hd,Zc);Xb++}return xb.toArray()}Ulp(ma,Ua){ma=Ei.a.Jqb(ma[0]);ma=this.Duj(ma);return Je.a.aEl(ma,Ua)}D0o(ma){const Ua=ma.kZh();for(let xb=0;xb<Ua;xb++)ma.qe.Iq.W(xb,Mc.IRn),ma.qe.It.W(xb,Mc.Nag)}x4f(ma,Ua){var xb=ma.Q0d();
xb.cp===ma.characterData.length?xb.ni=!0:(xb=Object.assign(new Mj.a(ma,ma.characterData.length),{ni:!0}),ma.ra.add(xb));xb=ma.ra.last;if(Ua){Ua=!!Ua.Jw;const Xb=this.U5h(ma,xb,!Ua,Ua,null);xb.formatting=Xb;Ua&&(ma=this.S5h(ma,xb),xb.nX=ma.Hk);xb.wn=!0;Ua=null}xb.cp||xb.formatting||(xb.formatting=new Bj.a(xb,nb.a.nil));return Ua}FCn(ma,Ua,xb){const Xb=ma.Q0d(),rc=!!Ua.attributes&&!!Ua.attributes.link,Zc=!!Ua.attributes&&!!Ua.attributes.atmention,Hd=this.U5h(ma,Xb,rc,Zc,Ua);Xb.formatting=Hd;xb&&(xb.Jw&&
(xb=this.S5h(ma,Xb),Xb.nX=xb.Hk),Xb.wn=!0,xb=null);if(rc||Zc)this.aCn(Xb,ma,Ua),xb=Xb.hyperlink;ma.bva(ma.characterData+Ua.insert);return xb}S5h(ma,Ua){Ua=new Bj.a(Ua,nb.a.create());let xb=this.sYd();xb.setValue(Ta.a.STb,!0);xb=ma.Hc.JP(xb);Ua.Hk=xb.id;return Ua}U5h(ma,Ua,xb,Xb,rc){Ua=new Bj.a(Ua,nb.a.create());let Zc=Sg.a.instance.createInstance(zi.a.s_a);if(xb||Xb)Zc.setValue(cb.a.tE,!0),Zc.setValue(cb.a.lba,!0),xb&&this.$So(ma,Zc);rc&&rc.attributes&&this.dZo(rc.attributes,Zc);Zc=ma.Hc.JP(Zc);Ua.Hk=
Zc.id;return Ua}$So(ma,Ua){(ma=this.xe.IF(ma))&&(ma=ma.nh(Zl.StyleReader.BBc))&&Ua.setValue(cf.a.Lw,ma.id)}dZo(ma,Ua){this.J_b(ma.weight>=Ei.a.udd,Ua,cb.a.bold,!0);this.J_b(ma.italic,Ua,cb.a.italic,!0);this.J_b(ma.underline,Ua,cb.a.underline,!0);this.J_b(ma.underline,Ua,cb.a.underlineType,xh.a.wAb);this.J_b(ma.strikethrough,Ua,cb.a.strikethrough,!0);if(kj.a.kpc(ma.highlight)){var xb=kj.a.Qrb(ma.highlight);this.J_b(!!ma.highlight,Ua,cb.a.highlight,kj.a.cha(xb))}kj.a.kpc(ma.color)&&(xb=kj.a.Qrb(ma.color),
this.J_b(!!ma.color,Ua,cb.a.fontColor,kj.a.cha(xb)))}J_b(ma,Ua,xb,Xb){ma&&Ua.setValue(xb,Xb)}aCn(ma,Ua,xb){if(xb.attributes&&xb.attributes.atmention){var Xb=Ci.a.oKa(xb.attributes.atmention.email);xb=xb.optional&&xb.optional.atmention&&xb.optional.atmention.contentId?xb.optional.atmention.contentId:Mc.efm(1===xb.attributes.atmention.resolveState);Xb=new Ek.a(ma,Xb,!0,void 0,void 0,void 0,xb);this.CDl(Xb,Ua.Hc);ma.hyperlink=Xb}else Ua=Ci.a.oKa(xb.attributes.link),Xb=this.CGl(ma.paragraph.ra.first),
ma.hyperlink=new Ek.a(ma,Ua,!1,Xb.Hk)}CGl(ma){let Ua=this.oai();Ua=ma.paragraph.Hc.JP(Ua);ma=new Bj.a(ma,nb.a.nil);ma.Hk=Ua.id;return ma}CDl(ma,Ua){var xb=String.format(' HYPERLINK "{0}"',ma.url),Xb=ma.Jw;const rc=this.sYd();rc.setValue(Ta.a.jt,15);rc.setValue(Ta.a.Jw,Xb);rc.setValue(Ta.a.lXa,!0);rc.setValue(Ta.a.C2,xb);ma.uya(Ua.JP(rc).id);Xb=this.sYd();Xb.setValue(Ta.a.jt,47);Xb.setValue(Ta.a.C2,xb);ma.uya(Ua.JP(Xb).id);xb=this.sYd();xb.setValue(Ta.a.jt,16);ma.uya(Ua.JP(xb).id)}oai(){const ma=Sg.a.instance.createInstance(zi.a.s_a);
ma.setValue(cb.a.tE,!0);ma.setValue(cb.a.lba,!0);ma.setValue(cb.a.isHidden,!0);return ma}sYd(){const ma=this.oai();ma.setValue(cb.a.Mca,!0);return ma}Duj(ma){const Ua=new N.a;for(let xb=0;xb<ma.ops.length;xb++){const Xb=ma.ops[xb];Xb.optional=Ed.tAo(Xb.optional);if(-1!==Xb.insert.indexOf("\n")&&"\n"!==Xb.insert){const rc=Xb.insert.split("\n");for(let Zc=0;Zc<rc.length;Zc++)if(xb!==ma.ops.length-1||Zc!==rc.length-1||rc[Zc])Ua.add(Object.assign(new Ee,{insert:rc[Zc],attributes:Xb.attributes,optional:Xb.optional})),
Zc!==rc.length-1&&Ua.add(Object.assign(new Ee,{insert:"\n"}))}else Ua.add(Xb)}return Object.assign(new hh,{ops:Ua.toArray()})}static efm(ma){return km.ACommentFormatTranslator.Dal+qa.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ma?"Z":"")}}Mc.IRn=0;Mc.Nag=0;Object(f.a)(Mc,"CommentDeltaFormatTranslator",km.ACommentFormatTranslator,[]);var Aa=d(1704),jb=d(1530);class lc{get userPrincipalName(){return this.J.jb("UserPrincipalName")}constructor(ma,Ua,xb,Xb,rc){this.rj=ma;this.J=Ua;
this.bI=xb;this.Mg=Xb;this.$P=rc}EF(ma){return this.rj.EF(ma)}ahn(ma){ma=this.rj.EF(ma);return ma?!ma.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}W8c(ma){return this.rj.W8c(ma)}isCurrentUserMentioned(ma){var Ua,xb;ma=this.rj.ymm(ma);for(const Xb of ma){if(!Xb.text||0===Xb.text.length)continue;ma=Ei.a.Jqb(Xb.text[0]);let rc=0;for(;ma.ops&&rc<ma.ops.length;){const Zc=null===(xb=null===(Ua=ma.ops[rc])||void 0===Ua?void 0:Ua.attributes)||void 0===xb?void 0:
xb.atmention;if(Zc&&Zc.email===this.userPrincipalName)return!0;rc++}}return!1}afd(){this.bI.T3("OnContentFilterUpdate")}Vha(){var ma;this.Mg.an&&(null===(ma=this.$P)||void 0===ma?void 0:ma.execute(Ua=>Ua.logActivity("WordWebCommentFilterActivity","CommentFilterFpsIsEnabled")))}}Object(f.a)(lc,"CommentFilterActor",null,[297]);var Nc=d(142),qd=d(2119),Rd=d(906),Me=d(611);class df{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd){this.yi=ma;this.Jb=Ua;this.tk=xb;this.$0a=Xb;this.Dj=rc;this.h1=Zc;this.Hh=Hd;this.IW=
Jd;this.nS=Xd;this.ZDb=null;this.E$e=0;this.dFd=!1;this.BJd=0;this.l2b=this.Dpd=this.Nah=this.VJc=this.KJb=!1;this.TAc=()=>{this.IW.oBg()&&this.Hh.TAc(this.dFd,this.Dgg)};this.Hvb=()=>{this.Hh.rqa.hta()&&(this.Xjd(this.Hh.rqa.Qc),this.Hh.rqa.gvc(this.Hvb))};this.Dgg=()=>{this.ufb();this.IW.Cgg()};this.iEg=()=>{!this.KJb&&this.IW.CAg()&&(this.BJd=this.Hbf.scrollTop,this.KJb=!0,this.$0a.cNa(2))};this.rpg=(je,af)=>{this.KJb&&(je=this.Hbf.scrollTop,je-this.BJd?(this.VJc||af.LFe||this.updatePosition(),
this.VJc||1!==af.LFe||this.ufb(),this.pgf(je),this.IW.Bfg()):this.VJc=this.KJb=!1)};this.Hbf=this.Hh.cia;this.Pma=Me.a.uoe;this.lu=this.Hh.lu;this.Hh.J5h()}get Ade(){return this.IW.S_f()}get Pma(){return this.Hh.Pma}set Pma(ma){this.Hh.Pma=ma}get JTh(){return"1"===this.lu.oH.style.opacity}gRj(ma){this.Dpd||(this.Dpd=!0,this.Hh.Otj(),this.ZDb=ma(this.lu.Kla,this.Hh.bDj,()=>{this.updatePosition()}),this.Hh.j$i(this.ZDb),this.IW.initialize(this.ZDb,this),this.Hh.initialize(this.ZDb,this.IW.Kvb),this.Hh.zAj(),
this.Hh.aRj(),this.Hh.bRj(),this.Hh.fRj(this.IW.Gjf,this.IW.one,this.IW.nne),this.$pg())}hxc(){}nye(){return this.Hh.ZRj()}setInitialActiveContainerId(ma,Ua,xb=null){this.Hh.setInitialActiveContainerId(ma,0,xb)}updatePosition(){if(!this.l2b&&this.Ade&&this.yi.Esa()){var ma=ka.a.Je()-this.E$e<Me.a.C8j;ma||this.dFd||this.ufb(ma)}}Hif(){this.ufb()}ZZa(ma,Ua,xb){this.h1.T3("OnFloatingCommentsVisibilityChange",!0);this.Hh.ZZa(ma,Ua,xb)}$Ia(ma,Ua,xb=!1){this.Hh.$Ia(ma,Ua,()=>{this.yi.H5c()||this.Hh.V$d();
this.IW.Kdg()},xb)}Ybc(ma,Ua,xb){this.Hh.Ybc(ma,Ua,xb,this.Hh.hi,this.IW.N3c,this.IW.tcg)}psj(ma){this.l2b=!0;ma();this.l2b=!1}Tkd(ma,Ua,xb){this.Hh.Tkd(ma,Ua,xb)}yec(){this.Hh.yec()}a9j(){const ma="1"===this.lu.oH.style.opacity;switch(!0){case ma&&!this.yi.H5c():this.Hh.V$d();break;case !ma&&this.yi.H5c():this.Hh.C0b()}}EHg(ma=!0){this.IW.iBg&&this.Hh.o1j(ma)}static Nwi(ma,Ua=null){const xb=new Fa.a;for(const Xb of ma)Xb.Rf||Xb.Dr!==qd.a.bE&&(!Ua||Ua(Xb))&&df.QVk(xb,Xb.objectId,Xb);return xb}static QVk(ma,
Ua,xb){let Xb;({value:Xb}=ma.Ec(Ua,Xb)).returnValue||(Xb=[],ma.W(Ua,Xb));Xb.push(xb)}Xjd(ma){ma&&(ma.g6(()=>{this.TAc()}),this.BJd=this.Hbf.scrollTop,ma.OPh(this.iEg),ma.PPh(this.rpg))}$pg(){this.Hh.hi?this.Xjd(this.Hh.hi):this.Hh.rqa?this.Hh.rqa.rcc(this.Hvb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}pgf(ma){this.lu.oH.style.top=ma-this.BJd+"px";this.VJc=!1}ufb(ma=!1){ma=new Db.a(0,1,0,()=>{this.zxf()},129,void 0,!ma);this.Jb.$b(ma);this.dFd=
!0;this.VJc=this.KJb;this.$0a.cNa(10)}GLf(ma){return this.Hh.hUa({contentAnchorPositions:ma.contentAnchorPositions})}zxf(){this.dFd=!1;if(this.lu.Kla&&this.ZDb&&this.yi.Esa()){this.Hh.e1d();var ma=0;this.tk.le(()=>{ma=this.Hh.C5d()},"FCM:UP:GET");var Ua=null,xb=null;this.tk.le(()=>{const Xb=this.IW.lvi(ma,this.Hh.hi);Ua=Xb.cxl;xb=this.GLf(Xb)},"FCM:UP:GP");this.tk.le(()=>{this.KJb?(this.Hh.Vii(xb),this.KJb=!1):this.ZDb.emitEvent(3,xb);this.h1.vse()},"FCM:UP:RC");this.ZDb.setFirstCommentRenderDone();
"0"===this.lu.oH.style.opacity&&0<Ua.count&&!this.Dj.an&&this.Dj.RNa&&this.tk.le(()=>{this.Hh.C0b()},"FCM:UP:SFC");!this.Nah&&0<Ua.count&&(Hf.a.f6(this.Jb,this.Hh.G$i,rh.a.F$i),this.Nah=!0);this.E$e=ka.a.Je();this.$0a.cNa(6)}else this.E$e=ka.a.Je()}}Object(f.a)(df,"FloatingCommentManager",null,[274,275]);var Cf=d(128),sg=d(1382),lg;(function(ma){ma[ma.Gmq=0]="singleHint";ma[ma.Idq=1]="multiHint";ma[ma.Rjq=2]="resolvedHint";ma[ma.Jdq=3]="multiResolvedHint";ma[ma.entryPoint=4]="entryPoint";ma[ma.unknown=
void 0]="unknown"})(lg||(lg={}));Object(f.b)("CommentIconType",lg);var Ia=d(151),Zb=d(1119);const Qc={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[lg.unknown]:""},ed={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter",
"OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[lg.unknown]:[]},Pd=(ma,Ua)=>{switch(ma){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(Ua){case 3:return Zb.a.H4h;
case 2:return Zb.a.I4h;case 1:return Zb.a.J4h}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(Ua){case 3:return Zb.a.E4h;case 2:return Zb.a.F4h;case 1:return Zb.a.G4h}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(Ua){case 3:return Zb.a.K4h;case 2:return Zb.a.L4h;
case 1:return Zb.a.M4h}}},hb=(ma,Ua)=>{Ia.a("renderIcon")&&appChrome.api.renderIcon(ma,Ua)};class Id{}Id.vOi=16;Id.B2m=1;Id.JTf=20;Id.Gck=2;Object(f.a)(Id,"CommentIconConstants",null,[]);class he{constructor(){this.iWd=0;this.rTc=!1}}Object(f.a)(he,"CommentHintCensus",null,[]);class Cd{constructor(ma,Ua,xb,Xb,rc){this.Obh=ma;this.Ebc=xb;this.Etk=Xb;this.rka=rc;this.XSa=-1;this.YMe=new Set(Ua)}get y(){if(-1!==this.XSa)return this.XSa;const ma=Sys.UI.DomElement.getBounds(this.Obh),Ua=this.Obh.getClientRects();
return this.XSa=0<Ua.length&&Ua[0]?this.Etk?ma.y/this.Ebc+Id.Gck:Math.floor(Ua[0].height)/(2*this.Ebc)+ma.y/this.Ebc-Id.vOi/2:0}get mWd(){return Array.from(this.YMe)}x_k(ma){this.YMe=new Set([...this.YMe,...ma])}}Object(f.a)(Cd,"HintInfo",null,[312]);class Wg extends sg.a{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg,bi){super();this.fj=ma;this.$g=Ua;this.Xm=xb;this.aO=Xb;this.ga=rc;this.yi=je;this.mwa=af;this.$0a=Wf;this.Dj=Mg;this.brk=bi;this.Uxd=new Map;this.yEb=this.kIb=null;this.Tzc={gAb:-1,
ebg:-1}}u_a(ma){let Ua=!1;mb.a.Rbk&&ma.ic.vj?va.a.instance.le(()=>{Ua=ne.n(ma,!0)},"CHA:SCIVE"):va.a.instance.le(()=>{Ua=ne.m(ma.htmlElement,!0)},"CHA:SCI");return Ua}fUa(ma){const Ua=this.zoom,xb=ma.I3,Xb=ma.OKa;let rc=0;for(let Jd=0;Jd<ma.r7.length;Jd++)if(0<ma.r7[Jd].width){rc=Jd;break}const Zc=ma.g6a(1,Id.JTf,Ua,rc);this.$0a.cNa(1);let Hd=[];Xb.forEach((Jd,Xd)=>{const je=ma.r7[Xd].y/Ua;Jd=this.TGl(this.yvm(Jd,Xd),af=>this.DGl(xb,af,af.y-je,Zc),()=>Wg.IIl(xb));Hd=Hd.concat(Jd)});return Hd}TGl(ma,
Ua,xb){xb=xb();const Xb=[];for(const rc of ma){ma=Ua(rc);for(const Hd of rc.mWd)this.Uxd.set(Hd.toString(),ma);const Zc=this.ACi(rc.mWd);this.t7j(Zc,ma);null==xb.rka&&(xb.rka=rc.rka);xb.appendChild(ma);Xb.push(ma)}this.Mlc(this.yEb);this.Wrb(this.kIb);return[xb]}ACi(ma){var Ua,xb;let Xb=0,rc=0;for(const Zc of ma)if(this.yi.RZf(Zc)){if(this.fj.contentFilterApiEnabled&&this.Dj.an&&(ma=this.yi.G2(Zc.toString()),null===(xb=(Ua=this.brk).isContentInFilteredContent)||void 0===xb||!xb.call(Ua,ma.id)))continue;
this.yi.NVi(Zc)?rc+=1:Xb+=1}Ua=new he;Ua.iWd=Xb+rc;Ua.rTc=0===Xb;return Ua}JAc(ma){if(ma=this.Uxd.get(ma.objectId)){var Ua=ne.g(ma);Ua=this.ACi(Ua);this.t7j(Ua,ma)}}t7j(ma,Ua){let xb,Xb;if(this.fj.contentFilterApiEnabled&&0===ma.iWd)Ua.style.display="none";else if(1===ma.iWd?(xb=ma.rTc?2:0,Xb=ma.rTc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ma.iWd&&(xb=ma.rTc?3:1,Xb=ma.rTc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:
WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),Ua.style.display="block",ma=Ua.firstElementChild)this.IVo(ma,xb),ma.title=Xb+". "+ma.title,hb(Qc[xb],ma)}IVo(ma,Ua){ma.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;Cf.a.Cm(ma,Wg.N4h,Ua)}yvm(ma,Ua){ma=this.EGl(ma,Ua);ma.sort((xb,Xb)=>xb.y-Xb.y);return this.gNn(ma)}EGl(ma,Ua){const xb=[],Xb=this.fj.Fr,rc=this.zoom;ma=ne.f(ma,!0);for(let Zc=0,Hd=ma.length;Zc<Hd;Zc++){const Jd=ma[Zc],Xd=ne.g(Jd);Xd&&xb.push(new Cd(Jd,
Xd,rc,Xb,Ua))}return xb}gNn(ma){let Ua=null;const xb=[];for(let Xb=0;Xb<ma.length;Xb++)Ua&&Math.abs(ma[Xb].y-Ua.y)<Id.vOi+Id.B2m?Ua.x_k(ma[Xb].mWd):(Ua=ma[Xb],xb.push(Ua));return xb}DGl(ma,Ua,xb,Xb){const rc=ma.Kh.ownerDocument,Zc=rc.createElement("div");Zc.className=Wg.C4h;Zc.style.top=xb+"px";Zc.style.left=Xb+"px";Zc.style.right="auto";Zc.style.zIndex="40";Cf.a.Cm(Zc,Kf.a.bWc,Ua.mWd);Ua=rc.createElement("span");this.DKg(Ua,Zc);hb(Qc[0],Ua);this.ME(Ua,ma);return Zc}DKg(ma,Ua){ma.title=CommonUIStrings.l_CommentHintTooltip;
ma.setAttribute("role","button");Ua.appendChild(ma)}ME(ma,Ua){this.$g.LI(ff.a.click,ma,this.h_n.bind(this),Ua);this.$g.ub(ff.a.XC,ma,this.k_n.bind(this));this.Xm.ub(ff.a.x3,ma,this.m_n.bind(this));this.Xm.ub(ff.a.MU,ma,this.l_n.bind(this));this.aO.ub(ma,this.j_n.bind(this))}static IIl(ma){ma=ma.Kh.ownerDocument.createElement("div");ma.className=Wg.a8n;return ma}j_n(){return!0}k_n(){return!0}h_n(ma){const Ua=ne.g(ma.GB.parentNode);ma.eventName===ff.a.hM&&(this.mwa.Vnf(),this.B2h());this.ga.Qb(aj.a.D4h,
2,Ua);return!0}m_n(ma){this.cKa(this.yEb)!==ma.GB&&(ma=ne.g(ma.GB.parentNode),this.ga.Qb(aj.a.opf,2,ma));return!0}l_n(){this.ga.Ob(aj.a.rWd,2);return!0}Mlc(ma){this.B2h();this.yEb=ma;this.o8k()}o8k(){this.p8k(this.cKa(this.yEb),this.cKa(this.kIb))}Wrb(ma){this.Trl();this.kIb=ma;if(ma=this.cKa(this.kIb)){const Ua=this.q6d(ma);this.$we(ma,Ua,1)}}cKa(ma){if(!ma)return null;let Ua=null;if(ma=this.yi.G2(ma))if(ma=ma.Rf?this.yi.EF(ma.Rf):ma)Ua=ma.objectId;return Ua&&this.Uxd.has(Ua)?this.Uxd.get(Ua).firstChild:
null}B2h(){this.Wrl(this.cKa(this.yEb),this.cKa(this.kIb))}Wrl(ma,Ua){if(ma){const xb=this.q6d(ma);this.$we(ma,xb,ma===Ua?1:3);this.yEb=null}}p8k(ma,Ua){ma&&(ma.title=0<this.Tzc.ebg&&1<this.Tzc.gAb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Tzc.ebg,this.Tzc.gAb):CommonUIStrings.l_CommentHintTooltip,Ua!==ma&&(Ua=this.q6d(ma),this.$we(ma,Ua,2)))}Trl(){const ma=this.cKa(this.yEb),Ua=this.cKa(this.kIb);if(Ua){const xb=this.q6d(Ua);this.$we(Ua,xb,ma===
Ua?2:3);this.kIb=null}}$we(ma,Ua,xb){this.Eln()?this.yVo(ma,xb):this.xXo(ma,Ua,xb)}yVo(ma,Ua){ma=null===ma||void 0===ma?void 0:ma.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ma||void 0===ma?void 0:ma.length)&&(ma[0].style.fill=2===Ua||1===Ua?"Highlight":"ButtonText")}xXo(ma,Ua,xb){Ua=ed[Ua];for(let rc=0;rc<Ua.length;rc++){var Xb=Ua[rc];const Zc=Pd(Xb,xb);if(!this.Zhn(Zc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Zc}.`);break}Xb=null===ma||void 0===
ma?void 0:ma.querySelectorAll("."+Xb);0<(null===Xb||void 0===Xb?void 0:Xb.length)&&(Xb[0].style.fill=`var(${Zc})`)}}Eln(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}q6d(ma){return Cf.a.Eb(ma,Wg.N4h)}Zhn(ma){var Ua;const xb=document.getElementById(fi.a.yZc);return!(null===(Ua=null===xb||void 0===xb?void 0:xb.style)||void 0===Ua||!Ua.getPropertyValue(ma))}}Wg.C4h="clip16x16 HintContainer";Wg.a8n="OutlineElementHintMargin";Wg.N4h="CommentIconType";
Object(f.a)(Wg,"CommentHintActor",sg.a,[292]);var cd=d(1E3);class If extends cd.a{get iBg(){return this.T2()}get Fxf(){return this.OKp.AGi()}constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af){super();this.Mg=ma;this.Vt=Ua;this.rj=xb;this.Zi=Xb;this.jQd=rc;this.bI=Zc;this.Hh=Hd;this.getSelectedText=Jd;this.OKp=Xd;this.focusManager=je;this.znb=af;this.Led=()=>{};this.eme=()=>{};this.h9g=!1;this.Qnl={[0]:()=>this.Tdi(),[1]:()=>this.Zxc.Hif(),[2]:()=>this.Tdi()};this.Cgg=()=>{this.jQd.cNa(11)};this.Gjf=Wf=>
{for(const Mg of ne.u)Wf.bindAction(Nc.KeyInputManager.Vw(Mg),Nb.a.Ilf)};this.one=()=>{this.eme()};this.nne=(Wf,Mg)=>{if(Wf.name!==vf.AFrame.xt&&Mg){var bi=this.rj.iu?this.rj.iu.id:"";this.Mg.wWb||(this.Mg.wWb=Hf.a.f6(this.Zi,()=>{this.Led(bi)}))}};this.Xnj=()=>{};this.Kvb=()=>{this.PTj()};this.tcg=(Wf,Mg)=>{0===Mg&&(this.bI.vse(),this.jQd.cNa(0))};this.Kdg=()=>{this.jQd.cNa(5)};this.N3c=Wf=>{let Mg=0;const bi=this.rj.xR();for(let zh=0;zh<bi.length;zh++){if(bi[zh].Rf||bi[zh].done)continue;if((bi[zh].Dr===
qd.a.bE?bi[zh].GA.draftId:bi[zh].id)===Wf.contentId)break;const Ah=this.ry.getContentAnchorPosition(bi[zh].id);!Ah||4<Math.abs(Wf.anchorTop-Ah.anchorTop)||Mg++}return Mg};this.Lij=()=>{this.bI.vse()};this.Bfg=()=>{this.jQd.cNa(2)};this.PTj=()=>{if(!this.h9g&&this.Hh.cia){const Wf=this.Hh.cia.getElementsByClassName(Wg.C4h);for(let Mg=0;Mg<Wf.length;Mg++)Wf[Mg].style.opacity="1";this.h9g=!0}}}initialize(ma,Ua){this.ry=ma;this.Zxc=Ua;this.Yjd();this.Vt.ribbonCommentFilteringEnabled&&this.rwo();this.two()}WUo(ma,
Ua){this.eme=ma;this.Led=Ua}uvi(ma,Ua){return{G5a:this.jnm(ma,Ua),containerContentByType:{}}}lvi(ma,Ua){const xb=df.Nwi(this.rj.xR(),this.rj.Zsa),Xb=[],rc=ne.e(!0);var Zc=this.rj.xR();Ua=this.tio(Ua,Zc,xb);!Ua.Zkg&&Ua.contentAnchorPosition&&(Xb.push(Ua.contentAnchorPosition),Ua.contentAnchorPosition=null);for(Zc=0;Zc<rc.length;Zc++){const Hd=rc[Zc],Jd=ne.g(Hd);if(Jd)for(let Xd=0;Xd<Jd.length;Xd++){const je=this.getContentAnchorPosition(ma,xb,Hd,Jd[Xd]);je&&(Xb.push(je),Ua.Zkg&&Ua.contentAnchorPosition&&
je.contentId===Ua.Zkg.id&&(Xb.push(Ua.contentAnchorPosition),Ua.contentAnchorPosition=null))}}Ua.contentAnchorPosition&&Xb.splice(0,0,Ua.contentAnchorPosition);return{cxl:xb,contentAnchorPositions:Xb}}S_f(){var ma;return!(null===(ma=this.ry)||void 0===ma||!ma.getAreContainersEnabled())}T2(){return this.rj.Esa()}CAg(){return this.T2()}epd(){return this.T2()}oBg(){return this.ry&&this.Hh.cia&&this.T2()}Amp(){this.bI.T3("OnFloatingCommentsVisibilityChange",this.Mg.RNa);if(this.Mg.RNa)this.Hh.C0b();else{const ma=
this.rj.MJ;ma.eB&&ma.clearSelection();this.Hh.V$d()}}Lnj(ma){0!==ma&&this.Led(this.rj.iu?this.rj.iu.id:"")}getContentAnchorPosition(ma,Ua,xb,Xb){let rc=null;return({value:rc}=Ua.Ec(Xb.toString(),rc)).returnValue?(Ua=rc[0])&&!Ua.Rf?{...(new Rd.a),anchorTop:(Me.a.L2c(xb)-ma)/this.Hh.Oea,anchorLeft:0,containerContentType:0,contentId:Ua.id}:null:null}tio(ma,Ua,xb){var Xb,rc;const Zc={};"CREATE"===(null===(rc=null===(Xb=this.rj.$y)||void 0===Xb?void 0:Xb.GA)||void 0===rc?void 0:rc.sessionType)&&(Xb=this.Hh.cia.querySelectorAll(ne.b),
ma=this.Hh.Osi((0<Xb.length?Xb[0]:null)||this.getSelectedText(),this.rj.$y.GA.draftId,0,ma),Zc.Zkg=this.gFm(Ua,xb),Zc.contentAnchorPosition=ma);return Zc}gFm(ma,Ua){var xb=Array.indexOf(ma,this.rj.$y);for(--xb;-1<xb;xb--)if(Ua.tb(ma[xb].objectId))return ma[xb]}jnm(ma,Ua){return this.lvi(ma,Ua).contentAnchorPositions}Yjd(){this.bI.V3("OnAfterTrackChangeMarkupViewChange",(ma,Ua)=>{if(Ua)this.Qnl[Ua.Gk]()})}two(){this.bI.V3("OnFloatingCommentsToggle",this.Amp.bind(this))}Tdi(){const ma=ne.i();if(0!==
ma.length){var Ua=df.Nwi(this.rj.xR()),xb=this.rj.MJ;for(let Xb=0;Xb<ma.length;Xb++){const rc=ne.g(ma[Xb]);for(let Zc=0;Zc<rc.length;Zc++){let Hd;({value:Hd}=Ua.Ec(rc[Zc].toString(),Hd)).returnValue&&(Hd.forEach(Jd=>{var Xd;Jd&&!Jd.Rf&&(this.Zxc.$Ia(Jd.id,0,!1),(null===(Xd=xb.eB)||void 0===Xd?void 0:Xd.id)===Jd.id&&xb.clearSelection())}),this.focusManager.Gg(vf.AFrame.Do))}}}}rwo(){this.bI.V3("OnContentFilterUpdate",this.pZn.bind(this))}pZn(){var ma;let Ua=[],xb=[];null===(ma=this.znb)||void 0===
ma?void 0:ma.getAllContent().forEach(Xb=>{this.znb.isContentInFilteredContent(null===Xb||void 0===Xb?void 0:Xb.contentId)?Ua.push(Xb):xb.push(Xb)});this.Hh.Q7l(Ua,xb)}}Object(f.a)(If,"CommentFloatingContainerActor",cd.a,[298]);var Rf=d(1384),ih=d(2127),mh=d(197);class Wk extends Rf.a{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd){super();this.HDk=ma;this.Zgb=Ua;this.ZMe=xb;this.tk=rc;this.gda=Jd;this.h1=Xd;this.Cj=null;this.Gk=1;Xb.execute(je=>{this.Cj=je});this.x5=[];this.VEc=new mh.ScriptSharpLegacyMap;
this.euo(Zc,Hd);this.Yjd()}get Tj(){return this.HDk.value}get kwl(){return this.Zgb}get Afa(){return!!this.Cj}get Xrb(){return 0}get U9a(){return this.x5}get clh(){return this.VEc.tb(this.Gk)?this.VEc.K(this.Gk):this.VEc.K(0)}oXa(ma){return this.gda.oXa(ma)}p9a(ma,Ua){if(ma=Object(V.a)(294,ma))for(const xb of this.Lio(ma))Ua.add(xb)}wMa(ma,Ua){this.Afa&&this.tk.le(()=>{this.C1n(ma,Ua)},"CHA:OPHC")}C1n(ma,Ua){if(this.Cj.Lp.Esa()){var xb=this.vs.OIa,Xb=new Cb.a(new zf.a),rc=Ua.WMa("*"),Zc=this.Nmm(xb),
Hd=!!xb&&!xb.action||!!Zc&&Zc===this.Cj.eB,Jd;this.tk.le(()=>{this.ZMe.eDm(ma.id,Xb,null===Zc||void 0===Zc?void 0:Zc.objectId)},"OPHC:GOI");this.tk.le(()=>{Jd=this.clh.wXh(rc,Zc,Xb,Hd);Jd.LVi=this.JVi(xb)&&0===xb.action},"OPHC:BHI");this.tk.le(()=>{this.clh.QSh(rc,Jd,Hd)},"OPHC:AH")}}Nmm(ma){let Ua=null;!this.JVi(ma)||0!==ma.action&&2!==ma.action||(Ua=this.vs.OIa.$B);return Ua||this.Cj.eB}Lio(ma){if(!ma)return[];ma=this.Tj.Eb(nb.a.Bf(ma.objectId));return this.kwl.C7d(ma,null)}ABj(){return!1}vH(ma,
Ua,xb){this.Afa&&(ma=Object.assign(new ih.a,{action:ma,type:0,$B:Ua,VL:xb}),this.vs.vH(ma))}Vnf(){this.Afa&&(this.vH(3,this.Cj.Xlc,this.Cj.Xlc),this.Cj.Xlc=null)}euo(ma,Ua){this.VEc.add(1,ma);this.VEc.add(0,Ua)}Yjd(){this.h1.V3("OnBeforeTrackChangeMarkupViewChange",(ma,Ua)=>{Ua&&Ua.Lag!==this.Gk&&(this.Gk=Ua.Lag)})}JVi(ma){return ma&&0===ma.type}}Object(f.a)(Wk,"CommentHighlightActor",Rf.a,[295,296]);var na=d(1028),db=d(337),Ob=d(524),Sb=d(1428);class qc{constructor(ma,Ua){this.Qwl=ma;this.ncg=Ua}}
Object(f.a)(qc,"CommentEndParaIdBeforeChangeInfo",null,[]);var Ic=d(1583);class xc{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd){this.G2f=ma;this.Mg=Ua;this.rj=xb;this.bI=Xb;this.Pq=rc;this.ml=Zc;this.owl=Hd;this.Vt=Jd;this.uCb=null;this.zio=()=>{if(!this.rj.Esa()){var Xd=ne.l();[Kf.a.lpf].forEach(je=>{this.vsl(Xd,je)})}};this.uio=(Xd,je)=>{(Xd=je.ZK)&&!ne.t(Xd)&&(je=this.rj.ZGf(Xd),nb.a.hw(je.eqd,je.h_c)||this.P6j(je,Xd)||this.g1h(je.mIa,je.UTa,Xd)||this.PKg(Xd))};this.rWn=(Xd,je)=>{je.property===Ta.a.Wza&&
(Xd=ne.h(je.node,nb.a.nil),this.uCb=new qc(je.node.id,Xd))};this.EXn=(Xd,je)=>{Xd=je.node;if(je.property===Ta.a.Wza&&Xd){var af=ne.k(Xd,nb.a.nil);je=ne.h(Xd,nb.a.nil);var Wf=this.uCb?this.ud.Eb(this.uCb.ncg):null;!ne.t(Xd)&&af&&!af.equals(je)&&this.uCb&&Xd.id.equals(this.uCb.Qwl)&&!af.equals(this.uCb.ncg)&&Wf&&Wf.isConnected&&this.cef(this.uCb.ncg,Xd.id);je&&this.Mg.kz.tb(je)&&(af=this.Mg.kz.K(je),af.P9a&&(a.ULS.shipAssertTag(572835481,327,!!af.wP,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),
af.wP&&af.wP.contains(Xd.id)&&(af.wP.remove(Xd.id),af.wP.count||(af.P9a=!1),this.Mg.PX.tb(Xd.id)?this.Mg.PX.K(Xd.id).remove(je):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.sfd=(Xd,je)=>{Xd=je.node.id;this.Mg.kz.tb(Xd)&&this.zAo(Xd)};this.bWn=(Xd,je)=>{je&&je.node&&this.r1a.tb(je.node)&&(Xd=this.r1a.K(je.node).toe,this.r1a.tb(Xd)||(Xd=this.r1a.K(je.node),this.g1h(Xd.duf?Xd.currentNode:Xd.toe,Xd.duf?Xd.toe:Xd.currentNode,Xd.ZK)||this.PKg(Xd.ZK)),
this.r1a.remove(je.node))};this.HXn=(Xd,je)=>{const af=Xd.pk;if(!je&&this.kkb.tb(af)){var Wf;(Wf=this.kkb).W(af,Wf.K(af)&(Xd.Wc?-2:-3));this.kkb.K(af)||(this.PKg(this.ud.Eb(af)),this.kkb.remove(af))}};this.r1a=new Ob.a(new na.a);this.kkb=new Bb.a(ne.c);this.bI.V3("OnCommentNodeAdded",this.uio);this.bI.V3("OnCommentNodeDeleted",this.zio);this.Vt.contentFilterApiEnabled?(this.bI.V3("OnCommentPaneOpen",this.ydn.bind(this)),this.bI.V3("OnCommentPaneClose",this.xdn.bind(this)),this.bI.V3("OnContentFilterUpdate",
this.afd.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Xd=>{this.bI.V3(Xd,this.vdn.bind(this))});this.bI.V3("OnFloatingCommentsVisibilityChange",this.wdn.bind(this));ma=this.Pq.qf(12);ma.ly(this.sfd);ma.ut(this.bWn);this.Pq.qf(40).zSc(this.rWn);this.Pq.qf(40).Qo(this.EXn);db.a.yZa(this.HXn)}get nv(){return this.G2f.value}get ud(){return this.nv.ud}eDm(ma,Ua,xb){if(this.j$n(ma))for(const Xb of this.Mg.kz.K(ma).wP)!this.VRj(Xb,xb===Xb.toString())||Ua.add(Xb)}VRj(ma,Ua){const xb=this.ud.Eb(ma),
Xb=ne.t(xb);if(!xb||Xb)return!1;ma=this.rj.G2(ma.toString());return!ma||this.Vt.contentFilterApiEnabled&&this.Mg.an&&!this.owl.isContentInFilteredContent(ma.id)||!this.Mg.an&&!this.rj.Zsa(ma)&&!Ua?!1:!0}j$n(ma){return this.O9n(ma)}vsl(ma,Ua){ma=ma.querySelectorAll(`.${Ua}`);if(0!==ma.length)for(let xb=0;xb<ma.length;xb++)ma[xb].classList.remove(Ua)}PKg(ma){if(ma){var Ua=Sb.a.C7d(ma,null),xb=new Qb.a;for(let Xb=1;Xb<Ua.length-1;Xb++)this.cef(Ua[Xb].id,ma.id),xb.add(Ua[Xb]);Rg.b(xb)}}wdn(){const ma=
new Qb.a;for(const Ua of this.rj.xR())!Ua.Rf&&Ua.Dr!==qd.a.bE&&this.rj.Zsa(Ua)&&this.rj.GEe(Ua,ma);Rg.b(ma)}O9n(ma){if(!this.Mg.IX)return!1;let Ua=null;if(({value:Ua}=this.Mg.kz.Ec(ma,Ua)).returnValue)return Ua.P9a;let xb=!1;this.ml.le(()=>{const Xb=ne.e();for(let rc=0;rc<Xb.length;rc++)xb=this.Gzp(Xb[rc],ma,xb);xb||(this.Mg.kz.add(ma,new Ic.a),this.Mg.kz.K(ma).P9a=!1)},"CHORA:PHOC");return xb}Gzp(ma,Ua,xb){ma=ne.g(ma);if(!ma)return xb;for(let Xb=0;Xb<ma.length;Xb++){const rc=this.ud.Eb(ma[Xb]);rc&&
!ne.t(rc)&&(xb=xb||this.tol(rc,Ua))}return xb}tol(ma,Ua){var xb=this.rj.ZGf(ma);if(this.P6j(xb,ma))return!1;var Xb=xb.eqd;const rc=xb.h_c;xb=xb.mIa;if(Xb!==nb.a.nil&&(Xb.equals(rc)||Xb.equals(Ua)))return!1;for(Xb=Mb.ParagraphReader.pg(xb,!1);Xb&&!Xb.id.equals(rc);){if(Xb.id.equals(Ua))return this.cef(Ua,ma.id),!0;Xb=Mb.ParagraphReader.pg(Xb,!1)}return!1}cef(ma,Ua){this.Mg.PX.tb(Ua)||this.Mg.PX.add(Ua,new Cb.a(new zf.a));this.Mg.PX.K(Ua).add(ma);this.Mg.kz.tb(ma)?this.Mg.kz.K(ma).wP||(this.Mg.kz.K(ma).wP=
new Cb.a(new zf.a)):this.Mg.kz.add(ma,new Ic.a(!0));this.Mg.kz.K(ma).P9a=!0;this.Mg.kz.K(ma).wP.add(Ua)}zAo(ma){if(this.Mg.kz.K(ma).wP)for(const Ua of this.Mg.kz.K(ma).wP)this.Mg.PX.tb(Ua)?this.Mg.PX.K(Ua).remove(ma):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Mg.kz.remove(ma)}vdn(){const ma=new Qb.a;for(const Ua of this.rj.xR())Ua.Rf||Ua.Dr===qd.a.bE||this.rj.Zsa(Ua)||this.rj.GEe(Ua,ma);Rg.b(ma)}ydn(){this.MVf("OnCommentPaneOpen")}afd(){this.MVf("OnContentFilterUpdate")}xdn(){this.MVf("OnCommentPaneClose")}MVf(ma){const Ua=
new Qb.a;for(const xb of this.rj.xR())xb.Rf||xb.Dr===qd.a.bE||this.rj.MJ.SZh(ma,xb)||this.rj.GEe(xb,Ua);Rg.b(Ua)}P6j(ma,Ua){let xb=!1;if(!ma.nAe||!ma.H0d){xb=!0;if(!ma.mIa||!ma.UTa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ma.mIa,!ma.UTa),!0;ma.nAe||this.r1a.tb(ma.mIa)||this.r1a.add(ma.mIa,{ZK:Ua,currentNode:ma.mIa,toe:ma.UTa,duf:!0});ma.H0d||this.r1a.tb(ma.UTa)||this.r1a.add(ma.UTa,{ZK:Ua,currentNode:ma.UTa,toe:ma.mIa,duf:!1})}return xb}g1h(ma,Ua,
xb){ma=Sb.a.qAa(ma,xb.id,!0);Ua=Sb.a.qAa(Ua,xb.id,!1);let Xb;ma||({value:Xb}=this.kkb.Ec(xb.id,Xb),this.kkb.W(xb.id,Xb&1));Ua||({value:Xb}=this.kkb.Ec(xb.id,Xb),this.kkb.W(xb.id,Xb&2));return!ma||!Ua}}Object(f.a)(xc,"CommentHighlightOnRestActor",null,[293]);var vb=d(557),Qd=d(452),Ze=d(546);class Be{constructor(ma,Ua){this.IJb=ma;this.Uoa=Ua}getViewContainer(){return this.IJb}registerForViewContainerEvents(ma){this.Uoa.Txo(ma)}unregisterForViewContainerEvents(ma){this.Uoa.uup(ma)}}Object(f.a)(Be,
"ViewContainerProvider",null,[1721]);class Ve{constructor(ma,Ua,xb,Xb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ma;this.appLocale=Ua;this.uiCulture=xb;this.dataCulture=Xb}}Object(f.a)(Ve,"LocalizationDetails",null,[]);var Pe=d(1121),Lf=d(1449),pe=d(497);class Zh{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg,bi,zh,Ah,Zi,sk,gm,Gj,En,Rm,Si,rp,Ji,Fn,ml,jn,Gn,gl,rj){this.Cr=ma;this.rj=Ua;this.iMb=xb;this.k2=Xb;this.Vt=rc;this.Mg=Zc;this.m3d=Hd;this.Nlc=
Jd;this.Ap=Xd;this.Pb=je;this.dynamicScriptLoader=af;this.KJo=Wf;this.focusManager=Mg;this.zWd=bi;this.yWd=zh;this.$cf=Ah;this.JFp=Zi;this.$P=sk;this.bI=gm;this.tLo=Gj;this.l5l=En;this.jij=Rm;this.KFp=Si;this.I6a=rp;this.IW=Ji;this.Hh=Fn;this.nS=ml;this.Oqf=jn;this.ecb=Gn;this.tWd=gl;this.rAl=rj;this.CDd=this.uxa=null;this.zmh=!1;this.y1e=[];this.xCh=this.Amh=!1;this.initialize=(tk,fp)=>{this.G7m(fp)};this.zNl=tk=>kj.a.sXd(tk);this.IXn=()=>{this.uRi()};this.ttm=(tk,fp,mj)=>{tk={...(new Pe.a),containerPanel:tk,
paneOpenedCallback:fp,paneClosedCallback:mj,ulsLogger:new vb.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.Hh.NHf(),destroyAllContainersCallback:()=>{this.Mg.an||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Vt.n3d,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.Vt.trackChangeInSidetrackEnabled,
improveJumpingFixEnabled:!1,shouldInitialize:!this.Vt.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Vt.contentNavigationApiEnabled,contentFilterApiEnabled:this.Vt.contentFilterApiEnabled,returnToDraftFixEnabled:!0,ribbonCommentFilteringEnabled:this.Vt.ribbonCommentFilteringEnabled}};this.Vt.contentNavigationApiEnabled&&(tk.sidetrackContentNavigationApi=this.Oqf,tk.featureGateApiSettings=this.IW.Fxf,tk.telemetryDetails=this.jij,this.Vt.contentFilterApiEnabled&&
(tk.contentFilterAPI=this.rAl));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(tk)};this.wZn=tk=>{2!==this.Cr.mode&&3!==this.Cr.mode&&this.rj.iu&&tk===this.rj.iu.id&&this.Cr.clearSelection();re.StaticActiveAppFrame.za().Ge(!0)};this.Hjj=(tk,fp)=>{this.Hw("onCSCStart",window.performance.now());this.Qlb&&!tk&&(this.u6n(),this.Hw("openInFishbowl",!0));this.iMb.Ulb&&this.Vt.BNb&&this.Pb.Ob(aj.a.dMa,2);fp&&fp();this.Hw("onCSCEnd",window.performance.now())};this.bI.V3("OnCommentInit",
this.initialize);this.bI.V3("OnCommentRenderedOnce",this.IXn);this.IW.WUo(()=>{},this.wZn);pe.a.P5c&&(this.Mg.RNa=!1)}get pQa(){return this.Cr}get Qlb(){return this.Mg.Qlb}Hw(ma,Ua){this.ecb.Hw(el.a.comments,ma,Ua,!0)}G7m(ma){if(this.Mg.IX)ma&&ma.kMa&&ma.kMa();else if(this.zmh)(null===ma||void 0===ma?0:ma.kMa)&&this.y1e.push(ma.kMa);else{var Ua=this.Vt.vlc;this.Hw("hasCommentOnBoot",Ua);Ua?(this.I6a.logKpiUsage(Lf.a.gMb,0),y.AFrameworkApplication.jga("3f3e3317;d8ebf581")):Qd.a.VTn();this.zmh=!0;this.Hw("initInProgress",
!0);this.rj.initialize(this.Cr);this.iMb.initialize(this.Cr,null);this.iMb.cRj(this.Cr);this.Nlc.C8m(this.k2.JZo);this.Hw("InitAMSetup",window.performance.now());this.uxa=K.a.instance.Oa("Common.App.People.IExternalPeopleAPI");mb.a.tnc&&null!=this.uxa?(this.zWd.initialize(this.uxa),this.aRi(ma)):Ze.a.sq(this.l5l).continueWith(xb=>{(this.uxa=xb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.zWd.initialize(this.uxa);this.aRi(ma)})}}aRi(ma){this.pQa.ipf.initialize(this.pQa,
this.rj,this.uxa,this.zWd);this.$cf.initialize(this.dynamicScriptLoader,this.pQa.ipf,this.jij,this.uxa,new Be(this.JFp,this.KFp),this.jBi(),"",this.zWd.AGi(),this.$P,mb.a.lxc);this.Hw("AMInitialized",window.performance.now());mb.a.tnc?this.wcn(ma):this.Vt.contentNavigationApiEnabled?(mb.a.k8a?mb.a.k8a:this.Hh.h7i()).then(()=>{this.Hw("FCMLoaded",window.performance.now());this.hxc();this.Lbe(ma)}):this.Lbe(ma)}iuj(){var ma;null===(ma=sharedComments.setDarkModeColorHandler)||void 0===ma?void 0:ma.call(sharedComments,
this.zNl)}Lbe(ma){this.CDd=this.$cf.Lbe(void 0,this.iuj.bind(this));this.A7c(ma);this.Mg.IX=!0;this.Vt.Sze&&this.yWd.initialize()}A7c(ma){if(!this.Mg.$9a){this.Hw("InitCSStart",window.performance.now());var Ua=this.Ap.Xf("Task","InitiateCommentingSession");this.I6a.logKpiUsage(Lf.a.sWd,0);try{this.gQg(),this.Mg.$9a=!0,this.CDd.then(()=>{this.Hw("SCLoaded",window.performance.now());this.Hh.mRi();this.Hw("FCMInitiated",window.performance.now());this.yGj(ma);this.Stj(ma)})}catch(xb){a.ULS.lz(539567713,
327,10,xb,`Comments Initialization Failed: ${xb}`),this.I6a.logKpiFailure(Lf.a.sWd,"CommentsInitializationFailed",{isInternal:!0},{name:Lf.a.ynb,isInternal:!0})}finally{Ua.stop(),this.Hw("InitCSEnd",window.performance.now())}this.Pb.Ob(aj.a.kpf,2)}}v6n(ma){this.Pb.Ob(aj.a.K0,2);this.IW.PTj();Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.k2.selectComment(ma,{...(new wm.a),i4:!0,qca:1});this.focusManager.Gg(vf.AFrame.xt);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",
(new Date).getTime()-y.AFrameworkApplication.YK)},rh.a.xOo);this.I6a.ex(aj.a.npf)}Ebb(){this.Pb.Ob(aj.a.Ebb,2)}TBn(ma,Ua){(mb.a.k8a?mb.a.k8a:this.Hh.h7i()).then(()=>{this.Hw("FCMLoaded",window.performance.now());this.hxc();this.Hjj(ma,Ua)}).catch(xb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+xb.toString())})}hxc(){this.nS.trackChangeInSidetrackEnabled?(this.m3d.hxc(),this.Hw("STSet",window.performance.now())):this.m3d.gRj(this.ttm)}uRi(){this.xCh||(this.Mg.IX&&
this.CDd?(this.CDd.then(()=>{const ma=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.tLo.execute(Ua=>{ma.registerSafelinksNavigator(Ua.uAc.bind(Ua))});this.KJo.execute(Ua=>{Ua.huo(ma)})}),this.xCh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.Amh=!0))}jBi(){return new Ve(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}wcn(ma){const Ua=
this.Ap.Xf("Task","InitiateCommentingSession");try{this.A1o(ma),this.Mg.IX=!0,this.Vt.Sze&&this.yWd.initialize(),this.Pb.Ob(aj.a.kpf,2)}catch(xb){a.ULS.lz(508102016,327,10,xb,`Floating Comments Initialization Failed: ${xb}`),this.I6a.logKpiFailure(Lf.a.sWd,"CommentsInitializationFailed",{isInternal:!0},{name:Lf.a.ynb,isInternal:!0})}finally{Ua.stop(),this.Hw("InitCSEnd",window.performance.now())}}A1o(ma){this.Mg.$9a||(this.Hw("InitCSStart",window.performance.now()),this.I6a.logKpiUsage(Lf.a.sWd,0),
this.gQg(),this.Mg.$9a=!0,Promise.all([mb.a.k8a,mb.a.lxc]).then(()=>{this.hxc();this.Hh.mRi();this.Hw("FCMInitiated",window.performance.now());this.$cf.Unj(void 0,this.iuj.bind(this));this.yGj(ma);this.Stj(ma)}).catch(()=>{[mb.a.k8a,mb.a.lxc].forEach(Ua=>this.LFn(Ua))}))}LFn(ma){ma.catch(Ua=>{a.ULS.sendTraceTag(508101828,327,10,`Failed to load dependant scripts. ${Ua}`)})}Stj(ma){ma&&ma.kMa&&ma.kMa();for(const Ua of this.y1e)Ua();this.Amh&&this.uRi();this.y1e=[]}gQg(){const ma=this.Ap.Xf("Task","InitiateCommentingSession-UpdateModel");
this.tWd.Z7m();ma.stop();this.Hw("initAtBoot",window.performance.now());this.Vt.Fr&&this.rj.Esa()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",ka.a.Je()));Lj.a.get_instance().kK(12);a.ULS.sendTraceTag(508101987,327,50,"CommentRendered AppInitializationStatus was set")}yGj(ma){if(this.Vt.Fr){var Ua=!1;if(this.Qlb){var xb=this.k2.e5d(this.Qlb);xb?(y.AFrameworkApplication.$c("3ge3g205;cha3g788"),xb=this.k2.f5d(xb,0),xb)?this.rj.Zsa(xb)||(Ua=!0,this.v6n(xb)):
(Ua=!0,this.Ebb()):Ua=!0}ma=ma?ma.Bkj:null;this.Vt.contentNavigationApiEnabled||mb.a.tnc?this.Hjj(Ua,ma):this.TBn(Ua,ma)}}u6n(){this.k2.vKj(this.Qlb,{...(new wm.a),dBg:!1,P8c:!0});this.I6a.ex(aj.a.npf)}}Object(f.a)(Zh,"CommentInitActor",null,[]);class Te{constructor(ma,Ua,xb,Xb){this.$g=ma;this.aO=Ua;this.ga=xb;this.Wj=Xb;this.lFe=this.h2a=null}get zoom(){let ma=1;this.Wj&&this.Wj.instance&&(ma=this.Wj.instance.nl);return 0<ma?ma:1}K6l(ma,Ua){if(!this.lFe||!ma.OKa||Ua>=ma.OKa.length)return null;const xb=
this.zoom,Xb=ma.I3,rc=ma.g6a(1,Id.JTf,xb,Ua);return this.GFl(Xb,(this.lFe.y-ma.r7[Ua].y)/xb+Id.Gck,rc)}GFl(ma,Ua,xb){if(this.h2a)return(ma=this.h2a.parentElement)&&ma.removeChild(this.h2a),this.aNj(this.h2a,Ua,xb),this.h2a;const Xb=ma.Kh.ownerDocument,rc=Xb.createElement("div");rc.className=Te.lwl;this.aNj(rc,Ua,xb);Ua=Xb.createElement("span");this.DKg(Ua,rc);hb(Qc[4],Ua);this.vvo(Ua,ma);return this.h2a=rc}DKg(ma,Ua){ma.title=CommonUIStrings.l_CommentNewCommentButton;ma.setAttribute("role","button");
Ua.appendChild(ma)}vvo(ma,Ua){this.$g.LI(ff.a.click,ma,this.bZn.bind(this),Ua);this.$g.ub(ff.a.XC,ma,this.dZn.bind(this));this.aO.ub(ma,this.cZn.bind(this))}P$d(){if(this.h2a){const ma=this.h2a.parentElement;ma&&ma.removeChild(this.h2a)}}aNj(ma,Ua,xb){ma.style.left=xb+Id.JTf+"px";ma.style.top=Ua+"px";ma.style.right="auto";ma.style.display="block";ma.style.position="absolute";ma.style.overflow="hidden";ma.style.cursor="default";ma.style.zIndex="40"}dZn(){return!0}bZn(ma){this.ga.gE=30;this.ga.Ob(aj.a.dMa,
2);ma=ma.GB;hb(Qc[4],ma);ma=ma.parentElement;(null===ma||void 0===ma?0:ma.parentElement)&&ma.parentElement.removeChild(ma);return!0}cZn(){return!0}}Te.lwl="clip16x16 EntryPointContainer";Object(f.a)(Te,"CommentMarginEntryPointActor",null,[]);var Gi=d(433),fe=d(84),Fe=d(224),mg=d(34),bj=d(103);class Jh{constructor(ma,Ua,xb,Xb,rc,Zc,Hd){this.G2f=ma;this.Czn=Ua;this.Lp=xb;this.Mg=Xb;this.Vt=rc;this.qpf=Zc;this.I6a=Hd;this.jwj=new Set;this.VUb=new Set;this.cgd=new Fe.a;this.Lec=new Map;this.R4h=K.a.instance.nf("Box4.CommentParagraphMapping");
this.jMb=new Set;this.nka=this.d5d()}get nv(){return this.G2f.value}get ud(){return this.nv.ud}get pIa(){return this.Czn.value}d5d(){const ma=new mf.a;ma.set(this.nv);this.pIa.vbb(ma);return ma}Z7m(){this.Mg.$9a&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",mg.Debug.y8a());this.Vt.contentNavigationApiEnabled||(this.Vt.vlc&&this.X7m(),this.Lp.Glj())}KWn(){this.lHj();this.jMb.forEach(ma=>{this.bRg(ma)});this.jMb.clear();
this.Lp.Glj()}bRg(ma){if(Gi.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ma}`);var Ua=this.Lec.get(ma).pyc,xb=this.Lec.get(ma).thc;Ua===nb.a.nil||xb===nb.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${Ua} or end ${xb} has invalid value`):(this.R4h.value.H6a.set(ma,Ua),this.R4h.value.G6a.set(ma,xb),a.ULS.sendTraceTag(512235651,327,50,`Start ${Ua} and End ${xb} mapping info for Comment ${ma} added on Comment Model load`))}}ban(ma){const Ua=[];
for(const xb of ma)ma=xb.pk.toString(),this.x6j(ma,xb.paragraph.id,xb.Wc),xb.Wc&&(this.jwj.has(ma)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",xb.pk):(this.jwj.add(ma),(ma=this.SVk(xb))&&Ua.push(ma)));return Ua}x6j(ma,Ua,xb){Gi.a.isEnabled&&(this.Lec.has(ma)||this.Lec.set(ma,{pyc:nb.a.nil,thc:nb.a.nil}),xb?this.Lec.get(ma).pyc=Ua:this.Lec.get(ma).thc=Ua)}SVk(ma){var Ua=this.ud.Eb(ma.pk);this.nka.Yj(Ua);if(40!==this.nka.uf||!Ua)return a.ULS.sendTraceTag(523334303,
327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!Ua,!ma.pk),this.nka=39===this.nka.uf?this.nka:this.d5d(),null;Ua=this.Lp.ZXd(this.nka);let xb;if(({index:xb}=this.Lp.rDe(Ua)).returnValue)if(this.Lp.ydf(Ua,xb),this.VUb.add(Ua.objectId),ne.q(Ua)||this.jMb.add(Ua.objectId),Ua.Rf)this.cDf(Ua);else return{contentId:Ua.id,containerContentType:0,$ba:{yd:ma.Ib.cp,uP:ma.paragraph.$k}};else this.cgd.add(Ua);return null}cDf(ma){if(ma.Rf){var Ua=
this.Lp.EF(ma.Rf);if(Ua&&Ua.Rf){const xb=this.Lp.EF(Ua.Rf);xb&&(xb.Rf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ma.Rf=Ua.Rf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ma.objectId} parentObjectId: ${Ua.objectId}`)))}}}X7m(){const ma=new pa.a(0),Ua=fe.a.Bo(this.Lp.I0a),xb=new Set;this.Vt.$7n&&!Gi.a.isEnabled&&this.EYk(Ua,ma);const Xb=this.d5d(),rc=new Set,Zc=new Set,Hd=new Jg.GraphTransaction(2);try{if(Hd.ju(Xb),
Xb.zu(1)){for(;Ua.moveNext();){if(!Mb.ParagraphReader.Fh(Ua.iterator))continue;const Xd=Ua.iterator.currentNode,je=Mb.ParagraphReader.Eqb(Xd,0);Gi.a.isEnabled&&this.EKn(Xd,je,ma);xb.add(Xd.id.toString());this.zvj(je,Zc,Xb,rc)}this.lHj();const Jd=this.Omm(xb);0<Jd.length&&this.bJo(Jd,xb,Xb,Zc);this.jMb.forEach(Xd=>{this.bRg(Xd)});this.jMb.clear()}}finally{Hd&&Hd.dispose()}0==this.VUb.size&&this.Vt.vlc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");jb.a.$Fn(rc,
Zc,this.ud)}zvj(ma,Ua,xb,Xb){for(const rc of ma){ma=this.Vt.Fr?!rc.Wc:rc.Wc;const Zc=rc.pk.toString();this.x6j(Zc,rc.paragraph.id,rc.Wc);ma?Ua.has(Zc)||Xb.add(Zc):Ua.has(Zc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",rc.pk):(Ua.add(Zc),this.TVk(rc,xb))}}bJo(ma,Ua,xb,Xb){const rc=this.nEm(ma);jb.a.xpl(rc);const Zc=new Set,Hd=new Set;rc.forEach(Xd=>{Ua.has(Xd.id.toString())||Hd.has(Xd.id.toString())||(Hd.add(Xd.id.toString()),Xd=Mb.ParagraphReader.Eqb(Xd,
0),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Xd.length} CommentRangeObjects`),this.zvj(Xd,Xb,xb,Zc))});const Jd=[];ma.forEach(Xd=>{this.VUb.has(Xd)||Jd.push(Xd)});0<Jd.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${Jd.length} Failed To Load on Retry: ${Jd.join(",")}`),this.I6a.logKpiFailure(Lf.a.gMb,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:Lf.a.ynb,isInternal:!0}))}nEm(ma){const Ua=[];ma.forEach(xb=>{if(xb=this.qpf.jvi(xb))xb=ne.k(xb),(xb=this.ud.Eb(xb))&&
xb.Fk&&Ua.push(xb)});return Ua}TVk(ma,Ua){const xb=this.ud.Eb(ma.pk);Ua.Yj(xb);40===Ua.uf&&xb?(ma=this.Lp.ZXd(Ua),({index:Ua}=this.Lp.rDe(ma)).returnValue?(this.Lp.ydf(ma,Ua),this.VUb.add(ma.objectId),ne.q(ma)||this.jMb.add(ma.objectId),ma.Rf&&this.cDf(ma)):this.cgd.add(ma)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!xb,!ma.pk),39===Ua.uf||this.d5d())}Omm(ma){const Ua=[],xb=this.qpf.Imm();if(this.VUb.size===xb.length)return Ua;
xb.forEach(Xb=>{!this.VUb.has(Xb)&&jb.a.qvn(Xb,ma,this.qpf,this.ud)&&Ua.push(Xb)});return Ua}lHj(){for(let ma=0;ma<this.cgd.length;ma++){const Ua=this.cgd.K(ma);let xb;({index:xb}=this.Lp.rDe(Ua)).returnValue?(this.Lp.ydf(Ua,xb),ne.q(Ua)||this.jMb.add(Ua.objectId),this.VUb.add(Ua.objectId),Ua.Rf&&this.cDf(Ua)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",Ua.UAa,Ua.H7a,Ua.objectId,Ua.Rf))}this.cgd.clear()}EYk(ma,
Ua){ma.zp(xb=>{if(11===xb.uf){var Xb=xb.currentNode;const rc=Xb.ka(bj.a.xpf,null),Zc=Xb.ka(bj.a.vpf,null);xb=!!rc&&0<rc.length;const Hd=!!Zc&&0<Zc.length;xb&&rc.forEach(Xd=>{const je=this.ud.Eb(Xd);je&&!ne.t(je)&&Ua.add(Xd,0)});Hd&&Zc.forEach(Xd=>{Ua.tb(Xd)&&Ua.remove(Xd)});(Xb=Xb.ka(cb.a.VG,null))&&Xb.forEach(Xd=>{const je=this.ud.Eb(Xd);Mb.ParagraphReader.Wb(je)&&!this.Mg.kz.tb(Xd)&&this.Mg.kz.add(Xd,new Ic.a)});const Jd=Ua.keys;for(let Xd=0;Xd<Jd.length;Xd++){Xb&&0<Ua.K(Jd.K(Xd))&&(this.Mg.PX.tb(Jd.K(Xd))||
this.Mg.PX.add(Jd.K(Xd),new Cb.a(new zf.a)),Xb.forEach(af=>{const Wf=this.ud.Eb(af);Mb.ParagraphReader.Wb(Wf)&&(this.Mg.kz.K(af).wP||(this.Mg.kz.K(af).wP=new Cb.a(new zf.a)),this.Mg.PX.K(Jd.K(Xd)).add(af),this.Mg.kz.K(af).P9a=!0,this.Mg.kz.K(af).wP.add(Jd.K(Xd)))}));let je;Ua.W(je=Ua.keys.K(Xd),Ua.K(je)+1)}return xb||Hd}return!0},null)}EKn(ma,Ua,xb){ma&&(this.qkk(Ua,xb),this.Mg.kz.tb(ma.id)||this.Mg.kz.add(ma.id,new Ic.a),xb.forEach((Xb,rc)=>{0<rc&&(this.Mg.PX.tb(Xb)||this.Mg.PX.add(Xb,new Cb.a(new zf.a)),
this.Mg.kz.K(ma.id).wP||(this.Mg.kz.K(ma.id).wP=new Cb.a(new zf.a)),this.Mg.PX.K(Xb).add(ma.id),this.Mg.kz.K(ma.id).P9a=!0,this.Mg.kz.K(ma.id).wP.add(Xb));xb.W(Xb,rc+1);return!0}))}qkk(ma,Ua){ma.forEach(xb=>{if(xb.Wc){const Xb=this.ud.Eb(xb.pk);Xb&&!ne.t(Xb)&&Ua.W(xb.pk,0)}else Ua.tb(xb.pk)&&Ua.remove(xb.pk)})}}Object(f.a)(Jh,"CommentModelBootLoader",null,[291]);var Gh=d(1043);class cj{constructor(ma){this.O4h=ma;this.CHc=null;this.Quh=void 0;this.Ruh=null;this.qMc=new Map;this.kQe=new Map}Kxo(){Gh.a.yZa(this.qwp.bind(this))}qwp(ma,
Ua){const xb=ma.id.toString();var Xb=ma.getValue(Ta.a.ZG).toString();Ua?(this.qMc.delete(xb),this.kQe.delete(Xb)):(this.qMc.set(xb,ma),this.kQe.set(Xb,ma));0===this.qMc.size&&this.CHc&&(ma=+new Date-+this.CHc,this.CHc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ma}`));Ua||this.Quh!==Xb||(Ua=+new Date-+this.Ruh,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${Ua}`),
Xb=new ua.a,Xb.durationMs=Ua,this.O4h.logKpiFailure(Lf.a.kWd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:Xb},{name:Lf.a.w4h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Xb}));this.CHc||(this.CHc=new Date)}set EOn(ma){this.Quh=ma;this.Ruh=new Date;if(ma=this.Gmm(ma))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ma.id} present but failed to load`),ma=new ua.a,this.O4h.logKpiFailure(Lf.a.kWd,"CommentPresentButFailedToLoad",{isInternal:!0},
{name:Lf.a.w4h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ma})}Imm(){return[...this.qMc.keys()]}Gmm(ma){return this.kQe.get(ma)}jvi(ma){return this.qMc.get(ma)}}Object(f.a)(cj,"CommentNodeTracker",null,[]);class Uj{get contentType(){return 0}constructor(ma,Ua,xb,Xb,rc){this.mug=ma;this.Lp=Ua;this.k2=xb;this.MJ=Xb;this.Mg=rc;this.mug.ZAj(this)}zKj(ma,Ua,xb){0===Ua?(Ua=this.Lp.W8c(ma),this.k2.selectComment(Ua?this.Lp.$y:this.Lp.EF(ma),Object.assign(new wm.a,{i4:xb||Ua,qca:1}))):
this.MJ.clearSelection()}ASj(ma){if(this.Mg.an||this.Lp.W8c(ma.contentId))return!0;const Ua=this.Lp.EF(ma.contentId);if(Ua)return this.Lp.Zsa(Ua);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${ma.contentId}`);return!1}}Object(f.a)(Uj,"CommentReviewSuggestionContentActor",null,[290]);class Xk{get SEg(){return this.QEg}constructor(ma,Ua){this.tWd=ma;this.Vt=Ua;this.QEg=new Set([12])}initialize(){}E4f(ma){if(!Mb.ParagraphReader.Wb(ma.node))return[];ma=Mb.ParagraphReader.Eqb(ma.node,
0);return this.tWd.ban(ma)}kjj(){this.tWd.KWn()}IMi(){return this.Vt.qap?this.Vt.vlc:!0}}Object(f.a)(Xk,"CommentReviewSuggestionContentProvider",null,[289]);var Lk=d(464),ii=d(87),lj=d(124),Od=d(768),Nj=d(1529);class yh{constructor(){this.commentId=null;this.G$c=!1}}Object(f.a)(yh,"CommentToSelectOnPaneLoadData",null,[]);class Th{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg,bi,zh,Ah){this.Cr=ma;this.Lp=Ua;this.oIa=xb;this.k2=Xb;this.bI=rc;this.Mg=Zc;this.m3d=Hd;this.Vt=Jd;this.iMb=Xd;this.EUb=
je;this.Pb=af;this.H2f=Wf;this.focusManager=Mg;this.ml=bi;this.Nwl=zh;this.znb=Ah;this.$id=(Zi,sk,gm,Gj,En)=>{if(1===gm||!En)return 32;En[Lk.a.On]=pe.a.P5c?this.Mg.an:this.Mg.RNa;return 32};this.Pb.qa(aj.a.w0b,ii.a.frame,this.Cr.w0b.bind(this.Cr));this.Pb.qa(aj.a.U_d,ii.a.frame,this.U_d.bind(this));this.Pb.qa(aj.a.jpf,ii.a.frame,this.AXn.bind(this));this.Pb.qa(aj.a.Yvl,ii.a.frame,this.zXn.bind(this));this.Pb.qa(aj.a.mgj,ii.a.frame,this.S0n.bind(this));this.Pb.qa(aj.a.jgi,ii.a.frame,this.IYn.bind(this));
this.Pb.qa(aj.a.D4h,ii.a.frame,this.i_n.bind(this));this.Pb.fb(aj.a.opf,ii.a.frame,this.$7k.bind(this),64);this.Pb.fb(aj.a.rWd,ii.a.frame,this.hzo.bind(this),64);this.Pb.qa(Nb.a.selectComment,ii.a.frame,this.k2.uOo.bind(this.k2));this.Vt.lAn&&this.Pb.qa(Nb.a.Zge,ii.a.frame,this.Zge.bind(this));this.MMh(Nb.a.DYc,!1);this.MMh(Nb.a.kvf,!0);this.Pb.fb(Nb.a.uWd,ii.a.frame,this.uWd.bind(this),64);this.Pb.qa(Nb.a.AHg,ii.a.frame,this.b5n.bind(this));this.Pb.fb(Nb.a.$id,ii.a.frame,this.$id.bind(this),96);
this.Pb.qa(Nb.a.U9i,ii.a.frame,lj.ActionManager.eg);this.Pb.qa(Nb.a.Ilf,ii.a.frame,this.Ril.bind(this));this.Pb.qa(Nb.a.Sdi,ii.a.frame,(Zi,sk)=>Od.a.iba(sk.Lk)&&Od.a.htb()?8:32);this.Vt.ribbonCommentFilteringEnabled&&(this.Pb.qa(Nb.a.B2d,ii.a.frame,this.B2d.bind(this)),this.Pb.qa(Nb.a.C2d,ii.a.frame,this.C2d.bind(this)),this.Pb.qa(Nb.a.D2d,ii.a.frame,this.D2d.bind(this)),this.Pb.qa(Nb.a.xue,ii.a.frame,this.xue.bind(this)))}get rj(){return this.Lp}get mode(){return this.Cr.mode}get eB(){return this.Cr.eB}get lE(){return this.Vt.Fr}get Tj(){return this.EUb.value}get lb(){return this.H2f.value}get MJ(){return this.Cr}U_d(ma,
Ua,xb,Xb,rc){return rc?rc?(ma=this.k2.e5d(rc.NavigationId))&&this.k2.f5d(ma,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}AXn(ma,Ua,xb,Xb,rc){rc&&this.bI.T3("OnCommentInit",{...(new Nj.a),kMa:()=>{var Zc=this.k2.e5d(rc.NavigationId);if(Zc){var Hd=this.k2.f5d(Zc,1);Hd?this.iMb.isVisible?(this.Nmd(Hd,1),this.focusManager.RE(vf.AFrame.xt)):this.rj.Zsa(Hd)?(Zc=ne.s(Hd),
this.k2.selectComment(Hd,{...(new wm.a),i4:!Zc,qca:1}),this.focusManager.RE(vf.AFrame.sR)):(this.Mg.an||this.Pb.Ob(aj.a.K0,2),Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.Nmd(Hd,1)},rh.a.Nmd)):this.Pb.Ob(aj.a.Ebb,2)}}});return 32}zXn(ma,Ua,xb,Xb,rc){rc?(ma=this.rj.n2c(rc))?this.MJ.fsc(ma.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.MJ.fsc(null);return 32}S0n(ma,Ua,xb,Xb,rc){if(rc){if(this.Mg.$9a){for(ma=0;ma<rc.length;ma++)this.rj.WMj(rc[ma]);
this.Cr.Zwb()}else this.rj.D_k(rc);this.hGn(rc)}return 32}IYn(ma,Ua,xb,Xb,rc){if(rc)if(this.Mg.$9a){for(ma=0;ma<rc.length;ma++)this.rj.WMj(rc[ma],!0);this.Cr.Zwb()}else this.rj.fsl();return 32}i_n(ma,Ua,xb,Xb,rc){this.lE||this.Mg.an||this.Pb.Ob(aj.a.K0,2);if(rc){ma=null;if(!this.eB||2!==this.mode&&3!==this.mode){if(!rc)return 8;if(this.lE)ma=this.y8l(rc);else for(Ua=0;Ua<rc.length&&(ma=this.rj.G2(rc[Ua].toString()),this.m3d.Ade&&(!ma||ma.done));Ua++);}else ma=this.eB;this.Nmd(ma,1);ma&&this.Mg.IX&&
this.focusManager.Gg(this.lE&&!this.Mg.an?vf.AFrame.sR:vf.AFrame.xt)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}$7k(ma,Ua,xb,Xb,rc){var Zc;if(!rc)return 32;if(rc&&0<rc.length){Ua=ma=xb=0;Xb=!1;for(let Hd=0;Hd<rc.length;Hd++)rc[Hd].toString()===(null===(Zc=this.eB)||void 0===Zc?void 0:Zc.objectId)?(Xb=!0,ma++):this.Lp.RZf(rc[Hd])&&(Xb&&0===xb&&(xb=Hd,Ua=ma),ma++);(Zc=this.Lp.G2(rc[xb].toString()))?(this.oIa.Tzc.ebg=Ua+1,this.oIa.Tzc.gAb=
ma,this.MJ.fsc(Zc.id)):(rc=rc[xb],this.Tj.Eb(rc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${rc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",rc.toString()))}return 32}hzo(){this.MJ.fsc(null);return 32}MMh(ma,Ua){this.Pb.qa(ma,ii.a.frame,(xb,Xb,rc)=>this.mYn(rc,Ua))}b5n(ma,Ua,xb){var Xb;if(1===xb)return this.Lp.$y?8:32;if(2===xb){if(pe.a.P5c||this.Mg.an)return this.Pb.Ob(aj.a.K0,
2),this.Mg.RNa=this.Mg.an,32;if(!this.Lp.H5c())return 32;this.Mg.RNa=!this.Mg.RNa;this.bI.T3("OnFloatingCommentsToggle");null===(Xb=re.StaticActiveAppFrame.za())||void 0===Xb?void 0:Xb.Ge(!0)}return 32}Zge(ma,Ua,xb){2===xb&&(ma=this.rj.Yo.Lc(7),ma.Ab(this.rj.I0a),Ua=new Ei.a,Ua.Ola(`${String.fromCodePoint(128077)} \n`),this.Lp.ufc(yk.a.instance.gb.currentSelection,void 0,Ua),this.Nwl.P$d(),ma.dispose());return 32}mYn(ma,Ua=!1){if(2===ma)ma=this.rj.Yo.Lc(15),ma.Ab(this.rj.I0a),this.ml.le(()=>{this.DYc(Ua)},
"ECM:DAC"),ma.dispose();else if(1===ma&&(!this.rj.Esa()||this.Vt.$Pl&&Ua&&!this.rj.YZm()))return 2;return 32}DYc(ma=!1){this.Cr.mode=1;const Ua=this.rj.xR();for(const xb of Ua)xb.Dr===qd.a.bE||ma&&!xb.done||xb.Rf||this.Cr.deleteComment(xb);this.focusManager.Gg(vf.AFrame.Do);0<(ma?this.rj.xR().filter(xb=>xb.done):this.rj.xR()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ma):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",
ma)}uWd(ma,Ua,xb){if(2===xb)if(ma=this.focusManager.currentScope.name,ma!==vf.AFrame.xt&&ma!==vf.AFrame.sR){!this.lE||this.Mg.an?(this.Mg.an||this.Pb.Ob(aj.a.K0,2),this.focusManager.Gg(vf.AFrame.xt)):this.focusManager.Gg(vf.AFrame.sR);var Xb=this.lb.gb.currentSelection;if(!Xb||!Xb.Qa)return 2;ma=Xb.Qa.cpBegin;Ua=Xb.Qa.node;Xb=!!this.eB&&(Af.a.ym(Xb)||Xb.FL)&&ne.r(this.eB,Ua,this.Tj,ma);ma=!!this.eB&&(2===this.mode||3===this.mode);if(Xb||ma)return this.MJ.BKj(this.eB.id,!0),32;Xb=this.lE&&!this.Mg.an?
this.rj.kvi(!0,!0):null;this.MJ.DOo(Xb)}else this.rj.iu&&(this.Cr.Nlc.uKj(this.rj.iu,!0),this.Cr.Nlc.Wrb(null===(Xb=this.rj.iu)||void 0===Xb?void 0:Xb.objectId)),this.focusManager.Gg(vf.AFrame.Do);return 32}Ril(){return 4}hGn(ma){const Ua=new Set;for(let xb=0;xb<ma.length;xb++){const Xb=this.rj.n2c(ma[xb]);Xb&&Ua.add(Xb.Rf?Xb.Rf:Xb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",Ua.size.toString())}Nmd(ma,Ua){ma?this.iMb&&!this.Mg.IX?this.Mg.Bnb=Object.assign(new yh,{commentId:ma.id,
G$c:!1}):this.k2.selectComment(ma,Object.assign(new wm.a,{i4:!!Ua,qca:Ua})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}y8l(ma){let Ua=null,xb=!1;for(let Xb=0;Xb<ma.length;Xb++){const rc=ma[Xb].toString();if(this.rj.RZf(ma[Xb])){Ua||(Ua=rc);if(xb&&this.rj.iu.objectId!==rc)return this.rj.G2(rc);xb=xb||!!this.rj.iu&&this.rj.iu.objectId===rc}}return Ua?this.rj.G2(Ua):null}jwe(ma){this.Mg.filter=ma;this.znb.onRibbonFilterChanged(ma);this.Pb.Ob(Nb.a.HHj,2);this.bI.T3("OnContentFilterUpdate")}B2d(ma,
Ua,xb){if(2===xb)this.jwe({...this.Mg.filter,resolutionStatus:2===this.Mg.filter.resolutionStatus?0:2});else if(1===xb&&!this.rj.Esa())return 2;return 32}C2d(ma,Ua,xb){if(2===xb)this.jwe({...this.Mg.filter,mentionsToCurrentUser:!this.Mg.filter.mentionsToCurrentUser});else if(1===xb&&!this.rj.Esa())return 2;return 32}D2d(ma,Ua,xb){if(2===xb)this.jwe({...this.Mg.filter,resolutionStatus:1===this.Mg.filter.resolutionStatus?0:1});else if(!(1!==xb||this.iMb.isVisible&&this.rj.Esa()))return 2;return 32}xue(ma,
Ua,xb){if(2===xb)this.jwe({mentionsToCurrentUser:!1,resolutionStatus:0});else if(1===xb&&!this.rj.Esa())return 2;return 32}}Object(f.a)(Th,"CommentsActionManager",null,[]);var Tf=d(169),pp=d(38),jk=d(196),lm=d(1863),ce=d(538),Ge=d(30),Vc;(function(ma){ma[ma.ZWp=0]="commentDeeplink";ma[ma.Rml=1]="catchUpActivity"})(Vc||(Vc={}));Object(f.b)("DeeplinkSource",Vc);class Ii{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg){this.ga=ma;this.yi=Ua;this.Zx=xb;this.$Me=Xb;this.US=rc;this.qEh=Zc;this.Zb=Hd;
this.Dj=Jd;this.fj=Xd;this.KFb=je;this.bNe=af;this.nJ=Wf;this.l8e=!1;this.JZo=bi=>{if(this.fj.Fr&&!this.Dj.an){const zh=new Db.a(0,1,0,()=>{this.HMj(bi)},136,void 0,!0);y.AFrameworkApplication.pc.$b(zh)}else this.HMj(bi)};Mg.execute(bi=>{this.BG=bi})}get Lp(){return this.yi}get lb(){return this.KFb.value}Wii(ma){let Ua=ma.Dr===qd.a.bE?ma.GA.draftId:ma.id,xb=null;ma.Rf&&(Ua=ma.Rf,xb=()=>{this.qEh.selectComment(ma.id)});this.US.setInitialActiveContainerId(Ua,0,xb)}uOo(ma,Ua,xb,Xb,rc){if(!rc.commentId)return 2;
ma=this.yi.EF(rc.commentId);if(!ma)return 2;this.Xxb(ma,rc);return 32}yKj(ma,Ua){var xb,Xb;if(ma){var rc=(null===(Xb=null===(xb=this.yi.$y)||void 0===xb?void 0:xb.GA)||void 0===Xb?void 0:Xb.draftId)===ma?this.yi.$y:this.yi.EF(ma);this.selectComment(rc,Ua)}}selectComment(ma,Ua){ma&&this.Xxb(ma,Ua)}vKj(ma,Ua){var xb=this.e5d(ma);xb&&((xb=this.f5d(xb,0))?Ua.dBg?(this.Dj.Bnb=Object.assign(new yh,{commentId:xb.id,G$c:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):
(this.Xxb(xb,Object.assign(new wm.a,{commentId:xb.id,qca:1,i4:!0,P8c:!0})),this.fj.Fr&&void 0!==ma&&null!==ma&&this.Wii(xb),Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.Zb.Gg(this.fj.Fr&&!this.Dj.an?vf.AFrame.sR:vf.AFrame.xt)},rh.a.YUo),Tf.a.instance.rf(pp.a.Jci,(new Date).getTime()),ma=this.fj.Fr?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ma+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ma,(new Date).getTime()-y.AFrameworkApplication.YK)):
this.ga.Ob(aj.a.Ebb,2))}e5d(ma){let Ua=null;var xb=null;if(Oa.a.soc(ma))Ua=ma;else if(({av:xb}=Ma.d(ma)).returnValue&&(ma=xb))return ce.a.comment in ma&&(Ua=ma[ce.a.comment]),Ua;Ua||(xb=xb?Object.keys(xb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",xb?xb.join(","):"Not Json."));return Ua?Ua.toString():null}f5d(ma,Ua){const xb=this.yi.n2c(ma),Xb=0===Ua;Xb&&this.nJ.logKpiUsage(Lf.a.kWd,0);if(!xb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",
ma,Ua);const rc=new Ge.a;rc.name="DeepLinkSource";rc.string=Vc[Ua];this.nJ.logActivity("CommentDeeplinkNotFound",{dataFields:[rc]});Xb&&(Ua=new ua.a,Ua.extendedProperties=new Map([["ErrorLevel","warning"]]),this.nJ.logKpiFailure(Lf.a.kWd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:Ua}),this.bNe.EOn=ma)}return xb}HMj(ma){this.l8e=!0;this.lb.Kc(ma);this.l8e=!1}Xxb(ma,Ua){if(ma){this.Dj.RNa||this.ga.Ob(Nb.a.AHg,2);this.Dj.wWb&&(y.AFrameworkApplication.pc.wf(this.Dj.wWb),this.Dj.wWb=
null);var xb=this.yi.iu,Xb=this.Lp.DLf(ma),rc=2===Ua.qca,Zc={};rc&&(Zc.TriggeredByFindReplace=!0);if(this.Dj.an)rc&&(Zc.PaneAlreadyOpen=!0),jk.UISurfaces.Lv().then(Hd=>{Hd.setSelectedTaskPane(lm.a.vWd);return null});else if(ma.Dr!==qd.a.bE&&!this.Lp.Zsa(ma))this.Dj.IX?this.ga.Ob(Nb.a.K0,2):this.Dj.Bnb=Object.assign(new yh,{commentId:ma.id,G$c:Ua.P8c}),rc&&(Zc.OpeningPaneToSelect=!0);else if(this.fj.Fr){const Hd=Xb.Dr===qd.a.bE;Hd?this.US.ZZa(Xb.GA.draftId,0,Ua.i4):this.US.ZZa(Xb.id,0,Ua.i4);!Hd&&
rc&&(Zc.SelectingDHC=!0)}Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.Dj.IX&&(Ua.i4&&this.Zb.Gg(this.fj.Fr&&!this.Dj.an?vf.AFrame.sR:vf.AFrame.xt),Ua.P8c&&this.Lp.Zsa(ma)||!Ua.i4&&!Ua.qca||this.qEh.selectComment(ma.id))},rh.a.Zxg);rc=this.Lp.DLf(xb);this.BG&&rc&&rc.id!==Xb.id&&this.BG.fireEvent(9,{comment:rc});this.yi.selectComment(ma);this.BG&&ma.Dr===qd.a.normal&&!ma.Rf&&this.BG.fireEvent(8,{comment:ma});this.$Me.highlightComment(ma,!0);this.Zx.vH(0,Xb,xb);re.StaticActiveAppFrame.za().Ge(!0);0<
Object.keys(Zc).length&&this.nJ.ex(Nb.a.selectComment,{ao:Zc})}}}Object(f.a)(Ii,"CommentSelectionActor",null,[288]);class Wj extends Wh.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new pg.a,{T_:Wj.getTypeName(),B_:Wj.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(Wj,"CommentSmartReplySignal",Wh.a,[]);class hn extends pb.a{constructor(){super();this.DomainName=
this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new pg.a,{T_:hn.getTypeName(),B_:hn.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(hn,"SmartReply",pb.a,[]);var Cm=d(883);class Cl{constructor(ma){this.lwa=ma}wfc(ma,Ua){return Object.assign(new Cm.a,{parentPath:["Signal",Wj.getTypeName()],items:[Object.assign(new qh.a,{body:Object.assign(new Wj,{commentId:ma,
comment:Ua})})]})}nkg(ma){const Ua=new N.a;if(ma&&ma.CommentId&&ma.ResultSets&&0<ma.ResultSets.length&&ma.ResultSets[0].Documents&&0<ma.ResultSets[0].Documents.length){for(const xb of ma.ResultSets[0].Documents)Ua.add(xb.Caption);0<Ua.count&&this.lwa.nkg(ma.CommentId,Ua.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return hn.getTypeName()}}Object(f.a)(Cl,"BaseCommentSmartReplyProvider",null,[1946]);class Uk extends Cl{constructor(ma,
Ua,xb,Xb){super(ma);this.Re=Ua;this.LC=xb;this.vok=Xb}initialize(){this.LC.im().then(()=>{this.Re.ub(this,Cl.prototype.getTypeName.call(this))})}invoke(ma,Ua){this.LC.im().then(()=>{this.vok.getAugLoopRuntimeManager().submitOperation(Object.assign(new jj.a,{operation:this.wfc(ma,Ua)}))})}gH(ma,Ua){ma&&vc.a.getTypeNameFor(ma.content)===this.getTypeName()&&Ua===tb.a.getTypeName()?this.nkg(ma.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(f.a)(Uk,"CommentSmartReplyProvider",
Cl,[114]);var Ml=d(35),jo=d(140),tl=d(629);class fl{constructor(ma,Ua,xb,Xb,rc,Zc){this.Aa=ma;this.Fd=Ua;this.zz=xb;this.EZe=Xb;this.bNe=rc;this.nS=Zc;this.GEb=!1;this.bNe.Kxo();this.Lbh=this.DCm();this.fpg&&(Ml.a.addHandler(window.self,ff.a.IQh,()=>{this.GEb=!0}),Ml.a.addHandler(window.self,ff.a.JQh,()=>{this.GEb=!1}));0<this.Lbh&&y.AFrameworkApplication.$c("77dda873;fe8jd931")}get nv(){return this.zz?this.zz.value:null}get pIa(){return this.EZe.value}get msp(){return this.GEb}get vlc(){return null!=
this.UWg?this.UWg:this.UWg=(()=>0<this.Lbh)()}get Fr(){return null!=this.aUg?this.aUg:this.aUg=(()=>this.nS.Fr)()}get gVl(){return null!=this.$Tg?this.$Tg:this.$Tg=!0}get u1b(){return null!=this.Y4g?this.Y4g:this.Y4g=(()=>this.Fd.isFeatureEnabled(106)&&!tl.a.Y9c)()}get NPo(){return null!=this.l3g?this.l3g:this.l3g=(()=>this.Fd.isFeatureEnabled(30)&&this.Aa.$("SendErrorReportOnCommentInboundCrashIsEnabled"))()}get Zvl(){return null!=this.QSg?this.QSg:this.QSg=(()=>this.Aa.$("CommentAnchorHighlightOnIpSelectionIsEnabled"))()}get fpg(){return null!=
this.K2g?this.K2g:this.K2g=!1}get Lgj(){return null!=this.R0g?this.R0g:this.R0g=(()=>this.Aa.$("NoHighlightWhenCommentDraftInProgressIsEnabled"))()}get BNb(){return null!=this.NTg?this.NTg:this.NTg=(()=>this.Fr&&!this.vlc&&!this.Aa.jb("BootActivityNavigationId")&&G.a.au)()}get Eal(){return this.Aa.$("AtMentionUserFloodGateCampaignIsEnabled")}get pwl(){return null!=this.RSg?this.RSg:this.RSg=(()=>this.Aa.$("CommentFriendlyTimestampsIsEnabled"))()}get YUl(){return null!=this.YTg?this.YTg:this.YTg=(()=>
this.Aa.jb("DisabledChangeGatesInSharedComments"))()}get n3d(){return null!=this.OVg?this.OVg:this.OVg=(()=>this.nS.n3d)()}get G0b(){return null!=this.H3g?this.H3g:this.H3g=(()=>G.a.QR?this.Jze:this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1))()}get Jze(){return null!=this.F3g?this.F3g:this.F3g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SimpleMarkupModeInSafari",!1))()}get Sze(){return null!=this.R3g?this.R3g:this.R3g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1))()}get A0(){return null!=this.A2g?this.A2g:this.A2g=(()=>this.Aa.jb("PresenceUserId"))()}get Wga(){return null!=this.L2g?this.L2g:this.L2g=tl.a.oGe&&!!jo.PageReader.instance&&jo.PageReader.instance.yAa(re.StaticActiveAppFrame.za().kb.hd).Wga}get gpb(){return null!=this.oUg?this.oUg:this.oUg=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1))()}get djp(){return null!=this.X4g?this.X4g:this.X4g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1))()}get exl(){return null!=this.SSg?this.SSg:this.SSg=(()=>this.Aa.$("CommentsTasksFpsIsEnabled"))()}get trackChangeInSidetrackEnabled(){return null!=this.I5g?this.I5g:this.I5g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1))()}get lAn(){return null!=this.X_g?this.X_g:this.X_g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1))()}get contentNavigationApiEnabled(){return null!=this.rTg?this.rTg:this.rTg=(()=>this.nS.contentNavigationApiEnabled)()}get $7n(){return null!=
this.f1g?this.f1g:this.f1g=(()=>this.Fd.isFeatureEnabled(79))()}get contentFilterApiEnabled(){return null!=this.oTg?this.oTg:this.oTg=(()=>this.nS.contentFilterApiEnabled)()}get qap(){return null!=this.Q3g?this.Q3g:this.Q3g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1))()}get ribbonCommentFilteringEnabled(){return null!=this.U2g?this.U2g:this.U2g=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCommentFilteringEnabled",!1))()}get $Pl(){return null!=
this.OTg?this.OTg:this.OTg=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DeleteAllCommentsCheckFixEnabled",!1))()}get Jif(){return null!=this.$Rg?this.$Rg:this.$Rg=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionBookmarkFixup",!1))()}get qxl(){return null!=this.TSg?this.TSg:this.TSg=(()=>this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixStuckCommentCommit",!1))()}DCm(){if(this.nv&&this.pIa){const ma=new mf.a;ma.set(this.nv);this.pIa.vbb(ma);let Ua=
0;39===ma.uf&&(Ua=ma.ar());return Ua}return-1}}Object(f.a)(fl,"CommentsSettings",null,[]);class Uh{constructor(){this.i8g=null;this.IX=!1;this.wWb=this.Bnb=null;this.kz=new Ob.a(new zf.a);this.PX=new Ob.a(new zf.a);this.Gog=this.$9a=!1;this.RNa=!0;this.filter={mentionsToCurrentUser:!1,resolutionStatus:0}}get an(){return pe.a.an}set an(ma){pe.a.an=ma}get Qlb(){return this.i8g}set Qlb(ma){this.i8g=ma}}Uh.Gk=1;Object(f.a)(Uh,"CommentsState",null,[]);var nh=d(1379);class Ke{constructor(ma){this.gda=ma}wXh(ma,
Ua,xb){const Xb=new id;Ua=this.gda.oXa(Ua)?Ua.objectId:null;if(!Ua)return Xb;Ua=nb.a.Bf(Ua);if(xb.contains(Ua))return Xb.j7c=0,Xb.i7c=ma.length,Xb;for(let Zc=0,Hd=ma.length;Zc<Hd;Zc++){var rc=ma[Zc];xb=ne.g(rc);rc=ne.d(rc);xb&&nh.a.k6h(xb,Ua)&&(Xb.j7c=Zc);if(rc&&nh.a.k6h(rc,Ua)){Xb.i7c=Zc;break}}return Xb}QSh(ma,Ua,xb){const Xb=-1===Ua.j7c&&-1===Ua.i7c,rc=-1<Ua.j7c?Ua.j7c:-1;Ua=-1<Ua.i7c?Ua.i7c:ma.length;const Zc=!Xb&&rc===Ua;var Hd=!1;for(let Jd=0;Jd<ma.length;Jd++){const Xd=ma[Jd],je=Rg.a(Xd);if(1!==
je&&2!==je&&3!==je)continue;this.gda.BZa(Xd);if(Xb||Jd<rc||Jd>Ua)continue;const af=3===je||2===je&&-1!==Xd.className.indexOf(Kf.a.mWa),Wf=xb?1:2;this.a9k(Jd,rc,Ua,Wf,af,Hd,Xd,Zc);if(Jd!==Ua||Zc)(Hd=this.gda.T9a.K(je).K(Wf))&&Xd.classList.add(Hd),Hd=af}}a9k(ma,Ua,xb,Xb,rc,Zc,Hd,Jd){ma!==Ua&&ma!==xb||rc||Zc||((ma=this.gda.Jtc.K(Xb))&&Hd.classList.add(ma),Jd&&Hd.classList.add(Kf.a.Mjg))}}Object(f.a)(Ke,"DefaultHighlightChangeHandler",null,[286]);var cg;(function(ma){ma[ma.success=0]="success";ma[ma.Qn=
1]="noSelection";ma[ma.l6p=2]="invalidContent"})(cg||(cg={}));Object(f.b)("AnchorCreationResult",cg);var ub=d(61),ec=d(21),Tc=d(278),bd=d(254),le=d(1037);class tf{}Object(f.a)(tf,"EditorAnchorInfo",null,[306]);class pf{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd){this.Jzn=ma;this.H2f=Ua;this.rj=xb;this.kBa=Xb;this.oIa=rc;this.Xs=Zc;this.bI=Hd;this.Vt=Jd;this.QHg=Xd;this.hEh=null;this.kBa.eNa(this.oIa);this.Vt.contentFilterApiEnabled&&(this.bI.V3("OnCommentPaneOpen",this.kyp.bind(this)),this.bI.V3("OnCommentPaneClose",
this.jyp.bind(this)),this.bI.V3("OnContentFilterUpdate",this.afd.bind(this)))}get lb(){return this.H2f.value}get Tj(){return this.Jzn.value}initialize(){}C8m(ma){this.hEh=ma}dispose(){}Wrb(ma){this.oIa.Wrb(ma)}Mlc(ma){this.oIa.Mlc(ma)}highlightComment(ma){this.uKj(ma,!1);this.oIa.Wrb(ma.objectId)}JAc(ma){this.oIa.JAc(ma)}cKa(ma){return this.oIa.cKa(ma)}afd(){this.lIe("OnContentFilterUpdate")}kyp(){this.lIe("OnCommentPaneOpen")}jyp(){this.lIe("OnCommentPaneClose")}lIe(ma){const Ua=[],xb=new Set;for(const rc of this.rj.xR())if(!rc.Rf&&
rc.Dr!==qd.a.bE&&!this.rj.MJ.SZh(ma,rc)){var Xb=this.GDm(rc);xb.has(Xb.id.toString())||(xb.add(Xb.id.toString()),(Xb=Xb.fg(Object(ub.a)().Gd.Ic))&&Ua.push(Xb))}Ua.forEach(rc=>{this.kBa.KAc(rc)})}GDm(ma){var Ua,xb,Xb;const rc=null===(Ua=this.Tj)||void 0===Ua?void 0:Ua.Eb(ma.objectId);if(!rc)return null;ma=ne.k(rc);Ua=null===(xb=this.Tj)||void 0===xb?void 0:xb.Eb(ma);return null===(Xb=this.QHg.instance)||void 0===Xb?void 0:Xb.ZQb(Ua)}uKj(ma,Ua){if(!ma.Dr){var xb=this.Tj.Eb(nb.a.Bf(ma.objectId)),Xb=
Sb.a.hfa(xb,this.Tj,!0);xb=Sb.a.hfa(xb,this.Tj,!1);if(Xb&&xb){const rc=Xb.Ib.paragraph;Xb=Xb.Ib.cp;if(this.ssn(rc,Xb))re.StaticActiveAppFrame.za().Ge(!0);else{Xb=ec.SelectionFactory.ue(rc,Xb);xb=Bi.a.Uc(xb.Ib.paragraph,xb.Ib.cp);if(pf.tg.jba(Xb.Qa)||pf.tg.jba(xb))ma.YWa=!0,ma.sbb();ma=Ua?ec.SelectionFactory.Vy(Xb,xb):Xb;this.hEh(ma)}}}}Srl(){this.oIa.Mlc(null);this.oIa.Wrb(null)}ADl(){const ma=new tf;return{returnValue:cg.success,anchor:ma}}ssn(ma,Ua){if(ma&&Object(Yg.a)(le.a,this.Xs.Gd)){var xb=
ma.fg(this.Xs.Gd.Ic);ma=document.getElementById(fi.a.H0a);if(xb&&ma){Ua=Tc.a.Ev(xb,Ua);if(!Ua)return!1;Ua=Ua.y;xb=Sys.UI.DomElement.getBounds(ma).y;ma=ma.offsetHeight;if(Ua>=xb&&Ua<=xb+ma)return!0}}return!1}static get tg(){return bd.a.instance}static getInstance(){return pf.Qm()}static Qm(){return pf._instance||(pf._instance=new pf(new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),new fb.a(()=>yk.a.instance),K.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),K.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,
K.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Object(ub.a)(),K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings"),K.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")))}}pf._instance=null;Object(f.a)(pf,"EditorCommentHintManager",null,[282,283,10]);var rf=d(66),Hg=d(2123),Fh=d(360),Ef=d(1126);class Bc extends rl.a{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg,bi,zh,Ah,Zi,sk,gm,Gj,En,Rm,Si,
rp,Ji,Fn){super(Hd);this.Pi=Ua;this.KFb=Jd;this.ipf=je;this.mwa=af;this.XEc=Wf;this.US=Mg;this.fj=bi;this.Qp=zh;this.f5b=Ah;this.Dj=Zi;this.h1=sk;this.ee=Gj;this.nJ=En;this.IW=Si;this.znb=rp;this.QHg=Fn;this.PNi=this.iGh=this.B2a=null;this.Hvb=()=>{this.Xva.hta()&&(this.QAj(this.Xva.Qc),this.Xva.gvc(this.Hvb))};this.Bdd=ml=>{ne.x(void 0,ml.mode)?1===ml.mode&&(this.cF=0):this.cF=1;this.yi.$y&&0===this.cF?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",
this.yi.$y.GA.sessionType):this.Dj.IX&&(this.lE||this.e5.isVisible)&&this.Zwb()};this.JVn=()=>{this.Dj.$9a?this.mode=0:this.cF=0};this.AMa=(ml,jn)=>{var Gn;ml=jn.Rm.currentSelection;if((this.lE||this.Dga&&this.Dga.isVisible)&&!this.f5b.l8e&&ml){jn=Af.a.ym(ml);var gl=ml.FL;null!==(Gn=this.PNi)&&void 0!==Gn&&Gn.Rea||(this.Lp||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),Gn=this.Lp&&this.Lp.Wsb(this.ga,!1),1!==this.mode||jn&&!gl||!Gn?this.XEc.P$d():this.KHl(ml));2!==
this.mode&&3!==this.mode&&this.fj.Zvl&&this.rqp(ml,jn,gl)}};this.spl=()=>{if(this.rj&&this.rj.$y&&!mb.a.dWf){var ml=this.rj.$y;ml.GA.sessionType!==Hg.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${ml.Dr} present on app shutdown`),(ml=jb.a.Jqm(ml))&&this.nJ.logKpiFailure(ml,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Lf.a.ynb,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.TVn=()=>{if(this.Dj.IX){var ml=()=>!0;this.lE&&!this.Dj.an&&(ml=jn=>this.Lp.Zsa(jn));
ml=this.Lp.BGf(ml);this.Zwb(ml)}};this.ga=Hd;this.cF=ne.x(this.ga.mode,void 0)?0:1;this.e5=rc;this.yi=Xb;this.xda=Zc;this.Zb=Xd;this.Iwo();xb.Vcb(this.mwa);this.lb.AB(this.AMa);ma.CWR(()=>ma.result.ZE.AHa(this.JVn));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.A5a(this.Bdd);this.h1.V3("OnAfterTrackChangeMarkupViewChange",this.TVn);y.AFrameworkApplication.fG&&y.AFrameworkApplication.fG(this.spl);Ji.execute(ml=>{this.BG=ml});Rm.execute(ml=>{ml.ZAl.execute(jn=>{this.PNi=jn})})}Iwo(){this.Xva&&
(this.Xva.hta()?this.QAj(this.Xva.Qc):this.Xva.rcc(this.Hvb))}QAj(ma){ma.g6(()=>{this.Vdp()})}get Xva(){var ma;return null===(ma=tl.a.hm)||void 0===ma?void 0:ma.kb}get lb(){return this.KFb.value}get rj(){return this.yi}get Lp(){return this.yi}get lE(){return this.fj.Fr}get wgj(){return!0}get mLj(){return!0}get Xlc(){return this.B2a}set Xlc(ma){this.B2a=ma}get mode(){return super.mode}set mode(ma){ma!==this.cF&&(super.mode=ma,this.sbb())}get eB(){return this.model&&this.model.iu?this.model.iu.Rf?this.model.EF(this.model.iu.Rf):
this.model.iu:null}get Tj(){return this.Pi.value}get QTj(){return!1}get Wga(){return this.fj.Wga}Zwb(ma=null){var Ua=this.Lp;const xb=!this.cF,Xb=this.Dga.mwl,rc=Ua.o7d();Xb.OKg(rc?5:1,xb);ma=this.fj.G0b&&ma?ma:Ua.aHf(this.fj.G0b&&this.lE&&!this.Dj.an);Xb.EPo(ma,rc,Ua.u1a);this.sKg();Ua=0;jb.a.w_d&&(Ua=+new Date-+jb.a.w_d);jb.a.V2h();a.ULS.sendTraceTag(572281362,327,50,`Comment Context Reloaded, Time Taken: ${Ua}`)}bfd(ma,Ua,xb=!1){this.Dj.an?this.US.a9j():Ua?this.US.$Ia(ma.Dr===qd.a.bE?ma.GA.draftId:
ma.id,0,xb):this.Ioo(ma)}Ioo(ma){const {$kp:Ua}=this.yi.Awm(ma),xb=this.xda.cKa(ma.objectId);xb&&this.US.Ybc(ma.id,xb.parentElement,0,Ua)}EKj(ma){const Ua=this.eB;this.Pmd();this.mwa.vH(0,this.yi.iu,Ua);this.lE&&this.yi.iu&&!this.Dj.an&&this.US.ZZa(this.yi.iu.id,0,1===ma)}EOo(){const ma=this.eB;this.Qmd();this.mwa.vH(0,this.yi.iu,ma);this.lE&&this.yi.iu&&!this.Dj.an&&this.US.ZZa(this.yi.iu.id,0,!1)}JAc(ma){this.xda.JAc(ma)}A_l(ma,Ua){this.US.Ybc(ma,null,0,Ua)}ebo(ma){this.US.psj(ma)}C_l(ma,Ua){this.US.Tkd(ma,
Ua,0)}wxp(){this.US.Hif()}xKj(ma){if(ma&&(2!==this.mode||ma.Dr===qd.a.bE)){var Ua=this.yi.iu;Ua!==ma&&(this.yi.selectComment(ma),this.e5.isVisible?this.Dj.IX?(this.e5.selectComment(ma,1),this.Uoa.selectComment(ma.id)):this.Dj.Bnb=Object.assign(new yh,{commentId:ma.id,G$c:!1}):this.lE&&!ma.done&&(this.BKj(ma.id,!1),this.Uoa.selectComment(ma.id)),!this.e5.isVisible&&this.lE&&ma.done||(this.Nlc.Wrb(ma.objectId),this.mwa.vH(0,this.eB,Ua)))}}A7c(){}tzf(){this.Dj.$9a=!1}mKb(ma){this.fj.Lgj&&this.yi.iu&&
this.clearSelection();super.mKb(ma);this.nJ.logKpiUsage(Lf.a.upf,0);this.sKg();if(this.lE){const Ua=this.yi.POm(ma.draftId);this.A_l(ma.draftId,Ua)}}Vlb(ma,Ua){this.nJ.logKpiUsage(Lf.a.xWd,0);super.Vlb(ma,Ua)}eza(ma){this.lE&&null!=ma.GA&&this.yi.VBj(ma.GA.draftId);super.eza(ma);this.xda.Wrb(ma.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",ne.a(ma));this.nJ.logKpiUsage(Lf.a.u4h,0);this.ypl(ma);jb.a.mFp(ma,this.Tj,this.nJ);this.nJ.ex(Nb.a.t4h,{succeeded:!0,ao:{actionType:ma.Rf?
Hg.a.reply:Hg.a.create}})}Dnb(ma){super.Dnb(ma);this.nJ.ex(Nb.a.t4h,{succeeded:!0,ao:{actionType:Hg.a.Rob}})}ypl(ma){if(ma.Rf){var Ua=this.yi.DLf(ma);if(Ua.RSc&&Ua.SSc){var xb=this.Tj.Eb(nb.a.Bf(Ua.SSc));Ua=Ua.SSc===Ua.RSc?null:this.Tj.Eb(nb.a.Bf(Ua.RSc));jb.a.LPg(xb,ma,!0);jb.a.LPg(Ua,ma,!1)}}}EYc(ma){super.EYc(ma);this.eB&&this.eB.id===ma.id&&(super.clearSelection(),this.lE&&this.US.yec());if(this.lE)if(ne.s(ma)){var Ua=[];let xb=null;for(const Xb of this.model.xR())Xb!==ma&&(Xb.Rf===ma.Rf&&Ua.push(Xb),
Xb.id===ma.Rf&&(xb=Xb));xb&&xb.id&&xb.objectId&&!xb.done&&this.Lp.yI(xb.objectId)&&!this.Lp.ctj(xb.objectId)&&!Ua.length&&this.bfd(xb,!0)}else Ua=ma.Dr===qd.a.bE,ma.done||this.bfd(ma,!0),Ua&&this.yi.VBj(ma.GA.draftId)}Sob(ma,Ua){1===this.mode&&ma&&(this.yi.MZc(ma,Ua),Hg.a.Rob===Ua.sessionType&&this.nJ.logKpiUsage(Lf.a.z4h,0),this.fj.u1b&&3!==Hg.a.IJf(Ua.sessionType)&&this.f5b.selectComment(ma,Object.assign(new wm.a,{i4:!1,qca:0})))}Qve(ma){this.lE&&!this.Dj.an||super.Qve(ma)}deleteComment(ma){ma.Dr!==
qd.a.bE&&this.Lp.gei(nb.a.Bf(ma.objectId));this.B2a&&this.B2a.id===ma.id&&(this.yi.iu&&this.B2a.id===this.yi.iu.id?this.B2a=null:this.mwa.Vnf());!this.yi.iu||this.yi.iu.id!==ma.id&&this.yi.iu.Rf!==ma.id?this.yi.iu&&this.mwa.vH(0,this.yi.iu,null):void 0===ma.Rf||null===ma.Rf?this.clearSelection():this.yi.selectComment(this.yi.EF(ma.Rf));ma.YWa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",ne.a(ma));super.deleteComment(ma);a.ULS.sendTraceTag(50426377,
327,50,`${ne.a(ma)} deleted by user action. DurableId: ${ma.H7a}`)}PLb(ma,Ua){super.PLb(ma,Ua);this.lE&&!this.Dj.an&&Ua&&(this.yi.iu&&this.yi.iu.id===ma.id&&this.clearSelection(),this.Xlc&&this.Xlc.id===ma.id&&this.mwa.Vnf())}DOo(ma=null){(ma=this.Lp.Emm(ma))?this.f5b.selectComment(ma,Object.assign(new wm.a,{i4:!0,qca:1})):this.EKj(1)}KHl(ma){var Ua,xb=this.Xva.Qc;if(xb){var Xb=ma.Qa.node,rc=null===(Ua=this.QHg.instance)||void 0===Ua?void 0:Ua.ZQb(Xb);if(rc)for(const Zc of xb.c7(rc))if(Zc&&Zc instanceof
Fh.a&&(Ua=Zc,xb=Ef.a.$$h(Ua),this.XEc.lFe=this.U6l(Xb,ma),rc=this.bkl(xb),null!==rc)){if(ma=this.XEc.K6l(xb,rc))xb.OKa[rc].appendChild(ma),Ua.hG(ma);break}}}U6l(ma,Ua){let xb;for(const Xb of ma.gJ)if(Xb&&Xb){xb=Xb;break}ma=Ua.Qa.zj;Ua=!(null===xb||void 0===xb||!xb.yp)&&0<xb.yp.length;return 0>ma||!Ua||null===xb||void 0===xb||!xb.qAf?null:Tc.a.f2(ma,xb,!1,!1)}bkl(ma){var Ua;const xb=null===(Ua=this.XEc.lFe)||void 0===Ua?void 0:Ua.y;for(const [Xb,rc]of ma.r7.entries())if(ma=xb-rc.y,-2<=ma&&ma<rc.height+
2)return Xb;return null}sbb(){mb.a.Grb=2===this.mode||3===this.mode;1!==this.mode&&this.XEc.P$d()}rqp(ma,Ua,xb){const Xb=this.Zb.currentScope;let rc=null;if(Ua||xb){Ua=ma.Qa.cpBegin;ma=ma.Qa.node;if(this.eB&&ne.r(this.eB,ma,this.Tj,Ua))return;rc=this.hBm(ma,Ua)}rc?!this.lE||this.Dj.an?Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.xKj(rc)},rh.a.wOo):this.xKj(rc):!this.yi.iu||Xb&&Xb.name===vf.AFrame.sR||this.clearSelection()}hBm(ma,Ua){let xb=null;const Xb=this.model.xR();for(let rc=Xb.length-1;0<=rc;rc--){const Zc=
Xb[rc];if(Zc.objectId&&!(Zc.Rf||this.lE&&!this.Dga.isVisible&&Zc.done)&&ne.r(Zc,ma,this.Tj,Ua)){xb=Zc;break}}return xb}selectComment(ma,Ua=1){this.f5b.yKj(ma,Object.assign(new wm.a,{i4:1===Ua,qca:Ua}))}BKj(ma,Ua){const xb=this.yi.EF(ma);xb?this.lE&&!ne.s(xb)&&xb.Dr!==qd.a.bE&&this.US.ZZa(ma,0,Ua):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ma=this.model.iu;this.BG&&ma&&this.BG.fireEvent(9,{comment:ma});super.clearSelection();this.mwa.vH(1,ma,ma);
this.lE&&ma&&this.US.yec()}Trn(){var ma;return 500>(null===(ma=this.iGh)||void 0===ma?void 0:ma.Ri)}fsc(ma,Ua=1){if(!this.fj.Lgj||!this.yi.$y){var xb=this.yi.EF(ma),Xb=null;xb||(Xb=this.B2a);var rc=this.Trn(),Zc=!1;1===Ua&&this.Uoa&&(rc?Zc=!0:this.Uoa.highlightComment(ma));ma?xb?rc?Zc=!0:this.xda.Mlc(xb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.xda.Mlc(null);xb?rc?Zc=!0:(this.B2a=xb,this.mwa.vH(2,xb,Xb)):(this.B2a=null,this.mwa.vH(3,
null,Xb));Zc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}Vdp(){this.ee&&(this.iGh=this.ee.Xf("UserAction","StartScrollDetectionStopwatch"))}notify(ma,Ua){this.Qp.sendNotification(ma,Ua)}sKg(){this.znb.onContentChanged()}SZh(ma,Ua){var xb,Xb;switch(ma){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.jap(Ua);case "OnContentFilterUpdate":return!(null===(Xb=(xb=this.znb).isContentInFilterUpdateDiff)||void 0===Xb?0:Xb.call(xb,
Ua.id));default:return!0}}jap(ma){return!ma.done&&this.Lp.Zsa(ma)===this.znb.isContentInFilteredContent(ma.id)}static getInstance(){return Bc.Qm()}static Qm(){Bc.gh||(Bc.gh=new Bc(rf.a.OAa(),new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),K.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,K.a.instance.resolve("Common.Comments.ICommentModel"),K.a.instance.resolve("Common.Comments.ICommentPane"),pf.getInstance(),y.AFrameworkApplication.va,new fb.a(()=>yk.a.instance),vm.FocusManager.instance(),
K.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),K.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),K.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),K.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings"),K.a.instance.resolve("Common.Utils.IAriaNotifier"),K.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),K.a.instance.resolve("WordEditor.Comments.CommentsState"),
K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),tl.a.hm.kb.Qc,re.StaticActiveAppFrame.za().Vr,K.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),K.a.instance.Ta("WordEditor.HeaderFooter.HeaderFooterControlOwner"),K.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),K.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),K.a.instance.Ta("WordEditor.Extension.RichApiEventManager"),K.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")),
Bc.gh.e0b=!0);return Bc.gh}}Bc.gh=null;Object(f.a)(Bc,"EditorCommentManager",rl.a,[279,280,281,10]);var Qm=d(1790);class mm{constructor(ma,Ua,xb,Xb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ma;this.body=Ua;this.confirmButton=xb;this.cancelButton=Xb}}Object(f.a)(mm,"ViewContainerModalDialogStrings",null,[]);d(1390);class Eg{constructor(ma,Ua){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;
this.delayActionsUntilRegistration=!1;this.canvasActionId=ma;this.canvasContextId=Ua}}Object(f.a)(Eg,"CommentUIAction",null,[]);var Xh=d(1527);class rq{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg,bi,zh,Ah,Zi){this.ga=ma;this.$g=Ua;this.oe=xb;this.Zb=Xb;this.gq=rc;this.ii=Zc;this.V5=Hd;this.lwa=Jd;this.vPd=Xd;this.Fbf=je;this.Jb=af;this.US=Wf;this.fj=Mg;this.Dj=bi;this.f5b=zh;this.h1=Ah;this.Roa=Zi;this.$Me=this.Cj=null;this.lEh=this.k8g=!1;this.YNc=null;this.y8o=(sk,gm,Gj)=>2!==Gj||this.Dj.IX?
1===Gj?32:2:(this.h1.T3("OnCommentInit",Object.assign(new Nj.a,{kMa:()=>{this.ga.Ob(aj.a.K0,2)}})),32);this.PTf=(sk,gm,Gj)=>1!==Gj||this.Dj.IX?2:8;this.KUk=(sk,gm,Gj)=>{if(1===Gj)return!this.Wsb()||this.Ulb?8:this.Dj.IX?2:32;if(!this.Dj.IX)return this.Ulb=!0,this.h1.T3("OnCommentInit",Object.assign(new Nj.a,{kMa:()=>{this.Fr||this.Dj.an||this.ga.Ob(aj.a.K0,2)}})),32;this.Fr||this.Dj.an||this.ga.Ob(aj.a.K0,2);(this.Fr||this.Dj.an)&&this.Zb.Gg(this.Dj.an?vf.AFrame.xt:vf.AFrame.sR);return 2};this.YPl=
(sk,gm,Gj)=>1===Gj&&dg.SessionStatusManager.instance.Jk?8:2;this.FUl=(sk,gm,Gj,En)=>1!==En||(this.Fr||this.isVisible)&&this.Cj.model.iu?sk||this.Cj.model.iu?32:8:8;this.Trb=(sk,gm,Gj,En,Rm)=>{if(1===Gj||!this.Dj.an)return 32;if(!this.Fr&&2===Gj&&(2===this.Cj.mode||3===this.Cj.mode))return Rm=new mm(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.vPd.invokeModalConfirmationDialog(()=>{this.PXn(sk,
gm,Gj,En)},()=>{this.UWn()},Rm),32;this.R$d();if(this.Fr)return 32;Rm&&this.Uii();return 32};this.Euc=(sk,gm,Gj,En,Rm)=>{if(1===Gj)return 32;Rm[Lk.a.On]=this.isVisible;return 32};this.ZCc=this.sDl()}get isVisible(){return this.Dj.an}get Ulb(){return this.k8g}set Ulb(ma){this.k8g=ma}get g2o(){return"SharedCommentsTaskPaneProps"}get xgd(){return null}get ngj(){return null}get ZM(){return this.gq}get Dga(){return null}get mwl(){return this.lwa}get Fr(){try{return this.fj.Fr}catch(ma){return!1}}jBi(){return new Ve(y.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}sDl(){const ma=new wl.a,Ua=new Eg(aj.a.dMa,ii.a.frame);Ua.preCallback=this.KUk;const xb=new Eg(Nb.a.Zag,ii.a.frame),Xb=new Eg(Nb.a.clg,ii.a.frame),rc=new Eg(Nb.a.deleteComment,ii.a.frame);rc.preCallback=this.YPl;rc.postCallback=this.FUl;const Zc=new Eg(Nb.a.HHj,ii.a.frame);this.Fr&&(xb.preCallback=this.PTf,Xb.preCallback=this.PTf,Zc.preCallback=this.PTf);const Hd=new Eg(aj.a.K0,ii.a.frame);Hd.preCallback=
this.y8o;ma.W(6,Hd);ma.W(0,Ua);ma.W(1,xb);ma.W(2,Xb);ma.W(3,rc);ma.W(7,Zc);return ma}cRj(ma){this.lEh||(this.SPk=this.g8d(),this.V5.iUa(),this.p1o(),this.j1o(ma),this.lEh=!0)}j1o(ma){this.Cj=ma;this.$Me=ma.Nlc;this.Cj.hli=this.lwa}initialize(ma){this.cRj(ma);this.Xb()}kUf(){this.YNc&&this.Zb.Gg(vf.AFrame.xt);this.Ulb&&!this.Fr?(this.ga.Ob(aj.a.dMa,2),this.Ulb=!1):this.Dj.Bnb&&Hf.a.f6(y.AFrameworkApplication.pc,()=>{const ma=this.Dj.Bnb.commentId,Ua=this.Dj.Bnb.G$c;this.ga.Qb(Nb.a.selectComment,2,
Object.assign(new wm.a,{commentId:ma,qca:1,i4:!0,P8c:Ua}));Ua&&(Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.Zb.Gg(vf.AFrame.xt)},rh.a.Zxg),Tf.a.instance.rf(pp.a.Jci,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.YK);this.Dj.Bnb=null},rh.a.vOo)}dispose(){}D8(){}selectComment(){this.isVisible||this.Fr||this.zUj();this.ii.Ge(!0)}Xb(){this.ga.qa(aj.a.Trb,ii.a.frame,this.Trb);this.ga.fb(aj.a.Euc,
ii.a.frame,this.Euc,96)}sbb(){-1!==this.Cj.mode&&(this.Cj.mode||this.Uii())}Uii(){const ma=this.Cj,Ua=ma.Lp,xb=Ua.o7d(),Xb=Ua.aHf(this.fj.G0b&&this.fj.Fr&&!this.Dj.an);this.lwa.DPo(Xb.length,xb,!ma.mode,xb?5:1);this.lwa.dQo(Xb,Ua.u1a)}p1o(){const ma=this.Zb.ie(vf.AFrame.xt);ma.parent=vf.AFrame.Gq;ma.IL=!0;ma.Iue=!0;ma.MAb=!0;ma.w5a((Ua,xb)=>{Me.a.RZh(xb.name)&&(this.Dj.wWb=Hf.a.f6(this.Jb,()=>{xb.name!==vf.AFrame.sR&&2!==this.Cj.mode&&3!==this.Cj.mode&&(this.Cj.clearSelection(),this.ii.Ge(!0));this.Dj.wWb=
null},rh.a.FXn))});this.gq.xW(vf.AFrame.xt);for(const Ua of ne.u)ma.bindAction(Nc.KeyInputManager.Vw(Ua),Nb.a.Ilf)}LUo(){this.YNc&&this.Fbf.Kbm()}R0h(){this.dwk&&this.LUo()}PXn(ma,Ua,xb,Xb){const rc=this.Cj,Zc=rc.Lp.$y;Zc&&Zc.GA?rc.ipf.endCommentSession(Zc.GA.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Trb(ma,Ua,xb,Xb,!0);Hf.a.f6(this.Jb,()=>{this.ii.Ge(!0)},rh.a.WJo)}UWn(){this.YNc&&this.Zb.Gg(vf.AFrame.xt);this.ii.Ge(!0)}bNa(ma){ma.ot(this.Zb.BZ);
ma.ot(this.Zb.CZ)}w0b(ma,Ua,xb){if(1===xb)return 32;this.zUj();return 32}zUj(){this.isVisible||(this.Dj.RNa=!0,this.Dj.IX?(this.DVl(),this.Dj.an=!0,this.h1.vse(),this.Zb.VRc(vf.AFrame.xt),this.Fr&&this.fj.G0b&&this.Cj.Zwb(this.Cj.model.BGf(()=>!0)),this.dwk=!0,jk.UISurfaces.Lv().then(ma=>{ma.showTaskPane(lm.a.vWd,this.SPk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Cj.fsc(null),this.ii.Ge(!0),this.bNa(this.Zb.ie(vf.AFrame.xt)),this.h1.T3("OnCommentPaneOpen"),
a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.h1.T3("OnCommentInit",Object.assign(new Nj.a,{kMa:()=>{this.Dj.an||this.ga.Ob(aj.a.K0,2)}})))}DVl(){this.ga.Qb(Nb.a.L6,2,null);this.ga.Qb(Nb.a.SW,2,null)}Wsb(){return this.Roa.Wsb(this.ga,!1)}mKb(){}show(){this.isVisible||this.ga.Ob(aj.a.K0,2)}Sob(){return 2}R$d(){this.Cj.D9n();this.Dj.an=!1;if(this.Fr&&this.fj.G0b){const Ua=this.Cj.model;this.Cj.Zwb(Ua.BGf(xb=>Ua.Zsa(xb)))}var ma=vm.FocusManager.instance();ma.currentScope&&ma.currentScope.name===
vf.AFrame.xt&&ma.Gg(this.Fr&&(2===this.Cj.mode||3===this.Cj.mode||this.Cj.rj.iu)?vf.AFrame.sR:ma.QW);this.gq.Dx(vf.AFrame.xt);this.Zb.mYc(vf.AFrame.xt);jk.UISurfaces.Lv().then(Ua=>{Ua.hideTaskPane(lm.a.vWd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Fr&&(ma=this.Cj.model.iu)&&this.wwp(ma);this.h1.T3("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}wwp(ma){ma.done?this.Cj.clearSelection():this.f5b.Wii(ma)}K4n(ma=
null){this.Fbf.yQj(3);this.kUf();if(ma){this.R0h();Ml.a.bte(ma,[ff.a.contextMenu]);const Ua=this.Zb.ie(vf.AFrame.xt);this.$g.iSc(vf.AFrame.xt,ma,Ua.MAb)}}t2n(ma){this.gq.QK(vf.AFrame.xt);1!==ma&&Hf.a.f6(y.AFrameworkApplication.pc,()=>{this.Zb.RE(vf.AFrame.xt)},rh.a.Zxg)}onTaskPaneClose(){this.Dj.IX&&this.Fbf.yQj(1)}g8d(){const ma={type:this.g2o,U1p:this.R0h};return Object.assign(new Xh.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ma,hideHeader:!1,width:300,location:2,onOpen:Ua=>
{this.YNc=Ua;this.K4n(Ua);this.US.EHg(!0)},onClose:()=>{this.YNc=null;this.ga.Qb(aj.a.Trb,2,!0);this.ii.Ge(!0);this.onTaskPaneClose();const Ua=this.Cj.Lp;this.Dj.RNa&&Ua.H5c()&&this.US.EHg(!1)},onShow:Ua=>{this.t2n(Ua)}})}K0(){return 32}}Object(f.a)(rq,"OfficeSharedCommentPane",null,[10,272,273]);var on=d(1679),Dl=d(175);class Zm{constructor(ma,Ua){this.containerType="full-pane";this.identifier=null;this.ga=ma;this.identifier=Ua}openView(){this.ga.Ob(aj.a.w0b,2)}closeView(){this.ga.Qb(aj.a.Trb,2,
!0)}invokeModalConfirmationDialog(ma,Ua,xb){const Xb=new Dl.StandardDialog;xb&&xb.title&&xb.body&&xb.confirmButton&&xb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),xb=new mm("","","",""));Xb.Bd=1;Xb.Ke(1,xb.confirmButton);Xb.Ke(0,xb.cancelButton);Xb.sw(xb.title,xb.body,1,rc=>{1===rc?ma():Ua()})}}Object(f.a)(Zm,"ViewContainerAPI",null,[270,271]);class tj{constructor(ma,Ua,xb){this.Gnp=ma;this.Mg=Ua;this.zOa=xb;this.jd=new Na.a;this.Gnp.execute(Xb=>
{this.zOa.jte("OnBeforeTrackChangeMarkupViewChange",(rc,Zc)=>{Zc&&Zc.Lag!==Xb.Gk&&this.jd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Zc)});this.zOa.jte("OnAfterTrackChangeMarkupViewChangeEventKey",(rc,Zc)=>{Zc&&Zc.Gk===Xb.Gk&&(Uh.Gk=Xb.Gk,this.jd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Zc))})})}V3(ma,Ua){this.jd.addHandler(ma,Ua)}T3(ma,Ua){this.jd.raiseEvent(ma,Ua)}vse(){this.Mg.Gog||(this.Mg.Gog=!0,this.jd.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(tj,"WordCommentEventsActor",
null,[]);var qj=d(1860);class Fk{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(Fk,"InitCommentSessionResult",null,[]);class Jq extends Fk{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(f.a)(Jq,"BeginDraftingHostResult",Fk,[]);var Zr=d(2182),kc=d(2125),ck=d(1042);class pn{constructor(ma,Ua,xb,Xb,rc,Zc,Hd,Jd,Xd,je,af,Wf,Mg,bi,zh){this.Zi=ma;this.lwa=Ua;this.tmk=xb;this.Nop=Xb;
this.yWd=rc;this.Vt=Zc;this.Zu=Hd;this.focusManager=Jd;this.$P=Xd;this.Pb=je;this.ml=af;this.k2=Wf;this.Mg=Mg;this.Owl=bi;this.Mwl=zh;this.H9b=this.g$=this.lp=null;this.irk="WordWebCommitNewCommentActivity";this.jrk="WordWebCommitTaskActivity";this.frk="WordWebCommentReactionActivity";this.Qbh=null}get Roa(){return this.g$}bgo(ma){var Ua;const xb=this.Roa.$y,Xb=this.g$.xR();if(Xb&&xb){const rc=ck.a.Apb(null!==(Ua=xb.authorId)&&void 0!==Ua?Ua:"");Ua=new qj.a(xb.authorId,xb.ndc,xb.author,null!==rc&&
void 0!==rc?rc:"",!0);ma.author=Ua;ma.insertIndex=Array.indexOf(Xb,xb);ma.authorName=xb.author;ma.authorIdentity="";return null}return Hf.a.xF(-2130915320)}initialize(ma,Ua,xb,Xb){this.lp=ma;this.g$=Ua;this.H9b=xb;this.Qbh=Xb}beginDraftingAsync(ma){if(!ma)return new Promise((Xb,rc)=>{rc(Hf.a.xF(-2130915327))});const Ua=new Jq,xb=Hg.a.IJf(ma.sessionType);return void 0===xb||null===xb?new Promise((Xb,rc)=>{rc(Hf.a.xF(-2130915317))}):new Promise((Xb,rc)=>{Hf.a.f6(this.Zi,()=>{if(1!==this.lp.mode)a.ULS.sendTraceTag(40130753,
327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.lp.mode),rc(Hf.a.xF(-2130915325));else{this.q0h();try{switch(xb){case 0:if(!this.lp.Dga.Wsb()){rc(Hf.a.xF(-2130915326));return}this.Owl.P$d();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ma.draftId}`);this.lp.mKb(ma);break;case 1:if(!ma.threadId||""===ma.threadId){rc(Hf.a.xF(-2130915324));return}if(this.Vt.Sze){const Jd=this.g$.EF(ma.threadId);if(Jd){const Xd=this.g$.fvi(Jd,!1),je=Zr.a.GPb(Jd,Xd,Jd.authorId===this.Vt.A0);
je&&this.yWd.invoke(ma.threadId,je)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.lp.mode)}this.lp.Vlb(ma.threadId,ma);break;case 3:if(!ma.threadId||""===ma.threadId){rc(Hf.a.xF(-2130915324));return}var Zc=this.g$.EF(ma.threadId);if(!Zc){rc(Hf.a.xF(-2130915323));return}this.lp.Sob(Zc,ma);break;case 2:if(!ma.commentId||""===ma.commentId){rc(Hf.a.xF(-2130915324));return}const Hd=this.g$.EF(ma.commentId);if(!Hd){rc(Hf.a.xF(-2130915323));return}this.lp.Sob(Hd,
ma)}}catch(Hd){rc(Hd);this.aGj();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Hd} on Session ${xb}`);return}(Zc=this.bgo(Ua))?rc(Zc):Xb(Ua);this.aGj()}},rh.a.beginDraftingAsync)})}commit(ma,Ua,xb){const Xb=this.Roa.$y;if(!Xb)throw Hf.a.xF(-2130915320);var rc=Xb.GA;if(!rc)throw Hf.a.xF(-2130915320);const Zc=Hg.a.IJf(rc.sessionType);if(void 0===Zc||null===Zc)throw Hf.a.xF(-2130915317);if(ma!==rc.draftId)throw Hf.a.xF(-2130915327);let Hd=!1,Jd=!1;rc=!1;switch(Zc){case 3:if(!xb)throw Hf.a.xF(-2130915327);
break;case 0:this.ml.le(()=>{if(!this.lp.Dga.Wsb())throw Hf.a.xF(-2130915326);Xb.text=[Ua];this.lp.lE&&!this.Mg.an?this.lp.ebo(()=>{this.lp.eza(Xb);this.lp.C_l(ma,Xb.id)}):this.lp.eza(Xb);Jd=xb&&null!=xb.Task;Hd=!0;Hf.a.f6(this.Zi,()=>{this.Xxb(Xb.id)},rh.a.Xxb)},"WESCA:C:C");break;case 1:this.ml.le(()=>{Xb.text=[Ua];this.lp.eza(Xb);Jd=xb&&null!=xb.Task;Hd=!0},"WESCA:C:R");break;case 2:this.ml.le(()=>{Xb.text=[Ua];this.lp.Dnb(Xb);this.Dvj(Nb.a.XDn)},"WESCA:C:E");break;default:throw Hf.a.xF(-2130915322);
}xb&&(xb.Resolve&&(this.YMj(Xb,xb.Resolve.isResolved),xb.Resolve.isResolved&&!this.Mg.an&&this.lp.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),xb.Task&&this.lp.nxl(Xb,xb.Task),xb.Reaction&&(rc=!0,xb.Reaction.isActive?this.lp.AQd(Xb,xb.Reaction.reactionType):this.lp.wte(Xb,xb.Reaction.reactionType)));this.Vt.exl&&Jd&&this.$P.execute(Xd=>Xd.logActivity(this.jrk,"CommentsTasksFpsIsEnabled"));Hd&&this.$P.execute(Xd=>{Xd.logActivity(this.irk,"CommentsFpsIsEnabled")});rc&&this.$P.execute(Xd=>{Xd.logActivity(this.frk,
"CommentReactionsFpsIsEnabled")});return Xb.id}endCommentSession(ma){const Ua=this.Roa.$y;if(Ua){if(Ua.GA&&Ua.GA.draftId!==ma)throw Hf.a.xF(-2130915327);if(Ua.Dr===qd.a.bE)this.lp.deleteComment(Ua),!this.lp.lE||Ua.Rf||this.Mg.an||this.focusManager.Gg(vf.AFrame.Do);else{if(3!==this.lp.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}Ua.Dr=qd.a.normal;Ua.XZa=kc.a.succeeded;Ua.GA=null;this.lp.Emf()}}this.Zu&&this.Zu.Ge(!0);this.Roa.o7d()||
this.lwa.OKg(1,!this.lp.mode)}deleteComment(ma){(ma=this.g$.EF(ma))?(this.lp.deleteComment(ma),this.lp.lE&&!this.Mg.an?ma.Rf||this.focusManager.Gg(vf.AFrame.Do):this.focusManager.RE(vf.AFrame.xt),this.Nop.ZAg(ma)&&this.Dvj(Nb.a.U9i)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ma){this.Xxb(ma,0)}highlightComment(ma){this.lp.fsc(ma,0)}setThreadResolvedState(ma,Ua){(ma=this.g$.EF(ma))&&this.YMj(ma,Ua)}YMj(ma,Ua){if(ma.Rf&&""!==ma.Rf)throw Hf.a.xF(-2130915321);
this.lp.PLb(ma,Ua);Ua&&!this.Mg.an&&this.focusManager.Gg(vf.AFrame.Do)}presentLinkToComment(ma){var Ua=this.g$.EF(ma);Ua?(Ua=this.Roa.E5d(Ua))?(ma={["nav"]:btoa(`{"${ce.a.comment}":${Ua}}`),["mode"]:"copy"},this.Mwl.ex(Nb.a.presentLinkToComment),this.Pb.Qb(aj.a.Daa,2,ma,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ma):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",ma)}selectFirstThreadInNextCommentContext(){this.lp.EKj(0)}selectLastThreadInPreviousCommentContext(){this.lp.EOo()}registerForCommentEvents(ma){const Ua=
this.Roa.aHf(this.Vt.G0b&&this.Vt.Fr&&!this.Mg.an),xb=this.Roa.u1a,Xb=this.Roa.o7d(),rc=!this.lp.mode;this.lwa.cZo();this.Qbh.vAm().then(Zc=>{this.lwa.bwo(ma,Ua,Xb,rc,xb,Zc);this.lwa.OKg(Xb?5:1,rc);this.Zu&&this.Zu.Ge(!0)})}unregisterForCommentEvents(ma){this.lwa.d2b(ma)}registerForAction(ma,Ua){this.tmk.xZa(ma,Ua)}unregisterForAction(){}checkAtMentionCapability(){return this.H9b?this.H9b.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),
new Promise(ma=>{ma(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}q0h(){const ma=this.lp.lE&&!this.Mg.an?vf.AFrame.sR:vf.AFrame.xt;if(ma===vf.AFrame.xt){if(!this.Mg.an)return;jk.UISurfaces.Lv().then(Ua=>{Ua.setSelectedTaskPane(lm.a.vWd);return null})}this.focusManager.RE(ma)}Xxb(ma,Ua=1){this.q0h();this.k2.yKj(ma,Object.assign(new wm.a,{qca:Ua,i4:1===Ua}))}aGj(){this.lp.Dga.Ulb&&(this.lp.Dga.Ulb=!1)}Dvj(ma){this.Pb.Ob(ma,
2)}}Object(f.a)(pn,"WordEditorSharedCommentAPI",null,[268,269]);class Ul{constructor(ma,Ua,xb,Xb,rc,Zc,Hd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ma;this.parentId=Ua;this.commentBody=xb;this.author=Xb;this.date=rc;this.commentFlags=Zc;this.usersByReactionType=Hd}}Object(f.a)(Ul,"OfficeSharedCommentModel",null,[]);d(1653);class Kq{constructor(ma,Ua){this.Aa=ma;this.EUb=Ua;this.hMh="AD";this.WEc=
new pa.a;this.rbf=new pa.a;this.gbl=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.Nbh=new ql.a}get userPrincipalName(){return this.Aa.jb("UserPrincipalName")}get ycb(){return this.Aa.jb("PresenceProvider")}get A0(){return this.Aa.jb("PresenceUserId")}get Tj(){return this.EUb.value}Zgj(ma){const Ua=this.gbl.exec(ma);return Ua?Ua[1]:ma}zGi(ma,Ua=!1){let xb=0;ma.done&&(xb=ma.Rf&&""!==ma.Rf?xb|4:xb|8);ma.C6h&&(xb|=2);Ua&&(xb|=1);this.ZAg(ma)&&(xb|=16);ma.sZf&&(xb|=32);this.VZm(ma)||(xb|=128);return xb}VZm(ma){return ma?
(ma=this.Tj.Eb(ma.objectId))?ma.hasProperty(Ta.a.y6):!1:!1}ZAg(ma){if(!ma)return!1;if(void 0===ma.authorId||null===ma.authorId||""===ma.authorId)return this.G5f(ma.id,ma.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.A0||null===this.A0||""===this.A0)return this.G5f(ma.id,ma.objectId,"PresenceUserId null or empty"),!1;if(this.A0==ma.authorId&&ma.ndc==this.ycb)return!1;const Ua=this.T1d(ma.authorId),xb=this.T1d(this.A0);if(this.ycb===this.hMh&&Ua&&xb&&Ua[0]!=this.userPrincipalName&&
Ua[1]!=xb[1])return!0;this.G5f(ma.id,ma.objectId,"Unknown");return!1}isCurrentUser(ma){if(!ma||void 0===ma.authorId||null===ma.authorId||""===ma.authorId||void 0===this.A0||null===this.A0||""===this.A0)return!1;if(this.A0==ma.authorId&&ma.ndc==this.ycb)return!0;ma=this.T1d(ma.authorId);const Ua=this.T1d(this.A0);return this.ycb===this.hMh&&ma&&Ua?ma[0]==this.userPrincipalName||ma[1]==Ua[1]:!1}T1d(ma){if(void 0===ma||null===ma)return null;ma=ma.split("::");return 3===ma.length?ma.slice(1,3):null}G5f(ma,
Ua,xb){ma&&!this.Nbh.contains(ma)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${Ua}; reason: ${xb}`),this.Nbh.add(ma))}cri(ma,Ua){var xb;if(!ma)return null;const Xb=ma.ffe;let rc=!1;ne.x(Ua,void 0)&&(rc=!0);Ua=ma.author?this.Zgj(ma.author):"";const Zc=ck.a.Apb(null!==(xb=ma.authorId)&&void 0!==xb?xb:"");xb=new qj.a(ma.authorId?ma.authorId:"",ma.ndc,Ua,null!==Zc&&void 0!==Zc?Zc:"",this.isCurrentUser(ma));return new Ul(ma.id?ma.id:"",ma.Rf?ma.Rf:"",ma.text&&ma.text.length?
ma.text[0]:null,xb,ma.date||Xb?ma.date:new Date,this.zGi(ma,rc),this.BGi(ma.usersByReactionType))}aem(ma,Ua,xb){const Xb=[],rc=new pa.a;if(!ma)return Xb;for(const Zc of ma)Zc.Dr!==qd.a.bE&&xb(Zc)&&(Zc.id&&this.WEc.tb(Zc.id)?(ma=this.WEc.K(Zc.id),ma=this.bIl(Zc,ma,Ua),Xb.push(ma),rc.W(Zc.id,ma)):Zc.id?(ma=this.cri(Zc,Ua),Xb.push(ma),rc.W(Zc.id,ma)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.WEc=rc;return Xb}zkm(ma,Ua,xb){const Xb=[];for(const rc of ma)rc.Dr!==qd.a.bE&&
xb(rc)&&(rc.id&&this.WEc.tb(rc.id)?Xb.push(this.WEc.K(rc.id)):rc.id&&Xb.push(this.cri(rc,Ua)));return Xb}bIl(ma,Ua,xb){var Xb=ma.ffe,rc=ne.x(xb,void 0);xb=ma.Rf?ma.Rf:"";const Zc=ma.text&&ma.text.length?ma.text[0]:null,Hd=ma.author?this.Zgj(ma.author):"",Jd=ma.authorId?ma.authorId:"",Xd=ma.ndc?ma.ndc:"",je=ck.a.Apb(Jd);Xb=ma.date||Xb?ma.date:new Date;rc=this.zGi(ma,rc);const af=this.isCurrentUser(ma),Wf=this.BGi(ma.usersByReactionType);return Ua.parentId===xb&&Ua.commentBody===Zc&&Ua.author.DisplayName===
Hd&&Ua.author.UserId===Jd&&Ua.author.Provider===Xd&&Ua.author.IsCurrentUser===af&&Ua.date===Xb&&Ua.commentFlags===rc&&this.F$k(Ua.usersByReactionType,Wf)?Ua:(Ua=new qj.a(Jd,Xd,Hd,null!==je&&void 0!==je?je:"",af),new Ul(ma.id,xb,Zc,Ua,Xb,rc,Wf))}F$k(ma,Ua){if(!ma&&!Ua)return!0;if(!Ua||!ma)return!1;var xb=Object.keys(ma);if(xb.length!==Object.keys(Ua).length)return!1;for(const Xb of xb){if(!(Xb in Ua))return!1;xb=ma[Xb];const rc=Ua[Xb];if(xb.length!==rc.length)return!1;for(let Zc=0;Zc<xb.length;Zc++)if(!this.u$k(xb[Zc],
rc[Zc]))return!1}return!0}u$k(ma,Ua){return ma||Ua?ma&&Ua&&ma.UserId===Ua.UserId&&ma.Provider===Ua.Provider&&ma.Email===Ua.Email&&ma.DisplayName===Ua.DisplayName&&ma.IsCurrentUser===Ua.IsCurrentUser?!0:!1:!0}BGi(ma){if(!ma)return null;const Ua={},xb=this.Aa.jb("PresenceUserId");for(const rc of Object.keys(ma)){const Zc=[];var Xb=ma[rc];for(const Hd of Xb){Xb=Hd.UserId===xb;let Jd;this.rbf.tb(Hd.UserId)?(Jd=this.rbf.K(Hd.UserId),Jd.IsCurrentUser=Xb):(Jd=new qj.a(Hd.UserId,Hd.Provider,Hd.DisplayName,
Hd.Email,Xb),this.rbf.add(Hd.UserId,Jd));Zc.push(Jd)}Ua[rc]=Zc}return Ua}}Object(f.a)(Kq,"WordEditorSharedCommentModelTranslator",null,[267]);class Tm{constructor(){this.eq=null;this.Jwd=this.Rzh=this.p9g=this.fHh=this.bKh=this.Fvh=this.UBh=!1}AGi(){this.eq||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.FPj());return this.eq}vAm(){return new Promise((ma,Ua)=>{this.Jwd?ma(this.PBi()):this.wMj().then(()=>{ma(this.PBi())}).catch(xb=>
{Ua(xb)})})}PBi(){this.Jwd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ma;ma=33;this.p9g&&(ma|=2);this.UBh&&(ma|=8);this.bKh&&(ma|=16);this.Fvh&&(ma|=4);this.fHh&&(ma|=64);this.Rzh&&(ma|=128);return ma}}Object(f.a)(Tm,"OfficeSharedCommentsAppCapabilities",null,[1776]);class Eo extends Tm{constructor(ma){super();this.uxa=null;this.fj=ma;this.q_o();this.FPj()}q_o(){this.fHh=this.fj.u1b;
this.bKh=!1;this.Rzh=this.Fvh=this.UBh=!0}initialize(ma){this.uxa=ma;this.wMj()}FPj(){this.eq={};this.eq.LivePersonaPicker="true";this.eq.PersonaColor="true";this.eq.DiscreteHostedComments=this.fj.gVl.toString();this.eq.NewCommentButton="true";this.eq.DisabledChangeGates=this.fj.YUl;this.eq.CommentsFluentUI="true";this.eq.CommentTasks=this.fj.u1b.toString();this.eq.CommentTasksFromReply=this.eq.CommentTasks;this.eq.CommentFriendlyTimestamps=this.fj.pwl.toString();this.eq.AtMentionFloodgateSurvey=
this.fj.Eal.toString();this.eq.HyperlinksInComments="true";this.eq.LogDraftCommentIdPair="true";this.eq.RichTextFormattingInWeb="true";this.eq.RichContentEditIntegration="true";this.eq.HyperlinksWithDisplayText="true";this.eq.SmartReplies=this.fj.Sze.toString();this.eq.LinkToComment="true";this.eq.TaskPaneWithNewInfrastructure="true";this.eq.CommentReactions="true";this.eq.WebThemeIntegration="true";this.eq.NewSelectionInteractions="true";this.eq.HighlightsAndFontColorInWebComments="true";this.eq.TruncationUIWithReadMoreText=
"true";this.eq.CtrlEnterTip="true";this.eq.AtMentionHintMessage="true";this.eq.LivePersonaCardForWeb="true";this.eq.TaskHistoryRecordIDs=this.fj.djp.toString();this.eq.ContentNavigation=this.fj.contentNavigationApiEnabled.toString();this.eq.RibbonCommentFilteringEnabled=this.fj.ribbonCommentFilteringEnabled.toString()}wMj(){return new Promise((ma,Ua)=>{this.uxa?this.uxa.atMentionsEnabledAsync().then(xb=>{this.p9g=xb;this.Jwd=!0;ma(this.Jwd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),
Ua(Hf.a.xF(-2130915320)))})}}Object(f.a)(Eo,"WordSharedCommentsAppCapabilities",Tm,[266]);class Dn{constructor(){this._initialized=!1;this.dxl={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Lf.a.JBf,vetoPillar:7};this.ljp={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:on.a.JBf,vetoPillar:7}}get ecb(){return null!=this.w1g?this.w1g:this.w1g=(()=>this.Z.resolve("Box4.IPackageBootPerfLogger"))()}Y1(ma){this.ecb.Y1(el.a.comments,ma,!0)}get name(){return"WordEditor.Comments"}wc(ma){this.Z=
ma;this.Y1("CPConfigStart");ma.ia("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new we.a(Y.Health.instance,new ri.a,this.dxl)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();ma.ia("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new we.a(Y.Health.instance,new ri.a,this.ljp)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();ma.ia("WordEditor.Comments.CommentNodeTracker",()=>new cj(this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();
ma.ia("WordEditor.Comments.CommentsSettings",()=>new fl(y.AFrameworkApplication.J,this.Z.resolve("Box4.IFeatureHelper"),new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd),new fb.a(()=>Tj.a.instance),this.Z.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();ma.ia("WordEditor.Comments.CommentsState",()=>new Uh).ha();ma.ia("WordEditor.Comments.WordCommentEventsActor",()=>new tj(ma.Ta("Box4.TrackChange.ITrackChangeManager"),
ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();ma.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Kq(y.AFrameworkApplication.J,new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();ma.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Mc(ma.resolve("WordEditor.Comments.CommentsSettings"),ma.resolve("Box4.Styles.IWACStyleReader"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();
ma.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new Bl(y.AFrameworkApplication.pc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();ma.ia("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Sh(this.Z.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();ma.ia("WordEditor.Comments.EditorCommentModel",Qm.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();
ma.ia("WordEditor.Comments.ICommentModelBootLoader",()=>new Jh(new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd),new fb.a(()=>Tj.a.instance),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.Comments.CommentsSettings"),ma.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ma.ia("WordEditor.Comments.ICommentFilterActor",()=>new lc(ma.resolve("WordEditor.Comments.IEditorCommentModel"),
y.AFrameworkApplication.J,ma.resolve("WordEditor.Comments.WordCommentEventsActor"),ma.resolve("WordEditor.Comments.CommentsState"),ma.Ta("Common.ISystemInitiatedFeedback"))).ha();ma.resolve("WordEditor.Comments.ICommentFilterActor");ma.ia("WordEditor.Comments.CommentHighlightOnRestActor",()=>new xc(new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.WordCommentEventsActor"),
ma.resolve("Box4.INotebookManager").Tl,va.a.instance,this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),ma.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();ma.ia("WordEditor.Comments.CommentHighlightUtils",()=>new Lc(ma.resolve("Box4.Highlight.IHighlightManager"))).ha();ma.ia("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Ke(ma.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();ma.ia("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",
()=>new kf(ma.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ma.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ua.S8,y.AFrameworkApplication.ua.sOa,y.AFrameworkApplication.va,y.AFrameworkApplication.pc,ma.resolve("WordEditor.Comments.CommentsState"),ma.Ta("WordEditor.Comments.IEditorCommentManager"))).ha();ma.ia("WordEditor.Comments.CommentHighlightActor",()=>new Wk(new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),ma.resolve("WordEditor.CommentsInteractive.ICommentEditor"),
ma.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ma.Ta("WordEditor.Comments.IEditorCommentManager"),va.a.instance,ma.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ma.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ma.resolve("WordEditor.Comments.CommentHighlightUtils"),ma.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();ma.ia("WordEditor.Comments.CommentHintActor",()=>new Wg(ma.resolve("WordEditor.Comments.CommentsSettings"),
Ll.a.instance,fn.a.instance,Yn.a.instance,y.AFrameworkApplication.va,sl.TableCellReader.hnn,Ym.moveToLastRenderedCellOfTheRow,new yi.a,ma.Ta("Box4.ContentControlConfigSettings"),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.ICommentHighlightActor"),ma.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();
ma.ia("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Te(Ll.a.instance,Yn.a.instance,y.AFrameworkApplication.va,ma.Ta("Common.IZoomManager"))).ha();ma.ia("WordEditor.Comments.ViewContainerAPI",()=>new Zm(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();ma.ia("Common.Comments.CommentActivationManager",()=>new Tl).as("Common.Comments.ICommentActivationManager").ha();ma.ia("Common.Comments.ViewContainerEventHost",()=>new jm(y.AFrameworkApplication.pc,
"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();ma.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new Uk(this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();ma.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",
()=>new Eo(ma.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();this.Y1("CPConfigEnd")}init(){this.Y1("CPInitStart");const ma=this.Z.resolve("Box4.IFeatureHelper"),Ua=ma.er.isCompleted;mb.a.tnc&&Ua?this.XPg():ma.er.continueWith(()=>{this.XPg()})}XPg(){try{this.Ho(),this.Y1("CPInitEnd")}catch(ma){throw a.ULS.lz(524300632,327,10,ma,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ma),this.ecb.Hw(el.a.comments,
"CPInitException",ma,!0),ma;}}Ho(){const ma=this.Z.resolve("WordEditor.Comments.CommentsSettings");this.Y1("onAfterGFNLoadedStart");this.Z.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new rq(y.AFrameworkApplication.va,y.AFrameworkApplication.ua.XE,y.AFrameworkApplication.ua.YE,y.AFrameworkApplication.ua.tq,y.AFrameworkApplication.ua.Ky,re.StaticActiveAppFrame.za(),Dk.a.instance,this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.Z.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.pc,this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),ma,this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.Z.ia("Common.Comments.OfficeSharedCommentsActionHost",
()=>new io(y.AFrameworkApplication.va,this.Z.resolve("WordEditor.Comments.IOfficeSharedCommentPane").ZCc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.Z.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new pn(y.AFrameworkApplication.pc,this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.Z.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.Z.resolve("Common.Comments.ICommentSmartReplyProvider"),
ma,re.StaticActiveAppFrame.za(),y.AFrameworkApplication.ua.tq,this.Z.Ta("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,va.a.instance,this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();rl.a.factory=Bc.getInstance;this.Z.ia("WordEditor.Comments.EditorCommentManager",
Bc.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.Z.ia("WordEditor.Comments.CommentFloatingContainerActor",()=>new If(this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.pc,this.Z.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${fi.a.H0a} .${Dg.a.fgc}`),this.Z.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ua.tq,this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const Ua=this.Z.resolve("WordEditor.Sidetrack.SidetrackSettings"),xb=Ua.trackChangeInSidetrackEnabled;xb&&this.Z.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").DAj(this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));
this.Z.ia("WordEditor.Comments.FloatingCommentManager",()=>new df(this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.pc,va.a.instance,this.Z.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),Ua)).ha();this.Z.ia("WordEditor.Comments.IFloatingCommentManager",
()=>xb?this.Z.resolve("WordEditor.Sidetrack.SidetrackManager"):this.Z.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();this.Z.ia("WordEditor.Comments.CommentSelectionActor",()=>new Ii(y.AFrameworkApplication.va,this.Z.resolve("Common.Comments.ICommentModel"),this.Z.resolve("WordEditor.Comments.ICommentHighlightActor"),pf.getInstance(),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
y.AFrameworkApplication.ua.tq,this.Z.resolve("WordEditor.Comments.CommentsState"),ma,new fb.a(()=>yk.a.instance),this.Z.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.Z.Ta("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.Z.ia("WordEditor.Comments.CommentInitActor",()=>new Zh(this.Z.resolve("WordEditor.Comments.IEditorCommentManager"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),
this.Z.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),ma,this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),pf.getInstance(),re.StaticActiveAppFrame.za().Vr,y.AFrameworkApplication.va,this.Z.resolve("Common.IDynamicScriptLoaderProvider").OD,this.Z.Ta("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ua.tq,this.Z.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.Z.resolve("Common.Comments.ICommentSmartReplyProvider"),this.Z.resolve("Common.Comments.ICommentActivationManager"),this.Z.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.Z.Ta("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.Ta("Common.App.SafeLinks.ISafeLinksManager"),this.Z.Ta("Common.App.People.IExternalPeopleAPI"),this.Z.resolve("Common.OfficeSharedCommentsTelemetry"),this.Z.resolve("Common.Comments.IViewContainerEventHost"),
this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),Ua,this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.Z.resolve("Box4.IPackageBootPerfLogger"),this.Z.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.Z.ia("WordEditor.Comments.CommentsActionManager",
()=>new Th(this.Z.resolve("WordEditor.Comments.EditorCommentManager"),this.Z.resolve("WordEditor.Comments.EditorCommentModel"),this.Z.resolve("WordEditor.Comments.ICommentHintActor"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),ma,this.Z.resolve("Common.Comments.ICommentPane"),new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd.ud),
y.AFrameworkApplication.va,new fb.a(()=>yk.a.instance),vm.FocusManager.instance(),va.a.instance,this.Z.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.CommentsActionManager").ha();this.Z.resolve("WordEditor.Comments.CommentInitActor");ma.contentNavigationApiEnabled&&(this.Z.ia("WordEditor.Comments.CommentContentProvider",()=>new Xk(this.Z.resolve("WordEditor.Comments.ICommentModelBootLoader"),
this.Z.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.Z.ia("WordEditor.Comments.CommentContentActor",()=>new Uj(this.Z.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.IEditorCommentManager"),this.Z.resolve("WordEditor.Comments.CommentsState"))).ha(),this.Z.resolve("WordEditor.Comments.CommentContentProvider"),
this.Z.resolve("WordEditor.Comments.CommentContentActor"));const Xb=ma.Fr,rc=this.Z.resolve("WordEditor.Comments.EditorCommentManager");this.Z.resolve("WordEditor.Comments.CommentsActionManager");rc&&Xb&&(this.Z.resolve("WordEditor.Comments.CommentsState").Qlb=Dn.Iti(),ma.BNb||this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").T3("OnCommentInit"));jb.a.kGn();ma.vlc&&re.StaticActiveAppFrame.za().kb.Qji();rl.a.instance&&(ma.BNb||Lj.a.get_instance().Sk(4,()=>{this.GXn(Xb)},11).continueWith(()=>
{this.W7m()}),this._initialized=!0);this.duo(this.Z.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}W7m(){this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").T3("OnCommentInit")}GXn(ma){ma||this.jTm()}jTm(){const ma=Dn.Iti();ma&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.YK),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").T3("OnCommentInit",
Object.assign(new Nj.a,{kMa:()=>{rl.a.instance.Dga.isVisible||y.AFrameworkApplication.va.Ob(aj.a.K0,2);this.Z.resolve("WordEditor.Comments.ICommentSelectionActor").vKj(ma,Object.assign(new wm.a,{dBg:!0}))}})),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").ex(aj.a.npf))}duo(ma,Ua,xb){ma&&ma.execute(Xb=>{Xb.dY(new Aa.a(Ua,xb))})}dispose(){this._initialized&&(rl.a.instance&&rl.a.instance.dispose(),this._initialized=!1)}static Iti(){return y.AFrameworkApplication.J.jb("BootActivityNavigationId")}}
Object(f.a)(Dn,"PackageManager",null,[0,1]);const vo=ma=>{const Ua=K.a.instance.Ta("Box4.IPackageBootPerfLogger"),xb=window.performance.now();Ua.execute(Xb=>{Xb.Hw(el.a.comments,"CPMain",xb,!0)});xa.a.instance.Mc(new Dn,0,ma)};var pc=d(1001);class Dm{isComment(ma){return Sb.a.isComment(ma)}Qce(ma){return Sb.a.Qce(ma)}JWf(ma){return Sb.a.JWf(ma)}wdg(ma,Ua){Sb.a.wdg(ma,Ua)}Adg(ma,Ua){Sb.a.Adg(ma,Ua)}Asf(ma){return Sb.a.Asf(ma)}vbb(ma){return Tj.a.instance.vbb(ma)}deleteComment(ma,Ua){Sb.a.deleteComment(ma,
Ua)}IZd(ma,Ua){Sb.a.IZd(ma,Ua)}hxb(ma){Sb.a.hxb(ma)}hfa(ma,Ua,xb){return Sb.a.hfa(ma,Ua,xb)}qAa(ma,Ua,xb){return Sb.a.qAa(ma,Ua,xb)}Pkc(ma,Ua){return Sb.a.Pkc(ma,Ua)}m2c(ma,Ua,xb,Xb=null){return Sb.a.m2c(ma,Ua,xb,Xb)}Wbc(ma,Ua,xb,Xb){Sb.a.Wbc(ma,Ua,xb,Xb)}zQd(ma,Ua,xb,Xb){return Sb.a.zQd(ma,Ua,xb,Xb)}get SSb(){return Sb.a.SSb}set SSb(ma){Sb.a.SSb=ma}LWb(ma,Ua){Sb.a.LWb(ma,Ua)}pkd(ma){Sb.a.pkd(ma)}Hqg(ma){Sb.a.Hqg(ma)}C7d(ma,Ua){return Sb.a.C7d(ma,Ua)}xdg(ma,Ua){Sb.a.xdg(ma,Ua)}zdg(ma,Ua){Sb.a.zdg(ma,
Ua)}Hle(ma,Ua,xb,Xb,rc,Zc){Sb.a.Hle(ma,Ua,xb,Xb,rc,Zc)}Nzf(ma,Ua){Sb.a.Nzf(ma,Ua)}Qhd(ma,Ua,xb,Xb){return Sb.a.Qhd(ma,Ua,xb,Xb)}Uhd(ma,Ua,xb,Xb){return Sb.a.Uhd(ma,Ua,xb,Xb)}}Object(f.a)(Dm,"CommentEditorProxy",null,[265]);class wo{constructor(){this.Z=null}get k1b(){return null!=this.M4g?this.M4g:this.M4g=(()=>this.Z.Ta("WordEditor.ITableEditor"))()}get ecb(){return null!=this.x1g?this.x1g:this.x1g=(()=>this.Z.resolve("Box4.IPackageBootPerfLogger"))()}Y1(ma){this.ecb.Y1(el.a.comments,ma,!0)}get name(){return"WordEditor.CommentsInteractive"}wc(ma){this.Z=
ma;this.Y1("CIPConfigStart");ma.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new Dm).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.Y1("CIPConfigEnd")}init(){this.Y1("CIPInitStart");this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho();this.Y1("CIPInitEnd")})}Ho(){this.G2m()}dispose(){}G2m(){db.a.yZa(Sb.a.Adg);pc.a.nRd(Sb.a.xdg);pc.a.oRd(Sb.a.zdg);pc.a.j1k(Sb.a.DXn);this.k1b.execute(Ua=>{Ua.wff(Sb.a.LWb)});const ma=mb.a.jf.Tl;ma.qf(39).Qo(Sb.a.wdg);pc.a.B0k(Sb.a.GWn);
pc.a.t0k(Sb.a.UVn);Gi.a.isEnabled&&ma.qf(12).ly(Sb.a.$hk)}}Object(f.a)(wo,"PackageManager",null,[0,1]);const Zn=ma=>{const Ua=K.a.instance.Ta("Box4.IPackageBootPerfLogger"),xb=window.performance.now();Ua.execute(Xb=>{Xb.Hw(el.a.comments,"CIPMain",xb,!0)});xa.a.instance.Mc(new wo,0,ma)};var zk=d(2181),Rk=d(107),Mk=d(1678);class Um{constructor(ma,Ua,xb,Xb,rc,Zc,Hd){this.ISa=ma;this.bea=Ua;this.x$=xb;this.fd=Xb;this.oxk=rc;this.M0e=Zc;this.VFb=Hd;Mk.a.i1k((Jd,Xd)=>{this.o_k(Xd.graphNode,Xd.$vl)});Mk.a.O1k((Jd,
Xd)=>{this.GCl(Xd.graphNode,Xd.Ktl)})}H6d(){var ma=this.oxk();const Ua=this.fd.Ql();Ua.set(ma);if(this.bea.Zrp(Ua))return Ua;Ua.set(ma);Object(Rk.a)().ZR(Ua);ma=this.x$.ZKl(Ua.currentNode);Ua.Yj(ma);return Ua}W8d(ma){const Ua=this.H6d();let xb=null;this.bea.Q3d(Ua,Xb=>{this.x$.XHi(Xb)===ma&&(xb=Xb);return!xb});return xb}THi(ma){const Ua=this.H6d();let xb=null;this.bea.Q3d(Ua,Xb=>{this.x$.Ukc(Xb)===ma&&(xb=Xb);return!xb});return xb}A$i(ma,Ua,xb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",
ma,Ua,xb)}YHi(){const ma=this.H6d(),Ua=[];this.bea.Q3d(ma,xb=>{Ua.push(this.x$.XHi(xb));return!0});return Ua}gob(ma,Ua){if(!Ua.length)return this.VFb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const xb=this.H6d(),Xb=qa.a.create().toString(),rc=new Fe.a;for(let Zc of Ua)rc.add(Zc),this.A$i(Zc.type,Xb,Zc.completion);Ua=this.ISa.Ywg(rc);this.x$.gob(xb.currentNode,Xb,ma,Ua);this.M0e();return Xb}wf(ma){(ma=this.W8d(ma))?(this.x$.wf(ma),this.M0e()):
this.VFb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}Ukc(ma){ma=this.W8d(ma);return ma?this.x$.Ukc(ma):(this.VFb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}UHi(ma){return this.x$.Ukc(ma)}WHi(ma){ma=this.W8d(ma);if(!ma)return this.VFb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ma=this.x$.QMf(ma);return this.ISa.ogc(ma).toArray()}z7k(ma,Ua){if(!Ua.length)return this.VFb&&
a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const xb=this.W8d(ma);if(!xb)return this.VFb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Xb=this.x$.QMf(xb),rc=this.ISa.ogc(Xb);for(let Zc of Ua)rc.add(Zc),this.A$i(Zc.type,ma,Zc.completion);ma=this.ISa.Ywg(rc);ma!==Xb&&(this.x$.NZo(xb,ma),this.M0e());return!0}o_k(ma,Ua){if(Ua=this.THi(Ua)){const xb=this.fd.Ql();xb.set(ma);this.x$.$b(Ua.clone(),this.x$.t2l(Ua,
xb))}}kzj(ma,Ua,xb){if(Ua.tb(ma))return Ua.K(ma);const Xb=qa.a.create().toString();Ua.add(ma,Xb);xb&&this.VFb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Xb}GCl(ma,Ua){const xb=new Kl.a;var Xb=this.fd.Ql();Xb.set(ma);Xb.Vb(38)&&this.bea.Q3d(Xb,rc=>{const Zc=this.x$.Ukc(rc);void 0!==Zc&&null!==Zc&&xb.add(Zc,rc);return!0});for(let rc of Ua)if(ma=null,({value:ma}=xb.Ec(rc.key,ma)).returnValue)if(rc.value===rc.key)ma=this.THi(rc.key),
this.x$.D_o(ma,parseInt(rc.key));else{ma=this.x$.QMf(ma);if(!ma||""===ma){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ma=this.ISa.ogc(ma);Xb=new Fa.a;for(let Zc=0;Zc<ma.length;Zc++){if(ma.K(Zc).commentId){const Hd=Number.parseInvariant(ma.K(Zc).commentId);Ua.tb(Hd)?ma.K(Zc).commentId=Ua.K(Hd).toString():ma.K(Zc).commentId=null}ma.K(Zc).recordId=this.kzj(ma.K(Zc).recordId,Xb,!1);-1===ma.K(Zc).type&&(ma.K(Zc).undoId=
this.kzj(ma.K(Zc).undoId,Xb,!0))}this.gob(rc.value,ma.toArray())}}static Us(){return new Um(K.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),K.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new yi.a,()=>re.StaticActiveAppFrame.za().kb.hd,()=>{K.a.instance.Ta("Common.Interface.IEditNotificationManager").execute(ma=>{ma.editHappened()})},!0)}}Object(f.a)(Um,"TaskActor",null,[264]);var Tg=d(1110);class nm{create(){return new Tg.a}}
Object(f.a)(nm,"TaskContentNodeFactory",null,[284]);var xm=d(1068);class xf{create(){return new xm.a}}Object(f.a)(xf,"TaskNodeFactory",null,[284]);class em{constructor(ma,Ua,xb,Xb,rc,Zc){this.bea=ma;this.Rc=Ua;this.fd=xb;this.NPk=Xb;this.QPk=rc;this.o4b=Zc}vJl(ma,Ua,xb){const Xb=this.QPk.create(zi.a.izc);Xb.setValue(Ta.a.taskId,ma);Xb.setValue(Ta.a.p1b,Ua);Xb.setValue(Ta.a.iEa,xb);return Xb}Wkc(ma){const Ua=this.Rc.Lc(4);Ua.Ab(ma);this.o4b();return Ua}XHi(ma){return this.bea.WTb(ma)?ma.getValue(Ta.a.taskId):
(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}Ukc(ma){return this.bea.WTb(ma)?ma.hasProperty(Ta.a.p1b)?ma.getValue(Ta.a.p1b):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}QMf(ma){return this.bea.WTb(ma)?ma.getValue(Ta.a.iEa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}ZKl(ma){if(7!==ma.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const Ua=this.Wkc(ma);try{const xb=this.NPk.create(zi.a.pOa),Xb=this.fd.Ql();
Xb.set(ma);Xb.d6(xb,38,em.$ip);return xb}finally{Ua&&Ua.dispose()}}gob(ma,Ua,xb,Xb){if(!this.bea.u0f(ma))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const rc=this.Wkc(ma);try{const Zc=this.vJl(Ua,xb,Xb),Hd=this.fd.Ql();Hd.set(ma);Hd.d6(Zc,1,new nb.a(qa.a.wza(xb.toString()),1));return Zc}finally{rc&&rc.dispose()}}wf(ma){if(this.bea.WTb(ma))if(ma.anchor&&ma.anchor.Gr){var Ua=ma.anchor.Gr.ht.node;if(this.bea.u0f(Ua)){var xb=this.Wkc(Ua);try{const Xb=this.fd.Ql();Xb.set(Ua);
Xb.Yj(ma.anchor.node);Xb.Tg()}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}NZo(ma,Ua){if(this.bea.WTb(ma)){var xb=this.Wkc(ma);try{ma.setValue(Ta.a.iEa,Ua)}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}D_o(ma,Ua){if(this.bea.WTb(ma)){var xb=
this.Wkc(ma);try{const Xb=ma.hasProperty(Ta.a.p1b)?ma.getValue(Ta.a.p1b):null;void 0===Xb||null===Xb||Xb===Ua?ma.Wg(Ta.a.p1b,Ua):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}t2l(ma,Ua){if(!Ua.zu(38)){const xb=this.fd.Ql();xb.set(ma);xb.zb(71);xb.kd(71);ma=$b.b(xb.currentNode,ma.Hj().Hc,!0);Ua.Wf(ma,38)}return Ua.Vb(38)}$b(ma,Ua){if(this.bea.u0f(Ua)){var xb=this.Wkc(Ua);try{const Xb=this.fd.Ql();
Xb.set(Ua);Xb.Wf(ma,1)}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Us(){return new em(K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new kg.a,new yi.a,new nm,new xf,()=>{tl.a.hm.kb.hd.KF.n6(10)})}}em.$ip=new nb.a(qa.a.Bf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(f.a)(em,"TaskEditor",null,[263]);class Ug{constructor(ma,Ua){this.zz=ma;this.VGb=Ua}WTb(ma){return!!ma&&72===ma.type}cun(ma){return!!ma&&71===ma.uf}u0f(ma){return!!ma&&
71===ma.type}Zrp(ma){ma.set(this.zz.value);this.VGb.ZR(ma);return!!ma.Vb(38)}Q3d(ma,Ua){if(ma&&Ua)if(this.cun(ma))for(var xb=!0,Xb=ma.Vb(1);xb&&Xb;)this.WTb(Xb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Xb.type),xb=Ua(Xb),Xb=ma.Kf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",ma.uf);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Us(){return new Ug(new fb.a(()=>re.StaticActiveAppFrame.za().kb.hd),Object(Rk.a)())}}
Object(f.a)(Ug,"TaskNavigator",null,[262]);class El{constructor(){this.Z=null}get name(){return"WordEditor.Tasks"}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}dispose(){}wc(ma){this.Z=ma;ma.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new zk.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();ma.ia("WordEditor.Tasks.TaskNavigator",()=>Ug.Us()).as("WordEditor.Tasks.ITaskNavigator").ha();ma.ia("WordEditor.Tasks.TaskEditor",()=>em.Us()).as("WordEditor.Tasks.ITaskEditor").ha();
ma.ia("WordEditor.Tasks.TaskActor",()=>Um.Us()).as("WordEditor.Tasks.ITaskActor").ha()}Ho(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(106)}}Object(f.a)(El,"TasksPackage",null,[0,1]);var mk=d(94),Em=d(1674),To=d(420),Lm=d(106);class ko{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(ko,
"TaskPaneGroupAppProps",null,[]);var $n=d(181);class Uo{static txl(ma,Ua){vm.FocusManager.lM()&&(fn.a.instance.wHa(ma,Ua,!1),$n.a.instance.wHa(ma,Ua,!1),y.AFrameworkApplication.ua.Ky.xW(ma))}}Object(f.a)(Uo,"ReactTaskPaneManagerUtils",null,[]);var qp=d(180),cr=d(375);class ll{constructor(){this.type=null}}Object(f.a)(ll,"SampleTaskPaneProps",null,[]);var jh=d(1676),$r=d(109);class Vl{constructor(){this.entry=null;this.show=!1}}Object(f.a)(Vl,"AnimationBatchEntry",null,[]);var Fp=d(381),tq=d(1675),
ao=d(170);class sh{constructor(){this.Eyh=[];this.Fyh=[];this.fqa={};this.TPa=this.SPa=null;this.RNd=!1;this.D1=null;this.$Kd=this.$Fd=0;this.rDc=[];this.nXe=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.Jtb;this.nA=!1}initialize(){this.RNd=!1;(this.nA=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.F7)&&this.otf()}qtf(ma,Ua,xb,Xb){Ua=this.Y8d(Ua);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.otf();const rc=document.createElement("div");rc.id=Ua;rc.className=
sh.wGp;rc.style.width="0";this.nXe||(this.EWk(xb,Ua,rc),this.fqa[Ua]=ma.qtf(Ua,xb,Xb,rc));return rc}otf(){this.RNd||this.F1o()}EWk(ma,Ua,xb){let Xb=null,rc=null;0===ma?(Xb=this.SPa,rc=this.Eyh):1===ma&&(Xb=this.TPa,rc=this.Fyh);if(Xb){ma=!1;for(let Zc=0;Zc<rc.length;Zc++)if(!ma)rc[Zc]===Ua&&(ma=!0);else if(rc[Zc]in this.fqa){this.Xbn(Xb,xb,this.fqa[rc[Zc]]);return}Xb.appendChild(xb)}}Xbn(ma,Ua,xb){ma.insertBefore(Ua,xb.element)}pWl(ma){ma=this.Y8d(ma);if(ma in this.fqa){const Ua=this.fqa[ma];Ua.element.parentNode.removeChild(Ua.element);
delete this.fqa[ma]}}bVj(ma){ma=this.Y8d(ma);ma in this.fqa&&(ma=this.fqa[ma])&&!ma.isVisible&&(this.oUj(ma,!0),this.nQh(ma.position,!0,this.jZh(ma,!0)),1===ma.position&&1<la.a.count(this.fqa)&&this.VHn())}O0m(ma){ma=this.Y8d(ma);ma in this.fqa&&(ma=this.fqa[ma])&&ma.isVisible&&(this.oUj(ma,!1),this.nQh(ma.position,!1,this.jZh(ma,!1)))}Dfc(ma){if(this.D1)return this.D1;const Ua=document.createElement("div");document.body.appendChild(Ua);Ua&&(this.D1=new Em.a(Ua,ma));return this.D1}oUj(ma,Ua){ma.element&&
(ma.isVisible=Ua,this.rDc.push(Object.assign(new Vl,{entry:ma,show:Ua})));0===ma.position?this.$Fd+=Ua?1:-1:this.$Kd+=Ua?1:-1;1===this.rDc.length&&window.setTimeout(Object($r.a)(this,this.Ndp,"startPaneAnimation"),0);this.nA&&ma.element&&ma.element.parentNode&&(0===ma.position&&!this.$Fd||1===ma.position&&!this.$Kd?(ma.element.parentNode.style.minHeight="0px",ma.element.parentNode.style.height="0px",ma.element.parentNode.style.overflow="hidden"):(ma.element.parentNode.style.minHeight="",ma.element.parentNode.style.height=
"",ma.element.parentNode.style.overflow=""))}Ndp(){this.gmj();var ma=rd.where(rd.asEnumerable(this.rDc),rc=>0===rc.entry.position),Ua=rd.where(ma,rc=>!rc.show);if(rd.any(Ua)&&rd.Ct(Ua)!==rd.Ct(ma)){for(var xb of Ua)xb.entry.element.style.width="0";ma=rd.where(ma,rc=>rc.show)}Ua=rd.where(rd.asEnumerable(this.rDc),rc=>1===rc.entry.position);xb=rd.where(Ua,rc=>!rc.show);if(rd.any(xb)&&rd.Ct(xb)!==rd.Ct(Ua)){for(var Xb of xb)Xb.entry.element.style.width="0";Ua=rd.where(Ua,rc=>rc.show)}for(const rc of rd.concat(ma,
Ua))ma=rc.entry,ao.WacAirSpace.nY(ma.element,Fp.a.SBg),Xb=new tq.a(ma.element),rc.show?Xb.Sgf(0,ma.width):Xb.Sgf(ma.width,0),ao.WacAirSpace.animate(Xb,null,null);this.rDc.length=0}gmj(){}jZh(ma,Ua){let xb=ma.width;ma=0===ma.position?this.$Fd:this.$Kd;if(Ua&&1===ma||!Ua&&!ma)xb+=1;return xb}F1o(){this.RNd||(this.SPa||(this.SPa=document.createElement("div"),this.SPa.id=sh.uGp,this.SPa.className=sh.Qak,Sys.UI.DomElement.addCssClass(this.SPa,"alignLeft"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.oba&&
Sys.UI.DomElement.addCssClass(this.SPa,"FlexBoxLayout"),this.nXe&&Sys.UI.DomElement.addCssClass(this.SPa,sh.Nak),this.tOh(0,this.SPa)),this.TPa||(this.TPa=document.createElement("div"),this.TPa.id=sh.vGp,this.TPa.className=sh.Qak,Sys.UI.DomElement.addCssClass(this.TPa,"alignRight"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.oba&&Sys.UI.DomElement.addCssClass(this.TPa,"FlexBoxLayout"),this.nXe&&Sys.UI.DomElement.addCssClass(this.TPa,sh.Nak),this.tOh(1,this.TPa)),this.xoj(this.SPa,this.TPa),
this.RNd=!0)}xoj(){}zHa(ma,Ua){Array.add(1===ma?this.Fyh:this.Eyh,Ua)}Y8d(ma){return ma+"-Entry"}VHn(){let ma=0;for(const Ua of la.a.CR(this.fqa)){const xb=Object(V.a)(1867,this.fqa[Ua]);xb&&xb.isVisible&&1===xb.position&&ma++}2===ma?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ma&&a.ULS.sendTraceTag(595179605,320,50,ma+" simultaneous panes open")}}sh.uGp="WACTaskPaneContainerLeft";sh.vGp="WACTaskPaneContainerRight";sh.Qak="WACTaskPaneContainer";sh.wGp="WACTaskPaneEntry";sh.Nak=
"WACReactTaskPaneContainer";Object(f.a)(sh,"BaseTaskPaneManager",null,[1868]);var Tp=d(646),Fm=d(307);class uq extends sh{constructor(ma,Ua){super();this.WLc=this.VLc=this.Jbf=this.Ibf=0;this.rqi=()=>{Object(ub.a)().forEach(xb=>{xb.U3d()})};this.ga=ma;this.rnh=Ua}tOh(ma,Ua){const xb=re.StaticActiveAppFrame.za().kG;xb.parentNode&&(ma?1===ma&&(this.nA?((ma=Object(Fm.a)("FarPane"))&&ma.appendChild(Ua),Ua.classList.add("regionComposer"),re.StaticActiveAppFrame.za().OQ.registerBoundingWindowRectsChanged("farPane",
(Xb,rc)=>{"DP"===rc||3===rc?Ua.classList.add("DL"):Ua.classList.remove("DL")})):xb.parentNode.insertBefore(Ua,xb.nextSibling)):this.nA?((ma=Object(Fm.a)("NearPane"))&&ma.appendChild(Ua),Ua.classList.add("regionComposer")):xb.parentNode.insertBefore(Ua,xb))}nQh(ma,Ua,xb){this.nA||(Ua=Ua?xb:-xb,ma?this.WLc+=Ua:this.VLc+=Ua)}gmj(){if(!this.nA){var ma=re.StaticActiveAppFrame.za().kG;ao.WacAirSpace.nY(ma,Fp.a.SBg);if(this.Ibf!==this.VLc){const Ua=new Tp.a(ma);Ua.Q5k(this.Ibf,this.VLc,this.rnh);ao.WacAirSpace.animate(Ua,
null,this.rqi);this.Ibf=this.VLc}this.Jbf!==this.WLc&&(ma=new Tp.a(ma),ma.R5k(this.Jbf,this.WLc,this.rnh),ao.WacAirSpace.animate(ma,null,this.rqi),this.Jbf=this.WLc)}}}Object(f.a)(uq,"TaskPaneManager",sh,[]);var dj=d(155);class an extends uq{get DXi(){null==this.zIe&&(this.zIe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.zIe}constructor(ma,Ua){super(ma,Ua);this.BZ=Nc.KeyInputManager.oc(mk.a.pz,
0);this.CZ=Nc.KeyInputManager.oc(mk.a.pz,4);this.K5e=this.GLc=null;this.Qsh="AccCheckerTaskPane";this.sa=new Na.a;this.isPaneOpen=!1;this.zIe=this.lRe=null;this.zHa(0,"SampleTaskPane");this.zHa(0,dj.a.Jpb);this.zHa(1,dj.a.wal);this.zHa(1,"CustomTaskPane");this.zHa(1,dj.a.kVf);this.zHa(1,vf.AFrame.xt);this.zHa(1,vf.AFrame.eMh);this.zHa(1,vf.AFrame.$Lh);this.zHa(1,dj.a.$3d);this.zHa(1,dj.a.OYc);this.zHa(1,dj.a.D_c);this.XBk=(this.X8g=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Gb)&&y.AFrameworkApplication.ua.Gb.m_f;
this.YAk=tl.a.tpc;this.dBk=this.X8g&&y.AFrameworkApplication.ua.Gb.w$c;this.initialize();ma.fb(Nb.a.kCg,hg.a.application,an.kCg,96)}get Fue(){if(!re.StaticActiveAppFrame.za()||!re.StaticActiveAppFrame.za().kG)return null;this.K5e||(this.K5e=new Em.a(re.StaticActiveAppFrame.za().kG,vm.FocusManager.instance()));return this.K5e}Xb(){}xoj(ma,Ua){const xb=To.a.instance,Xb=vm.FocusManager.instance(),rc=Lm.EventHandlerManager.instance,Zc=this;jk.UISurfaces.Lv().then(Hd=>{Zc.GLc=Zc.Dfc(Xb);let Jd;Hd.renderTaskPaneGroups(ma,
Ua,(Jd=new ko,Jd.middleContainer=re.StaticActiveAppFrame.za().kG,Jd.onTabStripFocus=()=>{Xb.RE(dj.a.Ryc)},Jd.onOpen=(Xd,je)=>{Zc.n_f(Xd)&&Uo.txl(Xd,je);rc.Idf(je,"focus",Zc.RFi(Xd,Xb),!0);var af=Zc.tZi(Xd),Wf=Hd.selectors.getTabbedTaskPaneCount(af?1:2);af=af?dj.a.qBe:dj.a.Ryc;1===Wf&&(xb.I$(af),this.isPaneOpen=!0,this.Wxj({isPaneOpen:this.isPaneOpen,t1b:je}));je=Zc.VIf(Xd);if(Wf=Xb.ie(je))Wf.tWc=af,Zc.x6o(Xd)&&(Wf.ot(Zc.BZ),Wf.ot(Zc.CZ)),xb.YXi(je)&&xb.Dx(je);this.DXi&&this.O1d&&this.O1d.dismissFloatie(!0)},
Jd.onClose=(Xd,je)=>{Zc.n_f(Xd);const af=Zc.tZi(Xd),Wf=af?dj.a.qBe:dj.a.Ryc;Hd.selectors.getTabbedTaskPaneCount(af?1:2)||(xb.Dx(Wf),this.isPaneOpen=!1,this.Wxj({isPaneOpen:this.isPaneOpen,t1b:je}));rc.Kqg(je,"focus",Zc.RFi(Xd,Xb),!0);this.DXi&&this.O1d&&this.O1d.dismissFloatie(!0)},Jd.setFocusCallback=(Xd,je)=>{Zc.n_f(Xd)&&je&&(Xd=Xb.ie(Zc.VIf(Xd)),Xd.zsl(),Xd.Nja(je))},Jd.onOverflowMenuOpen=()=>{if(Zc.GLc)Zc.GLc.onMenuOpen()},Jd.onOverflowMenuClose=()=>{if(Zc.GLc)Zc.GLc.onMenuClose()},Jd.onShow=
(Xd,je)=>{2===je&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Xb.Gg(Xd)},0)})},Jd.onHide=(Xd,je,af)=>{af&&1!==je&&Xb.Gg(Xb.QW)},Jd.onResizeStart=()=>{if(re.StaticActiveAppFrame.za()&&(re.StaticActiveAppFrame.za().kG.className=fi.a.DMg,Zc.Fue))Zc.Fue.onMenuOpen()},Jd.onResizeEnd=()=>{if(re.StaticActiveAppFrame.za()&&(qp.a.W0i()||(re.StaticActiveAppFrame.za().kG.className+=" "+re.StaticActiveAppFrame.za().z_h),Zc.Fue))Zc.Fue.onMenuClose()},Jd));this.xna(dj.a.Ryc,Xb,Ua,Zc);this.xna(dj.a.qBe,
Xb,ma,Zc);return null})}xna(ma,Ua,xb,Xb){const rc=Ua.ie(ma);rc.parent=vf.AFrame.Gq;rc.IL=!0;fn.a.instance.wHa(ma,xb,!1);$n.a.instance.wHa(ma,xb,!1);ma=new cr.DOMFocusListing(()=>xb);ma.rn(3);ma.rn(2);ma.rn(4);ma.rn(1);Ua.Rqa(()=>xb,rc,ma).rP=!0;rc.ot(Xb.BZ);rc.ot(Xb.CZ)}VIf(ma){return ma===this.Qsh?dj.a.fLh:ma}RFi(ma,Ua){return()=>{Ua.RE(this.VIf(ma))}}x6o(ma){return ma===this.Qsh?!1:!0}nkn(ma){return ma===dj.a.Jpb}n_f(ma){return this.nkn(ma)||ma===dj.a.fLh||0<=ma.indexOf("AppForOfficePanel")||ma===
dj.a.$3d||ma===dj.a.kVf&&this.XBk||ma===dj.a.OYc&&this.YAk||ma===dj.a.D_c&&this.dBk||ma===jh.a.fPb?!0:!1}tZi(ma){return ma===dj.a.Jpb||"SampleTaskPane"===ma}static fOm(){return new an(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static kCg(ma,Ua,xb,Xb,rc){if(1===xb)return 32;jk.UISurfaces.Lv().then(Zc=>{Zc.showTaskPane(rc,Object.assign(new Xh.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new ll,{type:"SampleTaskPaneProps"})}));return null});return 32}C5a(ma){this.sa.addHandler("onPaneToggle",
ma)}Lkd(ma){this.sa.removeHandler("onPaneToggle",ma)}Wxj(ma){this.sa.raiseEvent("onPaneToggle",ma)}get O1d(){this.lRe||(this.lRe=K.a.instance.Oa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.lRe}}Object(f.a)(an,"TaskPaneManager",uq,[261]);class lo{constructor(){this.tW=null}get name(){return"WordEditor.TaskPaneManager"}wc(){}init(){this.tW=an.fOm();this.tW.Xb();re.StaticActiveAppFrame.za().Leb=this.tW}dispose(){}}Object(f.a)(lo,"PackageManager",null,[0,1]);d.d(J,"a",function(){return m})},
2035:function(I,J,d){I=d(0);var m=d(2),f=d(124),a=d(48),l=d(219),w=d(19),z=d(16),x=d(85),u=d(195),v=d(41),D=d(30),y=d(13),H=d(39),F=d(5),G=d(8),K=d(80),R=d(313),E=d(78),N=d(11),O=d(6),U=d(108),X=d(130),V=d(31),Q=d(229),T=d(92),ba=d(230),W=d(15),aa=d(75),Y=d(148),da=d(898),ka=d(3),qa=d(82),ua=d(63),Pa=d(131),Ja=d(100),Ca=d(36),ra=d(494),Ea=d(462),xa=d(37),Ma=d(21),ha=d(50),la=d(166),Fa=d(20),Ga=d(27),va=d(254),pa=d(7),Oa=d(1044),Ra=d(1509),fb=d(1537),qb=d(308),mb=d(238),eb=d(83),bb=d(334),Wa=d(529);
class Za extends qb.a{constructor(sb,pb,tb,wb,gc,vc,Pc,ld){super();this.CDh=this.xx=null;this.init(sb);this.nm("FormattingViewOperation");this.usb(m.AFrameworkApplication.va,pb,wb,gc,vc);this._context=tb;this.dgb=0;this.Ps=!0;this.Pvk=Pc;this.Vn=ld}get $ea(){return this.Vn.instance}run(){const sb=this._context.view;var pb=null;sb.ve&&(pb=sb.lb);if(pb){var tb=pb.gb.currentSelection,wb=!fb.a.snc(this.actionId);!tb||Za.tg.M_f(tb,wb)?(Za.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.UG}),this.Ps=!1):this.$ea&&this.$ea.Knc(tb)?
(Za.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.Z7a}),this.Ps=!1):Object(la.a)().HEa(pa.ParagraphReader.xX,pb.Pg)&&(Za.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.XQ}),this.Ps=!1)}else Za.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.qga}),this.Ps=!1;1!==this.behavior&&this.Ps||(this.Ps&&(tb=pb.gb.currentSelection,1===pb.gb.length&&1===tb.length&&xa.a.Zl(tb.Qa)&&aa.b(tb.Qa)&&(Za.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.wWc}),this.Ps=!1)),(tb=this.Ps)&&this.actionId===ka.a.z8&&((tb=Array.from(pb.gb.currentSelection).some(U.FormattingReader.uqf))||
Za.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.Oxf})),this.hs=tb?32:8,this.dgb=3);this.dgb||(mb.a.mark(5730),this.CDh=Wa.SelectionReferenceFactory.instance.WMb(),tb=pb.gb.currentSelection.Qa,this.xx=new Ca.GraphTransaction(15),this.xx.Ab(tb.node),this.xx.Ph=this.actionId,this.dgb=1);if(1===this.dgb){this.PC||this.wnd(this._context.Lk);if(1===this.Dcb())return;this.dgb=2}if(2===this.dgb){if(this.actionId===ka.a.z8)if(pb=pb.Pg,pb.Ww)for(tb=0;tb<pb.length;tb++)wb=pb.getContext(tb),this.r4j(wb);else this.r4j(pb);
bb.a.Kqf&&this.Spp(this.actionId,this.rd);this.CDh.Mua(this.actionId===ka.a.rY||this.actionId===ka.a.Vya);(pb=Object(K.a)(444,this.rd))&&!pb.t_a||eb.FocusManager.instance().Gg(sb.nL);this.xx.dispose();this.xx=null;Fa.StaticActiveAppFrame.za().Ge();mb.a.mark(5731);this.dgb=3;this.hs=32}3===this.dgb&&(this.Pvk.process(this.actionId,this._context,this.behavior,this.response),this.fva())}Spp(sb,pb){const tb={};tb.FormattingActionId=sb;tb.FormattingActionData=pb;8===this.ga.Qb(ka.a.jSd,2,tb)&&G.ULS.sendTraceTag(509110153,
368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",sb,pb)}r4j(sb){(xa.a.Xw(sb)||xa.a.pl(sb))&&Pa.a.eQ.zha(sb.node)}static get tg(){return va.a.instance}static get Ac(){return u.a.instance}}Object(I.a)(Za,"FormattingViewOperation",qb.a,[]);var Na=d(1034),Db=d(47),nb=d(42);d.d(J,"a",function(){return cb});const Ta=new Set([ka.a.S2,ka.a.l4,ka.a.fE,ka.a.aIa,ka.a.bIa,ka.a.q6a,ka.a.Sya,ka.a.r6a]);class cb{constructor(sb,pb,tb=null,wb,gc,vc,Pc,ld,Dc,ic,mc,Rc,rb){this.kpiName=
"ChangeCaseCommandUsage";this.Baa="wwaengidc";this.kub=new Map;this.Lth=new Set;this.pPb=()=>new da.a(2);this.Nwj=(Cb,Kb,$b,ab,ia)=>{ab=!0;Kb.contextId!==N.a.view&&(ab=!1);if(1===$b&&!ab)return 8;if(Cb===ka.a.Aid)Cb=ia.formatting,ia=ia.RCg;else{if(!Kb.view||!Kb.view.ve)return 2;Kb=Kb.view;if(!Kb.lb||!Kb.lb.gb.currentSelection)return 8;Cb=ia;ia=Kb.lb.gb}this.dyl(ia,Cb);return 32};this.yhf=(Cb,Kb,$b,ab,ia,La)=>new Za(Cb,Kb,$b,ab,ia,La,this.uwk,cb.xy());this.hSd=(Cb,Kb,$b,ab,ia)=>{var La,Mb,Ha;let zb=
!0,ac=Kb;const nc=!fb.a.snc(Cb);Kb.contextId!==N.a.Cd&&Kb.contextId!==N.a.Vc?zb=!1:(cb.tg.jba(ac,!1,nc)&&(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.UG}),zb=!1),cb.xy()&&cb.xy().instance&&cb.xy().instance.zX(ac)&&(zb=!1),zb&&xa.a.Zl(Kb)&&aa.b(ac)&&(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.wWc}),zb=!1),pa.ParagraphReader.xX(Kb)&&(cb.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.XQ}),zb=!1));if(1===$b||!zb)return zb?32:8;if(Kb.contextId===N.a.Vc)return 2;(Kb=null===(La=this.Gp)||void 0===La?void 0:La.Q7d(ac))&&(ac=Kb);this.v6o(Cb)&&
(La=xa.a.U1b(ac),xa.a.mf(La)||(ac=La));La="boolean"===typeof ia&&ia;Kb=!1;(null===(Mb=this.tda)||void 0===Mb?0:Mb.annotateRange)&&(null===(Ha=this.tda)||void 0===Ha?0:Ha.yoc(ac.node))&&(Kb=this.AW(ac,Cb,ia,La));Kb&&Cb!==ka.a.z8||cb.ED.AW(ac,Gb=>{this.Kwc(Gb,Cb,ia,ac.cpEnd)},La);ac.node.Fq&&(Mb=[Object.assign(new D.a,{name:"Source",string:"CharacterFormatting"})],v.a("TOCFormatting",!0,void 0,Mb));this.zgn(Cb)&&this.IUd(ac,Cb);ab&&Ra.a.Vzb&&(ab.Xt|=Ra.a.Fqb(ac.node));return 32};this.Ard=(Cb,Kb,$b)=>
1!==$b&&2===$b?(this.kub.set("Source","Shortcut"),Cb=Kb.node.characterData.substr(Kb.cpBegin,Kb.cpEnd-Kb.cpBegin),cb.e0f(Cb,0,Cb.length)?this.IUd(Kb,ka.a.aIa):cb.stn(Cb,Cb.length)?this.IUd(Kb,ka.a.Sya):this.IUd(Kb,ka.a.bIa)):32;this.lnb=(Cb,Kb,$b)=>{let ab=!0;Cb=!fb.a.snc(Cb);Kb.contextId!==N.a.Cd&&Kb.contextId!==N.a.Vc?ab=!1:(cb.tg.jba(Kb,!1,Cb)&&(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.UG}),ab=!1),ab&&xa.a.Zl(Kb)&&aa.b(Kb)&&(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.wWc}),ab=!1),ab&&pa.ParagraphReader.xX(Kb)&&
(cb.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.XQ}),ab=!1));if(1===$b||!ab)return ab?32:8;Kb=Kb.node;this.xv.ZLb(Kb,!1);Kb.Fq&&(Kb=[Object.assign(new D.a,{name:"Source",string:"ClearFormatting"})],v.a("TOCFormatting",!0,void 0,Kb));return 32};this.qVc=(Cb,Kb,$b,ab,ia)=>{Cb={};Cb[Na.a.fPa]=6168;Cb[Na.a.ePa]=6169;const La=Kb.view;var Mb=null;La.vj&&(Mb=La);var Ha=!0;let zb=32;Mb&&(Mb=Mb.lb.gb.currentSelection)&&(cb.tg.M_f(Mb)?(cb.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.UG}),zb=8,Ha=!1):1===$b&&(zb=32,Ha=!1));Ha&&(Ha=new Ca.GraphTransaction(1===
$b?3:15),Ha.Ab(La.root),zb=Na.a.nua(ka.a.lnb,Kb,$b,ab,ia,Cb,12),Ha.dispose());return zb};this.Ghf=(Cb,Kb,$b,ab,ia)=>{var La,Mb=!0,Ha=32;const zb=!fb.a.snc(Cb);Kb.contextId!==N.a.Vc?Mb=!1:cb.tg.jba(Kb,!1,zb)&&(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.UG}),Mb=!1);if(1===$b||!Mb)return Mb?32:8;$b=Kb.node;Cb===ka.a.fE&&(cb.Kl.sVc($b),this.xv.U2h($b),Mb=this.hy.IF($b).nh(this.hy.wordStyleIdNormal),this.ew.ZP(Mb,$b,!0));$b=cb.rk.MMf(Kb);!$b&&(Mb=null===(La=this.Gp)||void 0===La?void 0:La.Q7d(Kb))&&(Kb=Mb,$b=Ma.SelectionFactory.Uo(Kb));
if($b)Ha=ha.a.SMb($b),Ha=m.AFrameworkApplication.va.Hf(Ha,Cb,2,!1,ab,ia);else{ab=Object(K.a)(444,ia);La=U.FormattingReader.Vs(Kb);if(!La)return 16;La=La.cache;switch(Cb){case ka.a.font:cb.qpi();if(ab&&ab.rd){const {fontName:ac,Rha:nc,bold:Gb,italic:tc}=cb.YIf(ab.rd);cb.rk.Twe(ac);cb.rk.qzg(nc);Object(ra.a)()&&(Cb=1==Gb,ia=1==tc,Cb||ia)&&(cb.rk.HN(Cb),cb.rk.fA(ia))}break;case ka.a.hx:G.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");cb.rk.hx(ia);break;case ka.a.eva:cb.rk.hx(ia);
this.IP.cTa(ia)||G.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ka.a.jka:cb.rk.jka();break;case ka.a.rY:G.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");cb.rk.NDa(ia);break;case ka.a.sca:cb.rk.NDa(ia);this.IP.cTa(ia)||G.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ka.a.Vya:cb.rk.sVd();break;case ka.a.pC:cb.qpi();cb.rk.pC(ab.rd);break;
case ka.a.S2:Cb=cb.rk.rI(y.a.fontSize,La.fontSize);cb.rk.pC(this.Ee.S2(Cb));break;case ka.a.l4:Cb=cb.rk.rI(y.a.fontSize,La.fontSize);cb.rk.pC(this.Ee.l4(Cb));break;case ka.a.bold:Cb=cb.rk.rI(y.a.bold,La.isBold);cb.rk.HN(!Cb);break;case ka.a.fA:Cb=cb.rk.rI(y.a.italic,La.isItalic);cb.rk.fA(!Cb);break;case ka.a.underline:Cb=cb.rk.rI(y.a.underline,La.isUnderline);cb.rk.C8(!Cb);break;case ka.a.sha:cb.rk.sha(ia);break;case ka.a.superscript:Cb=cb.rk.rI(y.a.superscript,La.isSuperscript);cb.rk.hva(!Cb);break;
case ka.a.subscript:Cb=cb.rk.rI(y.a.subscript,La.isSubscript);cb.rk.NNa(!Cb);break;case ka.a.strikethrough:Cb=cb.rk.rI(y.a.strikethrough,La.isStrikethrough);cb.rk.una(!Cb);break;case ka.a.xu:Cb=cb.rk.rI(H.a.xu,La.isDoubleStrikethrough);cb.rk.Owe(!Cb);break;case ka.a.fE:cb.rk.xxb();break;case ka.a.z8:ia.hasProperty(y.a.RF)&&cb.rk.z8(ia.getValue(y.a.RF));ia.hasProperty(F.a.noProof)&&(Cb=ia.getValue(F.a.noProof),cb.rk.wXo(Cb));break;default:this.Lth.has(Cb)||(this.Lth.add(Cb),(ia=f.ActionManager.D$(Cb))&&
ia.length||(ia="UnknownAction"),G.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${ia} (${Cb})`))}}Fa.StaticActiveAppFrame.za().Ge();return Ha};this.BW=(Cb,Kb,$b,ab,ia)=>{ab=cb.Ac.rq(ka.a.kUo);var La=!0;Kb.contextId!==N.a.Zc&&(La=!1);if(1===$b||!La)return La?32:8;$b=Kb.node;nb.ListItemReader.De?La=nb.ListItemReader.isListItem($b):(La=O.a.eb($b),La.Nd(),La=La.zla(4),La=!!La&&cb.Pd.cta(La));if(La&&!Pa.a.oqc)return 8;var Mb=!pa.ParagraphReader.textLength($b);
ab.properties.W("Action",Cb.toString());ab.properties.W("ListContext",La.toString());ab.properties.W("IsEmptyParagraph",Mb.toString());G.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",Cb,La,Mb);La=$b.ra.last;this.RAo($b,Cb);var Ha=!!La.formatting;const zb=$b.getValue(F.a.Vza);Mb=this.Rd.R7a($b);Ha=!Ha&&zb&&zb.equals(a.a.nil)?new Y.a(La,a.a.nil):Mb.Of(Mb.Ib);this.Kwc(Mb,Cb,ia,La.cp);cb.Lj.x_b($b,La,Kb.cpBegin,Kb.cpEnd,Ha,Mb,cb.Qd.Bg);ab.end();return 32};
this.Dqa=(Cb,Kb,$b)=>{Cb=!0;const ab=O.a.eb(Kb.node);ab.Nd();Kb.contextId===N.a.Zc&&(nb.ListItemReader.De?nb.ListItemReader.isListItem(Kb.node):ab.zla(4))||(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.p3f}),Cb=!1);return(nb.ListItemReader.De?nb.ListItemReader.isListItem(Kb.node):cb.Pd.cta(ab.currentNode))?1!==$b&&Cb?32:Cb?32:8:8};this.yua=(Cb,Kb,$b,ab,ia)=>{Cb=!0;Kb.contextId!==N.a.paragraph&&(Cb=!1);if(1===$b&&!Cb)return 8;$b=Kb.node;-1!==ia.si?ia.si!==pa.ParagraphReader.Xy($b)&&(ia.si=0):ia.si=pa.ParagraphReader.Xy($b);
Cb=this.Sp.Sqb($b);ia.Cu?(!ia.wZm&&this.zZm(ia.Cu,Cb)&&2===ia.Cu.specialIndentType&&(ia.Cu.specialIndentType=0),ia.Cu.qsb===Cb.qsb&&l.a.xBa(ia.Cu.RA,Cb.RA)||(ia.Cu.RA=Number.MAX_VALUE),ia.Cu.rsb===Cb.rsb&&l.a.xBa(ia.Cu.Hfa,Cb.Hfa)||(ia.Cu.Hfa=Number.MAX_VALUE)):ia.Cu=Cb;Kb=Object(la.a)().NUh(Kb.Lk);void 0!==Kb&&null!==Kb&&(Kb=Kb.node,void 0!==Kb&&null!==Kb&&(Kb=Q.WordSectionNavigator.instance.NU(Kb),void 0!==Kb&&null!==Kb&&(Kb=cb.qg.Jv(Kb)-(cb.qg.gN(Kb)+cb.qg.hN(Kb)+Pa.a.LEa),Cb.h7c=Kb-Cb.RA,Cb.g7c=
Kb-Cb.Hfa,ia.Cu.g7c=Math.min(ia.Cu.g7c,Cb.g7c),ia.Cu.h7c=Math.min(ia.Cu.h7c,Cb.h7c))));Kb=this.hZ.HVa($b);ia.cQ?(ia.cQ.beforeSpacing=cb.vQh(Kb.beforeSpacing,ia.cQ.beforeSpacing),ia.cQ.afterSpacing=cb.vQh(Kb.afterSpacing,ia.cQ.afterSpacing),ia.cQ.lineSpacing.unit===Kb.lineSpacing.unit&&l.a.xBa(ia.cQ.lineSpacing.value,Kb.lineSpacing.value)||(ia.cQ.lineSpacing.unit=0,ia.cQ.lineSpacing.value=0)):ia.cQ=Kb;Kb=new O.a;Kb.set($b);Kb.zb(11);if($b=Kb.kd(11))ia.isRtl=T.a.Go($b);$b=cb.Pd.Uw(Kb);Kb=16;void 0!==
$b&&null!==$b&&(Kb=$b.listType);ia.listType=cb.Jom(ia.listType,Kb);ia.fz=16===ia.listType?null:$b;return 32};this.ylo=(Cb,Kb,$b,ab,ia)=>{ia.isRtl=T.a.Go(V.OutlineElementNavigator.Pm(Kb.node));return 32};this.tTh=(Cb,Kb,$b)=>{if(Cb===ka.a.Y_b)Cb=!0;else if(Cb===ka.a.X_b)Cb=!1;else return 2;Cb&&this.Q$i(Kb);if(1===$b)return 32;this.Vh.O_b(V.OutlineElementNavigator.Pm(Kb.node),Cb);return 32};this.olo=(Cb,Kb,$b,ab,ia)=>{Cb=Kb.node;ia.isRtl=T.a.isRtl(V.OutlineElementNavigator.Pm(Cb));ia.si=X.a.Xy(Cb);
return 32};this.zmo=(Cb,Kb,$b,ab,ia)=>{Cb=Kb.node;ia.isRtl=T.a.isRtl(V.OutlineElementNavigator.Pm(Cb));ia.si=Ga.TableReader.Xy(Cb);-1!==ia.si&&ia.si||(ia.si=ia.isRtl?3:1);return 32};this.$cc=(Cb,Kb,$b,ab,ia)=>{let La;if(!({Hz:La}=fb.a.BAg($b,Kb)).returnValue)return La;const Mb=Kb.node;switch(Cb){case ka.a.X_b:this.Vh.dxc(Mb,!1);break;case ka.a.Y_b:this.Q$i(Kb);this.Vh.dxc(Mb,!0);break;case ka.a.z8:La=m.AFrameworkApplication.va.Hf(Kb.Lk,Cb,$b,!0,ab,ia),32===La&&pa.ParagraphReader.en(Kb)&&cb.bid&&cb.bid.zha(Mb)}return 32};
this.Prl=(Cb,Kb,$b,ab,ia)=>{const La={};La[Na.a.fPa]=6168;La[Na.a.ePa]=6169;var Mb=Kb.view;const Ha=new Ca.GraphTransaction(1===$b?3:15);Ha.Ab(Mb.root);let zb=Na.a.nua(Cb,Kb,$b,ab,ia,La,0),ac=null;Mb.vj&&(ac=Mb);Mb=!0;let nc=null;ac&&(nc=ac.lb.gb.currentSelection)&&(Cb=!fb.a.snc(Cb),cb.tg.M_f(nc,Cb)?(cb.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.UG}),zb=8,Mb=!1):1===$b&&(zb=32,Mb=!1),Object(la.a)().HEa(pa.ParagraphReader.xX,ac.lb.Pg)&&(cb.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.XQ}),zb=8,Mb=!1));Mb&&this.xtn(nc)&&(zb=
Na.a.nua(ka.a.lnb,Kb,$b,ab,ia,La,12));Ha.dispose();return zb};this.Orl=(Cb,Kb,$b)=>{Cb=!0;Kb.contextId!==N.a.paragraph&&Kb.contextId!==N.a.Vc?Cb=!1:cb.tg.gab(Kb)&&(cb.Ac.fc(qa.a.Pn,{["Reason"]:ua.a.UG}),Cb=!1);if(1===$b||!Cb)return Cb?32:8;Kb=Kb.node;$b=new Ca.GraphTransaction(15);$b.Ab(Kb);cb.Kl.sVc(Kb);this.xv.ZLb(Kb,!0);this.ew.xVc(Kb);$b.dispose();return 2};this.UUm=(Cb,Kb,$b)=>{Cb=!0;Kb.contextId!==N.a.view&&(Cb=!1);if(1===$b&&!Cb)return 8;if(!Kb.view||!Kb.view.ve)return 2;Kb=Kb.view;if(!Kb.lb||
!Kb.lb.gb.currentSelection)return 8;if(Object(la.a)().HEa(pa.ParagraphReader.xX,Kb.lb.Pg))return cb.Ac.fc(qa.a.Ne,{["Reason"]:ua.a.XQ}),8;Kb=Kb.lb.gb;for(const ab of Kb)for(const ia of ab)if(ia&&ia.contextId!==N.a.Cd&&ia.contextId!==N.a.Vc&&ia.contextId!==N.a.paragraph&&ia.contextId!==N.a.Zc)return 2;return 32};this.Kcb=(Cb,Kb,$b,ab,ia)=>{Cb=!0;Kb.contextId!==N.a.paragraph&&(Cb=!1);if(1===$b&&!Cb)return 8;ia.Cu||(Kb=Kb.node,$b=this.Sp.Sqb(Kb),ia.Cu=$b,Kb=V.OutlineElementNavigator.Pm(Kb),ia.isRtl=
Kb?T.a.Go(Kb):!1);return 32};this.Amo=(Cb,Kb,$b,ab,ia)=>{Kb=Kb.node;Cb=V.OutlineElementNavigator.Pm(Kb);ia.Cu||(Kb=this.KEm(Kb),Kb=this.Sp.Sqb(Kb),ia.Cu=Kb,ia.isRtl=T.a.isRtl(Cb));return 32};this.uwk=sb;this.tda=pb;this.M9=tb;this.Gp=wb;this.Ee=gc;this.Rd=vc;this.xv=Pc;this.hZ=ld;this.ew=ic;this.hy=Dc;this.Vh=mc;this.Sp=rb}get IP(){return null!=this.G2g?this.G2g:this.G2g=w.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get wLa(){if(null!=cb.n_g)var sb=cb.n_g;else{var pb;m.AFrameworkApplication.$c("repeat_T;repeat_C");
sb=null===(pb=m.AFrameworkApplication.J)||void 0===pb?void 0:pb.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1);sb=cb.n_g=sb}return sb}get mYf(){if(null!=this.KZg)var sb=this.KZg;else m.AFrameworkApplication.$c("91cji169;50h4g153"),sb=this.KZg=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isGalleryFormattingEOPFixEnabled",!1);return sb}get D3d(){return!!this.M9&&this.M9.enabled}Xb(){const sb=m.AFrameworkApplication.va,
pb=this.ylo;(cb.rc?cb.rc.rE(34):m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled"))?(sb.qa(ka.a.font,N.a.Zc,this.BW),sb.qa(ka.a.pC,N.a.Zc,this.BW),sb.qa(ka.a.S2,N.a.Zc,this.BW),sb.qa(ka.a.l4,N.a.Zc,this.BW),sb.qa(ka.a.hx,N.a.Zc,this.BW),sb.qa(ka.a.eva,N.a.Zc,this.BW),sb.qa(ka.a.jka,N.a.Zc,this.BW),sb.qa(ka.a.rY,N.a.Zc,this.BW),sb.qa(ka.a.sca,N.a.Zc,this.BW),sb.qa(ka.a.Vya,N.a.Zc,this.BW),sb.qa(ka.a.bold,N.a.Zc,this.BW),sb.qa(ka.a.fA,N.a.Zc,this.BW),sb.qa(ka.a.underline,
N.a.Zc,this.BW),sb.qa(ka.a.sha,N.a.Zc,this.BW),sb.qa(ka.a.superscript,N.a.Zc,this.BW),sb.qa(ka.a.subscript,N.a.Zc,this.BW),sb.qa(ka.a.strikethrough,N.a.Zc,this.BW),sb.qa(ka.a.xu,N.a.Zc,this.BW),sb.qa(ka.a.z8,N.a.Zc,this.BW),sb.qa(ka.a.fE,N.a.Zc,this.BW)):Pa.a.oqc&&(sb.qa(ka.a.font,N.a.Zc,this.Dqa),sb.qa(ka.a.pC,N.a.Zc,this.Dqa),sb.qa(ka.a.hx,N.a.Zc,this.Dqa),sb.qa(ka.a.eva,N.a.Zc,this.Dqa),sb.qa(ka.a.jka,N.a.Zc,this.Dqa),sb.qa(ka.a.bold,N.a.Zc,this.Dqa),sb.qa(ka.a.fA,N.a.Zc,this.Dqa),sb.qa(ka.a.superscript,
N.a.Zc,this.Dqa),sb.qa(ka.a.subscript,N.a.Zc,this.Dqa),sb.qa(ka.a.strikethrough,N.a.Zc,this.Dqa),sb.qa(ka.a.xu,N.a.Zc,this.Dqa),sb.qa(ka.a.S2,N.a.Zc,this.Dqa),sb.qa(ka.a.l4,N.a.Zc,this.Dqa));const tb=Pa.a.Y_a.nXc(wb=>Ea.OutlineElementGeneralizer.cla(wb.gb,!0));sb.fb(ka.a.cnf,N.a.view,this.UUm,100);sb.fb(ka.a.Ard,N.a.Cd,this.Ard,1028);sb.qa(ka.a.lZa,N.a.view,this.Nwj);sb.qa(ka.a.Aid,N.a.view,this.Nwj);sb.qa(ka.a.yua,N.a.view,tb);sb.qa(ka.a.yua,N.a.paragraph,this.yua);sb.qa(ka.a.yua,N.a.image,this.olo);
sb.qa(ka.a.yua,N.a.POa,pb);sb.qa(ka.a.yua,N.a.table,this.zmo);sb.qa(ka.a.Kcb,N.a.view,tb);sb.qa(ka.a.Kcb,N.a.paragraph,this.Kcb);sb.qa(ka.a.Kcb,N.a.table,this.Amo);sb.Pc(ka.a.lZa,99);sb.Pc(ka.a.Aid,1127);sb.Pc(ka.a.yua,97);sb.Pc(ka.a.Kcb,97);this.zO(sb,ka.a.font);this.zO(sb,ka.a.pC);this.zO(sb,ka.a.S2);this.zO(sb,ka.a.l4);sb.Slb(ka.a.Ppi,N.a.view,this.yhf);sb.Pc(ka.a.Ppi,1092);this.zO(sb,ka.a.hx);this.zO(sb,ka.a.eva);this.zO(sb,ka.a.jka);this.zO(sb,ka.a.rY);this.zO(sb,ka.a.sca);this.zO(sb,ka.a.q6a);
this.zO(sb,ka.a.aIa);this.zO(sb,ka.a.bIa);this.zO(sb,ka.a.Sya);this.zO(sb,ka.a.r6a);this.zO(sb,ka.a.Vya);this.zO(sb,ka.a.bold);sb.o_b(ka.a.bold,this.pPb);this.zO(sb,ka.a.fA);sb.o_b(ka.a.fA,this.pPb);this.zO(sb,ka.a.underline);sb.o_b(ka.a.underline,this.pPb);this.zO(sb,ka.a.sha);this.zO(sb,ka.a.superscript);sb.o_b(ka.a.superscript,this.pPb);this.zO(sb,ka.a.subscript);sb.o_b(ka.a.subscript,this.pPb);this.zO(sb,ka.a.strikethrough);sb.o_b(ka.a.strikethrough,this.pPb);this.zO(sb,ka.a.xu);sb.o_b(ka.a.xu,
this.pPb);sb.fb(ka.a.EWa,N.a.Cd,this.hSd,96);sb.Slb(ka.a.z8,N.a.view,this.yhf);sb.qa(ka.a.z8,N.a.paragraph,this.$cc);sb.qa(ka.a.z8,N.a.Cd,this.hSd);sb.qa(ka.a.z8,N.a.Vc,this.Ghf);sb.qa(ka.a.fE,N.a.view,this.Prl);sb.qa(ka.a.fE,N.a.paragraph,this.Orl);sb.qa(ka.a.fE,N.a.Cd,this.hSd);sb.qa(ka.a.fE,N.a.Vc,this.Ghf);sb.Pc(ka.a.fE,1036);sb.qa(ka.a.lnb,N.a.Cd,this.lnb);sb.qa(ka.a.lnb,N.a.Vc,this.lnb);sb.qa(ka.a.qVc,N.a.view,this.qVc);sb.qa(ka.a.X_b,N.a.view,fb.a.zx);sb.qa(ka.a.X_b,N.a.paragraph,this.$cc);
sb.qa(ka.a.X_b,N.a.POa,this.tTh);sb.Pc(ka.a.X_b,1028);sb.qa(ka.a.Y_b,N.a.view,fb.a.zx);sb.qa(ka.a.Y_b,N.a.paragraph,this.$cc);sb.qa(ka.a.Y_b,N.a.POa,this.tTh);sb.Pc(ka.a.Y_b,1028)}zO(sb,pb){sb.Slb(pb,N.a.view,this.yhf);sb.qa(pb,N.a.Cd,this.hSd);sb.qa(pb,N.a.Vc,this.Ghf);sb.Pc(pb,1036)}dyl(sb,pb){for(const Dc of sb)for(const ic of Dc){sb=null;if(ic.contextId===N.a.Cd){if(aa.b(ic))continue;sb=[];var tb=ic.node.ra;if(tb){var wb=tb.length-1,gc=ic.cpBegin;const mc=ic.cpEnd;let Rc=!1;const rb=ic.node.characterData;
if(rb&&""!==rb){var vc=rb.substr(gc,mc-gc);vc&&""!==vc&&z.a.Dqf(vc,0,vc.length)&&(Rc=!0)}vc=!1;for(let Cb=0;Cb<wb;Cb++){var Pc=tb.Ub(Cb).cp,ld=tb.Ub(Cb+1).cp;if(tb.Ub(Cb).formatting&&Math.max(Pc,gc)<Math.min(ld,mc)){if(rb&&""!==rb&&(Pc=Pc<gc?gc:Pc,ld=rb.substr(Pc,(ld<mc?ld:mc)-Pc),!Rc&&z.a.Dqf(ld,0,ld.length)))continue;vc=!0;sb.push(tb.Ub(Cb).formatting)}else if(vc)break}tb.Ub(wb).formatting&&ic.cpEnd>tb.Ub(wb).cp&&sb.push(tb.Ub(wb).formatting)}}else if(ic.contextId===N.a.paragraph&&!pa.ParagraphReader.xX(ic)){if(sb=
[],tb=ic.node.ra)for(wb=this.mYf&&1!=tb.length?tb.length-1:tb.length,gc=0;gc<wb;gc++)tb.Ub(gc).formatting&&sb.push(tb.Ub(gc).formatting)}else if(ic.contextId===N.a.Zc&&(!this.mYf||this.mYf&&1===Dc.length))sb=[U.FormattingReader.Vs(ic)];else if(ic.contextId===N.a.Vc){this.Xko(ic,pb);return}if(sb&&0<sb.length)for(const mc of sb)if(U.FormattingReader.bKg(pb,mc.cache,ic))return}}Xko(sb,pb){if(sb=U.FormattingReader.Vs(sb)){sb=sb.cache;var tb=cb.rk.rI(y.a.bold,sb.isBold);pb.bold=tb?1:0;tb=cb.rk.rI(y.a.italic,
sb.isItalic);pb.italic=tb?1:0;tb=cb.rk.rI(y.a.underline,sb.isUnderline);pb.underline=tb?1:0;pb.underlineType=cb.rk.rI(y.a.underlineType,sb.underlineType);tb=cb.rk.rI(y.a.superscript,sb.isSuperscript);pb.superscript=tb?1:0;tb=cb.rk.rI(y.a.subscript,sb.isSubscript);pb.subscript=tb?1:0;tb=cb.rk.rI(y.a.strikethrough,sb.isStrikethrough);pb.strikethrough=tb?1:0;tb=cb.rk.rI(H.a.xu,sb.isDoubleStrikethrough);pb.xu=tb?1:0;tb=cb.rk.rI(y.a.font,sb.pI);pb.fontName=Ja.a.U8a(tb);pb.Rha=sb.Te;pb.fontSize=cb.rk.rI(y.a.fontSize,
sb.fontSize);pb.fontColor=cb.rk.rI(y.a.fontColor,sb.fontColor);pb.highlight=cb.rk.rI(y.a.highlight,sb.highlight)}}v6o(sb){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isUnderlineButtonSelectionBugFixEnabled",!1)?sb===ka.a.sha||sb===ka.a.xu||sb===ka.a.rY:sb===ka.a.underline||sb===ka.a.sha||sb===ka.a.strikethrough||sb===ka.a.xu||sb===ka.a.rY}static YIf(sb){return"string"===typeof sb?{fontName:sb,Rha:-1,bold:2,italic:2}:sb}AW(sb,pb,tb,wb){var gc;const vc=sb.cpBegin,
Pc=sb.cpEnd,ld=sb.node;var Dc=U.FormattingReader.Vs(sb);let ic=vc;const mc=null===(gc=m.AFrameworkApplication.J)||void 0===gc?void 0:gc.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);gc=cb.Qd.Bg;if(mc&&(gc||ld.Nv))return!1;if(Ta.has(pb))for(const Rc of ld.ra)if(!(Rc.cp<=vc)){if(Rc.cp>=Pc)break;Rc.formatting&&Rc.formatting.cache.fontSize!=Dc.cache.fontSize&&(Dc=this.cJf(sb.node,Dc,pb,tb,mc?null:wb),this.tda.annotateRange(sb.node,mc?ld.ra.E7a(ic):ic,mc?ld.ra.E7a(Rc.cp):
Rc.cp,Dc),ic=Rc.cp,Dc=Rc.formatting)}pb=this.cJf(sb.node,Dc,pb,tb,mc?null:wb);this.tda.annotateRange(sb.node,mc?ld.ra.E7a(ic):ic,mc?ld.ra.E7a(Pc):Pc,pb);return!0}cJf(sb,pb,tb,wb,gc){const vc={},Pc=Object(K.a)(444,wb),ld=pb.cache;switch(tb){case ka.a.bold:2===wb.value&&(wb.value=ld.isBold?0:1);vc[y.a.bold.id]=1===wb.value;break;case ka.a.fA:2===wb.value&&(wb.value=ld.isItalic?0:1);vc[y.a.italic.id]=1===wb.value;break;case ka.a.underline:2===wb.value&&(wb.value=ld.isUnderline?0:1);wb=1===wb.value;vc[y.a.underline.id]=
wb;vc[y.a.underlineType.id]=wb?Ja.a.wAb:Ja.a.xV;break;case ka.a.sha:vc[y.a.underlineType.id]=wb.number;vc[y.a.underline.id]=wb.number!==Ja.a.xV;break;case ka.a.superscript:2===wb.value&&(wb.value=ld.isSuperscript?0:1);vc[y.a.superscript.id]=1===wb.value;1===wb.value&&(vc[y.a.subscript.id]=!1);break;case ka.a.subscript:2===wb.value&&(wb.value=ld.isSubscript?0:1);vc[y.a.subscript.id]=1===wb.value;1===wb.value&&(vc[y.a.superscript.id]=!1);break;case ka.a.strikethrough:6!==m.AFrameworkApplication.va.gE?
G.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===wb.value&&(wb.value=ld.isStrikethrough?0:1);vc[y.a.strikethrough.id]=1===wb.value;break;case ka.a.xu:2===wb.value&&(wb.value=ld.isDoubleStrikethrough?0:1);vc[H.a.xu.id]=1===wb.value;break;case ka.a.font:if(Pc&&Pc.rd){const {fontName:ic,Rha:mc,bold:Rc,italic:rb}=cb.YIf(Pc.rd);wb=ic.substr(0,cb.Acj);this.D3d&&(vc[F.a.d2.id]=wb,vc[F.a.zF.id]=
wb,vc[F.a.A6.id]=wb,vc[F.a.q7.id]=wb,vc[F.a.$e.id]=mc,vc[F.a.vf.id]=mc,vc[F.a.Ve.id]=mc,vc[F.a.ff.id]=mc);vc[y.a.font.id]=wb;vc[F.a.Te.id]=mc;if(Object(ra.a)()){wb=1==Rc;var Dc=1==rb;if(wb||Dc)vc[y.a.bold.id]=wb,vc[y.a.italic.id]=Dc}}break;case ka.a.hx:wb=Oa.a.instance.lka(sb,wb);vc[y.a.fontColor.id]=wb;break;case ka.a.eva:Dc=Oa.a.instance.lka(sb,wb);vc[y.a.fontColor.id]=Dc;this.IP.cTa(wb)||G.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ka.a.jka:vc[y.a.fontColor.id]=
E.a.auto;break;case ka.a.rY:vc[y.a.highlight.id]=parseInt(wb,16);break;case ka.a.sca:vc[y.a.highlight.id]=parseInt(wb,16);this.IP.cTa(wb)||G.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ka.a.Vya:vc[y.a.highlight.id]=E.a.auto;break;case ka.a.pC:vc[y.a.fontSize.id]=this.Ee.Uec(Pc.rd);break;case ka.a.S2:ld&&ld.fontSize&&(vc[y.a.fontSize.id]=this.wwm(ld.fontSize));break;case ka.a.l4:ld&&ld.fontSize&&(vc[y.a.fontSize.id]=this.wpm(ld.fontSize));
break;case ka.a.EWa:if(wb=null===(Dc=cb.oB)||void 0===Dc?void 0:Dc.EWa)for(const ic of wb.Zj())vc[ic.id]=wb.zf(ic);break;case ka.a.fE:if(wb=pb.mo)for(const ic of wb.Zj())vc[ic.id]=null;vc[F.a.YLb.id]=!0;break;case ka.a.aIa:case ka.a.bIa:case ka.a.q6a:case ka.a.Sya:case ka.a.r6a:ld.WVa&&2===ld.capitalization&&(vc[H.a.capitalization.id]=0)}null!=gc&&(vc[m.AFrameworkApplication.FEf]=gc);return vc}wwm(sb){sb=this.Ee.S2(sb);return this.Ee.Uec(sb)}wpm(sb){sb=this.Ee.l4(sb);return this.Ee.Uec(sb)}Kwc(sb,
pb,tb,wb){var gc=sb.cache;const vc=Object(K.a)(444,tb);switch(pb){case ka.a.bold:tb=cb.wLa?new da.a(tb.value):tb;2===tb.value&&(tb.value=gc.isBold?0:1);this.Ee.HN(sb,1===tb.value);break;case ka.a.fA:tb=cb.wLa?new da.a(tb.value):tb;2===tb.value&&(tb.value=gc.isItalic?0:1);this.Ee.fA(sb,1===tb.value);break;case ka.a.underline:tb=cb.wLa?new da.a(tb.value):tb;2===tb.value&&(tb.value=gc.isUnderline?0:1);this.Ee.C8(sb,1===tb.value);break;case ka.a.sha:this.Ee.sha(sb,tb);break;case ka.a.superscript:tb=cb.wLa?
new da.a(tb.value):tb;2===tb.value&&(tb.value=gc.isSuperscript?0:1);this.Ee.hva(sb,1===tb.value);break;case ka.a.subscript:tb=cb.wLa?new da.a(tb.value):tb;2===tb.value&&(tb.value=gc.isSubscript?0:1);this.Ee.NNa(sb,1===tb.value);break;case ka.a.strikethrough:6!==m.AFrameworkApplication.va.gE?G.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");tb=cb.wLa?new da.a(tb.value):tb;2===tb.value&&(tb.value=
gc.isStrikethrough?0:1);this.Ee.una(sb,1===tb.value);break;case ka.a.xu:tb=cb.wLa?new da.a(tb.value):tb;2===tb.value&&(tb.value=gc.isDoubleStrikethrough?0:1);this.Ee.Owe(sb,1===tb.value);break;case ka.a.font:if(vc&&vc.rd){const {fontName:Pc,Rha:ld,bold:Dc,italic:ic}=cb.YIf(vc.rd);this.Ee.lha(sb,Pc.substr(0,cb.Acj));this.Ee.qzg(sb,ld);Object(ra.a)()&&(tb=1==Dc,wb=1==ic,tb||wb)&&(this.Ee.HN(sb,tb),this.Ee.fA(sb,wb))}break;case ka.a.hx:G.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");
this.Ee.hx(sb,tb,null);break;case ka.a.eva:this.Ee.hx(sb,tb,null);this.IP.cTa(tb)||G.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ka.a.jka:this.Ee.jka(sb);break;case ka.a.rY:G.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Ee.NDa(sb,tb);break;case ka.a.sca:this.Ee.NDa(sb,tb);this.IP.cTa(tb)||G.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ka.a.Vya:this.Ee.sVd(sb);break;case ka.a.pC:this.Ee.pC(sb,vc.rd);break;case ka.a.S2:this.Ee.rLi(sb);break;case ka.a.l4:this.Ee.mVj(sb);break;case ka.a.z8:gc=tb.ka(F.a.noProof,!1);this.Ee.kxe(sb,tb.getValue(y.a.RF),wb,gc);break;case ka.a.EWa:this.Ee.Vwe(sb);break;case ka.a.fE:this.Ee.Wqa(sb);break;case ka.a.aIa:case ka.a.bIa:case ka.a.q6a:case ka.a.Sya:case ka.a.r6a:gc.WVa&&2===gc.capitalization&&this.Ee.Brl(sb)}}RAo(sb,pb){ka.a.fE===pb&&V.OutlineElementNavigator.Pm(sb).properties.removeProperty(y.a.H3)}zZm(sb,
pb){return this.NTh(sb,pb)||this.NTh(pb,sb)}NTh(sb,pb){return(1===sb.specialIndentType||!sb.specialIndentType)&&2===pb.specialIndentType}KEm(sb){var pb;sb=O.a.eb(sb);sb.zb(11);W.moveToCell(sb,0,0);sb.je();if(null===(pb=Db.a.getInstance())||void 0===pb?0:pb.E7)return T.a.jN(sb);sb.n7();return sb.currentNode}xtn(sb){return!sb||xa.a.ym(sb)||1===sb.length&&xa.a.Zl(sb.Qa)&&!xa.a.etb(sb.Qa)?!1:!0}Q$i(sb){cb.PCh.tb(sb.contextId)||(G.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",sb.contextId),cb.PCh.W(sb.contextId,
!0))}zgn(sb){return sb===ka.a.q6a||sb===ka.a.aIa||sb===ka.a.bIa||sb===ka.a.Sya||sb===ka.a.r6a}IUd(sb,pb){const tb=sb.node,wb=tb.characterData.substr(sb.cpBegin,sb.cpEnd-sb.cpBegin);this.kub.set("Command",pb.toString());x.Health.instance.recordKpiUsage(this.kpiName,1,this.Baa,this.kub);pb=cb.hkp(wb,pb);tb.bva(tb.characterData.substr(0,sb.cpBegin)+pb+tb.characterData.substr(sb.cpEnd));return 32}static get rk(){return cb.oB||(cb.oB=w.a.instance.resolve("Box4.IInsertionPointFormatting"))}static xy(){return cb.Vn||
(cb.Vn=w.a.instance.Ta("Box4.IExternalSelectionManager"))}static get tg(){return va.a.instance}static get Ac(){return u.a.instance}static get rc(){return null!=cb.wVg?cb.wVg:cb.wVg=w.a.instance.Oa("Box4.IFeatureHelper")}static get bid(){return Pa.a.eQ}static get Qd(){return null!=cb.f6g?cb.f6g:cb.f6g=w.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Lj(){return null!=cb.E5g?cb.E5g:cb.E5g=w.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get ED(){return null!=
cb.g5g?cb.g5g:cb.g5g=w.a.instance.resolve("Box4.TextFormattingHelper")}static get Pd(){return null!=cb.C0g?cb.C0g:cb.C0g=w.a.instance.resolve("Box4.List.IListReader")}static get Kl(){return null!=cb.n0g?cb.n0g:cb.n0g=w.a.instance.resolve("Box4.List.IListEditor")}static get qg(){return ba.a.instance}static Jom(sb,pb){return 42===sb?pb:sb!==pb||16===sb?16:sb}static vQh(sb,pb){sb.hWi||(pb.hWi?pb=sb:pb.unit===sb.unit&&l.a.xBa(pb.value,sb.value)||(pb.value=-1));return pb}static hkp(sb,pb){switch(pb){case ka.a.aIa:return sb.toLowerCase();
case ka.a.bIa:return 6!==m.AFrameworkApplication.va.gE?G.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):G.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),sb.toUpperCase();case ka.a.q6a:case ka.a.Sya:return cb.gol(sb,pb===ka.a.Sya);case ka.a.r6a:return cb.Fmp(sb);default:return sb}}static Fmp(sb){let pb="";for(let tb=0;tb<sb.length;tb++)pb=sb.charAt(tb)===sb.charAt(tb).toUpperCase()?pb+sb.charAt(tb).toLowerCase():pb+sb.charAt(tb).toUpperCase();
return pb}static gol(sb,pb){let tb,wb,gc=!0,vc=sb.length,Pc=0,ld=cb.e0f(sb,Pc,vc);for(;0<vc;){wb=tb=!1;var Dc=vc;let mc;var ic=void 0;for(ic=0;0<Dc&&cb.Hql(sb.charAt(Pc+ic));ic++,Dc--)wb=cb.nfe(sb.charAt(Pc+ic));for(mc=ic;0<Dc&&!(tb=cb.nfe(sb.charAt(Pc+ic)))&&" "!==sb.charAt(Pc+ic)&&"/"!==sb.charAt(Pc+ic);ic++,Dc--);Dc=ic-mc;if(0>=Dc)break;Pc+=mc;ic=sb.substr(Pc,Dc);ic=ic===ic.toUpperCase();if(ld||!ic)sb=gc||wb||pb?sb.substr(0,Pc)+sb.charAt(Pc).toUpperCase()+sb.substr(Pc+1,Dc-1).toLowerCase()+sb.substr(Pc+
Dc):sb.substr(0,Pc)+sb.substr(Pc,Dc).toLowerCase()+sb.substr(Pc+Dc);vc-=Dc+mc;Pc+=Dc;if(gc=tb)Pc++,vc--,ld=cb.e0f(sb,Pc,vc)}return sb}static e0f(sb,pb,tb){for(;0<tb&&!cb.nfe(sb.charAt(pb));){if(sb.charAt(pb)!==sb.charAt(pb).toUpperCase())return!1;pb++;tb--}return!0}static stn(sb,pb){for(var tb=0;0<pb&&!cb.nfe(sb.charAt(tb));){if(sb.charAt(tb)!==sb.charAt(tb).toLowerCase())return!1;tb++;pb--}return!0}static nfe(sb){return"."===sb||"!"===sb||"?"===sb?!0:!1}static Hql(sb){return-1==="0123456789".indexOf(sb)&&
sb.toUpperCase()===sb.toLowerCase()}static qpi(){const sb=w.a.instance.Ta("Common.ISystemInitiatedFeedback");sb&&sb.execute(pb=>{pb.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}cb.PCh=new R.a;cb.oB=null;cb.Vn=null;cb.Acj=31;Object(I.a)(cb,"TextFormattingActor",null,[])},2131:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.initial=0]="initial";f[f.EXj=1]="startSearch";f[f.jKj=2]="searching";f[f.Txb=3]="searchComplete";f[f.nvc=4]="replaceAllInProgress";
f[f.mvc=5]="replaceAllComplete";f[f.Uha=6]="tooManyResults";f[f.hYa=7]="noMatchesFound"})(m||(m={}));Object(I.b)("FindReplaceViewType",m)},2133:function(I,J,d){d.d(J,"a",function(){return m});var m;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(m||(m={}))},2162:function(I,J,d){function m(b,h){h=Object.assign(new da.a,{name:"LinkType",string:h});f(vb.a.Fan,
b,[h])}function f(b,h,r,A=!0){h&&h.UILocation&&Object(me.d)(b,A,me.e,0,h.UILocation,0,r)}function a(b,h){const r=Wa.a.instance;return new kv(b,h,r.nf("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,r.nf("WordEditor.Bookmark.FullBookmarkManager").value,r.resolve("Box4.IHyperlinkStrategy"),r.resolve("Box4.IHyperlinkEditor"),r.resolve("Box4.ICharacterPropertiesEditor"),r.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,r.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Cq.a.instance,r.Oa("Box4.IInternalLinkManager"))}function l(b,h){var r;return b===os.none?"none":null===(r=CE[b])||void 0===r?void 0:r[h]}function w(){const b=Wa.a.instance.Oa("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&v.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function z(){const b=Wa.a.instance.Oa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&v.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");
return b}function x(b){b.Ta("Box4.AugmentationLoop.IUtilsWrapper").execute(async h=>{var r,A,L,Z;await h.im();h=iJ.a.Nz();const oa=await h.getSession();null!==(Z=null===(L=null===(A=null===(r=null===oa||void 0===oa?void 0:oa.sessionManager)||void 0===r?void 0:r.networkWorkerManager)||void 0===A?void 0:A.globalUrl)||void 0===L?void 0:L.startsWith)&&void 0!==Z&&Z.call(L,"ws://localhost")&&(r={message:new rk.y({seq:0,ops:[new tt.a({parentPath:["session"],items:[{id:"doc",body:new hj.d({isReadonly:!1})}]}),
new tt.a({parentPath:["session","doc"],items:[{id:"headerfooters",body:new Ri.HeaderFooterSubDocument},{id:"comments",body:new Ri.CommentSubDocument},{id:"main",body:new Ri.MainSubDocument}]})]})},h.submitCustomMessage(r))})}d.r(J);var u=d(0),v=d(8),D=d(109),y=d(2),H=d(29),F=d(16),G=d(186),K=d(90);class R{constructor(b){this.kHg=0;this.NRb=this.iuc=this.dEa=null;this.mV=y.AFrameworkApplication.ua.Vr;this.N_=b;this.N_.Bv(K.a.mNj);this.N_.LE(K.a.mNj,Object(D.a)(this,this.z2n,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.NRb)return v.ULS.sendTraceTag(589050652,
344,100,"Returning existing promise"),this.NRb;this.dEa=this.mV.Xf("ComponentAttach","getCustomAuthConfig");return this.NRb=new Promise((b,h)=>{const r={};let A=!1,L=!1,Z=0;this.kHg=window.setInterval(()=>{4>Z?(Z++,this.N_.sendMessage(K.a.getCustomAuthConfig,r)):(window.clearInterval(this.kHg),A=!0,v.ULS.sendTraceTag(588087303,344,10,H.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.iuc=(oa,Ba)=>{window.clearInterval(this.kHg);A||L||(L=!0,oa?(v.ULS.sendTraceTag(589050653,
344,50,"Resolving Promise with authConfig"),b(oa)):(v.ULS.sendTraceTag(589050654,369,10,H.c({["error"]:Ba.toString()})),h(Ba)))};this.N_.sendMessage(K.a.getCustomAuthConfig,r)})}z2n(b){try{const h=H.a(b.Values[G.a.fjl]);let r=y.AFrameworkApplication.J.jb("Application")||"";r=F.a.xh(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.dEa&&(this.dEa.stop(),this.dEa=null);this.iuc(h,"")}catch(h){v.ULS.sendTraceTag(589050655,344,10,H.c({["error"]:h.message,["stack"]:h.stack})),this.iuc(null,h.message)}}}Object(u.a)(R,"AccountSwitchingManager",null,[207]);var E=d(178);class N{get name(){return"Common.App.AccountSwitching"}wc(b){b.register(R,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().Ud(()=>
new R(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){E.a.instance.Mc(new N)}}Object(u.a)(N,"AccountSwitchingPackage",null,[0,1]);var O;(function(b){b[b.x8a=0]="generalException";b[b.Zbe=1]="invalidArgument";b[b.sbg=2]="notAllowed";b[b.$gf=3]="apiNotAvailable";b[b.Aup=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.ndf=6]="adalTimeout";b[b.x$j=7]="userNotSignedIn";b[b.Atd=8]="userAborted";b[b.vVj=9]="silentSignInFailed";b[b.g8c=10]="invalidResourceUrl";b[b.zVf=
11]="invalidGrant";b[b.Q5h=12]="connectionLost";b[b.nof=13]="clientError";b[b.dxg=14]="serverError"})(O||(O={}));Object(u.b)("ErrorCodes",O);d(1851);class U{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(u.a)(U,"OutstandingRequest",null,[]);class X{}X.lSn="AADSTS50058";X.g8c="AADSTS50001";X.eSn="AADSTS65001";X.VSn="AADSTS70011";X.Atd="13002";X.veo="Popup Window is null";X.ueo="Popup Window closed";X.ndf="Token renewal operation failed due to timeout";
X.s1j="tokenRevoked";Object(u.a)(X,"WopiHostErrorType",null,[]);var V=d(634),Q=d(48),T=d(1850);class ba{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(ba,"WopiIdentityInfo",null,[791]);class W{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(u.a)(W,"WopiIdentityToken",null,[790]);var aa=d(17),Y=d(185),da=d(30),ka=d(236);class qa{constructor(b){this._initialized=
!1;this.y2n=h=>{let r=null;try{const L=h.Values[G.a.wDg],Z=h.Values[G.a.Qcp],oa=h.Values[G.a.cXj],Ba=h.Values[G.a.Ycp];let gb=null,Ab=null;const Jb=this.btc[L];if("undefined"!==typeof Jb&&Jb){var A=[];Array.add(A,Object.assign(new da.a,{name:G.a.vDg,string:Jb.requestParameters.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:A}));r=Jb.requestCallback;delete this.btc[L];"undefined"!==typeof Z&&Z&&Z.length?
Ab=new W(Z,oa,Ba):gb=O[this.VJn(h)];A="getAccessToken_"+L;A in this.AAe&&(this.AAe[A].stop(),delete this.AAe[A]);r(Ab,gb)}else v.ULS.sendTraceTag(37856066,344,10,H.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:L}))}catch(L){h=h.Values[G.a.wDg],h in this.btc&&delete this.btc[h],this.Ehe(),v.ULS.sendTraceTag(37856067,344,10,H.c({["error"]:L.message,["stack"]:L.stack})),r&&r(null,"generalException")}};this.btc={};this.AAe={};this.mV=y.AFrameworkApplication.ua.Vr;this.ySf=
b}s_c(b){this._initialized||(b.Bv(K.a.Ztc),b.LE(K.a.Ztc,this.y2n),this._initialized=!0)}getAccessToken(b,h,r=null){this.qP(b,h);return new Promise((A,L)=>{if(this.jWf(h))if(h in this.btc)L("unresolvedPendingRequest");else{var Z=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,H.c({["error"]:"Request timeout.",["callerId"]:h}));L("timeout")},12E4);this.zFf(b,h,r,(oa,Ba)=>{window.clearTimeout(Z);oa?A(oa):(v.ULS.sendTraceTag(37856033,369,15,H.c({["error"]:O[Ba]})),L(Ba))})}else v.ULS.sendTraceTag(37856034,
344,10,H.c({["error"]:"Caller is not allowed."})),L("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.jWf(b)?this.WGm((A,L)=>{A?h(A):(v.ULS.sendTraceTag(37856064,369,10,H.c({["error"]:L.toString()})),r(L))}):(v.ULS.sendTraceTag(37856065,344,10,H.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const A=this.getAuthContextSync(b);A?h(A):r("notAllowed")})}getAuthContextSync(b){if(this.jWf(b)){const h=new T.a;h.upn=y.AFrameworkApplication.J.jb("UserPrincipalName");
h.userId=y.AFrameworkApplication.J.jb("LoggableUserId");h.authority=y.AFrameworkApplication.J.jb("HostAuthAuthority");h.tenantId=y.AFrameworkApplication.J.jb("TenantId");h.isAnonymous=y.AFrameworkApplication.J.$("IsAnonymousUser");h.supportsAuthToken=this.c3m(b);b=y.AFrameworkApplication.J.jb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}v.ULS.sendTraceTag(40751647,344,10,H.c({["error"]:"Caller is not allowed."}));return null}c3m(b){const h=V.a.r6c;
return aa.a.mXa?h&&V.a.E_j?Array.contains(V.a.E_j,b.toLowerCase()):!1:h}zFf(b,h,r,A){var L=[];Array.add(L,Object.assign(new da.a,{name:"CallerId",string:h}));Array.add(L,Object.assign(new da.a,{name:G.a.vDg,string:b.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:L}));L=Q.a.create().toString();const Z="getAccessToken_"+L,oa=this.mV.Xf("ComponentAttach",Z);this.AAe[Z]=oa;const Ba={};Ba[G.a.wDg]=L;Ba[G.a.Vcp]=
b.resource;Ba[G.a.Wcp]=b.scope;Ba[G.a.cXj]=y.AFrameworkApplication.J.jb("HostAuthType");Ba[G.a.Zcp]=y.AFrameworkApplication.J.jb("UserPrincipalName");Ba[G.a.Xcp]=b.silentLogin;Ba[G.a.Scp]=b.options;Ba[G.a.vDg]=b.correlationId;Ba[G.a.Tcp]=h;r&&(Ba[G.a.addinName]=r.AddinName,Ba[G.a.Rcp]=r.AddinTrustId);this.ySf.execute(gb=>{this.s_c(gb);gb.sendMessage(K.a.getAuthToken,Ba)});this.btc[L]=new U(b,A)}WGm(b){const h=y.AFrameworkApplication.J.jb("UserName"),r=y.AFrameworkApplication.J.jb("UserPrincipalName"),
A=y.AFrameworkApplication.J.jb("LoggableUserIdSpace"),L=new ba;L.email=r;L.displayName=h;switch(A){case "OrgIdPuid":L.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":L.authority="MicrosoftAccount";break;default:L.authority=A}b(L,null)}jWf(b){var h=y.AFrameworkApplication.ZSm();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=V.a.fhf;for(const r in h)if(b===h[r].toLowerCase())return!0;return!1}VJn(b){b=b.Values[G.a.Ucp];this.Ehe();v.ULS.sendTraceTag(39068821,
344,15,H.c({["error"]:b}));return b?-1<b.indexOf(X.lSn)?9:-1<b.indexOf(X.veo)||-1<b.indexOf(X.ueo)?12:-1<b.indexOf(X.g8c)?10:-1<b.indexOf(X.Atd)?8:-1<b.indexOf(X.VSn)||-1<b.indexOf(X.eSn)||b===X.s1j?11:-1<b.indexOf(X.ndf)?6:0:13}qP(b,h){b=this.cto(b.resource);v.ULS.sendTraceTag(39921882,344,50,H.c({["callerId"]:h,["resource"]:b}))}Ehe(){v.ULS.sendTraceTag(39068822,344,50,H.c({["userAgent"]:window.navigator.userAgent}))}cto(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/",
"\\")}}Object(u.a)(qa,"WopiIdentityManager",null,[777]);class ua{constructor(){this.Z=null;this.iz=()=>{try{this.Z.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){v.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}}get name(){return"Common.App.WopiIdentity"}wc(b){this.Z=b;b.register(qa,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().Ud(()=>new qa(b.Ta("Postmessage.IHostPostmessenger")))}init(){y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.vp(this.iz)}dispose(){}static main(){E.a.instance.Mc(new ua)}}Object(u.a)(ua,"WopiIdentityPackage",null,[0,1]);var Pa=d(524),Ja=d(280),Ca=d(80),ra;(function(b){b[b.LUp=0]="applicationFeatureHelperHandler";b[b.QWp=1]="cloudPolicySettings";b[b.qUp=2]="alternateAuthToken"})(ra||(ra={}));Object(u.b)("ApplicationFeatureHelperRequestType",ra);class Ea{constructor(){this.message=null;this.httpStatusCode=0}}Object(u.a)(Ea,"HttpRequstToPromiseRejectData",null,[]);var xa=d(85),Ma=
d(46),ha=d(179),la=d(551);class Fa{constructor(b,h){this.Aa=b;this.If=h}NMb(b,h,r,A=null,L=null,Z=null,oa=null,Ba=null){const gb=ra[r],Ab=gb+"RequestFailure";xa.Health.instance.recordKpiUsage(Ab,0,"jpittsdirects",null);return new Promise((Jb,Tb)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",gb);const jc=null!=oa?oa:this.Aa.jc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Hc=null!=Ba?Ba:this.Aa.jc("ApplicationFeatureHelperRequestSentTimeout",
3E4);this.If.x5a(b,1,null,this.l3c(r,A),Z,1,hd=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",gb);try{if(void 0===hd||null===hd||void 0===hd.data||null===hd.data||void 0===hd.data.Pe||null===hd.data.Pe){xa.Health.instance.recordKpiFailure(Ab,"Invalid RequestSucceededEventArgs",!1,!0,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
gb);Tb(this.m7(de,hd))}else if(hd.data.He!==ha.a.qz){xa.Health.instance.recordKpiFailure(Ab,"HttpStatusCode_"+hd.data.He.toString(),!1,!0,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",hd.data.He,gb);Tb(this.m7(de,hd))}else{void 0!==L&&null!==L&&void 0!==hd.data.wi&&null!==hd.data.wi&&L(hd.data.wi);var Gd=h(hd.data.Pe);if(Gd)v.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",gb),Jb(Gd);else{xa.Health.instance.recordKpiFailure(Ab,"Parse Failure",!1,!0,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",gb);Tb(this.m7(de,hd))}}}catch(de){xa.Health.instance.recordKpiFailure(Ab,"Unexpected Failure",!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
de,gb),Tb(this.m7(Gd,hd))}},hd=>{if(hd.data){xa.Health.instance.recordKpiFailure(Ab,"HttpStatusCode_"+hd.data.He.toString(),!1,!0,null);var Gd=la.a.PQb(hd.data.Pe||"No Data");Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",hd.data.He,Gd,gb)}else xa.Health.instance.recordKpiFailure(Ab,"Invalid RequestFailedEventArgs",!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
gb);Tb(this.m7(Gd,hd))},void 0,void 0,jc,Hc)})}m7(b,h){const r=new Ea;r.message=b;r.httpStatusCode=h&&h.data?h.data.He:-1;return r}l3c(b,h){const r={};r["x-UserDataSignature"]=this.Aa.jb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Aa.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Aa.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Aa.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Aa.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]=
"true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=Ma.a.vL(window.location.href,"wd_afhpipl")||"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(h)for(const A of h.keys)r[A]=h.K(A);return r}}Object(u.a)(Fa,"HttpRequestToPromiseUtility",null,[]);var Ga;(function(b){b[b.lIn=0]="loki";b[b.VUp=1]="augloopACLP"})(Ga||(Ga={}));Object(u.b)("AlternateAuthSupportApp",Ga);class va{constructor(){this.Token=null;this.ExpirationTime=0}}Object(u.a)(va,"WacAlternateAuthToken",null,[]);class pa{constructor(b,h){this.Omp=3E5;this.F$n=r=>{let A=null;({av:A}=H.d(r));return A};if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Aa=b;this.owd=new Pa.a(Ja.a.vh());this.GIc=new Fa(b,h);void 0!==V.a.b6f&&null!==V.a.b6f&&void 0!==V.a.gie&&null!==V.a.gie&&0<V.a.gie&&(b=new va,b.Token=V.a.b6f,b.ExpirationTime=V.a.gie,this.owd.W("loki",b))}Mhm(){let b=null;this.owd.tb(Ga[0])&&(b=this.owd.K(Ga[0]));return void 0===b||null===b||this.Sfe(b)?this.N6l():Promise.resolve(b.Token)}Sfe(b){return b.ExpirationTime-Date.now()<this.Omp}N6l(){const b=new Pa.a(Ja.a.vh());b.W("X-AlternateAuthApp",Ga[0]);return this.GIc.NMb(this.tVa("/afhs/AlternateAuthHelperHandler.ashx"),
this.F$n,2,b).then(h=>{v.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Ga[0]);this.owd.W(Ga[0],h);return h.Token},h=>{h=Object(Ca.a)(Ea,h);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}tVa(b){const h=this.Aa.$("SuiteOriginForAFHSIsEnabled")?this.Aa.jb("SuiteOrigin"):this.Aa.jb("WebServiceBase");return String.format("{0}{1}?{2}",
h,b,y.AFrameworkApplication.rm)}}Object(u.a)(pa,"AlternateAuthHelper",null,[767]);var Oa=d(617);class Ra{constructor(b,h,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(u.a)(Ra,"FeatureStateChangeArgs",null,[]);var fb=d(877),qb=d(203),mb=d(81),eb=d(118),bb;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(bb||(bb={}));Object(u.b)("FeatureState",bb);var Wa=d(19),Za=d(12),Na=d(93);class Db{constructor(b,h,r=null,
A=null,L=null){this.Epb=this.Opa=this.KBh=this.mjb=this.aNd=null;this.K$n=Z=>{(Z=H.b(Z))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",Z)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Z.Features};this.wVm=()=>{v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.Epb.then(Z=>{this.Yzj(Z)}).catch(()=>{this.Yzj({})})};this.Lho=Z=>{try{Z&&"Date"in Z&&(this.Opa=new Date(Z.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Opa.toString()))}catch(oa){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",oa)}};this.GIc=new Fa(b,h);this.Aa=b;this.MDk=b.jc("LicensingMaxRetryAttempts",0);this.EEd=b.$("IsO365ConsumerHost");this.ZWe=b.$("IsO365CommercialHost");this.sWe=
b.$("PremiumUpsellIsEnabled");this.T7b=!1;this.vZe=0;this.sbh=r;this.MJh=A;this.ga=L;this.ljb=b.$("LicensingIsEnabled");this.xGb=b.$("OcpsIsEnabled")&&this.ZWe;this.sbf=b.$("ShowPrivacyDialog")&&!!A;this.I7b=b.$("IsAnonymousUser");this.a2d=new Promise(Z=>{Z(!1)});this.rAb=new Promise(Z=>{Z(!0)});this.Dpb=new Pa.a(Ja.a.vh());this.qPd=!0;this.Tsh=this.tym();this.fab()&&!this.I7b?(void 0!==y.AFrameworkApplication.ua&&null!==y.AFrameworkApplication.ua&&(this.aNd=y.AFrameworkApplication.ua.Vr,void 0!==
this.aNd&&null!==this.aNd&&(this.mjb=this.aNd.UXa("WebServiceCall","ApplicationFeatureHelperService"))),this.Epb=this.SIg()):this.Epb=new Promise(Z=>{Z({})});this.Epb.catch(Z=>{Z=Object(Ca.a)(Ea,Z);v.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Z?Z.httpStatusCode.toString():"Unknown")});this.qPd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Z=>{this.T7b=Z;return null})}tym(){const b=this.Aa.my("AllLicensedFeatures")?this.Aa.hD("AllLicensedFeatures"):
[],h=new Oa.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}fab(){return this.ZWe||this.EEd}SIg(b=0,h=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=fb.a.XG();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.EEd.toString()),r.set("isO365CommercialHost",this.ZWe.toString()),r.set("isFreemiumUpsellSettingEnabled",this.sWe.toString()));xa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",r);xa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.mjb&&null!==this.mjb&&this.mjb.start();let A=null;h&&(A=new Pa.a(Ja.a.vh()),A.W("x-LicensingForceRefresh","true"));this.KBh=new Date;return(this.ljb?this.GIc.NMb(this.tVa("/afhs/ApplicationFeatureHelperHandler.ashx"),this.K$n,0,A,this.Lho,["Date"]):Promise.resolve({})).then(L=>{const Z=Object.assign(new Na.a,{durationMs:this.WXj()});Z.extendedProperties=r;Z.extendedProperties&&L&&
(Z.extendedProperties.set("featureCount",mb.a.count(L).toString()),Z.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in L).toString()),Z.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in L).toString()),"FreemiumUpsell"in L&&Z.extendedProperties.set("isFreemiumUpsellEnabled",L.FreemiumUpsell.toString()),this.Opa&&Z.extendedProperties.set("fromCache",(this.Opa<this.KBh).toString()));xa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Z);
return L},L=>{const Z=Object.assign(new Na.a,{durationMs:this.WXj()}),oa=Object(Ca.a)(Ea,L);if(!oa)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Z),new Promise((Ba,gb)=>{gb(L)});Z.extendedProperties=r;Z.extendedProperties&&Z.extendedProperties.set("status",oa.httpStatusCode.toString());xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,Z);return 408===oa.httpStatusCode&&++b<=this.MDk?this.SIg(b):new Promise((Ba,gb)=>{gb(oa)})})}tVa(b){var h=this.Aa.$("SuiteOriginForAFHSIsEnabled")?this.Aa.jb("SuiteOrigin"):this.Aa.jb("WebServiceBase");h=String.format("{0}{1}",h,b);this.Aa.my("ApplicationFeatureHelperHttpCachingEnabled")&&this.Aa.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=Db.b7d(this.Aa))&&0<b.length&&(this.qPd&&(b+="ucbf"),h=new qb.QueryStringBuilder(h),h.Ae("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,
h){if(!this.xGb&&!this.sbf&&!this.ljb)return this.rAb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.xGb?this.sbh.cN("ControllerConnectedServicesEnabled"):this.rAb;const Z=this.sbf?this.MJh.getSettings().then(oa=>2!==oa.aL,()=>h):this.rAb;return r.then(oa=>oa?Z:this.a2d)}if("FreemiumUpsell"===b&&(!this.sWe||!this.EEd||this.I7b))return this.a2d;r=null;r=this.xGb?this.sbh.isFeatureEnabled(b):
this.rAb;let A=null;A=this.ljb?this.dkn(b,h):this.rAb;let L=null;L=this.sbf?this.MJh.isFeatureEnabled(b):this.rAb;return r.then(Z=>Z?L.then(oa=>oa?A:this.a2d):this.a2d).then(Z=>{this.c$i(b,Z,!0);return Z},()=>{this.c$i(b,h,!1);return h})}c$i(b,h,r){v.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.ljb)return new Promise(r=>{r(2)});v.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
b);return this.Epb.then(r=>this.d9d(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.sWe&&this.EEd&&!this.I7b){if(this.T7b&&2!==this.vZe||!this.T7b&&1!==this.vZe)v.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.T7b.toString()),this.vZe=this.T7b?2:1;return this.T7b}return!1}launchUpsellExperience(b,h=null){v.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
b));var r=fb.a.XG();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));xa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);(r=Wa.a.instance.Oa("Common.IInProductMessagingUIManager"))?r.L5i(b,this.wVm,h):(v.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb(Za.a.f4d,2,{["experience"]:b}))}Cua(b,h){if(!this.ljb)return null;if(!b||
!h)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=eb.a.create().toString();this.Dpb.tb(b)||this.Dpb.W(b,new Pa.a(Ja.a.vh()));this.Dpb.K(b).add(r,h);v.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",r,b));return r}iZb(b,h){this.ljb&&(b&&this.Dpb.tb(b)?h&&eb.a.isValid(h)?this.Dpb.K(b).tb(h)?(v.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.Dpb.K(b).remove(h)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):v.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}d9d(b,h,r){return this.qPd?b in h?h[b].LicenseTier:r:b in h?this.yao(h[b],r):r}yao(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}Yzj(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.SIg(0,!0);h.then(r=>{this.Epb=h;mb.a.count(r)>
mb.a.count(b)?xa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const A of this.Dpb.keys)if(A in r){const L=this.d9d(A,r,0);A in b?this.d9d(A,b,0)!==L&&this.Hbg(A,!0,L):this.Hbg(A,!0,L)}else A in b&&this.Hbg(A,!1,this.d9d(A,b,0))}).catch(r=>{xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,3004,10,
JSON.stringify(r))})}Hbg(b,h,r){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Ra(b,h,r);r=this.Dpb.K(b);for(const A of r)try{A.value(h)}catch(L){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,A.key,L.message))}}ckn(b,h){if(this.ljb){const r=
this.Tsh.contains(b);let A=!0,L="",Z=!1;return this.Epb.then(oa=>{b in oa?(oa=oa[b],L=bb[oa.FeatureState],A=1!==oa.FeatureState):A=!r;this.r$i(b,r,L,Z,h,A);return A},()=>{Z=!0;r&&(A=h);this.r$i(b,r,L,Z,h,A);return A})}return this.rAb}r$i(b,h,r,A,L,Z){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,A,r,L,Z)}dkn(b,h){if(this.qPd)return this.ckn(b,h);if(this.ljb){if(this.Tsh.contains(b))return this.Epb.then(r=>
b in r,()=>h);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.rAb}WXj(){if(void 0!==this.mjb&&null!==this.mjb){const b=this.mjb.Ri;this.mjb.stop();return b}return null}static b7d(b){try{if(aa.a.bBe){const h=b.jb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),A=JSON.parse(r).LocalStorageKey;if(void 0!==A&&null!==A&&0<A.length)return A}}}catch(h){v.ULS.sendTraceTag(578863816,
3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(u.a)(Db,"ApplicationFeatureHelper",null,[768]);var nb=d(71);class Ta{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(u.a)(Ta,"CloudPolicySettingsCacheData",null,[]);var cb=d(1272),sb=d(607),pb=d(304);class tb{static sVj(){return y.AFrameworkApplication.J.$("SideCarIsEnabled")?tb.Jve&&
tb.V8c?new Promise(b=>{b(!0)}):new Promise((b,h)=>{tb.Jve=pb.a.create(y.AFrameworkApplication.J.jb("SideCarUrl"));sb.a.m_(tb.Jve);tb.Jve.Z1((r,A)=>{(tb.V8c=A.succeeded)?b(A.succeeded):h(A.succeeded)})}):new Promise(b=>{b(!1)})}}tb.V8c=!1;tb.Jve=null;Object(u.a)(tb,"SideCarLoader",null,[]);class wb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(u.a)(wb,"CloudPolicySettingsData",null,[]);class gc{constructor(b,h){this.cMe=0;this.OVd=null;this.O$n=r=>{let A=
null;({av:A}=H.d(r));r=!!A;v.ULS.sendTraceTag(50622687,3004,r?50:10,"ParseCloudPolicySettingsResponse: Success={0}",r);return A};this.Yho=r=>{try{if(void 0!==r&&null!==r&&"CheckIn-Interval"in r){const A=parseInt(r["CheckIn-Interval"]);void 0!==A&&null!==A&&0<A&&(this.cMe=A)}}catch(A){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",A)}};this.GIc=new Fa(b,h);this.Aa=b;h=b.jb("HostAuthType");this.xGb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===
h||null===h)&&"aad"===h.toLowerCase();this.owh=H.b(b.jb("OcpsDefaultSettings")||"{}");this.SKc=this.b7d();h=this.Aa.my("ServicesControlsMicrosoftControllerServicesList")?this.Aa.hD("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Ayd=new Oa.a;for(let r=0;r<h.length;r++)this.Ayd.add(h[r]);this.xGb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.OVd=this.Vqp():this.OVd=this.RIg(this.xGb,this.tVa("/afhs/CloudPolicySettings.ashx"),this.O$n);this.OVd.then(()=>null).catch(r=>{r=Object(Ca.a)(Ea,
r);v.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}cN(b,h=!0,r=!0){if(!this.xGb){const oa=this;return new Promise(Ba=>{Ba(oa.S3c(b))})}const A=this,L=this,Z=this.OVd.then(oa=>{try{let Ba=null;oa.PolicySettings&&"unknown"in oa.PolicySettings&&(Ba=oa.PolicySettings.unknown);if(Ba){if(b in Ba&&void 0!==Ba[b]&&null!==Ba[b])return new Promise(Ab=>{Ab("0"!==Ba[b])});const gb=b.toLowerCase();if(gb in Ba&&void 0!==
Ba[gb]&&null!==Ba[gb])return new Promise(Ab=>{Ab("0"!==Ba[gb])});if(r)return v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default"),new Promise(Ab=>{Ab(A.S3c(b))});v.ULS.sendTraceTag(508395746,3004,50,"Policy"+b+" not found, returning PolicyNotConfigured error");return new Promise((Ab,Jb)=>{Jb("PolicyNotConfigured")})}return new Promise(gb=>{gb(A.S3c(b))})}catch(Ba){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",Ba.message),A.handleError(Ba.toString(),
h,A.S3c(b))}},oa=>L.handleError(oa,h,L.S3c(b)));Z.then(oa=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,oa);return null});return Z}isFeatureEnabled(b,h=!0){if(this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.fkn(b,h);let r=new Promise(L=>{L(!0)}),A="";this.Ayd.contains(b)&&(A="ControllerConnectedServicesEnabled",r=this.cN(A,h));r.then(L=>{v.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,L,A);return null});return r}fkn(b,h=!0){let r=new Promise(L=>{L(!0)}),A="";"mso_sendASmile"===b?A="Enabled":"Survey"===b||"FloodgateSurvey"===b?A="SurveyEnabled":this.Ayd.contains(b)&&(A="ControllerConnectedServicesEnabled");""!==A&&(r=this.cN(A,h));r.then(L=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
b,L,A);return null});return r}handleError(b,h,r){return h?new Promise(A=>{A(r)}):new Promise((A,L)=>{L(b)})}RIg(b,h,r){if(!b)return Promise.resolve(new wb);let A=!1,L=null;xa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Z=this.Jrf("GetCloudPolicySettings");return(new Promise((oa,Ba)=>{if(void 0!==this.SKc&&null!==this.SKc&&0<this.SKc.length){const gb=this.wqp();if(void 0!==gb&&null!==gb){A=!0;oa(gb);return}}this.GIc.NMb(h,r,1,null,this.Yho,["CheckIn-Interval"],
this.Aa.jc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Aa.jc("CloudPolicySettingsRequestSentTimeout",3E4)).then(gb=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Mrp(gb);oa(gb);return gb},gb=>{Ba(gb);return null})})).then(oa=>{({nz:Z,returnValue:L}=this.xAe(Z));var Ba=fb.a.XG();Ba&&Ba.set("FromCache",A.toString());Ba=Object.assign(new Na.a,{durationMs:L,extendedProperties:Ba});xa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ba);return oa})}Vqp(){return tb.sVj().then(()=>
{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}tVa(b){const h=this.Aa.$("SuiteOriginForAFHSIsEnabled")?this.Aa.jb("SuiteOrigin"):this.Aa.jb("WebServiceBase");return String.format("{0}{1}",h,b)}S3c(b){return b in this.owh?"0"!==this.owh[b]:!0}wqp(){try{const b=cb.a.instance.getItem(this.SKc);if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return v.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new wb;r.PolicySettings=h.PolicySettings;r.ControllerConnectedServicesFeatureNames=new nb.a;this.Aa.my("ServicesControlsMicrosoftControllerServicesList")&&this.Aa.hD("ServicesControlsMicrosoftControllerServicesList");for(const A of this.Ayd)r.ControllerConnectedServicesFeatureNames.add(A);v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return r}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}Mrp(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.cMe)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Ta(b,this.cMe),r=JSON.stringify(h);
v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);cb.a.instance.setItem(this.SKc,r);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){v.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}b7d(){const b=Db.b7d(this.Aa);return b&&0<b.length?"OCPS"+b:null}Jrf(b){const h=Wa.a.instance.Oa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
h&&null!==h?h.Xf("WebServiceCall",b):null}xAe(b){if(void 0!==b&&null!==b){const h=b.Ri;b.stop();return{returnValue:h,nz:null}}return{returnValue:null,nz:b}}}Object(u.a)(gc,"CloudPolicySettingsHelper",null,[765]);class vc{constructor(){this.Shi=this.s$j=this.aL=0;this.Thi=this.t$j=this.yMb="";this.E8e=this.z0a=2}clone(){const b=new vc;b.aL=this.aL;b.s$j=this.s$j;b.Shi=this.Shi;b.yMb=this.yMb;b.t$j=this.t$j;b.Thi=this.Thi;b.z0a=this.z0a;b.E8e=this.src;return b}get src(){return this.E8e}serialize(b=
null){const h={};if(!b||b.contains(vc.mWb))h[vc.mWb]=this.aL;if(!b||b.contains(vc.xed))h[vc.xed]=this.yMb;if(!b||b.contains(vc.yed))h[vc.yed]=this.z0a;return JSON.stringify(h)}static create(b,h=null){const r=new vc;r.E8e=b;void 0!==h&&null!==h&&(vc.mWb in h&&(r.aL=h[vc.mWb]),vc.xed in h&&(r.yMb=h[vc.xed]),vc.yed in h&&(r.z0a=h[vc.yed]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return vc.create(h,r);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(r){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",r.toString()),r;}}}vc.mWb="CCS";vc.xed="CCSTime";vc.yed="OfficePrivacyRoamedNoticeShown";Object(u.a)(vc,"UserPrivacySettings",null,[]);var Pc=d(167);class ld{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Aa=b;this.If=h;this.y7e=this.Oe=null}tVa(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Aa.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(y.AFrameworkApplication.rm);return h.toString()}executeRequest(b,h,r,A=null){return this.If.oKb(b,h,A,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Oe||null===this.Oe||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");
else{var A=this.Oe.aL!==b.aL;if(2===this.Oe.src&&A)this.nMo(b),h(!0);else{var L=this.xRo(b);if(void 0===L||null===L||!L.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Oe.src)h(this.m4j(L));else if(0===this.Oe.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",L);const Z=this.executeRequest(this.tVa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
L);Z.continueWith(()=>{if(Z.Zo||Z.Yi)v.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var oa=Z.result;void 0!==oa.args&&null!==oa.args&&void 0!==oa.args.data&&null!==oa.args.data&&oa.args.data.He===ha.a.qz?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(Z){v.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",Z.toString()),h(!1)}})}xRo(b){if(void 0===this.Oe||null===this.Oe||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new nb.a;0===b.src?(this.Oe.aL!==b.aL&&(h.add(vc.mWb),h.add(vc.xed)),this.Oe.z0a!==b.z0a&&h.add(vc.yed)):1===b.src&&this.Oe.aL!==b.aL&&h.add(vc.mWb);return h.count?b.serialize(h):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.y7e){const b=this;this.y7e=new Promise(h=>{try{b.Oe?h(b.Oe.clone()):b.Nqp().then(r=>{b.Oe=r;h(b.Oe.clone());return null},()=>{b.Lqp().then(r=>{b.Oe=r;h(b.Oe.clone());return null},()=>{b.Mqp().then(r=>{b.Oe=r;h(b.Oe.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Oe=new vc;h(b.Oe.clone());return null});return null});return null})}catch(r){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
r.toString()),b.Oe=new vc,h(b.Oe.clone())}})}return this.y7e}Nqp(){return new Promise((b,h)=>{try{const A=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Aa.$("PrivacyDialogShouldCheckRoaming")||A){var r=this.executeRequest(this.tVa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.Zo||r.Yi)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const L=r.result;if(L&&L.args&&L.args.data)if(L.args.data.He!==
ha.a.qz)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",L.args.data.He);else{if(L.args.data.Pe){b(ld.parse(L.args.data.Pe,0));v.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",L.args.data.Pe);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(L){v.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",L.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(A){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
A.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Lqp(){return new Promise((b,h)=>{try{const r=Pc.a.get("WacUPToggleState");let A=null;void 0!==r&&null!==r&&0<r.length&&(A=decodeURIComponent(r));if(void 0!==A&&null!==A&&0<A.length){const L=ld.parse(A,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",L.toString());b(L)}else{const L=vc.create(1),Z=new nb.a;Z.add(vc.mWb);const oa=L.serialize(Z);this.m4j(oa)?(v.ULS.sendTraceTag(51258449,
3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",oa),b(L)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",oa),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Mqp(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");const r=vc.create(2);h?(r.aL=2,y.AFrameworkApplication.Rfi(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.aL=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),
h=vc.create(2),h.aL=1,b(h)}})}nMo(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.aL?y.AFrameworkApplication.Rfi():y.AFrameworkApplication.W_l();v.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}m4j(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Aa.jb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Pc.a.BQj("WacUPToggleState",b,Pc.a.$Xa,h)}catch(h){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Aa.my("ServicesControlsMicrosoftControllerServicesList")?this.Aa.hD("ServicesControlsMicrosoftControllerServicesList"):[],A=new Oa.a;for(let L=0;L<r.length;L++)A.add(r[L]);return A.contains(b)?
2!==h.aL:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),vc.deserialize(b,h)}catch(r){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(u.a)(ld,"UserPrivacySettingsHelper",null,[766]);class Dc{constructor(){this.Z=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}wc(b){this.Z=
b;this.Z.register(765,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().Ud(()=>new gc(y.AFrameworkApplication.J,y.AFrameworkApplication.Fe));this.Z.register(766,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().Ud(()=>new ld(y.AFrameworkApplication.J,y.AFrameworkApplication.Fe));this.Z.register(767,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().Ud(()=>new pa(y.AFrameworkApplication.J,y.AFrameworkApplication.Fe));this.Z.register(768,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().Ud(()=>
new Db(y.AFrameworkApplication.J,y.AFrameworkApplication.Fe,this.Z.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Z.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),y.AFrameworkApplication.va))}init(){y.AFrameworkApplication.J.vp(()=>{const b=this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");y.AFrameworkApplication.J.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{v.ULS.sendTraceTag(42513092,
3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.jb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.jb("IsAnonymousUser"));return null}));this.Z.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");
this.Qjp()})}dispose(){}Qjp(){try{y.AFrameworkApplication.J.$("SideCarIsEnabled")&&tb.sVj().then(b=>{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){E.a.instance.Mc(new Dc)}}Object(u.a)(Dc,"ApplicationFeatureHelperPackage",null,[0,1]);var ic=d(174);class mc{g7d(b,h){let r;const A=[];for(;r=h.exec(b);){const L=r.index;A.push(new ic.a(L,L+r[0].length))}return A}isEndPuncSpecialCase(b){const h=this.g7d(b,
mc.Ibp);for(const r of h)if(r.end===b.length)return!0;return!1}S_c(b){for(const h of mc.z4l){const r=this.g7d(b,h);if(0<r.length&&!r[0].Dc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.g7d(A,mc.Gji);for(h=b.length-1;0<=h;h--){const L=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(L))return A=A.substring(b[h].Dc,A.length),r+b[h].end+this.S_c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.g7d(A,mc.Gji);for(r=0;r<b.length;r++){const L=A.substring(0,
b[r].end);if(!this.isEndPuncSpecialCase(L))return A=A.substring(b[r].Dc,A.length),h+b[r].end+this.S_c(A)}return-1}}mc.$Af="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";mc.aBf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
mc.bBf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";mc.z4l=[new RegExp(mc.$Af,"ig"),new RegExp(mc.aBf,"ig"),new RegExp(mc.bBf,"ig")];mc.XCg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";mc.$Cg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";mc.ZCg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
mc.YCg=mc.$Cg+"|"+mc.ZCg;mc.aDg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";mc.bDg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";mc.cDg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
mc.dDg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";mc.Wwg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
mc.YCg+"|"+mc.aDg+"|"+mc.bDg+")";mc.Vwg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
mc.cDg+")";mc.hbg=mc.XCg+"|"+mc.dDg;mc.WCg=mc.hbg+"|"+mc.Wwg+"|"+mc.Vwg;mc.Gji=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");mc.Ibp=new RegExp(mc.WCg,"g");Object(u.a)(mc,"ProofingSentenceSeparatorScriptSharp",null,[758]);class Rc{bvd(b,h){const r=[];let A;for(;null!=(A=h.exec(b));){const L=A.index;r.push({Dc:L,end:L+A[0].length})}return r}isEndPuncSpecialCase(b){return this.bvd(b,Rc.jjk).some(h=>
h.end==b.length)}S_c(b){for(const h of Rc.Dfk){const r=this.bvd(b,h);if(0<r.length&&0==r[0].Dc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.bvd(A,Rc.ZOg);for(h=b.length-1;0<=h;h--){const L=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(L))return A=A.substring(b[h].Dc,A.length),r+b[h].end+this.S_c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.bvd(A,Rc.ZOg);for(r=0;r<b.length;r++){const L=A.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(L))return A=
A.substring(b[r].Dc,A.length),h+b[r].end+this.S_c(A)}return-1}}Rc.kek="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Rc.ejk="[\u2639\u263a\u263b]";Rc.bQg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Rc.lfk="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Rc.bik="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Rc.iQg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Rc.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Rc.aQg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Rc.$gk="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Rc.Zgk="[\uff21-\uff3a\uff41-\uff5a]";Rc.Xgk="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Rc.Wgk="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Rc.Ygk="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Rc.cHe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Rc.YOg="[\u3002\uff61]";Rc.zvd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Rc.Jfk="[\u00bb\u2019\u201d\u203a\"']";Rc.yHe=Rc.kek+"|"+Rc.ejk;Rc.ahk="[\u2028\u2029\n\r]";Rc.Vgk="("+Rc.zvd+"|"+Rc.bQg+"|"+Rc.iQg+"|"+Rc.aQg+
")";Rc.Ugk="("+Rc.zvd+"|"+Rc.bQg+"|"+Rc.iQg+"|"+Rc.Symbol+"|"+Rc.aQg+"|"+Rc.lfk+"|"+Rc.bik+")";Rc.$Af="("+Rc.cHe+"("+Rc.yHe+"|"+Rc.Jfk+"|"+Rc.zvd+")*"+Rc.ahk+")";Rc.aBf="("+Rc.cHe+"("+Rc.yHe+")*("+Rc.zvd+")+)";Rc.bBf="("+Rc.YOg+"("+Rc.yHe+")*)";Rc.Dfk=[new RegExp(Rc.$Af,"ig"),new RegExp(Rc.aBf,"ig"),new RegExp(Rc.bBf,"ig")];Rc.XCg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Rc.$Cg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Rc.ZCg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Rc.YCg=Rc.$Cg+"|"+Rc.ZCg;Rc.aDg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Rc.bDg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Rc.cDg="(("+Rc.$gk+"|"+Rc.Xgk+"|"+Rc.Ygk+")[.])+|(("+Rc.Wgk+")[.\ufe52\uff0e])+";Rc.dDg="("+Rc.Zgk+")[.\ufe52\uff0e]";Rc.Wwg=Rc.Vgk+"("+Rc.YCg+"|"+Rc.aDg+"|"+Rc.bDg+")";Rc.Vwg=Rc.Ugk+"("+Rc.cDg+")";Rc.hbg=Rc.XCg+"|"+Rc.dDg;Rc.WCg=Rc.hbg+"|"+Rc.Wwg+"|"+Rc.Vwg;Rc.ZOg=new RegExp(Rc.cHe+"|"+Rc.YOg,"ig");Rc.jjk=new RegExp(Rc.WCg,"g");Object(u.a)(Rc,"ProofingSentenceSeparator",null,[758]);class rb{constructor(){this.Z=null}get name(){return"Box4.ProofingGrammarCheck"}wc(b){this.Z=b;y.AFrameworkApplication.J.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new Rc).ha():b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new mc).ha()}init(){this.Z.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){E.a.instance.Mc(new rb)}}Object(u.a)(rb,"Box4GrammarCheckPackage",null,[0,1]);var Cb=d(142),Kb=d(61),$b=d(1869),ab=d(20);class ia{constructor(){this.Z=null}get name(){return"Box4.AtMentions"}wc(b){this.Z=b;this.Z.ia("Box4.AtMentions.IAtMentionsListener",()=>new $b.a(this.Z.resolve("Box4.IEditingDomManager"),
this.Z.resolve("Box4.ICaretPositionManager"),this.Z.resolve("Box4.BackspaceDeleteEventSource"),Object(Kb.a)(),"@",["@","/"])).ha()}init(){y.AFrameworkApplication.J.vp(()=>{this.Z.resolve("Box4.AtMentions.IAtMentionsListener").sdc(ab.StaticActiveAppFrame.za().kb,Cb.KeyInputManager.instance)})}dispose(){this.Z.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){E.a.instance.Mc(new ia)}}Object(u.a)(ia,"Box4AtMentionsPackage",null,[0,1]);class La{get name(){return"Box4.Workers"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new La)}}
Object(u.a)(La,"Box4WorkersPackage",null,[0,1]);var Mb=d(313),Ha=d(95);class zb{constructor(){this.tPa=new Ha.a}v8(b,h){this.tPa.W(b,h)}IFf(b){({value:b}=this.tPa.Ec(b));return b}}Object(u.a)(zb,"AggregationMethodsForActivityName",null,[]);var ac=d(256);class nc{constructor(){this.KJd=new Mb.a;this.tPa=new Mb.a}v8(b,h,r){this.tPa.tb(b)&&this.tPa.K(b)||this.tPa.W(b,new zb);this.tPa.K(b).v8(h,r)}IFf(b,h){return this.tPa.tb(b)&&this.tPa.K(b)?this.tPa.K(b).IFf(h):null}i4c(b){this.KJd.tb(b)&&this.KJd.K(b)||
this.KJd.W(b,new ac.a);return this.KJd.K(b)}zci(b,h){this.i4c(b).add(h)}}Object(u.a)(nc,"ActivityAggregationInfo",null,[773]);var Gb=d(253),tc=d(987),Qb=d(1003);class Yb extends tc.a{constructor(b,h){super(b);this.Oaf=(this.Cmk=h)?h.ltm():Qb.a.qFf()}get uHa(){return this.Cmk}get activityName(){return this.uHa.name}get startTime(){return this.uHa.startTime}get endTime(){return this.uHa.endTime}end(){}cancel(){}XDf(){}Jxp(){this.Lic.W("AM",this.uHa.mode.toString());this.Lic.W("C",this.uHa.count.toString());
this.Lic.W("DA",this.uHa.eii.toFixed(2));this.Lic.W("DV",this.uHa.bZl.toFixed(2))}ULf(b){return this.uHa.ULf(b)}DMf(){return this.uHa.DMf()}pcc(){for(const b of this.uHa.vHa)b.pcc()}}Object(u.a)(Yb,"AggregatedActivity",tc.a,[]);class fc{constructor(b,h){this.CJe=0;this.SEa=b;this.a1a=h}y4k(b,h){this.CJe=h;for(h=0;h<b.count;h++){const r=b.K(h);this.z4k(r)}}z4k(b){const h=Object(Ca.a)(Yb,b);if(h)if(1===this.CJe)this.x4k(h);else if(2===this.CJe){this.A4k(h);for(const r of this.a1a.i4c(this.SEa)){const A=
h.uHa.vHa.K(0);A.properties.tb(r)&&b.properties.W(r,A.properties.K(r))}}}x4k(b){for(const h of this.a1a.i4c(this.SEa))this.zIj(b,h)}A4k(b){for(const h of b.DMf())this.zIj(b,h)}zIj(b,h){const r=this.a1a.IFf(this.SEa,h);if(r){const A=b.ULf(h);b.properties.W(h,r(A))}}}Object(u.a)(fc,"PropertyAggregationHelper",null,[]);var ib=d(1080);class Jc{constructor(b,h,r,A,L){this.V3b=b;this.a1a=h;this.Ubh=L;this.kJe=A;this.hDk=r}get YLh(){return this.hDk.value}dWc(b){if(Object(Gb.a)(ib.a,b))b.dWc();else if(Object(Gb.a)(Yb,
b)&&this.kJe.$Zh(b.activityName.toString())){b=Object(Ca.a)(Yb,b);b.Jxp();b=b.Obj();var h=[];Array.add(h,b);b=H.c(h);v.ULS.sendTraceTag(6907266,213,50,b)}}GHa(b,h){const r=(new Date).getTime();var A=this.Ubh.list.K(b);const L=({C4k:A}=this.Xgm(A)).returnValue;this.Ubh.list.W(b,new nb.a);h&&(A=this.SCl(A,r,this.V3b.PKi));0<A.count&&(new fc(b,this.a1a)).y4k(A,L)}SCl(b,h,r){const A=new nb.a;for(let L=0;L<b.count;L++){const Z=b.K(L);Z.startTime>h-r?Z.pcc():A.add(Z)}return A}Xgm(b){const h=this.YLh.J0j(b);
b=this.YLh.tlp(b);const r=this.D4k(h,b);return{returnValue:r,C4k:1===r?h:b}}D4k(b,h){return b.count*this.V3b.mej<h.count?1:2}get enabled(){return this.V3b.enabled}pcc(){}}Object(u.a)(Jc,"ActivityAggregationManager",null,[772]);class jd{constructor(b){this.enabled=!1;this.Ecj=500;this.Sdj=2;this.mej=5;this.PKi=3E4;this.a0c(b.appSettings)}a0c(b){this.enabled=Boolean.parse(b[jd.nzf]||"false");this.Ecj=parseInt(b[jd.GLn]||"500");this.Sdj=parseInt(b[jd.kOn]||"2");this.mej=parseInt(b[jd.IOn]||"5");this.PKi=
parseInt(b[jd.rTm]||"30000")}}jd.nzf="ActivityAggregationEnabled";jd.GLn="ActivityAggregationMaxInterval";jd.kOn="ActivityAggregationMinChain";jd.IOn="ActivityAggregationModeFactor";jd.rTm="ActivityAggregationGraceWindow";Object(u.a)(jd,"ActivityAggregationParams",null,[]);class Wc{constructor(b,h){this.a1a=b;this.h8g=h}J0j(b,h=1){if(!b||!b.count)return b;const r=new nb.a;var A=null;for(let L=0;L<b.count;L++){const Z=b.K(L);if(!Z)continue;const oa=Z.activityName;A?A.Xvn(Z)?A.add(Z):(A=A.process(),
r.addRange(A),A=this.h8g(oa,h),A.add(Z)):(A=this.h8g(oa,h),A.add(Z))}A&&(b=A.process(),r.addRange(b));return r}tlp(b){if(!b||!b.count)return b;const h={};var r=null;for(let L=0;L<b.count;L++){const Z=b.K(L);if(Z){if(!r){r=new nb.a;var A=this.a1a.i4c(Z.activityName);for(const oa of A)r.add(oa)}A=this.wHm(Z,r);null!==A&&(A in h&&h[A]||(h[A]=new nb.a),h[A].add(Z))}}b=new nb.a;for(const L of mb.a.CR(h))r=this.J0j(h[L],2),b.addRange(r);return b}wHm(b,h){let r="";for(const A of h)r+=A,r=b.properties.tb(A)&&
void 0!==b.properties.K(A)&&null!==b.properties.K(A)?r+b.properties.K(A):r+"null";return r}}Object(u.a)(Wc,"ActivityAggregationSchemes",null,[771]);class Ad{constructor(b,h,r,A,L){this.qt=this.ki=0;this.V3b=r;this.gDc=A;this.a1a=L;this.name=b;this.GC=h;this.vHa=new nb.a}get mode(){return this.GC}get count(){return this.vHa.count}get startTime(){return this.ki}get endTime(){return this.qt}get eii(){if(!this.count)return 0;let b=0;for(const h of this.vHa)b+=h.endTime-h.startTime;return b/this.count}get bZl(){if(!this.count)return 0;
let b=0;const h=this.eii;for(const r of this.vHa){const A=r.endTime-r.startTime;b+=(A-h)*(A-h)}return b/this.count}add(b){this.count?this.qt=b.endTime>this.endTime?b.endTime:this.endTime:(this.ki=b.startTime,this.qt=b.endTime);this.vHa.add(b)}Xvn(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.V3b.Ecj}process(){if(this.count>=this.V3b.Sdj){const b=new nb.a,h=this.gDc(this);b.add(h);return b}return this.vHa}ULf(b){const h=new nb.a;for(const r of this.vHa)if(r.properties.tb(b)){const A=r.properties.K(b);
h.add(A)}else h.add(null);return h}DMf(){const b=this.a1a.i4c(this.name),h=new ac.a;for(const r of this.zhm())b.contains(r)||h.add(r);return h}zhm(){const b=new ac.a;if(!this.vHa)return b;for(const h of this.vHa)for(const r of h.properties.keys)b.add(r);return b}ltm(){return this.vHa.K(0).uniqueID}}Object(u.a)(Ad,"ActivityCollection",null,[770]);class Yd{constructor(){this.xCb=new Mb.a}get list(){return this.xCb}add(b){const h=b.activityName;if(this.xCb.tb(h)&&this.xCb.K(h)){const r=this.xwm(this.xCb.K(h),
b);this.xCb.K(h).insert(r,b)}else this.xCb.W(h,new nb.a),this.xCb.K(h).add(b)}xwm(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.K(r).startTime)return r+1;return 0}}Object(u.a)(Yd,"CompletedActivitiesHelper",null,[769]);class ke{constructor(){this.Z=null}get name(){return"Common.App.ActivityAggregator"}init(){y.AFrameworkApplication.fG(()=>{this.Z.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}wc(b){this.Z=b;const h=A=>new Yb(()=>b.Oa("Common.App.Activities.IActivityAggregationManager"),
A),r=(A,L)=>new Ad(A,L,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Jc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().Ud(()=>new Jc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.nf("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(jd,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().Ud(()=>new jd(y.AFrameworkApplication.J));b.register(nc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().Ud(()=>new nc);b.register(Wc,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().Ud(()=>new Wc(b.resolve("Common.IActivityAggregationInfo"),
r));b.register(Yd,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().Ud(()=>new Yd)}static main(){E.a.instance.Mc(new ke)}}Object(u.a)(ke,"ActivityAggregatorPackage",null,[0,1]);var bf=d(722),od=d(10),Vf=d(1292);class ah{constructor(b){this.dAh=0;this.YLe=null;this.Uuc=()=>{v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(h=>{h.getChatsContainer(this.gXn)}).catch(h=>{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
h)}),this.chat.getChatsCounter().then(h=>{h.onChatsCountChange(this.qol)}).catch(h=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",h)}),this.chat.getKeyboard().then(h=>{h.onKeyDown(this.jXn)}).catch(h=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",h)}))}catch(h){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",h)}};this.qol=h=>{v.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",h);if(!h)this.eAg.fXn();
else if(1===h&&!this.dAh){const r=document.getElementById(this.YLe?this.YLe:Vf.a.SLb);r?this.eAg.kXn(r,this.qop):v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.dAh=h};this.gXn=h=>{this.YLe=h};this.jXn=h=>{h.ctrlKey&&"f6"===h.key.toLowerCase()&&this.oop(h.shiftKey)};this.qop=()=>{v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(h=>{h.focusConversationInput()}).catch(h=>{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",
h)})}catch(h){v.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",h)}};this.lKk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get eAg(){return this.lKk.value}Xb(){this.isInitialized?this.Uuc():this.owo(this.Uuc)}owo(b){bf.a.instance.ub(od.a.dhp,window.self,()=>{b();return!0})}oop(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.eAg.hXn(b)}}Object(u.a)(ah,"ChatManager",null,[529]);var Bf=d(86);class Of{constructor(){this.sa=new Bf.a;
this.RQk=!1}p2k(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}W1k(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get inp(){return this.RQk}Zxj(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(u.a)(Of,"HeaderEventSource",null,[]);var Qf=d(207),Jg=d(375),jf=d(94);class $i{constructor(b,h,r,A,L){this.FOd=null;this.iXn=()=>{this.FOd&&this.FOd()};this.Zb=b;this.gq=h;this.Xm=r;this.UQk=A;this.ga=L}BAj(b,h,r,A=null){const L=this.Zb.ie(h);L.parent=
r;L.IL=!0;A&&L.J$(A);this.Xm.wHa(h,b,!1);this.UQk.wHa(h,b,!1);h=new Jg.DOMFocusListing(()=>b);h.rn(2);h.rn(1);h.rn(8);h.rn(5);h.rn(3);h.rn(6);this.Zb.Rqa(()=>b,L,h).rP=!0;h=Cb.KeyInputManager.oc(jf.a.pz,0);r=Cb.KeyInputManager.oc(jf.a.pz,4);L.ot(h);L.ot(r)}onFlexPaneOpen(b){this.BAj(b,Vf.a.jrc,Vf.a.cWa);this.Zb.Gg(Vf.a.jrc);this.gq.I$(Vf.a.jrc)}onFlexPaneClose(){this.gq.Dx(Vf.a.jrc);this.Zb.Gg(Vf.a.cWa)}kXn(b,h){this.FOd||(this.FOd=h,this.BAj(b,Vf.a.SLb,Qf.AFrame.UK,this.iXn));this.Zb.Gg(Vf.a.SLb);
this.gq.I$(Vf.a.SLb)}fXn(){this.gq.Dx(Vf.a.SLb);this.Zb.V3d(Qf.AFrame.Do)}hXn(b){this.ga.Ob(b?Za.a.zBf:Za.a.U1d,2)}}Object(u.a)($i,"ReactSharedHeaderFocusManager",null,[525]);var Vd=d(124),eh=d(1053),rd=d(43),Gc=d(87);class Wd{constructor(b){this.Xfj=(h,r,A,L,Z)=>{if(1===A)return 32;h=8;2===A&&(A=this.WGf(Z,"experience","gopremiumribbon"),Z=Ma.a.Raa("2116536"),Z=Ma.a.Jp(Z,"ocid",eh.b(y.AFrameworkApplication.ua.Gb.Mk,y.AFrameworkApplication.ua.Gb.Dma,A)),rd.a.Tm(Z,"_blank",void 0,"NavigateToUpsellPage"),
h=32,this.ga.Ob(Za.a.hFj,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return h};this.launchUpsellExperience=(h,r,A,L,Z)=>{if(1===A)return 32;var oa=8;2===A&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(oa=Wa.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(h=this.WGf(Z,"experience","gopremium"),Z=this.WGf(Z,"dimeCampaignId",null),oa.launchUpsellExperience(h,Z),oa=32):(v.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),
oa=this.Xfj(h,r,A,L,Z)));return oa};this.ga=b}Xb(){this.ga.qa(Za.a.f4d,Gc.a.frame,this.Xfj);this.ga.qa(Za.a.ari,Gc.a.frame,this.launchUpsellExperience);this.ga.qa(Za.a.AFo,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.hFj,Gc.a.frame,Vd.ActionManager.eg)}WGf(b,h,r){b&&b[h]&&(r=Object(Ca.a)(String,b[h]));return r}}Object(u.a)(Wd,"UpsellActor",null,[523]);class Ye{constructor(){this.Z=null}get name(){return"Common.App.Header"}init(){Wa.a.instance.resolve("Common.App.Header.IUpsellActor").Xb();Wa.a.instance.resolve("Common.App.Header.IChatManager").Xb()}dispose(){}wc(b){this.Z=
b;this.Z.register(Of,"Common.App.Header.HeaderEventSource").ha();this.Z.register(Wd,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().Ud(()=>new Wd(y.AFrameworkApplication.va));this.Z.register($i,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().Ud(()=>new $i(y.AFrameworkApplication.ua.tq,y.AFrameworkApplication.ua.Ky,y.AFrameworkApplication.ua.S8,y.AFrameworkApplication.ua.dCe,y.AFrameworkApplication.va));this.Z.register(ah,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().Ud(()=>new ah(this.Z.nf("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){E.a.instance.Mc(new Ye)}}Object(u.a)(Ye,"CommonAppHeaderPackage",null,[0,1]);var yg=d(774);class yf{static fti(b,h){switch(b){case 3:return yf.nSm(h);case 2:return yf.RDm(h);case 1:return yf.Orm(h)}return""}static nSm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static RDm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static Orm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static QX(b,h,r){if(aa.a.Di||aa.a.vI)window.setTimeout(()=>{yf.Lzj(r,yf.r9d())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(yf.QRh(r),b,0,!1)}static btl(b,h,r,A){h&&A&&A();
yf.QX(b,h,r)}static r9d(){return aa.a.Di?1:aa.a.vI?2:aa.a.Aab?3:aa.a.Jl?4:0}static URm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static VRm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get dZf(){return"zh-CN"===window.navigator.language}static Lzj(b,h){1===h?(v.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=yf.fti(b,h),8<aa.a.V9a?rd.a.Tm(b,void 0,void 0,"RedirectToAppStore"):rd.a.Tpb(b)):document.hidden||(yf.dZf?(b=y.AFrameworkApplication.J.appSettings.WildFireUrlChinaStoreAndroid.toString())?(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),rd.a.Tpb(b)):v.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(yf.fti(b,
h),null,null)))}static QRh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Nye(){return(aa.a.Aab||aa.a.Jl)&&aa.a.Nr}static get R5o(){return aa.a.Di||aa.a.vI}static Ati(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static DZi(b){return(b=yf.sxm(b))&&""!==b?Boolean.parse(b):!1}static yzg(b){yf.jWo(b)}static sxm(b){try{return localStorage.getItem(b)}catch(h){return v.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static jWo(b){try{localStorage.setItem(b,"true")}catch(h){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}yf.P1h="ChromeExtensionBarDismiss";Object(u.a)(yf,"WildFireUtilities",null,[]);var re=d(364);class Xe{constructor(){this.TJe=new re.a;this.RJe=new re.a;this.QJe=new re.a;this.Sfl(this.TJe);this.Rfl(this.RJe);this.Qfl(this.QJe);this.qUe=new re.a;
this.pUe=new re.a;this.oUe=new re.a;this.til(this.qUe);this.sil(this.pUe);this.ril(this.oUe);this.rMe=new re.a;this.dgl(this.rMe);this.hKb(this.rMe);this.hKb(this.QJe);this.hKb(this.RJe);this.hKb(this.TJe);this.hKb(this.pUe);this.hKb(this.qUe);this.hKb(this.oUe)}I8d(b,h){switch(b){case 1:return this.dTm(h);case 2:return this.Yhm(h)}return yf.Nye?this.rMe:null}Sfl(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}Rfl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}Qfl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}til(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}dgl(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}sil(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}ril(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}hKb(b){b.add("Corporation","Microsoft Corporation")}dTm(b){switch(b){case 3:return this.qUe;case 2:return this.pUe;case 1:return this.oUe}return null}Yhm(b){switch(b){case 3:return this.TJe;case 2:return this.RJe;case 1:return this.QJe}return null}static get instance(){Xe._instance||
(Xe._instance=new Xe);return Xe._instance}}Xe._instance=null;Object(u.a)(Xe,"WildFireStringFactory",null,[]);class dc{constructor(b,h,r,A,L=null,Z=null){this.S1e=null;this._id=b;this.s3e=h;this.Exk=L;this.wJc=A;this.VOc=Z;this.vgb=null;this.sRc=r;this.kQc=Xe.instance.I8d(h,b)}mEl(){this.vgb=new yg.a(this.title,this.message,null);this.vgb.addButton(this.Jil,Object(D.a)(this,this.NWn,"onButtonOneClick"),"");this.sRc&&this.vgb.jOh(this.Qil,Object(D.a)(this,this.SWn,"onButtonTwoClick"));this.vgb.kka=
Object(D.a)(this,this.iVl,"dismissBar");this.vgb.image=3;this.vgb.id=16;this.vgb.closeable=!0}get title(){return this.kQc.K("Headline")}get message(){return this.kQc.K("CallToAction")}get Jil(){return this.sRc?this.kQc.K("InstallButton"):this.kQc.K("UseAppButton")}get Qil(){return this.sRc?this.kQc.K("OpenAppButton"):""}NWn(){this.sRc?this.ocn():this.dDp()}SWn(){this.sRc&&this.m6n()}get eYh(){return this.vgb}get bua(){this.S1e||(this.S1e=this.Exk());return this.S1e}ocn(){v.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.wJc&&this.VOc&&this.VOc();yf.Lzj(this._id,this.s3e)}m6n(){this.bua&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.wJc&&this.VOc&&this.VOc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(yf.QRh(this._id),this.bua,0,!1))}dDp(){yf.Nye?this.Fil():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),yf.yzg("BizBarClicked"),1!==this.s3e&&2!==this.s3e||yf.btl(this.bua,this.wJc,this._id,this.VOc))}Fil(){this.wJc?
v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");rd.a.Tpb(y.AFrameworkApplication.J.appSettings.WildFireChromeExtensionUrl.toString())}jVl(){this.wJc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");yf.yzg(yf.P1h)}iVl(){yf.Nye?this.jVl():(yf.yzg(yf.Ati(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static wtf(){const b=y.AFrameworkApplication.ua.Gb;
new dc(b.Mk,yf.r9d(),8<aa.a.V9a,1===b.Dma,()=>b.GW,b.gvg());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(u.a)(dc,"WildFireBusinessBar",null,[]);class Ac{get name(){return"Common.App.WildFire"}vdf(b){const h=y.AFrameworkApplication.ua.Gb;let r=!1;b&&(b.mEl(),b.eYh&&(r=h.rya(b.eYh,!0)));return r}sEl(){var b=y.AFrameworkApplication.ua.Gb;b=new dc(b.Mk,yf.r9d(),!1,1===b.Dma);this.vdf(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}wtf(b,h,r,A,L,Z){b=new dc(b,
r,A,h,L,Z);this.vdf(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}NLl(){const b=y.AFrameworkApplication.ua.Gb;var h=y.AFrameworkApplication.J;const r=b.Mk,A=1===b.Dma;if(h.$(yf.URm(r))){var L=yf.r9d(),Z=8<aa.a.V9a;if(2!==r||2!==L||!A){h=h.$(yf.VRm(r));var oa=b.gvg(),Ba=()=>b.GW;h&&!yf.DZi(yf.Ati(r))&&this.wtf(r,A,L,Z,Ba,oa)}}}init(){var b=y.AFrameworkApplication.J;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;yf.Nye&&b&&!yf.DZi(yf.P1h)?this.sEl():
(document.body&&yf.R5o&&this.NLl(),y.AFrameworkApplication.va.qa(Za.a.w2f,Gc.a.frame,Object(D.a)(this,this.w2f,"launchWildFireBusinessBar")))}w2f(b,h,r,A,L){if(1===r)return 32;if(!L)return 8;this.wtf(L.app,L.mode,L.platform,L.useTwoButton,null,null);return 32}dispose(){}wc(){}static main(){E.a.instance.Mc(new Ac)}}Object(u.a)(Ac,"PackageManager",null,[0,1]);class dd{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(dd,"BrowserInfo",null,[]);class fd{constructor(){this.Version=
this.Name=null}}Object(u.a)(fd,"PluginInfo",null,[]);class Fd{static P7(){if(y.AFrameworkApplication.J.$("LogBrowserInfoIsEnabled")){var b=Fd.wem();try{const h=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,h)}catch(h){v.ULS.sendTraceTag(6903564,102,15,h.message)}}else v.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static aGm(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const A=b[r].name,L=b[r].version;
Array.add(h,Object.assign(new fd,{Name:A,Version:L}))}return h}static wem(){const b=new dd,h=new Sys.StringBuilder;Fd.TJ(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);Fd.TJ(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);Fd.TJ(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);Fd.TJ(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);Fd.TJ(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);Fd.TJ(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);Fd.TJ(r=>{b.ScreenWidth=r},()=>window.screen.width,h);Fd.TJ(r=>{b.ScreenHeight=r},()=>window.screen.height,h);Fd.TJ(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);Fd.TJ(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);Fd.TJ(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);Fd.TJ(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);Fd.TJ(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);Fd.TJ(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);Fd.TJ(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);Fd.TJ(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);Fd.TJ(r=>{b.WinOrientation=r},()=>window.self.orientation,h);Fd.TJ(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);Fd.TJ(r=>{b.SupportsTouch=r},()=>aa.a.Eqd,h);Fd.TJ(r=>{b.NavAppName=r},()=>window.navigator.appName,h);Fd.TJ(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);Fd.TJ(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);Fd.TJ(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);Fd.TJ(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);Fd.TJ(r=>{b.NavPlugins=r},Fd.aGm,h);Fd.TJ(r=>{b.CalculatedDevicePixelRatio=r},()=>Fd.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static TJ(b,h,r){try{const A=h();b(A)}catch(A){r.isEmpty()||r.append(" | "),r.append(A.message||
"null")}}}Object(u.a)(Fd,"BrowserInfoLogger",null,[]);class cf{get name(){return"Common.App.BrowserInfoLogger"}wc(){}init(){Fd.P7()}dispose(){}static main(){E.a.instance.Mc(new cf)}}Object(u.a)(cf,"BrowserInfoLoggerPackage",null,[0,1]);class Bg{constructor(){this.sa=new Bf.a}vKb(b){this.sa.addHandler("OnEditHappenedEvent",b)}Jte(b){this.sa.removeHandler("OnEditHappenedEvent",b)}vno(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(u.a)(Bg,"EditNotificationEventSource",null,[]);var me=d(41),mf=d(91);
class ug{constructor(b,h,r,A,L,Z,oa=0){this.pQe=!1;this.oQe=this.tGb=null;this.HJh=!1;this.fnd=()=>{this.pQe&&(this.Cib.CWR(()=>this.Cib.result.sendMessage(K.a.xZl,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.pQe=!1)};this.uFo=()=>{try{this.iCd&&(me.c(Za.a.ryf),this.iCd=!1)}catch(Ba){this.iCd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+Ba)}};this.Jb=h;this.vHd=b;this.Cib=
r;this.Aia=A;this.FJh=L;this.huk=Z;this.aAd=0;this.iCd=!1;try{0<oa&&(this.aAd=oa,3E5>this.aAd&&(this.aAd=3E5),this.Jb&&!this.oQe&&(this.oQe=new mf.a(3,2,this.aAd,this.uFo),this.Jb.$b(this.oQe)))}catch(Ba){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Ba)}}get kFe(){return this.HJh}editHappened(){this.kFe?this.iCd=!0:(this.HJh=!0,xa.Health.instance.addQosPillar("Save"),xa.Health.instance.addQosPillar("ContentCreation"),
me.c(Za.a.ryf));this.pQe=!0;this.FJh&&this.FJh.aMh();this.Aia&&this.Aia.vno();y.AFrameworkApplication.fh&&y.AFrameworkApplication.fh.iKn();this.huk&&!this.tGb&&(this.fnd(null),this.tGb=new mf.a(3,2,this.vHd,this.fnd,113),this.Jb.$b(this.tGb))}}Object(u.a)(ug,"EditNotificationManager",null,[578]);class Bi{constructor(b,h,r,A,L){this.oTe=this.tGb=null;this.i7b=this.gJe=!1;this.IAj=()=>{const Z=document.getElementById(y.AFrameworkApplication.gTc);!this.i7b&&this.Xm&&Z&&(this.Xm.ub(od.a.x3,Z,this.B8f,
null),this.i7b=!0);this.k1e(()=>{this.dispose()})};this.B8f=()=>{this.i7b&&(this.Xm.xc(od.a.x3,document.getElementById(y.AFrameworkApplication.gTc),this.B8f),this.i7b=!1);this.aMh();return!1};this.fnd=()=>{this.gJe&&(this.Cib.CWR(()=>this.Cib.result.sendMessage(K.a.BDp,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.gJe=!1)};this.Jb=h;this.vHd=b;this.Cib=r;this.Xm=A;this.k1e=L;this.IAj(null)}aMh(){this.gJe=!0;this.oTe||(this.oTe=
new mf.a(3,2,this.vHd,this.IAj,112),this.Jb.$b(this.oTe));this.tGb||(this.fnd(null),this.tGb=new mf.a(3,2,this.vHd,this.fnd,111),this.Jb.$b(this.tGb))}dispose(){this.i7b&&(this.Xm.xc(od.a.x3,document.getElementById(y.AFrameworkApplication.gTc),this.B8f),this.i7b=!1)}}Object(u.a)(Bi,"UserActivityHostNotificationManager",null,[577,10]);var Zf=d(204),zf=d(114),xh=d(546);class Vj{constructor(){this.Z=null;this.iz=()=>{Vj.yZl&&0<Vj.uyf&&(this.Z.register(Bg,"Common.App.HostNotification.EditNotificationEventSource").ha(),
this.Z.register(Bi,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().Ud(()=>new Bi(6E4,zf.a.instance,xh.a.sq(this.Z.Ta("Postmessage.IHostPostmessenger")),Zf.a.instance,y.AFrameworkApplication.fG)),this.Z.register(ug,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().Ud(()=>new ug(Vj.uyf,zf.a.instance,xh.a.sq(this.Z.Ta("Postmessage.IHostPostmessenger")),this.Z.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.Z.Oa("Common.Interface.IUserActivityHostNotificationManager"),Vj.zZl,Vj.rZl)),this.Z.resolve("Common.Interface.IEditNotificationManager"),v.ULS.shipAssertTag(38086291,209,0<Vj.uyf,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.vp(this.iz)}wc(b){this.Z=b}dispose(){}static get uyf(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get rZl(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get yZl(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationIsEnabled")}static get zZl(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationPostMessageIsEnabled")}static main(){E.a.instance.Mc(new Vj)}}Object(u.a)(Vj,"CommonHostNotificationPackage",null,
[0,1]);class Ui{constructor(b,h,r){this.CIb=null;this.Xye=()=>{this.CIb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.iih.display()};this.j8o=(A,L,Z,oa,Ba)=>A!==Za.a.Xye?2:1===Z?32:2===Z&&Ba?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Ba),Ba?this.cxb():(this.CIb?(v.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Jb.wf(this.CIb)):(v.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.iih.remove(null)),this.CIb=null),32):8;this.Jb=b;this.ga=h;this.iih=r.create()}cxb(){this.CIb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.CIb=new mf.a(2,1,3E4,this.Xye,67),this.Jb.$b(this.CIb))}xZa(){this.ga.qa(Za.a.Xye,Gc.a.frame,this.j8o)}}Object(u.a)(Ui,"FloatPaneActor",null,[576]);var Bb=d(101),Pb=d(98),zc=d(35),$c=d(74);
class Ae{constructor(b,h,r,A,L){this.RZe=this.wIc=this.sKd=this.b4a=this.gja=this.q1a=this.jLe=this.Jda=this.eNc=this.NKc=this.OKc=this.ZRe=null;this.o0n=()=>{const Z=this.Aa.jc("O365AdPaneShowingDuration",60);this.t9h();this.Jda.style.display="block";this.Jda.style.height=this.gja.height+"px";this.wIc=new mf.a(2,1,1E3*Z,Object(D.a)(this,this.hide,"hide"),67);this.Jb.$b(this.wIc);this.pCj()};this.n0n=()=>{v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.pCj();this.gja=null};this.Umj=()=>{v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.wIc&&this.Jb.wf(this.wIc);this.hide();return!0};this.Jb=h;this.Aa=b;this.$g=r;this.Z=L;this.WEa=A}t9h(){this.Jda=document.createElement("div");this.Jda.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.Jda.style.width=this.gja.width+"px";(this.RZe=this.FCm(this.WEa))?(this.b4a=document.createElement("a"),
this.b4a.setAttribute($c.a.Wh,$c.a.xA),this.$g.ub(od.a.click,this.b4a,this.Umj),this.b4a.href=this.RZe,this.b4a.target="_blank",this.b4a.appendChild(this.gja),this.Jda.appendChild(this.b4a)):this.Jda.appendChild(this.gja);this.q1a=document.createElement("a");this.q1a.setAttribute($c.a.Wh,$c.a.N$);this.q1a.className="StandardButton WACFloatPaneCloseButton";this.q1a.title=CommonUIStrings.l_Close;this.q1a.tabIndex=-1;this.jLe=Pb.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.jLe.setAttribute($c.a.Wh,$c.a.xA);this.q1a.appendChild(this.jLe);this.$g.ub(od.a.click,this.q1a,this.onClose);this.Jda.appendChild(this.q1a);this.eNc.appendChild(this.Jda)}kwm(b){const h=this.Aa.$("O365PromotionHasStarted");switch(b){case 2:return Bb.a.Dea(String.format("adppt{0}.png",h?"sale":""));case 1:return Bb.a.Dea(String.format("adxls{0}.png",h?"sale":""));case 3:return Bb.a.Dea(String.format("addoc{0}.png",h?"sale":""))}return null}FCm(b){const h=this.Aa.jb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.wIc=null;this.Jda&&!this.sKd&&(b?v.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.Jda.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Jda.style.height="0px",this.sKd=new mf.a(2,1,1E3,Object(D.a)(this,
this.remove,"remove"),67),this.Jb.$b(this.sKd))}remove(){this.Jda&&this.eNc&&(this.b4a&&this.$g.xc(od.a.click,this.b4a,this.Umj),this.$g.xc(od.a.click,this.q1a,this.onClose),this.eNc.removeChild(this.Jda),this.Jda=null);this.sKd=null}display(){if(this.ZRe=this.Z.Oa("Common.IFloatPaneContainer"))if(this.eNc=this.ZRe.container){var b=this.kwm(this.WEa);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.gja=document.createElement("img"),this.gja.className="WACFloatPaneImage",
this.OKc=this.o0n,zc.a.addHandler(this.gja,od.a.load,this.OKc),this.NKc=this.n0n,zc.a.addHandler(this.gja,od.a.error,this.NKc),this.gja.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}pCj(){this.OKc&&this.gja&&zc.a.removeHandler(this.gja,
od.a.load,this.OKc);this.OKc=null;this.NKc&&this.gja&&zc.a.removeHandler(this.gja,od.a.error,this.NKc);this.NKc=null}dispose(){this.hide()}}Object(u.a)(Ae,"FloatPane",null,[587]);class Gf{constructor(b,h,r,A,L){this.Jb=h;this.Aa=b;this.$g=r;this.Z=L;this.WEa=A}create(){return new Ae(this.Aa,this.Jb,this.$g,this.WEa,this.Z)}}Object(u.a)(Gf,"FloatPaneFactory",null,[574]);var jg=d(303);class hi{constructor(){this.Z=null}get name(){return"Common.App.FloatPane"}get TXi(){return y.AFrameworkApplication.J.$("O365AdvertisementIsEnabled")&&
y.AFrameworkApplication.J.$("IsShowAdvertisementPaneEnabled")}init(){this.TXi&&(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Z.resolve("Common.App.FloatPane.IFloatPaneActor").cxb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Z.resolve("Common.App.FloatPane.IFloatPaneActor").xZa())}wc(b){this.Z=b;this.TXi&&(this.Z.register(Gf,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ud(()=>new Gf(y.AFrameworkApplication.J,
y.AFrameworkApplication.pc,jg.a.instance,y.AFrameworkApplication.ua.Gb.Mk,this.Z)).ha(),this.Z.register(Ui,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ud(()=>new Ui(y.AFrameworkApplication.pc,y.AFrameworkApplication.va,this.Z.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){E.a.instance.Mc(new hi)}}Object(u.a)(hi,"FloatPanePackage",null,[0,1]);var xj=d(1652);class xg{}Object(u.a)(xg,"LokiTokenResult",null,[]);class fj{constructor(b){this.CHd=
b}vKf(){const b=this.yzm();return b?fj.fab?new Promise((h,r)=>{this.CHd.continueWith(()=>{this.CHd.Zo||this.CHd.Yi?r(Error.create("Error downloading auth library")):this.CHd.result.tV("Loki",b).then(A=>{A=y.AFrameworkApplication.J.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.Bzm():A.IsSuccess&&A.Token?Object.assign(new xg,{isSuccess:!0,token:A.Token,errorMessage:null}):Object.assign(new xg,{isSuccess:!1,token:null,errorMessage:JSON.stringify(A)});h(A);return A})})}):Promise.resolve(Object.assign(new xg,
{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new xg,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",xj.a.oti())}))}Bzm(){const b=y.AFrameworkApplication.J.jb("LokiUserDataSignature")||"";return Object.assign(new xg,{isSuccess:!0,token:b,errorMessage:null})}yzm(){let b=null;const h=xj.a.D4d();2===h?b=y.AFrameworkApplication.J.jb("LokiAADAppId"):1===
h&&(b=y.AFrameworkApplication.J.jb("LokiMSAAppId"));return b}static get fab(){return y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")}}Object(u.a)(fj,"LokiTokenManager",null,[520]);class dg{get name(){return"Common.App.LivePersonaUtils"}init(){Wa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}wc(b){b.register(fj,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().Ud(()=>new fj(xh.a.sq(b.Ta("Common.App.OAuth.IOAuthManager"))))}static main(){E.a.instance.Mc(new dg)}}
Object(u.a)(dg,"LivePersonaUtilsPackage",null,[0,1]);class Nf{constructor(b){this.MJe=b}YWi(b){if(!this.MJe)return!0;b=Ma.a.sJf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.MJe.length;h++)if(b.endsWith(this.MJe[h]))return!0;return!1}}Object(u.a)(Nf,"DomainAllowListManager",null,[]);class pg{constructor(b,h){this.suf=null;this.O$e=b;this.url=h}get BLg(){return Ma.a.fca(this.url)}get nt(){return this.O$e}uHg(){const b={},h=this.nt;b.a=this.BLg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);
b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);
b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.suf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(u.a)(pg,"PerformanceTimingEntry",null,[]);const ye=(b,h)=>{var r,A;const L={};let Z=null;switch(b){case 0:Z="ResourceTiming";b=h.a;null!=b&&(L.Url=b);b=h.b;null!=b&&(L.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(L.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(L.RedirectEnd=
b);b=null==h.e?null:h.e.toString();null!=b&&(L.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(L.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(L.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(L.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(L.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(L.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(L.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(L.ResponseStart=b);b=null==
h.m?null:h.m.toString();null!=b&&(L.ResponseEnd=b);b=h.n;null!=b&&(L.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(L.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(L.EncodedBodySize=b);b=null==h.q?null:h.q.toString();null!=b&&(L.TransferSize=b);h=null!==(A=null===(r=h.r)||void 0===r?void 0:r.toString())&&void 0!==A?A:null;null!=h&&(L.responseStatus=h);break;case 1:Z="PerformanceTiming",r=h.a,null!=r&&(L.Url=r),r=null==h.b?null:h.b.toString(),null!=r&&(L.NavigationStart=r),
r=null==h.c?null:h.c.toString(),null!=r&&(L.UnloadEventStart=r),r=null==h.d?null:h.d.toString(),null!=r&&(L.UnloadEventEnd=r),r=null==h.e?null:h.e.toString(),null!=r&&(L.RedirectStart=r),r=null==h.f?null:h.f.toString(),null!=r&&(L.RedirectEnd=r),r=null==h.g?null:h.g.toString(),null!=r&&(L.FetchStart=r),r=null==h.h?null:h.h.toString(),null!=r&&(L.DomainLookupStart=r),r=null==h.i?null:h.i.toString(),null!=r&&(L.DomainLookupEnd=r),r=null==h.j?null:h.j.toString(),null!=r&&(L.ConnectStart=r),r=null==h.k?
null:h.k.toString(),null!=r&&(L.ConnectEnd=r),r=null==h.l?null:h.l.toString(),null!=r&&(L.SecureConnectionStart=r),r=null==h.m?null:h.m.toString(),null!=r&&(L.RequestStart=r),r=null==h.n?null:h.n.toString(),null!=r&&(L.ResponseStart=r),r=null==h.o?null:h.o.toString(),null!=r&&(L.ResponseEnd=r),r=null==h.p?null:h.p.toString(),null!=r&&(L.DomLoading=r),r=null==h.q?null:h.q.toString(),null!=r&&(L.DomInteractive=r),r=null==h.r?null:h.r.toString(),null!=r&&(L.DomContentLoadedEventStart=r),r=null==h.s?
null:h.s.toString(),null!=r&&(L.DomContentLoadedEventEnd=r),r=null==h.t?null:h.t.toString(),null!=r&&(L.DomComplete=r),r=null==h.u?null:h.u.toString(),null!=r&&(L.LoadEventStart=r),r=null==h.v?null:h.v.toString(),null!=r&&(L.LoadEventEnd=r),h=h.w,null!=h&&(L.CustomText=h)}L.Table=Z;return Sys.Serialization.JavaScriptSerializer.serialize(L)};var qh=d(38),qg=d(169),dl=d(156);class Jk{constructor(b,h=null,r=null){this.og=b;this.ALg=this;this.Lwk=h||(()=>window.location.href);this.WPe=new Nf(r)}run(){if(Jk.tLb(window.performance))try{const L=
this.Lwk();if(Jk.dRk.exec(L)&&this.WPe.YWi(L)){var b=new pg(window.performance.timing,L);dl.a.instance.hqo(b.nt.fetchStart);dl.a.instance.iqo(b.nt.navigationStart);dl.a.instance.o0(qh.a.Fdm,"connectStart","requestStart");dl.a.instance.o0(qh.a.Odm,"requestStart","responseStart");dl.a.instance.o0(qh.a.Rdm,"responseStart","responseEnd");this.ALg.Yab(1,b.uHg());this.og.rf(qh.a.SJa,b.nt.fetchStart);this.og.rf(qh.a.Ldm,b.nt.domainLookupStart);this.og.rf(qh.a.Kdm,b.nt.domainLookupEnd);this.og.rf(qh.a.Hdm,
b.nt.connectStart);this.og.rf(qh.a.Tdm,b.nt.secureConnectionStart);this.og.rf(qh.a.Gdm,b.nt.connectEnd);this.og.rf(qh.a.Pdm,b.nt.requestStart);this.og.rf(qh.a.Kic,b.nt.responseStart);this.og.rf(qh.a.Mdm,b.nt.responseEnd-b.nt.responseStart);this.og.rf(qh.a.Qdm,b.nt.responseStart-b.nt.requestStart);var h=0,r=0,A=0;({transferSize:h,pzf:r,Puf:A}=this.prp(L)).returnValue&&(this.og.rf(qh.a.Vdm,h),this.og.rf(qh.a.Idm,A),this.og.rf(qh.a.Ndm,r));this.og.rf(qh.a.l1c,b.nt.navigationStart)}}catch(L){v.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",L)}}prp(b){let h,r,A;A=r=h=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,pzf:r,Puf:A};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,pzf:r,Puf:A};b=b[0];var L=b.transferSize;void 0!==h&&null!==h&&(h=L);L=b.decodedBodySize;void 0!==L&&null!==L&&(A=L);b=b.encodedBodySize;void 0!==
b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,pzf:r,Puf:A}}Yab(b,h){v.ULS.sendTraceTag(4551815,306,50,ye(b,h))}static get instance(){return Jk._instance||(Jk._instance=new Jk(qg.a.instance,null,y.AFrameworkApplication.J.$("PerfTimingLoggerFilterDomainsIsEnabled")?y.AFrameworkApplication.J.hD("ResourceLoggerDomainAllowList"):null))}static tLb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}Jk._instance=null;Jk.dRk=RegExp("^https?://.*","i");Object(u.a)(Jk,"PerformanceTimingLogger",
null,[521]);class Ni{constructor(b,h){this.suf=null;this.O$e=b;this.behavior=h;this.url=this.nt.name}get BLg(){return 2===this.behavior?this.url:Ma.a.fca(this.url)}get nt(){return this.O$e}uHg(){const b={},h=this.nt;b.a=this.BLg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&
null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);b.o=this.round(Ni.s9a(h,"decodedBodySize"));b.p=this.round(Ni.s9a(h,"encodedBodySize"));b.q=this.round(Ni.s9a(h,"transferSize"));b.n=this.suf;b.r=Ni.s9a(h,"responseStatus")||0;return b}round(b){return Math.round(1E3*b)/1E3}static s9a(b,h){return b[h]}}Object(u.a)(Ni,"ResourceTimingEntry",null,[550]);class Wh{constructor(b,h=null,r=100){this.$8g=
b;this.YMd=h;this.sgb={};this.Opk=r;this.v8g=y.AFrameworkApplication&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)}Ppp(b){var h=b.name.toLowerCase();const r=Ma.a.EQb(h);this.IGj(r,h)&&(r in this.sgb?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.X2i(b),h.encodedsize=Ni.s9a(b,"encodedBodySize"),h.decodedsize=
Ni.s9a(b,"decodedBodySize"),this.sgb[r]=h))}Qpp(b){var h=b.name.toLowerCase();const r=Ma.a.EQb(h);this.eIo(r,h)&&(r in this.sgb?v.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.X2i(b),h.encodedsize=Ni.s9a(b,"encodedBodySize"),h.decodedsize=Ni.s9a(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,
h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.sgb[r]=h))}IGj(b,h){if(this.$8g)return Array.contains(this.$8g,b);if(this.YMd)for(b=Ma.a.nU(h),h=0;h<this.YMd.length;h++)if(this.YMd[h]&&b.endsWith(this.YMd[h]))return!0;return!1}eIo(b,h){return this.IGj(b,h)?b.endsWith(".js")||b.endsWith(".css"):!1}X2i(b){try{const h=Ni.s9a(b,"transferSize");if(void 0!==h&&null!==h)return!h;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return b.responseEnd-b.fetchStart<this.Opk}catch(h){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}Hso(){if(mb.a.Qf(this.sgb))v.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=y.AFrameworkApplication.flightId?y.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new Na.a,{extendedProperties:fb.a.XG()});h.extendedProperties.set("Flights",
H.c(b));this.w$i(h,this.sgb,xa.Health.instance)}}HFf(b){let h=0,r=0,A=0,L=0,Z=0;const oa=this.sgb;for(const Ab in oa){var Ba=Ab,gb=oa[Ab];Ba.endsWith(".js")&&(gb=Object(Ca.a)(Object,gb),gb.responseend<b&&(h+=1,r+=gb.decodedsize,L+=gb.encodedsize,A+=gb.iscached?0:gb.encodedsize,Ba=Ba.toLowerCase(),this.v8g&&(y.AFrameworkApplication.J.jb("Slice1Name").toLowerCase().endsWith(Ba)?Z|=1:Ba.endsWith(".common.js")||Ba.endsWith(".othercommon.js")||Ba.endsWith(".ext.js")?Z|=2:Ba.endsWith("common50.min.js")&&
(Z|=4))))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=A;b.encodedBytes=L;this.v8g&&(b.lazyChunksLoaded=Z);return b}w$i(b,h,r){if(h){var A=0,L=0,Z=0,oa=0,Ba=0,gb=0,Ab=0,Jb=0,Tb=0,jc=0,Hc=0;for(const Gd in h){var hd=h[Gd];try{const de=Object(Ca.a)(Object,hd);if(!de)continue;const qe=de.iscached?Boolean.parse(de.iscached.toString()):!1,oe=de.fetchstart?this.parseFloat(de.fetchstart.toString()):0,ge=(de.responseend?this.parseFloat(de.responseend.toString()):0)-oe,$d=de.encodedsize?this.parseFloat(de.encodedsize.toString()):
0,lf=de.decodedsize?this.parseFloat(de.decodedsize.toString()):0;A+=ge;oa+=$d;Ab+=lf;jc++;qe?(Z+=ge,gb+=$d,Tb+=lf,Hc++):(L+=ge,Ba+=$d,Jb+=lf)}catch(de){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",de.message)}}b.extendedProperties.set("StaticResources",H.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",A.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",L.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",
Z.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",oa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ba.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",gb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ab.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Jb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Tb.toString());
b.extendedProperties.set("TotalNumberOfResourcesDownloaded",jc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Hc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(u.a)(Wh,"AppStaticResourceManager",null,[]);class gh extends Sys.EventArgs{constructor(b){super();this.entries=
b}}Object(u.a)(gh,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class th{constructor(b,h,r=null,A=null,L=100,Z=!1){this.$Xe=!1;this.np=null;this.xFc=0;this.sa=new Bf.a;this.QBb=null;this.A1=!1;this.RHh=0;this.Jb=b;this.Odh=0;this.ALg=this;this.WPe=new Nf(r);this.GM=h;A&&(this.QBb=new Wh(null,A,L));this.$mk=Z}get jXh(){try{return!(void 0===this.GM||null===this.GM)&&!(void 0===this.GM.getEntriesByType||null===this.GM.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
b),!1}}get hOl(){return this.Odh}get isActive(){return this.A1}get lHg(){return this.RHh}YOh(b){this.sa.addHandler(th.oAf,b)}vDj(b){this.sa.removeHandler(th.oAf,b)}wc(b,h){const r=this.lHg!==b;this.RHh=b;this.isActive&&this.Jb&&r&&(this.wf(),this.$b());this.Odh=h}activate(){!this.isActive&&this.jXh&&(this.$b(),this.A1=!0)}deactivate(b){this.isActive&&(this.wf(),b&&this.flush(),this.A1=!1)}flush(){if(this.isActive&&this.jXh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.xFc&&
v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.xFc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.xFc=0);const r=[];for(let A=this.xFc;A<b.length;A++)this.WPe.YWi(b[A].name)&&(this.QBb&&(this.$mk?this.QBb.Qpp(b[A]):this.QBb.Ppp(b[A])),r.push(new Ni(b[A],this.hOl)));h||(this.xFc=b.length);this.sa.raiseEvent(th.oAf,
new gh(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.ALg.Yab(0,r[b].uHg());0<r.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",r.length)}catch(h){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}Yab(b,h){v.ULS.sendTraceTag(4310804,306,50,ye(b,h))}cqo(){this.QBb.Hso()}HFf(b){return this.QBb.HFf(b)}$b(){this.Jb&&0<this.lHg&&(this.np=new mf.a(3,2,1E3*this.lHg,
()=>{this.flush()},5),this.Jb.$b(this.np),this.$Xe=!0)}wf(){this.$Xe&&(this.Jb.wf(this.np),this.np=null,this.$Xe=!1)}}th.oAf="EntriesAvailable";Object(u.a)(th,"ResourceTimingLogger",null,[475,521]);class li{constructor(){this.Z=null}get name(){return"Common.ResourceTiming"}init(){this.Z.resolve("Common.NetworkTiming.IResourceTimingLogger");Jk.instance.run()}dispose(){}wc(b){this.Z=b;let h=null;if(y.AFrameworkApplication.J.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=y.AFrameworkApplication.J.hD("ResourceLoggerDomainAllowList")}catch(Z){v.ULS.sendTraceTag(51652512,
306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=[];r.push(Ma.a.nU(Bb.a.o4).toLowerCase());r.push(Ma.a.nU(Bb.a.Iod).toLowerCase());const A=y.AFrameworkApplication.J.jc("AppStaticResourceMonitorCacheThresholdInMs",100),L=y.AFrameworkApplication.J.$("PPTAggregateResourceTimingV2Enabled");b.register(475,"Common.NetworkTiming.IResourceTimingLogger").ha().Ud(()=>new th(y.AFrameworkApplication.pc,window.performance,h,r,A,L))}static main(){E.a.instance.Mc(new li)}}Object(u.a)(li,
"ResourceTimingPackage",null,[0,1]);var rg=d(272);class jj{constructor(){this.cJe={}}pUk(b){this.cJe[b.id.toString()]=b}sTn(b){const h=this.cJe;for(const r in h)h[r].notify(b,!1);this.cJe={}}hlo(b,h){h&&this.pUk(h);return this.jnj(b,h)}Yyf(b){this.sTn(b)}Tii(b,h){b.notify(h,!0)}}Object(u.a)(jj,"AEventEmitter",null,[517]);var Jl;(function(b){b[b.ubg=0]="notStarted";b[b.waiting=1]="waiting";b[b.Eye=2]="shouldRetry";b[b.complete=3]="complete"})(Jl||(Jl={}));Object(u.b)("EventResultState",Jl);class Af{constructor(){this._state=
0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Jl[this._state],["NewState"]:Jl[b]},"ResultType",this.rFi());this._state=b}}Object(u.a)(Af,"AEventResult",null,[580]);class kl extends Af{constructor(){super();this.h9e=this.xNc=null;this.state=0;this.BVe=this.Umh=!1}get Iga(){return this.xNc}get Aeb(){return this.h9e}get xcn(){return this.Umh}rFi(){return"GetMoreInfo Result"}}Object(u.a)(kl,"GetMoreInfoResult",Af,[579,
580]);var xi=d(1277),Eh=d(1505),Kj=d(1054);class Vi{constructor(b,h,r,A,L,Z,oa,Ba){this.YWb=(gb,Ab,Jb,Tb,jc)=>{jc&&jc.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:jc.SourceControlId,["AppType"]:Kj.a[this.pga]}),rd.a.Tm(jc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.Pgg=(gb,Ab,Jb,Tb,jc)=>{if(jc&&jc.MenuItemId){const Hc=y.AFrameworkApplication.J.$("WacInTabOpenMRUIsEnabledForUiHost"),hd=y.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");
v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Hc,hd);if(Hc&&hd){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:jc.SourceControlId,["AppType"]:Kj.a[this.pga]});gb=jc.MenuItemId.toString();const Gd={};Gd[G.a.Quc]="1";Gd[G.a.documentUrl]=gb;Gd[G.a.reason]=Eh.a.open;v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");y.AFrameworkApplication.nN().execute(de=>{de.sendMessage(K.a.SNb,
Gd)})}else this.YWb(gb,Ab,Jb,Tb,jc)}return 32};this.M_d=()=>{this.z$i();return 32};this.ga=b;this.If=h;this.ii=r;this.WEa=A;this.Jb=L;this.gF=Z;this.cyk=oa;this.tNd=Ba}fuo(){this.Crc.qa(Za.a.YWb,Gc.a.frame,this.YWb);this.Crc.qa(Za.a.Pgg,Gc.a.frame,this.Pgg);y.AFrameworkApplication.Jka?this.z$i():this.Crc.fb(Za.a.M_d,Gc.a.frame,this.M_d,96)}KXa(b,h,r=""){if(h&&h.jH){const A=xi.a[h.status];h=h.jH.getTime();const L=this.Xp()-h;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",
{["Caller"]:b,["RequestStatus"]:A,["ElapsedMs"]:L,["StartTime"]:h,["Notes"]:r})}else v.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}z$i(){var b=y.AFrameworkApplication.J.$("QPGVCI"),h=Ma.a.vL(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var r=Ma.a.vL(document.URL,"wdPreviousSession",b);b=Ma.a.vL(document.URL,"wdPreviousCorrelation",b);var A=y.AFrameworkApplication.J.$("NAOPLP");if(y.AFrameworkApplication.Jka){var L=
y.AFrameworkApplication.Jka.getTime();!h||h>L?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:L,["SessionId"]:r,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:L-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get Crc(){return this.ga.value}get Xdd(){return this.If.value}get jgj(){return this.ii.value}get pga(){return this.WEa.value}get rke(){return this.Jb.value}get Xp(){return this.gF}get gYa(){return this.cyk.value}get N_a(){return this.tNd.value}static get instance(){return Vi._instance||(Vi._instance=Vi.Us())}static Us(){return new Vi(new rg.a(()=>y.AFrameworkApplication.va),new rg.a(()=>y.AFrameworkApplication.Fe),new rg.a(()=>y.AFrameworkApplication.ua),
new rg.a(()=>y.AFrameworkApplication.ua.Gb.Mk),new rg.a(()=>y.AFrameworkApplication.pc),()=>(new Date).getTime(),new rg.a(()=>y.AFrameworkApplication.ua.Gb.gYa),new rg.a(()=>y.AFrameworkApplication.N_a))}}Vi._instance=null;Object(u.a)(Vi,"NewAndOpenCommonHelpers",null,[516]);class Qh{constructor(b,h,r){this.TLd=this.np=null;this.V5e=0;this.GMk=b;this.Jb=h;this.oeh=r}j4k(){this.V5e=this.Dvc+1}ytg(b){this.np&&(this.Jb.wf(this.np),this.np=null);b&&(this.V5e=0)}Kdp(b){const h=this.Elp;0<=h?(this.j4k(),
this.ytg(!1),this.np=new mf.a(4,1,h,b,107),this.Jb.$b(this.np)):(this.ytg(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.oeh}))}get Dvc(){return this.V5e}get Elp(){return this.Dvc>=this.aMj.length?-1:this.aMj[this.Dvc]}get aMj(){if(!this.TLd){const b=(this.GMk.value||"0").split(",");this.TLd=[];for(let h=0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.oeh,["Entry"]:b[h]}):
Array.add(this.TLd,r)}}return this.TLd}}Object(u.a)(Qh,"RetryHelper",null,[]);class Mh extends jj{constructor(b,h){super();this.qGa=b;this.COc=new Qh(h,this.Ddd.rke,"GetMoreInfo");this.pu=new kl}rJn(){this.T6f("Document opened")}IHl(b){return()=>{this.T6f(b,!0)}}jnj(b,h=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.pu.state?(h&&this.Tii(h,this.pu),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.T6f(b);return this.pu}T6f(b,h=!1){this.COc.ytg(!h);1===this.pu.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.COc.Dvc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.COc.Dvc}),this.pu.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Ddd.gYa,y.AFrameworkApplication.rm),this.Ddd.Xdd.x5a(h,1,null,null,[Mh.rzh,Mh.jGh],5,this.sGl(),this.rGl(b)))}sGl(){return b=>
{var h=!1;let r=!1;var A=!1,L;y.AFrameworkApplication.J.$("GetMoreInfoDataFromResponseBody")&&(b.data.Pe?({av:L}=H.d(b.data.Pe)).returnValue?L?(A=!0,this.pu.h9e=L.StorageServiceDisplayName,this.pu.xNc=Mh.O3i(L.PersonalFileStorageUrl)?L.PersonalFileStorageUrl:"",""===this.pu.Iga&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.jb("FileSource")&&(this.pu.xNc=Ma.a.fca(y.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.pu.Iga&&""!==this.pu.Aeb):v.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));A||((L=b.data.wi)?(this.pu.h9e=(L[Mh.jGh]||"").toString(),h=(L[Mh.rzh]||"").toString(),this.pu.xNc=Mh.O3i(h)?h:"",""===this.pu.Iga&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.jb("FileSource")?(this.pu.xNc=Ma.a.fca(y.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.pu.Iga&&""!==this.pu.Aeb):h=""===h&&""!==this.pu.Aeb):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));A=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.COc.Dvc,r,h,A);this.Ddd.KXa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,A);this.qMj(3,h,r)}}rGl(b){return h=>{this.Ddd.KXa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.qMj(2);this.COc.Kdp(this.IHl(b))}}qMj(b,h=!1,r=!1){this.pu.state=b;this.pu.Umh=h;this.pu.BVe=r;this.Yyf(this.pu)}get Ddd(){return this.qGa.value}static get instance(){return Mh._instance||(Mh._instance=Mh.Us())}static Us(){return new Mh(new rg.a(()=>Vi.instance),new rg.a(()=>y.AFrameworkApplication.LAm))}static O3i(b){if(!b)return v.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.xh(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}Mh.rzh="PersonalFileStorageUrl";Mh.jGh="StorageServiceDisplayName";Mh._instance=null;Object(u.a)(Mh,"GetMoreInfoActor",jj,[]);class Ch{constructor(b,h,r,A,L){this.rzk=6E4;this.aQi="inactive";this.SLh="active";this.A1=!0;this.Jb=b;this.ixk=h;this.gF=r;this.mOd=A;this.sa=new Bf.a;L&&this.Bdp();this.nrh=this.HAi()}sMh(b){this.sa.addHandler(this.SLh,b)}yYk(b){this.sa.addHandler(this.aQi,b)}Bdp(){const b=new mf.a(5,2,this.rzk,Object(D.a)(this,this.u5m,
"inactiveLoop"),108);this.v5m.$b(b)}u5m(){const b=this.HAi(),h=this.Xp()-b;h>this.wCe&&this.A1&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.A1=!1,this.sa.raiseEvent(this.aQi));b-this.nrh>this.wCe&&(this.A1=!0,this.sa.raiseEvent(this.SLh));this.nrh=b}get v5m(){return this.Jb.value}get HAi(){return this.ixk}get Xp(){return this.gF}get wCe(){return this.mOd.value}static get instance(){return Ch._instance||(Ch._instance=Ch.Us())}static Us(){return new Ch(new rg.a(()=>
zf.a.instance),()=>y.AFrameworkApplication.j2f.getTime(),()=>(new Date).getTime(),new rg.a(()=>y.AFrameworkApplication.wCe),!0)}}Ch._instance=null;Object(u.a)(Ch,"InactivityManager",null,[]);var Al=d(1705);class Rj extends Af{constructor(){super();this.jFk=this.mvh=this.lvh=null;this.state=this.SHh=0;this.BVe=!1}get a9f(){return this.lvh}get ffj(){return this.mvh}get Klp(){return this.SHh}rFi(){return"MruActor Result"}}Object(u.a)(Rj,"MruResult",Af,[581,580]);class qk{constructor(b,h,r){this.task=
null;this.hbe=b;this.maxRetries=h;this.Zi=r;this.retryCount=this.e8c=0;this.b4e=this.Gad=null}$pn(b,h){return b===ha.a.Bic||20===h||18===h||3===h}wrn(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get sqe(){return this.b4e}reset(){this.e8c=this.retryCount=0;this.b4e=this.Gad=null;this.task&&(this.Zi.wf(this.task),this.task=null)}a$m(b,h,r,A){this.b4e=String.format("{0}_{1}",r,A);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,
202,50,"Max retries exceeded"),!1;if(this.$pn(r,A))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.wrn(A)&&1<=this.e8c)return this.Gad=r,!1;h=Math.max(h,this.hbe*Math.pow(2,this.e8c));if(26===A)h=Math.max(h,3E4);else if(27===A||28===A)h=Math.max(h,6E4);9===A||412===r&&(null==this.Gad||412!==this.Gad)?h=500:this.e8c+=1;this.Gad=r;this.retryCount+=1;this.task&&this.Zi.wf(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
h);this.task=new mf.a(2,1,h,b,107);this.Zi.$b(this.task);return!0}}Object(u.a)(qk,"RetryManager",null,[]);var eg=d(151);class qf{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(u.a)(qf,"WriteOptions",null,[]);var kg=d(633);class Wi extends jj{constructor(b,h,r,A,L,Z,oa){super();this.tLp=Ba=>{this.ULi(Ba.data)};this.TLl=Ba=>{if(Ba.data.He===ha.a.Gfc)this.ULi(Ba.data);else{var gb=Ba.data.He===ha.a.l8,Ab=fb.a.XG();this.dMi(this.Klb,
Ba,this.BLl(),Ab);Ab&&(Ab.set("StatusCode",Ba.data.He.toString()),gb||this.Gdf(Ba.data,Ab));xa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ba.data.He),gb,!1,Object.assign(new Na.a,{extendedProperties:Ab}))}};this.XAm=Ba=>{this.UBi(Ba)};this.WAm=Ba=>{this.UBi(Ba,!0)};this.TAm=Ba=>{this.TBi(Ba)};this.RAm=Ba=>{this.TBi(Ba,!0)};this.qGa=b;this.$Dk=h;this.pkb=new qk(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),
y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.xP.rke);this.Klb=new qk(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.xP.rke);this.oKk=r;this.QKh=A;this.eTk={};this.xpa=new Rj;this.Hwk=L;this.eHd="";this.dO=Z;this.ogh=oa;this.kKd="";this.tKk=y.AFrameworkApplication.J.jc("WordRecentLinksCount",
25)}get AGe(){return this.eTk}Wxo(){this.xP.Crc.qa(Za.a.aEj,Gc.a.frame,Object(D.a)(this,this.YCo,"renameMruEntry"))}YCo(){return this.UNg("Rename")}FJn(){this.Qbj("File Opened")}GJn(){this.Qbj("IntervalUpdate")}Qbj(b){v.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.UNg(b)}jla(b){(b=F.a.jla(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}z4d(){switch(this.xP.pga){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}YQm(b){var h=this.Hwk();if(!h)return null;const r=new qf;r.documentUrl=this.ogh.value?encodeURI(h):h;r.mruItemId=this.eHd;r.app=this.z4d();if(h=this.dO())r.folderName=h.breadcrumbFolderName,h=h.zA,r.documentName=F.a.qL(h),r.documentExt=this.jla(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(r)}UNg(b,h=!1){if(4===this.xP.pga&&!y.AFrameworkApplication.J_d)return 2;var r=fb.a.XG();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.eHd?"true":"false"),r.set("URLEncoded",this.ogh.value?"true":"false"));xa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.YQm(r);if(!b)return h=!y.AFrameworkApplication.$2b,r&&(r.set("WebEditingIsEnabled",y.AFrameworkApplication.$2b?"true":"false"),r.set("ProtectedFile",y.AFrameworkApplication.dV?
"true":"false")),xa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new Na.a,{extendedProperties:r})),2;this.Klb&&!h&&this.Klb.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.xP.gYa,this.S4f);this.QKh?this.AGe["X-FileId"]=y.AFrameworkApplication.rm:r+=String.format("&{0}",y.AFrameworkApplication.rm);y.AFrameworkApplication.sessionStartInfoSettings&&(this.AGe["X-Office-AudienceGroup"]=Object(Ca.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.AGe["X-Timeout"]=15E3;return this.xP.Xdd.Xj(r,2,b,this.AGe,!0,5,this.tLp,this.TLl,null,void 0,void 0,void 0,void 0,"4")}ULi(b){const h=fb.a.XG();this.Klb&&(h&&this.Klb.sqe&&(h.set("LastError",this.Klb.sqe),h.set("NumRetries",this.Klb.retryCount.toString())),this.Klb.reset());const r=Al.c(b.Pe);r&&r.diagnostics_data&&(this.eHd=r.diagnostics_data.mru_id);b=+b.IO-+b.jH;h&&h.set("RequestDuration",b.toString());xa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Na.a,{extendedProperties:h}))}BLl(){return()=>
{this.UNg("Retry",!0)}}VAm(){this.Dcd("Polling")}UAm(){this.Dcd("Retry",!0)}uJn(){this.Dcd("Open")}tJn(){this.Dcd("Activity")}sJn(){this.Dcd("ActivityRecentLinks",!1,!0)}Dcd(b,h=!1,r=!1){v.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const A=fb.a.XG();A&&(A.set("Trigger",b),A.set("IsRetry",h?"true":"false"),r&&A.set("RecentLinks","true"));xa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",A);this.pkb&&!h&&this.pkb.reset();r?this.a$h(this.WAm,this.RAm,!0):this.a$h(this.XAm,
this.TAm)}Gdf(b,h){b&&b.wi&&(b=b.wi["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}$En(b,h){b&&(h&&h.set("RequestDuration",(+b.IO-+b.jH).toString()),xa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Na.a,{extendedProperties:h})))}UBi(b,h=!1){var r="";let A=null,L=null,Z=null;const oa=Al.c(b.data.Pe);oa&&(A=oa.places?oa.places.items:[],L=oa.documents?oa.documents.items:[],(Z=Al.a(oa,h))&&(r=H.c(Z)));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.gXa&&eg.c()&&(h?this.kKd=
r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=fb.a.XG();this.pkb&&(r&&this.pkb.sqe&&(r.set("LastError",this.pkb.sqe),r.set("NumRetries",this.pkb.retryCount.toString())),this.pkb.reset());h&&r&&r.set("RecentLinks","true");Z||A||L?(h?this.xP.KXa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.xP.KXa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.EEe(3,Z,A,L),this.$En(b.data,r)):(h?this.xP.KXa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Failure: Invalid JSON"):this.xP.KXa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.Gdf(b.data,r),xa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Na.a,{extendedProperties:r})),this.EEe(3,null,null,null,!0));this.Yyf(this.xpa)}dMi(b,h,r,A){let L=0,Z=0;const oa=Al.c(h.data.Pe);oa&&(null!=oa.response_code&&(L=oa.response_code,A&&A.set("MruResponseCode",L.toString()),9===L&&(this.eHd="")),oa.error_data&&null!=oa.error_data.retry_after_ms&&
(Z=oa.error_data.retry_after_ms,A&&A.set("ExpectedRetryAfter",Z.toString())));b&&(h=b.a$m(r,Z,h.data.He,L),A&&(A.set("CurrentRetryCount",b.retryCount.toString()),A.set("RetryScheduled",h?"true":"false")))}TBi(b,h=!1){const r=b.data.He===ha.a.l8,A=fb.a.XG();A&&(A.set("StatusCode",b.data.He.toString()),h&&A.set("RecentLinks","true"),r||this.Gdf(b.data,A));h?this.xP.KXa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.xP.KXa("MruActor.GetMruFromServerFailureCallback",b.data,
"Failure");this.EEe(2);this.dMi(this.pkb,b,Object(D.a)(this,this.UAm,"getMruFromServerRetryTask"),A);xa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.He),r,!1,Object.assign(new Na.a,{extendedProperties:A}));this.Yyf(this.xpa);y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.gXa&&eg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.kKd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}EEe(b,h=null,
r=null,A=null,L=!1){if(3!==this.xpa.state||3===b)this.xpa.lvh=h,this.xpa.mvh=r,this.xpa.jFk=A,this.xpa.state=b,this.xpa.BVe=L,this.xpa.SHh=this.xP.Xp()}jnj(b,h){v.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.xpa.state});h&&3===this.xpa.state&&this.Tii(h,this.xpa);return this.xpa}a$h(b,h,r=!1){this.EEe(1);let A;const L={};A=r?String.format(this.xP.gYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.tKk,"OfficeSuite",this.S4f,
"ClassicMru"):String.format(this.xP.gYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.z4d(),this.S4f);this.oKk.value||(A+="&entity=docs");y.AFrameworkApplication.sessionStartInfoSettings&&(L["X-Office-AudienceGroup"]=Object(Ca.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");r&&(L["X-Office-Application"]="147");this.QKh?L["X-FileId"]=y.AFrameworkApplication.rm:A+=String.format("&{0}",y.AFrameworkApplication.rm);this.xP.Xdd.Xj(A,1,null,L,!0,5,b,
h,null)}get xP(){return this.qGa.value}get S4f(){return this.$Dk.value}static get instance(){return Wi._instance||(Wi._instance=Wi.Us())}static Us(){return new Wi(new rg.a(()=>Vi.instance),new rg.a(()=>kg.a.Eg(y.AFrameworkApplication.lcid).name),new rg.a(()=>y.AFrameworkApplication.ua.Gb.kH),y.AFrameworkApplication.J.$("MruWriteFileIdInHeader"),()=>y.AFrameworkApplication.ua.Gb.GW,()=>y.AFrameworkApplication.Et,new rg.a(()=>y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled")))}}Wi._instance=null;
Object(u.a)(Wi,"MruActor",jj,[]);class ql{constructor(){this.lRc=this.OAh=this.Z=null;this.ji=!1;this.OQl=()=>{zf.a.instance.wf(this.hfj)};this.fNh=()=>{zf.a.instance.$b(this.hfj)}}get name(){return"Common.App.NewAndOpen.Core"}wc(b){this.Z=b;b.register(516,"Common.INewAndOpenCommonHelpers").ha().Ud(()=>Vi.instance);b.register(517,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().Ud(()=>Mh.instance);b.register(517,"Common.IEventEmitter<Common.IMruResult>").ha().Ud(()=>Wi.instance)}init(){y.AFrameworkApplication.J.vp(()=>
{this.g$a()})}g$a(){this.Z.resolve("Common.INewAndOpenCommonHelpers");this.Z.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Z.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Vi.instance.fuo();y.AFrameworkApplication.eMa&&(b=!0);y.AFrameworkApplication.Pog&&(Wi.instance.uJn(),0<y.AFrameworkApplication.gfj&&this.fNh(),this.x1o(),b=!0);y.AFrameworkApplication.N_a&&b&&Mh.instance.rJn();y.AFrameworkApplication.uzp&&(b=Wi.instance,b.Wxo(),b.FJn(),zf.a.instance.$b(this.vzp))}x1o(){Ch.instance.sMh(Object(D.a)(Wi.instance,
Wi.instance.tJn,"makeGetMruRequestActivityTrigger"));Ch.instance.sMh(this.fNh);Ch.instance.yYk(this.OQl)}get hfj(){return this.OAh||(this.OAh=new mf.a(5,2,y.AFrameworkApplication.gfj,Object(D.a)(Wi.instance,Wi.instance.VAm,"getMruFromServerTask"),109))}get vzp(){return this.lRc||(this.lRc=new mf.a(2,2,6E4*y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(D.a)(Wi.instance,Wi.instance.GJn,"makeUpdateMruTask"),197))}dispose(){this.ji||
(this.ji=!0,this.lRc&&(zf.a.instance.wf(this.lRc),this.lRc=null))}}Object(u.a)(ql,"CorePackageManager",null,[0,1,10]);var hg=d(1497),Km=d(150);class zg{static l0l(b){return zg.UXh("New",b)}static m0l(b){return zg.UXh("Open",b)}static zXh(b,h){return zg.d6a("LoadingMenuSection",zg.OCn,b,zg.mUc("lblLoading",h))}static nUc(b,h,r=null,A=null){return zg.d6a("MessageMenuSection",zg.efj,h,zg.mUc("lblMessage",b,r,A))}static ihl(b){return zg.zXh(b,CommonUIStrings.l_VoicedLoadingText)}static jhl(b,h){return zg.nUc(CommonUIStrings.l_NewCreationLocationMessage,
b.labelText,h.Iga,h.Aeb)}static hhl(b,h){return zg.nUc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.Aeb,"\n\n"),b.labelText)}static DXh(b){return zg.nUc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static fhl(b,h,r){return zg.d6a("menuNewBlank",zg.H_m,r?b.labelText:null,zg.iUc(b.KNi,b.LNi,b.MNi,null,b.W9a,b.J6c,h,"blank"))}static ail(){return zg.mUc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static SXh(){return zg.mUc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static bil(b,
h){return zg.d6a("menuNewTemplates",b,null,h)}static dhl(b,h){return zg.d6a("menuNewMoreTemplates",zg.aqi,null,zg.iUc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static Xfl(b,h,r){let A="";r&&h&&(A=zg.d6a("BrowseMoreMenuSection",zg.aqi,null,zg.iUc("btnBrowseMore",h,h,null,null,null,b||"1959943459",r)));return A}static mUc(b,h,r=null,A=null){let L=A;h&&0<h.length&&(L=zg.tgj.Awb(h).trimEnd(),L=0<=L.indexOf("{0}")?String.format(L,
A):String.format("{0} {1}",L,A));r=r&&A?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.yf(r),F.a.yf(A),F.a.yf(L)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',F.a.yf(b||""),zg.tgj.Awb(F.a.yf(h||"")),r)}static iUc(b,h,r,A,L,Z,oa,Ba){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
F.a.yf(b||""),F.a.yf(h||""),F.a.yf(r||""),A||"32by32",F.a.yf(L||""),F.a.yf(Z||""),oa,F.a.yf(Ba||""))}static UXh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static d6a(b,h,r,A){r=r?String.format('Title="{0}"',F.a.yf(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
F.a.yf(b||""),F.a.yf(h||""),r,A)}}zg.efj="MenuMru";zg.OCn="MenuLoading";zg.H_m="MenuHeader";zg.aqi="MenuFooter";zg.tgj=Km.a.jE("\n","&#10;");Object(u.a)(zg,"NewAndOpenXmlUtilities",null,[]);class Kd{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(u.a)(Kd,"HostInformation",null,[]);class Cg{constructor(b,h,r,A,L,Z){this.EQc=this.nx=this.hxd=null;this.zMd=this.b8e=!1;this.Duh=0;this.rXe=!1;this.Upe=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;2!==gb||this.rXe||(this.Duh=
(new Date).getTime(),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Jye,["CachedNewMenuXmlExists"]:!!this.hxd,["ShouldCallGetMoreInfo"]:this.$R.N_a}));return this.geo(Jb)};this.qGa=b;this.sHc=h;this.u2a=new rg.a(()=>new hg.a(r.value,Object(D.a)(this,this.sQb,"getMoreInfoEventReceived")));this.hFk=A;this.Djb=L;this.NNk=Z;this.FPc=this.Jye;this.aFd=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("GateTemplateRenderingByGetMoreInfoResponse");
this.xCk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",!1);this.Bqh=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",!1);this.TBk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("PPTOPremiumTemplateEnabled")}get j6(){switch(this.$R.pga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}Xb(){const b=this.$R.Crc;b.qa(Za.a.tke,Gc.a.frame,Object(D.a)(this,this.tke,"newDocument"));b.qa(Za.a.Upe,Gc.a.frame,this.Upe)}tke(b,h,r,A,L){if(1===r)return 32;if(2===r&&L){if(y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&L.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),y.AFrameworkApplication.va.Ob(Za.a.Ffo,2);if(L.MenuItemId&&L.SourceControlId)return"NewDocumentHome"===L.SourceControlId&&
me.a("NewDocumentFromHomeTab"),this.FXc(L.MenuItemId,L.SourceControlId)}return 8}FXc(b,h){var r=this.xke.L$h;if(null===r)return 8;var A=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const L=y.AFrameworkApplication.aub;"blank"===b&&this.qon()&&(v.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.j6),b="blankNew");if(L&&A){v.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const Z={};Z[G.a.template]=b;Z[G.a.j6]=this.j6;Z[G.a.lcid]=y.AFrameworkApplication.lcid.toString();Z[G.a.reason]=Eh.a.Lsf;Z[G.a.uiCulture]=y.AFrameworkApplication.uiCulture;Z[G.a.dataCulture]=y.AFrameworkApplication.dataCulture;y.AFrameworkApplication.nN().execute(oa=>{oa.sendMessage(K.a.FXc,Z)})}else A=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,F.a.$i(this.eMa),F.a.$i(b),F.a.$i(this.j6),F.a.$i(y.AFrameworkApplication.lcid.toString()),
F.a.$i(A.toString()),F.a.$i(h),F.a.$i(y.AFrameworkApplication.RM),y.AFrameworkApplication.rm),(r=y.AFrameworkApplication.J.jb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+F.a.$i(r)),h+="&"+y.AFrameworkApplication.z8d(),y.AFrameworkApplication.ZWa&&(h+="&"+y.AFrameworkApplication.d7d()),(r=this.nx?this.nx.Iga:null)?h+="&DestinationUrl="+F.a.$i(r):3===this.$R.pga&&this.$R.N_a&&v.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),rd.a.Tm(h,
"_blank",void 0,"CreateNewDocument");2!==this.$R.pga&&3!==this.$R.pga||v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Kj.a[this.$R.pga],["Template"]:b});y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.$R.pga&&("blank"===b||"blankNew"===b?me.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new da.a,{name:"TemplateId",string:b})],me.b("ConsumerTemplateNew",null,0,!0,
0,b)));return 32}qon(){let b=!1;switch(this.$R.pga){case 3:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return b}uHn(b){let h=Number.MAX_VALUE,r=Number.MIN_VALUE;const A=window.performance;if(A&&"undefined"!==typeof A.getEntriesByName){for(let Z=
0;Z<b.length;Z++){var L=A.getEntriesByName(b[Z]);L&&0<L.length&&(L=L[0],h=Math.min(parseInt(String(L.fetchStart)),h),r=Math.max(parseInt(String(L.responseEnd)),r))}r>h&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}geo(b){b&&(this.hxd?b.PopulationXML=this.hxd:(this.$R.N_a&&!this.nx&&this.GRn.FR("Opened New menu",!0),b.PopulationXML=this.Nfm(this.dIi())));return 32}U0i(){return!this.$R.N_a||!!this.nx&&
3===this.nx.state&&!!this.nx.Aeb&&!!this.nx.Iga}o_f(){return y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.gXa&&!this.aFd?!0:this.U0i()}dIi(){if(!this.Jye&&!this.aFd&&!this.o_f())return null;if(this.FPc&&!this.zMd){let h=!1;var b="9";const r=y.AFrameworkApplication.J.appSettings;"NumberOfTemplatesInBackstage"in r&&(b=r.NumberOfTemplatesInBackstage);let A=this.j6;"TemplateCollectionId"in r&&(A=r.TemplateCollectionId);this.xCk&&(A="WordConsumerWAC",b="10");this.Bqh&&(A="WordConsumerWAC",
b="10",h=!0);this.TBk&&"PowerPointWAC"===A&&(h=!0);b=String.format(this.$R.gYa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.$i(y.AFrameworkApplication.lcid.toString()),F.a.$i(A),b);Boolean.parse(r.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(r.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in r&&(b+="&templateTier="+r.TemplateTier);this.Bqh&&(b+="&col=officetemplateswordonlinestartexp2");b=h?b+"&p=1":b+"&p=0";b+="&"+y.AFrameworkApplication.z8d();
y.AFrameworkApplication.ZWa&&(b+="&"+y.AFrameworkApplication.d7d());this.$R.Xdd.Xj(b,1,null,null,!1,2,L=>{this.$R.KXa("CreateNewActor.GetTemplateListJson",L.data);this.Pjp(L.data.Pe)},L=>{this.$R.KXa("CreateNewActor.GetTemplateListJson",L.data);this.Ojp()},null,void 0,void 0,void 0,void 0,"5");this.FPc=!1}return this.EQc}Pjp(b){this.EQc=b;this.FPc=!1;this.Ojd();this.aFd?this.o_f()?this.Zwf():this.nx&&(v.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.Ywf()):this.Zwf()}Zwf(){if(y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Gb.gXa&&eg.c()){const b=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=y.AFrameworkApplication.aub;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.EQc,!0,b&&h));3===this.$R.pga&&v.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}Ojp(){this.zMd=this.FPc=!0;this.Ojd();this.Ywf();xa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Ywf(){y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Gb.gXa&&eg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.$R.pga&&v.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}ZNf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const A=b.length?b[h]:null;b=A?A.Url||"":"";var L;let Z=r=h=!1;if(A&&(L=A.AspectRatio))L=parseFloat(L),1>L?h=!0:1.5<L?r=!0:1===L&&(Z=!0);else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",
{["Url"]:b}),this.$R.pga){case 3:h=!0;break;case 2:r=!0;break;case 5:Z=!0}return{returnValue:b,$4m:h?"95by123":r?"123by69":Z?"100by100":"123by95"}}Nfm(b){b=({mye:h}=this.ghl(b,this.xke,this.xke.qUc||"1056925771")).returnValue;if(h){this.hxd=b;var h=(new Date).getTime()-this.Duh;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}sQb(b,h){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.nx||3!==b.state?
2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.b8e=!0,this.Ojd()):(this.nx=b,h||this.Ojd(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.gXa&&eg.c()&&eg.d("setFileMenuHostInformation")&&(b=Object.assign(new Kd,{hostUrl:this.nx.Iga,hostName:this.nx.Aeb,folderUrl:y.AFrameworkApplication.breadcrumbFolderUrl,folderName:y.AFrameworkApplication.breadcrumbFolderName}),v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),
appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.aFd&&this.EQc&&this.EQc.length&&(this.o_f()?this.Zwf():this.Ywf(),v.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}ghl(b,h,r){let A;A=!1;const L=this.U0i();let Z="";this.$R.N_a&&(this.b8e?(Z=zg.DXh(h),this.b8e=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.nx?L?Z=zg.jhl(h,this.nx):this.nx.xcn?(A=!0,this.FPc=!1,Z=zg.hhl(h,this.nx),
v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(A=!0,Z=zg.DXh(h),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.nx.Iga,["StorageServiceDisplayNameIsSet"]:!!this.nx.Aeb})):(Z=zg.ihl(h.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));L&&(Z+=zg.fhl(h,r,!Z)+({mye:A}=this.$hl(b,r)).returnValue);return{returnValue:zg.l0l(Z),
mye:A}}$hl(b,h){let r;r=!1;if(!this.Jye)return r=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",mye:r};let A="",L="",Z="MenuTemplate";if(this.zMd)A=zg.SXh(),this.zMd=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const oa=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);A=this.Zhl(oa,h);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");y.AFrameworkApplication.ugj&&
"OneDrive"===this.eMa&&(L=zg.dhl(this.HRn,y.AFrameworkApplication.ugj))}catch(oa){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),A=zg.SXh()}r=!0}else Z="MenuLoading",A=zg.ail(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:zg.bil(Z,A)+L,mye:r}}Zhl(b,h){let r="";const A=[];for(let Z=0;Z<b.length;Z++){var L=b[Z];let oa="";if(L){const Ba=L.Title,gb=L.AssetId;L=L.Thumbnails;gb&&
Ba&&L&&({$4m:L,returnValue:oa}=this.ZNf(L),r+=zg.iUc("jbtnNewTemplate"+Z,Ba,null,L,null,oa,h,gb))}A[Z]=oa}b=new mf.a(4,1,5E3,()=>{this.uHn(A)},106);this.$R.rke.$b(b);return r}Ojd(){this.rXe=!0;this.$R.jgj.VOa(this.xke.$0c);this.rXe=!1}get $R(){return this.qGa.value}get xke(){return this.sHc.value}get GRn(){return this.u2a.value}get HRn(){return this.hFk.value}get eMa(){return this.Djb.value}get Jye(){return this.NNk.value}}Object(u.a)(Cg,"CreateNewActor",null,[]);class wl{constructor(){this._initialized=
!1;this.k9e={}}iD(b){this.Eki();return this.get(b)}contains(b){this.Eki();return b.toString()in this.k9e}Eki(){this._initialized||(this.c_k(),this._initialized=!0)}Wlb(b,h){this.k9e[b.toString()]=h}get(b){return this.k9e[b.toString()]}}Object(u.a)(wl,"AIntlHelper",null,[]);class Kl extends wl{constructor(){super()}c_k(){this.Wlb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Wlb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Wlb(2,CommonUIStrings.l_Open);this.Wlb(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.Wlb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Wlb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Kl._instance||(Kl._instance=new Kl)}static X6n(b){return Kl.instance.iD(b)}}Kl._instance=null;Object(u.a)(Kl,"MruActorIntlHelper",wl,[]);var ae;(function(b){b[b.success=0]="success";b[b.Gj=1]="failure";b[b.J0b=2]="spinner";b[b.none=3]="none"})(ae||(ae={}));Object(u.b)("DisplayState",ae);class pd{constructor(b,h,r,A,L,Z,oa,Ba){this.uLe=null;this.Vbf=!0;this.gxd="";this.MQk=
0;this.H8b=null;this.UYe=3;this.kkg=(gb,Ab,Jb,Tb,jc)=>1!==Jb&&jc?this.eeo(jc):32;this.Aa=Ba;this.qGa=b;this.Vxa=h;this.zvk=r;this.spk=A;this.rpk=L;this.u2a=new rg.a(()=>new hg.a(Z.value,null));this.lxk=new rg.a(()=>new hg.a(oa.value,Object(D.a)(this,this.aQn,"mruEventResultReceived")));this.Aa.$("WacInTabOpenMRUIsEnabledForUiHost");this.Aa.$("UiHostSupportsDocRebootFeatures")}aQn(b,h){this.H8b=b;h||this.cAj()}Wwo(){this.xP.Crc.fb(Za.a.kkg,Gc.a.frame,this.kkg,96)}eeo(b){this.$0l();this.Z0l();b.PopulationXML=
zg.m0l(this.gxd+this.uLe);return 32}$0l(){var b=3;let h=!1;if(this.gxd&&this.MQk===this.H8b.Klp)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.UYe;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.xP.Xp();this.H8b=this.$Pn.FR("File Open opened",!0);this.gxd&&2!==this.UYe&&3!==this.H8b.state?h=!0:(b=this.JKm(this.H8b),y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Gb.gXa&&eg.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.gxd=({yRn:b}=this.Pfm(this.H8b)).returnValue);r=this.xP.Xp()-r;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:ae[b]},1!==b&&(r.IsStale=h),v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",r));this.UYe=b}JKm(b){let h;try{h=H.c(b.a9f)}catch(r){h=null,v.ULS.sendTraceTag(0,
202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",r)}return h}Z0l(){this.Vbf?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.uLe=({JGp:this.Vbf}=this.oJn()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Vbf,["NotDisplayingLink"]:!this.uLe})}Pfm(b){let h;1===b.state||
0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=zg.zXh(this.C9a(2),this.C9a(5))):3===b.state&&b.a9f?(h=this.ehl(b.a9f),b=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=zg.nUc(this.C9a(1),this.C9a(2)),b=1);return{returnValue:h,yRn:b}}ehl(b){let h;const r=this.ldd.qUc||"2155708348";if(b.length){h=zg.mUc("lblRecentDocuments",this.C9a(3));let A=0;for(let L=0;L<b.length;L++){const Z=b[L];"FileName"in
Z&&"DocumentUrl"in Z&&"Path"in Z&&(h+=zg.iUc("MruButton"+L,Z.FileName.toString(),Z.Path.toString(),null,this.ldd.W9a,this.ldd.J6c,r,Z.DocumentUrl.toString()),Z.IsPinned&&A++)}h=zg.d6a("RecentDocumentsMenuSection",zg.efj,this.C9a(2),h);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:A})}else h=zg.nUc(this.C9a(0),this.C9a(2)),v.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}oJn(){let b;
b=!0;let h=this.ofl;var r=this.nfl;if(h&&r||!this.xP.N_a)b=!1;else{const A=this.h7d.FR("File Open",!1);3===A.state&&(h=A.Iga,r=A.Aeb,b=!1)}r=r?String.format(this.C9a(4),r):null;return{returnValue:zg.Xfl(this.ldd.qUc,r,h),JGp:b}}cAj(){this.xP.jgj.VOa(this.ldd.$0c)}get xP(){return this.qGa.value}get C9a(){return this.Vxa.value}get ldd(){return this.zvk.value}get ofl(){return this.spk.value}get nfl(){return this.rpk.value}get h7d(){return this.u2a.value}get $Pn(){return this.lxk.value}}Object(u.a)(pd,
"MruRenderer",null,[]);var el=d(1506);class Yg{constructor(b,h,r,A,L,Z,oa){this.nx=null;this.mDh=!1;this.Lwa=this.Z4=0;this.sQb=Ba=>{if(!this.nx&&3===Ba.state)this.nx=Ba;else if(2===Ba.state){this.mDh?v.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.h7d.FR("NewDocumentFromStream",!0),this.mDh=!0);return}this.Osf()};this.BRn=Ba=>{if(Ba&&Ba.data&&Ba.data.Pe)if(({av:gb}=H.d(Ba.data.Pe)).returnValue)if(Ba=gb,Ba.StatusCode!==ha.a.qz&&Ba.StatusCode!==ha.a.Gfc)v.ULS.sendTraceTag(24904475,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.j6,this.Lwa,Ba.StatusCode),this.j9b(null);else if(Ba.NewDocumentUrl&&""!==Ba.NewDocumentUrl){var gb=(new Date).getTime()-this.Z4;v.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.j6,this.Lwa,gb);this.yFk(Ba.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.j6,this.Lwa),this.j9b(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.j6,this.Lwa,{["ResponseData"]:el.a.csd(Ba.data.Pe)}),this.j9b(null);else v.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.j6,this.Lwa),this.j9b(null)};this.ARn=Ba=>{Ba&&Ba.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.j6,this.Lwa,Ba.data.status);this.j9b(null)};this.yFk=b;this.j9b=h;this.iHd=r;this.sHc=A;this.Djb=L;this.qGa=Z;this.u2a=new rg.a(()=>new hg.a(oa.value,this.sQb))}FXc(){!this.nx&&this.Dag.N_a?this.h7d.FR("NewDocumentFromStream",!0):this.Osf()}Osf(){this.Z4=(new Date).getTime();var b=this.s7l.L$h;if(null===b)this.j9b(null);else{var h=this.iHd.menuItemId,r=this.iHd.ZNa,A=this.iHd.mfp,L=this.iHd.A7l;this.Lwa="streamBase64"===A?L.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",
this.j6,this.Lwa);var Z=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,F.a.$i(this.eMa),F.a.$i(h),F.a.$i(this.j6),F.a.$i(y.AFrameworkApplication.lcid.toString()),F.a.$i(Z.toString()),F.a.$i(r),F.a.$i(y.AFrameworkApplication.RM),y.AFrameworkApplication.rm,F.a.$i(A));b+="&"+y.AFrameworkApplication.z8d();y.AFrameworkApplication.ZWa&&(b+="&"+y.AFrameworkApplication.d7d());(h=this.nx?this.nx.Iga:null)&&(b+=
"&DestinationUrl="+F.a.$i(h));this.Dag.Xdd.Xj(b,2,L,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.BRn,this.ARn,null,void 0,void 0,void 0,void 0,"31")}}get j6(){switch(this.Dag.pga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get s7l(){return this.sHc.value}get eMa(){return this.Djb.value}get Dag(){return this.qGa.value}get h7d(){return this.u2a.value}}Object(u.a)(Yg,"NewDocumentFromStreamOperation",null,[]);class rh{constructor(b,
h,r,A){this.sHc=b;this.Djb=h;this.qGa=r;this.kxk=A}create(b,h,r){return new Yg(b,h,r,this.sHc,this.Djb,this.qGa,this.kxk)}}Object(u.a)(rh,"NewDocumentFromStreamOperationFactory",null,[549]);var Mf=d(138);class mi{get name(){return"Common.App.NewAndOpen.UX"}wc(b){b.register(rh,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().Ud(()=>new rh(new rg.a(()=>y.AFrameworkApplication.ua.Gb.GIf()),new rg.a(()=>y.AFrameworkApplication.eMa),
new rg.a(()=>b.Oa("Common.INewAndOpenCommonHelpers")),new rg.a(()=>b.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){y.AFrameworkApplication.J.vp(()=>{this.g$a()})}g$a(){const b=xh.a.sq(Wa.a.instance.Ta("Common.INewAndOpenCommonHelpers")),h=xh.a.sq(Wa.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));y.AFrameworkApplication.eMa&&Mf.Task.WAA.call(null,b,h).continueWith(()=>{const r=new Cg(new rg.a(()=>b.result),new rg.a(()=>y.AFrameworkApplication.ua.Gb.GIf()),new rg.a(()=>
h.result),new rg.a(()=>y.AFrameworkApplication.ua.Gb.HIf().qUc||"1959943459"),new rg.a(()=>y.AFrameworkApplication.eMa),new rg.a(()=>y.AFrameworkApplication.ron));r.Xb();r.Ojd()});if(y.AFrameworkApplication.Pog){const r=xh.a.sq(Wa.a.instance.Ta("Common.IEventEmitter<Common.IMruResult>"));Mf.Task.WAA.call(null,b,h,r).continueWith(()=>{const A=new pd(new rg.a(()=>b.result),new rg.a(()=>Kl.X6n),new rg.a(()=>y.AFrameworkApplication.ua.Gb.HIf()),new rg.a(()=>y.AFrameworkApplication.W6n),new rg.a(()=>y.AFrameworkApplication.V6n),
new rg.a(()=>h.result),new rg.a(()=>r.result),y.AFrameworkApplication.J);A.Wwo();A.cAj()})}}dispose(){}}Object(u.a)(mi,"UXPackageManager",null,[0,1,10]);var Ag=d(175);class Hf extends Ag.StandardDialog{constructor(){super();this.Bd=0;this.Ke(1,CommonUIStrings.l_DialogClose)}iR(b){this.Iy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}hxf(b){this.Iy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(Hf,"ErrorDialog",
Ag.StandardDialog,[585]);var Pg=d(342);class bk{Ysi(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Pg.a;b.gg("api.onedrive.com");return b.task}}Object(u.a)(bk,"OneDriveConsumerEndpointHelper",null,[474]);var Sj=d(40);class gj{constructor(b,h,r,A){this.EGb=this.pMa=null;this.x7e=this.z7e=!1;this.v9b=null;this.Aa=b;this.c4b=h;this.MFb=r;this.qJ=A}get zRh(){return this.c4b}get J(){return this.Aa}kkc(){this.v9b||(this.v9b=this.Usc?pb.a.create(this.Usc,null,null,null,!1):
null);return this.v9b}setup(b){this.EGb=b;this.z7e||this.x7e?this.z7e&&this.EGb&&this.EGb(!0):(b=this.kkc())?(this.x7e=!0,b.Uab.continueWith(h=>{this.c1n(h)}),sb.a.m_(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.EGb(!1))}Geg(b){v.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.wk?b.wk.toString():"No error detail.")}c1n(b){this.x7e=!1;if(b.Yi)this.Geg(b),this.EGb(!1);else try{this.z7e=!0,v.ULS.sendTraceTag(17909022,
352,50,"Initializing OneDrive API"),this.$Tf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.EGb(!0)}catch(h){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.EGb(!1)}}fqd(b){this.pMa=b;this.MFb?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(D.a)(this,this.Icg,"onApiReady")))}Icg(b){b?this.Nge():
this.qq()}qq(){this.qJ().iR(Sj.a.X5n)}zE(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.pMa&&this.pMa(!0,b)}dispose(){this.v9b&&this.v9b.dispose()}}Object(u.a)(gj,"AOneDriveFilePickerApiManager",null,[588,10]);class Yi extends gj{constructor(b,h,r,A,L,Z){super(h,r,A,Z);this.Ah=null;this.Qxa=b;this.VNk=L}get Usc(){return this.J.jb("OneDriveApiUrl")}start(b,h){this.Ah=b;this.fqd(h)}$Tf(){WL.init(1===this.zRh||2===this.zRh?{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId}:
{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}fqd(b){this.pMa=b;!this.MFb&&this.Qxa.r8c?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(D.a)(this,this.Icg,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.VNk())}Nge(){try{v.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Ah).then(Object(D.a)(this,this.zE,"onSuccess"),Object(D.a)(this,
this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.qq()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,b.error.message)}else v.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.pMa&&this.pMa(!1,
b);this.qq()}}Object(u.a)(Yi,"OneDriveFilePickerApiManagerV5",gj,[]);class Bl extends gj{constructor(b,h,r,A,L){super(b,h,r,A);this.ECd=this.Cxh=null;this.GCe=()=>{this.ECd.style.visibility="hidden"===this.ECd.style.visibility?"":"hidden"};this.Euk=L;this.options={};this.options.clientId=this.J.jb("OneDriveApiV7ClientId");this.options.cancel=this.GCe}get Usc(){return this.J.jb("OneDriveApiV72Url")}start(b,h){this.ECd=h;const r=this.Euk.Ysi();r.continueWith(()=>{v.ULS.sendTraceTag(24134241,352,50,
"Fetch endpoint task completed, attempting to start OneDrive picker");this.Cxh=r.result;this.fqd((A,L)=>{this.GCe();b(A,L)})},3);r.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,r.wk.message);this.GCe()},5)}$Tf(){this.options.success=b=>{const h={};h.data=b;this.zE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Cxh;this.options.advanced.iframeParentDiv=this.ECd}Nge(){try{v.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.GCe(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.qq()}}onFailure(b){this.pMa&&this.pMa(!1,b);this.qq()}}Object(u.a)(Bl,"OneDriveFilePickerApiManagerV7",gj,[]);class Ll extends gj{constructor(b,h,r,A){super(b,h,r,A);this.Mnk=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.J.jb("OneDriveApiV72ClientId");
this.options.advanced.trapFocus=!0}get Usc(){return this.J.jb("OneDriveApiV72Url")}start(b,h,r,A){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=A;this.options.cancel=h;this.Mnk.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.fqd(b)}fqd(b){this.pMa=b;this.MFb?v.ULS.sendTraceTag(24391838,
216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(D.a)(this,this.Icg,"onApiReady")))}$Tf(){this.options.success=b=>{const h={};h.data=b;this.zE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}Nge(){try{v.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
b.message,b.stack),this.qq()}}Geg(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.wk?b.wk.toString():"No error detail.");sb.a.SAo(this.Usc);this.v9b=null}qq(){this.qJ().hxf(Sj.a.GLo)}onFailure(b){this.pMa&&this.pMa(!1,b)}}Object(u.a)(Ll,"OneDriveFilePickerApiManagerV72",gj,[]);class fn{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(u.a)(fn,"IExtraData",null,[]);class Yn extends Ll{constructor(b,h,r,A){super(b,h,r,A);this.options.advanced.filter=
b.jb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=y.AFrameworkApplication.KRh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.jb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new fn(y.AFrameworkApplication.userSessionId))}get Usc(){return this.J.jb("OneDriveApiV72Url")}Nge(){try{v.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",
this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",y.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.qq()}}}Object(u.a)(Yn,"OneDriveFilePickerApiOpenManagerV72",Ll,[]);class Tl{constructor(b){this.Mq=null;this.KAm=h=>{if(h.data.He===ha.a.l8&&"X-NewKey"in h.data.wi){v.ULS.sendTraceTag(24134236,
352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const r={};r["X-Key"]=h.data.wi["X-NewKey"];this.uwg(r)}else 0<this.T5e?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.T5e),this.T5e--,this.uwg()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Mq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
this.MAm=h=>{"PersonalFileStorageUrl"in h.data.wi&&""!==h.data.wi.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Mq.gg(h.data.wi.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Mq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};this.If=b;this.T5e=3}Ysi(){this.Mq=new Pg.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");
this.uwg();return this.Mq.task}uwg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",y.AFrameworkApplication.fNb);this.If.x5a(h,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,this.MAm,this.KAm,void 0,void 0,void 0,void 0,"21")}}Object(u.a)(Tl,"OneDriveForBusinessEndpointHelper",null,[474]);var jm=d(772);class Kk{constructor(){this.Z=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}wc(b){this.Z=b;this.Z.register(Yi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().Ud(()=>
new Yi(jm.a.instance,y.AFrameworkApplication.J,y.AFrameworkApplication.R6,y.AFrameworkApplication.Bta,y.AFrameworkApplication.nCg,()=>new Hf));y.AFrameworkApplication.qab?this.Z.register(474,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new bk):this.Z.register(474,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new Tl(y.AFrameworkApplication.Fe));this.Z.register(Bl,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Ud(()=>
new Bl(y.AFrameworkApplication.J,y.AFrameworkApplication.R6,y.AFrameworkApplication.Bta,()=>new Hf,this.Z.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.Z.register(Ll,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().Ud(()=>new Ll(y.AFrameworkApplication.J,y.AFrameworkApplication.R6,y.AFrameworkApplication.Bta,()=>new Hf));this.Z.register(Yn,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Ud(()=>new Yn(y.AFrameworkApplication.J,
y.AFrameworkApplication.R6,y.AFrameworkApplication.Bta,()=>new Hf))}static main(){E.a.instance.Mc(new Kk)}}Object(u.a)(Kk,"PackageManager",null,[0,1]);class gn{constructor(b,h,r,A,L,Z){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=A;this.WasServiceDown=L;this.AffinitizedUrl=Z}}Object(u.a)(gn,"SafeLinksData",null,
[]);class io{constructor(b,h){this.JBe=b;this.nz=h}}Object(u.a)(io,"SafeLinksGetUrlReputationRequestData",null,[]);class rl{constructor(b,h,r,A){this.XZn=L=>{let Z="OnGetUrlReputationSuccessCallback: ",oa=10;const Ba=L.data.state;try{const gb=H.b(L.data.Pe).reputationResults[0],Ab=gb.navigateUrl.length,Jb=Ba.JBe.length,Tb=gb.navigateUrl===Ba.JBe;gb.navigateUrl&&0<gb.navigateUrl.length&&(Ba.JBe=gb.navigateUrl);Z+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",
L.data.He,gb.verdict,Jb.toString(),Ab.toString(),Tb.toString());oa=50}catch(gb){Z+=String.format("Exception {0}",gb.message)}this.MLi(Ba,Z,oa)};this.WZn=L=>{let Z="OnGetUrlReputationFailureCallback: ";const oa=L.data.state;try{Z+=String.format("HttpStatus {0}",L.data.He)}catch(Ba){Z+=String.format("Exception {0}",Ba.message)}this.MLi(oa,Z,10)};this.Aa=b;this.If=h;this.Fxk=r;rl.ee=A}uAc(b,h,r){try{var A=null;rl.ee&&(A=rl.ee.Xf("WebServiceCall","SafeLinksGetUrlReputation"));const L=new io(h,A);A={};
A.AffinitizedUrl=b;A.TargetUrl=h;A.PolicyCookie=r;const Z=H.c(A);this.If.Xj(this.Fxk,2,Z,null,!1,2,this.XZn,this.WZn,L,void 0,void 0,3E3,3E3,"36");return!0}catch(L){v.ULS.sendTraceTag(588788033,378,10,L.message)}return!1}MLi(b,h,r){b.nz&&(b.nz.stop(),b.nz=null);v.ULS.sendTraceTag(588788034,378,r,h);rd.a.Tm(b.JBe,void 0,"noopener,noreferrer","SafeLinksNav")}}rl.ee=null;Object(u.a)(rl,"SafeLinksNavigationHelper",null,[]);var vm;(function(b){b[b.E_p=0]="enabledByPolicy";b[b.UUl=1]="disabledByPolicy";
b[b.sZp=2]="disabled_GetPolicyFailure";b[b.tZp=3]="disabled_PendingGetPolicyRequest"})(vm||(vm={}));Object(u.b)("SafeLinksNavigationState",vm);class Lj{constructor(b,h,r,A=!1,L=null,Z=null){this.oEb=this.nEb=0;this.n9c=this.ZBd=!1;this.Yjb=null;this.o8b=!0;this.ULd=null;this.DJm=gb=>{let Ab=ha.a.TSn,Jb="";try{this.ZBd=this.n9c=!1;var Tb=gb.data.state;const $d=({nz:Tb}=this.xAe(Tb)).returnValue,lf=Object.assign(new Na.a,{durationMs:$d});xa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",
lf);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",gb.data.He,gb.data.Pe.length,$d);if(gb.data.He!==ha.a.qz)Jb="Unexpected httpStatus: "+gb.data.He.toString();else{Tb=null;try{Tb=H.b(gb.data.Pe)}catch(wf){Jb="Exception:"+wf.toString()+" deserializing response";return}if(Tb){var jc=Tb.IsSafeLinksEnabled;if(void 0===jc||null===jc||0>=jc.length)Jb="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,
50,"Retrieved isSafeLinksEnabledString {0}",jc);var Hc=Lj.Gig(jc);if(void 0===Tb.WebAffinitizedUrl||null===Tb.WebAffinitizedUrl||0>=Tb.WebAffinitizedUrl.length)Jb="Invalid WebAffinitizedUrl";else if(void 0===Tb.PolicyCookie||null===Tb.PolicyCookie||0>=Tb.PolicyCookie.length)Jb="Invalid PolicyCookie";else if(void 0===Tb.PolicyCookieTTL||null===Tb.PolicyCookieTTL)Jb="Invalid PolicyCookieTTL";else{var hd=Tb.WebAffinitizedUrl,Gd=Tb.PolicyCookie,de=Tb.AffinitizedUrl,qe=new Date;qe.setMinutes(qe.getMinutes()+
(5<Tb.PolicyCookieTTL?Tb.PolicyCookieTTL-5:0));var oe=qe.getTime(),ge=new gn(jc,hd,Gd,oe,!1,de);this.GMj(ge);Ab=gb.data.He;this.Yjb&&(Hc?(this.a4j(this.Yjb),this.oEb=this.nEb=0):(v.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),rd.a.Tpb(this.Yjb)),this.Yjb=null)}}}else Jb="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch($d){Jb=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+$d.toString()}finally{Ab!==ha.a.qz&&this.LLi(Ab,Jb)}};this.CJm=gb=>{this.ZBd=!1;let Ab=500,Jb="";try{let Tb=gb.data.state;const jc=({nz:Tb}=this.xAe(Tb)).returnValue,Hc=Object.assign(new Na.a,{durationMs:jc});Ab=gb.data.He;xa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+Ab.toString(),!1,!0,Hc);Jb="Request Failed, Status="+xi.a[gb.data.status]+" Duration: "+jc}catch(Tb){Jb="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
Tb.toString()}finally{this.LLi(Ab,Jb)}};v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Aa=b;this.If=h;this.vPa=r;Lj.ee=Z;this.MSk=A?this.Aa.jb("SafeLinksHandlerWebServiceBase"):this.Aa.jb("WebServiceBase");this.iSk=this.Aa.jb("SafeLinksHashedUserId");this.hLp=this.Aa.jb("SafeLinksWorkloadIdHeaderValue");this.wGd=this.Aa.jc("SafeLinksMaxGetPolicyBootRetries",2);this.xGd=this.Aa.jc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.iEd=this.Orn();this.hEd=this.Nrn();Lj.LJh=
this.Aa.jb("UserPrincipalName")||"";Lj.FQc=this.Aa.jb("TenantId")||"";v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.iEd,this.hEd);if(this.iEd&&this.hEd){h=(b=this.yqb())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.VZf();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var oa=!b||"unknown"===h||b.WasServiceDown||r,Ba=fb.a.XG();Ba&&(Ba.set("shouldGetSafeLinksDataFromServer",
oa.toString()),Ba.set("isSafeLinksEnabledCacheValue",h.toString()));L?(this.o8b=!1,L.execute(gb=>{gb.isFeatureEnabled("MsoUrlreputation",!0).then(Ab=>{this.o8b=Ab;Ba.set("isUserLicensedForSafeLinks",this.o8b.toString());xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ba);this.o8b&&oa&&this.s8d(!0);return null})})):(xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ba),oa&&this.s8d(!0))}}get appName(){return this.vPa}get YFe(){return this.MSk}get userId(){return this.iSk}get mJi(){try{if(""===
Lj.WSe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=y.AFrameworkApplication.buildVersion;b.OS=this.Aa.jb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);Lj.WSe=window.self.btoa(h)}}catch(b){v.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return Lj.WSe}get cGm(){const b=this.YFe?this.YFe+"/":"",h=new qb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ae("app",this.appName);this.Aa.$("SafeLinksUseDebugHeader")&&h.Ae("action","debug");
this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ae("s2satpop","1");this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Ae("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.rm)}get AQm(){const b=this.YFe?this.YFe+"/":"",h=new qb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ae("app",this.appName);this.Aa.$("SafeLinksUseDebugHeader")&&h.Ae("action","debug");this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&h.Ae("s2satpop","1");this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Ae("s2saat","1");this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Ae("s2se03","1");this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.Ae("sladpar",this.mJi);h.Ae("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.rm)}get eRn(){Lj.y6e||(Lj.y6e=new rl(this.Aa,
this.If,this.AQm,Lj.ee));return Lj.y6e}uAc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.Mln(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.iEd,this.hEd,this.o8b);if(!(h&&this.iEd&&this.hEd&&this.o8b))return!1;h=0;const r=({state:h}=this.w6o()).returnValue;v.ULS.sendTraceTag(595079385,378,
50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",vm[h]);const A=fb.a.XG();A&&A.set("SafeLinksNavigationState",vm[h]);xa.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",A);if(!r)return 2!==h&&3!==h||xa.Health.instance.recordKpiFailure("SafeLinksNavigations",vm[h],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.U6o())return this.VZf()?!1:this.eRn.uAc(this.Wgm(),b,this.eEi());if(!this.VZf())return this.a4j(b),
!0;this.Yjb=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.n9c=!1;this.s8d();return!0}Mln(b){b=b.toLowerCase();const h=this.Aa.hD("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}s8d(b=!1){var h=fb.a.XG();h&&h.set("isOnBootRequest",b.toString());xa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);xa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",
0,"jpittsdirects",h);h=this.Jrf("SafeLinksGetPolicy");this.If.Xj(this.cGm,1,null,null,!0,2,this.DJm,this.CJm,h,void 0,void 0,void 0,void 0,"23");this.n9c=b;this.ZBd=!0;b?this.nEb++:this.oEb++}LLi(b,h=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.nEb<this.wGd&&this.oEb<this.xGd)this.s8d(this.n9c);else{this.n9c=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.nEb,this.oEb,b,h);h=null;const r=fb.a.XG();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new Na.a,{extendedProperties:r}));xa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const A=new gn("false","","",0,!0,"");this.GMj(A);this.Yjb&&(v.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),rd.a.Tpb(this.Yjb),this.Yjb=null)}}catch(r){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}a4j(b){const h=this.eEi(),r=this.ORm(),A={};A.Url=b;A.SafeLinksCookie=h;A.CorrelationId=eb.a.create().toString();A.WorkloadId=this.hLp;A.UserAgentInfo=aa.a.cE+"|"+this.appName;this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(A.User=Lj.LJh,A.TenantId=Lj.FQc,A.AdditionalProperties=this.mJi);v.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",A.CorrelationId);rd.a.zkg(rd.a.Vva(4),r,A)}Orn(){const b=this.Aa.jb("IsSafeLinksEnabledForUser");return b?Lj.Gig(b):!1}Nrn(){const b=this.Aa.hD("SafeLinksDisabledBrowsers");if(aa.a.y7){if(this.Aa.my("SafeLinksForTeamsIsEnabled")&&this.Aa.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,aa.a.cE))return!1;return"officecomhwa"===(this.Aa.jb(y.AFrameworkApplication.Yha)||"").toLowerCase()?
!1:!0}U6o(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&aa.a.O9c?!0:aa.a.y7||aa.a.Z3i}w6o(){let b;b=0;const h=this.yqb(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,
state:1}):{returnValue:Lj.Gig(r),state:b};if(this.ZBd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.nEb>=this.wGd||this.oEb>=this.xGd)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.nEb,this.wGd,this.oEb,this.xGd),{returnValue:!1,state:b};v.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.wGd+this.xGd-(this.nEb+this.oEb));return{returnValue:!0,state:b}}eEi(){const b=this.yqb();return b?b.PolicyCookie:""}ORm(){const b=this.yqb();return b?b.WebAffinitizedUrl:""}Wgm(){const b=this.yqb();return b?b.AffinitizedUrl:""}Rrm(){const b=new Date;try{const h=this.yqb();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){v.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}VZf(){const b=this.Rrm();return!!b&&b.getTime()<Date.now()}yqb(){if(!this.ULd){const b=
cb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.ULd=JSON.parse(b)}return this.ULd}GMj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.ULd=b;b.WasServiceDown||this.wLp(b)}wLp(b){b=JSON.stringify(b);cb.a.instance.setItem(this.userId,b)}Jrf(b){return void 0!==Lj.ee&&null!==Lj.ee?Lj.ee.Xf("WebServiceCall",
b):null}xAe(b){if(void 0!==b&&null!==b){const h=b.Ri;b.stop();return{returnValue:h,nz:null}}return{returnValue:null,nz:b}}static Gig(b){return"false"!==b.toLowerCase()?!0:!1}}Lj.ee=null;Lj.y6e=null;Lj.FQc="";Lj.LJh="";Lj.WSe="";Object(u.a)(Lj,"SafeLinksManager",null,[518]);const wm=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},aj=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class sl{constructor(){this.Z=null;this.iz=()=>{y.AFrameworkApplication.J.$("WACSafeLinksIsEnabled")&&(this.Z.register(Lj,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().Ud(()=>new Lj(y.AFrameworkApplication.J,y.AFrameworkApplication.Fe,String.format("{0}-{1}",wm(y.AFrameworkApplication.ua.Gb.Mk),aj(y.AFrameworkApplication.ua.Gb.Dma)),!1,this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),y.AFrameworkApplication.ua.Vr)),
this.Z.Oa("Common.App.SafeLinks.ISafeLinksManager"))}}get name(){return"Common.App.SafeLinks"}wc(b){this.Z=b}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.vp(this.iz)}dispose(){}static main(){E.a.instance.Mc(new sl)}}Object(u.a)(sl,"SafeLinksPackage",null,[0,1]);var yi=d(222);class Dk{constructor(b){this.sa=new Bf.a;this.ii=b}$lb(b){this.sa.addHandler(Dk.LDa,b)}Kkd(b){this.sa.removeHandler(Dk.LDa,b)}gTa(b){this.sa.addHandler(Dk.d0a,b)}mZb(b){this.sa.removeHandler(Dk.d0a,b)}Aff(b){this.sa.addHandler(Dk.Rzc,
b)}HBg(){this.sa.raiseEvent(Dk.LDa)}ARf(){return yi.a.instance.iXa(y.AFrameworkApplication.Gz)}}Dk.LDa="SE";Dk.ond="SEP";Dk.d0a="SER";Dk.Rzc="TRP";Object(u.a)(Dk,"NullSessionExpirationManager",null,[471,472]);class fi{constructor(){this.xPc=this.Nkb=!1;this.Ksc=()=>{yi.a.instance.XDj(this.Ksc);v.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.QQf()};this.Hfd=()=>{yi.a.instance.LCo(this.Hfd);this.xPc||this.Nkb||(v.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),
this.xPc=!0,this.pCg())};const b=y.AFrameworkApplication.Gz;0>=b||(this.Gz=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Gz,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.YK}),yi.a.instance.UPh(this.Ksc),yi.a.instance.TPh(this.Hfd))}QQf(){this.Nkb||(y.AFrameworkApplication.lS(Sj.a.nnd),this.Nkb=!0,this.qze())}}Object(u.a)(fi,"ASessionExpirationManager",null,[]);var Dg=d(173),yk=d(547);class Ym{constructor(b,h,r,
A){this.TGg="";this.Tvd=b;this.YDh=r;this.UDh=A;this.noh=h;b=(new Date(this.Tvd)).format(y.AFrameworkApplication.TRj);this.TGg=this.noh?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Bwc(b){1===b?this.YDh&&this.YDh(this.noh):0===b&&y.AFrameworkApplication.va.Qb(Za.a.close,2,yk.g)}dispose(){this.UDh&&this.UDh()}}Ym.id="SessionExpirationDialog";Object(u.a)(Ym,"SessionExpirationDialogSharedProperties",null,[]);class we{}we.mh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";
Object(u.a)(we,"SessionExpirationDialogHtml",null,[]);class ri extends Dg.a{constructor(b,h,r,A){super(h);const L={};this.C4a=new Ym(b,h,r,A);this.Ig=Ym.id;y.AFrameworkApplication.WZh?(this.Bd=1,this.Ke(0,CommonUIStrings.l_DialogClose)):(this.Bd=0,this.Au=!1);h||1===y.AFrameworkApplication.ua.mode?this.Ke(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ke(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.mh=we.mh;L.WACSessionExpirationText=this.C4a.TGg;this.Uh(CommonUIStrings.l_DefaultDialogTitle,
Object(D.a)(this,this.Bwc,"sessionExpirationDialogHandler"),L);this.x8(this.Bj("WACSessionExpirationText"))}Bwc(b){this.C4a.Bwc(b)}VRf(){this.hide()}dispose(){super.dispose();this.C4a&&this.C4a.dispose()}}Object(u.a)(ri,"LegacySessionExpirationDialog",Dg.a,[565]);class Tj extends Ag.StandardDialog{constructor(b,h,r,A){super(h);this.C4a=new Ym(b,h,r,A);this.Ig=Ym.id;y.AFrameworkApplication.WZh?(this.Bd=1,this.Ke(0,CommonUIStrings.l_DialogClose)):(this.Bd=0,this.Au=!1);h||1===y.AFrameworkApplication.ua.mode?
this.Ke(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ke(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.sw(CommonUIStrings.l_DefaultDialogTitle,this.C4a.TGg,0,Object(D.a)(this,this.Bwc,"sessionExpirationDialogHandler"))}Bwc(b){this.C4a.Bwc(b)}VRf(){this.hide()}dispose(){super.dispose();this.C4a&&this.C4a.dispose()}}Object(u.a)(Tj,"SessionExpirationDialog",Ag.StandardDialog,[565]);const vf=(b,h,r,A)=>y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.kH&&y.AFrameworkApplication.J.$("ReactStandardSessionExpirationDialogIsEnabled")?
new Tj(b,h,r,A):new ri(b,h,r,A);var ff=d(200);class Kf extends fi{constructor(b){super();this.xMd=this.eac=!0;this.J1=null;this.sa=new Bf.a;this.Bgc=()=>{this.J1=null};this.Cwc=h=>{(h||this.ii.$Sd())&&this.ii.eca(null)};this.ii=b}$lb(b){this.sa.addHandler(Kf.LDa,b)}Kkd(b){this.sa.removeHandler(Kf.LDa,b)}gTa(b){this.sa.addHandler(Kf.d0a,b)}mZb(b){this.sa.removeHandler(Kf.d0a,b)}Aff(b){this.sa.addHandler(Kf.Rzc,b)}ARf(){return yi.a.instance.iXa(y.AFrameworkApplication.Gz)}HBg(b){this.eac=b}pCg(){this.J1||
ff.a.PO||(this.xMd&&(this.J1=vf(this.Gz,!1,this.Cwc,this.Bgc)),this.sa.raiseEvent(Kf.ond))}qze(){this.J1&&(this.J1.jma&&this.J1.VRf(),this.J1=null);this.eac&&(this.J1=vf(this.Gz,!0,this.Cwc,this.Bgc));this.sa.raiseEvent(Kf.LDa)}}Kf.LDa="SE";Kf.ond="SEP";Kf.d0a="SER";Kf.Rzc="TRP";Object(u.a)(Kf,"SessionExpirationManager",fi,[471,472]);class Rg{}Rg.tTk="Aborting";Rg.rQd="ActivityDuration";Rg.error="Error";Rg.AAf="Errors";Rg.TB="Failed";Rg.UOb="FirstActivity";Rg.initialized="Initialized";Rg.I4i="KickedOut";
Rg.dyn="LastActivity";Rg.mHj="RetryOverride";Rg.sue="RequestGroups";Rg.wxb="Requests";Rg.Gue="Responses";Rg.pwe="SessionDuration";Rg.status="Status";Rg.success="Success";Rg.jgp="Successful";Rg.tokens="Tokens";Rg.Wjg="PollingDuration";Object(u.a)(Rg,"SessionExpirationStrings",null,[]);class ob{constructor(b){this.MD={};this.ooa={};this.K3a={};this.q$i=15;this.pqh=!1;this.IMk=new Date;this.sFd=new Date;this.Cck=()=>{v.ULS.sendTraceTag(41964821,217,50,v.ULS.zad({["Aggregate"]:this.ooa,["Current"]:this.MD}))};
this.Jb=b;this.GQ=new mf.a(2,2,6E4*this.q$i,this.Cck,135,"SL",!1);this.Jb.$b(this.GQ);this.V8m()}V8m(){this.ooa[Rg.sue]=0;this.ooa[Rg.wxb]=0;this.ooa[Rg.Gue]=0;this.ooa[Rg.status]=Rg.initialized;this.ooa[Rg.UOb]=new Date;this.ooa[Rg.pwe]=0;this.ooa[Rg.rQd]=0;this.ooa[Rg.pwe]=0;this.MD[Rg.pwe]=0;this.ooa[Rg.rQd]=0;this.MD[Rg.rQd]=0}get rdo(){this.K3a[Rg.Wjg]=+new Date-+this.K3a[Rg.UOb];return this.K3a}ETf(b,h){var r=b[h];r=r?r:0;r++;b[h]=r;this.tyg(b)}tyg(b){const h=new Date;b[Rg.rQd]=+h-+this.sFd;
this.sFd=h;b[Rg.pwe]=+this.sFd-+this.IMk;b[Rg.dyn]=this.sFd}uca(b,h){this.MD[b]=h;this.tyg(this.MD)}Lxg(b,h){this.MD[b]=h;this.tyg(this.MD)}smc(b){this.ETf(this.MD,b);this.ETf(this.ooa,b);this.ETf(this.K3a,b)}flush(){this.pqh||(this.ooa[Rg.status]=this.MD[Rg.status],this.Cck(this.GQ),this.Jb.Z3(this.GQ,6E4*this.q$i))}SGo(){const b=this.MD[Rg.status];b&&(this.ooa[Rg.status]=b);this.MD={}}dHo(){this.K3a={};this.K3a[Rg.Wjg]=0;this.K3a[Rg.UOb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.pqh=!0;this.Jb.wf(this.GQ)}}Object(u.a)(ob,"SessionLogger",null,[467]);class Nb{constructor(b,h){this.rOd=b;this.JFa=h}get tokens(){return this.rOd}get errors(){return this.JFa}}Object(u.a)(Nb,"TokenRefreshArgs",null,[515]);var cc=d(479);class Lc extends Sys.EventArgs{constructor(b,h,r,A,L,Z,oa){super();this.K3a=b;this.hdo=h;this.sue=A;this.TB=L;this.wxb=Z;this.Gue=oa}}Object(u.a)(Lc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Uc=d(25);class sd{constructor(b,h=null,
r=null){this.xPc=this.Nkb=!1;this.xMd=this.eac=!0;this.sa=new Bf.a;this.APc=this.kKc=this.nKd=!1;this.kHb=null;this.Bzh=10;this.LEd=!1;this.dto=()=>{this.A5c(!1);return!yi.a.instance.iXa(y.AFrameworkApplication.Gz)};this.lTk=(A,L)=>{yi.a.instance.tfe?this.Ksc(A,L):this.aYe?(this.kKc=!1,this.A5c(!1)):(this.Nkb||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.Ksc(A,L))};this.mTk=(A,L)=>{yi.a.instance.sfe?this.Hfd(A,L):(Uc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),
this.kKc=!1,this.A5c(!0))};this.Ccf=(A,L)=>{yi.a.instance.sfe?this.Hfd(A,L):this.A5c(!0)};this.Ksc=()=>{this.aYe||yi.a.instance.XDj(this.Ksc);v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.QQf(yi.a.instance.tfe)};this.Nmp=()=>{const A=this.Jc.rdo;v.ULS.sendTraceTag(555255521,217,50,"{0}",H.c(A));this.sa.raiseEvent(sd.Rzc,new Lc(A,A[Rg.Wjg],A[Rg.UOb],A[Rg.sue],A[Rg.TB],A[Rg.wxb],A[Rg.Gue]))};this.pfo=()=>{3E5<+new Date-+this.Nrh?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),
this.A5c(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.W$e=b;this.aYe=y.AFrameworkApplication.Zvn;this.Jb=zf.a.instance;v.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:y.AFrameworkApplication.Gz,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.YK});this.Jc=h||new ob(zf.a.instance);this.xja=r;yi.a.instance.UPh(this.lTk);yi.a.instance.TPh(this.Ccf);
cc.SessionStatusManager.instance.yff(this.Ccf);cc.SessionStatusManager.instance.E2k(this.pfo);this.Nrh=new Date;y.AFrameworkApplication.Yvn&&(yi.a.instance.Kmf=this.dto);b=!1;y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Bzh=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),b=y.AFrameworkApplication.J.$("WopiTokenRefreshWhenNetworkResumed"));b?cc.SessionStatusManager.instance.yff(this.mTk):cc.SessionStatusManager.instance.yff(this.Ccf)}$lb(b){this.sa.addHandler(sd.LDa,b)}Kkd(b){this.sa.removeHandler(sd.LDa,b)}gTa(b){this.sa.addHandler(sd.d0a,b)}mZb(b){this.sa.removeHandler(sd.d0a,b)}Aff(b){this.sa.addHandler(sd.Rzc,b)}ARf(){return yi.a.instance.iXa(y.AFrameworkApplication.Gz)}A5c(b){if(!this.nKd&&!this.kKc)if(this.xja&&this.xja.$o)this.APc=!0,this.Jc.uca(Rg.status,
Rg.I4i),this.Jc.flush(),this.Jc.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.APc),this.APc)this.qze();else{this.Jc.flush();this.Jc.SGo();this.Jc.smc(Rg.sue);this.nKd=!0;this.LEd||(this.Jc.dHo(),this.LEd=!0,this.MDl());const h=this.W$e.wto(b);h.continueWith(()=>{if(this.W$e.Ajo(h))this.Jc.smc(Rg.jgp),this.Jc.uca(Rg.status,Rg.success),this.xMd=!1,this.aYe&&(this.eac=!1),this.kKc=!1,this.Nrh=new Date,this.Sep(),this.sa.raiseEvent(sd.d0a,
new Nb(h.result.tokens,null));else{const r=h.result.errors;this.Jc.smc(Rg.TB);this.Jc.uca(Rg.status,Rg.TB);b||(this.APc=this.W$e.i$c(r));this.APc&&(this.Jc.uca(Rg.tTk,JSON.stringify(r)),v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.kKc=!0;this.sa.raiseEvent(sd.d0a,new Nb(null,r))}this.Jc.flush();this.nKd=!1})}}Hfd(){this.xPc||this.Nkb||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.xPc=!0,this.pCg(yi.a.instance.sfe))}QQf(b){if(!this.Nkb){var h=
b?Sj.a.JRo:Sj.a.nnd;const r=Object.assign(new Na.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));y.AFrameworkApplication.lS(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(y.AFrameworkApplication.YK),v.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&
xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.Nkb=!0;this.qze()}}Sep(){this.LEd&&(this.Jb.wf(this.kHb),this.LEd=!1)}MDl(){this.kHb=new mf.a(2,2,1E3*this.Bzh,this.Nmp,135);this.Jb.$b(this.kHb)}}sd.LDa="SE";sd.ond="SEP";sd.d0a="SER";sd.Rzc="TRP";Object(u.a)(sd,"ASessionExpirationManagerWithRefresh",null,[]);class id extends sd{constructor(b,h,r=null,A=null){super(h,r,A);this.J1=null;this.Bgc=()=>{this.J1=null};this.Cwc=L=>{(L||
this.ii.$Sd())&&this.ii.eca(null)};this.ii=b}HBg(b){this.eac=b}pCg(b){if(!this.J1&&!ff.a.PO){if(b)this.J1=vf(y.AFrameworkApplication.xNa,!1,this.Cwc,this.Bgc);else if(this.xMd){if(this.nKd)return;this.J1=vf(y.AFrameworkApplication.Gz,!1,this.Cwc,this.Bgc)}v.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",sd.ond,b);this.sa.raiseEvent(sd.ond)}}qze(){this.J1&&(this.J1.jma&&this.J1.VRf(),this.J1=null);if(this.eac){this.Jc.stop();if(this.xja&&this.xja.$o)return;this.J1=
vf(y.AFrameworkApplication.Gz,!0,this.Cwc,this.Bgc)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",sd.LDa);this.sa.raiseEvent(sd.LDa)}}Object(u.a)(id,"SessionExpirationManagerWithRefresh",sd,[471,472]);class Ld{constructor(b,h,r=null,A=null){this.sJh=!1;this._instance=null;this._frame=b;this.lp=h;this.Jc=r||new ob(zf.a.instance);this.xja=A}create(){this.sJh=y.AFrameworkApplication.Bab;if(!this.sJh)return new Kf(this._frame);v.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");
if(!this._instance)switch(y.AFrameworkApplication.JHp){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new Dk(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new id(this._frame,this.lp,this.Jc,this.xja);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Kf(this._frame)}v.ULS.sendTraceTag(39408089,217,
50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(u.a)(Ld,"SessionExpirationManagerFactory",null,[470]);class ne{}Object(u.a)(ne,"Error",null,[]);class kf{}Object(u.a)(kf,"NamedResult",null,[]);class vg extends kf{}Object(u.a)(vg,"ErrorInfo",kf,[]);var Sh=d(1075);class Ei{constructor(b,h,r,A=null,L=!1,Z=null,oa=!1,Ba=!1,gb=!1,Ab=!1,Jb=!1){this.JGa=0;this.zja=this.np=null;this.rOd=new nb.a;this.JFa=new nb.a;this.Mq=null;
this.UJc=!1;this.OQc=this.PQc=null;this.mGo=()=>{this.RFj()};this.Jb=b;this.Fzh=h;this.Fzh.execute(Tb=>{Tb.LE(K.a.ASf,Object(D.a)(this,this.n_n,"onHostResponseReceived"))});this.K5=r;this.ZHh=new Sh.a("WebServiceCall","TokenRefresh");this.Jc=A||new ob(b);this.AMk=L;this.lf=Z?Z:cc.SessionStatusManager.instance;this.lgh=oa;this.tAd=Ba;this.VMk=gb;this.WMk=Ab;this.vEh=Jb}n_n(b){if(b.MessageId!==K.a.ASf)Uc.b(39408099,306,15,"Unexpected message.");else{var h=new nb.a,r=new nb.a;this.Jc.smc(Rg.Gue);var A=
b.Values[G.a.hMj];if(!A||0>=A.length)Uc.b(40122317,306,15,"Found no tokens in the dictionary"),A=b.Values;Uc.b(40122318,306,100,"The Tokens array contains {0} tokens",A.length);this.Jc.uca("Correlation",b.CorrelationId);var L="";for(let Ba=0;Ba<A.length;Ba++){this.Jc.Lxg(Rg.tokens,A.length);var Z=A[Ba],oa=Z;if(!oa||!oa.Name)continue;this.Jc.smc(oa.Name);const gb=Z;if(gb&&gb.Value)Uc.b(39408128,306,100,"Received token with name: {0}",gb.Name),h.add(gb),this.rOd.add(gb),this.tAd||this.Jc.uca(Rg.status,
Rg.success),this.lgh&&this.lf&&this.lf.uHo();else if(Z=this.OJm(Z),Uc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",oa.Name,JSON.stringify(Z),this.zja),r.add(Z),this.tAd||(this.JFa.add(Z),L=JSON.stringify(Z),this.Jc.uca(Rg.error,JSON.stringify(Z)),this.Jc.uca(Rg.status,Rg.TB)),this.lgh)for(const Ab of Z.Errors)oa=this.Drm(Ab),this.lf&&this.lf.L_k(oa)}this.tAd?(0<r.count?this.OQc?this.OQc(new Nb(h,r)):Uc.b(512267295,306,15,"Received errors but the promise has completed"):
this.PQc?this.PQc(new Nb(h,r)):Uc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Uc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.zja)):(0<r.count&&""!==L?(A=Object.assign(new Na.a,{extendedProperties:new Map}),A.extendedProperties.set("Errors",L),A.extendedProperties.set("RetryCount",this.JGa.toString()),A.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),
A.extendedProperties.set("IsTokenExpiring",this.UJc.toString()),this.w_f()&&A.extendedProperties.set("IsAppShuttingDown",y.AFrameworkApplication.Yl.toString()),xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,A)):xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Uc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.zja),0<r.count&&!this.i$c(r)?(b=this.K5.tFi(r),b!==
this.K5.Evc&&(this.Jc.Lxg(Rg.mHj,b),this.Jb.Z3(this.np,b))):(this.Jc.flush(),this.np&&(Uc.b(39408131,306,100,"Deleting task {0} from task manager",this.np.name),this.Jb.wf(this.np)),this.Mq&&!this.Mq.task.isCompleted?this.Mq.gg(new Nb(h,r)):Uc.b(512267293,306,15,"Received results but the task has completed")))}}OJm(b){if(!b)return null;const h=Object.assign(new vg,{Name:b.Name,Errors:[],SPCorrelationId:b.SPCorrelationId});for(const r of b.Errors)b=new ne,b.Id=r.Id,b.Details=la.a.PQb(r.Details,500),
h.Errors.push(b);return h}RFj(){y.AFrameworkApplication.$c("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.JGa>=this.K5.Xie?(Uc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.zja),this.IFl(this.Mq)):(xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.pLj())}pLj(){const b={};b[G.a.hMj]=this.K5.tokens;this.VMk&&(b[G.a.ORo]=this.WMk);const h=eb.a.create().toString();Uc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",
JSON.stringify(this.K5.tokens),this.JGa+1,h,this.zja);this.Fzh.execute(r=>{r.sendMessage(K.a.khf,b,h)});this.JGa++;this.Jc.smc(Rg.wxb)}IFl(b){const h=new nb.a;for(let r=0;r<this.K5.tokens.length;r++){const A=Object.assign(new vg,{Name:this.K5.tokens[r],Errors:[Object.assign(new ne,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(A);this.JFa.add(A)}this.Jb.wf(this.np);this.Jc.uca(Rg.AAf,JSON.stringify(this.JFa));
this.Jc.uca(Rg.status,Rg.TB);b&&!b.task.isCompleted&&b.gg(new Nb(new nb.a,this.JFa))}w_f(){return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}wto(b){y.AFrameworkApplication.$c("ej4if276;fheca743");y.AFrameworkApplication.$c("5d4fi128;abe10395");this.ZHh.start();this.w_f()&&this.Jb.Orb&&(Uc.b(508351137,306,15,"Restarting taskmanager, is shutting down {0}",y.AFrameworkApplication.Yl),this.Jb.restart());this.UJc=b;this.zja=eb.a.create().toString();
Uc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.zja,this.UJc);this.JGa=0;this.JFa.clear();this.rOd.clear();this.Mq=new Pg.a;this.tAd?this.SFj(this.K5.Xie).then(h=>{this.Mq&&!this.Mq.task.isCompleted&&this.Mq.gg(h);this.OQc=this.PQc=null;this.Jc.uca(Rg.AAf,JSON.stringify(this.JFa));this.Jc.uca(Rg.status,Rg.success);this.Jc.flush()}).catch(h=>{this.Mq&&!this.Mq.task.isCompleted&&this.Mq.gg(Object(Ca.a)(515,h));this.OQc=this.PQc=null;this.Jc.uca(Rg.AAf,JSON.stringify(this.JFa));
this.Jc.uca(Rg.status,Rg.TB);this.Jc.flush()}):(this.np=new mf.a(this.K5.priority,2,this.K5.Evc,this.mGo,98,K.a.khf,!0),this.AMk&&this.RFj(),this.Jb.$b(this.np));return this.Mq.task}SFj(b){const h=this,r=new Promise((Ba,gb)=>{h.PQc=Ba;h.OQc=gb;xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.pLj()}),A=this,L=new Promise((Ba,gb)=>{window.setTimeout(()=>{gb(A.Q9h("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},A.K5.Evc)});let Z=b;const oa=
this;return new Promise((Ba,gb)=>{Z--;Promise.race([r,L]).then(Ab=>{xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ba(Ab)}).catch(Ab=>{var Jb=oa.K5.Evc;if(Object(Gb.a)(515,Ab)&&(Ab=Object(Ca.a)(515,Ab),0<Ab.errors.count)){oa.wEn(Ab.errors);oa.SMh(Ab.errors);if(oa.i$c(Ab.errors)){gb(Ab);return}const Tb=oa.K5.tFi(Ab.errors);Tb!==oa.K5.Evc?(oa.Jc.Lxg(Rg.mHj,Tb),Jb=Tb):oa.uun(Ab.errors)&&(Jb=0)}Z?window.setTimeout(()=>{oa.SFj(Z).then(Ba).catch(gb)},Jb):(Jb=oa.Q9h("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),
oa.SMh(Jb.errors),gb(Jb),Uc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",oa.zja))})})}SMh(b){for(const h of b)this.JFa.add(h)}uun(b){if(!b.count)return!1;b=b.K(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}Q9h(b,h){const r=new nb.a;for(let A=0;A<this.K5.tokens.length;A++){const L=this.JFl(this.K5.tokens[A],b,h);r.add(L)}return new Nb(new nb.a,r)}JFl(b,h,r){return Object.assign(new vg,{Name:b,Errors:[Object.assign(new ne,{Id:h,Details:r})]})}wEn(b){if(b.count){b=
b.K(b.count-1);b=JSON.stringify(b);var h=Object.assign(new Na.a,{extendedProperties:new Map});h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.JGa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.UJc.toString());this.w_f()&&h.extendedProperties.set("IsAppShuttingDown",y.AFrameworkApplication.Yl.toString());xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",
!1,!1,h);this.Jc.uca(Rg.error,b);this.Jc.uca(Rg.status,Rg.TB)}}Ajo(b){this.ZHh.stop();const h=this.YYm(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!h,this.zja,this.UJc,this.JGa,this.JFa.count,0<b.result.errors.count?b.result.errors.K(0).Name:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Id:
"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Details:"");return h?!1:this.zjo(b.result.tokens)}i$c(b){return this.K5.i$c(b)}zjo(b){for(let h=0;h<b.count;h++){const r=b.K(h);if(r.Name===G.a.accessToken){const A=(new Date).getTime();r.Expiry>y.AFrameworkApplication.Gz?(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.YK},"PreviousAccessTokenTtl",y.AFrameworkApplication.Gz),
y.AFrameworkApplication.accessToken=r.Value,y.AFrameworkApplication.Gz=Math.floor(r.Expiry),y.AFrameworkApplication.mNg=A,y.AFrameworkApplication.YSa=Math.floor(r.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.YK},"PreviousAccessTokenTtl",y.AFrameworkApplication.Gz)}}return!0}YYm(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const A=b.K(r);v.ULS.sendTraceTag(39706829,
217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",A.Name,JSON.stringify(A.Errors),this.zja,A.SPCorrelationId)}return h}b3i(b){return b.includes("aadInteractionRequired")||b.includes("sessionRevocation")||b.includes("blockAccessForTenantRestrictions")||b.includes("revoked")||b.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}Drm(b){let h=Sj.a.nnd;const r=parseInt(b.Id);b=b.Details.toString();if(isNaN(r))h=
Sj.a.Abk;else{switch(r){case 401:h=Sj.a.wBc;this.vEh&&this.b3i(b)&&(h=Sj.a.vBc);break;case 403:h=Sj.a.cGe;this.vEh&&this.b3i(b)&&(h=Sj.a.vBc);break;case 500:h=Sj.a.zbk;break;case 503:h=Sj.a.Cbk}h===Sj.a.nnd&&(h=500<r?Sj.a.Bbk:Sj.a.ybk)}return h}}Object(u.a)(Ei,"TokenRefreshManager",null,[469]);class pj{constructor(){this.Evc=y.AFrameworkApplication.MHp;this.Xie=y.AFrameworkApplication.KHp;this.tokens=y.AFrameworkApplication.aTm();this.priority=y.AFrameworkApplication.NHp;this.dCh=this.ZYo();this.icf=
y.AFrameworkApplication.$Sm()}i$c(b){b=JSON.stringify(b);if(this.icf&&0<this.icf.length)for(const h of this.icf)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}tFi(b){try{if(b)for(const h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in this.dCh)return Number.parseInvariant(this.dCh[r.Id].toString())}catch(h){v.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Evc}ZYo(){const b={};try{if(!y.AFrameworkApplication.z9d()||0>=y.AFrameworkApplication.z9d().length||
""===y.AFrameworkApplication.z9d()[0])return b;for(const h of y.AFrameworkApplication.z9d())0<h.length&&(b[h]=y.AFrameworkApplication.LHp)}catch(h){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",h.toString())}return b}}Object(u.a)(pj,"TokenRefreshPolicy",null,[468]);class Ed{constructor(){this.Z=null}get name(){return"Common.App.SessionExpiration"}init(){y.AFrameworkApplication.J.vp(()=>{this.g$a()})}g$a(){this.Z.resolve("Common.ISessionExpirationManagerFactory");
this.Z.resolve("Common.ISessionExpirationManager");this.Z.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}wc(b){this.Z=b;b.register(467,"Common.App.SessionExpiration.ISessionLogger").ha().Ud(()=>new ob(zf.a.instance));b.register(468,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().Ud(()=>new pj);b.register(469,"Common.App.SessionExpiration.ITokenRefreshManager").ha().Ud(()=>new Ei(zf.a.instance,y.AFrameworkApplication.nN(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),
b.resolve("Common.App.SessionExpiration.ISessionLogger"),y.AFrameworkApplication.J.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa("Common.ISessionStatus"),y.AFrameworkApplication.J.$("WopiAllowTokenRefreshErrorTracking"),y.AFrameworkApplication.J.$("WopiTokenRefreshSyncMessageWithTimeout"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",
!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RevokedTokenExperiment",!1)&&y.AFrameworkApplication.J.$("ShowTokenRevocationErrorMessage")));b.register(470,"Common.ISessionExpirationManagerFactory").ha().Ud(()=>new Ld(y.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Oa("Common.ISessionStatus")));b.register(471,"Common.ISessionExpirationManagerWithDialog").ha().Ud(()=>
b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(472,"Common.ISessionExpirationManager").ha().Ud(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){E.a.instance.Mc(new Ed)}}Object(u.a)(Ed,"SessionExpirationPackage",null,[0,1]);var ni=d(776),Ee=d(421),hh=d(348),Mj=d(208);class Bj extends Mj.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(u.a)(Bj,"PersonaButtonProps",Mj.a,[]);class Zl{yfc(b,
h){if(b&&!(1>b.length)&&h){var r=Object.assign(new hh.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.ZFl(b,r.ControlList);h.push(r)}}ZFl(b,h){const r=Object.assign(new ni.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Ee.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new hh.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.dJl(b,h.ControlList)}dJl(b,
h){for(let r=0;r<b.length;r++){const A=Object.assign(new Bj,{ExternalId:String.format("CoauthorPersona_{0}",r),Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});Array.add(h,A)}}}Object(u.a)(Zl,"PresenceContextMenuSectionBuilder",null,[829]);var kj=d(105);class Ci{constructor(b,h,r,A){this.hwa=this.Nt=this.np=this.Ai=this.CPa=null;this.ebl=()=>{this.CMd.dVh()};this.Era=L=>{1===L?(jm.a.wpe(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),
y.AFrameworkApplication.va.Ob(Za.a.t2f,2)):(this.k7o(),y.AFrameworkApplication.va.Ob(Za.a.u_h,2))};this.Ail=()=>{this.NUl();y.AFrameworkApplication.va.Ob(Za.a.t_h,2)};this.CMd=b;this.SNk=A;this.CMd.r8c&&(this.np=new mf.a(3,2,5E3,this.ebl,2),y.AFrameworkApplication.pc.$b(this.np),this.Xb(h,r));this.CMd.w0k(()=>{this.sWb()});this.CMd.SOh(()=>{this.tWb()})}get TQ(){return this.Nt||(this.Nt=Wa.a.instance.Oa("CommonUI.IBusinessBar"))}get fYh(){return this.hwa||(this.hwa=Wa.a.instance.Oa("CommonUI.IBusinessBarEntryFactory"))}Xb(b,
h){const r=y.AFrameworkApplication.va;r.fb(Za.a.eVh,Gc.a.frame,b,96);r.fb(Za.a.fVh,Gc.a.frame,h,96);r.qa(Za.a.t_h,Gc.a.frame,Vd.ActionManager.cU);r.qa(Za.a.u_h,Gc.a.frame,Vd.ActionManager.cU);r.qa(Za.a.t2f,Gc.a.frame,Vd.ActionManager.cU)}sWb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);y.AFrameworkApplication.va.Ob(Za.a.eVh,2)}tWb(){this.zjp();y.AFrameworkApplication.va.Ob(Za.a.fVh,2)}zjp(){this.Ai&&(this.Ai.hide(),this.Ai.dispose(),this.Ai=null);this.CPa&&this.TQ&&(y.AFrameworkApplication.Yl||
this.TQ.removeEntry(this.CPa),this.CPa.dispose(),this.CPa=null)}showDialog(b){kj.a.AD(this.Ai);this.Ai=new Ag.StandardDialog;this.SNk||(this.Ai.Au=!1,this.Ai.Bd=0);this.Ai.Ke(1,CommonUIStrings.l_SignIn);this.Ai.lV(CommonUIStrings.l_DefaultDialogTitle,b,this.Era)}k7o(){this.TQ&&this.fYh&&(this.CPa=this.fYh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.CPa.closeable=!0,this.CPa.addButton(CommonUIStrings.l_SignIn,Ci.e6a,""),this.CPa.kka=this.Ail,
this.TQ.Iz(this.CPa,!1))}NUl(){this.np&&(y.AFrameworkApplication.pc.wf(this.np),this.np=null)}dispose(){this.np=this.Ai=this.CPa=null}static e6a(){jm.a.wpe();y.AFrameworkApplication.va.Ob(Za.a.t2f,2)}}Object(u.a)(Ci,"SignOutResponseUI",null,[10]);class Ek{get name(){return"Common.App.UI"}wc(b){b.register(Zl,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){kj.a.AD(Ek.Qxa);Ek.Qxa=null}static main(){E.a.instance.Mc(new Ek)}static h7m(b,
h,r){Ek.V6o()&&(Ek.Qxa=new Ci(jm.a.instance,b,h,r))}static V6o(){return y.AFrameworkApplication.oke&&!y.AFrameworkApplication.Tfa}}Ek.Qxa=null;Object(u.a)(Ek,"CommonAppUIPackage",null,[0,1]);class zi{get name(){return"Common.App.DialogWithLinkToResource"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new zi)}}Object(u.a)(zi,"CommonAppDialogWithLinkToResourcePackage",null,[0,1]);var Sg=d(83);class km{constructor(b){this.Ez=b;this.wz=Array.indexOf(this.Ez,this.$ka)}dispose(){this.Ez=null}get tra(){return this.Ez[this.wz]}iA(b){this.vnd(b,
!1);return!0}Eic(b){this.vnd(b,!0)}vnd(b,h){b&&(this.tra!==b||h)&&(b.tabIndex=0,Sg.FocusManager.LN(b));Array.contains(this.Ez,b)&&(this.wz=Array.indexOf(this.Ez,b))}get Yuj(){let b=this.wz;do if(b)if(0<b&&b<this.Ez.length)b--;else break;else b=this.Ez.length-1;while(!Jg.DOMFocusListing.K7a(this.Ez[b])&&b!==this.wz);return this.Ez[b]}get ygj(){let b=this.wz;do if(b===this.Ez.length-1)b=0;else if(0<=b&&b<this.Ez.length-1)b++;else break;while(!Jg.DOMFocusListing.K7a(this.Ez[b])&&b!==this.wz);return this.Ez[b]}get $ka(){let b=
0;for(;!Jg.DOMFocusListing.K7a(this.Ez[b])&&b<this.Ez.length;)b++;return Jg.DOMFocusListing.K7a(this.Ez[b])?this.Ez[b]:null}get Spc(){let b=this.Ez.length-1;for(;!Jg.DOMFocusListing.K7a(this.Ez[b])&&0<b;)b--;return Jg.DOMFocusListing.K7a(this.Ez[b])?this.Ez[b]:null}}Object(u.a)(km,"DialogFocusListing",null,[83]);var Je=d(77);class Mc extends Ag.StandardDialog{constructor(b,h,r,A=null){super();this.jja=this.fy=this.bib=null;this.Ez=[];this.z4n=L=>{this.fy&&(this.fy.target="_blank",this.fy.submit());
L.preventDefault()};this.Xhi=()=>{v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};this.hho=()=>{v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Ym&&this.Ym.stop()};this.XId=h;this.Xm=b;this.wyk=r;this.QLd=A;this.Ym=new Sh.a("LoadResource","LoadPrintablePdf")}jJa(){this.Bd=5;this.width=40;const b=document.createElement("span");b.id=this.Bj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;
Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.jja=document.createElement("iframe");this.jja.name="pdfObjectFrame";this.jja.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.jja.onload=this.hho;if(this.QLd&&0<this.QLd.count){var r=Ma.a.ALf(this.XId,this.QLd);const A=Ma.a.arg(this.XId,this.QLd);this.fy=document.createElement("form");this.fy.id="printPreviewPostForm";this.fy.method="POST";this.fy.target=this.jja.name;this.fy.action=A;for(const L of r)r=document.createElement("input"),
r.type="hidden",r.name=L.key,r.value=L.value,this.fy.appendChild(r)}else this.jja.setAttribute("src",this.XId);Sys.UI.DomElement.addCssClass(this.jja,ff.a.mwh);this.wyk?(Sys.UI.DomElement.addCssClass(this.jja,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,$c.a.Is(this.jja,$c.a.wA,$c.a.mq)):(Sys.UI.DomElement.addCssClass(this.jja,"DirectPrintPdfObject"),this.Ez.push(this.jja));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.jja);
this.fy&&b.appendChild(this.fy);b.appendChild(document.createElement("br"));b.appendChild(this.dzl(this.fy?"#":this.XId));this.Ym.start();this.bvb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.x8(this.Bj("DirectPrintHeaderContent"));this.fy&&this.fy.submit();this.aGl();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}dzl(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);
y.AFrameworkApplication.J&&(2===y.AFrameworkApplication.ua.Gb.Mk&&y.AFrameworkApplication.J.$("PPTDisableDirectPrintDialogDownloadPDFLink")||1===y.AFrameworkApplication.ua.Gb.Mk&&y.AFrameworkApplication.J.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===y.AFrameworkApplication.ua.Gb.Mk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===y.AFrameworkApplication.ua.Gb.Mk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,
328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.bib=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.bib=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.fy&&zc.a.addHandler(r,"click",this.z4n),this.Xm.ub(od.a.click,this.bib,this.Xhi,null));this.Ez.push(this.bib);return h}aGl(){if(0<
this.Ez.length){const b=new km(this.Ez),h=Sg.FocusManager.instance().$t();h&&(this.bib.focus(),h.Uk=b,h.rP=!0)}}Ybd(){v.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.bib&&(this.Xm.xc(od.a.click,this.bib,this.Xhi),this.bib=null);Je.a.xD(this.jja);this.jja=null;super.dispose()}}Object(u.a)(Mc,"DirectPrintDialog",Ag.StandardDialog,[556]);class Aa{constructor(b){this.Xm=b}iqm(b,h,r=null){return new Mc(this.Xm,b,h,r)}}Object(u.a)(Aa,"DirectPrintDialogFactory",
null,[546]);class jb{constructor(b,h){this._url=b;this.HHk=h}Mgi(){this.HHk?rd.a.wYl(this._url):rd.a.Tm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(jb,"OpenUrlInTabDialogDownloadBehavior",null,[564,10]);class lc extends Ag.StandardDialog{constructor(b,h=!0,r=!1,A=null,L=null,Z=!1,oa=null){super();this.$6b=this.Z6b=this.fy=this.E5=null;this.qVn=Tb=>{this.Bli(Tb);return!0};this.rVn=Tb=>this.Bad(Tb,this.Bli);this.Bli=Tb=>{this.fy&&this.fy.submit();
this.zOb(Tb.Df)};this.Era=Tb=>{1===Tb?(this.Ybd(),this.fy?lc.NN&&this.xyj():this.bQe.Mgi()):2===Tb&&(this.ede?this.j8h():this.pde&&this.r_l());this.dispose()};var Ba=this.pHg?this.pHg:CommonUIStrings.l_DefaultDialogTitle;lc.Ilc=Z;this.Tpk=oa;this.bQe=A||new jb(b,!0);const gb=[],Ab=[];lc.NN&&(this.BRd&&this.BRd.forEach(Tb=>{Array.add(gb,Tb)}),this.kQh&&this.kQh.forEach(Tb=>{Array.add(Ab,Tb)}));h?r?this.ede?(this.Bd=12,this.Ke(1,this.buttonText),this.Ke(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),
this.Ke(3,CommonUIStrings.l_DialogClose)):this.pde?(this.Bd=12,this.Ke(1,this.buttonText),this.Ke(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Ke(3,CommonUIStrings.l_DialogClose)):(this.Bd=4,this.Ke(1,this.buttonText),this.Ke(2,CommonUIStrings.l_DialogClose)):(this.Bd=6,this.Ke(0,CommonUIStrings.l_DialogClose)):this.Bd=5;Z=document.createElement("span");this.VXc&&(Z.className=this.VXc);A=document.createElement("a");A.innerText=this.nqc;A.href=b;A.target="_blank";A.id=this.wbd;A.className=
Qf.AFrame.Igf;if(oa=!aa.a.y7&&!aa.a.Z3i&&!!L&&0<L.count){const Tb=Ma.a.ALf(b,L);L=Ma.a.arg(b,L);A.href="#";A.target="_self";this.fy=document.createElement("form");this.fy.id="printPreviewPostForm1";this.fy.method="post";this.fy.target="_blank";this.fy.action=L;for(var Jb of Tb)L=document.createElement("input"),L.type="hidden",L.name=Jb.key,L.value=Jb.value,this.fy.appendChild(L)}else this.fy=null;this.fy||lc.Ilc?lc.Ilc||Array.add(Ab,{["type"]:"AppLinkProps",["id"]:this.wbd,["text"]:this.nqc,["onExecute"]:()=>
{this.xyj()}}):Array.add(Ab,{["type"]:"AppLinkProps",["id"]:this.wbd,["text"]:this.nqc,["handler"]:{["href"]:oa?"#":b,["target"]:oa?"_self":"_blank"}});this.rbb&&Array.add(gb,this.rbb);r?(b=document.createElement("span"),b.innerText=this.rbb.replace("{0}",""),Z.appendChild(b)):this.Jdj?(b=document.createElement("span"),b.id=this.Bj("message"),Jb=document.createElement("span"),L=document.createElement("span"),oa=this.rbb.split("{0}"),Jb.innerText=oa[0],L.innerText=oa[1],b.appendChild(Jb),b.appendChild(A),
b.appendChild(L),Z.appendChild(b)):(b=document.createElement("span"),b.innerText=this.rbb,Z.appendChild(b),Z.appendChild(document.createElement("br")),Z.appendChild(document.createElement("br")),Z.appendChild(A),lc.Ilc||Array.add(gb,"{0}"));this.fy&&Z.appendChild(this.fy);lc.NN&&(this.yub&&(this.fbd?this.VMh(this.yub,this.fbd):(Array.add(gb,"{0}"),Array.add(Ab,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.yub,["onExecute"]:()=>{}}))),this.vQd(gb,Ab));this.bvb(Ba,null,this.NSf,null,
this.Era,lc.NN?null:Z);this.x8(this.Bj("message"));!lc.NN&&this.fbd&&this.yub&&(Ba=document.createElement("div"),Ba.className="WACDialogLearnMoreLinkContainer",this.E5=document.createElement("a"),this.E5.innerText=this.yub,this.E5.href=this.fbd,this.E5.target="_blank",this.E5.id=this.Bj("LearnMoreLinkId"),this.E5.className=Qf.AFrame.Igf,Ba.appendChild(this.E5),h?this.Oc.insertBefore(Ba,this.Oc.lastChild):this.Oc.appendChild(Ba),this.x8(String.format("{0} {1}",this.Bj("message"),this.Bj("LearnMoreLinkId"))));
this.HGc=A;r?this.e4(this.jJ):this.e4(this.HGc);this.Nhe();y.AFrameworkApplication.ua.S8.ub(od.a.click,this.HGc,Object(D.a)(this,this.Whi,"downloadLinkClicked"),null);this.E5&&y.AFrameworkApplication.ua.S8.ub(od.a.click,this.E5,Object(D.a)(this,this.k6i,"learnMoreLinkClicked"),null);this.XY=!1}get NSf(){return null}get pHg(){return null}get rbb(){return null}get HZh(){return this.Tpk}get fbd(){return null}get yub(){return null}get Jdj(){return!1}get buttonText(){return CommonUIStrings.l_Open}get VXc(){return null}get BRd(){return null}get kQh(){return null}get ede(){return!1}get pde(){return!1}j8h(){this.Daa({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}r_l(){this.Daa({SourceControlId:"Share"},{ControlId:"Share"})}Daa(b,h){const r=y.AFrameworkApplication.va;r.gE=8;r.Qb(Za.a.Daa,2,b,h)}Lqa(){this.fy&&(this.Z6b||(this.Z6b=this.qVn,this.rr.ub(od.a.click,this.jJ,this.Z6b)),this.$6b||(this.$6b=this.rVn,this.oe.ub(od.a.gi,this.jJ,this.$6b)));super.Lqa()}Ybd(){}Whi(){this.h5f();this.fy?this.fy.submit():this.bQe.Mgi();return!0}k6i(){return!1}dispose(){this.bQe.dispose();this.HGc&&(y.AFrameworkApplication.ua.S8.xc(od.a.click,this.HGc,
Object(D.a)(this,this.Whi,"downloadLinkClicked")),this.HGc=null);this.E5&&(y.AFrameworkApplication.ua.S8.xc(od.a.click,this.E5,Object(D.a)(this,this.k6i,"learnMoreLinkClicked")),this.E5=null);this.rr&&this.Z6b&&(this.rr.xc(od.a.click,this.jJ,this.Z6b),this.Z6b=null);this.oe&&this.$6b&&(this.oe.xc(od.a.gi,this.jJ,this.$6b),this.$6b=null);super.dispose()}xyj(){this.fy&&(document.body.appendChild(this.fy),this.fy.submit(),document.body.removeChild(this.fy))}static get NN(){return y.AFrameworkApplication.ua.Gb.kH&&
y.AFrameworkApplication.ua.Gb.P0i}static get Ilc(){return lc.Ukh}static set Ilc(b){lc.Ukh=b}}lc.Ukh=!1;Object(u.a)(lc,"ADialogWithLinkToResource",Ag.StandardDialog,[]);class Nc extends lc{constructor(b,h,r=null,A=!0,L=!1,Z=null){super(b,!0,!(Nc.OAb&&A),new jb(b,h),r,L,Z);Nc.OAb=Nc.OAb&&A;if(Nc.OAb){h=document.createElement("iframe");A=null;L=this.kfi;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){Z=Ma.a.ALf(b,r);b=Ma.a.arg(b,r);A=document.createElement("form");A.id="printPreviewPostForm";
A.method="POST";A.target=h.name;A.action=b;for(const oa of Z)b=document.createElement("input"),b.type="hidden",b.name=oa.key,b.value=oa.value,A.appendChild(b)}else h.src=b;L.appendChild(h);A&&(L.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");$c.a.Is(h,$c.a.wA,$c.a.mq)}}get NSf(){return"Print_32x32x32"}get pHg(){return Nc.OAb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get rbb(){return Nc.OAb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get BRd(){const b=
[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(lc.Ilc){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==y.AFrameworkApplication.ua.Gb.cci&&(h=y.AFrameworkApplication.ua.Gb.cci);Array.add(b,h)}return Nc.OAb?b:null}get nqc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get wbd(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get VXc(){return y.AFrameworkApplication.t7a?"UIFontDialogTextLarge":null}Nhe(){v.ULS.sendTraceTag(7690390,
324,50,"Legacy print dialog displayed")}h5f(){y.AFrameworkApplication.Bn.c$a(9540);v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Ybd(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get OAb(){return!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.kH&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(aa.a.y7||aa.a.As||aa.a.nj||aa.a.QR)&&!y.AFrameworkApplication.iad&&y.AFrameworkApplication.J.$("ShouldHostDefaultToNativeBrowserPrintExperience")&&
Nc.wJh}static set OAb(b){Nc.wJh=b}}Nc.wJh=!1;Object(u.a)(Nc,"PrintDialogWithLinkToPdf",lc,[]);class qd{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.zqn=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.Jmn=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.Z0b=(b.DirectPrintSupportedMimeTypes||"").split(qd.Awf);this.xzb=(b.DirectPrintSupportedPlugins||"").split(qd.Awf);this.j5m=(b.DirectPrintImmersivePreviewPlugins||"").split(qd.Awf);this.gXi=
Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.Hgn=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.Mql=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.i8f=14;this.Tdj=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.i8f=parseInt(h[0]),this.Tdj=parseInt(h[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else v.ULS.sendTraceTag(20734113,208,
15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}qd.Awf=",";Object(u.a)(qd,"DirectPrintBrsSettings",null,[]);class Rd{constructor(b,h){this.REg=b;this.xzb=h}}Object(u.a)(Rd,"DirectPrintProbeResults",null,[]);var Me=d(182);class df{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.nPd=null;this.bHm=()=>{var Jb=this.SMm();const Tb=this.wmo(),jc={},Hc={};for(let hd=0;hd<this.bU.Z0b.length;hd++)jc[this.bU.Z0b[hd]]=Jb[hd];for(Jb=0;Jb<this.bU.xzb.length;Jb++)Hc[this.bU.xzb[Jb]]=
Tb[Jb];return new Rd(jc,Hc)};this.ztk=b;this.RLc=h;this.s0e=r;this.cBk=A;this.nCk=L;this.NNc=new rg.a(this.bHm);this.lGc=Z;this.Rsh=gb;this.rW=oa;this.SJc=Ba;this.JCk=Ab}get bU(){return this.ztk}start(){}Eho(){this.bU.zqn&&this.DGn()}vmo(){const b=Array(this.bU.Z0b.length);if(void 0!==this.RLc&&null!==this.RLc)for(let h=0;h<this.bU.Z0b.length;h++)b[h]=this.bU.Z0b[h]in this.RLc&&this.cBk(this.RLc[this.bU.Z0b[h]]);return b}wmo(){const b=Array(this.bU.xzb.length),h=!(void 0===this.s0e||null===this.s0e);
for(let r=0;r<this.bU.xzb.length;r++){const A=this.bU.xzb[r];b[r]=h&&A in this.s0e?!0:this.nCk(A)}return b}SMm(){const b=this.vmo(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.D5l(this.RLc[this.bU.Z0b[r]]):null;return h}D5l(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}DGn(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.NNc.value.REg,this.NNc.value.xzb)}N6o(){return this.JCk||!this.bU.isEnabled||y.AFrameworkApplication.iad?
!1:this.tgp()}T6o(){if(null!=this.nPd)return this.nPd;const b=df.fXi(this.bU);return this.nPd=this.bU.gXi&&b||this.Fgn()}Fgn(){return aa.a.Nr&&this.bU.Hgn&&aa.a.Lql>=this.bU.Mql?!0:!1}tgp(){if(!this.SJc(this.bU))return!1;var b=mb.a.E9a(this.NNc.value.REg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=mb.a.E9a(this.NNc.value.xzb);for(const h of b)if(h)return!0;return!1}jZm(){const b=mb.a.E9a(this.NNc.value.REg);for(const h of b)if(Me.a.contains(this.bU.j5m,h))return!0;return!1}t9o(b,h=null){y.AFrameworkApplication.ua&&
y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.Rsh(b,h):this.N6o()?this.TVl(b,this.jZm()&&!0,h):this.Rsh(b,h)}TVl(b,h,r=null){const A=this.rW.Xf("UserAction","OpenDirectPrintDialog");this.lGc.iqm(b,h,r).jJa();A.stop()}static ytn(b){try{return new ActiveXObject(b),!0}catch(h){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static Jjn(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=
new qd(y.AFrameworkApplication.J.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(Ab){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let A=null;try{A=window.navigator.plugins}catch(Ab){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const L=df.Jjn,Z=df.ytn;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const oa=y.AFrameworkApplication.ua.Vr,Ba=df.ztn,gb=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.kH&&
!y.AFrameworkApplication.J.$("PrintDialogFallbackLinkEnabled");return new df(h,r,A,L,Z,b,oa,Ba,(Ab,Jb)=>new Nc(Ab,!1,Jb,!0,gb),y.AFrameworkApplication.Tfa)}static ztn(b){return aa.a.Nr||aa.a.As&&b.Jmn||b.gXi&&df.fXi(b)?!0:!1}static fXi(b){var h=aa.a.Ygc;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.i8f||h===b.i8f&&r>=b.Tdj}return!1}}Object(u.a)(df,"DirectPrintManager",null,[513]);class Cf{constructor(){this.mDb=this.Z=null}get name(){return"Common.App.DirectPrint"}wc(b){this.Z=
b;b.register(Aa,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().Ud(()=>new Aa(y.AFrameworkApplication.ua.S8));b.register(513,"Common.App.DirectPrint.IDirectPrintManager").ha().Ud(()=>df.create(this.Z))}init(){this.mDb=this.Z.resolve("Common.App.DirectPrint.IDirectPrintManager");this.mDb.start()}dispose(){}}Object(u.a)(Cf,"PackageManager",null,[0,1]);class sg{constructor(b,h=3E4){this.GHg=9E5;this.IHg=1E4;this.Taj=this.Wqc=null;this.t6f=0;this.tob=Date.now;this.aPm=b;this.Veb=h;this.v4d()}CIi(b=
!0){const h=this.tob();if(h<this.t6f+this.GHg)return h>this.t6f+this.IHg&&this.v4d(),this.Taj;b&&this.v4d();return null}getToken(b=!0){return(b=this.CIi(b))?Promise.resolve(b):this.v4d()}v4d(){return this.Wqc=this.Wqc||new Promise(b=>{this.aPm().then(h=>{this.Wqc=null;""!==h&&h&&(this.Taj=h,this.t6f=this.tob(),b(h));b(null)}).catch(()=>{this.Wqc=null;b(null)});window.setTimeout(()=>{this.Wqc=null;b(null)},this.Veb)})}}Object(u.a)(sg,"OAuthCacheManager",null,[]);var lg=d(122),Ia=d(302);class Zb{constructor(){this.Cba=
null;this.tgh={};this.c0a=new Pa.a(Ja.a.vh())}getToken(b,h){if(this.c0a.tb(h))return this.c0a.K(h).getToken();const r=new sg(()=>this.DIi(b,h));this.c0a.W(h,r);return r.getToken()}$Om(b,h){if(this.c0a.tb(h))return this.c0a.K(h).CIi();const r=new sg(()=>this.DIi(b,h));this.c0a.W(h,r);return null}DIi(b,h){if(!this.Cba)try{this.Cba=Wa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){v.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.Cba?new Promise(r=>
{const A=Date.now();this.Cba.tV(b,h).then(L=>{const Z=L.Token;!L.IsSuccess||this.wun(Z)?(this.pwc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,L.ErrorCode,L.ErrorMessage,h),r(null)):(this.pwc("GetTokenInternalImplicitJS",!0,Date.now()-A,b,L.ErrorCode,L.ErrorMessage,h),r(Z))}).catch(L=>{L=L?H.c(L):"";this.pwc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,"Caught Exception",L,h);r(null)})}):new Promise(r=>{this.pwc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}pwc(b,
h,r,A,L="",Z="",oa=""){var Ba="Search"===A;const gb=[];b=lg.a.Naa(Ba?"Event":"EventName",b,2);A=lg.a.Naa("AppName",A,2);Array.add(gb,b);Array.add(gb,A);Ba&&(A=lg.a.Naa("LatencyType","FetchToken",2),Array.add(gb,A));L&&""!==L&&(L=lg.a.Naa("ErrorCode",L,2),Array.add(gb,L));Z&&""!==Z&&(Z=lg.a.Naa("ErrorMessage",Z,2),Array.add(gb,Z));oa&&""!==oa&&(Z=!(oa in this.tgh),this.tgh[oa]=Z,Z=lg.a.Naa("WarmUpCall",Z.toString(),1),Array.add(gb,Z),oa=lg.a.Naa("Service",this.NKm(oa),2),Array.add(gb,oa));Ba=Ba?"Office.TellMe.TellMeWAC.Latency":
"Office.Insights.SmartLookup.Authentication";h=Object.assign(new Ia.a,{name:Ba,samplingPolicy:2,dataFields:gb,succeeded:h,durationMs:r});Y.a.sendActivityEvent(h)}NKm(b){return b===y.AFrameworkApplication.c6f?"Loki":b===y.AFrameworkApplication.HEg?"Substrate":y.AFrameworkApplication.J&&b===y.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}wun(b){return!b||!b.length}}Object(u.a)(Zb,"SearchOAuthManager",null,[463]);class Qc{constructor(){this.Z=null}get name(){return"Common.App.SearchOAuthManager"}wc(b){this.Z=
b;this.Z.register(463,"Common.App.SearchCommon.ISearchOAuthManager").ha().Ud(()=>new Zb)}init(){}dispose(){}static main(){E.a.instance.Mc(new Qc)}}Object(u.a)(Qc,"SearchOAuthPackage",null,[0,1]);var ed=d(131),Pd=d(224),hb=d(6),Id=d(130),he=d(37),Cd=d(7);class Wg{constructor(b,h,r){this.g1e=this.KHb=this.d1e=this.JHb=this.kZe=null;this.BVm=A=>{try{this.AVm(A)}catch(L){A=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",L.message,L.stack),v.ULS.sendTraceTag(5285580,
334,10,A)}};this.Qp=b;this.luk=h;this.ib=r;this.init()}init(){this.luk.ub(this.BVm);this.JHb=new re.a;this.d1e=new re.a;this.KHb=new re.a;this.g1e=new Pd.a}dY(b){this.JHb.add(b.key,b)}aZb(b){this.KHb.add(b.key,b)}AVm(b){let h;const r=this.ib.gb.currentSelection;({guf:h}=Wg.Qqp(r)).returnValue&&(b=Wg.Nnm(b,this.kZe,h),this.Zho(b,h,r),this.kZe=h)}Zho(b,h,r){b=this.$gm(b,h,r);let A;({notification:A}=Wg.Fqp(b)).returnValue&&this.Qp.sendNotification(A,!1)}$gm(b,h,r){const A=new re.a;A.W(1,new Pd.a);A.W(0,
new Pd.a);b.forEach(L=>{3===L?(Wg.SAg(h.node)||this.BGo(h,r),this.HEm(A,h)):L||this.lom(A,h);return!0});return A}BGo(b,h){this.JHb.forEach((r,A)=>{A.reset(b,h);return!0})}lom(b,h){let r=new re.a;Wg.SAg(h.node)||(r=this.jom(h.cpBegin));this.kom(b,this.d1e,r,Wg.$Kj(this.kZe,h));this.d1e=r}jom(b){const h=new re.a;this.JHb.forEach((r,A)=>{r=null;({JG:r}=A.rEa(b)).returnValue&&h.W(A.key,r);return!0});return h}kom(b,h,r,A){const L=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((Z,oa)=>
{const Ba=this.JHb.K(Z).Fv||oa.title;let gb;({value:gb}=r.Ec(Z)).returnValue?A&&gb.contentObject!==oa.contentObject&&(Ba&&b.K(1).add(Ba),Z=this.JHb.K(Z).Fv,Z=String.format(L,gb.title,Z),gb.description&&(Z+=", "+gb.description),b.K(0).add(Z)):Ba&&b.K(1).add(Ba);return!0});r.forEach((Z,oa)=>{h.tb(Z)||(Z=this.JHb.K(Z).Fv,Z=String.format(L,oa.title,Z),oa.description&&(Z+=", "+oa.description),b.K(0).add(Z));return!0})}HEm(b,h){h=this.mMm(h.node);h=this.Eul(h);this.nMm(b,this.g1e,h);this.g1e=h}mMm(b){const h=
new hb.a;h.set(b);if(!h.zb(1))return null;const r=new Pd.a;for(;1!==h.uf;)this.KHb.forEach((A,L)=>{let Z;({Iea:Z}=L.X1b(h)).returnValue&&r.add(Z);return!0}),h.uc();r.reverse();return r}Eul(b){b=b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.dG===b[h+1].dG&&(this.KHb.K(r.dG),({Iul:r}={returnValue:!1,Iul:null}).returnValue)){b.splice(h,2,r);continue}h++}return new Pd.a(b)}nMm(b,h,r){var A;for(A=0;A<Math.min(r.length,h.length)&&r.K(A).contentId.equals(h.K(A).contentId);A++){var L=this.KHb.K(r.K(A).dG).Gqb(r.K(A),
h.K(A));L&&(r.K(A).description&&(L+=", "+r.K(A).description),b.K(0).add(L))}for(L=A;L<r.length;L++){let Z=this.KHb.K(r.K(L).dG).Gqb(r.K(L),null);Z&&(r.K(L).description&&(Z+=", "+r.K(L).description),b.K(0).add(Z))}for(r=A;r<h.length;r++)(A=this.KHb.K(h.K(r).dG).Fv)&&b.K(1).add(A)}static Nnm(b,h,r){const A=new Pd.a;(b=b||Wg.iPo(h,r))?(A.add(3),A.add(0)):Wg.$Kj(h,r)&&A.add(0);return A}static iPo(b,h){return!b||!b.node.id.equals(h.node.id)}static $Kj(b,h){return!b||!b.equals(h)}static Qqp(b){let h=null;
if(!b||!(he.a.ym(b)||(b=he.a.vk(b,!0,!1),he.a.ym(b)||b.Qa&&Wg.SAg(b.Qa.node))))return{returnValue:!1,guf:h};h=b.Qa;return{returnValue:!!h,guf:h}}static Fqp(b){const h=new Pd.a;b.K(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.K(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static SAg(b){return Id.a.Eq(b)||
Cd.ParagraphReader.hza(b)}}Object(u.a)(Wg,"AccessibilityContextManager",null,[459]);class cd{constructor(b,h){this.Uph=!1;this.aPc=null;this.MLd=this.dPd=!1;this.Pfh=null;this.HRd=(r,A)=>{(A.hQ||A.Xua)&&this.BTn(A.hQ,A.Xua)};this.Jb=b;this.RY=h}get d_m(){return!!this.aPc}ub(b){this.Uph||(this.RY.hPh(this.HRd),this.Uph=!0);this.Pfh=b}BTn(b,h){this.d_m&&this.Jb.wf(this.aPc);this.dPd=this.dPd||b;this.MLd=this.MLd||h;this.aPc=new mf.a(5,1,cd.s3l,()=>{this.Pfh(this.dPd,this.MLd);this.reset()},126);this.Jb.$b(this.aPc)}reset(){this.aPc=
null;this.MLd=this.dPd=!1}}cd.s3l=100;Object(u.a)(cd,"EditingViewOnAfterValidateEventsConsolidator",null,[458]);var If=d(50);class Rf{constructor(){this.Z=null}get name(){return"Box4.Accessibility"}init(){ed.a.gUh&&this.Z.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}wc(b){this.Z=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new cd(y.AFrameworkApplication.pc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();
b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new Wg(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),If.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){E.a.instance.Mc(new Rf)}}Object(u.a)(Rf,"Box4AccessibilityPackage",null,[0,1]);var ih=d(195),mh=d(1063),Wk=d(1642),na=d(912),db=d(238),Ob=d(1471),Sb=d(36),qc=d(21),Ic=d(102),xc=d(26),vb=d(3);class Qd extends Ob.a{get qBa(){return null!=
this.gZg?this.gZg:this.gZg=Wa.a.instance.Oa("Box4.IInternalLinkManager")}get Rtj(){return null!=this.y2g?this.y2g:this.y2g=Wa.a.instance.Oa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get sE(){return!0}get commandId(){return vb.a.nbl}Ira(b){db.a.mark(7012);const h=new Sb.GraphTransaction(15);h.Ab(b);var r=this.EI,A=this.t3,L=Cd.ParagraphReader.text(b),Z=L.substring(r,A);const oa=({Vag:Ba}=F.a.pEg(Z)).returnValue;Z!==oa&&(r+=Ba,A=r+oa.length);Z=xc.a.createTextRange(b,r,A);var Ba=L.substring(r,
A);Qd.Dmn(L,r,A)&&(this.Rd.We(xc.a.createTextRange(b,r-1,A+1),Ba,!0,!1),--r,--A,Z=xc.a.createTextRange(b,r,A),r=qc.SelectionFactory.ue(b,A),If.a.instance.Kc(r));r=Ic.a.oKa(Ba);Qd.Op.wF(Z,r,!1);L=Ba="";A=!1;this.qBa&&({sqg:Ba,v8a:L}=this.qBa.JIg(r)).returnValue&&(r=Ba,A=!0,Ba=Ic.a.Oz(Z,!1),Qd.Op.fV(Ba[0].paragraph,Ba[0].hyperlink),""!==L&&(this.Rd.We(Z,L,!0,!1),Z=xc.a.createTextRange(b,this.EI,this.EI+L.length),b=qc.SelectionFactory.ue(b,this.EI+this.EI+L.length),If.a.instance.Kc(b)),Qd.Op.wF(Z,r,
!1));h.dispose();!A&&this.Rtj&&this.Rtj.Neo(Z,r);db.a.mark(7013)}set sE(b){super.sE=b}static get Op(){return null!=Qd.hXg?Qd.hXg:Qd.hXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static Dmn(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(u.a)(Qd,"HyperlinkAction",Ob.a,[]);class Ze{constructor(b){this.Rd=b}HGl(b,h,r){return new Qd(null,b,h,r,this.Rd)}}Object(u.a)(Ze,"HyperlinkActionFactory",null,[456]);var Be=
d(254);class Ve{constructor(){this.Z=null}get name(){return"Box4.AutoCorrect"}wc(b){this.Z=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new Wk.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),Be.a.instance,y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new mh.a(b.resolve("Box4.IRoamingServiceRequestManager"),
y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new na.a(b.resolve("Box4.IAutoCorrectRules"),If.a.instance,ih.a.instance,y.AFrameworkApplication.J,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",
()=>new Ze(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.Z.resolve("Box4.IAutoCorrectRules").IBn();const b=y.AFrameworkApplication.J;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.Z.resolve("Box4.IAutoCorrectOptionsInfo").Iim()}dispose(){}static main(){E.a.instance.Mc(new Ve)}}Object(u.a)(Ve,"Box4AutoCorrectPackage",null,[0,1]);class Pe{get name(){return"Box4.Clipboard"}init(){}dispose(){}wc(){}static main(){E.a.instance.Mc(new Pe)}}
Object(u.a)(Pe,"Box4ClipboardPackage",null,[0,1]);class Lf{get name(){return"Box4.ImageEditors"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Lf)}}Object(u.a)(Lf,"Box4ImageEditorsPackage",null,[0,1]);var pe=d(625),Zh=d(894),Te=d(688),Gi=d(659),fe=d(1124);class Fe{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,r,A,L){const Z=new Fe;Z.DocumentId=L;Z.UserId=r;Z.WACSessionId=A;Z.Revision=b;Z.ChangeStateList=fe.a.WLj(h);return Z}}Object(u.a)(Fe,"LocalUnsavedChange",
null,[]);class mg{constructor(){this.zhe=null}CEe(b){return new Promise((h,r)=>{this.v9h().then(A=>{const L=A.transaction(mg.Pbd,"readwrite");L.objectStore(mg.Pbd).put(b);L.oncomplete=()=>h();L.onerror=()=>r(L.error.message)}).catch(r)})}wVd(b,h,r){return new Promise((A,L)=>{this.v9h().then(Z=>{const oa=Z.transaction(mg.Pbd,"readwrite");oa.objectStore(mg.Pbd).delete([b,h,r]);oa.oncomplete=()=>A();oa.onerror=()=>L(oa.error.message)}).catch(L)})}static isSupported(){return"indexedDB"in window}v9h(){return new Promise((b,
h)=>{if(mg.isSupported())if(this.zhe)b(this.zhe);else{var r=window.indexedDB.open(mg.TCn,mg.UCn);r.onsuccess=()=>{this.zhe=r.result;b(r.result)};r.onerror=()=>{h(r.error.message)};r.onupgradeneeded=()=>{const A=r.result,L=A.createObjectStore(mg.Pbd,{keyPath:["DocumentId","UserId","WACSessionId"]});L.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});L.createIndex("UserId",["UserId"],{unique:!1});this.zhe=A;b(A)}}else h("This browser does not support IndexedDB.")})}}mg.TCn="LocalUnsavedChangeDatabase";
mg.UCn=1;mg.Pbd="LocalUnsavedChange";Object(u.a)(mg,"LocalUnsavedChangeStore",null,[]);class bj{constructor(b,h,r,A,L,Z){this.w9i=b;this.ndb=h;this.ICm=r;this.h3c=A;this.eol=L;this.zDa=Z}initialize(){const b=Zh.a.qMf(this.ICm());this.TYd=this.YXc=b;this.zDa.$1k(this.onj.bind(this));this.zDa.a2k(this.pnj.bind(this))}dispose(){this.zDa.rCo(this.onj.bind(this));this.zDa.sCo(this.pnj.bind(this))}onj(b,h){this.Nyp(h.cB)}pnj(b,h){this.Avp(h.cB)}Avp(b){b.equals(this.YXc)||(this.YXc=b,b.equals(this.TYd)?
this.wVd():this.CEe())}Nyp(b){b.equals(this.TYd)||(this.TYd=b,b.equals(this.YXc)?this.wVd():this.CEe())}AHl(){const b=Object(Gi.b)({cB:this.TYd,sm:this.YXc,fileId:this.h3c().Bq,Tga:this.h3c().Tga,contextId:this.h3c().contextId,M1d:this.YXc.id,ndb:this.ndb,Dde:Te.a.bTb(this.h3c()),Tae:!1,cellId:this.h3c().ud.id},!1);return Fe.construct(b,this.eol.C2c(),bj.userId,bj.sessionId,bj.documentId)}CEe(){const b=this.AHl();this.w9i.CEe(b).then(()=>{v.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",
b.Revision.Id)}).catch(h=>{v.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}wVd(){this.w9i.wVd(bj.documentId,bj.userId,bj.sessionId).then(()=>{v.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{v.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return mg.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=
bj.dUg?bj.dUg:bj.dUg=y.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=bj.B6g?bj.B6g:bj.B6g=y.AFrameworkApplication.J.jb("LoggableUserId")}static get sessionId(){return null!=bj.o3g?bj.o3g:bj.o3g=y.AFrameworkApplication.J.jb("SessionId")}}Object(u.a)(bj,"LocalUnsavedChangeManager",null,[451]);class Jh{get name(){return"Box4.LocalUnsavedChange"}init(){this.RWi()&&bj.isSupported()&&(this.R4f=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),
this.R4f.initialize())}dispose(){this.R4f&&this.R4f.dispose()}wc(b){this.container=b;if(this.RWi()){b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new mg).ha();var h=(r,A,L)=>new pe.a(r,A,L);b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new bj(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>ab.StaticActiveAppFrame.za().kb.hd.ud,()=>ab.StaticActiveAppFrame.za().kb.hd,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){E.a.instance.Mc(new Jh)}RWi(){return y.AFrameworkApplication.J.$("DisconnectedScenarioIsEnabled")}}
Object(u.a)(Jh,"LocalUnsavedChangePackage",null,[0,1]);class Gh{get name(){return"Box4.NotebookLevelEditors"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Gh)}}Object(u.a)(Gh,"Box4NotebookLevelEditorsPackage",null,[0,1]);var cj=d(1489);class Uj{get name(){return"Box4.Search"}wc(b){b.ia("Box4.Search.FindManagerHelper",()=>cj.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(u.a)(Uj,"PackageManager",null,[0,1]);class Xk{get name(){return"Box4.TableEditors"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Xk)}}
Object(u.a)(Xk,"Box4TableEditorsPackage",null,[0,1]);class Lk{get name(){return"Box4.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Lk)}}Object(u.a)(Lk,"Box4TextLevelEditorsPackage",null,[0,1]);var ii=d(128),lj=d(344),Od=d(157),Nj=d(432),yh=d(314);class Th{constructor(b,h,r){this.qx=this.tQa=this.DSa=null;this.mG=this.tOe=this.iFa=0;this.qpa=this.tEd=this.q2a=this.p2a=!1;this.gDd=this.Wlh=this.$lh=0;this.ZFa=b;this.ga=h;this.St=r}MR(b){return!ab.StaticActiveAppFrame.za().kb.isEditingAllowed||
cc.SessionStatusManager.instance.Jk?!1:""!==this.i3c(b.Df)}zN(b){if(!this.MR(b))return!1;this.WVo(b);this.mG=this.ZFa.wjc();this.TYo(b);this.UYo();({Unc:this.tEd,ppc:this.qpa}=this.kPj(this.tOe));this.VYo();this.DSa=b.jK;this.qx=new Sys.UI.Point(0,0);[this.$lh,this.Wlh]=this.ZFa.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}OX(b){this.tQa=b.jK;this.wjl();this.gDd=yh.d(this.qx.x,this.qx.y,this.$lh,this.Wlh,this.tEd,this.qpa,this.gDd,y.AFrameworkApplication.J.$("SmoothImageHelperGetScaleIsEnabled"));
this.ZFa.XKg(this.gDd,this.tEd,this.qpa);return!0}YF(){this.setSize();v.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}s0(){this.ZFa.xtg();v.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}WVo(b){this.ZFa=ii.a.Eb(b.Df,Nj.a)}UYo(){this.tOe=(Math.floor((this.mG+22)/45)%8+this.iFa)%8}kPj(b){let h,r;if(this.mG&&90!==this.mG&&180!==this.mG&&270!==this.mG&&360!==this.mG||this.Gmn(b))return{Unc:!0,ppc:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{Unc:r,
ppc:h}}VYo(){this.q2a=this.p2a=!1;switch(this.tOe){case 0:this.q2a=this.p2a=!0;break;case 1:case 2:this.q2a=!0;break;case 7:case 6:this.p2a=!0}}Gmn(b){return!(b%2)}i3c(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}TYo(b){switch(this.i3c(b.Df)){case "WACImageResizeHandleNW":this.iFa=
0;break;case "WACImageResizeHandleN":this.iFa=1;break;case "WACImageResizeHandleNE":this.iFa=2;break;case "WACImageResizeHandleE":this.iFa=3;break;case "WACImageResizeHandleSE":this.iFa=4;break;case "WACImageResizeHandleS":this.iFa=5;break;case "WACImageResizeHandleSW":this.iFa=6;break;case "WACImageResizeHandleW":this.iFa=7}}wjl(){var b=1;this.St.instance&&(b=this.St.instance.nl);const h=(this.tQa.x-this.DSa.x)/b;b=(this.tQa.y-this.DSa.y)/b;this.qx.x=this.p2a?-h:h;this.qx.y=this.q2a?-b:b}setSize(){const b=
new lj.DictionaryPropertySet;b.setValue(Od.a.Z6c,100*this.gDd);b.setValue(Od.a.KPi,!0);if(90===this.mG||270===this.mG){let h,r;({Unc:h,ppc:r}=this.kPj(this.iFa));b.setValue(Od.a.iTf,h);b.setValue(Od.a.jTf,r)}else b.setValue(Od.a.iTf,this.tEd),b.setValue(Od.a.jTf,this.qpa);b.setValue(Od.a.DPi,this.iFa);this.ga.Qb(vb.a.kmc,2,b)}}Object(u.a)(Th,"ImageResizeDragAdapter",null,[191]);var Tf=d(136),pp=d(652);class jk{constructor(b,h,r,A){this.SUe=this.tQa=this.DSa=this.gLd=null;this.mId=this.JPd=0;this.Db=
null;this.ga=b;this.ib=h;this.St=r;this.eth=this.NGa=0;this.qd=A}MR(b){return ab.StaticActiveAppFrame.za().kb.isEditingAllowed&&!cc.SessionStatusManager.instance.Jk&&b&&this.Grn(b.Df)?(this.gLd=this.ib.Pg)?!0:!1:!1}l3d(){}rMf(){return null}zN(b){if(!this.MR(b))return!1;this.ZFa=ii.a.Eb(b.Df,Nj.a);if(!this.ZFa)return!1;this.ELd=this.ZFa.pca;if(!this.ELd)return!1;this.gLd=this.ib.Pg;this.Db=Id.a.Mn(this.gLd);if(!this.Db)return!1;this.DSa=this.jVa(b);this.SUe=Sys.UI.DomElement.getBounds(this.ELd);this.JPd=
0<Id.a.u6d(this.Db)?Id.a.u6d(this.Db):0;this.mId=Id.a.BJf(this.Db);return!0}OX(b){this.tQa=this.jVa(b);this.Djl();if(this.ZFa)return this.ZFa.NEe(this.NGa,this.eth),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}YF(){this.JPd=this.NGa=yh.e(this.NGa);this.B8()}s0(){this.ZFa.NEe(this.mId,0)}Grn(b){return b.classList.contains(pp.c)||b.classList.contains(pp.b)||b.classList.contains(pp.a)||!!b.parentElement&&b.parentElement.classList.contains(pp.a)}jVa(b){return this.qd.Gd.F8a(b)}Djl(){var b=
1;this.St&&this.St.instance&&(b=this.St.instance.nl);var h=new Sys.UI.Point(this.SUe.x+this.ELd.clientWidth/2*b,this.SUe.y+this.ELd.clientHeight/2*b);b=yh.a(this.DSa,h);h=yh.a(this.tQa,h);this.NGa=Math.round(Tf.a.ano(h-b));0<this.JPd&&(this.NGa+=this.JPd-this.mId);this.eth=this.NGa;this.NGa+=this.mId}B8(){const b=new lj.DictionaryPropertySet;b.setValue(Od.a.W6c,0);b.setValue(Od.a.pX,this.NGa);this.ga.Qb(vb.a.$aa,2,b)}}Object(u.a)(jk,"ImageRotateDragAdapterSimplified",null,[449,191]);class lm{constructor(){this.Z=
null}get name(){return"Box4.Images"}wc(b){this.Z=b;this.Z.ia("Box4.Images.ImageResizeDragAdapter",()=>new Th(null,y.AFrameworkApplication.va,Wa.a.instance.Ta("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.Z.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new jk(y.AFrameworkApplication.va,If.a.instance,Wa.a.instance.Ta("Common.IZoomManager"),Object(Kb.a)())).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.Z.resolve("Box4.Images.IImageResizeDragAdapter");
this.Z.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){E.a.instance.Mc(new lm)}}Object(u.a)(lm,"Box4ImagesPackage",null,[0,1]);var ce=d(68),Ge=d(103),Vc=d(5),Ii=d(456),Wj=d(470),hn=d(590),Cm=d(263),Cl=d(250),Uk=d(1803),Ml=d(1706),jo=d(1178);class tl extends Ml.a{constructor(b,h,r){super(b,h,r);this.kJd=this.xlb=null}get mV(){return y.AFrameworkApplication.ua.Vr}P5d(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}vFe(b){return tl.coa(b,this.pJi())}pJi(){return tl.wbf}coa(b,h=null){b=this.vFe(b);return 0!==b?(h&&h.GQd(),2===b&&(h=this.P5d(b),this.qq(this.lxi(b),h)),!1):!0}dAa(b,h){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Agg=h;db.a.mark(5576);this.kJd=this.mV.Xf("LoadResource","PictureUploadTime");this.Fbe()?this.Ykd(b):this.Qsc()}qq(b,h){const r=new Ag.StandardDialog;r.Bd=0;r.Iy(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}Qsc(){v.ULS.sendTraceTag(36783361,
322,50,"PictureUploader.OnUploadComplete");super.Qsc();this.kJd&&(this.kJd.stop(),this.kJd=null)}leb(){this.xlb=(new jo.a).create();this.xlb.message=CommonUIStrings.l_ImageUploadWait;this.xlb.Bd=5;this.xlb.Au=!1;this.xlb.aM(null,null,null)}Eec(){this.xlb&&(this.xlb.close(),this.xlb=null)}static s_m(b,h){b=F.a.xh(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static coa(b,h=null){h||(h=tl.wbf);return b?tl.s_m(b,h)?0:2:1}}tl.wbf=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(u.a)(tl,"PictureUploader",Ml.a,[]);var fl=d(507),Uh;(function(b){b[b.sFe=0]="validPicture";b[b.aed=1]="noPictureSpecified";b[b.GTi=2]="invalidExtension";b[b.Bpe=3]="pictureTooLarge"})(Uh||(Uh={}));Object(u.b)("PictureValidationResult",Uh);var nh=d(54),Ke=d(13),cg=d(39),ub=d(1008);class ec{constructor(){this.pR=null}}Object(u.a)(ec,"ImageData",null,[]);var Tc=d(141),bd=d(191),le=d(44),tf=d(299),pf=d(66),rf=d(872),Hg=d(1595),Fh=d(1651);class Ef extends Dg.a{constructor(b,h=!0){super(!1,!1,Ef.NN);
this.a$b=null;this.Ehh=!1;this.Ez=[];this.Vq=null;this.HZn=r=>{this.QMk&&(this.Vq=this.mQj(r,this.zlb))};this.y5n=()=>{this.Vq&&this.Vq.pR&&(this.Ehh||(this.Vq.qwo(this.Wdg),this.Ehh=!0),this.Vq.oni())};this.Wdg=r=>{this.a$b.uploadStatusLabel=r;this.d9(this.titleText,Object(D.a)(this,this.wbe,"insertDialogHandler"),this.a$b)};this.Bgg=()=>{this.Hvj()};this.onKeyDown=r=>{4!==Sg.FocusManager.instance().Nvj(r)&&r.preventDefault()};this.zlb=b;this.QMk=h;this.vda=this.RGh=!1;this.e5a=null;this.IRe=!1;
this.mh=this.ETl;this.Ig="InsertFileDialog";this.Ke(1,this.$Pd);Ef.NN?(this.a$b={["id"]:this.Ig,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:this.y5n}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.HZn},this.Uh(this.titleText,Object(D.a)(this,this.wbe,"insertDialogHandler"),this.a$b),this.XY=!0):(this.showDialog(this.titleText,Object(D.a)(this,this.wbe,"insertDialogHandler")),h&&this.h0o(),(b=this.H4d(1))&&this.Ez.push(b),
(b=this.H4d(0))&&this.Ez.push(b),this.$7j(),this.XY=!1)}get V9j(){return this.zlb}validate(){this.Vq.pR||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Vq.pR.value?!0:(Ef.Iy(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}wbe(b){1===b&&this.isEnabled()?Ef.NN&&this.Vq.pR&&!this.Vq.pR.value?(this.a$b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.d9(this.titleText,Object(D.a)(this,this.wbe,"insertDialogHandler"),this.a$b)):(this.T$d(),this.zlb.dAa(this.Vq,
Object(D.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}h0o(){this.IRe=!1;this.Vq=this.mQj(document.getElementById("uploadFrameContainer"),this.zlb);y.AFrameworkApplication.J.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.e5a=this.Bgg,zc.a.addHandler(this.Vq.UJ,"load",this.e5a));this.Vq.pR||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.Hvj()}Hvj(){if(this.Vq&&!this.IRe){var b=this.Vq.pR;b&&(zc.a.addHandler(b,od.a.ij,this.onKeyDown),b=[b],this.Ez=b.concat.apply(b,
this.Ez),this.$7j(),this.IRe=!0)}}dispose(){if(this.Vq&&!Ef.NN){const b=this.Vq.pR;b&&zc.a.removeHandler(b,od.a.ij,this.onKeyDown);this.e5a&&zc.a.removeHandler(this.Vq.UJ,"load",this.e5a)}this.Vq=null;super.dispose()}$7j(){if(0<this.Ez.length){const b=new km(this.Ez),h=Sg.FocusManager.instance().$t();h&&(this.Ez[0].focus(),h.Uk=b,h.rP=!0)}}static get NN(){return y.AFrameworkApplication.ua.Gb.kH&&y.AFrameworkApplication.ua.Gb.R0i}static Iy(b){const h=document.getElementById("errorText");h.innerText=
b;h.style.display="inline-block"}}Object(u.a)(Ef,"InsertFileDialog",Dg.a,[]);class Bc{static get mh(){return Dg.a.uy(Bc.lo,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Bc.lo="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(u.a)(Bc,"InsertImageDialogHtml",
null,[]);class Qm extends Ef{constructor(b,h=!0){super(b,h)}get $Pd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get ETl(){return Bc.mh}validate(){this.Vq.pR||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Ca.a)(tl,this.V9j);const h=b.vFe(this.Vq.pR.value);return 0!==h?(b=b.P5d(h),Ef.Iy(b),!1):!0}}Object(u.a)(Qm,"InsertImageDialog",Ef,[]);class mm extends Qm{constructor(b){super(b)}mQj(b,h){const r=
y.AFrameworkApplication.ua.Gb.kH&&y.AFrameworkApplication.ua.Gb.R0i;return new Fh.a(b,Object(D.a)(h,h.jwb,"onUploadFrameInitialized"),Object(D.a)(h,h.aoa,"uploadResponseReceived"),y.AFrameworkApplication.J,!r)}isEnabled(){return mm.HR.fka(this.V9j.context)}static get HR(){return null!=mm.sXg?mm.sXg:mm.sXg=Wa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(u.a)(mm,"Box4InsertImageDialog",Qm,[]);class Eg{iBl(b){return new Promise((h,r)=>{this.jBl(b).then(A=>{h(A)},A=>{r(A)})})}t7h(b){return new Promise((h,
r)=>{const A=new FileReader;A.addEventListener("load",()=>{h(A.result)},!1);A.addEventListener("error",()=>{r("FileReader exception ("+A.error.name+")")});A.readAsDataURL(b)})}jBl(b){return new Promise((h,r)=>{this.t7h(b).then(A=>{this.hrf(A,"image/jpeg").then(L=>{h(L)},L=>{r(L)})},A=>{r(A)})})}hrf(b,h){return new Promise((r,A)=>{const L=new Image;L.addEventListener("load",()=>{const Z=document.createElement("canvas"),oa=Z.getContext("2d");Z.width=L.width;Z.height=L.height;oa.drawImage(L,0,0);r(Z.toDataURL(h))});
L.addEventListener("error",()=>{A("Image failed to load")});L.src=b})}}Object(u.a)(Eg,"ImageFormatConverter",null,[]);var Xh=d(233),rq=d(1059);const on=["ImageInsertFailed"];class Dl extends tl{constructor(b,h,r,A,L,Z,oa,Ba=!0){var gb;super(b,h,r);this.Jo=oa;this.WFa=this.Fm=this.iJ=this.Tf=null;this.g2d="wwpicturesfc";this.kpiName="ImageFileExtension";this.gKc="LocalDeviceUpload";this.L7=new Map;this.uni=0;this.ylb=null;this.GRe="";this.Lwa=0;this.Qp=null;this.ZIc="";this.euh=50;this.ejh=this.jHc=
this.UPc=this.kMc=!1;this.yEk=19922944;this.kwh=0;this.KRe=[];this.Dhh=[];this.lwh=0;this.O1n=()=>{bd.a.kV&&this.Jo.XL([25],this.Yd)};this.wfg=Ab=>{v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Ab){var Jb={},Tb=this.iJ?this.iJ.properties.sc.toString():this.Tf.sc.toString();Jb[Wj.a.nodeId]=this.iJ?this.iJ.id.toString():this.Tf.id.toString();Jb[Wj.a.classId]=Tb;this.Nf.hasProperty(Vc.a.imageType)&&(Jb[Ii.a.imageType]=this.Nf.getValue(Vc.a.imageType));this.Nf.hasProperty(Vc.a.oX)&&
(Jb[Ii.a.oX]=this.Nf.getValue(Vc.a.oX));this.Nf.hasProperty(Ge.a.Mka)&&(Jb[Ii.a.Mka]=this.Nf.getValue(Ge.a.Mka));this.Nf.hasProperty(Vc.a.Mub)&&(Jb[Ii.a.Mub]=this.Nf.getValue(Vc.a.Mub));Hg.d(Ab,this.Tf,this.Fm,Jb)&&(this.xqd(Ab),Dl.Rrc++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.oZn=Ab=>{if(!this.NUf){var Jb=this.Ixi(this.Vq);Jb&&(this.GRe=Jb.name,this.Lwa=Jb.size);if(!this.coa(Ab,this.Vq)||!this.jMg(Jb,this.Vq)){Jb=Object.assign(new Na.a,{extendedProperties:new Map});
Jb.extendedProperties.set("type",this.coa(Ab,this.Vq)?"Image too large":"FileType invalid");this.The(Jb);this.Ohe();return}}this.dAa(this.Vq,null)};this.Nf=A;this.En=L;this.ga=Z;this.Yd=bd.a.pq||bd.a.kV?fl.a.getInstance(Tc.a):fl.a.getInstance(Xh.a);this.gth=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.wuh=r.jc("ImageUploadMaxByteSize",Number.MAX_VALUE);Ba&&this.showDialog();null===(gb=tf.a.A9a())||void 0===gb?void 0:gb.addHandler(this);rq.a.Rpg(this.O1n)}get jZi(){return this.J.$("JfifImageInsertIsEnabled")}get UR(){return this.gKc}get fileExtension(){return this.GRe}get fileSize(){return this.Lwa}get U9j(){return this.ylb}get Iw(){return this.Qp||
(this.Qp=Wa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get NUf(){return this.UR===this.gKc}showDialog(){Hg.a(this.J)?(this.Iob=!1,this.Vq=new Fh.a(document.body,Object(D.a)(this,this.jwb,"onUploadFrameInitialized"),Object(D.a)(this,this.aoa,"uploadResponseReceived"),this.J,!1,void 0,!0)):Hg.b()||this.mvb&&aa.a.OF?(this.Iob=!1,this.Vq=new Fh.a(document.body,Object(D.a)(this,this.jwb,"onUploadFrameInitialized"),Object(D.a)(this,this.aoa,"uploadResponseReceived"),this.J,!1)):(this.Iob=!0,this.Vq=
(new mm(this)).Vq)}lxi(b){switch(b){case Uh.aed:return le.a.aed;case Uh.GTi:return le.a.ybn;case Uh.Bpe:return le.a.I4f}return Sj.a.unknown}Ykd(b){this.NUf||(this.Tf.Hj()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),rf.a.instance.xLg(this.Tf.Hj()),this.Tf.Hj().Ag.nE(this.wfg,Object(D.a)(this,this.ZXb,"processFailure"),b)):this.ZXb(b,157))}jqn(){return Hg.c(this.Tf)}xqd(b){b.xqd();this.ylb=b.ylb}aoa(b){this.uni=+new Date-+this.U9j;this.Ohe();v.ULS.sendTraceTag(36783364,
322,50,"Box4PictureUploader.UploadResponseReceived");Hg.e(this,b,this.Tf)}uLg(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.Qsc();Dl.Rrc--;this.ga.Ob(Za.a.wfb,2);this.Tf?rf.a.instance.UAc(this.Tf.Hj(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Iw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}ZXb(b,h){var r;if(this.eJo(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",
this.retryCount,h.toLocaleString());else{b=Object.assign(new Na.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());bd.a.pq?this.Yd.logKpiFailure({kpiName:Tc.d.sKa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(yh.c)(Tc.d.plc,b,null,!1)}):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.Yd.logKpiFailure({kpiName:Xh.c.IKa,
errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Xh.c.imc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):xa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",on,!1,!0,!1,!1,b);r=this.zAf(h);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Tf.SJ();var A=
new Sb.GraphTransaction(15,vb.a.sX);A.Ab(this.Tf);Dl.HR.g_a(this.Nf,r);Dl.HR.KCj(this.Tf,this.iJ);Id.a.fOj(this.Nf,ub.a.TB);A.dispose();this.AUj(r);this.En.Aec(b,!1);this.Qsc();Dl.Rrc--;rf.a.instance.UAc(this.Tf.Hj(),h)}}AUj(b){const h=new Ag.StandardDialog;h.Bd=0;h.Iy(le.a.ITi,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}zAf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}jgk(){if(this.ZIc&&0<this.ZIc.length){const b=
new lj.DictionaryPropertySet;b.setValue(Od.a.XX,this.ZIc);b.setValue(Od.a.Vfa,!0);this.ga.Qb(vb.a.s6,2,b)}this.$7o()}$7o(){let b="";this.ejh?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.kMc&&this.jHc&&this.UPc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.kMc&&this.jHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.kMc&&this.UPc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.UPc&&this.jHc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.UPc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.jHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.kMc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.AUj(b),this.khk())}A_k(b){this.ZIc+=String.format('<img src="{0}"></img>',b);this.lwh++}tFn(){this.UPc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Na.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Image too large");this.The(b)}sFn(){this.jHc=!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Na.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.The(b)}f$i(b){this.ejh=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}kdp(b){const h=new Eg;if(this.vFe(b.name)===Uh.sFe)return h.t7h(b);if(tl.coa(b.name,Fh.a.xbf)===Uh.sFe)return h.iBl(b)}tBl(b){return new Promise(h=>
{const r=this.kdp(b);void 0===r&&(this.f$i("Failed starting conversion work"),h());r.then(A=>{A.length>this.yEk?this.tFn():this.A_k(A);h()},A=>{this.f$i(A);h()})})}hvn(b){return this.vFe(b.name)===Uh.sFe||tl.coa(b.name,Fh.a.xbf)===Uh.sFe}Kan(){const b=[];if(this.Vq.pR.files){this.kwh=this.Vq.pR.files.length;this.Vq.pR.files.length>this.euh&&(this.kMc=!0);this.leb();for(let h=0;h<this.Vq.pR.files.length&&this.euh;h++){const r=this.Vq.pR.files[h];this.KRe.push(r.name);this.Dhh.push(r.size);r&&(this.hvn(r)?
b.push(this.tBl(r)):this.sFn())}}Promise.all(b).then(()=>{this.Eec();this.jgk()});return!0}Abn(){this.Fm=eb.a.create();this.Nf||(this.Nf=new lj.DictionaryPropertySet);this.gth&&this.WFa&&this.Nf.setValue(Ge.a.s9i,this.WFa);var b=480;let h=320;const r=this.context.view.Hi.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.Nf.setValue(Ge.a.Mka,r));this.Nf.setValue(Ke.a.zta,nh.a.hn(b,0));this.Nf.setValue(Ke.a.yta,nh.a.hn(h,1));this.Nf.setValue(cg.a.U_,ub.a.ZOa);this.Nf.setValue(Od.a.Vfa,
!0);this.Nf.setValue(Vc.a.Mub,Box4Intl.Box4Strings.l_Picture);b=Dl.HR.Pgi(this.context,this.Nf,this.Fm);if(!b)return!1;this.Tf=b.node;this.Nf=(this.iJ=b.blob)?this.iJ.properties:this.Tf.properties;pf.a.xd().xm&&pf.a.xd().Bk.IG(this.Tf);return!0}Fbe(){return this.NUf?this.Kan():this.Abn()}khk(){this.L7.set("FileExtensions",this.Xmm());this.L7.set("FileSizeInBytes",this.Dhh.toString());this.L7.set("Source",this.UR);this.L7.set("NumberOfImagesAttemptedToInsert",this.kwh.toString());this.L7.set("NumberOfImagesPasted",
this.lwh.toString());if(bd.a.pq){this.L7.set("ErrorLevel","warning");var b=Object.assign(new Na.a,{extendedProperties:this.L7});this.Yd.logKpiFailure({kpiName:Tc.d.sKa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})}else(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.L7.set("ErrorLevel","warning"),b=Object.assign(new Na.a,{extendedProperties:this.L7}),this.Yd.logKpiFailure({kpiName:Xh.c.IKa,errorName:"MultipleImageInsertFailed",
optionalProperties:{additionalValues:b}})):xa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.g2d,this.L7)}Xmm(){let b="";for(let h=0;h<this.KRe.length;++h)b=b+this.Hxi(this.KRe[h])+",";return b}dAa(b,h){bd.a.kV&&this.Jo.cY([25]);this.gth&&(this.WFa=new ec,this.WFa.pR=b.pR);super.dAa(b,h)}jwb(b){this.Vq=b;if(!this.Iob){if(this.rtd){if(Hg.a(this.J)||this.mvb&&aa.a.OF){b.qZc(this.oZn);return}const h=b.qZc(null),r=this.Ixi(b);r&&(this.GRe=r.name,this.Lwa=r.size);if(!this.coa(h,b)||!this.jMg(r,
b)){b=Object.assign(new Na.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.coa(h,this.Vq)?"Image too large":"FileType invalid");this.The(b);this.Ohe();return}}this.dAa(b,null)}}F$d(){return!!Dl.Rrc}Ohe(){var b;this.L7.set("FileExtension",this.Hxi(this.fileExtension));this.L7.set("Source",this.UR);this.L7.set("FileSizeInBytes",this.fileSize.toString());this.L7.set("RequestTimeInMs",this.uni.toString());bd.a.pq?this.Yd.logKpiUsage({kpiName:Tc.d.sKa,kpiType:0,optionalProperties:{extendedProperties:this.L7}}):
(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.Yd.logKpiUsage({kpiName:Xh.c.IKa,kpiType:0,optionalProperties:{extendedProperties:this.L7}}):xa.Health.instance.recordKpiUsage(this.kpiName,0,this.g2d,this.L7)}Hxi(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}pJi(){return this.jZi?Fh.a.PJh:tl.wbf}Ixi(b){return(b=b.pR)?b.files[0]:null}jMg(b,h){return b&&b.size>this.wuh?(h&&h.GQd(),b=this.P5d(Uh.Bpe),this.qq(this.lxi(Uh.Bpe),
b),!1):!0}P5d(b){switch(b){case Uh.aed:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Uh.GTi:return this.jZi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Uh.Bpe:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.wuh/1E6));default:return""}}The(b){var h;bd.a.pq?(b.extendedProperties.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:Tc.d.sKa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:b},optionalVeto:Object(yh.c)(Tc.d.plc,b)})):(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Xh.c.imc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:Xh.c.IKa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):
xa.Health.instance.recordQosError("PictureFromLocalInvalid",on,!0,!0,!1,!1,b)}static get HR(){return null!=Dl.rXg?Dl.rXg:Dl.rXg=Wa.a.instance.resolve("Box4.Images.IImageEditor")}}Dl.Rrc=0;Object(u.a)(Dl,"Box4PictureUploader",tl,[554,392]);var Zm=d(854),tj=d(147);class qj{constructor(){this.Dw=this.ks=this.qHb=this.GHh=this.h4b=this.Aqk=null;this.L5e=0;this.Cwa=this.T0e=this.DHb=null;this.kch=0;this.oKe=this.Axa=this.GYe=null;this.ynh=!1;this.yJe=this.tJe=this.zJe=null}get assetId(){return this.h4b}get thumbnailUrl(){return this.GHh}get previewUrl(){return this.qHb}get displayName(){return this.Cwa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.ks,this.Dw)}get y3k(){if(this.tJe&&this.yJe&&this.zJe){const b=document.createElement("a");b.setAttribute("href",this.zJe);b.setAttribute("target","_blank");b.innerText=this.yJe;return b}return null}get jQh(){return this.tJe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.kch)}get Doo(){const b=document.createElement("span");var h=0;if(this.DHb&&0<this.DHb.length){var r=this.DHb.indexOf("."),A=0>r?this.DHb:this.DHb.substring(0,r);for(A=Number.parseInvariant(A);h<
A&&5>h;h++)b.appendChild(Pb.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",tj.a.Aj("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.DHb.substr(r+1)),3>r?b.appendChild(Pb.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",tj.a.Aj("box42.png"),"","",!0,"")):8>r?b.appendChild(Pb.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",tj.a.Aj("box42.png"),"","",!0,"")):b.appendChild(Pb.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",tj.a.Aj("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Pb.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",tj.a.Aj("box42.png"),"","",!0,""));this.T0e&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.T0e),b.appendChild(h));return b}get IHo(){return 0<this.L5e?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.L5e):""}get $al(){if(this.ynh){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.oKe&&this.Axa)return qj.qHl(this.oKe,this.Axa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.GYe){const h=this.GYe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static iem(b){const h=new qj;for(let r=0;r<b.childNodes.length;r++){const A=b.childNodes[r];if(1===A.nodeType)try{const L=A.firstChild.nodeValue;switch(A.nodeName){case "src":h.Aqk=L;break;case "assetid":h.h4b=
L;break;case "thumb":"64x64"===A.attributes.getNamedItem("size").nodeValue?h.GHh=qj.$2j(L):"192x192"===A.attributes.getNamedItem("size").nodeValue&&(h.qHb=qj.$2j(L));break;case "imagedim":if(L){const oa=L.indexOf("x");0<oa&&oa<L.length&&(h.ks=L.substr(0,oa),h.Dw=L.substr(oa+1))}break;case "resolution":h.L5e=Number.parseInvariant(L);break;case "rating":h.DHb=L;break;case "numofratings":h.T0e=L;break;case "displayname":h.Cwa=L;break;case "contentlength":h.kch=Number.parseInvariant(L)/1024;break;case "subject":h.GYe=
L;break;case "provider":h.Axa=L;break;case "attributionlink":h.oKe=L;break;case "iscsc":h.ynh=1===Number.parseInvariant(L);break;case "additional":const Z=A.firstChild;if(A.hasChildNodes()&&Z&&"id"===Z.nodeName&&1===Number.parseInvariant(Z.text))for(let oa=0;oa<A.childNodes.length;oa++){const Ba=A.childNodes[oa];switch(Ba.nodeName){case "caption":h.tJe=Ba.text;break;case "value":h.zJe=Ba.text;break;case "string":h.yJe=Ba.text}}}}catch(L){}}return h}static qHl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static $2j(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(u.a)(qj,"ClipArtSearchResult",null,[]);class Fk{static get mh(){return Dg.a.uy(Fk.lo,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Fk.lo="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(u.a)(Fk,"InsertClipartDialogHtml",null,[]);class Jq extends Dg.a{constructor(b){super();this.UFa=this.BEb=0;this.Vzh=null;this.V3e=!1;this.P9b=this.S3a=this.BQ=null;this.Hnj=h=>{const r=this.FZ.value;r&&0<r.trim().length&&(this.search(this.FZ.value),this.$ua(1,!1));h.preventDefault();h.stopPropagation()};this.N3n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.Hnj(h),h.preventDefault(),h.stopPropagation())};this.Inj=h=>{100<=this.FZ.value.length&&(h.preventDefault(),h.stopPropagation())};
this.j2n=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.Uuj(h);this.Yxg(h)};this.u0=()=>{if(this.Qs&&this.Qs.children&&!(2>this.Qs.children.length)){var h=this.Qs.children[0].children[0],r=this.Qs.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Qs.scrollTop,A=h.clientHeight+2,L=parseInt(String(this.Qs.scrollTop/A));h=parseInt(String(r/A));var Z=parseInt(String(this.Qs.clientWidth/A));h<r/A&&h<parseInt(String(this.BQ.length/Z))&&h++;for(r=L;r<h;r++)for(A=0;A<Z;A++){var oa=
r*Z+A;L=this.BQ[oa];(oa=document.getElementById("clip"+oa))&&!oa.childNodes.length&&(L=this.cbi(L),oa.appendChild(L))}}};this.R4n=h=>{h.target.setAttribute("src",tj.a.Aj("phthumb.64x64x32.png"))};this.k2n=h=>{h.target.setAttribute("src",tj.a.Aj("phpreview.96x96x32.png"))};this.Tkj=h=>{rd.a.Tm(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.q_n=h=>{(h?h.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.Tkj(h)};this.mlj=h=>{const r=h.target.innerText;this.FZ&&(this.FZ.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.$ua(1,!1)};this.Y_n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.mlj(h)};this.Knj=h=>{this.BQ&&(this.WNo(this.BQ[this.BEb]),h.stopPropagation(),h.preventDefault(),this.FZ.value="",this.$ua(1,!1))};this.O3n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.Knj(h)};this.onKeyDown=h=>{if(h.keyCode>=Sys.UI.Key.left&&
h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.UFa=this.UFa+r<this.Qs.children.length-1?0>this.UFa+r?0:this.UFa+r:this.Qs.children.length-1;this.Yxg(this.UFa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Qs.children.length&&this.HKj(h)):h.keyCode===Sys.UI.Key.tab&&(this.UFa=h.shiftKey?
Math.max(0,this.UFa-1):Math.min(this.UFa+1,this.Qs.children.length-1))};this.onError=()=>{this.Qs&&(this.Qs.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.ewj=h=>{if(this.Qs)if(h.data.ina){var r=h.data.ina.lastChild.childNodes;this.BQ||(this.BQ=[]);for(h=0;h<r.length&&100>this.BQ.length;h++){var A=r[h];1===A.nodeType&&"image"===A.nodeName&&(A=qj.iem(A),this.BQ.push(A))}this.xgi();this.BQ.length||(this.Qs.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.Pe){h=F.a.DYj(h.data.Pe);
try{r=parseInt(h)}catch(L){r=14}this.Qs.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.xgi=()=>{if(this.BQ){Je.a.KT(this.Qs);this.S3a&&(this.S3a.dispose(),this.S3a=null);this.Qs.focus();this.Qs.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.BQ.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const A=document.createElement("span");A.id="clip"+r;A.classList.add("ClipartImageContainer");
h.appendChild(A);this.Qs.appendChild(h);r<parseInt(String(this.Qs.clientHeight/A.clientHeight))*parseInt(String(this.Qs.clientWidth/A.clientWidth))&&(h=this.cbi(this.BQ[r]),A.appendChild(h))}this.V3e&&(this.HKj(this.BEb),this.Yxg(this.BEb))}};this.X$m=h=>{1===h&&this.BQ&&Jq.HR.fka(this.ibh.context)&&(h=this.BQ[this.BEb])&&this.ibh.cEa(h)};this.ibh=b;this.mh=Fk.mh;this.Ig="InsertClipartDialog";this.Ke(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.X$m);this.Qs=document.getElementById("clipartsearchresults");this.zLd=this.onKeyDown;zc.a.addHandler(this.Qs,"keydown",this.zLd);this.yLd=this.u0;zc.a.addHandler(this.Qs,"scroll",this.yLd);this.FZ=document.getElementById("textInput");this.XNd=this.N3n;zc.a.addHandler(this.FZ,"keydown",this.XNd);this.YNd=this.Inj;zc.a.addHandler(this.FZ,"keypress",this.YNd);this.ZNd=this.Inj;zc.a.addHandler(this.FZ,"paste",this.ZNd);this.XDc=document.getElementById("btnSearch");this.XDc.setAttribute("src",tj.a.Aj("search.16x16x32.png"));
this.xLd=this.Hnj;zc.a.addHandler(this.XDc,"click",this.xLd);this.d6b=document.getElementById("clipartpreviewimage");this.GPe=document.getElementById("clipartattributedisplayname");this.Lhb=document.getElementById("clipartseesimilar");this.FPe=document.getElementById("clipartdimensions");this.yGc=document.getElementById("clipartadditionalvalue");this.HPe=document.getElementById("clipartratingvalue");this.W1a=document.getElementById("clipartattributionvalue");this.X1a=document.getElementById("clipartkeywords");
this.DPe=document.getElementById("clipartadditionalname");this.IPe=document.getElementById("clipartratingname");this.EPe=document.getElementById("clipartattributionname");this.X3e=this.j2n;this.C$e=this.R4n;this.NCd=this.Tkj;this.OCd=this.q_n;this.EYe=this.mlj;this.FYe=this.Y_n;this.BLd=this.Knj;this.CLd=this.O3n;this.FZ.focus();this.$ua(1,!1)}dispose(){this.Qs&&this.i2h();this.Qs&&this.zLd&&(zc.a.removeHandler(this.Qs,"keydown",this.zLd),this.zLd=null);this.Qs&&this.yLd&&(zc.a.removeHandler(this.Qs,
"scroll",this.yLd),this.yLd=null);this.Qs=null;this.FZ&&this.XNd&&(zc.a.removeHandler(this.FZ,"keydown",this.XNd),this.XNd=null);this.FZ&&this.YNd&&(zc.a.removeHandler(this.FZ,"keypress",this.YNd),this.YNd=null);this.FZ&&this.ZNd&&(zc.a.removeHandler(this.FZ,"paste",this.ZNd),this.ZNd=null);this.FZ=null;this.XDc&&this.xLd&&(zc.a.removeHandler(this.XDc,"click",this.xLd),this.XDc=this.xLd=null);this.EPe=this.IPe=this.DPe=this.X1a=this.W1a=this.HPe=this.yGc=this.FPe=this.Lhb=this.GPe=this.d6b=this.CLd=
this.BLd=this.FYe=this.EYe=this.OCd=this.NCd=this.P9b=this.C$e=this.X3e=null;this.S3a&&(this.S3a.dispose(),this.S3a=null);super.dispose()}JN(){super.JN();document.getElementById(this.Bj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.l_b(b,!1,this.ewj)}l_b(b,h,r){this.UFa=this.BEb=0;this.i2h();if(this.BQ&&b===this.Vzh&&this.V3e===h)window.setTimeout(this.xgi,500);else{this.BQ&&(Array.clear(this.BQ),this.BQ=null);this.Vzh=b;this.V3e=h;var A=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');
A.append("<query>");A.append(F.a.yf(b));A.append("</query>");A.append("<mediatype>Illustration</mediatype>");A.append("<mediatype>Photo</mediatype>");A.append("<filetype>jpg</filetype>");A.append("<filetype>jpeg</filetype>");A.append("<filetype>gif</filetype>");A.append("<filetype>bmp</filetype>");A.append("<filetype>tif</filetype>");A.append("<filetype>tiff</filetype>");A.append("<filetype>png</filetype>");A.append("</search>");b=y.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let L=
b.length;4>L;L++)b="0"+b;y.AFrameworkApplication.Fe.Xj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",ed.a.webServiceBase,b,Ii.a.K$o,h.toString()),2,A.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}WNo(b){this.l_b(b.assetId,!0,this.ewj);this.BQ||(this.BQ=[],this.BQ.push(b))}cbi(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;
h.setAttribute("title",b);h.setAttribute("alt",b);zc.a.addHandler(h,"click",this.X3e);zc.a.addHandler(h,"error",this.C$e);return h}sRl(b){1===b.childNodes.length&&(b=b.childNodes[0],zc.a.removeHandler(b,"click",this.X3e),zc.a.removeHandler(b,"error",this.C$e))}Uuj(b){const h=this.BQ[b];var r=h.previewUrl;this.g2h();this.P9b=this.k2n;var A=document.createElement("img");A.setAttribute("src",r);if(h.displayName)r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=
new Sys.StringBuilder;for(let L=0;L<h.keywords.length&&5>L;L++)L&&r.append(", "),r.append(h.keywords[L]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}A.setAttribute("title",r);A.setAttribute("alt",r);zc.a.addHandler(A,"error",this.P9b);this.d6b.appendChild(A);A=document.getElementById("clip"+this.BEb);A.classList.remove("ClipartSelectedImage");A=document.getElementById("clip"+b);A.classList.add("ClipartSelectedImage");this.BEb=b;h.displayName&&(this.GPe.innerText=
h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');zc.a.addHandler(b,"click",this.BLd);zc.a.addHandler(b,"keydown",this.CLd);this.Lhb.appendChild(b);this.FPe.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.IHo,h.fileSize);(b=h.y3k)&&h.jQh?(this.yGc.parentNode.style.display="block",this.DPe.innerText=h.jQh,this.yGc.appendChild(b)):this.yGc.parentNode.style.display="none";this.HPe.appendChild(h.Doo);Je.a.KT(this.W1a);
if(b=h.$al)this.W1a.appendChild(b),"a"===b.nodeName.toLowerCase()&&(zc.a.addHandler(b,"click",this.NCd),zc.a.addHandler(b,"keydown",this.OCd));this.X1a.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)A=h.keywords[b],r=document.createElement("a"),r.innerText=A,r.setAttribute("href",'""'),zc.a.addHandler(r,"click",this.EYe),zc.a.addHandler(r,"keydown",this.FYe),this.X1a.appendChild(r),b<h.keywords.length-1&&(A=document.createElement("span"),A.innerText=", ",this.X1a.appendChild(A));
this.IPe.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.EPe.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.$ua(1,!0)}g2h(){this.d6b&&1===this.d6b.childNodes.length&&(this.P9b&&(zc.a.removeHandler(this.d6b.childNodes[0],"error",this.P9b),this.P9b=null),Je.a.KT(this.d6b));this.W1a&&0<this.W1a.childNodes.length&&"a"===this.W1a.childNodes[0].nodeName.toLowerCase()&&(this.NCd&&zc.a.removeHandler(this.W1a.childNodes[0],"click",this.NCd),this.OCd&&zc.a.removeHandler(this.W1a.childNodes[0],
"keydown",this.OCd));this.Lhb&&0<this.Lhb.children.length&&"a"===this.Lhb.children[0].nodeName.toLowerCase()&&(this.BLd&&zc.a.removeHandler(this.Lhb.children[0],"click",this.BLd),this.CLd&&zc.a.removeHandler(this.Lhb.children[0],"keydown",this.CLd),Je.a.KT(this.Lhb));if(this.X1a){for(let b=0;b<this.X1a.childNodes.length;b++){const h=this.X1a.childNodes[b];"a"===h.nodeName.toLowerCase()&&(zc.a.removeHandler(h,"click",this.EYe),zc.a.removeHandler(h,"keydown",this.FYe))}Je.a.KT(this.X1a)}this.GPe.innerText=
"";this.FPe.innerText="";Je.a.KT(this.yGc);Je.a.KT(this.HPe);Je.a.KT(this.W1a);this.X1a.innerText="";this.DPe.innerText="";this.IPe.innerText="";this.EPe.innerText=""}HKj(b){if(!(this.Qs.children.length<=b||0>b)){var h=this.Qs.children[b],r=this.Qs.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.Qs.scrollTop+this.Qs.clientHeight<h.offsetTop+h.clientHeight?this.Qs.scrollTop=h.offsetTop-3*h.clientHeight-r:this.Qs.scrollTop>h.offsetTop&&(this.Qs.scrollTop=h.offsetTop-r/2);this.Uuj(b)}}validate(){return!0}i2h(){if(Sg.FocusManager.lM()){var b=
Sg.FocusManager.instance().getRegion(this.aN);b&&b.Uk.iA(this.FZ)}else this.FZ.focus();for(b=0;b<this.Qs.childNodes.length;b++){const h=this.Qs.childNodes[b];1===h.childNodes.length&&this.sRl(h.childNodes[0])}Je.a.KT(this.Qs);this.g2h();this.$ua(1,!1);this.S3a=new Zm.a(Box4Intl.Box4Strings.l_ClipartSearching);this.S3a.T1i=!1;this.Qs.appendChild(this.S3a.element);this.Qs.classList.add("ClipartSearchInProgress")}Yxg(b){this.UFa=b;b=this.Qs.children[this.UFa];Sg.FocusManager.lM()?Sg.FocusManager.instance().getRegion(this.aN).Uk.iA(b):
b.focus()}static get HR(){return Jq.Dk=Jq.Dk||Wa.a.instance.resolve("Box4.Images.IImageEditor")}}Jq.Dk=null;Object(u.a)(Jq,"InsertClipartDialog",Dg.a,[]);class Zr extends Dl{constructor(b,h,r,A,L,Z,oa){super(b,h,r,A,L,Z,oa,!1);this.R1n=Ba=>{if(this.jqn()){var gb=this.Tf.Hj(),Ab=gb.Ag.Pr.toString(),Jb=new Sys.Net.WebRequest;Jb.set_url("ClipArtUpload.ashx");Jb=new Sys.StringBuilder(Jb.getResolvedUrl());this.OZ(Jb,Ii.a.assetId,Ba.assetId,!0);this.OZ(Jb,Wj.a.lcid,y.AFrameworkApplication.lcid.toString());
this.OZ(Jb,Wj.a.nodeId,this.iJ?this.iJ.id.toString():this.Tf.id.toString());this.OZ(Jb,Wj.a.cellId,gb.il.toString());this.OZ(Jb,Wj.a.fileId,gb.Bq);this.OZ(Jb,Wj.a.Jya,Ab);this.OZ(Jb,Wj.a.h_,this.Fm.toString());Ba=this.Tf.ka(Ge.a.ZJ,Cl.a.Gu);this.OZ(Jb,Wj.a.ZJ,Ba.toString());this.OZ(Jb,Wj.a.ZAb,"1");gb.$G&&this.OZ(Jb,Wj.a.$G,gb.$G);this.OZ(Jb,Wj.a.classId,this.iJ?this.iJ.properties.sc.toString():this.Tf.sc.toString());this.Nf.hasProperty(Vc.a.imageType)&&this.OZ(Jb,Ii.a.imageType,this.Nf.getValue(Vc.a.imageType).toString());
Cm.a.instance.J_k(Jb);y.AFrameworkApplication.Fe.Xj(Jb.toString(),2,"",{},!1,2,this.lCp,this.R9j,null);Dl.Rrc++}};this.lCp=Ba=>{if(({group:gb}=hn.a.D4(Ba.data.Pe)).returnValue){var gb=gb.Responses[0];gb.sxb=Ba.data.jH;gb.Lm=Ba.data.wi?Ba.data.wi[ce.a.q2]:"";this.aoa(gb)}else this.R9j(null)};this.R9j=()=>{const Ba=new Uk.a;Ba.StatusCode=14;this.aoa(Ba)};new Jq(this)}cEa(b){this.Fbe()&&this.Tf.Hj().Ag.nE(this.R1n,null,b)}OZ(b,h,r,A){b.append(A?"?":"&");b.append(F.a.$i(h));b.append("=");b.append(F.a.$i(r))}zAf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;
case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.zAf(b)}}aoa(b){super.aoa(b);Dl.Rrc--}}Object(u.a)(Zr,"ClipartUploader",Dl,[]);var kc=d(11),ck=d(419);class pn{constructor(b,h,r){this.Y$m=(A,L,Z,oa,Ba)=>{if(!this.Dk||!this.Dk.value)return v.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;A=this.Dk.value.fka(L);return 2===Z&&A?(new Zr(L,zf.a.instance,y.AFrameworkApplication.J,Ba,this.En,this.ga,new ck.b),32):1===Z?A&&ed.a.d3h?32:8:2};this.Dk=b;this.En=
h;this.ga=r}Xb(){this.ga.fb(vb.a.YRi,kc.a.view,this.Y$m,260)}}Object(u.a)(pn,"ClipArtActor",null,[]);class Ul{constructor(){this.Z=null}get name(){return"Box4.ClipArt"}wc(b){this.Z=b;b.ia("Box4.ClipArt.ClipArtActor",()=>new pn(b.nf("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.va)).ha()}init(){this.Z.resolve("Box4.ClipArt.ClipArtActor").Xb();const b=ab.StaticActiveAppFrame.za();b&&b.Ge()}dispose(){}}Object(u.a)(Ul,"ClipartPackage",null,[0,1]);class Kq{constructor(b){this.o4a=
this.Z3a=this.v4a=this.u4a=null;this.xkh=this.Yeh=this.ykh=this.Grh=this.vi=this.bxa=!1;this.z5e=this.lsh=null;this.Wrh=0;this.Aa=this.gsh=null;this.Aia=b;this.nQ=3;this.M7b=!0}initialize(b,h,r){this.u4a=this.zMf(b,h);this.v4a=CommonUIStrings.l_SavingStatus;this.Z3a=CommonUIStrings.l_ReadOnlyStatus;this.o4a=CommonUIStrings.l_ReviewModeStatus;this.Aia&&this.Aia.execute(A=>{A.vKb(Object(D.a)(this,this.ftd,"updateToSavingStatus"))});this.vi=!0;this.Aa=r;this.Yeh=this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",
!1);return!0}KAb(b,h){this.bxa=b;this.nQ=h;this.t0a(this.M7b)}t0a(b){!this.M7b&&b&&(this.gsh=new Date);this.M7b=b;this.xkh=!1;b=null;3===this.nQ&&(b=this.M7b?this.u4a:this.v4a);this.KVl(b)}zMf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}ftd(){this.t0a(!1)}uAm(){switch(this.nQ){case 1:return this.Z3a;case 2:return this.o4a;default:return null}}tAm(){if(3!==this.nQ)switch(this.nQ){case 1:return"ReadOnly";
case 2:return"ReviewOnly";default:return null}return this.xkh?"FailedToSave":this.M7b?"Saved":"Saving"}Tin(b){return this.Grh===this.bxa&&this.Wrh===this.nQ&&this.lsh===b}Uwf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.bxa,b,this.uAm(),this.gsh,this.M7b,this.Yeh?h.getHeaderSaveStatusIconProps(this.tAm()):null);this.ykh=!0;return null});this.z5e=null}KVl(b){this.vi&&eg.c()&&!this.Tin(b)&&(!this.ykh&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.Uwf(b):rd.a.tue()?(this.z5e&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.z5e=window.requestIdleCallback(()=>{this.Uwf(b)})):window.requestAnimationFrame(()=>{this.Uwf(b)}),this.Grh=this.bxa,this.lsh=b,this.Wrh=this.nQ)}}Object(u.a)(Kq,"ReactSaveStatusUIHandler",null,[539]);class Tm{constructor(b,h){this.N_=null;this.u4a=CommonUIStrings.l_SavedStatus;this.v4a=CommonUIStrings.l_SavingStatus;this.Z3a=CommonUIStrings.l_ReadOnlyStatus;
this.o4a=CommonUIStrings.l_ReviewModeStatus;this.Bib=h;this.Aia=b;this.nQ=3;this.Fkb=!0}ME(){this.Aia&&this.Aia.execute(b=>{b.vKb(Object(D.a)(this,this.ftd,"updateToSavingStatus"))});this.Bib.execute(b=>{this.N_=b})}KAb(b,h){this.nQ=h;3===h?this.t0a(this.Fkb):2===h?this.dJg(this.o4a):this.dJg(this.Z3a)}ftd(){this.t0a(!1)}t0a(b){this.Fkb=b;this.dJg(this.Fkb?this.u4a:this.v4a)}dJg(b){this.N_&&this.N_.sendMessage(K.a.rsp,this.ozl(b))}ozl(b){const h={};h.StatusText=b;return h}}Object(u.a)(Tm,"SaveStatusPostMessageHandler",
null,[539]);var Eo=d(1033),Dn=d(180);class vo{constructor(b,h,r,A){this.o4a=this.Z3a=this.v4a=this.u4a=null;this.aGb=0;this.I1=this.E6e=this.OBb=this.cKe=this.P$e=null;this.Hg=b;this.wib=h;this.Aia=r;this.Hm=A;this.yoh=!0;this.bxa=!1;this.nQ=3;this.Fkb=!0}initialize(b,h){if(!this.Hg)return!1;this.u4a=this.zMf(b,h);this.v4a=CommonUIStrings.l_SavingStatus;this.Z3a=CommonUIStrings.l_ReadOnlyStatus;this.o4a=CommonUIStrings.l_ReviewModeStatus;this.ME();return!0}zMf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}ME(){this.wib&&this.wib.execute(b=>{b.p2k(Object(D.a)(this,this.Jai,"createStatusAndModeElements"));b.W1k(Object(D.a)(this,this.C8o,"showHideSaveStatusElement"));b.inp&&this.Jai(null,null)});this.Aia&&this.Aia.execute(b=>{b.vKb(Object(D.a)(this,this.ftd,"updateToSavingStatus"))})}zY(){this.I1&&this.Hg&&this.Hg.vEa(this.I1)}C8o(b,h){this.KAb("true"===h,this.nQ)}KAb(b,h){this.bxa=
b;this.nQ=h;this.cKe&&(this.cKe.style.display=this.bxa||3===this.nQ||!this.P$e?"none":"");this.OBb&&(this.OBb.style.display=this.bxa||3===this.nQ?"none":"",this.OBb.innerText=1===this.nQ?this.Z3a:this.o4a,this.OBb.title=1===this.nQ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.E6e&&(this.E6e.style.display=this.bxa||1===this.nQ||!this.P$e&&!this.OBb?"none":"");this.I1&&(this.I1.style.display=this.bxa||1===this.nQ?"none":"",this.t0a(this.Fkb),this.I1.title=
CommonUIStrings.l_SaveStatusTooltip)}Jai(b,h){b=document.getElementById(Eo.a.I_m);h&&h.DHp||!b||""===this.u4a||""===this.v4a||""===this.Z3a||""===this.o4a||(this.P$e=document.getElementById(Eo.a.$kf),this.cKe=Eo.a.XXd(b,"BreadcrumbAppModeDash","-"),this.OBb=Eo.a.XXd(b,"BreadcrumbAppModeStatus",1===this.nQ?this.Z3a:this.o4a),this.X6j(this.OBb),this.E6e=Eo.a.XXd(b,"BreadcrumbSaveStatusDash","-"),this.I1=Eo.a.XXd(b,"BreadcrumbSaveStatus",this.u4a),this.X6j(this.I1),this.KAb(this.bxa,this.nQ))}ftd(){this.t0a(!1)}t0a(b){this.Fkb=
b;this.EAp(this.Fkb?this.u4a:this.v4a)}EAp(b){!this.I1||3!==this.nQ&&2!==this.nQ||(this.yoh&&!this.Fkb?(this.aGb=this.I1.offsetWidth<this.aGb?this.aGb:this.I1.offsetWidth,this.lvp(this.v4a),this.yoh=!1):this.I1.innerText=b)}X6j(b){b.style.direction=this.Hm?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Hm?"right":"left";b.style.display=this.bxa?"none":"";b.setAttribute("Unselectable","on")}lvp(b){this.I1&&(this.I1.style.width="",this.I1.innerText=b,this.aGb=this.I1.offsetWidth<this.aGb?this.aGb:
this.I1.offsetWidth,b=Dn.a.WB(this.I1),this.I1.style.width=this.aGb-Je.a.ZU(b.paddingLeft)-Je.a.ZU(b.paddingRight)+1+"px")}}Object(u.a)(vo,"SaveStatusUIHandler",null,[539]);var pc=d(106);class Dm{constructor(){this.F6e=this.K4e=this.vSa=this.Z=null;this.iz=()=>{const b=y.AFrameworkApplication.J,h=!!y.AFrameworkApplication.ua.Gb&&4===y.AFrameworkApplication.ua.Gb.Mk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||
b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.K_?(this.F6e=this.Z.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.F6e.ME():y.AFrameworkApplication.ua.Gb.j0f||y.AFrameworkApplication.hideHeader||(y.AFrameworkApplication.ua.Gb.tN?(this.K4e=this.Z.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.K4e.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus"),
y.AFrameworkApplication.J):(this.vSa=this.Z.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.vSa.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}wc(b){this.Z=b;y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.K_?this.Z.register(Tm,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new Tm(this.Z.Ta("Common.App.HostNotification.EditNotificationEventSource"),
this.Z.Ta("Postmessage.IHostPostmessenger"))):y.AFrameworkApplication.ua.Gb.j0f||(y.AFrameworkApplication.ua.Gb.tN?this.Z.register(Kq,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new Kq(this.Z.Ta("Common.App.HostNotification.EditNotificationEventSource"))):this.Z.register(vo,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new vo(pc.EventHandlerManager.instance,this.Z.Ta("Common.App.Header.HeaderEventSource"),
this.Z.Ta("Common.App.HostNotification.EditNotificationEventSource"),y.AFrameworkApplication.isRtl)))}init(){y.AFrameworkApplication.J.vp(this.iz)}dispose(){this.vSa&&this.vSa.zY()}}Object(u.a)(Dm,"PackageManager",null,[0,1]);var wo=d(1647);class Zn{get name(){return"Common.App.EventsCachePackage"}wc(){}init(){wo.a.instance.init()}dispose(){}static main(){E.a.instance.Mc(new Zn)}}Object(u.a)(Zn,"EventsCachePackage",null,[0,1]);var zk=d(127),Rk=d(262),Mk=d(1404),Um=d(1281),Tg=d(464),nm=d(1461),xm=
d(1426),xf=d(1393),em=d(283),Ug=d(1397);class El{constructor(b){this.Fnh=!1;this.Yvd=this.nn=null;this.bJe=!1;this.rG=b}get control(){return this.rG}get Vd(){return this.control.Vd}get root(){return this.control.root}get eK(){return this.control.eK}get n5a(){return this.control.n5a}get gl(){return this.control.gl}get WG(){return this.control.WG}VK(){}initialize(){}py(b,h,r){this.control.EWl(b,h,r)}xn(){xf.c(this.control.fi.Command)||this.ov(this.control.fi.Command,null,null)}ov(b,h,r){let A=0;this.root&&
(A=this.root.sua(b,h,r));this.control.enabled=0<(A&1);return A}yfb(){let b=this.control.visible;this.root.O_a&&(b=this.Vd[em.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Brc=!0));return b}GKg(){const b=Ug.a.Qva(this.Vd[em.a.labelText],this.control.fi.LabelText);this.ixe(b)}ixe(b){this.control.labelText!==b&&(this.WG.forEach(h=>{h.ixe(b)}),this.control.labelText=b,this.root.xbb=!0)}r2b(){const b=Ug.a.Qva(this.Vd[em.a.alt],this.control.fi.Alt);this.exc(b)}exc(b){this.control.tooltip!==
b&&(this.WG.forEach(h=>{h.exc(b)}),this.control.tooltip=b)}Zna(){const b=Ug.a.Qva(this.Vd[Um.a.Image16by16Class],this.control.fi.Image16by16Class),h=Ug.a.Qva(this.Vd[Um.a.Image32by32Class],this.control.fi.Image32by32Class);var r=Ug.a.Qva(this.Vd[Um.a.Image48by48Class],this.control.fi.Image48by48Class);r=xf.b(r)?h:r;this.kTc(this.WG.small,b);this.kTc(this.WG.Es,b);this.kTc(this.WG.JX,h);this.kTc(this.WG.Tap,b);this.kTc(this.WG.Qpc,r)}kTc(b,h){!b||xf.c(b.eU)||xf.c(h)||b.eU.className===h||(b.eU.className=
h)}Ywp(b){if(!xf.b(b)&&this.root.VEg){for(const h of this.control.Opf){const r=h.UW===b;r&&(this.control.cdf=h);this.control.visible&&(h.uC=r)}this.control.visible&&(this.root.xbb=!0)}}Q3k(){if(this.WG.Qpc&&this.WG.Qpc.lR&&this.WG.Qpc.apb){const b=this.WG.Qpc.lR,h=Ug.a.Qva(this.Vd[Tg.a.Description],this.control.fi.Description);xf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.gl;Object(Gb.a)(nm.a,b)?this.eK.EAb(b):
this.root.xMb=this.control;return!1}onBlur(){const b=this.gl;this.control.PTb()&&Ug.a.Px(b.Tc,"cui-ctl-menu-hovered-without-focus");this.root.xMb=null;return!1}cS(b){if(this.control.PTb()){var h=this.eK.pva;const r=h===this.root.EVb-1;h=r?null:this.root.uE[h+1];this.Cof(!1);r||this.control===h||Ug.a.Px(h.CUb,xm.MenuLauncher.jdd);this.control.enabled&&this.control.Iv?r?this.control.E0():(Ug.a.sg(this.gl.Tc,"cui-ctl-menu-hovered-without-focus"),h.Oka=this.control.Iv):r?this.eK.setFocus(b.yg):(h.Oka=
this.eK.Tc,this.eK.Lua())}return!1}OL(){this.control.PTb()&&Ug.a.Px(this.gl.Tc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!xf.c(b.Lb)&&!xf.c(b.Lb.rawEvent)){const r=b.Lb.keyCode;b=b.Lb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(Gb.a)(nm.a,this.gl)){const A=this.eK;if(!xf.c(A)){const L=A.pva,Z=0===this.root.x4,oa=!xf.c(this.control.A$n);if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;
rd.a.Znf();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(A.$M(1),h=!0):r===Sys.UI.Key.left&&Z||r===Sys.UI.Key.right&&!Z?(oa?A.$M(2):0<L&&this.root.B6a(L,!0,!1),h=!0):r===Sys.UI.Key.right&&Z||r===Sys.UI.Key.left&&!Z?(oa&&A.$M(4),h=!0):r===Sys.UI.Key.up?(A.$M(5),h=!0):r===Sys.UI.Key.down?(A.$M(6),h=!0):r===Sys.UI.Key.esc&&(this.root.B6a(L,!0,!1),h=!0):(A.$M(0),h=!0)}}}return h}aA(b){let h=!1;if(!xf.c(b.Lb)&&!xf.c(b.Lb.rawEvent)){const r=b.Lb.keyCode;Cb.KeyInputManager.bNi(b)||r!==Sys.UI.Key.enter&&r!==
Sys.UI.Key.space||(h=this.CQf(b),h||(this.py(b.Df,1,b.Lb),h=!0))}return h}yE(b){this.Apf();if(this.n5a){let h=!0;2===b.yg&&(h=b.mga===Sys.UI.MouseButton.leftButton);h&&this.gl&&this.lQd(this.gl.Tc)}(b.Lb.type.toLowerCase()!==od.a.xS||this.n5a)&&b.Lb.preventDefault();return!1}get KWf(){return this.Fnh}U_l(){this.Fnh=!0}Apf(){this.KWf&&this.control.root.Cnb()}CCa(b){Object(Gb.a)(nm.a,this.gl)&&!this.n5a&&2===b.yg&&b.mga===Sys.UI.MouseButton.leftButton?(this.py(b.Df,b.yg,b.Lb),b=!0):b=this.control.Dza(b);
return b}onClick(b){let h=!1;Object(Gb.a)(nm.a,this.gl)&&!this.n5a&&3===b.yg&&(this.py(b.Df,b.yg,b.Lb),h=!0);return aa.a.Di?!1:h}iwb(b){return this.nle(b)}DMa(b){this.Dza(b);return!1}nle(b){return xf.c(this.nn)?!1:(this.lxg(rd.a.Aoc(this.VLh,b.clientPoint)),!0)}usc(b){let h=!1;this.Dza(b)&&(h=!0);3!==b.yg&&(b=!0,!this.root&&El.Pbg&&(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.w6(),h=!0);return h}xsc(b){return this.Dza(b)}vsc(b){return this.nle(b)}wsc(b){return this.Dza(b)}ssc(b){return 3===
b.yg?(this.root.w6(),!0):!1}tsc(){return!1}get VLh(){!xf.c(this.nn)&&xf.c(this.Yvd)&&(this.Yvd=rd.a.getElementBounds(this.nn));return this.Yvd}lxg(b){this.bJe!==b&&(this.bJe=b,this.ddf(this.bJe))}ddf(b){xf.c(this.nn)||Ug.a.X8(this.nn,Mk.a.oQd,b)}lQd(b){this.control.enabled&&(this.nn=b,this.root.ZRc=this.control,this.lxg(!0),this.root.$ja(this.control,!1))}Dza(b){if(!xf.c(this.nn)){this.lxg(!1);let h=!!this.root;if(El.Pbg){const r=Vd.ActionManager.D$(parseInt(this.control.fi.Command))||"";v.ULS.sendTraceTag(588084885,
207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.Vea(this.control,!1);xf.c(b)||rd.a.Aoc(this.VLh,b.clientPoint)&&this.py(this.nn,b.yg,b.Lb);h=!!this.root;El.Pbg&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.ZRc=null);this.Yvd=this.nn=null;return!0}return!1}$M(b){return Object(Gb.a)(nm.a,this.gl)&&2!==b&&4!==b&&!rd.a.Zmc(this.control.Iv)?this.E0():!1}E0(){try{if(this.control.visible){const b=this.control.Iv;if(!xf.c(b))return b.focus(),!0}}catch(b){}return!1}Cof(b){const h=
this.eK;xf.c(h)||this.root.B6a(h.pva+1,b)}$ta(){}CQf(){return!1}bP(b){let h=null;b&&b.rawEvent&&(h={},h[El.triggerTime]=b.rawEvent.timeStamp);return h}static get Pbg(){null==El.O0e&&(El.O0e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return El.O0e}}El.triggerTime="TriggerTime";El.O0e=null;Object(u.a)(El,"ControlBehavior",null,[598]);var mk=d(181);class Em extends El{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.fi}VK(b){const h=
b.Jn;b=b.UW;xf.c(h)||(bf.a.instance.ub(od.a.focus,h,Object(D.a)(this,this.onFocus,"onFocus")),bf.a.instance.ub(od.a.blur,h,Object(D.a)(this,this.onBlur,"onBlur")),Rk.a.instance.ub(od.a.UL,h,Object(D.a)(this,this.cS,"onPointerOver")),Rk.a.instance.ub(od.a.qH,h,Object(D.a)(this,this.OL,"onPointerOut")),Cb.KeyInputManager.instance.LI(od.a.ij,h,Object(D.a)(this,this.onKeyDown,"onKeyDown"),b),Cb.KeyInputManager.instance.LI(od.a.lv,h,Object(D.a)(this,this.HI,"onKeyPress"),b),Cb.KeyInputManager.instance.LI(od.a.gi,
h,Object(D.a)(this,this.aA,"onKeyUp"),b),Rk.a.instance.ub(od.a.kt,h,Object(D.a)(this,this.yE,"onPointerDown")),Rk.a.instance.ub(od.a.EP,h,Object(D.a)(this,this.CCa,"onPointerUp")),jg.a.instance.ub(od.a.click,h,Object(D.a)(this,this.onClick,"onClick")),mk.a.instance.ub(od.a.wS,h,Object(D.a)(this,this.iwb,"onTouchMove")),mk.a.instance.ub(od.a.hM,h,Object(D.a)(this,this.DMa,"onTouchEnd")))}py(b,h,r){this.control.enabled&&(b=null,this.gl&&this.gl.L9c()&&this.eK&&(b=this.root.uE[this.eK.pva])&&!this.KWf&&
(b.$Za(this.button),b=null),this.executeCommand(this.control.fi.Command,h,!0,r),b&&b.$Za(this.button))}executeCommand(b,h,r,A){if(!xf.c(b)){const L=this.Vd;L.CommandValueId=this.button.EPb();L.MenuItemId=this.button.fi.MenuItemId;L.SourceControlId=this.control.id;this.root.executeCommand(b,L,this.gl,h,r,null,this.bP(A))}}xn(){xf.c(this.control.fi.Command)||0<(this.ov(this.properties.Command,this.properties.QueryCommand,this.Vd)&2)&&this.yfb()&&this.q0a()}q0a(){this.GKg();this.r2b();this.Zna()}onFocus(b){super.onFocus(b);
this.LDg();return!1}onBlur(b){super.onBlur(b);this.xzf();return!1}onKeyDown(b){let h=super.onKeyDown(b);xf.c(b.Lb)||this.wAg(b.uq,b.Lb.keyCode)&&(h=!1);return h}HI(b){let h=!1;xf.c(b.Lb)||xf.c(b.Lb.rawEvent)||(this.wAg(b.uq,b.Lb.rawEvent.keyCode)?(this.py(b.Df,b.yg,b.Lb),h=!0):b.Lb.preventDefault());return h}wAg(b,h){if(aa.a.As&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}aA(b){let h=!1;xf.c(b.Lb)||this.wAg(b.uq,b.Lb.keyCode)||
(h=super.aA(b));return h}LDg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}xzf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(u.a)(Em,"ButtonBehavior",El,[]);var To=d(1588);class Lm{}Lm.Color="Color";Lm.IndexColorSelected="ColorSelected";Object(u.a)(Lm,"ColorPickerCommandProperties",null,[]);var ko=d(1592);class $n extends El{constructor(b){super(b);this.iPc=this.Cw=-1}get dMb(){return this.control}get QTa(){return this.dMb.jvl.QTa}get properties(){return this.dMb.fi}py(b,
h,r){if(this.control.enabled){const A=this.Vd;A.Color=$n.k7d(b)[To.ColorPicker.aWd];b=null;Ug.a.Zs(this.properties.Stateful)&&this.gl&&this.gl.L9c()&&this.eK&&(b=this.root.uE[this.eK.pva]);this.root.executeCommand(this.properties.Command,A,this.gl,h,!0,null,this.bP(r));b&&b.$Za(this.dMb)}}xn(){var b=this.Vd;b.SourceControlId=this.properties.Id;if(0<(this.ov(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Lm.IndexColorSelected in this.Vd&&(b=this.Vd[Lm.IndexColorSelected]),b!==this.iPc)){const h=
this.QTa;0<=b&&b<h.length&&this.o6j(h[b],!0);0<=this.iPc&&this.iPc<h.length&&this.o6j(h[this.iPc],!1);this.iPc=b}}o6j(b,h){h?Ug.a.sg(b,"cui-colorpicker-selected"):Ug.a.Px(b,"cui-colorpicker-selected")}VK(b){for(let h=0;h<b.Dcf.length;++h){const r=b.Dcf[h];bf.a.instance.ub(od.a.focus,r,Object(D.a)(this,this.gdg,"onCellFocus"));bf.a.instance.ub(od.a.blur,r,Object(D.a)(this,this.bXn,"onCellBlur"));Cb.KeyInputManager.instance.ub(od.a.ij,r,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.gi,
r,Object(D.a)(this,this.aA,"onKeyUp"));jg.a.instance.ub(od.a.click,r,Object(D.a)(this,this.cXn,"onCellClick"));Rk.a.instance.ub(od.a.EP,r,Object(D.a)(this,this.idg,"onCellPointerUp"));Rk.a.instance.ub(od.a.UL,r,Object(D.a)(this,this.hdg,"onCellPointerOver"));Rk.a.instance.ub(od.a.kt,r,Object(D.a)(this,this.dXn,"onCellPointerDown"))}}gdg(b){b=$n.k7d(b.Df);this.eK.EAb(this.gl);this.lEe(b,!0);return!0}bXn(b){this.lEe($n.k7d(b.Df),!1);return!0}lEe(b,h){h?(this.Cw=parseInt(b.getAttribute("arrayPosition")),
Ug.a.sg(b,"cui-colorpicker-hoveredOver"),this.LDg(b)):(this.Cw=-1,this.xzf(b),Ug.a.Px(b,"cui-colorpicker-hoveredOver"))}cXn(b){3===b.yg&&this.py(b.Df,b.yg,b.Lb);return!0}idg(b){3!==b.yg&&this.py(b.Df,b.yg,b.Lb);return!0}hdg(b){this.Cof(!1);b=parseInt($n.k7d(b.Df).getAttribute("arrayPosition"));this.Cnd(b);return!0}dXn(){return!1}LDg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!xf.b(h)){const r=this.Vd;r.Color=b[To.ColorPicker.aWd];this.root.executeCommand(h,r,this.gl,0,!1)}}}xzf(b){if(this.control.enabled){const h=
this.properties.CommandRevert;if(!xf.b(h)){const r=this.Vd;r.Color=b[To.ColorPicker.aWd];this.root.executeCommand(h,r,this.gl,0,!1)}}}$M(b){b=ko.a.BDf(this.Cw,this.dMb.width,this.QTa.length,b);if(b!==this.Cw&&this.Cnd(b))return!0;this.lEe(this.QTa[this.Cw],!1);return!1}E0(){return this.Cnd(0)}Cnd(b){return this.QTa&&this.QTa.length>b&&(b=this.QTa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}$ta(){-1!==this.Cw&&this.lEe(this.QTa[this.Cw],!1)}static k7d(b){return $n.fBm(b)}static fBm(b){var h=["td"];
const r=h.length;if(!b)return null;for(var A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;for(b=b.parentNode;b;){for(A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;b=b.parentNode}return null}}Object(u.a)($n,"ColorPickerBehavior",El,[]);var Uo=d(350),qp=d(381),cr=d(1707),ll=d(710),jh=d(1437),$r=d(1693);class Vl{constructor(b,h){this.iQk=b;this.pnh=h}Rwe(b,h,r,A){if(xf.c(b)||xf.c(h))return null;const L=new $r.a;const Z=A.x,oa=A.y,Ba=A.width;var gb=A.height;
let Ab;Vl.sgc(h,"flyoutWidth");A=Vl.sgc(h,"flyoutRealHeight");const Jb=Vl.sgc(h,"viewportWidth"),Tb=Vl.sgc(h,"viewportHeight"),jc=Vl.sgc(h,"viewableLeft"),Hc=Vl.sgc(h,"viewableTop"),hd=this.iQk;let Gd=!1,de=!1;const qe=1===r,oe=4===r,ge=this.pnh;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Ab=this.Zcj(b);L.Cak=Tb;L.EMg=Jb;if(qe)hd?h=Z+Ba:(h=Z-Ab,L.vub=!0),gb=oa;else{var $d="";Ba>Ab&&(Ab=Ba,$d=(Ab-2*jh.Menu.cje).toString());hd?h=Z:(h=Z+Ba-Ab,L.vub=!0);
gb=oa+gb;""!==$d&&(b.style.minWidth=$d+"px")}ge&&(gb+=Hc,h+=jc);b.style.top=gb+"px";b.style.left=h+"px";let lf=$d=!1;Ab<=Jb?h+Ab>jc+Jb?(qe&&hd&&Z-Ab>jc||oe&&Z-Ab>jc?(h=Z-Ab,ge&&(h+=jc),lf=L.vub=!0):(h=jc+Jb-Ab,Gd=!0),$d=!0):h<jc&&(qe&&!hd&&Z+Ba+Ab<jc+Jb?(h=Z+Ba,ge&&(h+=jc),L.vub=!1,lf=!0):(h=jc,de=!0,L.vub=!0),$d=!0):hd?(h=jc,$d=!0,L.vub=!0):(h=jc+Jb-Ab,$d=!0,L.vub=!1);$d&&(b.style.left=h+"px");L.tic=gb;if(!(gb+A<=Hc+Tb)||3===r){L.y2f=!0;const {DRn:wf,tbm:gi,Ekn:Di,Wrn:Yl}=this.$Cf(r,gb,A,oa,Hc,Tb);
gb!==wf&&(b.style.top=wf+"px",L.tic=wf);-1<gi&&(b.style.maxHeight=gi+"px");Di&&(b.style.bottom="0px",b.style.height="auto");Yl&&this.qJn(b,hd,qe,lf,de,Gd,Jb,Z,Ba)}L.a1c=h;L.xDf=Ab;L.tDf=A;return L}$Cf(b,h,r,A,L,Z){let oa,Ba,gb;oa=-1;gb=Ba=!1;const Ab=h,Jb=L+Z-h;h=A-r;const Tb=this.pnh;let jc=!1;0>h&&(h=L);Tb||(A-=L);r<=A&&1!==b||(4===b||1===b?r<Z?(h=Z-r,Ba=!0):(h=L,jc=gb=Ba=!0):(A<Jb&&3!==b?(h=Ab,Ba=!0):oa=A,gb=!0));Tb&&(Ba=!1,jc?oa=Z:h+=L);return{DRn:h,tbm:oa,Ekn:Ba,Wrn:gb}}qJn(b,h,r,A,L,Z,oa,Ba,
gb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(Z||A)b.style.left="",b.style.right=(Z?0:oa-Ba)+"px"}else L||A||(b.style.left="",b.style.right=(r?oa-Ba:oa-Ba-gb)+"px")}gqm(b){const h={};if(xf.c(b))return h;h.viewportWidth=Je.a.srb();h.viewportHeight=Je.a.D_();xf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);xf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);
h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;xf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);xf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*jh.Menu.cje:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Zcj(b);b.style.overflowY=r;return h}Zcj(b){return b.offsetWidth}static sgc(b,
h){return xf.c(b)?0:b[h]}}Object(u.a)(Vl,"MenuPositioner",null,[]);var Fp=d(2021),tq=d(1518),ao=d(1696),sh=d(1694),Tp=d(1691),Fm=d(1692),uq=d(1699),dj=d(1450),an=d(1584);class lo extends El{constructor(b){super(b);this.N_e=0;this.Brh=null;this.a3e=-1;this.dAd=null;this.Vjg=this.ekh=!1;this.QUk=()=>{this.Jg&&this.Jg.Tc&&(document.body.appendChild(this.sVh),this.xeo())};this.ugf=h=>{h.element&&(h.element.style.filter="",h.element.style.opacity="",this.Jg&&this.Jg.Tc===h.element&&Object(Gb.a)(Tp.a,this.Jg)&&
qp.a.L5k(this.Eui()))};this.SEk=new Vl(0===this.root.x4,Ug.a.Zs(this.root.properties.DivSyndicated))}get qdj(){return this.SEk}get Rv(){return this.control}get properties(){return this.control.fi}get Jg(){return this.Rv.Jg}set Jg(b){this.Rv.Jg=b}get vN(){return this.Rv.vN}set vN(b){this.Rv.vN=b}get sVh(){xf.c(this.dAd)&&(this.dAd=lo.osf());return this.dAd}get bTj(){let b=!this.root.tTf;Object(Gb.a)(357,this.root)&&1===this.root.EVb&&(b=!0);return b}py(b,h){Object(Gb.a)(357,this.root)&&this.root.Ozf();
this.Rv.m3(h)}m3(b){if(this.Rv.enabled&&!this.vN){var h=ih.a.instance.rq(Za.a.m3);h.properties.add("Id",this.Rv.fi.Id);h.properties.add("InputMethod",Uo.a[b]);h.end();db.a.mark(10326);rd.a.aje(this.Rv.fi.Id,"MenuOpen");this.Rv.Iv&&(this.Rv.Oka=rd.a.jqb(this.Rv.Iv.ownerDocument));this.N_e=b;this.xtj(b);this.hwe();this.Rv.pfb(this.Rv.Iv,!0)}}hwe(){xf.c(this.properties.PopulateAsyncTriggerCommand)||this.ekh||(this.tTn(),this.ekh=!0)}tTn(){const b={};b[cr.a.Callback]=Object(D.a)(this,this.aAj,"refreshMenuCallback");
this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.gl,0,!1)}aAj(){this.Rv.wZa()}wZa(){this.vN&&this.xtj(this.N_e,!0)}xtj(b,h=!1){var r=!0;if(Ug.a.Zs(this.properties.PopulateDynamically)){r=!1;const A=this.jhd(b);A!==this.Brh&&(r=this.jkg(A,h));r=r||!this.vN}r&&(h=y.AFrameworkApplication.ua.Vr,r=null,h&&(r=h.Xf("LoadResource","Menu Initialization")),this.Kfa(b),r&&r.stop(),this.Fme())}Kfa(b){if(!xf.c(this.Jg)){if(this.Rv.ocb){var h=this.Rv.gl;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();
this.Jg.dYo(String.format("{0} {1}",this.Rv.ocb,h.keytip.Oyf),this.Rv.YYa&&""!==this.Rv.YYa?String.format("{0}-{1}",this.Rv.YYa,r):r)}}this.Jg.Vra();Ug.a.sg(this.Jg.Tc,this.Rv.jgf);Ug.a.X8(this.Jg.Tc,"cui-touch",3===b||this.root.VCe);if(this.Jg.hasItems()){this.Jg.VK();h=this.gl;h.cki();h.F6c=!0;h.Wf(this.Jg);h.F6c=!1;this.Jg.qtj();r=Object(Gb.a)(an.a,this.root);var A=null,L=!1;r&&(A=this.root,L=A.deb,A.deb=!1);var Z=this.Jg.Tc;Z.style.visibility="hidden";Z.style.position="absolute";Z.style.top="0px";
Z.style.left="0px";aa.a.As&&!aa.a.WWa&&(Z.style.maxHeight="100px",Z.style.overflowY="scroll");document.body.appendChild(Z);this.T3k();this.Ceo(Z);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.PUk();Ug.a.sg(this.Rv.CUb,xm.MenuLauncher.jdd);var oa=this.root.EVb;this.U3o&&this.root.$ja(this.control,!0);Z.style.zIndex=String(y.AFrameworkApplication.ua.oya);this.root.bYk(this.Rv);this.Jg.pva=oa;Z.style.visibility="visible";oa=this.Eui();if(Object(Gb.a)(Fm.a,this.Jg)){Z.style.position="fixed";
const Ba=this.root.uE[0];Ba&&Ba.Jg&&Ba.Jg.Tc?100!==rd.a.T3c(this.root.uE[0].Jg.Tc)&&qp.a.ZBg(Z,oa,this.ugf):qp.a.ZBg(Z,oa,this.ugf)}else qp.a.ZBg(Z,oa,this.ugf);this.vN=!0;this.Jg.x2f=!0;!aa.a.Di&&this.Rv.SPo&&this.Jg.setFocus(b);r&&(A.deb=L);r=this.properties.CommandMenuOpen;xf.b(r)||this.root.executeCommand(r,null,h,b,!1)}}db.a.mark(10327)}Fme(){}PUk(){this.a3e=Ug.a.LLb(this.a3e);this.a3e=window.setTimeout(this.QUk,50)}xeo(){const b=this.sVh;var h=this.Jg.Tc;b.style.position="absolute";b.style.visibility=
"hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;aa.a.WWa&&(r-=4,h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get U3o(){return this.root.EVb?!1:!0}Eui(){const b=this.Jg.children,h=[];if(Object(Gb.a)(Tp.a,this.Jg))for(let r=0;r<b.count;r++){const A=b.K(r);Array.add(h,A.separator);for(let L=0;L<A.children.count;L++){const Z=A.children.K(L);Array.add(h,
Z.Tc)}}return h}T3k(){var b=this.Jg.children;for(let r=0;r<b.count;r++){const A=b.K(r).children;for(let L=0;L<A.count;L++){var h=A.K(L);if(Object(Gb.a)(nm.a,h)){const Z=h;if("Menu32"===Z.UW||"Menu48"===Z.UW)h=h.control,h.behavior&&(Object(Gb.a)(tq.a,h)||Object(Gb.a)(sh.a,h))&&h.behavior.Q3k()}}}0<b.count&&(b=b.K(0),xf.c(b.separator)||(b.separator.style.display="none"),xf.c(b.yCe)||Ug.a.sg(b.yCe,"cui-menusection-titleAtTop"))}Ceo(b){if(!xf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom=
"";b.style.right="";b.style.width="";b.style.minWidth="";var h=ll.a.create();try{const r=this.qdj.gqm(b),A=this.y3c();let L=this.root.Rwe(b,r,this.Rv.dje,A);L||(L=this.qdj.Rwe(b,r,this.Rv.dje,A));this.root.rdj=L}finally{h&&h.dispose()}}}y3c(){const b=rd.a.getElementBounds(this.Rv.CUb);var h=this.eK;xf.c(h)||xf.c(h.Tc)||(h=rd.a.getElementBounds(h.Tc),b.x=h.x+jh.Menu.cje,b.width=h.width-2*jh.Menu.cje);Object(Gb.a)(dj.a,this.Rv.Rge)&&(b.height=0);return b}aza(){if(this.Rv.vN){v.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Rv.fi.Id});this.Jg.$ta();this.CCj();this.vN=!1;this.Jg.x2f=!1;this.root.Vea(this.control,!0);this.bTj?y.AFrameworkApplication.ua.Gld(this.Rv.Oka,this.N_e):this.rIo();this.Rv.Oka=null;var b=this.Rv.CUb;Ug.a.Px(b,xm.MenuLauncher.jdd);this.Rv.pfb(this.Rv.Iv,!1);Ug.a.Px(b,"cui-ctl-menu-hovered-without-focus");this.Jg.Lua();xf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.gl,0,!1);this.BCj()}}rIo(){const b=
this.Rv.Oka;if(b)try{b.focus()}catch(h){}}BCj(){Je.a.xD(this.Jg.Tc);Je.a.xD(this.dAd);Ug.a.vEa(this.Jg.Tc)}jhd(b){if(this.Vjg&&Ug.a.Zs(this.properties.PopulateOnlyOnce)||xf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Rv.XGf();return 0<(this.root.sua(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}jkg(b,h=!1){if(this.Vjg&&Ug.a.Zs(this.properties.PopulateOnlyOnce))return!0;let r=null;this.Brh=b;xf.c(b)||
(r=this.MHl(b));xf.c(r)||(this.Vjg=!0);if(h){this.root.dsl(this.Rv);if(xf.c(r)||!r.hasItems())return this.aza(),!1;this.CCj();this.BCj()}this.eXo(r);return!0}okj(){}MHl(b){b=Fp.a.T7h(b);if(!xf.c(b)){const h=new uq.a;h.l3h=!0;h.parentId=this.control.id;let r;r=Object(Gb.a)(ao.a,this.control);return this.root.SQ.c6a(b,h,r)}return null}eXo(b){xf.c(b)||(xf.c(this.Jg)||this.Jg.dispose(),this.Jg=b,this.okj())}CCj(){const b=this.Jg.parent;b?(b.F6c=!0,b.removeChild(this.Jg.id),b.F6c=!1):v.ULS.sendTraceTag(572330335,
207,10,"Parent not found for the Menu component {0}",this.Jg.id)}onKeyDown(b){let h=!1;xf.c(b.Lb)||xf.c(b.Lb.rawEvent)||Object(Gb.a)(nm.a,this.gl)||!b.Lb.rawEvent.altKey||b.Lb.keyCode!==Sys.UI.Key.down||(this.py(b.Df,1,b.Lb),h=!0);h||(h=super.onKeyDown(b));return h}yE(b){this.Apf();2===b.yg&&b.mga!==Sys.UI.MouseButton.leftButton||this.py(b.Df,b.yg,b.Lb);b.Lb.preventDefault();return!1}CQf(b){if(!this.eK||!this.eK.inKeytipMode||!this.Rv.wlj)return!1;this.Rv.wlj(this.gl,b);return!0}static osf(){const b=
Ug.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(u.a)(lo,"MenuLauncherBehavior",El,[606,598]);var ma=d(1697);class Ua extends lo{constructor(b){super(b)}get gu(){return this.IZc.properties}get IZc(){return this.control}get EUa(){return this.IZc.EUa}VK(){Rk.a.instance.ub(od.a.kt,this.EUa.Jn,Object(D.a)(this,this.yE,"onPointerDown"));Cb.KeyInputManager.instance.ub(od.a.ij,this.EUa.Jn,Object(D.a)(this,this.onKeyDown,"onKeyDown"));
Cb.KeyInputManager.instance.ub(od.a.gi,this.EUa.Jn,Object(D.a)(this,this.aA,"onKeyUp"))}xn(){const b=this.Vd[ma.a.SelectedItemId];if(0<(this.ov(this.gu.Command,this.gu.QueryCommand,this.Vd)&2)){const h=this.Vd[ma.a.SelectedItemId];xf.c(h)||b===h||this.IZc.Omd(h)||(this.Vd[ma.a.SelectedItemId]=null)}}}Object(u.a)(Ua,"DropDownBehavior",lo,[]);var xb=d(624),Xb=d(1481);class rc extends Ua{constructor(b){super(b);this.e2a=null;this.t0e=this.REb=this.oGa=!1;this.pNc=null;this.nNc=-1;this.Reg=h=>{let r=
!1;if(2!==h.yg||h.mga===Sys.UI.MouseButton.leftButton)this.py(h.Df,h.yg,h.Lb),this.wwe(),r=!0;r&&h.Lb.preventDefault();return!1};this.F_n=h=>{let r=!1;if(!xf.c(h.Lb)&&!xf.c(h.Lb.rawEvent)){const A=h.Lb.keyCode;h=h.Lb.rawEvent.shiftKey;Ug.a.Zs(this.EJ.AutoComplete);if(A===Sys.UI.Key.enter)this.JW(),this.Mtg(),Object(Gb.a)(Xb.Ribbon,this.root)&&this.root.u2(),r=!0;else if(A===Sys.UI.Key.tab){if(this.JW(),this.Mtg(),Object(Gb.a)(Xb.Ribbon,this.root)&&(r=this.root.tGe(this.gl.Tc,!h)),Object(Gb.a)(357,
this.root))return!0}else A===Sys.UI.Key.backspace||A===Sys.UI.Key.del?this.control.enabled?(this.Hmf(),this.pNc=null):r=!0:A===Sys.UI.Key.esc?(this.Qtg(),this.Mtg(),Object(Gb.a)(Xb.Ribbon,this.root)&&this.root.u2(),r=!0):A===Sys.UI.Key.down&&(this.m3(1),this.wwe(),r=!0)}return r};this.G_n=h=>{if(!this.control.enabled)return!0;!xf.c(h.Lb)&&h.Lb.charCode&&this.CPl();return!1};this.ueg=()=>this.oGa?!1:this.oGa=!0}get x6(){return this.control}get PT(){return this.x6.PT}get EJ(){return this.x6.EJ}get Hde(){return this.Vd[xb.a.IsFreeForm]}set Hde(b){this.Vd[xb.a.IsFreeForm]=
b}VK(b){Rk.a.instance.ub(od.a.kt,b.Jn,Object(D.a)(this,this.yE,"onPointerDown"));const h=b.us;bf.a.instance.ub(od.a.focus,h,Object(D.a)(this,this.Wvb,"onInputFocus"));bf.a.instance.ub(od.a.blur,h,Object(D.a)(this,this.xCa,"onInputBlur"));Cb.KeyInputManager.instance.ub(od.a.ij,h,this.F_n);Cb.KeyInputManager.instance.ub(od.a.lv,h,this.G_n);Zf.a.instance.ub(od.a.Fba,h,this.ueg);Rk.a.instance.ub(od.a.kt,h,Object(D.a)(this,this.I_n,"onInputPointerDown"));Rk.a.instance.ub(od.a.kt,b.Eii,this.Reg)}xn(){0<
(this.ov(this.EJ.Command,this.EJ.QueryCommand,this.Vd)&2)&&(this.REb||this.E9j(),this.Cxp())}okj(){this.x6.menuItems=null;var b;var h=b=null;if(!xf.c(this.Jg)){this.wwe();for(const A of this.Jg.children)for(const L of A.children)if(Object(Gb.a)(nm.a,L)){var r=L;r=r.control;Object(Gb.a)(558,r)&&(b=r,b=b.fi.MenuItemId);Object(Gb.a)(557,r)&&(h=r,h=h.z9a());xf.c(b)||xf.c(h)||(this.x6.menuItems[h]=b,b=h=null)}}}I_n(b){Object(Gb.a)(357,this.root)&&2===b.yg&&(this.e2a=rd.a.jqb(this.control.Iv.ownerDocument),
this.control.Iv.focus());return!1}yE(b){this.Apf();let h=!1;3===b.yg&&(h=super.yE(b),this.wwe());h&&b.Lb.preventDefault();return!1}A3l(){this.nNc=-1;const b=this.PT.us,h=b.value,r=this.Vsm(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const A=b.createTextRange();A.moveStart("character",h.length);A.moveEnd("character",b.value.length);A.select()}this.pNc=r.value}else this.pNc=null}Vsm(b){const h=this.x6.menuItems;for(const r in h){const A=
{key:r,value:h[r]};if(A.key.toLowerCase().startsWith(b.toLowerCase()))return A}return null}CPl(){Ug.a.Zs(this.EJ.AutoComplete)&&-1===this.nNc&&(this.t0e&&(this.jhd(0),this.t0e=!1),this.nNc=window.setTimeout(Object(D.a)(this,this.A3l,"executeAutoComplete"),this.x6.ibl))}Hmf(){Ug.a.Zs(this.EJ.AutoComplete)&&(this.nNc=Ug.a.LLb(this.nNc))}Wvb(b){if(this.vN)return this.Jg.setFocus(0),!0;Object(Gb.a)(357,this.root)&&(Sg.FocusManager.instance().RE("ribbon"),this.root.V5c=!1);this.onFocus(b);this.REb=!0;
Ug.a.sg(this.PT.Jn,"cui-cb-focus");Ug.a.Zs(this.EJ.PopulateDynamically)&&(this.t0e=!0);rd.a.Kmd(this.PT.us);xf.c(this.Jg)||this.Jg.yn();return this.oGa=!1}xCa(){this.REb=!1;this.JW();Ug.a.Px(this.PT.Jn,"cui-cb-focus");return!1}Mtg(){Object(Gb.a)(357,this.root)&&(void 0!==this.e2a&&null!==this.e2a&&y.AFrameworkApplication.ua.Gld(this.e2a,2),this.e2a=null)}JW(){if(this.control.enabled){this.Hmf();var b=this.PT.us;if(void 0===this.Vd[xb.a.Value]||null===this.Vd[xb.a.Value]||b.value!==this.Vd[xb.a.Value].toString())if(this.x6.Omd(this.pNc))this.Hde=
!1,this.Vd[xb.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.x6.Umd.EPb(),["MenuItemId"]:this.x6.Umd.fi.MenuItemId},this.root.executeCommand(this.EJ.Command,b,this.gl,0,!1);else{if(!Ug.a.Zs(this.EJ.AutoComplete)){var h=this.x6.menuItems[b.value];if(!xf.b(h)&&this.x6.Omd(h)){this.Hde=!1;this.Vd[xb.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.x6.Umd.EPb(),["MenuItemId"]:h};this.root.executeCommand(this.EJ.Command,b,this.gl,0,!1);return}}h=!xf.b(b.value)&&""!==F.a.oDa(b.value);
this.x6.WQh&&h?(this.Hde=!0,this.Vd[xb.a.Value]=b.value,this.root.executeCommand(this.EJ.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.gl,0,!1)):this.Qtg()}}else this.Qtg()}Qtg(){this.Hmf();this.pNc=null;this.E9j()}E9j(){const b=this.Vd[xb.a.Value]||"";b!==this.PT.us.value&&(this.PT.us.value=b);this.x6.Omd(this.x6.menuItems[b])}Cxp(){const b=this.Vd[xb.a.FontStyle]||"normal";b!==this.PT.us.style.fontStyle&&(this.PT.us.style.fontStyle=b)}wwe(){this.control.Iv&&this.Jg&&this.control.Iv.setAttribute($c.a.iUh,
this.Jg.id)}}Object(u.a)(rc,"ComboBoxBehavior",Ua,[]);class Zc extends lo{constructor(b){super(b)}get lXd(){return this.control}y3c(){let b=0;this.Jg&&this.Jg.Tc&&2===this.Jg.horizontalAlignment&&(b=this.Jg.Tc.clientWidth);return new Sys.UI.Bounds(this.lXd.x-b,this.lXd.y,this.lXd.A2f,this.lXd.z2f)}}Object(u.a)(Zc,"ContextMenuLauncherBehavior",lo,[]);class Hd extends lo{constructor(b){super(b)}get d_d(){return this.control}y3c(){return new Sys.UI.Bounds(this.d_d.x,this.d_d.y,this.d_d.A2f,this.d_d.z2f)}}
Object(u.a)(Hd,"DialogMenuLauncherBehavior",lo,[]);var Jd=d(1273);class Xd extends lo{constructor(b){super(b);this.w0e=!1;this.JNk=!Ug.a.Vla(this.gu.ShouldRefreshWhenDropped)}get KJa(){return this.control}get gu(){return this.control.fi}VK(b){b=b.Jn;xf.c(b)||(bf.a.instance.ub(od.a.focus,b,Object(D.a)(this,this.onFocus,"onFocus")),bf.a.instance.ub(od.a.blur,b,Object(D.a)(this,this.onBlur,"onBlur")),Rk.a.instance.ub(od.a.UL,b,Object(D.a)(this,this.cS,"onPointerOver")),Cb.KeyInputManager.instance.ub(od.a.ij,
b,Object(D.a)(this,this.onKeyDown,"onKeyDown")),Cb.KeyInputManager.instance.ub(od.a.gi,b,Object(D.a)(this,this.aA,"onKeyUp")),Rk.a.instance.ub(od.a.kt,b,Object(D.a)(this,this.yE,"onPointerDown")))}xn(){xf.c(this.control.fi.Command)||(this.KJa.vN&&!this.JNk?this.w0e=!0:(0<(this.ov(this.gu.Command,this.gu.QueryCommand,this.Vd)&2)&&this.yfb()&&this.q0a(),Ug.a.Zs(this.gu.RefreshableMenu)&&this.vN&&this.Jg.ldo()))}q0a(){this.zxp();this.Zna();this.lyp();this.KJa.eTf=this.Vd[Jd.a.ImageIsVisible]}zxp(){const b=
Ug.a.Qva(this.Vd[Jd.a.LabelText],this.gu.LabelText),h=this.Vd[Jd.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.gu.LabelTextUserGeneratedPlaceholderReplacements!==h)this.WG.Es&&this.Axp(this.WG.Es.lR,b,h),this.root.xbb=!0,this.control.labelText=b,this.gu.LabelTextUserGeneratedPlaceholderReplacements=h}Axp(b,h,r){const A=b.lastChild;Ug.a.gNj(b,h+" ",r);h=xf.c(A);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",
h?"":A.nodeType.toString());h||b.appendChild(A)}lyp(){const b=this.Vd[Jd.a.ImageBackColor];this.WG.forEach(h=>{Xd.Y7k(h.eU,b)})}m3(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&y.AFrameworkApplication.va.Ob(Za.a.g_d,2);"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||y.AFrameworkApplication.va.Ob(Za.a.g_d,2);Object(Gb.a)(nm.a,this.gl)&&(this.vN||this.Cof(!0),this.control.enabled&&this.E0());
super.m3(b)}aza(){super.aza();this.w0e&&(this.w0e=!1,this.xn())}cS(b){return this.control.PTb()?(this.KJa.vN?(this.root.o_h(),Ug.a.sg(this.KJa.CUb,xm.MenuLauncher.jdd),this.KJa.Oka=this.control.Iv):(super.cS(b),this.py(b.Df,b.yg,b.Lb)),!1):super.cS(b)}onKeyDown(b){let h=!1;if(!xf.c(b.Lb)&&!xf.c(b.Lb.rawEvent)){if(Object(Gb.a)(nm.a,this.gl)){const r=b.Lb.rawEvent,A=b.Lb.keyCode,L=0===this.root.x4;r.shiftKey||r.ctrlKey||!(A===Sys.UI.Key.right&&L||A===Sys.UI.Key.left&&!L)||(h=this.CQf(b),h||(this.py(b.Df,
1,b.Lb),h=!0))}h||(h=super.onKeyDown(b))}return h}static Y7k(b,h){xf.c(b)||xf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(u.a)(Xd,"FlyoutAnchorBehavior",lo,[]);var je=d(1276);class af extends El{constructor(b){super(b)}get Qic(){return this.control}get properties(){return this.Qic.properties}get pka(){return this.Qic.pka}VK(b){b=b.fOb;bf.a.instance.ub(od.a.focus,b,Object(D.a)(this,this.onFocus,"onFocus"));bf.a.instance.ub(od.a.blur,b,Object(D.a)(this,this.onBlur,"onBlur"));
Rk.a.instance.ub(od.a.UL,b,Object(D.a)(this,this.cS,"onPointerOver"));Rk.a.instance.ub(od.a.qH,b,Object(D.a)(this,this.OL,"onPointerOut"));Cb.KeyInputManager.instance.ub(od.a.ij,b,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.gi,b,Object(D.a)(this,this.aA,"onKeyUp"));Rk.a.instance.ub(od.a.kt,b,Object(D.a)(this,this.yE,"onPointerDown"));Rk.a.instance.ub(od.a.EP,b,Object(D.a)(this,this.CCa,"onPointerUp"));mk.a.instance.ub(od.a.wS,b,Object(D.a)(this,this.iwb,"onTouchMove"));
mk.a.instance.ub(od.a.hM,b,Object(D.a)(this,this.DMa,"onTouchEnd"))}xn(){const b=this.Vd[je.a.On],h=this.Vd[je.a.IsRtl];this.h9j();if(0<(this.ov(this.properties.Command,this.properties.QueryCommand,this.Vd)&2)){var r=!xf.c(this.Vd[je.a.InnerHTML])||!xf.c(this.properties.InnerHTML),A=!xf.c(this.properties.Image);r||A||(this.control.enabled=!1);A=this.pka.fOb;if(!xf.c(A)){if(r){r=Ug.a.Qva(this.Vd[je.a.InnerHTML],this.properties.InnerHTML);if(null===A.innerHTML||null===r||F.a.xh(A.innerHTML)!==F.a.xh(r))A.innerHTML=
r;""===r&&(this.control.enabled=!1)}r=A.title;const L=Ug.a.Qva(this.Vd[je.a.Alt],this.properties.Alt);L===r||this.control.GAg||(A.title=L)}A=this.Vd[je.a.IsRtl];b===this.Vd[je.a.On]&&h===A||this.control.QWb()}}h9j(){const b=this.Vd;b[je.a.CommandValueId]=this.control.EPb();b.MenuItemId=this.control.fi.MenuItemId;b.SourceControlId=this.properties.Id}py(b,h,r){if((b=this.gl)&&this.control.enabled){const A=this.root;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelBorderMenuCompactionEnabled")&&
b.L9c()&&this.eK){const L=A.uE[this.eK.pva];L?L.$Za(this.Qic):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.h9j();this.Vd[je.a.On]||(this.Vd[je.a.On]=!0,this.control.QWb());"Menu"===b.UW&&Ug.a.Px(this.pka.Jn,"cui-gallerybutton-focused");A.executeCommand(this.properties.Command,this.Vd,b,h,!0,null,this.bP(r))}}onFocus(b){super.onFocus(b);Ug.a.sg(this.pka.Jn,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);
Ug.a.Px(this.pka.Jn,"cui-gallerybutton-focused");return!1}}Object(u.a)(af,"GalleryButtonBehavior",El,[]);var Wf=d(1700),Mg=d(1289),bi=d(2128);class zh extends El{constructor(b){super(b);this.w3a=-1}get Gmc(){return this.control}get properties(){return this.Gmc.fi}get VVc(){return this.Gmc.VVc}get wSf(){var b=null;if(this.gl&&(b=this.gl.parent,!Object(Gb.a)(bi.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get gSb(){return this.Gmc.Ibe.gSb}get ggd(){return this.Gmc.Ibe.ggd}py(b,
h,r){if(this.control.enabled){b=this.FJf(this.ijc(b));const A=this.V4d(b);this.VVc[Mg.a.Rows]=this.p8d(b)+1;this.VVc[Mg.a.Columns]=A+1;this.root.executeCommand(this.properties.Command,this.VVc,this.gl,h,!0,null,this.bP(r))}}VK(b){var h=b.Jn;const r=b.d0h;b=b.cells;Rk.a.instance.ub(od.a.qH,h,Object(D.a)(this,this.aYn,"onControlPointerOut"));mk.a.instance.ub(od.a.wS,h,Object(D.a)(this,this.cYn,"onControlTouchMove"));mk.a.instance.ub(od.a.hM,h,Object(D.a)(this,this.bYn,"onControlTouchEnd"));for(h=0;h<
b.length;++h)this.Gal(r[h],b[h])}Gal(b,h){bf.a.instance.ub(od.a.focus,b,Object(D.a)(this,this.gdg,"onCellFocus"));Rk.a.instance.ub(od.a.UL,h,Object(D.a)(this,this.hdg,"onCellPointerOver"));Rk.a.instance.ub(od.a.EP,h,Object(D.a)(this,this.idg,"onCellPointerUp"));Cb.KeyInputManager.instance.ub(od.a.ij,h,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.gi,h,Object(D.a)(this,this.aA,"onKeyUp"));mk.a.instance.ub(od.a.xS,h,Object(D.a)(this,this.eXn,"onCellTouchStart"))}FJf(b){return parseInt(b.id.substr(this.Gmc.id.length+
1))}OLi(b){this.NLi(this.FJf(b))}p8d(b){return Math.floor(b/Wf.a.led)}V4d(b){return b%Wf.a.led}NLi(b){if(b!==this.w3a){var h=this.V4d(b),r=this.p8d(b),A=-1;let L=-1;-1!==this.w3a&&(A=this.p8d(this.w3a),L=this.V4d(this.w3a));for(;A!==r||L!==h;)A<r?this.pPj(++A,L,!0):A>r?(this.pPj(A,L,!1),A--):L<h?this.TMj(++L,A,!0):L>h&&(this.TMj(L,A,!1),L--);this.wSf?this.wSf.dQj(this.lui(r+1,h+1)):(r=(h=this.control.Opf)&&0<h.length?h[0]:null,A=this.gl,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!A,["DispCompPar"]:!!A&&!!A.parent}));this.w3a=b}}pPj(b,h,r){for(let A=0;A<=h;A++)this.KMj(b,A,r)}TMj(b,h,r){for(let A=0;A<=h;A++)this.KMj(A,b,r)}KMj(b,h,r){h=b*Wf.a.led+h;b=this.gSb[h];h=this.ggd[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}idg(b){this.py(b.Df,b.yg,b.Lb);return!0}ijc(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return xf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}eQj(b){const h=this.FJf(b);b.childNodes[0].childNodes[0].title=this.lui(this.p8d(h)+1,this.V4d(h)+1)}lui(b,h){let r=this.properties.Alt;xf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}svc(){if(this.gl){for(var b=0;b<Wf.a.Orc;b++)this.gSb[b].className="cui-it-inactiveCell",this.ggd[b].className="cui-it-inactiveCellOuter";this.w3a=-1;b=this.properties.MenuSectionInitialTitle;
xf.c(b)&&(b="");this.wSf.dQj(b)}}hdg(b){this.control.enabled&&(b=this.ijc(b.Df),this.Cnd(b),this.pxf(b));return!1}pxf(b){this.eQj(b);this.OLi(b)}gdg(b){if(!this.control.enabled)return!1;b=this.ijc(b.Df);this.eQj(b);this.OLi(b);return!1}aYn(b){rd.a.UZf(this.Gmc.Ibe.Jn,b.clientPoint)||this.svc();return!1}eXn(b){if(!this.control.enabled)return!1;b=this.ijc(b.Df);this.pxf(b);return!0}cYn(b){if(!this.control.enabled)return!1;b=rd.a.J5d(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.ijc(b))?this.pxf(b):this.svc();return!0}bYn(b){if(!this.control.enabled)return!1;var h=rd.a.J5d(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.svc(),!0;(h=this.ijc(h))?this.py(h,3,b.Lb):this.svc();return!0}$M(b){b=ko.a.BDf(this.w3a,Wf.a.led,Wf.a.Orc,b);if(b!==this.w3a)return this.gSb[b].firstChild.focus(),this.NLi(b),!0;this.svc();this.w3a=-1;return!1}E0(){const b=this.gSb[0];if(xf.c(b))return!1;b.firstChild.focus();return!0}Cnd(b){if(xf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}$ta(){this.svc()}}Object(u.a)(zh,"InsertTableBehavior",El,[]);class Ah extends lo{constructor(b){super(b)}xn(){this.control.enabled=!!this.Jg}py(b,h,r){y.AFrameworkApplication.va.Qb(Za.a.CXa,2,h,this.bP(r))}}Object(u.a)(Ah,"JewelMenuLauncherBehavior",lo,[]);var Zi=d(1282);class sk extends El{constructor(b){super(b)}get properties(){return this.control.fi}xn(){0<(this.ov(this.properties.Command,this.properties.QueryCommand,this.Vd)&2)&&this.yfb()&&this.q0a()}q0a(){this.zBp();this.Zna();this.r2b()}zBp(){const b=
this.control.labelText;let h=this.Vd[Zi.a.Value];xf.c(h)&&(h=this.properties.LabelText,xf.c(h)&&(h=""));h!==b&&this.ixe(h)}VK(b){b=b.Jn;xf.c(b)||(Rk.a.instance.ub(od.a.kt,b,Object(D.a)(this,this.yE,"onPointerDown")),Rk.a.instance.ub(od.a.UL,b,Object(D.a)(this,this.cS,"onPointerOver")),Rk.a.instance.ub(od.a.qH,b,Object(D.a)(this,this.OL,"onPointerOut")))}}Object(u.a)(sk,"LabelBehavior",El,[]);var gm=d(1535),Gj=d(1421),En=d(1695);class Rm extends lo{constructor(b){super(b);this.TUe=this.HMe=!1;this.x7b=
this.O3b=null;if(this.b8b=y.AFrameworkApplication.J.$("TellMeRedesignIsEnabled"))this.O3b=this.qv.kna.LightImage16by16Class,this.x7b=this.qv.kna.DarkImage16by16Class}get qv(){return this.control}Nke(b,h,r,A){h&&(this.qv.Oka=r,y.AFrameworkApplication.ua.lyb());if(Object(Gb.a)(Gj.a,b)&&A){r=new gm.a;r.CommandLocation=this.root.kca;r.InvocationMethod=0;const L={};(b=b.control)&&b.fi&&(L.CommandId=b.fi.Command,L.ControlId=b.fi.Id,L.CloseAllMenus=h,b.eK&&b.eK.parent&&b.eK.parent.id&&(L.ParentControlId=
b.eK.parent.id.split("-")[0]),this.root.tH&&this.root.tH.SUa(A,L,r))}}aza(){this.qv.Oka||(this.qv.Oka=this.qv.Tz);!this.qv.gPn&&this.b8b&&(Ug.a.Px(this.qv.Tz,"cui-sb-focus"),Ug.a.Px(this.qv.C4,"cui-sb-focus"),Ug.a.Px(this.qv.FDa,this.O3b),Ug.a.sg(this.qv.FDa,this.x7b));this.HMe=!0;super.aza();this.HMe=!1;this.qog()}get bTj(){return!this.qv.gZa}Fme(){this.qv.Fme()}xse(){this.TUe||this.HMe||(this.TUe=!0,this.qv.raiseEvent(En.a.v$a,null))}qog(){this.vN||this.qv.xUf||(this.TUe=!1,this.qv.raiseEvent(En.a.CSb,
null))}reg(b){Ug.a.Px(this.qv.Tz,"cui-sb-focus");Ug.a.Px(this.qv.C4,"cui-sb-focus");this.b8b&&!this.qv.vN&&(Ug.a.Px(this.qv.FDa,this.O3b),Ug.a.sg(this.qv.FDa,this.x7b));this.qv.raiseEvent(En.a.blur,b);this.qog();this.qv.Oka=this.qv.Tz;return!1}teg(b){Ug.a.sg(this.qv.Tz,"cui-sb-focus");Ug.a.sg(this.qv.C4,"cui-sb-focus");this.b8b&&(Ug.a.Px(this.qv.FDa,this.x7b),Ug.a.sg(this.qv.FDa,this.O3b));this.qv.raiseEvent(En.a.focus,b);this.xse();return!1}Tfg(){this.b8b&&(Ug.a.sg(this.qv.C4,"cui-sb-hover"),Ug.a.sg(this.qv.Tz,
"cui-sb-hover"),Ug.a.Px(this.qv.FDa,this.x7b),Ug.a.sg(this.qv.FDa,this.O3b));return!1}Sfg(){this.b8b&&(Ug.a.Px(this.qv.C4,"cui-sb-hover"),Ug.a.Px(this.qv.Tz,"cui-sb-hover"),this.qv.vN||this.qv.xUf||(Ug.a.Px(this.qv.FDa,this.O3b),Ug.a.sg(this.qv.FDa,this.x7b)));return!1}}Object(u.a)(Rm,"SearchBoxBehavior",lo,[600,598]);class Si{}Si.Value="value";Si.MinValue="MinValue";Si.MaxValue="MaxValue";Si.Text="Text";Object(u.a)(Si,"SliderCommandProperties",null,[]);class rp extends El{constructor(b){super(b);
this.sga=()=>{this.pxl(this.G8.us.value);return!0}}get PCg(){return this.control}get G8(){return this.PCg.G8}get properties(){return this.control.fi}initialize(){}py(){}VK(b){b=b.us;bf.a.instance.ub(od.a.focus,b,Object(D.a)(this,this.onFocus,"onFocus"));bf.a.instance.ub(od.a.blur,b,Object(D.a)(this,this.onBlur,"onBlur"));bf.a.instance.ub(od.a.UUc,b,this.sga);bf.a.instance.ub(od.a.input,b,this.sga)}onFocus(b){this.G8.Jn&&Sys.UI.DomElement.addCssClass(this.G8.Jn,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.G8.Jn&&
Sys.UI.DomElement.removeCssClass(this.G8.Jn,"cui-sldr-onfocus");return super.onBlur(b)}pxl(b){this.Vd[Si.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Vd,this.gl,0,!1)}xn(){const b=this.Vd[Si.Value],h=this.Vd[Si.MaxValue],r=this.Vd[Si.Text];var A=this.ov(this.properties.Command,this.properties.QueryCommand,this.Vd);this.G8&&this.G8.us&&(this.G8.us.disabled=!this.control.enabled);if(0<(A&2)){A=this.Vd[Si.Value];const L=this.Vd[Si.MaxValue],Z=this.Vd[Si.Text];(L!==h||A!==
b||r!==Z)&&this.G8&&this.G8.us&&(this.G8.us.setAttribute($c.a.CSd,String.format("{0}",L)),this.G8.us.setAttribute("max",String.format("{0}",L)),this.G8.us.value=A,this.G8.lR.innerText=this.Vd[Si.Text])}}}Object(u.a)(rp,"SliderBehavior",El,[]);var Ji=d(1280);class Fn extends El{constructor(b){super(b);this.BHd=0;this.vlb=null;this.YEd=!1;this.RJh=null;this.C8e=!1;this.AKd=this.ZId=-1;this.oGa=!1;this.HI=()=>!this.control.enabled;this.sga=()=>{this.JW();return!1};this.ueg=()=>this.oGa?!1:this.oGa=!0;
this.Vij=h=>{var r=!1;let A=!0;2===h.yg&&(A=h.mga===Sys.UI.MouseButton.leftButton);A&&(r=h.Df,this.GXj(r===this.VI.khc||r===this.VI.Pii||r===this.VI.Oii,h.yg),r=!0);return r};this.Wij=h=>this.Dza(h);this.sEo=()=>{this.p_h();-1===this.AKd&&(this.cAe(),this.AKd=window.setInterval(Object(D.a)(this,this.cAe,"spin"),50))}}get J0b(){return this.control}get VI(){return this.J0b.VI}get properties(){return this.control.fi}initialize(){const b=this.J0b.eMg;this.RJh=this.ttp(b);this.BHd=b[0].min;this.vlb=b[0];
this.YEd=!1}py(){}VK(b){const h=b.us,r=b.khc;b=b.TZc;bf.a.instance.ub(od.a.focus,h,Object(D.a)(this,this.onFocus,"onFocus"));bf.a.instance.ub(od.a.blur,h,Object(D.a)(this,this.onBlur,"onBlur"));Cb.KeyInputManager.instance.ub(od.a.ij,h,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.lv,h,this.HI);Cb.KeyInputManager.instance.ub(od.a.gi,h,Object(D.a)(this,this.aA,"onKeyUp"));bf.a.instance.ub(od.a.UUc,h,this.sga);Zf.a.instance.ub(od.a.Fba,h,this.ueg);Rk.a.instance.ub(od.a.kt,
r,this.Vij);Rk.a.instance.ub(od.a.kt,b,this.Vij);Rk.a.instance.ub(od.a.EP,r,this.Wij);Rk.a.instance.ub(od.a.EP,b,this.Wij);mk.a.instance.ub(od.a.wS,r,Object(D.a)(this,this.Yij,"onArrowTouchMove"));mk.a.instance.ub(od.a.wS,b,Object(D.a)(this,this.Yij,"onArrowTouchMove"));mk.a.instance.ub(od.a.hM,r,Object(D.a)(this,this.Xij,"onArrowTouchEnd"));mk.a.instance.ub(od.a.hM,b,Object(D.a)(this,this.Xij,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Ug.a.sg(this.VI.Jn,"cui-spn-focus");this.control.enabled&&
rd.a.Kmd(this.VI.us);return this.oGa=!1}onBlur(b){super.onBlur(b);Ug.a.Px(this.VI.Jn,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!xf.c(b.Lb)&&!xf.c(b.Lb.rawEvent)){const r=b.Lb.keyCode,A=b.Lb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||r===Sys.UI.Key.down)this.root.fXf(this.control)||this.GXj(r===Sys.UI.Key.up,b.yg),h=!0;else if(r===Sys.UI.Key.enter)this.JW(),Object(Gb.a)(Xb.Ribbon,this.root)&&this.root.u2(),h=!0;else if(r===Sys.UI.Key.tab)this.JW(),Object(Gb.a)(Xb.Ribbon,this.root)&&(h=this.root.tGe(this.gl.Tc,
!A));else if(r===Sys.UI.Key.esc)this.uvc(),Object(Gb.a)(Xb.Ribbon,this.root)&&this.root.u2(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}aA(){this.NNl();return!1}Yij(b){return this.nle(b)}Xij(b){return this.Dza(b)}z5m(b){if(this.control.enabled){var h=!1;if(!this.YEd){var r=this.vwm(b);r=b?r+this.vlb.step:r-this.vlb.step;r=Math.min(r,this.vlb.max);r=Math.max(r,this.vlb.min);r!==this.BHd&&(this.zpf(r,this.vlb),this.root.executeCommand(this.properties.Command,
this.Vd,this.gl,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Vd,r.Increment=b,xf.c(h)||this.root.executeCommand(h,r,this.gl,0,!1))}}vwm(b){const h=Math.pow(10,y.AFrameworkApplication.numberFormat.Wke),r=Math.round(this.vlb.step*h);let A=Math.round(this.BHd*h)/r;A=b?Math.floor(A):Math.ceil(A);return A*r/h}GXj(b,h){if(this.control.enabled){this.JW();const r=b?this.VI.khc:this.VI.TZc;switch(h){case 2:case 3:this.C8e=b;this.lQd(r);break;case 1:this.C8e=b,this.oUk(r)}}}lYj(){this.p_h();this.tml()}Hdi(){-1===
this.ZId&&(this.ZId=window.setTimeout(this.sEo,500))}p_h(){this.ZId=Ug.a.LLb(this.ZId)}tml(){this.AKd=Ug.a.pml(this.AKd)}cAe(){this.z5m(this.C8e)}oUk(b){this.root.$ja(this.control,!1);Ug.a.sg(b,Mk.a.oQd);this.cAe();this.Hdi()}NNl(){this.root.Vea(this.control,!1);this.lYj();Ug.a.Px(this.VI.khc,Mk.a.oQd);Ug.a.Px(this.VI.TZc,Mk.a.oQd)}Rwc(b){this.VI.us.value!==b&&(this.VI.us.value=b)}uvc(){this.Rwc(this.Vd[Ji.a.Text])}jNj(b){this.Rwc(b);this.Vd[Ji.a.Text]=b;this.YEd=!0}DTo(b,h,r){this.Rwc(r);this.Vd[Ji.a.Text]=
r;this.Vd[Ji.a.Number]=b;this.Vd[Ji.a.UnitType]=h.type;this.BHd=b;this.vlb=h;this.VI.us.setAttribute($c.a.Bif,r);this.VI.us.setAttribute($c.a.pUh,String.format("{0}",h.min));this.VI.us.setAttribute($c.a.CSd,String.format("{0}",h.max));this.YEd=!1}Y4h(b){var h;if(({SSn:h}=this.Zsn(b)).returnValue)this.jNj(h);else{({number:b,lfb:h}=F.a.Irj(b,this.RJh,y.AFrameworkApplication.numberFormat));let r=this.XDe(h);0===h&&xf.c(r)&&(r=this.XDe(this.Vd[Ji.a.UnitType]));this.zpf(b,r)}}zpf(b,h){b=this.qbg(b,h);
if(isNaN(b)||xf.c(h))this.uvc();else{const r=y.AFrameworkApplication.numberFormat;let A;A=F.a.RJa(b,h.type,r);A=A.replace(6===h.type?r.Xke:r.jjg,"");this.DTo(b,h,A)}}Zsn(b){let h,r=!1;h="";b=b.trim();const A=this.J0b.N$j;if(!xf.c(A))for(let L=0;L<A.length;L++)if(A[L].toLowerCase()===b.toLowerCase()){h=A[L];r=!0;break}return{returnValue:r,SSn:h}}qbg(b,h){return isNaN(b)||xf.c(h)?Number.NaN:h.qbg(b)}XDe(b){let h=null;const r=this.J0b.eMg;for(let A=0;A<r.length;A++)if(r[A].type===b){h=r[A];break}return h}ttp(b){const h=
b.length,r=Array(h);for(let A=0;A<h;A++)r[A]=b[A].type;return r}JW(){if(this.control.enabled){const b=this.Vd[Ji.a.Text],h=this.VI.us.value;h!==b&&(this.Y4h(h),this.Vd[Ji.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Vd,this.gl,0,!1))}else this.uvc()}xn(){var b=this.Vd[Ji.a.Text],h=this.Vd[Ji.a.Number];const r=this.Vd[Ji.a.UnitType],A=this.Vd[Ji.a.MaxValue];if(0<(this.ov(this.properties.Command,this.properties.QueryCommand,this.Vd)&2)){const L=this.Vd[Ji.a.Text],Z=this.Vd[Ji.a.Number],
oa=this.Vd[Ji.a.UnitType],Ba=this.Vd[Ji.a.MaxValue];Ba!==A&&(this.XDe(oa).max=Ba,this.VI.us.setAttribute($c.a.CSd,String.format("{0}",Ba)));L!==b?""===L?this.jNj(L):this.Y4h(L):isNaN(Z)||Z===h&&oa===r||this.zpf(Z,this.XDe(oa));b=this.VI.Jn.title;h=Ug.a.Qva(this.Vd[Ji.a.Alt],this.properties.Alt);h!==b&&(this.VI.us.title=h,this.VI.khc.title=h,this.VI.TZc.title=h)}}ddf(b){super.ddf(b);b?(this.cAe(),this.Hdi()):this.lYj()}}Object(u.a)(Fn,"SpinnerBehavior",El,[599,598]);var ml=d(426),jn=d(1183);class Gn extends lo{constructor(b){super(b);
this.a9b=!0;this.hCb=!1}get J8(){return this.control}get gu(){return this.J8.properties}VK(b){const h=b.Jn,r=b.$ob;b=b.VZc;bf.a.instance.ub(od.a.focus,h,Object(D.a)(this,this.onFocus,"onFocus"));bf.a.instance.ub(od.a.blur,h,Object(D.a)(this,this.onBlur,"onBlur"));Cb.KeyInputManager.instance.ub(od.a.ij,h,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.gi,h,Object(D.a)(this,this.aA,"onKeyUp"));aa.a.au&&16>this.Tqm()&&(Rk.a.instance.ub(od.a.kt,h,Object(D.a)(this,this.foj,
"onSplitbuttonPointerDownPointerUp")),Rk.a.instance.ub(od.a.EP,h,Object(D.a)(this,this.foj,"onSplitbuttonPointerDownPointerUp")));Rk.a.instance.ub(od.a.UL,r,Object(D.a)(this,this.PWn,"onButtonPointerOver"));Rk.a.instance.ub(od.a.qH,r,Object(D.a)(this,this.OWn,"onButtonPointerOut"));Rk.a.instance.ub(od.a.kt,r,Object(D.a)(this,this.mjj,"onButtonPointerDown"));Rk.a.instance.ub(od.a.EP,r,Object(D.a)(this,this.njj,"onButtonPointerUp"));mk.a.instance.ub(od.a.wS,r,Object(D.a)(this,this.RWn,"onButtonTouchMove"));
mk.a.instance.ub(od.a.hM,r,Object(D.a)(this,this.QWn,"onButtonTouchEnd"));Rk.a.instance.ub(od.a.kt,b,Object(D.a)(this,this.Reg,"onMenuButtonPointerDown"));Rk.a.instance.ub(od.a.UL,b,Object(D.a)(this,this.B0n,"onMenuButtonPointerOver"));Rk.a.instance.ub(od.a.qH,b,Object(D.a)(this,this.A0n,"onMenuButtonPointerOut"))}py(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.hCb&&(this.J8.on=!this.J8.on,b=this.Vd,b.CommandValueId=this.control.EPb(),this.root.executeCommand(this.gu.Command,b,this.gl,
h,!0,null,this.bP(r))):this.a9b&&super.py(b,h,r)}aA(b){const h=b.Lb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Vd,b.CommandValueId=this.control.EPb(),this.root.executeCommand(this.gu.Command,b,this.gl,1,!0),!0):super.aA(b)}xn(){const b=this.root.sua(this.gu.Command,this.gu.QueryCommand,this.Vd),h=0<(b&1);let r=!0;r=xf.c(this.gu.CommandMenuOpen)?h:0<(this.root.sua(this.gu.CommandMenuOpen,null,null)&1);if(r!==this.a9b||h!==this.hCb||(r||h)!==this.control.enabled)this.control.enabled=
r||h,h!==this.hCb&&this.YYn(h),r!==this.a9b&&this.ZYn(r),this.a9b=r,this.hCb=h;if(0<(b&2)){this.Zna();const A=Ug.a.Qva(this.Vd[jn.a.LabelText],this.gu.LabelText);this.Vd[jn.a.ApplyLabelTextToControlOnly]?this.J8.Aic(L=>{L.Jn.title=A;L.$ob.removeAttribute("title");L.VZc.removeAttribute("title")}):this.J8.Aic(L=>{L.$ob.title=A});this.Vd[jn.a.EnsureControlRoleIsButton]&&this.J8.Aic(L=>{$c.a.Is(L.Jn,$c.a.Wh,$c.a.N$)});xf.c(this.Vd[jn.a.Visible])||this.yfb()&&this.q0a()}this.J8.setState(this.J8.on&&h)}q0a(){this.GKg();
this.r2b();this.Zna()}ZYn(b){this.J8.Aic(h=>{Ug.a.kyb(h.VZc,b)});this.skd();this.a9b=b}YYn(b){this.J8.Aic(h=>{Ug.a.kyb(h.$ob,b)});this.skd();this.hCb=b}skd(){const b=this.J8.Kqb();xf.c(b)||(Ug.a.Px(b.childNodes[0],"cui-ctl-split-hovered-primary"),Ug.a.Px(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Ug.a.Px(b.childNodes[1],"cui-ctl-split-hovered-primary"),Ug.a.Px(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}foj(b){if(0!==ml.a(b.Lb))return!1;let h=!1;b.eventName===od.a.kt?h=this.mjj(b):
b.eventName===od.a.EP&&(h=this.njj(b));return h}mjj(b){let h=!1;const r=b.yg;switch(r){case 3:this.Q6o()?this.py(this.gl.Tc,r,b.Lb):this.lQd(this.J8.zgi);h=!0;break;case 2:b.mga===Sys.UI.MouseButton.leftButton&&(this.lQd(this.J8.zgi),h=!0)}h&&b.Lb.preventDefault();return!1}Q6o(){const b=this.gl.UW;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}njj(b){return this.Dza(b)}RWn(b){return this.nle(b)}QWn(b){return this.Dza(b)}onFocus(b){super.onFocus(b);this.gSf(!0,!0);return!1}onBlur(b){super.onFocus(b);
this.skd();return!1}PWn(){this.control.enabled&&this.hCb&&this.gSf(!0,this.J8.on);return!1}OWn(){this.control.enabled&&this.hCb&&this.skd();return!1}Reg(b){let h=!1;if(2!==b.yg||b.mga===Sys.UI.MouseButton.leftButton)this.py(b.Df,b.yg,b.Lb),h=!0;h&&b.Lb.preventDefault();return!1}B0n(){this.control.enabled&&this.a9b&&this.gSf(this.J8.on,!0);return!1}A0n(){this.skd();return!1}gSf(b,h){const r=this.control.Kqb();xf.c(r)||(Ug.a.sg(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),
Ug.a.sg(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}Tqm(){var b=aa.a.Ygc;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(u.a)(Gn,"SplitButtonBehavior",lo,[]);var gl=d(1288);class rj extends El{constructor(b){super(b);this.REb=this.oGa=!1;this.Suk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelTableRenameEnabled");this.HI=()=>!this.control.enabled;this.sga=()=>{this.JW();return!1};this.BCa=()=>this.Oha.isEditable?this.oGa?!1:
this.oGa=!0:(rd.a.Kmd(this.Oha.us),!0)}get crd(){return this.control}get Oha(){return this.crd.Oha}get gGg(){return this.crd.fi}VK(b){b=b.us;bf.a.instance.ub(od.a.focus,b,Object(D.a)(this,this.onFocus,"onFocus"));bf.a.instance.ub(od.a.blur,b,Object(D.a)(this,this.onBlur,"onBlur"));Cb.KeyInputManager.instance.ub(od.a.ij,b,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.lv,b,this.HI);Cb.KeyInputManager.instance.ub(od.a.gi,b,Object(D.a)(this,this.aA,"onKeyUp"));bf.a.instance.ub(od.a.UUc,
b,this.sga);Zf.a.instance.ub(od.a.Fba,b,this.BCa)}onFocus(b){super.onFocus(b);this.REb=!0;Ug.a.sg(this.Oha.Jn,"cui-tb-focus");this.control.enabled&&rd.a.Kmd(this.Oha.us);return this.oGa=!1}onBlur(b){this.REb=!1;super.onBlur(b);Ug.a.Px(this.Oha.Jn,"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!xf.c(b.Lb)&&!xf.c(b.Lb.rawEvent)){const r=b.Lb.keyCode,A=b.Lb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.JW(),Object(Gb.a)(Xb.Ribbon,this.root)&&(h=this.root.tGe(this.gl.Tc,!A))):r===Sys.UI.Key.enter?
this.Suk&&(this.JW(),Object(Gb.a)(Xb.Ribbon,this.root)&&this.root.u2(),h=!0):r===Sys.UI.Key.esc?(this.uvc(),Object(Gb.a)(Xb.Ribbon,this.root)&&this.root.u2(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.bza&&(zc.a.m_h(b.Lb),h=!1)}return h}aA(){return!1}Rwc(b){this.Oha.us.value!==b&&(this.Oha.us.value=b)}uvc(){this.Rwc(this.Vd[gl.a.Text])}JW(){if(this.control.enabled&&this.Oha.isEditable){const b=this.Oha.us.value;b!==this.Vd[gl.a.Text]&&(this.Vd[gl.a.Text]=b,this.root.executeCommand(this.gGg.Command,
this.Vd,this.gl,0,!1))}else this.uvc()}xn(){const b=this.Vd[gl.a.Text];if(0<(this.ov(this.gGg.Command,this.gGg.QueryCommand,this.Vd)&2)&&!this.REb){const h=this.Vd[gl.a.Text];h!==b&&this.Rwc(h)}}}Object(u.a)(rj,"TextBoxBehavior",El,[597,598]);var tk=d(1866);class fp extends El{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.fi}py(b,h,r){this.control.enabled&&(Ug.a.Vla(this.properties.TogglesWhenExecuted)||this.toggle(),this.Vd.CommandValueId=this.toggleButton.EPb(),
this.Vd.MenuItemId=this.toggleButton.fi.MenuItemId,this.Vd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Vd,this.gl,h,!Ug.a.Vla(this.properties.CloseMenuWhenExecuted),A=>{Ug.a.Zs(this.properties.UpdateHtmlPostToggle)&&(32===A?this.r1j():this.p1j())},this.bP(r)))}p1j(){this.Vd[Tg.a.On]=!this.Vd[Tg.a.On]}r1j(){this.toggleButton.setState(this.Vd[Tg.a.On]);(this.toggleButton.CEa&&this.toggleButton.fFe||Ug.a.Zs(this.properties.UpdateHtmlPostToggle))&&this.q0a()}toggle(){this.p1j();
Ug.a.Zs(this.properties.UpdateHtmlPostToggle)||this.r1j()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!xf.c(b.Lb)&&this.eK){const r=b.Lb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Lb.preventDefault()}return h}xn(){xf.c(this.properties.MenuItemId)||(this.Vd.MenuItemId=this.properties.MenuItemId);0<(this.ov(this.properties.Command,this.properties.QueryCommand,this.Vd)&2)&&this.yfb()&&this.q0a()}q0a(){this.toggleButton.setState(this.Vd[Tg.a.On]);this.Ywp(Ug.a.Qva(this.Vd[Tg.a.DisplayMode],
""));this.GKg();this.Zna();this.Hyp();Tg.a.Alt in this.Vd&&this.r2b()}Hyp(){const b=this.WG.Qpc;if(b&&b.apb){var h=Ug.a.Qva(this.Vd[Tg.a.Description],this.properties.Description);h!==b.apb.innerText&&(b.apb.innerText=h,b.lR&&!Object(Gb.a)(tk.a,this.root)&&(h=!xf.b(h),Ug.a.X8(b.lR,"UIFontBold",h),Ug.a.X8(b.lR,"cui-ctl-mediumlabel-nodescription",!h)))}}VK(b){b=b.Jn;bf.a.instance.ub(od.a.focus,b,Object(D.a)(this,this.onFocus,"onFocus"));bf.a.instance.ub(od.a.blur,b,Object(D.a)(this,this.onBlur,"onBlur"));
Rk.a.instance.ub(od.a.UL,b,Object(D.a)(this,this.cS,"onPointerOver"));Rk.a.instance.ub(od.a.qH,b,Object(D.a)(this,this.OL,"onPointerOut"));Cb.KeyInputManager.instance.ub(od.a.ij,b,Object(D.a)(this,this.onKeyDown,"onKeyDown"));Cb.KeyInputManager.instance.ub(od.a.gi,b,Object(D.a)(this,this.aA,"onKeyUp"));Rk.a.instance.ub(od.a.kt,b,Object(D.a)(this,this.yE,"onPointerDown"));Rk.a.instance.ub(od.a.EP,b,Object(D.a)(this,this.CCa,"onPointerUp"));jg.a.instance.ub(od.a.click,b,Object(D.a)(this,this.onClick,
"onClick"));mk.a.instance.ub(od.a.wS,b,Object(D.a)(this,this.iwb,"onTouchMove"));mk.a.instance.ub(od.a.hM,b,Object(D.a)(this,this.DMa,"onTouchEnd"))}}Object(u.a)(fp,"ToggleButtonBehavior",El,[]);class mj{constructor(b){this.hrk=b;this.rRe={["Button"]:h=>new Em(h),["FileMenuButton"]:h=>new Em(h),["ColorPicker"]:h=>new $n(h),["ComboBox"]:h=>new rc(h),["ContextMenuControl"]:h=>new Zc(h),["ContextMenuLauncher"]:h=>new Zc(h),["DialogMenuLauncher"]:h=>new Hd(h),["DropDown"]:h=>new Ua(h),["FlyoutAnchor"]:h=>
new Xd(h),["GalleryButton"]:h=>new af(h),["StatefulColorFlyoutAnchor"]:h=>new Xd(h),["JewelMenuLauncher"]:h=>new Ah(h),["Label"]:h=>new sk(h),["Placeholder"]:h=>new El(h),["SearchBox"]:h=>new Rm(h),["Separator"]:h=>new El(h),["SplitButton"]:h=>new Gn(h),["StatefulColorSplitButton"]:h=>new Gn(h),["StatefulImageSplitButton"]:h=>new Gn(h),["TextBox"]:h=>new rj(h),["ToggleButton"]:h=>new fp(h)}}kji(){this.rRe[Mk.a.GSi]=b=>new zh(b)}lzf(){this.rRe[Mk.a.DWj]=b=>new Fn(b)}$im(b){const h=this.rRe[b.controlType];
(b=h?h(b):null)&&this.hrk&&b.U_l();return b}static get instance(){return mj._instance||(mj._instance=new mj(!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("CUICommitChangeFixIsEnabled")))}}mj._instance=null;Object(u.a)(mj,"ControlBehaviorFactory",null,[586]);var xs=d(1586),qr=d(1410);class Up extends xm.MenuLauncher{constructor(b,h,r,A){super(b,h,r,A);this.Gsh=null;this.XSa=this.KRc=0;this.tH=null;this.EKc=this.DKc=0;this.Bh("Menu");this.enabled=!0}get x(){return this.KRc}get y(){return this.XSa}get z2f(){return this.DKc}get A2f(){return this.EKc}get controlType(){return"DialogMenuLauncher"}Ndb(){}pfb(){}XGf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.gu.DialogMoveCommand;b.DialogCloseCommand=this.gu.DialogCloseCommand;return b}Pyn(b,h){this.KRc=b.x;this.XSa=b.y;this.DKc=b.height;this.EKc=b.width;this.m3(h)}WT(b){this.Gsh=Ug.a.createElement("span");return new qr.a(b,this.Gsh)}get gu(){return this.fi}gza(b,h,r){return new Up(b,this.id,h,r)}}Object(u.a)(Up,"DialogMenuLauncher",xm.MenuLauncher,[]);var dr=d(1587);class Fi extends xs.a{constructor(b,h){super(b,h);this.mgb=null}get gdf(){return this.mgb}get jfi(){return this.properties}get kca(){return 20}yn(){super.yn();
xf.c(this.Tc)&&this.mE();this.Tc=Ug.a.EZa(this.Tc);this.SZ(this.Tc);this.dirty=!1}nR(b){if(!Object(Gb.a)(dr.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}bsf(b,h,r,A){r=new jh.Menu(this,h,r,A,null);b||(b={});b.CommandMenuOpen=this.jfi.CommandMenuOpen;b.CommandMenuClose=this.jfi.CommandMenuClose;b=new Up(this,h,b,r);this.Ffc[h]=b;h=new dr.a(this,"dock"+h);h.Wf(b.MW("Menu"));this.Wf(h);this.refresh()}GBg(b,h,r,A){const L=this.Ffc[b];if(xf.c(L))throw Error.create('The dialog menu "'+
b+'" does not exist');L.Pyn(new Sys.UI.Bounds(h,r,0,0),A);this.mgb=L.Jg}Eof(b){b=this.Ffc[b];xf.c(b)||(b.aza(),this.mgb=null)}Gme(){this.mgb=null}dispose(){const b=this.Ffc;for(const h in b)b[h].dispose();super.dispose()}}Object(u.a)(Fi,"DialogMenuRoot",xs.a,[]);class bo{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(u.a)(bo,"RootProperties",null,[]);class gp extends bo{constructor(){super()}}Object(u.a)(gp,"StandaloneRootProperties",bo,[]);class ci extends gp{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(u.a)(ci,"DialogMenuRootProperties",gp,[]);class Mm{constructor(){this.ckg=(h,r,A,L,Z)=>{if(1===A)return 32;h=new Sys.StringBuilder;h.append('<Menu Id="dialogMenu">');h.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');h.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',Z.DialogMoveCommand,CommonUIStrings.l_DialogMove));h.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',Z.DialogCloseCommand,
CommonUIStrings.l_DialogClose));h.append("</Controls></MenuSection>");h.append("</Menu>");Z.PopulationXML=h.toString();return 32};const b=new ci;b.ImageSideArrow=y.AFrameworkApplication.Lr;b.ImageSideArrowClass=Pb.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ed=new Fi("DialogMenuRootId",b);this.Ed.tH=this;this.Ed.refresh();y.AFrameworkApplication.va.fb(Za.a.ckg,Gc.a.frame,this.ckg,96)}get T8(){return this.Ed}SUa(b,h,r,A,L=null){b=parseInt(b);
A=y.AFrameworkApplication.va;r&&(A.gE=r.CommandLocation,A.b3=r.InvocationMethod);h=A.Qb(b,2,h,L);this.Ed.refresh();return 32===h}xLa(b){return b?32===y.AFrameworkApplication.va.Ob(parseInt(b),1):!0}ov(){this.T8.root.xn()}bsf(b,h,r){const A={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};A.DialogMoveCommand=h;A.DialogCloseCommand=r;this.T8.bsf(A,b,"","")}GBg(b,h,r,A){this.T8.GBg(b,h,r,A)}Eof(b){this.T8.Eof(b)}dispose(){this.Ed&&(this.Ed.dispose(),
this.Ed=null)}}Object(u.a)(Mm,"DialogMenuRootUser",null,[406,10,460]);class ys{constructor(b,h,r){this.SCb=this.TMd=this.MLc=this.jl=null;this.YUe=this.iMd=!1;this.Mtc=A=>{if(!this.uTf)return!1;A.Lb.preventDefault();this.ZAf();return!0};this.RHc=b;this.oe=h;this.rx=r;this.a8b=y.AFrameworkApplication.isRtl}get uTf(){return this.YUe}J2l(b){b?(this.jl=b,this.YUe=!0,this.iMd=!1,this.oe.capture(Object(D.a)(this,this.pxn,"keyEventHandler"),null),this.rx.ub(od.a.kt,this.RHc,this.Mtc),this.MLc||this.XHl(),
this.jl.appendChild(this.MLc),this.g8m()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}ZAf(){this.YUe=!1;this.TMd=this.SCb=null;this.sAo();this.uqg();this.jl=null}uqg(){this.oe.releaseCapture();this.rx.xc(od.a.kt,this.RHc,this.Mtc)}g8m(){if(this.jl.style.left.endsWith("px")&&this.jl.style.right.endsWith("px"))this.SCb=new Sys.UI.Point(Dn.a.y0(this.a8b?this.jl.style.right:this.jl.style.left),Dn.a.y0(this.jl.style.top));else{const b=this.a8b?this.RHc.offsetWidth-(this.jl.offsetLeft+
this.jl.offsetWidth+Dn.a.y0(this.jl.style.marginRight)):this.jl.offsetLeft-Dn.a.y0(this.jl.style.marginLeft),h=this.jl.offsetTop-Dn.a.y0(this.jl.style.marginTop);this.MPj(b,h);this.SCb=new Sys.UI.Point(b,h)}this.TMd=this.SCb}XHl(){this.MLc=Pb.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}sAo(){this.MLc.parentNode===this.jl&&this.jl.removeChild(this.MLc)}pxn(b){if(!this.uTf)return!1;b.Lb.preventDefault();if(b.eventName===od.a.ij){const h=b.Lb.ctrlKey?1:10;let r;switch(b.Lb.keyCode){case jf.a.i9:this.trc(0,
-1*h);break;case jf.a.aia:this.trc(0,1*h);break;case jf.a.M2b:r=this.a8b?1:-1;this.trc(r*h,0);break;case jf.a.N2b:r=this.a8b?-1:1;this.trc(r*h,0);break;case jf.a.Dfb:this.Dej(this.TMd.x,this.TMd.y);this.iMd=!0;break;case jf.a.Pu:this.iMd=!0}}b.eventName===od.a.gi&&this.iMd&&this.ZAf();return!0}trc(b,h){this.Dej(this.SCb.x+b,this.SCb.y+h)}Dej(b,h){b=this.U3k(b,h);this.MPj(b.x,b.y);this.SCb=b}MPj(b,h){this.a8b?this.jl.style.right=b+"px":this.jl.style.left=b+"px";this.jl.style.top=h+"px"}U3k(b,h){const r=
this.a8b?Dn.a.y0(this.jl.style.marginRight):Dn.a.y0(this.jl.style.marginLeft),A=Dn.a.y0(this.jl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.RHc.offsetWidth-this.jl.offsetWidth-r),Math.min(Math.max(-A,h),this.RHc.offsetHeight-this.jl.offsetHeight-A))}}Object(u.a)(ys,"KeyMoveAdapter",null,[461]);var di=d(1682),Vp=d(1502);class zs{get name(){return"CUI.Behavior"}wc(b){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&(b.register(460,"Common.UI.IDialogMenuRootUser").ha().Ud(()=>
new Mm),b.register(461,"Common.IKeyMoveAdapter").ha().Ud(()=>new ys(y.AFrameworkApplication.ua.ksa(),Cb.KeyInputManager.instance,Rk.a.instance)));b.register(Vp.a,"CommandUI.RootManager").as("Common.IRootManager").ha().Ud(()=>Vp.a.instance)}init(){di.a.brf=mj.instance;const b=Vp.a.instance.eve;for(let h=0;h<b.length;++h){const r=Object(Ca.a)(462,b[h]);r&&r.LUa()}zk.a.get_instance().kK(6)}dispose(){}static main(){E.a.instance.Mc(new zs,5)}}Object(u.a)(zs,"CuiBehaviorPackage",null,[0,1]);class sp{constructor(b){const h=
new gp;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Pb.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Pb.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Pb.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=Pb.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Pb.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Pb.getImageClass("CheckboxChecked_16x16x32");
h.ImageUncheckMarkClass=Pb.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.blb=xs.a.EKl(h);this.blb.refresh()}get uha(){return this.blb}dispose(){this.blb.dispose()}}Object(u.a)(sp,"StandaloneRootController",null,[1758,10]);var Lq=d(1791),Ak=d(228);class Jr{constructor(b){this.sOc=b}create(b,h){const r=new Sys.StringBuilder;this.OXc(r,b,h);this.vsf(r,b);return r.toString()}RMb(b,h){const r=[];this.jtf(r,b,h);this.wsf(r,b);return r}OXc(b,h,
r){switch(h.errorType){case 0:b.append(this.sOc.build());break;case 1:case 2:b.append(this.plf(h,r))}}jtf(b,h,r){switch(h.errorType){case 0:b.push(this.sOc.KXh());break;case 1:case 2:b.push(this.ngl(h,r))}}vsf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Ak.a("btnIgrnoreSpellingError",(2===h.errorType?vb.a.OOa:vb.a.eBa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}wsf(b,h){const r=Object.assign(new hh.a,
{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new Mj.a,{ExternalId:h}));b.push(r)}plf(b,h){b=this.yfm(b.suggestions,h);return 0<b.length?Ak.g("msUnknownWord",Ak.d(null,b),"Menu16"):Ak.g("msUnknownWord",Ak.d(null,[Ak.a("btnNoSuggestions",vb.a.OOa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}yfm(b,h){const r=[];if(b){const A=Math.min(h.length,b.length);for(let L=0;L<A;++L)b[L]&&r.push(Ak.a("btnCorrectWord"+L,h[L].toString(),
b[L]))}return r}ngl(b,h){const r=Object.assign(new hh.a,{Id:"Suggestions",ControlList:[]});this.xfm(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new Mj.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}xfm(b,h,r){if(b){const A=Math.min(h.length,b.length);for(let L=0;L<A;++L){if(!b[L])continue;const Z=Object.assign(new Mj.a,{ExternalId:"btnCorrectWord"+L,Command:h[L].toString(),LabelText:b[L]});r.push(Z)}}}}Object(u.a)(Jr,"DefaultProofingContextMenuCreator",
null,[]);var Vo=d(727);class vq{constructor(b,h){this.Pdh=b;this.Sfh=h;this.aqa=[vb.a.Rzb,vb.a.Szb,vb.a.Tzb,vb.a.m1b,vb.a.n1b]}create(b,h){return h?Object(Gb.a)(Vo.a,h)?this.Sfh.create(b,h,this.aqa):this.Pdh.create(h,this.aqa):""}yfc(b,h){return h?Object(Gb.a)(Vo.a,h)?this.Sfh.RMb(b,h,this.aqa):this.Pdh.RMb(h,this.aqa):null}}Object(u.a)(vq,"ProofingContextMenuSectionFactory",null,[478]);class rr{build(){const b=[Ak.a("btnDeleteRepeatedWord",vb.a.aJa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,
null)];return Ak.g("msRepeatedWord",Ak.d(null,b),"Menu16")}KXh(){const b=Object.assign(new hh.a,{ControlList:[]}),h=Object.assign(new Mj.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(u.a)(rr,"ProofingRepeatedWordSectionBuilder",null,[477]);class om{static get mh(){return Dg.a.uy(om.lo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}om.lo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(u.a)(om,"AutoCorrectOptionsDialogHTML",null,[]);class qn{static get mh(){return Dg.a.uy(qn.lo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}qn.lo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(u.a)(qn,"AutoCorrectOptionsDialogHTML2",null,[]);class as extends Dg.a{constructor(b,h){super();this.vSo=(r,A)=>{1!==r?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):A.ReplaceTextAsYouType!==this.KY.JZa||A.CapitalizeFirstLetterOfSentences!==this.KY.oUd||A.ReplaceOrdianalsWithSuperscript!==this.KY.fue||A.ReplaceHyphensWithDash!==this.KY.Ukd||A.ReplaceFractionsWithFractionCharacter!==this.KY.eue||this.oja&&A.ReplaceQuoteWithSmartQuote!==
this.KY.zsg?(r={},r.ReplaceTextAsYouType=A.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=A.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=A.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=A.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=A.ReplaceFractionsWithFractionCharacter,this.oja&&(r.ReplaceQuoteWithSmartQuote=A.ReplaceQuoteWithSmartQuote),this.KY.LLo(r),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:A.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:A.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:A.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:A.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:A.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.oja,["ReplaceQuoteWithSmartQuote"]:this.oja&&A.ReplaceQuoteWithSmartQuote}),ab.StaticActiveAppFrame.za().Ge(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.KY=b;this.oja=h;this.Ig="AutoCorrectOptionsDialog"}YBg(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.mh=this.oja?qn.mh:om.mh;const b={};b.ReplaceTextAsYouType=this.KY.JZa;b.CapitalizeFirstLetterOfSentences=this.KY.oUd;b.ReplaceOrdianalsWithSuperscript=this.KY.fue;b.ReplaceHyphensWithDash=this.KY.Ukd;b.ReplaceFractionsWithFractionCharacter=this.KY.eue;this.oja&&(b.ReplaceQuoteWithSmartQuote=
this.KY.zsg);this.Uh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.vSo,b)}}Object(u.a)(as,"AutoCorrectOptionsDialog",Dg.a,[476]);class pm{static get mh(){return Dg.a.uy(pm.lo,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}pm.lo="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(pm,"AltTextDialogWithDescriptionHtml",null,[]);class oj{static get mh(){return Dg.a.uy(oj.lo,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}oj.lo="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(oj,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Uf extends Dg.a{constructor(b=!1,h=!1){super(!1,!1,b);this.nOi=!1;h?(this.nOi=!0,this.mh=oj.mh):this.mh=pm.mh;this.Ig=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}Hrf(b){this.Uh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(D.a)(this,this.x5k,"altTextDialogHandler"),this.aIf(b));b=document.getElementById(Uf.Mgf)||document.getElementById(Uf.PRd);b.focus();b.select()}aIf(b){const h={};this.nOi?h[Uf.Q0m]=!0:h[Uf.Mgf]=
this.RFf(b);h[Uf.PRd]=this.Rpm(b)||"";return h}Hza(b){return b.Df.id===Uf.PRd?!1:super.Hza(b)}}Uf.Mgf="titleText";Uf.PRd="descriptionText";Uf.Q0m="hideTitleField";Object(u.a)(Uf,"BaseAltTextDialogWithDescription",Dg.a,[]);var si=d(27);class $l extends Uf{constructor(b,h,r,A,L){super();this.ik=h;this.sn=r;this.Yo=A;this.Qd=L;this.Pzb=this.m2=null;this.Hrf(b)}Rpm(b){this.m2=b.node;this.Pzb=si.TableReader.HHi(b);return si.TableReader.wNf(this.Pzb)}RFf(b){this.m2=b.node;this.Pzb=si.TableReader.HHi(b);
return si.TableReader.xNf(this.Pzb)}x5k(b,h){if(1===b){b=si.TableReader.xNf(this.Pzb);const r=si.TableReader.wNf(this.Pzb),A=h[Uf.Mgf];h=h[Uf.PRd];this.hide();const L=this.Yo.Lc(15);try{L.Ab(this.m2),this.ik.kzg(this.Pzb,A),this.ik.RPj(this.Pzb,h)}finally{L&&L.dispose()}A===b&&h===r||this.Qd.Yu(16)}this.sn.xm&&this.sn.Bk.IG(this.m2)}}Object(u.a)($l,"TableAltTextDialog",Uf,[]);class Wp{constructor(b,h,r){this.GG=b;this.Rc=h;this.Zd=r}create(b){return new $l(b,this.GG,pf.a.xd(),this.Rc,this.Zd)}}Object(u.a)(Wp,
"TableAltTextDialogFactory",null,[]);const $f=()=>{ed.a.YQh=!0;return 32},co=(b,h,r,A,L)=>{if(1===r)return 32;if(!({JE:b,az:h}=tp(L)).returnValue)return 16;ab.StaticActiveAppFrame.za().Ixc(b,h);return 32},ji=(b,h,r,A,L)=>{if(1===r)return 32;if(!({JE:b,az:h}=tp(L)).returnValue)return 16;ab.StaticActiveAppFrame.za().Bna(b,h);return 32},tp=b=>{let h=null,r=0;if(!b)return{returnValue:!1,JE:h,az:r};b=b.split(",");if(3>b.length)return{returnValue:!1,JE:h,az:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));
r=parseInt(b[2]);return{returnValue:!0,JE:h,az:r}};var Hn=d(1876);class nk extends Sys.EventArgs{constructor(b,h,r,A,L,Z=0,oa=0,Ba=null){super();this.controlId=b;this.utc=r;this.commandId=A;this.time=L;this.commandSurface=Z;this.az=oa;this.contentType=Ba}}Object(u.a)(nk,"CommandClickEventArgs",Sys.EventArgs,[]);class ej{constructor(b,h){this.Twa=b.IHf();this.sFc=b;this.ggb=h}SUa(b,h,r,A=null,L=null){r&&(this.ggb.gE=r.CommandLocation,this.ggb.b3=r.InvocationMethod,this.ggb.TTa=r.CommandTabName);b=
parseInt(b);let Z=this.sFc.qxi(b,h,r);Z.iag&&(Z=this.sFc.qxi(Z.wO,h,r));if(void 0!==Z.I7a&&null!==Z.I7a)return Z.I7a;if(Z.ARb)L=32;else{var oa=null;this.Twa&&this.Twa.Akg&&(oa=this.Twa.Akg(Z,L));Z.gma||Z.s$c?Z.yJa?L=16:(L=this.ggb.Qb(Z.wO,Z.Coc?2:1,Z.rd,L),2===L&&(L=32)):Z.yJa?L=this.ggb.Zma(null,Z.wO,Z.rd,Ba=>{A&&A(Ba.response)},L):(L=this.ggb.Qb(Z.wO,2,Z.rd,L),A&&A(L));this.Twa&&this.Twa.ukg&&this.Twa.ukg(Z,L,oa);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;if(void 0===r||
null===r)r="";oa=h.ParentMenuId;void 0!==oa&&null!==oa||!h.MenuId||(oa=h.MenuId);let Ba=h.SqmControlId;void 0!==Ba&&null!==Ba||!h.SourceControlId||(Ba=h.SourceControlId);(void 0!==Ba&&null!==Ba||void 0!==oa&&null!==oa)&&Hn.a.ono(new nk(Ba,r,oa,Vd.ActionManager.D$(b),Date.now()))}}Z.gma&&32===L&&this.Twa&&this.Twa.OHa&&this.Twa.OHa(Z,h);Z.s$c&&32===L&&this.Twa&&this.Twa.I5a&&this.Twa.I5a(Z,h);return 32===L||1===L}xLa(b,h=null){if(y.AFrameworkApplication.Yl||zf.a.instance.Yz)return!1;null!=h&&null!=
h.UILocation&&(this.ggb.gE=h.UILocation);const r=parseInt(b);if(!b||r===Vd.ActionManager.$yf)return!0;b=this.sFc.fxi(r,h);b.iag&&(b=this.sFc.fxi(b.wO,h));if(void 0!==b.I7a&&null!==b.I7a)return b.I7a;r===Za.a.bcc&&h&&(b.rd=h);return 32===this.ggb.Qb(b.wO,1,b.rd)}clearCache(){this.sFc.clearCache()}}Object(u.a)(ej,"GeneralCuiUser",null,[405,406]);var Wo=d(197),Ki=d(58),kk=d(52),kn=d(728);class bs{get mM(){return null!=this.L6g?this.L6g:this.L6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,
h,r,A){this.hfh="DocumentProofingFailed";this.u$e=b;this.lHh=h;this.Nwd=r;this.LK=A}ZJm(){const b=this.LK.hHm(this.u$e);return{returnValue:this.LK.iKa(this.u$e),Wjo:b}}Gyp(b,h){const r=Ki.a.Np();if(r){var A=new Wo.ScriptSharpLegacyMap;A.add(Ke.a.RF,b);A.add(Vc.a.noProof,h);b=new Sb.GraphTransaction(15);b.Ab(r);this.mM.ubb(kk.StyleReader.wordStyleIdNormal,A,r)?kn.a.H2j():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),kn.a.recordQosError(this.hfh,[kn.a.TNc],"Style could not be modified"));
b.dispose()}else v.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),kn.a.recordQosError(this.hfh,[kn.a.TNc],"PageContentNode not found")}ZTo(b,h){this.Gyp(b,h)}vZo(b,h){if(this.lHh){var r=new lj.DictionaryPropertySet;this.Nwd.execute(A=>{A.o_c(b)});r.setValue(Ke.a.RF,b);r.setValue(Vc.a.noProof,h);h=new Sb.GraphTransaction(15);h.set(ed.a.jf.Tl);this.lHh.z8(r);h.dispose()}}mf(){return he.a.mf(this.u$e)}}Object(u.a)(bs,"LanguageEditor",null,[455]);var ln=d(616),wq=d(255),qm=d(110);class mo{constructor(b=
!1,h=0){this.languages=mo.IGi(kg.a.Iom());this.VFd=new wq.a;this.qZa=[];this.d$b=new ln.a;this.Tyj=b;this.VAh=0>=h?7:h;this.UAh=this.T4e=0;this.qkh=!1;b&&(this.p9m(),y.AFrameworkApplication.fG(()=>{this.KGn()}))}p9m(){for(var b of this.languages)this.VFd.W(b.LCID,b);b=[];try{const A=Pc.a.get("RecentlyUsedLcids");if(A&&""!==A){const L=decodeURIComponent(A).split(",").slice(0,this.VAh);for(const Z of L){let oa;({value:oa}=this.VFd.Ec(parseInt(Z),oa)).returnValue&&b.push(oa)}}}catch(A){v.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",A.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.d$b.contains(r)||(this.qZa.push(h),this.d$b.add(r))}else h=y.AFrameworkApplication.lcid,({value:r}=this.VFd.Ec(h,r)).returnValue&&(this.qZa.push(r),this.d$b.add(h));this.iJj()}iJj(){const b=qm.toArray(qm.select(qm.asEnumerable(this.qZa),h=>h.LCID)).join(",");Pc.a.q_a("RecentlyUsedLcids",b,180)}Kxm(b){let h,r=-1,A=null;var L=mo.IGi(this.qZa);
this.Tyj&&0<L.length&&(A=qm.toArray(qm.Si(qm.asEnumerable(L),(Ba,gb)=>{b===Ba.LCID&&-1===r&&(r=gb);return{["key"]:gb,["text"]:Ba.displayName,["value"]:Ba.LCID.toString()}})));let Z=0;A&&(Z=A.length);L=Z;const oa=qm.toArray(qm.Si(qm.asEnumerable(this.languages),(Ba,gb)=>{b===Ba.LCID&&-1===r&&(r=Z+gb);return{["key"]:Z+gb,["text"]:Ba.displayName,["value"]:Ba.LCID.toString()}}));h=r;return 0<Z?{returnValue:A.concat.apply(A,oa),selectedIndex:h,iyc:L}:{returnValue:oa,selectedIndex:h,iyc:L}}mWo(b,h){if(this.Tyj&&
({value:r}=this.VFd.Ec(b,r)).returnValue){h=b!==h;if(this.d$b.contains(b))b=Array.indexOf(this.qZa,r),0<=b&&(Array.removeAt(this.qZa,b),this.qZa.push(r)),h&&this.T4e++;else{this.d$b.add(b);this.qZa.push(r);if(this.qZa.length>this.VAh){var r=this.qZa.shift();this.d$b.remove(r.LCID)}h&&this.UAh++}this.iJj()}}KGn(){const b=this.T4e+this.UAh;!this.qkh&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.T4e/b),this.qkh=!0)}static IGi(b){b=Array.clone(b);b.sort((h,
r)=>h.displayName.localeCompare(r.displayName));return b}}Object(u.a)(mo,"LanguageListHelper",null,[454]);var no=d(190);class Io extends no.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(u.a)(Io,"NumberButtonProps",no.a,[]);var Nl=d(166);class nl{static get H8(){return null!=nl.S3g?nl.S3g:nl.S3g=Wa.a.instance.Oa("Box4.ISpacingCommands")}static get Oab(){return null!=nl.a0g?nl.a0g:nl.a0g=Wa.a.instance.Oa("Box4.ILineSpacingHelper")}static get QSj(){return!!nl.H8}static Xb(){const b=
y.AFrameworkApplication.va;b.qa(vb.a.Ttc,kc.a.view,nl.Ttc);b.Pc(vb.a.Ttc,1124);b.qa(vb.a.Ttc,kc.a.paragraph,nl.Oyp)}static Ttc(b,h,r,A,L){if(1===r||!nl.QSj)return nl.QSj?32:8;if(!nl.TZi){var Z=[];Z.push(Object.assign(new Io,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));Z.push(Object.assign(new Io,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));Z.push(Object.assign(new Io,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));Z.push(Object.assign(new Io,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));
Z.push(Object.assign(new Io,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));Z.push(Object.assign(new Io,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));L.MenuItems=Ak.e(Z);nl.TZi=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.lb;Z=null;h&&h.gb.currentSelection&&(Z=h.gb.currentSelection);h=Object(Nl.a)().xri(Z.Qa);y.AFrameworkApplication.va.Hf(h,b,r,!0,A,L);return 32}static Oyp(b,h){let r=b=!0;h=nl.Oab.HVa(h.node);var A=h.beforeSpacing;let L=!1;1===A.unit&&(L=!0);
if(L||0<A.value)b=!1;h=h.afterSpacing;A=!1;1===h.unit&&(A=!0);if(A||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(nl.ZZk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(nl.fBo,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(nl.YZk,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(nl.eBo,r));return 32}}nl.ZZk="AddSpaceBeforeParagraph";nl.YZk="AddSpaceAfterParagraph";nl.fBo="RemoveSpaceBeforeParagraph";
nl.eBo="RemoveSpaceAfterParagraph";nl.TZi=!1;Object(u.a)(nl,"LineSpacingRibbonMenu",null,[]);var Ol=d(196),cs=d(1894),ds=d(1578),Nk=d(67);const er=(b,h,r)=>{if(1===r)return 32;b=ab.StaticActiveAppFrame.za().$J.yka("Automation test",!1);b.image=3;ab.StaticActiveAppFrame.za().$J.Iz(b);return 32},es=(b,h,r,A,L)=>{let Z;if(!({l$j:Z}=up(L)).returnValue)return 16;Ol.UISurfaces.uL().then(oa=>{let Ba=null;var gb=Object.assign(new cs.a,{label:"OK",onExecute:()=>{Ba&&oa.removeNotification(Ba)}});gb=Object.assign(new ds.a,
{target:"#"+Nk.a.Aug,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:gb,useTeachingStyles:Z});gb=oa.callout(gb);Ba=oa.addNotification(gb);return null},oa=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",oa);return null});return 32},up=b=>{let h=!1;if(!b)return{returnValue:!1,l$j:h};h=Boolean.parse(b);return{returnValue:!0,l$j:h}};class Wl{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(u.a)(Wl,"ColorCellProps",
null,[]);let Jo,rn,rm,In,Sm,Fo;class sm{constructor(){this.r$=new nb.a;this.Tph=!1}cTa(b){const h=this.r$.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.r$.removeAt(h)}this.r$.insert(0,b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.r$.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.r$.K(10)),this.r$.removeAt(10));this.kAp();return r}NAc(b){let h="#";for(let A=0;A<this.r$.count;A++){var r="#"+
this.r$.K(A).substring(4,6)+this.r$.K(A).substring(2,4)+this.r$.K(A).substring(0,2);r=Object.assign(new Wl,{Color:this.r$.K(A),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const A of sm.RAh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(A,h))}kAp(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.r$.count;r++){var h="#"+this.r$.K(r).substring(4,
6)+this.r$.K(r).substring(2,4)+this.r$.K(r).substring(0,2);h=Object.assign(new Wl,{Color:this.r$.K(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of sm.RAh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.Tph||this.lzp();this.Tph=!0}lzp(){for(const b of Object.keys(sm.Euh)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=sm.Euh[b],r=[];for(const A of h)r.push(appChrome.api.menuSection(A,
A[0]in sm.P_e?sm.P_e[A[0]].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,sm.P_e[b].toString()))}}}sm.Euh={["FontColor"]:(Fo=new nb.a,Fo.add(["AutomaticFontColor"]),Fo.add(["ThemeFontColorPickerMCU"]),Fo.add(["ThemeFontColorPicker"]),Fo.add(["StandardFontColorPicker"]),Fo.add(["RecentFontColorPicker"]),Fo.add(["MoreFontColors"]),Fo),["CellShading"]:(Sm=new nb.a,Sm.add(["ThemeShadingColorPickerMCU"]),Sm.add(["ThemeShadingColorPicker"]),Sm.add(["StandardShadingColorPicker"]),
Sm.add(["RecentCellShadingColorPicker"]),Sm.add(["ClearShadingColor"]),Sm.add(["MoreCellShadingColors"]),Sm),["PictureBorders"]:(In=new nb.a,In.add(["ThemePictureBorderColorPickerMCU"]),In.add(["ThemePictureBorderColorPicker"]),In.add(["StandardPictureBorderColorPicker"]),In.add(["RecentPictureBorderColorPicker"]),In.add(["MorePictureBorderColors"]),In.add(["NoPictureBorder"]),In.add(["PictureBorderWeightOptions"]),In.add(["PictureBorderStyleOptions"]),In),["PageColor"]:(rm=new nb.a,rm.add(["ThemePageColorPickerMCU"]),
rm.add(["ThemePageColorPicker"]),rm.add(["StandardPageColorPicker"]),rm.add(["RecentPageColorPicker"]),rm.add(["NoPageColor"]),rm.add(["MorePageColors"]),rm),["ParagraphShading"]:(rn=new nb.a,rn.add(["ThemeParagraphShadingColorPickerMCU"]),rn.add(["ThemeParagraphShadingColorPicker"]),rn.add(["StandardParagraphShadingColorPicker"]),rn.add(["RecentParagraphShadingColorPicker"]),rn.add(["NoParagraphShadingColor","MoreParagraphShadingColors"]),rn)};sm.P_e={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["ParagraphShading"]:"Paragraph Shading",["PageColor"]:Box4Intl.Box4Strings.L_PageColor};sm.RAh=(Jo=new nb.a,Jo.add("RecentFontColorPicker"),
Jo.add("RecentCellShadingColorPicker"),Jo.add("RecentPictureBorderColorPicker"),Jo.add("RecentPageColorPicker"),Jo.add("RecentParagraphShadingColorPicker"),Jo);Object(u.a)(sm,"RecentColorsSectionHandler",null,[]);var Xo=d(1893),eo=d(1527);class fr{constructor(b){this.wIk=b}E3(){}C3(b){this.wIk.pTn(b)}}Object(u.a)(fr,"DataBuddyActionListener",null,[119]);class bn{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(u.a)(bn,"DataBuddyTaskPaneProps",
null,[]);class Ig{constructor(b){this.isVisible=!1;this.X0=new nb.a;this.XIe=null;this.V5=b;this.HC=new Xo.a;this.Zb=Sg.FocusManager.instance()}initialize(){this.XIe=new fr(this);this.V5.iUa();this.HC.FN(this.gZk());this.HC.FN(this.AVk())}toggle(){this.isVisible?this.hide():this.show()}pTn(b){if(2===b.behavior){const h=Vd.ActionManager.D$(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.X0.add(h+": "+Ig.ngm(b.response)),this.Um())}}hide(){Ol.UISurfaces.Lv().then(b=>{b.hideTaskPane(Ig.BD,
2);return null})}show(){Ol.UISurfaces.Lv().then(b=>{b.showTaskPane(Ig.BD,this.LB());return null});this.isVisible&&Ol.UISurfaces.Lv().then(b=>{b.setSelectedTaskPane(Ig.BD);return null})}gZk(){return b=>{b.actions=this.X0.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}AVk(){return b=>{b.onClearClick=()=>{this.X0.clear();this.Um()}}}Xb(){y.AFrameworkApplication.va.fY(this.XIe)}mfb(){y.AFrameworkApplication.va.d2b(this.XIe)}LB(){const b=new bn;this.HC.yyb(b);return Object.assign(new eo.a,
{title:"Data Buddy",hideHeader:!1,width:Ig.width,location:2,contentProps:b,onOpen:()=>{this.rca();this.Xb();this.isVisible=!0;y.AFrameworkApplication.ua.Ge()},onClose:()=>{this.kha();this.mfb();this.isVisible=!1;this.Um();y.AFrameworkApplication.ua.Ge()},isModernPane:!0})}Um(){Ol.UISurfaces.Lv().then(b=>{b.updateTaskPane(Ig.BD,this.LB());return null})}rca(){this.Zb.Gg(Ig.BD)}kha(){this.wab()&&this.Zb.Gg(this.Zb.QW)}wab(){return!!this.Zb.currentScope&&this.Zb.currentScope.name===Ig.BD}static ngm(b){switch(b){case 0:return"Unattempted";
case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Ig.BD="DataBuddyTaskPane";Ig.width=300;Object(u.a)(Ig,"Box4DataBuddyTaskPane",null,[457]);class vp{constructor(b){this.ii=b}SOa(b){this.ii&&this.ii.eJ(b)}Lsd(){this.ii&&this.ii.atd(void 0)}}Object(u.a)(vp,"RibbonButtonUpdater",null,[448]);var Ko=d(346);class Go{constructor(){this.H8e=this.Z=
null}get name(){return"Box4.UI"}wc(b){this.Z=b;b.ia("Box4.IGeneralCuiUser",()=>new ej(b.resolve("Box4.UI.CuiActionBridge"),y.AFrameworkApplication.va)).ha();b.ia("Box4.UI.TableAltTextDialogFactory",()=>new Wp(b.resolve("Box4.ITableEditor"),new Ko.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.UI.ILanguageEditor",()=>new bs(If.a.instance.Pg,b.Oa("Box4.ITextFormattingCommands"),b.Ta("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ia("CommandUI.StandaloneRootController",
()=>new sp(y.AFrameworkApplication.Lr)).as("Common.IStandaloneRootController").ha();b.ia("Box4.UI.IAutoCorrectOptionsDialog",()=>new as(b.resolve("Box4.IAutoCorrectOptionsInfo"),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new mo(y.AFrameworkApplication.J.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();b.register(rr,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();
b.ia("Box4.UI.DefaultProofingContextMenuCreator",()=>new Jr(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new vq(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ia("Box4.RibbonButtonUpdater",()=>new vp(this.Z.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ia("Box4.UI.RecentColorsSectionHandler",
()=>new sm).ha();b.ia("Common.IDataBuddyTaskPane",()=>new Ig(Lq.a.instance)).ha()}init(){var b=ab.StaticActiveAppFrame.za();const h=b.Gb;Ek.h7m(Object(D.a)(h,h.sWb,"onAuthenticationLost"),Object(D.a)(h,h.tWb,"onAuthenticationRestored"),b.eml);b=y.AFrameworkApplication.va;b.qa(vb.a.Ogo,kc.a.application,$f);b.fb(vb.a.C7o,kc.a.application,co,96);b.fb(vb.a.k8o,kc.a.application,ji,96);b=y.AFrameworkApplication.va;b.fb(vb.a.c$o,kc.a.application,er,96);b.fb(vb.a.s7o,kc.a.application,es,96);nl.Xb();this.w9m();
this.H8e=this.Z.resolve("Common.IStandaloneRootController")}w9m(){this.Z.Ta("Box4.IGeneralCuiUser").execute(b=>{this.Z.Ta("Common.IStandaloneRootController").execute(h=>{h.uha.tH=b})})}dispose(){this.H8e.dispose();this.H8e=null}static main(){E.a.instance.Mc(new Go,6)}}Object(u.a)(Go,"Box4UIPackage",null,[0,1]);var As=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",
Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Us=d(1895);class Nt{get name(){return"Box4.Insights"}init(){}dispose(){}wc(b){b.ia("Box4.Insights.Box4InsightsSelection",()=>new Us.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(u.a)(Nt,"Box4InsightsPackage",null,[0,1]);const Mq=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+
b)};var Gp=d(420),cn=d(557),hp=d(720),tm=d(1853);class ip{pvb(){return!1}reset(){}update(){}}Object(u.a)(ip,"NullTaskYieldStrategy",null,[318]);var pt=d(1293);class xo{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(u.a)(xo,
"CatchUpConfiguration",null,[]);class Ot{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(u.a)(Ot,"SharedControllerFactoryParameters",null,[]);var Fl=d(629),Ec=d(18);class fs{constructor(b,h,r,A){this.$4n=(L,Z)=>{(this.PDd=!this.PDd)&&
Z.Lk&&Z.Lk.contextId===kc.a.Vc&&this.l1h(Z.Lk.node,Z.Lk.zj);return 32};this.vz=b;this.Qp=h;this.ga=r;this.Zb=A;this.tFd=this.uFd=null;this.PDd=!1;this.ga.qa(Ec.a.Z0j,kc.a.view,this.$4n);this.Zb.ie(Qf.AFrame.Gq).bindAction(Cb.KeyInputManager.oc(jf.a.NCc,6),Ec.a.Z0j)}vP(b,h){this.PDd&&this.Qp&&h&&h.Rm&&h.Rm.currentSelection&&h.Rm.currentSelection.Qa&&h.Rm.currentSelection.Qa.node&&h.Rm.currentSelection.Qa.contextId===kc.a.Vc&&this.l1h(h.Rm.currentSelection.Qa.node,h.Rm.currentSelection.Qa.zj)}l1h(b,
h){b&&(this.Rgj(b)?(this.uFd&&this.uFd.id.equals(b.id)||(this.Qp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.uFd=b),this.nJn(b,h)):this.tFd=this.uFd=null)}Rgj(b){return 0<this.vz.tQb(b).count}nJn(b,h){if(b){var r=-1,A=null,L=null;for(let Z=0;Z<b.ra.length;Z++){const oa=b.ra.Ub(Z);if(!(null==L||oa.changeStart&&oa.changeStart.equals(A))&&h>=r&&h<=oa.cp&&!A.equals(this.tFd))if(this.vz.pTb(A)){(b=this.vz.D1c(A,b.id))&&0<b.actors.length&&b.displayTimestamp&&
(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Qp.sendNotification(b,!1),this.tFd=A);break}else this.tFd=null;oa.changeStart&&!oa.changeStart.equals(A)&&(r=oa.cp,A=oa.changeStart);L=oa.changeStart}}}}Object(u.a)(fs,"ActivityAnnouncementManager",null,[]);var gs=d(1579),dk=d(549),Kn=d(786),ek=d(604);class am{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=
this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(u.a)(am,"Activity",null,[]);var hm=d(411);class sr extends am{constructor(){super();this.Kw=this.objectId=null}static vS(b){const h=new ek.a(new hm.a);if(b.Kw)for(const r of b.Kw)h.add(r);return h}}Object(u.a)(sr,"RevisionSetActivity",am,[]);class yj{constructor(b,h,r,A=!1){this.tNe=null;this.dismiss=()=>{this.phj.then(L=>{L.removeNotification(this.tNe);return this.tNe=null})};this.YZ=b;this.Pb=h;this.phj=r;this.poc=A}qrp(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:this.Pb.Qb(Za.a.Ebb,
2,null);break;default:this.uTn()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}uTn(){this.phj.then(b=>{var h=Object.assign(new ds.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new gs.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new dk.a,{expirationOptions:Object.assign(new Kn.a,{displayTimeoutSeconds:10,
onExpire:this.dismiss})});this.tNe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Pb.Qb(Za.a.U_d,2,h))return!1;break;case 1:return this.cXl(b)}return!0}cXl(b){b=
sr.vS(b);return b?0<this.YZ.l6d(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(u.a)(yj,"ActivityContentManager",null,[604]);var hs=d(1384),Nq=d(2126),wk=d(410),Xp=d(723);class Yp{constructor(){this.Kw=this.L_=null}compare(b){if(!b)return!1;if(this.L_&&b.L_){if(this.L_.count!==b.L_.count)return!1;for(const h of this.L_)if(!b.L_.contains(h))return!1}else if(!b.L_&&this.L_||!this.L_&&b.L_)return!1;if(b.Kw&&this.Kw){if(b.Kw.count!==this.Kw.count)return!1;
for(const h of this.Kw)if(!b.Kw.contains(h))return!1}else if(!this.Kw&&b.Kw||!b.Kw&&this.Kw)return!1;return!0}}Object(u.a)(Yp,"ActivityHighlightableObject",null,[]);class qt extends hs.a{constructor(b,h){super();this.$3e=this.S9b=null;this.bwd=b;this.vz=h;this.x5=[new Nq.a(wk.a.P_h,wk.a.O_h),new Nq.a(wk.a.M_h,wk.a.L_h),new Nq.a(wk.a.tUd,wk.a.uUd),new Nq.a(wk.a.vUd,wk.a.Smf)]}get Xrb(){return 1}get U9a(){return this.x5}get Afa(){return!0}p9a(b,h){if(b=Object(Ca.a)(Yp,b))if(b.L_)for(const r of b.L_)h.add(r);
else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}wMa(b,h){if(this.vs.OIa){var r=this.bwd.Ddb,A=this.bwd.Zrb,L=!!r&&r.compare(A),Z=this.vs.OIa,oa=Z.action,Ba=this.Y3o(Z,b),gb=!1;2!==oa&&oa&&(gb=(gb=this.vs.Qad)?1===gb.type:!!r||!!A);h=h.WMa("*");for(let Ab=0,Jb=h.length;Ab<Jb;Ab++){const Tb=h[Ab],jc=this.grm(Tb,wk.a.NUc);if(jc&&jc.$u)if(this.Tzo(Tb),1===Z.type)switch(oa){case 0:Ba&&r.Kw.contains(jc.$u)&&this.kSd(Tb,2,jc,!1);break;case 2:Ba&&A.Kw.contains(jc.$u)&&
this.kSd(Tb,L?2:1,jc,!1);break;default:this.Llc(b,Tb,jc,!1)}else gb?this.Llc(b,Tb,jc,!1):this.Llc(b,Tb,jc,!0)}this.S9b&&(this.S9b.classList.add(wk.a.vUd),this.$3e=this.S9b=null)}}grm(b,h){return ii.a.Eb(b,h)}Y3o(b,h){if(b&&b.$B){const r=b.$B,A=b.action;if(1===b.type&&(2===A||!A)&&r.L_)return r.L_.contains(h);if(r.Kw)for(const L of r.Kw){b=this.vz.f3c(L);for(const Z of b)if(Z===h)return!0}}return!1}Llc(b,h,r,A){const L=this.bwd.Ddb,Z=this.bwd.Zrb;L&&L.Kw.contains(r.$u)&&(!L.L_||L.L_.contains(b))?this.kSd(h,
2,r,A):Z&&Z.Kw.contains(r.$u)&&(!Z.L_||Z.L_.contains(b))&&this.kSd(h,1,r,A)}kSd(b,h,r,A){b&&Xp.a(b)&&(b.classList.add(this.uvm(2===h,A)),this.zVo(b,r,A))}zVo(b,h,r){this.S9b?-1!==h.cpEnd&&this.$3e.cpEnd!==h.cpBegin&&(this.S9b.classList.add(r?wk.a.Smf:wk.a.vUd),b.classList.add(r?wk.a.uUd:wk.a.tUd)):b.classList.add(r?wk.a.uUd:wk.a.tUd);b.classList.add(wk.a.N_h);this.S9b=b;this.$3e=h}Tzo(b){this.vs.BZa(b);this.Pyo(b)}Pyo(b){b.classList.remove(wk.a.tUd,wk.a.uUd,wk.a.N_h,wk.a.vUd,wk.a.Smf)}uvm(b,h){return h?
b?wk.a.L_h:wk.a.O_h:b?wk.a.M_h:wk.a.P_h}}Object(u.a)(qt,"ActivityHighlightActor",hs.a,[]);var yn=d(2127),Oq=d(165);class Li{constructor(b,h,r,A,L,Z,oa,Ba){this.dZ=b;this.FQ=h;this.vz=r;this.sIk=L;this.ib=Z;this.Qp=Ba;this.Zb=oa;this.FQ.Uee=!1}Mnj(b,h,r){b?this.$0m(b,h,r):this.FQ.Ddb&&(b=Object.assign(new yn.a,{action:1,type:1,$B:null,VL:this.FQ.Ddb}),this.FQ.Ddb=null,this.dZ.vH(b))}$0m(b,h,r){if(h){b=new ek.a(new hm.a);for(L of h){var A=this.vz.g2c(L);for(let Z=0;Z<A.length;Z++){const oa=A[Z];this.vz.pTb(oa)&&
b.add(oa)}}var L=this.vz.l6d(b);L=this.P8h(L,b);A=this.FQ.Ddb;this.FQ.Ddb=L;L=Object.assign(new yn.a,{action:0,type:1,$B:this.FQ.Ddb,VL:A});this.dZ.vH(L);r&&!this.DNo(h.K(0),b)||this.wPo(h.K(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}DNo(b,h){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),
!1;h=this.nom(b,h);return this.sIk.c_b(b.id,h)?this.Kc(b,h)?!0:!1:(v.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}wPo(b,h){b=this.vvm(b,h);h=new Sys.StringBuilder;for(let r=0;r<b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.K(r)));this.Qp.sendNotification(h.toString(),!0)}Kc(b,h){if(!b||!Cd.ParagraphReader.Wb(b))return v.ULS.sendTraceTag(579396806,377,
10,"SetSelection: Invalid node provided"),!1;if(0>h)return v.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.FQ.Uee=!0;b=xc.a.Uc(b,h);b=new Oq.Selection([b],!0);this.ib.Kc(b);Sg.FocusManager.lM()&&this.Zb.Gg(Qf.AFrame.Do);return!0}nom(b,h){if(h&&0<h.count)for(let r=0;r<b.ra.length;r++){const A=b.ra.Ub(r);if(A.changeStart&&h.contains(A.changeStart))return A.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");
return 0}vvm(b,h){const r=new nb.a;if(h&&0<h.count&&b){let A=-1;for(let L=0;L<b.ra.length;L++){const Z=b.ra.Ub(L);if(-1!==A&&Z.ys)if(Z.changeStart&&h.contains(Z.changeStart))continue;else r.add(b.characterData.substring(A,Z.cp)),A=-1;Z.changeStart&&h.contains(Z.changeStart)&&(A=Z.cp)}}return r}Hmj(b,h){if(b)switch(b.type){case 1:if(h){b=new ek.a(new hm.a);for(var r of h){h=this.vz.g2c(r);for(let A=0;A<h.length;A++){const L=h[A];this.vz.pTb(L)&&b.add(L)}}}else b=sr.vS(b);h=this.vz.l6d(b);this.FQ.Zrb=
this.P8h(h,b);r=Object.assign(new yn.a,{action:2,type:1,$B:this.FQ.Zrb,VL:null});this.dZ.vH(r)}else this.FQ.Zrb&&(r=Object.assign(new yn.a,{action:3,type:1,$B:null,VL:this.FQ.Zrb}),this.FQ.Zrb=null,this.dZ.vH(r))}P8h(b,h){var r=null;if(b){r=new Oa.a;for(const A of b)12===A.type&&r.add(A)}b=new Yp;b.L_=r;b.Kw=h?h:this.nBm(r);return b}nBm(b){const h=new ek.a(new hm.a);if(!b)return h;for(const r of b)for(const A of this.vz.tQb(r))h.add(A);return h}}Object(u.a)(Li,"ActivityHighlightManager",null,[]);
var oo=d(874),po=d(718),hl=d(1382),Ln=d(59),wp=d(88),Hp=d(56);class eq{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(u.a)(eq,"CreateIndicatorTooltipParameters",null,[]);class Vs{constructor(){this.clearSticky=!1}}Object(u.a)(Vs,"DismissIndicatorTooltipParameters",null,[]);class xp{constructor(){this.target=null;this.isSticky=!1}}Object(u.a)(xp,"UpdateIndicatorTooltipParameters",null,[]);class xq extends Sys.EventArgs{constructor(b,h,r){super();
this.UOb=b;this.AQi=h;this.f5o=r}}Object(u.a)(xq,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class tr{constructor(){this.BQi=new Map;this.CQi=new Set}bop(b,h){this.CQi.add(b);this.BQi.set(b,h)}pmn(b){return rd.a.nXi(b.htmlElement)}DRm(){const b=new Set;for(const h of this.CQi){const r=this.BQi.get(h);r&&this.omn(r)&&b.add(h)}return b}omn(b){return b.parentElement&&rd.a.nXi(b.parentElement)}}Object(u.a)(tr,"IndicatorVisibilityTracker",null,[]);class Qj extends hl.a{constructor(b,h,r,A,L,Z,oa,Ba,
gb,Ab){super();this.sa=new Bf.a;this.OEb=this.Bda=null;this.yXm=(Jb,Tb,jc,Hc,hd)=>{if(!hd)return v.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Tb=sr.vS(hd.Activity);Jb=null;if(hd.NodeId&&(hd=wp.b(hd.NodeId),!Q.a.hw(hd,Q.a.nil)&&(hd=this.vz.Eyi(hd),this.XIg(hd,!1))))return 32;for(const Gd of Tb)if(this.vz.pTb(Gd)){hd=this.vz.Fjc(Gd);if(this.XIg(hd,!0))return 32;hd&&!Jb&&(Jb=hd)}if(this.XIg(Jb,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");
return 8};this.wXm=(Jb,Tb,jc,Hc,hd)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");hd&&Tb&&Tb.Al&&(Jb=Tb.node)&&((Jb=this.hDc.y6d(Jb))?this.kQd(Jb,!1,!1):v.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.e$o=Jb=>{(Jb=this.hDc.y6d(Jb.ao))&&this.kQd(Jb,!1,!1)};this.Gma=Jb=>this.Jlj(Jb.GB,!0);this.Hma=Jb=>{Jb=Jb.GB;if(Jb===this.Bda)return!0;this.YBj(Jb);
return!0};this.Zta=Jb=>{this.OEb=null;return this.Jlj(Jb.GB,!1)};this.NX=()=>{this.CCg();this.uVd(!0);return!1};this.mv=()=>{this.Iqj()};this.Ioe=()=>{this.Bda&&this.G7j(this.Bda);this.OEb&&this.YBj(this.OEb);this.B_n()};this.Iqj=()=>{this.Bda?this.G7j(this.Bda):this.Snf()};this.vz=b;this.hJe=h;this.tmh=r;this.Dzk=A;this.URa=L;this.L9=null;this.Jb=oa;this.hDc=Ba;this.bVe=new tr;this.XD=gb;this.l$=Ab;this.K3&&(this.K3.g6(this.Ioe),this.K3.y1k(this.Iqj));Z&&Z.execute(Jb=>{Jb.gY(this.mv)})}get K3(){return this.URa&&
this.URa.vj?this.URa:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Mea(b,h,r){if(this.Bda){var A=Hp.a(this.Bda);if(b===A)return this.Bda}const L=b.Kh.ownerDocument;A=oo.a.createElement(L,po.a.div);A.className=wk.a.wUd;A.style.left=h+"px";A.style.top=r+"px";h=oo.a.createElement(L,po.a.div);h.className=this.XD?wk.a.V_h:wk.a.Q_h;A.style.cursor="pointer";h.style.cursor="pointer";h.style.backgroundColor=this.l$.Nkm();h.style.outlineWidth="1px";h.style.outlineStyle="solid";
h.style.outlineColor=this.l$.Okm();A.appendChild(h);Zf.a.instance.ub(od.a.w3,A,this.Gma);Zf.a.instance.ub(od.a.MU,A,this.Hma);jg.a.instance.ub(od.a.click,A,this.Zta);Zf.a.instance.ub(od.a.contextMenu,A,this.NX);v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.wFn(b);h=this.iCm(b);this.bVe.bop(h,A);this.bVe.pmn(b)&&this.Zkj(h);return A}u_a(b){return this.S2o(b)}fUa(b){const h=this.ckl(b),r=[];r.push(this.Mea(b.I3,h,b.nBc[0].y-b.r7[0].y));return r}ckl(b){let h=wk.a.n6m+
(0>b.gbd?-b.gbd:0);const r=nh.a.Mj(b.pma,0)/2;1>=r&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<wk.a.R_h?wk.a.R_h:h;return y.AFrameworkApplication.isRtl?b.r7[0].width/this.zoom+h:-h}bSj(b){if(b&&b.sc===Ln.a.paragraphNode||b.sc===Ln.a.Lna){const h=this.vz.tQb(b);if(h)for(const r of h)if(b===this.vz.Fjc(r))return!0}return!1}S2o(b){for(const h of Cd.ParagraphReader.Kv(b.Cb,!0,!1))if(this.bSj(h))return!0;return!1}Xb(b){b.qa(Ec.a.LTj,kc.a.Vc,this.wXm);b.qa(Ec.a.UBg,
kc.a.Vc,this.yXm)}XIg(b,h){if(!b)return!1;const r=this.hDc.y6d(b);if(r)return this.kQd(r,!1,!0),!0;if(!h){let A;this.hjd((A=new nb.a,A.add(b),A),!1,!0,!0);h=new mf.a(3,1,0,this.e$o,181);h.ao=b;this.Jb.$b(h);return!0}return!1}QGl(b,h=!1){h&&this.uVd(!0);if(b&&b.parentNode){var r=this.INf(b);r=this.zgm(r);this.L9||(this.L9=document.createElement("Div"),document.getElementById(y.AFrameworkApplication.gTc).appendChild(this.L9));this.hJe.createActivityIndicatorTooltip(Object.assign(new eq,{target:b,container:this.L9,
activityIds:r,isSticky:h,dirHint:9}));h&&(this.Bda=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}N0l(b){b&&b.classList.add(wk.a.xUd)}Jlj(b,h){return this.kQd(b,h,!1)}kQd(b,h,r){if(h&&b===this.Bda)return!0;const A=this.INf(b);h||this.CCg();this.QGl(b,!h);this.N0l(b.getElementsByClassName(this.XD?wk.a.V_h:wk.a.Q_h)[0]);this.hjd(A,h,!0,r);this.l$i(A,h?1:2);this.Dzk.cie();h&&(this.OEb=
b);return!0}uVd(b=!1){this.hJe.dismissActivityIndicatorTooltips(Object.assign(new Vs,{clearSticky:b}));this.OEb=null;b&&(this.Bda=null)}nVj(b){b&&b.classList.remove(wk.a.xUd)}CCg(){this.Bda&&this.nVj(this.Bda.getElementsByClassName(wk.a.xUd)[0])}YBj(b){const h=this.INf(b);this.hjd(h,!0,!1,!1);this.nVj(b.getElementsByClassName(wk.a.xUd)[0]);this.uVd(!1);this.OEb=null}INf(b){let h=null;(b=(b=Hp.a(b))?b.Cb:null)&&11===b.type&&(h=Cd.ParagraphReader.Kv(b,!0,!1));return h}Snf(){const b=!!this.OEb;if(this.Bda||
b)this.CCg(),this.uVd(!0),this.hjd(null,!1,!1,!1),this.hjd(null,!0,!1,!1)}k0k(b){this.sa.addHandler(Qj.cMh,b)}l0k(b){this.sa.addHandler(Qj.dMh,b)}hjd(b,h,r,A){let L=null;if(r&&b){for(const Z of b)if(r=this.vz.g2c(Z))for(let oa=0;oa<r.length;oa++){const Ba=r[oa];if(this.vz.pTb(Ba)){L=this.vz.D1c(Ba,Z.id);break}}if(!L){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(Qj.cMh,new xq(L,b,!1)):this.sa.raiseEvent(Qj.dMh,
new xq(L,b,A))}zgm(b){const h=[];if(b)for(const A of b){var r=this.vz.tQb(A);for(const L of r)(r=this.vz.D1c(L,A.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");return h}G7j(b){b&&b.parentNode?(this.hJe.updateActivityIndicatorTooltip(Object.assign(new xp,{target:b,isSticky:!0})),this.Bda=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}B_n(){const b=
this.bVe.DRm();for(const h of b)this.Zkj(h)}Zkj(b){this.tmh.k$i(b,3)}iCm(b){return(b=Cd.ParagraphReader.Kv(b.Cb,!0,!1))&&b.count?b.K(0).id:null}wFn(b){b=Cd.ParagraphReader.Kv(b.Cb,!0,!1);this.l$i(b,0)}l$i(b,h){b&&b.count&&this.vFn(b.K(0).id,h)}vFn(b,h){this.tmh.k$i(b,h)}}Qj.cMh="ActivityIndicatorPreviewed";Qj.dMh="ActivityIndicatorSelected";Object(u.a)(Qj,"ActivityIndicatorActor",hl.a,[]);var fg=d(31);class ym{constructor(b,h,r){this.vz=b;this.oOd=h;this.URa=r}get K3(){return this.URa&&this.URa.vj?
this.URa:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}y6d(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");const h=this.Kzi(b);if(!h){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.vz.tQb(b);for(const r of b)if(b=this.vz.Fjc(r),b=this.Kzi(b))return b}return h}Kzi(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var h=this.oOd.ZQb(b);if(!h||11!==h.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.fg(this.K3.Ic);if(!h||!h.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),
null;var r=Je.a.h2c(h.htmlElement,ym.bMh);if(r)return r;h=h.Q2d();if(!h)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;h=Je.a.Flm(h,ym.bMh);if(!h)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const A=Hp.a(h[r]),L=fg.OutlineElementNavigator.Pm(b);if(A&&A.Cb&&L&&A.Cb.id.equals(L.id))return h[r]}v.ULS.sendTraceTag(539779152,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}Gwm(b){b=this.vz.Eyi(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),Q.a.nil;b=this.y6d(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),Q.a.nil;b=Hp.a(b);return b?b.Cb.id:(v.ULS.sendTraceTag(555356865,
377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),Q.a.nil)}}ym.bMh="CatchUpActivityIndicatorContainer";Object(u.a)(ym,"ActivityIndicatorHelper",null,[]);class Yo{constructor(b,h,r,A,L,Z){this.kBa=b;this.Oh=h;this.ldf=r;this.Pb=A;this.YZ=L;this.pf=Z;this.T3i=!1;this.jKn=(oa,Ba,gb)=>{if(1===gb)return this.vRf?32:8;2===gb&&(this.vRf&&(this.ldf.Snf(),this.orl()),v.ULS.sendTraceTag(38138719,377,50,H.c({["MarkAsRead invoked"]:!0})));ab.StaticActiveAppFrame.za().Ge();
return 8};this.kBa.eNa(this.ldf)}initialize(){this.Pb.qa(Ec.a.$bj,Gc.a.frame,this.jKn)}get vRf(){return!!this.YZ.OU&&0<this.YZ.OU.count||!!this.YZ.Drc&&0<this.YZ.Drc.count}get hwn(){return this.T3i}Ggg(b){const h=b&&b.wywaActivities?b.wywaActivities.length:0;if(0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.pf.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.uVn(b.wywaActivities),this.T3i=!0):(v.ULS.shipAssertTag(36538305,377,!1),this.pf.logKpiFailure("CatchUpActivitiesReady",
"CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}uVn(b){b?(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),this.f1o(b),b=this.YZ.C_k(b),this.g1o(b)):v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}f1o(b){if(b){var h=new nb.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.yrj:r.contentId,h.add(b),this.YZ.Drc.add(b)}0<h.count&&(v.ULS.sendTraceTag(51196435,
377,50,"{0}",h.count),this.Pb.Qb(Za.a.mgj,2,h.toArray()))}}g1o(b){const h=new ek.a(new hm.a),r=new Sb.GraphTransaction(3);try{r.Ab(this.Oh);for(const A of b){const L=this.YZ.Fjc(A);L&&this.ldf.bSj(L)&&(h.add(L.id),this.kBa.FSb(L,!0))}}finally{r&&r.dispose()}0<b.count&&ab.StaticActiveAppFrame.za().Ge();b={};b.highlightedNodeCount=h.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",H.c(b))}orl(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.YZ.Drc.count&&
(this.Pb.Qb(Za.a.jgi,2,this.YZ.Drc.toArray()),this.YZ.Drc.clear());const b=this.qtl(this.YZ.OU);this.Hyo(b)}Hyo(b){v.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const h=new Sb.GraphTransaction(3);try{h.Ab(this.Oh);for(const r of b){this.YZ.OU.remove(r);for(const A of this.YZ.f3c(r))this.kBa.FSb(A,!0)}this.YZ.$1h()}finally{h&&h.dispose()}}qtl(b){const h=new ek.a(new hm.a);for(const r of b)h.add(r);return h}}Object(u.a)(Yo,"ActivityIndicatorManager",
null,[]);class is{constructor(){this.Zrb=this.Ddb=null;this.isFirstDocumentOpen=this.Uee=!1}}Object(u.a)(is,"ActivityStateManager",null,[603]);class hu{constructor(b,h){this.wxd={};this.I4b=b;this.FM=h;this.Drc=new nb.a}get OU(){return this.I4b.OU}tQb(b){const h=new ek.a(new hm.a);if(!b)return h;b=this.I4b.M4d(b);for(let r=0;r<b.length;r++){const A=b[r];this.pTb(A)&&h.add(A)}return h}f3c(b){return this.I4b.f3c(b)}l6d(b){const h=new nb.a;if(b)for(const r of b)h.addRange(this.f3c(r));return h}C_k(b){const h=
new ek.a(new hm.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const A of b.Kw){h.add(A);this.OU.add(A);const L=A.toString();this.wxd[L]||(this.wxd[L]=new nb.a);this.wxd[L].add(b)}this.$1h();return h}pTb(b){return this.OU&&b?this.OU.contains(b):!1}D1c(b,h){if(b&&(b=this.wxd[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.K(0)}return null}Fjc(b){return this.I4b.Fjc(b)}$1h(){this.I4b.arl()}g2c(b){return this.I4b.g2c(b)}Eyi(b){if(!this.FM)return null;const h=
this.FM.Hc;return h?h.Eb(b):null}}Object(u.a)(hu,"ChangeIdCache",null,[]);var js=d(526),Ws=d(235);class Lo extends js.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new Ws.a,{T_:Lo.getTypeName(),B_:Lo.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Lo,"ChangeSummariesResponse",js.a,[]);var Kr=d(1434);class Pq extends Kr.a{constructor(){super();
this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Ws.a,{T_:Pq.getTypeName(),B_:Pq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(u.a)(Pq,"ChangeSummariesRequest",Kr.a,[]);var Ip=d(1402),iu=d(879),gq=d(312),Ka=d(878);class $a{constructor(){this.Yuc=this.zld=null}}Object(u.a)($a,"ActionPair",null,[]);class Hb{constructor(b,h,r,A){this.F0l=L=>{L=L.ao;const Z=
this.yBj(L);Z&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.KKf(L)),Z.Yuc("Request timeout"))};this.LC=b;this.IY=h;this.Re=r;this.Jb=A;this.dVe=null;this.k4e=new Ha.a;this.LBh=new Ha.a}cgp(b){const h=Object.assign(new Ip.a,{parentPath:["Signal",Pq.getTypeName()],items:[Object.assign(new iu.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((A,L)=>{this.k4e.W(b.requestId,Object.assign(new $a,
{zld:A,Yuc:L}))});this.LBh.W(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Hb.requestTimeoutMs);this.IY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ka.a,{operation:h}));this.RYo(b.requestId);return r})}initialize(){this.dVe||(this.dVe=this.LC.im().then(()=>{this.Re.ub(this,Lo.getTypeName())}));return this.dVe}gH(b,h){if(b&&gq.a.getTypeNameFor(b.content)===Lo.getTypeName())if(b=
b.content){var r=this.yBj(b.correspondingRequest);r?h!==Ip.a.getTypeName()?r.Yuc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.KKf(b.correspondingRequest)),r.zld(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.KKf(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,
377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}RYo(b){const h=new mf.a(3,1,Hb.requestTimeoutMs,this.F0l,176);h.YPd=0;h.ao=b;this.Jb.$b(h)}yBj(b){if(!b)return null;let h;if(!({value:h}=this.k4e.Ec(b,h)).returnValue)return null;this.k4e.remove(b);return h}KKf(b){if(!b)return-1;let h;return({value:h}=this.LBh.Ec(b,h)).returnValue?
(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return y.AFrameworkApplication.J.jc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(u.a)(Hb,"ChangeSummariesAugloopProvider",null,[114]);class uc{constructor(){this.activityGroups=null}}Object(u.a)(uc,"FeaturedActivityGroupPayload",null,[]);class M{constructor(b,h,r,A,L){this.gLk=b;this.zok=h;this.lqk=r;this.Ytk=A;this.BBb=L}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.Ytk.uHb.then(()=>this.jsm(b)):
M.azf}VUm(b,h,r){if(!h)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Mq("TranslateFeaturedActivityGroups");r=this.lqk.Mop(b,h,r.wywaActivities);v.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.BBb.set(h.correspondingRequest,
r);return Object.assign(new uc,{activityGroups:r})}jsm(b){Mq("BuildFeaturedActivityGroupRequest");const h=this.gLk.cgl();if(!h||!h.documentContent||!h.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),M.azf;if(!h.documentContent.length||!h.activityChanges.length)return M.azf;v.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+
h.requestId);Mq("SubmitFeaturedActivityGroupRequest");return this.zok.cgp(h).then(r=>this.VUm(h,r,b))}}M.azf=Promise.resolve(Object.assign(new uc,{activityGroups:[]}));Object(u.a)(M,"ChangeSummariesDataProvider",null,[596]);class fa{constructor(b,h){this.vz=b;this.VPk=h}cgl(){const b=new nb.a,h=new nb.a,r=new ek.a(new hm.a);var A=this.vz.OU;if(!A||!A.count)return fa.dzf;A=this.vz.l6d(A);if(!A||!A.count)return v.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),
fa.dzf;for(const L of A)r.contains(L.id)||(r.add(L.id),this.Mio(L,b,h));return h.count&&b.count?Object.assign(new Pq,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:wp.a(Q.a.create())}):fa.dzf}Mio(b,h,r){if(Cd.ParagraphReader.Wb(b)){var A=Cd.ParagraphReader.R3(b);if(A&&A.length){h.add(A);A=this.vz.tQb(b);A=this.cUm(A);for(const L of A){A=new nb.a;const Z=this.getTextRanges(b,L);for(const oa of Z)A.add({changeEnd:oa.endIndex,changeSpanId:oa.zRo,changeStart:oa.startIndex,contentIndex:h.count-
1,locationId:wp.a(b.id)});(A=this.tDl(L,A.toArray()))&&r.add(A)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}cUm(b){const h=new Ha.a;for(const r of b)(b=this.QDi(r))?(h.tb(b)||h.W(b,new ek.a(new hm.a)),h.K(b).add(r)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");
return h.values}tDl(b,h){const r=[];let A=null;for(const L of b)if(b=this.vz.D1c(L,Q.a.nil)){if(!A){const Z=this.QDi(L);if(!Z||!Z.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}A=Z}r.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return r.length?A?h.length?{activityId:r[0].activityId,changes:h,personId:A,
timestamp:r[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}QDi(b){b=this.vz.D1c(b,Q.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,
377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new nb.a;if(!h||!h.count||!b)return r;let A=-1,L=new ek.a(new hm.a);for(let Z=0;Z<b.ra.length;Z++){const oa=
b.ra.Ub(Z);if(-1!==A&&oa.ys){if(oa.changeStart&&h.contains(oa.changeStart)){L.add(oa.changeStart);continue}r.add({startIndex:A,endIndex:oa.cp,zRo:this.VPk.VLj(L)});A=-1;L=new ek.a(new hm.a)}oa.changeStart&&h.contains(oa.changeStart)&&(A=oa.cp,L.add(oa.changeStart))}return r}}fa.dzf=Object.assign(new Pq,{activityChanges:[],documentContent:[],requestId:wp.a(Q.a.nil)});Object(u.a)(fa,"ChangeSummariesRequestBuilder",null,[]);class Va{constructor(){this.changes=this.content=null}}Object(u.a)(Va,"ContentChange",
null,[]);class Fb{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(u.a)(Fb,"FeaturedActivityGroup",null,[]);class Vb{constructor(){this.end=this.start=0}}Object(u.a)(Vb,"TextRange",null,[]);class wc{constructor(b){this.hDc=b}Mop(b,h,r){if(!h)return v.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),wc.y0d;if(!h.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),
wc.y0d;if(!h.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),wc.y0d;if(!h.inferences.length||!h.activityClassifications.length)return v.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),wc.y0d;const A=[],L=new Pa.a(new hm.a);for(const Z of h.inferences){const oa=this.Lop(Z,b,h,r);if(!oa)continue;
const Ba=this.hDc.Gwm(wp.b(oa.locationId));Ba.equals(Q.a.nil)?A.push(oa):L.tb(Ba)?L.K(Ba).ranking>oa.ranking&&L.W(Ba,oa):L.add(Ba,oa)}b=[...Array.from(L.values),...A];b.sort((Z,oa)=>Z.ranking-oa.ranking);return b.slice(0,wc.CLn)}Lop(b,h,r,A){if(!b||Me.a.Qf(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const L=new nb.a,Z=new Ha.a;let oa=null;for(const gb of b.activitiesInGroup){if(!gb){v.ULS.sendTraceTag(588379910,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>gb.activityIndex||gb.activityIndex>=r.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Ab=r.activityClassifications[gb.activityIndex];if(!Ab||Me.a.Qf(Ab.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");
else{var Ba=this.m8l(A,Ab.activityId);if(Ba){L.add(Ba);for(const Jb of gb.changes){if(!Jb){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ba=Jb.value;if(0>Ba||Ba>=Ab.contents.length){v.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Ba=Ab.contents[Ba];if(!Ba){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");
continue}const Tb=h.documentContent[Ba.contentIndex],jc=Object.assign(new Vb,{start:Ba.changeStart,end:Ba.changeEnd});if(Z.tb(Tb))Z.K(Tb).add(jc);else{let Hc;Z.W(Tb,(Hc=new nb.a,Hc.add(jc),Hc))}oa||(oa=Ba.locationId)}}else v.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!L.count)return v.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.QPm(Z);
return h.count?Object.assign(new Fb,{ranking:b.ranking.value,reasons:[1],activities:L.toArray(),contentChanges:h.toArray(),locationId:oa}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}m8l(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}QPm(b){const h=new nb.a;for(const A of b){b=A.key;const L=A.value;L.Sc((Z,oa)=>Z.start-oa.start);var r=L.K(0).start;if(r>wc.Fcj){r-=wc.Fcj;
b=b.substring(r,b.length);for(const Z of L)Z.start-=r,Z.end-=r}h.add(Object.assign(new Va,{content:b,changes:L.toArray()}))}return h}}wc.y0d=[];wc.Fcj=10;wc.CLn=4;Object(u.a)(wc,"ChangeSummariesResponseTranslator",null,[]);class Xc{constructor(){this.BBb=new Ha.a;this.y5e=new Ha.a}set(b,h){if(h.length&&b){this.BBb.W(b,h);for(const r of h)if(r.activities)for(const A of r.activities)A&&A.activityId?this.y5e.W(A.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");
else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.BBb.tb(b)?this.BBb.K(b):null}pIn(b){return b&&this.y5e.tb(b)?this.y5e.K(b):null}}Object(u.a)(Xc,"FeaturedActivityGroupCache",null,[]);class vd{constructor(b){this.Bhe=(h,r,A,L,Z)=>{if(!Z)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=Z.Activity;if(!h)return v.ULS.sendTraceTag(574103577,377,
15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.BBb.pIn(h.activityId);if(!r)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;A=sr.vS(h);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,this.VLj(A));return 32};this.BBb=b;this.xah=new Map}Xb(b){b.qa(Ec.a.Bhe,
Gc.a.frame,this.Bhe)}VLj(b){let h=0;const r=Array(b.count);for(const A of b)b=this.mDm(A),r[h]=wp.a(b),h++;return r.join(",")}mDm(b){let h=this.xah.get(b);if(h&&h!=Q.a.nil)return h;h=Q.a.create();this.xah.set(b,h);return h}}Object(u.a)(vd,"FeaturedActivityGroupTelemetryActor",null,[]);var Dd=d(84);class Ce extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(u.a)(Ce,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class ea{constructor(b,h,r){this.nT=null;this.Pop=A=>{this.j5a.reset();A=this.HPm(A.ao);
let L=null;for(;A.moveNext();){const Z=A.currentNode;if(Z&&(Cd.ParagraphReader.Wb(Z)&&this.sa.raiseEvent("OPV",new Ce(Z)),this.j5a.update(),this.j5a.pvb())){L=Z;break}}L?this.GOh(L):this.nT(!0)};this.Jb=b;this.j5a=h;this.FM=r;this.sa=new Bf.a;this.uHb=new Promise(A=>{this.nT=A})}N1k(b){this.sa.addHandler("OPV",b)}Ncl(){this.GOh(null)}GOh(b){const h=new mf.a(3,1,0,this.Pop,182);h.ao=b;this.Jb.$b(h)}HPm(b){if(!b)return Dd.a.Bo(this.FM);b=hb.a.eb(b);b.zb(7);return Dd.a.At(b,this.FM)}}Object(u.a)(ea,
"DocumentTraverser",null,[]);class Xa{constructor(b){this.Pb=b}shouldShowEmptyExperienceButton(){return y.AFrameworkApplication.fge()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.Pb.Qb(Za.a.wze,2,null)}onInviteOthersButtonClick(){this.Pb.Qb(Za.a.Daa,2,null)}}Object(u.a)(Xa,"EmptyCatchUpBehaviorManager",null,[595]);class yb{constructor(b,h){this.Fbm=()=>{const r=document.getElementById("flyoutItem0");r&&(v.ULS.sendTraceTag(588129371,
3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.gq=b;this.Zb=h}initialize(){const b=this.Zb.ie(Qf.AFrame.iec);b.IL=!0;b.parent=Qf.AFrame.Gq;b.Nja(this.Fbm);this.gq.xW(Qf.AFrame.iec)}enableF6Focus(){this.gq.QK(Qf.AFrame.iec)}disableF6Focus(){this.gq.Dx(Qf.AFrame.iec)}}Object(u.a)(yb,"FlyoutFocus",null,[593]);class Ub{constructor(b,h,r){this.z$g=this.gkh=this.CJc=this.oEd=!1;this.bSe=this.cxd=null;this.p2n=(A,L,Z,oa,Ba)=>{Ba[Tg.a.Visible]=!0;Ba[Tg.a.On]=this.CJc&&this.oEd;return 32};
this.a5n=(A,L,Z)=>{if(1===Z)return this.oEd?(this.gkh||(this.gkh=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.cxd)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.z$g=!0;this.cxd();return 32};this.ga=b;this.kih=h;this.Zb=r}get vDf(){return this.bSe?this.bSe:(v.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),
new Date)}set vDf(b){this.bSe=b}initialize(){this.Xb()}registerButtonClickedEvent(b){this.cxd&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.cxd=b.buttonClickedCallback}onFlyoutInitialized(){this.oEd&&v.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.vDf.getTime();v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",
b);this.oEd=!0;me.c(Za.a.Wml,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.CJc!==b.flyoutIsVisible&&(this.CJc=b.flyoutIsVisible,ab.StaticActiveAppFrame.za()&&ab.StaticActiveAppFrame.za().Ge(!0),this.CJc&&this.z$g&&this.Zb.Gg(Qf.AFrame.iec),this.CJc||this.kih&&this.kih.LDn())}logFlightTriggers(b){b.hasFlyoutData&&y.AFrameworkApplication.$c("WoCha187;WoCha187cf")}Xb(){this.ga.qa(Za.a.c1j,Gc.a.frame,this.a5n);this.ga.fb(Za.a.oxj,Gc.a.frame,this.p2n,96)}}Object(u.a)(Ub,"FlyoutRibbonButton",
null,[594]);var yc=d(152);class ad{constructor(b,h){this.OU=null;this.uce=this.e0i=!1;this.YZ=b;this.pf=h;this.Isb=new yc.a;this.Wbe=new Map;this.Isb.W(1,new ek.a(new hm.a));this.Isb.W(0,new ek.a(new hm.a));this.Isb.W(2,new ek.a(new hm.a));this.Isb.W(3,new ek.a(new hm.a));this.Wbe.set(3,"CatchUpIndicatorVisible");this.Wbe.set(1,"CatchUpIndicatorPreviewed");this.Wbe.set(2,"CatchUpIndicatorSelected");this.Xte=0}k$i(b,h){if(this.Isb.K(h).add(b)){this.xFn(h);switch(h){case 0:v.ULS.sendTraceTag(592545740,
377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.f1h()}}E1n(b){this.T1l();b=this.YZ.tQb(b);for(const h of b)if(this.OU.remove(h)){this.Xte++;break}}T1l(){if(!this.OU){this.OU=new ek.a(new hm.a);for(const b of this.YZ.OU)this.OU.add(b)}}a5k(){v.ULS.sendTraceTag(590890074,
377,50,"Total number of renderable indicators: {0}",this.Xte);this.f1h()}f1h(){this.Xte&&(this.ipl(),this.Vol())}ipl(){!this.e0i&&.5<=this.Isb.K(0).count/this.Xte&&(this.e0i=!0,me.c(Za.a.Zml),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}Vol(){if(!this.uce){var b="";1<=this.Isb.K(1).count&&(this.uce=!0,b="previews");1<=this.Isb.K(2).count&&(this.uce=!0,b="selections");this.uce&&(me.c(Za.a.Pml),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",
b))}}xFn(b){(b=this.Wbe.get(b))&&this.pf.logKpiUsage(b,0)}}Object(u.a)(ad,"IndicatorTelemetryActor",null,[]);var md=d(725);d(1073);class Sd{constructor(b,h){this.Hod=b;this.OUc=h}GRm(){return this.OUc.promise.then(b=>b.getWywaActivitiesResponse)}EFf(b,h){return md.b(this.Hod.requestActivities(b,h))}gMf(b,h){return this.OUc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):md.b(this.Hod.requestRelevantActivities(b,h)))}updateActivityState(b){return md.b(this.Hod.updateActivityState(b))}FFf(){return this.OUc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):md.b(this.Hod.requestActivityFeed()))}itd(){return md.b(this.Hod.pGo())}}Object(u.a)(Sd,"ActivityRepository",null,[]);var ze=d(1074),Ne=d(574);class ng{constructor(b){this.Qj=b}get K3(){return this.Qj&&this.Qj.vj?this.Qj:null}c_b(b,h){return this.K3?this.K3.vmf(b,!0)?this.K3.c_b(b,h,!0,!0,!1,!1,Ne.a.Oml):(v.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(u.a)(ng,"PageViewWrapper",
null,[]);class Ng{constructor(b,h,r,A,L,Z=!1){this.activityContentManager=b;this.Pb=h;this.VXl=r;this.pf=A;this.o6m=L;this.poc=Z}W5f(b){const h=new Map;h.set("activityType",b.type.toString());this.pf.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}j5f(b){this.pf.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}UQn(b){try{const h=b.activity;this.W5f(b.activity);1==h.type&&this.o6m.cie();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.qrp(h),
this.j5f("Content does not exist"),Promise.resolve(2);const r={};let A=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);A=this.Pb.Qb(Za.a.jpf,2,r);break;case 1:r.Activity=h,r.NodeId=b.locationId,A=this.Pb.Qb(Ec.a.UBg,2,r),r.NodeId&&this.Pb.Qb(Ec.a.Bhe,2,r)}8==A&&this.j5f("Action failed")}catch(h){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.j5f("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.VXl.uHb.then(()=>this.UQn(b))}}Object(u.a)(Ng,"WordActivityNavigationManager",null,[592]);var uh;(function(b){b[b.default=0]="default";b[b.CNp=1]="D48X48";b[b.FNp=2]="D64X64";b[b.GNp=3]="D96X96";b[b.yNp=4]="D120X120";b[b.zNp=5]="D240X240";b[b.ANp=6]="D360X360";b[b.BNp=7]="D432X432";b[b.DNp=8]="D504X504";b[b.ENp=9]="D648X648"})(uh||(uh={}));Object(u.b)("ProfilePhotoDimension",uh);var Oh=d(799),Hj=d(1383);class Da{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(u.a)(Da,"ActivityFeedEntry",null,[]);const Ib=(b,h)=>h.oad?qm.toArray(qm.select(qm.asEnumerable(b),r=>{if(!r||!r.activityFeedItemPayload)return r;const A=JSON.parse(r.activityFeedItemPayload);var L=A.actor;if(!L||L.pictureUrl)return r;const Z=L.userPrincipalName||L.email;if(!Z)return r;L=h.aNb(Z,L.provider,y.AFrameworkApplication.rm,0);if(!L)return r;A.actor.pictureUrl=L;return Object.assign(new Da,
{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(A),timestamp:r.timestamp})})):b,hc=(b,h)=>{const r=new Map,A=new Map;for(const L of b){if(!L||!L.activityFeedItemPayload)continue;b=JSON.parse(L.activityFeedItemPayload).actor;if(!b)continue;const Z=b.email||b.userPrincipalName;Z&&!A.has(Z)&&A.set(Z,new Oh.a(Z,null,b.name))}A.forEach(L=>{const Z=h.dlc(L,6);r.set(L.UserId,Z)});return r};var Kc=d(463);class zd{constructor(){this.lowWaterline=
this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(u.a)(zd,"ActivityRequestPayload",null,[]);class ue{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(u.a)(ue,"Person",null,[]);class Ue extends am{constructor(){super();this.relationship=0}}Object(u.a)(Ue,"TaskActivity",am,[]);class Re extends am{constructor(){super();this.contentId=null}}Object(u.a)(Re,"CommentActivity",am,
[]);class wg extends Re{constructor(){super()}}Object(u.a)(wg,"CommentReplyActivity",Re,[]);class Xg extends Re{constructor(){super();this.yrj=null}}Object(u.a)(Xg,"MentionActivity",Re,[]);class fk{constructor(b,h,r,A){this.CBb=b;this.YRa=h;this.QNc=r;this.FQ=A;this.FQ.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.CBb.GRm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Ksf("GetWYWAActivities",b);155===b.StatusCode&&(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),
this.FQ.isFirstDocumentOpen=!0);const h=this.tIg(b.People);return Object.assign(new zd,{activities:this.$Ce(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.CBb.EFf(b,h).then(r=>{if(!r||r.StatusCode)throw this.Ksf("GetActivities",r);const A=this.tIg(r.People);return Object.assign(new zd,{activities:this.$Ce(r.Activities,A),actors:A,hasMore:!r.RequestedRetrieved,
highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.CBb.gMf(b,this.FQ.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.Ksf("GetRelevantActivities",h);const r=this.tIg(h.People),A=this.$Ce(h.NewActivities,r,2);h=this.$Ce(h.OutstandingActivities,r,3);for(const L of h)A.push(L);return Object.assign(new zd,{activities:A,actors:r})})}updateActivityState(b){return this.CBb.updateActivityState(b)}requestActivityFeed(){return this.CBb.FFf().then(b=>
({activityFeedItems:this.c$m(b),personaColorMap:this.shl(b)}))}$Ce(b,h,r=1){const A=[];if(!b)return A;for(const oa of b){var L=null;b=[];b.push(h[oa.CreatorIndex]);switch(oa.ActivityType){case 1:L=oa;var Z=new sr;Z.Kw=new nb.a;for(const Ba of L.ChangeIds)Z.Kw.add(wp.b(Ba));Z.objectId=wp.b(L.ObjectId);L=Z;break;case 2:L=oa;Z=new Re;Z.contentId=L.ContentId;Z.navigationId=L.NavigationId;L=Z;break;case 4:L=oa;Z=new Xg;b.push(h[L.MentioneeIndex]);Z.yrj=L.ParentContentId;Z.navigationId=L.NavigationId;L=
Z;break;case 3:case 10:L=oa;Z=new wg;b.push(h[L.RepliedIndex]);Z.contentId=L.ContentId;Z.navigationId=L.NavigationId;L=Z;break;case 6:case 7:case 8:case 9:L=oa,Z=new Ue,b.push(h[L.MentioneeIndex]),Z.navigationId=L.NavigationId,Z.relationship=L.Relationship,L=Z}L&&(L.actors=b,L.displayTimestamp=new Date(oa.DisplayTimestamp),L.activityId=wp.b(oa.ActivityId).toString(),L.type=oa.ActivityType,1!==r&&(L.relevancy=r),A.push(L))}return A}OIo(b,h,r){return this.QNc&&this.QNc.oad?this.QNc.aNb(h,r,y.AFrameworkApplication.rm,
uh.default):b}tIg(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const A=new ue;A.id=b[r].Id;A.provider=b[r].Provider;A.displayName=b[r].DisplayName;A.email=b[r].Email;A.imageUrl=this.OIo(b[r].PictureUrl,b[r].Email,b[r].Provider);this.YRa&&(A.color=this.YRa.dlc(new Oh.a(A.email,void 0,A.displayName),Hj.a.Vml));h[r]=A}return h}Ksf(b,h){let r="null";h&&(r=Kc.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}c$m(b){return this.QNc?
Ib(b,this.QNc):b}shl(b){return this.YRa?hc(b,this.YRa):new Map}}Object(u.a)(fk,"WordActivityRequestManager",null,[503]);class vh{constructor(b,h,r){this.hHd=0;this.aOc=!1;this.Hrh=null;this.itd=()=>{if(ed.a.LX)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.aOc||3>=this.hHd){this.aOc?this.aOc=!1:this.hHd++;const A=Math.max(this.Aa.jc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.Hrh),0);v.ULS.sendTraceTag(39396256,
391,100,"Requesting new activities in {0}ms",A);Mf.Task.delay(A).continueWith(()=>{this.CBb.itd().then(()=>{this.Dve();return null}).catch(()=>{this.Dve();this.aOc=!0;this.hHd=0})})}else this.Dve()};this.Aa=b;this.CBb=r;h.pRd(()=>{this.aOc=!0;this.Hrh=new Date;this.hHd=0})}start(){this.Dve()}Dve(){window.setTimeout(this.itd,6E4)}}Object(u.a)(vh,"WordEditorActivityScheduler",null,[]);class ig{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}QSo(b){this.resolve(b)}}Object(u.a)(ig,
"CatchUpNetworkRequestWorkerCache",null,[]);class bh{constructor(b,h,r){this.VMl=b;this.J=h;this.pf=r}Ggg(b){b&&b.authors&&this.rFn(b.authors)}rFn(b){for(const h of b)h&&h.displayName===this.VMl&&(this.pf.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.J.jb("PresenceUserId"),
h.email===this.J.jb("UserPrincipalName")))}}Object(u.a)(bh,"WywaAuthorComparator",null,[]);class Ij{constructor(b){this.$P=b}cie(){this.$P&&this.$P.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(u.a)(Ij,"IndicatorSurveyActor",null,[]);var Mo=d(1046),Mn=d(1039);class ol{constructor(){}shouldShowDisplayChangesCheckbox(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayRecentChangesEnabled",!1)}shouldDisplayChangesBeInitiallyChecked(){return Promise.resolve(!0)}toggleShowingChanges(){return Promise.resolve(!0)}}
Object(u.a)(ol,"WordRecentChangesManager",null,[500]);class Bk{constructor(){this.$ml={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get Sml(){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")}get bXi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get tWi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get vce(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get Xun(){return y.AFrameworkApplication.J.$("IsUserFromDifferentTenant")}get poc(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}wc(b){Mq("Configure");this.container=b;b.ia("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new ig).ha()}init(){Mq("Init");this.Sml&&(E.a.instance.registerOnPackageInit("WordEditor.Workers",
()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,y.AFrameworkApplication.rootQuerySignature,ed.a.webServiceBase+"OneNote.ashx",hp.a.word,this.vce)}),Mq("HotStore"),ed.a.Nca.h$a.execute(()=>{Mq("ChromeReady");zk.a.get_instance().Sk(7,()=>{Mq("ScriptDownload");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("catchUpActivity")).catch(b=>{v.ULS.sendTraceTag(592233361,
377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.aXn()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}aXn(){Mq("CreateObjectsAndInitializeState");this.GEn();this.IDl();return this.r8m()}GEn(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");v.ULS.sendTraceTag(594401288,
3012,50,"Tasks and outstanding data is enabled");this.bXi&&v.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.tWi&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.Xun);this.vce&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}r8m(){this.X8m();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").vDf=new Date;Mq("InitializeCatchUpApp");return this.hec.initialize(Object.assign(new xo,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.bXi,customDynamicEntryPointEnabled:this.tWi,activityFeedDataEnabled:this.vce})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}IDl(){this.container.ia("WordEditor.CatchUpActivity.ChangeIdCache",()=>new hu(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Fl.a.hm.kb.Qc.vd)).ha();this.container.ia("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new Mo.a(xa.Health.instance,new Mn.a,this.$ml)).ha();this.container.ia("WordEditor.CatchUpActivity.IActivityStateManager",()=>new is).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityContentManager",()=>new yj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),y.AFrameworkApplication.va,Ol.UISurfaces.uL(),this.poc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ia("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new Sd(new ze.a(xh.a.Y0j(this.container.Ta("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),
()=>y.AFrameworkApplication.rootQuerySignature,ed.a.webServiceBase+"OneNote.ashx",hp.a.word,xh.a.Y0j(this.container.Ta("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityRequestManager",()=>new fk(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),
this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.poc)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Li(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),Fl.a.hm.kb.Qc,new ng(Fl.a.hm.kb.Qc),If.a.instance,Sg.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();
this.container.ia("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new tm.a(50,rd.a.Je):new ip;return new ea(y.AFrameworkApplication.pc,b,Fl.a.hm.kb.Qc.vd)}).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new Ij(this.container.Ta("Common.ISystemInitiatedFeedback"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityNavigationManager",
()=>new Ng(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),y.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.poc)).ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Ub(y.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),
Sg.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutFocus",()=>new yb(Gp.a.instance,Sg.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new Xc).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new ym(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
Fl.a.hm.kb.Qc)).ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new vd(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new M(new fa(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Hb(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),y.AFrameworkApplication.pc),new wc(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.poc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Xa(y.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();
this.container.ia("WordEditor.CatchUpActivity.RecentChangesManager",()=>new ol).as("Common.App.CatchUpActivity.IRecentChangesManager").ha();this.hec=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new Ot,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),
appColorUpdateIsEnabled:y.AFrameworkApplication.J.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:y.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.vce?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),
uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new cn.a,recentChangesManager:this.container.resolve("Common.App.CatchUpActivity.IRecentChangesManager")}));this.hec.setWebpackPublicPath(y.AFrameworkApplication.L8);this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new qt(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();this.container.ia("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new vh(y.AFrameworkApplication.J,pt.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new ad(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Qj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.hec.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Fl.a.hm.kb.Qc,this.container.Ta("Common.IZoomManager"),y.AFrameworkApplication.pc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!ed.a.instance&&ed.a.instance.LBa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorManager",
()=>new Yo(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Fl.a.hm.kb.Qc.vd,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),y.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new fs(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.container.resolve("Common.Utils.IAriaNotifier"),y.AFrameworkApplication.va,Sg.FocusManager.instance())).ha();this.container.ia("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new bh(y.AFrameworkApplication.userName,y.AFrameworkApplication.J,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}X8m(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.Vcb(h);const r=
this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const A=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const L=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),Z=If.a.instance,oa=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");Z.AB(()=>
{L.Uee?L.Uee=!1:(L.Ddb&&r.Mnj(null,null,!1),L.Zrb&&r.Hmj(null,null),A.Snf())});Z.AB(Object(D.a)(h,h.vP,"onSelectionChanged"));this.hec.getWywaEvent().addListener(Object(D.a)(b,b.Ggg,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.hec.getWywaEvent().addListener(Object(D.a)(b,b.Ggg,"onWywaActivityReady"));const Ba=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");oa.N1k((gb,Ab)=>{Ab&&Ba.E1n(Ab.node)});oa.uHb.then(()=>
{Ba.a5k()});this.hec.getWywaEvent().addListener(()=>{oa.Ncl()});A.k0k((gb,Ab)=>{Ab&&r.Hmj(Ab.UOb,Ab.AQi)});A.l0k((gb,Ab)=>{Ab&&r.Mnj(Ab.UOb,Ab.AQi,Ab.f5o)});A.Xb(y.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.E9o()}E9o(){eg.c()&&(v.ULS.sendTraceTag(591673372,3012,
50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(u.a)(Bk,"WordEditorCatchUpActivityPackageManager",null,[0,1]);var zm=d(183),qo=d(880),Nn=d(1422),ju=d(1507),kh=d(1596),Bs=d(1433),uj=d(1708),Lr=d(1709),sw=d(641),Jp=d(1710),gr=d(883),rt=d(143),Zo=d(1441);class sn{constructor(){this.operationType=this.annotation=null}}Object(u.a)(sn,"AnnotationChangedData",null,[]);class Pl{constructor(b,
h,r,A,L,Z,oa,Ba=!1,gb){this.annotationType=b;this.Cv=h;this.Ap=r;this.V0b=A;this.Dtd=L;this.RDp=Z;this.kb=oa;this.$Rj=Ba;this.J=gb;this.nz=null;this.j0i=!1;this.jd=new Bf.a;this.ped=0}QH(b){this.jd.addHandler("AnnotationChangedEvent",b)}hK(b){this.jd.removeHandler("AnnotationChangedEvent",b)}register(){return this.Dtd().then(()=>{0===this.ped&&(this.$Rj&&(this.nz=this.Ap.Xf("WebServiceCall",this.annotationType)),this.Cv.ub(this,this.annotationType));this.ped++})}unregister(){return this.Dtd().then(()=>
(new Promise(b=>setTimeout(b,this.J.jc(rt.a.ASl,3E3)))).then(()=>{0<this.ped&&(this.ped--,0===this.ped&&this.Cv.xc(this,this.annotationType))}))}getAnnotations(){return this.Dtd().then(()=>this.Cv.getAnnotationsByType(this.annotationType))}Vsi(b){b=qo.a.eH(b);return(b=this.Cv.w4d(b))&&0<b.count?b.toArray().filter(h=>gq.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.RDp(this.kb.hd.ud,b.parentPath):null:(v.ULS.shipAssertTag(575930380,
3016,!1),null)}Rza(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new gr.a,{parentPath:["Signal",gq.a.getTypeNameFor(b)],items:[Object.assign(new iu.a,{body:b})]});this.V0b.submitOperation(b)}D_l(b,h){b=Object.assign(new Ip.a,{parentPath:["Signal",h],items:b});this.V0b.submitOperation(b)}gH(b,h){b?h?(this.$Rj&&!this.j0i&&(this.nz.stop(),this.j0i=!0),this.jd.xfa&&(b=new Zo.a(Object.assign(new sn,{annotation:b,operationType:h})),this.jd.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,
3016,!1):v.ULS.shipAssertTag(575930381,3016,!1)}}Object(u.a)(Pl,"AnnotationManager",null,[591,114]);class jp{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.iL=b;this.dve=h;this.kPb=r;this.u8a=A;this.vaa=L;this.m0j=Z;this.A4=oa;this.y1b=Ba;this.Lgc=gb;this.eYb=Ab;this.Kip=Jb}}Object(u.a)(jp,"AnnotationManagerHolder",null,[589]);class ur{constructor(b,h){this.yya=b;this.Dtd=h}submitOperation(b){return this.Dtd().then(()=>{this.yya.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ka.a,{operation:b}))})}}
Object(u.a)(ur,"SubmitOperationHelper",null,[]);var Gk=d(1070),Cs=d(1711),st=d(1597),sf=d(42),On=d(104),xl=d(75),tt=d(1093);class Jf{constructor(b,h,r){this.vaa=b;this.$m=h;this.gcb=r;this.lJa={};this.ehi=!1;this.Ovb=(A,L)=>{var Z;L.data.operationType!==Ip.a.getTypeName()&&L.data.operationType!==tt.o.getTypeName()||!L.data.annotation||L.data.annotation.annotationType!==Cs.a.getTypeName()||(A=L.data.annotation.content)&&null!==(Z=A.documentTypeConfidences)&&void 0!==Z&&Z.length&&(this.dhi=A.documentTypeConfidences[0].documentTypeLabel,
v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.dhi))};this.vaa.QH(this.Ovb);this.vaa.register();this.lJa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}z6d(){this.ehi||(this.vaa.Rza(new st.a),v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.ehi=!0);this.uxf();this.lJa.docType=this.dhi;this.lJa.characterCount=
this.characterCount;this.lJa.paragraphCount=this.YU;this.lJa.imageCount=this.zL;this.lJa.tableCount=this.Jca;this.lJa.listElementsCount=this.H6i;this.lJa.blobsCount=this.OTc;this.lJa.pageCount=this.gcb.getTotalPageCount();this.lJa.currentPage=this.gcb.dDi();return this.lJa}uxf(){this.YU=this.OTc=this.H6i=this.Jca=this.zL=this.characterCount=0;var b=this.$m.osa(Fl.a.hm.kb.Qc.vd,7,7).currentNode,h=hb.a.eb(b);for(b=Dd.a.At(h,b);b.moveNext();)if(h=b.currentNode)if(Id.a.Eq(h))this.zL++;else if(si.TableReader.kP(h))this.Jca++;
else if(sf.ListItemReader.Fg(h))this.H6i++;else if(Cd.ParagraphReader.Wb(h)){var r=xl.e(h);for(let A=0;A<r.length;A++)5===r[A].Sh?this.zL++:this.OTc++;r=On.AParagraphNode.KP(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!Cd.ParagraphReader.EX(h)&&!Cd.ParagraphReader.DX(h)&&this.YU++}}}Object(u.a)(Jf,"LoggingDocumentInfo",null,[510]);class Xj{constructor(){this.sa=new Bf.a}l2k(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}xCo(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",
b)}e1k(b){this.sa.addHandler("BlueDotClickedEvent",b)}cCo(b){this.sa.removeHandler("BlueDotClickedEvent",b)}s1k(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}u1k(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}r1k(b){this.sa.addHandler("OnFormattingAccept",b)}t1k(b){this.sa.addHandler("OnFormattingReject",b)}Z1k(b){this.sa.addHandler("OnReviewInvalidated",b)}LPh(b){this.sa.addHandler("OnTraigeAction",b)}xff(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}qCo(b){this.sa.removeHandler("OnReviewVisibilityChanged",
b)}b1k(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}V1k(b){this.sa.addHandler("OnRegisterEnhancement",b)}o2k(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}yCo(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}kjd(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Zo.a(b)):v.ULS.shipAssertTag(575930374,3016,!1)}Nno(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Zo.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}Qno(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",
new Zo.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}Qxj(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Zo.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}Pno(b){b?this.sa.raiseEvent("OnFormattingAccept",new Zo.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}Rno(b){b?this.sa.raiseEvent("OnFormattingReject",new Zo.a(b)):v.ULS.shipAssertTag(575930378,3016,!1)}Sno(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Zo.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}uog(b){b?this.sa.raiseEvent("OnTraigeAction",
new Zo.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}Rxj(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Zo.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}Mno(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Zo.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}Kuc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Zo.a(b)):v.ULS.shipAssertTag(555055117,3016,!1)}gyj(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Zo.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(u.a)(Xj,"ReviewEvents",
null,[512]);class av{constructor(b){this.Sy=b;if(!b)throw zm.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}wc(b){this.Z=b;b.ia("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new ur(this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),qo.a.im)).ha();b.ia("WordEditor.Designer.IDesignerControl",()=>new Gk.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.uiCulture)).ha();b.ia("WordEditor.Designer.Common.Review.IReviewEvents",
()=>new Xj).ha();b.ia("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new jp(this.CIa(Bs.DocumentRoleDetectionAnnotation.getTypeName()),this.CIa(Bs.RoleDetectionAnnotation.getTypeName()),this.CIa(Nn.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.CIa(Nn.FormattingSuggestionsAnnotation.getTypeName()),this.CIa(ju.DocumentTypeClassifierAnnotation.getTypeName()),this.CIa(Lr.ThemeExtractorAnnotation.getTypeName()),this.CIa(sw.ThemeGeneratorAnnotation.getTypeName()),this.CIa(uj.TextToImageAnnotation.getTypeName()),
this.CIa(kh.DocumentPullQuoteAnnotation.getTypeName()),this.CIa(kh.PullQuoteAnnotation.getTypeName()),this.CIa(Jp.TableTypeAnnotation.getTypeName()))).ha();b.ia("WordEditor.Designer.DocumentInfo",()=>new Jf(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").vaa,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}CIa(b,h=!1){return new Pl(b,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.Z.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),qo.a.im,qo.a.m9a,this.Sy,h,this.Z.resolve("Common.IAppSettingsManager"))}}Object(u.a)(av,"PackageManager",null,[0,1]);var yq=d(1439),bv=d(1418),By=d(1712);class Qq extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.Sag=h}}Object(u.a)(Qq,"RoleChangeArgs",Sys.EventArgs,[]);class Cy{constructor(b){this.ji=!1;this.t$=b;this.t$.NDd++}dispose(){this.ji||(this.ji=!0,this.t$.NDd--)}}Object(u.a)(Cy,"InvalidationSuspension",
null,[10]);class Cv{constructor(){this.Iqd=null;this.role=this.zje=0;this.NKb=this.bfe=this.$la=this.ipc=!1;this.Eie=this.Fcd=this.bVa=null;this.nxb=this.placeholder=!1;this.gSd=this.Atf=null;this.fSd=0}get N$a(){return!this.role||!this.bVa||!this.bVa.length}rdn(){this.NKb=this.bfe=!0}kvn(){return!!this.role||!!this.bVa||!!this.Iqd}}Object(u.a)(Cv,"RoleState",null,[537]);class ks{constructor(b,h,r,A,L){this.vi=!1;this.fce=null;this.X6f=new re.a;this.Zkh=0;this.gKo=(Z,oa)=>{oa.data.operationType===
Ip.a.getTypeName()&&(oa=oa.data.annotation,(Z=oa.content)?(oa=this.w$b.getParent(oa))&&this.Qnd(oa,bv.f(Z.roleType),!1,void 0,null!=Z.listID?Z.listID:0,Z.listItemlevel,Z.listItemPrefix):v.ULS.shipAssertTag(575813856,3016,!1))};this.HXl=(Z,oa)=>{if(oa.data.operationType===Ip.a.getTypeName())if(Z=oa.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,Z.confidence.toString()),this.X6f=new re.a,oa=0;Z.listInfos&&oa<Z.listInfos.length;oa++){const Ba=Z.listInfos[oa];this.X6f.W(Ba.listID,Ba)}else v.ULS.shipAssertTag(556323522,
3016,!1)};this.PZi=(Z,oa)=>{Z=Z.iQ;if(!Z||Z.ka(Vc.a.RC,!1))return!1;Z=Z.getValue(Vc.a.na);if(!Z)return!1;Z=bv.g(Z);return 1!=Z&&Z!=oa.role};this.xdm=(Z,oa)=>{Z=oa.data.annotation;const Ba=this.EBd.getParent(Z);if(Ba)if(oa.data.operationType===Ip.a.getTypeName()){const gb=oa.data.annotation.content;gb?this.mha(Ba,Ab=>{this.fce&&Ab.Atf&&this.fce>Ab.Atf&&!Ab.NKb||Ab.role!==Ab.zje||this.PZi(Ba,Ab)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.fce,Ab.NKb,Ab.role===Ab.zje),Ab.Iqd=gb.suggestions):(Ab.bVa=gb.suggestions,Ab.NKb=!1)}):v.ULS.shipAssertTag(575813859,3016,!1)}else oa.data.operationType===yq.a.getTypeName()&&this.mha(Ba,gb=>{gb.bVa=null;gb.Iqd=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${Z.id} parentPath: ${Z.parentPath}`)};this.DZn=(Z,oa)=>{(Z=oa.data.paragraphNode)?this.mha(Z,Ba=>{oa.data.z$j?(Ba.gSd=Ba.bVa,Ba.fSd=Ba.role):(Ba.gSd=null,Ba.fSd=0);Ba.$la=!0}):v.ULS.shipAssertTag(575930368,
3016,!1)};this.FZn=(Z,oa)=>{(Z=oa.data.paragraphNode)?this.mha(Z,Ba=>{Ba.$la=!1;Ba.gSd=null;Ba.fSd=0;5!==oa.data.state&&(Ba.bVa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};this.BZn=(Z,oa)=>{(Z=oa.data.paragraphNode)?this.mha(Z,Ba=>{Ba.$la=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.EZn=(Z,oa)=>{(Z=oa.data.paragraphNode)?this.Qnd(Z,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.sgg=(Z,oa)=>{(Z=oa.data.paragraphNode)?this.Qnd(Z,oa.data.Sag,!0,!0):v.ULS.shipAssertTag(575484484,3016,
!1)};this.CTm=(Z,oa)=>{if(oa.node){var Ba=oa.node;Z=this.YB(Ba);27==Z.role&&v.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");Z.$la&&27!==Z.role&&28!==Z.role&&this.VQj(this.NZb-1);Z.N$a||27===Z.role||28===Z.role||this.OQj(this.inconsistenciesCount-1);this.mha(Ba,gb=>{gb.nxb=!0});setTimeout(()=>this.removeNode(Ba),1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=Z=>{let oa;({value:oa}=this.wv.Ec(Z.id));(null===oa||void 0===oa?0:oa.nxb)&&this.wv.remove(Z.id)};this.BTm=
(Z,oa)=>{oa.node?(Z=oa.node,this.OZf(Z)?this.mha(Z,Ba=>{Ba.nxb=!1}):this.mha(Z,Ba=>{Ba.NKb=!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.DTm=(Z,oa)=>{oa.node?this.Qyb(oa.property,oa.node)&&(Z=oa.node,this.NDd||Z.lqe?this.mha(Z,Ba=>{Ba.NKb=!1}):this.mha(Z,Ba=>{Ba.rdn();Ba.Iqd&&(Ba.bVa=Ba.Iqd,Ba.role=Ba.zje)}).$la&&this.n4a.Sno(new By.a(oa.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.G2n=(Z,oa)=>{switch(oa.data.role){case 27:const Ba=oa.data;this.mha(oa.data.paragraphNode,Ab=>{Ab.role=
27;Ab.ipc=!0;Ab.placeholder=Ba.placeholder});break;case 28:const gb=oa.data;this.mha(oa.data.paragraphNode,Ab=>{Ab.role=28;Ab.ipc=!0;Ab.placeholder=gb.placeholder;Ab.K6c=gb.K6c});break;case 2:this.mha(oa.data.paragraphNode,Ab=>{Ab.role=2})}};this.EBd=b;this.w$b=h;this.PPe=r;this.Zr=A;this.n4a=L;this.wv=new re.a;this.sa=new Bf.a;this.NDd=this.aLd=this.qDd=0}get Ndn(){return this.NDd}w1k(b){this.sa.addHandler(ks.Ykj,b)}c2k(b){this.sa.addHandler(ks.tnj,b)}b2k(b){this.sa.addHandler(ks.snj,b)}get inconsistenciesCount(){return this.qDd}OQj(b){this.qDd!==
b&&(this.qDd=b,this.sa.raiseEvent(ks.Ykj,new Zo.a(this.qDd)))}get NZb(){return this.aLd}VQj(b){this.aLd!==b&&(this.aLd=b,this.sa.raiseEvent(ks.tnj,new Zo.a(this.aLd)))}get eSf(){return this.Zkh}OZf(b){return this.wv.tb(b.id)}Kzm(b){var h,r;return null===(r=null===(h=this.X6f)||void 0===h?void 0:h.Ec(b))||void 0===r?void 0:r.value}yDi(b,h){var r,A,L;const Z=new Map;for(const oa of h)if(h=oa){const Ba=null!==(L=null===(A=null===(r=this.wv.Ec(h.id))||void 0===r?void 0:r.value)||void 0===A?void 0:A.role)&&
void 0!==L?L:1;b.has(Ba)&&(Z.has(Ba)?Z.get(Ba).add(h):Z.set(Ba,new nb.a([h])))}return Z}YB(b){if(!b)return v.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.wv.Ec(b.id)).returnValue?h:Object.assign(new Cv,{role:1,ipc:!1})}ZFo(){this.fce=new Date;return new Cy(this)}register(){this.EBd.register();this.w$b.register();this.PPe.register()}unregister(){this.EBd.unregister();this.w$b.unregister();this.PPe.unregister()}initialize(){if(!this.vi){const b=this.Zr.qf(12);b.ly(this.CTm);
b.ut(this.BTm);b.Qo(this.DTm);this.EBd.QH(this.xdm);this.w$b.QH(this.gKo);this.PPe.QH(this.HXl);this.n4a.t1k(this.EZn);this.n4a.r1k(this.BZn);this.n4a.s1k(this.DZn);this.n4a.u1k(this.FZn);this.n4a.LPh(this.sgg);this.n4a.V1k(this.G2n);this.vi=!0}}Wd(){}Qnd(b,h,r,A=!1,L=0,Z=0,oa){let Ba=0,gb=!1;this.mha(b,Ab=>{const Jb=Ab.bfe||!Ab.role||1==Ab.role;r||(Ab.zje=h);if(A||Jb)gb=Ab.role!==h,Ba=Ab.role,Ab.role=h,Ab.ipc=r,Ab.bfe=!1,Ab.Fcd=L,Ab.Eie=Z,Ab.listItemPrefix=oa,Ab.Atf=new Date});if(gb){const Ab=h-
4;Ab>this.eSf&&8>Ab&&(this.Zkh=Ab);1===h&&this.mha(b,Jb=>{Jb.bVa=null});this.sa.raiseEvent(ks.snj,new Zo.a(new Qq(b,h,Ba)))}}mha(b,h){let r;if(({value:r}=this.wv.Ec(b.id)).returnValue){b=r.N$a;const A=r.$la;h(r);if(27!==r.role&&28!==r.role){if(r.nxb)return r;b!==r.N$a&&this.OQj(this.inconsistenciesCount+(b?1:-1));A!==r.$la&&this.VQj(this.NZb+(A?-1:1))}}else h(r=new Cv),r.kvn()&&this.wv.add(b.id,r);return r}Qyb(b,h){({value:h}=this.wv.Ec(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===
h||void 0===h?0:h.placeholder)&&b===Ke.a.zn:!(null===h||void 0===h?0:h.placeholder)&&(b===Ke.a.zn||b===Ke.a.Sn||Array.contains(On.AParagraphNode.ufa(),b))}}ks.Ykj="OnInconsistenciesChanged";ks.tnj="OnRoleReviewCount";ks.snj="OnRoleChanged";Object(u.a)(ks,"RoleLifecycleManager",null,[505,506,507]);class Xs{constructor(b,h,r,A,L){this.n4a=b;this.w$b=h;this.Re=r;this.Zr=A;this.t$=L;this.vi=!1;this.sgg=(Z,oa)=>{(Z=oa.data.paragraphNode)?this.N6j(Z,()=>!0,Ba=>Ba.userSetRole=bv.e(oa.data.Sag)):v.ULS.shipAssertTag(557057378,
3016,!1)};this.z1n=(Z,oa)=>{0<this.t$.Ndn||this.Qyb(oa.property)&&this.N6j(oa.node,Ba=>!(Ba&&Ba.isInvalidated),Ba=>Ba.isInvalidated=!0)}}initialize(){this.vi||(this.n4a.LPh(this.sgg),this.Zr.qf(12).Qo(this.z1n),this.vi=!0)}Wd(){}N6j(b,h,r){if(b=(b=this.w$b.Vsi(b))&&1===b.length&&b[0]){var A=b.content;A=A&&A.M_&&A.M_.customMetadata;h(A)&&(h=new Bs.RoleDetectionCustomMetadata,h.isInvalidated=A&&A.isInvalidated,h.userSetRole=A&&A.userSetRole,r(h),this.Re.ovp(b,h))}}Qyb(b){return b===Ke.a.zn||b===Ke.a.Sn||
Array.contains(On.AParagraphNode.ufa(),b)}}Object(u.a)(Xs,"RoleDetectionMetadataUpdater",null,[504]);class Mr{constructor(b,h){this.V0b=b;this.TNb=h;this.Sed=(r,A)=>{r=A.data;if(r.operationType==tt.a.getTypeName()||r.operationType==tt.o.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.TNb.QH(this.Sed)}Wd(){this.TNb.hK(this.Sed)}kWn(){if(void 0===this.runId)Promise.resolve();else{var b=new Bs.RoleDetectionSettings({acceptedRunId:this.runId});
b=new tt.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.V0b.submitOperation(b)}}}Object(u.a)(Mr,"RoleDetectionSettingsUpdater",null,[]);class No{constructor(b,h,r){this.tcn=b;this.Cv=h;this.$d=r;this.RSi=this.initialized=!1;this.Rij=()=>{this.BSj()&&(this.qRi(),this.Cv.UBo(this.Rij))}}initialize(){this.initialized||(this.kUf(),this.initialized=!0)}Wd(){}kUf(){this.BSj()?this.qRi():this.Cv.Q0k(this.Rij)}BSj(){return!this.RSi&&
(this.$d.JWi()||this.Cv.cnc(Bs.DocumentRoleDetectionAnnotation.getTypeName())||this.Cv.cnc(Bs.RoleDetectionAnnotation.getTypeName()))}qRi(){for(const b of this.tcn)b.initialize();this.RSi=!0}}Object(u.a)(No,"RLMInitializer",null,[]);class hq{constructor(b,h,r){this.Y0=b;this.Sy=h;this.Cwd=r;this.Z=null;this.K8=()=>{this.d8c();this.Sy.bdb(this.K8)};if(!b)throw zm.a.argument("AppLifecycleManager is null");if(!h)throw zm.a.argument("Workspace is null");if(!r)throw zm.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>this.Ho())}wc(b){this.Z=b;b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new Mr(this.Z.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL)).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Xs(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dve,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new ks(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u8a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dve,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iL,
b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new No([this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}Ho(){this.Cwd.tN?this.Y0.Sk(16,()=>this.s7c()):this.s7c()}s7c(){this.Sy.uBa?this.d8c():this.Sy.Qja(this.K8)}d8c(){this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(u.a)(hq,"PackageManager",null,[0,1]);class ul{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,
h){const r=new ul;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(u.a)(ul,"DocumentSwayPreviewContent",null,[]);class ku{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static eBl(b,h,r,A){const L=new ku;L.RawText=b;L.ParagraphFormatting=h;L.TextRuns=r;L.IsRTL=A;L.ParagraphIndex=0;return L}}Object(u.a)(ku,"ParagraphContent",null,[]);var Pn=d(100),wa=d(1154);class Sa{constructor(){this.Name=null;this.Size=0}static construct(b,
h){const r=new Sa;r.Name=b;r.Size=h;return r}}Object(u.a)(Sa,"FontData",null,[]);class za{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,A,L,Z){const oa=new za;oa.IsBold=b;oa.IsUnderline=h;oa.IsUppercase=r;oa.Font=A;oa.Alignment=L;oa.LeftIndent=Z;return oa}}Object(u.a)(za,"TextFormatting",null,[]);class ta{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new ta;r.RawText=b;r.RunFormatting=
h;return r}}Object(u.a)(ta,"TextRunContent",null,[]);var Ya=d(108),Eb=d(92);class Wb{constructor(b,h){this.ohb=null;this.vDk=b;this.xQ=h||""}get k9n(){return this.vDk.value}u5l(){var b=Date.now();const h=ul.construct(2,this.xQ);h.Paragraphs=this.uhm();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();v.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}uhm(){const b=new nb.a;var h=0;let r=0,A=!1;var L=new hb.a;L.set(this.k9n);L=Dd.a.Bo(L.currentNode);const Z=new re.a(0);for(;L.moveNext()&&
2100>r&&25>h;){var oa=L.currentNode;if(Cd.ParagraphReader.Wb(oa)&&!Cd.ParagraphReader.EX(oa)){!A&&Cd.ParagraphReader.DX(oa)&&(A=!0);let Ba=On.AParagraphNode.KP(oa.characterData);Ba=Ba.trim();if(0<Ba.length){const gb=this.jN(oa);gb.ParagraphIndex=h;h++;r+=Ba.length;b.add(gb);this.Fyp(Z,Cd.ParagraphReader.language(oa))}}}this.ohb=this.Hom(Z);h={};h.documentHasList=A;v.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}Hom(b){let h=-1,r=1033;for(const A of b.keys.toArray())A&&b.K(A)>h&&(h=
b.K(A),r=A);return kg.a.Eg(r)}Fyp(b,h){b.tb(h)?b.W(h,b.K(h)+1):b.W(h,1)}jN(b){const h=On.AParagraphNode.KP(b.characterData),r=this.CEm(b),A=this.DOm(b);b=this.Hpn(b);return ku.eBl(h,r,A,b)}CEm(b){const h=Cd.ParagraphReader.Ug(b,Ke.a.bold,!1),r=Cd.ParagraphReader.Ug(b,Ke.a.underline,!1);var A=Cd.ParagraphReader.Ug(b,Ke.a.fontSize,Pn.a.VO);const L=Cd.ParagraphReader.Ug(b,Ke.a.font,Pn.a.KJ);var Z=Cd.ParagraphReader.Xy(b);Z=this.JFf(Z);const oa=!!Cd.ParagraphReader.Ug(b,cg.a.capitalization,0);b=(new wa.a).fX(b).value/
20;A=Sa.construct(L,A);return za.construct(h,r,oa,A,Z,b)}DOm(b){const h=new nb.a;for(let L=0;L<b.ra.length-1;L++){var r=b.ra.Ub(L),A=b.ra.Ub(L+1);r.formatting&&(A=On.AParagraphNode.KP(b.characterData.substr(r.cp,A.cp-r.cp)),r=this.EOm(r.formatting),r=ta.construct(A,r),h.add(r))}return h.toArray()}EOm(b){const h=Ya.FormattingReader.x4c(b,Ke.a.bold,!1),r=Ya.FormattingReader.x4c(b,Ke.a.underline,!1);var A=Ya.FormattingReader.x4c(b,Ke.a.fontSize,Pn.a.VO);const L=Ya.FormattingReader.x4c(b,Ke.a.font,Pn.a.KJ);
A=Sa.construct(L,A);b=!!Ya.FormattingReader.x4c(b,cg.a.capitalization,0);return za.construct(h,r,b,A,5,0)}JFf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}Hpn(b){const h=new hb.a;h.set(b);h.zb(11);return(b=h.kd(11))?Eb.a.Go(b):!1}}Object(u.a)(Wb,"DocumentContentExtractor",null,[450]);class oc{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}wc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",
()=>new Wb(new rg.a(()=>Fl.a.hm.kb.Qc.vd),y.AFrameworkApplication.Et.zA)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){E.a.instance.Mc(new oc)}}Object(u.a)(oc,"DocumentContentExtractorPackage",null,[0,1]);class Oc{}Oc.mh="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(u.a)(Oc,"EmbedDialogHtml",null,[]);class Sc{constructor(b,h,r,A){this.Wsc=
b;this.Y9a=h;this.noe=r;this.value=A}}Object(u.a)(Sc,"OptionInfo",null,[]);class ud{constructor(b,h,r){this.Pvg=b;this.hmc=h;this.Y9a=r}}Object(u.a)(ud,"SectionInfo",null,[]);var xd=d(305);class Yc extends Dg.a{constructor(b,h=!1){super(!1,!1,h);this.pAd=476;this.u6b=288;this.hPe=798;this.wJk=476;this.vJk=288;this.Egd={};this.Vxb=[];this.$Y=this.N3a=this.KGb=this.lDb=this.kId=this.Q9b=null;this.jal=r=>{this.o0h(r);return!0};this.kal=r=>this.Bad(r,this.o0h);this.o0h=r=>{r=r.uq;"visible"===r.Pvg.style.visibility?
(r.Pvg.style.visibility="hidden",r.Y9a.className=Pb.getImageClass(Yc.qfh),r.Y9a.title=CommonUIStrings.l_Expand,r.hmc.title=CommonUIStrings.l_Expand):(r.Pvg.style.visibility="visible",r.Y9a.className=Pb.getImageClass(Yc.DRk),r.Y9a.title=CommonUIStrings.l_Collapse,r.hmc.title=CommonUIStrings.l_Collapse)};this.r7n=r=>{this.Kpj(r);return!0};this.s7n=r=>this.Bad(r,this.Kpj);this.Kpj=r=>{const A=this.Egd[r.uq.toString()];A.value?(A.value=0,A.Y9a.className=Pb.getImageClass(Yc.Iaf),A.noe.setAttribute($c.a.QHa,
$c.a.DO)):(A.value=1,A.Y9a.className=Pb.getImageClass(Yc.gMe),A.noe.setAttribute($c.a.QHa,$c.a.mq));this.tEe(r.uq.toString(),A.value.toString())};this.ekp=()=>{this.$Y.select()};this.SGc=y.AFrameworkApplication.q6c;this.qHb=b;this.X1e=this.r7n;this.PMc=this.s7n;this.kKe=this.jal;this.g4b=this.kal;this.WNd=this.ekp;this.VBk=h;this.mh=Oc.mh;this.Bd=0;this.Ig="EmbedDialog"}get Dw(){return this.u6b}set Dw(b){this.u6b=b}RUj(b){const h={["id"]:this.Ig,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,
["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Ma.a.lq(this.qHb,"wdPreview","1"),["initialEmbedUrl"]:this.SGc,["getEmbedCode"]:Yc.dxi,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Bd=1;this.Ke(1,CommonUIStrings.l_CopyAction);this.Ke(0,CommonUIStrings.l_Close);this.Uh(CommonUIStrings.l_Embed,null,h)}Lxc(){if(this.VBk)this.RUj({});
else{this.showDialog(CommonUIStrings.l_Embed,null);this.Q9b=document.getElementById("embedpreviewpane");this.kId=document.getElementById("embedoptionpane");this.Q9b.style.width=String.format("{0}px",this.wJk);this.N3a=document.createElement("iframe");this.N3a.className=Yc.uJk;this.N3a.frameBorder="0";this.N3a.style.height=String.format("{0}px",this.vJk);this.N3a.tabIndex=-1;this.Q9b.appendChild(this.zYd(CommonUIStrings.l_Preview,this.N3a,Yc.Yzh,Yc.Xzh,Yc.Yzh,!0));this.$Y=document.createElement("textarea");
this.$Y.className=Yc.ruk;Sys.UI.DomElement.addCssClass(this.$Y,xd.a.Jgf);this.$Y.id=Yc.bgh;aa.a.Di||(this.$Y.readOnly=!0);this.$Y.rows=4;this.$Y.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.$Y.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.$Y.setAttribute($c.a.Xja,String.format("{0} {1}",Yc.agh,Yc.$fh));this.Q9b.appendChild(this.zYd(CommonUIStrings.l_EmbedCode,this.$Y,Yc.agh));zc.a.addHandler(this.$Y,"focus",this.WNd);var b=document.createElement("span");b.className=
Yc.kwk;b.innerText=CommonUIStrings.l_CopyText;b.id=Yc.$fh;this.Q9b.appendChild(b);this.lDb=document.createElement("div");this.lDb.className=Yc.ytk;this.kId.appendChild(this.zYd(CommonUIStrings.l_Dimensions,this.lDb));this.KGb=document.createElement("div");this.kId.appendChild(this.zEl(Yc.Nxh,this.KGb));this.Bd=0;this.Ke(1,CommonUIStrings.l_Close);this.lKg();this.F8j();aa.a.Di||this.$Y.focus()}}dispose(){if(this.Egd){var b=this.Egd;for(const h in b){const r=b[h];this.rr.xc(od.a.click,r.Wsc,this.X1e);
this.oe.xc(od.a.ij,r.Wsc,this.PMc);this.oe.xc(od.a.gi,r.Wsc,this.PMc)}this.PMc=this.X1e=this.Egd=null}if(this.Vxb){for(b=0;b<this.Vxb.length;++b)this.rr.xc(od.a.click,this.Vxb[b].hmc,this.kKe),this.oe.xc(od.a.ij,this.Vxb[b].hmc,this.g4b),this.oe.xc(od.a.lv,this.Vxb[b].hmc,this.g4b),this.oe.xc(od.a.gi,this.Vxb[b].hmc,this.g4b);this.oe=this.kKe=this.Vxb=null}this.WNd&&this.$Y&&(zc.a.removeHandler(this.$Y,"focus",this.WNd),this.WNd=null);this.$Y=this.N3a=this.KGb=this.lDb=this.kId=this.Q9b=null;super.dispose()}Nga(){super.Nga();
this.Oc.style.width=String.format("{0}px",this.hPe);this.$Ha()}hxp(b,h){const r=Ma.a.lq(this.SGc,b,h);return this.SGc!==r?(this.SGc=r,this.qHb=Ma.a.lq(this.qHb,b,h),!0):!1}lKg(){this.$Y&&(this.$Y.innerText=Yc.dxi(this.SGc,this.pAd,this.u6b))}F8j(){this.N3a&&this.N3a.contentWindow.location.replace(Ma.a.lq(this.qHb,"wdPreview","1"))}tEe(b,h){this.hxp(b,h)&&(this.lKg(),this.F8j())}zYd(b,h,r=null,A=null,L=null,Z=!1){const oa=document.createElement("div");oa.className=Yc.jMk;A&&(oa.id=A);L&&oa.setAttribute($c.a.Xja,
L);Z&&(oa.tabIndex=0);A=document.createElement("span");A.className=Yc.kMk;A.innerText=b;r&&(A.id=r);oa.appendChild(A);oa.appendChild(h);return oa}zEl(b,h){const r=this.zYd(CommonUIStrings.l_Interaction,h),A=this.Oj.createElement("div");A.className=Yc.dok;A.id=Yc.k9g+b;A.setAttribute($c.a.Wh,$c.a.N$);A.tabIndex=0;r.insertBefore(A,h);b=Pb.createClusteredImage(16,16,Yc.eok,Yc.fok,!0,"");A.appendChild(b);b=b.childNodes[0];b.className=Pb.getImageClass(Yc.qfh);b.title=CommonUIStrings.l_Expand;A.title=CommonUIStrings.l_Expand;
h.style.visibility="hidden";h=new ud(h,A,b);Array.add(this.Vxb,h);this.rr.LI(od.a.click,A,this.kKe,h);this.oe.LI(od.a.ij,A,this.g4b,h);this.oe.LI(od.a.lv,A,this.g4b,h);this.oe.LI(od.a.gi,A,this.g4b,h);return r}k9h(b,h){const r=document.createElement("div");r.className=Yc.Kxh;r.id=b+Yc.Lxh;var A=this.Oj.createElement("div");A.tabIndex=0;A.className=Yc.Cah;A.id=b+Yc.yEc;A.setAttribute($c.a.Wh,$c.a.rif);A.setAttribute($c.a.QHa,$c.a.mq);A.setAttribute($c.a.Xja,b+Yc.T5b);r.appendChild(A);r.setAttribute($c.a.Wh,
$c.a.xA);var L=Pb.createClusteredImage(16,16,Yc.Kah,Yc.Jah,!0,"");A.appendChild(L);L=L.childNodes[0];L.id=b+Yc.Mxh;L.className=Pb.getImageClass(Yc.gMe);A=new Sc(r,L,A,1);this.Egd[b]=A;this.rr.LI(od.a.click,r,this.X1e,b);A=document.createElement("span");A.className=Yc.T5b;A.innerText=h;A.id=b+Yc.T5b;r.appendChild(A);this.oe.LI(od.a.ij,r,this.PMc,b);this.oe.LI(od.a.gi,r,this.PMc,b);return r}static dxi(b,h,r){if(!Yc.E0e){const A=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.Ylc("https://office.com"),
CommonUIStrings.l_Office),L=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.Ylc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Yc.E0e=String.format(CommonUIStrings.l_NoFrames,A,L)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',F.a.Ylc(b),h,r,Yc.E0e)}}Yc.E0e=null;Yc.gMe="CheckboxChecked_16x16x32";Yc.Iaf="CheckboxUnchecked_16x16x32";Yc.DRk="OutlookSearchChevronUp_16x16x32";Yc.qfh="OutlookSearchChevronDown_16x16x32";Yc.Kah="CommentChecked";
Yc.eok="UpArrowServer";Yc.T5b="EmbedDescription";Yc.jMk="EmbedSectionHeader";Yc.kMk="EmbedSectionName UIFontBold";Yc.kwk="EmbedCodeFooter";Yc.Jah="EmbedOptionImage";Yc.uJk="EmbedPreviewFrame";Yc.ruk="EmbedCodeTextArea";Yc.Kxh="EmbedOption";Yc.ytk="EmbedDimensionSection";Yc.fok="EmbedArrowIcon";Yc.dok="WACGlyph EmbedArrowHolder";Yc.Cah="EmbedCheckBoxHolder";Yc.Lxh="Option";Yc.Mxh="OptionImage";Yc.bgh="EmbedCode";Yc.agh="EmbedCodeHeader";Yc.Yzh="Preview";Yc.Xzh="PreviewHeader";Yc.Nxh="Options";Yc.k9g=
"Arrow";Yc.yEc="Check";Yc.$fh="EmbedCodeFooter";Object(u.a)(Yc,"EmbedDialog",Dg.a,[]);class Md extends Sc{constructor(b,h,r,A,L){super(b,h,r,A);this.i$a=L}}Object(u.a)(Md,"OptionInputInfo",Sc,[]);class He extends Yc{constructor(b,h){super(b,He.NN);this.Zda=null;this.qGc=[];this.SMd=Object(D.a)(this,this.Ldp,"startOnOptionClickHandler");this.qac=Object(D.a)(this,this.Mdp,"startOnOptionKeyHandler");this.DId=Object(D.a)(this,this.p1n,"onPageNumberChanged");this.tPe=Object(D.a)(this,this.FYn,"onDimensionChanged");
this.oJ=h}Lxc(){if(He.NN){var b=He.jpo,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.oJ.bvj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.oJ.Nzj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.oJ.vXj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.oJ.xXj}});this.RUj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.pAd,
["defaultHeight"]:this.u6b,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.oJ.qbk,["heightLabel"]:this.oJ.YNi},["interactionOptions"]:h})}else super.Lxc(),this.NMh(this.oJ.qbk,"EmbedWidthInput",this.pAd),this.NMh(this.oJ.YNi,"EmbedHeightInput",this.u6b),this.KGb.appendChild(this.k9h("wdPrint",this.oJ.bvj)),this.KGb.appendChild(this.k9h("wdEmbedCode",this.oJ.Nzj)),this.vVk(this.oJ.vXj),this.$Ha(),Sg.FocusManager.lM()&&(b=Sg.FocusManager.instance(),h=[document.getElementById(Yc.bgh),document.getElementById("EmbedWidthInput"),
document.getElementById("EmbedHeightInput"),document.getElementById(Yc.k9g+Yc.Nxh),document.getElementById("wdPrint"+Yc.yEc),document.getElementById("wdEmbedCode"+Yc.yEc),document.getElementById("wdStartOn"+Yc.yEc),document.getElementById("wdStartOnText"),document.getElementById(ff.a.Wvd),document.getElementById(Yc.Xzh)],h=new km(h),b.$t().Uk=h,aa.a.Di?this.e4(document.getElementById(ff.a.Wvd)):this.$Y.select())}dispose(){if(!He.NN){if(this.qGc){for(let b=0;b<this.qGc.length;++b)zc.a.removeHandler(this.qGc[b],
"change",this.tPe);this.qGc=this.tPe=null}this.DId&&(zc.a.removeHandler(this.Zda.i$a,"change",this.DId),this.DId=null);this.SMd&&(this.rr.xc(od.a.click,this.Zda.Wsc,this.SMd),this.SMd=null);this.qac&&(this.oe.xc(od.a.ij,this.Zda.Wsc,this.qac),this.oe.xc(od.a.gi,this.Zda.Wsc,this.qac),this.qac=null);this.Zda=null}super.dispose()}NMh(b,h,r){const A=document.createElement("label");A.className="EmbedInputPrefix";A.innerText=b;this.lDb.appendChild(A);b=document.createElement("input");b.className=h;b.id=
h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");A.setAttribute("for",h);this.lDb.appendChild(b);this.qGc.push(b);zc.a.addHandler(b,"change",this.tPe);this.lDb.appendChild(document.createElement("br"))}FYn(b){"EmbedWidthInput"===b.target.id?this.pAd=this.Z0d(b.target,375):this.u6b=this.Z0d(b.target,250);this.lKg()}Z0d(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}p1n(b){b=this.Z0d(b.target,1);1===this.Zda.value&&this.tEe("wdStartOn",b.toString())}vVk(b){const h=
document.createElement("div");h.className=Yc.Kxh+" EmbedInlineOption";h.id="wdStartOn"+Yc.Lxh;const r=this.Oj.createElement("div");r.tabIndex=0;r.className=Yc.Cah;r.id="wdStartOn"+Yc.yEc;r.setAttribute($c.a.Wh,$c.a.rif);r.setAttribute($c.a.QHa,$c.a.DO);r.setAttribute($c.a.Xja,"wdStartOn"+Yc.T5b);h.appendChild(r);h.setAttribute($c.a.Wh,$c.a.xA);var A=Pb.createClusteredImage(16,16,Yc.Kah,Yc.Jah,!0,"");r.appendChild(A);A=A.childNodes[0];A.id="wdStartOn"+Yc.Mxh;A.className=Pb.getImageClass(Yc.Iaf);const L=
document.createElement("span");L.className=Yc.T5b;L.innerText=b;L.id="wdStartOn"+Yc.T5b;h.appendChild(L);this.KGb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.oJ.xXj;b.setAttribute("data-lpignore","true");this.KGb.appendChild(b);zc.a.addHandler(b,"change",this.DId);this.Zda=new Md(h,A,r,0,b);this.tEe("wdStartOn","1");this.rr.ub(od.a.click,h,this.SMd);this.oe.ub(od.a.ij,h,this.qac);this.oe.ub(od.a.gi,h,this.qac)}Ldp(b){this.tXj(b);
return!0}Mdp(b){return this.Bad(b,Object(D.a)(this,this.tXj,"startOnOptionHandler"))}tXj(){let b=1;this.Zda.value?(this.Zda.value=0,this.Zda.Y9a.className=Pb.getImageClass(Yc.Iaf),this.Zda.noe.setAttribute($c.a.QHa,$c.a.DO)):(this.Zda.value=1,this.Zda.Y9a.className=Pb.getImageClass(Yc.gMe),b=this.Z0d(this.Zda.i$a,1),this.Zda.noe.setAttribute($c.a.QHa,$c.a.mq));this.tEe("wdStartOn",b.toString())}static get NN(){return y.AFrameworkApplication.ua.Gb.kH}static jpo(b,h,r,A=null){if("wdPrint"===h||"wdEmbedCode"===
h)return Ma.a.lq(b,h,r?"1":"0");if("wdStartOn"===h){let L="1";r&&A&&(A=parseInt(A),!isNaN(A)&&1<=A&&(L=A.toString()));return Ma.a.lq(b,h,r?L:"1")}return b}}Object(u.a)(He,"WordEmbedDialog",Yc,[]);class xe{constructor(b,h,r,A,L){this.Nia=null;this.ga=b;this.Bib=h;this.FS=r;this.oJ=A;this.jia=L}Xb(){this.ga.qa(this.FS,Gc.a.frame,Object(D.a)(this,this.U7o,"showEmbedCode"));this.Bib.execute(Object(D.a)(this,this.leg,"onHostPostmessengerCreated"))}leg(b){v.ULS.shipAssertTag(4994850,332,!!b);this.Nia=b;
y.AFrameworkApplication.Tfa||(this.Nia.Bv(K.a.VZh),this.Nia.LE(K.a.VZh,Object(D.a)(this,this.Lxc,"showEmbedDialog")))}Lxc(b){b=b.Values.HostEmbeddedViewUrl.toString();y.AFrameworkApplication.q6c=b;this.jia.Wyf=b;(new He(b,this.oJ)).Lxc()}U7o(b,h,r){if(2===r)if(y.AFrameworkApplication.q6c)(new He(this.jia.Wyf,this.oJ)).Lxc();else return y.AFrameworkApplication.Bn.c$a(xe.bfk),y.AFrameworkApplication.FLg&&this.Nia.sendMessage(K.a.o7l,null)?32:y.AFrameworkApplication.ua.MX(!0,y.AFrameworkApplication.XBf);
return 32}}xe.bfk=10381;Object(u.a)(xe,"EmbedActor",null,[]);class ve{}Object(u.a)(ve,"WordEmbedDialogStrings",null,[]);var Qe=d(232);class hf extends xe{constructor(b,h){super(b,h,Ec.a.MBg,Object.assign(new ve,{qbk:WordEditorIntl.WordEditorStrings.l_Width,YNi:WordEditorIntl.WordEditorStrings.l_Height,bvj:WordEditorIntl.WordEditorStrings.l_PrintOption,Nzj:WordEditorIntl.WordEditorStrings.l_ReembedOption,vXj:WordEditorIntl.WordEditorStrings.l_StartOnOption,xXj:WordEditorIntl.WordEditorStrings.l_StartPage}),
Qe.WoncaApp.instance)}}Object(u.a)(hf,"EmbedActor",xe,[]);class nf{constructor(){this.Z=null}get name(){return"WordEditor.Embed"}wc(b){this.Z=b;b.ia("WordEditor.Embed.EmbedActor",()=>new hf(y.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha()}init(){this.Z.resolve("WordEditor.Embed.EmbedActor").Xb()}dispose(){}}Object(u.a)(nf,"EmbedPackage",null,[0,1]);class bg{constructor(b,h,r){this.qx=this.tQa=this.DSa=null;this.jQa=0;this.e8b=this.X7b=this.J7b=this.m8b=this.q2a=this.p2a=!1;
this.Dk=b;this.St=r}MR(b){return ab.StaticActiveAppFrame.za().kb.isEditingAllowed?""!==this.i3c(b.Df):!1}zN(b){if(!this.MR(b))return!1;this.xTo(b);this.yTo();this.zTo();this.DSa=b.jK;this.qx=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}OX(b){this.tQa=b.jK;this.Kjl();this.Dk.D7j(this.qx.x,this.qx.y,this.m8b,this.J7b,this.X7b,this.e8b,!1);return!0}YF(){this.Dk.D7j(this.qx.x,this.qx.y,this.m8b,this.J7b,this.X7b,this.e8b,!0);v.ULS.sendTraceTag(22381024,
322,50,"Image Crop drag succeeded")}s0(){this.Dk.uml();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}yTo(){this.e8b=this.X7b=this.J7b=this.m8b=!1;switch(this.jQa){case 1:this.m8b=!0;break;case 5:this.J7b=!0;break;case 3:this.e8b=!0;break;case 7:this.X7b=!0;break;case 0:this.X7b=this.m8b=!0;break;case 2:this.e8b=this.m8b=!0;break;case 6:this.X7b=this.J7b=!0;break;case 4:this.e8b=this.J7b=!0}}zTo(){this.q2a=this.p2a=!1;switch(this.jQa){case 0:this.q2a=this.p2a=!0;break;case 1:case 2:this.q2a=
!0;break;case 7:case 6:this.p2a=!0}}i3c(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}xTo(b){switch(this.i3c(b.Df)){case "WACImageCropHandleNW":this.jQa=0;break;case "WACImageCropHandleN":this.jQa=1;break;case "WACImageCropHandleNE":this.jQa=2;break;case "WACImageCropHandleE":this.jQa=3;break;case "WACImageCropHandleSE":this.jQa=
4;break;case "WACImageCropHandleS":this.jQa=5;break;case "WACImageCropHandleSW":this.jQa=6;break;case "WACImageCropHandleW":this.jQa=7}}Kjl(){var b=1;this.St.instance&&(b=this.St.instance.nl);const h=(this.tQa.x-this.DSa.x)/b;b=(this.tQa.y-this.DSa.y)/b;this.qx.x=this.p2a?-h:h;this.qx.y=this.q2a?-b:b}}Object(u.a)(bg,"ImageCropDragAdapter",null,[191]);class lh{constructor(b,h){this.ga=b;this.St=h}bwm(b){return new bg(b,this.ga,this.St)}}Object(u.a)(lh,"ImageCropDragAdapterFactory",null,[647]);var ph=
d(310),Sf=d(219),De=d(33),Yf=d(416),ki=d(719),Df=d(82),gf=d(63),vj=d(184),cm=d(487),yl=d(903),Vh=d(533),yo=d(741),pl=d(140),Qn=d(369),Yj=d(768),iq=d(658),fo=d(202),fm=d(79),Kh=d(15),lu=d(257),oi=d(796),Rq=d(382),zl=d(119);class $o{constructor(b,h,r,A,L,Z,oa,Ba){this.V7c=null;this.jT=b;this.Vh=h;this.Rc=r;this.xv=A;this.Rd=L;this.ib=Z;this.Vn=oa;this.EG=Ba}get ZZ(){return null!=this.pSg?this.pSg:this.pSg=Wa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get Yb(){return null!=this.g7g?this.g7g:
this.g7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get pj(){return pl.PageReader.instance}OVo(b,h,r){const A=this.Rc.Lc(15);A.Ab(h.node);this.g_a(b,r);A.dispose()}NVo(b,h,r){const A=this.Rc.Lc(15);A.Ab(h.node);this.y_b(b,r);A.dispose()}g_a(b,h){b.setValue(Ke.a.imageAltText,h)}y_b(b,h){b.setValue(Vc.a.R_,h)}VVo(b,h){b.setValue(Ke.a.bsb,h)}eOj(b,h){if(Object(vj.d)(b)){const r=b.ka(De.a.ele,null);h=oi.a.FIl(h,r);b.setValue(De.a.ele,h)}else b.setValue(Vc.a.S_,h)}RVo(b,h,r,A,L){let Z=0;var oa=
0;({width:Z,height:oa}=Id.a.$8a(b));oa-=(h+r)/1E5*oa;this.JNa(b,Z-(A+L)/1E5*Z);this.INa(b,oa);this.vOj(b);b.setValue(Vc.a.zae,h);b.setValue(Vc.a.wae,r);b.setValue(Vc.a.xae,A);b.setValue(Vc.a.yae,L)}TZo(b,h,r,A){const L=this.Rc.Lc(15);L.Ab(h.node);this.Lwe(b,r,A);L.dispose()}Lwe(b,h,r){this.JNa(b,h);this.INa(b,r);this.vOj(b);b.removeProperty(Od.a.Ipe);b.removeProperty(Od.a.Hpe)}JNa(b,h){b.setValue(Ke.a.zta,h);b.setValue(Od.a.HKa,-1)}INa(b,h){b.setValue(Ke.a.yta,h);b.setValue(Od.a.GKa,-1)}wH(b,h){b.setValue(Vc.a.Qlc,
h);b.setValue(Ke.a.si,h);b.setValue(Ke.a.Cs,h)}J_o(b,h){b.setValue(Vc.a.Zzb,h)}zSo(b,h){b.setValue(Vc.a.dTd,h)}O_o(b){if(!Id.a.A7(b)&&b.Al){var h=b.node;if(Id.a.cba(h)){const L=this.Rc.Lc(15);L.Ab(b.node);b=hb.a.eb(h);b.zb(12);b=b.parentNode;var r=b.properties.zf(Vc.a.Iq),A=h.properties.getValue(Vc.a.runId);h.ka(Vc.a.ed,Cl.a.AV);const Z=b.ra;if(!y.AFrameworkApplication.J||!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveAnchoredProperties",!1)){const oa=[Vc.a.Qlc,
Ke.a.si,Ke.a.Cs,Vc.a.dTd,Vc.a.Zzb,Vc.a.lTa];Object(vj.d)(h)&&oa.push(De.a.O9d,De.a.N9d);h.Vf.apply(h,oa)}r=this.AHf(A,r,Z);A=xc.a.Uc(b,r);this.xv.r7h(h,A);(h=this.EG.eL(b,r,r+1))&&this.ib.Kc(h);this.ZZ.ava(b,r,r+1);L.dispose()}}}qxg(b,h){if(b.properties.hasProperty(Vc.a.i6)){const r=b.properties.zf(Vc.a.i6);r.push(h);b.properties.setValue(Vc.a.i6,Array.clone(r))}else b.properties.setValue(Vc.a.i6,[h])}Uxe(b,h,r=0,A=!1){if(b.Al){var L=this.Rc.Lc(15),Z=b.node;L.Ab(Z);if(Id.a.A7(b)){const Ab=Object(vj.c)()?
new yo.a:new Vh.a;Ab.zt(Id.a.Mn(b));var oa=Z.ra,Ba=this.d9l(b.cpBegin,oa);this.v$k(b.cpEnd,oa,Ba)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");oa=oa.Ub(Ba).blob;Ba=oa.te;var gb=Z.properties.zf(Vc.a.Iq);gb=this.Joo(gb);Ba=gb[Ba];gb=Z.ka(Vc.a.ed,Cl.a.AV);if(oa=Object(Ca.a)(yl.a,oa))oa.g0b=!1;this.Rd.We(b,"");oa&&(oa.g0b=!0);Ab.properties.setValue(Vc.a.runId,Ba);Ab.properties.setValue(Vc.a.ed,gb);b=hb.a.eb(Z);b.zb(12);b.Wf(Ab,6);this.qxg(b.currentNode,Ab.anchor.node.id);
Z=Ab}r&&this.wH(Z.properties,r);this.zSo(Z.properties,A);this.J_o(Z.properties,h);this.ZZ.Jwc(Z);(h=this.EG.Er(Z))&&this.ib.Kc(h);L.dispose()}}tvg(b,h){if(!(0>=h)){var r=nh.a.hn(h,0),A=Id.a.XB(b),L=Id.a.fD(b);A>r&&(L*=r/A,this.JNa(b,r),this.INa(b,L),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}v$k(b,h,r){const A=h.length;if(r>=A||!h.Ub(r).Ue)return!1;const L=new ln.a;for(;r<A;r++){const Z=h.Ub(r);if(Z.cp>b||!Z.Ue)break;for(let oa=0;oa<Z.Ue.length;oa++){if(L.contains(Z.Ue.K(oa).pk))return!0;
L.add(Z.Ue.K(oa).pk)}}return!1}Joo(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var A=b[h];r=h-1;for(var L=A-1;0<=r;)b[r]=L,r--,L--;L=0;for(r=h+1;r<b.length;)(h=b[r])?h<A?(A=h+L,b[r]=A):A=h:(L+=2,A++,b[r]=A),r++}return b}ICf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}AHf(b,h,r){let A=0;const L=this.ICf(b,h);let Z=0;if(L===h.length)Z=r.length-1;else for(;Z<r.length;){h=r.Ub(Z);if(h.formatting&&h.formatting.te===L)break;Z++}Z<r.length?A=
r.Ub(Z).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:Z,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return A}d9l(b,h){let r=0;for(;r<h.length&&h.Ub(r).cp!==b;)r++;r===h.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}vOj(b){b.setValue(Ke.a.FBa,!0)}iqe(b,h,r,A=!1){h&&r?(h=Math.max(h,ki.a.Wdj),r=Math.max(r,ki.a.Wdj)):
r=h=ki.a.Yci;b.setValue(Ke.a.zta,nh.a.hn(h,0));b.setValue(Ke.a.yta,nh.a.hn(r,1));b.setValue(Ke.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(cg.a.U_,ub.a.ZOa);b.setValue(Vc.a.Zla,A)}Ebe(){return null}Pgi(b,h,r){let A=null;h=({bWb:A}=this.Qgi(b,h,r)).returnValue;A&&b.view.lb.Kc(A);return h}Qgi(b,h,r){var A=null;if(!this.fka(b))return{returnValue:null,bWb:A};var L=b.view;const Z=this.Rc.Lc(15,vb.a.sSb);Z.Ab(L.vd);h||(h=new lj.DictionaryPropertySet);h.setValue(Od.a.qYl,!0);let oa=
L.lb.Pg;var Ba=new iq.a;if(!he.a.mf(oa)){if(2===y.AFrameworkApplication.va.Ob(vb.a.Bra,2))return Z.dispose(),{returnValue:null,bWb:A};oa=L.lb.Pg}else if(oa.Al&&Cd.ParagraphReader.Wb(oa.node)){pf.a.xd().xm&&pf.a.xd().Bk.IG(oa.node);L=Ya.FormattingReader.Vs(oa);if(!L)return Z.dispose(),{returnValue:null,bWb:A};L.cache.tE&&(L=L.Of(null),$o.tj.p8(L));Ba.formatting=L.Hk;Ba.languageId=Ya.FormattingReader.language(L);Ba.goa=this.Yb.Cq(oa.node)}if(!oa.Al)return Z.dispose(),{returnValue:null,bWb:A};if(!this.XUf(b.Lk,
h))return Z.dispose(),this.V7c=null,{returnValue:null,bWb:A};b=this.V7c;this.V7c=null;1===b.location?(A=b.node,h=Rq.a.instance.pOf(A),fg.OutlineElementNavigator.ft(h,!1,!1)||(fo.OutlineNavigator.Uue(h),this.jT.Tja(h,!0,Ba)),fg.OutlineElementNavigator.Me(h),si.TableReader.isTable(h)&&(Object(Gb.a)(zl.a,h)||Object(Gb.a)(Qn.a,h)?(Ba=new hb.a,Ba.set(h.currentNode),Kh.moveToCellContent(Ba,0,0),h.set(Ba.currentNode)):Kh.moveToCellContent(h,0,0),Eb.a.Mh(h)?fg.OutlineElementNavigator.Me(h):h=Rq.a.instance.pOf(A)),
A=Cd.ParagraphReader.uu(h.currentNode)?this.EG.ue(h.currentNode,0):this.EG.Er(h.currentNode)):b.location||(Ba=b.blob.Ib.cp+1,A=this.EG.eL(b.node,Ba-1,Ba));Z.QLa(r,1);Z.Ph=vb.a.sSb;Z.dispose();return{returnValue:b,bWb:A}}XUf(){return!1}fka(b){b.contextId===kc.a.view&&b.view.ve&&b.view.lb&&(b=b.view.lb.Pg);if(!b)return $o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Qn}),!1;if($o.tg.p2(b))return $o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UG}),!1;if($o.tg.ama(b))return $o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.lSi}),!1;if(this.Vn&&
this.Vn.instance&&this.Vn.instance.zX(b))return $o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Z7a}),!1;if(this.pj.u7)return $o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.compatMode}),!1;if(b.Al)return fm.OutlineReader.Cee(b)?($o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Aqf}),!1):Id.a.Bde(b)?($o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.sqf}),!1):lu.c(b)?($o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.tqf}),!1):Yj.a.XXf(b)?($o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.rqf}),!1):Cd.ParagraphReader.xX(b)||Id.a.hfn(b)?($o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),!1):!0;if(cm.a.oZf(b)){let h=
!0;for(let r=0;r<b.length;++r){const A=b.getContext(r);if(!A.Al)return!1;h&&!Cd.ParagraphReader.xX(A)&&(h=!1)}return h?($o.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),!1):!0}return!1}KCj(b,h){const r=this.Rc.Lc(7);r.Ab(b);if(12===b.type){h=h.Ib.cp;var A=Cd.ParagraphReader.textLength(b);A=xc.a.XT(h,h+1,h+1===A?!0:!1,b);this.Rd.We(A,"");b=xc.a.Uc(b,h);this.ib.Kc(qc.SelectionFactory.Uo(b))}else this.Vh.pDa(b);r.dispose()}static get tj(){return null!=$o.tWg?$o.tWg:$o.tWg=Wa.a.instance.resolve("Box4.IFormattingEditor")}static get tg(){return Be.a.instance}static get Ac(){return ih.a.instance}}
Object(u.a)($o,"ImageEditor",null,[443]);class zq{constructor(b,h,r,A=0){this.node=b;this.blob=h;this.location=r;this.oX=A}}Object(u.a)(zq,"InsertPictureResult",null,[]);var Yk=d(845),Kp=d(286),cv=d(572),dn=d(111),Pt=d(525),kp;(function(b){b[b.other=0]="other";b[b.Zsj=1]="picture"})(kp||(kp={}));Object(u.b)("ImageType",kp);var sj=d(1151);class dv extends $o{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){var Hc,hd;super(b,h,r,A,L,Z,oa,Ba);this.ysk="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");
this.nhb="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");this.uM=this.aRa=this.AFa=null;this.Eoa=Array(8);this.dDd=this.YFa=null;this.bRa=!1;this.cDd=this.MUe=null;this.Kyd=this.Uzd=!1;this.eW=this.dW=this.cW=this.fW=this.VY=this.UY=this.TY=this.WY=this.pZ=this.qZ=0;this.vP=()=>{this.bRa&&
this.uzf()};this.tCa=Gd=>{this.bRa&&Gd.Lb.keyCode!==jf.a.Pu&&this.uzf(!0);return!1};this.Tlh=jc;Z.AB(this.vP);this.oe=Tb;this.o5=ph.a.instance;this.ga=y.AFrameworkApplication.va;this.Zd=Ab;this.kq=gb;this.fWf=null!==(hd=null===(Hc=y.AFrameworkApplication.J)||void 0===Hc?void 0:Hc.getBooleanFeatureGate("Microsoft.Office.WordOnline.AppendSpacersToDataUrlForSafari",!1))&&void 0!==hd?hd:!1}cxe(b,h,r,A,L){b.hasProperty(Od.a.JXa)&&b.removeProperty(Od.a.JXa);const Z=Array(4);Z[dn.a.left]=h;Z[dn.a.right]=
r;Z[dn.a.top]=A;Z[dn.a.bottom]=L;b.setValue(Vc.a.Jga,Z)}Bzo(b){b.setValue(Vc.a.JKa,Pt.a.tbg);b.setValue(Vc.a.yXb,"");this.cxe(b,0,0,0,0)}kyg(b,h,r,A,L){b.setValue(Vc.a.zae,h);b.setValue(Vc.a.wae,r);b.setValue(Vc.a.xae,A);b.setValue(Vc.a.yae,L)}exe(b,h,r,A){b.setValue(Vc.a.pX,h);b.setValue(Vc.a.mRf,r);b.setValue(Vc.a.JRf,A);b.setValue(Od.a.pX,-1)}Cbe(b,h){b=b.node;const r=hb.a.eb(b);if(Cd.ParagraphReader.Wb(b)&&Cd.ParagraphReader.isEmpty(r)){var A=b.properties.zf(Vc.a.ed);h.setValue(Vc.a.ed,A);h.setValue(Vc.a.runId,
1);A=new sj.a;h&&A.zt(h);r.Wf(A,6);this.qxg(b,A.anchor.node.id);this.ZZ.Jwc(A);return new zq(A,null,3)}return null}Ebe(b,h){var r=Yk.a.instance.gvd;h&&r.zt(h);r.setValue(Vc.a.imageType,kp.Zsj);let A=0;A=Sf.a.wD();r.setValue(Vc.a.oX,A);const L=b.node.Hc.hu(r,r.id);r=this.Rd.Lla(b,Z=>new yl.a(Z,L));Kp.a.instance.Xdg(b.node);if(this.Zd.Bg){const Z=new Sb.GraphTransaction(15);Z.Ab(b.node);this.kq.vna(b.node,b.cpBegin,b.cpBegin+1,1,null);Z.dispose()}this.ZZ.ETa&&!h.ka(Vc.a.Zla,!1)&&this.ZZ.ava(b.node,
b.cpBegin,b.cpBegin+1);return new zq(b.node,r,0,A)}XUf(b,h){if(!this.fka(b))return!1;const r=this.Rc.Lc(7);r.Ab(b.node);y.AFrameworkApplication.J.$("ContentAppIsEnabled")&&h.ka(Vc.a.AUi,!1)?this.V7c=this.Cbe(b,h):this.V7c=this.Ebe(b,h);r.dispose();return!0}bvc(b,h,r,A){if(!r.Wb(b))return!1;r=this.Rc.Lc(7,vb.a.TTm);r.Ab(b);var L=b.properties.ka(Ke.a.An,[]);L.push(0);for(const Z of L)if((L=A.jGf(b,Z))&&5===L.Sh&&L.id.equals(h))return this.Rd.We(xc.a.createTextRange(b,Z,Z+1),""),r.dispose(),!0;r.dispose();
v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}Ryo(b,h,r,A){if(!Id.a.cba(b))return!1;h.set(b);h.zb(12);const L=h.Dp(12);if(!L)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.d$c(L))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;A(b);r=this.Rc.Lc(7);r.Ab(b);
h.Tg();r.dispose();return!0}KEo(b,h,r,A){return Id.a.y$a(b)?this.xEo(b,r):Id.a.A7(b)?this.OEo(b,h,r,A):null}OEo(b,h,r,A){const L=Yk.a.instance.gvd;r&&L.zt(r);r=0;r=Sf.a.wD();L.setValue(Vc.a.oX,r);r=b.node.Hc;b=b.node;A=A.U1c(b,5);for(const Z of A)if(Z.id.equals(h)){this.Rd.We(xc.a.createTextRange(b,Z.Ib.cp,Z.Ib.cp+1),"");const oa=r.hu(L,L.id);h=xc.a.Uc(b,Z.Ib.cp);this.Rd.Lla(h,Ba=>new yl.a(Ba,oa));return L}return null}xEo(b,h){if(!Id.a.y$a(b))return null;h.setValue(Vc.a.oX,Sf.a.wD());b=b.node;var r=
b.anchor.node.id;b=hb.a.eb(b);b.zb(12);const A=b.parentNode;let L;A.properties.hasProperty(Vc.a.i6)?(L=A.properties.zf(Vc.a.i6),r=Q.a.indexOf(L,r),-1!==r&&Array.removeAt(L,r)):L=[];A.properties.setValue(Vc.a.i6,Array.clone(L));b.Tg();r=Object(vj.c)()?new yo.a:new Vh.a;r.zt(h);b.Wf(r,6);this.qxg(A,r.anchor.node.id);return r}Brd(b,h){this.bRa?this.uzf():this.ndp(b,h)}XVo(b,h){b.setValue(Od.a.pX,h)}fwm(b){let h=null,r=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),
{returnValue:null,view:h,Tj:r};if(!Object(Kb.a)().Gd)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Tj:r};const A=b.node;if(!A)return v.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,Tj:r};r=A.Hc;var L=Object(Kb.a)().Gd.Ic;L=A.fg(L);if(!L)return v.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),
{returnValue:null,view:h,Tj:r};h=L.Kh;if(b.Al&&Id.a.A7(b)){b=Id.a.eKa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Tj:r};b=b.BAa(h,L);if(!b)return v.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Tj:r};b=b.element}else if(Id.a.Eq(A))b=L.htmlElement;else return v.ULS.sendTraceTag(22381059,
322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Tj:r};return{returnValue:b,view:h,Tj:r}}k1o(b){for(let A=0;A<this.Eoa.length;A++){this.Eoa[A]=b.vl(po.a.span);this.Eoa[A].className="WACImageCropHandles "+this.ysk[A];if(2>=A){var h=b.vl(po.a.span);h.className=this.nhb[0];var r=b.vl(po.a.span);r.className=this.nhb[1];this.Eoa[A].appendChild(h);this.Eoa[A].appendChild(r)}else 4<A&&(h=b.vl(po.a.span),h.className=this.nhb[2],
r=b.vl(po.a.span),r.className=this.nhb[3],this.Eoa[A].appendChild(h),this.Eoa[A].appendChild(r));if(!A||3===A||5===A)h=b.vl(po.a.span),h.className=this.nhb[4],r=b.vl(po.a.span),r.className=this.nhb[5],this.Eoa[A].appendChild(h),this.Eoa[A].appendChild(r);else if(2===A||4===A||7===A)h=b.vl(po.a.span),h.className=this.nhb[6],r=b.vl(po.a.span),r.className=this.nhb[7],this.Eoa[A].appendChild(h),this.Eoa[A].appendChild(r)}}ndp(b,h){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.bRa)v.ULS.sendTraceTag(22381061,
322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,A=null;if((this.YFa=({view:r,Tj:A}=this.fwm(h)).returnValue)&&r){this.YFa.classList.add("ImageCropMode");this.AFa=r.vl(po.a.div);this.AFa.className="WACImageCropMode";this.aRa=r.vl(po.a.lsb);this.aRa.className="WACImageCropBase";this.uM=r.vl(po.a.span);this.uM.className="WACImageCropSrcRect";this.k1o(r);this.AFa.appendChild(this.uM);for(r=0;r<this.Eoa.length;r++)this.uM.appendChild(this.Eoa[r]);this.AFa.appendChild(this.aRa);
this.aRa.style.visibility="";this.aRa.style.display="";this.YFa.appendChild(this.AFa);this.Beo(b);A=Id.a.lKa(b,A);r=Id.a.a9(b,Od.a.e8,null);this.aRa.src=r?this.fWf&&aa.a.mta?Object(cv.a)(r):r:Id.a.a9a(A);this.Tlh&&this.Tlh.execute(L=>{this.dDd||(this.dDd=L.bwm(this))});this.Uzd||(this.o5.jS(this.YFa,this.dDd),this.Uzd=!0);this.oe&&this.oe.ub(od.a.WK,Object(Kb.a)().Ie.editingElement,this.tCa);this.bRa=!0;this.MUe=b;this.cDd=h;this.Kyd=!1;b=new Sb.GraphTransaction(4);b.Ab(this.cDd.node);this.MUe.setValue(Od.a.zBa,
this.bRa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}Beo(b){const h=nh.a.xf(Id.a.XB(b),0),r=nh.a.xf(Id.a.fD(b),1);var A=Id.a.lfa(b);const L=Math.max(A.top,0),Z=Math.max(A.bottom,0),oa=Math.max(A.left,0);A=Math.max(A.right,0);this.qZ=1E5*h/(1E5-(oa+A));this.pZ=1E5*r/(1E5-(L+Z));this.WY=Math.floor(L*this.pZ/1E5);this.TY=Math.floor(Z*this.pZ/1E5);this.UY=Math.floor(oa*this.qZ/1E5);this.VY=Math.floor(A*
this.qZ/1E5);this.uM.style.top=this.WY+"px";this.uM.style.bottom=this.TY+"px";this.uM.style.left=this.UY+"px";this.uM.style.right=this.VY+"px";this.aRa.style.width=this.qZ+"px";this.aRa.style.height=this.pZ+"px";Id.a.Vz(b)&&(this.AFa.style.width=this.qZ+"px",this.AFa.style.height=this.pZ+"px");this.fW=this.WY;this.cW=this.TY;this.dW=this.UY;this.eW=this.VY}uzf(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.bRa?(b||this.kxl(),this.aRa?Je.a.sF(this.aRa):v.ULS.sendTraceTag(23961793,
322,15,"Unable to clear imageCropBase dom element because it was already null."),this.YFa?(this.AFa?this.AFa.parentNode===this.YFa?this.YFa.removeChild(this.AFa):v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.YFa.classList.remove("ImageCropMode"),this.bRa=!1,b=new Sb.GraphTransaction(4),b.Ab(this.cDd.node),
this.MUe.setValue(Od.a.zBa,this.bRa),b.dispose(),this.Uzd&&(this.o5.AS(this.YFa,this.dDd),this.Uzd=!1),this.oe&&this.oe.xc(od.a.WK,Object(Kb.a)().Ie.editingElement,this.tCa),this.YFa=this.AFa=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}D7j(b,h,r,A,L,Z,oa){if(r){r=Math.max(this.WY-h,0);const Ba=Math.floor(this.pZ)-
this.TY-r;5<=Ba?(this.fW=r,this.cW=this.TY):5>Ba&&0<=Ba||0>Ba&&!this.TY?(this.fW=r-(5-Ba),this.cW=this.TY):0>Ba&&5>=Math.abs(Ba)?(this.fW=Math.floor(this.pZ)-this.TY,this.cW=Math.max(this.TY-(r-(this.pZ-this.TY))-(5-Math.abs(Ba)),0)):(this.fW=Math.floor(this.pZ)-this.TY,this.cW=Math.max(this.TY-(r-(this.pZ-this.TY)),0));this.uM.style.top=this.fW+"px";this.uM.style.bottom=this.cW+"px";oa&&(this.WY=this.fW,this.TY=this.cW)}A&&(h=Math.max(this.TY-h,0),A=Math.floor(this.pZ)-this.WY-h,5<=A?(this.cW=h,
this.fW=this.WY):5>A&&0<=A||0>A&&!this.WY?(this.cW=h-(5-A),this.fW=this.WY):0>A&&5>=Math.abs(A)?(this.cW=Math.floor(this.pZ)-this.WY,this.fW=Math.max(this.WY-(h-(this.pZ-this.WY))-(5-Math.abs(A)),0)):(this.cW=Math.floor(this.pZ)-this.WY,this.fW=Math.max(this.WY-(h-(this.pZ-this.WY)),0)),this.uM.style.top=this.fW+"px",this.uM.style.bottom=this.cW+"px",oa&&(this.WY=this.fW,this.TY=this.cW));L&&(L=Math.max(this.UY-b,0),h=Math.floor(this.qZ)-this.VY-L,5<=h?(this.dW=L,this.eW=this.VY):5>h&&0<=h||0>h&&
!this.VY?(this.dW=L-(5-h),this.eW=this.VY):0>h&&5>=Math.abs(h)?(this.dW=Math.floor(this.qZ)-this.VY,this.eW=Math.max(this.VY-(L-(this.qZ-this.VY))-(5-Math.abs(h)),0)):(this.dW=Math.floor(this.qZ)-this.VY,this.eW=Math.max(this.VY-(L-(this.qZ-this.VY)),0)),this.uM.style.left=this.dW+"px",this.uM.style.right=this.eW+"px",oa&&(this.UY=this.dW,this.VY=this.eW));Z&&(b=Math.max(this.VY-b,0),Z=Math.floor(this.qZ)-this.UY-b,5<=Z?(this.eW=b,this.dW=this.UY):5>Z&&0<=Z||0>Z&&!this.UY?(this.eW=b-(5-Z),this.dW=
this.UY):0>Z&&5>=Math.abs(Z)?(this.eW=Math.floor(this.qZ)-this.UY,this.dW=Math.max(this.UY-(b-(this.qZ-this.UY))-(5-Math.abs(Z)),0)):(this.eW=Math.floor(this.qZ)-this.UY,this.dW=Math.max(this.UY-(b-(this.qZ-this.UY)),0)),this.uM.style.left=this.dW+"px",this.uM.style.right=this.eW+"px",oa&&(this.UY=this.dW,this.VY=this.eW));oa&&(this.Kyd=!0,ab.StaticActiveAppFrame.za().Ge())}uml(){this.fW=this.WY;this.cW=this.TY;this.dW=this.UY;this.eW=this.VY;this.uM.style.top=this.fW+"px";this.uM.style.bottom=this.cW+
"px";this.uM.style.left=this.dW+"px";this.uM.style.right=this.eW+"px"}kxl(){if(this.Kyd){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.WY/this.pZ),h=Math.floor(1E5*this.TY/this.pZ),r=Math.floor(1E5*this.UY/this.qZ),A=Math.floor(1E5*this.VY/this.qZ),L=new lj.DictionaryPropertySet;L.setValue(Od.a.ksb,b);L.setValue(Od.a.hsb,h);L.setValue(Od.a.isb,r);L.setValue(Od.a.jsb,A);this.ga.Hf(this.cDd,Ec.a.CPi,2,!1,null,L)}else v.ULS.sendTraceTag(23070481,
322,50,"No New Cropping Properties To Commit.")}zBa(){return this.bRa}Nom(){return{top:this.fW,bottom:this.cW,left:this.dW,right:this.eW}}nyp(b,h){if(0>b)v.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.WY=this.fW=Math.min(Math.floor(this.pZ)-this.cW-5,b);this.uM.style.top=this.fW+"px";break;case 1:this.TY=this.cW=Math.min(Math.floor(this.pZ)-this.fW-5,b);this.uM.style.bottom=this.cW+"px";break;case 2:this.UY=this.dW=Math.min(Math.floor(this.qZ)-
this.eW-5,b);this.uM.style.left=this.dW+"px";break;case 3:this.VY=this.eW=Math.min(Math.floor(this.qZ)-this.dW-5,b),this.uM.style.right=this.eW+"px"}this.Kyd=!0}}}Object(u.a)(dv,"ImageEditor",$o,[442,443]);class Ds{constructor(){this.Z=null}get name(){return"WordEditor.ImageEditors"}wc(b){this.Z=b;this.Z.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new lh(y.AFrameworkApplication.va,Wa.a.instance.Ta("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();this.Z.ia("WordEditor.ImageEditors.ImageEditor",
()=>new dv(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Ta("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
Cb.KeyInputManager.instance,b.Ta("WordEditor.IImageCropDragAdapterFactory"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.Z.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){E.a.instance.Mc(new Ds)}}Object(u.a)(Ds,"WordEditorImageEditorsPackage",null,[0,1]);class ls{}Object(u.a)(ls,"FolderContentEditor",null,[1417]);class Es{}Object(u.a)(Es,"PageEditor",null,[1564]);class Zw extends Es{constructor(){super()}}Object(u.a)(Zw,"PageEditor",Es,
[]);class tw{get name(){return"WordEditor.NotebookLevelEditors"}wc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new ls).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new Zw).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){E.a.instance.Mc(new tw)}}Object(u.a)(tw,"WordEditorNotebookLevelEditorsPackage",null,[0,1]);class Ys{get WXb(){return y.AFrameworkApplication.privacyUrl}Wya(){v.ULS.sendTraceTag(37034014,342,50,
"User clicked on the Privacy statement.");rd.a.Tm(this.WXb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(u.a)(Ys,"PrivacyLinkHandler",null,[100]);class Zs{constructor(b,h){this.q1e=null;this.CMk=b;this.BMk=h}showDialog(b){this.q1e=b;this.BMk.create().Uh(Object(D.a)(this,this.vVm,"handleDialog"))}vVm(b){1===b&&this.CMk.JLj();this.q1e();this.q1e.prototype}}Object(u.a)(Zs,"SendUsYourFileController",null,[78]);class il extends Ag.StandardDialog{constructor(b,h,r){super();this.V9b=
null;this.$g=b;this.MNc=h;this.oJ=r}Uh(b){this.Bd=1;this.Ke(1,this.oJ.send);this.Ke(0,this.oJ.kSn);v.ULS.shipAssertTag(37034013,342,!this.V9b,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.bvb(this.oJ.W6k,null,"CancelRequest_32x32x32",null,b,h);this.x8(this.Bj(il.RLj))}dialogContent(){const b=document.createElement("span");b.innerText=this.oJ.Fho;const h=document.createElement("span");h.innerText=this.oJ.Mjp;h.style.fontWeight=this.oJ.JDp;const r=document.createElement("span");
r.innerText=this.oJ.eRo;const A=this.pzl(),L=document.createElement("span");L.id=this.Bj(il.RLj);L.appendChild(b);L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(h);L.appendChild(document.createElement("br"));L.appendChild(r);L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(A);return L}pzl(){const b=document.createElement("span"),h=document.createElement("a");
h.innerText=this.oJ.nho;h.href=this.MNc.WXb||"";b.appendChild(h);this.V9b=h;this.$g.ub(od.a.click,this.V9b,Object(D.a)(this.MNc,this.MNc.Wya,"clickHandler"));return b}dispose(){this.V9b&&(this.$g.xc(od.a.click,this.V9b,Object(D.a)(this.MNc,this.MNc.Wya,"clickHandler")),this.V9b=null);super.dispose()}}il.RLj="sendUsYourFileId";Object(u.a)(il,"SendUsYourFileDialog",Ag.StandardDialog,[99]);class Fs{create(){return Wa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(u.a)(Fs,
"Factory",null,[98]);var Aq=d(521);class mn extends Aq.a{constructor(){super();this.FileId=null}Om(){return 38}static construct(b){const h=new mn;h.FileId=b;return h}}Object(u.a)(mn,"CreateSendUsYourFileRequest",Aq.a,[]);var og=d(1079);class hr{constructor(b,h,r){this.HS=b;this.ZS=h;this.hEk=r}JLj(b=!1){if(this.ZS){const h=mn.construct(this.ZS()),r=new og.a;r.kr=h;r.status=1;r.bG="BootErrorReport";b=b?this.HS(null):this.HS(A=>{this.Dld(r,A)});b.MG(r);b.i_();this.hEk()}}Dld(b){5===b.statusCode&&this.JLj(!0)}}
Object(u.a)(hr,"SendUsYourFileManager",null,[77]);class jl{constructor(b,h){this.Z=null;this.oJ=b;this.ZS=h}wc(b){this.Z=b;this.Z.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.oJ).ha();this.Z.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new il(jg.a.instance,new Ys,this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.Z.ia("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new hr(h=>this.Jaa(0,h),this.ZS,()=>{v.ULS.sendTraceTag(42022664,
342,50,"send us your file request is now sent.")}));this.Z.ia("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new Fs;return new Zs(this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(u.a)(jl,"SendUsYourFilePackageManager",null,[]);var Sq=d(576),Dz=d(1030);class Pi{get W6k(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get kSn(){return CommonUIStrings.l_NoThanks}get Fho(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get Mjp(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get JDp(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get eRo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get nho(){return CommonUIStrings.l_PrivacyStatement}}
Object(u.a)(Pi,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class dm extends jl{constructor(){super(new Pi,()=>y.AFrameworkApplication.rootQuerySignature)}Jaa(b,h){return new Dz.a(b,h,"SendUsYourFile.ashx",hp.a.word,ed.a.webServiceBase,Sq.a.yq,Sq.a.Fld,Sq.a.old)}get name(){return"WordEditor.SendUsYourFile"}static main(){E.a.instance.Mc(new dm)}}Object(u.a)(dm,"PackageManager",jl,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Xi=d(559),Oo=d(647),ms=d(1896),nn=d(120),$g=d(23),zo=d(160),Ql=d(78),Bq=d(1044),Mi=d(171);class ok{constructor(){this.color=0;this.weight=Mi.a.ikf;this.style=Mi.a.mLb}}Object(u.a)(ok,"BorderPropertyValue",null,[]);class en{constructor(b,h,r,A,L,Z){this.g4d=b;this.gallerySectionId=h;this.tBf=r;this.Egf=A;this.commandId=L;this.queryCommandId=Z}}Object(u.a)(en,"BorderStyleMenuPropsArguments",null,[]);class Lp{constructor(b,h,r,A,L,Z,oa){this.W5a=b;this.oqd=h;this.width=r;this.oed=A;this.height=L;
this.sbd=Z;this.altText=oa}}Object(u.a)(Lp,"TableBorderStyleProperties",null,[]);class Fg{constructor(){this.pTd=[new Lp(Fg.H0b,"","2",1,8,0,"Solid Line"),new Lp(Fg.vNb,"5,3","1",1,8,0,"Dashed Line"),new Lp(Fg.WNb,"1,1","1",1,8,0,"Dotted Line"),new Lp(Fg.YNb,"","1",2,8,3,"Double Line")];this.qTd=[new Lp(Fg.fLb,"","1",1,8,0,"0.25pt"),new Lp(Fg.dLb,"","1",1,8,0,"0.5pt"),new Lp(Fg.iLb,"","2",1,8,0,"0.75pt"),new Lp(Fg.eLb,"","2",1,8,0,"1pt"),new Lp(Fg.cLb,"","3",1,8,0,"1.5pt"),new Lp(Fg.jLb,"","4",1,
8,0,"2.25pt"),new Lp(Fg.hLb,"","4",1,8,0,"3pt"),new Lp(Fg.bLb,"","5",1,8,0,"4.5pt"),new Lp(Fg.gLb,"","6",1,8,0,"6pt")]}initialize(){this.Wjd()}dFf(){const b=new en("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.pTd,vb.a.Zdb,vb.a.Yng);return this.Uic(b)}eFf(){const b=new en("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.qTd,vb.a.$db,vb.a.Zng);return this.Uic(b)}Kti(b){switch(b){case Fg.H0b:return Mi.a.mLb;case Fg.vNb:return Mi.a.Kmb;
case Fg.WNb:return Mi.a.$Tc;case Fg.YNb:return Mi.a.q6;default:return Mi.a.Nya}}Lti(b){switch(b){case Fg.fLb:return Mi.a.YTc;case Fg.dLb:return Mi.a.ikf;case Fg.iLb:return Mi.a.U5a;case Fg.eLb:return Mi.a.Mya;case Fg.cLb:return Mi.a.U$;case Fg.jLb:return Mi.a.bka;case Fg.hLb:return Mi.a.p6;case Fg.bLb:return Mi.a.Lya;case Fg.gLb:return Mi.a.aka;default:return Mi.a.XH}}Uic(b){const h=new Ee.a,r=new hh.a,A=Object.assign(new Oo.a,{Id:b.g4d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.tBf,Type:4,
Width:1,GalleryItems:[]});for(const Z of b.Egf){var L={};const oa={};oa.width=Fg.BAn;oa.height=Fg.AAn;L.root=oa;L=Object.assign(new ms.a,{Id:Z.W5a,ExternalId:String.format("{0}_GalleryButton",Z.W5a),Icon:Z.W5a,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:Z.W5a,FullIconStyle:L,ShouldSetTitle:"true",Alt:Z.altText});A.GalleryItems.push(L)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(A);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}Wjd(){const b=
{};for(const h of this.pTd)b[h.W5a]=appChrome.buildBorderStyleIcon(h.oqd,h.width,h.oed,h.height,h.sbd);for(const h of this.qTd)b[h.W5a]=appChrome.buildBorderStyleIcon(h.oqd,h.width,h.oed,h.height,h.sbd);appChrome.api.registerIconProvider(()=>b)}KSo(b,h,r){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==kc.a.s4)return v.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),
!1;switch(b.border){case 2:this.h4(nn.a.eX(b),b.node,5,r,h);break;case 0:this.h4(nn.a.eX(b),b.node,3,r,h);break;case 1:this.h4(nn.a.eX(b),b.node,4,r,h);break;case 3:this.h4(nn.a.eX(b),b.node,0,r,h);break;case 7:this.h4(nn.a.eX(b),b.node,1,r,h);break;case 8:this.h4(nn.a.eX(b),b.node,2,r,h);break;case 6:this.h4(nn.a.eX(b),b.node,1,r,h);this.h4(nn.a.eX(b),b.node,2,r,h);break;case 5:this.h4(nn.a.eX(b),b.node,3,r,h);this.h4(nn.a.eX(b),b.node,5,r,h);this.h4(nn.a.eX(b),b.node,4,r,h);this.h4(nn.a.eX(b),b.node,
0,r,h);break;case 4:this.h4(nn.a.eX(b),b.node,3,r,h),this.h4(nn.a.eX(b),b.node,5,r,h),this.h4(nn.a.eX(b),b.node,4,r,h),this.h4(nn.a.eX(b),b.node,0,r,h),this.h4(nn.a.eX(b),b.node,1,r,h),this.h4(nn.a.eX(b),b.node,2,r,h)}return!0}zxg(b,h,r,A){if(!h)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==kc.a.I0)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var L=h.node;
const Z=new hb.a;Z.set(L);Z.zb(14);L=$g.TableCellReader.iVa(Z);switch(h.border){case 2:this.c_a(b,h.node,5,A,r,L);this.uxe(h.node,5,r);this.vwe(b,h.A8a(),3,r,A,L);break;case 0:this.c_a(b,h.node,3,A,r,L);this.uxe(h.node,3,r);this.vwe(b,h.A8a(),1,r,A,L);break;case 1:this.c_a(b,h.node,4,A,r,L);this.uxe(h.node,4,r);this.vwe(b,h.A8a(),0,r,A,L);break;case 3:this.c_a(b,h.node,0,A,r,L),this.uxe(h.node,0,r),this.vwe(b,h.A8a(),2,r,A,L)}return!0}xmo(b,h){if(he.a.X$c(b)&&h)switch(b=Object(Ca.a)(zo.TableNodeBorderContext,
b),b.border){case 2:this.DR(b.node,Fg.Kp.$O(5),h);break;case 0:this.DR(b.node,Fg.Kp.$O(3),h);break;case 3:this.DR(b.node,Fg.Kp.$O(0),h);break;case 1:this.DR(b.node,Fg.Kp.$O(4),h);break;case 7:this.DR(b.node,Fg.Kp.$O(1),h);break;case 8:this.DR(b.node,Fg.Kp.$O(2),h);break;case 5:h=this.DR(b.node,Fg.Kp.$O(5),h);h=this.DR(b.node,Fg.Kp.$O(3),h);h=this.DR(b.node,Fg.Kp.$O(0),h);this.DR(b.node,Fg.Kp.$O(4),h);break;case 6:h=this.DR(b.node,Fg.Kp.$O(1),h);this.DR(b.node,Fg.Kp.$O(2),h);break;case 4:h=this.DR(b.node,
Fg.Kp.$O(5),h),h=this.DR(b.node,Fg.Kp.$O(3),h),h=this.DR(b.node,Fg.Kp.$O(0),h),h=this.DR(b.node,Fg.Kp.$O(4),h),h=this.DR(b.node,Fg.Kp.$O(1),h),this.DR(b.node,Fg.Kp.$O(2),h)}}Vko(b,h){if(he.a.Y$c(b)&&h)switch(b=Object(Ca.a)(zo.TableNodeBorderContext,b),b.border){case 2:this.DR(b.node,Fg.Kp.zR(5),h);break;case 0:this.DR(b.node,Fg.Kp.zR(3),h);break;case 3:this.DR(b.node,Fg.Kp.zR(0),h);break;case 1:this.DR(b.node,Fg.Kp.zR(4),h)}}X1c(b,h,r){r=null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),
r;b.properties.hasProperty(h.size)&&(r=new ok,r.weight=b.properties.ka(h.size,Mi.a.XH),r.style=b.properties.ka(h.style,Mi.a.Nya),r.color=b.properties.ka(h.color,0));return r}yxg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}gZb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),
b.properties.removeProperty(h.color)):v.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}h4(b,h,r,A,L){L=this.oBp(b,h,r,A,L);this.Ewc(h,Fg.Kp.$O(r),L);switch(r){case 5:this.gxb(h,2,A,L);break;case 4:this.gxb(h,1,A,L);break;case 0:this.gxb(h,3,A,L);break;case 3:this.gxb(h,0,A,L);break;case 1:this.gxb(h,7,A,L);break;case 2:this.gxb(h,8,A,L)}}oBp(b,h,r,A,L){if(3!==A){var Z=Fg.Xg.H5d(b,h,r,3);void 0!==Z&&null!==Z&&Z!==Mi.a.e2&&(Z=Ql.a.Nvc(Z),L.color=Fg.Fva.lka(h,Z))}1!==A&&(Z=Fg.Xg.H5d(b,
h,r,1),void 0!==Z&&null!==Z&&Z!==Mi.a.WH&&(L.weight=parseFloat(Z)*Mi.a.ZTc));2!==A&&(b=Fg.Xg.H5d(b,h,r,2),void 0!==b&&null!==b&&b!==Mi.a.WH&&(L.style=b));return L}c_a(b,h,r,A,L,Z){A&&(L=this.Xvp(b,h,Z,r,A,L));this.Ewc(h,Fg.Kp.zR(r),L)}Xvp(b,h,r,A,L,Z){if(3!==L){var oa="",Ba=Fg.Xg.RPb(b,h,A,!1,!0,r,3);Ba&&(oa=Ba.lLb);void 0!==oa&&null!==oa&&oa!==Mi.a.e2&&(oa=Ql.a.Nvc(oa),Z.color=Fg.Fva.lka(h,oa))}if(1!==L){oa="";if(Ba=Fg.Xg.RPb(b,h,A,!1,!0,r,1))oa=Ba.lLb;void 0!==oa&&null!==oa&&oa!==Mi.a.WH&&(Z.weight=
parseFloat(oa)*Mi.a.ZTc)}if(2!==L){L="";if(b=Fg.Xg.RPb(b,h,A,!1,!0,r,2))L=b.lLb;void 0!==L&&null!==L&&L!==Mi.a.WH&&(Z.style=L)}return Z}ZOn(b){let h=0,r=0;({zOn:h,bMn:r}=this.pAm(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}pAm(b,h,r){switch(b){case Mi.a.mLb:case Mi.a.Kmb:case Mi.a.$Tc:h=2;r=48;break;case Mi.a.q6:h=2;r=24;break;default:h=2,r=48}return{zOn:h,bMn:r}}vwe(b,h,r,A,L,Z){if(h)if(A)for(let oa=0;oa<h.length;oa++)switch(r){case 2:this.c_a(b,h[oa],5,L,A,Z);break;
case 0:this.c_a(b,h[oa],3,L,A,Z);break;case 1:this.c_a(b,h[oa],4,L,A,Z);break;case 3:this.c_a(b,h[oa],0,L,A,Z)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}uxe(b,h,r){const A=new hb.a;A.set(b);A.zb(14);const L=$g.TableCellReader.qfa(b);b=$g.TableCellReader.QJ(b);Kh.forEachCell(A,L,b,(Z,oa,Ba)=>{Z=Z.currentNode;$g.TableCellReader.gr(Z)&&0==Ba&&0<oa&&this.Ewc(Z,Fg.Kp.zR(h),r)})}Ewc(b,
h,r){b?(r=this.ZOn(r),b.properties.setValue(h.color,r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}gxb(b,h,r,A){if(b){var L=si.TableReader.vg(b),Z=si.TableReader.Eh(b),oa=new hb.a,Ba=[];for(let gb=0;gb<L;gb++)for(let Ab=0;Ab<Z;Ab++)if(oa.set(b),Kh.moveToCell(oa,gb,Ab),oa&&oa.currentNode&&!$g.TableCellReader.Ng(oa))switch(h){case 2:$g.TableCellReader.Wla(oa)&&Ba.push(zo.TableNodeBorderContext.maa(oa.currentNode,
2));break;case 0:$g.TableCellReader.Xla(oa)&&Ba.push(zo.TableNodeBorderContext.maa(oa.currentNode,0));break;case 3:$g.TableCellReader.SYf(b,oa.currentNode)&&Ba.push(zo.TableNodeBorderContext.maa(oa.currentNode,3));break;case 1:$g.TableCellReader.TYf(b,oa.currentNode)&&Ba.push(zo.TableNodeBorderContext.maa(oa.currentNode,1));break;case 7:$g.TableCellReader.TYf(b,oa.currentNode)||Ba.push(zo.TableNodeBorderContext.maa(oa.currentNode,1));break;case 8:$g.TableCellReader.SYf(b,oa.currentNode)||Ba.push(zo.TableNodeBorderContext.maa(oa.currentNode,
3))}for(b=0;b<Ba.length;b++)switch(h=Ba[b],h.border){case 2:this.okd(h.node,Fg.Kp.zR(5),r,A);this.rte(h.A8a(),Fg.Kp.zR(0),r,A);break;case 0:this.okd(h.node,Fg.Kp.zR(3),r,A);this.rte(h.A8a(),Fg.Kp.zR(4),r,A);break;case 1:this.okd(h.node,Fg.Kp.zR(4),r,A);this.rte(h.A8a(),Fg.Kp.zR(3),r,A);break;case 3:this.okd(h.node,Fg.Kp.zR(0),r,A),this.rte(h.A8a(),Fg.Kp.zR(5),r,A)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}rte(b,h,r,A){if(b)for(let L=0;L<b.length;L++)this.okd(b[L],
h,r,A);else v.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}okd(b,h,r,A){if(b){var L=b.ka(h.color,Fg.uYc),Z=b.ka(h.size,Fg.bgc),oa=b.ka(h.style,Fg.agc),Ba=new ok;Ba.weight=A.weight;Ba.style=A.style;Ba.color=A.color;2!==r||L===Fg.uYc&&Z===Fg.bgc?3!==r||oa===Fg.agc&&Z===Fg.bgc?1!==r||L===Fg.uYc&&oa===Fg.agc?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ba.color=L,Ba.style=oa,this.Ewc(b,h,Ba)):(Ba.style=
oa,Ba.weight=Z,this.Ewc(b,h,Ba)):(Ba.color=L,Ba.weight=Z,this.Ewc(b,h,Ba))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}DR(b,h,r){var A=b.properties.ka(h.style,Mi.a.WH);A!==Mi.a.WH&&(r.lineStyle!==Mi.a.WH?r.lineStyle!==A&&(r.lineStyle=Mi.a.Oel):r.lineStyle=A);A=b.properties.ka(h.size,Mi.a.XH);A!==Mi.a.XH&&(r.lqc!==Mi.a.XH?r.lqc!==A&&(r.lqc=Mi.a.Bel):r.lqc=A);b=b.properties.ka(h.color,0);b=Ql.a.JB(b);b!==Mi.a.e2&&(r.borderColor!==Mi.a.e2?r.borderColor!==b&&(r.borderColor=
Mi.a.sel):r.borderColor=b);return r}static get Kp(){return null!=Fg.iSg?Fg.iSg:Fg.iSg=Mi.a.instance}static get Xg(){return null!=Fg.A7g?Fg.A7g:Fg.A7g=Wa.a.instance.Oa("WordEditor.IWACTableStyleReader")}static get Fva(){return null!=Fg.o5g?Fg.o5g:Fg.o5g=Bq.a.instance}}Fg.BAn="110px";Fg.AAn="20px";Fg.H0b="SolidLineStyle";Fg.vNb="DashedLineStyle";Fg.WNb="DottedLineStyle";Fg.YNb="DoubleLineStyle";Fg.fLb="BorderPointSizeOneQuarter";Fg.dLb="BorderPointSizeOneHalf";Fg.iLb="BorderPointSizeThreeQuarters";
Fg.eLb="BorderPointSizeOne";Fg.cLb="BorderPointSizeOneAndHalf";Fg.jLb="BorderPointSizeTwoAndQuarter";Fg.hLb="BorderPointSizeThree";Fg.bLb="BorderPointSizeFourAndHalf";Fg.gLb="BorderPointSizeSix";Fg.agc="single";Fg.bgc=4;Fg.uYc=0;Object(u.a)(Fg,"TableBorderManager",null,[479]);var tn=d(1029),Vm=d(53),Ju=d(209);class OA{constructor(b,h){this.aBh=this.Wvh=null;this.FTa=b;this.jyh=h}get $pj(){return this.jyh}get Wta(){return this.Wvh}get wpg(){return this.aBh}hPj(b,h){this.aBh=b;this.Wvh=h}PXo(b){this.jyh=
b}}Object(u.a)(OA,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var pk=d(57),uw=d(194),Qt=d(371),vr=d(149),Tq=d(230),$e=d(481),ev=d(73),lp=d(496),PA=d(1057);class Wm extends tn.a{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb=null,Tb=null){super(b,h,r,Tb,Jb);this.ahb=PA.a.instance;this.sa=new Bf.a;this.e0h=[Vc.a.Wyc,Vc.a.Nzb,Vc.a.j1b,Vc.a.Uyc,Vc.a.Lzb,Vc.a.h1b,Vc.a.Tyc,Vc.a.Kzb,Vc.a.g1b,Vc.a.Vyc,Vc.a.Mzb,Vc.a.i1b];this.jqk=[Vc.a.ya,Vc.a.xa,Ke.a.si,Ke.a.Cs];this.Pi=A;this.WIb=L;this.fd=Z;this.ib=oa;
this.K9=Ba;this.Wm=gb;this.XHc=Ab;this.lIh=Jb;this.WQk=Tb;this.Njo=this.wmg.bind(this)}get Tj(){return this.Pi.value}get Zt(){return this.K9?this.K9.instance:null}wff(b){this.sa.addHandler("OnParagraphDelete",b)}get Lh(){return!!this.XHc.instance&&this.XHc.instance.Lh}R7c(b,h,r,A,L){h.setValue(Vc.a.ed,Sf.a.wD());h.setValue(Vc.a.hhn,L);$e.c(A,h,[Vc.a.u4]);super.R7c(b,h,r,A,L)}sbe(b,h,r,A,L){const Z=this.s5c(h,r,A,L);this.BXd(Z,h,!1);return super.sbe(b,h,r,A,L)}xQd(b,h,r,A,L){const Z=this.s5c(h,r,A,
L);this.BXd(Z,h,!0);super.xQd(b,h,r,A,L);return Z}prf(b,h,r,A){h=this.s5c(b,h,r,A);this.BXd(h,b,!0);return h}insertRows(b,h,r,A){const L=Vm.a.Ft(b),Z=new hb.a;Z.nd(b);const oa=Z.currentNode;Z.Vb(1);let Ba;Ba=h?b.dP(1):b.currentNode;const gb=b.uc();if(!gb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Ab=si.TableReader.vg(gb),Jb=gb.l2.Xg;let Tb=!1;try{gb.yDa=1;const jc=this.ahb.Aqb(gb,Jb.fH(gb));this.o_a(b.currentNode);this.Mva(b);this.pYk(r,b,Ba,Z,oa,h,A);
const Hc=this.ahb.Aqb(gb,Jb.fH(gb));this.Xdb(gb,si.TableReader.vg(gb)+r);Tb=!0;this.dce(gb,jc,Hc)}finally{gb.yDa=0,Tb||this.Xdb(gb,si.TableReader.vg(gb)+r)}L+1!==Ab||h?!L&&h&&Wm.EVf(gb,r):Wm.EVf(gb,L);h=L+r+(h?0:1);h<Ab+r&&this.WTi(gb,h);return b.currentNode}pYk(b,h,r,A,L,Z,oa){let Ba=null,gb=null;for(var Ab=0;Ab<b;++Ab){var Jb=Ju.a.instance.createInstance(Ln.a.Lna);gb||(gb=Jb);Ba=Jb;this.R7c(h,Jb,r,L,Z)}b=si.TableReader.Eh(h.currentNode);r=!0;do{r?(h.Yj(Ba),r=!1):h.Kf(1);L=Array(b);for(Ab=0;Ab<b;++Ab){Jb=
this.kUa();const Tb=this.prf(Jb,A.currentNode,Z,!0);let jc=null;Tb.Ng||(jc=oa(Tb));L[Ab]=new OA(Jb,jc);L[Ab].hPj(Tb,null);A.Kf(1)}for(Ab=0;Ab<b;++Ab)Jb=L[Ab].FTa,h.d6(Jb,1,tn.a.QQa?tn.a.QQa():null),$g.TableCellReader.gr(Jb)||(this.DKb(h,Jb,L[Ab].$pj),this.e8h(L[Ab].wpg,Jb,!0));A.zla(1)}while(h.currentNode!==gb)}insertColumns(b,h,r,A,L){let Z=b.currentNode,oa=!1,Ba=si.TableReader.Eh(b.currentNode);const gb=Ba;try{this.o_a(b.currentNode);this.Mva(b);const Ab=Z.l2.Xg;Z.yDa=1;const Jb=this.ahb.Aqb(Z,
Ab.fH(Z));Ba=si.TableReader.Eh(b.currentNode);-1===h&&(h=Ba);this.nYk(b,A,r,h,L);Z=b.currentNode;Ba+=A;this.bpg(b,Ba,A,h);oa=!0;const Tb=this.ahb.Aqb(Z,Ab.fH(Z));this.dce(Z,Jb,Tb)}finally{Z.yDa=0,oa||this.bpg(b,Ba,A,h)}h!==gb||r?!h&&r&&Wm.DVf(Z,A):Wm.DVf(Z,h-1)}nYk(b,h,r,A,L){var Z=b.currentNode;A=r?A:A-1;b.Vb(1);var oa=new nb.a;do{var Ba=b.Fo(A,1);b.uc();var gb=Array(h);for(let Jb=0;Jb<h;++Jb){var Ab=this.kUa();const Tb=this.kCm(b,Ba,r),jc=this.prf(Ab,Ba,r,!1);Ab=new OA(Ab,null);Ab.hPj(jc,Tb);gb[Jb]=
Ab}oa.add(gb)}while(b.Ci(1));r=oa.toArray();for(A=0;A<r.length;A++)for(oa=0;oa<h;oa++)Ba=r[A][oa],gb=Ba.wpg,gb.Ng||Ba.PXo(L(gb));b.set(Z);b.Vb(1);L=0;do{for(Z=0;Z<h;++Z)A=r[L][Z],oa=A.FTa,b.mSb(oa,A.Wta,1,tn.a.QQa?tn.a.QQa():null),$g.TableCellReader.gr(oa)||(this.DKb(b,oa,A.$pj),this.e8h(A.wpg,oa,!1));L++}while(b.Ci(1))}dce(b,h,r){if(h){var A=2===b.yDa,L=[],Z=new hb.a;Z.set(b);for(var oa=Z.Vb(1);oa;){for(oa=Z.Vb(1);oa;){const Ba=oa.id.toString();Ba in h&&h[Ba]===r[Ba]&&(!A||!$g.TableCellReader.Xla(Z)&&
!$g.TableCellReader.Wla(Z))||L.push(oa);oa=Z.Ci(1)}oa=Z.Ci(1)}if(0<L.length){h=new Sb.GraphTransaction(3);try{h.set(b.Fk);for(const Ba of L)Ba.GVf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=Vm.a.Ft(b),A=r+h;let L=b.uc();const Z=L.l2.Xg;let oa=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",L.id.toString(),L.type,r,h);const Ba=si.TableReader.vg(L);try{L.yDa=2;const gb=this.ahb.Aqb(L,Z.fH(L));
this.o_a(b.currentNode);this.Mva(b);for(let Jb=A-1;Jb>=r;--Jb){b.Fo(Jb,1);let Tb=b.Vb(1);for(;Tb;)this.Ned(Tb,!0),Tb=b.Ci(1);this.UVa(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.uf);b.Tg()}L=b.currentNode;const Ab=this.ahb.Aqb(L,Z.fH(L));this.Xdb(L,si.TableReader.vg(L)-h);this.Ple(b);oa=!0;this.dce(L,gb,Ab)}finally{L.yDa=0,oa||(this.Xdb(b.currentNode,si.TableReader.vg(b.currentNode)-h),this.Ple(b))}Ba===A&&0<=r-1&&Wm.EVf(L,r-1);
r<Ba-h&&this.WTi(L,r)}deleteColumns(b,h,r){b=Object(Ca.a)(hb.a,b);let A=Object(Ca.a)(lp.a,b.currentNode),L=si.TableReader.Eh(b.currentNode);const Z=A.l2.Xg;let oa=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",A.id.toString(),A.type,h,r);const Ba=L;try{A.yDa=2;const gb=this.ahb.Aqb(A,Z.fH(A));this.o_a(b.currentNode);this.Mva(b);-1===h&&(h=L-r);b.Vb(1);do for(let Jb=h+r-1;Jb>=h;--Jb)b.Fo(Jb,1),
this.Ned(b.currentNode,!1),this.UVa(b),b.Tg();while(b.Ci(1));L-=r;this.apg(b,L,h,r);oa=!0;A=Object(Ca.a)(lp.a,b.currentNode);const Ab=this.ahb.Aqb(A,Z.fH(A));this.dce(A,gb,Ab);this.Ole(b)}finally{A&&(A.yDa=0),oa||(this.apg(b,L,h,r),this.Ole(b))}Ba===h+r&&0<=h-1&&Wm.DVf(A,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var A=new hb.a;A.nd(b);A.zb(14);this.Jsf(A,h,r);this.Evp(A,h,r);A.uc();A.uc();this.xlj(A)}}PWj(b,h,r){if(b&&(1!==h||1!==r)){var A=new hb.a;A.nd(b);A.zb(14);this.CKl(A,h,r);A.uc();A.uc();
this.eoj(A)}}Ned(b,h){v.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.nVm(b,h,this.Njo)}wmg(b,h){const r=b.currentNode;r.Ng=!1;this.BXd(h.currentNode,b.currentNode,!0);r.removeProperty(Vc.a.skippedCell);r.removeProperty(Vc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.pVc();tn.a.jT.Tja(b,!0,tn.a.VCi(h.currentNode));Kh.returnToCell(b);this.xCl(h,b)}EQf(b,h,r){super.EQf(b,h,r);1===h.LO.colSpan&&1===h.LO.rowSpan?h.LO.pVc():!r&&h.hve&&(b.YVa?
1<b.colSpan&&(h=new hb.a,h.set(b),h.zb(15),Kh.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(r=new hb.a,r.set(h.LO),r.zb(15),h=ev.a(r),r=new hb.a,r.set(b),r.zb(15),Kh.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}s5c(b,h,r,A){const L=super.s5c(b,h,r,A);if(b.Ng&&!A){var Z=h.jCa;Z.hve&&(A=tn.a.jjc(Z.LO,A),!Z.TVd&&r||Z.TVd===A-1&&!r?b.colSpan=1:(r=new hb.a,r.set(Z.LO),r.zb(15),Z=ev.a(r),r=new hb.a,r.set(h),r.zb(15),Kh.moveToColumnByIndex(r,Z),r.currentNode.colSpan+=1))}L.ka(Vc.a.skippedCell,
!1)&&(b.Ng=!0,b.G7=!0,b.Syb=!0);return L}Ple(b){this.k2b(b,Vc.a.complexTable)}Ole(b){this.k2b(b,Vc.a.complexTable)}xlj(b){this.k2b(b,Vc.a.complexTable)}eoj(b){this.k2b(b,Vc.a.complexTable)}xCl(b,h){if(b&&h){let r;b=hb.a.eb(b.currentNode);fo.OutlineNavigator.Gba(b)&&(b.Vb(2),b=b.currentNode,12==b.type&&(r=b.zf(Ke.a.si)));r&&(b=new hb.a,b.nd(h),fo.OutlineNavigator.Gba(b)&&b.Vb(2)&&(h=b.currentNode,12==h.type&&h.Wg(Ke.a.si,r)))}}BXd(b,h,r){b&&($e.c(b,h,this.e0h),$e.c(b,h,[Ke.a.QG]),r&&$e.c(b,h,[Vc.a.qS,
Vc.a.oV,Vc.a.kOa,Vc.a.iOa,Vc.a.lOa,Vc.a.skippedCell,Vc.a.renderCell]))}e8h(b,h,r){b&&(b=hb.a.eb(b),b.Nd(),b.je(),h=hb.a.eb(h),h.Nd(),h.je(),Eb.a.Mh(b)&&fg.OutlineElementNavigator.Me(b)&&Eb.a.Mh(h)&&fg.OutlineElementNavigator.Me(h)&&$e.c(b.currentNode,h.currentNode,this.jqk),r&&(fg.OutlineElementNavigator.me(b),fg.OutlineElementNavigator.me(h),sf.ListItemReader.Fg(b)&&(r=Wm.nBn.Uw(b),r.yD=pk.a.Ok,{Jla:r}=Wm.Kl.Bqa(r.Se,h,r))))}UVa(b){this.Lh&&this.Wm.qyo(b.currentNode);for(b=uw.a.zq(b);b.moveNext();)if(Cd.ParagraphReader.Wb(b.currentNode)){const h=
xl.e(b.currentNode);for(const r of h)r.uga();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else sf.ListItemReader.Fg(b.iterator)&&this.Zt&&this.Zt.Vga(b.iterator)}wH(b,h){let r=null;if(this.lIh.Bg){const A=Object(Ca.a)(lp.a,b);A&&(r=A.$X())}si.TableReader.Go(b)&&(1===h?h=3:3===h&&(h=1));super.wH(b,h);this.lIh.Bg&&this.WQk.p_a(b,r);Object(Gb.a)(lp.a,b)&&tn.a.Vh.VPj(Object(Ca.a)(lp.a,b),(new Qt.a(1,0)).Qu)}Eyg(b,h){const r=Array(h),A=this.NHi(b)/h;for(let L=0;L<h;L++)r[L]=Math.max(nh.a.hn(vr.a.Iha,
0),A);b.setValue(Ke.a.hB,r)}NOj(b){b.setValue(Vc.a.tableLayout,0)}sQh(b,h,r,A,L){const Z=Array(r);for(var oa=0,Ba=0;oa<A;++oa)Z[oa]=h[oa],Ba+=Z[oa];for(;oa<r;++oa)Z[oa]=0>oa-L?h[0]:h[oa-L],Ba+=Z[oa];oa=this.NHi(b.currentNode);if(Ba>oa)for(Ba=oa/Ba,oa=0;oa<r;++oa)Z[oa]=Math.max(nh.a.hn(vr.a.Iha,0),Z[oa]*Ba);return Z}NHi(b){var h=hb.a.eb(b);b=nh.a.hn(nh.a.Mj(si.TableReader.BHi(h),0),0);if(h.zb(16))return Kh.returnToCell(h),h=vr.a.Wzc(h.currentNode),nh.a.hn(nh.a.Mj(h,0),0)-b;h=Tq.a.Xzc(h);return nh.a.hn(nh.a.Mj(h,
0),0)-b}QJ(b,h,r){const A=new hb.a;A.set(b);Kh.moveToCell(A,h,r);return A.currentNode.ka(Vc.a.colSpan,1)}Lwc(b){var h=ab.StaticActiveAppFrame.za().kb.Gw;if(h.ve&&(h=b.fg(h.Ic))){var r=!1,A=si.TableReader.Eh(b),L=b.ka(Ke.a.hB,Array(A));for(var Z of L)if(!Z){r=!0;break}if(r){L=Me.a.clone(L);Z=b.ka(Vc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",A,L,Z);r=1;var oa=0;for(let gb=0;gb<A;)if(Z&&(r=this.QJ(b,
0,gb)),1<r){for(var Ba=0;Ba<r;Ba++)L[gb]||(L[gb]=this.zBi(0)),gb++;oa+=r-1}else(Ba=h.Mom(gb-oa))||v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",gb,oa),L[gb]||(L[gb]=this.zBi(Ba)),gb++;b.setValue(Ke.a.hB,L)}}}zBi(b){return nh.a.hn(Math.max(b,vr.a.Iha),0)}o_a(b){b=hb.a.eb(b);this.Lwc(b.currentNode);b.zb(14)&&(Kh.returnToContainingTable(b),this.Lwc(b.currentNode))}RPj(b,h){h&&b.setValue(Vc.a.Kca,h)}kzg(b,h){h&&b.setValue(Vc.a.Syc,h)}v2h(b,h){const r=si.TableReader.Eh(b);
tn.a.Frl(b,h,r)}KTo(b,h,r){let A;if(!({Bp:A}=this.$oc(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.yWl(A,h))return!1;for(let L=0;L<h.length;++L){const Z=this.WIb.ynd(b,h[L],r[L]);if(Z)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",Z),!1}this.Lje(A);return!0}return!1}u7k(b,h){let r;if(!({Bp:r}=this.$oc(b)).returnValue||si.TableReader.oD(r))return!1;var A=Object(Ca.a)(hb.a,this.fd.mg(r));Kh.moveToLastRow(A);
var L=si.TableReader.vg(r);if(h&&0<h.length){this.insertRows(A,!1,h.length,()=>null);A=si.TableReader.vg(r);var Z=this.fd.mg(r);L=this.xHi(Z,L,A-1);for(A=0;A<L.length;++A){Z=L[A];const oa=h[A];for(let Ba=0;Ba<Z.length;++Ba){let gb;if(gb=oa&&oa[Ba]?this.WIb.ynd(b,Z[Ba],oa[Ba].toString()):this.WIb.ynd(b,Z[Ba],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",gb),!1}}}this.Lje(r);return!0}c7k(b,h){let r;if(!({Bp:r}=this.$oc(b)).returnValue||
si.TableReader.oD(r))return!1;var A=this.fd.mg(r),L=si.TableReader.Eh(r);if(h&&0<h.length){this.insertColumns(Object(Ca.a)(hb.a,A),L,!1,h[1].length,()=>null);var Z=si.TableReader.Eh(r);A=this.nNm(A,L,Z-1);for(L=0;L<A.length;++L){Z=h[L];const oa=A[L];for(let Ba=0;Ba<oa.length;++Ba){let gb;if(gb=Z&&Z[Ba]?this.WIb.ynd(b,oa[Ba],Z[Ba].toString()):this.WIb.ynd(b,oa[Ba],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",gb),!1}}}this.Lje(r);
return!0}bQl(b){let h;if(!({Bp:h}=this.$oc(b)).returnValue)return!1;let r=this.Y8a(h);const A=si.TableReader.vg(h);var L=this.fd.mg(h);L=this.xHi(L,r,A-1);for(let Z=0;Z<L.length;++Z){const oa=L[Z];for(let Ba=0;Ba<oa.length;++Ba){const gb=this.WIb.mBj(b,oa[Ba]);if(gb)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",gb),!1}}r=r?r:1;b=this.fd.mg(h);b.ZB(r)&&15===b.uf&&this.deleteRows(Object(Ca.a)(hb.a,b),A-r);this.Lje(h);return!0}Y8a(b){let h=
0;const r=this.fd.mg(b);let A=r.je();for(;A&&A.ka(Vc.a.Xtb,!1);)h++,A=r.Mv();return!h&&tn.a.Ry.O2(b)&32?1:h}Evp(b,h,r){var A,L;const Z=b.currentNode,oa=new hb.a;oa.nd(b);let Ba=null,gb=null,Ab=null;const Jb=Mi.a.instance.zR(3),Tb=Mi.a.instance.zR(4),jc=Mi.a.instance.zR(5),Hc=Mi.a.instance.zR(0);Kh.forEachCell(oa,h,r,(hd,Gd,de)=>{hd=hd.currentNode;Gd||de||(Ba=Wm.gB.X1c(hd,Jb,Ba));Gd||de!==r-1||(gb=Wm.gB.X1c(hd,Tb,gb));0<Gd&&!de&&(Ba?Wm.gB.yxg(hd,Jb,Ba):Wm.gB.gZb(hd,Jb),gb?Wm.gB.yxg(hd,Tb,gb):Wm.gB.gZb(hd,
Tb),Wm.gB.gZb(hd,jc),Gd!==h-1&&Wm.gB.gZb(hd,Hc));de||Gd!==h-1||(Ab=Wm.gB.X1c(hd,Hc,Ab))});b=null===(L=null===(A=ab.StaticActiveAppFrame.za())||void 0===A?void 0:A.kb)||void 0===L?void 0:L.Gw;gb?(A=zo.TableNodeBorderContext.maa(Z,1),Wm.gB.zxg(nn.a.Oq(b),A,gb,0)):Wm.gB.gZb(Z,Tb);A=zo.TableNodeBorderContext.maa(Z,0);if(Ba)Wm.gB.zxg(nn.a.Oq(b),A,Ba,0);else for(A=Object(Ca.a)(zo.TableNodeBorderContext,A).A8a(),L=0;L<A.length;L++)Wm.gB.gZb(A[L],Tb);Ab?Wm.gB.yxg(Z,Hc,Ab):Wm.gB.gZb(Z,Hc)}yWl(b,h){for(let A=
0;A<h.length;++A){var r=this.fd.mg(h[A]);if(r.zb(14)&&(r=r.kd(14),b.id===r.id))continue;return!1}return!0}$oc(b){let h=null;if(b&&b.rv.toString()!==b.IA.toString())return{returnValue:!1,Bp:h};h=this.Tj.Eb(b.rv);return 14===h.type&&this.WIb.$oc(b)?{returnValue:!0,Bp:h}:{returnValue:!1,Bp:h}}xHi(b,h,r){const A=[];Kh.forEachCellInTable(Object(Ca.a)(hb.a,b),(L,Z,oa)=>{if(Z>=h&&Z<=r)oa||A.push([]),$g.TableCellReader.Ng(L)||Array.add(A[Z-h],L.currentNode);else if(Z>r)return!1;return!0});return A}nNm(b,
h,r){const A=[];Kh.forEachCellInTable(Object(Ca.a)(hb.a,b),(L,Z,oa)=>{oa>=h&&oa<=r&&(oa===h&&A.push([]),$g.TableCellReader.Ng(L)||Array.add(A[Z],L.currentNode));return!0});return A}Lje(b){if(b&&14===b.type){b=Object(Ca.a)(hb.a,this.fd.mg(b));const h=new nb.a;Cd.ParagraphReader.HQb(b,!0,!1,h);b=qc.SelectionFactory.ue(h.K(h.count-1),0);this.ib.Kc(b)}}static get gB(){Wm.Zxa||(Wm.Zxa=Wa.a.instance.Oa("WordEditor.ITableBorderManager"));return Wm.Zxa}static get nBn(){return null!=Wm.o0g?Wm.o0g:Wm.o0g=Wa.a.instance.resolve("Box4.List.IListReader")}static get Kl(){return null!=
Wm.h0g?Wm.h0g:Wm.h0g=Wa.a.instance.resolve("Box4.List.IListEditor")}WTi(b,h){const r=new hb.a;r.set(b);Kh.moveToFirstRow(r);Kh.moveToRowByIndex(r,h);do r.currentNode.Xl(4,!0);while(Kh.moveToNextRow(r))}static EVf(b,h){if(b){var r=si.TableReader.vg(b),A=si.TableReader.Eh(b);if(!(!ab.StaticActiveAppFrame.za().kb.Gw.ve||0>h||h>=r))for(r=new hb.a,r.set(b),b=0;b<A;b++){b?Kh.moveToNextColumn(r):Kh.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let L=r.currentNode;$g.TableCellReader.gr(L)&&
(L=$g.TableCellReader.W6(L));L&&L.Xl(4,!0)}}else v.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static DVf(b,h){if(b){var r=si.TableReader.vg(b),A=si.TableReader.Eh(b),L=new hb.a;if(!(!ab.StaticActiveAppFrame.za().kb.Gw.ve||0>h||h>=A))for(A=0;A<r;A++){L.set(b);Kh.moveToCell(L,A,h);if(!L||!L.currentNode)continue;let Z=L.currentNode;$g.TableCellReader.gr(Z)&&(Z=$g.TableCellReader.W6(Z));Z&&Z.Xl(4,!0)}}else v.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}
Wm.Zxa=null;Object(u.a)(Wm,"TableEditor",tn.a,[446,447]);class Ku{get name(){return"WordEditor.TableEditors"}wc(b){y.AFrameworkApplication.J.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new Wm(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Xi.a,If.a.instance,b.Ta("WordEditor.IFlatListEditor"),
b.resolve("Box4.ContentControl.IContentControlOperator"),b.Ta("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ia("WordEditor.TableEditors.TableBorderManager",()=>new Fg).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){E.a.instance.Mc(new Ku)}}Object(u.a)(Ku,"WordEditorTableEditorsPackage",
null,[0,1]);class ut{get name(){return"WordEditor.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new ut)}}Object(u.a)(ut,"WordEditorTextLevelEditorsPackage",null,[0,1]);var fv=d(2024),QA=d(384),Ez=d(784),Dv=d(213),Ao=d(229);class Rt{constructor(b){this.YHk=b}LIl(){const b=Ju.a.instance.createInstance(Ln.a.aXb);b.setValue(Ke.a.QL,Dv.a.first);b.setValue(Ke.a.eWh,0);b.setValue(Ke.a.zta,fm.OutlineReader.VOl);(new Ez.OutlineIndentInfo(!0)).sJj(b);return b}Tja(b,h,r=null){const A=
b.currentNode;if(!b.xL(1))return this.rSb(b,null,h,r);Eb.a.sN(b)&&fg.OutlineElementNavigator.Z8f(b,!0);return Eb.a.Mh(b)?Rt.Mf.yy(b,!1,h,r):(b.Jld(A),null)}Ell(b){return fm.OutlineReader.KZf(b.currentNode)||Eb.a.Mh(b)||Eb.a.sN(b)||$g.TableCellReader.isTableCell(b)}rSb(b,h=null,r=!1,A=null){if(!this.Ell(b))return null;const L=Rt.Mf.fob();this.mZo(L,b);b.mSb(L,h,1,null);b.Yj(L);r&&(Rt.Mf.dL(b,A),fg.OutlineElementNavigator.me(b));return L}mZo(b,h){if(h=this.pJm(h))switch(h.type){case 11:Rt.Mf.jyf(h,
b,!0);break;case 8:h=Rt.pj.isRtl(h),Rt.Mf.P_b(b,h)}}pJm(b){return this.YHk.qJm(b)}O_b(b,h){b.setValue(Ke.a.Cs,h?11:9)}STo(b,h){const r=Ao.WordSectionNavigator.instance.NU(b);return r?fm.OutlineReader.u_(b)!==h?(r.setValue(Vc.a.Xuf,h),!0):!1:null}static get pj(){return pl.PageReader.instance}static get Mf(){return Rt.Vh||(Rt.Vh=Wa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Mf(b){Rt.Vh=b}}Rt.Vh=null;Rt.Ee=null;Object(u.a)(Rt,"OutlineEditor",null,[499]);const RA=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",
()=>new Rt(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new fv.a(b.nf("Box4.IOutlineEditor"),b.nf("Box4.List.IListEditor"),b.nf("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").ha()};
class Dy{KSj(){return{JSj:!0,sbk:!1}}}Object(u.a)(Dy,"CursorMovementValidator",null,[441]);class $w{get name(){return"Box4.OutlineLevelEditors"}wc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new Dy).as("Box4.List.ICursorMovementValidator").ha();RA(b)}init(){}dispose(){}static main(){E.a.instance.Mc(new $w)}}Object(u.a)($w,"Box4OutlineLevelEditorsPackage",null,[0,1]);class Fz{constructor(b){this.$Yd=null;this.iij=b.jb("OfficeOnlineChromeExtensionId");this.tij=b.jb("ChromeClipboardAccessExtensionId");
this.lgn=b.$("OfficeOnlineChromeExtensionIsEnabled");this.xEh=!this.Uon();this.$Yd=this.i0b?this.tij:this.iij}gGj(){this.$Yd===this.iij&&this.CZi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.$Yd=this.tij;this.xEh=!0}get i0b(){return this.xEh}Uon(){if(this.lgn&&this.CZi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get CZi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){v.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(u.a)(Fz,"ChromeExtensionHelper",null,[1948]);var Lu=d(1342),mu=d(693),Gz=d(1295);class zn{create(b){return new Gz.a(b)}}Object(u.a)(zn,"Factory",null,[720]);var Ok=d(610),vw=d(1035),oE=d(405),
Am=d(367),jq=d(938);class go extends jq.a{constructor(b,h,r,A,L,Z,oa=null,Ba=null){super(b,Z,oa,Ba);this._formatting=null;this.JQa=!1;this.$Db=y.AFrameworkApplication.J.$("FollowDestinationFormattingPasteIsEnabled");this.oGb=0;this.xQc=new nb.a;Uc.a(8128527,307,Eb.a.Mh(b));this.tO=h;this.tO.wdc(this);this.fr=r;this.Kl=A;this.Pd=L;this.Tkf=Ba;this.Y2e=sf.ListItemReader.Fg(this.Bc)}get ql(){return null!=this.$1g?this.$1g:this.$1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}get RYd(){return null}get hfc(){return this.Y2e&&
!this.tO.UIa}get oNb(){return 0<this.oGb}yga(b,h){if(!this.a1.QIg(this.Bc,h,!0)){Uc.a(8701077,307,Cd.ParagraphReader.Fh(this.Bc));var r=this.Bc.currentNode,A=xc.a.Cx(r);this.$Db&&this._formatting.jU&&(r=r.ra.last,this.JQa&&(r.formatting=this._formatting.jU.Of(r),this.JQa=!1),b=this.a1.MQf(b,h),this.a1.vca(this.Bc.currentNode,this._formatting.Fga,h));this.Cg.We(A,b)}}Kba(){Uc.a(8701078,307,Cd.ParagraphReader.Fh(this.Bc));const b=xc.a.Cx(this.Bc.currentNode);this.Cg.Lla(b,h=>new Am.a(h))}fwb(){this.a1.SQf(this.Bc)}qMa(){this.$Db&&
(this.JQa=!0)}oYa(){Uc.a(8701079,307,Cd.ParagraphReader.Fh(this.Bc))}nYa(){Uc.a(8701080,307,Cd.ParagraphReader.Fh(this.Bc))}xE(b){this.tO.UIa||(this.$Db?(this.qhf(b),this._formatting.esd(this.Bc.currentNode),b&&"P"===b.Tba.eae&&this.Tkf.nha(this.Bc.currentNode,this._formatting.BP),this.a1.vca(this.Bc.currentNode,this._formatting.Fga,b)):this.Pcl(b))}ZF(){this.tO.UIa||this.Xza()}tYa(){}Sbb(){}ACa(){Uc.a(8701081,307,Eb.a.Mh(this.Bc)||fm.OutlineReader.zy(this.Bc)||Cd.ParagraphReader.Fh(this.Bc)&&this.tO.UIa);
let b=!1;this.oNb||(b=this.hfc||!0);b||(this.YX+=1);this.oGb++}yCa(){this.oGb--;let b=!1;this.oNb||(b=this.hfc||!0,this.Kl.zCj(this.xQc));b||--this.YX}uMa(b){Uc.a(8701082,307,Eb.a.Mh(this.Bc)||fm.OutlineReader.zy(this.Bc)||Cd.ParagraphReader.Fh(this.Bc)&&this.tO.UIa);Uc.a(8701083,307,!!b.listStyleType)}zCa(){Uc.a(8701084,307,Eb.a.Mh(this.Bc)||Cd.ParagraphReader.Fh(this.Bc)&&this.tO.UIa);this.tO.UIa||Uc.a(8701085,307,this.Bc.zu(2))}Qba(b){this.tO.Qba(b)}Oba(){this.tO.Oba()}Srd(b){this.xQc.add(b)}d8(b){this.tO.d8(b)}Pba(){this.tO.Pba()}Nba(b){this.tO.Nba(b)}Mba(){this.tO.Mba()}Pcl(b){this.yrc(!1);
(new hb.a).nd(this.Bc);b=jq.a.Mf.dL(this.Bc,this.J3c(b));Uc.a(8128534,307,b===this.Bc.currentNode);Uc.a(8128535,307,Cd.ParagraphReader.Wb(b))}Xza(){Uc.a(8128536,307,Cd.ParagraphReader.Fh(this.Bc));fg.OutlineElementNavigator.me(this.Bc)}reset(){this.$Db&&(super.reset(),this._formatting=this.VHf(!0))}qhf(b){this.yrc(!1);(new hb.a).nd(this.Bc);b=jq.a.Mf.dL(this.Bc,this.J3c(b));Uc.a(36577367,307,b===this.Bc.currentNode);Uc.a(36577368,307,Cd.ParagraphReader.Wb(b));-1!==this._formatting.Jx&&this.ql.wH(b,
this._formatting.Jx);this._formatting.lineSpacing&&this.Tkf.UE(b,this._formatting.lineSpacing);this._formatting.I8&&this.Tkf.Lxe(b,this._formatting.I8);this.JQa=!0;this._formatting.paragraph=b}static mrf(b,h){let r=0;switch(h){case 3:r=Tf.a.lD(b);break;case 7:r=nh.a.bA(b,0);break;case 1:r=Tf.a.anf(b);break;case 5:r=Tf.a.lD(Tf.a.Ojg(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}Object(u.a)(go,
"TextOnlyBox4PasteSteward",jq.a,[]);class nj extends go{constructor(b,h,r,A,L,Z,oa,Ba=null,gb=null){super(h,r,A,L,Z,oa,Ba,gb);this.GJc=!1;this.VEb=[];this.oHh=b;h={};h.textOnlyPasteFlags=b;v.ULS.sendTraceTag(509088282,307,50,H.c(h))}reset(){super.reset();this.GJc=!1;this.VEb.length=0;this.QDd=!1}xE(b){this.GJc||(super.xE(b),this.GJc=!0)}ZF(){this.QDd?this.QDd=!1:this.Kba(null)}Kba(b){this.oHh&2||super.Kba(b)}ACa(){}yCa(){}uMa(){}zCa(){}Qba(){}Oba(){}d8(b){this.GJc||(super.d8(b),this.GJc=!0);this.VEb.push(!1)}Pba(){this.oHh&
1&&this.Kba(null);0<this.VEb.length?this.VEb.pop():Uc.a(509088281,307,!1)}Nba(){var b=this.VEb.length-1;0<=b?this.VEb[b]?(b=xc.a.Cx(this.Bc.currentNode),this.Cg.We(b,", ")):this.VEb[b]=!0:Uc.a(509088280,307,!1);this.QDd=!0}Mba(){this.QDd=!1}Srd(){}}Object(u.a)(nj,"StrictTextOnlyBox4PasteSteward",go,[]);class ns{constructor(b,h,r,A){this.j2e=b;this.DM=h;this.lg=r;this.a1=A}create(b,h,r,A,L=null,Z=null,oa=null,Ba=null){return 1===b?null!==Ba&&0!==Ba?new nj(Ba,h,A,this.j2e,this.DM,this.lg,L,Z,this.a1):
new go(h,A,this.j2e,this.DM,this.lg,L,Z,this.a1):new oE.Box4PasteSteward(h,r,A,this.j2e,this.DM,this.lg,L,new ck.b,Z,this.a1,oa)}}Object(u.a)(ns,"Box4PasteStewardFactory",null,[719]);var $s=d(176),Hz=d(377),Nr=d(1060);class lG{constructor(b,h,r){this.kA=null;this.pGb=0;this.Bc=b;this.ik=r}wdc(b){this.kA=b}get UIa(){return 0<this.pGb}Qba(b){Uc.a(7869459,307,!!this.kA);Uc.a(7869460,307,Eb.a.Mh(this.Bc)||fm.OutlineReader.zy(this.Bc));Uc.b(38563978,307,50,"Table pasting started");this.kA.yrc(!0);const h=
new hb.a;h.nd(this.Bc);var r=Nr.a.o3m[b.styleId];r||(y.AFrameworkApplication.$c("gdea6103;0df65435"),b.wWf?(v.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),r=Nr.a.DSn):r=Nr.a.tdi);r=this.ik.Vso(this.Bc,b.rowCount,b.tnb,r,b.tableLook,this.kA.J3c(b),b.wWf);b.yFg&&(Uc.b(573691298,3022,100,"Applying table border properties"),Nr.a.CSh(b.yFg,this.Bc,!1,!0));b.$ae&&(Uc.b(573691299,3022,100,"Applying indentation properties"),Nr.a.q8k(this.Bc,b.$ae.spaceBefore,b.$ae.spaceAfter));
b.UVd&&(Uc.b(573691328,3022,100,"Applying column widths"),Nr.a.Z7k(b.UVd,this.Bc,Object(Ca.a)(Hz.TableNode,r),b.jab));this.kA.nSd(h,!1);this.pGb++;sf.ListItemReader.Fg(h)&&this.kA.Srd(h.currentNode);Uc.a(7869461,307,si.TableReader.isTable(this.Bc))}Oba(){Uc.a(7869462,307,!!this.kA);Uc.a(7869463,307,Vm.a.isTableRow(this.Bc));Uc.b(38563979,307,50,"Table pasting finished");this.Bc.mt(14)&&Nr.a.xJj(this.Bc.Aq);fg.OutlineElementNavigator.me(this.Bc);this.pGb--}d8(b){Uc.a(7869464,307,!!this.kA);Uc.b(573691329,
3022,100,"Table row pasting started");si.TableReader.isTable(this.Bc)?Kh.moveToFirstRow(this.Bc):Vm.a.isTableRow(this.Bc)&&Kh.moveToNextRow(this.Bc);b.height&&(Uc.b(573691330,3022,100,"Applying table row height"),Nr.a.l9k(this.Bc,b.height));Uc.a(7869465,307,Vm.a.isTableRow(this.Bc))}Pba(){Uc.a(7869466,307,!!this.kA);Uc.a(7869467,307,$g.TableCellReader.isTableCell(this.Bc));Kh.returnToContainingRow(this.Bc)}Nba(b){Uc.a(7869468,307,!!this.kA);Uc.a(7869469,307,!this.kA.YX);Vm.a.isTableRow(this.Bc)?Kh.moveToFirstColumn(this.Bc):
$g.TableCellReader.isTableCell(this.Bc)?Kh.moveToNextColumn(this.Bc):Uc.a(7869471,307,!1);if(this.Bc.currentNode){Uc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Ca.a)($s.TableCellNode,this.Bc.currentNode);Uc.a(50689760,307,!h&&16!==this.Bc.currentNode.type||!!h&&16===this.Bc.currentNode.type);if(h){var r=new hb.a;r.nd(this.Bc);if(b.Uoc)Uc.b(573691332,3022,100,"Processing skipped cell"),Nr.a.mjo(r,b);else{if(1<b.colSpan||1<b.rowSpan){const A=Kh.returnToContainingTable(r);if(!A)return;
A.setValue(Vc.a.complexTable,!0);r.nd(this.Bc);Uc.b(573691333,3022,100,"Processing merged cell");Nr.a.Cio(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}Nr.a.q9k(this.Bc,b.shadingColor);Nr.a.h$k(this.Bc,b.verticalAlignment);Nr.a.N7k(this.Bc,b.sBe);Nr.a.CSh(b.Jna,this.Bc,!b.colSpan&&!b.rowSpan,!1);(new hb.a).nd(this.Bc);Kh.forEachCell(r,b.rowSpan,b.colSpan,(A,L,Z)=>{Uc.b(573691334,3022,100,"Setting ghost cell borders");Nr.a.TNj(A,b.Jna,L,Z,b.rowSpan,b.colSpan)});Nr.a.j$k(this.Bc,b.width,b.jab);Uc.a(7869472,
307,fm.OutlineReader.zy(this.Bc))}}}}Mba(){Uc.a(7869473,307,!!this.kA);Uc.a(7869474,307,Eb.a.Mh(this.Bc)||$g.TableCellReader.isTableCell(this.Bc));Kh.returnToCell(this.Bc);Uc.a(7869475,307,0>=this.kA.YX);this.kA.Xnf()}}Object(u.a)(lG,"Box4TableSteward",null,[735,223]);class ax{constructor(b,h,r){this.kA=null;this.pGb=0;this.Bc=b;this.ik=r}wdc(b){this.kA=b}get UIa(){return 0<this.pGb}Qba(){this.UIa&&(Uc.a(8787101,307,Cd.ParagraphReader.Fh(this.Bc)),fg.OutlineElementNavigator.me(this.Bc));Uc.a(8701086,
307,!!this.kA);Uc.a(8701087,307,Eb.a.Mh(this.Bc)||fm.OutlineReader.zy(this.Bc));this.pGb++}Oba(){Uc.a(8701088,307,!!this.kA);fg.OutlineElementNavigator.me(this.Bc);this.pGb--;if(this.UIa){this.kA.yrc(!0);const b=ax.Mf.dL(this.Bc);Uc.a(8787102,307,b===this.Bc.currentNode);Uc.a(8787103,307,Cd.ParagraphReader.Fh(this.Bc))}}d8(b){Uc.a(8701089,307,!!this.kA);this.kA.yrc(!0);const h=new hb.a;h.nd(this.Bc);this.kA.nSd(h,!1);sf.ListItemReader.Fg(h)&&this.kA.Srd(h.currentNode);b=ax.Mf.dL(this.Bc,this.kA.J3c(b));
Uc.a(8701090,307,b===this.Bc.currentNode);Uc.a(8701091,307,Cd.ParagraphReader.Fh(this.Bc))}Pba(){Uc.a(8701120,307,!!this.kA);Uc.a(8701121,307,Cd.ParagraphReader.Fh(this.Bc));fg.OutlineElementNavigator.me(this.Bc)}Nba(){Uc.a(8701122,307,!!this.kA);Uc.a(8701123,307,Cd.ParagraphReader.Fh(this.Bc));Uc.a(8701124,307,!this.kA.YX);var b=this.Bc.currentNode;Cd.ParagraphReader.textLength(b)&&(b=xc.a.Cx(b),this.kA.Cg.We(b,", "))}Mba(){Uc.a(8701125,307,!!this.kA);Uc.a(8701126,307,Cd.ParagraphReader.Fh(this.Bc));
Uc.a(8701127,307,0>=this.kA.YX);this.kA.Xnf()}static get Mf(){return null!=ax.j1g?ax.j1g:ax.j1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(u.a)(ax,"TextOnlyBox4TableSteward",null,[735,223]);class Ey{constructor(b,h,r=!1,A=!1){this.DM=b;this.GG=h;this.EIk=r;this.LIk=A}create(b,h){return 1===b?new ax(h,this.DM,this.GG):new lG(h,this.DM,this.GG,this.EIk,this.LIk)}}Object(u.a)(Ey,"Box4TableStewardFactory",null,[718]);class Bm{create(){return new zl.a}}Object(u.a)(Bm,"Factory",null,[717]);
class St{constructor(){this.Xkh=!1}get X$d(){return this.Xkh}set X$d(b){this.Xkh=b}}Object(u.a)(St,"HighContrastColorPickerState",null,[716]);class gJ{constructor(b){this.ga=b}get Pb(){return this.ga}yil(b,h,r=null){const A=new lj.DictionaryPropertySet;A.setValue(Od.a.cC,b);A.setValue(Od.a.GXa,h);r&&A.zt(r);A.CommandSource="autobulleting";this.Pb.Qb(vb.a.$E,2,A)}BUn(b,h,r,A,L){const Z=new lj.DictionaryPropertySet;Z.setValue(Od.a.cC,b);Z.setValue(Od.a.GXa,h);Z.setValue(Od.a.JLa,r);L&&Z.setValue(Ge.a.DT,
L);A&&Z.setValue(Vc.a.$w,A);Z.setValue(Ge.a.Cta,"autocorrect");L&&Z.setValue(Ge.a.qma,L);Z.CommandSource="autonumbering";return 32===this.Pb.Qb(vb.a.KN,2,Z)}}Object(u.a)(gJ,"ListCommands",null,[715]);var Gl=d(115);class hJ{constructor(b,h,r,A,L){this.Kl=b;this.OUn=h;this.Lj=r;this.Qd=A;this.Cg=L}get $hj(){return this.OUn.value}execute(b,h,r,A){const L=ih.a.instance.rq(vb.a.LWo);Eb.a.isEmpty(b,!1)?this.e4l(b):this.f4l(b,h,r,A);L.end()}e4l(b){this.$hj.smf(b,-1)?this.$hj.hZa(b,-1,0):this.Kl.hca(b,{qCj:!0})}f4l(b,
h,r,A){h=A(b,h,r);b=Cd.ParagraphReader.Zm(b.currentNode);!this.Kl.czb&&this.Dun(b)&&this.M_k(h);this.Kl.P0();(null===b||void 0===b?0:b.ra)&&!b.ra.last.formatting&&this.Cg.R7a(b)}Dun(b){return b.lj&&!b.Nx.hasProperty(Vc.a.listID)}M_k(b){fg.OutlineElementNavigator.Me(b);b=b.currentNode;const h=new Gl.a;b.Hc.hu(h);this.Lj.YP(b,h,this.Qd.Bg)}}Object(u.a)(hJ,"ListNewLineStrategy",null,[]);var fh=d(424);class zv{constructor(b){this.ga=b}pPn(b){if(4===b)b=vb.a.cCa;else if(2===b)b=vb.a.dha;else if(1===b)b=
vb.a.BAb;else if(3===b)b=vb.a.DUa;else return;this.ga.Ob(b,2)}Y7a(){this.ga.Ob(vb.a.Y7a,2)}}Object(u.a)(zv,"SelectionCommands",null,[714]);var zy=d(231),ww=d(1096),Iz=d(144),SA=d(498);class TA{constructor(){this.uad=!1;this.cGp=y.AFrameworkApplication.J.jb("WordEditorVisiFontFileUri");this.eGp=y.AFrameworkApplication.J.jb("WordEditorVisiRtlFontFileUri");this.dGp=y.AFrameworkApplication.J.jb("WordEditorVisiPilcrowFontFileUri");this.$Fp=y.AFrameworkApplication.J.jb("WordEditorVisiCarriageReturnFontFileUri");
this.bGp=y.AFrameworkApplication.J.jb("WordEditorVisiCarriageReturnRtlFontFileUri")}Imp(){this.uad=!this.uad}Hmp(b){this.Imp();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],A=b.getElementsByClassName("VisiFontPilcrowStyle")[0],L=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],Z=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",Je.a.Rx(h,""),b.appendChild(h));
r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",Je.a.Rx(r,""),b.appendChild(r));A||(A=document.createElement("Style"),A.className="VisiFontPilcrowStyle",Je.a.Rx(A,""),b.appendChild(A));L||(L=document.createElement("Style"),L.className="VisiFontCarriageReturnStyle",Je.a.Rx(L,""),b.appendChild(L));Z||(Z=document.createElement("Style"),Z.className="VisiFontCarriageReturnRtlStyle",Je.a.Rx(Z,""),b.appendChild(Z));if(this.uad)return v.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),
this.oTc(h)&&this.oTc(r)&&this.oTc(A)&&this.oTc(L)&&this.oTc(Z);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.Fkd(h)&&this.Fkd(r)&&this.Fkd(A)&&this.Fkd(L)&&this.Fkd(Z)}oTc(b){return""===Je.a.MA(b)?("VisiFontStyle"===b.className?Je.a.Rx(b,this.W2c("WordVisi_MSFontService",this.cGp)):"VisiFontRtlStyle"===b.className?Je.a.Rx(b,this.W2c("WordVisiRtl_MSFontService",this.eGp)):"VisiFontPilcrowStyle"===b.className?Je.a.Rx(b,this.W2c("WordVisiPilcrow_MSFontService",this.dGp)):
"VisiFontCarriageReturnStyle"===b.className?Je.a.Rx(b,this.W2c("WordVisiCarriageReturn_MSFontService",this.$Fp)):"VisiFontCarriageReturnRtlStyle"===b.className&&Je.a.Rx(b,this.W2c("WordVisiCarriageReturnRtl_MSFontService",this.bGp)),!0):!1}Fkd(b){return""!==Je.a.MA(b)?(Je.a.Rx(b,""),!0):!1}W2c(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(u.a)(TA,"VisiMarkersOperation",null,[711]);var Gs=d(1487),Ev=d(951);
class Fv extends Gs.a{constructor(b,h){super(b,h);this.gVe=-1;this.YDb=0;this.$Re=null;this.hmh=!1;this.iTe=[];this.FEd=!1;this.xvh=!0;this.v1e=this.zCd=null;this.preventDismissOnScroll=this.nqe=this.euc=!1;this.jaa=null;this.BOd=!1;this.V5c=!0;this.ey=!1;this.Boh=y.AFrameworkApplication.J.$("FloatieLightDismissIsEnabled");Fv.gBh||(y.AFrameworkApplication.va.qa(Za.a.showFloatie,Gc.a.frame,Vd.ActionManager.eg),Fv.gBh=!0)}get ipi(){return this.SQ}set ipi(b){this.SQ=b}get O1j(){return this.BOd}get $6c(){return this.hmh}set $6c(b){this.hmh=
b;this.YDb=0}get uC(){return!0}get cssClass(){return y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.pba?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.ey}e_a(){for(const b of this.children)if(b.e_a())return!0;return!1}get kca(){return 9}Wf(b){this.iTe[this.iTe.length]=b;super.Wf(b)}yn(){super.yn();xf.c(this.Tc)&&this.mE();this.Tc=Ug.a.EZa(this.Tc);this.SZ(this.Tc);this.dirty=!1}usc(b){3===b.yg||this.nqe||this.dismissFloatie(b);return!1}xsc(){return!1}vsc(b){3!==
b.yg&&this.V5c&&!this.euc&&this.Fzp(b);return!1}wsc(){return!1}ssc(b){3===b.yg&&this.dismissFloatie(b);return!1}tsc(b){void 0!==this.jaa&&null!==this.jaa||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}yE(){this.Ozf();return!1}Gme(){this.$6c=!0}Fzp(b){if(b=Sf.a.Dgc(b.clientPoint,this.$Re)){if(this.$6c){if(!this.YDb||b<this.YDb)this.YDb=b;b-=this.YDb}b-=this.gVe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():aa.a.setOpacity(this.Tc,Math.max(h/255,0))}else this.$6c=!1,
this.YDb=0,aa.a.setOpacity(this.Tc,1)}Xxp(b){let h=null;void 0!==this.zCd&&null!==this.zCd&&(h=this.zCd(b));b=null;for(const r of this.iTe){let A=!this.O1j&&r.d3i;if(!A&&void 0!==h&&null!==h)for(let L=0;L<h.length;L++)if(r.id===h[L]){A=!0;break}r.Tc.style.display=A?"none":"";r.Agc=!A;A||(b=r)}b&&(b.Agc=!1)}dyi(){const b=this.Tc.style.top,h=this.Tc.style.left;this.Tc.style.top="0px";this.Tc.style.left="0px";const r=this.VPb();this.Tc.style.top=b;this.Tc.style.left=h;return r}VPb(){const b=this.Tc.style.visibility,
h=this.Tc.style.display;this.Tc.style.visibility="hidden";this.Tc.style.display="";const r=rd.a.getElementBounds(this.Tc);this.Tc.style.display=h;this.Tc.style.visibility=b;return r}Wzj(b){3===b||this.VCe?(Sys.UI.DomElement.addCssClass(this.Tc,Ev.a.N1b),this.BOd=!0):(Sys.UI.DomElement.removeCssClass(this.Tc,Ev.a.N1b),this.BOd=!1);this.Xxp(b)}ieb(b,h,r,A=!1){this.isVisible||(this.jaa||!this.xvh&&this.preventDismissOnScroll||(this.xvh=!1,rd.a.aje("ShowLegacyFloatie",""),y.AFrameworkApplication.va.Ob(Za.a.showFloatie,
2)),this.Wzj(r),this.V5c=!0,this.YDb=0,this.$6c=!1,!this.Boh||void 0!==this.jaa&&null!==this.jaa?(this.FEd=!1,this.$ja(this,!1)):(this.FEd=!0,this.Ocl(this)),h=A?b:this.yeo(b,h),this.Tc.style.top=h.y.toString()+"px",this.Tc.style.left=h.x.toString()+"px",this.ov(),this.$Re=this.VPb(),this.gVe=Sf.a.Dgc(b,this.$Re),aa.a.setOpacity(this.Tc,1),this.Tc.style.zIndex=String(y.AFrameworkApplication.ua.oya),this.Tc.style.display="",this.ey=!0)}yeo(b,h){const r=this.O1j?30:17,A=this.dyi(),L=Je.a.srb(),Z=Je.a.D_();
b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=A.height:3===h?(b.y-=A.height,b.x-=A.width):2===h&&(b.x-=A.width);b.x+A.width>L&&(b.x=Math.floor(L-A.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+A.height>Z&&(b.y=Z-A.height);return b}zeo(b,h){const r=b.rdj;if(r){this.Wzj(h);var A=this.dyi();this.jaa=b;b=r.EMg-r.a1c>A.width;var L=r.a1c+r.xDf>A.width,Z=r.tic>A.height+17,oa=r.Cak-(r.tic+r.tDf)>A.height+17;A=new Sys.UI.Point(r.a1c,r.tic);L||b||(L=!0,A.x=r.EMg);b=r.vub?r.y2f?oa?L?2:0:L?
3:1:Z?L?3:1:L?2:0:r.y2f?oa?b?0:2:b?1:3:Z?b?1:3:b?0:2;if(3===b||2===b)A.x=r.a1c+r.xDf;if(2===b||0===b)A.y=r.tic+r.tDf;this.ieb(A,b,h);this.V5c=!1;h=this.jaa.gdf.Tc;void 0!==h&&null!==h&&(h.style.zIndex=String(y.AFrameworkApplication.ua.oya))}}K6(){let b=super.K6();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.ZRc&&null!==this.ZRc&&this.ZRc.Dza(null);void 0!==this.jaa&&null!==this.jaa&&this.jaa.w6();this.w6();this.Boh&&this.FEd?this.x0l(this):
this.Vea(this,!1);this.FEd=!1;this.gVe=-1;this.jaa=null;this.Tc.style.display="none";this.ey=!1;this.v1e&&this.v1e(b);return!0}Ozf(){void 0!==this.jaa&&null!==this.jaa&&(this.jaa.o5a=null,this.jaa.w6(),this.jaa=null,this.xje.style.zIndex=String(y.AFrameworkApplication.ua.sHa),this.Tc.style.zIndex=String(y.AFrameworkApplication.ua.oya))}Bvo(b){this.zCd=b}swo(b){this.v1e=b}set uC(b){super.uC=b}}Fv.gBh=!1;Object(u.a)(Fv,"Floatie",Gs.a,[545,357,358]);class Gv{constructor(b,h){this.Bw=this.GQa=null;this.Caj=
b;this.tIj=h}get kpi(){return this.GQa}M0o(b){this.GQa=b}VPb(){return this.Bw.VPb()}f3(){return this.Bw?this.Bw.isVisible:!1}OVh(b){this.M0o(b)}showFloatie(b,h){this.ieb(h.location,h.az,h.isRtl)}ieb(b,h,r){r=r?this.tIj:this.Caj;this.Y0d();this.Bw&&this.Bw.ieb(b,r,h)}dismissFloatie(){this.Bw&&this.Bw.dismissFloatie()}Y0d(){this.GQa&&!this.Bw&&(this.Bw=Object(Ca.a)(Fv,this.GQa()))}L1d(){}}Object(u.a)(Gv,"AFloatieManager",null,[733]);class Fy extends Gv{constructor(){super(1,3);this.T_j=!1;this.Qei=
""}ieb(b,h,r){r=r?this.tIj:this.Caj;this.Y0d();this.Bw&&(this.Bw.isVisible&&this.Bw.dismissFloatie(),this.T_j||this.Bw.xn(),this.Bw.ieb(b,r,h,!0))}Y0d(){this.kpi&&!this.Bw&&(this.Bw=this.GQa())}L1d(){if(this.Bw&&this.Bw.isVisible){const b=Object(Ca.a)(Mk.a,this.Bw.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.py(b.Kqb(),1,null)}}dzg(b){this.Qei=b}iDo(b){b=b.RHf("Menu16",null);eg.a("renderIcon")&&b&&appChrome.api.renderIcon(Fy.ntk,b.firstElementChild)}PAc(b,h,r){if(this.Bw){const A=this.Bw.controls[this.Qei];
A&&(Fy.Ynh||(this.iDo(A),Fy.Ynh=!0),A.Vd[em.a.labelText]=b,A.Vd[em.a.alt]=h,r&&A.behavior.xn())}}}Fy.Ynh=!1;Fy.ntk="Designer_20";Object(u.a)(Fy,"PasteFloatieManager",Gv,[]);var UA=d(1047);class Ox{constructor(){this.Od=null}get Fv(){return null}getTitle(){return null}Fwi(){return null}reset(b){this.Od=b.node}rEa(b){b=xl.d(this.Od,b);let h=null;if(!b||b.Sh!==this.Sh)return{returnValue:!1,JG:h};h=Object.assign(new UA.a,{dG:this.key,contentObject:b,title:this.getTitle(b),description:this.Fwi(b)});return{returnValue:!0,
JG:h}}}Object(u.a)(Ox,"BlobDetailsProvider",null,[299,300]);class mG extends Ox{constructor(){super()}get key(){return"EQUATION"}get Sh(){return 11}get Fv(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(u.a)(mG,"EquationDetailsProvider",Ox,[]);class Or{constructor(){this.Ilh=null}get key(){return"LINK"}get Fv(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.Ilh=Ic.a.Ojc(b.node)}rEa(b){let h=null;for(const r of this.Ilh)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new UA.a,
{dG:this.key,contentObject:r.hyperlink}),{returnValue:!0,JG:h};return{returnValue:!1,JG:h}}}Object(u.a)(Or,"HyperlinkDetailsProvider",null,[299,300]);var yC=d(1274),Jz=d(924);class VA{constructor(){this.Rqh=!1}get key(){return"IFRAMENODE"}get Fv(){return this.Rqh?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}X1b(b){let h=null;b=b?Cd.ParagraphReader.dKa(b.currentNode):null;if(!b)return{returnValue:!1,Iea:h};h=Object.assign(new yC.a,{dG:this.key,contentId:b.id,
contentObject:b});return{returnValue:!0,Iea:h}}Gqb(b,h){b=b?Object(Ca.a)(Jz.a,b.contentObject):null;h=h?Object(Ca.a)(Jz.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.Rqh=b.yab,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Fv,this.Fv));return r}}Object(u.a)(VA,"IFrameDetailsProvider",null,[732,300]);class nG extends Ox{constructor(){super()}get key(){return"IMAGE"}get Sh(){return 5}reset(b,h){super.reset(b,h);this.UBk=!he.a.ym(h)}get Fv(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Id.a.x_(b.properties)}Fwi(b){b=
Id.a.AVa(b.properties);return this.UBk&&(y.AFrameworkApplication.$c("51a6c128;f7eb8687"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImageSelectionAnnouncement",!1))?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(u.a)(nG,"ImageDetailsProvider",Ox,[]);class Mu{get key(){return"IMAGENODE"}get Fv(){return Box4Intl.Box4Strings.l_ImageContentTitle}X1b(b){let h=null;if(!b||!Id.a.Eq(b.currentNode))return{returnValue:!1,
Iea:h};h=Object.assign(new yC.a,{dG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Iea:h}}Gqb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let A="";h&&b.id===h.contentObject.id||(A=String.format(r,Id.a.x_(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return A}}Object(u.a)(Mu,"ImageNodeDetailsProvider",null,[732,300]);var iJ=d(773);let Px,pE;class xw{constructor(b,h){this.Cgh=null;this.ko=h;this.q4e=b;this.key=
xw.keys.K(b);this.Fv=xw.Sqf.K(b)}reset(b){this.Cgh=this.ko.f7(b.node);iJ.a.F0e++}rEa(b){var h=xw.WCf(this.Cgh||[],r=>this.Phn(b,r));h=this.QEl(h);return{returnValue:!!h,JG:h}}Phn(b,h){return h.Dc<=b&&b<h.end&&(!h.errorDetails||this.q4e===h.errorDetails.proofingType)}QEl(b){return b?Object.assign(new UA.a,{dG:this.key,contentObject:b.errorDetails,description:this.mVa()}):null}mVa(){return kn.a.qLa?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static WCf(b,h){for(const r of b)if(h(r))return r;
return null}}xw.keys=(pE=new yc.a,pE.add(1,"SPELLINGERROR"),pE.add(2,"GRAMMATICALERROR"),pE.add(3,"ADVANCEDERROR"),pE);xw.Sqf=(Px=new yc.a,Px.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Px.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Px.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Px);Object(u.a)(xw,"ProofingDetailsProvider",null,[299,300]);class Kz{constructor(){this.Bp=null;this.SVd=this.fve=this.columns=this.rows=0}}Object(u.a)(Kz,"TableInfo",null,[]);
class Gy{get key(){return"TABLE"}get Fv(){return Box4Intl.Box4Strings.l_TableContentTitle}X1b(b){var h=null;if(!$g.TableCellReader.isTableCell(b))return{returnValue:!1,Iea:h};h=new hb.a;h.nd(b);b=new Kz;b.fve=Vm.a.Ft(h)+1;b.SVd=ev.a(h)+1;Kh.returnToContainingTable(h);b.Bp=h.currentNode;b.columns=si.TableReader.Eh(b.Bp);b.rows=si.TableReader.vg(b.Bp);h=Object.assign(new yC.a,{dG:this.key,contentId:b.Bp.id,contentObject:b});return{returnValue:!0,Iea:h}}Gqb(b,h){b=b.contentObject;const r=new Pd.a;h||
r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.SVd===b.SVd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.SVd));h&&h.contentObject.fve===b.fve||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.fve));return r.toArray().join(" ")}}Object(u.a)(Gy,"TableDetailsProvider",null,[732,300]);class oG{constructor(b,h){this.LQa=b;this.ko=h}get u2b(){return null!=this.w6g?this.w6g:this.w6g=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",
!1)}Lpg(){this.LQa.execute(b=>{b.dY(new Or);kn.a.iWf()||(this.u2b||(b.dY(new xw(1,this.ko)),b.dY(new xw(2,this.ko))),b.dY(new xw(3,this.ko)));b.dY(new mG);b.dY(new nG);b.aZb(new Gy);b.aZb(new Mu);b.aZb(new VA)})}}Object(u.a)(oG,"AccessibilityActor",null,[]);class Lz{constructor(b,h,r){this.n6n=(A,L,Z)=>{if(1===Z)return 32;this.Iok().YBg();return 32};this.U4a=b;this.Iok=r}Xb(){this.U4a.fb(vb.a.ipj,kc.a.view,this.n6n,1028)}}Object(u.a)(Lz,"AutoCorrectActor",null,[]);class qE{constructor(){this.Wie=
!0}wCa(){}Xbb(){}wdc(){}pfg(){}dxe(){}get Htc(){return!1}get Dvb(){return 0}get Icj(){return!1}get h_(){return eb.a.nil}}Object(u.a)(qE,"TextOnlyBox4ImageSteward",null,[414]);class zC{constructor(b,h,r,A,L,Z,oa=!1){this.HR=b;this.Zi=h;this.ih=r;this.b5m=A;this.$J=L;this.rc=Z;this.mDn=oa}create(b,h,r,A){return 1===b?new qE:new rq.a(h,this.HR,this.Zi,this.ih,this.rc,this.b5m,this.$J,this.mDn,r,A)}}Object(u.a)(zC,"Box4ImageStewardFactory",null,[710]);var Mp=d(32);class AC{constructor(b){this.Nee=b}tpn(b){if(!b||
!b.kD||1>b.kD.count)return!1;const h=[Mp.a.zbi,Mp.a.ybi];return!!this.U4d(b.kD,1,r=>this.WWd(r,h))}cXi(b){return!b||!b.kD||1>b.kD.count?!1:!!this.U4d(b.kD,1,h=>this.WWd(h,[Mp.a.mI]))}imn(b){return!b||!b.kD||1>b.kD.count?!1:!!this.U4d(b.kD,2,h=>this.WWd(h,[Mp.a.KUb]))}Fh(b){return!b||!b.kD||1>b.kD.count?!1:!!this.U4d(b.kD,1,h=>this.WWd(h,[Mp.a.Oma]))}Gde(b){if(!b||!b.kD)return!1;b=b.kD;for(let h=0;h<b.count;++h)if(!b.K(h)||0<b.K(h).Zal)return!1;return!0}f3l(b,h){return this.cXi(h)||this.imn(h)?"":
b}U4d(b,h,r){if(b&&0<b.count)for(let A=b.count-1;0<=A;--A){if(r(b.K(A)))return b.K(A);if(b.count-A>=h)break}return null}WWd(b,h){b=b&&b.VOi?b.VOi.split(" "):null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(u.a)(AC,"Box4PasteStewardUtils",null,[709]);var Tt=d(748);class Mz{constructor(){this.DAc=0;this.rqc=Array(9)}}Object(u.a)(Mz,"FullListMetadata",null,[]);class Hy{constructor(b,h,r){this.DAc=this.level=0;this.DBf=null;this.xtc=!1;this.level=b;this.nGe=h;this.y7n=
r}}Object(u.a)(Hy,"ListItemMetadata",null,[]);var Iy=d(1275);class rE{constructor(){this.level=0;this.tagName="UL";this.evb=null;this.XSf=!1;this.pUn=0;this.listStyle="BulletListStyle1";this.Jub=new Iy.a;this.font=this.levelText=""}}Object(u.a)(rE,"ListLevelMetadata",null,[]);class Qx{constructor(){}}Object(u.a)(Qx,"LevelLists",null,[]);class BC{constructor(b){this.nodes=b;this.lUa=0;this.lists={};this.Jub=[];this.i5i=null;this.MMl=[];this.MMl[0]=new Qx}}Object(u.a)(BC,"WordConverterArguments",null,
[]);var Cq=d(380),Rx=d(717);class Hl{}Hl.FNl="data-ccp-timestamp";Hl.jZd="data-clipservice-ccpid";Hl.INl="data-shapeids";Hl.pTm="docs-internal-guid-";Hl.Z5n="SCXO";Hl.Zeo="SCXP";Hl.yIp="SCXW";Hl.kQn="MsoListParagraphCxSpFirst";Hl.lQn="MsoListParagraphCxSpLast";Hl.Fuf="data-pkey";Hl.Guf="data-clipservice-type";Hl.Duf="data-clipservice-count";Hl.Euf="data-clipservice-dc";Hl.jYc="data-clipservice-client";Hl.Huf="data-clipservice-version";Object(u.a)(Hl,"HtmlContentMetadataConstants",null,[]);class Az{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(u.a)(Az,"AbsolutePosition",null,[]);var Nu=d(882);class Dq{constructor(b,h,r="",A=0){this.Oy=!1;this.wlh=this.xlh=null;let L=!1;Dq.rln(b)&&(L=!0,this.xlh=b);Dq.Kln(h)&&(this.wlh=h);this.Lyk=r;this.pok=A;this.Oy=L&&this.eae?!0:!1}get isValid(){return this.Oy}get YOi(){return this.xlh}get eae(){return this.wlh}get VOi(){return this.Lyk}get Zal(){return this.pok}static rln(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static Kln(b){return b?-1===b.indexOf(" ")&&
0<b.length:!1}}Object(u.a)(Dq,"HtmlElementInfo",null,[]);class Jy{constructor(b){this.next=null;this.data=b}}Object(u.a)(Jy,"StackNode",null,[]);class Ky{constructor(){this.Av=null;this.Pk=0}get count(){return this.Pk}get isEmpty(){return!this.count||!this.Av}push(b){b=new Jy(b);b.next=this.Av;this.Av=b;this.Pk=this.count+1}$U(){return this.count&&this.Av?this.Av.data:null}pop(){if(!this.count||!this.Av)return null;const b=this.Av;this.Av=b.next;this.Pk=this.count-1;return b.data}clear(){this.Av=
null;this.Pk=0}toArray(){const b=Array(this.count);let h=this.Av;for(let r=this.count-1;0<=r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(u.a)(Ky,"Stack",null,[]);class Zj{constructor(b){this.jj=b;this.PHc=this.KHd=null;this.cAd=!1}get RYd(){return this.PHc.$U()}reset(){this.jj.reset();this.KHd=new Ky;this.PHc=new Ky;this.PHc.push(this.jj.yYc);this.cAd=!1}tle(){this.cAd=!1}gK(b){this.cAd||(this.KHd.push(null),this.cAd=!0);this.KHd.push(b)}onClose(){for(;;){const b=this.KHd.pop();if(!b)break;b()}}RNj(){return!1}ITn(){this.mw(()=>
!0)}mw(b){const h=this.RYd.clone();return b(h)?(this.PHc.push(h),this.jj.qMa(h),this.gK(Object(D.a)(this,this.CZn,"onFormattingEnd")),!0):!1}AQf(b){if(Ok.a.Etb){let h=2;Cq.a.instance.le(()=>{h=this.yLi(b)},"AHT:HCA");return h}return this.yLi(b)}yLi(b){return b.style?this.mw(h=>this.RNj(h,b))?1:2:2}CZn(){this.PHc.pop();this.jj.qMa(this.RYd)}yga(){}lle(){return 2}qcg(){return 2}rcg(){return 2}vcg(){return 2}Jcg(){return 3}Lcg(){}sle(){return 2}Mcg(){}Ncg(){}Ocg(){return 2}vle(){return 2}wle(){return 2}cdg(){return 2}xle(){}edg(){return 2}zle(){return 2}Ale(){return 2}Dle(){return 2}Ele(){return 2}qdg(){}rdg(){return 2}Mle(){return 2}Nle(){return 2}Qle(){return 2}Rle(){return 2}Tle(){return 2}Ule(){return 2}Vle(){return 2}Xle(){return 2}Vdg(){return 2}fme(){return 2}beg(){return 2}deg(){}eeg(){return 2}ime(){return 2}jme(){return 2}kme(){return 2}lme(){return 2}mme(){return 2}nme(){return 2}jeg(){return 3}ome(){}neg(){return 2}pme(){return 2}peg(){return 3}tme(){}veg(){}ume(){return 2}Aeg(){return 3}xme(){return 2}zme(){return 2}Bme(){return 2}Cme(){return 2}Leg(){}Peg(){return 3}Eme(){return 2}onMenuOpen(){return 2}Veg(){}cfg(){return 2}dfg(){return 2}ffg(){return 3}Pme(){return 2}hfg(){return 2}Rme(){return 2}Vme(){return 2}ofg(){}cne(){return 2}Afg(){return 2}kne(){return 2}lne(){return 2}Qfg(){return 3}Wfg(){return 2}wne(){return 2}xne(){return 2}Ane(){return 2}Bne(){return 2}$fg(){return 3}Cne(){return 2}Ene(){return 2}Gne(){return 2}egg(){return 2}Jfd(){return 2}igg(){return 2}jgg(){return 2}Jne(){return 2}kgg(){return 2}ngg(){return 3}One(){return 2}Pne(){return 2}Qne(){return 2}Rne(){return 2}Wne(){return 2}Tne(){return 2}static IVa(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static SLf(b){if(!b||""===b)return-1;const h=F.a.xh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static xBi(b){const h=Zj.SLf(b);return-1===h?(v.ULS.sendTraceTag(508678240,307,50,`Unhandled unit or blank string , is blankstring => ${!b}`),-1):0>h?(v.ULS.sendTraceTag(508925786,
307,50,"Negative margin in px or pt"),-1):h}static yBi(b){b=Zj.SLf(b);return Tf.a.fK(b)}static tLm(b){return Zj.SLf(b)}static iEi(b){return b&&""!==b?Zj.IVa(b):null}static DE(b){let h=null,r=null,A=null,L=null;b&&b.Ff&&(h=Zj.mU(b.Ff,"id"),r=Zj.mU(b.Ff,"lang"),A=b.Ff.tagName,b.K7k&&(L=Object.assign(new Az,{x:Zj.IVa(b.Ff.style.left),y:Zj.IVa(b.Ff.style.top),left:Zj.iEi(b.Ff.style.left),top:Zj.iEi(b.Ff.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new Nu.a(new Dq(h,A),b.kD,null,r,L)}static mU(b,
h){return b[h]}}Object(u.a)(Zj,"AHtmlTranslator",null,[229]);class Nz extends Nu.a{constructor(b,h,r,A=0,L=0,Z=null){super(Z?Z.Tba:null,Z?Z.kD:null,Z?Z.LCa:null,Z?Z.cultureName:null,Z?Z.qHa:null);this.width=A;this.height=L}}Object(u.a)(Nz,"AugmentationSemanticArgs",Nu.a,[]);var jJ=d(1286);class kJ{constructor(){this.stop=this.color=null}}Object(u.a)(kJ,"ColorStopPair",null,[]);var Eq=d(2032);class WA{constructor(){this.direction=null;this.RVc=new Iy.a}QMi(){return!!this.direction&&0<this.direction.length}}
Object(u.a)(WA,"LinearGradient",null,[]);class Sx{constructor(){this.ync=!1}}Object(u.a)(Sx,"HtmlTranslatorContext",null,[]);var lJ=d(1899);class mJ{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(u.a)(mJ,"IndentationProperties",null,[]);var Uq=d(1283);class Ly extends Nu.a{constructor(b,h,r,A,L=null,Z=0,oa=null,Ba=null,gb=!1,Ab=!1,Jb=69905,Tb=null){super(Tb?Tb.Tba:null,Tb?Tb.kD:null,Tb?Tb.LCa:null,Tb?Tb.cultureName:null,Tb?Tb.qHa:null);this.colSpan=b;this.rowSpan=h;this.width=r;this.Uoc=
Ab;this.height=A;this.jab=gb;this.shadingColor=L;this.verticalAlignment=Z;this.Jna=oa;this.sBe=Ba;this.W$=Jb}}Object(u.a)(Ly,"TableCellSemanticArgs",Nu.a,[]);class ir extends Nu.a{constructor(b,h=null){super(h?h.Tba:null,h?h.kD:null,h?h.LCa:null,h?h.cultureName:null,h?h.qHa:null);this.height=b}}Object(u.a)(ir,"TableRowSemanticArgs",Nu.a,[]);class XA extends Nu.a{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab=null,Jb=-1,Tb=null){super(Tb?Tb.Tba:null,Tb?Tb.kD:null,Tb?Tb.LCa:null,Tb?Tb.cultureName:null,Tb?Tb.qHa:
null);this.UVd=null;this.rowCount=b;this.tnb=h;this.width=r;if(L)for(this.UVd=Array(L.length),b=0;b<L.length;++b)this.UVd[b]=L[b];this.wWf=Z;this.yFg=Ba;this.cgn=oa;this.jab=A;this.$ae=gb;this.styleId=Ab;this.tableLook=Jb}}Object(u.a)(XA,"TableSemanticArgs",Nu.a,[]);var Hv=d(1296);let My;class Hk extends Zj{constructor(b,h,r=new Sx,A=null,L=null){super(b);this.settings=h;this.context=r;this.Fbd=A;this.Rrb=L;this.QFb=null;this.UDk=mb.a.V8("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,
"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.P6i=0;this.qBn=new Set(["LI","OL","UL","MENU"]);this.BXo=new Set("DIV P H1 H2 H3 H4 H5 H6".split(" "))}get Y6i(){return this.UDk}eBi(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.Y6i[F.a.xh(r)])||(r=Zj.mU(b,"type"))&&""!==r&&(r=this.Y6i[r]))return r;if((r=b.tagName.toLowerCase())&&
("ol"===r||"ul"===r)&&(b=b.className))if("ul"===r)switch(b=Hk.k9d(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=Hk.k9d(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}WAi(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===r||"ul"===r){b=Je.a.Nxi(b,"li");
if(!b)return h;r="li"}if("li"===r){h=(h=this.C4d(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=Je.a.Nxi(b,"p"))return Hk.Pym(b)-1}return h}C4d(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}k0n(){this.QFb.pop();this.jj.yCa()}v5c(b,h){this.mw(L=>L.nha(0,0));const r=this.eBi(b.Ff,h?6:2);let A=1;h&&(A=this.C4d(b.Ff,"start",1));h=!1;h=b.Ff.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.Ff.removeAttribute("data-pasteFromRc");(aa.a.B7||aa.a.nj)&&Hk.xVd(b.Ff);this.F3o(b)&&
this.pYd();b=new Uq.a(r,A,Zj.DE(b),this.P6i,-1,h);this.QFb.push(b);this.jj.ACa(b);this.gK(Object(D.a)(this,this.k0n,"onListElementClose"));return 1}F3o(b){var h,r;return Ok.a.aZf?(b=null===(r=null===(h=b.Ff)||void 0===h?void 0:h.parentElement)||void 0===r?void 0:r.tagName)&&this.qBn.has(b)?!1:!0:!1}pYd(){this.P6i=Date.now()}JKl(b,h,r){return(h=h.getAttribute(r))?b.ltf(h):!1}reset(){super.reset();this.QFb=new Ky}RNj(b,h){if(Ok.a.Etb){let r=!1;Cq.a.instance.le(()=>{r=this.SNj(b,h)},"DHT:SFFA");return r}return this.SNj(b,
h)}SNj(b,h){var r,A,L,Z,oa,Ba,gb;let Ab=!1;try{var Jb=h.getAttribute("xml:lang")||Zj.mU(h,"lang")}catch(Hc){Jb=null}Jb&&""!==Jb&&(Ab=b.syg(Jb)||Ab);(Jb=Zj.mU(h,"dir"))&&(Ab=b.dxc(Jb)||Ab);if(this.settings.N3o(this.context)&&h.getAttribute)for(Jb=0;Jb<Hk.FYj.length;Jb++)Ab=this.JKl(b,h,Hk.FYj[Jb])||Ab;Jb=h.style;const Tb=window.performance.now();var jc;Ok.a.Yla?jc=null===(r=this.Rrb)||void 0===r?void 0:r.Tmi(h):Ok.a.zoc&&(jc=getComputedStyle(h));Hv.a.SCe+=window.performance.now()-Tb;Hv.a.Eke+=1;Ok.a.qgk&&
(Jb=getComputedStyle(h));if(Jb){if(Jb.fontWeight||h instanceof HTMLHeadingElement&&Ok.a.Tde&&Ok.a.Yla)r=F.a.tC(null!==(A=null===jc||void 0===jc?void 0:jc.fontWeight)&&void 0!==A?A:Jb.fontWeight),A=parseInt(r),isNaN(A)?"BOLD"===r?Ab=b.HN(!0)||Ab:"NORMAL"===r&&(Ab=b.HN(!1)||Ab):Ab=600<=A?b.HN(!0)||Ab:b.HN(!1)||Ab;if(this.settings.pSj&&Jb.fontSize||h instanceof HTMLHeadingElement&&Ok.a.Tde&&Ok.a.Yla)A=null!==(L=null===jc||void 0===jc?void 0:jc.fontSize)&&void 0!==L?L:Jb.fontSize,L=Zj.tLm(A),0<L&&(Ab=
b.Uwe(Math.floor(2*L))||Ab);this.C2o(h)&&(L=Zj.xBi(null!==(Z=null===jc||void 0===jc?void 0:jc.marginTop)&&void 0!==Z?Z:Jb.marginTop),Z=Zj.xBi(null!==(oa=null===jc||void 0===jc?void 0:jc.marginBottom)&&void 0!==oa?oa:Jb.marginBottom),-1!==L||-1!==Z)&&(Ab=b.nha(L,Z)||Ab);Ok.a.W_i&&this.vWf(h)&&(oa=Zj.yBi(null!==(Ba=null===jc||void 0===jc?void 0:jc.marginLeft)&&void 0!==Ba?Ba:Jb.marginLeft),Ba=Zj.yBi(null!==(gb=null===jc||void 0===jc?void 0:jc.marginRight)&&void 0!==gb?gb:Jb.marginRight),oa||Ba)&&(Ab=
b.Myg(oa,Ba)||Ab);this.settings.R3o(this.context)&&(this.settings.tSj&&h.getAttribute?(gb=h.getAttribute("data-indent"))&&0<gb.length&&(gb=nh.a.Mj(parseInt(gb),0)+"px",Ab=b.Sxe(gb)||Ab):Jb.textIndent&&(Ab=b.Sxe(Jb.textIndent)||Ab));this.settings.M3o(this.context)&&Jb.marginLeft&&(this.settings.tSj&&h.getAttribute?(gb=h.getAttribute("data-margin"))&&0<gb.length&&(Ab=b.sna(Jb.marginLeft)||Ab):"TABLE"!==h.tagName&&(Ab=b.sna(Jb.marginLeft)||Ab));if(this.settings.P3o(this.context)&&(gb=h.getAttribute("style"))&&
""!==gb)for(gb=gb.split(";"),Ba=0;Ba<gb.length;Ba++)jc=gb[Ba].trim(),jc.startsWith("tab-stops")&&(Ab=b.jzg(jc.replace("tab-stops:",""))||Ab);this.settings.L3o(this.context)&&Jb.lineHeight&&(Ab=b.UE(Jb.lineHeight)||Ab);this.settings.I3o&&(gb=Jb.textTransform?F.a.xh(Jb.textTransform):null,Ba=Jb,Ba=Ba.fontVariantCaps?F.a.xh(Ba.fontVariantCaps):null,jc=Jb.fontVariant?F.a.xh(Jb.fontVariant):null,"uppercase"===gb?Ab=b.tod("uppercase")||Ab:"small-caps"===Ba||jc&&0<=jc.indexOf("small-caps")?Ab=b.tod("small-caps")||
Ab:this.settings.Eml&&"none"===gb&&(Ab=b.tod("none")||Ab));this.settings.Q3o(this.context)&&Jb.textAlign&&(Ab=b.W_b(F.a.xh(Jb.textAlign))||Ab);Jb.fontStyle&&(gb=F.a.tC(Jb.fontStyle),"ITALIC"===gb||"OBLIQUE"===gb?Ab=b.ryb(!0)||Ab:"NORMAL"===gb&&(Ab=b.ryb(!1)||Ab));gb=Hk.uOm(h);if(Jb.textDecoration||gb)Ba=F.a.xh(Jb.textDecoration||""),gb=F.a.xh(gb||""),h.parentNode&&h.parentNode.tagName&&"a"===F.a.xh(h.parentNode.tagName)?(jc=(h.querySelector(".TextRun")||h).className)&&-1<jc.indexOf("Underlined")&&
(Ab=b.C8(!0)||Ab):Jb.Uoq||Hk.isUnderline(Ba)||Hk.isUnderline(gb)?Ab=b.C8(!0)||Ab:this.settings.zTj&&(Ab=b.C8(!1)||Ab),Jb.Toq||Hk.uZi(Ba)||Hk.uZi(gb)?Ab=b.una(!0)||Ab:this.settings.zTj&&(Ab=b.una(!1)||Ab);if(Jb.verticalAlign){gb=F.a.tC(Jb.verticalAlign);Ba=this.zpo(gb);if("SUB"===gb||this.settings.sSj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>Ba&&this.settings.ZSj)Ab=b.NNa(!0)||Ab;else if("SUPER"===gb||this.settings.sSj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||
0<Ba&&this.settings.ZSj)Ab=b.hva(!0)||Ab;this.settings.pSj&&("SUB"===gb||"SUPER"===gb)&&h.getAttribute&&(gb=parseFloat(h.getAttribute("data-fontsize")),isNaN(gb)||(Ab=b.Uwe(Math.floor(2*gb))||Ab))}gb=!1;y.AFrameworkApplication.J&&(gb=y.AFrameworkApplication.J.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.K3o&&Jb.fontFamily&&(this.settings.T3o&&h.getAttribute?(Ba=h.getAttribute("data-usefontface"))&&"true"===Ba&&(gb&&v.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),Ab=this.PNj(b,
Jb.fontFamily,Ab)):Ab=this.PNj(b,Jb.fontFamily,Ab));Ba=null;this.settings.J3o&&Jb.color&&(Ba=Eq.a.nra(Jb.color));jc=!!Ba;this.settings.S3o(this.context)&&h.getAttribute&&(Ba=h.getAttribute("data-scheme-color"),Ba=null!==Ba?Ba:"",jc=""!==Ba||!this.context.ync||Hk.oun(h));jc&&(Ab=b.hx(Ba)||Ab);!this.settings.G3o||!Jb.backgroundColor||h.tagName&&Hk.Jip.contains(F.a.tC(h.tagName))||(Ba=Jb.backgroundColor,Ab=Ok.a.qgn&&this.vWf(h)?b.wca(Eq.a.nra(Ba))||Ab:b.NDa(Eq.a.nra(Ba))||Ab);if(this.settings.H3o&&Jb.backgroundImage&&
h.className&&-1<h.className.indexOf("Highlight")&&(Jb=Hk.hRm(Jb.backgroundImage))&&0<Jb.RVc.count){Ba=Jb.RVc.K(0).color;jc=!0;for(oa=0;oa<Jb.RVc.count&&(jc=jc&&Ba===Jb.RVc.K(oa).color,jc);oa++);jc&&(gb&&v.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),Ab=b.NDa(Eq.a.nra(Ba))||Ab)}}this.settings.rSj(this.context)&&h.getAttribute&&(Jb=h.getAttribute("data-ccp-props"))&&(Ab=b.vca(Jb)||Ab);h.getAttribute&&((Jb=h.getAttribute("data-ccp-charstyle"))&&this.settings.Pyb&&(Ab=b.und(Jb)||Ab),
(Jb=h.getAttribute("data-ccp-parastyle"))&&this.settings.Pyb&&(Ab=b.bod(Jb)||Ab));return Ab=this.i_o(b,h.className)||Ab}C2o(b){const h=Ok.a.Ipn&&this.vWf(b);return b instanceof HTMLHeadingElement?h&&Ok.a.Tde&&Ok.a.Yla:h}vWf(b){const h=this.BXo.has(b.tagName);return Ok.a.SWi?h&&"inline"!==b.style.display:h}i_o(b,h){if(!F.a.Qf(h)&&Ok.a.ntn){var r=this.pEm(h);if(r)return b.bod(r);if(h=this.nlm(h))return b.und(h)}}pEm(b){switch(b){case "MsoTitle":return"Title";case "MsoSubtitle":return"Subtitle";case "MsoNoSpacing":return"No Spacing";
case "MsoQuote":return"Quote";case "MsoIntenseQuote":return"Intense Quote";default:return null}}nlm(b){switch(b){case "TitleChar":return"Title Char";case "SubtitleChar":return"Subtitle Char";case "QuoteChar":return"Quote Char";case "IntenseQuoteChar":return"Intense Quote Char";case "MsoSubtleReference":return"Subtle Reference";case "MsoIntenseReference":return"Intense Reference";case "MsoListParagraph":return"List Paragraph";case "MsoBookTitle":return"Book Title";default:return null}}T5o(b){if(this.settings.U5o)for(b=
b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.tC(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.tC(b.tagName))break;b=b.parentNode}return!1}PNj(b,h,r){h=Hk.khm(h);let A=!1,L=0;if(!h)return r;for(const Z of h){if(A=b.Mdb(Z,this.settings.sgp))break;L++}1<h.length&&(A?v.ULS.sendTraceTag(508889217,307,50,"Secondary font matched from font-family at : {0} out of {1}",L+1,h.length):v.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",
h.length));return A||r}zpo(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}yga(b,h){"\u200b"===b&&(b="\u00a0");h&&h.Ff&&this.T5o(h.Ff)&&(b="");this.jj.yga(b,Zj.DE(h))}lle(b){const h=Zj.mU(b.Ff,"href");return h&&""!==h?(this.jj.oYa(h,Zj.DE(b)),this.gK(Object(D.a)(this.jj,this.jj.nYa,"onAnchorEnd")),1):2}sle(){return this.mw(b=>b.HN(!0))?1:2}vle(){return this.mw(b=>b.tQf())?1:2}wle(b){this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}xle(b){this.jj.Kba(Zj.DE(b))}zle(b){this.jj.xE(Zj.DE(b));
this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Dle(){return this.mw(b=>b.ryb(!0))?1:2}Ale(b){this.mw(h=>h.W_b("center"));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Ele(){return this.mw(b=>b.Mdb("consolas"))?1:2}Nle(){return this.mw(b=>b.una(!0))?1:2}Mle(b){return this.v5c(b,!1)}Qle(){return this.mw(b=>b.ryb(!0))?1:2}Rle(b){return this.v5c(b,!1)}Tle(b){var h=b.Ff.getAttribute("data-render-src");const r=b.Ff.getAttribute("data-render-method");
if(h&&""!==h&&r&&""!==r){const oa=b.Ff.getAttribute("data-render-fallback");let Ba=0,gb=0;if(b.Ff.currentStyle){var A=b.Ff.currentStyle.width,L=b.Ff.currentStyle.height;A&&-1!==A.indexOf("px")&&(A=parseInt(F.a.substring(A,0,A.indexOf("px"))),isNaN(A)||(Ba=A));L&&-1!==L.indexOf("px")&&(L=parseInt(F.a.substring(L,0,L.indexOf("px"))),isNaN(L)||(gb=L))}b=new Nz(h,r,oa,Ba,gb,Zj.DE(b));this.jj.Xbb(b);return 2}(aa.a.B7||aa.a.nj)&&(h=b.Ff.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Hk.xVd(b.Ff);
const Z=b.Ff.getAttribute("align");h=this.mw(oa=>oa.W_b(Z));if(!this.Uyb(b))return h?1:2;this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Ule(b){this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Vle(b){this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Xle(){return this.mw(b=>b.ryb(!0))?1:2}fme(b){return this.mw(h=>{var r=Hk.Etm(b.Ff.getAttribute("face"));r=h.Mdb(r);h=h.hx(Eq.a.nra(b.Ff.getAttribute("color")));
return r||h})?1:2}ime(b){if(!this.Uyb(b))return 2;this.mw(h=>this.settings.Pyb?h.uyb(1):h.wyb(1));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Uyb(b){var h;return"inline"===(null===(h=b.Ff)||void 0===h?void 0:h.style.display)&&Ok.a.SWi?!1:!0}jme(b){if(!this.Uyb(b))return 2;this.mw(h=>this.settings.Pyb?h.uyb(2):h.wyb(2));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}kme(b){if(!this.Uyb(b))return 2;this.mw(h=>this.settings.Pyb?
h.uyb(3):h.wyb(3));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}lme(b){if(!this.Uyb(b))return 2;this.mw(h=>this.settings.Pyb?h.uyb(4):h.wyb(4));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}mme(b){if(!this.Uyb(b))return 2;this.mw(h=>this.settings.Pyb?h.uyb(5):h.wyb(5));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}nme(b){if(!this.Uyb(b))return 2;this.mw(h=>this.settings.Pyb?
h.uyb(6):h.wyb(6));this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}ome(b){this.jj.Kba(Zj.DE(b))}tme(b){var h=b.Ff;const r=h.src,A=h.alt,L=h.u8p,Z=h.getAttribute("data-external-content-url");let oa=0,Ba=0;h.style&&(oa=Zj.IVa(h.style.width),Ba=Zj.IVa(h.style.height));oa&&Ba||(oa=h.width,Ba=h.height);let gb=0,Ab=0;b.Ff.currentStyle&&(oa||Ba||(oa=Zj.IVa(b.Ff.currentStyle.width),Ba=Zj.IVa(b.Ff.currentStyle.height)),gb=Zj.IVa(b.Ff.currentStyle.maxWidth),Ab=Zj.IVa(b.Ff.currentStyle.maxHeight));
!Ok.a.Tln||oa&&Ba||(Ba=oa=0);let Jb=null;const Tb=h.getAttribute(Hl.jZd);if(Tb&&(v.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ChartsPasteFromXLOIsEnabled"))){const jc=h.getAttribute(Hl.Fuf),Hc=h.getAttribute(Hl.Guf),hd=h.getAttribute(Hl.Duf),Gd=h.getAttribute(Hl.Euf),de=h.getAttribute(Hl.jYc);h=h.getAttribute(Hl.Huf);jc&&Gd&&(Jb=new jJ.a(Tb,jc,Hc,hd,Gd,de,h))}b=new lJ.a(r,A,oa,Ba,Zj.DE(b),gb,Ab,L,null,Z,Jb);this.jj.wCa(b)}pme(){return this.mw(b=>
b.ryb(!0))?1:2}ume(){return this.mw(b=>b.C8(!0))?1:2}xme(){return this.mw(b=>b.Mdb("consolas"))?1:2}zme(b){this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Bme(b){this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Cme(b){let h;if(this.r6o(b.Ff))return this.dIl(b),1;const r=this.eBi(b.Ff,0);let A=this.C4d(b.Ff,"value",0);0<this.QFb.count?h=this.QFb.$U():(h=new Uq.a(2,1,Zj.DE(b)),A||(A=1));var L=Hk.Zym(b.Ff,Uq.a.J4j);3!==L&&
(h.at=L);L=h.listLevel;let Z=h.listId;this.settings.qSj?(L=this.WAi(b.Ff),L=0>L&&0>h.listLevel&&0<this.QFb.count?h.listLevel=this.QFb.count-1:h.listLevel=0<=L?L:h.listLevel,this.Fbd&&this.Fbd.b<L&&(this.Fbd.b=L)):0>L&&(L=h.listLevel=this.WAi(b.Ff));1>Z&&(Z=h.listId=this.C4d(b.Ff,Uq.a.ybd,0));b.Ff.getAttribute(Uq.a.Bbd)&&(h.levelText=b.Ff.getAttribute(Uq.a.Bbd));var oa=b.Ff.getAttribute(Uq.a.l3f);oa&&(h.font=oa);oa=!1;y.AFrameworkApplication.J&&(oa=y.AFrameworkApplication.J.$("FollowDestinationThemePasteIsEnabled"));
if(oa){var Ba=b.Ff.getAttribute("data-charcodes");oa=[];if(Ba&&""!==Ba)if(-1<Ba.indexOf(",")){Ba=Ba.split(",");for(var gb=0;gb<Ba.length;gb++)oa.push(parseInt(Ba[gb]))}else oa.push(parseInt(Ba));if(oa&&0<oa.length){Ba=Array(oa.length);for(gb=0;gb<oa.length;gb++)Ba[gb]=oa[gb];h.nnf=Ba}(oa=b.Ff.getAttribute("data-buAutoNum"))&&0<oa.length&&(h.buAutoNum=parseInt(oa))}(L=0<=L&&0<Z)&&Hk.xVd(b.Ff);h.L8k(r,A,L);h.j3f=this.Eym(b.Ff);this.jj.uMa(h.clone());this.gK(Object(D.a)(this.jj,this.jj.zCa,"onListItemEnd"));
return 1}Eym(b){var h=b.getAttribute(Uq.a.I6i);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{v.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new lj.DictionaryPropertySet;for(const r in b)h.Dzg(+r,b[r]);return h}onMenuOpen(b){return this.v5c(b,!1)}Eme(b){if(this.mw(h=>h.Uwc(!0))){const h=b.Ff.getAttribute("OuterHtml");this.jj.tYa(h,Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.Sbb,
"onMathEnd"))}return 1}Pme(b){return this.v5c(b,!0)}Rme(b){this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}Vme(b){const h=b.Ff.getAttribute("align");this.mw(A=>A.W_b(h));const r=b.Ff.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&Hk.xVd(b.Ff,aa.a.B7||aa.a.nj);if(!this.Uyb(b))return 2;this.jj.xE(Zj.DE(b));this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"));return 1}cne(){this.mw(b=>b.Mdb("consolas"));this.jj.bwb();this.gK(Object(D.a)(this.jj,this.jj.awb,
"onPreFormattedTextEnd"));return 1}kne(){return this.mw(b=>b.una(!0))?1:2}lne(){return this.mw(b=>b.Mdb("consolas"))?1:2}wne(){return this.mw(b=>b.ACg())?1:2}xne(b){var h=b.Ff.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=Eq.a.hao(r);if(0<h&&this.settings.y$m){for(r=0;r<h;r++)this.jj.fwb(Zj.DE(b));return 3}return 2}Ane(){return this.mw(b=>b.una(!0))?1:2}Bne(){return this.mw(b=>b.HN(!0))?1:2}Cne(){return this.mw(b=>b.NNa(!0))?1:2}Ene(){return this.mw(b=>b.hva(!0))?1:2}Gne(b){this.mw(Jb=>
Jb.fE()&&Jb.ttg());Eq.a.V9d(b.Ff,this);const h=Eq.a.IJi(b.Ff),r=Eq.a.hui(b.Ff),A=Eq.a.gN(b.Ff),L=Eq.a.hN(b.Ff),Z=!parseInt(Zj.mU(b.Ff,"border")),oa=Eq.a.Otn(b.Ff);let Ba=-1,gb="";var Ab=-1;b.Ff.attributes.hasOwnProperty("style")&&-1!==(Ab=b.Ff.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ba=parseInt(b.Ff.attributes.getNamedItem("style").value.substr(Ab+17)):b.Ff.attributes.hasOwnProperty(Rx.a.kZd.toString())&&(Ba=parseInt(b.Ff.attributes.getNamedItem(Rx.a.kZd.toString()).value));
Ab=-1;b.Ff.attributes.hasOwnProperty("class")&&-1!==(Ab=b.Ff.attributes.getNamedItem("class").value.indexOf("Mso"))?gb=b.Ff.attributes.getNamedItem("class").value.substr(Ab).split(" ")[0]:b.Ff.attributes.hasOwnProperty(Rx.a.kYc.toString())&&(gb=b.Ff.attributes.getNamedItem(Rx.a.kYc.toString()).value);this.jj.Qba(new XA(0,0,h.value,h.Y0i,null,Z,oa,r,new mJ(A.value,L.value),gb,Ba,Zj.DE(b)));this.gK(Object(D.a)(this.jj,this.jj.Oba,"onTableEnd"));return 1}Jfd(b){const h=Eq.a.Yyi(b.Ff),r=Eq.a.IJi(b.Ff);
if(!r.value&&r.Jde&&this.settings.Srj)return 3;let A=parseInt(Zj.mU(b.Ff,"colSpan"));if(void 0===A||null===A||""===A+"")A=r.value?1:0;let L=parseInt(Zj.mU(b.Ff,"rowSpan"));if(void 0===L||null===L||""===L+"")L=h.value?1:0;let Z=!1;b.Ff.attributes.hasOwnProperty("style")&&(Z=-1!==b.Ff.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.Ff.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!Z&&b.Ff.attributes.hasOwnProperty("class")&&(Z=
-1!==b.Ff.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let oa=69905;if(b.Ff.attributes.hasOwnProperty(Rx.a.Cuf.toString())){var Ba=parseInt(b.Ff.attributes.getNamedItem(Rx.a.Cuf.toString()).value);isNaN(Ba)||(oa=Ba)}Ba=Eq.a.nra(b.Ff.style.backgroundColor);const gb=Eq.a.mRm(b.Ff);this.mw(Tb=>Tb.nha(0,0));Eq.a.V9d(b.Ff,this);const Ab=Eq.a.hui(b.Ff),Jb=this.settings.Tao?Eq.a.Tkm(b.Ff):null;b=new Ly(A,L,r.value,h.value,Ba,gb,Ab,Jb,r.Y0i,Z,oa,Zj.DE(b));this.jj.Nba(b);this.gK(Object(D.a)(this.jj,
this.jj.Mba,"onTableCellEnd"));this.ITn();return 1}Jne(b){const h=this.Jfd(b);if(3===h)return h;this.mw(r=>{const A=r.HN(!0);r=r.W_b("center");return A||r});Eq.a.V9d(b.Ff,this);return 1}One(b){Eq.a.V9d(b.Ff,this);const h=Eq.a.Yyi(b.Ff);if(h.Jde&&!h.value&&this.settings.Srj)return 3;this.jj.d8(new ir(h.value,Zj.DE(b)));this.gK(Object(D.a)(this.jj,this.jj.Pba,"onTableRowEnd"));return 1}Pne(){return this.mw(b=>b.Mdb("consolas"))?1:2}Qne(){return this.mw(b=>b.C8(!0))?1:2}Rne(b){return this.v5c(b,!1)}Tne(){return 2}Wne(){return this.mw(b=>
b.C8(!0))?1:2}static Zqm(b){if(!b)return null;b=b.split(",");1<b.length&&v.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static ihm(b){return b?b.split(","):null}static X2j(b){if(!b)return null;b=F.a.prg(b.trim(),'"');return b=F.a.prg(b,"'")}static Etm(b){if(!b)return null;b=Hk.Zqm(b);return b=Hk.X2j(b)}static khm(b){var h;if(!b)return null;b=null===(h=Hk.ihm(b))||void 0===h?void 0:h.map(r=>Hk.X2j(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==
h&&void 0!==h?h:null}static qOh(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.QMi())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<r.length){if(b.QMi())return!1;b.direction=h;return!0}var A=(r=h.match(RegExp("^rgb\\(.*\\)")))&&0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===A?h:Eq.a.nra(h.substr(0,A).trim());if(!r||""===r)return!1;h=-1===A?"":h.substr(A).trim();A=new kJ;A.color=r;
A.stop=h;b.RVc.add(A);return!0}static hRm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new WA;for(;0<h.trim().length;){let A=h.indexOf(",");const L=h.indexOf("(");if(0<L&&L<A){const Z=h.indexOf(")");if(Z<L)return null;A=h.indexOf(",",Z)}if(-1===A){if(!Hk.qOh(r,h))return null;h=""}else{const Z=h.substr(0,A);h=h.substr(A+1);if(!Hk.qOh(r,Z))return null}}return r}catch(h){return null}}static k9d(b,
h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static xVd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Hk.u2h(b,h))}static u2h(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&Hk.u2h(b,h)),b=b.nextSibling}static Pym(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&
"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static Zym(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static oun(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}r6o(b){var h;return Ok.a.qnn&&Ok.a.Yla&&b&&"none"===(null===(h=this.Rrb)||void 0===h?void 0:h.Tmi(b).listStyleType)}dIl(b){this.jj.xE(Zj.DE(b));
this.gK(Object(D.a)(this.jj,this.jj.ZF,"onParagraphEnd"))}static uOm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static uZi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Hk.Jip=(My=new nb.a,My.add("TABLE"),My.add("THEAD"),My.add("TBODY"),My.add("TFOOT"),My.add("TR"),My.add("TH"),My.add("TD"),My);Hk.FYj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(u.a)(Hk,
"DefaultHtmlTranslator",Zj,[]);var Ho=d(1040);class im{constructor(b=null){this.Y5=b||Ho.a.MJi("");this.Nvh=Number.parseInvariant((new Date).format("HHmmss"))}get Nc(){return this.Y5}process(b,h){if(b&&b.querySelectorAll){const Z=b.querySelectorAll("p");if(Z&&0<Z.length){for(var r=0,A=!1,L=Z[0].parentNode;5>r&&L&&L!==b;){r++;const oa=L.id.toLowerCase();if(oa&&oa.length&&-1!==oa.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(L,"WACEditing")&&Sys.UI.DomElement.containsCssClass(L,"EditingSurfaceBody")){A=
!0;break}L=L.parentNode}if(A&&L!==b){r=b.firstChild;for(A=!1;0<L.children.length&&L.children[0]!==r;)b.insertBefore(L.children[0],r),A=!0;if(A)for(;r;)L=r.nextSibling,b.removeChild(r),r=L}b=new Tt.a(h,Object(D.a)(this,this.Fio,"processNodesDiscovery"),new BC(Z));b.nm("Word Converter Operation");b.oi=!h||h.oi;b.run()}}}Fio(b,h){const r=h.nodes[h.lUa];var A=im.Kym(r);if(A){let Z=A.nGe.replace(RegExp("level[0-9]"),"").trim();Z=Z&&Z.length?Z:A.nGe;let oa=h.lists[Z];oa||(oa=new Mz,oa.DAc=this.Nvh++);let Ba=
oa.rqc[A.level-1];Ba||(Ba=new rE,Ba.level=A.level);var L=r.parentNode;if(L&&"li"===L.tagName.toLowerCase()){if(L=L.parentNode)!(L=L.tagName.toUpperCase())||"OL"!==L&&"UL"!==L||(Ba.tagName=L)}else Ba.evb=im.zxi(r,5),Ba.evb&&Ba.evb.length||(Ba.evb=im.qNf(r,5)),Ba.XSf=!Ba.evb||!Ba.evb.length,Ba.tagName=im.yxi(Ba.evb),"UL"===Ba.tagName&&(Ba.font=this.jyi(r,5));A.DAc=oa.DAc;Ba.pUn++;Ba.XSf||"li"===r.parentNode.tagName.toLowerCase()||(L=(L=im.qNf(r,5))?L:Ba.evb)&&L.length&&(A.DBf=L,(L=im.UWo(r,L,Ba.listStyle,
A.level-1))&&L.length&&(Ba.listStyle=L));h.Jub[h.Jub.length]=A;Ba.Jub.contains(A)||Ba.Jub.add(A);if(void 0===oa.rqc[A.level-1]||null===oa.rqc[A.level-1]||oa.rqc[A.level-1]!==Ba)oa.rqc[A.level-1]=Ba;h.lists[Z]&&h.lists[Z]===oa||(h.lists[Z]=oa);h.i5i=r}else if((A=h.i5i)&&im.XHm(r)===A&&r.tagName===A.tagName&&r.className===A.className){A.appendChild(A.ownerDocument.createElement("BR"));for(A.appendChild(A.ownerDocument.createElement("BR"));r.firstChild;)A.appendChild(r.firstChild);r.parentNode.removeChild(r)}h.lUa++;
if(h.nodes.length<=h.lUa){if(!h.Jub.length)return!1;h.lUa=0;b.Ni(Object(D.a)(this,this.Eio,"processNodeConvert"))}return!0}Eio(b,h){var r;b=h.Jub[h.lUa];var A=b.y7n,L=b.nGe.replace(RegExp("level[0-9]"),"").trim();L=L&&L.length?L:b.nGe;L=h.lists[L];const Z=L.rqc[b.level-1];var oa=A.parentNode.tagName.toLowerCase();if(!Z.XSf&&A.parentNode&&"li"!==oa){if(oa=im.tHl(A,Z)){im.f2h(A,5);const Ba=A.ownerDocument.createElement("LI");Ba.setAttribute("data-aria-level",String.format("{0}",b.level));Ba.setAttribute(Uq.a.ybd,
String.format("{0}",L.DAc));if("UL"===Z.tagName)Ba.setAttribute(Uq.a.Bbd,String.format("{0}",b.DBf)),Ba.setAttribute(Uq.a.l3f,String.format("{0}",Z.font));else if("OL"===Z.tagName&&Ok.a.rgk){L=RegExp("[0-9]+|[a-zA-Z]+");const gb=null===(r=b.DBf)||void 0===r?void 0:r.replace(L,"%"+b.level);Ba.setAttribute(Uq.a.Bbd,String.format("{0}",gb));v.ULS.sendTraceTag(508101642,307,50,"Passed level text information")}for(;A.firstChild;)Ba.appendChild(A.firstChild);oa.appendChild(Ba);A.parentNode.removeChild(A);
"UL"===Z.tagName?this.Nc.b++:this.Nc.c++}}else"li"===oa&&(r=Z.tagName,A=A.parentNode,b.xtc&&(b=A.parentNode)&&b.tagName.toUpperCase()===r&&b.setAttribute("data-pasteFromRc","true"),A.setAttribute(Uq.a.ybd,String.format("{0}",L.DAc)),"UL"===r?this.Nc.b++:this.Nc.c++);h.lUa++;return h.lUa<h.Jub.length}jyi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const L=b.childNodes[A];r=im.Ftm(L);!r&&1===L.nodeType&&1<h&&(r=this.jyi(L,h-1))}return r}static tHl(b,h){b=im.sHl(b,h.tagName);return im.JBl(b,
h)}static JBl(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static sHl(b,h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));Ok.a.pgn&&(r=b.getAttribute("align")||b.style.textAlign)&&(h.style.textAlign=r);(r=b.className)&&0<r.length&&(r="OL"===h.tagName?Hk.k9d(r,
"NumberListStyle"):Hk.k9d(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static f2h(b,h){for(let r=0;r<b.childNodes.length;r++){const A=b.childNodes[r];1===A.nodeType&&1<h&&im.f2h(A,h-1);if(im.Cjn(A)||im.FYi(A))b.removeChild(A),r--}}static Kym(b){if(1===b.nodeType){var h=im.kNf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const A=Number.parseInvariant(r[1].substr(5)),L=new Hy(A,
h,b);L.xtc=!0;return L}}catch(A){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+$c.a.wif),r=r.getAttribute(Uq.a.ybd),h&&r&&0<h.length&&0<r.length))return b=new Hy(Number.parseInvariant(h),r+" level"+h,b),b.xtc=!1,b}return null}static UWo(b,h,r,A){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===im.yxi(h))return r=im.ikm(h),Sys.UI.DomElement.addCssClass(b,r),r;var L=h.match(RegExp("^[0-9]+"));return L&&L.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,
r),b.setAttribute("start",L[0]),r):(L=h.match(RegExp("^[a-zA-Z]+")))&&L.length&&(L=L[0],A=(h=L.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?im.$Im(r,A):1,1!==A&&((r=im.rXd(b,L,RegExp("^[ivxlcdm]+"),F.a.A7h,"NumberListStyle3"))||(r=im.rXd(b,L,RegExp("^[IVXLCDM]+"),F.a.A7h,"NumberListStyle5")))||A&&((r=im.rXd(b,L,RegExp("^[a-z]+"),F.a.y7h,"NumberListStyle2"))||(r=im.rXd(b,L,RegExp("^[A-Z]+"),F.a.y7h,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static ikm(b){switch(b){case "o":return"BulletListStyle2";
case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static $Im(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static rXd(b,h,r,A,L){return(h=h.match(r))&&h.length?(A=A(h[0]),A=1>A?1:A,Sys.UI.DomElement.addCssClass(b,L),b.setAttribute("start",A+""),L):null}static yxi(b){return im.mgn(b)?
"UL":"OL"}static mgn(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static qNf(b,h){let r=null;var A;let L,Z;for(let oa=-1;!r&&oa<b.childNodes.length;oa++){const Ba=-1===oa?b:b.childNodes[oa];if(Ba)if((A=Ba.innerHTML)&&0<A.length){if(L=A.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=L&&(Z=A.indexOf("\x3c!--[endif]--\x3e"),0<=Z)){A=A.substring(L,Z+14);Ba.innerHTML=Ba.innerHTML.replace(A,"");if(A.length){b=b.ownerDocument.createElement("span");
b.innerHTML=A;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=oa&&1===Ba.nodeType&&1<h&&(r=im.qNf(Ba,h-1))}return r}static Ftm(b){let h=null;1===b.nodeType&&((h=im.iyi(b,"font-family"))||(h=im.iyi(b,"mso-ascii-font-family")));return h}static iyi(b,h){return(b=im.kNf(b,h))&&0<b.length?b.trim():null}static zxi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const L=b.childNodes[A];im.FYi(L)?(r="string"===typeof L.innerText?L.innerText.trim():L.textContent.trim(),r.length||(r="o"),
L.parentNode.removeChild(L)):1===L.nodeType&&1<h&&(r=im.zxi(L,h-1))}return r}static FYi(b){return 1===b.nodeType&&(b=im.kNf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Cjn(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static kNf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const A=b[r].split(":");if(2===A.length&&A[0].trim()===h)return A[1].trim()}}return null}static XHm(b){do b=
b.previousSibling;while(b&&im.rXi(b));return b}static rXi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(im.NDk,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:im.rXi(b.firstChild):!0}}im.NDk=RegExp("[\n|\r]","gi");Object(u.a)(im,"WacAndRichClientWordConverter",null,[224]);class at{constructor(){}create(b=null){return new im(b)}}Object(u.a)(at,"Box4WordConverterFactory",null,[708]);var wj=d(1897),vt=d(45),pG=d(270),mp=d(1284),wr=d(543),
bx=d(308),YA=d(1340),yw=d(1089);class xr{constructor(b,h,r,A,L,Z=null,oa="",Ba=!0,gb=!1){this.DJa=this.oAe=this.Jxb=this.uwj=this.jue=null;this.v9c=!1;this.MKa=null;this.Xbg=0;this.$Be=null;this.context=b;this.ge=b.view;this.yx=h;this.rd=L;this.UU=r;this.ica=A;this.GDa=this.TB=!1;this.poe=null;this.K$a=this.uoc=!1;this.nap=xr.Wqf(b);this.browserName=oa;this.k$j=Ba;this.dad=gb;this.x0a=!1;this.lfc=0;if(b=Object(Gb.a)(73,L)?L:null){this.uwj=new lj.DictionaryPropertySet;this.uwj.zt(b);r=b.ka(Od.a.Ngd,
Q.a.nil);this.GVc=r!=Q.a.nil?r.toString():Q.a.create().toString();if(b.ka(Od.a.msj,!1)){this.uoc=!0;this.K$a=b.ka(Od.a.K$a,!1);this.poe=Z;for(Z=this.ge.lb.Pg;Z.Ww;)Z=Z.getContext(0);if(L=Object(Ca.a)(On.AParagraphNode,Z.node)){r=0;A=Cd.ParagraphReader.textLength(L);switch(Z.contextId){case kc.a.Cd:r=Z.cpBegin;A=Z.cpEnd;break;case kc.a.Zc:r=A}this.jue=Ya.FormattingReader.a6d(Z.node,r,Z.Fb);v.ULS.shipAssertTag(6305503,307,!!this.jue);L=Ic.a.Ojc(L);for(const Ab of L)Ab.cpEnd<=r||Ab.cpBegin>=A||xr.Op.fV(Z.node,
Ab.hyperlink)}}this.GDa=b.ka(Od.a.GDa,!1);this.x0a=b.ka(Od.a.x0a,!1);this.Jxb=b.ka(Od.a.Jxb,null)}else this.GVc=Q.a.create().toString();h&64&&(this.GDa=!0)}static get Op(){return null!=xr.bXg?xr.bXg:xr.bXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static Wqf(b){if(b){if(b.Ww){for(let h=0;h<b.length;h++)if(xr.Wqf(b.getContext(h)))return!0;return!1}if(Object(Gb.a)(wr.a,b))return xr.Wqf(b.Lk);if(Cd.ParagraphReader.Wb(b.node)&&b.node.YQ)return!0}return!1}}Object(u.a)(xr,"ClipboardActionArguments",
null,[]);var Oz;(function(b){b[b.paste=1]="paste";b[b.Xoq=2]="textOnly";b[b.iqj=4]="overtype";b[b.iE=16]="copy";b[b.XYp=32]="deleteSelection";b[b.move=64]="move";b[b.Uqq=256]="useSystemClipboard";b[b.j2p=512]="forceInternalClipboard";b[b.uZa=4096]="reformatPastedContent";b[b.jhq=8192]="pasteAsPlainText";b[b.tpd=65536]="showPlaceholderGlossary";b[b.Qiq=131072]="reformatPastedContentWithDesignerPaste";b[b.weq=262144]="noSpacesAdjustment";b[b.c9p=524288]="mergeAfterPasteForInsertHtmlAPI"})(Oz||(Oz={}));
Object(u.b)("ClipboardActionFlags",Oz);var ro=d(383);class Ou extends bx.a{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe,ge,$d,lf,wf,gi,Di,Yl,xk,Vn=!0){super();this.woa=this.xx=null;this.qM=this.pA=0;this.nlb=this.c7e=this.Hda=this.zh=null;this.Y9=!1;this.mW=!0;this.ukh=!1;this.init(b);this.nm("ClipboardOperation");this.usb(gb,h,L,Z,oa);this.zd=Ab;this.Qe=Jb;this.gf=Tb;this.Rc=jc;this.lbh=Hc;this.nbh=hd;this.mbh=Gd;this.CMe=de;this.V4b=qe;this.DMe=oe;this.AEc=Ba;this.oEc=ge;this.BSa=
$d;this.cSk=Vn;this.KC=lf;this.Zd=wf;this.En=gi;this.F1=Di;this._context=A;this.Bja=Yl;this.Ukb=xk;this.Yd=fl.a.getInstance(ro.a.n6a);oa&&Object(Gb.a)(73,oa)&&(this.Hda=Object(Ca.a)(730,oa.ka(Od.a.Zya,null)));this.Hda||(this.Hda=this.Bja.cqd());this.zBb=void 0===r||null===r?"NotAvailable":Object(YA.a)(Oz,r);this.Hda.o7k(this.zBb.split(", "));b=this._context;if(this.Ukb){if(!Ou.UZh(b,this.CMe,this.zd,this.Hda,Vn)){this.hs=8;this.finish();return}this.zh=b.view;this.Y9=3===this.zh.qUb;this.pA=0;this.qM=
r;this.nlb=de.ZYa}else{if(!b.view.ve){this.zd.fc(Df.a.Ne,{["Reason"]:gf.a.fWb});this.Hda.fail("Not in interactive view",!0);this.hs=8;this.finish();return}this.zh=b.view;if(!this.zh.lb){this.zd.fc(Df.a.Ne,{["Reason"]:gf.a.Qn});this.Hda.fail("No selection manager",!0);this.hs=8;this.finish();return}this.Y9=3===this.zh.qUb;this.pA=0;this.qM=r;this.nlb=de.ZYa;if(Vn&&!(this.nlb&&this.nlb.currentSelection&&this.nlb.length)){this.zd.fc(Df.a.Ne,{["Reason"]:gf.a.Qn});this.Hda.fail("No selection when one required",
!0);this.hs=8;this.finish();return}}de=he.a.ym(this.nlb.currentSelection);de=!(this.qM&16&&de);de=oe.Mgn(r,this.Pg)&&de;1!==this.behavior&&de||(de||this.Hda.fail("Clipboard operation disabled for selection",!0),this.hs=de?32:8,this.fva());!this.ukh&&this.gf.Di&&(me.b("IPadCCP"),this.ukh=!0)}get Pg(){this.c7e||(this.c7e=If.a.Odc(this.nlb));return this.c7e}Rga(){super.Rga();this.nlb=null}run(){this.pA||this.setup();1===this.pA&&this.process();2===this.pA&&this.yjp();3===this.pA&&this.vjp();4===this.pA&&
this.finish()}setup(){if(this.qM&256&&this.AEc){this.PC||this.V4b.oql(this,this.qM,this.zBb);this.PC.run();if(this.PC.Dfa)return;this.mW=this.PC.cua;this.oVd();if(!this.mW){this.Hda.fail("No access to system clipboard",!0);this.hs=8;this.pA=4;this.Lhe();return}}else v.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.qM,this.zBb,this.gf.cE,this.actionId);this.qM&32&&!this.Qe.jde(this.zh.lb.Pg)?(v.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.zd.fc(Df.a.Ne,
{["Reason"]:gf.a.wuf}),this.Hda.fail("Cut not allowed",!0),this.oEc.show(),this.hs=8,this.pA=4):(this.qM&16||this.qM&32)&&this.KC.kfe(this.zh.lb.gb.currentSelection)?(this.Hda.fail("Selected content deleted in coauthoring",!0),this.Zd.y0b(),this.hs=8,this.pA=4):(this.qM&4096&&(this.F1.Luc(Object.assign(new yw.a,{e9c:!0,WX:this.zBb})),this.En.undo()),this.DMe.Xfo(this.qM),this.zh.vd?(this.xx=this.Rc.Lc(15),this.xx.Ph=this.actionId,this.xx.Ab(this.zh.vd),this.pA=1):(this.Hda.fail("Interactive view has null target node",
!0),this.hs=8,this.pA=4))}process(){if(!this.PC){v.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.qM,this.zBb,this.gf.cE);v.ULS.shipAssertTag(6305507,307,!this.woa);this.woa=new xr(this._context,this.qM,this.Hda,this.ica,this.YN,void 0,this.gf.cE,this.cSk,this.Y9);let b;this.qM&65536?b=Object(D.a)(this.lbh,this.lbh.process,"process"):this.qM&64?b=Object(D.a)(this.nbh,this.nbh.process,"process"):this.qM&1?(this.Yd.logKpiUsage({kpiName:ro.a.Rya}),b=Object(D.a)(this.CMe,
this.CMe.process,"process")):b=Object(D.a)(this.mbh,this.mbh.process,"process");this.qM&16&&this.zh.lb.lEa.uqi();this.BSa.create(this,b,this.woa).nm("ClipboardAction")}v.ULS.shipAssertTag(6305536,307,!!this.PC);this.PC.run();this.PC.Dfa||(this.oVd(),this.pA=this.oi?2:3)}yjp(){this.woa.uoc&&(this.xx.Ph=vb.a.N0);this.woa.v9c&&this.xx.QLa(this.woa.MKa,this.woa.Xbg);this.xx.dispose();this.hs=this.woa.TB?8:32;this.pA=4}vjp(){if(this.PC){if(this.PC.run(),this.PC.Dfa)return}else if(this.woa.uoc&&(this.xx.Ph=
vb.a.N0),this.xx.FNa(this),this.woa.v9c&&this.xx.QLa(this.woa.MKa,this.woa.Xbg),this.xx.dispose(),this.bdf)return;this.hs=this.woa.TB?8:32;this.pA=4}finish(){this.F1.Luc(Object.assign(new yw.a,{e9c:!1}));this.fva();32===this.response?(v.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.qM,this.zBb,this.gf.cE),this.qM&1&&this.Yd.logKpiSuccess({kpiName:ro.a.Rya})):v.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",
+this.endTime-+this.startTime,this.qM,this.zBb,this.gf.cE);this.Bja.Uka(this.Hda);Ou.kqo&&this.dEn()}Lhe(){const b=!!(this.qM&1),h=this._context.view;h&&ro.a.Lhe(b,h.lb,this.gf.cE)}dEn(){if(!(this.qM&4||this.qM&64)){var b=new Map;b.set("isCopy",String.format("{0}",!!(this.qM&16)));b.set("isIPad",String.format("{0}",this.gf.Di));b.set("SkipAria","false");b.set("ErrorLevel","info");this.Yd.logKpiUsage({kpiName:ro.a.b0h,kpiType:0,optionalProperties:{extendedProperties:b},blockFutureEmissionDurationInMs:0});
this.mW||(b.set("SkipAria","false"),b.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:ro.a.b0h,errorName:ro.a.gnl,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:b}},blockFutureEmissionDurationInMs:0}))}}static get kqo(){null==Ou.W4e&&(Ou.W4e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("RecordCcpErrorDialogKpiIsEnabled"));return Ou.W4e}static epg(b,h,r,A){b&&b.fc(Df.a.Ne,{["Reason"]:r});h&&h.fail(A,!0)}static UZh(b,h,r=null,A=null,L=!0){return b.view.ve?
b.view.lb?!L||h.ZYa&&h.ZYa.currentSelection&&h.ZYa.length?!0:(Ou.epg(r,A,gf.a.Qn,"Paste target is invalid"),!1):(Ou.epg(r,A,gf.a.Qn,"No selection manager"),!1):(Ou.epg(r,A,gf.a.fWb,"Not in interactive view"),!1)}}Ou.W4e=null;Object(u.a)(Ou,"ClipboardOperation",bx.a,[]);class qG{constructor(b,h,r,A,L,Z,oa){this.kC=oa;this.S2e=null;this.Mzh=0;this.zd=A;this.gf=h;this.e1=L;this.iUe=r;this.AEc=y.AFrameworkApplication.qBg();this.qMe=b.appSettings.ChromeClipboardAccessOperationTimeout;this.BK=0;this.Cqk=
Z;this.fvk=b.$("EnableExternalPasteSupportOnMobileIsEnabled");this.Yd=fl.a.getInstance(ro.a.n6a)}get ZYa(){return this.e1.ZYa}process(b,h){if(!this.BK)return this.Pao(h);if(1===this.BK)return this.QXb(b,h);if(2===this.BK)return this.BK=3,this.S2e(b,h);3===this.BK&&this.e1.$yg(b,h);return!1}Pao(b){let h=!0;this.fvk&&(h=!(b.yx&1));this.gf.C7&&h||b.yx&512?(this.S2e=b.yx&2?Object(D.a)(this.e1,this.e1.paste,"paste"):Object(D.a)(this.e1,this.e1.Yrj,"pasteInternal"),this.BK=2):(this.AEc?(this.BK=1,this.Mzh=
Date.now()):this.BK=2,this.S2e=Object(D.a)(this.e1,this.e1.paste,"paste"));ro.a.pGn(b);return!0}QXb(b,h){var r;b=!0;if(this.iUe.value.tuj())this.BK=2;else{const A=Date.now()-this.Mzh;A>this.qMe&&(v.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",A),this.zd.fc(Df.a.asa,{["Reason"]:gf.a.Gpj}),h.UU&&(h.UU.fail("Prepare for paste timed out",!1),null===(r=this.kC)||void 0===r?void 0:r.LNb(),this.Yd.logKpiFailure({kpiName:ro.a.Rya,errorName:"PreparePasteTimedOut",optionalVeto:{name:ro.a.ope,isIntentional:!1,
isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}})),h.TB=!0,b=!1,this.Cqk.rHo())}return b}}Object(u.a)(qG,"ClipboardOperationPasteProcessor",null,[726]);class CC extends bx.a{constructor(b,h,r,A,L,Z){super();this.init(b);this.nm("DummyClipboardOperation");this.usb(y.AFrameworkApplication.va,h,A,L,Z);this._context=r;this.hs=8;this.fva()}run(){this.Sib=!0;this.wnd(this._context);this.Dcb();this.hs=32}}Object(u.a)(CC,"DummyClipboardOperation",bx.a,[]);var Ny=d(1536);class nJ extends Ny.a{constructor(b,
h,r,A,L){super(b,h,L);this.kk=r;this.J7e=A}vAc(b){let h;if(this.sT&&!b)return v.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Lka:null};h=null;if(this.J7e&&!this.sT){const r=this.properties.ka(Od.a.esj,"");r&&(h=this.kk.pcb(r))}h||(h=this.kk.pcb(b));return{returnValue:!0,Lka:h}}}Object(u.a)(nJ,"HtmlStringImportStrategy",Ny.a,[]);var Iv=d(1898);class Tx extends Iv.a{constructor(b,h,r,A,L){super(b,h,r,A,L)}LDi(){return this.properties.ka(Od.a.rXb,
"")}vAc(b){if(this.XEh){if(this.kk)return b=this.kk.Dig(b,!0),{returnValue:!0,Lka:b};v.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.vAc(b)}tbd(b){b=super.tbd(b);return b.length&&" "!==b?b:"\u00a0"}}Object(u.a)(Tx,"MultiLinePlainTextImportStrategy",Iv.a,[]);class sE extends Ny.a{constructor(b,h,r){super(b,h,r)}vAc(b){if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorPlainTextImportStrategy",!1))return this.vrp(b);let h;
if(this.sT&&!b)return v.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Lka:null};h=pG.a.r4c("Box4PasteScratchPad");h.innerText=b;return{returnValue:!0,Lka:h}}vrp(b){let h;if(this.sT&&!b)return v.ULS.sendTraceTag(508379359,307,10,"No htmlDomContent"),{returnValue:!1,Lka:null};h=Ux.Qao;h.innerText=b;return{returnValue:!0,Lka:h}}}Object(u.a)(sE,"PlainTextImportStrategy",Ny.a,[]);class tE{constructor(b){this.isReady=this.ZZf=!1;this.yja=b}tuj(){this.ZZf||(this.ZZf=!0,this.isReady=
!1,this.yja.QXb(()=>{this.isReady=!0}));return this.isReady}D3j(){this.ZZf=!1;const b=this.yja.paste();return b?b.hasChildNodes()?{returnValue:!0,fXd:b}:(v.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),tE.Ac.fc(Df.a.G4,{["Reason"]:gf.a.dBf}),{returnValue:!1,fXd:b}):(v.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),tE.Ac.fc(Df.a.FOb,{["Reason"]:gf.a.tFg}),{returnValue:!1,fXd:b})}static get Ac(){return ih.a.instance}}Object(u.a)(tE,"SystemClipboardImportStrategy",null,[727]);
class Ux{get g5i(){return this.sRa}set g5i(b){this.sRa=b}constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe,ge=null){this.kC=oe;this.R1d=ge;this.fxd=null;this.sRa=0;this.hCd=this.nRc=!1;this.fCb=Tg.a.On;this.rpd=()=>{const $d=Array(1);$d.push("PasteRecoveryFloatie");var lf=this.GIk.xVa();lf=Object.assign(new wj.a,{x:lf.x,y:lf.y});this.bO.showFloatie(lf,$d,1);return 32};this.HRb=()=>{this.bO.f3&&this.bO.dismissFloatie();return 32};this.ixj=($d,lf,wf,gi,Di)=>{if(1===wf)return 32;Di[je.a.On]=
!1;return 32};this.QYl=($d,lf,wf,gi,Di,Yl)=>{v.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var xk=Yl.DataTransfer;Yl=xk.getData("text/html");xk=xk.getData("text/plain");let Vn=!1;const Dx=new lj.DictionaryPropertySet;0<Yl.length?(v.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Dx.setValue(Od.a.XX,Yl),Vn=!0):0<xk.length&&(v.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Dx.setValue(Od.a.rXb,xk),Vn=!0);if(Vn){const qy=
this.yz.K(lf);return this.IVd.create($d,lf,qy,new rg.a(()=>this.QYc(qy,Dx)),wf,gi,Di,Dx)}return null};this.Ong=($d,lf,wf,gi,Di)=>{if(lf="object"===typeof Di?Di:null)this.Vkb?this.OSo($d,this.sRa,lf):$d===vb.a.Ere?($d=this.sRa!==vb.a.uZa&&this.sRa!==vb.a.vZa&&this.sRa!==vb.a.hDa,lf[this.fCb]=this.sRa===vb.a.uZa||$d):$d===vb.a.Fre?lf[this.fCb]=this.sRa===vb.a.vZa:$d===vb.a.Kng&&(lf[this.fCb]=this.sRa===vb.a.hDa);return 32};this.a_=($d,lf,wf,gi,Di,Yl)=>{if((y.AFrameworkApplication.dV||y.AFrameworkApplication.cG)&&
!y.AFrameworkApplication.hpb||Yj.a.iba(wf)&&Yj.a.htb())return new CC($d,lf,wf,gi,Di,Yl);let xk=this.yz.K(lf);1!==gi&&xk&1&&(this.sRa=lf);if(1!==gi){var Vn=Object(Gb.a)(73,Yl)?Yl:null;Yl?(xk&1&&(this.fxd=Vn),Vn=Vn?Vn.ka(Od.a.WX,0):0,lf===vb.a.paste&&Vn===vb.a.XHa?xk=this.yz.K(vb.a.s6):lf===vb.a.P3&&Vn===vb.a.h6a&&(xk=this.yz.K(vb.a.ppe))):!Yl&&xk&4096&&(Yl=this.fxd,Vn=Object(Gb.a)(73,Yl)?Yl:null)&&(Vn=Vn.ka(Od.a.Ngd,Q.a.nil),v.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",
Vn))}return this.IVd.create($d,lf,xk,new rg.a(()=>this.QYc(xk,Yl)),wf,gi,Di,Yl)};this.Uho=($d,lf,wf,gi,Di)=>this.hmf($d,lf,wf,Di);this.Tho=($d,lf,wf,gi,Di)=>this.hmf($d,lf,wf,Di);this.Sho=($d,lf,wf,gi,Di)=>this.hmf($d,lf,wf,Di);this.Rje=($d,lf,wf,gi,Di,Yl)=>{Yl=xc.a.Uc(If.a.instance.gb.currentSelection.Qa.node,Yl);return this.a_($d,lf,wf,gi,Di,Yl)};this.Gqk=b;this.yja=h;this.zd=r;this.kk=A;this.ga=Z;this.Hxd=Ab;this.V4b=Jb;this.kf=Tb;this.wg=jc;this.Zb=gb;this.Ukb=Hc;this.Vkb=hd;this.GIk=Gd;this.bO=
de;this.mXe=qe;this.Yd=fl.a.getInstance(ro.a.n6a);Ba&&(this.nRc=Ba.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.hCd=this.Vkb&&Ba.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.yz=new Mb.a;this.yz.W(vb.a.paste,257);this.yz.W(vb.a.P3,8449);this.yz.W(vb.a.s6,1);this.yz.W(vb.a.k$a,1);this.yz.W(vb.a.EKb,1);this.yz.W(vb.a.LHa,1);this.yz.W(vb.a.Ybe,513);this.yz.W(vb.a.uZa,4097);this.yz.W(vb.a.vZa,12289);this.yz.W(vb.a.hDa,131073);this.yz.W(vb.a.Mig,7);this.yz.W(vb.a.Lig,1);this.yz.W(vb.a.ppe,
8193);this.yz.W(vb.a.iE,272);this.yz.W(vb.a.eUc,16);this.yz.W(vb.a.cut,304);this.yz.W(vb.a.clf,48);this.yz.W(vb.a.Qje,64);this.yz.W(vb.a.Rje,64);this.yz.W(vb.a.tpd,327680);this.yz.W(vb.a.$xf,1);this.hCd&&this.yz.W(vb.a.xwb,this.yz.K(vb.a.ppe))}get R_a(){return null!=this.E4g?this.E4g:this.E4g=Wa.a.instance.Oa("Box4.Clipboard.ISystemClipboardAccessManager")}get lGg(){return null!=this.$4g?this.$4g:this.$4g=Wa.a.instance.Oa("Common.Utils.Telemetry.ITelemetry")}get IVd(){return this.Gqk.value}get Bhp(){return this.yja}Xb(){if(y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePasteQueryAtBoot",!1)){this.R1d.addCommandToMaps(new vt.a(mp.a.Ogd,this.Ukb?vb.a.XHa.toString():vb.a.paste.toString()));let b;this.R1d.addCommandToMaps((b=new vt.a(mp.a.Jig,this.Vkb?vb.a.h6a.toString():vb.a.P3.toString()),b.legacyControlId="fseaNewPaste",b));this.R1d.addCommandToMaps(new vt.a(mp.a.Mgd,this.Vkb?vb.a.h6a.toString():vb.a.P3.toString()));let h;this.R1d.addCommandToMaps((h=new vt.a("PasteStandalone",this.Ukb?
vb.a.XHa.toString():vb.a.paste.toString()),h.legacyControlId="fseaPaste",h))}this.ga.fb(vb.a.Blo,kc.a.application,this.ixj,97);this.ga.fb(vb.a.Clo,kc.a.application,this.ixj,97);this.ga.fb(vb.a.Ere,kc.a.application,this.Ong,97);this.ga.fb(vb.a.Fre,kc.a.application,this.Ong,97);this.ga.fb(vb.a.Kng,kc.a.application,this.Ong,97);this.ga.wW(vb.a.clf,kc.a.view,this.a_,1028);this.ga.Slb(vb.a.eUc,kc.a.view,this.a_);this.ga.wW(vb.a.$xf,kc.a.view,this.QYl,1028);this.ga.wW(vb.a.s6,kc.a.view,this.a_,1028);this.ga.wW(vb.a.k$a,
kc.a.view,this.a_,1028);this.ga.wW(vb.a.EKb,kc.a.view,this.a_,1028);this.ga.wW(vb.a.LHa,kc.a.view,this.a_,1028);this.Ukb&&this.ga.fb(vb.a.XHa,kc.a.view,this.Sho,1028);this.Vkb&&this.ga.fb(vb.a.h6a,kc.a.view,this.Tho,1028);this.ga.wW(vb.a.paste,kc.a.view,this.a_,1028);this.ga.wW(vb.a.P3,kc.a.view,this.a_,1028);this.ga.wW(vb.a.ppe,kc.a.view,this.a_,1028);this.ga.wW(vb.a.Lig,kc.a.view,this.a_,1028);this.ga.wW(vb.a.Mig,kc.a.view,this.a_,1028);this.ga.wW(vb.a.uZa,kc.a.view,this.a_,1028);this.ga.wW(vb.a.vZa,
kc.a.view,this.a_,1028);this.ga.qa(vb.a.uZb,kc.a.view,Vd.ActionManager.eg);this.ga.qa(vb.a.lsj,kc.a.view,Vd.ActionManager.eg);this.ga.qa(vb.a.isj,kc.a.view,Vd.ActionManager.eg);this.ga.qa(vb.a.jsj,kc.a.view,Vd.ActionManager.eg);this.ga.qa(vb.a.ksj,kc.a.view,Vd.ActionManager.eg);this.ga.qa(vb.a.hsj,kc.a.view,Vd.ActionManager.eg);this.ga.Slb(vb.a.Qje,kc.a.view,this.a_);this.ga.Slb(vb.a.Rje,kc.a.view,this.Rje);this.ga.Slb(vb.a.Ybe,kc.a.view,this.a_);this.ga.Slb(vb.a.tpd,kc.a.view,this.a_);this.hCd&&
(this.ga.fb(vb.a.BUc,kc.a.view,this.Uho,1028),this.ga.wW(vb.a.xwb,kc.a.view,this.a_,1028));this.ga.qa(vb.a.Gbi,kc.a.view,Vd.ActionManager.eg);this.ga.qa(vb.a.jci,kc.a.view,Vd.ActionManager.eg);this.mXe&&(this.ga.fb(vb.a.rpd,kc.a.view,this.rpd,96),this.ga.fb(vb.a.HRb,kc.a.view,this.HRb,96))}o8(){if(this.Zb){const b=this.Zb.ie(Nk.a.AF);this.hCd&&b.bindAction(Cb.KeyInputManager.oc(jf.a.uBb,Cb.KeyInputManager.li|4),vb.a.BUc)}else v.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}OSo(b,
h,r){switch(h){case vb.a.vZa:case vb.a.P3:case vb.a.xwb:h=vb.a.Fre;break;case vb.a.hDa:h=vb.a.Kng;break;default:h=vb.a.Ere}r[this.fCb]=b===h}wFm(){const b=Object(Gb.a)(73,this.fxd)?this.fxd:null;return b?b.ka(Od.a.Ngd,Q.a.nil):Q.a.nil}hmf(b,h,r,A){if(1===r){if(!Object(Gb.a)(wr.a,h)||!this.Hxd||Yj.a.iba(h)&&Yj.a.htb())return 8;r=new rg.a(()=>this.QYc(this.yz.K(vb.a.s6),A));const L=this.Hxd.create(r,Object(Ca.a)(73,A));r=new qG(y.AFrameworkApplication.J,Lu.a.instance,r,ih.a.instance,L,this.V4b,this.kC);
return Ou.UZh(h,r)?32:8}if(2===r){if(this.t3o(ed.a.m5a))return this.XHa(b);ed.a.Vuc(()=>{this.XHa(b)});return 32}return 2}XHa(b){var h;if(!this.kf)return v.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var r=this.kf.Lqb();if(!r)return v.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;r=r.Eo;if(!r)return v.ULS.sendTraceTag(592454659,307,10,"No document"),8;v.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",b);this.Yd.logKpiUsage({kpiName:ro.a.Rya});this.wg.S_l(b);
b=rd.a.AOb(r,"paste");r=this.wg.wUl();v.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",r);if(b)return v.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.Yd.logKpiSuccess({kpiName:ro.a.Rya}),32;this.KVm();v.ULS.sendTraceTag(592454662,307,10,"execCommand failed");null===(h=this.kC)||void 0===h?void 0:h.LNb();this.Yd.logKpiFailure({kpiName:ro.a.Rya,errorName:"ExecCommandFailed"});return 8}KVm(){this.R_a&&(this.R_a.z0b(),ro.a.Lhe(!0,If.a.instance,aa.a.cE));if(this.lGg){const b=
this.lGg.cqd();b.Ycc("CallExecCommandPasteOperation");b.fail("call to execCommand('paste') failed",!0);this.lGg.Uka(b)}}t3o(b){let h=!1;this.Zb?this.Zb.currentScope?h=!this.Zb.yXf(this.Zb.currentScope.name):v.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):v.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(h){v.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Zb.currentScope.name);if(1>b)return v.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Zb.zDf();
return!1}return!0}QYc(b,h){return b&256?new tE(this.Bhp):b&2?b&4096?new nJ(h,this.zd,this.kk,ed.a.instance.r9c,ed.a.instance.v_a):new sE(h,this.zd,ed.a.instance.v_a):h.hasProperty(Od.a.rXb)?new Tx(h,this.zd,this.kk,this.nRc,ed.a.instance.v_a):new nJ(h,this.zd,this.kk,ed.a.instance.r9c,ed.a.instance.v_a)}static get Qao(){return pG.a.r4c("Box4PasteScratchPad")}TZh(b,h,r,A){return!y.AFrameworkApplication.dV&&!y.AFrameworkApplication.cG||y.AFrameworkApplication.hpb?(b=this.a_(null,b?vb.a.cut:vb.a.iE,
h,1,r,A))?b.response:8:8}}Object(u.a)(Ux,"ClipboardActor",null,[]);class cx{constructor(b,h,r,A,L){this.vgh=0;this.IGp=Z=>{let oa=!0;const Ba=this.yja.X1l;null!=Ba?(Z.cua=Ba,oa=!1):Date.now()-this.vgh>this.qMe&&(v.ULS.sendTraceTag(18354843,307,50,null),this.zd.fc(Df.a.asa,{["Reason"]:gf.a.Gpj}),oa=Z.cua=!1);return oa};this.zd=b;this.gf=h;this.qMe=L;this.yja=r;this.BSa=A}oql(b,h,r){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.gf.cE);b.oi&&this.gf.Nr&&
window.chrome&&v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.yja.x_c(!!(h&16));this.BSa.create(b,this.IGp,null).nm("ClipboardPreProcess");this.vgh=Date.now()}rHo(){this.yja.reset()}}Object(u.a)(cx,"ClipboardOperationClipboardAccessHelper",null,[706]);class ZA{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd){this.L2a=null;this.ga=b;this.zd=h;this.qB=r;this.Vh=A;this.ib=L;this.yja=Z;this.hb=oa;this.Qe=Ba;
this.yo=gb;this.fd=Ab;this.Qjb=Jb;this.i5e=Tb;this.EG=jc;this.kk=hd;this.w7b=Hc?Hc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.KEd=Hc?Hc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Fd=Gd;this.Yd=fl.a.getInstance(ro.a.n6a)}get Mf(){return this.Vh}get Ac(){return this.zd}get N8c(){if(null==this.L2a)if(this.Fd)if(this.Fd.er.isCompleted)this.L2a=this.Fd.isFeatureEnabled(2);else return!1;else this.L2a=!1;return this.L2a}zGp(b){b.hJ();return!0}h8h(b,h){b=h.yx;v.ULS.shipAssertTag(18130960,
307,!!(b&16));if(b&256){let A=!1,L;this.N8c&&h.ge&&h.ge.Hi&&(A=this.kk.pNh(h.ge.Hi.editingElement));L=this.kk.VQf(h.ge.Hi.editingElement,!1);var r=h.ge.Hi.editingElement;this.kk.SVf(r,!1,1);this.w7b&&aa.a.mta?(r=h.ge.Hi.editingElement,this.kk.xsg(r,"data-src","data-srcurl"),b=this.yja.iE(),this.kk.xsg(r,"data-srcurl","data-src")):this.KEd&&h.ge&&h.ge.Hi?(r=this.kk.enf(h.ge.Hi.editingElement,h.ge.WC,!0),b=this.yja.iE(),r&&this.kk.enf(h.ge.Hi.editingElement,h.ge.WC,!1)):(this.kk.qDj(h.ge.Hi.editingElement),
b=this.yja.iE());this.N8c&&A&&this.kk.hBo(h.ge.Hi.editingElement);L&&this.kk.VQf(h.ge.Hi.editingElement,!0);r=h.ge.Hi.editingElement;this.kk.SVf(r,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:ro.a.CUd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Ac.fc(Df.a.FOb,{["Reason"]:gf.a.tFg}),h.UU&&h.UU.fail("SystemClipboard did not copy",!1),
h.TB=!0,!1}return!0}rrf(b,h){const r=h.ge;v.ULS.shipAssertTag(18130961,307,!!(h.yx&16));h.nap?this.qB.C2h():this.qB.IXd(r,b);return!0}cei(b,h){var r=h.context,A=h.rd;const L=h.ica;var Z=!1;b=this.ib.gb.currentSelection.Xc;if(this.hb.en(b)||this.Qe.pl(b)){const oa=this.fd.mg(b.node),Ba=oa.Nd();v.ULS.shipAssertTag(18130962,307,Ba);this.yo.me(oa);this.Qjb.stb(oa)&&(Z=!0)}A=h.yx&64?new lj.DictionaryPropertySet:A||new lj.DictionaryPropertySet;A.setValue(Od.a.tZc,!1);this.Yd.logKpiUsage({kpiName:ro.a.DUd});
r=this.ga.Hf(r,vb.a.gI,2,!0,L,A);8===r&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Ac.fc(Df.a.asa,{["Reason"]:gf.a.bei}),h.UU&&h.UU.fail("DeleteKey failed",!1),this.Yd.logKpiFailure({kpiName:ro.a.DUd,errorName:"DeleteForCutFailed"}),h.TB=!0);32===r&&this.Yd.logKpiSuccess({kpiName:ro.a.DUd});32===r&&Z&&(h=this.ib.gb.currentSelection,this.Qe.ym(h)&&h.Qa.node===b.node&&!this.hb.textLength(h.Qa.node)&&(h=this.fd.mg(h.Qa.node),b=this.Qe.Ou(h),v.ULS.shipAssertTag(18130964,307,b),this.yo.me(h),
this.Qjb.xde(h)||(b=this.i5e.create(),b.nd(h),this.yo.y3(b,!1,!1),Z=this.yo.Me(b),this.hb.Wb(Z)&&(this.yo.me(b),this.Mf.merge(b,h,!1,!1),this.ib.Kc(this.EG.ue(Z,this.hb.textLength(Z)))))));return!0}}Object(u.a)(ZA,"ClipboardOperationCutCopy",null,[729]);class rG{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd){this.ga=b;this.zd=h;this.qB=r;this.yja=Z;this.ib=L;this.Vh=A;this.hb=oa;this.Qe=Ba;this.yo=gb;this.fd=Ab;this.Qjb=Jb;this.i5e=Tb;this.EG=jc;this.Aa=Hc;this.kk=hd;this.Fd=Gd}create(){return new ZA(this.ga,
this.zd,this.qB,this.Vh,this.ib,this.yja,this.hb,this.Qe,this.yo,this.fd,this.Qjb,this.i5e,this.EG,this.Aa,this.kk,this.Fd)}}Object(u.a)(rG,"Factory",null,[707]);var Fq=d(334);class uE{constructor(b,h){this.hFc=null;this.rCl=(r,A)=>{let L;if(Fq.a.aga){if(!A.rd)return!1;L=A.rd.X4c;if(!L)return!1}else{if(!Object(Gb.a)(73,A.rd))return!1;const Ba=Object(Ca.a)(73,A.rd);if(!Ba.hasProperty(Od.a.X4c))return!1;L=Ba.getValue(Od.a.X4c)}const Z=A.ge,oa=Z.lb;this.qB.n$j();oa.UZb(()=>{oa.Kc(L,void 0,!0);this.qB.IXd(Z,
r)},!0);return!0};this.qB=b;this.e1=h;this.BK=0}process(b,h){this.BK||(this.hFc=[this.rCl,Object(D.a)(this.e1,this.e1.Nao,"pasteGlossaryPlaceholder")],Fq.a.aga&&this.hFc.push(Object(D.a)(this.e1,this.e1.$yg,"setSelectionAfterPaste")));let r=!0;this.BK<this.hFc.length&&(r=this.hFc[this.BK++](b,h));return r?this.BK<this.hFc.length:!1}}Object(u.a)(uE,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[734]);class nu{constructor(b){this.YCb=null;this.b5=b;this.BK=-1}process(b,h){-1===this.BK&&
(this.pNl(b,h),this.BK=0);let r=!1;this.BK<this.YCb.length&&(r=this.YCb[this.BK++](b,h));return r?this.BK<this.YCb.length:!1}pNl(b,h){aa.a.C7||h.yx&512?(this.YCb=[Object(D.a)(this.b5,this.b5.rrf,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.oi&&h.yx&256?(this.YCb=[Object(D.a)(this.b5,this.b5.zGp,"waitBeforeCopy"),Object(D.a)(this.b5,this.b5.h8h,"copyExternal"),Object(D.a)(this.b5,this.b5.rrf,"copyInternal")],v.ULS.sendTraceTag(18158307,
307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.YCb=[Object(D.a)(this.b5,this.b5.h8h,"copyExternal"),Object(D.a)(this.b5,this.b5.rrf,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.yx&32&&(b=Object(D.a)(this.b5,this.b5.cei,"deleteForCut"),this.YCb.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));
ro.a.cEn(h)}}Object(u.a)(nu,"ClipboardOperationCutCopyProcessor",null,[731]);class kL{constructor(b,h,r,A){this.bHd=null;this.uCl=(L,Z)=>{Z=Z.ge;this.qB.fDp();this.qB.IXd(Z,L);return!0};this.Edd=(L,Z)=>{Z=new Oq.Selection([Z.rd],!0);this.ib.Kc(Z,L);return!0};this.qB=b;this.ib=h;this.b5=r;this.e1=A;this.BK=0}process(b,h){this.BK||(this.bHd=[this.uCl,Object(D.a)(this.b5,this.b5.cei,"deleteForCut"),this.Edd,Object(D.a)(this.e1,this.e1.Yrj,"pasteInternal"),Object(D.a)(this.e1,this.e1.$yg,"setSelectionAfterPaste")]);
let r=!0;this.BK<this.bHd.length&&(r=this.bHd[this.BK++](b,h));return r?this.BK<this.bHd.length:!1}}Object(u.a)(kL,"ClipboardOperationMoveProcessor",null,[728]);class Po{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe){this.kC=oe;this.qB=b;this.ga=h;this.AEc=r;this.zd=A;this.Qe=L;this.gf=Z;this.Rc=oa;this.Hxd=Ba;this.Fqk=gb;this.V4b=Ab;this.DMe=Jb;this.oEc=Tb;this.BSa=jc;this.KC=Hc;this.Zd=hd;this.En=Gd;this.F1=de;this.Bja=qe}create(b,h,r,A,L,Z,oa,Ba,gb=!0){const Ab=this.Hxd.create(A,
Object(Ca.a)(73,Ba));var Jb=this.Fqk.create();const Tb=new uE(this.qB,Ab),jc=new kL(this.qB,If.a.instance,Jb,Ab);Jb=new nu(Jb);A=new qG(y.AFrameworkApplication.J,Lu.a.instance,A,ih.a.instance,Ab,this.V4b,this.kC);return new Ou(b,h,r,L,Z,oa,Ba,this.AEc,this.ga,this.zd,this.Qe,this.gf,this.Rc,Tb,jc,Jb,A,this.V4b,this.DMe,this.oEc,this.BSa,this.KC,this.Zd,this.En,this.F1,this.Bja,y.AFrameworkApplication.uBg(),gb)}}Object(u.a)(Po,"Factory",null,[705]);var kq=d(242);class DC{constructor(b,h){this.jRb=
b.jJf(h);this.Crf=b.pom(h);this.VLb=b.OGf(h);this.Emb=b.kGf(h)}static dH(b){return DC.Us(b)}static Us(b){return new DC(SA.a.instance,b)}}Object(u.a)(DC,"CpUsageHelper",null,[]);class sG{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){this.kC=jc;this.zd=b;this.qB=h;this.lNc=r;this.gya=A;this.ib=L;this.ga=Z;this.iUe=oa;this.Jaf=gb;this.V2e=Ba;this.SPe=Ab;this.BMe=Jb;this.Zd=Tb;this.Yd=fl.a.getInstance(ro.a.n6a)}get ih(){return this.Jaf.value}get Nva(){return this.gya}get Ac(){return this.zd}get ZYa(){return this.V2e.ZYa}paste(b,
h){let r=!1;return Ok.a.Etb?(Cq.a.instance.le(()=>{r=this.Vrj(b,h)},"COP:P"),r):this.Vrj(b,h)}Vrj(b,h){var r,A;const L=this.Zd.S5a();try{const Z=h.ge,oa=h.yx;this.ib&&this.ib.gb&&this.ib.gb.currentSelection&&kq.TableBorderSelectionCache.P0o(this.ib.gb.currentSelection.Yw||this.ib.gb.currentSelection.vab);Nr.a.GZo(this.ib);v.ULS.shipAssertTag(18131010,307,!!(oa&1));Object(Gb.a)(73,h.rd)&&h.rd.setValue(Ge.a.Mka,Z.Hi.editingElement.clientWidth);this.BMe.Prp(b,h);let Ba;if(!({fXd:Ba}=this.iUe.value.D3j()).returnValue)return this.ccd(h,
"HTML import strategy failed",!1),null===(r=this.kC)||void 0===r?void 0:r.LNb(),this.Yd.logKpiFailure({kpiName:ro.a.Rya,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:ro.a.ope,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;this.ih.uI();let gb=!0,Ab=null;const Jb=this.SPe.create(Ba),Tb=h.k$j;if(!Z||!Z.lb)return this.ccd(h,"Fail to set selection.",!1),null===(A=this.kC)||void 0===A?void 0:A.LNb(),this.Yd.logKpiFailure({kpiName:ro.a.Rya,errorName:"SetSelectionFailed",
optionalVeto:{name:ro.a.ope,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;Z.lb.UZb(()=>{Tb&&2===this.ga.Ob(vb.a.Bra,2)?gb=!1:(Ab=Tb?this.ib&&this.ib.gb&&this.ib.gb.currentSelection?this.ib.gb.currentSelection.Qa:null:h.rd)?(v.ULS.shipAssertTag(18158338,307,he.a.mf(Ab)),this.x$i(Ab,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Tb)},this.V2e.h0i);if(!gb)return this.ccd(h,"fail to deleteForReplace.",!0),!1;if(!Ab)return this.ccd(h,
"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ab.node||!Ab.node.isConnected)return this.ccd(h,"node is null or not connected in ip context.",!0),!1;Z.Ie.disable(!0,25);Jb.restore();this.lNc.Iao(Ba,Ab,b);return!0}finally{L&&L.dispose()}}ccd(b,h,r){b.TB=!0;b.UU&&b.UU.fail(h,r)}Nao(b,h){var r,A;let L;if(Fq.a.aga){L=h.rd;var Z=L.A9d}else Z=Object(Ca.a)(73,h.rd).getValue(Od.a.A9d);v.ULS.shipAssertTag(20492440,307,he.a.mf(Z));if(!this.E1h(Z,h))return!1;this.ih.uI();const oa=(new Ko.a).Lc(15);
oa.Ab(this.qB.Pna);const Ba=Fq.a.aga?this.ib.gb.currentSelection:null;this.lNc.wTi(Z,b);Fq.a.aga&&(b=null!==(A=null===(r=L.placeholderText)||void 0===r?void 0:r.length)&&void 0!==A?A:0,r=h.DJa,Z=Ba&&he.a.mf(Ba.Qa)&&r&&he.a.mf(r.Qa)&&Ba.Qa.node===r.Qa.node&&Ba.Qa.cpBegin>Z.cpBegin?qc.SelectionFactory.ue(Ba.Qa.node,Ba.Qa.cpBegin+b):Ba,h.DJa=Z);this.qB.C2h();oa.dispose();return!0}Yrj(b,h){const r=this.ib.gb.currentSelection.Qa;if(!this.E1h(r,h))return!1;this.ih.uI();this.ga.Ob(vb.a.Bra,2);this.x$i(r,
"intPaste");this.lNc.wTi(r,b);return!0}E1h(b,h){var r,A;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return v.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.dad),h.UU&&(h.UU.fail("Invalid ipContext before InternalPasteAtIp",!0),h.TB=!0),h=new Map,h.set("ErrorLevel","warning"),null===(r=this.kC)||void 0===r?void 0:r.LNb(),this.Yd.logKpiFailure({kpiName:ro.a.Rya,errorName:"InvalidIpContextBeforeInternalPasteAtIp",
optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!he.a.mf(b))return v.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.dad,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),r=new Map,r.set("ErrorLevel","warning"),null===(A=this.kC)||void 0===A?void 0:A.LNb(),this.Yd.logKpiFailure({kpiName:ro.a.Rya,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:r}}}),
h.UU&&(h.UU.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.TB=!0),!1}return!0}x$i(b,h){h=DC.dH(h);this.Nva.Aqo(h,b.node,b.cpBegin);this.Nva.eEn(h.Crf);this.Nva.q5f(h.jRb);this.Nva.d5f(h.VLb);this.Nva.b5f(h.Emb)}$yg(b,h){if(!h.k$j)return!1;h.yx&64&&this.qB.m$j();if(!h.DJa)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Ac.fc(Df.a.G4,{["Reason"]:gf.a.Lsb}),h.UU&&h.UU.fail("No selection after paste",!1),h.TB=!0,!1;this.V2e.hCp(h);this.ih.uI();return!1}}Object(u.a)(sG,
"ClipboardOperationPaste",null,[725]);class tG{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb){this.kC=Tb;this.zd=b;this.qB=h;this.lNc=r;this.gya=A;this.ib=L;this.ga=Z;this.Jaf=Ba;this.JIk=oa;this.SPe=gb;this.BMe=Ab;this.Zd=Jb}create(b,h){h=this.JIk.create(this.ib,h);return new sG(this.zd,this.qB,this.lNc,this.gya,this.ib,this.ga,b,h,this.Jaf,this.SPe,this.BMe,this.Zd,this.kC)}}Object(u.a)(tG,"Factory",null,[704]);class $h{constructor(b,h){this.Ifp=b;this.D$n=h}}Object(u.a)($h,"ParagraphFormatStore",null,
[]);class EC{constructor(b,h,r){this.ib=b;this.hb=h;this.xe=r}Prp(b,h){if(h.uoc){h=b.cua;var r=this.ib.gb.currentSelection.Qa.node,A=null;this.hb.Wb(r)&&(A=this.xe.Cq(r),r=this.hb.o9a(r),A=new $h(A,r));h=new xr(h.context,h.yx,h.UU,h.ica,h.rd,A);b.cua=h}}}Object(u.a)(EC,"ClipboardOperationPasteOvertypeStrategy",null,[703]);class ch{constructor(b){this.WZe=null;this.ib=b;b.UZb(h=>{this.WZe=h},!1)}get h0i(){return!1}hCp(b){b=this.rgf(b);this.Kc(this.ib,b)}rgf(b){let h=b.DJa;(b.x0a||b.GDa)&&b.oAe&&(h=
qc.SelectionFactory.Vy(b.oAe,h.Qa));return h}Kc(b,h){b.Kc(h)}}Object(u.a)(ch,"AClipboardOperationPasteStrategy",null,[751]);class Pz extends ch{constructor(b){super(b)}get ZYa(){return this.WZe}}Object(u.a)(Pz,"ClipboardOperationPasteToLiveSelectionStrategy",ch,[]);class uG extends ch{constructor(b,h){super(b);this.Nbf=null;this.WEk=h;b.UZb(r=>{this.Nbf=r},!0)}get h0i(){return!0}get ZYa(){return this.Nbf}rgf(b){let h=super.rgf(b);b.rd.setValue(Od.a.csj,h);return h=this.WEk.LBi(this.WZe.currentSelection,
this.Nbf.currentSelection,h)}}Object(u.a)(uG,"ClipboardOperationPasteToVirtualSelectionStrategy",ch,[]);class vG{constructor(b){this.Mbf=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ka(Od.a.x0a,!1)&&this.Mbf?new uG(b,this.YFp):new Pz(b)}get YFp(){return null!=this.K6g?this.K6g:this.K6g=Wa.a.instance.Oa("Box4.Actors.IVirtualSelectionMerger")}}Object(u.a)(vG,"ClipboardOperationPasteStrategyFactory",null,[702]);class FC{constructor(b,h,r,A){this.Ac=b;this.lb=h;this.sn=r;this.tg=
A}Xfo(b){(b&1||b&32)&&this.sn.xm&&this.lb.bKb()}Mgn(b,h){return b&1&&this.tg.p2(h,!0)?(this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UG}),!1):!0}}Object(u.a)(FC,"ClipboardOperationWordStrategy",null,[]);class oJ{constructor(){}M7h(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var A=h=0,L=0,Z=0;for(const Ba of r){r=Ba.style;var oa=Ba.selectorText;r=r?r.cssText:null;oa=oa?oa.split(","):null;if(r&&oa&&Ba.type===Ba.STYLE_RULE){Z+=oa.length;for(const gb of oa){0<=gb.indexOf("#")&&h++;
0<=gb.indexOf(".")&&A++;0>gb.indexOf("#")&&0>gb.indexOf(".")&&L++;oa=null;try{oa=b.querySelectorAll(gb)}catch(Ab){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",gb,Ab.message)}if(oa)for(let Ab=0;Ab<oa.length;Ab++)oa[Ab].setAttribute("style",r+(oa[Ab].getAttribute("style")||""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",Z,h,A,L)}else this.V$i();else this.V$i()}V$i(){v.ULS.sendTraceTag(41211202,
307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",aa.a.cE)}}Object(u.a)(oJ,"ExternalPasteCssConverter",null,[701]);class zw{constructor(b){this.lUa=0;this.c3h=null;this.node=b}}Object(u.a)(zw,"ChartConverterArguments",null,[]);class wG{constructor(b=null){this._imgNodesConverted=0;this.Y5=b||Ho.a.xui("")}get Nc(){return this.Y5}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&
(b=new Tt.a(h,this.q5l.bind(this),new zw(b[0])),b.nm("Chart Converter Operation"),b.oi=!h||h.oi,b.run())))}q5l(b,h){var r=h.node;if(1<h.lUa)return!1;if(1===r.nodeType&&"DIV"===r.tagName){const A=r.getAttribute(Hl.jZd);if(A){const L=r.getAttribute(Hl.Fuf),Z=r.getAttribute(Hl.Guf),oa=r.getAttribute(Hl.Duf),Ba=r.getAttribute(Hl.Euf),gb=r.getAttribute(Hl.jYc);r=r.getAttribute(Hl.Huf);L&&Ba&&Z&&"chart"===Z&&gb&&"XLO"===gb&&(h.c3h=new jJ.a(A,L,Z,oa,Ba,gb,r))}}b.Ni(this.SOn.bind(this));return!0}SOn(b,h){var r=
h.node;if(b=h.c3h)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Hl.jZd,b.ccpId),r.setAttribute(Hl.Fuf,b.pKey),r.setAttribute(Hl.Guf,b.type),r.setAttribute(Hl.Euf,b.dc),r.setAttribute(Hl.jYc,b.client),b.version&&r.setAttribute(Hl.Huf,b.version),b.count&&r.setAttribute(Hl.Duf,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.Y5._imgNodesConverted=this._imgNodesConverted;h.lUa++;return!1}}
Object(u.a)(wG,"ChartConverter",null,[]);class xG{constructor(b,h=null,r=null){this.Af=b;this.Y5=h||Ho.a.jGi("");this.HPk=r||Ho.a.kGi("")}get Nc(){return this.Y5}get UFg(){return this.HPk}Qba(b){this.UFg.b++;this.Af.Qba(b)}Oba(){this.Af.Oba()}d8(b){this.UFg.c++;this.Af.d8(b)}Pba(){this.Af.Pba()}Nba(b){this.UFg.d++;this.Af.Nba(b)}Mba(){this.Af.Mba()}reset(){this.Af.reset()}get yYc(){return this.Af.yYc}yga(b,h){this.Nc.b++;this.Af.yga(b,h)}Kba(b){this.Nc.c++;this.Af.Kba(b)}fwb(b){this.Nc.b++;this.Af.fwb(b)}wCa(b){this.Nc.d++;
this.Af.wCa(b)}qMa(b){this.Nc.f++;this.Af.qMa(b)}oYa(b,h){this.Nc.g++;this.Af.oYa(b,h)}nYa(){this.Af.nYa()}xE(b){this.Nc.h++;this.Af.xE(b)}ZF(){this.Af.ZF()}bwb(){this.Af.bwb()}awb(){this.Af.awb()}tYa(b,h){this.Nc.i++;this.Af.tYa(b,h)}Sbb(){this.Af.Sbb()}ACa(b){this.Nc.j++;this.Af.ACa(b)}yCa(){this.Af.yCa()}uMa(b){this.Nc.k++;this.Af.uMa(b)}zCa(){this.Af.zCa()}Xbb(b){this.Nc.l++;this.Af.Xbb(b)}}Object(u.a)(xG,"SemanticEventUsageCollector",null,[222,223]);class GC{constructor(b=null){this.um=b}Zul(b,
h){var r;if(this.um&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const A of h){h=A.replace(/[0-9]+/,"");this.um.KAe.has(b)||this.um.KAe.set(b,new Map);const L=this.um.KAe.get(b);null===L||void 0===L?void 0:L.set(h,(null!==(r=L.get(h))&&void 0!==r?r:0)+1)}}Ii(b){const h=b.Ff;if(h&&this.um&&("font"===h.tagName.toLowerCase()&&this.wao(b),b=h.style)){0===b.length&&this.um.f7c(h.tagName,"no style present");for(let r=0;r<b.length;r++){const A=b[r];A&&0<A.length&&(this.um.f7c(h.tagName,A),this.Zul(A,b.getPropertyValue(A)))}}}wao(b){if((b=
b.Ff)&&"font"===b.tagName.toLowerCase()&&this.um){var h=b.getAttribute("face");h&&0<h.length&&this.um.f7c(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.um.f7c(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.um.f7c(b.tagName,"font-attr-size")}}}Object(u.a)(GC,"HtmlEventUsageCollectorHelper",null,[]);class yG{constructor(b,h,r=null,A=null){this.Fi=h;this.mrk="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.Af=b;this.Y5=r||Ho.a.izi(aa.a.pLb,"");this.Aw=A;this.nrk=new ek.a(Ja.a.vh());for(const L of this.mrk)this.nrk.add(L)}get Nc(){return this.Y5}get um(){return this.Aw}Xh(b){return b?b+1:1}reset(){this.Af.reset()}tle(){this.Af.tle()}AQf(b){if(b&&this.um&&(b.getAttribute&&(b.getAttribute(Hl.FNl)&&(this.um.Rqi=!0),b.getAttribute(Hl.jZd)&&(this.um.zdm=!0),b.getAttribute(Hl.jYc)&&(this.um.sof=b.getAttribute(Hl.jYc)),b.getAttribute(Hl.INl)&&(this.um.Sqi=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Hl.pTm)&&
(this.um.Tqi=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Hl.Z5n)&&(this.um.Xqi=!0);h.startsWith(Hl.Zeo)&&(this.um.Yqi=!0);h.startsWith(Hl.yIp)&&(this.um.Zqi=!0);if(h.startsWith(aa.a.blf)&&h.length===aa.a.blf.length+1){const r=parseInt(F.a.substring(h,h.length-1,h.length));isNaN(r)||(this.um.WWc=r)}if(h===Hl.kQn||h===Hl.lQn)this.um.j1c=!0}return this.Af.AQf(b)}onClose(){this.Af.onClose()}Ion(b){for(const h of b)if("\n"!==h)return!0;return!1}yga(b,h){this.um&&
(this.um.Bdm=!0);this.um&&!this.um.xEf&&b&&(this.um.xEf=this.Ion(b));this.Nc.d=this.Xh(this.Nc.d);this.Af.yga(b,h)}lle(b){this.um&&(this.um.Vqi=!0);this.Nc.e=this.Xh(this.Nc.e);this.Fi.Ii(b);return this.Af.lle(b)}qcg(b){this.Nc.f=this.Xh(this.Nc.f);this.Fi.Ii(b);return this.Af.qcg(b)}rcg(b){this.Nc.g=this.Xh(this.Nc.g);this.Fi.Ii(b);return this.Af.rcg(b)}vcg(b){this.Nc.h=this.Xh(this.Nc.h);this.Fi.Ii(b);return this.Af.vcg(b)}Jcg(b){this.Nc.i=this.Xh(this.Nc.i);this.Fi.Ii(b);return this.Af.Jcg(b)}Lcg(b){this.Nc.j=
this.Xh(this.Nc.j);this.Fi.Ii(b);this.Af.Lcg(b)}sle(b){this.Nc.k=this.Xh(this.Nc.k);this.Fi.Ii(b);return this.Af.sle(b)}Mcg(b){this.Nc.l=this.Xh(this.Nc.l);this.Fi.Ii(b);this.Af.Mcg(b)}Ncg(b){this.Nc.m=this.Xh(this.Nc.m);this.Fi.Ii(b);this.Af.Ncg(b)}Ocg(b){this.Nc.n=this.Xh(this.Nc.n);this.Fi.Ii(b);return this.Af.Ocg(b)}vle(b){this.Nc.o=this.Xh(this.Nc.o);this.Fi.Ii(b);return this.Af.vle(b)}wle(b){this.Nc.p=this.Xh(this.Nc.p);this.Fi.Ii(b);return this.Af.wle(b)}cdg(b){this.Nc.q=this.Xh(this.Nc.q);
this.Fi.Ii(b);return this.Af.cdg(b)}xle(b){this.Nc.r=this.Xh(this.Nc.r);this.Fi.Ii(b);this.Af.xle(b)}edg(b){this.Nc.s=this.Xh(this.Nc.s);this.Fi.Ii(b);return this.Af.edg(b)}zle(b){this.Nc.t=this.Xh(this.Nc.t);this.Fi.Ii(b);return this.Af.zle(b)}Ale(b){this.Nc.u=this.Xh(this.Nc.u);this.Fi.Ii(b);return this.Af.Ale(b)}Dle(b){this.Nc.v=this.Xh(this.Nc.v);this.Fi.Ii(b);return this.Af.Dle(b)}Ele(b){this.Nc.w=this.Xh(this.Nc.w);this.Fi.Ii(b);return this.Af.Ele(b)}qdg(b){this.Nc.x=this.Xh(this.Nc.x);this.Fi.Ii(b);
this.Af.qdg(b)}rdg(b){this.Nc.y=this.Xh(this.Nc.y);this.Fi.Ii(b);return this.Af.rdg(b)}Mle(b){this.Nc.z=this.Xh(this.Nc.z);this.Fi.Ii(b);return this.Af.Mle(b)}Nle(b){this.Nc.ba=this.Xh(this.Nc.ba);this.Fi.Ii(b);return this.Af.Nle(b)}Qle(b){this.Nc.bb=this.Xh(this.Nc.bb);this.Fi.Ii(b);return this.Af.Qle(b)}Rle(b){this.Nc.bc=this.Xh(this.Nc.bc);this.Fi.Ii(b);return this.Af.Rle(b)}Tle(b){this.Nc.bd=this.Xh(this.Nc.bd);this.Fi.Ii(b);return this.Af.Tle(b)}Ule(b){this.Nc.be=this.Xh(this.Nc.be);this.Fi.Ii(b);
return this.Af.Ule(b)}Vle(b){this.Nc.bf=this.Xh(this.Nc.bf);this.Fi.Ii(b);return this.Af.Vle(b)}Xle(b){this.Nc.bg=this.Xh(this.Nc.bg);this.Fi.Ii(b);return this.Af.Xle(b)}Vdg(b){this.Nc.bh=this.Xh(this.Nc.bh);this.Fi.Ii(b);return this.Af.Vdg(b)}fme(b){this.Nc.bi=this.Xh(this.Nc.bi);this.Fi.Ii(b);return this.Af.fme(b)}beg(b){this.Nc.bj=this.Xh(this.Nc.bj);this.Fi.Ii(b);return this.Af.beg(b)}deg(b){this.Nc.bk=this.Xh(this.Nc.bk);this.Fi.Ii(b);this.Af.deg(b)}eeg(b){this.Nc.bl=this.Xh(this.Nc.bl);this.Fi.Ii(b);
return this.Af.eeg(b)}ime(b){this.Nc.bm=this.Xh(this.Nc.bm);this.Fi.Ii(b);return this.Af.ime(b)}jme(b){this.Nc.bm=this.Xh(this.Nc.bm);this.Fi.Ii(b);return this.Af.jme(b)}kme(b){this.Nc.bm=this.Xh(this.Nc.bm);this.Fi.Ii(b);return this.Af.kme(b)}lme(b){this.Nc.bm=this.Xh(this.Nc.bm);this.Fi.Ii(b);return this.Af.lme(b)}mme(b){this.Nc.bm=this.Xh(this.Nc.bm);this.Fi.Ii(b);return this.Af.mme(b)}nme(b){this.Nc.bm=this.Xh(this.Nc.bm);this.Fi.Ii(b);return this.Af.nme(b)}jeg(b){this.Nc.bn=this.Xh(this.Nc.bn);
return this.Af.jeg(b)}ome(b){this.Nc.bo=this.Xh(this.Nc.bo);this.Fi.Ii(b);this.Af.ome(b)}neg(b){this.Nc.bp=this.Xh(this.Nc.bp);return this.Af.neg(b)}pme(b){this.Nc.bq=this.Xh(this.Nc.bq);this.Fi.Ii(b);return this.Af.pme(b)}peg(b){this.Nc.br=this.Xh(this.Nc.br);this.Fi.Ii(b);return this.Af.peg(b)}tme(b){this.um&&(this.um.Uqi=!0);this.Fi.Ii(b);this.Nc.bs=this.Xh(this.Nc.bs);this.Af.tme(b)}veg(b){this.Nc.bt=this.Xh(this.Nc.bt);this.Fi.Ii(b);this.Af.veg(b)}ume(b){this.Nc.bu=this.Xh(this.Nc.bu);this.Fi.Ii(b);
return this.Af.ume(b)}Aeg(b){this.Nc.bv=this.Xh(this.Nc.bv);this.Fi.Ii(b);return this.Af.Aeg(b)}xme(b){this.Nc.bw=this.Xh(this.Nc.bw);this.Fi.Ii(b);return this.Af.xme(b)}zme(b){this.Nc.bx=this.Xh(this.Nc.bx);this.Fi.Ii(b);return this.Af.zme(b)}Bme(b){this.Nc.by=this.Xh(this.Nc.by);this.Fi.Ii(b);return this.Af.Bme(b)}Cme(b){this.um&&(this.um.j1c=!0);this.Nc.bz=this.Xh(this.Nc.bz);this.Fi.Ii(b);return this.Af.Cme(b)}Leg(b){this.Nc.ca=this.Xh(this.Nc.ca);this.Fi.Ii(b);this.Af.Leg(b)}Peg(b){this.Nc.cb=
this.Xh(this.Nc.cb);this.Fi.Ii(b);return this.Af.Peg(b)}Eme(b){this.um&&(this.um.Adm=!0);this.Nc.cc=this.Xh(this.Nc.cc);this.Fi.Ii(b);return this.Af.Eme(b)}onMenuOpen(b){this.Nc.cd=this.Xh(this.Nc.cd);this.Fi.Ii(b);return this.Af.onMenuOpen(b)}Veg(b){this.Nc.ce=this.Xh(this.Nc.ce);this.Af.Veg(b)}cfg(b){this.Nc.cf=this.Xh(this.Nc.cf);this.Fi.Ii(b);return this.Af.cfg(b)}dfg(b){this.Nc.cg=this.Xh(this.Nc.cg);this.Fi.Ii(b);return this.Af.dfg(b)}ffg(b){this.Nc.ch=this.Xh(this.Nc.ch);this.Fi.Ii(b);return this.Af.ffg(b)}Pme(b){this.um&&
(this.um.j1c=!0);this.Nc.ci=this.Xh(this.Nc.ci);this.Fi.Ii(b);return this.Af.Pme(b)}hfg(b){this.Nc.cj=this.Xh(this.Nc.cj);this.Fi.Ii(b);return this.Af.hfg(b)}Rme(b){this.Nc.ck=this.Xh(this.Nc.ck);this.Fi.Ii(b);return this.Af.Rme(b)}Vme(b){this.Nc.cl=this.Xh(this.Nc.cl);this.Fi.Ii(b);return this.Af.Vme(b)}ofg(b){this.Nc.cm=this.Xh(this.Nc.cm);this.Fi.Ii(b);this.Af.ofg(b)}cne(b){this.Nc.cn=this.Xh(this.Nc.cn);this.Fi.Ii(b);return this.Af.cne(b)}Afg(b){this.Nc.co=this.Xh(this.Nc.co);this.Fi.Ii(b);return this.Af.Afg(b)}kne(b){this.Nc.cp=
this.Xh(this.Nc.cp);this.Fi.Ii(b);return this.Af.kne(b)}lne(b){this.Nc.cq=this.Xh(this.Nc.cq);this.Fi.Ii(b);return this.Af.lne(b)}Qfg(b){this.Nc.cr=this.Xh(this.Nc.cr);return this.Af.Qfg(b)}Wfg(b){this.Nc.cs=this.Xh(this.Nc.cs);this.Fi.Ii(b);return this.Af.Wfg(b)}wne(b){this.Nc.ct=this.Xh(this.Nc.ct);this.Fi.Ii(b);return this.Af.wne(b)}xne(b){this.Nc.cu=this.Xh(this.Nc.cu);this.Fi.Ii(b);return this.Af.xne(b)}Ane(b){this.Nc.cv=this.Xh(this.Nc.cv);this.Fi.Ii(b);return this.Af.Ane(b)}Bne(b){this.Nc.cw=
this.Xh(this.Nc.cw);this.Fi.Ii(b);return this.Af.Bne(b)}$fg(b){this.Nc.cx=this.Xh(this.Nc.cx);return this.Af.$fg(b)}Cne(b){this.Nc.cy=this.Xh(this.Nc.cy);this.Fi.Ii(b);return this.Af.Cne(b)}Ene(b){this.Nc.cz=this.Xh(this.Nc.cz);this.Fi.Ii(b);return this.Af.Ene(b)}Gne(b){this.um&&(this.um.iAa=!0);this.Nc.da=this.Xh(this.Nc.da);this.Fi.Ii(b);return this.Af.Gne(b)}egg(b){this.um&&(this.um.iAa=!0);this.Nc.db=this.Xh(this.Nc.db);this.Fi.Ii(b);return this.Af.egg(b)}Jfd(b){this.um&&(this.um.iAa=!0);this.Nc.dc=
this.Xh(this.Nc.dc);this.Fi.Ii(b);return this.Af.Jfd(b)}igg(b){this.Nc.dd=this.Xh(this.Nc.dd);this.Fi.Ii(b);return this.Af.igg(b)}jgg(b){this.Nc.de=this.Xh(this.Nc.de);this.Fi.Ii(b);return this.Af.jgg(b)}Jne(b){this.um&&(this.um.iAa=!0);this.Nc.df=this.Xh(this.Nc.df);this.Fi.Ii(b);return this.Af.Jne(b)}kgg(b){this.um&&(this.um.iAa=!0);this.Nc.dg=this.Xh(this.Nc.dg);this.Fi.Ii(b);return this.Af.kgg(b)}ngg(b){this.Nc.dh=this.Xh(this.Nc.dh);this.Fi.Ii(b);return this.Af.ngg(b)}One(b){this.um&&(this.um.iAa=
!0);this.Nc.di=this.Xh(this.Nc.di);this.Fi.Ii(b);return this.Af.One(b)}Pne(b){this.Nc.dj=this.Xh(this.Nc.dj);this.Fi.Ii(b);return this.Af.Pne(b)}Qne(b){this.Nc.dk=this.Xh(this.Nc.dk);this.Fi.Ii(b);return this.Af.Qne(b)}Rne(b){this.um&&(this.um.j1c=!0);this.Nc.dl=this.Xh(this.Nc.dl);this.Fi.Ii(b);return this.Af.Rne(b)}Wne(b){this.Nc.dm=this.Xh(this.Nc.dm);this.Fi.Ii(b);return this.Af.Wne(b)}Tne(b){this.Nc.dn=this.Xh(this.Nc.dn);this.Fi.Ii(b);return this.Af.Tne(b)}}Object(u.a)(yG,"HtmlEventUsageCollector",
null,[229]);class $A{constructor(b,h,r=!1){this.Ff=b;this.kD=h;this.K7k=r}}Object(u.a)($A,"TagEventParam",null,[]);class vE{constructor(b,h=null){this.Pzd=this._prunedElements=this.xaf=this._voidElements=null;this.Ad=b;this.Y5=h||Ho.a.jzi("");this.g0o()}get Nc(){return this.Y5}XTn(b,h,r){this.xaf[h]?this.Chj():(this.Nc.e++,(h=this.Pzd[h])&&h(new $A(b,r,!1)),this.Nc.b++)}Chj(){this.Nc.d++}QTn(){this.Nc.c++}CTn(b,h,r){if(this.xaf[h])this.Chj();else{if(h=this.Pzd[h])return this.Nc.b++,h(new $A(b,r,!1));
this.Nc.f++;return this.Ad.Tne(new $A(b,null))}return 2}g0o(){this._voidElements=mb.a.V8("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.xaf=mb.a.V8("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=mb.a.V8("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",
!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.Ad,h=this.Ad,r=this.Ad,A=this.Ad,L=this.Ad,Z=this.Ad,oa=this.Ad,Ba=this.Ad,gb=this.Ad,Ab=this.Ad,Jb=this.Ad,Tb=this.Ad,jc=this.Ad,Hc=this.Ad,hd=this.Ad,Gd=this.Ad,de=this.Ad,qe=this.Ad,oe=this.Ad,ge=this.Ad;this.Pzd=mb.a.V8("A",Object(D.a)(this.Ad,this.Ad.lle,"onAOpen"),"ABBR",Object(D.a)(this.Ad,this.Ad.qcg,"onAbbrOpen"),"ACRONYM",Object(D.a)(this.Ad,
this.Ad.rcg,"onAcronymOpen"),"ADDRESS",Object(D.a)(this.Ad,this.Ad.vcg,"onAddressOpen"),"APPLET",Object(D.a)(this.Ad,this.Ad.Jcg,"onAppletOpen"),"AREA",Object(D.a)(this.Ad,this.Ad.Lcg,"onAreaTag"),"B",Object(D.a)(this.Ad,this.Ad.sle,"onBOpen"),"BASE",Object(D.a)(this.Ad,this.Ad.Mcg,"onBaseTag"),"BASEFONT",Object(D.a)(this.Ad,this.Ad.Ncg,"onBasefontTag"),"BDO",Object(D.a)(this.Ad,this.Ad.Ocg,"onBdoOpen"),"BIG",Object(D.a)(this.Ad,this.Ad.vle,"onBigOpen"),"BLOCKQUOTE",Object(D.a)(this.Ad,this.Ad.wle,
"onBlockquoteOpen"),"BODY",Object(D.a)(this.Ad,this.Ad.cdg,"onBodyOpen"),"BR",Object(D.a)(this.Ad,this.Ad.xle,"onBrTag"),"BUTTON",Object(D.a)(this.Ad,this.Ad.edg,"onButtonOpen"),"CAPTION",Object(D.a)(this.Ad,this.Ad.zle,"onCaptionOpen"),"CENTER",Object(D.a)(this.Ad,this.Ad.Ale,"onCenterOpen"),"CITE",Object(D.a)(this.Ad,this.Ad.Dle,"onCiteOpen"),"CODE",Object(D.a)(this.Ad,this.Ad.Ele,"onCodeOpen"),"COL",Object(D.a)(this.Ad,this.Ad.qdg,"onColTag"),"COLGROUP",Object(D.a)(this.Ad,this.Ad.rdg,"onColgroupOpen"),
"DD",Object(D.a)(this.Ad,this.Ad.Mle,"onDdOpen"),"DEL",Object(D.a)(this.Ad,this.Ad.Nle,"onDelOpen"),"DFN",Object(D.a)(this.Ad,this.Ad.Qle,"onDfnOpen"),"DIR",Object(D.a)(this.Ad,this.Ad.Rle,"onDirOpen"),"DIV",Object(D.a)(this.Ad,this.Ad.Tle,"onDivOpen"),"DL",Object(D.a)(this.Ad,this.Ad.Ule,"onDlOpen"),"DT",Object(D.a)(this.Ad,this.Ad.Vle,"onDtOpen"),"EM",Object(D.a)(this.Ad,this.Ad.Xle,"onEmOpen"),"FIELDSET",Object(D.a)(this.Ad,this.Ad.Vdg,"onFieldsetOpen"),"FONT",Object(D.a)(this.Ad,this.Ad.fme,"onFontOpen"),
"FORM",Object(D.a)(this.Ad,this.Ad.beg,"onFormOpen"),"FRAME",Object(D.a)(this.Ad,this.Ad.deg,"onFrameTag"),"FRAMESET",Object(D.a)(this.Ad,this.Ad.eeg,"onFramesetOpen"),"H1",Object(D.a)(this.Ad,this.Ad.ime,"onH1Open"),"H2",Object(D.a)(this.Ad,this.Ad.jme,"onH2Open"),"H3",Object(D.a)(this.Ad,this.Ad.kme,"onH3Open"),"H4",Object(D.a)(this.Ad,this.Ad.lme,"onH4Open"),"H5",Object(D.a)(this.Ad,this.Ad.mme,"onH5Open"),"H6",Object(D.a)(this.Ad,this.Ad.nme,"onH6Open"),"HEAD",Object(D.a)(this.Ad,this.Ad.jeg,
"onHeadOpen"),"HR",Object(D.a)(this.Ad,this.Ad.ome,"onHrTag"),"HTML",Object(D.a)(this.Ad,this.Ad.neg,"onHtmlOpen"),"I",Object(D.a)(this.Ad,this.Ad.pme,"onIOpen"),"IFRAME",Object(D.a)(this.Ad,this.Ad.peg,"onIframeOpen"),"IMG",Object(D.a)(this.Ad,this.Ad.tme,"onImgTag"),"INPUT",Object(D.a)(this.Ad,this.Ad.veg,"onInputTag"),"INS",Object(D.a)(this.Ad,this.Ad.ume,"onInsOpen"),"ISINDEX",Object(D.a)(this.Ad,this.Ad.Aeg,"onIsindexOpen"),"KBD",Object(D.a)(this.Ad,this.Ad.xme,"onKbdOpen"),"LABEL",Object(D.a)(this.Ad,
this.Ad.zme,"onLabelOpen"),"LEGEND",Object(D.a)(this.Ad,this.Ad.Bme,"onLegendOpen"),"LI",Object(D.a)(this.Ad,this.Ad.Cme,"onLiOpen"),"LINK",Object(D.a)(this.Ad,this.Ad.Leg,"onLinkTag"),"MAP",Object(D.a)(this.Ad,this.Ad.Peg,"onMapOpen"),"MATH",Object(D.a)(this.Ad,this.Ad.Eme,"onMathOpen"),"MENU",Object(D.a)(this.Ad,this.Ad.onMenuOpen,"onMenuOpen"),"META",Object(D.a)(this.Ad,this.Ad.Veg,"onMetaTag"),"NOFRAMES",Object(D.a)(this.Ad,this.Ad.cfg,"onNoframesOpen"),"NOSCRIPT",Object(D.a)(this.Ad,this.Ad.dfg,
"onNoscriptOpen"),"OBJECT",Object(D.a)(this.Ad,this.Ad.ffg,"onObjectOpen"),"OL",Object(D.a)(this.Ad,this.Ad.Pme,"onOlOpen"),"OPTGROUP",Object(D.a)(this.Ad,this.Ad.hfg,"onOptgroupOpen"),"OPTION",Object(D.a)(this.Ad,this.Ad.Rme,"onOptionOpen"),"P",Object(D.a)(this.Ad,this.Ad.Vme,"onPOpen"),"PARAM",Object(D.a)(this.Ad,this.Ad.ofg,"onParamTag"),"PRE",Object(D.a)(this.Ad,this.Ad.cne,"onPreOpen"),"Q",Object(D.a)(this.Ad,this.Ad.Afg,"onQOpen"),"S",Object(D.a)(this.Ad,this.Ad.kne,"onSOpen"),"SAMP",Object(D.a)(this.Ad,
this.Ad.lne,"onSampOpen"),"SCRIPT",Object(D.a)(this.Ad,this.Ad.Qfg,"onScriptOpen"),"SELECT",Object(D.a)(this.Ad,this.Ad.Wfg,"onSelectOpen"),"SMALL",Object(D.a)(b,b.wne,"onSmallOpen"),"SPAN",Object(D.a)(h,h.xne,"onSpanOpen"),"STRIKE",Object(D.a)(r,r.Ane,"onStrikeOpen"),"STRONG",Object(D.a)(A,A.Bne,"onStrongOpen"),"STYLE",Object(D.a)(L,L.$fg,"onStyleOpen"),"SUB",Object(D.a)(Z,Z.Cne,"onSubOpen"),"SUP",Object(D.a)(oa,oa.Ene,"onSupOpen"),"TABLE",Object(D.a)(Ba,Ba.Gne,"onTableOpen"),"TBODY",Object(D.a)(gb,
gb.egg,"onTbodyOpen"),"TD",Object(D.a)(Ab,Ab.Jfd,"onTdOpen"),"TEXTAREA",Object(D.a)(Jb,Jb.igg,"onTextareaOpen"),"TFOOT",Object(D.a)(Tb,Tb.jgg,"onTfootOpen"),"TH",Object(D.a)(jc,jc.Jne,"onThOpen"),"THEAD",Object(D.a)(Hc,Hc.kgg,"onTheadOpen"),"TITLE",Object(D.a)(hd,hd.ngg,"onTitleOpen"),"TR",Object(D.a)(Gd,Gd.One,"onTrOpen"),"TT",Object(D.a)(de,de.Pne,"onTtOpen"),"U",Object(D.a)(qe,qe.Qne,"onUOpen"),"UL",Object(D.a)(oe,oe.Rne,"onUlOpen"),"VAR",Object(D.a)(ge,ge.Wne,"onVarOpen"))}}Object(u.a)(vE,"AHtmlProcessor",
null,[]);class dx{constructor(b,h){this.childNodes=b.childNodes;this.kD=h;this.Utf=0;this.gde=!1}}Object(u.a)(dx,"HtmlProcessorArguments",null,[]);class ex extends vE{constructor(b,h,r=null){super(b,r);this.kC=h;this.eXe=null}get Tpn(){null==this.eXe&&(this.eXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.eXe}process(b,h=null){b&&(this.Ad.reset(),this.wvj(new dx(b,new Iy.a),h))}wvj(b,h){b.childNodes.length&&(b=new Tt.a(h,Object(D.a)(this,
this.Xho,"processChild"),b),b.nm("HTML Processing Operation"),h||(b.oi=!0),b.run())}Xho(b,h){var r;const A=h.childNodes[h.Utf];if(3===A.nodeType)return this.Ad.tle(),this.Ad.yga(A.nodeValue,new $A(A,h.kD.Rvi())),ex.xAc(h);if(1!==A.nodeType)return ex.xAc(h);if(!h.gde){const Z=F.a.tC(A.tagName);if(!ex.DYm(A))if(this._prunedElements[Z])this.QTn();else{ex.gKn(A);null===(r=this.kC)||void 0===r?void 0:r.R5m();this.Ad.tle();var L=A.id;const oa=A.tagName;r=h.kD.Rvi();const Ba=A.getAttribute?A.getAttribute("class"):
null;L=new Dq(L,oa,Ba?Ba:"",A.attributes?A.attributes.length:0);L.isValid&&r.add(L);if(this._voidElements[Z])return this.XTn(A,Z,r),ex.xAc(h);L=!1;switch(this.CTn(A,Z,r)){case 1:L=!0;break;case 3:return ex.xAc(h)}switch(this.Ad.AQf(A)){case 1:L=!0}h.gde=L;this.wvj(new dx(A,r),b);if(!b.oi)return!0}}if(h.gde){if(this.Tpn&&!this.Pzd[F.a.tC(A.tagName)])return ex.xAc(h);this.Ad.onClose()}return ex.xAc(h)}static gKn(b){3!==b.nodeType&&ii.a.Cm(b,"alreadyPasted",!0)}static DYm(b){return 3!==b.nodeType&&ii.a.Eb(b,
"alreadyPasted")}static xAc(b){b.Utf++;b.gde=!1;return b.Utf<b.childNodes.length}}Object(u.a)(ex,"HtmlProcessor",vE,[]);var wE=d(555);const xE={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,
["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,
["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,
["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,
["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,
["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,
["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,
["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,
["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,
["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,
["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,
["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,
["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,
["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,
["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,
["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,
["border-right"]:325,["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,
["page-break-after"]:352,["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,
["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},HC={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,
["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,
["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,
["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class Oy{constructor(){this.yx=0;this.WWc=6;this.zdm=this.Rqi=!1;this.sof=null;this.Zqi=this.Yqi=this.Xqi=this.Tqi=this.Sqi=!1;this.progId=null;this.xEf=this.Vqi=this.Uqi=this.iAa=this.j1c=
this.Adm=this.Bdm=!1;this.fsj=this.wtc=0;this.Epj=this.platform=null;this.fVi=this.hpc=!1;this.KAe=new Map;this.zOk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.nxf=[1,3,4,2,5];this.zEb={}}get QCg(){if(null!==this.sof)switch(this.sof){case "XLO":return"Excel Online"}if(this.Zqi)return"Word Online";if(this.Yqi||this.Sqi)return"PowerPoint Online";if(this.Rqi)return"Excel Online";
if(this.Tqi)return"Google Docs";if(this.Xqi)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}YT(b,h){const r=new da.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}$md(b,h,r){const A=new wE.a;A.name=b;A.dataFields=h;A.dnmInterval=r;A.dnmAllowedPartA=this.nxf;Y.a.sendDirectNumericEvent(A)}iHn(){for(const [b,
h]of this.KAe)for(const [r,A]of h){const L=[this.YT("style",b),this.YT("unit",r),this.YT("frequency",A)];Object(me.a)("StylesAndUnitsFrequency",!0,0,L)}}jFn(){const b=this.Qgl(),h=[],r=[this.YT("isUserConsumer",this.hpc),this.YT("isDocumentBlank",this.fVi),this.YT("FoundText",this.xEf),this.YT("FoundTable",this.iAa),this.YT("FoundImage",this.Uqi),this.YT("FoundList",this.j1c),this.YT("FoundLink",this.Vqi),this.YT("Browser",this.wtc),this.YT("SourceApp",this.zOk[this.QCg])];for(const A of r)h.push(A);
this.$md("Office.DNM.Word.Online.ExternalPasteEvent2",h,2);v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}WEl(b,h){var r,A;const L=[];b=this.YT("tag",null!==(r=HC[b])&&void 0!==r?r:HC.OTHERS);h=this.YT("style",null!==(A=xE[h])&&void 0!==A?A:xE.OTHERS);A=this.YT("IsUserConsumer",this.hpc);L.push(b);L.push(h);L.push(A);this.$md("Office.DNM.Word.Online.ExternalPasteEvent1",L,2)}XEl(b){var h;const r=[];b=this.YT("tag",null!==(h=HC[b])&&void 0!==h?h:HC.OTHERS);h=this.YT("IsUserConsumer",this.hpc);
r.push(b);r.push(h);this.$md("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}kFn(){const b=this.zEb;for(const A in b){var h=A,r=b[A];this.XEl(h);for(const L of Object.keys(r))this.WEl(h,L)}}f7c(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.zEb||(this.zEb[b]={}),this.zEb[b][h]=this.rMm(b,h)+1)}rMm(b,h){if(!(b&&b.length&&h&&h.length&&this.zEb&&b in this.zEb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.zEb[b])&&h in b?b[h]:0}Qgl(){const b={};b.ActionIdFlags=
this.yx;b.SourceApp=this.QCg;b.CopySourceBrowser=this.WWc;b.PasteBrowser=this.wtc;b.IsSameBrowserPaste=this.Prn(this.WWc,this.wtc);b.IsCrossBrowserPaste=this.Xhn(this.WWc,this.wtc);b.IsUncategorizedBrowserPaste=this.Jun(this.WWc,this.wtc);b.Platform=this.platform;b.OperationId=this.Epj;return b}Prn(b,h){return 5===b||6===b?!1:b===h}Xhn(b,h){return 6===b?!1:b!==h}Jun(b,h){return 5===b&&5===h}}Object(u.a)(Oy,"HtmlContentMetadata",null,[]);var IC=d(260),yE=d(1064),Vq=d(351),ai=d(47),Ut=d(89),Vx;(function(b){b[b.vfk=
0]="EmptyPara";b[b.mjk=1]="StartingOfPara";b[b.Ghk=2]="MiddleOfPara";b[b.xfk=3]="EndOfPara"})(Vx||(Vx={}));Object(u.b)("PasteContext",Vx);class ap{constructor(b,h,r,A,L,Z,oa){this.aic=oa;this.RXe=!1;this.B1j=this.nWe=null;this.Lao=Ba=>{let gb=!1;return Ok.a.Etb?(Cq.a.instance.le(()=>{gb=this.Trj(Ba)},"APEM:PE"),gb):this.Trj(Ba)};this.Trj=Ba=>{db.a.mark(5568);this.Hli(Ba);let gb=this.CMn;if(this.UZi){const Ab=this.pTj();Ab&&(gb=this.wwb);v.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",
Ab)}Ba.Ni(gb);return!0};this.CMn=Ba=>{db.a.mark(5569);var gb=new hb.a;this.xcb.restore(gb);var Ab=new hb.a;this.HDf.restore(Ab);this.HDf=null;v.ULS.shipAssertTag(6305489,307,Eb.a.Mh(gb));v.ULS.shipAssertTag(6305490,307,Eb.a.Mh(Ab));fg.OutlineElementNavigator.Me(gb);const Jb=Cd.ParagraphReader.Fh(gb)?Cd.ParagraphReader.textLength(gb.currentNode):0;fg.OutlineElementNavigator.me(gb);fg.OutlineElementNavigator.Me(Ab);v.ULS.shipAssertTag(6305491,307,Cd.ParagraphReader.Fh(Ab));const Tb=Cd.ParagraphReader.textLength(Ab.currentNode);
fg.OutlineElementNavigator.me(Ab);var jc=y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8111697_MergeParagraphsAfterCCPlaceholderPaste")&&this.lYi();let Hc=this.Wod||jc;var hd=new zl.a;hd.nd(gb);fg.OutlineElementNavigator.ft(hd,!1,!1);var Gd=hd.currentNode===Ab.currentNode,de=!!this.Ui&&!!(this.Ui.yx&8192);let qe=!1;!de&&this.Ui.rd&&Object(Gb.a)(lj.DictionaryPropertySet,this.Ui.rd)&&(de=(jc=this.Ui.rd.zf(Od.a.rXb))&&""!==jc?!0:!1);jc=!1;this.Ui.rd instanceof
IC.a&&(jc=this.Ui.rd.ka(Od.a.Vfa,!1));if(Gd){hd=hb.a.eb(gb.currentNode);Cd.ParagraphReader.uu(fg.OutlineElementNavigator.Me(hd))||(gb=Ab);gb.currentNode.id!==Ab.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",sf.ListItemReader.Fg(gb),sf.ListItemReader.Fg(Ab)),de=ap.Mf.merge(gb,Ab,!0,de),v.ULS.shipAssertTag(6305492,307,de));Ab=gb;var oe=!0}else{Gd=!!(this.Ui.yx&4);oe=this.Qd.Bg&&Gd&&this.Ui.K$a;var ge=!!(this.Ui.yx&
262144);this.Tig&&this.Ui&&!Gd&&!ge&&(this.Tig.iMi(gb,!1),this.Tig.iMi(Ab,!0));fg.OutlineElementNavigator.Me(hd);Gd=Cd.ParagraphReader.Fh(hd)?Cd.ParagraphReader.textLength(hd.currentNode):0;fg.OutlineElementNavigator.me(hd);this.lYi()||this.b$k(hd,gb,Ab);ge=new zl.a;ge.nd(hd);fg.OutlineElementNavigator.ft(ge,!1,!1);ge.currentNode.id===Ab.currentNode.id&&(this.RXe=!0);if(this.ZZ.ETa||this.O3o)if(ge.Aq.id!==Ab.Aq.id){for(;hd.currentNode.id!==Ab.currentNode.id;)fg.OutlineElementNavigator.Me(hd,!1),this.ZZ.GNa(xc.a.create(hd.currentNode)),
hd.uc(),fg.OutlineElementNavigator.ft(hd,!1,!1);hd.nd(gb);fg.OutlineElementNavigator.ft(hd,!1,!1)}else qe=!0;this.lda&&({Wod:Hc,fAa:hd}=this.lda.Ylg(gb,Ab,Hc,hd));Ut.a.mL&&this.aic&&(hd=this.aic.Ylg(gb,Ab,hd));if(this.Ui.jue&&(v.ULS.shipAssertTag(6305493,307,this.Ui.uoc),ge=new hb.a,ge.nd(hd),ge=fg.OutlineElementNavigator.Me(ge))){var $d=this.Ui.jue.Of(ge.ra.Ub(0));ge.ra.Ub(0).formatting=$d}ge=0;de&&this.W2e&&(ge=1);$d=this.r4o(gb,hd,ge);this.Ui.oAe=null;if(this.Ui.GDa||this.Ui.x0a)this.Ui.oAe=this.XLm($d?
gb.currentNode:hd.currentNode,$d);var lf=!1;$d&&(lf=sf.ListItemReader.Fg(gb),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",lf,sf.ListItemReader.Fg(Ab)),this.nWe=lf=ap.Mf.merge(gb,hd,!0,de,Ab,void 0,qe,oe,this.W2e),this.s4o(gb,ge)&&this.ZMn(gb,Ab,ge,de));ge=ap.Zao.f9m(gb,hd,Ab,Jb,lf,this.ZSb);var wf=!1;if(Hc){const gi=new zl.a;gi.nd(Ab);fg.OutlineElementNavigator.y3(gi,!1,!1);wf=sf.ListItemReader.Fg(gi);const Di=sf.ListItemReader.Fg(Ab),
Yl=jc;v.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",Yl);const xk=!!(this.Ui.yx&524288);oe=ap.Mf.merge(gi,Ab,!0,de,void 0,!0,void 0,oe,this.W2e,Yl,!xk,!xk);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",wf,Di,oe?"True":"False, will cause IP to reset to zero.");Ab=(wf=oe)?gi:Ab}else oe=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.ZZ.ETa&&
qe&&($d&&!this.Bkn(ge,lf)?(hd=new hb.a,hd.nd(gb),gb=fg.OutlineElementNavigator.Me(hd),this.ZZ.ava(gb,Jb,Jb+Gd)):Hc&&!this.gnn(ge,wf)?(gb=new hb.a,gb.nd(hd),gb=fg.OutlineElementNavigator.Me(gb),this.ZZ.ava(gb,0,Gd)):(gb=new hb.a,gb.nd(hd),gb=fg.OutlineElementNavigator.Me(gb),this.ZZ.GNa(xc.a.create(gb))));this.Peo(ge);de||this.aD.Uio(ge)}v.ULS.shipAssertTag(6305494,307,Ab.isValid);de=fg.OutlineElementNavigator.Me(Ab);gb=oe?Cd.ParagraphReader.textLength(de)-Tb:0;this.Ui.DJa=jc?qc.SelectionFactory.eL(de,
gb-1,gb):qc.SelectionFactory.ue(de,gb);this.Ui&&this.Ui.uoc&&Cd.ParagraphReader.Wb(de)&&this.Ui.poe&&((jc=this.Ui.poe.Ifp)&&this.mM.ZP(jc,de,!0),(jc=this.Ui.poe.D$n)&&this.ql.fTh(de,jc));Ok.a.pgk&&this.$Vk(this.vFm(Jb,Tb));Ba.Ni(this.wwb);return!0};this.EZo=Ba=>{const gb=hb.a.eb(this.B1j);gb.xL(1);this.Ui.DJa=qc.SelectionFactory.qp(gb.currentNode,!1);Ba.Ni(this.wwb);return!0};this.wwb=()=>{var Ba=void 0===this.Ui.yx||null===this.Ui.yx?"not available":Object(YA.a)(Oz,this.Ui.yx);v.ULS.sendTraceTag(8765523,
307,50,"PasteTeardown: {0} [{1}].",this.Ui.yx,Ba);v.ULS.shipAssertTag(6305497,307,!!this.Ui.DJa);this.ZSb?Object(me.a)("ExternalPasteAction",!0):Object(me.a)("InternalPasteAction",!0);this.xcb&&(Ba=new hb.a,this.xcb.restore(Ba),this.xcb=null,this.QXm(Ba));this.transaction.dispose();this.ZSb&&Hv.a.qGn();Ba=this.Sy.Gw;if(!Ba.ve||!Ba.Ie.Kk)return!1;Ba.Ie.ujp();return!1};this.dLa=b;this.HDf=this.xcb=null;this.Ui=h;this.transaction=r;this.lda=A;this.Sy=L;this.O9=Z}get J(){return y.AFrameworkApplication.J}get W2e(){return!!this.J&&
this.J.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get aD(){return null!=this.ZVg?this.ZVg:this.ZVg=Wa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get mM(){return null!=this.O6g?this.O6g:this.O6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get Yb(){return null!=this.l7g?this.l7g:this.l7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get ql(){return null!=this.g2g?this.g2g:this.g2g=Wa.a.instance.resolve("Box4.IParagraphEditor")}get Pd(){return null!=this.B0g?this.B0g:this.B0g=
Wa.a.instance.resolve("Box4.List.IListReader")}get Kl(){return null!=this.m0g?this.m0g:this.m0g=Wa.a.instance.resolve("Box4.List.IListEditor")}get LF(){return null!=this.SWg?this.SWg:this.SWg=Wa.a.instance.resolve("Box4.IBox4GraphWriter")}get Gpd(){return null!=this.L3g?this.L3g:this.L3g=Wa.a.instance.Oa("Box4.List.ISingleLevelListEditor")}get Lj(){return null!=this.G5g?this.G5g:this.G5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get ti(){return null!=this.m6g?this.m6g:
this.m6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Qd(){return null!=this.S5g?this.S5g:this.S5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get ZZ(){return null!=this.qSg?this.qSg:this.qSg=Wa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get Tig(){return null!=this.u2g?this.u2g:this.u2g=Wa.a.instance.Oa("Box4.IPastedParagraphSpaceHandler")}get nsj(){return!1}Jli(){}get ZSb(){return!1}asj(b){let h=!1;return Ok.a.Etb?
(Cq.a.instance.le(()=>{h=this.bsj(b)},"APEM:PS"),h):this.bsj(b)}bsj(b){var h=void 0===this.Ui.yx||null===this.Ui.yx?"not available":Object(YA.a)(Oz,this.Ui.yx);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Ui.yx,h);v.ULS.shipAssertTag(6305487,307,he.a.mf(this.dLa));if(this.Mke)return v.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Ui.DJa=qc.SelectionFactory.Uo(this.dLa),b.Ni(this.wwb),!0;if(!this.dLa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),
!1;h=new hb.a;h.set(this.dLa.node);he.a.Ou(h);fg.OutlineElementNavigator.me(h);this.B1j=h.origin;if(this.nsj)return h.mt(10),this.Jli(h,b),b.Ni(this.EZo),!0;this.lda&&this.lda.CWn(this.dLa);if(!this.Hcp(this.dLa))return this.Ui.UU&&(this.Ui.UU.fail("SplitLine Failed",!0),this.Ui.TB=!0),this.Ui.DJa=qc.SelectionFactory.Uo(this.dLa),b.Ni(this.wwb),!0;const r=new zl.a;r.nd(h);fg.OutlineElementNavigator.ft(r,!1,!1);this.xcb=new yE.a(h);this.HDf=new yE.a(r);b.Ni(this.Lao);return!0}pTj(){return!1}get UZi(){return this.J.$("PptCcpFix2IsEnabled")}get O3o(){return this.J.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}vFm(b,
h){if(0==b&&0==h)return Vx.vfk;if(0==b&&0!=h)return Vx.mjk;if(0!=b&&0!=h)return Vx.Ghk;if(0==h&&0!=b)return Vx.xfk}$Vk(b){b=[Object.assign(new da.a,{name:"isExternalPaste",bool:this.ZSb}),Object.assign(new da.a,{name:"Single OE",bool:this.RXe}),Object.assign(new da.a,{name:"Context",string:b})];Object(me.a)("ContextualTelemetryForPaste",!0,void 0,b)}Bkn(b,h){return!h&&!!b&&Eb.a.Mh(b.fAa)&&Eb.a.Jnb(b.fAa)}gnn(b,h){return!h&&!!b&&Eb.a.Mh(b.oub)&&Eb.a.Jnb(b.oub)}Peo(b){ap.$tj&&b&&ap.$tj.Qio(b)}r4o(b,
h,r){var A;sf.ListItemReader.Fg(b)?(null===(A=this.Gpd)||void 0===A?void 0:A.KTf(b),h=sf.ListItemReader.Fg(h)?this.ISj:!0):Eb.a.isEmpty(b,!0)&&!r?(ap.Mf.z7a(b),h=!1):h=!0;this.lda&&(h=this.lda.fql(b,h));return h}s4o(b,h){return sf.ListItemReader.Fg(b)||1===h?!0:!1}ZMn(b,h,r,A){const L=sf.ListItemReader.Fg(b);if(L){if(A=new zl.a,A.nd(b),fg.OutlineElementNavigator.ft(A,!1,!1),A.Aq.id!==h.Aq.id){r=this.Pd.Uw(b);if(sf.ListItemReader.De)({listId:Z}=sf.ListItemReader.nla(b,{Ara:0}));else{this.Pd.q0(b);
var Z=b.currentNode.ka(Vc.a.listID,0);b.uc()}var oa=this.Pd.RVj,Ba=!0;for(r.yD=pk.a.Ok;A.currentNode.id!==h.currentNode.id;){if(!oa||!Eb.a.$5o(A))if(!sf.ListItemReader.Fg(A))ai.a.getInstance().du?(Eb.a.Dlc(A)||({Jla:r}=this.Kl.Bqa(r.Se,A,r)),this.Kl.P0()):{Jla:r}=this.Kl.Bqa(r.Se,A,r),Ba=!1;else if(L){Ba=sf.ListItemReader.De?sf.ListItemReader.nla(A,{pUa:-1}).listLevel:this.Pd.kKf(A);var gb=this.Pd.Yy(b.currentNode,Z,Ba);gb=gb?Vq.a.naa(gb,null):r;Ba=Vq.a.OW(gb.listType,r.listStyle,null,0,Ba,"","");
Ba.Gvb=b.currentNode;this.Kl.iYo(Ba);this.Kl.nxe(A,!0);Ba=!1}fg.OutlineElementNavigator.ft(A,!1,!1)}oa&&Ba&&this.Kl.pbl()}}else if(1===r)for(r=new zl.a,r.nd(b),fg.OutlineElementNavigator.Me(r),b=Cd.ParagraphReader.Fh(r)?r.currentNode:null,Z=this.Yb.gNf(r),fg.OutlineElementNavigator.me(r),fg.OutlineElementNavigator.ft(r,!1,!1);r.currentNode.id!==h.currentNode.id;)fg.OutlineElementNavigator.Me(r),oa=Cd.ParagraphReader.Fh(r)?r.currentNode:null,fg.OutlineElementNavigator.me(r),oa&&b&&A&&(Z&&this.mM.ZP(Z,
oa,!0),this.O9.Edj(b,oa,L),this.O9.Qta(b,oa,1,!0)),fg.OutlineElementNavigator.ft(r,!1,!1)}b$k(b,h,r){if(this.Qd.Bg){for(;b.currentNode!==r.currentNode;){fg.OutlineElementNavigator.Me(b,!1);const A=this.ti.Spd(xc.a.create(b.currentNode));let L;({type:L}=A.m9d()).returnValue&&this.Qd.Yu(L);for(let Z=0;Z<A.length;Z++){let oa;const Ba=({Vfe:oa}=A.getContext(Z)).returnValue;oa&&(ap.Op.zvb(Ba,1),this.Lj.Fyb(Ba,1,null,!0))}b.uc();fg.OutlineElementNavigator.ft(b,!1,!1)}b.nd(h);fg.OutlineElementNavigator.ft(b,
!1,!1)}}XLm(b,h){b=hb.a.eb(b);fg.OutlineElementNavigator.Me(b);return Cd.ParagraphReader.Wb(b.currentNode)?(h=h?Cd.ParagraphReader.textLength(b.currentNode):0,qc.SelectionFactory.ue(b.currentNode,h)):si.TableReader.kP(b.currentNode)?qc.SelectionFactory.Er(b.currentNode):null}QXm(b){if(b){if(this.ZSb&&si.TableReader.Ix(b)&&this.RXe){if(null!=this.nWe&&0==this.nWe){var h=new zl.a;h.nd(b);fg.OutlineElementNavigator.ft(h,!1,!1);b.nd(h)}h=Nr.a.VEo(b);const r=Cd.ParagraphReader.Zm(h);h&&r&&(this.Ui.DJa=
qc.SelectionFactory.ue(r,0),b=hb.a.eb(h))}else Nr.a.Sao(b);b&&si.TableReader.Ix(b)&&Kh.returnToContainingCell(b)&&Nr.a.K3k(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}N2o(b,h){const r=new hb.a;r.nd(b);b=fg.OutlineElementNavigator.Me(r);h=Cd.ParagraphReader.Wb(b)&&h===Cd.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}Hcp(b){var h;v.ULS.shipAssertTag(6305498,307,he.a.mf(b));if(null===
(h=this.LF)||void 0===h?0:h.G_a)return!!this.LF.G_a(b.node,b.cpBegin,{fem:!0,Fb:b.Fb,Tb:b.Tb});h=hb.a.eb(b.node);var r=h.Nd();fg.OutlineElementNavigator.me(h);r&&b.isValid||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Eb.a.Mh(h)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.J.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;
r=ap.Mf.Psa(h,!0);const A=this.N2o(h,b.cpBegin);ap.Mf.Eca(h,r,b,!1,!1,!0,A);return!0}lYi(){return!!(this.Ui.yx&65536)}static get Op(){return null!=ap.cXg?ap.cXg:ap.cXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static get pj(){return pl.PageReader.instance}static get Mf(){return null!=ap.n1g?ap.n1g:ap.n1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Ds(){return ai.a.getInstance()}static get rc(){return null!=ap.iVg?ap.iVg:ap.iVg=Wa.a.instance.Oa("Box4.IFeatureHelper")}static get $tj(){return null!=
ap.z2g?ap.z2g:ap.z2g=Wa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get Zao(){return null!=ap.t2g?ap.t2g:ap.t2g=Wa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}}Object(u.a)(ap,"APasteExecutionManager",null,[]);class zG{constructor(b){this.sk=b}reset(){this.sk.reset()}get yYc(){return this.sk.yYc}yga(b,h){this.sk.yga(b,h)}Kba(b){this.sk.Kba(b)}fwb(b){this.sk.fwb(b)}wCa(b){this.sk.wCa(b)}qMa(b){this.sk.qMa(b)}oYa(b,h){this.sk.oYa(b,h)}nYa(){this.sk.nYa()}xE(b){this.sk.xE(b)}ZF(){this.sk.ZF()}bwb(){this.sk.bwb()}awb(){this.sk.awb()}ACa(b){this.sk.ACa(b)}yCa(){this.sk.yCa()}uMa(b){this.sk.uMa(b)}zCa(){this.sk.zCa()}Xbb(b){this.sk.Xbb(b)}Qba(b){this.sk.Qba(b)}Oba(){this.sk.Oba()}d8(b){this.sk.d8(b)}Pba(){this.sk.Pba()}Nba(b){this.sk.Nba(b)}Mba(){this.sk.Mba()}tYa(b,
h){this.sk.tYa(b,h)}Sbb(){this.sk.Sbb()}}Object(u.a)(zG,"AHtmlNormalizer",null,[222,223]);class aB extends zG{constructor(b){super(b);this.WL=!1}yga(b,h){this.WL?this.HP.XO(()=>{this.lmg(b,h)}):this.lmg(b,h)}lmg(b,h){this.sk.yga(b,h)}Kba(b){this.WL?this.HP.XO(()=>{this.Olg(b)}):this.Olg(b)}Olg(b){this.sk.Kba(b)}wCa(b){this.WL?this.HP.XO(()=>{this.Shd(b)}):this.Shd(b)}Shd(b){this.sk.wCa(b)}qMa(b){this.WL?this.HP.XO(()=>{this.Mlg(b)}):this.Mlg(b)}Mlg(b){this.sk.qMa(b)}oYa(b,h){this.WL?this.HP.XO(()=>
{this.Flg(b,h)}):this.Flg(b,h)}Flg(b,h){this.sk.oYa(b,h)}nYa(){this.WL?this.HP.XO(Object(D.a)(this,this.Elg,"processAnchorEnd")):this.Elg()}Elg(){this.sk.nYa()}xE(b){this.WL?this.HP.XO(()=>{this.Xlg(b)}):this.Xlg(b)}Xlg(b){this.sk.xE(b)}ZF(){this.WL?this.HP.XO(Object(D.a)(this,this.Wlg,"processParagraphEnd")):this.Wlg()}Wlg(){this.sk.ZF()}bwb(){this.WL?this.HP.XO(Object(D.a)(this,this.$lg,"processPreFormattedTextStart")):this.$lg()}$lg(){this.sk.bwb()}awb(){this.WL?this.HP.XO(Object(D.a)(this,this.Zlg,
"processPreFormattedTextEnd")):this.Zlg()}Zlg(){this.sk.awb()}ACa(b){this.WL?this.HP.XO(()=>{this.Slg(b)}):this.Slg(b)}Slg(b){this.sk.ACa(b)}yCa(){this.WL?this.HP.XO(Object(D.a)(this,this.Plg,"processListEnd")):this.Plg()}Plg(){this.sk.yCa()}uMa(b){this.WL?this.HP.XO(()=>{this.Rlg(b)}):this.Rlg(b)}Rlg(b){this.sk.uMa(b)}zCa(){this.WL?this.HP.XO(Object(D.a)(this,this.Qlg,"processListItemEnd")):this.Qlg()}Qlg(){this.sk.zCa()}Qba(b){this.WL?this.HP.XO(()=>{this.kmg(b)}):this.kmg(b)}kmg(b){this.sk.Qba(b)}Oba(){this.WL?
this.HP.XO(Object(D.a)(this,this.gmg,"processTableEnd")):this.gmg()}gmg(){this.sk.Oba()}d8(b){this.WL?this.HP.XO(()=>{this.jmg(b)}):this.jmg(b)}jmg(b){this.sk.d8(b)}Pba(){this.WL?this.HP.XO(Object(D.a)(this,this.hmg,"processTableRowEnd")):this.hmg()}hmg(){this.sk.Pba()}Nba(b){this.WL?this.HP.XO(()=>{this.fmg(b)}):this.fmg(b)}fmg(b){this.sk.Nba(b)}Mba(){this.WL?this.HP.XO(Object(D.a)(this,this.emg,"processTableCellEnd")):this.emg()}emg(){this.sk.Mba()}tYa(b,h){this.WL?this.HP.XO(()=>{this.Ulg(b,h)}):
this.Ulg(b,h)}Ulg(b,h){this.sk.tYa(b,h)}Sbb(){this.WL?this.HP.XO(Object(D.a)(this,this.Svj,"processMathEnd")):this.Svj()}Svj(){this.sk.Sbb()}}Object(u.a)(aB,"AQueuingHtmlNormalizer",zG,[]);var Rn=d(2039);class Gq{constructor(){this.C4e=new Rn.a}XO(b){this.C4e.enqueue(b)}flush(b=!1){for(b&&this.Hwe();!this.C4e.isEmpty;)this.C4e.dequeue()();b&&this.zue()}Hwe(){}zue(){}}Object(u.a)(Gq,"QueuedEventManager",null,[]);class ei extends Gq{constructor(b){super();this.id=void 0;this.euf=null;this.x9c=!1;this.Vba=
"";this.Zde=this.Ree=!1;this.Xtf=this.Nfc=null;this.Vdd=0;this.H9c=this.gad=this.I0f=!1;this.table=null;this.Aag=0;this.E1=b}get QSc(){return!!this.table}Hwe(){this.E1.$sc.push(this.E1.currentState);this.E1.currentState=this}zue(){this.E1.currentState=this.E1.$sc.pop()}}ei.nextId=void 0;Object(u.a)(ei,"ContentState",Gq,[]);class Jv{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.jab=b.jab;this.shadingColor=b.shadingColor;this.verticalAlignment=
b.verticalAlignment;this.Jna=b.Jna;this.sBe=b.sBe;this.Uoc=b.Uoc;this.W$=b.W$;this.contents=r;this.fTm=h}}Object(u.a)(Jv,"TableCell",null,[]);var ti=d(1713),ou=d(1714);class wt extends Gq{constructor(b,h){super();this.E1=b;this.ZGh=new Iy.a;this.Aoa=new Iy.a;this.Q_e=[];this.hLd=[];this.cQa=-1;this.F1a=0;this.GAk=h.wWf;this.FAk=h.cgn;this.xPk=h.yFg;this.ks=h.width;this.Vph=h.jab;this.Lxk=new Nu.a(new Dq(h.Tba.YOi,h.Tba.eae),h.kD,h.LCa,h.cultureName,h.qHa);this.zzk=h.$ae;this.KNd=h.styleId;this.CPk=
h.tableLook}get sk(){return this.E1.sk}mgo(b){this.cQa++;this.ZGh.add(b);this.hLd[this.cQa]=b.height;this.F1a=0}get DMl(){for(;this.F1a>=this.Aoa.count;)this.Aoa.add(Array(this.cQa+1));return this.Aoa.K(this.F1a)}rVk(b,h,r,A,L,Z,oa){if(0>this.cQa)return!1;for(;this.Q_e[this.F1a]>=this.cQa;)this.F1a++;b=new Jv(b,new Nu.a(h,r,A,L,Z),oa);this.DMl[this.cQa]=b;if(1<b.rowSpan)for(h=this.cQa+b.rowSpan-1,A=this.F1a,r=this.F1a+b.colSpan-1;A<=r;A++)this.Q_e[A]>=h||(this.Q_e[A]=h);this.F1a+=b.colSpan;this.hLd[this.cQa]<
b.height&&(this.hLd[this.cQa]=b.height);return!0}Hwe(){this.E1.currentState.table=this}zue(){this.E1.currentState.table=null}vpi(){y.AFrameworkApplication.$c("fd8b6402;j6e17681");this.flush(!0);const b=this.cQa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.Aoa.count);r=!0;var A=0;for(var L=0;L<this.Aoa.count;L++){var Z=this.Aoa.K(L),oa=!0;for(var Ba=0;Ba<b;Ba++){var gb=Z[Ba];gb&&(oa=!1,h[Ba][L+A]=new Ly(gb.colSpan,gb.rowSpan,gb.width,gb.height,void 0,void 0,void 0,void 0,gb.jab,gb.Uoc))}oa?
(this.Aoa.removeAt(L),L--,++A):r=!1}if(!r){(h=this.Vph?this.E1.zZh(h,this.ks/100):this.E1.zZh(h,1,this.ks))&&h.length!==this.Aoa.count&&(h=null);this.E1.mpb(!0);this.E1.MVd();this.sk.Qba(new XA(b,this.Aoa.count,this.ks,this.Vph,h,this.GAk,this.FAk,this.xPk,this.zzk,this.KNd,this.CPk,this.Lxk));for(h=0;h<b;h++){r=this.ZGh.K(h);this.sk.d8(new ir(this.hLd[h],new Nu.a(r.Tba,r.kD,r.LCa,r.cultureName,r.qHa)));for(r=0;r<this.Aoa.count;r++){A=this.Aoa.K(r)[h];var Ab=!!this.KNd&&""!==this.KNd&&"Custom"!==
this.KNd;L=A?A.colSpan:0;Z=A?A.rowSpan:0;A&&(L=Math.min(A.colSpan,this.Aoa.count-r),Z=Math.min(A.rowSpan,b-h));oa=A?A.width:0;Ba=A?A.height:0;gb=A?A.W$:0;const Jb=A?A.jab:!1,Tb=A&&(65536&gb||!Ab)?A.shadingColor:"",jc=A?A.verticalAlignment:0,Hc=A?A.Uoc:!1;Ab=A?this.E1.tCm(A.Jna,r,h,this.Aoa,Ab,A.W$):new ti.a;const hd=A?A.sBe:new ou.a,Gd=A?A.fTm:null;this.sk.Nba(new Ly(L,Z,oa,Ba,Tb,jc,Ab,hd,Jb,Hc,gb,new Nu.a(Gd?Gd.Tba:null,Gd?Gd.kD:null,Gd?Gd.LCa:null,Gd?Gd.cultureName:null,Gd?Gd.qHa:null)));A&&!A.Uoc&&
(A.contents.Hwe(),A.contents.flush(),this.E1.mpb(!1),this.E1.MVd(),A.contents.zue());this.sk.Mba()}this.sk.Pba()}this.sk.Oba();this.E1.currentState.H9c=!1;this.E1.vki(!1)}}}Object(u.a)(wt,"NormalizedTable",Gq,[]);class JC{constructor(b=!1,h=!1){this.uBk=b;this.Wpa=h}get tmn(){return this.uBk}get veb(){return this.Wpa}}Object(u.a)(JC,"HtmlNormalizerSettings",null,[234]);class fx extends aB{constructor(b,h=null){super(b);this.$sc=new Ky;this.t7b=h||new JC}reset(){super.reset();this.currentState=new ei(this);
this.$sc.clear();this.WL=!1}get HP(){return this.currentState&&this.currentState.QSc?this.currentState.table:this.currentState}w_c(b=!1){this.currentState.x9c||(this.MVd(),this.sk.xE(this.currentState.euf),this.currentState.x9c=!0,this.currentState.H9c=!1);b||!this.currentState.Nfc||this.currentState.Zde||(this.sk.oYa(this.currentState.Nfc,this.currentState.Xtf),this.currentState.Zde=!0)}v_c(){this.currentState.Zde&&(this.sk.nYa(),this.currentState.Zde=!1)}wki(){this.currentState.x9c&&(this.sk.ZF(),
this.currentState.x9c=!1,this.currentState.Vba="")}vki(b){this.currentState.gad&&(this.currentState.H9c?b||(this.sk.xE(null),this.sk.ZF(),this.sk.zCa(),this.currentState.gad=!1):(this.sk.zCa(),this.currentState.gad=!1,this.currentState.H9c=!0))}mpb(b){this.v_c();this.wki();this.vki(b)}Y6n(b){this.sk.ACa(new Uq.a(2,1,b));this.currentState.Vdd++;this.currentState.I0f=!0}MVd(){!this.currentState.gad&&this.currentState.I0f&&(this.sk.yCa(),this.currentState.Vdd--,this.currentState.I0f=!1)}lmg(b,h){b=this.QSn(b);
if(""!==b)if(this.w_c(),this.currentState.Ree)this.mmg(b,h);else{b=b.split(fx.bjl);for(let r=0;r<b.length-1;r++)this.mmg(b[r],h),this.sk.fwb(h);this.mmg(b[b.length-1],h)}}Ulg(b,h){""!==b&&(this.w_c(),this.sk.tYa(b,h))}Olg(b){this.t7b.veb||this.v_c();if(Ok.a.von){const h=this.currentState.x9c;this.w_c(!0);h?this.sk.Kba(b):this.wki()}else this.w_c(!0),this.sk.Kba(b)}Mlg(b){this.currentState.QSc||this.sk.qMa(b)}Shd(b){this.currentState.Nfc&&(b.href=this.currentState.Nfc);super.Shd(b)}Flg(b,h){this.v_c();
this.currentState.Nfc=b;this.currentState.Xtf=h}Elg(){this.v_c();this.currentState.Nfc=null;this.currentState.Xtf=null}Xlg(b){this.currentState.euf=b;this.mpb(!0)}Wlg(){this.currentState.euf=null;this.mpb(!0)}$lg(){this.currentState.Ree=!0}Zlg(){this.currentState.Ree=!1}Slg(b){this.mpb(!1);this.MVd();this.sk.ACa(b);this.currentState.Vdd++}Plg(){this.mpb(!1);this.sk.yCa();this.currentState.Vdd--}Rlg(b){this.mpb(!1);this.currentState.Vdd||this.Y6n(b);this.sk.uMa(b);this.currentState.gad=!0;this.currentState.H9c=
!0}Qlg(){this.mpb(!1)}Qba(b){this.currentState.QSc||(this.WL=!0,this.currentState.table=new wt(this,b))}kmg(){}Oba(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.$sc.isEmpty?(this.WL=!1,b.vpi()):this.HP.XO(Object(D.a)(b,b.vpi,"flushTable"))}}gmg(){}d8(b){this.currentState.QSc&&this.currentState.table.mgo(b)}jmg(){}Pba(){}hmg(){}Nba(b){let h=!1;if(this.currentState.QSc){const r=new ei(this);this.currentState.table.rVk(b,new Dq(b.Tba.YOi,b.Tba.eae),b.kD,
b.LCa,b.cultureName,b.qHa,r)?(this.$sc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.Aag++}fmg(){}Mba(){0<this.currentState.Aag?this.currentState.Aag--:this.currentState=this.$sc.pop()}emg(){}zZh(b,h=1,r=0){if(!b)return null;const A=b.length;if(!A)return null;const L=b[0].length;for(var Z=1;Z<A;Z++)if(b[Z].length!==L)return null;Z=Array(L+1);Z[0]=0;const oa=Array(L+1);for(var Ba=0;Ba<oa.length;Ba++)oa[Ba]=!1;Ba=new nb.a;for(let Ab=0;Ab<L;Ab++){for(var gb=0;gb<A;gb++){const Jb=
b[gb][Ab];if(Jb&&0<Jb.width){const Tb=Math.min(Ab+Jb.colSpan,L);Z[Tb]=Z[Ab]+Jb.width*(Jb.jab?h:1);oa[Tb]=!0}}if(oa[Ab+1]){gb=Z[Ab+1]-Z[Ab];if(0>=gb)return null;Ba.add(gb)}else Z[Ab+1]=Z[Ab]}return Ok.a.o0f&&Z[L]<r?null:Ba.toArray()}QKn(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}tCm(b,h,r,A,L,Z){if(!b)return null;L&&(b=this.QKn(b,Z));if(0>r||0>h||h>A.count-1)return b;0<=h-1&&r<=A.K(h-1).length-1&&1===b.borderLeftStyle&&
(L=A.K(h-1)[r])&&1!==L.Jna.borderRightStyle&&(b.borderLeftStyle=L.Jna.borderRightStyle,b.borderLeftColor=L.Jna.borderRightColor,b.borderLeftWidth=L.Jna.borderRightWidth);0<=r-1&&r<=A.K(h).length-1&&1===b.borderTopStyle&&(h=A.K(h)[r-1])&&1!==h.Jna.borderBottomStyle&&(b.borderTopStyle=h.Jna.borderBottomStyle,b.borderTopColor=h.Jna.borderBottomColor,b.borderTopWidth=h.Jna.borderBottomWidth);return b}QSn(b){this.currentState.Ree||(b=this.t7b.tmn?b.replace(fx.A3m," "):b.replace(fx.z3m," "));b.startsWith(" ")&&
(this.currentState.Vba.endsWith(" ")||""===this.currentState.Vba)&&(b=F.a.substring(b,1,b.length));return b}mmg(b,h){""!==b&&(this.sk.yga(b,h),this.currentState.Vba+=b)}}fx.z3m=RegExp("[ \t\f\u200b\r\n]+","g");fx.A3m=RegExp("[ \f\u200b\r\n]+","g");fx.bjl="\t";Object(u.a)(fx,"DefaultHtmlNormalizer",aB,[]);class KC extends fx{constructor(b,h,r){super(b,r);this.Jkh=!1;this.FEb=h}static Din(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?
(b=KC.gSl.exec(b))&&0<b.length:!1}Shd(b){this.FEb.Htc&&(y.AFrameworkApplication.Bta?this.Jkh||(b=new Ag.StandardDialog,b.Bd=0,b.Ke(1,CommonUIStrings.l_DialogClose),b.sw(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Jkh=!0):this.FEb.Icj?this.FEb.Wie=!0:b.src&&""!==b.src?Ma.a.getOrigin(b.src)!==Ma.a.getOrigin(window.location.href)||KC.Din(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?y.AFrameworkApplication.va.Ob(vb.a.isj,2):b.src.startsWith("webkit-fake-url")?
y.AFrameworkApplication.va.Ob(vb.a.hsj,2):(this.v_c(),this.w_c(!0),this.sk.wCa(b)):y.AFrameworkApplication.va.Ob(vb.a.ksj,2):y.AFrameworkApplication.va.Ob(vb.a.jsj,2))}}KC.gSl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(u.a)(KC,"Box4HtmlNormalizer",fx,[]);class pJ{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.ZOi=b;this.kTf=h;this.ool=r;this.Hbk=A;this.wdm=L;this.oPo=Z;this.pPo=oa;this.u6c=Ba;this.r3m=gb;this.u3m=Ab;this.Fbd=Jb}}Object(u.a)(pJ,"ExecutePasteArguments",null,
[]);class bB extends ap{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe=null){super(h,r,A,Ab,Tb,hd,de);this.kC=qe;this.Rrb=oe;this.B5=null;this.JSn=ge=>{this.KNk&&this.jUe.Fpp(this.m$);ge.Ni(this.qgo);return!0};this.qgo=ge=>{if(this.ZMk){const $d=this.m$.getElementsByTagName("style");if($d&&0<$d.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let lf=0;lf<$d.length;lf++)this.Zhb.M7h(this.m$,$d[lf]),$d[lf]&&
($d[lf].parentNode.removeChild($d[lf]),lf--)}}ge.Ni(this.dCl);return!0};this.dCl=(ge,$d)=>{this.jcf.value.create($d.Hbk).process(this.m$,ge);($d=Wa.a.instance.Oa("Box4.IFeatureHelper"))&&$d.isFeatureEnabled(8)?ge.Ni(this.lBl):ge.Ni(this.Kvj);return!0};this.lBl=(ge,$d)=>{(new wG($d.ool)).process(this.m$,ge);ge.Ni(this.Kvj);return!0};this.Kvj=(ge,$d)=>{var lf;y.AFrameworkApplication.$c("j6cj2207;gfehe251");if(Ok.a.Yla){var wf=window.performance.now();this.m$=this.Rrb.q7k(this.m$);Hv.a.aue=window.performance.now()-
wf}else if(Ok.a.zoc&&!document.getElementById("FrameContainingPastedDOM")){wf=window.performance.now();var gi=document.createElement("iframe");gi.style.visibility="hidden";gi.style.zIndex="-100";gi.style.position="absolute";gi.style.width=window.screen.width+"px";gi.style.height=window.screen.height+"px";gi.style.contain="strict";gi.setAttribute("sandbox","allow-same-origin");gi.id="FrameContainingPastedDOM";document.body.appendChild(gi);(gi=gi.contentDocument)&&Ok.a.Fsn&&(gi.documentElement.style.fontSize=
"62.5%",gi.body.style.fontSize="1.6rem");Hv.a.FYd=window.performance.now()-wf}gi=null;!Ok.a.Yla&&Ok.a.zoc&&(gi=document.getElementById("FrameContainingPastedDOM"));!Ok.a.Yla&&Ok.a.zoc&&gi instanceof HTMLIFrameElement?(wf=window.performance.now(),gi=null===(lf=gi.contentDocument)||void 0===lf?void 0:lf.querySelector("body"),null===gi||void 0===gi?void 0:gi.appendChild(this.m$),Hv.a.aue=window.performance.now()-wf,lf=null===gi||void 0===gi?void 0:gi.children,1!==(null===lf||void 0===lf?void 0:lf.length)&&
v.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),$d.ZOi.process(1===(null===lf||void 0===lf?void 0:lf.length)?lf[0]:this.m$,ge)):$d.ZOi.process(this.m$,ge);ge.Ni($d.kTf&&$d.kTf.Htc?this.uZb:this.Eji);return!0};this.uZb=(ge,$d)=>{if($d=$d.kTf){let wf=!1,gi=!1,Di=!1,Yl=!1;var lf=-1;const xk=new lj.DictionaryPropertySet,Vn=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Gb.a)(73,this.Ui.rd)?(wf=this.Ui.rd.ka(Vc.a.Zla,!1),lf=this.Ui.rd.ka(Od.a.XX,
""),Di=this.Ui.rd.ka(Od.a.Vfa,!1),Yl=this.Ui.rd.ka(Ke.a.FBa,!1),Vn.test(lf)&&(gi=!0),lf=this.Ui.rd.ka(Ge.a.Mka,-1)):this.Ui.yx&256&&this.m$&&(wf=!0,Vn.test(this.m$.innerHTML)&&(gi=!0));xk.setValue(Vc.a.Zla,wf);xk.setValue(Od.a.lad,gi);xk.setValue(Od.a.Vfa,Di);xk.setValue(Ge.a.Mka,lf);xk.setValue(Ke.a.FBa,Yl);$d.dxe(xk);$d.pfg();$d.Dvb&&(this.Ui.v9c=!0,this.Ui.MKa=$d.h_,this.Ui.Xbg=$d.Dvb,wf&&!Di&&me.c(vb.a.k5l),y.AFrameworkApplication.va.Ob(vb.a.uZb,2))}ge.Ni(this.Eji);return!0};this.Eji=(ge,$d)=>
{var lf;ge=window.performance.now();if(Ok.a.Yla)this.Rrb.IAo();else if(Ok.a.zoc){var wf=document.getElementById("FrameContainingPastedDOM");wf instanceof HTMLIFrameElement&&(wf=null===(lf=wf.contentDocument)||void 0===lf?void 0:lf.querySelector("body"),(null===wf||void 0===wf?0:wf.firstElementChild)?(v.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===wf||void 0===wf?void 0:wf.removeChild(null===wf||void 0===wf?void 0:wf.firstElementChild)):v.ULS.sendTraceTag(508858443,
307,15,"iframe body first element child was null"))}Hv.a.Zrg=window.performance.now()-ge;Ho.a.ZHn($d.Hbk);Ho.a.mFn($d.u3m);Ho.a.VGn($d.oPo);Ho.a.WGn($d.pPo);Ho.a.KFn($d.Fbd);lf="Others";$d.u6c&&($d.u6c.jFn(),$d.u6c.kFn(),$d.u6c.iHn(),lf=$d.u6c.QCg);Ho.a.lFn($d.r3m,lf);Ho.a.VEn($d.wdm,lf);return!1};this.m$=b;this.dLe=L;this.QUe=Z;this.W9e=oa;this.jcf=Ba;this.FIc=gb;this.t7b=Hc;this.Aa=Jb;this.zlh=Object.assign(new Sx,{ync:2===this.Ui.lfc||3===this.Ui.lfc});this.Zhb=jc;this.jUe=Gd;this.bac=Jb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");
this.ZMk=Jb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.KNk=Jb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get Mke(){return!1}get ZSb(){return!0}Hli(b){Ok.a.Etb?Cq.a.instance.le(()=>{this.Ili(b)},"EPEM:EP"):this.Ili(b)}Ili(b){this.B5=new hb.a;this.xcb.restore(this.B5);v.ULS.shipAssertTag(6305550,307,Eb.a.Mh(this.B5));this.Ui.UU&&this.Ui.UU.Ycc("external");var h=this.Ui.yx&8192?1:0,r=this.QUe.value.create(h,this.B5,this.Ui.GVc,this.Ui.Jxb),A=this.W9e.value.create(h,this.B5);const L=Ho.a.xui(y.AFrameworkApplication.userSessionId),
Z=Ho.a.MJi(y.AFrameworkApplication.userSessionId),oa=Ho.a.dJf(aa.a.pLb,this.Ui.GVc),Ba=Ho.a.jGi(y.AFrameworkApplication.userSessionId),gb=Ho.a.kGi(y.AFrameworkApplication.userSessionId),Ab=this.bac?this.L8m():null,Jb=Ho.a.izi(aa.a.pLb,this.Ui.GVc),Tb=Ho.a.jzi(y.AFrameworkApplication.userSessionId),jc=this.FIc.qSj?Ho.a.jzm(y.AFrameworkApplication.userSessionId):null;h=this.dLe.value.create(h,this.B5,r,A,null,oa,this.I5k,this.Ui.$Be);h=new xG(h,Ba,gb);h=new KC(h,r,this.t7b);h=new Hk(h,this.FIc,this.zlh,
jc,Ok.a.Yla?this.Rrb:null);A=new GC(Ab);h=new yG(h,A,Jb,Ab,this.Aa);h=new ex(h,this.kC,Tb);r=new pJ(h,r,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc);r=new Tt.a(b,this.JSn,r);r.nm("paste and request pictures");r.oi=!b||b.oi;r.run()}get I5k(){return this.m$.getElementsByTagName("a").length}L8m(){const b=new Oy;b.wtc=aa.a.pLb;this.Ui&&(b.yx=this.Ui.yx,b.Epj=this.Ui.GVc,this.Ui.rd&&(b.progId=this.Ui.rd.ka(Od.a.gsj,"")));this.m$&&this.m$.innerHTML&&(b.fsj=this.m$.innerHTML.length,Hv.a.Qig=b.fsj);y.AFrameworkApplication.sessionStartInfoSettings&&
(b.platform=y.AFrameworkApplication.sessionStartInfoSettings.Platform,b.hpc=y.AFrameworkApplication.J.$("IsO365ConsumerHost"),b.fVi=Cd.ParagraphReader.Vja(ab.StaticActiveAppFrame.za().kb.Qc.vd));return b}get ISj(){return!0}get Wod(){v.ULS.shipAssertTag(6305551,307,!!this.B5);if(this.FIc.rSj(this.zlh)){var b=!1;Eb.a.Mh(this.B5)&&(this.B5.n7(),b=!0);var h=Cd.ParagraphReader.Fh(this.B5)&&!this.B5.currentNode.ka(Od.a.vXi,!1);b&&this.B5.uc();return h}return this.Ui.yx&524288?(b=!1,Eb.a.Mh(this.B5)&&(this.B5.n7(),
b=!0),h=Cd.ParagraphReader.Fh(this.B5),b&&this.B5.uc(),h):Cd.ParagraphReader.Fh(this.B5)}}Object(u.a)(bB,"ExternalPasteExecutionManager",ap,[]);class AG{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc=null){this.aic=Tb;this.kC=jc;this.Rrb=Hc;this.dLe=b;this.QUe=h;this.W9e=r;this.jcf=A;this.FIc=L;this.lda=Z;this.Aa=oa;this.Zhb=Ba;this.t7b=gb;this.O9=Ab;this.jUe=Jb}create(b,h,r,A){return new bB(b,h,r,A,this.dLe,this.QUe,this.W9e,this.jcf,this.FIc.value,this.lda,this.Aa,ab.StaticActiveAppFrame.za().kb,
this.Zhb,this.t7b,this.O9,this.jUe,this.aic,this.kC,Ok.a.Yla?this.Rrb.value:null)}}Object(u.a)(AG,"Factory",null,[700]);class BG{constructor(b=null){var h;this.gG=b;b=window.performance.now();Ok.a.nVi&&(null===(h=this.gG)||void 0===h?void 0:h.execute(r=>{r.logActivity("CCPUsage","CCPFloodgateSurvey")}));this.osf();Hv.a.FYd=window.performance.now()-b}q7k(b){if(this.zfa.contentDocument){const h=this.zfa.contentDocument.body;b=h.appendChild(b);1!==h.children.length&&v.ULS.sendTraceTag(508624975,307,
15,`Found Non-One Pasted Containers ${h.children.length}`);return b}v.ULS.sendTraceTag(508624974,307,15,"iframe not loaded when append method was called");return b}IAo(){if(this.zfa.contentDocument){var b=this.zfa.contentDocument.body;b?b.lastElementChild?(v.ULS.sendTraceTag(508624930,307,50,"iframe body first element child was not null"),b.removeChild(b.lastElementChild)):v.ULS.sendTraceTag(508624929,307,15,"iframe body first element child was null"):v.ULS.sendTraceTag(508101854,307,15,"iframe body itself is null")}}Tmi(b){var h;
const r=null===(h=this.zfa.contentDocument)||void 0===h?void 0:h.body;return(null===r||void 0===r?0:r.contains(b))?getComputedStyle(b):b.style}osf(){var b=document.getElementById(Nk.a.pBc);this.zfa=document.createElement("iframe");this.zfa.style.visibility="hidden";this.zfa.style.zIndex="-100";this.zfa.style.position="absolute";this.zfa.style.contain="strict";Ok.a.Esn&&(this.zfa.style.width=window.screen.width+"px",this.zfa.style.height=window.screen.height+"px");this.zfa.setAttribute("sandbox","allow-same-origin");
this.zfa.id="FrameContainingPastedDOM";b?(b.appendChild(this.zfa),b=this.zfa.contentDocument,Ok.a.L1i&&b?(b.documentElement.style.fontSize="62.5%",b.body.style.fontSize="1.6rem"):Ok.a.L1i&&v.ULS.sendTraceTag(508441186,307,15,"Iframe not loaded when setting root fontSize")):v.ULS.sendTraceTag(508624973,307,15,"View Panel not found")}}Object(u.a)(BG,"HiddenExternalPasteView",null,[699]);class pu{eyn(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.Ljn(b.childNodes[h-2])&&
this.Tvn(b.childNodes[h-1])}Fpp(b){this.eyn(b)&&(b.removeChild(b.lastChild),v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}chn(b){return!!b&&8===b.nodeType}kun(b){return!!b&&3===b.nodeType}Ljn(b){return this.chn(b)&&"EndFragment"===b.nodeValue}Tvn(b){if(!this.kun(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(u.a)(pu,"HtmlNormalizerHelper",null,[698]);var bp=d(1001),cB=d(640);class dB extends ap{constructor(b,h,r,A,L,Z,oa,Ba,gb){super(b,h,r,L,Z,Ba,gb);this.qB=
A;this.JFb=oa}get Fl(){return this.JFb.value}get Mke(){return this.qB.Mke()}get nsj(){const b=this.qB;return b.Bqf&&!b.pTi()}Jli(b,h){v.ULS.shipAssertTag(6305616,307,fm.OutlineReader.zy(b));const r=cB.a(b.currentNode);if(fm.OutlineReader.isEmpty(b)){var A=xc.a.create(b.currentNode);b.mt(8);y.AFrameworkApplication.va.Hf(A,vb.a.gI,2,!0,null,null)}else b.mt(8);(A=b.xL(1))&&b.uc();this.qB.Wrj(this.Ui.ge,b.currentNode,A,-1,r,h)}Hli(b){const h=new hb.a;this.xcb.restore(h);v.ULS.shipAssertTag(6305618,307,
Eb.a.Mh(h));this.Ui.UU&&this.Ui.UU.Ycc("internal");let r=-1;if(Object(Gb.a)(73,this.Ui.rd))r=this.Ui.rd.ka(Ge.a.Mka,-1);else{const A=this.lpm(h.currentNode);r=A?A.clientWidth:r}this.qB.Wrj(this.Ui.ge,h.parentNode,h.currentNode,r,null,b);this.UZi&&(this.xcb.restore(h),Eb.a.Mh(h)&&this.qB.w2i(h)&&(b=fg.OutlineElementNavigator.Me(h)))&&(this.Ui.DJa=qc.SelectionFactory.ue(b,0))}lpm(b){return b?(b=b?b.fg(this.Fl.Ic):null)?b.htmlElement:null:null}pTj(){const b=new hb.a;this.xcb.restore(b);return this.qB.w2i(b)}get ISj(){return!0}get Wod(){return!this.qB.Yza&&
!this.qB.Bqf}}Object(u.a)(dB,"InternalPasteExecutionManager",ap,[]);class LC{constructor(b,h,r,A,L){this.aic=L;this.qB=b;this.lda=h;this.JFb=r;this.O9=A}create(b,h,r){return new dB(b,h,r,this.qB,this.lda,ab.StaticActiveAppFrame.za().kb,this.JFb,this.O9,this.aic)}}Object(u.a)(LC,"Factory",null,[697]);var Pr;(function(b){b[b.unknown=0]="unknown";b[b.mZp=1]="differentBox4App";b[b.Ekq=2]="sameBox4AppDifferentSession";b[b.Fkq=3]="sameBox4AppSameSession"})(Pr||(Pr={}));Object(u.b)("CopySource",Pr);class Pu{constructor(b,
h,r,A,L){this.kC=L;this.qB=b;this.Ymh=h;this.evk=r;this.xl=A}Iao(b,h,r){v.ULS.shipAssertTag(6305620,307,!!b);v.ULS.shipAssertTag(6305621,307,he.a.mf(h));v.ULS.shipAssertTag(6305622,307,!!r);v.ULS.shipAssertTag(6305623,307,Object(Gb.a)(xr,r.cua));const A=r.cua;A.lfc=this.qB.Tvi(b);this.yFn(b,A);let L=!1;this.xl.ama(h,Ba=>L=Ba)&&(A.yx|=8192,A.$Be=1,L||(A.$Be|=2));const Z=this.Imn(A);var oa=new Sb.GraphTransaction(7,vb.a.paste);oa.Ab(h.node);h.node.SJ().KF.n6(8);Z?(v.ULS.sendTraceTag(40706500,307,50,
"Internal paste operation starts. {0}; {1}",A.yx,A.browserName),this.kC?this.kC.Zwc("isExternal",!1):this.eaj(),b=this.Ymh.create(h,A,oa)):(v.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",A.yx,A.lfc,A.browserName),this.kC?this.kC.Zwc("isExternal",!0):this.eaj(),Pu.pFn(b),b=this.evk.create(b,h,A,oa));r=new Tt.a(r,Object(D.a)(b,b.asj,"pasteSetup"),null);r.nm("Paste");r.run()}Imn(b){return!this.Vpn(b)&&3===b.lfc}eaj(){v.ULS.sendTraceTag(508143509,307,15,"PastePerformanceE2ETracker instance is nullish")}Vpn(b){return 1===
(b.yx&8192?1:0)}wTi(b,h){v.ULS.shipAssertTag(6305624,307,he.a.mf(b));v.ULS.shipAssertTag(6305625,307,!!h);v.ULS.shipAssertTag(6305626,307,Object(Gb.a)(xr,h.cua));const r=new Sb.GraphTransaction(7,vb.a.Ybe);r.Ab(b.node);b=this.Ymh.create(b,h.cua,r);h=new Tt.a(h,Object(D.a)(b,b.asj,"pasteSetup"),null);h.nm("InternalPasteAtIp");h.run()}yFn(b,h){if(b){let r=!1,A=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?A=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||A)&&v.ULS.sendTraceTag(42471960,
307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Pr[h.lfc],r,A)}}static pFn(b){b&&Pu.NSk.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Pu.NSk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(u.a)(Pu,"PasteCoordinator",null,[]);var CG=d(813),gu=d(1087),Wx=d(1086);class Xx{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc=null){this.kua=
b;this.Wba=h;this.Xs=r;this.Puj=A;this.ua=L;this.qcb=Z;this.J=oa;this.Mao=Ba;this.Ega=gb;this.J9a=Ab;this.jza=Jb;this.lb=Tb;this.hma=jc;this.xci=100;this.fpc=!1;this.fOe=null;this.OWe=!1;this.UId=null;this.hFd=this.lRa=!1;this.Tam=(Hc,hd)=>{this.dismissFloatie(hd.i8l)};this.l8o=(Hc,hd)=>{this.WFl(Hc,hd)};this.BN=(Hc,hd)=>{hd.property===Ke.a.lastModifiedTime?(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.J9a.cuf.contains(vb.a.WKg)||this.mog(hd)):v.ULS.sendTraceTag(520734532,
307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.uYa=(Hc,hd)=>{this.mog(hd)};this.Jma=(Hc,hd)=>{hd.kde||this.mog(hd)};this.Vlj=()=>{CG.a.instance.keyCode===jf.a.GEa&&this.Wba.Lxj()};this.wdp()}wdp(){this.Wba.JPh(this.l8o);this.Wba.uPh(this.Tam)}WFl(b,h){var r,A,L;(null===(A=null===(r=this.lb.gb)||void 0===r?void 0:r.currentSelection)||void 0===A?0:A.f9c)?v.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.qcb.BVf(),1===this.Mao.nGl(h.Pgd)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.lRa?this.lRa=!1:this.Sxo(),this.Tjd(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",vb.a.pU(h.WX)||"Unknown",h.correlationId),v.ULS.sendTraceTag(40379588,307,50,b),me.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new da.a,{name:"PasteCommand",int64:vb.a.pU(h.WX)||"Unknown"}),Object.assign(new da.a,
{name:"CorrelationId",string:null===(L=h.correlationId)||void 0===L?void 0:L.toString()})]),this.h2b()):v.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.OWe&&(this.lRa||(this.hma?null===(h=this.jza)||void 0===h?0:h.f3:this.kua.f3()))&&(b&&(this.qcb.BVf(),this.r5j(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.UId)),this.lRa=!b,this.aEe(),this.hma?
y.AFrameworkApplication.va.Ob(vb.a.HRb,2):this.kua.dismissFloatie())}Sxo(){this.hFd||(this.fOe=this.Xs.Gd,zc.a.addHandler(this.fOe.container,"scroll",Object(D.a)(this,this.b_b,"scrollHandler")),this.ua.a2(Object(D.a)(this,this.hna,"resizeHandler")),this.hFd=!0)}r5j(){this.hFd&&(zc.a.removeHandler(this.fOe.container,"scroll",Object(D.a)(this,this.b_b,"scrollHandler")),this.ua.Yga(Object(D.a)(this,this.hna,"resizeHandler")),this.hFd=!1)}h2b(){if(this.hma)this.jza.f3&&y.AFrameworkApplication.va.Ob(vb.a.HRb,
2),y.AFrameworkApplication.va.Ob(vb.a.rpd,2),this.fpc=!1;else{const b=new Wx.a(0,y.AFrameworkApplication.isRtl);b.location=this.qcb.xVa();this.qcb.Fkn(b.location)?this.showFloatie(null,b):this.Wba.$Ma(new gu.a(!1))}}hna(){this.hma?(y.AFrameworkApplication.va.Ob(vb.a.HRb,2),this.nYc()):this.h2b()}b_b(){this.hma?(y.AFrameworkApplication.va.Ob(vb.a.HRb,2),this.nYc()):this.h2b()}Tjd(){this.Puj.z1k(this.Vlj);this.Wba.zPh(Object(D.a)(this.kua,this.kua.L1d,"expandFloatie"));this.Wba.HPh(Object(D.a)(this,
this.dsj,"pastedFloatieStatusChange"));this.Ega.ut(this.Jma);this.Ega.ly(this.uYa);this.Ega.Qo(this.BN)}aEe(){this.Puj.kCo(this.Vlj);this.Wba.KDj(Object(D.a)(this.kua,this.kua.L1d,"expandFloatie"));this.Wba.SDj(Object(D.a)(this,this.dsj,"pastedFloatieStatusChange"));this.Ega.kS(this.Jma);this.Ega.Hua(this.uYa);this.Ega.LP(this.BN)}dsj(b,h){this.OWe=h.e9c;h.WX&&(this.UId=h.WX);h.nBg&&this.kua.f3()&&this.h2b()}mog(b){b.node.nP||this.Wba.$Ma(new gu.a(!0))}showFloatie(b,h){h||(h=new Wx.a(0,y.AFrameworkApplication.isRtl));
h.location||(h.location=this.qcb.xVa());if(!h.location)return!1;this.lRa&&(this.lRa=!1,this.Tjd());this.hma?y.AFrameworkApplication.va.Ob(vb.a.rpd,2):this.kua.showFloatie(b,h);return!0}nYc(){if(!this.fpc){const b=new mf.a(3,1,this.xci,()=>{this.h2b()},215);zf.a.instance.$b(b);this.fpc=!0}}}Object(u.a)(Xx,"PasteFloatieEventManager",null,[]);class eB{constructor(b,h){this.kk=b;this.wK=h}nGl(b){return qm.any(qm.where(qm.asEnumerable(eB.ugp),h=>this.wK.D$c(h)))?(b=this.kk.pcb(b))&&(b=b.innerText)&&0<
b.trim().length?0:1:1}}eB.ugp=[vb.a.uZa.toString(),vb.a.vZa.toString(),vb.a.hDa.toString()];Object(u.a)(eB,"PasteFloatieFeatureSetBuilder",null,[]);class fB{constructor(){this.SCa=null;this.Atc=0}}Object(u.a)(fB,"PasteFloatieAnchorData",null,[]);class Kv{constructor(b,h,r,A,L,Z=!1){this.cHb=null;this.ib=b;this.plb=h;this.qd=r;this.Qwk=A;this.T2e=L;this.mXe=Z}BVf(){this.cHb=null}xVa(){const b=this.SIf(this.cHb)||this.nZh();if(!b){let h="null",r="null";if(this.cHb&&this.cHb.SCa){if(!this.qd.Gd)return v.ULS.sendTraceTag(51143187,
307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.cHb.SCa).getName();const A=this.qd.Gd.jm(this.cHb.SCa);A&&(r=Object.getType(A).getName())}v.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}Fkn(b){if(!b)return!1;const h=this.T2e.VPb(),r=this.Qwk(this.qd.Gd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}nZh(){if(!this.ib||
!this.ib.gb||!this.ib.gb.currentSelection)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.ib.gb.currentSelection.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.sEi(r);while(r&&Object(Gb.a)(On.AParagraphNode,r)&&!r.characterData.trim().length)}let A="";const L=Object(Ca.a)(On.AParagraphNode,r);L&&(A=L.characterData.length===b.cpBegin||h?L.characterData.trimEnd():L.characterData.substring(0,b.cpBegin).trimEnd());h=L?
A.length:b.cpBegin;b=Object.assign(new fB,{SCa:Object(Ca.a)(139,(L?Object(Ca.a)(139,L):Object(Ca.a)(139,r))||b.node),Atc:h});return this.SIf(b)}sEi(b){const h=new hb.a;if(!b.anchor)return null;h.set(b);if(!h.Nd())return null;h.kd(11);return h.cP()?h.Vb(2):null}SIf(b){if(!b||!b.SCa)return null;this.cHb=b;const h=this.qd.Gd;if(!h)return v.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.lzi(b,h);if(!b)return null;y.AFrameworkApplication.isRtl&&
this.T2e.f3()&&(b.x-=this.T2e.VPb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}lzi(b,h){h=h.fg(b.SCa);if(!h)return null;let r=null;if(Object(Gb.a)(On.AParagraphNode,b.SCa)){const A=Object(Ca.a)(42,h);if(!A)return null;try{r=this.plb.f2(b.Atc,A,0<b.Atc,!1,!1,!1),r.height+=this.mXe?Kv.Voo:Kv.Wam}catch(L){v.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",L),r=null}}else Object(Gb.a)(Hz.TableNode,b.SCa)&&(r=Object(Ca.a)(218,h).CNf());
r||(r=h.getBounds());return r}}Kv.Wam=2;Kv.Voo=60;Object(u.a)(Kv,"PasteFloatiePositionProvider",null,[]);class qJ{constructor(b,h,r,A,L){this.fAa=b;this.oub=h;this.Yao=r;this.Xao=A;this.ZSb=L}}Object(u.a)(qJ,"PastedContentsPostProcessorParams",null,[]);class rJ{f9m(b,h,r,A,L,Z){b=this.htm(b,h,L);r=this.Wxm(r);if(!b||!r)return null;A=this.BFm(b,A,L);L=this.AFm(r);return new qJ(b,r,A,L,Z)}htm(b,h,r){b=r?b:h;if(!Eb.a.Mh(b))return null;h=new zl.a;h.nd(b);return h}Wxm(b){if(!Eb.a.Mh(b))return null;const h=
new zl.a;h.nd(b);fg.OutlineElementNavigator.y3(h,!1,!1);return h}BFm(b,h,r){fg.OutlineElementNavigator.Me(b);let A=-1;Cd.ParagraphReader.Fh(b)&&(A=r?h:0);fg.OutlineElementNavigator.me(b);return A}AFm(b){fg.OutlineElementNavigator.Me(b);const h=Cd.ParagraphReader.Fh(b)?Cd.ParagraphReader.textLength(b.currentNode):-1;fg.OutlineElementNavigator.me(b);return h}}Object(u.a)(rJ,"PastedContentsPostProcessorHelper",null,[]);class xt{constructor(b,h){this.mGc=b;this.Bqk=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get Pqi(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get xuf(){return CommonUIStrings.l_ClipboardCut}get Q6f(){return CommonUIStrings.l_ClipboardCut_Mac}get trf(){return CommonUIStrings.l_ClipboardCopy}get P6f(){return CommonUIStrings.l_ClipboardCopy_Mac}get ztc(){return CommonUIStrings.l_ClipboardPaste}get R6f(){return CommonUIStrings.l_ClipboardPaste_Mac}get P3(){return CommonUIStrings.l_ClipboardPasteText}get S6f(){return CommonUIStrings.l_ClipboardPasteText_Mac}get tof(){return this.Bqk}get e3h(){return CommonUIStrings.l_ClipboardExtensionLink}get qnb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}dmi(){v.ULS.sendTraceTag(8716421,
307,50,null);rd.a.Tm(this.tof,"_blank",void 0,"ClipboardAccessExtensionLink")}$ga(b,h){let r=aa.a.Jl;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=aa.a.Di||r);return r?String.format(h,"\u2318"):b}dispose(){this.mGc=null}Kog(b){this.o8h(b)}Xzn(b){this.o8h(b)}o8h(b){this.mGc&&this.mGc(b)}}xt.id="CopyPasteShortcutDialog";xt.W_j="CopyPasteText";Object(u.a)(xt,"ACopyPasteShortcutDialog",null,[10]);class Qz extends xt{constructor(b,h,r){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=xt.W_j;var A=document.createElement("span");A.innerText=this.Pqi;var L=document.createElement("span");L.className="UIFontBold";L.innerText=this.$ga(this.xuf,this.Q6f);const Z=document.createElement("span");Z.className="UIFontBold";Z.innerText=this.$ga(this.trf,this.P6f);const oa=document.createElement("span");oa.className="UIFontBold";oa.innerText=this.$ga(this.ztc,this.R6f);h.appendChild(A);h.appendChild(document.createElement("br"));
h.appendChild(L);h.appendChild(Z);h.appendChild(oa);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.Nr||aa.a.nj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.$ga(this.P3,this.S6f),h.appendChild(r));b.appendChild(h);this.tof?(v.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.e3h,zc.a.addHandler(h,"click",Object(D.a)(this,this.dmi,"extensionLinkHandler")),r.appendChild(h),L=this.qnb.indexOf("{0}"),
-1!==L&&(A=this.qnb.substring(0,L),L=this.qnb.substring(L+3,this.qnb.length),A=document.createTextNode(A),L=document.createTextNode(L),r.insertBefore(A,h),r.appendChild(L)),b.appendChild(document.createElement("br")),b.appendChild(r)):v.ULS.sendTraceTag(8716422,307,50,null);r=new Ag.StandardDialog;r.Bd=0;r.Ig=xt.id;r.sw(this.titleText,null,0,Object(D.a)(this,this.Xzn,"legacyCopyPasteShortcutDialogHandler"),b);r.x8(xt.W_j)}}Object(u.a)(Qz,"CopyPasteShortcutDialog",xt,[]);class gv extends xt{constructor(b,
h){super(b,h);h={};b=this.rcn;h.extensionStartText=this.Y4l;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.u2o;h.cutText=this.$ga(this.xuf,this.Q6f);h.copyText=this.$ga(this.trf,this.P6f);h.pasteText=this.$ga(this.ztc,this.R6f);4!==y.AFrameworkApplication.ua.Gb.Mk&&(h.pasteTextOnly=this.$ga(this.P3,this.S6f));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new Dg.a(!1,!1,!0);r.Ig="CopyPasteInstallDialog";r.Bd=0;r.Ke(1,this.qcn);r.qY(1);r.Uh(b,Object(D.a)(this,
this.Kog,"reactCopyPasteShortcutDialogHandler"),h)}get u2o(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get qcn(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get rcn(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get Y4l(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static R6o(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(u.a)(gv,"ReactCopyPasteInstallDialog",xt,[]);class gB extends xt{constructor(b){super(b,null);this.j6i="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.$Rn;var r="";let A="";this.messageText&&(r=this.messageText.split(" {")[0],A=this.messageText.split("} ")[1]);h.startText=r;h.endText=A;h.cutText=this.qNl;h.copyText=this.tCl;h.pasteText=this.Oao;
h.cutShortcutText=this.$ga(this.rNl,this.cJn);h.copyShortcutText=this.$ga(this.DCl,this.bJn);h.pasteShortcutText=this.$ga(this.Rao,this.eJn);h.imageSrc=Bb.a.Dea("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.dho;this.j6i&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.yub,["onExecute"]:()=>{this.Pzn()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new Dg.a(!1,!1,!0);r.Bd=0;r.Ig="CopyPasteNoClipboardAccessDialog";r.Uh(b,Object(D.a)(this,this.Kog,"reactCopyPasteShortcutDialogHandler"),h)}get $Rn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get yub(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get dho(){return CommonUIStrings.l_DialogOk}get qNl(){return CommonUIStrings.l_CutString}get rNl(){return CommonUIStrings.l_CutShortcut}get cJn(){return CommonUIStrings.l_CutShortcut_Mac}get tCl(){return CommonUIStrings.l_CopyString}get DCl(){return CommonUIStrings.l_CopyShortcut}get bJn(){return CommonUIStrings.l_CopyShortcut_Mac}get Oao(){return CommonUIStrings.l_PasteString}get Rao(){return CommonUIStrings.l_PasteShortcut}get eJn(){return CommonUIStrings.l_PasteShortcut_Mac}Pzn(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");rd.a.Tm(this.j6i,"_blank",void 0,"learnMoreLink")}}Object(u.a)(gB,"ReactCopyPasteNoClipboardAccessDialog",xt,[]);class DG extends xt{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.Pqi;b.cutText=this.$ga(this.xuf,this.Q6f);b.copyText=this.$ga(this.trf,this.P6f);b.pasteText=this.$ga(this.ztc,this.R6f);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.Nr||aa.a.nj)&&(b.pasteTextOnly=this.$ga(this.P3,this.S6f));this.tof?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.e3h,["onExecute"]:A=>{this.dmi(A)}},r=this.qnb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.qnb.substring(0,r),b.suggestionSuffixElement=this.qnb.substring(r+3,this.qnb.length))):v.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:xt.id,["bodyControls"]:b};b=new Dg.a(!1,!1,!0);b.Bd=0;b.Ig=xt.id;b.Uh(this.titleText,Object(D.a)(this,this.Kog,"reactCopyPasteShortcutDialogHandler"),r)}}Object(u.a)(DG,"ReactCopyPasteShortcutDialog",
xt,[]);class Aw{constructor(){this.nRa=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.kH}Yrf(b,h,r=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.nRa,r));this.nRa?r?new gv(b,h):new DG(b,h,y.AFrameworkApplication.J):new Qz(b,h,y.AFrameworkApplication.J)}static get instance(){return Aw._instance||(Aw._instance=new Aw)}}Aw._instance=null;Object(u.a)(Aw,"CopyPasteShortcutDialogFactory",null,[1219]);class hB{constructor(b,h,r,A,
L,Z,oa,Ba){this.GEh=this.Uoh=this.a9e=!1;this.qPk=b;this.qd=h;this.Sy=r;this.Zb=A;this.kf=L;this.wg=Z;this.gf=oa;Ba&&(this.GEh=Ba.$("ShouldLogExecCommandCopySuccess"))}get R_a(){return this.qPk}get aab(){return this.Uoh}set aab(b){this.Uoh=b;this.wg.YSf=b}x_c(b){this.R_a.x_c(b);b||this.ard(!0)}get X1l(){return this.R_a.Stg}QXb(b){this.aab=!0;this.R_a.QXb(b,this.ZFg)}reset(){this.aab=!1}paste(){var b=null;let h=null;if(!this.R_a.a3b){(b=this.qd.Gd)&&this.Zb.Gg(b.nL);var r=this.Sy.Gw;if(!r.ve||!r.Ie.Kk)return null;
h=r.Ie;b=this.kf.Fx();this.aab=!0;r.Ffb()}r=null;try{h&&h.Ufo(),r=b=this.R_a.O_c(this.ZFg,b)}catch(A){v.ULS.shipAssertTag(6305672,307,!1),this.wLi()}this.aab=!1;return r}iE(){var b=this.qd.Gd;b&&this.Zb.Gg(b.nL);b=this.Sy.Gw;if(!b.ve||1!==b.Ie.mode)return!1;this.aab=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");xa.Health.instance.recordKpiUsage(ro.a.BUd,0,ro.a.c0h,r);const A=this.R_a.RAf(this.ZFg);h=!0;this.GEh&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
A,this.gf.cE);if(!A){const L=Object.assign(new Na.a,{extendedProperties:r});xa.Health.instance.recordKpiFailure(ro.a.BUd,ro.a.a0h,!0,!0,L)}}catch(r){v.ULS.shipAssertTag(6305673,307,aa.a.nj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",aa.a.cE),h=!1}this.aab=!1;return h?!0:!1}ard(){if(this.a9e)return!0;var b=this.Sy.Gw;if(!b.ve||!b.Ie.Kk)return!1;const h=b.Ie;b=this.kf.Fx();this.aab=!0;const r=new Gz.a(b);let A=!1;try{A=this.R_a.ard(b,()=>{h.zVd()},
()=>{h.zNa()})}catch(L){}r.restore();this.aab=!1;A?this.a9e=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",aa.a.cE),this.wLi());return A}wLi(){this.a9e=!1;if(y.AFrameworkApplication.oGp)Aw.instance.Yrf(null,null);else{const b=new Ag.StandardDialog;b.Bd=0;b.lV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get ZFg(){const b=this.kf.Lqb();return b?b.Eo:null}}Object(u.a)(hB,"SystemClipboard",null,
[696]);class Vt{constructor(b,h,r){this.mPd=!1;this.KPd=this.mW=this.Vrh=this.AMe=this.Gxd=null;this.OBh=!1;this.seo=A=>{1===A?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.pMe)),this.sbc&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.sbc)),rd.a.Tm(this.aTe+this.b1e,"_blank",void 0,"ChromeCCPInstallDialog"))):A||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.pMe))};this.pMe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.aTe=b.jb("ChromeClipboardAccessExtensionLink");this.k2a=h;this.kk=r;this.b1e=b.jb("ChromeClipboardAccessExtensionId");this.YRk=b.$("UseGetClipboardDataIsEnabled");this.YAh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.sbc=!1;b.$("CcpInstallDialogIsEnabled")&&y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.kH&&(this.sbc=gv.R6o()||b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.sbc));this.OBh=null===b||void 0===b?void 0:
b.getBooleanFeatureGate("Microsoft.Office.WordOnline.ResetExtensionIdForMSFTExtensionFailure",!1);this.iHc=null}x_c(b){b?this.mW=!0:(this.mW=null,chrome.runtime&&chrome.runtime.sendMessage?(this.iHc=this.k2a.$Yd,this.k2a.i0b?(this.mPd=this.YRk,this.c1h()):(this.mPd=!0,this.c1h(),v.ULS.sendTraceTag(19256732,307,50,Q.a.create().toString()))):(this.z0b(),this.mW=!1))}get Stg(){return this.mW}get a3b(){return this.KPd}ard(){return!0}RAf(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=
rd.a.AOb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}QGf(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const A=this.kk.AKj(!!h,!!r,b);let L=null;if(3===A){if(!b)return null;h=this.kk.wBf(b);(h=this.kk.tmi(h))&&(b+=h);L=this.kk.pcb(b)}else 2===A?L=this.kk.Dig(r,!0):1===A&&(L=this.kk.pcb(h));return L}O_c(b,h){if(this.a3b)h=this.QGf(this.AMe),this.AMe=null;else{if(!this.Gxd)return h;
b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.Gxd;h=b.body;this.Gxd=null}return h}QXb(b){const h=Q.a.create();this.Vrh=h;this.k2a.i0b?v.ULS.sendTraceTag(7377737,307,50,h.toString()):v.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.a3b?"getClipboardData":"paste";chrome.runtime.sendMessage(this.iHc,r,A=>{h.equals(this.Vrh)?this.a3b?this.AMe=A:this.Gxd=A:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&
(this.SYl(),this.k2a.i0b?v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}z0b(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.sbc?b=this.aTe+this.b1e:this.pMe&&(b=this.aTe+this.iHc);Aw.instance.Yrf(this.seo,b,this.sbc)}SYl(){this.k2a.gGj();this.z0b()}PLj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}Eol(){const b=Q.a.create();this.k2a.i0b?v.ULS.sendTraceTag(592491466,307,
50,b.toString()):v.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.iHc,{command:"getAvailableCommands"},h=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Gb.a)(Array,h)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.KPd=-1!==Array.indexOf(h,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.KPd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.OBh&&this.k2a.gGj(),this.KPd=!1)})}c1h(){const b=Q.a.create();this.k2a.i0b?v.ULS.sendTraceTag(7726105,307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.mPd&&this.Eol();this.PLj(this.iHc,h=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.mW=!0:(h?"ping"!==h&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:
null):v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.z0b(),this.mW=!1);this.mPd&&!this.a3b&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}p$i(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.YAh&&(b&&xa.Health.instance.recordKpiSuccess(Vt.uwh,
null),h&&xa.Health.instance.recordKpiSuccess(Vt.rwh,null))}BEn(){this.YAh&&(xa.Health.instance.recordKpiUsage(Vt.uwh,1,Vt.Tgh,null),xa.Health.instance.recordKpiUsage(Vt.rwh,1,Vt.Tgh,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.k2a.i0b;this.PLj(this.b1e,h=>{this.p$i(b,!!h)})}else this.p$i(!1,!1)}}Vt.uwh="OfficeOnlineExtensionInstallationStatus";Vt.rwh="OfficeClipboardExtensionInstallationStatus";Vt.Tgh="wwccp";Object(u.a)(Vt,"ChromeSystemClipboardAccessManager",null,[724]);class EG{constructor(b,
h){this.mW=null;this.gf=b;this.Aa=h;this.$ok=!this.Aa.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Aa.$("BlockCopyCutOnFirefoxIsEnabled");this.PMk=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}x_c(b){this.$ok&&b&&this.gf.nj?(this.z0b(),this.mW=!1):this.mW=!0}get Stg(){return this.mW}get a3b(){return!1}RAf(b){return rd.a.AOb(b,"copy")}O_c(b,h){rd.a.AOb(b,"paste");return h}QXb(b){b()}ard(b,h,r){if(this.gf.y7)return this.PMk&&(this.mW=!1),!1;h();r();b=this.O_c(b.ownerDocument,b);
h=b.innerHTML;b.innerHTML=eb.a.create().toString();r();b=this.O_c(b.ownerDocument,b);return this.mW=b=h===b.innerHTML}z0b(){Aw.instance.Yrf(null,null)}}Object(u.a)(EG,"DefaultSystemClipboardAccessManager",null,[724]);class sJ{constructor(b,h,r){this.mW=this.zda=this.G9b=this.Fpa=this.I3a=this.Cxd=null;this.kk=h;this.R3a=r;this.CEk=b.jc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.vNk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}x_c(b){this.vNk&&
b&&(this.mW=!0)}get Stg(){return this.mW}get a3b(){return!1}RAf(b){return b?rd.a.AOb(b,od.a.iE):!1}O_c(b,h){this.I3a&&(h=this.I3a,this.I3a=null);return h}QXb(b,h=null){if(b&&h){this.Cxd=b;this.G9b=h;$addHandler(this.G9b,od.a.paste,Object(D.a)(this,this.pmj,"onPasteEvent"));this.zda=this.Fpa=null;if(this.h4j(this.G9b)){if(this.zda&&0<this.zda.length&&(!this.Fpa||this.kk.dFe(this.Fpa))){this.R3a.B7h(this.zda,Object(D.a)(this,this.s_n,"onImageConverted"));this.I3a&&!this.I3a.hasChildNodes()&&v.ULS.sendTraceTag(42592151,
307,50,"pastedContentDom has no child nodes.");return}this.Fpa&&this.Fpa.innerHTML&&((this.I3a=this.$Oi(this.Fpa.innerHTML))&&!this.I3a.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Je.a.sF(this.Fpa))}this.Foi()}else b&&b()}ard(b){return this.mW=b=this.h4j(b.ownerDocument)}pmj(b){try{b&&b.rawEvent&&((this.Fpa=b.rawEvent.target)&&this.Fpa.id&&-1<this.Fpa.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+
this.Fpa.id),this.Fpa=null):this.zda=this.Zvm(b.rawEvent))}catch(h){v.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+h.toString())}}s_n(b){b&&(this.R3a.PSj&&(b=String.format('<img src="{0}">',b)),this.I3a=this.$Oi(b));this.Foi()}Foi(){this.G9b&&($removeHandler(this.G9b,od.a.paste,Object(D.a)(this,this.pmj,"onPasteEvent")),this.G9b=null);this.Cxd&&(this.Cxd(),this.Cxd=null)}Zvm(b){let h=null;(b=this.kk.Pui(b))&&({bTf:h}=this.kk.K3j(b,this.CEk,this.R3a.Ccj));
return h}h4j(b){return rd.a.AOb(b,od.a.paste)}$Oi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}z0b(){}}Object(u.a)(sJ,"EdgeSystemClipboardAccessManager",null,[724]);class Bw{constructor(b,h,r,A){this.Aa=b;this.pqk=h;this.kk=r;this.gf=A}create(){let b=null;y.AFrameworkApplication.qBg()&&this.gf.Nr&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Vt(this.Aa,this.pqk,this.kk),this.Aa.$("LogChromeExtensionInstallationStatusIsEnabled")&&
b.BEn()):this.Aa.$("EdgeContextMenuPasteFixIsEnabled")&&this.gf.au?(v.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),b=new sJ(this.Aa,Wa.a.instance.resolve("Box4.IClipboardDataHelper"),Wa.a.instance.resolve("Box4.IProcessImageStrategy"),Wa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new EG(this.gf,this.Aa));return b}}Object(u.a)(Bw,"SystemClipboardAccessManagerFactory",
null,[695]);var Cw=d(791),iB;(function(b){b[b.automatic=1]="automatic";b[b.clear=2]="clear";b[b.Oeb=3]="themeColors";b[b.Wnq=4]="standardColors";b[b.IP=5]="recentColors";b[b.w9p=6]="moreColors";b[b.dWa=7]="highContrastColors"})(iB||(iB={}));Object(u.b)("ColorMenuControls",iB);var Yx=d(1045);class Wq{constructor(b){this.uLc=null;this.Qxd={};this.HSb=()=>{this.uLc=null};this.mO=b;this.Z6e=""}get mca(){return this.Z6e}set mca(b){b=b||"";this.Z6e!==b&&(this.Z6e=b,this.HSb())}cqb(b,h){if(this.uLc)return this.uLc;
if(!b)return null;const r=Object.assign(new Ee.a,{Id:String.format("menu{0}Color",this.mO),ExternalId:String.format("{0}Color",this.mO)});r.MenuSectionList=[];Object(Yx.a)()&&r.MenuSectionList.push(this.hXk());r.MenuSectionList.push(this.YUk());r.MenuSectionList.push(this.zVk());r.MenuSectionList.push(this.t_k(b,h));r.MenuSectionList.push(this.a_k());return this.uLc=r}PH(b,h){iB[b]in this.Qxd||(this.Qxd[iB[b]]=h)}z5a(b,h){b.wdf(this.HSb,h)}hXk(){if(!({actionId:h}=this.isd(7)).returnValue)return null;
const b=Object.assign(new hh.a,{Id:String.format("{0}Color",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new Mj.a,{Command:h.toString(),LabelText:F.a.yf(Box4Intl.Box4Strings.L_HighContrastColorPicker),Image16by16:y.AFrameworkApplication.Lr,Image16by16Class:Pb.getImageClass("Automatic_16x16x32"),Id:String.format("HighContrast{0}ColorPicker",this.mO),ExternalId:String.format("HighContrast{0}ColorPicker",this.mO),KeyTip:CommonUIStrings.l_HighContrastColorPickerKeytip,
QueryCommand:vb.a.Cid.toString()});b.ControlList.push(h);return b}YUk(){if(!({actionId:h}=this.isd(1)).returnValue)return null;const b=Object.assign(new hh.a,{Id:String.format("{0}Color",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new Mj.a,{Command:h.toString(),LabelText:F.a.yf(Box4Intl.Box4Strings.L_Automatic),Image16by16:y.AFrameworkApplication.Lr,Image16by16Class:Pb.getImageClass("Automatic_16x16x32"),Id:"automatic",
KeyTip:CommonUIStrings.l_AutomaticKeytip});b.ControlList.push(h);return b}zVk(){if(!({actionId:h}=this.isd(2)).returnValue)return null;const b=Object.assign(new hh.a,{Id:String.format("{0}Color",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new Mj.a,{Command:h.toString(),LabelText:F.a.yf(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:y.AFrameworkApplication.Lr,Image16by16Class:Pb.getImageClass("NoHighlight_16x16x32"),
Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});b.ControlList.push(h);return b}t_k(b,h){if(!({actionId:A}=this.isd(3)).returnValue)return null;const r=Object.assign(new hh.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),ControlList:[]});var A=Object.assign(new Cw.a,{Id:String.format("Theme{0}ColorPicker",this.mO),ExternalId:String.format("Theme{0}ColorPicker",this.mO),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.mO),McuLayout:!0,Command:A.toString(),
Width:10});const {dvl:L,Mkp:Z}=Wq.JOm(b,h);A.Colors=L;this.yPj(A,Z);r.ControlList.push(A);return r}a_k(){if(!({actionId:h}=this.isd(4)).returnValue)return null;const b=Object.assign(new hh.a,{Id:String.format("{0}Colors",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),Title:F.a.yf(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var h=Object.assign(new Cw.a,{Id:String.format("Standard{0}ColorPicker",this.mO),ExternalId:String.format("Standard{0}ColorPicker",this.mO),
Command:h.toString(),Width:10,Colors:[]});h.Colors=Wq.TLm();this.yPj(h);b.ControlList.push(h);return b}yPj(b,h){if(b){var r="";"object"===typeof this.mca?void 0!==h&&(r=this.nKm(h,this.mca)):r=this.YJm(b.Colors,this.mca);b.Stateful=!0;b.SelectedColorId=""!==r?r:"NoColor"}}nKm(b,h){var r,A;let L="";for(const Z of b)if(Z.iCe===h.cuc&&Z.ixc===(null===(r=h.lIa)||void 0===r?void 0:r.ixc)&&Z.Seb===(null===(A=h.lIa)||void 0===A?void 0:A.Seb)){L=Z.evl;break}return L}YJm(b,h){let r="";if(!b)return r;for(let A=
0;A<b.length;A++)if(b[A].DisplayColor.toLowerCase()===h.toLowerCase()){r=b[A].Color;break}return r}isd(b){b=iB[b];return b in this.Qxd?{returnValue:!0,actionId:this.Qxd[b]}:{returnValue:!1,actionId:0}}static TLm(){const b=[];b.push(Object.assign(new Wl,{Color:"0000C0",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));b.push(Object.assign(new Wl,{Color:"0000FF",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));b.push(Object.assign(new Wl,{Color:"00C0FF",
Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));b.push(Object.assign(new Wl,{Color:"00FFFF",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));b.push(Object.assign(new Wl,{Color:"50D092",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));b.push(Object.assign(new Wl,{Color:"50B000",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));b.push(Object.assign(new Wl,{Color:"F0B000",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorLightBlue),
DisplayColor:"#00B0F0"}));b.push(Object.assign(new Wl,{Color:"C07000",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));b.push(Object.assign(new Wl,{Color:"602000",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));b.push(Object.assign(new Wl,{Color:"A03070",Alt:F.a.yf(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return b}static JOm(b,h){const r=b.properties.ka(Vc.a.Oeb,null);b=b.properties.getValue(Vc.a.lCe).split(" ");const A=
[],L=[];for(let gb=0;6>gb;gb++)for(let Ab=0;10>Ab;Ab++){var Z=10*gb+Ab,oa=r[Z];oa=oa&4278190080|(oa&255)<<16|oa&65280|(oa&16711680)>>>16;Z=F.a.JJ(Z+1<<24,8);var Ba=h[b[Ab]];const Jb=this.bsi(gb,Ab,r[Ab]);Jb.evl=Z;L.push(Jb);Ba=Wq.Tmp(Ba,Jb);A.push(Object.assign(new Wl,{Color:Z,DisplayColor:"#"+F.a.JJ(oa,6),Alt:F.a.yf(Ba)}))}return{dvl:A,Mkp:L}}static Tmp(b,h){if(void 0===h.ixc&&void 0===h.Seb)return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,b,h.XGg);const r=void 0!==h.Seb;return String.format(r?
Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,b,h.XGg,r?h.Seb:h.ixc)}static bsi(b,h,r){if(b){var A=r&255,L=(r&65280)>>>8;r=(r&16711680)>>>16;L=Math.floor((Math.min(Math.min(A,L),r)+Math.max(Math.max(A,L),r))/2);A=b-1;L?255===L?(b=!1,A=[242,217,191,166,128][A]):204<L?(b=!1,A=[230,191,128,64,26][A]):51>L?(b=!0,A=[26,64,128,191,230][A]):(L=[51,102,153],r=[191,128],A=(b=A<L.length)?L[A]:r[A-L.length]):(b=!0,A=[128,166,191,217,242][A]);A=255-A;h={iCe:Wq.hCe[h].name,
XGg:Wq.hCe[h].label};b?h.Seb=Math.round(100*A/255):h.ixc=Math.round(100*A/255);return h}return{iCe:Wq.hCe[h].name,XGg:Wq.hCe[h].label}}static Oqp(b,h){if((h=h.properties.ka(Vc.a.Oeb,null))&&0<=b&&b<h.length){const r=b%10;return Wq.bsi(Math.floor(b/10),r,h[r])}}}Wq.hCe={0:{name:"background1",label:Box4Intl.Box4Strings.l_ThemeLabel1},1:{name:"text1",label:Box4Intl.Box4Strings.l_ThemeLabel2},2:{name:"background2",label:Box4Intl.Box4Strings.l_ThemeLabel3},3:{name:"text2",label:Box4Intl.Box4Strings.l_ThemeLabel4},
4:{name:"accent1",label:Box4Intl.Box4Strings.l_ThemeLabel5},5:{name:"accent2",label:Box4Intl.Box4Strings.l_ThemeLabel6},6:{name:"accent3",label:Box4Intl.Box4Strings.l_ThemeLabel7},7:{name:"accent4",label:Box4Intl.Box4Strings.l_ThemeLabel8},8:{name:"accent5",label:Box4Intl.Box4Strings.l_ThemeLabel9},9:{name:"accent6",label:Box4Intl.Box4Strings.l_ThemeLabel10}};Object(u.a)(Wq,"ColorMenu",null,[531]);class FG{x3l(b){return b}}Object(u.a)(FG,"DeleteTableSegmentStrategy",null,[694]);var An=d(462),yt=d(1034);
class wh{get fr(){return vw.a.zQb}get ql(){return null!=this.Z1g?this.Z1g:this.Z1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}get N3(){return this.ql.fr}get Ac(){return ih.a.instance}get jC(){return null!=this.j2g?this.j2g:this.j2g=Wa.a.instance.resolve("Box4.IParagraphIndentationReader")}mTc(b,h,r,A,L,Z,oa){let Ba=2;if(!b.ve)return 2;const gb=b.lb;if(!gb)return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.qga}),8;if(y.AFrameworkApplication.J.$("Box4PartialPromoteDemoteIsEnabled")){b=this.b_h(h===vb.a.KI,
r,!0);if(1===A)return b?32:8;b&&(Ba=yt.a.Ftc(h,r,A,L,Z,oa))}else Ba=yt.a.Ftc(h,r,1,L,Z,oa),1!==A&&32===Ba?(b.lb.pne(),b=new Sb.GraphTransaction(15),b.Ab(r.view.vd),Ba=this.b_h(h===vb.a.KI,r,!1)?yt.a.Ftc(h,r,A,L,Z,oa):8,b.dispose()):1!==A&&8===Ba&&(b.lb.pne(),this.Oxl(h,r,gb));return Ba}b_h(b,h,r){h=h.view.lb;if(!h||!h.gb.currentSelection)return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.fWb}),!1;if(h.gb.GL)return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Aqf}),!1;h=An.OutlineElementGeneralizer.cla(h.gb,!1);if(!h)return this.Ac.fc(Df.a.Ne,
{["Reason"]:gf.a.Y1d}),!1;let A=!1;for(let L=0;L<h.length;L++){const Z=h.getContext(L),oa=new hb.a;oa.set(Z.node);he.a.Ou(oa);if(!Eb.a.Mh(oa))if(r)continue;else return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UNb}),!1;if(b?!this.fr.ILb(oa):!this.fr.$dc(oa))if(r)continue;else return this.Ac.fc(Df.a.Ggc,{["Reason"]:gf.a.Lmf}),!1;A=!0}return r?A:!0}Oxl(b,h,r){const A=new Sb.GraphTransaction(15);try{A.Ab(h.view.vd);h=!0;const L=An.OutlineElementGeneralizer.cla(r.gb,!1);for(let Z=0;Z<L.length;Z++){const oa=
L.getContext(Z),Ba=new hb.a;Ba.set(oa.node);he.a.Ou(Ba);if(!Eb.a.Mh(Ba))h=!1;else if(b===vb.a.KI?this.fr.ILb(Ba):this.fr.$dc(Ba))switch(h=!1,b){case vb.a.KI:this.fr.hZa(Ba,-1,0);break;case vb.a.eR:this.fr.LYc(Ba,1)}}if(h){const Z=r.gb.currentSelection;for(r=0;r<Z.length;r++){const oa=Z.K(r);if(oa.Al){const Ba=this.jC.Sqb(oa.node),gb=Ba.yha;if(b===vb.a.KI?Ba.RA>gb:Ba.RA<18*gb){const Ab=new hb.a;Ab.set(oa.node);this.N3.PDa(Ab,1,b===vb.a.KI?Ba.RA>=2.5*gb?Ba.RA-2*gb:gb:Ba.RA<16*gb?Ba.RA+2*gb:18*gb)}}}}}finally{A&&
A.dispose()}}}Object(u.a)(wh,"IndentationActorExtension",null,[693]);var zz=d(767),MC=d(1189);class Py{constructor(b,h){this.Mo=new lj.DictionaryPropertySet;this.IJd=new lj.DictionaryPropertySet;this.$Eb=!1;this.CGa=this.bhb=null;this.M9=b;this.uih=h}get Xzb(){return null!=this.c5g?this.c5g:this.c5g=Wa.a.instance.Oa("Box4.ITextFormattingCommands")}get tj(){return null!=this.qWg?this.qWg:this.qWg=Wa.a.instance.resolve("Box4.IFormattingEditor")}get Yb(){return null!=this.j7g?this.j7g:this.j7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}xxb(){this.$Eb||
(0<this.EWa.bL()&&(this.IJd=this.Mo.clone()),this.Mo.tte(),this.bhb=null,this.eAo())}CCl(b){var h;const r=null!==(h=Ya.FormattingReader.Vs(b))&&void 0!==h?h:Ya.FormattingReader.a6d(b.node,b.cpBegin,-1);!r.cache.tE&&(b=r.mo)&&(h=new lj.DictionaryPropertySet,h.zt(b),h.zt(this.Mo),h.hasProperty(cg.a.Lw)&&(this.bhb=r.paragraph.Hc),this.Mo=h)}hasProperty(b){return this.Mo.hasProperty(b)}S5c(){return 0<this.Mo.bL()}get EWa(){return this.Mo}freeze(){this.$Eb=!0}qOa(){this.$Eb=!1}rI(b,h){return this.EWa.ka(b,
h)}pC(b){this.Mo.setValue(Ke.a.fontSize,this.tj.Uec(b));this.f4();Pn.a.jpg(this.IJd,this.Mo)}fontSize(){return this.Mo.ka(Ke.a.fontSize,Pn.a.VO)}Twe(b){this.Mo.setValue(Ke.a.font,b);this.uih&&this.uih.execute(h=>{null==h?v.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.Twe(this.Mo)});this.M9&&this.M9.enabled&&(Uc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.M9.eVo(this.Mo,b));this.f4();Pn.a.jpg(this.IJd,this.Mo)}qzg(b){this.Mo.setValue(Vc.a.Te,
b);this.M9&&this.M9.enabled&&(Uc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.M9.L_o(this.Mo,b));this.f4()}hx(b){b=Bq.a.instance.lka(If.a.instance.gb.currentSelection.Qa.node,b);this.Mo.setValue(Ke.a.fontColor,b);this.f4();Pn.a.jpg(this.IJd,this.Mo)}jka(){this.Mo.setValue(Ke.a.fontColor,Ql.a.auto);this.f4()}fontColor(){return this.Mo.ka(Ke.a.fontColor,Ql.a.nil)}NDa(b){this.Mo.setValue(Ke.a.highlight,parseInt(b,16));this.f4()}sVd(){this.Mo.setValue(Ke.a.highlight,Ql.a.auto);
this.f4()}isBold(){return this.Mo.ka(Ke.a.bold,!1)}HN(b){this.Mo.setValue(Ke.a.bold,b);this.f4()}isItalic(){return this.Mo.ka(Ke.a.italic,!1)}fA(b){this.Mo.setValue(Ke.a.italic,b);this.f4()}isUnderline(){return this.Mo.ka(Ke.a.underline,!1)}C8(b){this.Mo.setValue(Ke.a.underline,b);this.Mo.setValue(Ke.a.underlineType,b?Pn.a.wAb:Pn.a.xV);this.f4()}underlineType(){return this.Mo.ka(Ke.a.underlineType,Pn.a.xV)}sha(b){b<Pn.a.wAb||b>Pn.a.xV||(this.Mo.setValue(Ke.a.underline,b!==Pn.a.xV),this.Mo.setValue(Ke.a.underlineType,
b),this.f4())}isSuperscript(){return this.Mo.ka(Ke.a.superscript,!1)}hva(b){this.Mo.setValue(Ke.a.superscript,b);b&&this.isSuperscript()&&this.Mo.setValue(Ke.a.subscript,!1);this.f4()}isSubscript(){return this.Mo.ka(Ke.a.subscript,!1)}NNa(b){this.Mo.setValue(Ke.a.subscript,b);b&&this.isSubscript()&&this.Mo.setValue(Ke.a.superscript,!1);this.f4()}isStrikethrough(){return this.Mo.ka(Ke.a.strikethrough,!1)}una(b){this.Mo.setValue(Ke.a.strikethrough,b);this.f4()}isDoubleStrikethrough(){return this.Mo.ka(cg.a.xu,
!1)}Owe(b){this.Mo.setValue(cg.a.xu,b);this.f4()}wui(){return this.Mo.ka(cg.a.Lw,null)}beb(b,h){this.Mo.tte();this.Mo.setValue(cg.a.Lw,b.id);this.bhb=h.Hc;this.f4()}z8(b){let h=Ke.a.RF;const r=zz.a.Wge(b);switch(r){case 1:h=Vc.a.Npc;break;case 2:h=Vc.a.Opc}this.Mo.setValue(Vc.a.Gab,r);this.Mo.setValue(h,b);this.f4()}language(){let b=Ke.a.RF;switch(this.Mo.ka(Vc.a.Gab,0)){case 1:b=Vc.a.Npc;break;case 2:b=Vc.a.Opc}return this.Mo.ka(b,0)}wXo(b){this.Mo.setValue(Vc.a.noProof,b);this.f4()}rTb(){return this.Mo.ka(Vc.a.noProof,
!1)}Con(){return this.Mo.hasProperty(Vc.a.noProof)}cnn(){return this.Mo.hasProperty(Ke.a.RF)||this.Mo.hasProperty(Vc.a.Npc)||this.Mo.hasProperty(Vc.a.Opc)}f4(){if(aa.a.Myc){Object(Kb.a)();var b=If.a.instance.gb.currentSelection.Qa,h=b.node;if(h===this.CGa)this.CGa.Xl(16,!0);else{this.CGa=h;h=this.CGa.H0();try{this.CGa.o_(b.cpBegin).BBa=!0}finally{h&&h.dispose()}}}}eAo(){if(aa.a.Myc&&this.CGa){var b=0,h=this.CGa.H0();try{for(let r=this.CGa.ra.length-1;0<=r;r--){const A=this.CGa.ra.Ub(r);A.BBa&&(A.BBa=
!1,b++,A.isEmpty&&this.CGa.ra.Fua(r))}}finally{h&&h.dispose()}this.CGa=null}}FAl(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.ra.Dh(b.cpBegin);return!!b&&b.BBa}Ihf(b){if(this.Xzb){this.freeze();var h=new Sb.GraphTransaction(7);h.Ab(b.node);this.Xzb.Vwe(b);this.qOa();this.xxb();h.dispose()}}MMf(b){const h=Cd.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!F.a.Zw(h.charCodeAt(b.cpBegin))&&MC.a.instance.W8a(h,b.cpBegin-1)!==b.cpBegin&&he.a.Qtb(b)?(b=he.a.T6(b,!1))?1<b.length||he.a.Zl(b.Qa)?
b:null:null:null}}Object(u.a)(Py,"InsertionPointFormatting",null,[691]);class Xw extends Dg.a{constructor(b,h){super(!1,!1,!0);this.kvl=(r,A)=>{1===r?(r=A.selectedColorText,6!==r.length?v.ULS.sendTraceTag(595345436,340,10,"Color picker dialog did not return the color in expected format RRGGBB. Color returned: {0}, Menu: {1}",r,this.mO):(r=r.substring(4,6)+r.substring(2,4)+r.substring(0,2),y.AFrameworkApplication.va.Qb(this.QMe,2,r),v.ULS.sendTraceTag(595345435,340,50,"Color selected from color picker dialog. Menu: {0}",
this.mO))):v.ULS.sendTraceTag(595345434,340,50,"Color picker dialog closed without selecting any color. Menu: {0}",this.mO)};this.mO=b;this.QMe=h}Vyb(b=0){const h={};h.initColor=Ql.a.JB(b);h.redLabel=Box4Intl.Box4Strings.L_FontColorRed;h.blueLabel=Box4Intl.Box4Strings.L_FontColorBlue;h.greenLabel=Box4Intl.Box4Strings.L_FontColorGreen;h.hexLabel=Box4Intl.Box4Strings.L_FontColorHex;this.Uh(Box4Intl.Box4Strings.L_MenuCustomColors,this.kvl,{["id"]:"ColorPickerDialog",["bodyControls"]:h});v.ULS.sendTraceTag(595345437,
340,50,"Color picker dialog is opened. Menu: {0}",this.mO)}}Object(u.a)(Xw,"ColorPickerDialog",Dg.a,[]);class nw{constructor(b,h,r,A,L,Z){this.pMn=b;this.eua=h;this.Fva=r;this.Yo=A;this.IP=L;this.whg=Z;this.N_i=!1;this.Xfd=(oa,Ba,gb)=>{if(1===gb)return 32;oa=this.Oh.ka(Ke.a.fS,Ql.a.jB);(new Xw(nw.unb,vb.a.Ywc)).Vyb(oa);return 32};this.Xtc=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;oa=this.Oh.ka(Ke.a.fS,Ql.a.jB);oa=Ql.a.JB(oa);this.Kfa(this.whg);this.whg.mca=oa;this.IP.NAc(oa);oa=this.whg.cqb(this.Oh,
ed.a.RTa);if(!oa)return 8;Jb.MenuItems=oa;v.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.Phf=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;Ba=this.Yo.Lc(15);Ba.Ab(this.Oh);switch(oa){case vb.a.yVd:this.Oh.hasProperty(Ke.a.fS)&&this.Oh.setValue(Ke.a.fS,Ql.a.jB);break;case vb.a.h_a:Jb=this.Fva.lka(this.Oh,Jb);this.Oh.setValue(Ke.a.fS,Jb);break;case vb.a.Ywc:oa=this.Fva.lka(this.Oh,Jb),this.Oh.setValue(Ke.a.fS,oa),this.IP.cTa(Jb)}Ba.dispose();return 32}}Kfa(b){this.N_i||
(b.PH(2,vb.a.yVd),b.PH(3,vb.a.h_a),b.PH(4,vb.a.h_a),b.PH(5,vb.a.Ywc),b.PH(6,vb.a.Xfd),b.z5a(this.pMn,1),this.N_i=!0)}Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.Xfd,kc.a.view,this.Xfd);b.qa(vb.a.Xtc,kc.a.view,this.Xtc);b.qa(vb.a.h_a,kc.a.view,this.Phf);b.qa(vb.a.yVd,kc.a.view,this.Phf);b.qa(vb.a.Ywc,kc.a.view,this.Phf);b.Pc(vb.a.Xtc,1127)}get Oh(){return this.eua.value}}nw.unb="Page";Object(u.a)(nw,"PageColorActor",null,[]);var Rz=d(554),lq=d(478);class jB extends bx.a{constructor(b,h,r,A,L,
Z,oa,Ba,gb,Ab,Jb){super();this.Y9b=this.Zn=this.aQa=null;this.cio=(Tb,jc)=>{jc=this.zxa.zqe(this.aQa,jc);Tb.Ni(this.cem);return jc};this.cem=(Tb,jc)=>{if(this.Zn.moveNext())return Tb=this.Zn.currentNode,12!==Tb.type||Tb===this.aQa.node?!0:this.zxa.Thd(Tb,jc);this.Qhl();Tb.Ni(this.hem);return!0};this.hem=(Tb,jc)=>{if(this.Zn.moveNext()){const Hc=this.Zn.currentNode;return 12!==Hc.type?!0:Hc===this.aQa.node?(Tb.Ni(this.dio),!0):this.zxa.Thd(Hc,jc)}return!1};this.dio=(Tb,jc)=>{this.zxa.Aqe(this.aQa,
jc);return!1};this.init(b);this.nm(Jb);this.usb(Ba,h,A,L,Z);this.YN=Z;this._context=r;this.ib=gb;this.Qe=Ab;this.zxa=oa;this.pA=0}run(){this.vnf();this.pA||this.C1o();1===this.pA&&this.njo();2===this.pA&&this.xjp();3===this.pA&&this.w$l()}vnf(){this.ib.gb&&this.ib.gb.currentSelection?1===this.behavior&&(this.zxa.vnf(this._context)?this.hs=32:this.hs=2,this.pA=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.hs=2,this.pA=3)}C1o(){this.uhl();this.zxa.Tzg(this.aQa)?(this.Ogl(),
this.pA=1):(this.hs=8,this.pA=3)}njo(){this.PC||new Tt.a(this,this.cio,this.YN);do if(this.PC.run(),this.PC.Dfa&&!this.oi)return;while(this.PC.Dfa);this.oVd();this.pA=2}xjp(){this.zxa.jGg(this)?this.hs=32:this.hs=8;this.pA=3}w$l(){this.fva()}uhl(){let b=this.ib.gb.currentSelection;if(b=this.Qe.vk(b,!0,!1))this.aQa=b.Qa;this.aQa&&this.aQa.node&&(this.Y9b=this.zxa.GEi(this.aQa.node))}Ogl(){if(!this.Y9b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new zl.a;b.set(this.aQa.node);
b.zb(this.Y9b.type);this.Zn=uw.a.At(b,this.Y9b);this.Zn.zp(Object(D.a)(this.zxa,this.zxa.gyc,"spellErrorFilter"),null)}Qhl(){if(!this.Y9b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new zl.a;b.set(this.Y9b);this.Zn=uw.a.zq(b);this.Zn.zp(Object(D.a)(this.zxa,this.zxa.gyc,"spellErrorFilter"),null)}}Object(u.a)(jB,"ProofingWholeDocumentOperation",bx.a,[]);var GG=d(278);class ow extends gp{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(u.a)(ow,"ContextMenuRootProperties",
gp,[]);var lL=d(2031);class tJ{constructor(b){const h=new ow;h.ImageSideArrow=y.AFrameworkApplication.Lr;h.ImageSideArrowClass=Pb.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=vb.a.Wpe.toString();this.wHh=new lL.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.T8.tH=r});this.T8.refresh();y.AFrameworkApplication.va.qa(Za.a.showContextMenu,Gc.a.frame,Vd.ActionManager.eg);y.AFrameworkApplication.va.qa(Za.a.Jxc,
Gc.a.frame,Vd.ActionManager.eg)}get T8(){return this.wHh}dispose(){this.T8&&(this.T8.dispose(),this.wHh=null)}showContextMenu(b,h){this.x0b(b,h.clientPoint,h.yg)}geb(b,h,r){rd.a.aje(this.T8.o5a?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");ab.StaticActiveAppFrame.za().Xcm();this.ov();this.T8.geb(b,h,r);this.T8.o5a?y.AFrameworkApplication.va.Ob(Za.a.Jxc,2):y.AFrameworkApplication.va.Ob(Za.a.showContextMenu,2)}x0b(b,h,r){this.geb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}ov(){this.T8.root.xn()}K6(){return this.T8.K6()}Jxc(b,
h,r,A){const L=this.T8;let Z=!1;r=Object(Ca.a)(Fv,r);L.o5a=r;A.WDa(b,h);L.gdf?r&&(r.zeo(L,h),Z=!0):(v.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",A.RMl()),L.o5a=null);return Z}}Object(u.a)(tJ,"AContextMenuController",null,[723,10]);class zE{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=zE.L_l;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=
this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}zE.L_l=[];Object(u.a)(zE,"Critique",null,[]);class uJ{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(u.a)(uJ,"Suggestion",null,[]);var vJ=d(615);class wJ extends Sys.EventArgs{constructor(b,h,r,A,L,Z){super();this.Rxk=b;this.Wzk=h;this.Xzk=r;this.WIe=A;this.kB=L;this.hgb=
Z}}Object(u.a)(wJ,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var BM=d(319);class zt{constructor(b,h,r){this.UQe=b;this.Wn=h;this.sa=r}C7h(b){const [h,r,A]=this.qJi(b);return this.mxi(h,r,A)}Thn(b){return gq.a.getTypeNameFor(b.content)===BM.a.getTypeName()}mxi(b,h,r){if(r&&this.Thn(r)){if(this.Lcc(r.content))return null;const L=r.content;var A=new zE;A.ExplanationTitle=L.explanationTitle;A.Suggestions=this.NMm(r);A.CategoryTitle=L.categoryName;A.TypeId=L.typeId;A.CritiqueActions=L.critiqueActions;
A.Priority=L.priority;r=this.UQe.create(A);A=L.context;r.token=A.substring(L.range.start,L.range.start+L.range.length);r.lcid=kg.a.Eg(L.language).LCID;r.originalText=A;return new vJ.a(b,h,r)}return null}NMm(b){var h=b.content.suggestions;b=[];for(const r of h)h=new uJ,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}Lcc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}qJi(b){const h=this.Wn.u3c(b,0),r=b.cpBegin,A=b.cpEnd,
L=he.a.mf(b);b=Cd.ParagraphReader.text(b.node,0);for(const Z of h)if(L){if(Z.Dc<=r&&Z.end>=A)return[Z.Dc,Z.end,Z.intent]}else if(Z.Dc<=r&&Z.end>=r&&F.a.w6h(b,Z.end,A))return[Z.Dc,Z.end,Z.intent];return[null,null,null]}static nD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}BQf(b,h,r){const [A,L,Z]=this.qJi(b);Z&&this.sa.raiseEvent(zt.$Uh,new wJ(b,A,L,h,Z,r))}U0k(b){this.sa.addHandler(zt.$Uh,b)}O6l(b,h,r){b=
this.Wn.Ujc(b,0,0,b.characterData.length);for(let A=0;A<b.count;A++){const L=b.K(A);if(L.intent){const Z=L.intent;if(Z.content&&(0==Z.content.priority||1==Z.content.priority)&&L.Dc>=h&&(!r||r(L.intent)))return this.mxi(L.Dc,L.end,L.intent)}}return null}}zt.$Uh="augloopProofingContextMenuActionEventKey";Object(u.a)(zt,"AugLoopProofingErrorDetailHelper",null,[]);class yr{}yr.juc="faProofing";yr.rii="EditorMenuSection";Object(u.a)(yr,"ContextMenuControlId",null,[]);class Zx{constructor(b){this.Qe=b}vnf(b){b=
Object(Ca.a)(wr.a,b);return!!b&&!!b.view&&b.view.ve}Tzg(){return!0}zqe(){return!0}Thd(){return!0}Aqe(){}jGg(){return!0}gyc(b){if(b.xs)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}GEi(b){if(!b||!this.Qe)return b;const h=new zl.a;h.set(b);if(this.Qe.Ou(h)){for(;!h.xs;)h.uc();return h.currentNode}return b}}Object(u.a)(Zx,"SimpleProofingWholeDocumentCallBacks",null,[530]);class hv{constructor(b){this.value=b}}Object(u.a)(hv,"RefBool",null,[]);class NC{constructor(){this.G_c=this.dWb=null;
this.W4j=new hv(!1)}}Object(u.a)(NC,"FindNextErrorOperationParam",null,[]);class HG extends Zx{constructor(b,h,r,A){super(h);this.ko=b;this.DPc=r;this.xok=A}zqe(b,h){return!this.T4f(b.node,b.cpBegin,h)}Thd(b,h){return!this.T4f(b,0,h)}Aqe(b,h){this.T4f(b.node,0,h);Object(Ca.a)(NC,h)}T4f(b,h,r){r=Object(Ca.a)(NC,r);if(Cd.ParagraphReader.Wb(b)&&!b.CL)if(Ya.FormattingReader.Vs(xc.a.Uc(b,h)).cache.rTb)r.W4j.value=!0;else{if(zt.nD())return h=this.xok.O6l(b,h,this.DPc),null!=h?(r.dWb=h,r.G_c=b,!0):!1;const A=
this.ko.f7(b);for(let L=0;L<A.length;L++){const Z=A[L];if(Z.Dc>=h&&!Z.errorDetails.X$a()&&(!this.DPc||this.DPc(Z.errorDetails)))return r.dWb=Z,r.G_c=b,!0}return!1}}}Object(u.a)(HG,"FindNextErrorCallbackSteps",Zx,[]);class IG{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd){this.Dul=(de,qe,oe,ge,$d)=>{qe=this.ib.gb.currentSelection;if(!qe)return this.zd.fc(Df.a.Ne,{["Reason"]:gf.a.Qn}),2;qe=this.Qe.vk(qe,!0,!1);return this.ga.Hf(qe.Qa,de,oe,!1,ge,$d)};this.S6n=(de,qe,oe)=>{if(1===oe)return this.ga.Ob(vb.a.z8,
1);this.ZCk().YBg();return 32};this.aJa=(de,qe,oe)=>{if(1===oe)return 32;db.a.mark(4670);oe=this.ko.msa(qe);if(this.tDe(oe))return 8;qe=qe.node;const ge=this.Rc.Lc(15);let $d=oe.Dc;" "===Cd.ParagraphReader.text(qe).charAt($d-1)&&$d--;ge.Ab(qe);const lf=this.Rd.We(xc.a.createTextRange(qe,0<oe.Dc?oe.Dc-1:0,oe.end),"",!0,!1);this.ib.Kc(qc.SelectionFactory.ue(qe,lf+$d));ge.dispose();oe.errorDetails.lAb(de);db.a.mark(4671);return 32};this.eBa=(de,qe,oe)=>{if(1===oe)return 32;v.ULS.sendTraceTag(7660830,
324,50,"Ignore spelling error triggerred");if(zt.nD())return this.zgb.BQf(qe,null,lq.b.IgnoreOnce),32;db.a.mark(4670);oe=this.ko.msa(qe);if(this.tDe(oe))return 8;qe=qe.node;const ge=this.Rc.Lc(15);ge.Ab(qe);this.ko.ixb(qe,[oe],!0);qe.setValue(Ke.a.xqf,!0);ge.dispose();oe.errorDetails.lAb(de);db.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.MGn(oe);this.W3a.xPi(oe,qe,!0);return 32};this.RCl=(de,qe,oe)=>{var ge,$d=!this.xl.jba(qe);this.Vn&&this.Vn.instance&&
this.Vn.instance.zX(qe)&&($d=!1);if(1===oe||!$d)return $d?32:8;this.ga.Ob(vb.a.Ava,2);db.a.mark(4670);$d=this.gom(de);if(0>$d)return 8;if(zt.nD())return this.zgb.BQf(qe,$d,lq.b.Apply),32;oe=this.ko.msa(qe);if(this.tDe(oe))return 8;qe=qe.node;var lf=oe.errorDetails.suggestions;if(!lf)return this.zd.fc(Df.a.FOb,{["Reason"]:"NoSuggestionsFound"}),db.a.mark(4671),8;$d=$d<lf.length?lf[$d]:null;if(!$d)return this.zd.fc(Df.a.FOb,{["Reason"]:"RequestedSuggestionIsNull"}),db.a.mark(4671),8;(null===(ge=pf.a.xd())||
void 0===ge?0:ge.xm)&&pf.a.xd().Bk.IG(qe);$d=$d.replace("  "," \u00a0");ge=this.Rc.Lc(15);ge.Ab(qe);lf=this.Rd.We(xc.a.createTextRange(qe,oe.Dc,oe.end),$d,!0,!1,vb.a.Ava);this.ib.Kc(qc.SelectionFactory.ue(qe,oe.Dc+$d.length+lf));ge.dispose();oe.errorDetails.lAb(de);db.a.mark(4671);this.jDn(oe);return 32};this.zPo=(de,qe)=>{qe=this.ko.msa(qe);if(this.tDe(qe))return 8;qe.errorDetails.lAb(de);return 32};this.z9l=(de,qe,oe,ge,$d)=>{if(!qe.view.ve)return 2;const lf=qe.view;if(!this.ib.gb.currentSelection)return this.zd.fc(Df.a.Ne,
{["Reason"]:gf.a.Qn}),2;if(1===oe)return 32;const wf=new NC,gi=new HG(this.ko,this.Qe,this.DPc,this.zgb);qe=new jB(null,de,qe,oe,ge,wf,gi,this.ga,this.ib,this.Qe,null);qe.oi=!0;qe.run();if(qe.isCompleted&&wf.dWb){if(qe=qc.SelectionFactory.ue(wf.G_c,wf.dWb.Dc),qe=qc.SelectionFactory.Vy(qe,xc.a.Uc(wf.G_c,wf.dWb.end)),!this.rAh.instance||!this.rAh.instance.zgo(wf.dWb,qe,lf)){this.ib.Kc(qe);let Di=0;$d&&(Di=$d.az);lf.Axc=!1;zf.a.instance.$b(new mf.a(1,1,1,()=>{this.zNo(lf,Di,wf.G_c,wf.dWb)}))}}else{const Di=
new Ag.StandardDialog;Di.Bd=0;ed.a.eQ.P$c?Di.Cna(CommonUIStrings.l_DefaultDialogTitle,wf.W4j.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Di.Cna(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),ed.a.eQ.UQd(()=>{Di.jma&&(Di.hide(),this.ga.Ob(de,2))}))}return 32};this.Wpe=(de,qe,oe)=>{if(1===oe)return 32;this.via&&this.via.T8&&(de=this.via.T8.DOf(yr.juc))&&!de.vN&&(de.m3(0),de.Jg.$M(0));
return 32};this.ga=h;this.ko=b;this.ZCk=r;this.Rd=A;this.Rc=L;this.ib=Z;this.Vn=oa;this.Qe=Ba;this.tMk=gb;this.xl=Ab;this.zd=Jb;this.zgb=Gd;this.via=Object(Ca.a)(tJ,Tb);this.$7b=jc.q$c;this.rAh=Hc;this.W3a=hd;this.SCc=new Map;this.SCc.set(1,vb.a.kDg);this.SCc.set(2,vb.a.gPf);this.SCc.set(3,vb.a.qEg);this.mOc=new Map;this.mOc.set(1,vb.a.lDg);this.mOc.set(2,vb.a.hPf);this.mOc.set(3,vb.a.rEg)}Xb(){const b=this.ga,h=this.RCl,r=this.Dul;b.fb(vb.a.eoe,kc.a.view,this.S6n,1028);b.qa(vb.a.aJa,kc.a.Vc,this.aJa);
b.qa(vb.a.eBa,kc.a.Vc,this.eBa);b.qa(vb.a.Rzb,kc.a.Vc,h);b.qa(vb.a.Szb,kc.a.Vc,h);b.qa(vb.a.Tzb,kc.a.Vc,h);b.qa(vb.a.m1b,kc.a.Vc,h);b.qa(vb.a.n1b,kc.a.Vc,h);b.qa(vb.a.aJa,kc.a.view,r);b.qa(vb.a.eBa,kc.a.view,r);b.qa(vb.a.Rzb,kc.a.view,r);b.qa(vb.a.Szb,kc.a.view,r);b.qa(vb.a.Tzb,kc.a.view,r);b.qa(vb.a.m1b,kc.a.view,r);b.qa(vb.a.n1b,kc.a.view,r);b.Pc(vb.a.aJa,1028);b.Pc(vb.a.eBa,1028);b.Pc(vb.a.Rzb,1028);b.Pc(vb.a.Szb,1028);b.Pc(vb.a.Tzb,1028);b.Pc(vb.a.m1b,1028);b.Pc(vb.a.n1b,1028);b.qa(vb.a.Ava,Gc.a.frame,
Vd.ActionManager.eg);this.$7b&&b.fb(vb.a.Wpe,kc.a.view,this.Wpe,1124);b.fb(vb.a.Ydd,kc.a.view,this.z9l,1028);b.fb(vb.a.ymg,kc.a.Cd,this.zPo,1124);this.cwo([vb.a.bAe,vb.a.kDg,vb.a.lDg,vb.a.G9d,vb.a.gPf,vb.a.hPf,vb.a.GAe,vb.a.qEg,vb.a.rEg,vb.a.pwj,vb.a.KQn,vb.a.BWj])}cwo(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],kc.a.view,Vd.ActionManager.cU,1028)}sxo(b){this.DPc=b}tDe(b){return b?b.errorDetails?!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.zd.fc(Df.a.FOb,
{["Reason"]:"ErrorRangeMissingErrorDetails"}),db.a.mark(4671),!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.zd.fc(Df.a.FOb,{["Reason"]:"RequestedErrorRangeNotFound"}),db.a.mark(4671),!0)}MGn(b){b=b.errorDetails.proofingType;if(this.mOc.has(b)){const h=this.mOc.get(b);this.ga.Ob(h,2);v.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}gom(b){switch(b){case vb.a.Rzb:return 0;case vb.a.Szb:return 1;case vb.a.Tzb:return 2;
case vb.a.m1b:return 3;case vb.a.n1b:return 4;default:return-1}}jDn(b){b=b.errorDetails.proofingType;if(this.SCc.has(b)){const h=this.SCc.get(b);this.ga.Ob(h,2);v.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}zNo(b,h,r,A){b.b4();(b=r.fg(b.Ic))?(A=GG.a.Ev(b,y.AFrameworkApplication.isRtl?A.Dc:A.end),this.tMk.WDa(new Sys.UI.Point(A.x,A.y+A.height),h)):v.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(u.a)(IG,"ProofingActor",
null,[]);var kB=d(321),At=d(1509),xJ=d(1900);class lB{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.Cyc=null;this.cbm="StyleUsageActivity";this.dbm="StylesFloodgateSurveyIsEnabled";this.qTa=(Tb,jc,Hc,hd)=>{Tb=this.qMm(Tb);return 0>Tb||Tb>this.Cyc.length?2:(Tb=this.Cyc[Tb])?y.AFrameworkApplication.va.Hf(jc,vb.a.zT,Hc,!0,hd,Tb):2};this.HXb=(Tb,jc,Hc,hd,Gd)=>{Tb=!0;jc.contextId!==kc.a.paragraph&&jc.contextId!==kc.a.Cd&&jc.contextId!==kc.a.Vc&&(Tb=!1);if(1===Hc||!Tb)return Tb?32:8;if(2===Hc&&!Gd)return 8;
jc=this.Yb.IF(jc.node);Gd.MenuItems=kB.a.OAm(jc);return 32};this.smo=(Tb,jc,Hc,hd,Gd)=>{Tb=!0;jc.contextId!==kc.a.paragraph&&(Tb=!1);if(1===Hc&&!Tb)return 8;jc=jc.node;Hc=this.Yb.Cq(jc);if(!Hc||!Gd)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Gd,jc,Hc),8;Ki.a.Kg.vn?Gd.uva.Ti().zt(Hc.Ti()):Gd.uva.zt(Hc.Ti());return 32};this.B9k=(Tb,jc,Hc,hd,Gd)=>{if(jc.contextId!==kc.a.paragraph)return 8;if(this.tg.gab(jc,!1))return this.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),
8;if(1===Hc)return 32;const de=jc.node;if(Cd.ParagraphReader.hza(de)||!Gd)return 8;const qe=this.jNf(Gd,de);if(!qe)return this.Ac.fc(Df.a.G4,{["Reason"]:gf.a.GOb}),8;if(2!==this.Yb.JF(qe))return 2;Hc=new Sb.GraphTransaction(15);this.aD.Txc(Gd);Hc.Ab(de);this.rk.xxb();const oe=[];Tb!=vb.a.fE&&oe.push(De.a.Gfb);this.p4.ZP(qe,de,!1,void 0,void 0,void 0,new xJ.a(oe,!1,!0));(Tb=this.Yb.IF(de))&&this.Yb.ne(qe,Tb)&&Uc.b(593078098,3017,50,"Custom linked style applied by user");de.Fq&&(Tb=[Object.assign(new da.a,
{name:"Source",string:"ApplyStyle"})],me.a("TOCFormatting",!0,void 0,Tb));Hc.dispose();Gd=F.a.HT(Gd);hd.Xt=Gd>>>16^Gd&65535;hd&&At.a.Vzb&&(hd.kE|=At.a.Fqb(jc.node));return 32};this.tmo=(Tb,jc,Hc,hd,Gd)=>{Tb=!0;jc.contextId!==kc.a.Cd&&(Tb=!1);if(1===Hc&&!Tb)return 2;jc=Ya.FormattingReader.Vs(jc);jc=Ya.FormattingReader.MAa(jc);if(!jc)return 2;if(!Gd)return 8;Ki.a.Kg.vn?Gd.uva.Ti().zt(jc.Ti()):Gd.uva.zt(jc.Ti());return 32};this.C9k=(Tb,jc,Hc,hd,Gd)=>{if(jc.contextId!==kc.a.Cd)return 8;this.tg.gab(jc);
if(1===Hc)return 32;Tb=jc;(jc=this.Gp.Q7d(Tb))&&(Tb=jc);jc=Tb.node;if(!Gd)return 8;const de=this.jNf(Gd,Tb.node);if(!de)return this.Ac.fc(Df.a.G4,{["Reason"]:gf.a.GOb}),8;if(1!==this.Yb.JF(de))return 2;Hc=this.Yb.IF(jc);if(!Hc)return this.Ac.fc(Df.a.G4,{["Reason"]:gf.a.Ami}),8;if(!Hc.nh(this.Yb.Be(de)))return this.Ac.fc(Df.a.G4,{["Reason"]:gf.a.GOb}),8;const qe=new Sb.GraphTransaction(7);try{if(this.aD.Txc(Gd),qe.Ab(jc),this.p4.hLg(jc,Hc),this.ED.AW(Tb,oe=>{this.tj.Wqa(oe);this.tj.beb(oe,de)}),jc.Fq){const oe=
[Object.assign(new da.a,{name:"Source",string:"ApplyStyle"})];me.a("TOCFormatting",!0,void 0,oe)}}finally{qe&&qe.dispose()}Hc&&this.Yb.ne(de,Hc)&&Uc.b(593078097,3017,50,"Custom linked style applied by user");Gd=F.a.HT(Gd);hd.Xt=Gd>>>16^Gd&65535;hd&&At.a.Vzb&&(hd.kE|=At.a.Fqb(Tb.node));return 32};this.rmo=(Tb,jc,Hc,hd,Gd)=>{Tb=!0;jc.contextId!==kc.a.Vc&&(Tb=!1);if(1===Hc&&!Tb)return 2;jc=this.p4.wMm(jc);if(!jc)return 2;if(!Gd)return 8;Ki.a.Kg.vn?Gd.uva.Ti().zt(jc.Ti()):Gd.uva.zt(jc.Ti());return 32};
this.A9k=(Tb,jc,Hc,hd,Gd)=>{if(jc.contextId!==kc.a.Vc)return 8;if(this.tg.gab(jc,!1))return this.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),8;if(1===Hc)return 32;var de=jc.node;if(!Gd)return 8;Hc=this.jNf(Gd,jc.node);if(!Hc)return this.Ac.fc(Df.a.G4,{["Reason"]:gf.a.GOb}),8;const qe=this.Yb.JF(Hc);if(1!==qe&&2!==qe)return 2;(jc=this.rk.MMf(jc))?(jc=If.a.SMb(jc),Tb=y.AFrameworkApplication.va.Hf(jc,Tb,2,!1,hd,Gd)):(Tb=new Sb.GraphTransaction(7),this.aD.Txc(Gd),Tb.Ab(de),this.p4.k_o(Hc,de),Tb.dispose(),Tb=
32);de.Fq&&(jc=[Object.assign(new da.a,{name:"Source",string:"ApplyStyle"})],me.a("TOCFormatting",!0,void 0,jc));(de=this.Yb.IF(de))&&this.Yb.ne(Hc,de)&&Uc.b(593078096,3017,50,"Custom linked style applied by user");Gd=F.a.HT(Gd);hd.Xt=Gd>>>16^Gd&65535;return Tb};this.umo=(Tb,jc,Hc,hd,Gd)=>{const de=this.Ptd.nua(Tb,jc,Hc,hd,Gd,null,0);return 2!==de?de:this.Ptd.nua(Tb,jc,Hc,hd,Gd,null,12)};this.D9k=(Tb,jc,Hc,hd,Gd)=>{const de={};de[this.Ptd.fPa]=6168;de[this.Ptd.ePa]=6169;let qe=12;if(!jc.view.ve)return 2;
var oe=jc.view.lb,ge=oe?oe.Pg:null;if(!ge)return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Qn}),8;if(this.Pw.wIa(Id.a.y$a,ge))return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.uWc}),8;if(this.Pw.HEa(Cd.ParagraphReader.xX,ge))return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),8;if(this.tg.xnc(ge,!1))return this.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UG}),8;ge=this.Yb.ro();if(Gd&&ge){const $d=ge.nh(Gd);if($d){const lf=this.Yb.Tqb($d,ge);let wf=this.Yb.JF($d);lf&&(oe=oe.gb.K(0),oe.Nw&&oe.Qa.contextId===kc.a.Cd||2===oe.length&&
oe.Qa.contextId===kc.a.Cd&&oe.Xc.contextId===kc.a.Zc)&&(wf=1,Gd=lf.getValue(cg.a.la));1===wf?qe=0:3===wf&&(qe=14);!this.Yb.ne($d,ge)&&this.Yb.Hd($d)&&(oe=this.Yb.Be($d),Uc.b(562317522,3017,50,String.format("{0}: style applied by user",oe)));this.Vha(this.cbm,this.dbm)}}return this.Ptd.nua(Tb,jc,Hc,hd,Gd,de,qe)};this.ew=h;this.Ee=r;this.rQ=A;this.oB=L;this.xl=Z;this.zd=oa;this.EZ=Ba;this.BSk=gb;this.xe=Ab;this.Gp=Jb}get p4(){return this.ew}get Pw(){return this.rQ}get rk(){return this.oB}get tj(){return this.Ee}get tg(){return this.xl}get Ac(){return this.zd}get ED(){return this.EZ}get Ptd(){return this.BSk}get Yb(){return this.xe}Xb(){const b=
y.AFrameworkApplication.va,h=ed.a.Y_a.y9h(12);b.qa(vb.a.zT,kc.a.Cd,this.C9k);b.qa(vb.a.XMa,kc.a.Cd,this.tmo);b.qa(vb.a.zT,kc.a.Vc,this.A9k);b.qa(vb.a.XMa,kc.a.Vc,this.rmo);b.qa(vb.a.zT,kc.a.paragraph,this.B9k);b.qa(vb.a.zT,kc.a.view,this.D9k);b.Pc(vb.a.zT,1036);b.qa(vb.a.XMa,kc.a.view,this.umo);b.qa(vb.a.XMa,kc.a.paragraph,this.smo);b.Pc(vb.a.XMa,99);b.qa(vb.a.HXb,kc.a.view,h);b.qa(vb.a.HXb,kc.a.paragraph,this.HXb);b.Pc(vb.a.HXb,1127);b.fb(vb.a.Thf,kc.a.view,this.qTa,4);b.fb(vb.a.Uhf,kc.a.view,this.qTa,
4);b.fb(vb.a.Vhf,kc.a.view,this.qTa,4);b.fb(vb.a.Whf,kc.a.view,this.qTa,4);b.fb(vb.a.Xhf,kc.a.view,this.qTa,4);b.fb(vb.a.Yhf,kc.a.view,this.qTa,4);b.fb(vb.a.Zhf,kc.a.view,this.qTa,4);b.fb(vb.a.pTh,kc.a.view,this.qTa,4);b.fb(vb.a.qTh,kc.a.view,this.qTa,4);b.fb(vb.a.rTh,kc.a.view,this.qTa,4);this.Cyc=Array(10);this.Yb.h_o(this.Cyc)}qMm(b){switch(b){case vb.a.Thf:return 0;case vb.a.Uhf:return 1;case vb.a.Vhf:return 2;case vb.a.Whf:return 3;case vb.a.Xhf:return 4;case vb.a.Yhf:return 5;case vb.a.Zhf:return 6;
case vb.a.pTh:return 7;case vb.a.qTh:return 8;case vb.a.rTh:return 9;default:return-1}}Vha(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");r&&r.execute(A=>{A.logActivity(b,h)})},lB.Eza)}jNf(b,h){if(b&&h&&Cd.ParagraphReader.Wb(h))h=this.Yb.IF(h);else return null;return h.nh(b)}get aD(){return null!=this.aWg?this.aWg:this.aWg=Wa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}lB.Eza=5E3;Object(u.a)(lB,
"StyleActor",null,[]);var zr=d(133);class Hh{constructor(b,h,r){this.ORk=b;this.xe=h;this.U4a=r}Xb(){this.U4a.fb(vb.a.Ype,kc.a.application,this.Ype.bind(this),96);this.U4a.qa(vb.a.QAc,kc.a.view,this.fBp.bind(this));this.U4a.fb(vb.a.sxj,kc.a.view,this.hBp.bind(this),96)}Ype(b,h,r,A,L){if(1===r)return 32;b=Object.assign(new Ee.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new hh.a,{ControlList:[]});r.ControlList.push(Object.assign(new Mj.a,{ExternalId:"UpdateStyle",
QueryCommand:"QueryUpdateStyle"}));h.push(r);Array.addRange(b.MenuSectionList,h);L.MenuItems=b;return 32}hBp(b,h,r,A,L){if(1===r)return 32;b=Ki.a.JYj();null==b&&8;b=this.xe.wL(b);L[Um.a.LabelText]=String.format(F.a.yf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}fBp(b,h,r){b=Ki.a.RTb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");xa.Health.instance.recordKpiUsage(zr.a.MEa,0,zr.a.UB,r);this.ORk.iLg(h)?Uc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new Na.a,{extendedProperties:h}),xa.Health.instance.recordKpiFailure(zr.a.MEa,"UpdateStyleFailed",!1,!0,h),Uc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(u.a)(Hh,"StyleContextMenuActor",null,[]);var JG=d(2035);class Ar{constructor(b){this.ga=b}get Pb(){return this.ga}Vwe(b,h=!1){this.Pb.Hf(b,vb.a.EWa,2,!0,null,h)}z8(b){this.Pb.Qb(vb.a.z8,
2,b)}}Object(u.a)(Ar,"TextFormattingCommands",null,[689]);class jr{constructor(b,h,r,A){this.kaf=this.hIh=!1;this.vnp=(L,Z,oa)=>{if(2!==oa)return 2;this.hIh||(this.hIh=!0);return 32};this.sio=(L,Z,oa,Ba,gb)=>{if(2!==oa)return 2;this.Lvj(gb,!0);return 32};this.rio=(L,Z,oa,Ba,gb)=>{if(2!==oa)return 2;this.Lvj(gb,!1);return 32};this.ojo=(L,Z,oa)=>{if(2!==oa)return 2;if(!this.uib)return 8;this.uib.E0m();return 32};this.kio=(L,Z,oa)=>{if(2!==oa)return 2;if(!this.uib)return 8;this.uib.sIo();return 32};
this.xYa=(L,Z)=>{3===Z.az&&he.a.ym(Z.Rm.currentSelection)&&(me.c(vb.a.qnp),this.kaf=!0)};this.ga=b;this.Aa=h;this.uib=r;this.ib=A}get unp(){return this.kaf}Xb(){var b;this.ga.fb(Za.a.xS,kc.a.view,this.vnp,4);this.ga&&this.Aa&&(this.Aa.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(vb.a.$Hg,kc.a.view,this.sio,4),this.ga.fb(vb.a.bIg,kc.a.view,this.rio,4)),this.ga.fb(Za.a.AXj,kc.a.application,this.ojo,4),this.ga.fb(Za.a.Azf,kc.a.application,this.kio,4),pc.EventHandlerManager.instance.ywo(()=>{this.g5n()}));
(null===(b=ab.StaticActiveAppFrame.za().kb.Qc)||void 0===b?0:b.ve)&&ab.StaticActiveAppFrame.za().kb.Qc.g6(()=>{this.HNo()});this.ib&&this.ib.AB(this.xYa)}Aoo(){me.c(vb.a.tnp);this.kaf=!0}HNo(){const b=window.performance.now();jr.sZe&&250>b-jr.sZe&&1E3<b-jr.hsh&&(me.c(vb.a.snp),jr.hsh=b);this.uib&&jr.rc&&jr.rc.rE(107)&&this.uib.showFloatie()}uen(b,h){if(h){var r=null;aa.a.cM&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.uib&&this.uib.Vxp(b.getBoundingClientRect(),h)}}g5n(){jr.sZe=
window.performance.now()}Lvj(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(jr.Y4m)){for(b=b.firstChild;b;)this.P3k(b,h),b=b.nextSibling;break}b=b.nextSibling}}P3k(b,h){if(b.classList.contains(jr.IPi)){const r="WACImageResizeHandleTouch"+this.Mum(b);h?b.classList.add(jr.JPi,r):b.classList.remove(jr.JPi,r)}}Mum(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==jr.IPi)return F.a.substring(h,20,h.length);return""}static get rc(){return null!=
jr.WUg?jr.WUg:jr.WUg=Wa.a.instance.Oa("Box4.IFeatureHelper")}}jr.IPi="WACImageResizeHandles";jr.JPi="WACImageResizeHandlesTouch";jr.Y4m="WACImgSelection";jr.sZe=0;jr.hsh=0;Object(u.a)(jr,"TouchInputActor",null,[688]);class Qy{get fPa(){return yt.a.fPa}get ePa(){return yt.a.ePa}get mBc(){return yt.a.mBc}nua(b,h,r,A,L,Z,oa){return yt.a.nua(b,h,r,A,L,Z,oa)}Ftc(b,h,r,A,L,Z){return yt.a.Ftc(b,h,r,A,L,Z)}static get instance(){Qy._instance||(Qy._instance=new Qy);return Qy._instance}}Qy._instance=null;Object(u.a)(Qy,
"ViewActionHandlerProxy",null,[687]);class mL{constructor(b,h,r){this.Rco=r;this.kpiName="VisiMarkersUsage";this.Baa="wwaengidc";this.kub=new Map;this.u$o=(A,L,Z,oa,Ba)=>{var gb;if(1===Z)return 32;if(!Ba)return 2;this.kub.set("Source",Uo.a[this.ga.b3]);this.Obf.uad?this.kub.set("Action","Removed"):this.kub.set("Action","Applied");xa.Health.instance.recordKpiUsage(this.kpiName,1,this.Baa,this.kub);A=document.getElementsByTagName("head")[0];if(!this.Obf.Hmp(A))return v.ULS.sendTraceTag(593294045,324,
15,"Toggling Formatting markers failed"),8;y.AFrameworkApplication.$c("PlaceholderTextBugFix;PlaceholderTextBugFixCf");(null===(gb=y.AFrameworkApplication.J)||void 0===gb?0:gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.PlaceholderTextBugFixIsEnabled",!1))&&this.Rco.OAo();ab.StaticActiveAppFrame.za().eJ({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.Klo=(A,L,Z,oa,Ba)=>{if(1===Z)return 32;Ba[Tg.a.On]=this.Obf.uad;return 32};this.ga=b;this.Obf=h}Xb(){this.ga.fb(vb.a.xze,kc.a.application,
this.u$o,1);this.ga.fb(vb.a.jxj,kc.a.application,this.Klo,96)}}Object(u.a)(mL,"VisiMarkersActor",null,[]);class KG{constructor(b){this.r4l=b;this.T_c=(h,r,A,L,Z)=>{(h=Z.getValue(Od.a.targetObject))&&this.r4l.n1j(h);return 32}}}Object(u.a)(KG,"ExpandParagraphStrategy",null,[]);var qu=d(885);class AE{wc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new ns(vw.a.zQb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();
b.ia("Box4.Actors.Box4PasteStewardUtils",()=>new AC(y.AFrameworkApplication.J.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();b.ia("Box4.Actors.ClipboardActor",()=>new Ux(b.nf("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),ih.a.instance,b.resolve("Box4.IClipboardDataHelper"),If.a.instance,y.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.J,Sg.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),
b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),y.AFrameworkApplication.uBg(),y.AFrameworkApplication.DTj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Wa.a.instance.resolve("Common.IReactContextualUILauncher"),!!ed.a.instance&&ed.a.instance.hma,b.Oa("Box4.Actors.PastePerformanceE2ETracker"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",
()=>new Fz(y.AFrameworkApplication.J)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new Bw(y.AFrameworkApplication.J,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Lu.a.instance)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ia("Box4.Actors.ISystemClipboard",()=>new hB(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),
Object(Kb.a)(),ab.StaticActiveAppFrame.za().kb,Sg.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Lu.a.instance,y.AFrameworkApplication.J)).ha();b.ia("Box4.Actors.IDeleteTableSegmentStrategy",()=>new FG).ha();b.ia("Box4.ISelectionFactory",()=>new ww.a).ha();b.ia("Box4.IRenderOrderGraphIteratorFactory",()=>new Bm).ha();b.ia("Common.IDomElementContentStateFactory",()=>new zn).ha();b.ia("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new EC(If.a.instance,
b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();b.ia("Box4.Actors.PastedContentsPostProcessorHelper",()=>new rJ).ha();b.ia("Box4.Actors.PasteFloatiePositionProvider",()=>new Kv(If.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Object(Kb.a)(),rd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!ed.a.instance&&ed.a.instance.hma)).ha();b.ia("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new eB(b.resolve("Box4.IClipboardDataHelper"),ed.a.EB.FJ)).ha();
b.ia("Box4.Actors.PasteFloatieEventManager",()=>new Xx(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Object(Kb.a)(),mu.a.instance(),y.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),ed.a.jf.Tl.qf(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!ed.a.instance&&
ed.a.instance.hma)).ha();b.ia("Box4.Actors.IClipboardOperationPasteFactory",()=>new tG(ih.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),SA.a.instance,If.a.instance,y.AFrameworkApplication.va,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.nf("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.Oa("Box4.Actors.PastePerformanceE2ETracker"))).ha();b.ia("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new rG(y.AFrameworkApplication.va,ih.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),If.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),zy.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),
b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Oa("Box4.IFeatureHelper"))).ha();b.ia("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new cx(ih.a.instance,Lu.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),y.AFrameworkApplication.J.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new vG(y.AFrameworkApplication.J)).ha();
b.ia("Box4.Actors.IClipboardOperationFactory",()=>new Po(b.resolve("Box4.Actors.InternalClipboard"),y.AFrameworkApplication.va,y.AFrameworkApplication.qBg(),ih.a.instance,zy.a.instance,Lu.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),
b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"),b.Oa("Box4.Actors.PastePerformanceE2ETracker"))).ha();Ok.a.Yla&&b.ia("Box4.Actors.IHiddenExternalPasteView",()=>new BG(Ok.a.nVi?b.Ta("Common.ISystemInitiatedFeedback"):null)).ha();b.ia("Box4.Actors.IExternalPasteExecutionManagerFactory",
()=>new AG(b.nf("Box4.Actors.IBox4PasteStewardFactory"),b.nf("Box4.Actors.IBox4ImageStewardFactory"),b.nf("Box4.Actors.IBox4TableStewardFactory"),b.nf("Box4.Actors.IBox4WordConverterFactory"),b.nf("HtmlImport.IHtmlTranslatorSettings"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),
b.resolve("Box4.IFieldCopyPasteHelper"),b.Oa("Box4.Actors.PastePerformanceE2ETracker"),Ok.a.Yla?b.nf("Box4.Actors.IHiddenExternalPasteView"):null)).ha();b.ia("Box4.Actors.InternalClipboard",()=>new bp.a(b.resolve("Box4.Images.IImageEditor"),b.nf("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),ed.a.jf,b.resolve("Box4.IParagraphIndentationReader"),y.AFrameworkApplication.J,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").ULj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ia("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new LC(b.resolve("Box4.Actors.InternalClipboard"),b.Oa("Box4.IContentControlCopyPasteHelper"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.List.IListCommands",()=>new gJ(y.AFrameworkApplication.va)).ha();b.ia("Box4.List.ListNewLineStrategy",()=>new hJ(b.resolve("Box4.List.IListEditor"),b.nf("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ia("Box4.Actors.PasteCoordinator",()=>new Pu(b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),Be.a.instance,b.Oa("Box4.Actors.PastePerformanceE2ETracker"))).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new zC(b.resolve("Box4.Images.IImageEditor"),y.AFrameworkApplication.pc,b.resolve("Box4.IUndoManager"),b.Oa("Box4.Actors.IImageStewardBridge"),ab.StaticActiveAppFrame.za().$J,b.Oa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();
b.ia("Box4.Actors.Box4TableStewardFactory",()=>new Ey(Wa.a.instance.resolve("Box4.List.IListEditor"),Wa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").ha();b.ia("Box4.Actors.ClipboardOperationWordStrategy",()=>new FC(ih.a.instance,If.a.instance,pf.a.xd(),Be.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",
()=>new at(y.AFrameworkApplication.J)).as("Box4.Actors.IBox4WordConverterFactory").ha();b.ia("Box4.Actors.IExternalPasteCssConverter",()=>new oJ(y.AFrameworkApplication.J)).ha();b.ia("Box4.Actors.IHtmlNormalizerHelper",()=>new pu).ha();b.ia("Box4.ISelectionCommands",()=>new zv(y.AFrameworkApplication.va)).ha();b.ia("Box4.ITextFormattingCommands",()=>new Ar(y.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.AccessibilityActor",()=>new oG(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();
b.ia("Box4.Actors.InsertionPointFormatting",()=>new Py(b.Oa("Box4.IFontSlotProvider"),b.Ta("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ia("Box4.UI.PasteFloatieManager",()=>new Fy).as("Box4.UI.IFloatieManager").ha();b.ia("Box4.Actors.ProofingActor",()=>new IG(Wa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),y.AFrameworkApplication.va,()=>Wa.a.instance.resolve("Box4.UI.ILanguageDialog"),Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
If.a.instance,Wa.a.instance.Ta("Box4.IExternalSelectionManager"),zy.a.instance,Wa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Be.a.instance,ih.a.instance,Wa.a.instance.resolve("Box4.IContextMenuController"),Wa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Wa.a.instance.Ta("Box4.Actors.IProofingErrorPresenter"),Wa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Wa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ia("Box4.Actors.StyleActor",
()=>new lB(Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Wa.a.instance.resolve("Box4.IFormattingEditor"),Object(Nl.a)(),Wa.a.instance.resolve("Box4.IInsertionPointFormatting"),Be.a.instance,ih.a.instance,Wa.a.instance.resolve("Box4.TextFormattingHelper"),Qy.instance,Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Wa.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ia("Box4.Actors.StyleContextMenuActor",()=>new Hh(Wa.a.instance.resolve("Box4.IUpdateStyleManager"),
Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),y.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.TextFormattingActor",()=>new JG.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Oa("Box4.IFontSlotProvider"),b.Oa("Box4.IContentControlChpHelper"),Wa.a.instance.resolve("Box4.IFormattingEditor"),Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.resolve("Box4.IParagraphEditor"),Wa.a.instance.resolve("Box4.ILineSpacingHelper"),
Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Wa.a.instance.resolve("Box4.IOutlineElementEditor"),Wa.a.instance.resolve("Box4.List.IListFormattingEditor"),Wa.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("Box4.Actors.AutoCorrectActor",()=>new Lz(y.AFrameworkApplication.va,ih.a.instance,()=>Wa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ia("Box4.Actors.TouchInputActor",()=>new jr(y.AFrameworkApplication.va,
y.AFrameworkApplication.J,Iz.GrippersManager.instance,If.a.instance)).as("Box4.ITouchInputActor").ha();b.register(TA,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ia("Box4.Actors.VisiMarkersActor",()=>new mL(y.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"),b.resolve("Box4.PlaceholderText.PlaceholderTextProvider"))).ha();b.ia("Box4.Actors.IndentationActorExtension",()=>new wh).as("Box4.Actors.IIndentationActorExtension").ha();Object(Yx.a)()&&b.register(St,"Box4.HighContrastColorPickerState").as("Box4.IHighContrastColorPickerState").ha();
Object(Rz.a)()&&b.ia("Box4.Actors.PageColorActor",()=>new nw(fh.a.instance,new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc.vd),Bq.a.instance,Ko.a.instance,Wa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler"),new Wq(nw.unb))).ha();qu.a.ftb&&b.ia("Box4.Actors.ExpandParagraphStrategy",()=>new KG(Wa.a.instance.resolve("Box4.IExpandCollapseActionHandler"))).ha()}}Object(u.a)(AE,"Box4ActorsComponentConfiguration",null,[1]);var OC=d(210),BE=d(1088);const Sz=()=>{const b=iv;y.AFrameworkApplication.va.qa(vb.a.Wxf,
kc.a.epb,b);y.AFrameworkApplication.va.qa(vb.a.Wxf,kc.a.sic,b);y.AFrameworkApplication.va.qa(vb.a.Vxf,kc.a.epb,PC);y.AFrameworkApplication.va.qa(vb.a.Vxf,kc.a.sic,PC)},iv=(b,h,r)=>ed.a.k_d?8:2===r?(b=new Ag.StandardDialog,b.Bd=4,b.qY(1),b.Ke(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ke(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.jCg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,yJ),32):2,yJ=b=>{1===b&&y.AFrameworkApplication.va.Ob(vb.a.Vxf,
2)},PC=(b,h,r)=>{if(ed.a.k_d)return 8;if(1===r)return h.node.hasProperty(Ke.a.jOb)?32:2;if(2===r&&(h.contextId===kc.a.view&&h.view.lb&&(h=h.view.lb.Pg),OC.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=BE.a.xsm(h.node);Pc.a.A0o();try{QC(b)}catch(A){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",A)}}return 32},QC=b=>{rd.a.Tm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Wt=d(803);class Hs{constructor(b){this.mJ=null;this.jTc=(h,r,A,L,Z)=>{if(1===A)return 32;if(2===
A&&!Z)return 8;this.VTe.X$d=!this.VTe.X$d;h=Hs.pj.DQb(r);r=new Wt.a;A=null;32===y.AFrameworkApplication.va.Qb(vb.a.lZa,2,r)&&r&&(A=r.fontColor);L="";A&&!r.ePb&&(L=Ql.a.JB(A)||"");this.z3d.mca=L;this.IP.NAc(L);h=this.z3d.cqb(h,ed.a.RTa);if(!h)return 8;Z.MenuItems=h;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Cid=(h,r,A,L,Z)=>{if(1===A)return 32;if(!Z)return 8;Z[Tg.a.On]=this.VTe.X$d;return 32};this.G3=(h,r,A,L,Z)=>{if(1===A)return 32;y.AFrameworkApplication.va.Qb(vb.a.lZa,
2,Z);h=Z&&0<=Z.fontColor&&16777215>=Z.fontColor?Z.fontColor:0;ab.StaticActiveAppFrame.za().dismissFloatie();(new Xw(Hs.unb,vb.a.eva)).Vyb(h);return 32};this.GXb=(h,r,A,L,Z)=>{if(1===A)return 32;if(2===A&&!Z)return 8;h=Hs.pj.DQb(r);r=new Wt.a;A=null;32===y.AFrameworkApplication.va.Qb(vb.a.lZa,2,r)&&r&&(A=r.fontColor);L="";A&&!r.ePb&&(L=Ql.a.JB(A)||"");this.z3d.mca=L;this.IP.NAc(L);h=this.z3d.cqb(h,ed.a.RTa);if(!h)return 8;Z.MenuItems=h;v.ULS.sendTraceTag(508421139,340,50,"Font color dropdown menu is opened.");
return 32};this.L_e=b}get z3d(){this.mJ||(this.mJ=new Wq(Hs.unb),this.Kfa(this.mJ));return this.mJ}Kfa(b){Object(Yx.a)()&&b.PH(7,vb.a.jTc);b.PH(1,vb.a.jka);b.PH(3,vb.a.hx);b.PH(4,vb.a.hx);b.PH(5,vb.a.eva);b.PH(6,vb.a.G3);b.z5a(this.L_e,1)}Xb(b){const h=y.AFrameworkApplication.va;Object(Yx.a)()&&(this.VTe=b,h.qa(vb.a.jTc,kc.a.view,this.jTc),h.fb(vb.a.Cid,kc.a.view,this.Cid,96));h.qa(vb.a.G3,kc.a.view,this.G3);h.qa(vb.a.GXb,kc.a.view,this.GXb);h.Pc(vb.a.GXb,1127)}static Btm(){return new Hs(fh.a.instance)}static get instance(){return null!=
Hs.iYg?Hs.iYg:Hs.iYg=Hs.Btm()}get IP(){return null!=this.J2g?this.J2g:this.J2g=Wa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get pj(){return pl.PageReader.instance}}Hs.unb="Font";Object(u.a)(Hs,"FontColorActor",null,[]);class bt{constructor(b){this.G3=(h,r,A,L,Z)=>{if(1===A)return 32;y.AFrameworkApplication.va.Qb(vb.a.lZa,2,Z);h=Z&&0<=Z.highlight&&16777215>=Z.highlight?Z.highlight:0;ab.StaticActiveAppFrame.za().dismissFloatie();(new Xw("Highlighter",vb.a.sca)).Vyb(h);return 32};this.ga=
b}Xb(){this.ga.qa(vb.a.Apj,kc.a.view,this.G3)}static wvm(){return new bt(y.AFrameworkApplication.va)}static get instance(){return null!=bt.UYg?bt.UYg:bt.UYg=bt.wvm()}}Object(u.a)(bt,"HighlighterColorActor",null,[]);var mB;(function(b){b.KOp="Heading";b.Bookmark="Bookmark";b.Url="Url";b.LQp="RecentLinks"})(mB||(mB={}));Object(u.b)("InsertLinkUserActivitySource",mB);class Tz{constructor(b,h,r,A,L){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=A;this.paragraphNode=L}}Object(u.a)(Tz,"HeadingDataForLinkDialog",
null,[]);class Qu{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(u.a)(Qu,"BookmarkDataForLinkDialog",null,[]);class jv{constructor(b,h,r,A,L,Z){this.key=b;this.name=h;this.startIndex=r;this.count=A;this.level=L;this.isCollapsed=Z}}Object(u.a)(jv,"GroupHeaderDataForLinkDialog",null,[]);class nB{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(u.a)(nB,"SelectedItemFromLinkDialogGroupedList",null,[]);class kv{static get coc(){var b;kv.aFb||(kv.aFb=null===(b=y.AFrameworkApplication.J)||
void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.insertLinkDialogRefactorEnabled",!1));return kv.aFb}constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.Zp=b;this.rd=h;this.vXl=r;this.bookmarkManager=A;this.Q_=L;this.Op=Z;this.Cg=oa;this.Qd=Ba;this.Lj=gb;this.ml=Ab;this.qBa=Jb;this.v8a=null;this.qXf=!1;this.zbe=(jc,Hc)=>{var hd;if(this.ge.ow){var Gd=Ic.a.Kkc(this.Zp),de=this.ge.lb.gb.currentSelection;if(de){de=de.Qa;Cd.ParagraphReader.en(de)&&(de=xc.a.createTextRange(de.node,0,Cd.ParagraphReader.textLength(de.node)));
var qe=he.a.U1b(de);he.a.Zl(qe)&&(de=qe);if(0!==jc&&32===y.AFrameworkApplication.va.Hf(de,vb.a.JR,1,!0,null,null)&&this.Zp.equals(de))if(kv.coc)Hc.UILocation=this.rd&&this.rd.UILocation,y.AFrameworkApplication.va.Hf(this.Zp,vb.a.GKb,2,!0,null,Hc);else{db.a.mark(5562);(null===(hd=pf.a.xd())||void 0===hd?0:hd.xm)&&this.ge.lb.bKb();jc=new Sb.GraphTransaction(15);jc.Ab(this.Zp.node);this.Zp.node.SJ().KF.n6(4);hd=Hc.txtDisplay;de=!1;if(null!=Hc.linkurl)if(de=!0,Hc.isHeading){m(this.rd,"Heading");qe=Hc.paragraphNode;
const oe=Hc.startCp,ge=Hc.endCp;Hc=this.bookmarkManager.Gti(qe);this.bookmarkManager.Tbc(Hc,oe,ge,qe,qe,!1)}else m(this.rd,"Bookmark"),Hc=Hc.linkurl;else m(this.rd,"Url"),Hc=Hc.txtLink.trim();this.o$a(hd,Hc,Gd,de);jc.Ph=vb.a.JR;jc.dispose();db.a.mark(5563);this.Zp.node.S7a()}else this.ge.O8()}else v.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ge=Object(Kb.a)().Gd;this.Zp=b;r=he.a.U1b(this.Zp);he.a.Zl(r)&&(this.Zp=r);if(!kv.coc){const jc=
new Dg.a(!1,!1,!0);r=this.Myi();A={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};L=this.v8a="";L=Cd.ParagraphReader.text(this.Zp.node);oa=this.Zp.cpBegin;Ba=this.Zp.cpEnd;({Xve:L,J1d:oa,K1d:Ba,jae:Z}=this.Lwi(L));if((h="object"===typeof h?h:null)&&
(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.o$a(h.DisplayText,h.Url,Z);else{Z[0]&&this.Yli(oa,Ba,Z[0].paragraph);h=""===L.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;jc.Ke(1,h);(null===L||void 0===L?0:L.startsWith(F.a.T5a))?(h=this.bGi(L,r))?r.selectedItem=h:A.txtLink=L:A.txtLink=L;A.txtDisplay=this.v8a;1>=Z.length&&this.Q_.j6h(b,Z[0],1===Z.length)&&(this.qXf=!0,A.textDisplayDisabled=!0);var Tb={["id"]:"InsertLinkDialog",["bodyControls"]:A};
this.ml.le(()=>{jc.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.zbe,Tb)},"RILD:IAS")}}}uUj(){const b=new Dg.a(!1,!1,!0),h=this.Myi(),r={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:h};var A=this.v8a="";A=Cd.ParagraphReader.text(this.Zp.node);var L=
this.Zp.cpBegin;let Z=this.Zp.cpEnd,oa;({Xve:A,J1d:L,K1d:Z,jae:oa}=this.Lwi(A));const Ba="object"===typeof this.rd?this.rd:null;if(Ba&&(Ba.Source&&"CommandingInterface"===Ba.Source||Ba.Url&&Ba.DisplayText))this.o$a(Ba.DisplayText,Ba.Url,oa);else{oa[0]&&this.Yli(L,Z,oa[0].paragraph);L=""===A.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;b.Ke(1,L);(null===A||void 0===A?0:A.startsWith(F.a.T5a))?(L=this.bGi(A,h))?h.selectedItem=L:r.txtLink=A:r.txtLink=A;r.txtDisplay=this.v8a;
1>=oa.length&&this.Q_.j6h(this.Zp,oa[0],1===oa.length)&&(this.qXf=!0,r.textDisplayDisabled=!0);var gb={["id"]:"InsertLinkDialog",["bodyControls"]:r};this.ml.le(()=>{b.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.zbe,gb)},"RILD:IAS")}}Lwi(b){const h=Ic.a.Kkc(this.Zp);let r=this.Zp.cpBegin,A=this.Zp.cpEnd,L="";if(!h.length)return this.v8a=b.substring(this.Zp.cpBegin,this.Zp.cpEnd),{returnValue:!0,Xve:L,J1d:r,K1d:A,jae:h};if(h[0].hyperlink){let Z,oa=0,Ba=Math.max(0,b.length-1),gb=0;for(let Ab=0;Ab<
h.length;Ab++)h[Ab].cpBegin>=oa&&({cpBegin:Z,cpEnd:oa}=this.Q_.mla(this.Zp,h[Ab]),Ba=Math.min(Z,Ba),gb=Math.max(oa,gb));r=Math.min(Ba,r);A=Math.max(gb,A);this.v8a=b.substring(r,A);r===Ba&&(L=h[0].hyperlink.url);return{returnValue:!0,Xve:L,J1d:r,K1d:A,jae:h}}return{returnValue:!1,Xve:L,J1d:r,K1d:A,jae:h}}Yli(b,h,r){if(h!==this.Zp.cpEnd||b!==this.Zp.cpBegin)b=qc.SelectionFactory.eL(r,b,h),this.ge.lb.Kc(b),this.Zp=he.a.U1b(b.Qa.clone())}Ynp(b,h,r,A,L,Z=!1){A?(A=xc.a.createTextRange(this.Zp.node,this.Zp.cpBegin,
this.Zp.cpBegin+b.length),this.Op.sZl(A,r,h),b=qc.SelectionFactory.ue(this.Zp.node,this.Zp.cpBegin+b.length)):(this.Op.zvb(this.Zp,2),this.Lj.Fyb(this.Zp,2),r=xc.a.Uc(this.Zp.node,this.Zp.cpEnd),this.Cg.We(r,b,!0),A=xc.a.createTextRange(this.Zp.node,this.Zp.cpEnd,this.Zp.cpEnd+b.length),this.Op.wF(A,h,L,!1,!0,Z),b=qc.SelectionFactory.ue(this.Zp.node,this.Zp.cpEnd+b.length));b&&this.ge.lb.Kc(b)}o$a(b,h,r,A=!1){var L=null;b||(b=h,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",
!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!A){h=Ic.a.oKa(h);var Z="";this.qBa&&({sqg:Z}=this.qBa.JIg(h)).returnValue&&(h=Z)}this.qXf||(b=this.Op.$Eo(b));Z=!1;if(h){L=0<r.length;const oa=Cd.ParagraphReader.text(this.Zp.node).substring(this.Zp.cpBegin,this.Zp.cpEnd)!==b,Ba=this.Qd.Bg;if(Ba&&1===r.length&&!r[0].hyperlink.wI&&!(r[0].cpBegin>this.Zp.cpBegin&&r[0].cpEnd<=this.Zp.cpEnd)){this.Ynp(b,h,r[0].hyperlink,!oa,L,A);return}if(L)for(let gb=0;gb<r.length;gb++)r[gb].hyperlink.wI&&
(Z=!0),this.Op.fV(this.Zp.node,r[gb].hyperlink,!1);oa?this.Cg.We(this.Zp,b,!Z):Ba&&!Z&&this.Lj.Fyb(this.Zp,1);r=xc.a.createTextRange(this.Zp.node,this.Zp.cpBegin,this.Zp.cpBegin+b.length);this.Op.wF(r,h,L,Z,!0,A);L=qc.SelectionFactory.ue(this.Zp.node,this.Zp.cpBegin+b.length)}else 0<r.length&&(b=r[0],b.hyperlink.wI&&(Z=!0),this.Op.fV(b.paragraph,b.hyperlink));Z&&this.Qd.Yu(Z?2:7);L&&this.ge.lb.Kc(L);ed.a.upp()}bGi(b,h){h=h.items;const r=b.substring(F.a.T5a.length),A=this.bookmarkManager.jDi(r);b=
-1;let L=0;for(let Z=0;Z<h.length;Z++)if(h[Z].isHeading&&0!=A.count&&h[Z].paragraphNode.id==A.K(0).id){b=Z;break}else if(!h[Z].isHeading&&h[Z].linkurl==r){b=Z;L=1;break}h=new nB(b,L);return-1!=b?h:null}Myi(){const b={};let h=[],r=0,A=0;var L=this.vXl.ivm();L&&(r=L.count,h=h.concat(this.nvm(L)));if(L=this.bookmarkManager.r4d(!1))A=L.count,h=h.concat(this.yjm(L));b.groups=this.cvm(r,A);b.items=h;return b}cvm(b,h){const r=[],A=new jv("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,
0,b,0,!0);r.push(A);b=new jv("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);r.push(b);return r}nvm(b){const h=[],r=/\uFFFC/;for(const A of b)b=A.characterData.replace(r," "),b=new Tz(b,!0,A.Dc,A.end,A.paragraphNode),h.push(b);return h}yjm(b){const h=[];for(const r of b)b=r.zf(Vc.a.tu).toString(),b=new Qu(b,!1),h.push(b);return h}}kv.aFb=null;Object(u.a)(kv,"ReactInsertLinkDialog",null,[]);class Lv{static get mh(){return Dg.a.uy(Lv.lo,Box4Intl.Box4Strings.l_InsertLinkDisplayText,
Box4Intl.Box4Strings.l_InsertLinkAddress)}}Lv.lo="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(u.a)(Lv,"InsertLinkDialogHtml",null,[]);class np extends Dg.a{constructor(b){super();
this.Dme=()=>{const h=document.getElementById("txtLink");this.$ua(1,!h||!h.value.length||Ic.a.qXa(h.value))};this.zbe=(h,r)=>{if(this.zh.ow){var A=this.zh.lb.gb.currentSelection;if(A)if(A.equals(this.Qy)&&0!==h){h=new Sb.GraphTransaction(15);h.Ab(this.qW[0].node);for(A=0;A<this.qW.length;A++)this.qW[A].node.SJ().KF.n6(4);A=r.txtLink.trim();r=this.cQl();A=this.Han(A);(r||A)&&np.Qd.Yu(7);this.hide();h.dispose()}else this.zh.O8()}};this.qW=b;this.zh=Object(Kb.a)().Gd;this.Qy=this.zh.lb.gb.currentSelection;
this.RCf=b[0].cpBegin;this.V1f=b[b.length-1].cpEnd;this.Ig="InsertMultiParagraphLinkDialog";b=this.qxp();this.showDialog("",b)}showDialog(b,h){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.mh=Lv.mh;""===h.trim()&&this.Ke(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.zbe,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;np.wYf&&
(b=document.getElementById("txtLink"),zc.a.addHandler(b,od.a.input,this.Dme),zc.a.addHandler(b,od.a.UUc,this.Dme))}hide(){if(np.wYf){const b=document.getElementById("txtLink");b&&(zc.a.removeHandler(b,od.a.UUc,this.Dme),zc.a.removeHandler(b,od.a.input,this.Dme))}super.hide()}Hza(b){return np.wYf?this.lkm(this.RFc)?super.Hza(b):!1:super.Hza(b)}qxp(){let b;var h="";const r=this.qW.length,A=Ic.a.Oz(this.qW[0],!1);0<A.length&&({cpBegin:L,cpEnd:b}=np.Q_.mla(this.qW[0],A[0]),L<=this.qW[0].cpBegin&&(h=A[0].hyperlink.url),
this.RCf=Math.min(this.RCf,L));var L=Ic.a.Oz(this.qW[r-1],!1);0<L.length&&({cpBegin:L,cpEnd:b}=np.Q_.mla(this.qW[r-1],L[L.length-1]),this.V1f=Math.max(this.V1f,b));this.hqp(this.RCf,this.V1f);return h}hqp(b,h){const r=this.qW.length;if(b!==this.qW[0].cpBegin||h!==this.qW[r-1].cpEnd){b=xc.a.Uc(this.qW[0].node,b);b=qc.SelectionFactory.Uo(b);h=xc.a.Uc(this.qW[r-1].node,h);h=qc.SelectionFactory.Vy(b,h);b=this.kIi(h.Qa.clone());const A=this.kIi(h.Xc.clone());b&&A&&(this.qW[0]=b,this.qW[r-1]=A,this.zh.lb.Kc(h),
this.Qy=h)}}Han(b){if(!b)return!1;b=Ic.a.oKa(b);for(let r=0;r<this.qW.length;r++){var h=this.qW[r];if(np.tya&&he.a.Zl(h)&&(h=he.a.EIg(h),!he.a.Zl(h)))continue;h=xc.a.createTextRange(this.qW[r].node,h.cpBegin,h.cpEnd);this.Ipp(h);np.Op.wF(h,b,!1)}return!0}Ipp(b){np.Qd.c3j(b)}kIi(b){return Cd.ParagraphReader.en(b)&&!he.a.fba(b)&&Cd.ParagraphReader.textLength(b.node)?xc.a.createTextRange(b.node,0,Cd.ParagraphReader.textLength(b.node)):he.a.Zl(b)?b:null}cQl(){let b=!1;for(const h of this.qW){const r=
Ic.a.Oz(h,!1);r&&(b=np.Q_.nCj(h,r)||b)}return b}static get Q_(){return null!=np.oXg?np.oXg:np.oXg=Wa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Qd(){return null!=np.U5g?np.U5g:np.U5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Op(){return null!=np.fXg?np.fXg:np.fXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static get tya(){null==np.Xca&&(np.Xca=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return np.Xca}static get wYf(){null==np.AWe&&(np.AWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkUrlValidationIsEnabled"):!1);return np.AWe}}np.Xca=null;np.AWe=null;Object(u.a)(np,"InsertMultiParagraphLinkDialog",Dg.a,[]);class ef{static get tg(){return Be.a.instance}static get C6(){return null!=ef.XSg?ef.XSg:ef.XSg=Wa.a.instance.Oa("Box4.IContentControlChpHelper")}static get Q_(){return null!=ef.pXg?ef.pXg:ef.pXg=Wa.a.instance.resolve("Box4.IHyperlinkStrategy")}static xy(){return ef.Vn||
(ef.Vn=Wa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Qd(){return null!=ef.d6g?ef.d6g:ef.d6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get ti(){return null!=ef.k6g?ef.k6g:ef.k6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Fti(){return null!=ef.JWg?ef.JWg:ef.JWg=Wa.a.instance.nf("WordEditor.Bookmark.FullBookmarkManager").value}static get Ac(){return ih.a.instance}static get Kdd(){null==ef.vBb&&(ef.vBb=
y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return ef.vBb}static get tya(){null==ef.Xca&&(ef.Xca=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ef.Xca}static get Op(){return null!=ef.mXg?ef.mXg:ef.mXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Cg(){return null!=ef.HSg?ef.HSg:ef.HSg=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get fab(){ef.$We||(ef.$We=
y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"):!1);return ef.$We}static get coc(){var b;ef.aFb||(ef.aFb=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.insertLinkDialogRefactorEnabled",!1));return ef.aFb}static get nlp(){ef.JHh||(ef.JHh=y.AFrameworkApplication.J?y.AFrameworkApplication.J.jc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return ef.JHh}static Xb(){const b=
y.AFrameworkApplication.va;b.qa(vb.a.JR,kc.a.view,ef.QRb);b.qa(vb.a.JR,kc.a.Vc,ef.o$a);b.qa(vb.a.JR,kc.a.Cd,ef.o$a);b.Pc(vb.a.JR,1028);ef.coc&&(b.qa(vb.a.GKb,kc.a.Cd,ef.GKb),b.qa(vb.a.GKb,kc.a.Vc,ef.GKb));b.qa(vb.a.ahc,kc.a.view,ef.QRb);b.qa(vb.a.ahc,kc.a.Vc,ef.o$a);b.qa(vb.a.ahc,kc.a.Cd,ef.o$a);b.Pc(vb.a.ahc,1028);b.qa(vb.a.fV,kc.a.view,ef.QRb);b.qa(vb.a.fV,kc.a.Vc,ef.xCj);b.qa(vb.a.fV,kc.a.Cd,ef.xCj);b.Pc(vb.a.fV,1028);b.qa(vb.a.Rve,kc.a.view,ef.QRb);b.qa(vb.a.Rve,kc.a.Vc,ef.DKj);b.qa(vb.a.Rve,
kc.a.Cd,ef.DKj);b.qa(vb.a.$bb,kc.a.view,ef.QRb);b.qa(vb.a.$bb,kc.a.Vc,ef.Cpj);b.qa(vb.a.$bb,kc.a.Cd,ef.Cpj);b.qa(vb.a.$bb,kc.a.image,ef.Qgg);b.qa(vb.a.$bb,kc.a.ZOb,ef.Qgg);b.qa(vb.a.$bb,kc.a.L$,ef.Qgg);b.qa(vb.a.zVc,kc.a.application,ef.zVc);b.qa(vb.a.GXd,kc.a.view,ef.QRb);ef.fab&&(b.fb(Za.a.Qcb,kc.a.view,this.QRb.bind(this),1028),b.qa(Za.a.Qcb,kc.a.Vc,this.Qcb.bind(this)),b.qa(Za.a.Qcb,kc.a.Cd,this.Qcb.bind(this)),b.Pc(Za.a.Qcb,1028),b.qa(Za.a.OUf,kc.a.Vc,this.Qcb.bind(this)),b.qa(Za.a.OUf,kc.a.Cd,
this.Qcb.bind(this)),b.Pc(Za.a.OUf,1028),b.qa(Za.a.mkg,kc.a.view,this.mkg.bind(this)),b.qa(Za.a.fkg,kc.a.view,this.fkg.bind(this)),b.fb(Za.a.zsb,kc.a.Vc,this.zsb.bind(this),1028),b.fb(Za.a.zsb,kc.a.Cd,this.zsb.bind(this),1028))}static zVc(){return 32}static Qcb(b,h,r){if(!ef.fab)return 2;b=ef.V$j(h);if(32!=b)return b;if(!ef.pXa(h,!0).returnValue||ef.Xec(h))return 8;1!==r||ef.Poi||(ef.KEe(!0),ef.Poi=!0);return 32}static mkg(b,h,r,A,L){if(!ef.fab)return 2;if(1===r)return 32;ef.Use(ef.hJk,ef.iJk,ef.TAh);
Cq.a.instance.le(()=>{ef.KEe();L.MenuItems=Object.assign(new Ee.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const Z=this.pai();Z?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),L.MenuItems.MenuSectionList.push(Z)):ef.Ctj(L,ef.TAh)},"HA:PRLF");return 32}static fkg(b,h,r,A,L){if(!ef.fab)return 2;if(1===r)return 32;ef.Use(ef.fJk,ef.gJk,ef.SAh);Cq.a.instance.le(()=>{ef.KEe();L.MenuItems=Object.assign(new Ee.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],
UpdateDynamically:!0});L.MenuItems.MenuSectionList.push(this.WGl());const Z=this.pai(!0);Z?(v.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),L.MenuItems.MenuSectionList.push(Z)):ef.Ctj(L,ef.SAh)},"HA:PILF");return 32}static Ctj(b,h){v.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);ef.Use(ef.KFk,ef.LFk,h);b.MenuItems.MenuSectionList.push(this.AJl());ef.KEe(!0)}static AJl(){const b=this.atf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new Mj.a,
{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static WGl(){const b=this.atf("InsertLinkSection");b.ControlList.push(Object.assign(new Mj.a,{ExternalId:"InsertLink"}));return b}static pai(b=!1){if(Wi.instance.kKd){var h=this.atf("RecentLinksSection",b);b=JSON.parse(Wi.instance.kKd);this.jKd.clear();b.forEach((r,A)=>{this.jKd.set(A,[r.FileName,r.DocumentUrl]);const L=ef.YHm(r.FileName);var Z=ef.bum(r.TimeStamp),oa=h.ControlList,Ba=oa.push,
gb=Object,Ab=gb.assign,Jb=new Mj.a,Tb=Za.a.zsb,jc=Za.a.zsb;Z=L!==r.FileName?r.FileName+"\n"+Z:Z;var Hc=r.FileName;let hd="SaveAsWordDocx_32";switch(r.App){case "Word":hd="SaveAsWordDocx_32";break;case "PowerPoint":hd="SaveAsPowerPointPptx_32";break;case "Excel":hd="SaveAsExcelXlsx_32"}Ba.call(oa,Ab.call(gb,Jb,{ExternalId:A,Command:Tb,CommandValueId:jc,LabelText:L,Alt:Z,AriaDescription:Hc,ExternalImageId:hd,KeyTip:r.FileName}))});return h}}static atf(b,h=!1){return Object.assign(new hh.a,{Title:h?
Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static zsb(b,h,r,A,L){if(!ef.fab)return 2;if(!L||L.CommandValueId!=Za.a.zsb)return 32;ef.Use(ef.Pzk,ef.Qzk,ef.uKk);r=h;h=new Sb.GraphTransaction(15);h.Ph=b;h.Ab(r.node);A=ef.pXa(r,!0).hyperlink;r=he.a.U1b(r);if(A)ef.krg(r),b=qc.SelectionFactory.eL(r.node,Math.min(r.cpBegin,A.cpBegin),Math.max(r.cpEnd,A.cpEnd)),If.a.instance.Kc(b),r=b.Qa;else if(he.a.mf(r)){var Z;he.a.Qtb(r)&&
(Z=he.a.T6(r,!1));Z||(Z=this.jKd.get(L.SourceControlId)[0],ef.Cg.We(r,Z,!0,void 0,b),Z=qc.SelectionFactory.eL(r.node,r.cpBegin,r.cpBegin+Z.length));if(Z&&(If.a.instance.Kc(Z),r=Z.Qa,ef.Xec(r)))return ef.Qd.y0b(!1),8}try{ef.Op.wF(r,this.jKd.get(L.SourceControlId)[1],0<Ic.a.Kkc(r).length);const oa=qc.SelectionFactory.ue(r.node,r.cpEnd);oa&&If.a.instance.Kc(oa);m(L,"RecentLinks")}finally{h&&h.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static QRb(b,h,r,A,L){if(ef.Kdd)return ef.K3m(b,
h,r,A,L);if(!h.view.ve)return 2;var Z=h.view.lb;if(!Z||!Z.gb||!Z.gb.length)return 8;var oa=Z.gb.currentSelection;let Ba=oa.Qa.clone();if(2===oa.length){if(oa=oa.K(1),!he.a.Zl(Ba)||!he.a.pl(oa)||Ba.node!==oa.node)return 8}else if(2<oa.length)return 8;if(Z.gb.GL)return 8;if(Object(Nl.a)().HEa(Cd.ParagraphReader.xX,Z.Pg))return ef.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),8;Cd.ParagraphReader.en(Ba)&&!he.a.fba(Ba)&&(Z=Ba.node,Ba=xc.a.createTextRange(Z,0,Cd.ParagraphReader.textLength(Z)));return b===vb.a.GXd?
ef.n8h(h,Ba,r,A):y.AFrameworkApplication.va.Hf(Ba,b,r,!0,A,L)}static K3m(b,h,r,A,L){if(!h.view.ve)return 2;var Z=h.view.lb;if(!Z||!Z.gb||!Z.gb.length||Z.gb.GL)return 8;var oa=Z.gb.currentSelection;if(Z=ef.V_f(oa))oa=ef.ONf(oa.Qa.clone(),!0);else{let Ba=oa.K(0).clone(),gb=1;for(;gb<oa.length&&(!Cd.ParagraphReader.textLength(Ba.node)||he.a.pl(Ba)||ef.tya&&xl.l(Ba));)Ba=oa.K(gb).clone(),gb++;oa=ef.ONf(Ba,!1)}return ef.tya&&he.a.Zl(oa)&&xl.l(oa)||!he.a.Zl(oa)&&!Z?8:b===vb.a.GXd?ef.n8h(h,oa,r,A):y.AFrameworkApplication.va.Hf(oa,
b,r,!0,A,L)}static V_f(b){if(1===b.length)return!0;if(2===b.length){const h=b.Qa.clone();b=b.K(1);return he.a.Zl(h)&&he.a.pl(b)&&h.node===b.node?!0:!1}return!1}static q5h(b){let h=null;const r=[];for(let A=0;A<b.length;A++){const L=ef.ONf(b.K(A).clone(),!1);if(he.a.Zl(L))ef.tya&&xl.l(L)||r.push(L);else if(!he.a.pl(L)&&!Cd.ParagraphReader.en(L))return{returnValue:!1,Rnb:h}}h=r;return{returnValue:!ef.tya||0<h.length?!0:!1,Rnb:h}}static GKb(b,h,r,A,L){var Z;db.a.mark(5562);b=Ic.a.Kkc(h);r=Object(Kb.a)().Gd;
(null===(Z=pf.a.xd())||void 0===Z?0:Z.xm)&&r.lb.bKb();Z=new Sb.GraphTransaction(15);Z.Ab(h.node);h.node.SJ().KF.n6(4);r=L.txtDisplay;let oa=!1;if(null!=L.linkurl)if(oa=!0,L.isHeading){m(L,"Heading");const Ba=L.paragraphNode,gb=L.startCp,Ab=L.endCp;A=ef.Fti.Gti(Ba);ef.Fti.Tbc(A,gb,Ab,Ba,Ba,!1)}else m(L,"Bookmark"),A=L.linkurl;else m(L,"Url"),A=L.txtLink.trim();a(h,L).o$a(r,A,b,oa);Z.Ph=vb.a.GKb;Z.dispose();db.a.mark(5563);h.node.S7a();return 32}static o$a(b,h,r,A,L){if(ef.Kdd)return ef.Tan(h,r,L);
A=ef.V$j(h);if(32!==A)return A;let Z;if(!({hyperlink:Z}=ef.pXa(h,!0)).returnValue||ef.Xec(h)||!Z&&b==vb.a.ahc)return 8;if(1===r)return 32;if(!Z&&he.a.mf(h)&&he.a.Qtb(h)&&(b=he.a.T6(h,!1))&&(If.a.instance.Kc(b),h=b.Qa,ef.Xec(h)))return ef.Qd.y0b(!1),8;Z&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");L=a(h,L);ef.coc&&L.uUj();return 32}static V$j(b){return!ef.eUd(b)||b.node.Fq||If.a.instance.gb.GL?8:he.a.A7(b)||Yj.a.ZXf(b)?2:32}static Tan(b,h,r){var A=If.a.instance.gb.currentSelection;const L=ef.V_f(A);
if(L)b=[b];else if(!({Rnb:b}=ef.q5h(A)).returnValue)return 8;for(A=0;A<b.length;A++)if(!ef.eUd(b[A]))return 8;if(If.a.instance.gb.GL)return 8;A=Array(b.length);let Z=null;for(let oa=0;oa<b.length;oa++)if(A[oa]=b[oa],!({hyperlink:Z}=ef.pXa(A[oa],!0)).returnValue||ef.Xec(A[oa]))return 8;if(1===h)return 32;if(!Z&&1===A.length&&L&&he.a.mf(A[0])&&he.a.Qtb(A[0])&&(h=he.a.T6(A[0],!1))&&(If.a.instance.Kc(h),A[0]=h.Qa,ef.Xec(A[0])))return ef.Qd.y0b(!1),8;L?(r=a(A[0],r),ef.coc&&r.uUj()):new np(A,r);return 32}static xCj(b,
h,r){if(ef.Kdd)return ef.fAo(b,h,r);if(!ef.eUd(h)||he.a.A7(h))return 2;let A;if(!({hyperlink:A}=ef.pXa(h,!1)).returnValue)return 2;if(2===r){r=new Sb.GraphTransaction(15);try{r.Ph=b,r.Ab(A.paragraph),ef.krg(h)}finally{r&&r.dispose()}A.hyperlink.wI&&ef.Qd.Yu(2)}return 32}static fAo(b,h,r){var A=If.a.instance.gb.currentSelection;if(ef.V_f(A))h=[h];else if(!({Rnb:h}=ef.q5h(A)).returnValue)return 8;for(A=0;A<h.length;A++)if(!ef.eUd(h[A]))return 8;if(1===r&&!ef.pXa(h[0],!1).returnValue)return 2;if(2===
r){for(r=0;r<h.length;r++)if(!ef.pXa(h[r],!0).returnValue)return 2;r=new Sb.GraphTransaction(15);try{const L=h[0];r.Ph=b;r.Ab(L.node);for(b=0;b<h.length;b++)ef.krg(h[b])}finally{r&&r.dispose()}ef.Qd.Yu(7)}return 32}static krg(b){const h=Ic.a.Kkc(b);let r=0;for(let A=0;A<h.length;A++)if(h[A].cpBegin>=r){const L=({cpEnd:r}=ef.Q_.mla(b,h[A])).returnValue;ef.Q_.nCj(b,L)}}static DKj(b,h,r){if(Id.a.z$a(h)||!({hyperlink:b}=ef.pXa(h,!1)).returnValue)return 2;if(2===r){const {cpBegin:A,cpEnd:L}=ef.Q_.mla(h,
b);If.a.instance.Kc(qc.SelectionFactory.eL(b.paragraph,A,L))}return 32}static Cpj(b,h,r){if(({hyperlink:b}=ef.nvn(h)).returnValue)v.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=ef.pXa(h,!1)).returnValue)return 2;2===r&&ed.a.wic(b.hyperlink.url);return 32}static Qgg(b,h,r){b=Id.a.mla(h.node);if(!b)return 2;2===r&&ed.a.wic(b);return 32}static n8h(b,h,r,A){if(Id.a.z$a(h)||!Object(Kb.a)().Ie.Kk)return 2;let L;if(!({hyperlink:L}=ef.pXa(h,!1)).returnValue)return 2;
if(1===r)return 32;const {cpBegin:Z,cpEnd:oa}=ef.Q_.mla(h,L);If.a.instance.Kc(qc.SelectionFactory.eL(L.paragraph,Z,oa));h=Object(Kb.a)().kIa.ownerDocument.createElement("span");h.innerText=L.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return y.AFrameworkApplication.va.Hf(b,vb.a.FXd,2,!0,A,h)}static pXa(b,h){if(he.a.Zl(b)){const r=xl.g(b),A=Me.a.all(r,L=>6===L.Sh);if(0<r.length&&(!ef.tya||!A)||ef.tg.Lh&&ef.C6&&0<ef.C6.k5d(b).count)return{returnValue:!1,hyperlink:null}}return ef.cvn(b,
h)}static nvn(b){let h=null;return Id.a.z$a(b)&&(h=Ic.a.Qjc(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static cvn(b,h){let r=null;const A=Ic.a.Kkc(b);return A.length?A[0].hyperlink?(r=A[0],b.cpBegin<A[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static Xec(b){b=ef.ti.LAa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.K(h).Jd.changeType)return!0;return!1}static eUd(b){return ef.tg.p2(b)||
ef.tg.ama(b)||ef.xy()&&ef.xy().instance&&ef.xy().instance.zX(b)?!1:!0}static ONf(b,h){return Cd.ParagraphReader.en(b)&&!he.a.fba(b)&&(Cd.ParagraphReader.textLength(b.node)||h)?xc.a.createTextRange(b.node,0,Cd.ParagraphReader.textLength(b.node)):b}static YHm(b){return b&&b.length<=ef.Syj?b:b.substring(0,ef.Syj)+"..."}static bum(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",
minute:"numeric"}))}catch(h){return""}}static KEe(b=!1){const h=Date.now();if(b||h-ef.e5i>ef.nlp)Wi.instance.sJn(),ef.e5i=h}static Use(b,h,r){const A=new Map;A.set("Source",r);A.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.m2a,A)}}ef.Vn=null;ef.vBb=null;ef.aFb=null;ef.Xca=null;ef.jKd=new Map;ef.$We=null;ef.Syj=35;ef.e5i=Date.now();ef.Poi=!1;ef.m2a="wwaengidc";ef.uKk="RecentLinks";ef.TAh="RecentLinksRibbonOptions";ef.SAh="RecentLinksContextMenuOptions";ef.hJk="PopulateRecentLinksRibbon";
ef.iJk="PopulateRecentLinksRibbonAction";ef.fJk="PopulateRecentLinksContextMenu";ef.gJk="PopulateRecentLinksContextMenuAction";ef.KFk="PopulateRecentLinksContextMenu";ef.LFk="PopulateRecentLinksContextMenuAction";ef.Pzk="InsertRecentLinks";ef.Qzk="InsertRecentLinksAction";Object(u.a)(ef,"HyperlinkActor",null,[]);class oB{}oB.Eab=Object.freeze({Z5m:"WordIndentationShortcutUsage"});oB.UB="wwaengidc";Object(u.a)(oB,"IndentationConstants",null,[]);class lv{static get Ayn(){return lv.PFd}static PDl(b,
h,r){try{lv.PFd=lv.ZHl(b,h,r)}catch(A){lv.PFd=null,v.ULS.lz(539787540,393,10,A,"Error in creating autoTriggerTextContext: {0}",A instanceof Error?A.message:"Unknown Error")}}static jGj(){lv.PFd=null}static ZHl(b,h,r){if(!sf.ListItemReader.Fg(h))throw v.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const A=sf.ListItemReader.h7(h);if(null===A||void 0===A||!A.id)throw v.ULS.sendTraceTag(539787542,393,10,
"No list item node with id found under outline element"),Error("No list item node with id found under outline element");h=r.Uw(h);if(!h)throw v.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new lv(b,A.id,h)}constructor(b,h,r){this.S2j=b;this.jBn=h;this.xqg={listType:r.listType,listStyle:r.listStyle,nhe:r.Kx}}brn(b,h){return h&&b&&this.jBn===b.id&&h.listType===this.xqg.listType&&h.listStyle===this.xqg.listStyle&&h.Kx===
this.xqg.nhe}}lv.PFd=null;Object(u.a)(lv,"AutoTriggerTextContext",null,[]);var os;(function(b){b[b.none=0]="none";b[b.Dfp=1]="style1";b[b.Efp=2]="style2";b[b.Ffp=3]="style3";b[b.Gfp=4]="style4";b[b.Hfp=5]="style5";b[b.Qdc=6]="bullet";b[b.invalid=42]="invalid"})(os||(os={}));Object(u.b)("ListStyle",os);const CE={[os.Dfp]:{[1]:"disc",[0]:"decimal"},[os.Efp]:{[1]:"circle",[0]:"lower-alpha"},[os.Ffp]:{[1]:"square",[0]:"lower-roman"},[os.Gfp]:{[0]:"upper-alpha"},[os.Hfp]:{[0]:"upper-roman"},[os.Qdc]:{[1]:"bullet"}};
var Uz;(function(b){b[b.number=0]="number";b[b.Qdc=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.peq=16]="noList";b[b.invalid=42]="invalid"})(Uz||(Uz={}));Object(u.b)("ListType",Uz);class Br{constructor(b,h){this.YA=this.nbd=null;this.levelText=b;this.font=h}get oqe(){return this.levelText}get listStyle(){return 6}get Jx(){return"left"}}Object(u.a)(Br,"ListMarkerBullet",null,[497]);class pi{static get Kl(){return null!=pi.e0g?pi.e0g:pi.e0g=Wa.a.instance.resolve("Box4.List.IListEditor")}static get URj(){if(null!=
pi.r3g)var b=pi.r3g;else{var h;y.AFrameworkApplication.$c("2g5eb101;d5ebj317");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.addActionIdInTransaction",!1);b=pi.r3g=b}return b}static get Pd(){return pi.lg||(pi.lg=Wa.a.instance.resolve("Box4.List.IListReader"))}static set Pd(b){pi.lg=b}static get rk(){return null!=pi.DXg?pi.DXg:pi.DXg=Wa.a.instance.resolve("Box4.IInsertionPointFormatting")}static xy(){return pi.Vn||(pi.Vn=Wa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get tg(){return Be.a.instance}static get Ac(){return ih.a.instance}static get Ds(){return ai.a.getInstance()}static get Gpd(){return null!=
pi.K3g?pi.K3g:pi.K3g=Wa.a.instance.Oa("Box4.List.ISingleLevelListEditor")}static Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.$E,kc.a.view,pi.hTc);b.qa(vb.a.$E,kc.a.eS,pi.Bqa);b.Pc(vb.a.$E,1036);b.qa(vb.a.KN,kc.a.view,pi.hTc);b.qa(vb.a.KN,kc.a.eS,pi.Bqa);b.Pc(vb.a.KN,1036);b.qa(vb.a.nga,kc.a.view,pi.hTc);b.qa(vb.a.nga,kc.a.eS,pi.Bqa);b.Pc(vb.a.nga,1036);b.qa(vb.a.Mhf,kc.a.view,Vd.ActionManager.eg);b.qa(vb.a.E2h,kc.a.view,Vd.ActionManager.eg);b.qa(vb.a.n1f,kc.a.view,pi.FGo);b.qa(vb.a.xhf,kc.a.view,
Vd.ActionManager.eg);b.qa(vb.a.Ohf,kc.a.view,Vd.ActionManager.eg);b.qa(vb.a.nFg,kc.a.view,Vd.ActionManager.eg);b.qa(vb.a.xZj,kc.a.view,Vd.ActionManager.eg);b.qa(vb.a.MDe,kc.a.view,Vd.ActionManager.eg)}static FGo(){lv.jGj();return 32}static hTc(b,h,r,A,L){var Z,oa,Ba;if(!h.view.ve)return 2;const gb=pi.Ac.rq(vb.a.hTc);A.Xt=42;A.kE=42;const Ab={[yt.a.fPa]:5796,[yt.a.ePa]:5797};var Jb=h.view;if(Object(Nl.a)().wIa(pi.y4m,Jb.lb.Pg))return pi.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.yqf}),gb.end(),8;if(Object(Nl.a)().wIa(pi.Rgf,
Jb.lb.Pg))return pi.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.uWc}),gb.end(),8;if(Object(Nl.a)().HEa(Cd.ParagraphReader.xX,Jb.lb.Pg))return pi.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),gb.end(),8;if(pi.tg.xnc(Jb.lb.Pg))return pi.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UG}),gb.end(),8;if(null===(oa=null===(Z=pi.xy())||void 0===Z?void 0:Z.instance)||void 0===oa?0:oa.zX(h))return pi.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Z7a}),gb.end(),8;if(1===r)return gb.end(),32;L||(L=new lj.DictionaryPropertySet);if(ai.a.Nfn&&2===r){h=new Sb.GraphTransaction(15);
h.Ab(Jb.vd);pi.URj&&(h.Ph=b);const {Jla:Tb,Wpb:jc}=pi.uuj(b,L);pi.Kl.Cmp(Jb.lb.gb.currentSelection,Tb,jc);h.dispose();gb.end();return 32}Z=null;if(2===r){Z=new Sb.GraphTransaction(15);pi.URj&&(Z.Ph=b);Z.Ab(h.view.vd);pi.V$c=!1;oa=An.OutlineElementGeneralizer.cla(Jb.lb.gb,!1);if(!oa)return Z.dispose(),pi.Ac.fc(Df.a.asa,{["Reason"]:gf.a.Y1d}),gb.end(),8;1<oa.length&&L.setValue(Od.a.Rfj,null);const Tb=L.ka(Od.a.JL,-1),jc=L.ka(Od.a.cC,-1);null===(Ba=pi.Gpd)||void 0===Ba?void 0:Ba.qql(oa);if(Ba=pi.J2o(Tb,
jc,oa))L.setValue(Od.a.cC,16),L.setValue(Od.a.GXa,0);if(!he.a.mf(Jb.lb.Pg)&&!Ba&&0<oa.length&&Tb){Jb=new hb.a;Ba=Array(oa.length);for(let Hc=0;Hc<oa.length;Hc++)Jb.set(oa.getContext(Hc).node),Ba[Hc]=pi.Pd.Uw(Jb);pi.I2o(Ba,L)&&(Jb=new lj.DictionaryPropertySet,Jb.setValue(Od.a.cC,16),Jb.setValue(Od.a.GXa,0),Jb.setValue(Ge.a.Cta,"clean-list-before-apply-new-list-style"),Jb.setValue(Ge.a.qma,L.ka(Ge.a.Cta,"unknown")+"@"+L.ka(Ge.a.qma,"undefined")),yt.a.nua(b,h,r,A,Jb,Ab,11),y.AFrameworkApplication.va.Ob(vb.a.xZj,
2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),pi.V$c=!0)}Jb=new hb.a;Jb.set(oa.getContext(0).node);Jb=pi.Pd.Uw(Jb);pi.JFn(Tb,jc,Jb,oa.length)}b=yt.a.nua(b,h,r,A,L,Ab,11);32===b&&L.ka(Od.a.kVh,!1)&&(b=yt.a.nua(vb.a.eR,h,r,A,L,Ab,11));Z&&Z.dispose();gb.end();return b}static I2o(b,h){let r=null;var A=!1;for(let L=b.length-1;0<=L&&(r?(A=b[L],A=-1!==h.ka(Od.a.JL,-3)?A?r.listType!==A.listType||r.listStyle!==A.listStyle:!0:A?r.listType!==A.listType:!0):r=b[L],!A);L--);
return r&&(b=!1,A||(b=h.ka(Od.a.cC,42),h=h.ka(Od.a.JL,-3),b=b!==r.listType||0<h),A||b)?!0:!1}static JFn(b,h,r,A){0>=A||pi.V$c||(b?r?(r=r.listType,-1===b&&h===r?(y.AFrameworkApplication.va.Ob(vb.a.MDe,2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(y.AFrameworkApplication.va.Ob(h?vb.a.xhf:vb.a.Ohf,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(y.AFrameworkApplication.va.Ob(h?vb.a.xhf:
vb.a.Ohf,2),pi.vpp(),v.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(y.AFrameworkApplication.va.Ob(vb.a.MDe,2),v.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static J2o(b,h,r){if(-1!==b&&b||!r.length)return!1;b=new hb.a;let A=null;for(let L=r.length-1;0<=L&&!(b.set(r.getContext(L).node),A=pi.Pd.Uw(b));L--);return A&&h===A.listType?!0:!1}static Bqa(b,h,r,A,L){var Z;if(h.contextId!==kc.a.eS)return 2;var oa=h.clone().gDg();
if(pi.tg.gab(oa))return pi.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),2;oa=new hb.a;oa.set(h.node);he.a.Ou(oa);pi.s4f&&$g.TableCellReader.tba(oa)&&(h=new Map,h.set(pk.a.I9c,(!0).toString()),pi.mzj(h));if(!Eb.a.Mh(oa))return 2;if(1===r)switch(b){case vb.a.$E:return 32;case vb.a.KN:return 32;case vb.a.nga:return 32;default:return 2}if(Eb.a.RT(oa))return pi.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.XQ}),2;h=pi.Pd.Uw(oa);const Ba=Object.freeze(null===h||void 0===h?void 0:h.clone());if(!L)return 8;const {Se:gb,Jla:Ab,Wpb:Jb}=
pi.uuj(b,L);pi.HYo(gb,oa);var Tb=pi.Kl.Bqa(gb,oa,Ab,Jb);if(!Tb.returnValue)return pi.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.p3f}),2;Tb=Tb.Jla;pi.zro(oa,L,Ba,Tb);2===r&&(r=L.ka(Od.a.cC,-1),Tb&&-1!==r&&((oa=L.ka(Vc.a.at,"Invalid MultiLevel Type"),b===vb.a.KN&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===L||void 0===L?void 0:L.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:os[null==(null===h||void 0===h?void 0:
h.listStyle)?null===Tb||void 0===Tb?void 0:Tb.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:Uz[null==(null===h||void 0===h?void 0:h.listType)?null===Tb||void 0===Tb?void 0:Tb.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===Tb||void 0===Tb?void 0:Tb.listType)})),h)?Tb.listType&&1!==Tb.listType||pi.V$c||(y.AFrameworkApplication.va.Ob(vb.a.nFg,2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",r?"Bullet":"Numbering",oa)):
16===Tb.listType?(y.AFrameworkApplication.va.Ob(vb.a.E2h,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",r?"Bullet":"Numbering",oa)):Tb.listType&&1!==Tb.listType||pi.V$c||(y.AFrameworkApplication.va.Ob(vb.a.Mhf,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",oa))),b=Sg.FocusManager.instance(),(null===(Z=null===b||void 0===b?void 0:b.currentScope)||void 0===Z?void 0:Z.name)===Nk.a.Qua&&b.RE(Qf.AFrame.Do));A.Xt=
Tb.listType;A.kE=Tb.listStyle;return 32}static get s4f(){if(null!=pi.G0g)var b=pi.G0g;else{var h;y.AFrameworkApplication.$c("534af766;70gef585");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.listWithinTablesLoggingEnabled",!1);b=pi.G0g=b}return b}static mzj(b){const h=b.has(pk.a.I9c)?b.get(pk.a.I9c):"false";b=b.has(pk.a.Zae)?b.get(pk.a.Zae):"unknown";const r=new Map;r.set(pk.a.I9c,h);r.set(pk.a.Zae,b);xa.Health.instance.recordKpiUsage(pk.a.Eab.sBn,
0,pk.a.UB,r)}static uuj(b,h){let r;b===vb.a.KN||b===vb.a.$E||b===vb.a.nga?(h=pi.Kl.y_c(b,h),r=Vq.a.OW(h.getValue(Od.a.cC),h.getValue(Od.a.GXa))):r=null;pi.o3(b,h);let A=!1;if(!r)return v.ULS.sendTraceTag(508155328,393,50,"Returning null list info from prepareArgsForApplyBulletsNumbering"),{Se:h,Jla:r,Wpb:A};pi.RWo(r,h);b===vb.a.$E&&h&&(h.hasProperty(Vc.a.$w)&&(r.levelText=h.getValue(Vc.a.$w)),h.hasProperty(Ke.a.font)&&(r.font=h.getValue(Ke.a.font)),h.hasProperty(Od.a.aEf)&&(A=h.getValue(Od.a.aEf)));
return{Se:h,Jla:r,Wpb:A}}static zro(b,h,r,A){var L,Z,oa,Ba,gb,Ab,Jb,Tb;const jc=new Map;jc.set("actionCallSource",h.ka(Ge.a.Cta,"unknown"));jc.set("actionCallSourceTrigger",h.ka(Ge.a.qma,"undefined"));jc.set("fromListType",Uz[null!==(L=null===r||void 0===r?void 0:r.listType)&&void 0!==L?L:16]);jc.set("fromListStyle",os[null!==(Z=null===r||void 0===r?void 0:r.listStyle)&&void 0!==Z?Z:0]);jc.set("fromListMarkerType",null!==(gb=l(null!==(oa=null===r||void 0===r?void 0:r.listStyle)&&void 0!==oa?oa:0,
null!==(Ba=null===r||void 0===r?void 0:r.listType)&&void 0!==Ba?Ba:16))&&void 0!==gb?gb:"undefined");jc.set("fromLevelText",(null===r||void 0===r?0:r.YAa)?r.levelText:"undefined");jc.set("toListType",null!==(Ab=Uz[null===A||void 0===A?void 0:A.listType])&&void 0!==Ab?Ab:"undefined");jc.set("toListStyle",null!==(Jb=os[null===A||void 0===A?void 0:A.listStyle])&&void 0!==Jb?Jb:"undefined");jc.set("toListMarkerType",null!==(Tb=l(null===A||void 0===A?void 0:A.listStyle,null===A||void 0===A?void 0:A.listType))&&
void 0!==Tb?Tb:"undefined");jc.set("toLevelText",(null===A||void 0===A?0:A.YAa)?A.levelText:"undefined");ai.a.$qn&&jc.set("underHeaderFooterKind",this.Pd.Syi(b.currentNode));xa.Health.instance.recordKpiUsage(pk.a.Eab.vBn,0,pk.a.UB,jc)}static HYo(b,h){var r=new hb.a;r.nd(h);(h=r.Vb(2))&&Cd.ParagraphReader.Wb(h)&&(r=If.a.instance.gb.currentSelection)&&r.Qa&&r.Qa.node===h&&he.a.mfe(r)&&(pi.dVo(b),pi.bVo(b))}static RWo(b,h){h.hasProperty(Vc.a.at)&&b.pxe(h.getValue(Vc.a.at));h.hasProperty(Ge.a.DT)&&(b.DT=
h.getValue(Ge.a.DT));h.hasProperty(Vc.a.$w)&&(b.levelText=h.getValue(Vc.a.$w));b.JL=h.ka(Od.a.JL,-1);let r=null;b.pta&&(r=pi.Rym(b,h));b.pta&&r?pi.BYo(b,r):(b.pta?v.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.JL,b.at,b.Uz):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),pi.QTo(b))}static QTo(b){if(b.Uz)b.t$d&&-1===b.JL||(b.levelText="%1.",
b.Se.hasProperty(Ke.a.W7)||b.tca(0,1));else if(1===b.listType)b.t$d&&-1===b.JL||(b.font=pk.a.vYc,b.levelText=pk.a.pZd,b.Se.hasProperty(Ke.a.W7)||b.tca(1,6));else return;b.Jx="left"}static BYo(b,h){1===b.at?pi.nXo(b,h):pi.FVo(b,h)}static nXo(b,h){(b.YA=h.YA)?b.b9=h.YA.b9:h.YA||v.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.JL,b.at,b.Uz)}static FVo(b,h){b.levelText=h.levelText;b.Uz?b.tca(0,h.listStyle):
(b.font=h.font,b.tca(1,1));b.Jx=h.Jx}static Rym(b,h){let r=null;2===b.at?r=b.Uz?Wa.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Wa.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.at&&(r=Wa.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let A=r.QUb.value;const L=b.JL+"";L in A||(A=r.wba,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
L,b.at,b.Uz));if(!(L in A)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",L,b.at,b.Uz);if(h.hasProperty(Ke.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",L,b.at,b.Uz),b=h.getValue(Ke.a.font),new Br(F.a.fromCharCode(parseInt(L)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
L,b.at,b.Uz)}return A[L]}static bVo(b){pi.rk.hasProperty(Ke.a.fontColor)&&b.setValue(Ke.a.fontColor,pi.rk.fontColor())}static dVo(b){pi.rk.hasProperty(Ke.a.fontSize)&&b.setValue(Ke.a.fontSize,pi.rk.fontSize())}static o3(b,h){b=b===vb.a.$E?0:b===vb.a.KN?1:b===vb.a.nga?2:-1;h=h.ka(Od.a.JL,-1);v.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static vpp(){const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");if(b){var h=y.AFrameworkApplication.J.jc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else v.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}pi.y4m=Id.a.u9c;pi.Rgf=Id.a.y$a;pi.lg=null;pi.Vn=null;pi.V$c=!1;Object(u.a)(pi,"ListActor",null,[]);class Xm{static get fr(){return vw.a.zQb}static get tg(){return Be.a.instance}static get Ac(){return ih.a.instance}static get Xs(){return Object(Kb.a)()}static xy(){return Xm.Vn||
(Xm.Vn=Wa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Y5m(){return null!=Xm.wXg?Xm.wXg:Xm.wXg=Wa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.KI,kc.a.view,Xm.mTc);b.qa(vb.a.KI,kc.a.eS,Xm.lTh);b.Pc(vb.a.KI,1036);b.qa(vb.a.eR,kc.a.view,Xm.mTc);b.qa(vb.a.eR,kc.a.eS,Xm.lTh);b.Pc(vb.a.eR,1036)}static sro(b){const h=new Map;b=b?b.ka(Ge.a.abe,"Unknown"):"tab";h.set("actionCallSource",b);xa.Health.instance.recordKpiUsage(oB.Eab.Z5m,
1,oB.UB,h)}static mTc(b,h,r,A,L){const Z=h.view;if(!Z.ve)return 2;var oa=Z.lb;if(!oa)return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.qga}),8;oa=oa.Pg;if(!oa)return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Qn}),8;if(Yj.a.iba(h))return 8;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Xm.tg.xnc(oa))return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UG}),8;if(1===r)return 32;if(Object(Nl.a)().wIa(Xm.Rgf,oa))return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.uWc}),8;if(Object(Nl.a)().HEa(Cd.ParagraphReader.xX,
oa))return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),8;if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Xm.tg.xnc(oa))return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UG}),8;if(Xm.xy()&&Xm.xy().instance&&Xm.xy().instance.zX(oa))return Xm.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Z7a}),8;oa={};oa[yt.a.fPa]=5794;oa[yt.a.ePa]=5795;return Xm.Y5m.mTc(Z,b,h,r,A,L,oa)}static lTh(b,h,r,A,L){var Z,oa;if(h.contextId!==kc.a.eS)return 2;var Ba=h.clone().gDg();if(si.TableReader.z2i(Ba)){if(Xm.tg.A2i(Ba))return Xm.Ac.fc(Df.a.Pn,
{["Reason"]:gf.a.UG}),8}else if(Xm.tg.gab(Ba))return Xm.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),2;Ba=new hb.a;Ba.set(h.node);he.a.Ou(Ba);if(!Eb.a.Mh(Ba))return 2;pi.s4f&&Xm.Nso(L,Ba);let gb;switch(b){case vb.a.KI:gb=Xm.fr.ILb(Ba);break;case vb.a.eR:gb=Xm.fr.$dc(Ba);break;default:return 2}if(1===r||!gb)return gb?32:8;r=0;b===vb.a.eR&&L&&L.ka(Od.a.kVh,!1)&&(r|=2);if(Eb.a.RT(Ba))return Xm.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.XQ}),2;(null===(oa=null===(Z=Xm.Xs)||void 0===Z?void 0:Z.Gd)||void 0===oa?0:oa.BX)&&Xm.Xs.Ie&&
(Xm.Xs.Ie.lK=!0);switch(b){case vb.a.KI:Xm.fr.hZa(Ba,-1,r);break;case vb.a.eR:Xm.fr.LYc(Ba,1)}A&&At.a.Vzb&&(A.Xt|=At.a.Fqb(h.node,!0));Xm.sro(L);return 32}static Nso(b,h){$g.TableCellReader.tba(h)&&sf.ListItemReader.Fg(h)&&(b=b?b.ka(Ge.a.abe,"Unknown"):"Ribbon",h=new Map,h.set(pk.a.Zae,b),h.set(pk.a.I9c,"true"),pi.mzj(h))}}Xm.Vn=null;Xm.Rgf=Id.a.y$a;Object(u.a)(Xm,"IndentationActor",null,[]);var Sn=d(1537);class Zk{static get ql(){return null!=Zk.X1g?Zk.X1g:Zk.X1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}static get ik(){return null!=
Zk.T4g?Zk.T4g:Zk.T4g=Wa.a.instance.resolve("Box4.ITableEditor")}static get tg(){return Be.a.instance}static get Ac(){return ih.a.instance}static xy(){return Zk.Vn||(Zk.Vn=Wa.a.instance.Ta("Box4.IExternalSelectionManager"))}static Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.FGg,kc.a.view,(h,r)=>Yj.a.iba(r)?8:32);b.qa(vb.a.O7,kc.a.view,Sn.a.zx);b.qa(vb.a.O7,kc.a.paragraph,Zk.NHa);b.qa(vb.a.O7,kc.a.table,Zk.$hf);b.Pc(vb.a.O7,1036);b.qa(vb.a.X$,kc.a.view,Sn.a.zx);b.qa(vb.a.X$,kc.a.paragraph,Zk.NHa);
b.qa(vb.a.X$,kc.a.table,Zk.$hf);b.Pc(vb.a.X$,1036);b.qa(vb.a.t8,kc.a.view,Sn.a.zx);b.qa(vb.a.t8,kc.a.paragraph,Zk.NHa);b.qa(vb.a.t8,kc.a.table,Zk.$hf);b.Pc(vb.a.t8,1036);b.qa(vb.a.TJa,kc.a.view,Sn.a.zx);b.qa(vb.a.TJa,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.TJa,1036);b.qa(vb.a.oZc,kc.a.view,Sn.a.zx);b.qa(vb.a.oZc,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.oZc,1036);b.qa(vb.a.jUb,kc.a.view,Sn.a.zx);b.qa(vb.a.jUb,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.jUb,1036);b.qa(vb.a.uod,kc.a.view,Sn.a.zx);b.qa(vb.a.uod,kc.a.paragraph,
Zk.NHa);b.Pc(vb.a.uod,1036);b.qa(vb.a.iqc,kc.a.view,Sn.a.zx);b.qa(vb.a.iqc,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.iqc,1036);b.qa(vb.a.pec,kc.a.view,Sn.a.zx);b.qa(vb.a.pec,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.pec,1036);b.qa(vb.a.Pvc,kc.a.view,Sn.a.zx);b.qa(vb.a.Pvc,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.Pvc,1036);b.qa(vb.a.Pic,kc.a.view,Sn.a.zx);b.qa(vb.a.Pic,kc.a.paragraph,Zk.NHa);b.Pc(vb.a.Pic,1036)}static $hf(b,h,r,A){let L=!0;if(!h)return 8;si.TableReader.z2i(h)?Zk.tg.A2i(h)?(Zk.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),
L=!1):Zk.xy()&&Zk.xy().instance&&Zk.xy().instance.zX(h)&&(Zk.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Z7a}),L=!1):(Zk.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Pxf}),L=!1);if(1===r||!L)return L?32:8;h=h.node;switch(b){case vb.a.O7:Zk.ik.wH(h,1);break;case vb.a.X$:Zk.ik.wH(h,2);break;case vb.a.t8:Zk.ik.wH(h,3)}A&&At.a.Vzb&&(A.Xt|=2);return 32}static NHa(b,h,r,A,L){let Z=!0;h.contextId!==kc.a.paragraph?Z=!1:Zk.tg.gab(h)?(Zk.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),Z=!1):Zk.xy()&&Zk.xy().instance&&Zk.xy().instance.zX(h)&&(Zk.Ac.fc(Df.a.Pn,
{["Reason"]:gf.a.Z7a}),Z=!1);if(1===r||!Z)return Z?32:8;h=h.node;r=Cd.ParagraphReader.Xy(h);switch(b){case vb.a.O7:case vb.a.iqc:Zk.ql.wH(h,1===r&&Zk.Rfe(L)?6:1);break;case vb.a.X$:case vb.a.pec:Zk.ql.wH(h,2===r&&Zk.Rfe(L)?1:2);break;case vb.a.t8:case vb.a.Pvc:Zk.ql.wH(h,3===r&&Zk.Rfe(L)?1:3);break;case vb.a.TJa:case vb.a.Pic:Zk.ql.wH(h,6===r&&Zk.Rfe(L)?1:6);break;case vb.a.jUb:Zk.ql.wH(h,11);break;case vb.a.oZc:Zk.ql.wH(h,7);break;case vb.a.uod:Zk.ql.wH(h,13)}A&&At.a.Vzb&&(A.Xt|=At.a.Fqb(h));return 32}static Rfe(b){let h=
!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}Zk.Vn=null;Object(u.a)(Zk,"JustificationActor",null,[]);const mv=()=>{const b=y.AFrameworkApplication.va;b.qa(vb.a.save,Gc.a.frame,zJ);b.qa(vb.a.sync,Gc.a.frame,Gm)},Gm=(b,h,r)=>{if(1===r)return 32;y.AFrameworkApplication.va.Ob(vb.a.eec,2);ed.a.jf.mBe();return 32},zJ=(b,h,r)=>{if(1===r)return 2===ab.StaticActiveAppFrame.za().mode?32:8;y.AFrameworkApplication.va.Ob(vb.a.eec,2);if(2!==ab.StaticActiveAppFrame.za().mode)return 32;
ed.a.jf.gJj(null,null);return 32};class Vz{constructor(){this.activateRibbonTab=(b,h,r,A,L)=>{ed.a.EB.FJ.Rld(L.toString());return 32};this.ezn=(b,h,r,A,L)=>{ed.a.EB.FJ.s4i(1,L.toString());return 32};this.e5n=(b,h)=>{if(h.contextId!==Gc.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.activateRibbonTab,kc.a.view,this.activateRibbonTab);b.Pc(vb.a.activateRibbonTab,5);b.qa(vb.a.t4i,kc.a.view,this.ezn);b.qa(vb.a.DHg,Gc.a.frame,this.e5n)}static get instance(){return null!=
Vz.$Xg?Vz.$Xg:Vz.$Xg=Vz.Qm()}static Qm(){return new Vz}}Object(u.a)(Vz,"RibbonActor",null,[]);var Qr=d(890);class Dw{constructor(b,h,r){this.En=null;this.$sp=(A,L,Z,oa,Ba)=>{var gb;let Ab;oa=this.aak(L);if(!oa)return 8;Ab=A===vb.a.undo?this.ih.V2:this.ih.$Aa;if(1===Z)return(null===(gb=y.AFrameworkApplication.J)||void 0===gb?0:gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))&&this.J8j(),Yj.a.iba(L)&&Yj.a.htb()?8:Ab?32:8;if(!Ab)return v.ULS.sendTraceTag(17069441,365,
50,"User attempted {0} without an undo stack",A===vb.a.undo?"undo":"redo"),this.NPa.value.Z4j(),Dw.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.Usp}),2;L=new Sb.GraphTransaction(3);L.Ab(oa.vd);L.xwe();A=A===vb.a.undo?this.ih.undo():this.ih.Sga();L.dispose();Ba&&Iz.GrippersManager.instance.s2b(Ba.az);if(A)return 32;Dw.Ac.fc(Df.a.Ggc,{["Reason"]:gf.a.Kgj});return 8};this.rEo=(A,L,Z)=>{if(!this.aak(L))return 8;A=this.NHb.wLa();return 1===Z?(this.J8j(),Yj.a.iba(L)&&Yj.a.htb()?8:A?32:8):A?this.NHb.repeat():(v.ULS.sendTraceTag(508127130,
365,50,"User attempted Repeat without a last repeatable action stored"),Dw.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.qEo}),2)};this.Xso=(A,L,Z,oa,Ba)=>{A=this.NHb.wLa();const gb=this.ih.$Aa;return 1===Z?Yj.a.iba(L)&&Yj.a.htb()?8:A||gb?32:8:A?y.AFrameworkApplication.va.Hf(L,vb.a.repeat,Z,!0,oa,Ba):gb?y.AFrameworkApplication.va.Hf(L,vb.a.Sga,Z,!0,oa,Ba):2};this.lqa=b;this.NPa=h;this.NHb=r}get ih(){return this.En||(this.En=this.lqa())}Xb(){var b;const h=y.AFrameworkApplication.va,r=this.$sp;h.fb(vb.a.undo,kc.a.view,
r,1028);h.fb(vb.a.Sga,kc.a.view,r,1028);if(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))h.fb(vb.a.repeat,kc.a.view,this.rEo,1028),h.fb(vb.a.Yse,kc.a.view,this.Xso,1124)}J8j(){const b=this.NHb.wLa(),h=this.ih.$Aa;b?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Repeat",!1)),appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("Repeat",!1)),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Redo",
!0))):h&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Repeat",!0)),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Redo",!1)),appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("Redo",!1)))}aak(b){b=b.view;return b.ve?b:(Dw.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.fWb}),null)}static get instance(){return null!=Dw.IXg?Dw.IXg:Dw.IXg=Dw.Qm()}static Qm(){var b;const h=Wa.a.instance;return new Dw(()=>h.resolve("Box4.IUndoManager"),h.nf("Box4.ICoauthCashTelemetry"),
(null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))&&h.resolve("Box4.UndoRedo.IRepeatManager"))}static get Ac(){return ih.a.instance}}Object(u.a)(Dw,"UndoActor",null,[]);const gx={track:!0,C_h:!1,pUd:!1},LG={["InsertTable"]:{pUd:!0},["InsertColumnAfter"]:{pUd:!0},["InsertRowBelow"]:{pUd:!0}};let pB;var RC=d(317);class DE{constructor(){this.Z=null}get name(){return"Box4.Actors"}wc(b){this.Z=b;(new AE).wc(b)}init(){var b=
this.Z.resolve("Box4.Actors.ClipboardActor");Object(Rz.a)()&&this.Z.resolve("Box4.Actors.PageColorActor").Xb();b.Xb();b.o8();Sz();Hs.instance.Xb(Object(Yx.a)()?this.Z.resolve("Box4.HighContrastColorPickerState"):null);ef.Xb();Xm.Xb();Zk.Xb();this.Z.resolve("Box4.Actors.TouchInputActor").Xb();bt.instance.Xb();this.Z.resolve("Box4.ISelectAllHandlers").Xb();mv();this.Z.resolve("Box4.Actors.ProofingActor").Xb();Vz.instance.Xb();(b=this.Z.Oa("Box4.IFeatureHelper"))?b.er.continueWith(()=>{this.XAj()}):
this.XAj();Qr.a.Xb(ed.a.Y_a);this.Z.resolve("Box4.Actors.TextFormattingActor").Xb();Dw.instance.Xb();this.Z.resolve("Box4.Actors.AccessibilityActor").Lpg();this.Z.resolve("Box4.IClipboardCommands");this.Z.resolve("Box4.Actors.PasteFloatieEventManager");ab.StaticActiveAppFrame.za().Ge()}XAj(){this.Z.resolve("Box4.Actors.StyleContextMenuActor").Xb();this.Z.resolve("Box4.Actors.StyleActor").Xb()}dispose(){}static main(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerIsEnabled",
!1)&&(Y.a.nTi=b=>{if(b&&window.event){var h=LG[b]||{};if(!pB){var r=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerWithSelectionContext","");pB=new Set(r.trim().split(/\s+/))}pB.has(b)&&(h.C_h=!0);h={...gx,...h};if(h.track){b=Object(RC.b)(window.event,`OtelUserAction - ${b}`);r=Wa.a.instance.Oa("Box4.IWordActionContextCapturer");var A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerWithTableContext",
!1);h.C_h&&r&&r.lOh(b);A&&h.pUd&&r&&r.j_k(b)}}});E.a.instance.Mc(new DE)}}Object(u.a)(DE,"Box4ActorsPackage",null,[0,1]);class MG extends Zx{constructor(b,h,r,A){super(b);this.Xra=r;this.qdb=A;this.KNg=0;this.nz=h.UXa("UserAction","WordOnlineAddToDictionary")}Tzg(b){this.m1d=this.Xra.msa(b);if(!this.Rol())return!1;const h=this.m1d.errorDetails.token;this.qdb.MOh(h);if(!this.qdb.brd(h))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;
v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.nz.start();this.transaction=new Sb.GraphTransaction(15);this.transaction.Ab(b.node);return!0}zqe(b){this.$Xb(b.node);return!0}Thd(b){this.$Xb(b);return!0}Aqe(b){this.$Xb(b.node)}jGg(b){this.transaction.dispose();this.m1d.errorDetails.lAb(b.actionId);this.qdb.rvg("unused corelation id.");this.nz.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",
this.KNg,this.nz.Ri,this.m1d.errorDetails.proofingType));return!0}gyc(b,h){const r=b.role;return super.gyc(b,h)||9===r||10===r||13===r||7===r||8===r}$Xb(b){if(b){var h=this.Xra.f7(b,r=>this.qdb.brd(r.errorDetails.token));this.Xra.ixb(b,h,!0);this.KNg+=h.length}}Rol(){var b,h;return null!==(h=null===(b=this.m1d)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(u.a)(MG,
"AddToDictionaryCallbackSteps",Zx,[]);class EE{constructor(b,h,r,A,L,Z,oa){this.Pb=b;this.lb=h;this.ona=r;this.Xra=A;this.Ap=L;this.qdb=Z;this.Rjo=oa;this.yUm=(Ba,gb,Ab,Jb,Tb,jc)=>{const Hc=new MG(this.ona,this.Ap,this.Xra,this.qdb);return new jB(Ba,gb,Ab,Jb,Tb,jc,Hc,this.Pb,this.lb,this.ona,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Xb(){this.Pb.wW(vb.a.wOh,kc.a.view,this.yUm,1124);this.Rjo.kxo(this.qdb)}}Object(u.a)(EE,"PersonalDictionaryOrchestrator",null,[]);class FE{get name(){return"Box4.PersonalDictionary"}wc(b){this.container=
b;b.register(EE,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().Ud(()=>new EE(y.AFrameworkApplication.va,If.a.instance,zy.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Xb()}dispose(){}static main(){zk.a.get_instance().Sk(7,()=>{E.a.instance.Mc(new FE)})}}
Object(u.a)(FE,"PersonalDictionaryPackage",null,[0,1]);var so=d(107);class Wz{constructor(b,h,r,A,L,Z){this.lFa=this.mJ=null;this.RUc=(oa,Ba,gb,Ab,Jb)=>this.M1i(Ba,gb,Jb,!1)?32:8;this.QG=(oa,Ba,gb,Ab,Jb)=>{if(!({Hz:oa}=this.kSj(Ba,gb,Jb,!0)).returnValue)return oa;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Jb=this.uQk.lka(Ba.node,Jb);this.Hbo(Ba.node,Jb);this.oM();return 32};this.knb=(oa,Ba,gb,Ab,Jb)=>{if(!({Hz:oa}=this.kSj(Ba,gb,Jb,!1)).returnValue)return oa;
this.Dbo(Ba.node);return 32};this.Wko=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;if(!Ba||!Ba.view.ve)return 2;oa=Ba.view.lb;if(!oa)return 2;oa=oa.Pg;if(!oa)return 2;oa=Object(Nl.a)().lU(oa,16);if(!oa||!oa.length)return 2;Ba=null;for(gb=0;gb<oa.length;gb++){Ab=oa.getContext(gb);if(!Ab||Ab.contextId!==kc.a.ix)return 2;const Tb={};this.cMi(Ab,Tb);if(Tb.CellShading)if(Ba&&Ba!==Tb.CellShading){Ba=null;break}else Ba=Tb.CellShading;else{Ba=null;break}}Jb.CellShading=Ba;return 32};this.Qwb=(oa,Ba,gb,Ab,Jb)=>
1===gb?32:this.cMi(Ba,Jb);this.EXb=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;oa=Ba.contextId===kc.a.view?this.Tjb.DQb(Ba):this.rLf(Ba);gb={};Ba=null;32===y.AFrameworkApplication.va.Qb(vb.a.Qwb,2,gb)&&gb&&(Ba=gb.CellShading);gb="";Ba&&(gb=Ql.a.JB(Ba)||"");this.hRj.mca=gb;this.IP.NAc(gb);oa=this.hRj.cqb(oa,ed.a.RTa);if(!oa)return 8;Jb.MenuItems=oa;v.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.G3=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();
y.AFrameworkApplication.va.Qb(vb.a.Qwb,2,Jb);this.lFa=new Xw("Shading",vb.a.Iwc);this.lFa.Vyb(Jb&&Jb.CellShading?Jb.CellShading:0);return 32};this.rnl=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;y.AFrameworkApplication.va.Qb(vb.a.w8,2,Jb);this.IP.cTa(Jb)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.uQk=h;this.L_e=r;this.Tjb=A;this.Zd=L;this.kq=Z}get IP(){return null!=this.I2g?this.I2g:this.I2g=Wa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get hRj(){this.mJ||
(this.mJ=new Wq("Shading"),this.Kfa(this.mJ));return this.mJ}Kfa(b){b.PH(2,vb.a.knb);b.PH(3,vb.a.w8);b.PH(4,vb.a.w8);b.z5a(this.L_e,1)}Xb(){this.ga.qa(vb.a.EXb,kc.a.view,this.EXb);this.ga.qa(vb.a.EXb,kc.a.ix,this.EXb);this.ga.Pc(vb.a.EXb,1126);this.ga.qa(vb.a.RUc,kc.a.view,Qr.a.y1c);this.ga.qa(vb.a.RUc,kc.a.ix,this.RUc);this.ga.Pc(vb.a.RUc,1028);this.ga.qa(vb.a.w8,kc.a.view,Qr.a.y1c);this.ga.qa(vb.a.w8,kc.a.ix,this.QG);this.ga.Pc(vb.a.w8,1028);this.ga.qa(vb.a.knb,kc.a.view,Qr.a.y1c);this.ga.qa(vb.a.knb,
kc.a.ix,this.knb);this.ga.Pc(vb.a.knb,1028);this.ga.qa(vb.a.Qwb,kc.a.view,this.Wko);this.ga.qa(vb.a.Qwb,kc.a.ix,this.Qwb);this.ga.Pc(vb.a.Qwb,1124);this.ga.qa(vb.a.Iwc,kc.a.view,Qr.a.y1c);this.ga.qa(vb.a.Iwc,kc.a.ix,this.rnl);this.ga.Pc(vb.a.Iwc,1028);this.ga.qa(vb.a.Sgg,kc.a.view,this.G3);this.ga.Pc(vb.a.Sgg,1028)}oM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}kSj(b,h,r,A){return this.M1i(b,h,r,A)?{returnValue:2===h,Hz:32}:(2==h&&Qr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],gf.a.U5l),{returnValue:!1,Hz:8})}M1i(b,h,r,A){return b.contextId!==kc.a.ix||2===h&&(A&&!r||!b.node)?!1:!0}Hbo(b,h){const r=new Sb.GraphTransaction(15);r.Ab(b);this.TPj(b);b.properties.setValue(Ke.a.QG,h);r.dispose()}Dbo(b){const h=new Sb.GraphTransaction(15);
h.Ab(b);this.TPj(b);b.properties.removeProperty(Ke.a.QG);h.dispose()}rLf(b){return b.contextId!==kc.a.ix?null:(b=Object(so.a)().Iu(b.node))?b:null}TPj(b){if(this.Zd&&this.Zd.Bg&&(b=Object(Ca.a)($s.TableCellNode,b))){const h=b.$X();this.kq.qod(b,h)}}cMi(b,h){if(b.contextId!==kc.a.ix)return 8;(b=b.node)&&b.hasProperty(Ke.a.QG)&&(h.CellShading=b.getValue(Ke.a.QG));return 32}static Zkm(){return new Wz(y.AFrameworkApplication.va,Bq.a.instance,fh.a.instance,pl.PageReader.instance,Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get instance(){return null!=Wz.bZg?Wz.bZg:Wz.bZg=Wz.Zkm()}}Object(u.a)(Wz,"CellShadingActor",null,[]);class NG{constructor(){this.Z=null}get name(){return"Box4.CellShading"}wc(b){this.Z=b}init(){const b=this.Z.Oa("Box4.IFeatureHelper");b?b.er.continueWith(()=>{this.Ho()}):this.Ho()}Ho(){Wz.instance.Xb();ab.StaticActiveAppFrame.za().Ge()}dispose(){}}Object(u.a)(NG,"CellShadingPackage",null,[0,1]);class Xz{constructor(){this.QUb=
new rg.a(()=>this.Dsf());this.wba={}}csi(b){return b}}Object(u.a)(Xz,"AListMarkerGalleryLoader",null,[526]);var Xt=d(1278),Yz=d(347);class yp extends Xz{constructor(){super();this.RFb=new ek.a(Ja.a.vh())}csi(b){yp.GT||this.NSo();b in yp.GT&&(b=yp.GT[b]);return b}Dsf(){const b={};b["0"]=new Br(Box4Intl.Box4Strings.L_ListStyleNone,Xt.a.HTi);b["1"]=new Br(String.fromCharCode(61623),"Symbol");b["2"]=new Br(String.fromCharCode(111),"Courier New");b["3"]=new Br(String.fromCharCode(61607),"Wingdings");b["4"]=
new Br(String.fromCharCode(9643),"Courier New");b["5"]=new Br(String.fromCharCode(61611),"Wingdings");b["6"]=new Br(String.fromCharCode(61614),"Symbol");b["7"]=new Br(String.fromCharCode(61483),"Symbol");b["8"]=new Br(String.fromCharCode(61485),"Symbol");b["9"]=new Br(String.fromCharCode(9830),"Courier New");b["10"]=new Br(String.fromCharCode(61664),"Symbol");b["11"]=new Br(String.fromCharCode(61558),"Wingdings");b["12"]=new Br(String.fromCharCode(61656),"Wingdings");b["13"]=new Br(String.fromCharCode(61514),
"Wingdings");b["14"]=new Br(String.fromCharCode(61516),"Wingdings");b["15"]=new Br(String.fromCharCode(61692),"Wingdings");b["16"]=new Br(String.fromCharCode(61691),"Wingdings");b["17"]=new Br(String.fromCharCode(61553),"Wingdings");return b}BEe(b){b&&b.length&&this.tlf(b)}Okg(){if(this.wba){var b=Yz.a(this.wba),h=b.length;for(let r=0;r<h;r++){const A=this.wba[b[r]];this.RFb.add(A.levelText+"_"+A.font)}}}tlf(b){this.Okg();for(const h of b)if(h&&!h.Uz&&h.YAa&&h.K5c&&(b=h.levelText+"_"+h.font,!this.RFb.contains(b))){const r=
Yz.a(this.wba).length+Yz.a(this.QUb.value).length+"";this.wba[r]=new Br(h.levelText,h.font);this.RFb.add(b)}}NSo(){yp.GT={};yp.GT["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;yp.GT["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;yp.GT["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;yp.GT["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;yp.GT["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;yp.GT["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;yp.GT["Symbol 0x002b"]=
Box4Intl.Box4Strings.L_PlusSign;yp.GT["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;yp.GT["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;yp.GT["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;yp.GT["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;yp.GT["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;yp.GT["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;yp.GT["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;yp.GT["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;
yp.GT["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;yp.GT["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}yp.GT=null;Object(u.a)(yp,"ListMarkerBulletLoader",Xz,[]);class Rr{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(u.a)(Rr,"InfoAtLevel",null,[]);class hx{constructor(b){this.YA=b}get font(){return"Calibri"}get listStyle(){return 42}get Jx(){return"left"}get oqe(){return this.YA?this.Ugo():this.Wgo()}get nbd(){return this.YA?this.Vgo():null}get levelText(){return""}Ysm(b){switch(b){case 1:return"1";
case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Ugo(){let b="";for(let h=0;3>h;h++)b+=this.h4c(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',hx.FHf(),b)}Vgo(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new Rr,{textAtLevel:this.rEi(h),styleAtLevel:this.tMm(h)}));return b}Wgo(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',hx.GHf(),Box4Intl.Box4Strings.L_ListStyleNone)}rEi(b){b=
this.YA.obd[b];for(let h=0;9>h;h++)b=F.a.replaceAll(b,"%"+(h+1),this.Ysm(this.YA.TUb[h]));return b}tMm(b){const h={};h.fontFamily=6===this.YA.TUb[b]?this.YA.NJa[b]:this.font;return h}h4c(b){const h=this.rEi(b),r=new Sys.StringBuilder;6===this.YA.TUb[b]&&r.append(String.format("font-family:{0};",this.YA.NJa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static FHf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static GHf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(hx,"ListMarkerMultilevel",null,[497]);var GE=d(1294);class HE extends Xz{constructor(){super()}Dsf(){const b=new GE.a,h={};h["0"]=new hx(null);h["1"]=new hx(b.$rf());h["2"]=new hx(b.Rsf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new hx(b.d9h([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}BEe(){}}Object(u.a)(HE,"ListMarkerMultilevelLoader",Xz,[]);var Qo=d(188);class Sr{constructor(b,h){this.YA=null;this.levelText=b;this.aGd=h}get font(){return"Calibri"}get listStyle(){return this.aGd}get Jx(){switch(this.aGd){case 3:case 5:return"right";default:return"left"}}get oqe(){switch(this.aGd){case 1:return this.fuc("1",
"2","3");case 2:return this.fuc("a","b","c");case 3:return this.fuc("i","ii","iii");case 4:return this.fuc("A","B","C");case 5:return this.fuc("I","II","III");case 0:return this.Xgo();default:return this.fuc("1","2","3")}}get nbd(){const b=[],h={};h.fontFamily=Qo.FontUtils.kza(this.font);switch(this.aGd){case 1:return b.push(Object.assign(new Rr,{textAtLevel:this.C_("1"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("2"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new Rr,{textAtLevel:this.C_("a"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("b"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new Rr,{textAtLevel:this.C_("i"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("ii"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new Rr,
{textAtLevel:this.C_("A"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("B"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new Rr,{textAtLevel:this.C_("I"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("II"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new Rr,{textAtLevel:this.C_("1"),
styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("2"),styleAtLevel:h})),b.push(Object.assign(new Rr,{textAtLevel:this.C_("3"),styleAtLevel:h})),b}}fuc(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Sr.FHf(),this.h4c(b),this.h4c(h),this.h4c(r))}Xgo(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Sr.GHf(),Box4Intl.Box4Strings.L_ListStyleNone)}h4c(b){b=this.C_(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}C_(b){return F.a.replaceAll(this.levelText,"%1",b)}static FHf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static GHf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Sr,"ListMarkerNumbering",null,[497]);class OG extends Xz{constructor(){super();this.RFb=new ek.a(Ja.a.vh())}Qsn(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Dsf(){const b=
{};b["0"]=new Sr(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Sr("%1.",5);b["2"]=new Sr("%1.",4);b["3"]=new Sr("%1.",1);b["4"]=new Sr("%1.",2);b["5"]=new Sr("%1.",3);b["6"]=new Sr("%1)",5);b["7"]=new Sr("%1)",4);b["8"]=new Sr("%1)",1);b["9"]=new Sr("%1)",2);b["10"]=new Sr("%1)",3);b["11"]=new Sr("(%1)",5);b["12"]=new Sr("(%1)",4);b["13"]=new Sr("(%1)",1);b["14"]=new Sr("(%1)",2);b["15"]=new Sr("(%1)",3);return b}BEe(b){b&&b.length&&this.tlf(b)}Okg(){if(this.wba){var b=Yz.a(this.wba),h=b.length;
for(let r=0;r<h;r++){const A=this.wba[b[r]];this.RFb.add(A.levelText+"_"+A.listStyle)}}}tlf(b){this.Okg();for(const h of b)if(h&&h.Uz&&h.YAa&&this.Qsn(h.levelText)&&h.listStyle&&(b=Xt.a.TEf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.RFb.contains(r)){const A=Yz.a(this.wba).length+Yz.a(this.QUb.value).length+"";this.wba[A]=new Sr(b,h.listStyle)}this.RFb.add(r)}}}Object(u.a)(OG,"ListMarkerNumberingLoader",Xz,[]);class qB{constructor(){this.Z=null}get name(){return"Box4.ListMarker"}init(){pi.Xb()}dispose(){}wc(b){this.Z=
b;this.Z.ia("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new yp).ha();this.Z.ia("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new OG).ha();this.Z.ia("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new HE).ha()}static main(){E.a.instance.Mc(new qB)}}Object(u.a)(qB,"Box4ListMarkerPackage",null,[0,1]);class Zp{static get mh(){return Dg.a.uy(Zp.lo,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}Zp.lo="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(u.a)(Zp,"DefineNewBulletDialogHtml",null,[]);class Yt extends Dg.a{constructor(b,h,r,A){super();this.KKc=this.UZe=this.G8b=this.x8b=null;this.zGb=0;this.zTc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.XQi=!0;this.wPl=L=>{if(this.x8b&&L.target!==this.x8b){const Z=this.focusManager.$t();Z&&Z.Uk&&(Z.Uk.iA(L.target),this.x8b=L.target)}this.R3n(L.target.id)};this.fBn=L=>{L=L.Df;if(!this.H3i(L))return!1;this.focusManager.$t().Uk.iA(L);L.focus();return!0};this.gBn=L=>{var Z=
L.Df;if(!this.H3i(Z))return!1;var oa=Z.id;oa=parseInt(oa.substr(oa.lastIndexOf("_")+1))-this.zGb;if(L.Lb.ctrlKey||L.Lb.altKey||L.Lb.keyCode>=jf.a.B3b&&L.Lb.keyCode<=jf.a.C3b)return!1;const Ba=L.Lb.keyCode;if(L.eventName===od.a.ij){L=-1;if(Ba===Sys.UI.Key.enter)return this.focusManager.$t().Uk.iA(Z),Z.focus(),this.clj(Z.id),this.hide(),!0;Ba===Sys.UI.Key.up?L=oa-17:Ba===Sys.UI.Key.down?L=oa+17:Ba===Sys.UI.Key.left?L=y.AFrameworkApplication.isRtl?oa+1:oa-1:Ba===Sys.UI.Key.right&&(L=y.AFrameworkApplication.isRtl?
oa-1:oa+1);0<=L&&(Z=this.ZAi(Yt.hgc+"_"+(L+this.zGb)))&&Z.focus()}return!0};this.vPl=L=>{1===L&&this.clj(this.G8b);this.hide()};this.zv=b;this.focusManager=h;this.ga=r;this.TV=!1;A&&(b=A.indexOf(","),-1!==b&&(A=A.substring(0,b)));this.fontName=A;this.Ig="DefineNewBulletDialog";this.mh=Zp.mh;this.Ke(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ke(0,CommonUIStrings.l_DialogClose);this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.vPl,null);this.vda=!1;this.bNa();document.getElementById(Yt.E3d).focus()}bNa(){this.focusManager.$t().scope.ot(Sg.FocusManager.instance().BZ);
this.focusManager.$t().scope.ot(Sg.FocusManager.instance().CZ);this.focusManager.$t().scope.bindAction(Sg.FocusManager.instance().BZ,vb.a.CZd);this.focusManager.$t().scope.bindAction(Sg.FocusManager.instance().CZ,vb.a.BZd)}Jba(){this.BTd(Yt.E3d,"DefineNewBulletFontPlaceholder",vb.a.AZd.toString(),vb.a.mYb.toString(),vb.a.nhd.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.pgl()}JN(){super.JN();document.getElementById(this.Bj("WACDialogPanel")).style.width="auto"}BTd(b,h,r,A,L,Z,oa){r=Ak.c(b,
r,!0,!0,A,L,F.a.yf(Z),!0,oa);this.bYd(b,h,r,"Medium")}pgl(){const b=document.getElementById(Yt.hgc);b&&(b.innerHTML=this.zwi(),this.GAj(b))}GAj(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)zc.a.addHandler(b[h],od.a.focus,this.wPl)}Bxp(){var b=document.getElementById(Yt.hgc);if(b){let h=this.fontName;const r=Xt.a.oWf(this.fontName);r&&61472!==this.zGb||!r&&32!==this.zGb?(b.innerHTML=this.zwi(),this.GAj(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.RNh(h),b[0].style.fontFamily=h)}}R3n(b){this.FOj(this.G8b,!1);this.G8b=b;this.FOj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.G8b){let h=parseInt(this.G8b.substr(this.G8b.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.zGb?61440:0,b.innerText=F.a.JJ(h,4))}}FOj(b,h){(b=this.ZAi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}ZAi(b){const h=document.getElementById(Yt.hgc);return h?h.querySelector("#"+b):null}Lqa(){const b=document.getElementById(Yt.hgc);
b&&(this.UZe||(this.UZe=this.fBn,this.rr.ub(od.a.click,b,this.UZe)),this.KKc||(this.KKc=this.gBn,this.oe.ub(od.a.ij,b,this.KKc),this.oe.ub(od.a.lv,b,this.KKc),this.oe.ub(od.a.gi,b,this.KKc)));super.Lqa()}H3i(b){return b.classList.contains("DefineNewBulletTableCell")}clj(b){if(b){b=b.split("_");const h=new lj.DictionaryPropertySet;h.setValue(Od.a.JL,parseInt(b[1]));h.setValue(Ke.a.font,this.fontName);h.setValue(Od.a.cC,1);h.setValue(Ge.a.Cta,"command-ui");h.setValue(Ge.a.qma,"define-new-bullet-dialog");
this.ga.Qb(vb.a.$E,2,h)}this.focusManager.EN(this.aN,!0)}zwi(){const b=new Sys.StringBuilder,h=Xt.a.oWf(this.fontName);let r=this.fontName;r=this.RNh(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.zGb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.zGb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}RNh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}bYd(b,h,r,A){h=document.getElementById(h);this.zv.r5a(b,r);r=this.zv.OPb(b,A);h.appendChild(r);this.zv.tua(b)}dispose(){this.TV||(this.zv.B0(Yt.E3d),this.TV=!0);super.dispose()}}Yt.E3d="DefineNewBulletFontStyleComboBox";Yt.hgc="DefineNewBulletTableContainer";Object(u.a)(Yt,"DefineNewBulletDialog",Dg.a,[]);class IE{C3c(){return vb.a.aBn}g4c(){return vb.a.gkg}}Object(u.a)(IE,"ListMarkerGalleryBulletCommands",
null,[605]);class PG{C3c(){return vb.a.cBn}g4c(){return vb.a.Zdo}}Object(u.a)(PG,"ListMarkerGalleryMultilevelCommands",null,[605]);class AJ{C3c(){return vb.a.dBn}g4c(){return vb.a.hkg}}Object(u.a)(AJ,"ListMarkerGalleryNumberingCommands",null,[605]);class zp{constructor(b,h,r,A,L){this.yFa=this.vRa=null;this.Adi=Z=>{if(!this.yFa)return 2;if(this.yFa.focusManager.$t().Uk.tra.id.startsWith(Yt.hgc)){let oa=null;Z===vb.a.CZd?oa=this.yFa.a6a:Z===vb.a.BZd&&(oa=document.getElementById(Yt.E3d));if(!oa)return 2;
this.yFa.focusManager.$t().Uk.iA(oa);oa.focus()}else if(Z===vb.a.CZd)this.yFa.focusManager.$t().urc();else if(Z===vb.a.BZd)this.yFa.focusManager.$t().rrc();else return 2;return 32};this.T6i=(Z,oa)=>{Z=null;oa.view.ve&&(Z=oa.view);return Z&&Z.lb?32:(Uc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",oa.toString()),8)};this.Nyn=(Z,oa,Ba)=>1===Ba?32:2===Ba?(Z=this.Jkc(oa),Z=Ya.FormattingReader.Vs(Z).cache.pI,this.yFa=
new Yt(this.FOk,Sg.FocusManager.instance(),y.AFrameworkApplication.va,Z),32):8;this.nhd=(Z,oa,Ba,gb,Ab)=>{if(1===Ba)return 32;if(2===Ba&&!Ab)return 8;if(this.yFa.XQi){for(Z=0;Z<Xt.a.zTc.length;Z++)Qo.FontUtils.s4j(Xt.a.zTc[Z]);this.yFa.XQi=!1}Pn.a.lbe(oa);Ab.PopulationXML=Qo.FontUtils.Iri(Pn.a.Kye,Pn.a.pEf,vb.a.AZd);return 32};this.Ydo=(Z,oa,Ba,gb,Ab)=>{Z=oa.contextId===kc.a.eS;if(1===Ba||!Z)return Z?32:8;if(2===Ba&&!Ab)return 8;Ab.MenuItems=this.RDk.Vym();return 32};this.uPl=(Z,oa,Ba,gb,Ab)=>{if(1===
Ba)return 32;if(2===Ba){Z=Object(Ca.a)(444,Ab);if(!Z||!Z.rd)return 8;this.yFa.fontName=Z.rd.fontName;this.yFa.Bxp();return 32}return 8};this.ga=b;this.lg=A.resolve("Box4.List.IListReader");this.a$=h;this.FOk=r;switch(this.a$){case 0:b=A.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.vRa=new IE;break;case 1:b=A.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.vRa=new AJ;break;case 2:b=A.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.vRa=new PG;break;
default:b=A.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.vRa=new IE}L=this.lg?this.lg.Iym(L):null;b.BEe(L);this.RDk=new Xt.a(h,b,L,!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.NTb)}Xb(){this.ga.qa(this.vRa.g4c(),kc.a.view,ed.a.Y_a.y9h(11));this.ga.qa(this.vRa.g4c(),kc.a.eS,this.Ydo);this.ga.Pc(this.vRa.g4c(),1124);this.a$||(this.ga.fb(vb.a.o2f,kc.a.view,this.Nyn,1028),this.ga.fb(vb.a.nhd,kc.a.view,this.nhd,1124),this.ga.fb(vb.a.AZd,kc.a.view,this.uPl,1028),this.ga.fb(vb.a.CZd,
Gc.a.frame,this.Adi,64),this.ga.fb(vb.a.BZd,Gc.a.frame,this.Adi,64));this.ga.qa(this.vRa.C3c(),kc.a.view,this.T6i);this.ga.qa(this.vRa.C3c(),kc.a.eS,this.T6i);this.ga.Pc(this.vRa.C3c(),1124)}Jkc(b){return this.W4d(b).Qa}W4d(b){let h=null;b=b.view;return b?h=he.a.vk(b.lb.gb.K(0),!1,!1):h}}Object(u.a)(zp,"ListMarkerGalleryActor",null,[445]);class Ru{constructor(){this.Tf=this.Z=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Object(Kb.a)()){var b=Object(Kb.a)();b.Ie&&(this.Tf=b.Ie.vd,this.awo())}}dispose(){}wc(b){this.Z=
b}awo(){(new zp(y.AFrameworkApplication.va,1,this.Z.resolve("Common.IStandaloneRootController").uha,this.Z,this.Tf)).Xb();(new zp(y.AFrameworkApplication.va,0,this.Z.resolve("Common.IStandaloneRootController").uha,this.Z,this.Tf)).Xb();(new zp(y.AFrameworkApplication.va,2,this.Z.resolve("Common.IStandaloneRootController").uha,this.Z,this.Tf)).Xb()}static main(){E.a.instance.Mc(new Ru)}}Object(u.a)(Ru,"Box4ListMarkerGalleryPackage",null,[0,1]);var BJ=d(506),$x=d(646),dh=d(563),Is=d(170);const rB=b=>
{b.element.style.top=""};var Ry=d(729);class SC{constructor(b,h,r){this.AJ=!1;this.thb=0;this.wia=this.Yxh=null;this.PVn=A=>{A.element.style.top="";y.AFrameworkApplication.ua.ked()};this.HVn=A=>{A.element.parentNode.removeChild(A.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);y.AFrameworkApplication.ua.ked()};this.Tv=()=>{const A=this.Nt.entries.length,L=Sys.UI.DomElement.getBounds(this.htmlElement).height;let Z;for(let oa=0;oa<A;++oa)Z=this.Nt.entries[oa],Z.htmlElement&&Z.xGj();
this.thb=Sys.UI.DomElement.getBounds(this.htmlElement).height;L!==this.thb&&this.p2b()};this.yIa=()=>!0;this.jl=b;this.KPk=h;this.Nt=r;this.S9=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.nA=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.F7)&&!this.Nt.exf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";aa.a.nj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.S9}get visible(){return this.AJ}set_visible(b){if(this.AJ!==
b)return(this.AJ=b)?this.Oif():this.PYc(),b}dispose(){this.visible&&this.PYc();Je.a.KT(this.htmlElement);this.jl=this.S9=null}XTj(b,h){const r=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.xGj();this.thb+=b.htmlElement.clientHeight;var A=this.htmlElement.childNodes,L=b.hRh,Z=this.PVn;Is.WacAirSpace.nY(r,"Shared_BasicClass");var oa=new dh.a(r);oa.Aya(0,1);const Ba=new $x.a(r);
Ba.IHa(r.clientTop-30,r.clientTop);L?(Is.WacAirSpace.gvb(oa,null,null),Is.WacAirSpace.gvb(Ba,null,Z)):(Is.WacAirSpace.animate(oa,null,null),Is.WacAirSpace.animate(Ba,null,Z));for(h+=1;h<A.length;h++)Z=A[h],Is.WacAirSpace.nY(Z,"Shared_BasicClass"),oa=new $x.a(Z),oa.IHa(Z.clientTop-r.clientHeight,Z.clientTop),L?Is.WacAirSpace.gvb(oa,null,null):Is.WacAirSpace.animate(oa,null,null);b.X7o();this.set_visible(!0)}jOi(b){const h=b.htmlElement;if(Je.a.aoc(h)){this.thb-=b.htmlElement.clientHeight;var r=h.parentNode.children;
b=b.hRh;var A=this.HVn;Is.WacAirSpace.nY(h,"Shared_BasicClass");var L=new BJ.a(h);L.Aya(1,0);b?Is.WacAirSpace.gvb(L,null,A):Is.WacAirSpace.animate(L,null,A);A=!1;for(L=0;L<r.length;L++){if(A){const Z=r[L];Is.WacAirSpace.nY(Z,"Shared_BasicClass");const oa=new $x.a(Z);oa.IHa(Z.clientTop,-h.clientHeight);b?Is.WacAirSpace.gvb(oa,null,rB):Is.WacAirSpace.animate(oa,null,rB)}A||r[L]!==h||(A=!0)}}}Oif(){""===this.jl.style.top.trim()&&(this.jl.style.top=this.jl.offsetTop+"px");this.htmlElement.style.left=
this.jl.style.left;this.htmlElement.style.top=this.jl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.Yxh=this.jl.style.top;this.thb=b.height;this.p2b();y.AFrameworkApplication.ua.a2(this.Tv);zc.a.addHandler(this.htmlElement,od.a.Uve,zc.a.dec);this.wia=this.yIa;y.AFrameworkApplication.ua.kEa.ub(this.htmlElement,this.wia,null);if(Sg.FocusManager.lM()){var h=Sg.FocusManager.instance();b=h.ie(Ry.a.BTa);
b.parent=Qf.AFrame.Gq;const r=new Jg.DOMFocusListing(()=>this.htmlElement);r.rn(1);r.rn(2);r.rn(8);h.Rqa(()=>this.htmlElement,b,r);h=h.getRegion(Ry.a.BTa);h.AZa();h.rP=!0;h.K6a=!0;const A=y.AFrameworkApplication.ua.Ky;b.jKb(()=>{A.Dx(Ry.a.BTa)});A.xW(Ry.a.BTa);(r.$ka||y.AFrameworkApplication.J.$("ReactBusinessBarIsEnabled"))&&A.QK(Ry.a.BTa)}}PYc(){this.BTj()&&(this.jl.style.top=this.Yxh);this.htmlElement.style.visibility="hidden";y.AFrameworkApplication.ua&&(Sg.FocusManager.lM()&&Sg.FocusManager.instance().jxb(Ry.a.BTa),
this.wia&&(y.AFrameworkApplication.ua.kEa.xc(this.htmlElement,this.wia),this.wia=null));zc.a.removeHandler(this.htmlElement,od.a.Uve,zc.a.dec)}p2b(){if(this.BTj()&&this.visible){var b=this.jl,h=this.thb+this.KPk;const r=Je.a.ZU(b.style.top);Is.WacAirSpace.nY(b,"Shared_BasicClass");b=new $x.a(b);b.IHa(r,h);Is.WacAirSpace.animate(b,null,null)}}BTj(){return!this.nA&&!this.Nt.exf}}Object(u.a)(SC,"BusinessBarDom",null,[2037,10]);var nv;(function(b){b[b.none=0]="none";b[b.WXp=1]="corruptPage";b[b.oYp=2]=
"currentPageStatus";b[b.BZp=3]="documentMarkedAsFinal";b[b.IZp=4]="documentSigned";b[b.j1p=5]="fileAccess";b[b.f7p=6]="kickoutWithDataLoss";b[b.LX=7]="lostSession";b[b.D8p=8]="malformedHyperlinkUris";b[b.Yhj=9]="odt";b[b.Ciq=10]="readonlyRecommended";b[b.Lkq=11]="saveReplaySuccess";b[b.Kkq=12]="saveReplayFailed";b[b.Uup=13]="unsupportedObjects";b[b.Frq=14]="word11Compat";b[b.zqq=15]="unsupportedBrowser";b[b.MUp=16]="applicationNotification";b[b.cnq=17]="skypeDocChatFailed";b[b.ymq=18]="showDialogInNewWindowInfo";
b[b.IRo=19]="sessionExpired";b[b.wen=20]="irmPolicyDescription";b[b.Bhq=21]="policyWarningMessage";b[b.kpq=22]="thirdPartyAddinDisabled";b[b.u2p=23]="gdprPrivacyNotice";b[b.FYp=24]="datacenterDecommissionWarning";b[b.y3p=25]="graphMergePrompt";b[b.yiq=26]="readOnlyDocument";b[b.jZp=27]="dictationSilence";b[b.aVp=28]="autoSensitivityLabel";b[b.Kiq=29]="recommendedSensitivityLabel";b[b.iZp=30]="dictationDebugInfo";b[b.lgq=31]="oneNoteCovid19Message";b[b.CWp=32]="citationStylePrompt";b[b.rgq=33]="oneNoteViewModeMessage";
b[b.qgq=34]="oneNotePrintImagesDownloading";b[b.pgq=35]="oneNotePagePrintReady";b[b.I6p=36]="irmPolicyCausedFeatureDisabled";b[b.F8p=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.m9p=39]="minorVersionLimit";b[b.Ioq=40]="testEntry1";b[b.Joq=41]="testEntry2";b[b.Koq=42]="testEntry3";b[b.Loq=43]="testEntry4";b[b.Moq=44]="testEntry5";b[b.Noq=45]="testEntry6";b[b.Ooq=46]="testEntry7"})(nv||(nv={}));Object(u.b)("BusinessBarId",nv);class Js{constructor(b,h=0,r=null,A=null){this.Rph=this.Xeh=!1;
this.T9b=null;this.xC=[];this.g1a=A||new SC(b,h,this);this.h9m(r)}h9m(b){if(b){this.T9b={};b=b.ranking;for(let h=0;h<b.length;h++)this.T9b[nv[b[h]]]=h}}dispose(){this.g1a.dispose();kj.a.cvg(this.xC);this.xC=null}get htmlElement(){return this.g1a.htmlElement}get visible(){return this.g1a.visible}get exf(){return this.Xeh}set exf(b){this.Xeh=b}get k_f(){return this.Rph}set k_f(b){this.Rph=b}get entries(){return this.xC}set entries(b){this.xC=b}z7(b){for(let h=0;h<this.xC.length;h++)if(this.xC[h].id===
b)return!0;return!1}Iz(b,h=!1,r=null,A=null,L=null){b.TQ=this;let Z=this.ywm(b.id);h&&!this.T9b&&(Z=0);Z<Js.zVb&&(this.g1a.XTj(b,Z),this.xC.length>=Js.zVb&&this.g1a.jOi(this.xC[Js.zVb-1]),this.g1a.p2b());Array.insert(this.xC,Z,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",nv[b.id],void 0===b.L6a||null===b.L6a?"":b.L6a);b.errorCode&&y.AFrameworkApplication.lS(b.errorCode,r,A,L)}removeEntry(b){const h=Array.indexOf(this.xC,b);-1!==h&&h<Js.zVb&&(this.xC.length>
Js.zVb&&this.g1a.XTj(this.xC[Js.zVb],Js.zVb),this.g1a.jOi(b),this.g1a.p2b());Array.remove(this.xC,b);b.TQ=null;b.dispose()}ywm(b){if(!this.T9b||0===b)return this.xC.length;b=this.T9b[nv[b]];if(void 0===b||null===b)return this.xC.length;for(let h=0;h<this.xC.length;h++)if(b<this.T9b[nv[this.xC[h].id]])return h;return this.xC.length}}Js.zVb=2;Object(u.a)(Js,"BusinessBar",null,[1984,10,1985]);class Mv{create(b,h,r){return new yg.a(b,h,r)}}Object(u.a)(Mv,"Factory",null,[2035]);class QG{static xyl(b,h){b.register(Js,
"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().Ud(()=>new Js(h.value,0,b.Oa("CommonUI.IBusinessBarRankProvider")));b.register(Mv,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(u.a)(QG,"CommonUIComponentConfiguration",null,[]);var ct=d(1680);class Su extends ct.a{constructor(){super()}static get instance(){return Su._instance||Su.nUf()}static nUf(){Su._instance=new Su;return Su._instance}}Su._instance=null;Object(u.a)(Su,"ReactRootManager",ct.a,
[431,432]);class ix extends Mj.a{constructor(){super()}get ControlType(){return 3}}Object(u.a)(ix,"CompoundButtonProps",Mj.a,[]);class RG{constructor(b,h,r,A,L,Z,oa){this.uZ=h;this.sOc=b;this.$nh=h.Uin;this.$7b=h.q$c;this.DWe=Z;this.aDd=A;this.bDd=L;this.WCd=r;this.zM=oa;this.Hib=new yc.a;this.Hib.W(1,"SpellingIssue_16x16x32");this.Hib.W(2,"GrammarIssue_16x16x32");this.Hib.W(3,"WritingIssue_16x16x32");this.Hib.W(4,null);this.Hib.W(0,null)}create(b,h,r){h=Object(Ca.a)(Vo.a,h);if(!h)return v.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const A=new Sys.StringBuilder;b=this.yAi(b);this.OXc(A,h,r,b);this.vsf(A,h);this.qJl(A,h,b);return A.toString()}RMb(b,h,r){const A=Object(Ca.a)(Vo.a,h);if(!A)return v.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.yAi(b);this.jtf(h,A,r,b);this.wsf(h,A);this.rJl(h,A,b);for(r=0;r<h.length;r++)h[r].Id=`${yr.rii}_${r}`;return h}OXc(b,h,r,A=null){h.errorType?1===h.errorType&&(this.Dhc(h)||b.append(this.plf(h,r,A))):b.append(this.sOc.build())}jtf(b,
h,r,A=null){h.errorType?1===h.errorType&&(this.Dhc(h)||b.push(this.mgl(h,r,A))):b.push(this.sOc.KXh())}vsf(b,h){const r=new Sys.StringBuilder;this.QUj(h)?r.append(Ak.a("btnIgnoreAllSpellingError",(2===h.errorType?vb.a.OOa:vb.a.Hsa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.Dhc(h)||r.append(Ak.a("btnIgrnoreSpellingError",this.qzi(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.WUj(h)&&(this.uZ.TWi&&r.append(Ak.a("btnDoNotCheckForThisIssue",
vb.a.PNb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Ak.a("btnGrammarOptions",vb.a.kwb.toString(),F.a.yf(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),b.append("</Controls></MenuSection>"))}wsf(b,h){const r=Object.assign(new hh.a,{ControlList:[]});if(this.QUj(h)){var A=zt.nD()?Object.assign(new Mj.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:vb.a.Hsa,
LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Mj.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(A)}else this.Dhc(h)||(A=Object.assign(new Mj.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.qzi(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(A));this.WUj(h)&&(this.uZ.TWi&&(h=Object.assign(new Mj.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),
h=Object.assign(new Mj.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}yAi(b){if(!this.zM)return null;b=this.zM.language(this.zM.Vs(b.Qa));return kg.a.Eg(b)?kg.a.Eg(b).name:null}qzi(b){return 2===b?vb.a.OOa:this.uZ.Wln?vb.a.h4m:vb.a.eBa}qJl(b,h,r=null){if(this.uAg(h)){var A=F.a.yf(h.wu.CategoryTitle);A=Ak.m(yr.juc,Za.a.yqa,this.Hib.K(h.proofingType),""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.aDd,this.bDd);A=Ak.d("cgProofingOuter",
[A]);b.clear();b.append(Ak.g("msProofingOuter",A,"Menu16",void 0,void 0,r,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}rJl(b,h,r=null){if(this.uAg(h)){var A=F.a.yf(h.wu.CategoryTitle);r=Object.assign(new ni.a,{ExternalId:String.format("{0}_{1}",yr.juc,h.proofingType),Command:Za.a.yqa.toString(),Image16by16Class:this.Hib.K(h.proofingType),LabelText:""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
Lang:r,Menu:Object.assign(new Ee.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Aim(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);A=Object.assign(new hh.a,{ControlList:[]});A.ControlList.push(r);b.push(A);v.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}plf(b,h,r=null){const A=this.qrm(b);
var L=[];let Z=!1;var oa=b.wu.Suggestions;if(oa)if(oa=oa.slice(0,Math.min(3,oa.length)),this.$nh&&(Z=!Me.a.any(oa,Ba=>!Ba||!Ba.Description)),1!==oa.length||oa[0].Action){let Ba=0,gb=null;Z&&(gb="font-weight: bold;");for(const Ab of oa){if(!Ab)continue;oa=null;let Jb="";const Tb=F.a.yf(Ab.Text);Z&&(oa=this.Vti(Ab.Description),Jb=this.Uti(Ab.Description));L.push(Ak.a("btnCorrectWord"+Ba,h[Ba].toString(),Tb,null,null,null,null,null,gb,null,oa,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,
A,Tb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.K7h(b.token)),"ariaDescribedById",Jb));Ba++}}else h=F.a.yf(oa[0].Text),L.push(Ak.a("btnCorrectWord0",vb.a.OOa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,A,h)));h="Menu16";0<L.length?Z&&(h="Menu16DescriptionEnabled"):L=[Ak.a("btnNoSuggestions",vb.a.OOa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,
null)];return Ak.g("msUnknownWord",Ak.d(null,L),h,A,this.Xzm(b),r,"ariaLabelledById")}mgl(b,h,r=null){var A=1!==b.proofingType&&0!==b.proofingType?b.wu.ExplanationTitle:"";A=Object.assign(new hh.a,{Title:A,Lang:r,ControlList:[]});let L=!1;var Z=b.wu.Suggestions;if(Z)if(Z=Z.slice(0,Math.min(3,Z.length)),this.$nh&&(L=!Me.a.any(Z,oa=>!oa||!oa.Description)),1!==Z.length||Z[0].Action){let oa=0;for(const Ba of Z){if(!Ba)continue;Z=null;let gb="";L&&(Z=this.Vti(Ba.Description),gb=this.Uti(Ba.Description));
if(oa>=h.length)break;Z?(Z=Object.assign(new ix,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",oa,b.proofingType),Command:h[oa].toString(),LabelText:Ba.Text,Description:Z,Lang:r,AriaDescription:gb}),A.ControlList.push(Z)):(Z=Object.assign(new Mj.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",oa,b.proofingType),Command:h[oa].toString(),LabelText:Ba.Text,Lang:r,RoleInMenu:"menuitem"}),A.ControlList.push(Z));oa++}}else b=Z[0],b=Object.assign(new Mj.a,{ExternalId:"NoSuggestion",
Command:vb.a.OOa.toString(),LabelText:b.Text}),A.ControlList.push(b);0>=A.ControlList.length&&A.ControlList.push(Object.assign(new Mj.a,{ExternalId:"btnNoSuggestions",Command:vb.a.OOa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return A}qrm(b){return F.a.yf(0!==b.proofingType?b.wu.ExplanationTitle:"")}Xzm(b){return this.uAg(b)?null:this.Hib.K(b.proofingType)}uAg(b){return this.$7b&&2!==b.errorType&&(1!==b.errorType||!this.Dhc(b))}QUj(b){return this.DWe&&!!b.errorType&&1===b.proofingType&&
!this.Dhc(b)}Aim(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.K7h(b.token)):""}WUj(b){return this.uZ.Vee&&this.$7b&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}Dhc(b){return!!b.errorType&&!!this.WCd&&this.WCd.contains(b.token,b.lcid)}Vti(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}Uti(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
b):""}K7h(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(u.a)(RG,"EditorServiceProofingContextMenuCreator",null,[]);class SG{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(u.a)(SG,"BusinessBarRankProvider",null,[434]);class sB{constructor(){this.Z=null}get name(){return"Wonca.UI"}wc(b){this.Z=b;b.ia("CommonUI.IBusinessBarRankProvider",()=>
new SG).ha();QG.xyl(b,new rg.a(()=>ab.StaticActiveAppFrame.za().Kka));b.ia("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new RG(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),y.AFrameworkApplication.Bfa,y.AFrameworkApplication.Lr,y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).ha();b.ia("CommandUI.ReactRootManager",()=>Su.instance).as("Common.IReactRootManager").ha()}init(){this.Z.resolve("Wonca.IRibbonUserFactory");
this.Z.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){E.a.instance.Mc(new sB)}}Object(u.a)(sB,"WoncaUIPackage",null,[0,1]);class TG{constructor(b){this.sQ=this.vMc=null;this.Ep=b}get key(){return"BOOKMARK"}get Fv(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get TO(){return this.sQ}reset(b){this.sQ=b.node}rEa(b){let h=null;if(this.vMc&&this.Ep.nWi(b,this.TO,this.vMc))return h=Object.assign(new UA.a,{dG:this.key,contentObject:this.vMc}),{returnValue:!0,JG:h};this.vMc=null;if(!this.TO.hasBookmark)return{returnValue:!1,
JG:h};const r=new hb.a;r.set(this.TO.Hj());this.Ep.Fdd(r);if(this.Ep.Yfn(r)){let A=r.je();for(;A;){if(this.Ep.nWi(b,this.TO,A))return this.vMc=A,h=Object.assign(new UA.a,{dG:this.key,contentObject:A,description:this.mVa()}),{returnValue:!0,JG:h};A=r.Tk()}}return{returnValue:!1,JG:h}}mVa(){return null}}Object(u.a)(TG,"BookmarkDetailsProvider",null,[299,300]);class UG{constructor(b,h,r,A,L=null){this.xnh=this.vi=!1;this.fHd=this.HId=null;this.jjj=(Z,oa)=>{Z=oa.node;Z.sc!==Ln.a.Kya?v.ULS.sendTraceTag(24155018,
324,10,"node.RuntimeClassId = {0}",Z.sc):(v.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.Yji(!0))};this.AG=r;this.tk=A;this.zz=h;this.e$g=b;this.FV=L}get nv(){return this.zz.value}initialize(){this.Ppg();this.vi=!0}Yji(b=!1){if(!this.vi)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.xnh)return!0;let h=!1;this.tk.le(()=>{this.HId={};this.fHd={};if(this.nv){const r=new hb.a;r.set(this.nv);if(this.LPn(r)){if(r.Vb(1)){do this.rYk(r.currentNode);
while(r.Kf(1))}h=this.xnh=!0}}},"BGM:EBGL");return h}mAa(b){return this.Yji()?b in this.fHd?this.fHd[b]:null:null}dispose(){this.vi?this.Ttp():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}LPn(b){if(this.AG.ZR(b))return(b=b.Vb(30))||v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}Ppg(){v.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");
this.e$g.GPh(this.jjj)}Ttp(){v.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.e$g.ODj(this.jjj)}rYk(b){var h,r,A,L;b?(this.CNh(null!==(r=this.FV.Jmb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:Q.a.nil,b),this.CNh(null!==(L=this.FV.Bdc.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==L?L:Q.a.nil,b),(h=b.properties.ka(Vc.a.tu,null))&&(this.fHd[h]=b)):v.ULS.sendTraceTag(24155022,324,50,"Node is null")}CNh(b,h){b===Q.a.nil?v.ULS.sendTraceTag(24155023,
324,50,"paraNodeId is null"):(b=b.toString(),b in this.HId||(this.HId[b]=new nb.a),b=this.HId[b],b.contains(h)||b.add(h))}}Object(u.a)(UG,"BookmarkGraphManager",null,[436]);var VG=d(821),CJ=d(1108);class jx{create(){return new CJ.a}}Object(u.a)(jx,"BookmarkContainerNodeFactory",null,[284]);class TC{constructor(b,h,r,A=null){this.A1n=(L,Z)=>{this.Ep.jmj(Z)};this.rfd=(L,Z)=>{var oa=this.Jni(Z.clone);L=Z.original.Hc;const Ba=new Ha.a;for(const gb of oa)oa=gb.uo.toString(),Ba.tb(oa)||(Ba.add(oa,!0),(oa=
L.Eb(gb.uo))&&!oa.anchor&&(oa=this.Ep.wPb(gb.uo)),oa?oa.anchor?this.vCl(oa,Z.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",oa.id,oa.ka(Vc.a.$Kb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.nfg=(L,Z)=>{L=Z.clone;Z=this.Jni(L);this.Ep.mkd(L,Z)};this.GG=h;this.Ep=r;this.dpk=A||new jx}init(){VG.a.Qto(Object(D.a)(this.Ep,this.Ep.xcg,"onAfterFullBookmarkRangeDeleted"));this.GG.wff(this.A1n);bp.a.nRd(this.rfd);bp.a.oRd(this.nfg)}Jni(b){const h=
new nb.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.Ub(r);if(A.Ch)for(let L=0;L<A.Ch.length;L++)h.add(A.Ch.K(L))}return h}vCl(b,h){var r=h.Hj().ud;r=$e.b(b,r,!0);h=hb.a.eb(h);this.X0l(h);h.Vb(30);h.d6(r,1,b.id);h.Yj(r)}X0l(b){if(b.zb(25)&&b.kd(25)&&!b.zu(30)){const h=this.dpk.create(Ln.a.Kya);b.Wf(h,30)}}}Object(u.a)(TC,"BookmarksEventHandler",null,[]);var Bt=d(240),DJ=d(1065),ov=d(211),WG=d(413),EJ=d(1156),XG=d(125),FJ=d(1067);class YG{create(){return new FJ.a}}Object(u.a)(YG,"BookmarkNodeFactory",
null,[284]);class Zz{constructor(b,h){this.qea=b;this.jpk=h}get BYb(){return this.jpk}}Object(u.a)(Zz,"FoundBookmarkRangeObject",null,[489]);class GJ{constructor(b,h,r,A,L,Z,oa,Ba=null,gb,Ab=null){this.Kia="_";this.y2a="OLE_LINK";this.h$g=40;this.BOk=" ";this.zz=b;this.AG=h;this.Rd=r;this.IZe=A;this.Rc=L;this.hb=Z;this.ib=oa;this.ipk=Ba||new YG;this.FV=Ab}Y3c(b,h){return b?this.FV.Jmb.get(null===h||void 0===h?void 0:h.toString()):this.FV.Bdc.get(null===h||void 0===h?void 0:h.toString())}get nv(){return this.zz.value}get I0a(){return this.IZe.value}tdf(b,
h){if(!h||!h.Qa||!h.Xc)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=h.Qa.node,A=h.Xc.node,L=Bt.a.Hqb(h,!0);h=Bt.a.Hqb(h,!1);return this.Tbc(b,L,h,r,A)}Tbc(b,h,r,A,L,Z=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",Z));const oa=this.mAa(b);if(oa)if(Z)this.GBj(oa);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!A||!L)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;Z=this.Rc.Lc(15);Z.Ab(this.I0a);DJ.a.Nod&&(Z.Ph=Ec.a.DIa);b=this.hVk(b);if(!b)return!1;this.eVk(A,h,b,L,r);Z.dispose();return!0}mAa(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.Mni(h=>b===h.properties.ka(Vc.a.tu,null))}wPb(b){return b&&b!==Q.a.nil?this.Mni(h=>b.equals(h.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}xcg(b){const h=this.wPb(b);h?(v.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),
this.FBj(h),this.lkd(h)):v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}nAa(b,h){var r;const A=null!==(r=this.Y3c(h,b.id))&&void 0!==r?r:Q.a.nil;if(A===Q.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Zz(null,2);r=this.nv.ud.Eb(A);return r?r.isConnected?this.getBookmarkRange(r,b,h):(v.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Zz(null,3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new Zz(null,2))}jmj(b){const h=this.Z9l(b);h[Symbol.iterator]().next().done||this.GPn(b,h)}mkd(b,h){const r=new nb.a;let A=0,L=!1;for(const Z of h)Z&&Z.Ib.Ch?(A++,Z.Ib.Ch.remove(Z),0<=Z.te&&Z.te<b.qe.length&&(Z.Ib.cp||(L=!0),r.add(Z.te))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.fna(r);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",A,r.count));L&&!b.qe.length&&b.qe.append(ov.CharacterPropertiesEditor.wN,1024)}r4d(b=
!1){var h;v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");h=new nb.a;const A=hb.a.eb(this.nv);if(null!==this.Fdd(A)){var L=A.ar();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",L);if(0<L)for(L=A.je();null!==L;){const Z=L.ka(Vc.a.tu,"");F.a.Qf(Z)||(b?h.add(L):Z.startsWith(this.Kia)||r&&Z.startsWith(this.y2a)||h.add(L));L=A.Tk()}}!b&&0<h.count&&v.ULS.sendTraceTag(556889755,
3029,50,"User Bookmarks count: {0}",h.count);return h}FYm(){return this.nv?this.Fzl():!1}Fzl(){var b;v.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",!1);const h=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.$("HideBookMarkStartingWithOleLink");b=hb.a.eb(this.nv);if(null!==this.Fdd(b)&&0<b.ar())for(var r=b.je();null!==r;){r=r.ka(Vc.a.tu,"");if(!(F.a.Qf(r)||r.startsWith(this.Kia)||h&&r.startsWith(this.y2a)))return!0;r=b.Tk()}return!1}jDi(b){var h=this.mAa(b);
b=new nb.a;if(h){var r=this.Y3c(!0,h.id);h=this.Y3c(!1,h.id);var A=this.nv.ud.Eb(r);A&&b.add(A);if(r.equals(h))return b;r=A;do(r=A=this.hb.pg(r,!1,!1,!0))&&b.add(A);while(A&&!A.id.equals(h))}else v.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist");return b}EBj(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.wPb(b);return this.GBj(b)}Gti(b){let h="";const r=b.id;b=b.characterData.split(this.BOk);for(let A=0;3>A&&A<b.length;A++)h+=
this.Kia+b[A];h.length>this.h$g&&(h=h.substring(0,this.h$g));return this.eek(h,r)}eek(b,h){const r=this.r4d(!0),A=[];let L;for(let oa=0;oa<r.count;oa++){var Z=r.K(oa);L=Z.ka(Vc.a.tu,"");Z=this.Y3c(!0,Z.id);L.startsWith(b)&&!h.equals(Z)&&A.push(L)}return 0<A.length?(A.sort((oa,Ba)=>oa.localeCompare(Ba,void 0,{numeric:!0})),(h=A[A.length-1].substring(b.length+1))?b+this.Kia+(parseInt(h)+1):b+this.Kia+1):b}hTm(b){F.a.Qf(b)?v.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):
(b=this.mAa(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.nAa(b,!0))?(b=qc.SelectionFactory.ue(b.qea.paragraph,b.qea.Ib.cp))&&this.ib.Kc(b):v.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}GBj(b){if(!b)return v.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Rc.Lc(15);h.Ab(this.I0a);
this.FBj(b);this.lkd(b);h.dispose();return!0}N5d(b,h){var r;if(!b||0>h)return v.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;const A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.$("HideBookMarkStartingWithOleLink");r=null;const L=new nb.a,Z=new nb.a;var oa=b.ra;for(var Ba=0;Ba<oa.length;Ba++){var gb=oa.Ub(Ba);if(gb.cp>h||gb.cp===h&&0<L.count)break;if(gb.Ch){var Ab=gb.Ch;if(2===Ab.length&&Ab.K(0).uo.equals(Ab.K(1).uo)&&gb.cp===h){L.add(Ab.K(0).uo.toString());
break}for(let Jb=0,Tb=Ab.length;Jb<Tb;Jb++){gb=Ab.K(Jb);const jc=b.Hc.Eb(gb.uo).ka(Vc.a.tu,"");F.a.Qf(jc)||jc.startsWith(this.Kia)||A&&jc.startsWith(this.y2a)||(gb.Wc?L.add(gb.uo.toString()):L.contains(gb.uo.toString())?L.remove(gb.uo.toString()):Z.add(gb.uo.toString()))}}}0<L.count&&(r=b.Hc.Eb(Q.a.Bf(L.K(L.count-1))));if(!r)for(h=Cd.ParagraphReader.pg(b,!0);h&&!r;){for(oa=0;oa<h.ra.length;oa++)if(Ba=h.ra.Ub(oa),Ba.Ch){Ba=Ba.Ch;for(let Jb=0,Tb=Ba.length;Jb<Tb;Jb++)Ab=Ba.K(Jb),gb=b.Hc.Eb(Ab.uo).ka(Vc.a.tu,
""),F.a.Qf(gb)||gb.startsWith(this.Kia)||A&&gb.startsWith(this.y2a)||(Ab.Wc?Z.contains(Ab.uo.toString())?Z.remove(Ab.uo.toString()):L.add(Ab.uo.toString()):L.contains(Ab.uo.toString())?L.remove(Ab.uo.toString()):Z.add(Ab.uo.toString()))}0<L.count?r=h.Hc.Eb(Q.a.Bf(L.K(L.count-1))):h=Cd.ParagraphReader.pg(h,!0)}return r}Cvp(b,h){if(null===b)return v.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.Zfn(h)||this.cYl(h))return!1;const r=this.Rc.Lc(15);r.Ab(this.I0a);this.Bvp(b,h);
r.dispose();return!0}Mni(b){if(!this.nv)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new hb.a;h.set(this.nv);if(!this.Fdd(h))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Vb(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.Kf(1));return null}getBookmarkRange(b,h,r){for(let A=0;A<b.ra.length;A++){const L=b.ra.Ub(A);if(L.Ch)for(let Z=0;Z<L.Ch.length;Z++){const oa=L.Ch.K(Z);if(oa.uo.equals(h.id)&&r===oa.Wc)return new Zz(oa,
0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ka(Vc.a.$Kb,-1),r,h.id,b.ra.length,this.eH(b));return new Zz(null,1)}Fdd(b){if(this.AG.ZR(b))return b=b.Vb(30),v.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}Z9l(b){const h=new Ha.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.Ub(r);if(A.Ch)for(let L=
0;L<A.Ch.length;L++){const Z=A.Ch.K(L),oa=Z.uo.toString();h.tb(oa)?(v.ULS.shipAssertTag(36218379,3029,Z.Wc!==h.K(oa).Wc),h.remove(oa)):h.add(oa,Z)}}return h.values}GPn(b,h){this.mkd(b,h);this.kPn(b,h)}kPn(b,h){let r=Cd.ParagraphReader.pg(b,!1,!0);b=Cd.ParagraphReader.pg(b,!0,!0);r||b?(r||this.jWh(h,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||this.jWh(h,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),
r=r||b,b=b||r,this.xej(r,h,0,!0),this.xej(b,h,b.ra.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}jWh(b,h){for(const r of b)if(h===r.Wc)return!0;return!1}xej(b,h,r,A){const L=new nb.a;r=this.MGf(b,r);for(const Z of h)Z.Wc===A&&(r?(h=this.jVk(b,A,r,Z.uo))&&L.add(h):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",A));L.count&&(b.Vm(),this.sLg(b,L),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",L.count,A)))}jVk(b,
h,r,A){const L=this.wPb(A);return L?this.udf(b,h,r,L):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",A)),null)}udf(b,h,r,A){var L;if(!A)return v.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),null;r.Ch||(r.Ch=new WG.a(r));const Z=new EJ.a(r,null,A.id,h);r.Ch.add(Z);(h?this.FV.Jmb:this.FV.Bdc).set(null===
(L=A.id)||void 0===L?void 0:L.toString(),b.id);return Z}sLg(b,h){if(h){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,A)=>r.te-A.te);for(let r=0;r<h.count;r++){const A=h.K(r);A.te?b.qe.rX(A.te-1,1024):b.qe.Nsa(A.te,1024);b.qe.Iq.W(A.te,ov.CharacterPropertiesEditor.wN);b.qe.It.W(A.te,ov.CharacterPropertiesEditor.aS)}}else v.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}MGf(b,h){if(!b||!b.ra||!b.ra.last)return null;v.ULS.shipAssertTag(36471766,3029,
h<=b.ra.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.ra.last.cp===h){var r=b.ra.length-1;if(!b.ra.Ub(r).formatting)for(var A=r-1;0<=A;A--){var L=b.ra.Ub(A);if(L.formatting){this.Rd.G0(b,r,h,L.formatting);break}}return b.ra.last}r=null;for(A=0;A<b.ra.length;A++){L=b.ra.Ub(A);if(L.cp>=h){if(L.cp>h||!L.formatting)this.Rd.G0(b,A,h,r),L=b.ra.Ub(A);L.Ch||(L.Ch=new WG.a(L));v.ULS.shipAssertTag(36471768,3029,L!==b.ra.last);return L}L.formatting&&(r=L.formatting)}return null}hVk(b){const h=
new hb.a;h.set(this.nv);if(!this.Fdd(h))return v.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.hEl(b);h.d6(b,1,null);h.Yj(b);return b}hEl(b){const h=this.ipk.create(Ln.a.Hmb);h.setValue(Vc.a.tu,b);h.setValue(Vc.a.$Kb,Sf.a.wD());return h}lkd(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",b.ka(Vc.a.$Kb,-1),b.id);var h=new hb.a;h.set(b);h.zb(64);h.Tg()}}eH(b){const h=[];let r=0;for(;b.anchor.Gr&&7!==b.type;)h[r]=XG.a[b.type],
b=b.anchor.Gr.ht.node,r++;h[r]=XG.a[b.type];return h.join(" ")}Bvp(b,h){b.setValue(Vc.a.tu,h)}FBj(b){const h=this.nAa(b,!0).qea;b=this.nAa(b,!1).qea;if(h&&b&&h.paragraph===b.paragraph){let r;this.mkd(h.paragraph,(r=new nb.a,r.add(h),r.add(b),r))}else{if(h){let r;this.mkd(h.paragraph,(r=new nb.a,r.add(h),r))}if(b){let r;this.mkd(b.paragraph,(r=new nb.a,r.add(b),r))}}}eVk(b,h,r,A,L){if(h=this.udf(b,!0,this.MGf(b,h),r)){b.Vm();var Z;this.sLg(b,(Z=new nb.a,Z.add(h),Z));(r=this.udf(A,!1,this.MGf(A,L),
r))?(A.Vm(),this.sLg(b,(Z=new nb.a,Z.add(r),Z))):v.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}kDi(b,h){var r;if(!b)return null;h=null!==(r=this.Y3c(h,b.id))&&void 0!==r?r:Q.a.nil;return b.Hc.Eb(h)?b.Hc.Eb(h):null}Yfn(b){return!!b&&64===b.uf}eig(b){var h,r;if(0===b.Fna)return!1;const A=null===(h=y.AFrameworkApplication.J)||
void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const L=b.ra.Ub(h);if(null!=L.Ch)for(let Z=0;Z<L.Ch.length;Z++){const oa=L.Ch.K(Z),Ba=b.Hc.Eb(oa.uo).uqb();if(!(F.a.Qf(Ba)||Ba.startsWith(this.Kia)||A&&Ba.startsWith(this.y2a))&&oa.Wc)return!0}}return!1}pGf(b){var h,r;const A=[];if(0===b.Fna)return A;const L=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===
r?void 0:r.length);h++){const Z=b.ra.Ub(h);if(null!=Z.Ch)for(let oa=0;oa<Z.Ch.length;oa++){const Ba=Z.Ch.K(oa),gb=b.Hc.Eb(Ba.uo),Ab=gb.uqb();F.a.Qf(Ab)||Ab.startsWith(this.Kia)||L&&Ab.startsWith(this.y2a)||!Ba.Wc||A.push(gb)}}return A}V5o(b){return b.ka(Vc.a.yI,!1)}Zfn(b){return F.a.Qf(b)?(v.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}cYl(b){return null!==this.mAa(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),
!0):!1}Hti(b,h,r){return this.getBookmarkRange(b,h,r).qea}nWi(b,h,r){if(this.V5o(r)||this.Bln(r))return!1;const A=this.kDi(r,!0),L=this.kDi(r,!1);if(A&&L&&this.hb.e$c(h,A,L)){if(h!==A&&h!==L)return!0;const Z=this.Hti(A,r,!0);if(Z&&(A!==h||Z.Ib.cp<=b)&&(r=this.Hti(L,r,!1))&&(L!==h||r.Ib.cp>=b))return!0}return!1}Bln(b){var h;b=null===b||void 0===b?void 0:b.ka(Vc.a.tu,"");const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");return!F.a.Qf(b)&&(b.startsWith(this.Kia)||
r&&b.startsWith(this.y2a))?!0:!1}}Object(u.a)(GJ,"FullBookmarkManager",null,[435]);class JE{constructor(){this.YKe=this.Zr=this.Z=null}get name(){return"WordEditor.Bookmark"}wc(b){this.Z=b;this.Zr=this.Z.resolve("Box4.INotebookManager").Tl;const h=new GJ(new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),Object(so.a)(),this.Z.resolve("Box4.ICharacterPropertiesEditor"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc.vd),Ko.a.instance,this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("Box4.SelectionManager"),
null,null,this.Z.resolve("Box4.BookmarkParagraphMapping"));this.Z.ia("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.Z.ia("WordEditor.Bookmark.BookmarksEventHandler",()=>new TC(this.Zr.qf(12),this.Z.resolve("WordEditor.ITableEditor"),this.Z.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();Fl.a.Ubk&&(this.YKe=new UG(this.Zr.qf(64),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),Object(so.a)(),Cq.a.instance,this.Z.resolve("Box4.BookmarkParagraphMapping")),
this.Z.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.YKe).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}dispose(){this.YKe.dispose()}Ho(){v.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");this.Z.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();v.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.Xto(this.Z.Ta("Box4.Accessibility.IAccessibilityContextManager"),
this.Z.resolve("WordEditor.Bookmark.FullBookmarkManager"))}Xto(b,h){b&&b.execute(r=>{r.dY(new TG(h))})}static main(){E.a.instance.Mc(new JE)}}Object(u.a)(JE,"BookmarkPackage",null,[0,1]);var nL=d(895),ZG=d(1056),$G=d(1491),Nv=d(1304);class aH extends Nv.a{constructor(b){super();this.ERk=b}get index(){return 3}run(){this.ERk()}QI(){this.r0()}}Object(u.a)(aH,"FootnoteEndnoteGraphUpdateTracker",Nv.a,[]);class UC{constructor(){this.fCd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}wc(){}init(){UC.rc.er.continueWith(()=>
{this.Ho()})}Ho(){nL.a.Upb=$G.a.instance;this.mSf()}dispose(){}mSf(){this.fCd=new aH(()=>{$G.a.instance.Yv()});ZG.a.gte(Object(D.a)(this.fCd,this.fCd.QI,"setUpdateNeeded"));Kp.a.instance.Zua(this.fCd,3)}static get rc(){return Wa.a.instance.resolve("Box4.IFeatureHelper")}}Object(u.a)(UC,"PackageManager",null,[0,1]);var KE=d(787),tB=d(245),ru=d(545),VC=d(490),uB=d(1645);class um extends Ox{constructor(){super()}get Fv(){return null}getTitle(b){b=b.psa();if(!b||!ru.a.instance.ata(b))return"";const h=
new Sys.StringBuilder,r=ru.a.instance.Qaa(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(ru.a.instance.Ijc(b));return h.toString()}}Object(u.a)(um,"FootnoteEndnoteBaseDetailsProvider",Ox,[]);class bH extends um{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get Sh(){return 7}}Object(u.a)(bH,"FootnoteEndnoteDetailsProvider",um,[]);var cH=d(1564),vB=d(1599),WC=d(1717);class wB extends um{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get Sh(){return 10}}
Object(u.a)(wB,"FootnoteEndnoteRefMarkDetailsProvider",um,[]);class $z{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe){this.fSi=(oe,ge,$d,lf,wf)=>{lf=ge.view;if(!lf.features.WAe||this.fF.iWi)return 8;const gi=lf.lb.Pg;if(!gi)return 2;if(this.xl.p2(gi))return 8;lf=oe===Ec.a.insertFootnote?1:0;var Di=this.W4d(ge);if(!Di)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;ge=!0;Di=Di.Qa;wf&&wf.Ioc&&wf.dLa&&(Di=wf.dLa,ge=!wf.keepCurrentFocus);if(1===$d&&Yj.a.iba(gi)||
!Di||!he.a.mf(Di)||this.gch.instance&&this.gch.instance.Qmn(Di)||Ic.a.CBa(Di,!0))return 8;if(1===$d)return 32;2===$d&&($d=this.rW.Xf("UserAction","InsertFootnoteEndnote"),oe=this.lwk.abn(Di,lf,oe),wf&&wf.Ioc&&(wf.hhj=oe),ge&&this.doe(oe,!0,!0),$d.stop(),this.Zd.Yu(6));return 32};this.Irc=(oe,ge,$d)=>{const lf=ge.view;if(oe===Ec.a.jeb||oe===Ec.a.Wyb){if(!lf.features.WAe)return 8}else if(!lf.features.XEg)return 8;if(!lf.lb.Pg)return 2;ge=this.Jkc(ge);return ge?oe!==Ec.a.jeb&&oe!==Ec.a.Wyb||this.IQa.eZm(ge.node,
oe===Ec.a.jeb?1:0)?1===$d?32:2===$d&&32===this.ga.Qb(Ec.a.L6,2,!0)?(this.ga.Qb(Ec.a.mag,2,oe),32):8:8:2};this.scm=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;if(2===$d){oe=this.xKm(ge);if(!oe)return 8;$d=ge=null;switch(wf){case Ec.a.jke:$d=oe.Xc;ge=this.X6b.F9d($d,1);break;case Ec.a.ike:$d=oe.Xc;ge=this.X6b.F9d($d,0);break;case Ec.a.lke:$d=oe.Qa;ge=this.X6b.NKi($d,1);break;case Ec.a.kke:$d=oe.Qa;ge=this.X6b.NKi($d,0);break;case Ec.a.jeb:$d=oe.Qa;(ge=this.X6b.F9d($d,1,!0))||(ge=this.IQa.Pxi($d.node,1));
break;case Ec.a.Wyb:$d=oe.Qa,(ge=this.X6b.F9d($d,0,!0))||(ge=this.IQa.Pxi($d.node,0))}if(ge)this.doe(ge);else{if(!this.Sy.Qc)return 8;(wf=xl.d($d.node,$d.cpBegin))&&7===wf.Sh&&this.IQa.CKj(wf)}}return 32};this.q8o=(oe,ge,$d,lf,wf)=>1===$d?32:2===$d?(v.ULS.shipAssertTag(4520066,308,!!wf),v.ULS.shipAssertTag(4520067,308,!!wf.P6a),oe=wf.P6a,v.ULS.shipAssertTag(4520068,308,this.uG.ata(oe)),this.doe(oe,wf.oye)?32:8):32;this.r8o=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;2===$d&&(oe=wf.Faa,wf=wf.vcm)&&(this.Qwa.zhc(),
ge=this.uG.itb(oe),wf.title=this.uG.$tm(oe)+(ge?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.Zbb=(oe,ge,$d,lf,wf)=>2===$d?(v.ULS.shipAssertTag(4520069,308,!!wf),v.ULS.shipAssertTag(4520070,308,!!wf.P6a),v.ULS.shipAssertTag(4520071,308,Cd.ParagraphReader.Wb(wf.P6a)),oe=this.uG.V8a(wf.P6a),this.doe(oe,wf.oye)?32:8):32;this.OUo=(oe,ge,$d)=>{2===$d&&this.fF.E0();return 32};this.pVl=(oe,ge,$d,lf,wf)=>{if(1===
$d)return 32;if(2===$d)return void 0!==wf&&null!==wf?this.fF.Owf(wf,wf):this.fF.Owf(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.$yn=(oe,ge,$d)=>{oe=this.Jkc(ge);return oe&&he.a.mf(oe)?1===$d?32:2===$d?($d=0<this.Sp.J2(oe.node).Qu,this.fF.gsf(),this.fF.dialog.Irb=$d,32):8:(v.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.qcm=(oe,ge,$d)=>1===$d?32:2===$d?(this.fF.dialog.Irb=!1,32):8;this.glo=(oe,ge,$d,lf,wf)=>
this.hqi(oe,$d,wf);this.elo=(oe,ge,$d,lf,wf)=>1===$d?32:this.fF.dialog&&this.fF.dialog.fontName?(wf[xb.a.Value]=this.fF.dialog.fontName,32):this.zsk.SUa(vb.a.mYb.toString(),wf,null)?32:8;this.pcm=(oe,ge,$d)=>1===$d?32:2===$d?(this.fF.dialog.Irb=!0,32):8;this.flo=(oe,ge,$d,lf,wf)=>this.hqi(oe,$d,wf);this.ncm=(oe,ge,$d)=>{if(1===$d)return 32;if(2===$d){oe=this.Jkc(ge);if(!oe)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;ge=this.uG.V8a(oe.node);this.uG.ata(ge)&&($d=
this.Rc.Lc(15),$d.Ab(ge),this.e7j(oe),this.IQa.MSh(ge,this.fF.dialog),$d.dispose());this.fF.vld();return 32}return 8};this.mcm=(oe,ge,$d)=>{if(1===$d)return 32;if(2===$d){oe=this.Jkc(ge);if(!oe)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;ge=this.uG.V8a(oe.node);this.uG.ata(ge)&&($d=this.Rc.Lc(15),$d.Ab(ge),this.e7j(oe),this.IQa.m8k(ge,this.fF.dialog),$d.dispose());this.fF.vld();return 32}return 8};this.ocm=(oe,ge,$d)=>1===$d?32:2===$d?(this.fF.vld(),32):8;this.kcm=
(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;if(2===$d){oe=Object(Ca.a)(444,wf);if(!oe||!oe.rd)return 8;this.fF.dialog.fontName=oe.rd.fontName;return 32}return 8};this.lcm=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;if(2===$d){oe=Object(Ca.a)(444,wf);if(!oe||!oe.rd)return 8;this.fF.dialog.W6b=oe.rd;return 32}return 8};this.ga=b;this.Sy=h;this.zsk=r;this.qd=A;this.uG=L;this.lwk=Z;this.IQa=oa;this.Qwa=Ba;this.fF=gb;this.Sp=Ab;this.X6b=Jb;this.Rc=Tb;this.xl=jc;this.Jb=Hc;this.rW=hd;this.Zd=Gd;this.lmk=de;this.gch=
qe}e7j(b){(b=Ya.FormattingReader.Vs(b))?(this.fF.dialog.fontName||(this.fF.dialog.fontName=b.cache.pI),-1===this.fF.dialog.fontSize&&(this.fF.dialog.W6b=b.cache.fontSize)):v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}hqi(b,h,r){return 1===h&&this.fF.dialog?32:2===h&&this.fF.dialog?(r[je.a.On]=b===Ec.a.nng?this.fF.dialog.Irb:!this.fF.dialog.Irb,32):8}Xb(){ed.a.instance.uPi([Ec.a.jke,Ec.a.ike,Ec.a.lke,Ec.a.kke,Ec.a.mag,Ec.a.jeb,Ec.a.Wyb,Ec.a.L6]);this.ga.fb(Ec.a.insertFootnote,
kc.a.view,this.fSi,4);this.ga.fb(Ec.a.insertEndnote,kc.a.view,this.fSi,4);this.ga.qa(Ec.a.jke,kc.a.view,this.Irc);this.ga.qa(Ec.a.mag,kc.a.view,this.scm);this.ga.qa(Ec.a.ike,kc.a.view,this.Irc);this.ga.qa(Ec.a.lke,kc.a.view,this.Irc);this.ga.qa(Ec.a.kke,kc.a.view,this.Irc);this.ga.qa(Ec.a.jeb,kc.a.view,this.Irc);this.ga.qa(Ec.a.Wyb,kc.a.view,this.Irc);this.ga.qa(Ec.a.gUj,kc.a.view,this.q8o);this.ga.fb(Ec.a.fqi,kc.a.view,this.pcm,4);this.ga.fb(Ec.a.nng,kc.a.view,this.flo,100);this.ga.fb(Ec.a.gqi,kc.a.view,
this.qcm,4);this.ga.fb(Ec.a.Uwj,kc.a.view,this.glo,100);this.ga.qa(Ec.a.hUj,kc.a.view,this.r8o);this.ga.fb(Ec.a.Zbb,kc.a.view,this.Zbb,96);this.ga.fb(Ec.a.J3d,kc.a.view,this.OUo,96);this.ga.qa(Ec.a.L6,kc.a.view,this.pVl);this.ga.fb(Ec.a.R5i,kc.a.view,this.$yn,4);this.ga.fb(Ec.a.cqi,kc.a.view,this.ncm,4);this.ga.fb(Ec.a.dqi,kc.a.view,this.mcm,4);this.ga.fb(Ec.a.eqi,kc.a.view,this.ocm,4);this.ga.fb(Ec.a.H3d,kc.a.view,this.kcm,4);this.ga.fb(Ec.a.Twj,kc.a.view,this.elo,100);this.ga.fb(Ec.a.I3d,kc.a.view,
this.lcm,4);this.ga.fb(Ec.a.qhd,kc.a.view,$z.qhd,100);this.ga.fb(Ec.a.rhd,kc.a.view,$z.rhd,100)}Kpg(){this.lmk.execute(b=>{b.dY(new bH);b.dY(new wB)})}Jkc(b){b=this.W4d(b);return b?b.Qa:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}W4d(b){let h=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.lb;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.gb;if(!b||
!b.length)return v.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.K(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=he.a.vk(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}xKm(b){return(b=b.view)?b.lb.gb.K(0):null}doe(b,h=!0,r=!1){if(b){this.Qwa.zhc();var A=b.esa;if(A){var L=A.Ib,Z=qc.SelectionFactory.eL(L.paragraph,L.cp,L.cp+1);L=this.Sy.Qc;if(!L)return!1;
this.qd.tha(L,Z);L.Qxb=150;L.b4();b=new VC.a(b,h);Z=tB.a.Njc(A,L);A=A.BAa(L,Z);if(!A)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||A.element?this.fF.DBg(b):(this.fF.DBg(new VC.a(b.P6a,!1)),h&&(h=new mf.a(2,1,10,()=>{this.fF.E0()}),this.Jb.$b(h)));return!0}}return!1}static Rtm(){return new $z(y.AFrameworkApplication.va,ab.StaticActiveAppFrame.za().kb,Wa.a.instance.resolve("Box4.IGeneralCuiUser"),Object(Kb.a)(),ru.a.instance,vB.a.instance,cH.a.instance,$G.a.instance,
uB.FootnoteEndnoteControlManager.instance,Wa.a.instance.resolve("Box4.IParagraphIndentationReader"),WC.a.instance,new Ko.a,Be.a.instance,zf.a.instance,y.AFrameworkApplication.ua.Vr,Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Wa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Wa.a.instance.Ta("Box4.IContentControlReader"))}static Qtm(){return $z.Rtm()}static qhd(b,h,r,A,L){if(1===r)return 32;if(2===r&&!L)return 8;Pn.a.lbe(h);L.PopulationXML=Qo.FontUtils.Iri(Pn.a.Kye,
Pn.a.pEf,Ec.a.H3d);return 32}static rhd(b,h,r,A,L){if(1===r)return 32;if(2===r&&!L)return 8;L.PopulationXML=Qo.FontUtils.Jri(Ec.a.I3d);return 32}}Object(u.a)($z,"FootnoteEndnoteActor",null,[616]);class xB extends Nv.a{constructor(b){super();this.bbf=b}get index(){return 1}run(){this.bbf()}QI(){this.r0()}}Object(u.a)(xB,"FootnoteEndnoteControlUpdateTracker",Nv.a,[]);var yB=d(360);class Ov extends yB.a{constructor(b,h,r,A,L,Z,oa){super(b,h,r,A);this.mv=()=>{this.Ksd(this.Cb)};this.xK=b.container;this.ox=
document.createElement("div");b.container.appendChild(this.ox);this.XP(this.ox);this.fLk=L;this.eo.execute(Ba=>{Ba.gY(this.mv)});this.MQa=Z;this.l$=oa;this.MQa.execute(Ba=>{Ba.Szg(this.ic,this.xK)});this.xK.style.backgroundColor=this.l$.pkc()}dispose(){super.dispose();this.eo.instance&&this.eo.instance.hNa(this.mv)}get eo(){return null!=this.HWg?this.HWg:this.HWg=Wa.a.instance.Ta("Common.IZoomManager")}OB(b){this.xK.classList.add("FootnoteEndnoteViewElement");this.Ksd(b.currentNode)}Ksd(b){this.eo.instance&&
(this.eo.instance.xud(this.ox),this.ox.style.width=Math.round(100/this.eo.instance.nl)+"%");this.fLk(b)}}Object(u.a)(Ov,"FootnoteEndnoteViewElement",yB.a,[]);class XC{constructor(){this._initialized=!1;this.yyd=this.fSe=this.Z=null;this.xcm=(b,h,r,A)=>b.U$a?new Ov(b,h,r,A,L=>{uB.FootnoteEndnoteControlManager.instance.NFo(L)},this.Z.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.Z.resolve("WordEditor.PageBackground.PageBackgroundColorHandler")):null}get name(){return"WordEditor.FootnoteEndnote"}wc(b){this.Z=
b}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){Ao.WordSectionNavigator.instance.pag=Object(D.a)(cH.a.instance,cH.a.instance.cRn,"navigateToWordSectionNodeWithFootnoteEndnote");KE.a.Hzg(this.xcm);uB.FootnoteEndnoteControlManager.instance.bind(ab.StaticActiveAppFrame.za().kG);this.fSe=$z.Qtm();this.fSe.Xb();this.fSe.Kpg();ab.StaticActiveAppFrame.za().Ge();this.mSf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,uB.FootnoteEndnoteControlManager.instance.dispose())}mSf(){this.yyd=
new xB(()=>{uB.FootnoteEndnoteControlManager.instance.Lsd()});ZG.a.gte(Object(D.a)(this.yyd,this.yyd.QI,"setUpdateNeeded"));Kp.a.instance.Zua(this.yyd,3)}}Object(u.a)(XC,"PackageManager",null,[0,1]);class HJ{constructor(b,h,r,A){this.ib=h;this.Uia=A}get bookmarkManager(){return this.Uia.value}Hmn(b){return Fl.a.Ubk?b.startsWith(F.a.T5a):!1}lWm(b){try{this.mWm(b)}catch(h){v.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}JIg(b){return{returnValue:!1,
sqg:b,v8a:""}}mWm(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.mAa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.nAa(h,!0).qea,h=this.bookmarkManager.nAa(h,!1).qea,b||h?b?this.CPj(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.CPj(h)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.w4i(!1))):(v.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.w4i(!0))}}w4i(b){b=qc.SelectionFactory.qp(ab.StaticActiveAppFrame.za().kb.hd.Jvi(),
b);this.ib.Kc(b)}CPj(b){b.paragraph&&b.Ib?(b=qc.SelectionFactory.ue(b.paragraph,b.Ib.cp),b.jVi=!0,this.ib.Kc(b)):v.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(u.a)(HJ,"InternalLinkManager",null,[440]);class dH{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}wc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new HJ(new rg.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),
b.resolve("Box4.IFeatureHelper"),new rg.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){E.a.instance.Mc(new dH)}}Object(u.a)(dH,"WordEditorInternalLinksPackage",null,[0,1]);class ay{constructor(b){this.rRa=null;this.wol=h=>{h=h.ao;if(h.anchor){db.a.mark(4763);var r=hb.a.eb(h);if(r.zb(8)&&r.kd(8)&&r.PIg(h)===h){if(fm.OutlineReader.isEmpty(r)){let A=!1;for(let L=0;L<If.a.instance.gb.length;L++){const Z=
If.a.instance.gb.K(L);for(let oa=0;oa<Z.length;oa++)if(Z.K(oa).node===h){A=!0;break}}A||this.hei(r)}db.a.mark(4764)}}};ay.jT=b}qYd(b){if(!ay.pj.Hee(b))return null;b.Vb(1)&&(b.currentNode.Xl(8,!0),b.uc());const h=ay.jT.LIl();ay.pj.isRtl(b.currentNode)?h.setValue(Ke.a.Cs,11):h.setValue(Ke.a.Cs,9);b.Wf(h,1);b.Yj(h);return h}pWo(b){if(this.rRa&&b!==this.rRa){const h=new mf.a(2,1,0,this.wol,120);h.ao=this.rRa;y.AFrameworkApplication.pc.$b(h)}this.rRa=b}hei(b){this.rRa===b.currentNode&&(this.rRa=null);
const h=new Sb.GraphTransaction(7);h.ju(b);b.Tg();h.dispose()}Y1h(){if(this.rRa&&this.rRa.anchor){const b=hb.a.eb(this.rRa);b.Ks()&&fm.OutlineReader.Z8c(b)&&this.hei(b);this.rRa=null}}static get pj(){return pl.PageReader.instance}}ay.jT=null;Object(u.a)(ay,"PageContentEditor",null,[1414]);var aA=d(1153),pv=d(614);class LE extends Dy{constructor(){super()}KSj(b,h,r,A,L){let Z=!1,oa=!0;he.a.mf(L)&&(h=sf.ListItemReader.Fg(b)&&h,L=Eb.a.UA(b,L,!1)&&!Eb.a.UA(b,L,!0),h&&r.smf(b,A)&&(Z=!0),pf.a.xd().xm&&
(L||h&&!Z)&&(oa=!1));return{JSj:oa,sbk:Z}}}Object(u.a)(LE,"CursorMoveValidator",Dy,[]);var dJ=d(216);class Ro{constructor(b,h,r,A,L){this.CI=L;this.G2e=b;this.K9=A;this.Owa=h;this.Vh=r}get Qd(){return null!=this.R5g?this.R5g:this.R5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Lj(){return null!=this.A5g?this.A5g:this.A5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Yb(){return null!=this.p7g?this.p7g:this.p7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Kg(){return null!=
this.B4g?this.B4g:this.B4g=Wa.a.instance.Oa("Box4.Styles.StyleSettings")}get Zt(){return this.K9.value}get Mf(){return this.Vh.value}get Ts(){return this.Owa}eUm(b){const h=window.performance.now(),r=new Wo.ScriptSharpLegacyMap,A=new ln.a,L=new Wo.ScriptSharpLegacyMap;if(b&&b.Ww){var Z=null;for(let oa=0;oa<b.length;oa++){const Ba=b.getContext(oa);Z=Z||Object(so.a)().Iu(Ba.node);let gb;if(!({groupId:gb}=this.Bqp(Ba.node,Z)).returnValue)continue;let Ab;r.tb(gb)||(Ab=[],r.add(gb,Ab));Ab=r.K(gb);Ab.push(Ba)}for(const oa of qm.toArray(r.keys))b=
r.K(oa),Z=new hb.a,Z.set(b[0].node),({VGj:b,$s:Z}=this.Owa.$pp(Z)).returnValue?(r.W(oa,b),L.add(oa,Z)):A.add(oa)}v.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,hUm:A,gUm:L}}ILb(b){return this.Sll(b)}$dc(b){return this.nll(b)}gUd(b,h,r=!0){return hb.a.Yea(()=>{var A=!1;if(sf.ListItemReader.Fg(b))return this.smf(b,h,r);A||(fg.OutlineElementNavigator.Me(b),A=Cd.ParagraphReader.Fh(b)||si.TableReader.isTable(b),
fg.OutlineElementNavigator.me(b),A=A&&this.Rll(b,h));return A})}smf(b,h,r=!0){return hb.a.Yea(()=>{const A=Eb.a.fKa(b),L=fm.OutlineReader.u_(b.currentNode);if(r?!this.son(b,h):!this.ton(b,h))return!1;var Z=hb.a.eb(b.currentNode);if(0<h&&Z.zb(14)){Z.kd(16);var oa=Z.currentNode;const Ba=$g.TableCellReader.zNf(Z);Z.kd(14);const gb=Z.currentNode;Z=vr.a.aP(oa,gb,Vc.a.qS,Vc.a.Ba,0);oa=vr.a.aP(oa,gb,Vc.a.oV,Vc.a.Ca,0);Z=nh.a.bA(Z,0);oa=nh.a.bA(oa,0);return A+L<Ba-Z-oa}return!0})}Rll(b,h){const r=Eb.a.fKa(b);
var A=Eb.a.qI(b);if(0<h){h=fm.OutlineReader.u_(b.currentNode);A=0;const {pageWidth:Ba,marginLeft:gb,marginRight:Ab}=Ro.w7d(b.currentNode);var L=hb.a.eb(b.currentNode);fg.OutlineElementNavigator.Me(b);if(si.TableReader.isTable(b)){A=si.TableReader.Laa(b);var Z=0;for(var oa of A)Z+=oa;A=nh.a.bA(nh.a.xf(Z,0),0)}fg.OutlineElementNavigator.me(b);return L.zb(14)?(L.kd(16),oa=L.currentNode,b=$g.TableCellReader.zNf(L),L.kd(14),Z=L.currentNode,L=vr.a.aP(oa,Z,Vc.a.qS,Vc.a.Ba,0),oa=vr.a.aP(oa,Z,Vc.a.oV,Vc.a.Ca,
0),L=nh.a.bA(L,0),oa=nh.a.bA(oa,0),r+h<b-L-oa-A):r+h<Ba-gb-Ab-A}return 0<r-A}hZa(b,h){this.aqj(b,-1*Math.abs(h))}LYc(b,h){this.aqj(b,Math.abs(h))}eTl(b,h,r,A,L){let Z=Ro.Rdj;if(h>=Ro.Rdj){Z=h-=r;const oa=A*L,Ba=Math.abs(oa),gb=Math.abs(h)%Ba;gb&&(Z=0>Z?0>A?Z+gb:Z-(Ba-gb):0<A?Z-gb:Z+(Ba-gb));Z+=oa;Z+=r;Ro.Uoe&&(r=Eb.a.J2(b),Z=Ro.Uoe.Qui(b.currentNode,h+r,Z+r,L,Z<h)-r)}return Z}Pll(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.Ewi(b[0].node,h);return this.Qll(b,h,r)}b8n(b,h,r){if(!b)return v.ULS.shipAssertTag(589345600,
338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return v.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const A=b[0].node;h=this.Ewi(A,h);if(!this.TOn(A,r[0],h)||!this.QOn(b,
h))return 8;this.Zt.P0();return 32}QOn(b,h){for(let r=0;r<b.length;r++){const A=new hb.a;A.set(b[r].node);let L=null;fg.OutlineElementNavigator.Me(A);if(Cd.ParagraphReader.Fh(A)){if(L=A.currentNode,!L)return v.ULS.shipAssertTag(589592461,338,!L,"The paraNode is null for the list OE node"),!1}else if(!Cd.ParagraphReader.Fh(A)&&!si.TableReader.isTable(A))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;A.uc();if(L){if(this.kZm(L)){const Z=
L.LA(),oa=Eb.a.fKa(A);this.Mf.PDa(A,1,oa+h);Z&&this.Lj.YP(L,Z,this.Qd.Bg)}ai.a.getInstance().du||L.setValue(Ke.a.DU,new Date)}}return!0}TOn(b,h,r){for(let A=0;A<pk.a.FI;A++){const L=this.Owa.Yy(b,h,A);if(!L)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const Z=L.getValue(Vc.a.ke);Z&&L.setValue(Vc.a.ke,Z+r)}return!0}kZm(b){return b.hasProperty(Vc.a.ke)||b.hasProperty(Vc.a.Jt)||b.hasProperty(Vc.a.uD)}nll(b){return this.gUd(b,1,!0)}Sll(b){return this.gUd(b,
-1,!0)}Ewi(b,h){var r=new hb.a;r.set(b);const A=Eb.a.fKa(r),L=Eb.a.qI(r),Z=Eb.a.J2(r);r=fm.OutlineReader.u_(b);Ro.w7d(b);b=(L?A-L:Z)%r;return h?-1*(b?b:r):r-b>Ro.Zci?Ro.Zci:r-b}Bqp(b,h){if(sf.ListItemReader.De)return h=sf.ListItemReader.nla(b),h=dJ.a.jkc(null===h||void 0===h?void 0:h.listId),{groupId:h,returnValue:null!=h};let r;const A=new hb.a;A.set(b);b=A.Vb(4).getValue(Vc.a.listID);return({id:r}=this.Owa.rAc(b,h)).returnValue?{returnValue:!0,groupId:r}:{returnValue:!1,groupId:r}}Qll(b,h,r){var A=
!1;for(let L=0;L<b.length;L++){A=b[L];const Z=new hb.a;Z.set(A.node);he.a.Ou(Z);if(!Eb.a.Mh(Z))return Ro.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.UNb}),!1;if(this.gUd(Z,h,r))A=!0;else return Ro.Ac.fc(Df.a.Ggc,{["Reason"]:gf.a.Lmf}),!1}return A}aqj(b,h){if(this.gUd(b,h,!0)){var r=!1;if(sf.ListItemReader.Fg(b)){var A=new hb.a;A.nd(b);this.Ts.q0(A);var L=A.currentNode;A.uc();r=!0;const {listId:oa,listLevel:Ba}=sf.ListItemReader.nla(b);var Z=this.oMm(oa,Ba+h);if(Z)fg.OutlineElementNavigator.Me(A),Cd.ParagraphReader.Fh(A)&&
Ro.mM.ZP(Z,A.currentNode,!1),A.uc();else{Z=null;let gb;fg.OutlineElementNavigator.Me(A);Cd.ParagraphReader.Fh(A)&&(Z=A.currentNode);A.uc();gb=Z?Z.LA():null;Z||(fg.OutlineElementNavigator.Me(A),Cd.ParagraphReader.Fh(A)&&(Z=A.currentNode),A.uc());Z&&(Z.hasProperty(Vc.a.ke)&&Z.removeProperty(Vc.a.ke),Z.hasProperty(Vc.a.Jt)&&Z.removeProperty(Vc.a.Jt));ai.a.getInstance().Ht||L.setValue(Vc.a.listLevel,Ba+h);ai.a.getInstance().du&&this.CI.A_b(Z,oa,Ba+h);ai.a.getInstance().Ht||L.removeProperty(Vc.a.j0);Z&&
gb&&(this.Lj.YP(Z,gb,this.Qd.Bg),this.Zt.P0());this.rhp(b,sf.ListItemReader.De?Z:L)}}r||(r=Eb.a.fKa(b),A=Eb.a.qI(b),L=fm.OutlineReader.u_(b.currentNode),h=this.eTl(b,r,A,h,L),this.Mf.PDa(b,1,h))}}ton(b,h){const r=Eb.a.fKa(b),A=Eb.a.qI(b),L=Eb.a.J2(b),{pageWidth:Z,marginLeft:oa,marginRight:Ba}=Ro.w7d(b.currentNode);if(0<h){if(b=Z-oa-Ba,L&&L+h+ed.a.LEa>b||r+h+ed.a.LEa>b)return!1}else if(L&&0>r+h||0>r-A+h)return!1;return!0}son(b,h){var r=this.Zt.pE(b);const A=r.level+h;if(Dv.a.Cyn<A||A<Dv.a.Z$l)return!1;
r=this.Ts.Yy(b.currentNode,r.listID,A);if(!r)return v.ULS.shipAssertTag(590700875,338,!!r),!1;if(0<h&&r.hasProperty(Vc.a.ke)){h=r.getValue(Vc.a.ke);const {pageWidth:L,marginLeft:Z,marginRight:oa}=Ro.w7d(b.currentNode);if(h+ed.a.LEa>L-Z-oa)return!1}return!0}oMm(b,h){const r=this.Yb.ro();let A,L;this.Kg.vn?(A=r.gv(),L=A.Qw):L=r.Qw;for(let oa=0;oa<L;oa++){var Z=void 0;this.Kg.vn?(Z=A.vla(oa),Z=r.nh(this.Yb.Be(Z))):Z=r.FAa(oa);if(this.Ts.Nob(Z)&&Z.ka(Vc.a.listID,this.Zt.vba+1)===b&&Z.ka(Vc.a.listLevel,
-1)===h)return Z}return null}rhp(b,h){fg.OutlineElementNavigator.Me(b);if(Cd.ParagraphReader.Fh(b)&&b.currentNode.hasProperty(Vc.a.ke)&&(h=this.Ts.Zjc(h))){if(h.hasProperty(Vc.a.Jt)){var r=h.getValue(Vc.a.Jt);this.G2e.myb(b.currentNode,r)}h.hasProperty(Vc.a.ke)&&(r=h.getValue(Vc.a.ke),this.G2e.PDa(b,1,r));h.hasProperty(Vc.a.uD)&&(h=h.getValue(Vc.a.uD),this.G2e.jha(b.currentNode,h))}fg.OutlineElementNavigator.me(b)}static get mM(){return null!=Ro.P6g?Ro.P6g:Ro.P6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Uoe(){return null!=
Ro.n2g?Ro.n2g:Ro.n2g=Wa.a.instance.Oa("WordEditor.ParagraphIndentationUtility")}static get ql(){return Ro.xv||(Ro.xv=Wa.a.instance.resolve("Box4.IParagraphEditor"))}static set ql(b){Ro.xv=b}static get Ac(){return ih.a.instance}static get qg(){return Tq.a.instance}static w7d(b){var h=Ao.WordSectionNavigator.instance.NU(b);b=Ro.qg.Jv(h);const r=Ro.qg.gN(h);h=Ro.qg.hN(h);return{pageWidth:b,marginLeft:r,marginRight:h}}}Ro.Zci=Tf.a.lD(.25);Ro.xv=null;Ro.Rdj=Tf.a.lD(-11);Object(u.a)(Ro,"OutlineElementIndentationEditor",
null,[438,439]);var YC=d(249),zB;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(zB||(zB={}));Object(u.b)("StyleTargetType",zB);class eH{constructor(b,h){this.vT=null;this.DM=h;this.lg=b}get ql(){return null!=this.W1g?this.W1g:this.W1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}get aD(){return null!=this.bWg?this.bWg:this.bWg=Wa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get tj(){return null!=this.sWg?this.sWg:this.sWg=Wa.a.instance.resolve("Box4.IFormattingEditor")}get Yb(){return null!=
this.q7g?this.q7g:this.q7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get U0(){return this.vT||(this.vT=new pv.WACStyleSet)}set U0(b){this.vT=b}get rc(){return null!=this.zVg?this.zVg:this.zVg=Wa.a.instance.Oa("Box4.IFeatureHelper")}get Kl(){return this.DM.value}get rk(){return null!=this.FXg?this.FXg:this.FXg=Wa.a.instance.Oa("Box4.IInsertionPointFormatting")}get Ebd(){return this.lg||(this.lg=Wa.a.instance.resolve("Box4.List.IListReader"))}get Cg(){return null!=this.FSg?this.FSg:this.FSg=
Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Qd(){return null!=this.h6g?this.h6g:this.h6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Lj(){return null!=this.F5g?this.F5g:this.F5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get LF(){return null!=this.TWg?this.TWg:this.TWg=Wa.a.instance.resolve("Box4.IBox4GraphWriter")}wMm(b){const h=b.node;var r=this.rk?this.rk.wui():null;if(r&&!r.equals(Q.a.nil)){if(b=h.Hc,!b||
(r=this.U0.wla(r,b))&&1!==this.Yb.JF(r))return null}else r=Ya.FormattingReader.Vs(b),r=Ya.FormattingReader.MAa(r);return r}k_o(b,h){const r=this.Yb.IF(h);r&&r.nh(this.Yb.Be(b))&&(this.hLg(h,r),this.rk&&(this.rk.xxb(),this.rk.beb(b,h)))}O7k(b,h){if(h)if(h.lPb&&0<h.lPb.length){let L=new Oa.a;for(var r of h.lPb)L.add(r);if(h.B4i){r=Ya.FormattingReader.Asi(b);const Z=[];for(var A of r)A.formatting&&A.formatting.mo&&Z.push(A.formatting.mo);if(0<Z.length){A=IC.a.gAi(Z);r=new Oa.a;for(const oa of L)(!A.hasProperty(oa)||
h.hxn&&oa===De.a.Gfb)&&r.add(oa);L=r}}this.ql.ZLb(b,!0,L)}else this.ql.ZLb(b,!0);else Uc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}ZP(b,h,r,A=!1,L=!1,Z=!1,oa=null,Ba=!1){var gb,Ab,Jb;if(Cd.ParagraphReader.Wb(h))if(b)if(this.Yb.h0(b.Ti()))if(2!==this.Yb.JF(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Tb=this.Yb.IF(h);if(Tb){var jc=this.Yb.Be(b);if(!jc)v.ULS.shipAssertTag(593506377,324,!1);else if(Tb.nh(jc)){var Hc=null,hd=A?
null:h.LA();r||((null===oa||void 0===oa?0:oa.ell)&&(null===(gb=this.rc)||void 0===gb?0:gb.isFeatureEnabled(93))?(this.O7k(h,oa),ai.a.getInstance().Ht||1!=oa.lPb.length||oa.lPb[0]!=De.a.Gfb?this.axp(h,b,oa):Hc=this.Kl.Pyj(Hc,h)):(ai.a.getInstance().Ht||(Hc=this.Kl.Pyj(Hc,h)),this.ql.ZLb(h,!0)));this.hLg(h,Tb);L&&(null===hd||void 0===hd?0:hd.hasProperty(cg.a.gx))&&hd.removeProperty(cg.a.gx);sf.ListItemReader.De&&!ai.a.getInstance().Ht&&this.XSh(b,h,Hc,Ba);(null===(Ab=this.LF)||void 0===Ab?0:Ab.vca)?
this.LF.vca(h,cg.a.gx,b.id):h.properties.setValue(cg.a.gx,b.id);(Ba||(sf.ListItemReader.De?sf.ListItemReader.isListItem(h):this.Ebd.mfa(h)))&&(null===(Jb=this.rc)||void 0===Jb?0:Jb.isFeatureEnabled(93))&&this.U6j(h,b,oa);h.iQ=b;h.dOa=null;for(r=0;r<h.ra.length;r++)h.ra.Ub(r).formatting&&h.ra.Ub(r).formatting.ESb();sf.ListItemReader.De||this.XSh(b,h,Hc,Ba);null!=this.aD&&this.aD.Txc(jc);A||!hd||Z||this.Lj.YP(h,hd,this.Qd.Bg);sf.ListItemReader.De&&this.Ebd.Nob(b)&&this.Kl.P0()}}else v.ULS.shipAssertTag(593506379,
324,!1)}else v.ULS.shipAssertTag(593506382,324,!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,324,!1)}XSh(b,h,r,A){this.Ebd.Nob(b)&&(r||(r=new hb.a,r.set(h),r.Nd(),fg.OutlineElementNavigator.me(r)),A||sf.ListItemReader.Fg(r)||(h.Vf(Vc.a.ke,Vc.a.WU,Vc.a.uD,Vc.a.k8,Vc.a.LYa,Vc.a.Dy),this.lSd(r,b)))}axp(b,h,r){let A;ai.a.getInstance().Ht||(A=this.Ebd.mfa(b));const L=this.Ebd.Nob(h);if(!ai.a.getInstance().Ht&&A||sf.ListItemReader.De&&sf.ListItemReader.isListItem(b))this.U6j(b,
h,r),ai.a.getInstance().Ht||!A||L||A.removeProperty(Vc.a.j0)}U6j(b,h,r){const A=b.Hc;if(b=this.Cg.R7a(b)){var L=null==b.mo?new YC.a:b.mo.clone();Ki.a.gAp(L,h,r&&!r.B4i&&r.lPb?r.lPb:null);L.BLa?h=A.JP(L,!0):(A.hu(L,null),h=L);b.Hk=h.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}lSd(){}pod(b,h){if(h){v.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.Yb.IF(h);r?(Ki.a.Kg.vn?(b=r.gv().GAa(b),r=r.nh(this.Yb.Be(b))):
r=r.qKa(b),r?this.Yb.h0(r.Ti())?this.ZP(r,h,!1,void 0,void 0,void 0,null):v.ULS.shipAssertTag(593506368,324,this.Yb.h0(r.Ti())):v.ULS.shipAssertTag(593506369,324,!!r)):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,324,!1)}xVc(b,h=!1,r=!1){const A=this.Yb.IF(b).nh(kk.StyleReader.wordStyleIdNormal);this.ZP(A,b,h,void 0,r)}hLg(b,h){(b=Object(so.a)().Iu(b))&&h.izg(b)}Ydi(b){var h=null;if(!b||!b.count)return v.ULS.sendTraceTag(592221652,
3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=Ki.a.Np(),!h))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.U0.gla(h);if(!r)return v.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var A=new Map;A.set("NumberOfStyles",b.count.toString());A.set("Source","DeleteStyleAPI");xa.Health.instance.recordKpiUsage(zr.a.eGe,0,zr.a.UB,A);A=0;const L=(new Date).getTime();var Z=null;let oa=null,Ba=null,gb=null;
const Ab=this.rc.isFeatureEnabled(29)&&!0;Ab&&(Z=new nb.a,oa=new nb.a,Ba=new nb.a,gb=new nb.a);for(var Jb of b){if(!Jb)return v.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const Tb=r.JVa(Jb);if(!Tb||!this.Yb.ne(Tb,r))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Tb,!!Tb&&this.Yb.ne(Tb,r)),!1;const jc=this.Yb.JF(Tb);if(2!==jc&&1!==jc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",jc),!1;const Hc=
this.Yb.Xjc(Tb,r);let hd=0;if(Hc){if(!this.Yb.ne(Hc,r))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;hd=this.Yb.JF(Hc);if(2!==hd&&1!==hd)return v.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",jc,hd),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Gd=this.DNb(Tb,r);if(!Gd)return!1;A++;Ab&&(1===jc?(oa.add(Jb),gb.add(Tb.id)):(Z.add(Jb),
Ba.add(Tb.id)));if(Hc){Gd=this.DNb(Hc,r);if(!Gd)return!1;A++;Ab&&(1===hd?(oa.add(this.Yb.Be(Hc)),gb.add(Hc.id)):(Z.add(this.Yb.Be(Hc)),Ba.add(Hc.id)))}}kB.a.Umc();r=Ki.a.iNf(r);Jb=new Sb.GraphTransaction(15);Jb.Ab(h);Ab&&this.kBo(Z,oa,Ba,gb,h);h.setValue(cg.a.Eha,r);Uc.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));Jb.Mwe();Jb.dispose();h=(new Date).getTime();Z=new Map;Z.set("Source","DeleteStyleAPI");Z.set("NumberOfStyles",b.count.toString());Z.set("TrueStyleCount",A.toString());
Z.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Na.a,{extendedProperties:Z,durationMs:h-L});xa.Health.instance.recordKpiSuccess(zr.a.eGe,b);return!0}kBo(b,h,r,A,L){if(b&&b.count||h&&h.count)if(L){var Z=(new Date).getTime();if(L=this.Dqm(L)){for(;L.moveNext();){if(!Cd.ParagraphReader.Fh(L.iterator))continue;const oa=L.currentNode;this.TAo(oa,b,r);this.UAo(oa,h,A)}r=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
r-Z));A=new Map;A.set("Source","DeleteStyleRemoveStylesReferences");A.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new Na.a,{extendedProperties:A,durationMs:r-Z});xa.Health.instance.recordKpiSuccess(zr.a.eGe,b)}}else Uc.b(577520338,3018,50,"PageContentNode not provided.");else Uc.b(577520337,3018,50,"No style IDs provided")}TAo(b,h,r){if(h&&h.count&&b){var A=b.Nx;A&&A.hasProperty(cg.a.gx)&&r.contains(A.getValue(cg.a.gx))&&(A.removeProperty(cg.a.gx),b.Nx=A,b.LA()&&this.Lj.YP(b,
b.LA(),this.Qd.Bg));(r=this.Yb.Cq(b))&&(r=this.Yb.Be(r))&&h.contains(r)&&this.xVc(b,!0,!0)}}UAo(b,h,r){if(b&&b.ra&&b.ra.length&&h&&h.count)for(let oa=0;oa<b.ra.length;oa++){var A=b.ra.Ub(oa);if(A&&A.formatting&&(A=A.formatting)&&A.Ib){var L=Ya.FormattingReader.MAa(A);L&&(L=this.Yb.Be(L))&&h.contains(L)&&this.tj.Unf(A);if(L=A.Ib.Io){var Z=L.mo;Z&&(Z=Z.clone(),Z.hasProperty(cg.a.Lw)&&r.contains(Z.getValue(cg.a.Lw))&&this.ezo(b,Z,L,A));Z=oa===b.ra.length-1?b.characterData.length:b.ra.Ub(oa+1).cp;this.Lj.x_b(b,
A.Ib,A.Ib.cp,Z,L,A,this.Qd.Bg)}}}}ezo(b,h,r,A){b&&h&&r&&A&&(b=b.Hc)&&(h.removeProperty(cg.a.Lw),h.BLa?h=b.JP(h,!0):b.hu(h,null),r.Hk=h.id,A.Ib.Io=r)}Dqm(b){if(!b)return null;b=hb.a.eb(b);return b.Ks()?Dd.a.At(b,b.origin):null}DNb(b,h){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.Ti();return this.Yb.h0(r)?h.org(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",zB[this.Yb.JF(b)]),r.set("IsCustomStyle",this.Yb.ne(b,h).toString()),
r.set("IsLinkedStyle",(!!this.Yb.Xjc(b,h)).toString()),b=Object.assign(new Na.a,{extendedProperties:r}),xa.Health.instance.recordKpiFailure(zr.a.eGe,"UnableToDeleteStyle",!1,!0,b),v.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}ubb(b,h,r,A){if(this.rc&&this.rc.isFeatureEnabled(73)){if(!b)return v.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=Ki.a.Np(),
!r))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const Z=this.U0.gla(r);if(!Z)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=Z.JVa(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var L=this.Yb.JF(b);if(2!==L&&1!==L)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",L),!1;xa.Health.instance.recordKpiUsage(zr.a.ANg,0,zr.a.UB,new Map([["Source",
"ModifyStyleAPI"]]));L=Date.now();const oa=new Sb.GraphTransaction(15);let Ba,gb;try{oa.Ab(r);if(!(A&&0!=A.length||h&&0!=h.count))return!1;if(A&&0!=A.length&&(Ba=Ki.a.B3c(b),!Z.zvf(b,A)))return this.NLa("ModifyStyleAPI",b,Z,L,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Hc=Z.gLg(b,h);gb=Ki.a.B3c(b);if(!Hc)return this.NLa("ModifyStyleAPI",b,Z,L,"UnableToModifyStyle"),!1}this.VOn(b,r,gb,Ba);kB.a.Umc();const Ab=Ki.a.iNf(Z);r.setValue(cg.a.Eha,Ab);Uc.b(572302818,3018,50,String.format("Style Object Ids - {0}",
Ab));const Jb=Date.now(),Tb=new Map([["Source","ModifyStyleAPI"]]),jc=Object.assign(new Na.a,{extendedProperties:Tb,durationMs:Jb-L});xa.Health.instance.recordKpiSuccess(zr.a.ANg,jc);return!0}finally{oa&&oa.dispose()}}return!1}VOn(b,h,r,A){var L,Z;if(null!==b){var oa;A&&((oa=null===(L=this.Kl)||void 0===L?void 0:L.Vsd(h,A,b,!0))||Uc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((oa=null===(Z=this.Kl)||void 0===Z?void 0:Z.Vsd(h,r,b,!1))||Uc.b(522856386,
3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}NLa(b,h,r,A,L){const Z=Date.now(),oa=!!this.Yb.Xjc(h,r);b=new Map([["Source",b],["StyleType",zB[this.Yb.JF(h)]],["IsCustomStyle",this.Yb.ne(h,r).toString()],["IsLinkedStyle",oa.toString()]]);A=Object.assign(new Na.a,{extendedProperties:b,durationMs:Z-A});xa.Health.instance.recordKpiFailure(zr.a.ANg,L,!1,!0,A)}}Object(u.a)(eH,"WACStyleEditor",null,[1451]);class fH extends eH{constructor(b,h,r){super(b,r);this.K9=
h}get Zt(){return this.K9.value}lSd(b,h){this.Zt.lSd(b,h)}}Object(u.a)(fH,"WACStyleEditor",eH,[]);class gH{Sdb(b,h){b.properties.setValue(Vc.a.marginTop,h)}Qdb(b,h){b.properties.setValue(Vc.a.marginBottom,h)}sna(b,h){b.properties.setValue(Vc.a.marginLeft,h)}Rdb(b,h){b.properties.setValue(Vc.a.marginRight,h)}Iyg(b,h){b.properties.setValue(Vc.a.pageWidth,h)}Hyg(b,h){b.properties.setValue(Vc.a.pageHeight,h)}qOj(b,h){b.properties.setValue(Vc.a.S4i,h)}s_b(b,h){b.properties.setValue(De.a.SG,h)}hTo(b,h){b.properties.setValue(De.a.bra,
h)}Lwc(b,h){b.properties.setValue(De.a.aI,h)}LZo(b,h){b.properties.setValue(De.a.separator,h)}}Object(u.a)(gH,"WordSectionEditor",null,[437]);class ME{get name(){return"WordEditor.OutlineLevelEditors"}wc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new gH).as("Box4.IWordSectionEditor").ha();y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new ay(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),
b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Ro(vw.a.n9a,b.resolve("WordEditor.List.IFlatListReader"),b.nf("Box4.IOutlineElementEditor"),b.nf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Ro(vw.a.n9a,b.resolve("WordEditor.List.IFlatListReader"),b.nf("Box4.IOutlineElementEditor"),b.nf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),
b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new LE).as("Box4.List.ICursorMovementValidator").ha(),b.ia("Box4.Styles.WACStyleReader",()=>new aA.a(new pv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").ha(),b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new fH(b.resolve("Box4.List.IListReader"),b.nf("WordEditor.IFlatListEditor"),b.nf("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){E.a.instance.Mc(new ME)}}Object(u.a)(ME,
"WordEditorOutlineLevelEditorsPackage",null,[0,1]);var NE=d(605),OE=d(205);class Tn{constructor(b,h){this.Pd=b;this.Vh=h;this.XRa=null}SWo(b,h,r){Ok.a.ynn||({listId:h,listLevel:r}=sf.ListItemReader.gKf(b,{Ara:0,pUa:-1}));if(0<h&&0<=r)this.XRa=b;else{let A=1;const L=b.listStyle;42!==L&&0<L&&(A=L);this.XRa=Vq.a.OW(b.listType,A,null,h,r,void 0,"")}h=new GE.a;switch(b.b9){case 0:this.XRa.YA=h.$rf();break;case 2:this.XRa.YA=h.d9h(h.YXh,h.XXh);break;case 1:this.XRa.YA=h.Rsf(h.acg,h.bcg)}}iYo(b){b&&(this.XRa=
b)}y$h(b){var h=ih.a.instance.rq(vb.a.rHl);Eb.a.Mh(b)||(v.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),ih.a.instance.fc("PossiblyIncorrectListCreation",{["Reason"]:gf.a.UNb}));sf.ListItemReader.Fg(b)&&(v.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),ih.a.instance.fc("PossiblyIncorrectListCreation",{["Reason"]:gf.a.Lzl}));const r=Eb.a.jN(b);r&&!r.hasProperty(Vc.a.Vza)&&
v.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");if(sf.ListItemReader.De&&b.Vb(4))return v.ULS.sendTraceTag(508412242,393,15,"PossiblyIncorrectListCreation - createList called when OE already has numberListNode"),h=b.currentNode,b.uc(),h;sf.ListItemReader.De&&b.Vb(31)&&b.Tg();const A=this.vHl();b.Wf(A,4);r&&(r.hE=A);h.end();return A}vHl(){return Ju.a.instance.createInstance(Ln.a.Obb)}Vga(b){const h=ih.a.instance.rq(vb.a.Vga);Eb.a.Mh(b)||ih.a.instance.fc("PossiblyIncorrectListRemoval",
{["Reason"]:gf.a.UNb});sf.ListItemReader.Fg(b)&&(ai.a.getInstance().du?this.hca(b):this.ECj(b));h.end()}ECj(b){this.Pd.q0(b);b.Tg()}r_i(b){let h=!1;1===b.at&&b.pta&&!b.JL&&(h=!0);const r=b.Se.ka(Vc.a.$w,null);r&&r===Box4Intl.Box4Strings.L_ListStyleNone&&(1===b.listType?h=b.pta&&!b.JL:b.listType||(h=!b.listStyle));return h}Bqa(b,h,r,A=!1){const L=ih.a.instance.rq(vb.a.V7k);this.mPj(b,r,A);const Z=b.hasProperty(Od.a.Rfj);var oa=b.ka(Od.a.Kce,!1);const Ba=this.r_i(r);if(oa)Ba&&(r.tca(16,0),b.setValue(Od.a.cC,
16),b.setValue(Od.a.GXa,0));else{oa=this.Pd.Uw(h);this.hBg(r,oa,Z,Ba)&&(L.properties.W("ToggledOff","true"),r.tca(16,0),this.VWo(b));if(!this.tpe(b,h,r,A))return L.end(),v.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,Jla:r};!r.listType&&b.hasProperty(Od.a.JLa)&&(r.yD=b.getValue(Od.a.JLa),b.removeProperty(Od.a.JLa))}if(Z&&(L.properties.W("MultipleOESelection","true"),this.oTj(h,r)))return L.end(),v.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),
{returnValue:!1,Jla:r};this.F3k(h,r,b,A);lv.jGj();b.hasProperty(Ge.a.DT)&&lv.PDl(b.getValue(Ge.a.DT),h,this.Pd);b.setValue(Od.a.Kce,!0);L.end();return{returnValue:!0,Jla:r}}hBg(b,h,r,A){if(A)return!0;if(h){A=b.listType===h.listType;const L=!b.listStyle&&b.yD===pk.a.Ok;let Z=b.listStyle===h.listStyle&&b.yD===h.yD;b=(!b.pta||this.fvg(h,b))&&!r;Z=Z&&b;return A&&(L||Z)}return!1}VWo(b){b.setValue(Od.a.cC,16);b.setValue(Od.a.GXa,0)}fvg(){return!0}mPj(){}tpe(){return!0}oTj(b,h){return h&&16!==h.listType&&
Eb.a.isEmpty(b,!0)}sVc(b){const h=ih.a.instance.rq(vb.a.sVc);Cd.ParagraphReader.Wb(b)||ih.a.instance.fc("ClearingListFromNonParagraph",{["Reason"]:gf.a.Oxf});const r=new hb.a;r.set(b);r.Nd();r.mt(12);fg.OutlineElementNavigator.me(r);this.hca(r);h.end()}merge(b,h,r){const A=ih.a.instance.rq(vb.a.hBn);Eb.a.Mh(h)||ih.a.instance.fc("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Eb.a.Mh(b)||ih.a.instance.fc("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});sf.ListItemReader.Fg(h)&&(A.properties.W("UseSourceListWithNonlistDestination",
r.toString()),r&&sf.ListItemReader.Fg(b)&&this.Vga(b),sf.ListItemReader.Fg(b)&&!r?this.Tvj(h,b):r&&(r=this.UAi(h),1===r.at&&r.Fnf(!0),this.IKb(b,r),A.properties.W("MoveListInfoFromSrcToDestOE","true")),this.Vga(h),A.properties.W("RemoveListFromSrcOE","true"));A.end();return!0}Tvj(){}UAi(b){return this.Pd.Uw(b)}y_c(b,h){h.hasProperty(Od.a.cC)||(b===vb.a.$E?h.setValue(Od.a.cC,1):(b===vb.a.KN||b===vb.a.nga)&&h.setValue(Od.a.cC,0));h.hasProperty(Od.a.GXa)||h.setValue(Od.a.GXa,0);return h}odc(b,h,r,A,
L,Z,oa,Ba){const gb=ih.a.instance.rq(vb.a.odc),Ab=this.Pd.Uw(h);r=Vq.a.OW(0,r,void 0,void 0,void 0,oa);r.yD=A;r.DT=Z;Ab&&r.rRf(Ab)&&r.yD===Ab.Kx||(A=new Sb.GraphTransaction(15),A.ju(h),Ba.BUn(r.listType,r.listStyle,r.yD,r.levelText,r.DT)&&(Tn.Cg.We(L,""),!sf.ListItemReader.De&&Cd.ParagraphReader.Wb(b)&&OE.a.dma(b)&&(h=this.Pd.mfa(b))&&Tn.Cg.q1l(b,h)),A.dispose());gb.end()}Vsd(b,h,r,A=!1){if(null===r||null===b||null===h)return!1;b=this.Pd.Yy(b,h.listId,h.listLevel);if(!b)return v.ULS.sendTraceTag(523069061,
393,15,"List def not exist when trying to update pStyle Property."),!1;if(A){if(b.hasProperty(cg.a.gx)){b.getValue(cg.a.gx)instanceof Q.a||v.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");if(!Q.a.hw(b.getValue(cg.a.gx),r.id))return v.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(cg.a.gx);return!0}}else{r=r.id;r instanceof Q.a||v.ULS.sendTraceTag(512267810,
393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(cg.a.gx))return v.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(cg.a.gx,r);return!0}return!1}static get xic(){return null!=Tn.WVg?Tn.WVg:Tn.WVg=Wa.a.instance.Oa("Box4.IFontSlotProvider")}static get Cg(){return null!=Tn.ySg?Tn.ySg:Tn.ySg=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Ds(){return ai.a.getInstance()}}
Object(u.a)(Tn,"ListEditor",null,[686]);var bA=d(819),kx=d(328);class su{constructor(b,h,r,A,L,Z){this.lg=L;this._pageContent=r;this.rGb=Array(su.FI);this.pac=Array(su.FI);this.MFh=Array(su.FI);this.O5e=Array(su.FI);this.YBh=Array(su.FI);this.L5=A;this.qRc=Z;for(A=0;A<su.FI;A++){var oa=this.A3c(b,A,r,L);oa?(Z=oa.ka(Ke.a.GU,pk.a.Ok),oa=oa.ka(Vc.a.zZb,pk.a.Ok)):oa=Z=pk.a.Ok;this.pac[A]=Z!==pk.a.Ok?Z:pk.a.m7a;this.O5e[A]=oa===pk.a.Ok?A-1:oa-1;su.xba(h)&&(this.MFh[A]=pk.a.Ok,this.YBh[A]=pk.a.Ok);this.rGb[A]=
this.pac[A]}}A3c(b,h,r,A){A.P6(r);return ai.a.getInstance().D8c&&this.qRc?this.lg.rKf(b,h,this.L5,r):this.lg.D3c(b,h,r.Hc,r)}restart(b){this.rGb[b]=this.pac[b]}Cke(b){for(var h=0;h<b;h++)this.rGb[h]===this.pac[h]&&this.rGb[h]++;for(h=b+1;h<su.FI;h++)this.O5e[h]>=b&&this.restart(h);return this.rGb[b]++}static xba(b){return!!b&&b.isFeatureEnabled(63)}}su.FI=9;Object(u.a)(su,"AWordList",null,[1595]);class PE{constructor(b,h,r,A){this.njb=new Wo.ScriptSharpLegacyMap;this.lg=b;this.FM=h;this.L5=r;this.qRc=
A}Uw(b,h){this.njb.tb(b)||this.njb.W(b,new su(b,h,this.FM,this.L5,this.lg,this.qRc));return this.njb.K(b)}Hrc(b,h,r){return this.Uw(b,r).Cke(h)}}Object(u.a)(PE,"AListNumberingMap",null,[1596]);class hH extends su{constructor(b,h,r,A,L,Z){super(b,h,r,A,L,Z)}pLf(b,h,r,A){A.P6(r);return ai.a.getInstance().D8c&&this.qRc?this.lg.czm(b,h,this.L5):this.lg.bzm(b,h,this._pageContent.Hc)}Nsd(b,h,r){var A=this.pLf(b,h,this._pageContent,this.lg);A?(b=A.ka(Ke.a.GU,pk.a.m7a),A=A.ka(Vc.a.zZb,pk.a.Ok),this.rGb[h]=
this.MFh[h]=this.pac[h]=b,A!==pk.a.Ok&&(this.YBh[h]=this.O5e[h]=A-1)):r&&(A=this.A3c(b,h,this._pageContent,this.lg),b=pk.a.m7a,A&&(b=A.ka(Ke.a.GU,pk.a.m7a)),this.rGb[h]=this.pac[h]=b)}}Object(u.a)(hH,"WordList",su,[]);class AB extends PE{constructor(b){super(b.Pd,b.Oh,b.cB,b.i$j);this.oAh=new nb.a}hKf(b,h,r){let A;ai.a.getInstance().g0?{value:A}=this.lg.VF.Ec(b,A):{value:A}=this.lg.n3.Ec(b,A);this.njb.tb(A)||this.njb.W(A,new hH(b,r,this.FM,this.L5,this.lg,this.qRc));if(!this.oAh.contains(b))for(this.oAh.add(b);h<
pk.a.FI;h++)this.njb.K(A).Nsd(b,h,!1);else if(!h)for(h+=1;h<pk.a.FI;h++)this.njb.K(A).Nsd(b,h,!0);return this.njb.K(A)}Hrc(b,h,r){return su.xba(r)?this.hKf(b,h,r).Cke(h):super.Hrc(b,h,r)}}Object(u.a)(AB,"ListNumberingMap",PE,[]);class iH{constructor(){this.Bvb=0;this.Xak=!1}}Object(u.a)(iH,"LastNumber",null,[]);var jH=d(389);class Bo{constructor(b,h,r,A){this.ged=!1;this.Zt=b;this.kZi=r;this.JSb=A;this.pv=this.Zt.pE(h);this.eS=new hb.a;this.eS.nd(h)}static get Pd(){return Bo.lg||(Bo.lg=Wa.a.instance.resolve("Box4.List.IListReader"))}static set Pd(b){Bo.lg=
b}static get Ds(){return ai.a.getInstance()}static i9l(b,h,r,A=!1,L=!1){var Z=h.currentNode;let oa=null,Ba=!1,gb=!1;h=h.PAb();const Ab=Dd.a.Bo(h);Ab.moveNext();for(h=Ab.iterator;h.currentNode!==Z;){let Tb=gb=Ba=!1;var Jb=Bo.Ahi(h);if(Eb.a.Mh(h)&&!Jb){Jb=!1;if(h.zu(4))if(Bo.aij(h,r,!0,A,L)){if(Tb=!0,oa=new Bo(b,h,!1,!1),Ab.moveNext(),Ab.iterator===Z&&(Ba=!0),A)break}else Eb.a.isEmpty(h,!1)||(Jb=!0),gb=!0;else!Eb.a.isEmpty(h,!1)&&h.N9a(12)&&(Eb.a.RT(h)||(Jb=!0));!A&&Jb&&oa&&(r.Se.hasProperty(Vc.a.listLevel)?
oa.pv.level=0:oa=null)}Tb||Ab.moveNext();h=Ab.iterator}oa&&(oa.JSb=Ba);if(!oa&&h.Kf(1))for(Z=!0;h.currentNode;){if(Eb.a.Mh(h)){if(h.zu(4)&&Bo.aij(h,r,!1,A,L)){oa=new Bo(b,h,!0,Z);break}if(!Eb.a.isEmpty(h,!1))break}if(!h.Kf(1))break;Z=!1}oa&&(oa.ged=gb);return oa}static k9l(b,h){const r=h.currentNode;let A=null,L=!1,Z=!1;h=h.PAb();h=Dd.a.Bo(h);h.moveNext();let oa=h.iterator,Ba=!1;for(;oa.currentNode!==r;){let gb=Z=L=!1;const Ab=Bo.Ahi(oa);Eb.a.Mh(oa)&&!Ab&&(oa.zu(4)?(gb=!0,Ba=!1,A=new Bo(b,oa,!1,!1),
h.moveNext(),h.iterator===r&&(L=!0)):Eb.a.isEmpty(oa,!1)?(Ba&&(A=null),Ba=!0):(A=null,Ba=!1));gb||h.moveNext();oa=h.iterator}A&&(A.JSb=L,A.ged=Z);return A}static Ahi(b){var h=b.Vb(2);if(!h)return!1;h=Cd.ParagraphReader.Fh(b)&&Bo.Gpn(h);b.uc();return h}static Gpn(b){return xl.a(b,8)}static aij(b,h,r,A=!1,L=!1){if(!sf.ListItemReader.Fg(b)&&(v.ULS.sendTraceTag(508913603,393,15,"Trying to call oeMatchesInfo for non list item"),sf.ListItemReader.De))return!1;if(sf.ListItemReader.De)var Z=sf.ListItemReader.h7(b);
else Bo.Pd.q0(b),Z=b.currentNode,b.uc();const oa=Bo.Pd.M2(Z);(b=h.Uz===oa.Uz)&&h.listStyle&&1!==h.at&&(b=h.listStyle===oa.listStyle);b&&(h.pta&&1!==h.at||h.Mic||L)&&(b=Bo.pnn(h,oa),h.Uz||(b=b&&h.font===oa.font));if(1===h.at)if(1===oa.at&&oa.Se.hasProperty(Ge.a.Lub))b=h.b9===oa.b9;else return!1;b&&h.Uz&&h.yD!==pk.a.Ok&&(b=oa.Kx,r&&(A&&1===h.yD&&1===b||b++),b=h.yD===b);b&&(A||h.Mic)&&(h=sf.ListItemReader.gKf(h,{Ara:0}).listId,Z=sf.ListItemReader.Jr(Z,{Ara:0}).listId,0<h&&0<Z&&(b=h===Z));return b}static pnn(b,
h){h=h.u6i;b.pta&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.u6i.toLocaleLowerCase()}static j9l(b,h,r){var A=h.currentNode;let L=null;const Z=new hb.a,oa=b.DAa(A,r);var Ba=!1;let gb=!1;Z.nd(h);Z.uc();for(Z.Vb(1);Z.currentNode!==A;)gb=Ba=!1,Eb.a.Mh(Z)&&Z.zu(4)&&(h=b.pE(Z),Bo.bij(h,r,!0)?(L=new Bo(b,Z,!1,!1),Ba=!0):(gb=!0,h.listID===r.listID&&h.level<=oa.idb&&(L=null))),Z.Kf(1);L&&(L.JSb=Ba);if(!L&&Z.Kf(1))for(A=!0;Z.currentNode;){if(Eb.a.Mh(Z)&&Z.zu(4)){Ba=b.pE(Z);if(Ba.listID===
r.listID&&Ba.level<=oa.idb)break;if(Bo.bij(Ba,r,!1)){L=new Bo(b,Z,!0,A);break}}if(!Z.Kf(1))break;A=!1}L&&(L.ged=gb);return L}static bij(b,h,r){let A=b.listID===h.listID&&b.level===h.level;A&&h.Kx!==pk.a.Ok&&(b=b.Kx,r&&b++,A=h.Kx===b);return A}}Bo.lg=null;Object(u.a)(Bo,"JoinTargetInfo",null,[]);class kr{constructor(b,h){this.pv=null;this.action=b;h&&(this.pv=h)}static Bbb(){return new kr(0)}static t3f(){return new kr(1)}static JAn(b){return new kr(3,b)}static $An(b){return new kr(2,b)}static MAn(b){return new kr(4,
b)}}Object(u.a)(kr,"ApplyListInfoResult",null,[]);class kH{constructor(){this.startAt=this.idb=0}}Object(u.a)(kH,"WordListRestartInfo",null,[]);var Sy=d(909);class cA{constructor(b,h,r){this.dqd=r;this.bgd=h.listID}}Object(u.a)(cA,"ListTransferInfo",null,[]);class Tu extends Tn{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){super(b,r,gb);this.CI=jc;this.oFh=!1;this.TFc=this.rzd=this.P5b=null;this.Bze=(Hc,hd)=>hd.listID===Hc.listID&&hd.level===Hc.level;this.C$o=(Hc,hd,Gd)=>hd.listID!==Hc.listID&&hd.listID!==
Gd.bgd||hd.level!==Hc.level?!1:!0;this.dLn=(Hc,hd,Gd)=>hd.listID===Hc.listID||Gd&&hd.listID===Gd.bgd?!0:!1;this.rVj=(Hc,hd,Gd,de)=>{ai.a.Ys||this.qVj(Hc,hd,Gd,de)};this.qVj=(Hc,hd,Gd,de)=>{if(!ai.a.Ys){if(sf.ListItemReader.De){const {listId:qe}=sf.ListItemReader.Jr(hd);qe!==Gd&&v.ULS.sendTraceTag(508347426,393,15,`siblingRenumberAndUpdateSublists: existingListId:${qe} newListId:${Gd}`)}ai.a.getInstance().Ht||this.CI.JAb(Hc,Gd);hd=sf.ListItemReader.De?hd:Hc;Hc=this.$jc(hd);hd=hb.a.eb(hd);hd.Nd();hd.uc();
this.Ccm(hd,Hc,this.dLn,this.bgp,de)}};this.E$o=(Hc,hd,Gd,de)=>{if(!ai.a.Ys){var {pv:qe,iterator:oe}=this.Hgc(hd,()=>{if(sf.ListItemReader.De){var {listId:ge}=sf.ListItemReader.Jr(hd);ge!==Gd&&v.ULS.sendTraceTag(508347424,393,15,`siblingRenumberAndUpdateListID: existingListId:${ge} newListId:${Gd}`)}ai.a.getInstance().Ht||this.CI.JAb(Hc,Gd);ai.a.getInstance().du&&this.CI.JAb(hd,Gd);var $d=sf.ListItemReader.De?hd:Hc;ge=this.$jc($d);$d=hb.a.eb($d);$d.Nd();$d.uc();return{pv:ge,iterator:$d}});this.P3d(oe,
qe,this.OYj,this.MAe,de)}};this.$fp=(Hc,hd,Gd,de)=>{ai.a.Ys||this.syj(Hc,hd,Gd,de)};this.MAe=(Hc,hd,Gd,de)=>{Gd.listID=hd.listID;de.Vb(4);const qe=this.Ts.CVa(de.currentNode);this.Hgc(qe,()=>{this.lTc(de.currentNode,Gd,qe);de.uc()})};this.bgp=(Hc,hd,Gd,de)=>{!ai.a.Ys&&sf.ListItemReader.Fg(de)&&(Hc=new hb.a,Hc.nd(de),Hc.Nd(),this.Pd.q0(Hc),this.qdn(de.currentNode,Hc.currentNode))};this.agp=(Hc,hd,Gd,de)=>{Gd.listID=hd.listID;this.syj(Hc,hd,Gd,de);this.MAe(Hc,hd,Gd,de)};this.NYj=(Hc,hd)=>hd.listID===
Hc.listID;this.Zfp=(Hc,hd)=>hd.level<=Hc.level;this.OYj=(Hc,hd,Gd)=>hd.listID===Gd.bgd;this.Sp=L;this.Owa=b;this.rDd=h;this.Rc=A;this.Rig={};this.ODk=Z;this.Zd=oa;this.kq=Ba;this.Fd=Ab;this.hy=Jb;this.ew=Tb}get xba(){return this.Owa.cma}get czb(){return this.oFh}set czb(b){this.oFh=b}get Ts(){return this.Owa}get p4(){return this.ew}get Yb(){return this.hy}get $s(){return this.Ts.$s}get Rq(){return this.Ts.Rq}get nya(){return this.Ts.nya}get vba(){return this.Ts.vba}set vba(b){this.Ts.vba=b}get zXa(){return this.Ts.zXa}set zXa(b){this.Ts.zXa=
b}get Gpd(){return null!=this.J3g?this.J3g:this.J3g=Wa.a.instance.Oa("Box4.List.ISingleLevelListEditor")}F3k(b,h,r,A){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const L=r.ka(Od.a.Kce,!1);let Z=!1,oa=-1;!L||h.listStyle&&1!==h.at||(Z=!r.ka(Od.a.o1f,!1),oa=r.ka(Od.a.Y2f,-1));b=this.IKb(b,h,{EQi:Z,hAn:oa,Wpb:A,Se:r});L||r.setValue(Od.a.o1f,2===b.action);3===b.action&&!r.hasProperty(Od.a.Y2f)&&b.pv&&r.setValue(Od.a.Y2f,b.pv.level)}merge(b,h,r,A=null){const L=sf.ListItemReader.Fg(b)||
sf.ListItemReader.Fg(h);b=super.merge(b,h,r,A);L&&this.P0();return b}Tvj(b,h){this.Kml(b,h)}Kml(b,h){b=sf.ListItemReader.De?sf.ListItemReader.nla(b,{pUa:-1}).listLevel:this.Pd.kKf(b);const r=sf.ListItemReader.De?sf.ListItemReader.nla(h,{pUa:-1}).listLevel:this.Pd.kKf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.rDd.value.LYc(h,b):0>b&&this.rDd.value.hZa(h,b,0))}ECj(b){this.Pd.q0(b);b.Tg();this.P0()}pIg(b,h,r,A){var L=hb.a.eb(r);L=this.pE(L);const Z=this.B_b(b,L,!ai.a.getInstance().du);if(!ai.a.Ys){b=this.Ts.f9a(b.currentNode,
L);b.listType||(Z.setValue(Tn.Ds.loa,L.Kx),Z.setValue(Tn.Ds.PEa,L.BZc),this.EEj(Z,L,h?r:A));switch(b.listType){case 0:h="Numbering";break;case 1:h="Bullet";break;default:h="Invalid List Type"}y.AFrameworkApplication.va.Ob(vb.a.n1f,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",h);ai.a.getInstance().Ht||this.CI.A_b(Z,L.listID,L.level)}}pE(b){if(!sf.ListItemReader.Fg(b)&&(v.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),sf.ListItemReader.De))return null;
let h;sf.ListItemReader.De?h=sf.ListItemReader.h7(b):(this.Pd.q0(b),h=b.currentNode,b.uc());return this.$jc(h)}sXo(b,h){this.Pd.q0(b);const r=b.currentNode;b.uc();ai.a.getInstance().Ht||this.CI.JAb(r,h);b=Eb.a.jN(b);ai.a.getInstance().du&&this.CI.JAb(b,h);this.$jc(sf.ListItemReader.De?b:r)}$jc(b){var h;const r=new bA.a;sf.ListItemReader.De&&(b&&Cd.ParagraphReader.Wb(b)||v.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?
void 0:b.constructor)||void 0===h?void 0:h.name}`));h=sf.ListItemReader.De?sf.ListItemReader.Jr(b)||sf.ListItemReader.sla(b):this.Pd.z_(b,!1,!0);r.listID=h.listId;r.level=h.listLevel;r.j0=sf.ListItemReader.s$d(b);h=this.Y6d(b);r.aVo(h);r.Kx=sf.ListItemReader.v9d(b);r.BZc=sf.ListItemReader.SOf(b);return r}B_b(b,h,r=!1){const A=Eb.a.jN(b);b=ai.a.getInstance().Ht?null:this.y$h(b);this.lTc(b,h,A,r);return b}lTc(b,h,r=null,A=!1){ai.a.getInstance().Ht||b||ih.a.instance.fc("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});
!ai.a.getInstance().du||A||r||Uc.b(509364259,393,15,"Apply list ref info called without para node");h||ih.a.instance.fc("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});ai.a.getInstance();ai.a.getInstance().du&&r&&(ai.a.eu?!h.j0:!A)&&this.CI.A_b(r,h.listID,h.level);ai.a.getInstance().E7&&(r=r||this.Pd.CVa(b),this.CI.yBo(r));ai.a.getInstance().Ht||(this.CI.A_b(b,h.listID,h.level),h.j0&&b.setValue(Vc.a.j0,!0),ai.a.getInstance().du||null==h.levelText||b.setValue(Vc.a.$w,h.levelText))}Z7j(b){this.Ts.P6(b);
b=Object(so.a)().Iu(b);let h=b.ka(Vc.a.Rq,null);h=h?Array.clone(h):[];b.setValue(Vc.a.Rq,h);this.Ts.Tmc()}Lfp(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Oym(b){b=b.view;if(!b.lb||!b.lb.gb)return null;b=An.OutlineElementGeneralizer.cla(b.lb.gb,!1);if(1!==b.length)return null;b=hb.a.eb(b.getContext(0).node);if(!sf.ListItemReader.Fg(b))if(14===b.je().type){const h=sf.ListItemReader.Sxi(b.currentNode);h&&b.set(h)}else Uc.b(589177753,
393,15,"Encountered an OE of non list type."),b.uc();b.Nd();return b}cIl(b,h,r,A){const L=b.SJ(),Z=new bA.a;Z.listID=this.pYd(b);this.xba?(Z.ghe=Tn.Ds.g0?this.R$h(b):this.I$h(b),this.nzj(b,Z.listID,Z.ghe)):this.pzj(b,Z.listID);Z.yOj(h.Se,this.mbd(r));this.S0d(b);r=this.RAi(b,h);for(let Ba=0;9>Ba;Ba++){const gb=new Gl.a;L.ud.hu(gb);this.ozj(b,this.xba?Q.a.nil:gb.id,this.xba?gb.id:Q.a.nil);this.mWk(gb,h.Uz,Ba);this.KNh(gb,r,Ba);var oa=A.TUb[Ba];oa=6===oa?Vq.a.OW(1,1):Vq.a.OW(0,oa);oa.rma&&gb.setValue(Ke.a.W7,
oa.rma);h.yD!==pk.a.Ok&&Ba===Z.level&&gb.setValue(Ke.a.GU,h.yD);A.NJa&&A.NJa[Ba]&&gb.setValue(Ke.a.font,A.NJa[Ba]);oa=A.obd[Ba];v.ULS.shipAssertTag(22127636,338,!!oa);gb.setValue(Vc.a.$w,oa);gb.setValue(Vc.a.gga,A.oge[Ba]);kx.a.$xe(A.b9,gb)}return Z}aIl(b,h,r){const A=b.SJ(),L=new bA.a;L.listID=this.pYd(b);this.xba?(L.ghe=Tn.Ds.g0?this.R$h(b):this.I$h(b),this.nzj(b,L.listID,L.ghe)):this.pzj(b,L.listID);L.yOj(h.Se,this.mbd(r));if(!h.listStyle)switch(L.level%3){case 0:h.tca(h.listType,1);break;case 1:h.tca(h.listType,
2);break;case 2:h.tca(h.listType,3)}this.S0d(b);r=this.RAi(b,h);for(let Z=0;9>Z;Z++){const oa=new Gl.a;A.ud.hu(oa);this.ozj(b,this.xba?Q.a.nil:oa.id,this.xba?oa.id:Q.a.nil);this.lWk(oa,h.Uz,Z);this.KNh(oa,r,Z);2===Z%3&&h.Uz?oa.setValue(Vc.a.gga,"right"):oa.setValue(Vc.a.gga,"left");Z===L.level&&(h.rma&&oa.setValue(Ke.a.W7,h.rma),h.yD!==pk.a.Ok&&oa.setValue(Ke.a.GU,h.yD),h.Uz?this.COj(h,oa,Z):(Tu.zOj(h,oa),Tu.BOj(h,oa)),Tu.AOj(h,oa),h.Mic&&oa.lza(h.Se,Vc.a.listID,Vc.a.listLevel))}return L}COj(b,h,
r){b.pta?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(r+1))):b=b.o8c||b.YAa?b.levelText:"%"+(r+1)+".";v.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Vc.a.$w,b)}hBg(b,h,r,A){if(b.o8c)return!1;if(1===b.at)return A;if(A)return!0;if(h){A=b.listType===h.listType;const L=!b.listStyle&&b.yD===pk.a.Ok;let Z=b.listStyle===h.listStyle&&b.yD===h.yD;b=(!b.pta||this.fvg(h,b))&&!r;Z=Z&&b;return A&&(L||Z)}return!1}S0d(b){this.P5b||(this.P5b=b.ka(Vc.a.IOl,null));this.rzd||(this.rzd=b.ka(Vc.a.HOl,null));this.TFc||
(this.TFc=b.ka(Vc.a.JOl,null))}mbd(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}Bzi(b){return b?this.Sp.fX(b).Qu-this.Sp.qI(b).Qu:-1}pzj(b,h){const r=b.ka(Vc.a.$s,null),A=r?r.length:0,L=Array(A+1);let Z=0;for(;Z<A;Z++)L[Z]=r[Z];L[Z]=h;b.setValue(Vc.a.$s,L);this.Ts.Tmc()}nzj(b,h,r){this.Zdf(Vc.a.$s,b,h);if(Tn.Ds.g0){this.Zdf(De.a.lYa,b,r);var A=this.Ts.W6d(b);A.add(h,r);b.setValue(De.a.VF,jH.d(NE.a.Ozc(A)))}else this.Zdf(Vc.a.nya,b,r),A=this.Ts.V6d(b),A.add(h,r),b.setValue(Vc.a.n3,
jH.d(NE.a.Ozc(A)))}ozj(b,h,r){this.xba?(this.ANh(Vc.a.Rq,b,r),this.ANh(Vc.a.h8,b,h)):(r=(r=b.ka(Vc.a.Rq,null))?Array.clone(r):[],r.push(h),b.setValue(Vc.a.Rq,r),this.Ts.Tmc())}Zdf(b,h,r){const A=h.ka(b,null),L=A?A.length:0,Z=Array(L+1);let oa=0;for(;oa<L;oa++)Z[oa]=A[oa];Z[oa]=r;h.setValue(b,Z)}ANh(b,h,r){let A=h.ka(b,null);A=A?Array.clone(A):[];A.push(r);h.setValue(b,A)}lWk(b,h,r){var A=r%3+1;const L=h?this.TFc:this.rzd;L&&r<L.length?b.setValue(Vc.a.Jt,L[r]):b.setValue(Vc.a.Jt,360);A=Vq.a.OW(h?0:
1,this.Lfp(A),null,0,r);b.zt(A.Se);b.setValue(Vc.a.ujf,h?-1:-2);h?b.setValue(Vc.a.$w,"%"+(r+1)+"."):(b.setValue(Ke.a.font,this.Kpm(r)),b.setValue(Vc.a.$w,String.fromCharCode(this.Bpm(r))));kx.a.Twc(2,b)}mWk(b,h,r){const A=h?this.TFc:this.rzd;A&&r<A.length?b.setValue(Vc.a.Jt,A[r]):b.setValue(Vc.a.Jt,360);b.setValue(Vc.a.ujf,h?-1:-2);kx.a.Twc(1,b)}Bpm(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}Kpm(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";
case 2:return"Wingdings";default:return"Symbol"}}pYd(b){if(this.xba)this.vba<pk.a.zbd&&this.Ts.P6(b),this.vba=this.ZBi(this.$s,this.vba,pk.a.zbd);else{if(this.vba<pk.a.zbd&&(this.Ts.P6(b),this.$s&&this.Rq)){b=this.$s.length;for(let h=0;h<b;h++)this.$s[h]>=this.vba&&(this.vba=this.$s[h])}this.vba+=1}return this.vba}I$h(b){this.zXa<pk.a.VPd&&this.Ts.P6(b);return this.zXa=this.ZBi(this.nya,this.zXa,pk.a.VPd)}R$h(b){var h;this.Ts.P6(b);do b=Math.floor(Math.random()*(Tu.LLn-Tu.Xdj))+Tu.Xdj;while(null===
(h=this.Ts.jWb)||void 0===h?0:h.includes(b));return b}ZBi(b,h,r){if(h<r&&b){r=b.length;for(let A=0;A<r;A++)b[A]>h&&(h=b[A])}h++;return h}oEo(b,h){ai.a.Ys||this.mqi(b,h,this.Bze,this.rVj,null,!1)}nEo(b,h){ai.a.Ys||this.Dcm(b,h,this.Bze,this.qVj)}pbl(){ai.a.Ys||this.P0()}P0(b=null){var h,r;if(!ai.a.Ys){var A=new hb.a;if(b)if(8===b.type)A.set(b);else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else A.set(ab.StaticActiveAppFrame.za().kb.hd),
Object(so.a)().WIg(A),b=Object(so.a)().Iu(A.currentNode);if(A.zb(7)||A.kd(7)){A=Dd.a.At(A,A.origin);var L=new AB({Pd:this.Ts,Oh:b,cB:null,i$j:!1});for(b=new AB({Pd:this.Ts,Oh:b,cB:null,i$j:!1});A.moveNext();){var Z=A.iterator;let Ba;if(!ai.a.getInstance().Ht){if(!Z.zu(4)&&!Z.zu(31))continue;this.Pd.TVb(Z);Ba=Z.currentNode;Z.uc();if(!Ba){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",Z.isValid);continue}}const gb=sf.ListItemReader.De?
sf.ListItemReader.m7d(Z):Ba;if(!this.xba&&!sf.ListItemReader.$Yf(gb)&&this.Pd.M2(gb).listType)continue;var oa=void 0;if(sf.ListItemReader.De){if(!gb){v.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}oa=sf.ListItemReader.Jr(gb)}else oa=this.Pd.z_(Ba,!1,!1);if(this.xba&&oa&&this.Pd.aee(oa.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",oa.listId);continue}const Ab=sf.ListItemReader.De?gb:Eb.a.jN(Z);
Ab&&(Ab.ra?(null==Ab.ra.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.xba&&this.Ts.P6(Z.currentNode),12===Ab.type&&(Ab.lj&&Ab.Nx.hasProperty(Vc.a.listID)||null===(h=Ab.ra.last)||void 0===h||!h.Wi)&&((Z=sf.ListItemReader.De?Ab.lj?sf.ListItemReader.sla(gb):sf.ListItemReader.Jr(gb):this.Pd.z_(Ba,!0,!0))?this.EOj(Ba,gb,b,Tn.Ds.ovd,Z):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ba.type)),
!oa||null!==(r=Ab.ra.last)&&void 0!==r&&r.Yh||!this.EOj(Ba,gb,L,Tn.Ds.loa,oa)||(oa=Ba.getValue(Tn.Ds.loa),this.xba&&this.Pd.M2(gb).listType||Ba.setValue(Tn.Ds.PEa,oa))):v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,376,7===A.uf,"Couldnt reach to page manifest node")}}EOj(b,h,r,A,L){if(!ai.a.Ys)return A||v.ULS.shipAssertTag(571757918,393,!!A,"Prop definition is null"),r=r.Hrc(L.listId,L.listLevel,this.Fd),L=-1,
b.hasProperty(A)&&(L=b.getValue(A)),r===L||this.xba&&!sf.ListItemReader.$Yf(h)&&this.Pd.M2(h).listType&&(A!==Tn.Ds.ovd||1!==this.Pd.M2(h).listType)?!1:(b.setValue(A,r),!0)}bmn(b,h){if(!ai.a.Ys){var r=!1,A=!0,L=0,Z=this.pE(b),oa=b.currentNode;b=b.PAb();b=Dd.a.Bo(b);for(b.zp(Sy.a.ohe,null);b.moveNext();){var Ba=b.iterator.currentNode;if(Ba===oa)break;sf.ListItemReader.Fg(Ba)&&(Ba=this.pE(b.iterator),Ba.listID===Z.listID&&(Ba.level>Z.level?(r=!0,L++):Ba.level===Z.level?(A=!1,L=0):Ba.level<=h.idb&&(A=
!0,L=0)))}return r&&A&&!0}}Vnl(b){if(!ai.a.Ys){this.Pd.q0(b);var h=b.currentNode;b.uc();var r=this.pE(b);r&&this.Ts.jhe(h,r.listID,r.level)&&this.nEo(b.currentNode,r)}}UAi(b){var h;const r=this.Pd.Uw(b);r.Mic=!0;sf.ListItemReader.De?(b=sf.ListItemReader.nla(b),r.Se.setValue(Vc.a.listID,null!==(h=null===b||void 0===b?void 0:b.listId)&&void 0!==h?h:0)):(this.Pd.q0(b),h=b.currentNode.ka(Vc.a.listID,0),r.Se.setValue(Vc.a.listID,h),b.kd(11));return r}a2f(b,h,r){if(!ai.a.Ys){var A=new hb.a,L=h.currentNode,
Z=pk.a.Ok,oa=!1,Ba=!1,gb=!1,Ab=null,Jb=h.PAb();Jb=Dd.a.Bo(Jb);for(Jb.zp(Sy.a.ohe,null);Jb.moveNext();){A.nd(Jb.iterator);if(A.currentNode===L)break;oa=!1;if(sf.ListItemReader.Fg(A)){var Tb=this.pE(A);Tb.listID===b.listID&&(Tb.level===b.level?(this.Pd.q0(A),Z=A.currentNode,A.uc(),Z=Z.ka(Tn.Ds.loa,pk.a.Ok),oa=!0,Ab=A.XAc(1),Ba=!0):Tb.level>b.level?gb=!0:Tb.level<=r.idb&&(Z=pk.a.Ok,gb=Ba=!1))}}!Ba&&gb&&(Z=r.startAt);oa&&(oa=h.XAc(1)===Ab);b=new iH;b.Bvb=Z;b.Xak=oa;return b}}Uyp(b,h){var r=sf.ListItemReader.h7(b);
b=this.$jc(r);const A=new hb.a;A.set(r);if(A.Nd()&&(r=A.ldb())){r=Dd.a.Bo(r);for(r.zp(Sy.a.ohe,b);r.moveNext();)sf.ListItemReader.Fg(r.iterator.currentNode)&&this.pE(r.iterator).listID===h&&this.sXo(r.iterator,b.listID);v.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}qdn(b,h){ai.a.Ys||(v.ULS.shipAssertTag(22819227,338,!!b&&!!h),h.setValue(Yf.a.n3f,Q.a.create().toString()))}DAa(b,h){const r=ih.a.instance.rq(vb.a.DAa),A=new kH;(b=this.Ts.Yy(b,h.listID,h.level))?(A.idb=
b.ka(Vc.a.zZb,h.level-1),A.startAt=b.ka(Ke.a.GU,1)):ih.a.instance.fc("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return A}lKl(b){const h=Ju.a.instance.createInstance(Ln.a.Fod);b.Wf(h,31)}aBo(b){b.Vb(31)&&b.Tg()}yCj(b){var h=this.Yb.Cq(b);h?this.Yb.Be(h)===kk.StyleReader.wordStyleIdListParagraph&&(h=this.Yb.IF(b),this.p4.ZP(h.nh(kk.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.czb)):v.ULS.shipAssertTag(8271188,315,!1)}GOj(b){if(this.Yb.Be(this.Yb.Cq(b))===kk.StyleReader.wordStyleIdNormal){const h=
this.Yb.IF(b);this.p4.ZP(h.nh(kk.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Vf(Vc.a.ke,Vc.a.WU,Vc.a.uD,Vc.a.k8,Vc.a.Jt,Vc.a.fua);b.setValue(Vc.a.LYa,0)}Xnl(b,h){var r=sf.ListItemReader.Jr(b);if(!r)return null;const A=r.listId;r=r.listLevel;for(let Z=0;9>Z;Z++){const oa=this.Ts.Yy(b,A,Z);if(!oa)return ih.a.instance.fc("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var L=h.TUb[Z];L=6===L?Vq.a.OW(1,1):Vq.a.OW(0,L);L.rma&&oa.setValue(Ke.a.W7,L.rma);oa.hasProperty(Ke.a.font)&&
oa.removeProperty(Ke.a.font);h.NJa&&h.NJa[Z]&&oa.setValue(Ke.a.font,h.NJa[Z]);L=h.obd[Z];v.ULS.shipAssertTag(22127641,338,!!L);oa.setValue(Vc.a.$w,L);oa.setValue(Vc.a.at,kx.a.Arc);kx.a.$xe(h.b9,oa);oa.setValue(Vc.a.gga,h.oge[Z]);oa.Vf(Vc.a.zZb,Ke.a.GU);this.Z7j(b)}b=new bA.a;b.listID=A;b.level=r;return b}Unl(b,h,r,A){if(A)return this.Xnl(b,A);var L=sf.ListItemReader.Jr(b);if(!L)return null;A=L.listId;L=L.listLevel;const Z=this.Ts.Yy(b,A,L);if(!Z)return ih.a.instance.fc("PossiblyIncorrectListStyle",
{["Reason"]:"ListDefIsNull"}),h&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,A,L),null;h.Mic&&(Z instanceof IC.a?Z.lza(h.Se,Vc.a.listID,Vc.a.listLevel):v.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===Z||void 0===Z?void 0:Z.constructor.name));var oa=Z.ka(Vc.a.at,null);oa&&oa===kx.a.Arc&&this.Tnl(b,A);if(!h.listStyle){oa=0;if(-1!==r){for(oa+=
L-r;0>oa;)oa+=3;oa%=3}switch(oa){default:r=1;break;case 1:r=2;break;case 2:r=3}h.tca(h.listType,r)}h.rma&&Z.setValue(Ke.a.W7,h.rma);h.Uz?(this.COj(h,Z,L),Z.hasProperty(Ke.a.font)&&Z.removeProperty(Ke.a.font)):(Tu.zOj(h,Z),Tu.BOj(h,Z));Tu.AOj(h,Z);Z.Vf(Vc.a.zZb,Ke.a.GU,Vc.a.l$c);this.Z7j(b);b=new bA.a;b.listID=A;b.level=L;return b}Tnl(b,h){let r;for(let A=0;9>A;A++){r=this.Ts.Yy(b,h,A);if(!r){v.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,A);break}r.setValue(Vc.a.at,
kx.a.hae);r.removeProperty(Ge.a.Lub)}}nxe(b,h){const r=ih.a.instance.rq(vb.a.nxe);this.rDd.value||ih.a.instance.fc("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.XRa?(r.properties.W("PendingListInfo","true"),sf.ListItemReader.Fg(b)&&(r.properties.W("RemoveCurrentListInfo","true"),this.czb=!0,this.hca(b),this.rDd.value.hZa(b,-1,0),this.czb=!1),16!==this.XRa.listType&&this.IKb(b,this.XRa,{EQi:!0,rem:!0}),this.XRa=null):h||(r.properties.W("CurrentlyUnderPastedList",
"true"),this.hca(b,{qCj:!0}));r.end()}kye(b,h){var r;if(sf.ListItemReader.Fg(b))return!1;b.Vb(2);var A=Wk.a.Tbl;const L=[!0,!1].map(Z=>Cd.ParagraphReader.pg(b.currentNode,Z,void 0,!1));b.uc();for(let Z=0;Z<L.length;Z++){const oa=L[Z];if(oa&&!OE.a.dma(oa))for(const Ba of A)if(Ba.test(oa.characterData))return A=null===(r=Ba.exec(oa.characterData))||void 0===r?void 0:r[0],this.Rro(h,Z?"nextPara":"prevPara",A),!1}return!0}Rro(b,h,r){const A=new Map;A.set("CurrentAutoListPreventedAutoListText",b);A.set("UndoAutoListPreferenceFoundIn",
h);A.set("UndoAutoListPreferenceAutoListText",r);xa.Health.instance.recordKpiUsage(pk.a.Eab.Cyo,0,pk.a.UB,A)}p6o(b,h){return b&&h}zCj(b){for(let h=0;h<b.count;h++){const r=hb.a.eb(b.K(h));r.Ks();this.Vga(r)}b.clear()}mEo(b){ai.a.Ys||sf.ListItemReader.Fg(b)&&this.P0()}Pyj(b,h){b=new hb.a;b.set(h);b.Nd();fg.OutlineElementNavigator.me(b);b.Hrb(h)||ih.a.instance.fc("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.hca(b);return b}wWo(b,h,r){this.Vh.PDa(b,h,r,!0)}GWo(b){b.tca(1,
1)}lSd(b,h){const r=ih.a.instance.rq(vb.a.H8k);if(this.Yb.h0(h.Ti())){if(sf.ListItemReader.Fg(b)&&this.hca(b),h=this.Ts.cBi(h)){if(ai.a.Ys)var A=this.B_b(b,h,!0);else if(this.Ts.f9a(b.currentNode,h),A=Bo.j9l(this,b,h))A=this.DOj(b,A,!0);else{A=this.y$h(b);var L=this.P3d(b,h,this.NYj,this.$fp);if(L){const Z=this.pE(L);if(Z.listID===h.listID&&Z.level<h.level&&this.Pd.Uw(L).Uz){const oa=this.DAa(L.currentNode,Z);Z.Kx===(oa.startAt===pk.a.Ok?1:oa.startAt)&&(Z.BZc=Z.Kx,this.EEj(A,Z,L.currentNode))}}L=
this.DAa(A,h);b=this.a2f(h,b,L);b=b.Bvb!==pk.a.Ok?b.Bvb+1:L.startAt===pk.a.Ok?1:L.startAt;ai.a.getInstance().Ht||this.lTc(A,h,null,!0);A.setValue(Tn.Ds.loa,b);A.setValue(Tn.Ds.PEa,b)}ai.a.getInstance().Ht||A.setValue(Vc.a.j0,!0);r.end()}}else ih.a.instance.fc("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}EEj(b,h,r){ai.a.Ys||this.Ts.jhe(b,h.listID,h.level)&&this.oEo(r,h)}U8k(b,h,r){if(!sf.ListItemReader.Fg(h)&&(v.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),
sf.ListItemReader.De))return;let A=null;ai.a.getInstance().Ht||(A=h.Vb(4),h.uc());(h=Eb.a.jN(h))||Uc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.Psf(b,r,0,null);this.lTc(A,b,h);return b}Psf(b,h,r,A=null){b=A?this.cIl(b,h,r,A):this.aIl(b,h,r);Tn.Ds.du||(h.YAa?(h=h.levelText,A||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(v.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}IKg(b,
h,r,A=null){if(sf.ListItemReader.Fg(b)){var L=b.Vb(4);b.uc();var Z=Eb.a.jN(b);this.Hgc(Z,()=>{this.lTc(L,h.pv,Z,r);ai.a.Ys||this.Ngi(L,h,r,A)})}else v.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}DOj(b,h,r,A=null){const L=Eb.a.jN(b);return this.Hgc(L,()=>{const Z=this.B_b(b,h.pv,r);if(!ai.a.Ys)return this.Ngi(Z,h,r,A),Z})}Ngi(b,h,r,A=null){if(!ai.a.Ys&&this.Ts.f9a(b,h.pv).Uz){const L=new hb.a;L.set(b);L.Nd();L.uc();const Z=this.Ham(L,h,A);b=this.zam(L,
b,h,r,A,Z);this.Eam(h,r,A,Z,b)}}Ham(b,h,r){if(!ai.a.Ys){if(h.kZi)h=h.eS;else{let A,L;r?(A=this.OYj,L=this.MAe):h.JSb?(A=this.NYj,L=this.MAe):(A=this.Zfp,L=this.agp);h=this.P3d(b,h.pv,A,L,r)}!h&&r&&(r=new hb.a,r.nd(b),r.E9d()&&sf.ListItemReader.Fg(r)&&(h=r));return h}}zam(b,h,r,A,L,Z){if(!ai.a.Ys)return A?(L?b=L.dqd:(Z=this.DAa(h,r.pv),r=this.a2f(r.pv,b,Z),b=r.Bvb!==pk.a.Ok?r.Bvb+1:Z.startAt===pk.a.Ok?1:Z.startAt),h.setValue(Tn.Ds.loa,b),h.setValue(Tn.Ds.PEa,b)):(b=pk.a.Ok,this.yXo(h,Z,r)),b}Eam(b,
h,r,A,L){if(!ai.a.Ys&&A){var Z=!1;const gb=this.pE(A);var oa=gb.level===b.pv.level,Ba=!!r&&gb.listID===r.bgd;(gb.listID===b.pv.listID||Ba)&&oa&&(oa=this.DAa(A.currentNode,gb),Ba=oa.startAt===pk.a.Ok?1:oa.startAt,gb.Kx===Ba+1&&(Z=h?L===Ba:this.bmn(A,oa)));if(!Z||r)r?(h=this.C$o,L=this.E$o):(h=this.Bze,L=this.rVj),Z=new hb.a,Z.set(A.currentNode),Z.Nd(),this.Pd.q0(Z),Z.uc(),this.mqi(A.currentNode,b.pv,h,L,r)}}yXo(b,h,r){if(!ai.a.Ys){var A=null;h&&(A=this.pE(h));if(A&&A.listID===r.pv.listID&&A.level===
r.pv.level){const L=this.Pd.Uw(h),Z=L.Kx;b.setValue(Tn.Ds.loa,Z);b.setValue(Tn.Ds.PEa,Z);L.Se.setValue(Vc.a.listID,A.listID);L.Se.setValue(Vc.a.listLevel,A.level);if(!r.JSb||r.ged)r.kZi&&!r.ged&&(this.Pd.q0(h),b=h.currentNode,fg.OutlineElementNavigator.me(h)),b.setValue(Tn.Ds.PEa,b.getValue(Tn.Ds.loa))}else h=r.pv.Kx+1,b.setValue(Tn.Ds.loa,h),b.setValue(Tn.Ds.PEa,h)}}Cmp(b,h,r=!1){let A,L=!1;const Z=[];for(const gb of b){if(!Cd.ParagraphReader.Wb(gb.node))continue;const Ab=gb.node;L||(L=he.a.mf(gb));
if(h&&16!==h.listType){var oa=hb.a.eb(Ab);oa.zb(8);oa.uc();if(1<b.length&&this.oTj(oa,h))continue;if(!Ba){var Ba=this.Pd.Uw(oa);oa=this.r_i(h);oa=this.hBg(h,Ba,!0,oa);Ba=!oa;null!==A&&void 0!==A?A:A=oa}}Z.push(Ab)}L?Ba?this.zVh(Z,h,{Wpb:r,S7j:!0}):this.AVh(Z):Ba?this.zVh(Z,h,{Wpb:r,S7j:A}):this.AVh(Z)}zVh(b,h,{Wpb:r=!1,S7j:A=!1}={}){const L=[];for(const Ba of b){(b=Ba.LA())&&L.push([Ba,b]);b=hb.a.eb(Ba);b.zb(8);b.uc();let gb;var Z=this.Bzi(Ba);const Ab=this.infoAtLevel(b,h),Jb=sf.ListItemReader.De?
null:b.Vb(4);if(sf.ListItemReader.De?sf.ListItemReader.isListItem(Ba):Jb)if(sf.ListItemReader.De||b.uc(),!A||oa)({listLevel:gb}=sf.ListItemReader.nla(b)),this.hca(b,void 0,!0);else{var oa=this.Nhf(Ab,sf.ListItemReader.De?Ba:Jb,-1,h.YA).pv;continue}this.GOj(Ba);oa||(oa=this.tAi(h,b,Ab,!1,r),this.NNj(oa,Ab),null==oa||r||Ab.Uz!==this.Pd.f9a(b.currentNode,oa.pv).Uz?(oa=Eb.a.J2(b),0<oa&&(Z+=oa),oa=this.Psf(Ba.Hc.Np(),h,Z,h.YA)):oa=oa.pv);Z=oa.level;null!=gb&&(oa.level=gb);this.B_b(b,oa);null!=gb&&(oa.level=
Z)}if(!this.czb)for(const [Ba,gb]of L)Ba&&gb&&this.kq.YP(Ba,gb,this.Zd.Bg);this.P0()}AVh(b){for(const h of b)b=hb.a.eb(h),b.zb(8),b.uc(),this.hca(b,void 0,!0);this.P0()}IKb(b,h,{EQi:r=!1,hAn:A=-1,Wpb:L=!1,rem:Z=!1}={}){return h&&16!==h.listType?hb.a.Yea(()=>{if(!Eb.a.Mh(b))return v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),kr.Bbb();const oa=Eb.a.jN(b);return sf.ListItemReader.De&&!oa&&(v.ULS.sendTraceTag(508441813,393,15,"No paraNode was found while trying to applyListInfo"),
sf.ListItemReader.De)?kr.Bbb():oa&&xl.a(oa,8)?(v.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),kr.Bbb()):(null===oa||void 0===oa?0:oa.ra.last.Yh)?(v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),kr.Bbb()):this.Hgc(oa,()=>{var Ba=Object(so.a)().Iu(b.currentNode);const gb=h.YA,Ab=this.infoAtLevel(b,h);var Jb=sf.ListItemReader.De?null:b.Vb(4);if(sf.ListItemReader.De?sf.ListItemReader.isListItem(oa):Jb)return sf.ListItemReader.De||
b.uc(),Ba=this.Nhf(Ab,sf.ListItemReader.De?oa:Jb,A,gb),Ba.pv=this.pE(b),Ba;this.aBo(b);({listId:Jb}=sf.ListItemReader.gKf(h,{Ara:-1}));const Tb=this.Hym(Jb,Z),jc=this.Bzi(oa),Hc=this.tAi(h,b,Ab,Z,L,r);this.NNj(Hc,Ab);oa&&this.GOj(oa);return null!=Hc&&!L&&(Ab.Uz===this.Pd.f9a(b.currentNode,Hc.pv).Uz||Ok.a.aZf&&h.BEf)?(Ab.listStyle||(Hc.JSb=!0),this.K8k(Tb,Hc,b)):this.gYl(Ab,Tb,Hc,b.currentNode)?this.J8k(b,Ab,Tb,jc,gb):this.I8k(b,Ab,Ba,jc,gb,Tb,Jb)})}):(h||v.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+
h),this.hca(b))}J8k(b,h,r,A,L){r=this.ezm(h,r,A);r=this.B_b(b,r);b=sf.ListItemReader.De?sf.ListItemReader.h7(b):r;return this.Nhf(h,b,-1,L)}tAi(b,h,r,A,L,Z){var oa;L=b.Gvb?new Bo(this,hb.a.eb(b.Gvb),!1,!0):b.BEf&&Ok.a.aZf?Bo.k9l(this,h):Bo.i9l(this,h,r,A,L);if(!L)return null;Z?(L.pv.level=this.Iwm(h,r,A),this.mam(h,L)):L.pv&&(null===(oa=b.Se)||void 0===oa?0:oa.hasProperty(Vc.a.listLevel))&&(L.pv.level=b.Se.getValue(Vc.a.listLevel));return L}Hym(b,h){return h&&0<b&&b+""in this.Rig?this.Rig[b+""]:-1}ezm(b,
h,r){var A,L;const Z=new bA.a;Z.listID=h;Z.level=null!==(L=null===(A=b.Se)||void 0===A?void 0:A.zf(Vc.a.listLevel))&&void 0!==L?L:this.mbd(r);b.Se&&b.YAa&&!Tn.Ds.du&&(Z.levelText=b.levelText.replace("%1","%"+(Z.level+1)));return Z}Nhf(b,h,r,A){b=this.Unl(h,b,r,A);return kr.JAn(b)}K8k(b,h,r){let A=null;0<b&&(A=new cA(0,h.pv,-1),A.bgd=b);ai.a.Ys?this.B_b(r,h.pv):this.DOj(r,h,!1,A);return kr.$An(h.pv)}I8k(b,h,r,A,L,Z,oa){const Ba=Eb.a.J2(b);0<Ba&&(A+=Ba);r=this.Psf(r,h,A,L);this.Typ(Z,oa,r);b=this.B_b(b,
r);ai.a.Ys||h.listType||(h=h.yD,h===pk.a.Ok&&(h=1),b.setValue(Tn.Ds.loa,h),b.setValue(Tn.Ds.PEa,h));return kr.MAn(r)}hca(b,{qCj:h=!1}={},r=!1){return hb.a.Yea(()=>{if(!Eb.a.Mh(b))return v.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),kr.Bbb();const A=Eb.a.jN(b);if(ai.a.getInstance().du&&!A&&(v.ULS.sendTraceTag(508432897,393,15,"OutlineElement has listNode but no paraNode during removeListInfo [setter flight ON]"),this.Vh.KAo(b.currentNode),ai.a.getInstance().Ht))return kr.Bbb();
if(null===A||void 0===A?0:A.ra.last.Yh)return v.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),kr.Bbb();const L=b.Vb(4);return ai.a.eu||L?ai.a.eu&&!sf.ListItemReader.isListItem(A)?L?(L.Dxc=!1,b.Tg(),kr.t3f()):kr.Bbb():A?this.Hgc(A,()=>{var Z;this.yCj(A);this.iAo(A);sf.ListItemReader.De||(A.hE=null);this.Pd.aee(sf.ListItemReader.De?sf.ListItemReader.Jr(A,{Ara:0}).listId:L.ka(Vc.a.listID,0))?(L&&(L.Dxc=!1),this.CI.Vga(A,b),sf.ListItemReader.De&&!ai.a.getInstance().Ht&&
(A.hE=null)):L&&b.uc();h||this.PTo(b);if(b.Vb(4)||ai.a.eu&&sf.ListItemReader.isListItem(A))L&&(L.Dxc=!1),this.CI.Vga(A,b),sf.ListItemReader.De&&!ai.a.getInstance().Ht&&(A.hE=null);!ai.a.getInstance().Ht&&(this.Zd.Bg&&!this.czb||!this.Zd.Bg&&A.lj)&&(!A.lj||(null===(Z=A.Nx)||void 0===Z?0:Z.hasProperty(Vc.a.listID)))&&this.lKl(b);return kr.t3f()},{yap:r}):(v.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),L&&(L.Dxc=!1,b.Tg()),kr.t3f()):kr.Bbb()})}PTo(b){const h=
Object(so.a)().Iu(b.currentNode),r=Eb.a.fKa(b),A=Eb.a.qI(b),L=Eb.a.J2(b);this.S0d(h);this.Vh.PDa(b,1,Math.max(0,r+(L||-1*A)-this.TFc[0]))}Hgc(b,h,{yap:r=!1}={}){let A=null;b&&(A=b.LA());h=h();this.czb||(b&&A&&this.kq.YP(b,A,this.Zd.Bg),r||this.P0());return h}iAo(b){b.hasProperty(Vc.a.ke)&&b.removeProperty(Vc.a.ke);b.hasProperty(Vc.a.uD)&&b.removeProperty(Vc.a.uD);b.hasProperty(Vc.a.Jt)&&b.removeProperty(Vc.a.Jt)}infoAtLevel(b,h){if(!h)return null;const r=h.YA;if(1===h.at){if(h.pta&&!h.JL||!h.Fnf(!1))return h;
b=Eb.a.fKa(b);const A=this.mbd(b),L=r.TUb[A];b=Vq.a.naa(h.Se,h.Se);6===L?b.tca(1,1):b.tca(0,L);b.pxe("multilevel");b.levelText=r.obd[A];r.NJa&&r.NJa[A]&&(b.font=r.NJa[A]);b.Jx=r.oge[A];b.b9=r.b9;b.hhe=h.hhe}else b=h;return b}NNj(b,h){null!==b&&void 0!==b&&b.pv&&(h.levelText=b.pv.levelText,h.Uz||(h.font=b.pv.font))}Iwm(b,h,r){let A=Eb.a.fKa(b);const L=Eb.a.J2(b);0<L?A+=L:(b=Eb.a.qI(b),0<b&&(A-=b));h=h.Se.ka(Vc.a.listLevel,-1);return r&&0<=h?h:this.mbd(A)}mam(b,h){if(!ai.a.Ys&&!this.Ts.f9a(b.currentNode,
h.pv).listType){const r=this.DAa(b.currentNode,h.pv);b=this.a2f(h.pv,b,r);h.pv.BZc=h.pv.Kx=b.Bvb===pk.a.Ok?r.startAt-1:b.Bvb;h.JSb=b.Xak}}Typ(b,h,r){0>=b?this.Rig[h+""]=r.listID:r.listID=b}gYl(b,h,r,A){if(0>=h)return!1;const L=(Z,oa)=>Z.length!==oa.length||Z.some((Ba,gb)=>Ba!==oa[gb]);if(r)return h=this.Pd.f9a(A,r.pv),b.Uz!==h.Uz||L(b.rma,h.rma);r=b.Se.ka(Vc.a.listLevel,-1);return 0<=r&&(h=this.Ts.Yy(A,h,r))&&(h=h.ka(Ke.a.W7,null))&&b.rma?L(h,b.rma):!1}gAo(b,h){var r;const A=!!h&&Cd.ParagraphReader.Wb(h);
let L=0,Z=0;A&&(L=this.Sp.fX(sf.ListItemReader.De?h:this.Pd.bBi(b)).Qu,Z=this.Sp.qI(h).Qu);A&&this.yCj(h);(null===(r=ai.a.getInstance())||void 0===r?0:r.Ht)||b.Vb(4);this.CI.Vga(h,b);A&&this.Vh.PDa(b,1,L-Z)}Jea(b,h,r,A=-1,L=!1,Z=null,oa=!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ba=ih.a.instance.rq(vb.a.Jea),gb=this.Rc.Lc(15);gb.ju(b);let Ab=null,Jb=0;({Nwn:Ab,eUn:Jb,returnValue:A}=this.L9l(b,h,A,Ab,Jb,L,Z));if(!Ab||oa&&(1===r||0>r-Ab.pv.Kx||
2<r-Ab.pv.Kx))return gb.dispose(),Ba.end(),!1;for(;0<Jb;)b.E9d(),Jb--;this.Pyp(b,h,A,Ab);gb.dispose();Ba.end();return!0}Pyp(b,h,r,A){for(;b.E9d();){var L=sf.ListItemReader.h7(b);if(L&&(L=this.$jc(L),L.listID===h.listID)){h=new cA(0,h,r);ai.a.getInstance().du?this.IKg(b,A,L.j0,h):this.IKg(b,A,!0,h);break}}}L9l(b,h,r,A,L,Z=!1,oa=null){for(var Ba;b.JKi();){if(b.zu(4)){const gb=this.pE(b),Ab=this.Pd.Uw(b);if(Ab.listType!==oa.listType){L++;continue}if(Z&&Ab.listStyle!==oa.listStyle||!Z&&h.level<gb.level){L++;
continue}-1===r&&(r=gb.Kx+1);A=null;if(h.level===gb.level||Z)null===(Ba=this.Gpd)||void 0===Ba?void 0:Ba.KTf(b),A=new Bo(this,b,!1,!1);Z&&gb.level!==h.level&&b.zu(4)&&(b.Vb(4).setValue(Vc.a.listLevel,gb.level),b.uc());break}L++}return{returnValue:r,Nwn:A,eUn:L}}dzm(b){b=sf.ListItemReader.h7(b);return this.Y6d(b)}Y6d(b){let h;h=sf.ListItemReader.De?sf.ListItemReader.Jr(b)||sf.ListItemReader.sla(b):this.Pd.z_(b,!1,!0);return this.Pd.Yy(b,h.listId,h.listLevel)}startNewList(b,h,r){v.ULS.sendTraceTag(17622212,
324,50,"'Start New List' is selected from Context Menu.");if(h){var A=ih.a.instance.rq(vb.a.startNewList),L=this.Rc.Lc(15);L.ju(b);var Z=Vq.a.OW(0,h.listStyle,null,0,h.Se.ka(Vc.a.listLevel,-1));if(sf.ListItemReader.De)({listId:oa,listLevel:Ba}=sf.ListItemReader.nla(b,{Ara:0,pUa:-1}));else{b.Vb(4);var oa=b.currentNode.ka(Vc.a.listID,0);var Ba=b.currentNode.ka(Vc.a.listLevel,-1);b.uc()}Z.hhe=oa;var gb=h.Se.ka(Vc.a.ke,0);0<gb&&Z.Se.setValue(Vc.a.ke,gb);-1===Z.Se.ka(Vc.a.listLevel,-1)&&Z.Se.setValue(Vc.a.listLevel,
Ba);1===h.at&&((Ba=new GE.a,oa=h.eJi(b.currentNode,oa),oa)?1===oa&&(Z.pxe(kx.a.Arc),Z.YA=Ba.Rsf(Ba.acg,Ba.bcg),Z.b9=Z.YA.b9):(Z.pxe(kx.a.Arc),Z.YA=Ba.$rf(),Z.b9=Z.YA.b9));h.vsa()&&1>r&&(r=1);Z.yD=r;Ba=new lj.DictionaryPropertySet;Ba=this.y_c(vb.a.KN,Ba);oa=Eb.a.jN(b);h=this.pE(b);if(gb=this.dzm(b))Z.levelText=gb.ka(Vc.a.$w,""),Z.JL=42,Z.Jx=gb.ka(Vc.a.gga,"left");this.gAo(b,oa);({Jla:Z}=this.Bqa(Ba,b,Z,!0));b.Vb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,
15,"Graph node {0} is not list node.",b.currentNode.type);ai.a.getInstance().Ht||b.currentNode.setValue(Vc.a.listLevel,h.level);ai.a.getInstance().du&&({listId:Z}=sf.ListItemReader.Jr(ai.a.getInstance().E7?oa:b.currentNode),this.CI.A_b(oa,Z,h.level));b.uc();Z=new Bo(this,b,!1,!1);r=new cA(1,h,r);this.IKg(b,Z,!!ai.a.getInstance().du,r);L.dispose();A.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}MZf(b){if(!b)return!1;const h=b.Vb(2);h&&b.uc();return h&&12===
h.type&&h.ra&&h.ra.last&&h.ra.last.Yh?!0:!1}tpe(b,h,r,A){return this.ODk.tpe(b,h,r,A)}fvg(b,h){if(!b||!h)return!1;const r=b.Se.ka(Vc.a.$w,null);h=h.Se.ka(Vc.a.$w,null);if(!r||!h)return!1;const A=b.Se.ka(Ke.a.font,null);b=b.Se.ka(Ke.a.font,null);return r===h&&A===b}mPj(b,h,r){r||h.listType||(h.yD=b.ka(Ke.a.GU,pk.a.Ok))}RAi(b,h){if(!h)return null;const r=Array(9),A=h.hhe;if(!this.znn(h,b)||1>A)return null;for(h=0;9>h;h++){const L=this.Pd.Yy(b,A,h);if(null===L||void 0===L?0:L.hasProperty(Vc.a.ke))r[h]=
L.getValue(Vc.a.ke);else return null}return r}znn(b,h){if(!b)return!1;const r=b.Se.ka(Vc.a.listLevel,-1);b=b.Se.ka(Vc.a.ke,-1);if(0>r||0>b)return!1;this.S0d(h);return b!==this.P5b[r]}KNh(b,h,r){b&&b.setValue(Vc.a.ke,h?h[r]:this.P5b&&r<this.P5b.length?this.P5b[r]:720*(r+1))}mqi(b,h,r,A,L=null,Z=!1){if(!ai.a.Ys){var oa=new hb.a,Ba=this.DAa(b,h);oa.set(b);oa.Nd();b=uw.a.At(oa,oa.PAb());b.zp(Sy.a.ohe,null);for(var gb=-1;b.moveNext();){if(!sf.ListItemReader.Fg(oa))continue;const Ab=this.pE(oa),Jb=Eb.a.jN(oa);
this.Pd.q0(oa);const Tb=oa.currentNode;oa.uc();if(r!==this.Bze||Ab.listID===h.listID){if(Z){if(-1!==gb&&gb>Ab.level)break;if(-1===gb)gb=Ab.level;else if(Ab.level!==gb)continue}else{if(Ab.level<=Ba.idb)break;if(!r(h,Ab,L))continue}A(Tb,Jb,h.listID,L)}}}}Dcm(b,h,r,A){if(!ai.a.Ys){var L=new hb.a,Z=this.DAa(b,h);L.set(b);L.Nd();if(sf.ListItemReader.Fg(L)){b=this.pE(L);var oa=Eb.a.jN(L);this.Pd.q0(L);var Ba=L.currentNode;L.uc();b.level<=Z.idb||r(h,b,null)&&A(Ba,oa,h.listID,null)}}}Ccm(b,h,r,A,L=null){const Z=
new hb.a;Z.nd(b);A(b,h,this.pE(Z),Z,0);this.P3d(b,h,r,A,L)}P3d(b,h,r,A,L=null){let Z=new hb.a;const oa=this.DAa(b.currentNode,h);let Ba=null,gb=0;var Ab=new hb.a;Ab.nd(b);Ab.zb(10);const Jb=Dd.a.At(Ab,Ab.origin);for(Jb.moveNext();Jb.moveNext();)if(Ba=null,Z=Jb.iterator,1===Z.role&&(Ba=Jb.currentNode,Z.zu(4)&&(Ab=this.pE(Z),r(h,Ab,L))))if(Ab.level>h.level)A(b,h,Ab,Z,gb),gb++;else if(Ab.level===h.level||Ab.level<=oa.idb)break;return Ba?Z:null}syj(b,h,r,A){ai.a.Ys||this.DAa(b.currentNode,r).idb>=h.level&&
this.Vnl(A)}static zOj(b,h){h.setValue(Ke.a.font,b.pta||b.o8c||b.K5c?b.font:"Symbol")}static BOj(b,h){b=b.pta||b.o8c||b.YAa?b.levelText:pk.a.pZd;v.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Vc.a.$w,b)}static AOj(b,h){b=b.Se.ka(Vc.a.gga,"left");h.setValue(Vc.a.gga,b)}}Tu.LLn=2147450879;Tu.Xdj=1;Object(u.a)(Tu,"FlatListEditorCssVersion",Tn,[685,686]);class QE{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){this.Ts=b;this.c8n=h;this.Mf=r;this.Yo=A;this.jC=L;this.GAn=Z;this.Qd=oa;this.Lj=Ba;this.RAn=
gb;this.rc=Ab;this.Yb=Jb;this.mM=Tb;this.CI=jc}create(){return new Tu(this.Ts,this.c8n,this.Mf,this.Yo,this.jC,this.GAn,this.Qd,this.Lj,this.RAn,this.rc,this.Yb,this.mM,this.CI)}}Object(u.a)(QE,"FlatListEditorFactory",null,[]);class IJ{constructor(){this.startAt=this.listLevel=this.listId=0;this.Gvb=null}}Object(u.a)(IJ,"ListAutoCorrectionRefInfo",null,[]);class JJ{constructor(b,h){this.lDk=b;this.lg=h}tpe(b,h,r,A){if(!b.hasProperty(Od.a.JLa))return!0;h=hb.a.eb(h.currentNode);he.a.Ou(h);let L=!0;
if(!r.listType&&!A){23===h.uf&&h.xL(1);A=b.ka(Od.a.JLa,1);if(1<A){var Z=new hb.a;Z.nd(h);Z.zb(10);Z=Dd.a.Bo(Z.origin);A=this.K9l(Z,A,r,h.currentNode);r.Gvb||(L=!1)}b.setValue(Od.a.JLa,A)}return L}K9l(b,h,r,A){const L=new nb.a;for(;b.moveNext()&&b.iterator.currentNode!==A;){const Z=b.iterator;if(!Z.zu(4))continue;const oa=this.lDk.value.pE(Z),Ba=this.lg.Uw(Z);this.Lko(L,oa);Ba.listType===r.listType&&Ba.listStyle===r.listStyle&&(0>h-oa.Kx||2<h-oa.Kx||L.add(Object.assign(new IJ,{listId:oa.listID,listLevel:oa.level,
Gvb:Z.currentNode,startAt:oa.Kx+1})))}0<L.count&&(h=L.K(L.count-1).startAt,r.Gvb=L.K(L.count-1).Gvb);return h}Lko(b,h){let r=0;for(;r<b.count;){const A=b.K(r);A.listId===h.listID&&A.listLevel>=h.level?b.removeAt(r):r++}}}Object(u.a)(JJ,"ListAutoCorrector",null,[649]);class lH{constructor(b,h,r,A,L){this.zeb=(Z,oa,Ba)=>{var gb;Z=sf.ListItemReader.De?sf.ListItemReader.T2c(oa):this.BXc(oa);if(!Z||this.Zt.MZf(Z))return 8;oa=this.Zt.pE(Z);if(1===oa.Kx||this.B9c(oa.level))return 8;oa=null===(gb=this.Pd)||
void 0===gb?void 0:gb.Uw(Z);if(!oa||this.yZi(oa))return 8;if(1===Ba)return 32;this.Zt.startNewList(Z,oa,1);return 32};this.yeb=(Z,oa,Ba)=>{Z=sf.ListItemReader.De?sf.ListItemReader.T2c(oa):this.BXc(oa);if(!Z||this.Zt.MZf(Z))return 8;oa=this.Zt.pE(Z);if(this.B9c(oa.level))return 8;const gb=this.Pd.Uw(Z);if(!gb||this.yZi(gb))return 8;if(1===Ba)return 32;this.VYc.tBm(Z.currentNode,oa.Kx,this.Pd,this.Zt,this.Z_a);return 32};this.Jea=(Z,oa,Ba)=>{Z=sf.ListItemReader.De?sf.ListItemReader.T2c(oa):this.BXc(oa);
if(!Z||this.Zt.MZf(Z))return 8;oa=this.Zt.pE(Z);if(1!==oa.Kx||this.B9c(oa.level))return 8;if(1===Ba)return 32;Ba=this.Pd.Uw(Z);return this.Zt.Jea(Z,oa,Ba.yD,-1,!1,Ba)?32:8};this.lzb=(Z,oa,Ba,gb,Ab)=>{Z=sf.ListItemReader.De?sf.ListItemReader.T2c(oa):this.BXc(oa);if(!Z)return 8;oa=this.Zt.pE(Z);if(this.B9c(oa.level))return 8;if(1===Ba)return 32;Ba=this.Pd.Uw(Z);this.Zt.startNewList(Z,Ba,Ab);return 32};this.Snb=(Z,oa,Ba,gb,Ab)=>{Z=sf.ListItemReader.De?sf.ListItemReader.T2c(oa):this.BXc(oa);if(!Z)return 8;
oa=this.Zt.pE(Z);return this.B9c(oa.level)?8:1===Ba?32:this.Zt.Jea(Z,oa,oa.Kx,Ab)?32:8};this.Pb=b;this.Pd=r;this.Zt=A;this.VYc=L}B9c(b){return 0>b}Xb(){this.Pb.qa(vb.a.zeb,kc.a.eS,this.zeb);this.Pb.qa(vb.a.zeb,kc.a.Vc,this.zeb);this.Pb.qa(vb.a.zeb,kc.a.view,this.zeb);this.Pb.Pc(vb.a.zeb,12);this.Pb.qa(vb.a.yeb,kc.a.eS,this.yeb);this.Pb.qa(vb.a.yeb,kc.a.Vc,this.yeb);this.Pb.qa(vb.a.yeb,kc.a.view,this.yeb);this.Pb.Pc(vb.a.yeb,12);this.Pb.qa(vb.a.Jea,kc.a.eS,this.Jea);this.Pb.qa(vb.a.Jea,kc.a.Vc,this.Jea);
this.Pb.qa(vb.a.Jea,kc.a.view,this.Jea);this.Pb.Pc(vb.a.Jea,12);this.Pb.qa(vb.a.lzb,kc.a.eS,this.lzb);this.Pb.qa(vb.a.lzb,kc.a.Vc,this.lzb);this.Pb.qa(vb.a.lzb,kc.a.view,this.lzb);this.Pb.Pc(vb.a.lzb,12);this.Pb.qa(vb.a.Snb,kc.a.eS,this.Snb);this.Pb.qa(vb.a.Snb,kc.a.Vc,this.Snb);this.Pb.qa(vb.a.Snb,kc.a.view,this.Snb);this.Pb.Pc(vb.a.Snb,12)}get Z_a(){return Wa.a.instance.resolve("Common.IStandaloneRootController").uha}BXc(b){return this.Zt.Oym(b)}yZi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}
Object(u.a)(lH,"ListContextMenuSectionActor",null,[]);var Hm=d(609);class qv{static get QAn(){return Dg.a.uy(qv.lo,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}qv.lo="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(qv,"ListSetStartValueDialogHtml",null,[]);class Uu extends Dg.a{constructor(b,h,r,A,L){super();this.LHd=this.CNe=this.dId=this.L8e=null;this.uPe=!0;this.TV=!1;this.yjb=0;this.CWj=[vb.a.yyg,vb.a.nDg,vb.a.xng];this.ZZo=(Z,oa)=>{Z=oa[Ji.a.Number];this.nda=Number.isInteger(oa[Ji.a.Number])&&Z>=this.yjb?Z:this.yjb};this.ILm=(Z,oa)=>{this.nda=this.nda>=this.yjb?this.nda:this.yjb;oa[Ji.a.Number]=this.nda;oa[Ji.a.UnitType]=0};this.TWo=(Z,oa)=>{if(1===Z){var Ba=oa.ListRadioStartNew,gb=oa.ListRadioContinue,
Ab=hb.a.eb(this.Tf);Ab.Nd();oa=this.Zt.pE(Ab);Z=this.lg.Uw(Ab);if(Ba)this.Zt.startNewList(Ab,Z,this.nda);else if(gb)if(this.uPe)this.Zt.Jea(Ab,oa,this.b2e,-1,!1,Z);else{Ba=!0;for(gb=null;Ab.cP();)if(sf.ListItemReader.Fg(Ab)){gb=new Bo(this.Zt,Ab,!1,!1);break}if(!gb||this.Zt.pE(Ab).Kx>=this.nda)Ba=!1;Ba?(Ab=hb.a.eb(this.Tf),Ab.Nd(),this.Zt.Jea(Ab,oa,this.b2e,this.nda,!1,Z)):(this.dispose(),this.HNa(CommonUIStrings.l_ErrorDialogMessage,this.PAn))}}};this.PAn=()=>{new Uu(this.Tf,this.b2e,this.lg,this.Zt,
this.Ed)};this.s4n=()=>{document.getElementById(Uu.W6i).style.visibility="visible"};this.YXn=()=>{document.getElementById(Uu.W6i).style.visibility="hidden"};this.Ig="ListSetStartValueDialog";this.mh=qv.QAn;this.Tf=b;this.nda=h;this.lg=r;this.b2e=h;this.K9=A;h=new hb.a;b?(h.set(b),h.Nd(),Eb.a.Mh(h)||fg.OutlineElementNavigator.me(h),sf.ListItemReader.Fg(h)&&(b=null,sf.ListItemReader.De?b=this.lg.Uw(h):(h.Vb(4),h=h.currentNode,22===h.type&&(b=this.lg.M2(h))),b&&(b.vsa()?this.yjb=1:this.yjb=0))):this.yjb=
1;this.Ed=L;this.Uh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.TWo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.uPe&&(this.L8e=document.getElementById("ListRadioStartNew"),this.dId=this.s4n,this.CNe=document.getElementById("ListRadioContinue"),this.LHd=this.YXn,zc.a.addHandler(this.L8e,"click",this.dId),zc.a.addHandler(this.CNe,"click",this.LHd));for(const Z of this.CWj)Object(Hm.a)(Z,this.ZZo,this.ILm);this.Ed.xn()}get Zt(){return this.K9}dispose(){if(!this.TV){for(const b of this.CWj)Object(Hm.b)(b);
this.uPe&&(this.dId&&zc.a.removeHandler(this.L8e,"click",this.dId),this.LHd&&zc.a.removeHandler(this.CNe,"click",this.LHd));this.Ed.B0("ListStartSpinner");super.dispose();this.TV=!0}}Ygl(){const b=Ak.l("none",this.yjb+"","100","1");return Ak.j(Uu.X6i,vb.a.yyg,vb.a.xng,Box4Intl.Box4Strings.l_SetValueTo,[b],null,vb.a.nDg)}RKb(b){const h=document.getElementById(Uu.X6i);this.Ed.r5a("ListStartSpinner",b);b=this.Ed.OPb("ListStartSpinner","Medium");h.appendChild(b)}Jba(){const b=this.Ygl();this.RKb(b)}}
Uu.X6i="SetListStartSpinnerContainer";Uu.W6i="ListStartAtSpinnerBox";Object(u.a)(Uu,"ListSetStartValueDialog",Dg.a,[]);class Np{tBm(b,h,r,A,L){new Uu(b,h,r,A,L)}static get instance(){return Np._instance||(Np._instance=new Np)}}Np._instance=null;Object(u.a)(Np,"ListDialogFactory",null,[650]);class mH{constructor(b,h,r){this.K9=b;this.lg=h;this.Rc=r}KTf(b){v.ULS.shipAssertTag(40420184,393,Eb.a.Mh(b));if(sf.ListItemReader.Fg(b)){const h=this.lg.Uw(b);h.at||this.p6m(b,h)}}qql(b){for(let h=0;h<b.length;h++){const r=
new hb.a;r.set(b.getContext(h).node);this.KTf(r)}}p6m(b,h){const r=Object(so.a)().Iu(b.currentNode),A=this.K9.pE(b),L=this.Rc.Lc(15);L.ju(b);h=this.K9.U8k(r,b,h);this.K9.Uyp(b,A.listID);L.dispose();this.lg.f9a(b.currentNode,h)}}Object(u.a)(mH,"SingleLevelListEditor",null,[648]);var Pv=d(402);class BB{Avj(b,h,r,A,L,Z){return b?y.AFrameworkApplication.va.Hf(b,h,r,!0,L,Z):8}}Object(u.a)(BB,"ListContextManager",null,[1599]);class Tr extends BB{constructor(b){super();Tr.aJc=b}Avj(b,h,r,A,L,Z){if(!b||!b.length)return 8;
let oa;const Ba=({hUm:b,gUm:oa}=Tr.fr.eUm(b)).returnValue;let gb=1;for(const Jb of Ba.keys){var Ab=b.contains(Jb);const Tb=Ba.K(Jb);Tr.fr.Pll(Ba.K(Jb),this.dVc(h),Ab)?Ab?(v.ULS.sendTraceTag(508350475,393,50,"List Actions: {0} lists, with change in level",this.dVc(h)?"Promote":"Demote"),Ab=y.AFrameworkApplication.va.Hf(Pv.a.IIa(Tb),h,r,A,L,Z)):(v.ULS.sendTraceTag(508350474,393,50,"List Actions: {0} lists, without change in level",this.dVc(h)?"Promote":"Demote"),Ab=Tr.fr.b8n(Ba.K(Jb),this.dVc(h),oa.K(Jb))):
(v.ULS.sendTraceTag(508350476,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.dVc(h)?"Promote":"Demote"),Ab=8);gb=Vd.ActionManager.rdd(gb,Ab)}return gb}dVc(b){return b===vb.a.KI?!0:!1}static get fr(){return Tr.aJc||(Tr.aJc=Wa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Tr.aJc=null;Object(u.a)(Tr,"WordEditorListContextManager",BB,[]);class Qv{get name(){return"WordEditor.ListEditors"}wc(b){y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("WordEditor.ListEditors.IListAutoCorrector",()=>new JJ(b.nf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).ha(),b.ia("WordEditor.IFlatListEditor",()=>(new QE(b.resolve("WordEditor.List.IFlatListReader"),b.nf("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new Ko.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ia("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ia("Box4.List.ISingleLevelListEditor",()=>new mH(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",
()=>new Tr(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new lH(y.AFrameworkApplication.va,new Xi.a,Qv.Pd,Qv.Zt,Np.instance)).Xb();const b=y.AFrameworkApplication.va;b.fb(vb.a.xng,kc.a.view,Hm.d,96);b.fb(vb.a.nDg,kc.a.view,Hm.c,96);b.fb(vb.a.yyg,kc.a.view,Hm.c,96)}dispose(){}static get Pd(){return null!=Qv.u0g?Qv.u0g:Qv.u0g=Wa.a.instance.resolve("Box4.List.IListReader")}static get Zt(){return null!=Qv.NVg?Qv.NVg:
Qv.NVg=Wa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){E.a.instance.Mc(new Qv)}}Object(u.a)(Qv,"WordEditorListEditorsPackage",null,[0,1]);var oL=d(1718),Ty=d(527),RE=d(458),KJ=d(258);class dA extends KJ.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=null}Om(){return RE.a.Qqj}static qka(b,h){const r=new dA;r.FileId=b;r.LastKnownPaginationRevision=wp.a(h);return r}}Object(u.a)(dA,"PaginationRequest",KJ.a,[]);class Uy extends ic.a{constructor(b,h,r,A,L,Z){super(b,
h);this.styleId=null;this.jr=0;this.Dta=null;this.characterData=r;this.paragraphNode=A;this.listMarker=L;this.ERb=Z}}Object(u.a)(Uy,"HeadingText",ic.a,[]);var ZC=d(358),Ct=d(1014);class LJ{constructor(b,h,r,A,L,Z){this.gQi=!0;this.Qqc=0;this.VAc=8;this.g0m=oa=>{if(oa.xs)return!0;oa=oa.role;return 1===oa||2===oa||4===oa};this.gDk=b;this.AG=h;this.xe=r;this.lg=A;this.tJ=L;this.HS=Z}get nv(){return this.gDk.value}async hvm(){const b=await this.XDm();return this.yuj(b,!0)}ivm(){return this.yuj([],!1)}yuj(b,
h){const r=window.performance.now(),A=this.Wyi();if(!A)return null;const L=new nb.a;let Z=0;for(;A.moveNext();){var oa=A.iterator;if(11===oa.uf){const Ba=sf.ListItemReader.h7(oa),gb=fg.OutlineElementNavigator.Me(oa,!0);h&&b[Z]&&b[Z].ParaId===Cd.ParagraphReader.rU(gb)&&Z++;fg.OutlineElementNavigator.me(oa);if(!gb||!Cd.ParagraphReader.Wb(gb)||gb.Fq||""===gb.characterData||"\ufffc"===gb.characterData)continue;const Ab=this.o6d(gb);Ab&&(Ba&&(Ab.listMarker=this.tJ.HXa(Ba,!1).FU,oa=this.lg.Uw(oa),1===oa.listType&&
oa.K5c&&(Ab.Dta=oa.font)),h&&(b[Z-1]&&b[Z-1].ParaId===Cd.ParagraphReader.rU(gb)?Ab.jr=Z:Ab.jr=Z+1),L.add(Ab))}}v.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-r));return L}XDm(){const b=new Pg.a;var h=dA.qka(y.AFrameworkApplication.rootQuerySignature,null);const r=new og.a;r.kr=h;r.status=Ct.a.MI;this.LHk=window.performance.now();h=this.HS.Jaa(0,()=>{if(2!=r.statusCode||null==r.Nk||0==r.Nk.length||null==r.Nk[0]){const A=String.format("GetPageEndsOperation Failed with status code: {0};",
r.statusCode);b.setException(Error.create(A));v.ULS.sendTraceTag(543802465,3019,10,A)}else b.gg(r.Nk[0].PageEnds),v.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.LHk))});h.MG(r);h.i_();return md.b(b.task)}Vyi(){const b=this.Wyi();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.uf){const A=fg.OutlineElementNavigator.Me(r,!0);fg.OutlineElementNavigator.me(r);A&&Cd.ParagraphReader.Wb(A)&&!A.Fq&&""!==A.characterData&&
"\ufffc"!==A.characterData&&this.o6d(A)&&h++}}return h}Wyi(){if(!this.nv)return v.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.AG.qU(this.nv);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=hb.a.eb(b);if(!b.Ks())return v.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Dd.a.At(b,b.origin);b.zp(this.g0m,null);return b}o6d(b){var h;return null!==(h=this.RRm(b))&&void 0!==h?h:this.oEm(b)}RRm(b){if(!this.Uvn(b))return null;
var h=Object(ZC.c)(9);h=Object(ZC.a)(h);h=[...Cd.ParagraphReader.gCf(b,h)];if(0===h.length)return null;const r=Cd.ParagraphReader.zAa(b)+1;return this.W5h(b,h,r)}oEm(b){var h,r,A,L,Z=Object(ZC.c)(9);Z=Object(ZC.a)(Z);const oa=Cd.ParagraphReader.m4c(b),Ba=this.xe.IF(b),{h0m:gb,W$l:Ab}=this.$Mm(oa,Ba,Z);Z=null!==(L=null!==(r=null===(h=Ab.linkedStyle)||void 0===h?void 0:h.ERb)&&void 0!==r?r:null===(A=Ab.Lw)||void 0===A?void 0:A.ERb)&&void 0!==L?L:10;return this.c$c(Z-1)?this.W5h(b,gb,Z):null}W5h(b,h,
r){var A;if(!this.c$c(r-1))return null;const {h3j:L,g3j:Z}=this.Gpp(b,h);return 0===L.length?null:(h=null===(A=Cd.ParagraphReader.$8d(b,L))||void 0===A?void 0:A.trim())&&""!=h?new Uy(Z.yd,Z.endCp,h,b,null,r):null}$Mm(b,h,r){const A=[];let L={linkedStyle:null,Lw:null},Z=null,oa=null;for(const Ba of b)if(Z=Ba.v6.formatting?this.evm(h,Ba.v6):Z,b=r(Ba)){if(!oa&&b){oa=Z;if(!oa)break;L=Z}else if(!this.xln(Z,oa))break;A.push(Ba)}return{h0m:A,W$l:L}}Gpp(b,h){var r;let A=-1,L;for(L=0;L<h.length;L++){var Z=
h[L],oa=b.characterData.substring(Z.v6.cp,Z.cpEnd),Ba=null===oa||void 0===oa?void 0:oa.trimStart();if(Ba){A=Z.v6.cp+(oa.length-Ba.length);break}}if(-1===A)return{h3j:[],g3j:{yd:-1,endCp:-1}};Z=-1;for(oa=h.length;0<oa;oa--){Ba=h[oa-1];const gb=b.characterData.substring(Ba.v6.cp,Ba.cpEnd),Ab=null===gb||void 0===gb?void 0:gb.trimEnd();if(Ab){Z=Ba.cpEnd-(gb.length-Ab.length);break}}return{h3j:null!==(r=h.slice(L,oa))&&void 0!==r?r:[],g3j:{yd:A,endCp:Z}}}xln(b,h){return null==b&&null==h&&b===h?!0:null==
b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.ERb===b.linkedStyle.ERb||h.Lw&&b.Lw&&h.Lw.E0h==b.Lw.E0h?!0:!1}evm(b,h){h=Ya.FormattingReader.MAa(h.formatting);b=this.gvm(b,h);h=this.dvm(h);return b||h?{linkedStyle:b,Lw:h}:null}gvm(b,h){b=this.xe.Tqb(h,b);if(!b)return null;h=b.ka(Vc.a.Jj,9);return this.WSj(h)?{g8p:b.id,ERb:h+1}:null}dvm(b){var h;b=this.xe.Be(b);if(!b||!Ki.a.F3i(b))return null;const r=null!==(h=Ki.a.m3c(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.c$c(h-1)?
{E0h:b,ERb:h}:null}Uvn(b){const h=Cd.ParagraphReader.zAa(b);if(!this.c$c(h))return!1;if(this.WSj(h))return!0;b=this.xe.Cq(b);b=this.xe.Be(b);return Ki.a.lpc(b)?!0:!1}WSj(b){return this.gQi&&this.c$c(b)}c$c(b){return b>=this.Qqc&&b<=this.VAc}}Object(u.a)(LJ,"StyleBasedDocumentHeadings",null,[492]);var nH=d(1002);class SE{constructor(){this.startTime=0}}Object(u.a)(SE,"TocCallbackData",null,[]);class rv{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.jLg=(Tb,jc,Hc)=>{const hd=jc.node;if(!hd)return v.ULS.sendTraceTag(36705296,
324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==hd.type)return v.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!hd.Fq)return 2;if(1===Hc)return cc.SessionStatusManager.instance.Jk?8:32;this.Fd&&this.Fd.isFeatureEnabled(112)?this.NQc.uxp(hd).then(Gd=>{Gd||this.w9j(hd)}):this.w9j(hd);return 32};this.MBp=Tb=>{Tb=window.performance.now()-Tb.startTime;v.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",
Tb));Tb=Object.assign(new Na.a,{durationMs:Tb});xa.Health.instance.recordKpiSuccess(rv.rck,Tb);rv.ffb()};this.ISi=(Tb,jc,Hc,hd,Gd)=>{if(Cd.ParagraphReader.Wb(jc.node)&&jc.node.Fq)return 2;if(1===Hc)return cc.SessionStatusManager.instance.Jk?8:32;if(jc.contextId!==kc.a.Vc||this.xl.jba(jc)||!Cd.ParagraphReader.Wb(jc.node))return 32;this.Zd.Yu(17);(null===Gd||void 0===Gd?0:Gd.resolve)?this.NQc.p9h(jc,Gd.resolve):this.NQc.p9h(jc);return 32};this.rrg=(Tb,jc,Hc)=>{Tb=jc.node;if(!Tb)return v.ULS.sendTraceTag(39358978,
324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==Tb.type)return v.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!Tb.Fq)return 2;if(1===Hc)return cc.SessionStatusManager.instance.Jk?8:32;Hc=null;Tb.isConnected&&(Hc=nH.a.ikc(Tb,!0),Hc.bAc(Tb));jc=new hb.a;jc.set(Tb);jc.zb(8);jc.kd(8);const hd=this.Rc.Lc(15);hd.ju(jc);this.NQc.Jzo(Tb)?(hd.dispose(),Hc&&Hc.normalize(),rv.ffb()):(Hc&&Hc.cancel(),hd.dispose(),v.ULS.sendTraceTag(556565975,
3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.Rwd=h;this.fd=A;this.Rc=L;this.xl=Z;this.NQc=oa;this.Zd=Ba;this.Fd=gb;this.Yih=Ab;this.DQ=Jb}Xb(){this.ga.qa(vb.a.o2b,kc.a.paragraph,this.jLg);this.ga.qa(vb.a.o2b,kc.a.Cd,this.jLg);this.ga.qa(vb.a.o2b,kc.a.Vc,this.jLg);this.ga.Pc(vb.a.o2b,1028);this.ga.qa(Ec.a.bVf,kc.a.Vc,this.ISi);this.ga.Pc(Ec.a.bVf,1028);this.ga.qa(Ec.a.Bkd,kc.a.paragraph,this.rrg);this.ga.qa(Ec.a.Bkd,kc.a.Cd,this.rrg);this.ga.qa(Ec.a.Bkd,kc.a.Vc,this.rrg);this.ga.Pc(Ec.a.Bkd,
1028)}w9j(b){xa.Health.instance.recordKpiUsage(rv.rck,1,rv.UB,null);const h=this.Kim(b),r=new SE;r.startTime=window.performance.now();this.Rwd.KLj(h,Vc.a.qKg,this.sQm(this.lEm(b)),this.MBp,null,r);this.NQc.Qol()}lhk(b){if(null!=b&&b.Fq)if(null==this.Yih.instance)v.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.Yih.instance.dDi();b=this.D9l(b);var r=!1;1===this.DQ.Gv&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new da.a,{name:"TOCPageNo",string:b}),Object.assign(new da.a,
{name:"HeadingPageNo",string:h}),Object.assign(new da.a,{name:"isMainView",string:r})],me.a("TOCPageNoMismatch",!0,void 0,h))}}D9l(b){for(let h=0;h<b.ra.length;h++){const r=b.ra.Ub(h);if(null!=r.lc)for(let A=0;A<r.lc.length;A++){const L=r.lc.K(A);if(1===L.pe&&L.tX.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,b.characterData.length-r.cp))}}return 0}lEm(b){return b?b.ka(Vc.a.gQ,null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}Kim(b){return this.fd.osa(b,
7,7).Vb(35)}sQm(b){const h=[];h.push(b+",TOC,0");return h}static ffb(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},rv.Eza)}}rv.Eza=5E3;rv.rck="WordUpdateTOC";rv.UB="wwaengidc";Object(u.a)(rv,"TableOfContentsActor",null,[491]);class TE{}Object(u.a)(TE,"FieldData",null,[]);class oH extends TE{constructor(){super();
this.cAb=null}}Object(u.a)(oH,"TOCFieldData",TE,[]);class CB{constructor(b,h,r,A,L,Z=null){this.j0m=b;this.tu=h;this.jr=r;this.HYj=A;this.listMarker=L;this.Dta=Z}}Object(u.a)(CB,"TOCHeadingData",null,[]);class Cr{constructor(b,h){this.Z1a=b;this.Ep=h}async Xyi(b){this.Z1a.gQi=b.BTf;this.Z1a.Qqc=b.Qqc;this.Z1a.VAc=b.VAc;return this.Z1a.hvm()}wjm(b){if(b=this.vjm(b))return this.Ep.mAa(b)}vjm(b){const h=b.ra.length;for(let r=0;r<h;r++){const A=b.ra.Ub(r);if(A.hyperlink&&A.hyperlink.Sla&&A.hyperlink.url.startsWith(F.a.T5a))return A.hyperlink.url.substr(A.hyperlink.url.indexOf("_Toc"))}return null}ute(b){(b=
this.wjm(b))&&this.Ep.xcg(b.id)}aNm(){return this.Z1a.Vyi()}Buj(b,h){const r=new oH,A=new nb.a;for(const L of b){b=this.ZMm(L,h);if(!b)return null;A.add(b)}r.cAb=A;return r}ZMm(b,h){let r;if(h&&(r=this.gEl(b),!r))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=On.AParagraphNode.KP(b.characterData.trim());const A=this.XOm(b.ERb);return new CB(h,r,b.jr,A,b.listMarker,b.Dta)}gEl(b){const h=String.format("{0}{1}","_Toc",Sf.a.wD());return this.Ep.Tbc(h,
b.Dc,b.end,b.paragraphNode,b.paragraphNode)?h:null}XOm(b){return String.format("toc {0}",b)}}Object(u.a)(Cr,"TOCDataManager",null,[490]);class DB{dCg(){const b=Object.assign(new Ag.StandardDialog,{Au:y.AFrameworkApplication.Qfa,Bd:0,TNa:!1});b.qY(1);b.Cna(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=DB.NYg?DB.NYg:DB.NYg=new DB}}Object(u.a)(DB,"TOCDialogHelper",null,[]);var pL=d(168),pH=d(515),
qH=d(291),Kg=d(148);class sv{constructor(b,h,r,A,L,Z,oa){this.eCg=b;this.ltb=h;this.BTf=r;this.Qqc=A;this.VAc=L;this.iKb=Z;this.Esd=[];this.tX=oa}toString(){return"showPageNumber:"+this.eCg+"  isHyperlink:"+this.ltb+" includeOutlineLevels:"+this.BTf+" lowerOutlineLevel:"+this.Qqc+" upperOutlineLevel:"+this.VAc+" addContentControl:"+this.iKb+" unsupportedSwitches:"+this.Esd.toString()}}Object(u.a)(sv,"TOCSettings",null,[]);class gk{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe){this.Vmh=
"TOC";this.Fpb=this.mOe=this.T$e=null;this.Teb=b;this.Vh=h;this.iF=r;this.ew=A;this.hy=L;this.xl=Z;this.ib=oa;this.Rd=Ba;this.WHh=gb;this.Ee=Ab;this.R$e=Jb;this.fq=jc;this.nO=Hc;this.yo=hd;this.Rc=Gd;this.Jb=de;this.th=qe;this.hb=oe}get Y7c(){return this.Vmh}set Y7c(b){this.Vmh=b}get dAb(){this.T$e||(this.T$e=this.ywi());return this.T$e}ywi(){return new sv(!0,!0,!0,0,8,!0,this.Rfo())}async p9h(b,h){me.a(gk.kLl);const r=window.performance.now();if(this.hb.Wb(b.node))if(this.xl.jba(b))v.ULS.shipAssertTag(592233794,
3019,!1,"We can't insert table of contents, current insertion point is in locked range"),gk.NXa("IP is in locked range");else{var A=await this.Teb.Xyi(this.dAb);if(A){var L=new mf.a(2,1,0,()=>{this.mLl(b,A,this.dAb.ltb,r);h&&h()});this.Jb.$b(L)}else v.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),gk.NXa("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),gk.NXa("Context should be paragraph")}mLl(b,
h,r,A=0){let L;try{if(0==A&&(A=window.performance.now()),this.bni(b.node)){var Z=new hb.a;Z.set(b.node);Z.zb(7);Z.kd(7);L=this.Rc.Lc(15);L.ju(Z);var oa=this.Teb.Buj(h,r);oa||gk.NXa("Failed to prepare TOC Field data");var Ba=oa.cAb?oa.cAb.count:0;if(Ba){h=null;var gb;for(r=0;r<Ba;r++){const jc=oa.cAb.K(r);if(!({jNb:gb}=this.ESi(b,h,r,Ba,jc,Jb?Jb.toString():void 0)).returnValue){gk.NXa("Failed to populate new TOC paragraph");return}if(0==r){var Ab=gb.currentNode;var Jb=Cd.ParagraphReader.rU(Ab)}h=gb}if(this.dAb.iKb&&
!this.Urf(Ab.id,h.Aq.id))gk.NXa("Failed to add content control block");else{var Tb=window.performance.now()-A;me.a(gk.rtf,!0,Tb)}}else if(this.R$e.dCg(),this.EFl(b)){const jc=window.performance.now()-A;me.a(gk.rtf,!0,jc)}}else gk.NXa("Failed to fetch style set")}catch(jc){gk.NXa(String.format("{0} {1}",jc.message,jc.stack))}finally{L&&L.dispose()}}bni(b){this.mOe=this.hy.IF(b);return this.mOe?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static PLa(b){b=[Object.assign(new da.a,
{name:gk.KBp,string:b})];me.a(gk.lLg,!1,void 0,b)}static P5f(b){b=[Object.assign(new da.a,{name:gk.sBo,string:b})];me.a(gk.jDj,!1,void 0,b)}static NXa(b){b=[Object.assign(new da.a,{name:gk.lLl,string:b})];me.a(gk.rtf,!1,void 0,b)}async uxp(b){const h=this.vHi(b);if(null==h)gk.PLa("Cannot update TOC when firstTocPara = null");else{var r=this.cNm(h);if(0<r.Esd.length)return this.MHn(r.Esd),!1;me.a(gk.JBp);var A=window.performance.now(),L=await this.Teb.Xyi(r);if(!L)return v.ULS.sendTraceTag(559248668,
3019,10,"Failed to get data for TOC update."),gk.PLa("Failed to fetch TOC data"),!1;b=new mf.a(1,1,0,()=>{this.LBp(h,L,r,A)});this.Jb.$b(b);return!0}}LBp(b,h,r,A=0){let L;try{if(null==b)gk.PLa("Attempt to update TOC when firstTocPara = null");else{0==A&&(A=window.performance.now());var Z=new hb.a;Z.set(b);Z.zb(7);Z.kd(7);L=this.Rc.Lc(15);L.ju(Z);var oa=this.Teb.Buj(h,r.ltb);if(null==oa)gk.PLa("Attempt to update TOC when tocFieldData = null");else{var Ba;if(({Umf:Ba}=this.FCj(b,r)).response){v.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var gb=oa.cAb?oa.cAb.count:0;if(this.bni(b)){var Ab;this.T_i(b)&&(this.iDj(b),(b=this.hb.pg(b,!1,!0))&&(Ab=b.ka(Vc.a.ed,null).toString()));var Jb=b.ka(Vc.a.gQ,null);h=Jb;Ab=null!==Ab&&void 0!==Ab?Ab:Jb;if(gb){for(var Tb=0,jc;b.Fq&&h==Jb&&Tb<gb;){const Gd=oa.cAb.K(Tb);r.ltb&&this.Teb.ute(b);if(!this.nBp(b,Tb,gb,Gd,r)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");gk.PLa("Failed to update TOC paragraph");
return}b.setValue(Vc.a.gQ,Ab);Tb++;jc=b;b=this.hb.pg(jc,!1,!0);if(!b){h=null;break}this.a0i(b)&&this.hDj(b);h=b.ka(Vc.a.gQ,null)}h==Jb&&this.grg(b);var Hc;if(({Kad:Hc}=this.kZk(oa,Tb,gb,jc,Ab)).response)if(r.iKb&&!this.Urf(Ba,Hc.id))gk.PLa("Failed to add content control block");else{var hd=window.performance.now()-A;me.a(gk.lLg,!0,hd)}else gk.PLa("Failed to add new paragraph")}else this.R$e.dCg(),this.GBp(b,r.iKb,Ba,r.tX,Ab)&&(Tb=window.performance.now()-A,me.a(gk.lLg,!0,Tb))}else gk.PLa("Failed to fetch style set")}else gk.PLa("Failed to remove Content Control")}}}catch(Gd){gk.PLa(String.format("{0} {1}",
Gd.message,Gd.stack))}finally{L&&L.dispose()}}kZk(b,h,r,A,L){let Z=new hb.a;for(Z.set(A);h<r;){A=b.cAb.K(h);if(!({jNb:A}=this.ESi(null,Z,h,r,A,L)).returnValue)return{Kad:Z.currentNode,response:!1};Z=A;h++}return{Kad:Z.currentNode,response:!0}}FCj(b,h){var r;let A,L;const Z=null===(r=null===b||void 0===b?void 0:b.ra)||void 0===r?void 0:r.first.Hb;if(Z&&0<Z.length)if(b=b.ra.first.Hb.K(0),b.zg){r=b.Xd.getValue(Vc.a.Ow);A=this.th.dr(b.Xd.id,!0);L=this.th.dr(b.Xd.id,!1);if(0!=this.fq.eZb(r))return v.ULS.sendTraceTag(558952907,
3019,10,"Failed to release content control"),{response:!1,Umf:A,$_h:L};h.iKb=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.iKb=!1;else h.iKb=!1;return{response:!0,Umf:A,$_h:L}}GBp(b,h,r,A,L){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.Teb.ute(b);const Z=this.o5d(b);if(!this.Dtj(Z,h,r,A))return gk.PLa("Failed to populate empty TOC."),!1;if(h=this.hb.pg(b,!1,!0))r=b.ka(Vc.a.gQ,null),A=h.ka(Vc.a.gQ,null),r==A&&this.grg(h);b.setValue(Vc.a.gQ,
L);return!0}Dtj(b,h,r,A){this.Rd.We(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.Mej(b);const L=b.ra.first;this.Ee.HN(L.formatting,!0);this.dsf(b,0,1,A);L.nAg&&b.qe.Iq.W(L.formatting.te,ov.CharacterPropertiesEditor.wN);return h&&r&&!this.Urf(r,b.id)?!1:!0}o5d(b){b.ra.reset();b.KTa();const h=new pL.a(b,0);h.formatting=new Kg.a(h,Q.a.nil);h.ni=!0;b.ra.add(h);return xc.a.createTextRange(b,0,b.characterData.length)}T_i(b){if(Cd.ParagraphReader.GR(b)){var h=b.ra.last.lc;if(!h||!h.length)return!1;
if(4<=h.length){b=0===h.K(h.length-4).pe;const r=1===h.K(h.length-3).pe&&h.K(h.length-3).tX.trim().startsWith(this.Y7c),A=2===h.K(h.length-2).pe;h=5===h.K(h.length-1).pe;return b&&r&&A&&h}}return!1}a0i(b){if(Cd.ParagraphReader.GR(b)){var h=b.ra.first.lc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.K(0).pe,h=3===h.K(1).pe,b&&h}return!1}iDj(b){const h=b.ra.last.lc,r=h.K(h.length-4),A=h.K(h.length-3),L=h.K(h.length-2),Z=h.K(h.length-1);h.ZL(r);h.ZL(A);h.ZL(L);h.ZL(Z);b.removeProperty(Vc.a.gQ)}hDj(b){const h=
b.ra.first.lc,r=h.K(0),A=h.K(1);h.ZL(r);h.ZL(A);b.removeProperty(Vc.a.gQ)}grg(b){if(b){var h=b.ka(Vc.a.gQ,null),r=b.ka(Vc.a.ed,null).toString(),A=h;r==h&&this.T_i(b)&&(this.iDj(b),(b=this.hb.pg(b,!1,!0))&&(A=b.ka(Vc.a.gQ,null)));r=new hb.a;r.set(b);r.zb(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var L;b&&b.Fq&&A==h&&L!=b;){if(this.a0i(b)){this.hDj(b);break}this.Teb.ute(b);this.yo.me(r);A=this.yo.ft(r,!1,!0);this.Vh.pDa(b);if(!A)return null;L=b;r.Vb(2);A=(b=
r.currentNode)?b.ka(Vc.a.gQ,null):null}return b}}cNm(b){var h=b.ra,r=h?h.length:0,A=null;b=new sv(!0,!1,!1,0,8,!0,void 0);for(let L=0;L<r&&(A=this.bNm(h.Ub(L)),b.tX=A,A=this.VJm(A),A[0]!==this.Y7c);L++);h=A?A.length:0;for(r=1;r<h;r++)switch(A[r]){case "\\h":b.ltb=!0;break;case "\\u":b.BTf=!0;break;case "\\o":this.RXo(A[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.eCg=!1;b.Esd.push(A[r]);break;default:b.Esd.push(A[r])}return b}RXo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===
b.length?(h.Qqc=Number.parseInvariant(b[1])-1,h.VAc=Number.parseInvariant(b[2])-1,!0):!1}Jzo(b){try{me.a(gk.rBo);const h=window.performance.now(),r=this.vHi(b);if(null==r){gk.P5f("Attempt to remove TOC when firstTocPara = null");return}let A,L,Z;const oa=this.ywi();if(!({Umf:A,$_h:L}=this.FCj(r,oa)).response)return gk.P5f("Failed to remove content control"),!1;if(void 0==A&&void 0==L)Z=this.grg(r);else{Z=r.Hc.Eb(A);const gb=new hb.a;gb.set(Z);gb.zb(8);b=!1;let Ab;for(;!b&&Z&&Ab!=Z;){Z.id.equals(L)&&
(b=!0);Z&&Z.Fq&&this.Teb.ute(Z);this.yo.me(gb);const Jb=this.yo.ft(gb,!1,!0);this.Vh.pDa(Z);if(!Jb){Z=null;break}gb.Vb(2);Ab=Z;Z=gb.currentNode}}Z&&this.Edd(Z);const Ba=window.performance.now()-h;me.a(gk.jDj,!0,Ba)}catch(h){gk.P5f(String.format("{0} {1}",h.message,h.stack))}return!0}Edd(b){b=xc.a.Uc(b,0);b=new Oq.Selection([b],!0);this.ib.Kc(b)}Urf(b,h){return this.fq.sqa(b,h,null,gk.bhi,!0,11).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),
!1):!0}Qol(){this.Teb.aNm()||this.R$e.dCg()}vHi(b){if(!b.Fq)return v.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ka(Vc.a.gQ,null);return this.nO.zEm(b)}MHn(b){b.length&&(b=[Object.assign(new da.a,{name:"UnsupportedSwitches",string:b.toString()})],me.a("UnsupportedTocInstruction",void 0,void 0,b))}bNm(b){const h=(b=b.lc)?b.length:0;for(let r=0;r<h;r++)if(1===b.K(r).pe&&b.K(r).tX.trim().startsWith(this.Y7c))return b.K(r).tX.trim();return null}VJm(b){const h=
[];if(!b)return h;b=b.split(" ");return b.length?b:h}EFl(b){b=this.S$h(b,null,!0,void 0).returnValue;if(!b)return gk.NXa("Failed to create paragraph"),!1;const h=xc.a.Uc(b,0);if(!this.Dtj(h,!0,b.id,this.dAb.tX))return gk.NXa("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}S$h(b,h,r,A){let L,Z;r&&b?(L=this.UFl(b),Z=L.currentNode,A=Cd.ParagraphReader.rU(Z).toString()):h&&(L=this.vBm(h),Z=this.Vh.dL(L));if(!Z)return v.ULS.sendTraceTag(592233798,
3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,jNb:L};Z.setValue(Vc.a.gQ,A);return{returnValue:Z,jNb:L}}Rfo(){const b=new Sys.StringBuilder(this.Y7c);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}fgo(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.dAb.ltb&&h.append(" \\h");return h.toString()}vBm(b){b.Nd();this.yo.me(b);return this.Vh.Psa(b,!1)}UFl(b){const h=new hb.a;h.set(b.node);h.Nd();this.yo.me(h);let r=this.$Bi(h);const A=!b.cpBegin;
if(Eb.a.isEmpty(h,!0))return this.nSi(r);if(A)return this.Vh.yy(r,!0,!1),this.Vh.Eca(h,r,b,!1,!1,!1),b=this.$Bi(r),this.nSi(b);r=this.Vh.Psa(h);this.Vh.Eca(h,r,b,!1,!1,!0);b=this.Vh.Psa(h);this.Vh.P_b(b.currentNode,!1);this.Vh.dL(b);this.yo.Me(b);return b}$Bi(b){const h=new hb.a;h.nd(b);h.Nd();return h}nSi(b){this.Vh.yy(b,!0,!0);this.Vh.P_b(b.currentNode,!1);this.yo.Me(b);return b}Mej(b){const h=b.ra;1===h.length&&(h.first.ni=!1,b.Q0d().ni=!0)}nBp(b,h,r,A,L){const Z=this.o5d(b);this.Rd.We(Z,"");this.Ktj(b,
A,L);this.dsf(b,h,r,L.tX);return L.ltb&&!this.wF(b,A.tu)?!1:!0}ESi(b,h,r,A,L,Z){h=({jNb:b}=this.S$h(b,h,0==r,Z)).returnValue;if(!h)return{returnValue:!1,jNb:b};this.Ktj(h,L,this.dAb);this.dsf(h,r,A,this.dAb.tX);return this.dAb.ltb&&!this.wF(h,L.tu)?{returnValue:!1,jNb:b}:{returnValue:!0,jNb:b}}Ktj(b,h,r){this.Aan(b,h.j0m,h.listMarker,h.HYj,h.Dta);this.WHh.fcn(b,b.characterData.length);r.eCg&&this.ubn(b,h);this.Mej(b);this.r_o(b,h.HYj)}Wym(b,h){if(!b)return 0;const r=gk.YOm();return 4<b.length?r.K(h)+
.5*Math.floor(b.length/3):r.K(h)}Aan(b,h,r,A,L){r&&this.Uan(b,r,A);r=xc.a.Uc(b,b.characterData.length);this.Rd.We(r,h);L&&(b=b.ra.Dh(0),this.Ee.lha(b.formatting,L))}Uan(b,h,r){r=this.Wym(h,r);const A=xc.a.Uc(b,0);this.Rd.We(A,h);this.WHh.Van(b,h.length,r)}ubn(b,h){var r=xc.a.Uc(b,b.characterData.length);this.Rd.We(r,h.jr.toString());r=b.ra.Dh(b.characterData.length-h.jr.toString().length);h=this.fgo(h.tu);this.tWa(b,r,0,2,h);this.tWa(b,r,1,2,h);this.tWa(b,r,2,2,h);r=b.ra.Dh(b.characterData.length);
this.tWa(b,r,3,2,h)}r_o(b,h){h=this.mOe.nh(h);this.ew.ZP(h,b,!0)}dsf(b,h,r,A){const L=b.ra.first,Z=b.ra.last;h?this.tWa(b,L,4,1,A):(this.tWa(b,L,0,1,A),this.tWa(b,L,1,1,A),this.tWa(b,L,2,1,A));h===r-1?this.tWa(b,Z,3,1,A):this.tWa(b,Z,5,1,A)}tWa(b,h,r,A,L=null){r=new pH.a(h,null,r,A,!0,!1,!1,L);h.lc||(h.lc=new qH.a(h));h.lc.uqa(r);b.Vm();this.QLl(r,b)}QLl(b,h){b.te?h.qe.rX(b.te-1,2):h.qe.Nsa(b.te,2);h.qe.Iq.W(b.te,ov.CharacterPropertiesEditor.wN);h.qe.It.W(b.te,ov.CharacterPropertiesEditor.aS)}wF(b,
h){b=xc.a.createTextRange(b,0,b.characterData.length);return this.iF.wF(b,h,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static YOm(){gk.dya||(gk.dya=new Ha.a,gk.dya.W("toc 1",1),gk.dya.W("toc 2",1.5),gk.dya.W("toc 3",2),gk.dya.W("toc 4",2.5),gk.dya.W("toc 5",3),gk.dya.W("toc 6",3.5),gk.dya.W("toc 7",4),gk.dya.W("toc 8",4.5),gk.dya.W("toc 9",5));return gk.dya}}gk.dya=null;gk.bhi="Table of Contents";gk.kLl="CreateTocClient";gk.rtf=
"CreateTocSuccess";gk.lLl="CreateTocFailureCause";gk.JBp="UpdateTocClient";gk.lLg="UpdateTocSuccess";gk.KBp="UpdateTocFailureCause";gk.rBo="RemoveTocClient";gk.jDj="RemoveTocSuccess";gk.sBo="RemoveTocFailureCause";Object(u.a)(gk,"TOCField",null,[487,488]);var EB=d(642);class UE{constructor(b,h){this.wFa=b;this.zPa=h}fcn(b,h){if(Cd.ParagraphReader.Wb(b)&&!(0>h)){var r=Tq.a.Xdc(b);r=new EB.a(r,4,1,1);this.wFa.ube(b,r);b=xc.a.Uc(b,h);this.zPa.Hbe(b)}}Van(b,h,r){var A=Pn.a.VO/2;const L=b.ra.T8a(h);A=
Ya.FormattingReader.Ug(L.formatting,Ke.a.fontSize,2*A)/2;r=new EB.a(Tf.a.lD(A/36)*r,1,0,1);this.wFa.ube(b,r);b=xc.a.Uc(b,h);this.zPa.Hbe(b)}}Object(u.a)(UE,"TOCTabUtility",null,[486]);class Dr{constructor(){this.Z=null}get name(){return"WordEditor.TableOfContents"}wc(b){this.Z=b;this.Z.ia("WordEditor.AutoSaveParamsUpdateService",()=>new oL.a(this.Z.resolve("Box4.Graph.IGraphIteratorFactory"),Ty.a.iU)).ha();this.Z.ia("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new LJ(new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),
Object(so.a)(),this.Z.resolve("Box4.Styles.IWACStyleReader"),this.Z.resolve("Box4.List.IListReader"),this.Z.resolve("Box4.IListMarkerUtility"),new Sq.a)).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.Z.ia("WordEditor.TableOfContents.TOCDataManager",()=>new Cr(this.Z.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.Z.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();this.Z.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new UE(this.Z.resolve("WordEditor.ICustomTabStopUtility"),
this.Z.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.Z.ia("WordEditor.TableOfContents.TOCField",()=>new gk(this.Z.resolve("Box4.ITOCDataManager"),this.Z.resolve("Box4.IOutlineElementEditor"),this.Z.resolve("Box4.IHyperlinkEditor"),this.Z.resolve("Box4.Styles.IWACStyleEditor"),this.Z.resolve("Box4.Styles.IWACStyleReader"),Be.a.instance,this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("WordEditor.TableOfContents.ITOCTabUtility"),
this.Z.resolve("Box4.IFormattingEditor"),DB.instance,this.Z.resolve("Box4.IFeatureHelper"),this.Z.resolve("WordEditor.ContentControl.IContentControlManager"),this.Z.Oa("WordEditor.ParagraphWordIdMapping"),this.Z.resolve("Box4.IOutlineElementNavigator"),Ko.a.instance,y.AFrameworkApplication.pc,this.Z.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();this.Z.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new rv(y.AFrameworkApplication.va,
this.Z.resolve("WordEditor.AutoSaveParamsUpdateService"),this.Z.resolve("Box4.IOutlineElementEditor"),this.Z.resolve("Box4.Graph.IGraphIteratorFactory"),Ko.a.instance,Be.a.instance,this.Z.resolve("WordEditor.TableOfContents.ITOCField"),this.Z.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.Z.resolve("Box4.IFeatureHelper"),this.Z.Ta("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.Z.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Xb()}dispose(){}}
Object(u.a)(Dr,"PackageManager",null,[0,1]);class un{constructor(b,h,r,A,L,Z,oa,Ba){this.nZa=(gb,Ab,Jb,Tb,jc)=>{if(!({Hz:gb}=this.Nyb(Ab,Jb,jc,!0,!0)).returnValue)return gb;this.LNd.Z9h(jc,Ab.node);return 32};this.bDa=(gb,Ab,Jb,Tb,jc)=>this.oMi(Ab,Jb,Tb,jc,!0);this.IXb=(gb,Ab,Jb,Tb,jc)=>{if(!({Hz:gb}=this.Nyb(Ab,Jb,jc,!1,!0)).returnValue)return gb;this.LNd.NHl(jc,Ab.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Eqa=(gb,Ab,Jb,Tb,jc)=>{if(!({Hz:Tb}=this.Nyb(Ab,Jb,jc,!1,
!0)).returnValue)return 2==Jb&&8==Tb&&Qr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],gf.a.GOb),Tb;const Hc=Ab.node;let hd=null;(hd=gb===vb.a.Eqa?this.LNd.U2b(jc[Tg.a.SourceControlId],Hc):this.Ry.J8d(Hc,jc))?(this.spe(Hc,()=>{this.EPd.U_b(hd,Hc)}),this.oM(),Tb=32):(Qr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],gf.a.GOb),Tb=8);gb===vb.a.Eqa&&32===Tb&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,
324,32===Tb);return Tb};this.Eya=(gb,Ab,Jb,Tb,jc)=>this.oMi(Ab,Jb,Tb,jc,!1);this.EBe=(gb,Ab,Jb,Tb,jc)=>yt.a.nua(gb,Ab,Jb,Tb,jc,{},14);this.$Lb=(gb,Ab,Jb,Tb,jc)=>{if(!({Hz:gb}=this.Nyb(Ab,Jb,jc,!1,!1)).returnValue)return gb;const Hc=Ab.node;this.spe(Hc,()=>{this.EPd.Hsl(Hc)});return 32};this.Ry=b;this.LNd=h;this.ga=r;this.EPd=A;this.Rc=L;this.oB=Z;this.sCk=Ba}Xb(){this.Uuc(ed.a.Y_a.z9h())}Uuc(b){this.ga.qa(vb.a.nZa,kc.a.view,b);this.ga.qa(vb.a.nZa,kc.a.table,this.nZa);this.ga.Pc(vb.a.nZa,1127);this.ga.qa(vb.a.Eqa,
kc.a.view,this.EBe);this.ga.qa(vb.a.Eqa,kc.a.table,this.Eqa);this.ga.Pc(vb.a.Eqa,1030);this.ga.qa(vb.a.zT,kc.a.table,this.Eqa);this.ga.qa(vb.a.Eya,kc.a.view,this.EBe);this.ga.qa(vb.a.Eya,kc.a.table,this.Eya);this.ga.Pc(vb.a.Eya,1038);this.ga.qa(vb.a.bDa,kc.a.view,b);this.ga.qa(vb.a.bDa,kc.a.table,this.bDa);this.ga.Pc(vb.a.bDa,1127);this.ga.qa(vb.a.IXb,kc.a.view,b);this.ga.qa(vb.a.IXb,kc.a.table,this.IXb);this.ga.Pc(vb.a.IXb,1126);this.ga.qa(vb.a.$Lb,kc.a.view,this.EBe);this.ga.qa(vb.a.$Lb,kc.a.table,
this.$Lb);this.ga.Pc(vb.a.$Lb,1028)}oM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}oMi(b,h,r,A,L){if(!({Hz:Z}=this.Nyb(b,h,A,L,!0)).returnValue)return 2==h&&8==Z&&Qr.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],
gf.a.V5l),Z;b=b.node;h=this.Ry.O2(b);var Z=A[Tg.a.On];const oa=un.wNm(A.MenuItemId);L?A[Tg.a.On]=un.r5o(h,oa):(this.H9k(h,oa,Z,b),r.Xt=oa,r.kE=Z?0:1,v.ULS.shipAssertTag(0,324,!!oa));return 32}spe(b,h){const r=this.Rc.Lc(15);try{r.Ab(b),this.oB.xxb(),h()}finally{r&&r.dispose()}}Nyb(b,h,r,A,L){return this.Ytn(b,h,r,A,L)?{returnValue:A||2===h,Hz:32}:{returnValue:!1,Hz:8}}Ytn(b,h,r,A,L){if(b.contextId!==kc.a.table)return!1;if(A||2===h)if(L&&!r||!Object(Gb.a)(Hz.TableNode,b.node)||this.sCk(b.node))return!1;
return!0}H9k(b,h,r,A){const L=(512===h||1024===h?!r:r)?b|h:b&~h;L!==b&&this.spe(A,()=>{this.EPd.RDa(L,A)})}static aF(){un.glb[un.O$l]=32;un.glb[un.E$l]=128;un.glb[un.ryn]=64;un.glb[un.gyn]=256;un.glb[un.qcl]=512;un.glb[un.pcl]=1024}static r5o(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static wNm(b){let h=0;b in un.glb&&(h=un.glb[b]);return h}}un.O$l="buttonFirstRow";un.E$l="buttonFirstColumn";un.ryn="buttonLastRow";un.gyn="buttonLastColumn";un.qcl="buttonBandedRow";un.pcl="buttonBandedColumn";
un.glb={};Object(u.a)(un,"TableStyleActor",null,[]);un.aF();var lx=d(423);class eA extends lx.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(u.a)(eA,"TableGalleryButtonProps",lx.a,[]);class Vy extends eA{constructor(){super()}get Type(){return 6}}Object(u.a)(Vy,"TableStyleGalleryButtonProps",eA,[]);class fA{}fA.WSn=2147483647;Object(u.a)(fA,"TableStyleUtil",null,[]);class Ks{constructor(b,h,r){this.dof="Clear";this.DOb=null;this.FPk=b;this.xe=h;this.Ry=r;
this.Bfa=y.AFrameworkApplication.Bfa;this.Lr=y.AFrameworkApplication.Lr}Q7a(){}YWk(b,h){this.Q7a(b);const r=this.Lsi(b),A=r.length;if(!(0>=A)){var L=fA.WSn,Z=null;for(let gb=0;gb<A;gb++){var oa=r[gb],Ba=this.Ry.NNm(oa);L!==Ba&&(L=Object.assign(new hh.a,{Id:"msMoreTableStyles"+Ba,Title:this.ONm(Ba),ControlList:[]}),Z=Object.assign(new Oo.a,{Type:6,Id:"galleryMoreTableStyles"+Ba,ExternalGalleryId:"TableStylesGallery",Width:Ks.yEg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.DOb&&(Z.ExternalId=
this.DOb[Ba.toString()]),L.ControlList.push(Z),h.MenuSectionList.push(L),L=Ba);Ba=this.xe.wL(oa);oa=Ks.SFg+gb;Ba=Object.assign(new Vy,{Id:oa,ExternalId:oa,Command:vb.a.Eqa.toString(),QueryCommand:vb.a.nZa.toString(),LabelText:Ba?F.a.yf(Ba):"",Alt:Ba,VerticalCenterAlign:"true"});Ba.TableCellStyles=this.Q8d(oa,b);Ba.TableStyles=this.B4c(oa,b);Z&&Z.GalleryItems.push(Ba)}}}WWk(b){const h=Object.assign(new hh.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),r=Object.assign(new Mj.a,{Id:"fseaClearTableFormatting",Command:vb.a.$Lb.toString(),LabelText:F.a.yf(this.dof),Alt:F.a.yf(this.dof),Image16by16:this.Lr,Image16by16Class:Pb.getImageClassWithCluster(this.Bfa,Ks.Gsl),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}Z9h(b,h){this.Q7a(h);const r=b[Tg.a.SourceControlId];var A=this.U2b(r,h);if(A){var L=this.Ry.fH(h);L=L?this.xe.Be(L):null;var Z=this.xe.wL(A);A=this.xe.Be(A);b[je.a.Alt]=
Z;b[je.a.On]=A===L;h=Object.assign(new Vy,{Id:r,ExternalId:r,Command:vb.a.Eqa.toString(),QueryCommand:vb.a.nZa.toString(),TableCellStyles:this.Q8d(r,h),TableStyles:this.B4c(r,h),Alt:Z});b[je.a.GalleryButtonProps]=h}else b[je.a.InnerHTML]=null,b[je.a.Alt]=null,b[je.a.On]=!1,b[je.a.GalleryButtonProps]=null}Q8d(b,h){this.Q7a(h);return(b=this.U2b(b,h))?this.FPk.nui(b,h):null}B4c(b,h){this.Q7a(h);return this.U2b(b,h),null}NHl(b,h){b.MenuItems=this.PAm(h)}PAm(b){const h=Object.assign(new Ee.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.YWk(b,h);this.WWk(h);return h}U2b(b,h){return b?b.startsWith(Ks.SFg)?this.POf(parseInt(b.substr(Ks.SFg.length)),h):this.VHo(parseInt(b.substr(Ks.Fip.length)),h):null}}Ks.SFg="buttonTableStyleMenu";Ks.Fip="buttonTableStyleRibbon";Ks.yEg=7;Ks.Gsl="ClearTableStyle_16x16x32";Object(u.a)(Ks,"ATableStyleRibbonControl",null,[620]);class gA extends Ks{constructor(b,h,r){super(null,h,r);this.aHh=b}Z9h(b,h){this.Q7a(h);const r=b[Tg.a.SourceControlId];var A=this.U2b(r,h);if(A){var L=
this.Ry.fH(h);L=L?this.xe.Be(L):null;var Z=this.xe.wL(A);A=this.xe.Be(A);b[je.a.Alt]=Z;b[je.a.On]=A===L;h=Object.assign(new Vy,{Id:r,ExternalId:r,Command:vb.a.Eqa.toString(),QueryCommand:vb.a.nZa.toString(),TableCellStyles:this.Q8d(r,h),TableStyles:this.B4c(r,h),Alt:Z});b[je.a.GalleryButtonProps]=h}else b[je.a.InnerHTML]=null,b[je.a.Alt]=null,b[je.a.On]=!1,b[je.a.GalleryButtonProps]=null}Q8d(b,h){this.Q7a(h);return(b=this.U2b(b,h))?this.aHh.nui(b,h,5,5):null}B4c(b,h){this.Q7a(h);return this.U2b(b,
h),null}}Object(u.a)(gA,"ATableStyleRibbonControlVariableSizePreviews",Ks,[]);var tu=d(1378),Rv=d(1118);class Sv{constructor(b,h,r,A){this.Njm=(L,Z)=>this.getBorder(L,this.W4.$O(Z));this.Mjm=(L,Z)=>this.getBorder(L,this.W4.zR(Z));this.hy=b;this.Dz=h;this.XIb=r;this.W4=A;this.mpk=new rg.a(()=>this.Ljm());this.Kgb=new rg.a(()=>this.Kjm())}Ljm(){const b={},h=y.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}Kjm(){const b={};b[Mi.a.Oya]=Mi.a.Lmb;b[Mi.a.Lmb]=Mi.a.Lmb;b[Mi.a.V5a]=Mi.a.V5a;return b}FEl(b,h,r,A){const L=new Rv.a;L.rowCount=r;L.tnb=A;L.M_a=this.XIb.TMm(b);L.Ja=b.ka(Vc.a.Ja,1);L.Ia=b.ka(Vc.a.Ia,1);L.tableLook=h;L.yBe=1;return L}nui(b,h,r,A){if(!this.hy.Be(b)||!Object(Gb.a)(195,b)||!Object(Gb.a)(lp.a,h))return null;const L=this.Dz.O2(h);r=this.FEl(b,L,r,A);A=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.AZk(b,
h,r,A);return A}B4c(){return null}Qla(){}AZk(b,h,r,A){r.omc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.tnb;r.cellIndex++)this.sVk(b,h,r,A)}sVk(b,h,r,A){h=this.XIb.Jxl(r,this.XIb.dHf(r),h,b);const L={};var Z=this.Dz.UGf(b,h,Ke.a.fontColor,!0,nn.a.YO(),"None");L.color=Z?Z:"inherit";Z=this.Dz.UGf(b,h,Ke.a.QG,!0,nn.a.YO(),"None");L["background-color"]=Z?Z:"inherit";this.d_k(r,b,h,L);A.push(L)}d_k(b,h,r,A){b=this.XIb.iVa(b);this.DQd(5,b,h,r,A);this.DQd(3,b,h,r,A);this.DQd(0,b,h,r,A);this.DQd(4,b,h,r,
A)}DQd(b,h,r,A,L){h=this.Xqm(b,h,r,A);h!==Mi.a.WH&&(L[this.mpk.value[tu.a[b]]]=h)}Xqm(b,h,r,A){let L=Mi.a.WH;if(({Nqa:L}=this.FOa(A,b,1,h,this.Mjm,L)).returnValue)return L;({Nqa:L}=this.FOa(r,b,3,h,this.Njm,L));return L}FOa(b,h,r,A,L,Z){return this.W4.mSj(r,h,A)&&(Z=L(b,h))!==Mi.a.WH||!h&&({Nqa:Z}=this.FOa(b,1,r,A,L,Z)).returnValue||4===h&&({Nqa:Z}=this.FOa(b,2,r,A,L,Z)).returnValue?{returnValue:!0,Nqa:Z}:{returnValue:Z!==Mi.a.WH,Nqa:Z}}getBorder(b,h){let r="",A,L;({borderStyle:A,borderWidth:L}=this.Rjm(b,
h));if(A===Mi.a.V5a)return r;r=String.format(Mi.a.oTd,L,A,this.Djm(b,h));return r.trim()}Djm(b,h){if(!h)return Mi.a.e2;b=this.Dz.f0c(b,h.color,Ql.a.auto);return b!==Ql.a.auto?Ql.a.JB(b):Mi.a.e2}Rjm(b,h){var r=Mi.a.Nya;let A=Mi.a.XH+Mi.a.Fdc;if(!h)return{borderStyle:r,borderWidth:A};r=this.Dz.f0c(b,h.style,Mi.a.V5a);b=this.Dz.f0c(b,h.size,Mi.a.XH);A=this.Ojm(r,b)+Mi.a.Fdc;r=this.Fjm(r);return{borderStyle:r,borderWidth:A}}Ojm(b,h){let r=2;b===Mi.a.mLb&&h<Mi.a.U$&&(r=1);return r}Fjm(b){return this.Kgb.value[b]||
Mi.a.Ddc}static RNm(){return new Sv(Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Wa.a.instance.resolve("WordEditor.IWACTableStyleReader"),PA.a.instance,Mi.a.instance)}static get instance(){return null!=Sv.WXg?Sv.WXg:Sv.WXg=Sv.RNm()}}Object(u.a)(Sv,"TableStylePreviewGenerator",null,[618]);var ps;(function(b){b[b.dVp=0]="background1";b[b.Poq=1]="text1";b[b.eVp=2]="background2";b[b.Qoq=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.Z1p=11]="followedHyperlink";b[b.xYp=12]="dark1";b[b.V7p=13]="light1";b[b.yYp=14]="dark2";b[b.W7p=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(ps||(ps={}));Object(u.b)("ThemeColor",ps);class by{constructor(b){this.i9b=b}Ghm(b,h,r){let A;({oyj:h,wVh:A}=this.PHm(h));b=[];const L=[];for(let oa=0;16>oa;oa++){if(!(ps[oa]in r.hJb))continue;const Ba=oa,gb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[A[Ba]],this.Hxm(oa));var Z=h[Ba];Z=Z&4278190080|(Z&255)<<16|Z&65280|(Z&16711680)>>>16;L.push(Object.assign(new Wl,{Color:Ba.toString(),DisplayColor:"#"+F.a.JJ(Z,6),Alt:F.a.yf(gb)}));b[b.length]=oa}return{returnValue:L,Pkp:b}}Hxm(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}PHm(b){let h=null,r=null;b=this.i9b(b);if(!b)return{oyj:h,wVh:r};h=b.properties.ka(Vc.a.Oeb,null);r=b.properties.getValue(Vc.a.lCe).split(" ");return{oyj:h,wVh:r}}static TNm(){return new by(Object(D.a)(Object(so.a)(),Object(so.a)().Iu,"navigateToPageContentNode"))}static get instance(){return null!=
by.oYg?by.oYg:by.oYg=by.TNm()}}Object(u.a)(by,"TableStyleThemeHelper",null,[671]);var $C=d(911);class aD{get Kg(){return null!=this.k4g?this.k4g:this.k4g=Wa.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.X9e={};this.hJb={};this.xe=b;this.Ry=h}jAf(b,h){const r=this.X9e[ps[h]];return r&&r.length?r:this.zfm(b,h)}Jzi(b,h,r){if(h=this.jAf(h,r))for(b=this.xe.Be(b),r=0;r<h.length;r++)if(this.xe.Be(h[r])===b)return r;return-1}Qla(){this.X9e={};this.hJb={}}zfm(b,h){const r=[];this.hJb={};
b=this.Ry.w4c(b);this.cSd(r,this.hJb,0,h,b);this.cSd(r,this.hJb,1,h,b);this.cSd(r,this.hJb,2,h,b);this.cSd(r,this.hJb,3,h,b);return this.X9e[ps[h]]=r}cSd(b,h,r,A,L){let Z;const oa=L.gv();Z=this.Kg.vn?oa.Qw:L.Qw;for(let gb=0;gb<Z;gb++){var Ba=void 0;this.Kg.vn?(Ba=oa.vla(gb),Ba=L.nh(this.xe.Be(Ba))):Ba=L.FAa(gb);if(3!==this.xe.JF(Ba))continue;const Ab=this.Ry.MNm(Ba),Jb=this.Ry.V8d(Ba);h[ps[Jb]]=!0;Ab!==r||Jb!==A&&16!==Jb||this.xe.Be(Ba)===$C.a.gWb||(b[b.length]=Ba)}}static FRm(){return new aD(Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Wa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static KLl(){return aD.FRm()}}Object(u.a)(aD,"WACTableStyleRibbonList",null,[670]);class tv extends gA{constructor(b,h,r,A,L){super(b,h,r);this.E5b=4;this.dOd=[];this.Jdn=()=>{this.xbc.Qla();this.aHh.Qla()};this.GPk=L;this.xbc=A;this.dof=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.Odo()}AEl(b,h){b.MenuItems=this.Lem(h)}Odo(){this.DOb={};this.DOb["0"]="CustomTableStyles";this.DOb["1"]="PlainTableStyles";this.DOb["2"]="GridTableStyles";
this.DOb["3"]="ListTableStyles"}Lem(b){const h=Object.assign(new Ee.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.mtn(b))return h;const r=Object.assign(new hh.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),A=Object.assign(new Cw.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Ec.a.qmb.toString(),QueryCommand:Ec.a.wYb.toString(),Width:tv.Qkp});A.Colors=({Pkp:this.dOd}=this.GPk.Ghm(this.dOd,b,this.xbc)).returnValue;r.ControlList.push(A);
h.MenuSectionList.push(r);return h}Q7a(b){if(b=this.Ry.fH(b))b=this.Ry.V8d(b),16!==b&&(this.E5b=b)}Lsi(b){return this.xbc.jAf(b,this.E5b)}POf(b,h){h=this.xbc.jAf(h,this.E5b);return 0>b||b>=h.length?null:h[b]}VHo(b,h){var r=this.Ry.fH(h);r=this.xbc.Jzi(r,h,this.E5b);r=-1!==r?Math.floor(r/Ks.yEg)*Ks.yEg:0;return this.POf(r+b,h)}ONm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;
case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}mtn(b){this.Q7a(b);return 0>=this.Lsi(b).length}EBp(b,h){if(!b||!h)return null;b=parseInt(b[Lm.Color]);var r=this.Ry.fH(h);const A=this.Ry.V8d(r);if(A===b)return null;if(16===A)return this.E5b=b,null;r=this.xbc.Jzi(r,h,A);this.E5b=b;return this.POf(r,h)}kTl(b){b=this.Ry.fH(b);b=this.Ry.V8d(b);if(16!==b)for(let h=0;h<this.dOd.length;h++)if(this.dOd[h]===b)return h;return-1}z5a(b){b.wdf(this.Jdn,2)}static SNm(){return new tv(Sv.instance,
Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Wa.a.instance.resolve("WordEditor.IWACTableStyleReader"),aD.KLl(),by.instance)}static get instance(){return null!=tv.TYg?tv.TYg:tv.TYg=tv.SNm()}}tv.Qkp=4;Object(u.a)(tv,"TableStyleRibbonControls",gA,[619,620]);var VE=d(1510);class Ew extends un{constructor(b,h,r,A,L,Z,oa,Ba){super(b,h,r,A,L,Z,oa,Ba);this.Wtc=(gb,Ab,Jb,Tb,jc)=>{if(!({Hz:gb}=this.Nyb(Ab,Jb,jc,!1,!0)).returnValue)return gb;this.TFg.AEl(jc,Ab.node);return 32};this.qmb=(gb,Ab,Jb,Tb,
jc)=>{if(!({Hz:gb}=this.Nyb(Ab,Jb,jc,!1,!0)).returnValue)return 2==Jb&&8==gb&&Qr.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],gf.a.W5l),gb;const Hc=Ab.node,hd=this.TFg.EBp(jc,Hc);hd&&this.spe(Hc,()=>{this.EPd.U_b(hd,Hc)});return 32};this.wYb=(gb,Ab,Jb,Tb,jc)=>{if(!({Hz:gb}=this.Nyb(Ab,Jb,jc,!0,!0)).returnValue)return gb;jc[Lm.IndexColorSelected]=this.TFg.kTl(Ab.node);return 32}}Uuc(b){super.Uuc(b);this.ga.qa(Ec.a.qmb,kc.a.view,this.EBe);this.ga.qa(Ec.a.qmb,kc.a.table,
this.qmb);this.ga.Pc(Ec.a.qmb,1030);this.ga.qa(Ec.a.Wtc,kc.a.view,b);this.ga.qa(Ec.a.Wtc,kc.a.table,this.Wtc);this.ga.Pc(Ec.a.Wtc,1126);this.ga.qa(Ec.a.wYb,kc.a.view,b);this.ga.qa(Ec.a.wYb,kc.a.table,this.wYb);this.ga.Pc(Ec.a.wYb,1127)}get TFg(){return this.LNd}static LNm(){return new Ew(Wa.a.instance.resolve("WordEditor.IWACTableStyleReader"),tv.instance,y.AFrameworkApplication.va,VE.a.instance,new Ko.a,Wa.a.instance.resolve("Box4.IInsertionPointFormatting"),Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(D.a)(Be.a.instance,Be.a.instance.Ytb,"isTableNodeInLockedRange"))}static get instance(){return null!=Ew.dYg?Ew.dYg:Ew.dYg=Ew.LNm()}}Object(u.a)(Ew,"TableStyleActor",un,[]);class uu{constructor(){this.Z=null}get name(){return"WordEditor.TableStyle"}wc(b){this.Z=b;this.Z.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Sv.instance).ha();this.Z.ia("Box4.TableEditors.IWACTableStyleEditor",()=>VE.a.instance).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>
{this.Ho()})}Ho(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(102)&&(Ew.instance.Xb(),tv.instance.z5a(fh.a.instance),ab.StaticActiveAppFrame.za().Ge())}dispose(){}}Object(u.a)(uu,"TableStylePackage",null,[0,1]);var rH=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},
children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",
LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",
QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},
children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",
Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",
Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",
Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},Op=d(1361);class qs{constructor(b,h){this.m7b=b;this.nyd=h}uwo(b){this.m7b.tPh(b)}IWd(b){this.nyd.IWd(b)}uye(b,
h){return this.nyd.uye(b,h)}tye(b,h){return this.nyd.tye(b,h)}eDe(b,h,r){this.nyd.eDe(b,h,r)}}Object(u.a)(qs,"ClientPaginationHeaderFooterBridge",null,[644]);class Fw{constructor(b,h){this.jp=b;this.ga=h;this.PGb=new wq.a;this.QGb=new wq.a}IWd(b){b=hb.a.eb(b);if(b.Ks()&&b.ar()){b.je();do 10===b.uf&&this.Vdo(b.currentNode),b.Mv();while(8!==b.uf)}}uye(b,h){var r=this.FMf(h);if(!this.PGb.tb(r))return v.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
r),!1;h=this.PGb.K(r);v.ULS.shipAssertTag(573400389,336,this.QGb.tb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");r=this.QGb.K(r);return this.R_m(h,b,r)}tye(b,h){var r=this.FMf(h);if(!this.PGb.tb(r))return v.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.PGb.K(r);v.ULS.shipAssertTag(573400391,336,this.QGb.tb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
r=this.QGb.K(r);return this.fcm(h,b,r)}eDe(b,h,r){h=this.qOm(h,r);this.ga.Qb(b?Ec.a.AMg:Ec.a.IFe,2,h)}qOm(b,h){h=this.jp.k3c(h);if(!h)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.jp.KAa(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}Vdo(b){if(10===b.type){var h=new wq.a,r=this.jp.k3c(b);v.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var A=this.jp.KAa(r);b=this.FMf(b);this.JAp(b,A);this.IAp(b,h);r=hb.a.eb(r);if(r.ar()){r.je();do b=r.currentNode,A=this.jp.n6d(b),b=this.jp.O_m(b),h.add(A,b),r.Mv();while(36===r.uf)}}}JAp(b,h){this.QGb.tb(b)?this.QGb.W(b,h):this.QGb.add(b,h)}IAp(b,h){this.PGb.tb(b)?this.PGb.W(b,h):this.PGb.add(b,h)}FMf(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ka(Vc.a.Wua,0)}R_m(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.tb(2))return b.K(2)}else if(b.tb(0))return b.K(0);
break;case 3:if(h){if(b.tb(1))return b.K(1)}else if(b.tb(0))return b.K(0);break;case 4:if(A){if(b.tb(2))return b.K(2)}else if(h){if(b.tb(1))return b.K(1)}else if(b.tb(0))return b.K(0);break;case 1:if(b.tb(0))return b.K(0)}return!1}fcm(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.tb(5))return b.K(5)}else if(b.tb(3))return b.K(3);break;case 3:if(h){if(b.tb(4))return b.K(4)}else if(b.tb(3))return b.K(3);break;case 4:if(A){if(b.tb(5))return b.K(5)}else if(h){if(b.tb(4))return b.K(4)}else if(b.tb(3))return b.K(3);
break;case 1:if(b.tb(3))return b.K(3)}return!1}}Object(u.a)(Fw,"ClientPaginationPageAdornmentContentManager",null,[642]);class sH{constructor(b,h,r,A,L,Z){this.Iyl=oa=>{1===oa&&this.rG.xG&&(oa=this.fd.osa(this.rG.xG,8,8),this.jp.kll(oa)?this.PQl(oa):this.t7o())};this.Lsp=oa=>{1===oa&&this.ga.Qb(vb.a.QX,2,!1)};this.rG=b;this.jp=h;this.fd=r;this.Rc=A;this.qIc=L;this.ga=Z}I7o(){const b=new Ag.StandardDialog;b.Bd=1;b.Ke(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.qY(0);
b.sw(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.Iyl)}PQl(b){b.kd(8);const h=this.Rc.Lc(15);h.set(b.Aq.Fk);this.qIc.Nyo(b);this.rG.dismiss();h.dispose();v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}t7o(){const b=new Ag.StandardDialog;b.Bd=1;b.Ke(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ke(0,CommonUIStrings.l_Close);b.qY(0);b.sw(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.Lsp);v.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(u.a)(sH,"DeleteHeaderFooterDialog",null,[]);class bD{constructor(b,h,r,A,L){this.jp=b;this.fd=h;this.Rc=r;this.qIc=A;this.ga=L}create(b){return new sH(b,this.jp,this.fd,this.Rc,this.qIc,this.ga)}}Object(u.a)(bD,"DeleteHeaderFooterDialogFactory",null,[643]);class cD{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.uda=null;this.BHg=(Jb,Tb,jc,Hc,hd)=>{var Gd=this.TOf(Tb);return Gd?1===jc?32:(jc=this.control)?
(Tb=this.Rc.Lc(15),Tb.Ab(Gd),Tb.Ph=Jb,jc.Rea?this.ga.Ob(Ec.a.SW,2):(Gd=this.Cki(Gd),Hc.Xt=Gd?1:0,Hc=Jb!==Ec.a.IFe,(Jb=this.mJf(Jb,hd))&&jc.MDa(Jb),this.ga.Qb(Ec.a.v_d,2,Hc)),Tb.dispose(),32):8:8};this.ivf=(Jb,Tb,jc)=>{if(1===jc)return 32;this.gtk.create(this.control).I7o();return 32};this.rlo=(Jb,Tb,jc,Hc,hd)=>1===jc?32:(Jb=this.control)?(hd[Tg.a.On]=Jb.Rea,32):8;this.Eyb=(Jb,Tb,jc,Hc,hd)=>{if(1===jc||!this.control.Rea)return 32;Tb=this.Uyi(Jb,hd);jc=cD.PJi(this.control.xG);Hc=this.Rc.Lc(15);Hc.Ab(jc);
Hc.Ph=Jb;Jb=this.fd.Ql();Jb.set(jc);this.WQa.hAf(Jb.currentNode,Tb);this.jp.RVb(Jb);this.qIc.YPj(Jb,Tb);Hc.dispose();return 32};this.MDa=(Jb,Tb,jc,Hc,hd)=>{if(1===jc)return 32;Jb=this.mJf(Jb,hd);this.control.Rea&&this.control.MDa(Jb);return 32};this.twe=(Jb,Tb,jc,Hc,hd)=>{if(1===jc)return 32;Jb=this.WFi(Jb,hd);Hc.Xt=Jb;Tb=this.TOf(Tb);if(!Tb)return 8;Hc=this.fd.Ql();Hc.set(Tb);Hc.zb(8);Hc.mt(8);if(!this.ul.SPn(Hc,Jb))return 8;this.jp.RVb(Hc);this.control.Vka(Hc.currentNode);return 32};this.ekg=(Jb,
Tb,jc,Hc,hd)=>{if(1===jc)return 32;Jb=this.PQk.eKl(this.TOf(Tb));hd.PopulationXML=Jb;return 32};this.Ure=(Jb,Tb,jc,Hc,hd)=>{Jb=this.Uyi(Jb,hd);Tb=this.control.xG;jc=this.jp.KAa(Tb);hd[Tg.a.On]=Jb===jc;1===Jb&&(hd[Tg.a.LabelText]=this.UKi(Tb)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.Uqe=(Jb,Tb,jc,Hc,hd)=>{if(1===jc||!this.control.Rea)return 32;Tb=this.control.xG;void 0!==Tb&&null!==Tb&&(Tb=this.jp.KAa(Tb),
Jb=this.mJf(Jb,hd),jc=this.control.G5b,hd[Tg.a.Visible]=this.Njp(Jb,Tb),hd[Tg.a.On]=Jb===jc);return 32};this.Hlo=(Jb,Tb,jc,Hc,hd)=>{if(1===jc||!this.control.Rea)return 32;Jb=this.control.xG;void 0!==Jb&&null!==Jb&&this.leo(Jb,hd);return 32};this.Rko=(Jb,Tb,jc,Hc,hd)=>{if(1===jc||!this.control.Rea)return 32;Jb=this.WFi(Jb,hd);Tb=this.control.xG;jc=0;void 0!==Tb&&null!==Tb&&(jc=Tb.getValue(Vc.a.Wua));hd[Tg.a.On]=Jb===jc;return 32};this.SW=(Jb,Tb,jc)=>{if(1===jc)return 32;this.control.dismiss();return 32};
this.J$d=()=>32;this.v_d=(Jb,Tb,jc,Hc,hd)=>{if(1===jc)return 32;this.control.show(hd);return 32};this.uub=(Jb,Tb,jc,Hc,hd)=>{if(1===jc)return 32;if(!hd)return 8;Tb=hd.P6a;if(!Tb||!Tb.isConnected)return 8;Jb=this.jp.Ndd(Tb);if(!({isHeader:jc,CGg:Tb}=this.jp.eIi(Tb)).returnValue)return 8;this.control.Vka(Jb);this.control.MDa(Tb);this.control.show(jc,hd.oye);return 32};this.ga=b;this.jp=h;this.qIc=r;this.WQa=A;this.ul=L;this.fd=Z;this.Rc=oa;this.PQk=Ba;this.Jxk=gb;this.gtk=Ab}get control(){return this.uda}set control(b){this.uda=
b}Xb(){this.ga.qa(Ec.a.HUf,kc.a.view,this.BHg);this.ga.fb(Ec.a.sng,kc.a.application,this.rlo,96);this.ga.qa(Ec.a.AMg,kc.a.view,this.BHg);this.ga.qa(Ec.a.IFe,kc.a.view,this.BHg);this.ga.fb(Ec.a.J$d,kc.a.view,this.J$d,64);this.ga.qa(Ec.a.v_d,kc.a.view,this.v_d);this.ga.fb(Ec.a.SW,kc.a.application,this.SW,96);this.ga.fb(Ec.a.uub,kc.a.application,this.uub,96);this.ga.fb(Ec.a.YRo,kc.a.view,this.MDa,96);this.ga.qa(Ec.a.lMj,kc.a.view,this.MDa);this.ga.qa(Ec.a.nMj,kc.a.view,this.MDa);this.ga.qa(Ec.a.mMj,
kc.a.view,this.MDa);this.ga.qa(Ec.a.oMj,kc.a.view,this.MDa);this.ga.fb(Ec.a.wVo,kc.a.view,this.Eyb,100);this.ga.fb(Ec.a.YNj,kc.a.view,this.Eyb,4);this.ga.fb(Ec.a.XNj,kc.a.view,this.Eyb,4);this.ga.fb(Ec.a.VNj,kc.a.view,this.Eyb,4);this.ga.fb(Ec.a.WNj,kc.a.view,this.Eyb,4);this.ga.qa(Ec.a.twe,kc.a.view,this.twe);this.ga.qa(Ec.a.nxg,kc.a.view,this.twe);this.ga.fb(Ec.a.ekg,kc.a.view,this.ekg,96);this.ga.fb(Ec.a.ivf,kc.a.view,this.ivf,4);this.ga.fb(Ec.a.Fwj,kc.a.view,this.Uqe,97);this.ga.fb(Ec.a.Hwj,kc.a.view,
this.Uqe,97);this.ga.fb(Ec.a.Gwj,kc.a.view,this.Uqe,97);this.ga.fb(Ec.a.Iwj,kc.a.view,this.Uqe,97);this.ga.fb(Ec.a.Ywj,kc.a.view,this.Ure,97);this.ga.fb(Ec.a.Xwj,kc.a.view,this.Ure,97);this.ga.fb(Ec.a.Vwj,kc.a.view,this.Ure,97);this.ga.fb(Ec.a.Wwj,kc.a.view,this.Ure,97);this.ga.fb(Ec.a.llo,kc.a.view,this.Hlo,97);this.ga.fb(Ec.a.Nmg,kc.a.view,this.Rko,97)}Cki(b){const h=this.jp.k3c(b),r=this.jp.KAa(h);b=this.WQa.hAf(b,r);this.control.Vka(h);return b}Uyi(b,h){switch(b){case Ec.a.YNj:case Ec.a.Ywj:b=
1;break;case Ec.a.XNj:case Ec.a.Xwj:b=2;break;case Ec.a.VNj:case Ec.a.Vwj:b=3;break;case Ec.a.WNj:case Ec.a.Wwj:b=4;break;default:b=h}return b}mJf(b,h){switch(b){case Ec.a.lMj:case Ec.a.Fwj:b=1;break;case Ec.a.nMj:case Ec.a.Hwj:b=2;break;case Ec.a.mMj:case Ec.a.Gwj:b=3;break;case Ec.a.oMj:case Ec.a.Iwj:b=4;break;case Ec.a.AMg:case Ec.a.IFe:b=h;break;case Ec.a.HUf:b=0;break;default:b=h}return b}WFi(b,h){return b===Ec.a.nxg||b===Ec.a.Nmg?parseInt(h.MenuItemId):h}TOf(b){return this.ul.Vaa(b.Lk)}Njp(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}leo(b,h){const r=this.UKi(b);if(h[Jd.a.Visible]=r)b=this.ul.QJi(this.Jxk(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[Jd.a.LabelText]=b}UKi(b){const h=this.fd.Ql();h.set(b);h.zb(8);h.mt(8);return 1<this.ul.jOf(h)}static PJi(b){const h=new hb.a;h.set(b);h.zb(10);return Ao.WordSectionNavigator.oJo(h)}}Object(u.a)(cD,"HeaderFooterActor",
null,[]);var tH=d(810),FB=d(726);class dD{constructor(b,h,r,A,L){this.NFk=b;this.jp=h;this.ul=r;this.fd=A;this.ga=L}oki(b,h){this.jp.RVb(b);h=this.F1l(b,h);b.uc();return h}hAf(b,h){b=this.fd.osa(b,8,8);let r=!1;this.ul.$Ua(b,A=>{const L=this.fd.Ql();L.set(A);r=(A=this.oki(L,h))||r;return A});return r}F1l(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=FB.a.bwf(h);for(let A=0;A<h.length;++A)r=this.NFk.E1l(b,h[A])||r;return r}}dD.kPl=1;Object(u.a)(dD,"HeaderFooterInserter",null,[635]);class Gw{constructor(b,
h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.eEh=this.Zeh=!1;this.xG=null;this.wWe=!1;this.G5b=0;this.Ile=()=>{this.wWe=!0};this.z9=b;b.bind(this);this.$af=A;this.Gtk=gb;this.Qwh=L;this.GGk=Z;this.rib=oa;this.I_=h;this.footer=r;this.I_.oLl();this.z9.$A();this.i$e=dD.kPl;this.WQa=Ba;Gw.ga=Ab;this.RY=Jb}get Rea(){return this.Zeh}show(b=!0,h=!0){this.Rea||(this.r9j(),this.uNj(!0),this.I_.xto(),this.Gtk(),this.Fdp(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.PBa&&(eg.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new tH.a,
{state:0,disablePopover:!0}))):v.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.eEh=h)&&this.Qwh(b)}dismiss(b=!1){this.Rea&&(this.GGk(b),this.uNj(!1),this.JNb(),this.G5b=0,this.Rep(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.PBa&&(eg.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new tH.a,{disablePopover:!1}))):v.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}uNj(b){this.Zeh=
b;Gw.ga.Ob(vb.a.lEf,2);this.z9.d4(b);this.I_.d4(b);this.footer.d4(b);this.$af()}Vka(b){this.xG!==b&&(this.xG=b,this.I_.Vka(b),this.footer.Vka(b),this.G5b=0,this.Eyb(this.rib.KAa(b)))}JNb(){this.xG&&(this.I_.Gob(),this.footer.Gob(),this.xG=null)}update(){this.Rea&&this.j2b()}j2b(){this.xG&&(this.rib.eYl(this.xG)&&this.rib.M_m(this.xG)?this.r9j():this.dismiss())}r9j(){const b=this.rib.KAa(this.xG);b!==this.i$e&&this.Eyb(b)}Eyb(b){this.i$e=b;this.MDa(this.pOm(b))}pOm(b){switch(b){case 2:return 2;case 3:return 3;
case 4:return 2}return 1}MDa(b,h=!0){this.G5b!==b&&(this.WQa.hAf(this.xG,this.i$e),this.I_.kMj(b),this.I_.KUh(Nk.a.yfa),this.footer.kMj(b),this.footer.KUh(Nk.a.efa),this.G5b=b,this.Rea&&this.eEh&&this.l2l(h))}l2l(b){this.Qwh(b);b?this.I_.pyb():this.footer.pyb()}dispose(){this.z9.Rca();this.I_.dispose();this.footer.dispose()}Fdp(){this.RY.lRd(this.Ile);this.wWe=!1}Rep(){this.RY.Grg(this.Ile);this.wWe&&Gw.ga.Ob(Ec.a.J$d,2)}static uVl(){Gw.ga.Qb(Za.a.Trb,2,!0);Gw.ga.Ob(Ec.a.L6,2)}}Gw.ga=null;Object(u.a)(Gw,
"HeaderFooterControl",null,[681,10]);class uH{constructor(b,h,r,A,L){this.$af=b;this.rib=h;this.WQa=r;this.ga=A;this.RY=L}create(b,h,r,A,L){return new Gw(b,h,r,this.$af,A,L,this.rib,this.WQa,Gw.uVl,this.ga,this.RY)}}Object(u.a)(uH,"Factory",null,[641]);class vH{constructor(){this.uda=null}get control(){return this.uda}set control(b){this.uda=b}bFf(b){return this.cFf(this.control.xG,this.control.G5b,b.isHeader,b)}cFf(b,h,r,A){return()=>{if(!b.isConnected)return null;this.control.Vka(b);this.control.MDa(h);
this.control.show(r);return A}}dismiss(){this.uda.Rea&&this.uda.dismiss()}}Object(u.a)(vH,"HeaderFooterControlLauncher",null,[]);var MJ=d(1131),qL=d(790),rL=d(826);class cy{constructor(b,h,r){this.Szc=null;const A=h?"Header":"Footer";this.Ms=b.ownerDocument.createElement("div");this.Ms.id=h?"HeaderPane":"FooterPane";this.Ms.classList.add(cy.Q_m,A);this.IJb=(new rL.a(this.Ms,"WACViewPanel_"+A)).rK;this.Ms.appendChild(this.IJb);b.appendChild(this.Ms);h&&(this.Szc=b.ownerDocument.createElement("div"),
this.Szc.classList.add(cy.X_m),this.Ms.appendChild(this.Szc));this.N8g=r.hEm(this.Ms)}bind(){}d4(b){b?this.N8g.K5k():this.N8g.M5k()}ndl(b){b.vdc(this.IJb)}}cy.X_m="HeaderToolbarContainer";cy.Q_m="HeaderFooterPane";Object(u.a)(cy,"PaneControlDom",null,[712]);class mx{constructor(b,h,r,A,L){this.rG=this.ur=null;this.amj=()=>{this.rG.dismiss(!0);if(this.G6b){const Z=new gu.a(!0);this.G6b.$Ma(Z)}return!0};this.mH=Z=>{Z.Lb.preventDefault();return!1};this.Ms=b.ownerDocument.createElement("div");this.Ms.id=
mx.k7h;this.Ms.className=mx.k7h;this.F1=A;this.G6b=L;this.ONi=new cy(this.Ms,!0,h);this.NIl(this.Ms);this.bqi=new cy(this.Ms,!1,h);this.d4(!1);b.appendChild(this.Ms)}NIl(b){this.ur=b.ownerDocument.createElement("div");this.ur.id=mx.r8n;this.ur.className=mx.p8n;this.ur.tabIndex=0;this.ur.setAttribute($c.a.Wh,$c.a.N$);this.ur.setAttribute($c.a.Wja,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.ur)}bind(b){this.rG=b}d4(b){if(!b&&this.F1){var h=new gu.a(!0);this.F1.$Ma(h)}!b&&
this.G6b&&(h=new gu.a(!0),this.G6b.$Ma(h));this.Ms.style.display=b?"":"none";this.ONi.d4(b);this.bqi.d4(b)}PUo(){this.ur.focus()}$A(){jg.a.instance.ub(od.a.click,this.ur,this.amj);Zf.a.instance.ub(od.a.dC,this.Ms,this.mH)}Rca(){jg.a.instance.xc(od.a.click,this.ur,this.amj);Zf.a.instance.xc(od.a.dC,this.Ms,this.mH)}}mx.k7h="HeaderFooterControl";mx.r8n="HeaderFooterOverlay";mx.p8n="EditingSurfaceOverlay HeaderFooterOverlay";Object(u.a)(mx,"HeaderFooterControlDom",null,[680]);var rs=d(155);class NJ{constructor(b,
h,r,A,L,Z,oa,Ba,gb,Ab){this.z9=null;this.sa=new Bf.a;this.rG=this.wLd=null;this.f_n=Jb=>{this.rca(Jb);this.sa.raiseEvent("OnShowEventKey")};this.e_n=Jb=>{this.K3&&(this.wLd=new MJ.a(this.K3));this.Zb.mYc(Nk.a.yfa);this.Zb.mYc(Nk.a.efa);this.kha(Jb);this.sa.raiseEvent("OnDismissEventKey")};this.Ioe=()=>{this.wLd&&(this.wLd.dispose(),this.wLd=null)};this.Zb=b;this.gq=h;this.Cyh=r;this.kyk=A;this.xIk=L;this.ga=Z;this.tch=qL.a.create();this.wgh=Cb.KeyInputManager.oc(jf.a.Pu,0);this.r1=Cb.KeyInputManager.oc(jf.a.J4,
0);this.COk=Cb.KeyInputManager.oc(jf.a.B0a,0);this.JFb=oa;this.Aa=Ba;this.F1=gb;this.G6b=Ab;this.K3&&this.K3.g6(this.Ioe)}f2k(b){this.sa.addHandler("OnShowEventKey",b)}tCo(b){this.sa.removeHandler("OnShowEventKey",b)}tPh(b){this.sa.addHandler("OnDismissEventKey",b)}gCo(b){this.sa.removeHandler("OnDismissEventKey",b)}get K3(){const b=this.JFb.value;return b?b.vj?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,
317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.rG}get ZAl(){return this.tch}bind(b){this.rG=this.izl(b);this.tch.instance=this.rG}izl(b){this.z9=new mx(b,this.xIk.value,this.Aa,this.F1,this.G6b);b=this.Cyh.value.create(this.ga,this.z9.ONi,!0,Nk.a.yfa);const h=this.Cyh.value.create(this.ga,this.z9.bqi,!1,Nk.a.efa);this.rG=this.kyk.value.create(this.z9,b,h,this.f_n,this.e_n);this.hUf();this.xW();return this.control}hUf(){var b=3===this.ga.mode?Nk.a.AF:
Nk.a.Puc;const h=this.Zb.ie(Nk.a.yfa);h.parent=b;this.Zb.Kdf(Nk.a.yfa);const r=this.Zb.ie(Nk.a.efa);r.parent=b;this.Zb.Kdf(Nk.a.efa);b=this.Zb.ie(rs.a.DRb);b.parent=Qf.AFrame.Gq;b.Nja(()=>{this.z9.PUo()});b.bindAction(this.wgh,Ec.a.SW);b.bindAction(this.r1,Ec.a.SW);b.bindAction(this.COk,Ec.a.SW);h.bindAction(this.r1,Ec.a.SW);r.bindAction(this.r1,Ec.a.SW)}xW(){this.gq.xW(Nk.a.yfa);this.gq.xW(rs.a.Q9a);this.gq.xW(Nk.a.efa);this.gq.xW(rs.a.DRb)}rca(b){this.gq.QK(Nk.a.yfa);this.gq.QK(rs.a.Q9a);this.gq.QK(Nk.a.efa);
this.gq.QK(rs.a.DRb);this.gq.Dx(Qf.AFrame.Do);this.Zb.VRc(Nk.a.yfa);this.Zb.VRc(Nk.a.efa);b?this.Zb.Gg(Nk.a.yfa):this.Zb.Gg(Nk.a.efa)}kha(b){this.gq.Dx(Nk.a.yfa);this.gq.Dx(rs.a.Q9a);this.gq.Dx(Nk.a.efa);this.gq.Dx(rs.a.DRb);this.gq.QK(Qf.AFrame.Do);(b||this.Zb.currentScope&&(this.Zb.currentScope.name===Nk.a.yfa||this.Zb.currentScope.name===rs.a.Q9a||this.Zb.currentScope.name===Nk.a.efa||this.Zb.currentScope.name===rs.a.DRb))&&this.Zb.Gg(Qf.AFrame.Do)}dispose(){const b=this.Zb.ie(rs.a.DRb);b.ot(this.wgh);
b.ot(this.r1);this.Zb.ie(Nk.a.yfa).ot(this.r1);this.Zb.ie(Nk.a.efa).ot(this.r1);this.K3&&this.K3.nZb(this.Ioe);this.control.dispose()}}Object(u.a)(NJ,"HeaderFooterControlOwner",null,[639,640]);var WE=d(1116);class vn{constructor(b,h,r,A,L,Z,oa,Ba){this.eqa=b;this.APk=h;this.SLe=r;this.Hm=A;this.ZHk=L;this.ZNk=Z;this.$xk=oa;vn.Vh=Ba}jan(b,h){this.APk(b,1,3,null,!1);this.eqa.LPj($C.a.gWb,1696,b.currentNode);this.SLe(b,0,this.Hm?3:1,h);this.SLe(b,1,2,h);this.SLe(b,2,this.Hm?1:3,h);this.ZHk(b);this.ZNk(b,
!1,!0,null);this.$xk(b,h)}static get mM(){return null!=vn.N6g?vn.N6g:vn.N6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get ql(){return null!=vn.d2g?vn.d2g:vn.d2g=Wa.a.instance.resolve("Box4.IParagraphEditor")}static VSo(b,h,r){Kh.moveToCellContent(b,0,h);fg.OutlineElementNavigator.Me(b);vn.mM.pod(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);vn.ql.wH(b.currentNode,r);h||vn.ql.fr.PDa(b,1,-115);2===h&&vn.ql.fr.oyb(b.currentNode,1,-115);Kh.returnToContainingTable(b)}static uVo(b,
h){fg.OutlineElementNavigator.Me(b);vn.mM.pod(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);fg.OutlineElementNavigator.me(b)}static Ykm(){return(b,h,r)=>{vn.VSo(b,h,r)}}static Kum(){return(b,h)=>{vn.uVo(b,h)}}static tNm(b){return(h,r,A,L,Z)=>b.vza(h,r,A,L,Z)}static mLm(){return(b,h,r,A,L)=>vn.Vh.yy(b,h,r,A,L)}}vn.Vh=null;Object(u.a)(vn,"HeaderFooterDefaultTableInserter",null,[637]);class wH{constructor(b,h,r,A){this.jp=b;this.AId=h;this.fd=r;this.ul=
A}YPj(b,h){b.Aq.properties.setValue(Vc.a.iRf,2===h||4===h);b.zb(8);b.std(8).properties.setValue(Vc.a.q$d,3===h||4===h)}Nyo(b){this.ul.$Ua(b,h=>{const r=this.fd.Ql();r.set(h);this.jp.RVb(r);this.YPj(r,1);this.Oyo(r);return!0})}Oyo(b){for(;b.je();)b.Tg()}}Object(u.a)(wH,"HeaderFooterEditor",null,[636]);var XE=d(1101);class YE extends Nv.a{constructor(b){super();this.bbf=b}get index(){return 0}run(){this.bbf()}L_m(b,h){h.property===Vc.a.iRf&&this.QI()}P8n(b,h){h.property===Vc.a.q$d&&this.QI()}QI(){this.r0()}}
Object(u.a)(YE,"ControlUpdateNeededTracker",Nv.a,[]);class Ap{constructor(b,h,r,A,L,Z){this.fhb=null;this.lyk=r;this.tCd=h;this.l7b=b;this.nIk=A;this.TRa=Z}start(){this.l7b.bind(ab.StaticActiveAppFrame.za().kG);this.tCd.control=this.l7b.control;this.tCd.Xb();this.lyk.control=this.l7b.control;this.nIk.value.create(this.l7b.control,Object(D.a)(this.tCd,this.tCd.Cki,"ensureSectionHeaderFooterAttachedToControl")).Xb();this.I2m()}I2m(){this.fhb=new YE(()=>{this.l7b.control.update()});const b=ed.a.jf.Tl;
b.qf(35).Qo(Object(D.a)(this.fhb,this.fhb.L_m,"headerFooterContainerNodePropertyChanged"));b.qf(8).Qo(Object(D.a)(this.fhb,this.fhb.P8n,"pageContentNodePropertyChanged"));XE.a.gte(Object(D.a)(this.fhb,this.fhb.QI,"setUpdateNeeded"));Kp.a.instance.Zua(this.fhb,3)}dispose(){this.l7b.dispose();this.TRa.ggi()}}Object(u.a)(Ap,"HeaderFooterManager",null,[]);class dt{constructor(b,h,r,A){this.ul=b;this.jp=h;this.l9b=r;this.HOe=A}E1l(b,h){let r=!1;const A=FB.a.ZKf(h);b.zu(A)||(this.zan(b,h),this.HOe.ian(b.currentNode,
h),r=!0);return r}zan(b,h){const r=this.l9b.create(Ln.a.Glc),A=b.currentNode.ka(Vc.a.Wua,0);r.properties.setValue(Vc.a.Wua,A);r.properties.setValue(Vc.a.Flc,h);h=FB.a.ZKf(h);b.Wf(r,h)}}Object(u.a)(dt,"HeaderFooterNodeLevelInserter",null,[634]);var nx=d(1425),eD=d(1462);class Tv extends nx.a{constructor(b,h,r){super(b,h,"","");this.SGb=null;this.aOi=Tv.Xci;this.c6c=[];this.PTe=r}get uC(){return!0}get cssClass(){return"cui-herodock"}yn(){this.rto();super.yn()}LUa(){for(const b of this.c6c)b.P0d();super.LUa()}Fcp(){const b=
[],h=[],r=[];for(let A=0;A<this.c6c.length;A++){const L=this.c6c[A];L.visible?b.length<this.aOi?b.push(L):Object(Gb.a)(eD.FlyoutAnchor,L)?Array.addRange(h,L.Ynm()):h.push(L):r.push(L)}return{cnp:b,n8n:h,Pdn:r}}MIl(b){if(!b||!b.length)return null;const h=new jh.Menu(this.root,this.id+"OverflowMenu",null,null,null),r=new bi.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const A of b)r.Wf(A.MW("Menu20"));h.Wf(r);return h}rto(){this.Eua();
this.Tc=Ug.a.EZa(this.Tc);this.mE();const {cnp:b,n8n:h,Pdn:r}=this.Fcp();for(var A of b){var L=A.MW("Medium20");L.enabled=!0;this.Ubc(L,this.children.count);this.Tc.appendChild(L.Tc);L.Vra()}if(A=this.MIl(h)){if(this.SGb)this.SGb.Jg=A;else{L=this.id+"OverflowMenuLauncher";const Z={};Z.Image20by20=this.PTe.OverflowMenuImage20by20;Z.Image20by20Class=this.PTe.OverflowMenuImage20by20Class;Z.PopulateDynamically="false";Z.HideDefaultArrow="true";Z.Alt=this.PTe.OverflowMenuTooltip;Z.Command="798637440";
Z.Id=L;this.SGb=new eD.FlyoutAnchor(this.root,L,Z,A)}A=this.SGb.MW("Small20");A.enabled=!0;this.Ubc(A,this.children.count);this.Tc.appendChild(A.Tc);A.Vra()}if(y.AFrameworkApplication.J.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const Z of r)A=Z.MW("Medium20"),this.Wf(A),A.Vra()}dispose(){this.SGb&&(this.SGb.dispose(),this.SGb=null);for(const b of this.c6c)b.dispose();this.Eua();super.dispose()}set uC(b){super.uC=b}}Tv.Xci=4;Object(u.a)(Tv,"HeroDock",nx.a,[]);var GB=d(1504);class fD extends GB.a{constructor(){super();
this.VAe=this.Zon=this.tep=!1;this.yLn=y.AFrameworkApplication.kZf?1:Tv.Xci}}Object(u.a)(fD,"ToolbarBuildOptions",GB.a,[]);var Jj=d(1459),xH=d(1534),ZE=d(1559);class ox extends nx.a{constructor(b,h,r){super(b,h,"","");this.oDc=r.Alignment;this.Efh=r.ScalingDirection===Jj.a.Ffk}yn(){this.Zza();this.SZ(this.Tc);super.yn()}SZ(b){for(const h of this.children){h.mE();switch(this.oDc){case Jj.a.rHe:Ug.a.sg(h.Tc,"cui-toolbar-button-left");break;case Jj.a.Tfb:Ug.a.sg(h.Tc,"cui-toolbar-button-center");break;
case Jj.a.u3b:Ug.a.sg(h.Tc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.oDc);}h.visible&&b.appendChild(h.Tc);h.Vra()}}nR(b){if(!Object(Gb.a)(Gj.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.oDc){case Jj.a.rHe:return"cui-toolbar-buttondock alignleft";case Jj.a.Tfb:return"cui-toolbar-buttondock aligncenter";case Jj.a.u3b:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.oDc);
}}get uC(){return!0}get alignment(){return this.oDc}flc(){let b=0;if(this.alignment===Jj.a.Tfb)for(const h of this.children){const r=h;r.visible&&(b+=r.Tc.offsetWidth)}else b=this.Tc.offsetWidth;return b}G8d(){let b=null;if(this.alignment===Jj.a.Tfb)for(const h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Tc);break}}else b=Sys.UI.DomElement.getBounds(this.Tc);return b?0===this.root.x4?b.x:b.x+b.width:0}O5d(){let b=null;if(this.alignment===Jj.a.Tfb){if(0<this.children.count){const h=
this.children.uIf(this.children.count-1);for(;h.jvb();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Tc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Tc);return b?0===this.root.x4?b.x+b.width:b.x:0}aAf(){for(const b of this.children){const h=b;if(!Object(Gb.a)(Gj.a,h)||h.control.visible)h.visible=!0}}yMo(b){const h=this.children.toArray(),r=new ZE.a;let A=this.Efh?0:h.length-1;const L=this.children.count,Z=this.root.O_a;for(;this.flc()>=b&&!(A>=L||0>A);){const oa=h[A];
Z&&Object(Gb.a)(Gj.a,oa)&&oa.control.visible&&(r.add(oa),oa.PSh());A+=this.Efh?1:-1}for(const oa of r)oa.mCj(),oa.visible=!1}set uC(b){super.uC=b}}Object(u.a)(ox,"ButtonDock",nx.a,[]);class HB extends an.a{constructor(b,h,r,A,L,Z,oa=!1){super(b,h,Z);this.Gwa=this.c1=this.Ypa=null;this.o0e=!1;this.sab=A;this.VAe=L;this.sOd=0;xf.c(h.Size)||(h.Size===Jj.a.UPg||r.options.Zon?this.sOd=0:h.Size===Jj.a.Mik&&(this.sOd=1));this.QQk=oa}get O_a(){return!0}Wf(b){super.Wf(b);Object(Gb.a)(ox,b)&&!this.o0e&&(b.alignment===
Jj.a.rHe?(this.Ypa&&this.Dyg(),this.Ypa=b):b.alignment===Jj.a.Tfb?(this.c1&&this.Dyg(),this.c1=b):b.alignment===Jj.a.u3b&&(this.Gwa&&this.Dyg(),this.Gwa=b))}Dyg(){this.o0e=!0;this.Gwa=this.c1=this.Ypa=null}iyb(b,h){b=this.u2c(b);xf.c(b)||b.visible===h||(b.visible=h,this.refresh())}yn(){super.yn();this.Xzj(!0)}Xzj(b){const h=this.root.xMb;xf.c(this.Tc)&&this.pLl();this.Tc=Ug.a.EZa(this.Tc);this.e6c&&this.Tc.appendChild(this.e6c);for(const r of this.children)r.visible&&(r.mE(),this.Tc.appendChild(r.Tc),
r.Vra());this.c1&&b&&this.b1l();h&&h.E0();this.dirty=!1}b1l(){if(this.c1.visible&&this.c1.children.count&&(this.bTh(0,0),this.dYl(this.Ypa,this.c1,this.Gwa))){let b=0,h=0;const r=this.Ypa?this.Ypa.flc():0,A=this.Gwa?this.Gwa.flc():0;if(0<A||0<r)A>r?(b=0,h=A-r):(b=r-A,h=0);this.bTh(b,h)}}dYl(b,h,r){let A=!1;0===this.root.x4?(b&&(A=b.O5d()>h.G8d()),!A&&r&&(A=h.O5d()>r.G8d())):(b&&(A=b.O5d()<h.G8d()),!A&&r&&(A=h.O5d()<r.G8d()));return A}bTh(b,h){0===this.x4?(this.c1.Tc.style.marginLeft=b+"px",this.c1.Tc.style.marginRight=
h+"px"):(this.c1.Tc.style.marginRight=b+"px",this.c1.Tc.style.marginLeft=h+"px")}pLl(){this.mE()}ov(){this.Zgi(()=>{Gs.a.prototype.ov.call(this)})}tua(b){b=this.u2c(b);xf.c(b)||this.Zgi(Object(D.a)(b,b.xn,"pollForStateAndUpdate"))}Zgi(b){this.Brc=this.xbb=!1;b();if(this.xbb||this.Brc)this.QQk||this.refresh(),this.scale()}nR(b){if(!Object(Gb.a)(Tv,b)&&!Object(Gb.a)(ox,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Gb.a)(ox,b)&&b.alignment===
Jj.a.Tfb)for(const h of this.children)if(h.alignment===Jj.a.Tfb)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.sOd?(b+="cui-toolbar-onerow ",y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.pba||(b+="UITextTranformUpperCase ")):1===this.sOd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Mza(){return"div"}get kca(){return 26}get v1j(){return this.SQ}set v1j(b){this.SQ=b}nEl(b){b=b[Jj.a.Ux];
return new ox(this.root,b.Id,b)}mE(){super.mE();this.Tc.setAttribute("role","toolbar");this.properties.Title&&this.Tc.setAttribute("title",this.properties.Title)}VOa(b){return this.root&&this.root.Tuc(b)?!0:!1}SUo(){this.e_a()}scale(){super.scale();if(!Ug.a.Zs(this.properties.Scale)||this.o0e)return!1;xf.c(this.Ypa)||(this.Ypa.visible=!0,this.Ypa.aAf());xf.c(this.c1)||(this.c1.visible=!0,this.c1.aAf());xf.c(this.Gwa)||(this.Gwa.visible=!0,this.Gwa.aAf());this.Xzj(!1);const b=this.Tc.offsetWidth,h=
xf.c(this.Ypa)?0:this.Ypa.flc(),r=xf.c(this.c1)?0:this.c1.flc(),A=xf.c(this.Gwa)?0:this.Gwa.flc();A+r+h>=b&&(A+h>=b?(this.gOi(this.c1),A>=b?(this.gOi(this.Ypa),this.svg(this.Gwa,b)):this.svg(this.Ypa,b-A)):this.svg(this.c1,b-A-h));this.xbb=!1;this.yn();return!1}gOi(b){b&&(b.visible=!1)}svg(b,h){b&&b.yMo(h)}}Object(u.a)(HB,"Toolbar",an.a,[1756]);class gD extends HB{constructor(b,h,r,A,L=!1){super(b,h,r,!1,!1,A,L);this.Fsh=!0}get kca(){return 7}get cssClass(){return gD.uep+" "+super.cssClass}static get uep(){let b=
"cui-statusbar";y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.pba||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(u.a)(gD,"StatusBar",HB,[]);var Uv=d(1488);class yH extends Uv.a{constructor(){super();this.toolbar=null;this.xfe=!1}}Object(u.a)(yH,"ToolbarBuildContext",Uv.a,[]);class Vu extends Fp.a{constructor(b,h,r,A){super(b,h,Mf.Task.a7(r),A);this.k3n=L=>{this.Ozg(this.iil(L.xid,L.GWc));this.toolbar.v1j=this;this.toolbar.yn();this.placeholder.appendChild(this.toolbar.Tc);
Ug.a.sg(this.placeholder,"loaded");this.Pya.continueWith(()=>{this.Pya.result.xWb(this.toolbar)},11)};if(xf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}Ozg(b){this.root=b}get MHg(){return this.options}gil(){const b=new yH,h=new xH.a;h.id="toolbar";h.cjd=1;h.handler=this.k3n;h.data=b;this.Cza.rve(h)}iil(b,h){var r=Jj.a.kla(b,Jj.a.Hjk);xf.c(r)&&(r=Jj.a.kla(b,Jj.a.Tik),h.xfe=!0);if(xf.c(r))throw Error.create("No toolbar element was present in the data");
b=new Jj.a(r);r=y.AFrameworkApplication.J.$("ToolbarScalingRedundancyEliminationIsEnabled");h.xfe?this.Ozg(new gD(b.attributes[Jj.a.id],b.attributes,this,this.Tda,r)):this.Ozg(new HB(b.attributes[Jj.a.id],b.attributes,this,this.MHg.tep,this.MHg.VAe,this.Tda,r));this.toolbar.Yya=this.options.Yya;this.toolbar.aFe=!0;this.toolbar.yn();b=Jj.a.Gx(Jj.a.kla(b.node,Jj.a.jfk));h=this.Pfl(b,h);for(const A of h)this.toolbar.Wf(A);return this.toolbar}Pfl(b,h){const r=[];for(let A=0;A<b.length;A++)this.aXa(b[A])||
Array.add(r,this.sgl(b[A],h));return r}sgl(b,h){const r=Jj.a.R3c(b);let A=null;r===Jj.a.Fdk?A=this.Zfl(b,h):r===Jj.a.Sfk&&(A=this.Pgl(b,h));return A}Pgl(b,h){var r=new Jj.a(b);r=new Tv(this.root,r.attributes[Jj.a.id],b[Jj.a.Ux]);r.aOi=this.MHg.yLn;b=Jj.a.kla(b,Jj.a.kBb);b=Jj.a.Gx(b);const A=[];for(let Z=0;Z<b.length;Z++){var L=b[Z];this.aXa(L)||(L=this.dka(L,h),Array.add(A,L))}r.c6c=A;return r}Zfl(b,h){new Jj.a(b);const r=this.toolbar.nEl(b);b=Jj.a.kla(b,Jj.a.kBb);b=Jj.a.Gx(b);for(let A=0;A<b.length;A++){if(this.aXa(b[A]))continue;
const L=this.hil(b[A],h);r.Wf(L)}return r}hil(b,h){var r=new Jj.a(b);const A=r.name;r=r.attributes[Jj.a.aCc];let L;L=h.xfe?"Small14":"Small";switch(A){case Jj.a.button:return b=this.dka(b,h),b.MW(xf.b(r)?L:r);case Jj.a.KJa:return L=h.xfe?"Medium14":"Medium",b=this.dka(b,h),b.MW(xf.b(r)?L:r);case Jj.a.label:return b=this.dka(b,h),b.MW(xf.b(r)?L:r);case Jj.a.separator:return b=this.dka(b,h),b.MW("Small");case Jj.a.toggleButton:return b=this.dka(b,h),b.MW(xf.b(r)?L:r);default:throw Error.create("Invalid control type.");
}}}Object(u.a)(Vu,"ToolbarBuilder",Fp.a,[]);var zH=d(2129);class IB{constructor(b,h,r,A,L,Z){this.Mvb=()=>{this.toolbar.xn()};this.xK=b;b=new Eo.a(tj.a.Z5a,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);A=new fD;A.bJ={};Z=3!==Z.mode;A.bJ.HeaderToolbarControlsRight=Z;A.bJ.HeaderToolbarButtonDockRight=Z;A.bJ.HeaderToolbarButtonRemovePageNumbers=Z;L=new Vu(A,this.xK,this,L);L.Cza=new zH.a(IB.Y_m,b);L.gil();this.jqa=L.toolbar;r.execute(oa=>{this.toolbar.tH=oa});
this.toolbar.refresh();this.toolbar.xn();this.ii=h;h.B5a(this.Mvb)}get toolbar(){return this.jqa}dispose(){this.ii.hvc(this.Mvb);this.toolbar&&(this.toolbar.dispose(),this.jqa=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.SUo()}tVl(){this.toolbar.K6()}xWb(){}}IB.Y_m="WordEditorHeaderToolbarData";Object(u.a)(IB,"HeaderFooterToolbar",null,[127,679]);class OJ{constructor(b,h,r,A,L){this.ii=b;this.XNe=h;this.Fd=r;this.Tda=A;this.ga=L}create(b){return new IB(b,this.ii,this.XNe,this.Fd,
this.Tda,this.ga)}}Object(u.a)(OJ,"Factory",null,[633]);class PJ{constructor(b,h){this.fd=b;this.ul=h}eKl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.dKl(b)+"</Controls></MenuSection></Menu>"}vum(b){const h=this.fd.Ql();h.set(b);h.zb(8);h.kd(8);return h}dKl(b){if(!b)return"";let h="";b=this.vum(b);this.ul.$Ua(b,r=>{const A=this.ul.QJi(r);r=r.getValue(Vc.a.Wua);h+=Ak.k(r.toString(),
r.toString(),Ec.a.nxg.toString(),Ec.a.Nmg.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,A));return!0});return h}}Object(u.a)(PJ,"HeaderFooterToolbarGenerator",null,[632]);var Dt=d(132);class Hw extends yB.a{constructor(b,h,r,A,L,Z,oa){super(b,h,r,A);this.mv=()=>{this.Ksd(this.Cb)};this.xK=b.container;this.ox=document.createElement("div");this.XP(this.ox);this.EGa=L;this.MQa=Z;this.eo.execute(Ba=>{Ba.gY(this.mv)});this.l$=oa;this.xK.style.backgroundColor=
this.l$.pkc()}dispose(){super.dispose();this.eo.instance&&this.eo.instance.hNa(this.mv)}get eo(){return null!=this.DWg?this.DWg:this.DWg=Wa.a.instance.Ta("Common.IZoomManager")}OB(b){this.xK.classList.add("HeaderFooterViewElement");this.ox.classList.add("HeaderFooterViewContent");this.Ksd(b.currentNode)}M6(b){this.ox.parentNode&&this.ox.parentNode===this.xK||(this.xK.appendChild(this.ox),this.MQa.instance&&this.MQa.instance.Szg(this.ic,this.xK));super.M6(b)}NNb(b){Dt.a.le(()=>{Dt.a.prototype.NNb.call(this,
b);this.E6j();this.MQa.instance&&this.MQa.instance.H5j(this.ic,this.ox.style.paddingLeft,this.ox.style.paddingTop)},"HFVE:UFO")}Ksd(b){this.eo.instance&&this.eo.instance.xud(this.ox);this.E6j();b=this.EGa.Mkc(b);this.ox.style.paddingLeft=b.efc+"px";this.ox.style.width=b.FWc+"px";this.MQa.instance&&this.MQa.instance.H5j(this.ic,this.ox.style.paddingLeft,this.ox.style.paddingTop)}E6j(){if(this.eo.instance){this.ox.style.paddingTop="";var b=Dn.a.WB(this.ox);b.paddingTop&&(b=Je.a.ZU(b.paddingTop),this.ox.style.paddingTop=
Math.round(b/this.eo.instance.nl)+"px")}}}Object(u.a)(Hw,"HeaderFooterViewElement",yB.a,[]);class Ur{constructor(b,h,r){this.EGa=b;this.MQa=h;this.l$=r}create(b,h,r,A){return new Hw(b,h,r,A,this.EGa,this.MQa,this.l$)}}Object(u.a)(Ur,"Factory",null,[631]);var hA=d(325),AH=d(199),Pp=d(976),BH=d(595);class hD extends hA.a{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe){super(h,Z,oa,Ba,gb,AH.a.aPi,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe);this.isHeader=this.isHeader=b;this.f4a=L;this.f4a.Vqd=this;A(this);
this.tyd=r;this.IFa=document.createElement("div");this.IFa.setAttribute("Unselectable","on");this.IFa.setAttribute("hideselection","hideselection");this.IFa.setAttribute("style","outline:none;");this.IFa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;this.IFa.tabIndex=0;this.features.mTj=!0;this.features.xmf=!0}get rYf(){return!0}LOf(){const b=this.tyd.bFf(this);return Pp.ViewReference.dH(this,b)}Rwf(b){Object(Gb.a)(hD,b)||this.tyd.dismiss()}get RRf(){return"WordEditor"+
(this.isHeader?"Header":"Footer")+"HiddenLabel"}s4c(){return BH.a.iej}Tv(){super.Tv();this.f4a.Bki()}rF(b,h=null){this.IFa.parentNode&&this.IFa.parentNode.removeChild(this.IFa);super.rF(b,h);this.f4a.nki(this.vd.Fk)}detach(){this.f4a.Aki();super.detach();this.IFa.parentNode||this.container.insertBefore(this.IFa,this.container.firstChild)}kod(){this.ow?super.kod():this.IFa.focus()}U3d(){this.Tv()}}Object(u.a)(hD,"HeaderFooterView",hA.a,[678,187,150,80,10,101,188,189,190]);class QJ{constructor(b,h,
r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd){this.tyd=b;this.ESk=h;this.DSk=r;this.Sy=A;this.qd=L;this.lqa=Z;this.ga=oa;this.G2a=Ba;this.bya=gb;this.u$=Ab;this.hTk=Jb;this.nu=Tb;this.oG=jc;this.kg=Hc;this.ri=hd;this.kyd=Gd}create(b,h){return new hD(b,h,this.tyd,this.ESk,this.DSk(),this.Sy,this.qd,this.lqa,this.ga,this.G2a,this.bya,this.u$,this.hTk,this.nu,this.oG,this.kg,this.ri,this.kyd)}}Object(u.a)(QJ,"Factory",null,[630]);class Iw{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe){this.vyh=
!1;this.AFh="SourceControlId";this.jlp=1;this.klp=1E3;this.rre=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;this.YBd(wf[this.AFh]);wf[je.a.Text]=this.y2e.j9n(this.Sjb.$Rb);return 32};this.qlo=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;wf[Tg.a.On]=this.Sjb.$Rb;return 32};this.D5m=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;this.Sjb.uyp(wf[Tg.a.On]);return 32};this.HCj=(oe,ge,$d)=>{if(1===$d)return 32;if(this.uda){ge=Object(so.a)().Iu(ge.view.vd);$d=hb.a.eb(ge);const lf=this.Zd.S5a();try{const wf=this.Rc.Lc(15);try{wf.Ab(ge),
wf.Ph=oe,Tq.a.instance.$Ua($d,gi=>{this.B9b.ykd(gi,this.Xom,this.gWo);return!0})}finally{wf&&wf.dispose()}}finally{lf&&lf.dispose()}}return 32};this.shd=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;wf.MenuItems=this.pIk.value;this.vyh?this.Sjb.TGo():this.vyh=!0;return 32};this.vbn=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;const gi=this.YBd(wf[this.AFh]);if(this.uda){ge=Object(so.a)().Iu(ge.view.vd);$d=hb.a.eb(ge);lf=this.Rc.Lc(15);try{lf.Ab(ge);lf.Ph=oe;let Di=null;const Yl=this.ee.Xf("UserAction","InsertPageNumber");
Tq.a.instance.$Ua($d,xk=>{this.uda.Rea||this.Guk(xk);Di=this.x2e.tbn(xk,gi,this.Sjb.$Rb)||Di;return!0});Yl.stop();if(!Di)return 8;this.x8o(Di,gi)}finally{lf&&lf.dispose()}this.Zd.Yu(12)}return 32};this.i9n=()=>32;this.i9o=(oe,ge,$d,lf,wf)=>{if(1===$d)return 32;2===$d&&this.TRa.showCallout(wf);return 32};this.h9o=(oe,ge,$d,lf,wf,gi)=>this.V7e.create(oe,ge,$d,lf,wf,gi);this.wVl=(oe,ge,$d)=>{if(1===$d)return 32;this.TRa.ggi();return 32};this.n7o=oe=>{y.AFrameworkApplication.va.Zma(null,Ec.a.MUj,oe.ao,
null)};this.Xom=oe=>{const ge=If.a.instance.gb.currentSelection;let $d=-1;for(const lf of ge)if(lf.node===oe){$d=lf.cpBegin;break}return{returnValue:$d,eee:he.a.ym(ge)}};this.gWo=(oe,ge)=>{oe=qc.SelectionFactory.ue(oe,ge);If.a.instance.Kc(oe)};this.ga=b;this.Rc=h;this.Jb=r;this.Sjb=A;this.uda=L;this.jp=Z;this.y2e=oa;this.x2e=Ba;this.B9b=gb;this.TRa=Ab;this.ib=Jb;this.V7e=Tb;this.ee=jc;this.Zd=Hc;this.YBd=hd;this.Guk=qe;this.pIk=new rg.a(()=>this.Sjb.bEm())}Xb(){this.ga.fb(Ec.a.shd,kc.a.view,this.shd,
100);this.ga.fb(Ec.a.Bqj,kc.a.view,this.i9n,68);this.ga.fb(Ec.a.tSi,kc.a.view,this.vbn,4);this.ga.fb(Ec.a.$Rb,kc.a.view,this.D5m,4);this.ga.fb(Ec.a.ykd,kc.a.view,this.HCj,4);this.ga.fb(Ec.a.EAo,kc.a.view,this.HCj,4);this.ga.fb(Ec.a.qng,kc.a.application,this.qlo,97);this.ga.fb(Ec.a.rre,kc.a.application,this.rre,97);this.ga.fb(Ec.a.LUj,kc.a.view,this.i9o,4);this.ga.wW(Ec.a.MUj,kc.a.view,this.h9o,100);this.ga.fb(Ec.a.vVl,kc.a.view,this.wVl,4)}x8o(b,h){const r=b.Ib.paragraph;if(r){var A=this.jp.Ndd(r);
A&&this.uda.Vka(A)}A=this.uda.Rea;this.uda.show(4>h);r&&this.vVo(r)&&(this.FZo(b,r),this.n_k(b,A))}vVo(b){let h;if(!({isHeader:h,CGg:b}=this.jp.eIi(b)).returnValue)return!1;this.uda.MDa(b,h);return!0}FZo(b,h){b=qc.SelectionFactory.ue(h,b.Ib.cp);this.ib.Kc(b)}n_k(b,h){h=new mf.a(2,1,h?this.jlp:this.klp,this.n7o);h.ao=b;this.Jb.$b(h)}}Object(u.a)(Iw,"PageNumbersActor",null,[677]);class RJ{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){this.ga=b;this.Jb=h;this.Sjb=r;this.y2e=A;this.x2e=L;this.B9b=Z;this.TRa=
oa;this.V7e=Ba;this.jp=gb;this.Zd=Ab;this.YBd=Jb;this.NRk=Tb;this.Eja=jc}create(b,h){return new Iw(this.ga,new Ko.a,this.Jb,this.Sjb,b,this.jp,this.y2e,this.x2e,this.B9b,this.TRa,If.a.instance,this.V7e,ab.StaticActiveAppFrame.za().Vr,this.Zd,this.YBd,this.NRk,this.Eja,h)}}Object(u.a)(RJ,"Factory",null,[629]);var $E=d(2027),px;(function(b){b[b.small=0]="small";b[b.V8p=1]="mediumSmall";b[b.Es=2]="medium";b[b.JX=3]="large"})(px||(px={}));Object(u.b)("ModalCalloutSize",px);var Bn;(function(b){b[b.QCe=
0]="topCenter";b[b.Fpq=1]="topJustified";b[b.Gpq=2]="topLeft";b[b.Hpq=3]="topRight";b[b.Nkf=4]="bottomCenter";b[b.MVp=5]="bottomLeft";b[b.NVp=6]="bottomRight"})(Bn||(Bn={}));Object(u.b)("BeakLocation",Bn);class CH{constructor(b,h,r){this.ilp=1;this.d5e=!1;this.Q$b=null;this.cvo=()=>{this.ib.AB(this.wua);this.d5e=!0;this.Q$b=null};this.wua=(A,L)=>{if(A=L.Rm.currentSelection)1<A.length||!A.length?A=!0:(A=A.Qa,A=A.cpEnd-A.cpBegin,A=1<A||!A),A&&this.Ftk()};this.Jb=b;this.ib=h;this.Ftk=r}$A(){this.m_k()}Rca(){this.d5e?
(this.ib.gna(this.wua),this.d5e=!1):this.Q$b&&(this.Jb.wf(this.Q$b),this.Q$b=null)}m_k(){this.Q$b=new mf.a(2,1,this.ilp,this.cvo);this.Jb.$b(this.Q$b)}}Object(u.a)(CH,"CalloutDismissManager",null,[]);class iA{constructor(b,h,r,A){this.dismiss=()=>{this.WJ&&(this.uGc.Rca(),this.zdd.dismiss())};this.zdd=b;this.Qp=A;this.uGc=new CH(h,r,this.dismiss)}get WJ(){return this.zdd.WJ}show(){if(!this.WJ){const b=document.createElement("div");b.classList.add(iA.h9n);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;
this.zdd.content=b;this.zdd.show();this.Qp&&this.Qp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.uGc.$A()}}dispose(){this.dismiss();this.zdd.dispose()}static THl(b,h){h=$E.a.F$h(rd.a.getElementBounds(b.targetElement),h,ab.StaticActiveAppFrame.za().kG,px.small);h.Zja=iA.DGf(b);h.Au=!1;return h}static DGf(b){let h=Bn.Nkf;Object(Gb.a)(678,b.view)&&b.view.isHeader&&(h=Bn.QCe);return h}}iA.h9n="PageNumbersCalloutControl";Object(u.a)(iA,"PageNumbersCallOutControl",
null,[675]);class DH{constructor(b,h,r){this.hW=null;this.aW=!1;this.dismiss=()=>{this.WJ&&this.hW&&Ol.UISurfaces.uL().then(A=>{this.uGc.Rca();A.removeNotification(this.hW);this.aW=!1;return null},A=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",A);return null})};this.jl=b;this.uGc=new CH(h,r,this.dismiss)}get WJ(){return this.aW}show(){this.WJ||Ol.UISurfaces.uL().then(b=>{const h=b.callout(Object.assign(new ds.a,{target:this.jl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),
r=Object.assign(new dk.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.aW=!0},expirationOptions:Object.assign(new Kn.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.hW=b.addNotification(h,r);this.uGc.$A();return null},b=>{v.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(u.a)(DH,"ReactPageNumbersCallOutControl",null,[675]);class EH{constructor(b,h,r){this.ib=h;this.Jb=b;this.Qp=r}create(b,h){if(y.AFrameworkApplication.ua.Gb&&
y.AFrameworkApplication.ua.Gb.hXa)return new DH(h.targetElement,this.Jb,this.ib);b=iA.THl(h,b);return new iA(b,this.Jb,this.ib,this.Qp,y.AFrameworkApplication.ua.uS)}}Object(u.a)(EH,"Factory",null,[628]);class FH{constructor(b,h){this.rG=null;this.oIk=b;this.Nj=h}get control(){return this.rG}showCallout(b){this.control&&this.control.WJ&&this.control.dismiss();this.rG=this.ggo(b);this.control.show()}ggi(){this.control&&(this.control.dismiss(),this.rG=null)}ggo(b){const h=this.Nj.ksa();this.rG=this.oIk.value.create(h,
b);return this.control}}Object(u.a)(FH,"PageNumbersCalloutControlManager",null,[627]);var SJ=d(782);class GH extends lx.a{constructor(){super();this.Text=null}get Type(){return 7}}Object(u.a)(GH,"PageNumberGalleryButtonProps",lx.a,[]);const Wy=(b,h,r)=>{b=b.Ql();b.set(r);h.RVb(b);return b};class Vv{constructor(b,h,r){this.aVe=!1;this.Eja=h;this.Hm=r}get $Rb(){return this.aVe}bEm(){const b=Object.assign(new Ee.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.PXk());
b.MenuSectionList.push(this.IYk());b.MenuSectionList.push(this.lZk());return b}uyp(b){this.aVe=b;this.Uzj()}TGo(){this.aVe=!1;const b={};b[Vv.hQi]="CheckboxModel";this.Eja(b);this.Uzj()}PXk(){const b=Object.assign(new hh.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.yf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new SJ.a,{Id:Vv.E5m,Command:Ec.a.$Rb.toString(),QueryCommand:Ec.a.qng.toString(),
LabelText:F.a.yf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.yf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}IYk(){const b=Object.assign(new hh.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Oo.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",
Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Hm){for(var r=3;1<=r;r--)h.GalleryItems.push(this.gJf(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.gJf(r))}else for(r=1;6>=r;r++)h.GalleryItems.push(this.gJf(r));b.ControlList.push(h);return b}lZk(){const b=Object.assign(new hh.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Mj.a,{Id:"btnRemovePageNumber",Command:Ec.a.ykd.toString(),LabelText:F.a.yf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),
Alt:F.a.yf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:y.AFrameworkApplication.Lr,Image16by16Class:Pb.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}gJf(b){const h=Vv.Ihg+b.toString();var r=Object,A=r.assign,L=new GH,Z=Ec.a.tSi.toString(),oa=Ec.a.rre.toString(),Ba=F.a,gb=Ba.yf;let Ab="";switch(b){case 1:Ab=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Ab=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;
break;case 3:Ab=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Ab=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:Ab=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Ab=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return A.call(r,L,{Id:h,Command:Z,QueryCommand:oa,Alt:gb.call(Ba,Ab)})}Uzj(){const b={};for(let h=1;6>=h;h++)b[Vv.Ihg+h.toString()]="PageNumberGalleryButtonModel";b[Vv.hQi]="CheckboxModel";
this.Eja(b)}static cEm(b){return b?parseInt(b.substr(Vv.Ihg.length)):1}}Vv.E5m="btnIncludePageCount";Vv.hQi="IncludePageCount";Vv.Ihg="btnPageNumbersPosition";Object(u.a)(Vv,"PageNumbersControl",null,[626]);class dy{constructor(b,h,r,A,L=null,Z=null,oa=null,Ba=null){this.Xum=(gb,Ab)=>{const Jb=new Pd.a;gb=4>gb;switch(Ab){case 1:case 2:Jb.add(gb?0:3);break;case 3:case 4:Jb.add(gb?0:3),Jb.add(gb?1:4)}return Jb};this.Bnm=(gb,Ab,Jb)=>{var Tb=Wy(this.fd,this.jp,gb);this.jp.SVb(Tb,Jb);let jc=this.Urk(Tb,
Ab);if(jc)this.B9b.kDj(jc);else{Tb=Wy(this.fd,this.jp,gb);this.jp.SVb(Tb,Jb);Tb.je();if(Eb.a.Mh(Tb)&&(fg.OutlineElementNavigator.Me(Tb),Cd.ParagraphReader.Fh(Tb))){Tb=Tb.currentNode;const Hc=this.iIi(Ab);Cd.ParagraphReader.Xy(Tb)===Hc&&this.B9b.kDj(Tb)&&(jc=Tb)}jc||(Tb=Wy(this.fd,this.jp,gb),this.jp.SVb(Tb,Jb),this.DN.rSb(Tb,null,!0),jc=fg.OutlineElementNavigator.Me(Tb),this.wH(Ab,jc))}return jc};this.Cnm=(gb,Ab)=>{let Jb=null;gb.Vb(1);if(Eb.a.Mh(gb)&&(gb.Vb(2),si.TableReader.isTable(gb))){var Tb=
gb.currentNode;if(3===si.TableReader.Eh(Tb)){let jc=0;Tb=si.TableReader.Go(Tb);switch(Ab){case 1:case 4:jc=Tb?2:0;break;case 2:case 5:jc=1;break;case 3:case 6:jc=Tb?0:2}Kh.moveToCellContent(gb,0,jc);gb.currentNode&&Eb.a.Mh(gb)&&(gb=fg.OutlineElementNavigator.Me(gb),Cd.ParagraphReader.Wb(gb)&&(Jb=gb))}}return Jb};this.sln=(gb,Ab)=>{const Jb=Wy(this.fd,this.jp,gb);gb=Jb.currentNode.ka(Vc.a.Wua,0);this.jp.SVb(Jb,Ab);Ab=Jb.currentNode.ka(Vc.a.Wua,0);return gb===Ab};this.fd=b;this.qIk=h;this.B9b=r;this.jp=
A;this.rIc=L||this.Xum;this.Vrk=Z||this.Bnm;this.Urk=oa||this.Cnm;this.oBk=Ba||this.sln}get DN(){return null!=this.$0g?this.$0g:this.$0g=Wa.a.instance.resolve("Box4.IOutlineEditor")}tbn(b,h,r){var A=Wy(this.fd,this.jp,b).Aq;A=this.jp.KAa(A);A=this.rIc(h,A);let L=null;for(let oa=0;oa<A.length;oa++){var Z=A.ug(oa);this.oBk(b,Z)&&(Z=this.Vrk(b,h,Z),L=this.qIk.HYk(Z,r)||L)}return L}wH(b,h){dy.p4.pod(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);dy.ql.wH(h,this.iIi(b))}iIi(b){let h=
1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get ql(){return null!=dy.b2g?dy.b2g:dy.b2g=Wa.a.instance.resolve("Box4.IParagraphEditor")}static get p4(){return null!=dy.a4g?dy.a4g:dy.a4g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(u.a)(dy,"PageNumbersInserter",null,[625]);var jA=d(905),sL=d(910);class ey{constructor(b,h,r=null,A=null,L=null){this.HDl=(Z,oa)=>{Z=xc.a.Uc(Z,Cd.ParagraphReader.textLength(Z));const Ba=Z.node.Hc;return Ba?
ey.Cg.Lla(Z,gb=>{gb=sL.a.getInstance(gb,jA.a.CIf(oa));this.VXd(gb,15,Ba,oa);this.VXd(gb,47,Ba,oa);this.VXd(gb,16,Ba);this.VXd(gb,17,Ba);return gb}):null};this.$bn=(Z,oa)=>{Z=xc.a.Uc(Z,Cd.ParagraphReader.textLength(Z));ey.Cg.We(Z,oa)};this.Rc=b;this.BId=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.RNe=A||this.HDl;this.qHh=L||this.$bn}HYk(b,h){const r=this.Rc.Lc(15);r.Ab(b);var A=Cd.ParagraphReader.text(b),L=!1;0<A.length&&" "!==A.charAt(A.length-1)&&(L=!0);if(h){h=
String.format(this.BId,"#","$");L&&(h=" "+h);L=h.indexOf("#");A=h.indexOf("$");v.ULS.shipAssertTag(4256717,309,-1!==L,"{0}",{["PageNumberIndex"]:L});v.ULS.shipAssertTag(4256718,309,-1!==A,"{0}",{["PageCountIndex"]:A});v.ULS.shipAssertTag(4256719,309,L!==A,"{0}",{["PageNumberIndex"]:L,["PageCountIndex"]:A});let Ba;let gb;if(L<A){var Z=L;Ba=A;var oa=jA.a.O2c(0);gb=jA.a.O2c(1)}else Z=A,Ba=L,oa=jA.a.O2c(1),gb=jA.a.O2c(0);this.cVf(b,h,0,Z);oa=this.RNe(b,oa);this.cVf(b,h,Z+1,Ba);Z=this.RNe(b,gb);this.cVf(b,
h,Ba+1,h.length);b=L<A?oa:Z}else L&&this.qHh(b," "),b=this.RNe(b,jA.a.O2c(0));r.dispose();return b}VXd(b,h,r,A=null){const L=new Gl.a;L.setValue(Ke.a.Mca,!0);L.setValue(Vc.a.NOb,1);L.setValue(Vc.a.jt,h);switch(h){case 15:L.setValue(Vc.a.lXa,!0);L.setValue(Vc.a.C2,A);break;case 47:L.setValue(Vc.a.C2,A);break;case 17:L.setValue(Vc.a.STb,!0)}h=r.hu(L,Q.a.create());this.DZk(b,h)}DZk(b,h){b.uya(h,Q.a.nil,On.AParagraphNode.RB,null)}cVf(b,h,r,A){h=h.substring(r,A);0<h.length&&this.qHh(b,h)}static get Cg(){return ey.Rd||
(ey.Rd=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set Cg(b){ey.Rd=b}}ey.Rd=null;Object(u.a)(ey,"PageNumbersNodeLevelInserter",null,[624]);class JB{j9n(b){return JB.HGm(b)}static HGm(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,JB.sqj,JB.sqj)}}JB.sqj="1";Object(u.a)(JB,"PageNumbersPositionPreviewGenerator",null,[623]);class vu{constructor(){this.Vbh=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,
"\ufffc","\ufffc");this.qrk=this.Vbh.length}h_m(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===Cd.ParagraphReader.textLength(b)?{returnValue:!0,vhd:h}:{returnValue:!1,vhd:-1}}JYm(b){let h=b.characterData.lastIndexOf(this.Vbh);return-1!==h&&h+this.qrk===Cd.ParagraphReader.textLength(b)?{returnValue:!0,vhd:h}:{returnValue:!1,vhd:-1}}FZm(b){return xl.a(b,9)?!0:!1}}Object(u.a)(vu,"PageNumbersReader",null,[622]);class TJ{constructor(b,h,r,A,L,Z=null,oa=null){this.DAo=(Ba,gb,Ab,Jb)=>
{Ba=Wy(this.fd,this.jp,Ba);this.jp.SVb(Ba,gb);gb=uw.a.zq(Ba);for(Ba=!1;gb.moveNext();){const Tb=gb.currentNode;if(Cd.ParagraphReader.Wb(gb.currentNode)&&xl.a(gb.currentNode,9)){Ba=!0;let jc;const Hc=({eee:jc}=Ab(Tb,jc)).returnValue;let hd=Hc;hd=this.kzo(Tb,hd);hd=this.bBo(Tb,hd);-1<Hc&&(hd===Hc&&jc||Jb(Tb,hd))}}Ba&&this.Zd.Yu(12)};this.fd=b;this.jp=h;this.z2e=r;this.Zd=A;this.uOc=L;this.rIc=Z||FB.a.bwf;this.HKk=oa||this.DAo;this.BId=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;
this.Lih=String.format(this.BId,"#","$");this.Bzk=this.Lih.indexOf("#");this.Azk=this.Lih.indexOf("$");this.oSe=String.format(this.BId,"\ufffc","\ufffc");this.Eih=this.oSe.length}ykd(b,h,r){var A=Wy(this.fd,this.jp,b).Aq;A=this.jp.KAa(A);A=this.rIc(A);for(const L of A)this.HKk(b,L,h,r)}kDj(b){if(this.z2e.FZm(b)){let h=-1;if(({vhd:h}=this.z2e.JYm(b)).returnValue&&this.Q0h(b,h)||({vhd:h}=this.z2e.h_m(b)).returnValue&&this.yol(b,h))return!0}return!1}bBo(b,h){var r=b.ra.length;for(let L=0;L<r;L++){var A=
b.ra.Ub(L);A.blob&&9===A.blob.Sh&&(A=A.cp,r=xc.a.createTextRange(b,A,A+1),this.uOc(r,""),r=b.ra.length,L--,h=this.wQh(h,A,1))}return h}kzo(b,h){let r=b.characterData.indexOf(this.oSe);for(;-1!==r;)this.Q0h(b,r)&&(h=this.wQh(h,r,this.Eih)),r=b.characterData.indexOf(this.oSe);return h}yol(b,h){const r=b.ra.Dh(h);return r&&r.blob&&9===r.blob.Sh?(b=xc.a.createTextRange(b,h,h+1),this.uOc(b,""),!0):!1}Q0h(b,h){const r=b.ra.Dh(h+this.Bzk),A=b.ra.Dh(h+this.Azk);return r&&r.blob&&9===r.blob.Sh&&A&&A.blob&&
9===A.blob.Sh?(b=xc.a.createTextRange(b,h,h+this.Eih),this.uOc(b,""),!0):!1}wQh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(u.a)(TJ,"PageNumbersRemover",null,[621]);class lr{constructor(b,h){this.NBb=this.MBb=null;this.Ms=b;this.Jb=h}K5k(){this.Ms.style.display="";this.MBb||(this.NBb&&(this.Jb.wf(this.NBb),this.NBb=null),this.MBb=new mf.a(0,1,10,()=>{this.Ms.classList.add("Displayed");this.MBb=null}),this.Jb.$b(this.MBb))}M5k(){this.Ms.classList.remove("Displayed");this.NBb||(this.MBb&&
(this.Jb.wf(this.MBb),this.MBb=null),this.NBb=new mf.a(0,1,200,()=>{this.Ms.style.display="none";this.NBb=null}),this.Jb.$b(this.NBb))}}Object(u.a)(lr,"PaneControlAnimationHelper",null,[528]);class UJ{constructor(b){this.Jb=b}hEm(b){return new lr(b,this.Jb)}}Object(u.a)(UJ,"PaneControlAnimationHelperFactory",null,[483]);class VJ{constructor(b,h,r,A,L,Z,oa,Ba,gb=!1){this.T7g=this.jqa=this.uCd=null;this.P_m=()=>{this.Iw.sendNotification(this.T7g+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,
!0)};this.ga=b;this.z9=h;this.z9.bind(this);this.vWe=r;this.Cxa=L;this.X$e=oa;this.Zb=Ba;this.ODd=gb;this.Hia=Z.value.create(r,A);this.z9.ndl(this.Hia);this.r1=Cb.KeyInputManager.oc(jf.a.J4,0)}get Iw(){return null!=this.XRg?this.XRg:this.XRg=Wa.a.instance.resolve("Common.Utils.IAriaNotifier")}d4(b){this.z9.d4(b);this.jqa&&!b&&this.jqa.tVl()}Vka(b){this.uCd!==b&&(this.Gob(),this.uCd=b)}kMj(b){if(this.uCd){var h=this.Cxa.WPb(this.uCd,FB.a.Wum(b,this.vWe));this.ODd?(this.T7g=this.nsi(b,this.vWe),this.Hia.w_b($c.a.ySd)):
this.bvp(b);h&&this.Pif(h)}}KUh(b){this.ODd&&this.Zb&&(b=this.Zb.ie(b))&&b.J$(this.P_m)}nsi(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}bvp(b){this.Hia.yNj(this.nsi(b,this.vWe),$c.a.ySd)}pyb(){this.Hia.kod()}Pif(b){this.Gob();this.Hia.rF(b,b.Fk)}Gob(){this.Hia.detach()}oLl(){this.jqa=this.X$e.value.create(this.z9.Szc);
this.I1o(this.jqa)}I1o(b){if(this.Zb){const h=this.Zb.ie(rs.a.Q9a);h.parent=Qf.AFrame.Gq;h.Nja(()=>{b.setFocus();this.R_o()});h.bindAction(this.r1,Ec.a.SW)}}R_o(){if(this.Zb){var b=this.Zb.ie(rs.a.Q9a);const h=new Jg.DOMFocusListing(()=>this.z9.Szc);h.Uga=!0;h.rn(1);this.Zb.Qmb(this.z9.Szc,b,h);b=this.Zb.getRegion(rs.a.Q9a);b.AZa();b.rP=!0;h.$ka&&h.iA(h.$ka)}}dispose(){void 0!==this.jqa&&null!==this.jqa&&(this.Zb.ie(rs.a.Q9a).ot(this.r1),this.jqa.dispose())}xto(){void 0!==this.jqa&&null!==this.jqa&&
this.jqa.refresh()}}Object(u.a)(VJ,"PaneControl",null,[527]);class HH{constructor(b,h,r,A){this.jp=b;this.nyk=h;this.X$e=r;this.Zb=A}create(b,h,r,A){return new VJ(b,h,r,A,this.jp,this.nyk,this.X$e,this.Zb,y.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(u.a)(HH,"Factory",null,[482]);var iD=d(1114);class aF extends bx.a{constructor(b,h,r,A,L,Z,oa,Ba,gb){super();this.init(b);this.nm("ShowCalloutForPageNumberOperation");this.umk=Ba;this.usb(this.umk,h,A,L,Z);
this.pA=0;this.SRa=Z;this.TRa=oa;this.ii=gb;1===this.behavior&&(this.hs=32,this.fva())}get B0l(){if(null!=this.pUg)var b=this.pUg;else{var h;b=this.pUg=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.ii.kb.Gw;if(!this.pA){var h=tB.a.Njc(this.SRa,b);this.SRa.R5c(h)?this.SRa.BAa(b,h).element&&(this.pA=1):this.B0l&&(this.pA=2)}1===this.pA&&(h=tB.a.Njc(this.SRa,b),h=this.SRa.BAa(b,
h),b=new iD.a(h.element,b),this.TRa.showCallout(b),this.pA=2);2===this.pA&&(this.hs=32,this.fva())}}Object(u.a)(aF,"ShowCalloutForPageNumberOperation",bx.a,[]);class ss{constructor(b,h,r){this.TRa=b;this.ga=h;this.L3b=r}create(b,h,r,A,L,Z){return new aF(b,h,r,A,L,Z,this.TRa,this.ga,this.L3b)}}Object(u.a)(ss,"Factory",null,[481]);class kA{get DN(){return null!=this.Y0g?this.Y0g:this.Y0g=Wa.a.instance.resolve("Box4.IOutlineEditor")}wc(b){b.ia("WordEditor.HeaderFooter.HeaderFooterManager",()=>new Ap(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),
b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.nf("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new QJ(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),Op.a.cqf,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),
ab.StaticActiveAppFrame.za().kb,Object(Kb.a)(),()=>b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),b.Ta("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Ta("Common.IZoomManager"),b.Oa("Box4.IContentControlViewElementManager"),b.Oa("Box4.CpConversionManagerImpl"),b.Oa("Box4.ContentControlConfigSettings"),b.Oa("Box4.IContentControlReader"),b.Oa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Ur(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).as("WordEditor.IHeaderFooterViewElementFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new OJ(Fl.a.hm,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Fl.a.hm,y.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();
b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new HH(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.nf("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.nf("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),Sg.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new uH(()=>{ab.StaticActiveAppFrame.za().Ge()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
y.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new RJ(y.AFrameworkApplication.va,zf.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),
b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Vv.cEm,Object(D.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().atd,"updateRibbonControl"),Object(D.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().eJ,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlLauncher",
()=>new vH).ha();b.ia("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new UJ(zf.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new NJ(Sg.FocusManager.instance(),ab.StaticActiveAppFrame.za().Ky,b.nf("WordEditor.HeaderFooter.IPaneControlFactory"),b.nf("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.nf("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),y.AFrameworkApplication.va,new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc),y.AFrameworkApplication.J,
b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new wH(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),pl.PageReader.instance,new Xi.a,Tq.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new PJ(new Xi.a,Tq.a.instance));b.ia("WordEditor.HeaderFooter.HeaderFooterActor",()=>new cD(y.AFrameworkApplication.va,
b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Tq.a.instance,new Xi.a,new Ko.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),cD.PJi,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new vn(VE.a.instance,vn.tNm(b.resolve("Box4.ITableEditor")),vn.Ykm(),y.AFrameworkApplication.isRtl,
fg.OutlineElementNavigator.me,vn.mLm(),vn.Kum(),b.resolve("Box4.IOutlineElementEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new WE.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Xi.a,h=>this.DN.rSb(h,null,WE.a.IAg),y.AFrameworkApplication.isRtl,Object(D.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").P_b,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),b.resolve("Box4.Styles.IWACStyleEditor")));
b.ia("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new dt(Tq.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();b.ia("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new bD(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Xi.a,new Ko.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),y.AFrameworkApplication.va)).ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new dD(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Tq.a.instance,new Xi.a,y.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.PageNumbersControl",()=>new Vv(Object(D.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().atd,"updateRibbonControl"),Object(D.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().eJ,"updateRibbonControls"),y.AFrameworkApplication.isRtl)).ha();
b.register(JB,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ia("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new ey(new Ko.a,b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersInserter",()=>new dy(new Xi.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersReader",
()=>new vu).ha();b.ia("WordEditor.HeaderFooter.PageNumbersRemover",()=>new TJ(new Xi.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(D.a)(kA.Cg,kA.Cg.We,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new FH(b.nf("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),ab.StaticActiveAppFrame.za())).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();
b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new EH(zf.a.instance,If.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new ss(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),y.AFrameworkApplication.va,ab.StaticActiveAppFrame.za())).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();
b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new Fw(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),y.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new qs(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get Cg(){return null!=
kA.xSg?kA.xSg:kA.xSg=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(u.a)(kA,"HeaderFooterComponentConfiguration",null,[1]);class KB{constructor(){this.wCd=this.Z=null}get name(){return"WordEditor.HeaderFooter"}wc(b){this.Z=b;(new kA).wc(b)}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(102)&&(this.wCd=this.Z.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.wCd.start(),this.Z.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.wCd&&
this.wCd.dispose()}static main(){E.a.instance.Mc(new KB)}}Object(u.a)(KB,"PackageManager",null,[0,1]);var IH=d(338),JH=d(516);class Qp{constructor(b,h){this.kg=b;this.Wm=h}create(){return new JH.a(this.kg.instance,this.Wm.instance)}}Object(u.a)(Qp,"ContentControlNodeFactory",null,[284]);var KH=d(1719),fy=d(400),bF=d(1066);class LH{create(){return new bF.a}}Object(u.a)(LH,"ContentControlContainerNodeFactory",null,[284]);var ts=d(201),tL=d(409),WJ=d(309),XJ=d(220),Xy=d(223),uL=d(1107);const Jw=b=>b?
(b=b.ka(Vc.a.aUa,null))&&b.includes(ts.a.mdi):!1;class Wv{constructor(b,h,r,A,L,Z,oa){this.Csa=b;this.Mf=h;this.Cg=r;this.uka=A;this.ED=L;this.tj=Z;this.hAl=oa;this.sWn=(Ba,gb)=>{Fq.a.aga&&(Ba=gb.node,gb=hb.a.eb(Ba),gb.zb(7)&&(gb=gb.kd(54)))&&(gb=gb.getValue(Vc.a.Xd),Ba=Ba.id,1==(null===gb||void 0===gb?void 0:gb.length)&&Ba.equals(gb[0])&&(Ba=this.Csa.twi(),this.nei(Ba)))};this.Edg=(Ba,gb)=>{if(Fq.a.aga)for(const Ab of gb.qci)Jw(Ab.Xd)||(Ba=Ab.Xd.ka(Vc.a.aUa,null),this.nei(Ba))}}get iXf(){return y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.uka.uAj(this.Edg);
this.hAl.wT(this.sWn)}nei(b){const h=this.Csa.jQb();h&&b&&this.Csa.gRb(h,b)&&(b=new Sb.GraphTransaction(7),b.ju(h),h.Tg(),b.dispose())}uXc(){const b=new uL.a;b.setValue(Vc.a.gTm,!0);var h=(h=eb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Vc.a.ilc,h);b.setValue(Vc.a.aAl,this.iXf);h=eb.a.create();b.setValue(Vc.a.vKi,h);return b}Ghl(b){const h=b.currentNode.getValue(Vc.a.vKi);b.Wf(new tL.a,1);b.n7();b.currentNode.setValue(Vc.a.chi,h);b.Wf(this.Mf.fob(),1);b.n7();
return this.Mf.dL(b)}l_o(b){var h=this.Csa.QJf();h.zb(7);if(h.uc()&&h.PVa(0,A=>8==A.type)){h=h.currentNode;const A=(new pv.WACStyleSet).Uaa(h);if(A){var r=A.nh(ts.a.Djg);if(!r&&(r=this.WYk(h),v.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=xc.a.createTextRange(b,0,Cd.ParagraphReader.textLength(b));this.ED.AW(b,L=>{this.tj.Wqa(L);this.tj.beb(L,r)})}}}fIl(b){var h=this.Csa.QJf();const r=this.uXc();h.Wf(r,29);h.n7();h=
this.Ghl(h);this.Cg.We(xc.a.Uc(h,0),b,!1,!1);this.l_o(h);return r}xtl(b){const h=this.Csa.jQb();this.Csa.gRb(h,b);b=this.uXc();const r=this.Csa.QJf();r.Wf(b,29);r.Yj(b);$e.a(h.currentNode,r.currentNode,!1);return b}Xzp(b,h){const {Roe:r,uNi:A}=this.Csa.ftm(b);if(r){var L=xc.a.createTextRange(r,0,Cd.ParagraphReader.textLength(r));this.Cg.We(L,h,!1,!1);A&&this.iRl(b);this.Kyp(b)}}iRl(b){const h=this.Csa.jQb();if(h&&b&&this.Csa.gRb(h,b))for(h.je(),b=h.ar(),--b;0<b;b--)h.ZB(b),h.Tg()}Kyp(b){const h=this.Csa.jQb();
this.Csa.gRb(h,b)&&h.currentNode.setValue(Ke.a.DU,new Date)}WYk(b){var h;const r=null===(h=Ki.a.Kg)||void 0===h?void 0:h.vn;h=r?new WJ.a(new XJ.a):new Xy.a(new XJ.a);h.setValue(cg.a.la,"Placeholder Text");h.setValue(cg.a.ma,1);h.setValue(Vc.a.na,"PlaceholderText");h.setValue(De.a.oa,99);h.setValue(Vc.a.pa,"Default Paragraph Font");h.setValue(Vc.a.fo,!0);h.setValue(Ke.a.fontColor,8421504);return Ki.a.gSc([h],b)?(r&&(b=Ki.a.Yb.ro(),h=Ki.a.Yb.Be(h),h=b.nh(h)),h):null}}Object(u.a)(Wv,"GlossaryEditor",
null,[653]);class MH{constructor(b,h,r,A,L){this.uka=b;this.H6h=h;this.uMb=r;this.RL=A;this.Lj=L;this.Zzl=new LH;this.Scg=(Z,oa)=>{this.RL.le(()=>{if(oa){oa.Nm.selectedContentControls||(oa.Nm.selectedContentControls={});var Ba=oa.Nm.selectedContentControls,gb=oa.BNa;if(gb&&gb.length){var Ab=gb[0];gb=gb[gb.length-1];Ab=this.uka.qHf(xc.a.Uc(Ab.node,Ab.zj),xc.a.Uc(gb.node,gb.Po),!1);for(const Jb of Ab)Jb.Xd.ka(Vc.a.DL,!1)||(Ba[Jb.Xd.id.toString()]=!0)}}},"CC:OnBeforeCopy")};this.rfd=(Z,oa)=>{this.RL.le(()=>
{if(oa){var Ba=oa.clone,gb=oa.original;try{const Ab=oa.Nm.selectedContentControls,Jb=this.uka.yGf(gb,0,gb.characterData.length,!0,!0,!1);for(const Tb of Jb){const jc=Tb.se.toString();Ab[jc]?Tb.nq&&!this.nCl(Tb.Xd,Ba,Ab)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",jc)),this.Iqg(Ba,Tb.se)):this.Iqg(Ba,Tb.se)}}catch(Ab){v.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Ab.toString()),this.H6h.Jyo(Ba)}}},
"CC:onParagraphCopy")};this.nfg=(Z,oa)=>{this.RL.le(()=>{if(oa){var Ba=oa.clone,gb=oa.original;try{const Ab=this.uka.yGf(Ba,0,gb.characterData.length);oa.Nm.ccObjectIdMapping||(oa.Nm.ccObjectIdMapping={});const Jb=oa.Nm.ccObjectIdMapping;for(let Tb=0;Tb<Ab.count;Tb++){const jc=Ab.K(Tb),Hc=jc.se.toString();if(this.Vqn(jc))if(jc.Wc){const hd=gb.Hj().ud.Eb(Hc),Gd=this.zFm(jc),de=this.ntl(hd,Gd.wrj,Gd.RRi,Ba.Hj().ud);Jb[Hc]=de.id;this.uMb.D6j(Jb[Hc],Ba.id,null);this.Lj.$qc(de)}else this.uMb.D6j(Jb[Hc],
null,Ba.id);Jb[Hc]?(jc.se=Jb[Hc],jc.fv=null):this.Iqg(Ba,jc.se)}}catch(Ab){v.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Ab.toString())}}},"CC:onParagraphPaste")}}init(){bp.a.TOh(this.Scg);bp.a.nRd(this.rfd);bp.a.oRd(this.nfg)}Wlm(b){if(!b.zb(25)||!b.kd(25))return null;if(!b.zu(25)){const h=this.Zzl.create(Ln.a.kra);b.Wf(h,25)}return b.Vb(25)}nCl(b,h,r){var A=b.ka(Vc.a.faa,null);const L=hb.a.eb(h);h=h.Hj().ud;r=A&&r[A.toString()]?h.Eb(A):this.Wlm(L);if(!r)return v.ULS.sendTraceTag(521172765,
368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;A=$e.b(b,h,!0);hb.a.eb(r).d6(A,26,b.id);54!==r.type&&A.setValue(Vc.a.faa,r.id);fy.a.iVf(null,A);return A}Iqg(b,h){this.H6h.xQl(new nb.a([b]),h)}Vqn(b){var h=b.Ib.paragraph.Hc;if(!h)return v.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.se.toString())),!1;h=h.Eb(b.fv);if(!h)return v.ULS.sendTraceTag(520152149,
368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.se.toString())),!1;b=h.getValue(Vc.a.jt);return 38===b||39==b}vkm(b,h){var r,A=b.ra.Ub(b.ra.length-1);let L=b.characterData.length;A=(null===(r=null===A||void 0===A?void 0:A.Hb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Ib.paragraph.id)&&(L=h.Ib.cp,A=h.Ib.Hb.sL(h.se,h.Wc));return this.uka.zGf(b,0,L,0,A)}zFm(b){let h=null,r=b.Ib.paragraph;const A={};for(;r;){const L=this.vkm(r,b);for(let Z=L.count-1;0<=Z;Z--){const oa=
L.K(Z);if(!oa.nq)continue;const Ba=oa.se.toString();if(oa.Wc){if(!A[Ba])return{wrj:oa.Xd,RRi:h}}else A[Ba]=!0,h||(h=oa.Xd)}r=Cd.ParagraphReader.pg(r,!0,!0)}return{wrj:null,RRi:h}}ntl(b,h,r,A){let L;h?L=this.uMb.rAa(h):(L=this.uMb.sAa(),h=L.currentNode);A=$e.b(b,A,!0);A.Wg(Vc.a.Ow,Sf.a.wD());54!==h.type&&A.setValue(Vc.a.faa,h.id);L.VJ(A,r,26);Fq.a.aga&&!Jw(b)&&this.uMb.utl(b,A);return A}}Object(u.a)(MH,"ContentControlCCP",null,[]);var vL=d(736);class jD{constructor(b,h,r,A){this.Rd=b;this.kg=h;this.hb=
r;this.th=A}get v7(){return!!this.kg.instance&&this.kg.instance.v7}get USb(){return!!this.kg.instance&&this.kg.instance.USb}qya(b,h,r,A,L,Z=ts.a.yNb,oa=ts.a.cgc,Ba=null,gb=ts.a.Ruf,Ab=-1){(b=this.mkc(b,r))?(b.Hb||(b.Hb=new IH.a(b)),this.ZVk(h,b.Hb,A,L,Z,oa,Ba,gb,Ab)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}Wdi(b,h,r){if(b){new nb.a;for(let L=0;L<b.count;L++){var A=this.nHf(b.K(L),h,!1);for(const Z of A)this.lzo(Z,r)}}}wQl(b,h){this.Wdi(b,h,
!0)}xQl(b,h){this.Wdi(b,h,!1)}We(b,h,r,A){this.Rd.We(b,h,r===vb.a.jpd||Fq.a.vec&&8===A)}mkc(b,h){var r=xc.a.Uc(b,h);this.Rd.ueb(r);for(r=0;r<b.ra.length;r++){const A=b.ra.Ub(r);if(A.cp>h)break;if(A.cp===h)return A}return null}ZVk(b,h,r,A,L=ts.a.yNb,Z=ts.a.cgc,oa=null,Ba=ts.a.Ruf,gb=-1){const Ab=h.Ib.paragraph;b=new vL.a(h.Ib,!0,!0,!0,null,b,A,r,L,Z,oa,Ba,null,this.th);if(!this.v7||-1>=gb||gb>h.length)gb=h.length;h.insert(b,gb);Ab.Vm();b.te?Ab.qe.rX(b.te-1,512):Ab.qe.Nsa(b.te,512);Ab.qe.Iq.W(b.te,
ov.CharacterPropertiesEditor.wN);Ab.qe.It.W(b.te,ov.CharacterPropertiesEditor.aS)}nHf(b,h,r){const A=new nb.a;for(let L=0;L<b.ra.length;L++){const Z=b.ra.Ub(L);if(Z.Hb)for(let oa=0;oa<Z.Hb.length;oa++)if(Z.Hb.K(oa).se.equals(h)&&(A.add(Z.Hb.K(oa)),r))return A}return A}Gsd(b,h,r){if(this.USb&&b){var A=b.node,L=b.zj,Z=b.Po,oa=this.yvi(A,L,h,!0);h=this.yvi(A,Z,h,!1);r?-1!==oa&&oa++:-1!==h&&h++;L||-1===oa||(oa=Math.max(oa,this.hb.vy(A)));Z===this.hb.textLength(A)&&-1!==h&&(h=Math.min(h,this.hb.Ex(A)));
b.Fb=oa;b.Tb=h}}yvi(b,h,r,A){return(b=(b=b.ra.Dh(h))?b.Hb:null)&&b.length?b.sL(r,A):-1}lzo(b,h){b&&b.Ib.Hb&&(h?b.Ib.Hb.remove(b):b.Ib.Hb.Gua(b),h=b.Ib.paragraph,0<=b.te&&b.te<h.qe.length&&(b.Ib.cp||1!==h.qe.length||(h.qe.rX(0,512),h.qe.Iq.W(1,ov.CharacterPropertiesEditor.wN),h.qe.It.W(1,ov.CharacterPropertiesEditor.aS)),h.qe.removeAt(b.te,512)),h.Vm())}Jyo(b){const h=b.ra;if(h){var r=new nb.a;for(let A=0;A<h.length;A++){const L=h.Ub(A);if(L&&L.Hb){for(let Z=0;Z<L.Hb.length;Z++)r.add(L.Hb.K(Z).te);
L.Hb=null}}b.fna(r)}}qtp(b,h,r){if(!(0>h||0>r))for(this.Rd.ueb(xc.a.Uc(b,h)),this.Rd.ueb(xc.a.Uc(b,r)),h=b.ra.L2(h),r=b.ra.L2(r),--r;r>h;r--){const A=b.ra.Ub(r);A.FXf?b.ra.Fua(r):A.formatting=null}}}Object(u.a)(jD,"ContentControlChpManager",null,[661]);class cF{constructor(b,h,r,A,L){this.hb=b;this.Gp=h;this.ri=r;this.Fd=A;this.th=L}lGf(b){if(!b||!he.a.mf(b))return null;if(!b.cpBegin){const h=this.Cti(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.hb.textLength(b.node)?this.Cti(b.node,b.Fb-
1,!1):null}ojm(b,h){b=this.r$h(b,h);return this.lGf(b)}Cti(b,h,r){return b.ra&&b.ra.length?(b=r?b.ra.first.Hb:b.ra.last.Hb)&&0<=h&&h<b.length&&b.K(h).zg&&b.K(h).Wc===r&&this.RWf(b.K(h))?b.K(h):null:null}JJf(b){if(!b||!he.a.Xw(b))return null;var h=this.Gp.l5d(b,b);b=0<h.count?h.K(h.count-1):null;return b&&!b.zg&&this.RWf(b)?(h=1<h.count?h.K(h.count-2):null)&&!h.zg&&this.RWf(h)?null:b:null}RWf(b){if(!b)return!1;var h=this.gDi(b);if(!h)return!1;if(b.Wc)var r=b;else r=h,h=b;var A=this.hb.textLength(b.Ib.paragraph);
if(r.Ib.cp||h.Ib.cp!==A||!r.nq||r.RBa||!h.nq||h.RBa)return!1;r=r.Ib.Hb;h=h.Ib.Hb;for(A=0;A<r.length&&!r.K(A).se.equals(b.se);A++)if(!r.K(A).Wc)return!1;for(r=h.length-1;0<=r&&!h.K(r).se.equals(b.se);r--)if(h.K(r).Wc)return!1;return!0}osd(b){b=this.lGf(b);this.qXd(b,!1)}w4j(b,h){b=this.r$h(b,h);this.osd(b)}GOa(b){b=this.JJf(b);return this.qXd(b,!0)?b:null}Vfn(b,h){b=this.lGf(b);return!!b&&b.se.equals(h)}nnc(b,h,r){b=this.ojm(b,h);return!!b&&b.se.equals(r)}EYf(b,h){b=this.JJf(b);return!!b&&b.se.equals(h)}qXd(b,
h){if(!b)return!1;const r=this.gDi(b);return this.v7h(b,h)&&(!r||this.v7h(r,h))}v7h(b,h){if(!b||b.zg===h)return!1;var r=this.Gp.EDe(b.Ib.paragraph,b.Wc);const A=b.Ib.Hb;-1!==r||b.Wc||(r=A.length);const L=h===b.Wc?1:-1;r+=h?L:0;b=A.sL(b.se,b.Wc)+L;if(r===b||0<L!==b>r)return v.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,L),v.ULS.shipAssertTag(24933848,368,0<L===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",
r,b,L),!1;for(var Z=r;Z!==b;Z+=L){var oa=A.K(Z);A.Gua(oa);oa.zg=h;A.kcn(oa,Z);this.wyp(A.K(Z))}if(this.x7)for(A.Ib.paragraph.Vm(),Z=r;Z!==b;Z+=L)oa=A.K(Z),oa.paragraph.qe.Iq.W(oa.te,ov.CharacterPropertiesEditor.wN),oa.paragraph.qe.It.W(oa.te,ov.CharacterPropertiesEditor.aS);h||this.$Ap(A,r,b,L);v.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-r),h?"block":"inline");return!0}O7d(b){return b.Wc&&this.th.dr(b.Xd.id,!0).equals(b.Ib.paragraph.id)?38:!b.Wc&&this.th.dr(b.Xd.id,
!1).equals(b.Ib.paragraph.id)?39:b.zg&&b.Wc?40:b.zg&&!b.Wc?41:!b.zg&&b.Wc?38:39}wyp(b){const h=b.Ib.paragraph.Hc;if(h){var r=h.Eb(b.fv),A=b.Xd;if(r){r=r.clone();r.setValue(Vc.a.l0f,b.zg);const L=this.O7d(b);r.setValue(Vc.a.jt,L);h.hu(r,null);b.fv=r.id}A&&A.setValue(Vc.a.eba,b.zg)}}gDi(b){if(b.Ib.cp&&b.Ib.cp!==this.hb.textLength(b.Ib.paragraph)||!b.Ib.paragraph.ra||!b.Ib.paragraph.ra.length)return null;const h=b.Wc?b.Ib.paragraph.ra.last:b.Ib.paragraph.ra.first;if(!h.Hb)return null;b=h.Hb.sL(b.se,
!b.Wc);return-1===b?null:h.Hb.K(b)}$Ap(b,h,r,A){var L=b.K(h).Xd;if(L){var Z=b.K(h).Wc;L=this.th.dr(L.id,Z);if(!L.equals(Q.a.nil))if(b.Ib&&b.Ib.paragraph&&b.Ib.paragraph.id.equals(L)){for(h+=A;h!==r;h+=A){const oa=b.K(h).Xd;if(!oa)return;this.th.fJ(oa.id,L,Z)}0<=r&&r<b.length&&b.K(r).zg&&this.a0f(b.K(r))&&(b=b.K(r).Xd)&&this.th.fJ(b.id,L,Z)}else v.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}a0f(b){return b.nq&&
!b.RBa}r$h(b,h){if(!b||!this.ri)return null;const r=h?xc.a.Uc(b,0):xc.a.Cx(b);b=this.ri.Kr(b,h);r.Tb=r.Fb=b;return r}get x7(){return this.Fd.isFeatureEnabled(25)}}Object(u.a)(cF,"ContentControlConverter",null,[659]);var Yy;(function(b){b[b.NMp=0]="BoundingBox";b[b.ORp=1]="Tags";b[b.NOp=2]="Hidden";b[b.cQp=3]="NumberOfContentControlAppearance"})(Yy||(Yy={}));Object(u.b)("ContentControlAppearance",Yy);var kD=d(1600);class dF{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.Vhb=this.Yda=this.uAd=this.RMd=
this.DHd=null;this.roa=this.Rk=this.kNc=this._id=0;this.e6b=this.$jb=this.MNd=this._title=this.kFa=null;this.HEd=this.GEd=this.vqh=this.tKd=this.xJc=this.tJc=this.Lzd=!1;this.Qrh=null;this.zg=!1;this.lyd=null;this.Pi=r;this.zz=h;this.lh=A;this.sr=L;this.Wm=Z;this.f5=oa;this.Gia=Ba;this.Gja=gb;this.TJb=Ab;this.th=Jb;b?(this.DHd=b.id,this.lyd=b,this.YW(!1)):this._id=Sf.a.wD()}get Tj(){return this.Pi.value}get id(){this.YW();return this._id}set id(b){this._id=b;this.isValid()&&(this.Xd.setValue(Vc.a.Ow,
this._id),this.BY())}get parentId(){this.YW();return this.kNc}set parentId(b){this.kNc=b}get title(){this.YW();return this._title}set title(b){this._title=b;this.isValid()&&(this.Xd.setValue(Vc.a.Knb,this._title),this.BY(),this.Jsd(h=>{h.title=this._title?this._title:ts.a.yNb}))}get tag(){this.YW();return this.MNd}set tag(b){this.MNd=b;this.isValid()&&(this.Xd.setValue(Vc.a.Onb,this.MNd),this.BY())}get type(){this.YW();return this.Rk}set type(b){this.Rk=b;this.isValid()&&(this.Xd.setValue(Vc.a.cUa,
kD.a[this.Rk]),this.BY())}get appearance(){this.YW();return this.roa}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.roa=b;this.isValid()&&(this.Xd.setValue(Vc.a.Lnb,Yy[this.roa].toLowerCase()),this.BY(),this.Jsd(h=>{h.appearance=Yy[this.roa].toLowerCase()}))}get color(){this.YW();return this.kFa}set color(b){if(b&&16777215>=b)this.kFa=b,this.isValid()&&(this.Xd.setValue(Vc.a.AWc,this.kFa),this.BY(),this.Jsd(h=>{h.color=this.kFa}));
else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.YW();return this.$jb}set placeholderText(b){this.$jb=b;Fq.a.aga&&this.lh.m7j(b,this.lyd)&&(this.BY(),this.HL&&this.Wm.JKb(this,!0))}get G_d(){this.YW();return this.e6b}set G_d(b){this.e6b=b;this.isValid()&&(this.Xd.setValue(Vc.a.tMb,this.e6b),this.BY())}get Dxf(){this.YW();return this.Lzd}set Dxf(b){b&&(this.Lzd=b,this.isValid()&&(this.Xd.setValue(Vc.a.dXd,this.Lzd),this.BY()))}get removeWhenEdited(){this.YW();
return this.tKd}set removeWhenEdited(b){if(b&&!this.Tla)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.tKd=b;this.isValid()&&(this.Xd.setValue(Vc.a.K6h,this.tKd),this.BY())}get Tla(){this.YW();return this.tJc}set Tla(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.tJc=b;this.isValid()&&(this.Xd.setValue(Vc.a.bfc,
this.tJc),this.Jsd(h=>{h.YM=this.tJc}),this.BY())}get isEditable(){this.YW();return this.xJc}set isEditable(b){this.xJc=b;this.isValid()&&(this.Xd.setValue(Vc.a.Nnb,this.xJc),this.Jsd(h=>{h.editable=this.xJc}),this.BY())}get isSupported(){this.YW();return this.vqh}get crn(){return this.isSupported&&11!==this.type&&10!==this.type}get $2i(){this.YW();return this.e6b&&"table of contents"===this.e6b.toLowerCase()?!0:!1}get Bee(){this.YW();return this.GEd}set Bee(b){this.GEd=b;this.isValid()&&(this.Xd.setValue(Vc.a.P6h,
this.GEd),this.BY())}get toc(){this.YW();return this.HEd}set toc(b){this.HEd=b;this.isValid()&&(this.Xd.setValue(Vc.a.Q6h,this.HEd),this.BY())}get HL(){return this.Xd.ka(Vc.a.gaa,!1)}set HL(b){this.isValid()&&this.Xd.setValue(Vc.a.gaa,b)}get isChecked(){return 8!==this.type?!1:this.Xd.ka(De.a.Hqf,!1)}set isChecked(b){8===this.type&&this.isValid()&&(this.Xd.setValue(De.a.Hqf,b),this.BY())}get rv(){this.YW();return this.RMd}set rv(b){this.RMd=b}get IA(){this.YW();return this.uAd}set IA(b){this.uAd=
b}get objectId(){return this.DHd}set objectId(b){this.DHd=b;this.lyd=this.Tj.Eb(this.DHd)}get start(){this.e9j();return this.Yda}set start(b){this.Yda=b}get end(){this.e9j();return this.Vhb}set end(b){this.Vhb=b}get Xd(){return this.lyd}S$n(b){for(let h=0;3>h;++h)if(Yy[h].toLowerCase()===b)return h;return 0}BY(){const b=this.start.node;b&&b.setValue(Ke.a.DU,new Date)}Xsd(){this._id=this.Xd.ka(Vc.a.Ow,0);this.roa=this.S$n(this.Xd.ka(Vc.a.Lnb,null));this.kFa=this.Xd.ka(Vc.a.AWc,null);this._title=this.Xd.ka(Vc.a.Knb,
null);this.MNd=this.Xd.ka(Vc.a.Onb,null);this.zg=this.Xd.ka(Vc.a.eba,!1);this.tJc=this.Xd.ka(Vc.a.bfc,!1);this.xJc=this.Xd.ka(Vc.a.Nnb,!1);this.vqh=this.Xd.ka(Vc.a.tka,!1);this.e6b=this.Xd.ka(Vc.a.tMb,null);this.Lzd=this.Xd.ka(Vc.a.dXd,!1);this.RMd=this.th.dr(this.Xd.id,!0);this.uAd=this.th.dr(this.Xd.id,!1);this.HEd=this.Xd.ka(Vc.a.Q6h,!1);this.GEd=this.Xd.ka(Vc.a.P6h,!1);this.tKd=this.Xd.ka(Vc.a.K6h,!1);this.Rk=Object(kD.b)(this.Xd.ka(Vc.a.cUa,"RichText"));let b=null;try{const h=this.Xd.ka(Vc.a.faa,
Q.a.nil);if(Q.a.hw(h,Q.a.nil))this.kNc=0;else if(b=this.Tj.Eb(h))this.kNc=b.ka(Vc.a.Ow,0)}catch(h){this.kNc=0}this.Wzp()}Wzp(){if(this.TJb){var b=this.Xd.ka(Vc.a.aUa,"");if((b=this.Gia.EJi(b))&&0<b.length){this.$jb=this.Jsi(b.Qa,b.Xc);return}}this.$jb=(b=this.lh.sAa())&&b.currentNode?b.currentNode.ka(Vc.a.BWc,null):null}YW(b=!0){if(!b||this.isValid())b=this.Xd.ka(Ke.a.lastModifiedTime,new Date(0)),this.Qrh!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.Xsd(),this.Qrh=b):v.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}ZAp(b,h){this.RMd=b;this.uAd=h;this.th.fJ(this.Xd.id,b,!0);this.th.fJ(this.Xd.id,h,!1)}e9j(){if(this.Xd){var b=this.rv,h=this.IA;if(!b||!h||b.equals(Q.a.nil)||h.equals(Q.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.lh.hsa(b,!0),h=this.lh.hsa(h,!1),
b&&h)if(b.isConnected&&h.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.zg)b=xc.a.create(b),this.sr.Gsd(b,this.objectId,!0),this.start=b,b=xc.a.create(h),this.sr.Gsd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.ra){for(let A=0;A<b.ra.length&&(-1===h||-1===r);A++){const L=b.ra.Ub(A);if(L.Hb)for(let Z=0;Z<L.Hb.length&&(-1===h||-1===r);Z++){const oa=L.Hb.K(Z);Q.a.hw(oa.se,this.objectId)&&(oa.Wc?h=L.cp:r=L.cp)}}0<=h&&0<=r&&(b=xc.a.XT(h,r,!1,
b),this.sr.Gsd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.zg?b=this.Jsi(h,r):(h=Cd.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=On.AParagraphNode.KP(h));return b}isValid(){return!!this.Xd&&this.Xd.isConnected}Rxe(b){return this.Gja?this.Wm.pzg(this,b)?0:2:2}clear(){return this.Gja?this.Wm.pzg(this,"")?0:2:2}Jui(){const b=new nb.a;var h=this.Xd.ka(Vc.a.Xd,[]);for(const r of h)if(!Q.a.hw(r,Q.a.nil)){h=this.Pi.value.Eb(r);
try{b.add(this.f5.IMb(h,this.zz,this.Pi,this.lh,this.sr,this.Wm,this.Gia,this.Gja,this.TJb))}catch(A){}}return b}LFf(){const b=new nb.a;this.zsi(this,b);return b}zsi(b,h){b=b.Jui();if(b.count)for(const r of b)h.add(r),this.zsi(r,h)}DF(b=!1){const h=new nb.a;if(this.zg){var r=this.Wm.dX(this.start,this.end);for(var A of r)r=xc.a.create(A),this.sr.Gsd(r,this.objectId,b),h.add(r)}else A=this.start.clone(),this.sr.Gsd(A,this.objectId,b),h.add(A);return h}Jsd(b){const h=this.Wm.dX(this.start,this.end);
for(let r=0;r<h.count;r++){const A=this.sr.nHf(h.K(r),this.objectId,!1);if(A){for(let L=0;L<A.count;L++)b(A.K(L));h.K(r).Vk()}}}Jsi(b,h){const r=new Sys.StringBuilder;h=this.Wm.dX(b,h);for(const A of h)A.id.equals(b.node.id)||r.append("\r"),r.append(Cd.ParagraphReader.R3(A));return r.toString()}}Object(u.a)(dF,"ContentControl",null,[690]);class NH{constructor(b){this.th=b}IMb(b,h,r,A,L,Z,oa,Ba,gb){return new dF(b,h,r,A,L,Z,this,oa,Ba,gb,this.th)}}Object(u.a)(NH,"ContentControlFactory",null,[658]);
class Zy{constructor(b,h,r,A,L){this.Pi=b;this.sr=h;this.jQk=r;this.EZ=A;this.Aa=L}Bwp(b,h,r){var A,L;if(!(Fq.a.Kqf&&b&&h&&r))return!1;const Z=b.Xd;if(!Z)return!1;var oa=Z.ka(Vc.a.vMb,Q.a.nil);oa&&!oa.equals(Q.a.nil)?b=this.Pi.value.Eb(oa):(b=this.sr.mkc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(A=null===b||void 0===b?void 0:b.formatting)||void 0===A?void 0:A.mo,b||(b=new YC.a,this.Pi.value.hu(b,null)),Z.setValue(Vc.a.vMb,b.id));A=this.Pi.value.Eb(b.id);oa="boolean"===typeof r&&
r;const Ba=null===(L=this.Aa)||void 0===L?void 0:L.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.jQk.cJf(Z,A,h,r,Ba?null:oa);h=this.EZ.tFe(h);for(const [gb,Ab]of h)b.setValue(gb,Ab);return!0}}Object(u.a)(Zy,"ContentControlFormattingManager",null,[660]);var YJ=d(944);class qx{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){this.zz=b;this.Pi=h;this.fd=r;this.VGb=A;this.Mrk=L;this.jT=Z;this.Vh=oa;this.hb=Ba;this.NId=gb;this.KBd=Ab;this.th=Jb;this.XSe=Tb;this.Gia=
jc}get nv(){return this.zz.value}sAa(){const b=this.fd.Ql();b.set(this.nv);this.VGb.ZR(b);if(b.Vb(25))return b;this.KBd.instance&&this.KBd.instance.$sa&&v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}g3c(b,h,r=!1){this.rOb();const A=new nb.a;let L;if(b){L=b.Vb(26);if(!L)return A;for(;L&&(!h(L)||(A.add(L),!r));){A.addRange(this.g3c(b,h));if(r&&0<A.count)break;L=b.Kf(26)}b.uc()}return A}aEm(){const b=
this.fd.Ql();b.set(this.zz.value);this.VGb.ZR(b);return b.currentNode}eXa(b,h,r){let A;A=b.equals(h);A||(A=(b=this.hsa(b,r))?b.id.equals(h):!1);return A}eVa(b,h){b=this.jv(b);if(!b)return null;let r=null;for(;55===b.type;){const A=this.th.dr(b.id,h);if(A.equals(r)){b=null;break}else b=this.jv(A);r=A}return b}hsa(b,h){return(b=this.eVa(b,h))?Cd.ParagraphReader.Wb(b)?b:h?this.hb.Zm(b):this.hb.GF(b):null}Udi(b,h=!1){this.Jvp(b);this.Vdi(b,h)}Jvp(b){var h=this.rAa(b);h=this.rAa(h.parentNode);h=55===h.currentNode.type?
h.currentNode.id:null;let r,A;r=this.jv(this.th.dr(b.id,!0));for(A=this.jv(this.th.dr(b.id,!1));r&&55===r.type;)r=this.jv(this.th.dr(r.id,!0));for(;A&&55===A.type;)A=this.jv(this.th.dr(A.id,!1));r&&A&&this.C6j(r.id,A.id,h,L=>{L=L.ka(Vc.a.d_,Q.a.nil);return!L||L.equals(Q.a.nil)||b.id.equals(L)})}Vdi(b,h=!1){v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");var r=this.rAa(b);const A=this.rAa(r.parentNode);let L=Q.a.nil,Z=Q.a.nil;var oa=A.currentNode.ka(Vc.a.Xd,[]);const Ba=
new nb.a;for(var gb=0;gb<oa.length;gb++)Ba.add(oa[gb]);if(h){if(54!==A.currentNode.type){L=this.th.dr(A.currentNode.id,!0);Z=this.th.dr(A.currentNode.id,!1);oa=this.jv(L);for(gb=this.jv(Z);oa&&55===oa.type;)L=this.th.dr(oa.id,!0),oa=this.jv(L);for(;gb&&55===gb.type;)Z=this.th.dr(gb.id,!1),gb=this.jv(Z)}oa=this.rAa(b);if(oa.Vb(26)){gb=new nb.a;for(gb.add(oa.currentNode);oa.Kf(26);)gb.add(oa.currentNode);for(var Ab of gb)this.Vdi(Ab,h)}}else if(L=this.th.dr(b.id,!0),Z=this.th.dr(b.id,!1),h=this.Bwm(Ba,
b.id),Ab=this.rAa(b),Ab.Vb(26)){oa=this.rAa(Ab.currentNode);gb=oa.currentNode;let Jb=b;for(;gb;){const Tb=Ab.currentNode;Ba.insert(h++,Tb.id);gb=oa.Kf(26);const jc=this.rAa(Tb);54!==A.currentNode.type?Tb.setValue(Vc.a.faa,A.currentNode.id):Tb.removeProperty(Vc.a.faa);$e.h(jc,A,Jb,26);Jb=jc.currentNode;gb&&(Ab.set(gb),Ab.F4(this.sAa().currentNode))}}54!==A.currentNode.type&&(h=this.th.dr(A.currentNode.id,!0),Ab=this.th.dr(A.currentNode.id,!1),h.equals(b.id)&&this.th.fJ(A.currentNode.id,L,!0),Ab.equals(b.id)&&
this.th.fJ(A.currentNode.id,Z,!1));r.Tg();v.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Ba,b.id);oa=Array(Ba.count);for(r=0;r<Ba.count;r++)oa[r]=Ba.K(r);A.currentNode.setValue(Vc.a.Xd,oa);YJ.a.fCa(b.id)}YVk(b,h,r,A,L,Z,oa=null){let Ba;if(h){var gb=this.jv(h.objectId);Ba=this.rAa(gb)}else Ba=this.sAa(),gb=Ba.currentNode;const Ab=this.Mrk.create(Ln.a.Xd);oa&&Ab.properties.zt(oa.properties);54!==gb.type&&Ab.setValue(Vc.a.faa,gb.id);oa?Ba.mSb(Ab,r,26,oa.id):Ba.VJ(Ab,r,26);
this.f9j(b,Ab.id,L,!0);this.f9j(b,Ab.id,Z,!1);b.zg&&(h&&(r=this.th.dr(gb.id,!0),oa=this.th.dr(gb.id,!1),r.equals(L)&&this.th.fJ(gb.id,Ab.id,!0),oa.equals(Z)&&this.th.fJ(gb.id,Ab.id,!1)),this.C6j(L,Z,Ab.id,Jb=>{Jb=Jb.ka(Vc.a.d_,Q.a.nil);const Tb=h?h.objectId:null;return!Jb||Jb.equals(Q.a.nil)||Jb.equals(Tb)}));L=this.rAa(Ab);Z=Array(A.count);for(gb=A.count-1;0<=gb;gb--)Z[gb]=A.K(gb).objectId,r=this.jv(A.K(gb).objectId),r=this.rAa(r),r.currentNode.setValue(Vc.a.faa,Ab.id),$e.h(r,L,null,26);0<Z.length&&
Ab.setValue(Vc.a.Xd,Z);qx.rc.isFeatureEnabled(31)&&(b.G_d&&Ab.setValue(Vc.a.tMb,b.G_d),b.Dxf&&Ab.setValue(Vc.a.dXd,!0));return Ab}f9j(b,h,r,A){12===this.jv(r).type?this.th.fJ(h,r,A):(this.th.fLg(h,r,A),this.th.fJ(h,A?b.start.node.id:b.end.node.id,A))}RTo(b,h,r,A,L){b.setValue(Vc.a.eba,h);b.setValue(Vc.a.bfc,!0);b.setValue(Vc.a.Nnb,!0);b.setValue(Vc.a.Ow,r);b.setValue(Vc.a.Lnb,Yy[0]);b.setValue(Vc.a.tka,!0);b.setValue(Vc.a.cUa,kD.a[L]);A&&b.setValue(Vc.a.fAb,A);b.setValue(Vc.a.cfc,0)}D6j(b,h=null,
r=null){h&&this.th.fJ(b,h,!0);r&&this.th.fJ(b,r,!1)}lei(b){if(!b||!b.count||!b.K(0))return null;const h=this.PGm(b);for(let r=0;r<b.count;r++)this.Vh.pDa(b.K(r));return h}PGm(b){if(!b||!b.K(0))return null;const h=this.fd.Ql();h.set(b.K(0));h.Nd();h.uc();return h.cP()?h.currentNode:null}lFm(b){const h=this.fd.Ql();h.set(b);h.Nd();h.uc();h.uc();return h}LNh(b,h,r){const A=new nb.a;for(let L=0;L<r;L++){h=this.jT.rSb(b,h,!0,null);if(!h||!b.je())return null;const Z=b.currentNode;b.uc();b.uc();A.add(Z)}return A}$kc(b){const h=
this.fd.Ql();h.set(b);for(h.zb(7);h.uc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}XCi(b){const h=this.fd.Ql();h.set(b);h.Nd();return(b=h.ldb())?b.id:null}RJf(b){const h=this.fd.Ql();h.set(b);return h.zb(7)?h:null}jv(b){return this.Pi.value.Eb(b)}rOb(){if(!qx.Onh){var b=this.sAa();b&&this.vIg(b);qx.Onh=!0}}H_a(b){return this.NId.H_a(b)}Dnf(b,h,r,A){let L=null,Z=b.kd(16);for(;Z!==r;){if(h&&$g.TableCellReader.TXf(b)||!h&&$g.TableCellReader.fee(b))L=
b.kd(14);else return{returnValue:!1,Hx:A};Z=b.kd(16)}L&&(A=xc.a.create(L));return{returnValue:!0,Hx:A}}vIg(b){if(b.Vb(26)){for(this.vIg(b);b.Kf(26);)this.vIg(b);b.uc()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.K(r).toString()===h.toString()){b.removeAt(r);break}}rAa(b){const h=this.fd.Ql();h.set(b);h.F4(this.sAa().currentNode);return h}Bwm(b,h){for(let r=0;r<b.count;r++)if(b.K(r).equals(h))return r;return-1}C6j(b,h,r,A){b=this.hnm(b,h);for(h=0;h<b.count;h++)A(b.K(h))&&(r?b.K(h).setValue(Vc.a.d_,
r):b.K(h).removeProperty(Vc.a.d_),this.KBd.instance&&this.KBd.instance.WVi&&b.K(h).Xl(16,!0))}hnm(b,h){const r=new nb.a;var A=this.jv(b);const L=this.jv(h);if(!A||!L)return r;const Z=({jbd:oa}=this.s4d(A,L)).returnValue;A=oa[Z];if(14===A.type)r.add(A);else if(15===A.type&&1<=Z){const Ba=oa[Z-1];1===si.TableReader.vg(Ba)&&r.add(Ba)}var oa=hb.a.eb(Z>=oa.length-1?A:oa[Z+1]);oa.zb(7);for(A=Dd.a.At(oa,A);A.moveNext()&&A.currentNode!==L;)14===A.currentNode.type&&r.add(A.currentNode);if(!Q.a.hw(h,b)&&14===
L.type)for(oa=hb.a.eb(L),A=Dd.a.At(oa,L);A.moveNext();)14===A.currentNode.type&&r.add(A.currentNode);return r}s4d(b,h){b=this.mqb(b);h=this.mqb(h);let r=0;for(;r<b.length&&r<h.length&&b[r]===h[r];++r);return{returnValue:0<r?r-1:r,jbd:b,Cug:h}}mqb(b){const h=[];h.push(b);b=hb.a.eb(b);for(b.zb(7);b.uc();)h.push(b.currentNode);h.reverse();return h}static get rc(){return null!=qx.UUg?qx.UUg:qx.UUg=Wa.a.instance.Oa("Box4.IFeatureHelper")}uXc(b,h,r=!1){b=this.XSe.instance.fIl(b);r?(r=ts.a.WOl,b.setValue(Vc.a.ilc,
r)):r=b.ka(Vc.a.ilc,null);h.setValue(Vc.a.aUa,r)}utl(b,h){this.ftj(b)&&(b=b.ka(Vc.a.aUa,null),b=this.XSe.instance.xtl(b).ka(Vc.a.ilc,null),h.setValue(Vc.a.aUa,b))}m7j(b,h){if(!this.ftj(h))return!1;var r=h.ka(Vc.a.aUa,null);r?Jw(h)?this.uXc(b,h):this.XSe.instance.Xzp(r,b):(r=this.Gia.twi())?h.setValue(Vc.a.aUa,r):this.uXc(b,h,!0);return!0}ftj(b){if(!b)return!1;var h=b.getValue(Vc.a.cUa);if(!h)return!1;h=Object(kD.b)(h);b=b.getValue(Vc.a.tMb);return(0==h||1==h)&&b!==gk.bhi}}qx.Onh=!1;Object(u.a)(qx,
"ContentControlGraphManager",null,[657]);class rx{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.rNe=Ab;this.qoa=null;this.fpn=(Jb,Tb)=>{if(this.v7)return this.gpn(Jb,Tb);if(!Jb||!Jb.count)return v.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let jc=!0;switch(Tb){case 0:Tb=this.ZO(Jb.K(0),Jb.K(Jb.count-1),1);if((Jb=this.ZO(Jb.K(0),Jb.K(Jb.count-1),3))&&0<Jb.count){if(!Jb.K(0).isSupported||!Jb.K(0).isEditable){jc=!1;break}for(Jb=Jb.K(0);Jb;)this.rkd(Tb,Jb.id),Jb=this.getById(Jb.parentId)}if(Tb)for(var Hc of Tb)if(!Hc.isSupported||
!Hc.isEditable){jc=!1;break}break;case 1:if(Jb.K(0).contextId!==kc.a.Vc){v.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");jc=!1;break}(Tb=this.ZO(Jb.K(0),Jb.K(0),1))&&0<Tb.count&&(jc=!1);break;case 2:if(Jb.K(0).contextId!==kc.a.Vc){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");jc=!1;break}(Tb=this.ZO(Jb.K(0),Jb.K(0),3))&&0<Tb.count&&
(jc=!1);break;case 3:case 4:Tb=this.E6d(Jb.K(0),!0);Hc=this.E6d(Jb.K(Jb.count-1),!1);if(!Tb||!Hc){v.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");jc=!1;break}if((Tb=this.ZO(Tb,Tb,3))&&0<Tb.count){jc=!1;break}if((Tb=this.ZO(Hc,Hc,3))&&0<Tb.count){jc=!1;break}if(Tb=this.Wm.ZO(Jb.K(0),Jb.K(Jb.count-1),1))for(const hd of Tb)if(!hd.Tla){jc=!1;break}break;default:jc=!1}return jc};rx.zz=b;rx.Pi=h;this.lh=r;this.sr=A;this.Wm=L;this.f5=
Z;this.Gia=oa;this.kg=Ba;this.Gp=gb}get IWa(){return!!this.kg.instance&&this.kg.instance.IWa}get $sa(){return!!this.kg.instance&&this.kg.instance.$sa}get Vce(){return!!this.kg.instance&&this.kg.instance.Vce}get v7(){return!!this.kg.instance&&this.kg.instance.v7}get Xce(){return!!this.kg.instance&&this.kg.instance.Xce}USb(){return!!this.kg.instance&&this.kg.instance.USb}sqa(b,h,r=null,A=null,L=!1,Z=0){if(!this.IWa)return{returnValue:2,id:0};b=this.lh.hsa(b,!0);h=this.lh.hsa(h,!1);if(!b||!h)return{returnValue:2,
id:0};b=xc.a.create(b);h=xc.a.create(h);return this.wMh(b,h,r,A,L,Z,!1)}dVk(b,h,r=0,A=!1){return this.IWa&&b&&h?this.wMh(b,h,null,null,!1,r,A):{returnValue:2,id:0}}t5a(b,h=null,r=0,A=!1){let L=0;if(!this.IWa)return{returnValue:2,id:L};const Z=this.f5.IMb(h,rx.zz,rx.Pi,this.lh,this.sr,this.Wm,this.Gia,this.IWa,this.Vce);Z.type=r;Z.start=b;Z.end=b;Z.rv=b.node.id;Z.IA=b.node.id;Z.zg=!1;return this.Wm.yNh(Z,h,A)?(L=Z.id,{returnValue:0,id:L}):{returnValue:2,id:L}}XVk(b,h=null){if(!this.IWa||!this.iln(b))return{returnValue:2,
id:0};var r=b.K(0).contextId===kc.a.Zc?b.K(1):b.K(0);const A=b.K(b.count-1);if(this.pqf(b,kc.a.paragraph)||this.pqf(b,kc.a.Zc)){b=r.node.id;let L=A.node.id;const Z=b.equals(L);r=this.Wm.TWj(r,!0);void 0!==r&&null!==r&&(b=r,L=Z?b:L);this.Wm.TWj(A,!1);h.setValue(Vc.a.eba,!0);return this.sqa(b,L,h)}return r!==A||r.contextId!==kc.a.Cd&&r.contextId!==kc.a.Vc?{returnValue:2,id:0}:(h.setValue(Vc.a.eba,!1),this.t5a(r,h))}getById(b){if(!this.$sa)return null;const h=this.lh.g3c(this.lh.sAa(),r=>r.getValue(Vc.a.Ow)===
b,!0);return 0<h.count?this.Wm.AR(h.K(0)):null}getByTitle(b){if(!this.$sa)return null;const h=this.lh.g3c(this.lh.sAa(),A=>A.ka(Vc.a.Knb,null)===b,!1),r=new nb.a;for(const A of h)r.add(this.Wm.AR(A));return r}getByTag(b){if(!this.$sa)return null;const h=this.lh.g3c(this.lh.sAa(),A=>A.ka(Vc.a.Onb,null)===b,!1),r=new nb.a;for(const A of h)r.add(this.Wm.AR(A));return r}ZO(b,h,r,A=!1){return this.$sa?this.v7?this.Wm.jsa(b,h,r):this.Wm.ZO(b,h,r,A):null}dX(b,h){return this.Wm.dX(b,h)}ghm(){if(!this.$sa)return null;
const b=this.lh.g3c(this.lh.sAa(),()=>!0,!1),h=new nb.a;for(const r of b)h.add(this.Wm.AR(r));return h}eZb(b){if(!this.IWa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Wm.lDa(b)?0:2}lQl(b){if(!this.IWa)return 2;b=this.getById(b);return this.Wm.deleteContentControl(b)?0:2}pWk(b){this.Wm.uAj(b)}cdl(b){this.qoa=b;this.qoa.zwo(this.fpn)}vnm(b){if(!this.USb())return null;let h;var r=b.DF();h=this.E6d(r.K(r.count-
1),!1);r=this.sr.mkc(r.K(r.count-1).node,h.cpBegin).Hb;b=this.aOm(r,b);if(-1===b)return null;h.Fb=b;h.Tb=h.Fb;return h}gpn(b,h){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.pjn(b);case 3:case 4:case 6:return this.mrn(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.K(0).contextId!==kc.a.Vc?(v.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),
!1):this.VYi(b.K(0),5===h,!1);default:return!1}}pjn(b){const h=this.Wm.jsa(b.K(0),b.K(b.count-1),3);if(h&&0<h.count){var r=h.K(0);if(!r.isSupported||!r.isEditable)return!1}b=this.Wm.jsa(b.K(0),b.K(b.count-1),1);for(r=0;h&&r<h.count;r++)this.rkd(b,h.K(r).id);if(b)for(const A of b)if(!A.isSupported||!A.isEditable)return!1;return!0}mrn(b,h){var r=b.K(0),A=b.K(b.count-1),L=r.zj,Z=A.Po;if(-1===L||-1===Z)return!1;L=this.Gp.Maa(r.node,L,r.Fb);Z=this.Gp.Maa(A.node,Z,A.Tb);var oa=-1,Ba=Math.min(L.count,Z.count);
for(--Ba;0<=Ba;Ba--){const gb=L.K(Ba).se,Ab=Z.K(Ba).se;if(gb.equals(Ab)){oa=Ba;break}}if(-1<oa&&(Ba=this.Wm.AR(L.K(oa).Xd),!Ba.isEditable||!Ba.isSupported||Ba.HL&&!this.Rin(Ba,b)))return!1;r=this.Wm.jsa(r,A,1);for(A=0;A<=oa;A++)this.rkd(r,this.Wm.AR(L.K(A).Xd).id);for(A=oa+1;A<L.count;A++){Ba=this.Wm.AR(L.K(A).Xd);if(!Ba.isEditable||!Ba.Tla||!Ba.isSupported||Ba.HL)return!1;this.rkd(r,Ba.id)}for(L=oa+1;L<Z.count;L++){oa=this.Wm.AR(Z.K(L).Xd);if(!oa.isEditable||!oa.Tla||!oa.isSupported||oa.HL)return!1;
this.rkd(r,oa.id)}if(r)for(const gb of r)if(!gb.isSupported||!gb.Tla)return!1;return h&&(b=this.E6d(b.K(0),!0))?this.VYi(b,!0,!0):!0}Rin(b,h){h=this.Gp.iFm(h.K(0),h.K(h.count-1));return!!b&&!!h&&b.objectId.equals(h.se)}VYi(b,h,r){return(b=this.Wm.jsa(b,b,3))&&0<b.count&&(b=b.K(0),!b.isSupported||!b.isEditable||!this.Xce&&h&&!b.zg||!r&&b.HL||h&&1===b.type)?!1:!0}E6d(b,h){if(!b)return null;let r=null;switch(b.contextId){case kc.a.paragraph:r=h?xc.a.Uc(b.node,0):xc.a.Cx(b.node);break;case kc.a.Zc:r=
xc.a.Cx(b.node);break;case kc.a.Cd:r=h?xc.a.Uc(b.node,b.cpBegin):xc.a.Uc(b.node,b.cpEnd);break;case kc.a.Vc:r=b}r&&(r.Tb=r.Fb=h?b.Fb:b.Tb);return r}rkd(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}aOm(b,h){if(!b)return-1;let r=-1;for(let A=0;A<b.length;A++)if(b.K(A).se.equals(h.objectId)&&!1===b.K(A).Wc){r=A;if(h.zg&&0<A&&b.K(A-1).zg&&!b.K(A-1).Wc)return-1;break}return r}iln(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.K(h).contextId;if(r!==kc.a.paragraph&&
r!==kc.a.Zc&&r!==kc.a.Cd&&r!==kc.a.Vc||0<h&&h<b.count-1&&r===kc.a.Cd&&(b.K(h).cpBegin||b.K(h).cpEnd!==b.K(h).node.characterData.length))return!1}return b.K(0).contextId===kc.a.Zc&&1===b.count||this.pqf(b,kc.a.Vc)&&1<b.count?!1:!0}pqf(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}wMh(b,h,r=null,A=null,L=!1,Z=0,oa=!1){let Ba=0;var gb=h.node;let Ab=xc.a.create(b.node);gb=xc.a.create(gb);if(!({HDg:Ab,vzf:gb}=this.rNe.F1h(Ab,gb)).success)return{returnValue:2,id:Ba};const Jb=this.f5.IMb(r,
rx.zz,rx.Pi,this.lh,this.sr,this.Wm,this.Gia,this.IWa,this.Vce);Jb.type=Z;Jb.start=b;Jb.end=h;Jb.rv=Ab.node.id;Jb.IA=gb.node.id;Jb.zg=!0;Jb.G_d=A;Jb.Dxf=L;return this.Wm.yNh(Jb,r,oa)?(Ba=Jb.id,{returnValue:0,id:Ba}):{returnValue:2,id:Ba}}}rx.zz=null;rx.Pi=null;Object(u.a)(rx,"ContentControlManager",null,[656]);var lD=d(632),ZJ=d(146),sx=d(189);class eF extends Sys.EventArgs{constructor(b){super();this.qci=b}}Object(u.a)(eF,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var LB=d(1396);class $k{constructor(){this.Ugj=
0;this.Crj=null}}Object(u.a)($k,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const Lh=b=>!(null===b||void 0===b?0:b.length),OH=b=>null==b?!1:[...b].some(h=>h.Wc),PH=b=>null==b?!1:[...b].some(h=>!h.Wc);class Kw{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe,ge,$d,lf,wf,gi){this.Lj=wf;this.CAh=[];this.D4e=[];this.zz=b;this.Pi=h;this.lh=r;this.sr=A;this.f5=L;this.Ee=Ba;this.hy=gb;this.ib=Z;this.EG=oa;this.Gia=jc;this.TJb=Hc;this.Gja=Ab;this.yK=Jb;this.ga=Tb;this.Gp=
hd;this.kg=Gd;this.ri=de;this.hb=qe;this.Rc=oe;this.aKh=ge;this.Fd=$d;this.th=lf;this.yK&&(this.yK.addHandler(lD.a.dZb,Object(D.a)(this,this.Wnj,"onShowingPlaceholder")),this.yK.addHandler(lD.a.Fte,Object(D.a)(this,this.Ymj,"onRemoveWhenEdited")),gi.execute(Di=>{this.BG=Di}))}get nv(){return this.zz.value}get Tj(){return this.Pi.value}get v7(){return!!this.kg.instance&&this.kg.instance.v7}get x7(){return!!this.Fd&&this.Fd.isFeatureEnabled(25)}dispose(){this.yK&&(this.yK.removeHandler(lD.a.dZb,Object(D.a)(this,
this.Wnj,"onShowingPlaceholder")),this.yK.removeHandler(lD.a.Fte,Object(D.a)(this,this.Ymj,"onRemoveWhenEdited")))}ZO(b,h,r,A=!1){if(this.v7)return this.jsa(b,h,r);if(!b||!h)return null;const L=this.lh.hsa(b.node.id,!0);var Z=this.lh.hsa(h.node.id,!1);if(!L||!Z)return null;b=b.contextId===kc.a.Zc?b:xc.a.Uc(L,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===kc.a.Zc?h:xc.a.Uc(Z,-1===h.cpEnd?Z.characterData.length:h.cpEnd);Z=null;switch(r){case 0:Z=this.Mrm(b,h);break;case 1:Z=this.sFm(b,h);break;case 3:Z=
this.CDi(b,h,A);break;case 2:Z=this.fPm(b,h);break;case 4:Z=this.qHf(b,h,!1)}return Z}jsa(b,h,r){if(!b||!h||b.contextId!==kc.a.Zc&&(b=this.w7h(b,!0),!b)||h.contextId!==kc.a.Zc&&(h=this.w7h(h,!1),!h))return null;let A=null;switch(r){case 0:A=this.Nrm(b,h);break;case 1:A=this.tFm(b,h);break;case 3:A=this.DDi(b,h);break;case 2:A=this.gPm(b,h);break;case 4:A=this.qHf(b,h,!0)}return A}w7h(b,h){var r=this.lh.hsa(b.node.id,h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:
b.cpEnd,b=b.Tb);r=xc.a.Uc(r,h);r.Fb=b;r.Tb=b;return r}Mrm(b,h){const r=new nb.a;if(b.contextId===kc.a.Zc||h.contextId===kc.a.Zc||b.equals(h))return r;const A=new ln.a,L=this.APb(b,b),Z=this.APb(h,h);for(let oa=0;oa<L.count;oa++)if(L.K(oa).Wc)for(let Ba=0;Ba<Z.count;Ba++)Z.K(Ba).Wc||L.K(oa).se.equals(Z.K(Ba).se)&&(!L.K(oa).zg||this.lh.eXa(L.K(oa).se,b.node.id,!0)&&this.lh.eXa(Z.K(Ba).se,h.node.id,!1))&&this.BQd(r,A,L.K(oa).se);return r}Nrm(b,h){const r=new nb.a;if(b.contextId===kc.a.Zc||h.contextId===
kc.a.Zc||b.equals(h)&&b.Fb===b.Tb||-1===b.Fb||-1===h.Tb)return r;var A=b.node.ra.Dh(b.cpBegin),L=h.node.ra.Dh(h.cpEnd);A&&A.Hb&&0<A.Hb.length&&b.Fb<=A.Hb.length&&L&&L.Hb&&0<L.Hb.length&&h.Tb<=L.Hb.length&&(b=b.Fb,h=h.Tb,b===A.Hb.length&&b--,0<h&&h--,A=A.Hb.K(b),L=L.Hb.K(h),A.Wc&&!L.Wc&&Q.a.hw(A.se,L.se)&&A.nq&&L.nq&&(L=A.Xd)&&r.add(this.AR(L)));return r}sFm(b,h){const r=new nb.a,A=new ln.a,L=this.APb(b,h);for(let Z=0;Z<L.count;Z++)this.BQd(r,A,L.K(Z).se);b=this.CDi(b,h,!1,!1);for(const Z of b)A.contains(Z.objectId)||
(r.add(Z),A.add(Z.objectId));return r}tFm(b,h){const r=new nb.a,A=new ln.a,L=this.xGf(b,h);for(let Z=0;Z<L.count;Z++)this.zdf(r,A,L.K(Z));b=this.DDi(b,h);for(const Z of b)A.contains(Z.objectId)||(r.add(Z),A.add(Z.objectId));return r}CDi(b,h,r,A=!0){const L=new nb.a;b.equals(h)&&(r=!1);const Z=new ln.a;let oa=!1;b=this.APb(null,b,!0,r);h=this.APb(h,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Ba=0;Ba<h.count&&!(b.K(r).se.equals(h.K(Ba).se)&&(b.K(r),this.BQd(L,Z,b.K(r).se)&&(oa=!this.lh.jv(b.K(r).se).ka(Vc.a.faa,
null),A||oa)));Ba++);if(0<L.count&&(A||oa))break}return L}DDi(b,h){const r=new nb.a,A=new ln.a,L=b.node;var Z=h.node;const oa=h.contextId===kc.a.Zc?Z.characterData.length:h.cpEnd;b=this.Gp.Maa(L,b.contextId===kc.a.Zc?L.characterData.length:b.cpBegin,b.Fb);h=this.Gp.Maa(Z,oa,h.Tb);Z=b.count>h.count?h.count:b.count;for(--Z;0<=Z;Z--)b.K(Z).se.equals(h.K(Z).se)&&this.zdf(r,A,b.K(Z));return r}fPm(b,h){const r=new nb.a;let A=new ln.a;const L=this.APb(b,h);let Z=0,oa=null;if(b.equals(h))return r;for(b=0;b<
L.count;b++)!L.K(b).Wc||L.K(b).zg&&!this.lh.eXa(L.K(b).se,L.K(b).Ib.paragraph.id,!0)?L.K(b).Wc||L.K(b).zg&&!this.lh.eXa(L.K(b).se,L.K(b).Ib.paragraph.id,!1)||(Z--,0>Z?(Z=0,A=new ln.a):!Z&&oa&&L.K(b).se.equals(oa)&&this.BQd(r,A,oa)):(Z||(oa=L.K(b).se),Z++);return r}gPm(b,h){const r=new nb.a;if(b.equals(h)&&b.Fb===h.Tb)return r;let A=new ln.a;b=this.xGf(b,h);h=0;let L=null;for(let Z=0;Z<b.count;Z++){const oa=b.K(Z);!oa.Wc||oa.zg&&!this.lh.eXa(oa.se,oa.Ib.paragraph.id,!0)?oa.Wc||oa.zg&&!this.lh.eXa(oa.se,
oa.Ib.paragraph.id,!1)||(h--,0>h?(h=0,A=new ln.a):!h&&L&&oa.se.equals(L.se)&&this.zdf(r,A,L)):(h||(L=oa),h++)}return r}qHf(b,h,r){const A=new nb.a;b=r?this.xGf(b,h):this.APb(b,h);h=0;for(r=0;r<b.count;r++){var L=b.K(r);L.nq&&(L.Wc?h++:(h--,0>h?h=0:(L=this.AR(L.Xd))&&A.add(L)))}return A}APb(b,h,r=!0,A=!0){const L=new nb.a,Z=this.dX(b,h);if(!Z.count)return L;let oa,Ba,gb,Ab;for(let Jb=0;Jb<Z.count;Jb++){oa=0;Ba=Z.K(Jb).characterData.length;gb=Ab=!0;if(b&&Z.K(Jb).id.equals(b.node.id)){if(b.contextId===
kc.a.Zc)continue;0<=b.cpBegin&&(oa=b.cpBegin)}h&&Z.K(Jb).id.equals(h.node.id)&&0<=h.cpEnd&&(Ba=h.cpEnd);Jb||(gb=r);Jb!==Z.count-1||h&&h.contextId===kc.a.Zc||(Ab=A);L.addRange(this.yGf(Z.K(Jb),oa,Ba,gb,Ab))}return L}xGf(b,h){const r=new nb.a,A=this.dX(b,h);let L,Z,oa;for(let gb=0;gb<A.count;gb++){const Ab=A.K(gb);if(Ab.ra.length){var Ba=Ab.ra.Ub(Ab.ra.length-1);L=0;Z=Ab.characterData.length;oa=0;Ba=Ba&&Ba.Hb?Ba.Hb.length:0;b&&Ab.id.equals(b.node.id)&&(L=b.zj,oa=b.Fb);h&&Ab.id.equals(h.node.id)&&(Z=
h.Po,Ba=h.Tb);r.addRange(this.zGf(Ab,L,Z,oa,Ba))}}return r}yGf(b,h,r,A=!0,L=!0,Z=!0){const oa=new nb.a;b=b.ra;for(let Ba=0;Ba<b.length;Ba++){if(b.Ub(Ba).cp<h)continue;if(b.Ub(Ba).cp>r)break;const gb=b.Ub(Ba);if(gb.Hb&&0<gb.Hb.length&&(gb.cp!==h||A)&&(gb.cp!==r||L))for(let Ab=0;Ab<gb.Hb.length;Ab++){const Jb=gb.Hb.K(Ab);(Z||Jb.Wc)&&oa.add(Jb)}}return oa}zGf(b,h,r,A,L){const Z=new nb.a;b=b.ra;for(let oa=0;oa<b.length;oa++){if(b.Ub(oa).cp<h)continue;if(b.Ub(oa).cp>r)break;const Ba=b.Ub(oa);if(Ba.Hb&&
0<Ba.Hb.length){let gb=0,Ab=Ba.Hb.length;Ba.cp===h&&-1!==A&&(gb=A);for(Ba.cp===r&&-1!==L&&(Ab=L);gb<Ab&&gb<Ba.Hb.length;gb++)Z.add(Ba.Hb.K(gb))}}return Z}BQd(b,h,r){let A=null;if(h.contains(r)||!(A=this.Tj.Eb(r)))return!1;b.add(this.AR(A));h.add(r);return!0}zdf(b,h,r){let A=null;!h.contains(r.se)&&(A=r.Xd)&&(b.add(this.AR(A)),h.add(r.se))}w3j(b,h){let r,A=!1;r=({dcb:h,ccb:b,Sod:A}=this.x3j(b,h,!1,A)).returnValue||A;A&&(r=r||({dcb:h,ccb:b,Sod:A}=this.x3j(h,b,!0,A)).returnValue);return{returnValue:r,
dcb:h,ccb:b}}x3j(b,h,r,A){let L,Z;if(r)return L=Z=null,{returnValue:!1,dcb:Z,ccb:L,Sod:!1};let oa=!1;Z=b;L=h;const Ba=b.cpBegin,gb=h.cpEnd;A=!1;var Ab=r?this.Dsi(h):this.vhm(b);let Jb=!1,Tb=!1,jc=0,Hc=0;for(const hd of Ab)for(Ab=0;Ab<hd.ra.length;Ab++){const Gd=hd.ra.Ub(Ab);!Tb&&hd.id.equals(h.node.id)&&(Tb=!0);if(!Jb&&(hd.id.equals(h.node.id)&&-1!==gb&&Gd.cp>gb||Tb&&!hd.id.equals(h.node.id)))if(Jb=!0,jc!==Hc)oa=!0;else return{returnValue:!1,dcb:Z,ccb:L,Sod:A};if((!hd.id.equals(b.node.id)||Gd.cp>=
Ba||-1===Ba)&&Gd.Hb)for(let de=0;de<Gd.Hb.length;de++){const qe=Gd.Hb.K(de),oe=this.Tj.Eb(qe.se);if(!oe.getValue(Vc.a.eba)||(!qe.Wc||this.lh.eXa(this.th.dr(oe.id,!0),hd.id,!0))&&(qe.Wc||this.lh.eXa(this.th.dr(oe.id,!1),hd.id,!1))){qe.Wc?jc++:jc--;if(oa&&jc===Hc)return{dcb:Z,ccb:L}=this.NEl(b.node,hd,b.cpBegin,Gd.cp),{returnValue:!0,dcb:Z,ccb:L,Sod:A};!r&&jc<Hc&&(A=!0,Hc--)}}}return{returnValue:oa,dcb:Z,ccb:L,Sod:A}}NEl(b,h,r,A){let L;h.id.equals(b.id)?b=0<r||A<Cd.ParagraphReader.textLength(h)?L=xc.a.createTextRange(h,
r,A):L=xc.a.create(h):(L=0<r?xc.a.createTextRange(b,r,Cd.ParagraphReader.textLength(b)):xc.a.create(b),b=A<Cd.ParagraphReader.textLength(h)?xc.a.createTextRange(h,0,A):xc.a.create(h));return{dcb:L,ccb:b}}gBm(b){const h=b.cpBegin,r=this.Dsi(b);for(let L=r.count-1;0<=L;L--){const Z=r.K(L);for(let oa=Z.ra.length-1;0<=oa;oa--){const Ba=Z.ra.Ub(oa);if((!Z.id.equals(b.node.id)||Ba.cp<=h||-1===h&&!Ba.cp)&&Ba.Hb){var A=Ba.Hb.length-1;for((Ba.cp===h||-1===h&&!Ba.cp)&&this.v7&&Z.id.equals(b.node.id)&&(A=b.Fb-
1);0<=A;A--){const gb=Ba.Hb.K(A),Ab=this.Tj.Eb(gb.se);if(gb.Wc){if(Ab.getValue(Vc.a.eba)&&!this.lh.eXa(this.th.dr(Ab.id,!0),Z.id,!0))continue;return null}if(!Ab.getValue(Vc.a.eba)||this.lh.eXa(this.th.dr(Ab.id,!1),Z.id,!1))return this.AR(Ab)}}}}return null}AR(b){if(!b)return null;this.lh.rOb();return this.f5.IMb(b,this.zz,this.Pi,this.lh,this.sr,this,this.Gia,this.Gja,this.TJb)}dX(b,h){b=this.Csi(b,h,Kw.iQb(12));if(!b)return null;h=new nb.a;for(const r of b)h.add(r);return h}thm(b,h){const r=Kw.qxm();
return this.Csi(xc.a.create(b.node),xc.a.create(h.node),r)}Csi(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var A=b.node;if(A&&r(A)){var L;return L=new nb.a,L.add(A),L}}A=Object.assign(new $k,{Ugj:35,Crj:r});b=b?b.node:null;h=h?h.node:null;L=this.HJm(b,h);if(!L)return null;h=this.O3k(h,r,Kw.oYh,A);return this.phm(b,h,L,r,Kw.oYh,A)}HJm(b,h){return(b=b?this.rAi(b):this.rAi(h))?b.kd(35):this.lh.aEm()}O3k(b,h,r,A){if(!b)return null;h(b)||(h=this.qhm(b,h,r,A),h.count&&
(b=h.K(h.count-1)));return b}phm(b,h,r,A,L,Z){b?(b=hb.a.eb(b),b.zb(7),r=Dd.a.At(b,r)):r=Dd.a.Bo(r);L&&r.zp(L,Z);for(L=new nb.a;r.moveNext()&&(A(r.currentNode)&&L.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return L}qhm(b,h,r,A){b=Dd.a.Bo(b);r&&b.zp(r,A);for(r=new nb.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);return r}rAi(b){b=hb.a.eb(b);return b.zb(35)?b:null}iNi(b,h){b=this.dX(b,h);for(const r of b)if((b=this.lh.RJf(r))&&b.zla(4))return!0;return!1}yNh(b,h=null,r=!1){if(!b)return!1;
var A=b.start,L=b.end;if(!he.a.Xw(A)&&A.contextId!==kc.a.paragraph||!he.a.Xw(L)&&L.contextId!==kc.a.paragraph||!this.v7&&({dcb:A,ccb:L}=this.w3j(b.start,b.end)).returnValue||this.v7&&!({start:A,end:L}=this.Cll(A,L)).returnValue)return!1;b.start=A;b.end=L;const Z=this.Bjn(A,L);if(this.v7){var oa=this.jsa(b.start,b.end,3);var Ba=this.jsa(b.start,b.end,2)}else oa=this.ZO(b.start,b.end,3),Ba=this.ZO(b.start,b.end,2);const gb=oa&&0<oa.count?oa.K(0):null,Ab=Ba&&0<Ba.count?Ba.K(0):null;if(r)return this.M8c(b,
0,oa)?!0:!1;if(this.M8c(b,0,oa)){r=(r=Object(Ca.a)(dF,this.gBm(b.start)))?this.lh.jv(r.objectId):null;Ba=this.lh.YVk(b,gb,r,Ba,b.rv,b.IA,h);this.Lj.$qc(Ba);if(b.zg)for(L=this.dX(b.start,b.end),r=0;r<L.count;r++)if(this.v7){oa=gb?gb.objectId:null;const Jb=this.Vzi(oa,L.K(r),!0);this.sr.qya(L.K(r),Ba.id,0,!0,!0,void 0,void 0,void 0,void 0,Jb);oa=this.Vzi(oa,L.K(r),!1);this.sr.qya(L.K(r),Ba.id,L.K(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,oa)}else this.sr.qya(L.K(r),Ba.id,0,!0,!0),this.sr.qya(L.K(r),
Ba.id,L.K(r).characterData.length,!0,!1);else this.v7?(r=-1===A.Fb?0:A.Fb,this.sr.qya(b.start.node,Ba.id,A.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.sr.qya(b.end.node,Ba.id,L.cpEnd,!1,!1,void 0,void 0,void 0,void 0,Z?r+1:L.Tb)):(this.sr.qya(b.start.node,Ba.id,b.start.cpBegin,!1,!0),this.sr.qya(b.start.node,Ba.id,b.start.cpEnd,!1,!1));h||this.lh.RTo(Ba,b.zg,b.id,this.lh.$kc(this.lh.jv(b.rv)),b.type);1===b.type&&this.sr.qtp(b.start.node,A.zj,A.Po);h=!(Fq.a.vec&&8===b.type);b.objectId=Ba.id;
A=this.lh.sAa().currentNode;h&&!A.hasProperty(Vc.a.BWc)&&A.setValue(Vc.a.BWc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);h&&Fq.a.aga&&this.lh.m7j(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Ba);gb&&this.u8j(gb.Xd,b);Ab&&this.u8j(Ba,Ab);h&&Z&&this.ga.Qb(vb.a.jpd,2,b.id);Fq.a.vec&&8===b.type&&this.QMj(!1,b,Ba);LB.a.I6h()&&this.BG&&this.BG.fireEvent(3,{node:Ba});return!0}return!1}deleteContentControl(b){if(!this.M8c(b,3))return v.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),
!1;if(this.Lj.lsd(b.Xd))return!0;b.HL&&(b.HL=!1);const h=this.ib.gb.currentSelection;b=b.DF();const r=new Oq.Selection(b.toArray(),!0);let A=!1;this.ib.UZb(()=>{this.ib.Kc(r);if(32===this.ga.Ob(vb.a.gI,2)){if(this.aKh.instance){const L=this.aKh.instance.LBi(h,r,this.ib.gb.currentSelection);this.ib.gvp(new ZJ.SelectionCollection([L],0))}A=!0}});return A}lDa(b,h=!1,r=!1){if(this.M8c(b,2)){if(b.HL)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),
this.deleteContentControl(b);const A=b.Xd;let L=new nb.a;h&&(L=b.LFf());L.add(b);if(r||!this.Lj.lsd(b.Xd)){A&&A.anchor&&this.lh.Udi(A,h);for(const Z of L)b=this.dX(Z.start,Z.end),this.sr.wQl(b,Z.objectId);this.Ixj(L)}v.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}pzg(b,h){if(this.M8c(b,1)){let Ba=!1;h||(Ba=!0,{I4o:r,returnValue:h}=this.IQb(b),r&&this.lh.sAa().currentNode.setValue(Vc.a.BWc,
h));var r=b.Jui().toArray();for(var A=0;A<r.length;A++)this.lDa(r[A],!0);r=this.Bcp(h);if(b.zg){A=this.dX(b.start,b.end);if(!A.count)return!1;if(1===A.count&&y.AFrameworkApplication.dv)this.sr.We(xc.a.createTextRange(A.K(0),0,A.K(0).characterData.length),h);else{var L=this.lh.lFm(A.K(0));h=A.K(0).djc();A=this.lh.lei(A);A=this.lh.LNh(L,A,r.length);for(L=0;L<A.count;L++){this.sr.We(xc.a.createTextRange(A.K(L),0,0),r[L],void 0,b.type);for(var Z=0;Z<h.count;Z++)this.sr.qya(A.K(L),h.K(Z),0,!0,!0),this.sr.qya(A.K(L),
h.K(h.count-Z-1),A.K(L).characterData.length,!0,!1)}b.ZAp(A.K(0).id,A.K(A.count-1).id);r=this.EG.ue(A.K(0),0);this.ib.Kc(r)}}else{L=0;1<r.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;A=h.node;for(var oa=0;oa<A.ra.length&&h.contextId===kc.a.Cd;oa++)if(Z=A.ra.Ub(oa),Z.cp===h.cpBegin&&Z.blob){L++;for(oa+=1;oa<A.ra.length;oa++)if(Z=A.ra.Ub(oa),Z.cp>h.cpBegin&&Z.cp<=h.cpEnd)if(Z.blob)L++;else break;else if(Z.cp>
h.cpEnd)break;break}if(0<L&&L+h.cpBegin<h.cpEnd)A=xc.a.createTextRange(h.node,h.cpBegin,h.cpBegin+L),h=xc.a.createTextRange(h.node,h.cpBegin+L,h.cpEnd),this.sr.We(h,r[0]),this.sr.We(A,"");else if(0<L&&L+h.cpBegin===h.cpEnd)for(this.sr.We(b.start,r[0]),r=0;r<A.ra.length;r++){if(L=A.ra.Ub(r),L.cp===h.cpBegin){L.blob=null;break}}else y.AFrameworkApplication.dv?(r=r.join(" "),this.sr.We(b.start,r)):this.sr.We(b.start,r[0],void 0,b.type)}this.JKb(b,Ba);let gb;this.pno((gb=new nb.a,gb.add(b),gb));return!0}return!1}JKb(b,
h){const r=this.sr.mkc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const L=this.lh.jv(b.objectId);if(h){h=this.hy.IF(b.start.node);var A=h.nh(ts.a.Djg);A||(Ki.a.Kg.vn?(A=h.gv().GAa(ts.a.htj),A=h.nh(this.hy.Be(A))):A=h.qKa(ts.a.htj));A&&(this.Ee.Wqa(r.formatting),this.Ee.beb(r.formatting,A));L&&(b.HL=!0)}else L&&b.HL&&(this.uIo(b,r),b.HL=!1)}else v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}uIo(b,h){b=this.lh.jv(b.objectId);let r=null;b&&
(r=b.ka(Vc.a.vMb,Q.a.nil));this.Ee.Wqa(h.formatting);r&&!r.equals(Q.a.nil)&&(b=this.Pi.value.Eb(r),h.formatting=b)}IQb(b){let h=!1;b=b.placeholderText;this.ltn(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,I4o:h}}oyo(b,h=!0){this.Gja&&(h&&this.jyo(b),this.vyo(b))}pyo(b){if(this.Gja&&(b=this.ZO(b,b,4)))for(const h of b)this.lDa(h,!1)}UXn(b,h){if(h&&!b.Wc&&(this.lh.rOb(),(b=b.Ib.paragraph.Hc.Eb(b.se))&&b.anchor)){this.lh.Udi(b);b=this.f5.IMb(b,this.zz,
this.Pi,this.lh,this.sr,this,this.Gia,this.Gja,this.TJb);let r;this.Ixj((r=new nb.a,r.add(b),r))}}Ymj(b,h){this.lh.rOb();b=this.lh.jv(h.se);const r=this.AR(b);if(r&&r.isValid()&&r.removeWhenEdited){const A=this.Rc.Lc(7);A.Ab(b);this.lDa(r,!1);h.state=2;A.dispose()}}Wnj(b,h){this.lh.rOb();b=this.lh.jv(h.se);this.uhn(b)&&(b=b.ka(Vc.a.Ow,0),this.ga&&(this.ga.Qb(vb.a.jpd,2,b),Kw.Qd.zgf()))}uhn(b){return b&&b.isConnected&&!b.ka(Vc.a.gaa,!1)?this.QWf(b)&&!b.jx:!1}QWf(b){b=this.f5.IMb(b,this.zz,this.Pi,
this.lh,this.sr,this,this.Gia,this.Gja,this.TJb);if(!b.isValid())return!1;if(b.zg){if(b.rv.toString()===b.IA.toString()){var h=this.lh.jv(b.rv);if(!h)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.ra.length)return this.XVi(h.ra.Ub(0),b.objectId)}}else{h=b.start;if(!h)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=
this.lh.jv(b.rv).ra.Dh(h.cpBegin),this.XVi(h,b.objectId)}return!1}XVi(b,h){b=b?b.Hb:null;if(!b)return!1;const r=b.sL(h,!0);return-1<r&&r+1<b.length&&b.K(r+1).se.toString()===h.toString()}uAj(b){this.D4e.push(b)}TWj(b,h){if(void 0===b||null===b||b.contextId!==kc.a.Cd)return null;b=xc.a.Uc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<Cd.ParagraphReader.textLength(b.node)?this.lh.H_a(b):null}select(b,h){if(b&&!b.equals(Q.a.nil)){var r=this.lh.jv(b);if(r&&55===r.type){r=this.AR(r);if(r.zg)r=
this.pjm(r);else{r=r.start;if(!r)return;r.contextId=kc.a.Cd;r=this.EG.Uo(r)}if(r&&r.length)return this.cNj(r.Qa,b,h,!0,!0),this.cNj(r.Xc,b,h,!1,!1),this.ib.Kc(r),r}}}lOo(b,h){if(!he.a.mf(b)||b.Fb!==b.Tb)return!1;const r=b.Fb;return-1===r?!1:(b=this.Gp.I8a(b.node,b.cpBegin,r,!h))&&h===b.Wc?(h=this.AR(b.Xd),this.select(b.se,!h.isEditable),!0):!1}pjm(b){var h,r=this.lh.eVa(b.rv,!0),A=this.lh.eVa(b.IA,!1);if(!r||!A)return null;r=this.thm(xc.a.create(r),xc.a.create(A));if(!r||!r.count)return null;A=new nb.a;
y.AFrameworkApplication.$c("DeleteTocUsingBackspace;DeleteTocUsingBackspaceCf");const L=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsDeleteTocUsingBackspaceEnabled",!1);for(h=0;h<r.count;h++){let Z;if(12===r.K(h).type)Z=h!==r.count-1||L&&b.$2i?xc.a.create(r.K(h)):xc.a.createTextRange(r.K(h),0,Cd.ParagraphReader.textLength(r.K(h))),this.ri&&(Z.Fb=this.ri.Kr(Z.node,!0),Z.Tb=this.ri.Kr(Z.node,!1));else if(15===r.K(h).type)Z=sx.TableNodeContext.create(r.K(h));
else continue;A.add(Z)}return new Oq.Selection(A.toArray(),!0)}nTo(b){if(b&&!b.equals(Q.a.nil)&&(this.lh.rOb(),(b=this.lh.jv(b))&&55===b.type&&b.isConnected)){var h=b.ka(Vc.a.gaa,!1);b.setValue(Vc.a.gaa,!1);h&&this.bto(b)}}d1j(b){if(b&&!b.equals(Q.a.nil)&&(this.lh.rOb(),(b=this.lh.jv(b))&&55===b.type&&b.isConnected)){var h=this.AR(b);h.isEditable&&8===h.type&&this.QMj(!h.isChecked,h,b)}}QMj(b,h,r){const {fOa:A,font:L}=this.tlm(b,r),Z=this.Rc.Lc(15);Z.Ab(r);h.isChecked=b;this.pzg(h,A);b=this.sr.mkc(h.start.node,
Math.max(h.start.cpBegin,0));this.Ee.lha(b.formatting,L);Z.dispose()}tlm(b,h){b?(b=h.ka(De.a.G6h,ts.a.kOl),h=h.ka(De.a.F6h,ts.a.jOl)):(b=h.ka(De.a.O6h,ts.a.mOl),h=h.ka(De.a.N6h,ts.a.lOl));b=String.fromCodePoint(Number("0x"+b));return{fOa:b,font:h}}bto(b){var h=this.th.dr(b.id,!0);h.equals(Q.a.nil)||(h=this.lh.hsa(h,!0))&&(b=this.sr.nHf(h,b.id,!0))&&0<b.count&&(b=b.K(0),h=b.Ib,h.formatting=b.jU?b.jU.Of(h):new Kg.a(h,Q.a.nil))}pBj(b){if(b=this.Hvi(b))for(const h of b)this.Lj.jAg()&&(h.HL=!1),this.lDa(h,
!1)}Dvi(b){const h=new nb.a;if(b=this.Hvi(b))for(const r of b)h.add(r.Xd);return h}qyo(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.hb.Zm(b),r=this.hb.GF(b);if(this.ri&&h&&r){b=this.ri.Kr(h,!0);const A=this.ri.Kr(r,!1);h=xc.a.create(h);r=xc.a.create(r);h.Fb=b;r.Tb=A;if(b=this.jsa(h,r,4))for(const L of b)this.lDa(L,!1)}}}whm(b){var h=this.th.dr(b.id,!0,b.nP);b=this.th.dr(b.id,!1,b.nP);if(h.equals(Q.a.nil)||b.equals(Q.a.nil))return new nb.a;h=this.lh.hsa(h,!0);b=this.lh.hsa(b,
!1);return h&&b?this.dX(xc.a.create(h),xc.a.create(b))||new nb.a:new nb.a}eVa(b,h){return this.lh.eVa(b,h)}xJf(b,h){if(b&&55===b.type&&(b=this.AR(b),b=h?b.start:b.end)){const r=xc.a.Uc(b.node,h?b.zj:b.Po);r.Fb=r.Tb=(h?b.Fb:b.Tb)+(h?-1:1);return r}return null}snm(b){return(b=this.AR(b))?b.start:null}cNj(b,h,r,A,L){if((b.contextId===kc.a.Cd||b.contextId===kc.a.Vc||b.contextId===kc.a.paragraph)&&(L=b.node.ra.Dh(L?b.zj:b.Po))&&L.Hb)for(let Z=0;Z<L.Hb.length;Z++){const oa=L.Hb.K(Z);if(oa.se.equals(h)&&
oa.nq)if(A&&oa.Wc){b.Fb=r?Z:Z+1;break}else if(!A&&!oa.Wc){b.Tb=r?Z+1:Z;break}}}pno(b){for(let h=0;h<this.CAh.length;++h)(0,this.CAh[h])(this,new eF(b))}Ixj(b){for(let h=0;h<this.D4e.length;++h)(0,this.D4e[h])(this,new eF(b))}vyo(b){b=xc.a.create(b);if(b=this.ZO(b,b,4))for(const h of b)h.zg||this.lDa(h,!1)}jyo(b){if(b=b.djc())for(let r=0;r<b.count;r++){var h=this.lh.jv(b.K(0));h=this.f5.IMb(h,this.zz,this.Pi,this.lh,this.sr,this,this.Gia,this.Gja,this.TJb);this.lDa(h)}}vhm(b){return this.dX(b,null)}M8c(b,
h,r=null){let A=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;v.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.Tla));if(this.hpn(h)&&this.ipn(h)&&!this.vhn(b))return!1;if(!r){const oa=this.hFm(b);oa&&(r=new nb.a,r.add(oa))}var L=this.lh.XCi(b.start.node);const Z=this.lh.XCi(b.end.node);if(L&&Z&&!L.equals(Z)||!L&&Z||L&&!Z)return!1;L=!0;if(r&&0<r.count){if(!r.K(0).isSupported)return!1;
L=r.K(0).isEditable}switch(h){case 0:A=this.Len(b,L);break;case 1:A=(this.x7||!this.DYf(b))&&b.isSupported&&b.isEditable&&this.ITh(b)&&this.$Vi(b);y.AFrameworkApplication.dv||(A=A&&!this.iNi(b.start,b.end));break;case 2:const oa=b.$2i?!0:b.isSupported;A=(this.x7||!this.DYf(b))&&oa&&b.Tla&&L;v.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:A=b.isSupported&&b.Tla&&L&&this.ITh(b)&&this.$Vi(b)&&!this.iNi(b.start,b.end)}}catch(Z){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+
h+", Exception: "+Z),A=!1}return A}ipn(b){return!(y.AFrameworkApplication.dv&&1===b)}hpn(b){return!(this.v7&&(!b||2===b||3===b))}Len(b,h){return!this.x7&&this.DYf(b)||!this.Men(b)||!this.kln(b)||!h||this.Emn(b)?!1:this.Ufn(b)?!0:(Fq.a.fVf&&v.ULS.sendTraceTag(508074052,368,15,"Unexpected isBlockContentControlNotContainingEntireTableRowsOrCells = false"),!1)}kln(b){var h;const r=b.start,A=r.contextId,L=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.zg?A!==kc.a.paragraph&&A!==kc.a.Zc||L!==
kc.a.paragraph&&L!==kc.a.Zc?!1:!0:he.a.Xw(r)||A===kc.a.Zc?!0:!1}Hvi(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.ri&&(this.hb.en(h)&&12===h.node.type&&(h.Fb=this.ri.Kr(h.node,!0)),this.hb.en(b)&&12===b.node.type&&(b.Tb=this.ri.Kr(b.node,!1)));return this.jsa(h,b,4)}ITh(b){b=b.LFf();for(const h of b)if(!h.isSupported||!h.Tla)return!1;return!0}vhn(b){if(this.w3j(b.start,b.end).returnValue)return!1;const h=this.ZO(b.start,b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&
(r.zg&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===Cd.ParagraphReader.textLength(r.end.node)))||!r.zg&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===Cd.ParagraphReader.textLength(b.end.node)))))return!1;return!0}$Vi(b){if(b.zg){var h=
this.lh.jv(b.rv),r=this.lh.jv(b.IA);let A=null;if(12===h.type&&12===r.type){h=this.lh.$kc(h);h=this.lh.jv(h);r=this.lh.$kc(r);r=this.lh.jv(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(A=h)}b=this.dX(b.start,b.end);if(!b.count)return!1;for(const L of b)if(b=this.lh.$kc(L),b=this.lh.jv(b),!b||!(16!==b.type||A&&b.id.equals(A.id)))return!1}return!0}DYf(b){return b.zg?!1:(b=b.start.node)?b.ka(Vc.a.OWa,!0)||b.ka(Ge.a.ena,!1)?!1:!0:!0}Men(b){return 1!==b.type?!0:b.rv.equals(b.IA)&&
Cd.ParagraphReader.Wb(b.start.node)&&!this.QZm(b)?!0:!1}QZm(b){const h=b.start;var r=h.node;const A=r.ra;if(b.zg){if(r.Nv||r.o7||r.hasBookmark)return!0;for(var L of A)if(this.nNi(L))return!0;return!1}b=h.zj;r=h.Po;let Z=L=null;for(const oa of A.k1f(b,r))if(!(oa.cp<b))if(oa.cp===b)L=oa;else if(oa.cp===r)Z=oa;else if(this.nNi(oa))return!0;return this.RZm(h,L,Z)?!0:!1}nNi(b){return Lh(b.Hb)&&Lh(b.Ue)&&Lh(b.Ch)&&Lh(b.lc)&&null==b.hyperlink&&!b.wn&&null==b.blob?!1:!0}RZm(b,h,r){var A,L,Z,oa,Ba,gb;if(null==
h&&null==r)return!1;const Ab=b.Fb;b=b.Tb;return null!=h&&(h.Hb&&Ab<h.Hb.length||null!=h.blob)||null!=r&&r.Hb&&0<b||null!=h&&null!=r&&(OH(null===(A=h.Ue)||void 0===A?void 0:A.getItems())&&PH(null===(L=r.Ue)||void 0===L?void 0:L.getItems())||OH(null===(Z=h.Ch)||void 0===Z?void 0:Z.getItems())&&PH(null===(oa=r.Ch)||void 0===oa?void 0:oa.getItems())||!Lh(h.lc)&&!Lh(r.lc)&&[...(null===(Ba=h.lc)||void 0===Ba?void 0:Ba.getItems())].some(Jb=>0===Jb.pe)&&[...(null===(gb=r.lc)||void 0===gb?void 0:gb.getItems())].some(Jb=>
3===Jb.pe)||null!=h.hyperlink&&r.wn)?!0:!1}Emn(b){var h,r;return(null!==(r=null===(h=this.ZO(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==r?r:[]).some(A=>1===A.type)?!0:!1}Ufn(b){if(!b.zg)return!0;var h=this.lh.jv(b.rv);b=this.lh.jv(b.IA);if($g.TableCellReader.SBa(h)||$g.TableCellReader.SBa(b)||Vm.a.I7(h)||Vm.a.I7(b))return!1;h=this.lh.$kc(h);h=this.lh.jv(h);b=this.lh.$kc(b);b=this.lh.jv(b);if(!h||!b)return!1;if(Fq.a.fVf){if(16===h.type&&16===b.type&&!h.id.equals(b.id))return!1}else if((16===
h.type||16===b.type)&&!h.id.equals(b.id))return!1;return!0}hFm(b){if(!b)return null;b=this.lh.jv(b.objectId);if(!b)return null;b=b.ka(Vc.a.faa,Q.a.nil);return b.equals(Q.a.nil)?null:(b=this.lh.jv(b))?this.AR(b):null}Dsi(b){return this.dX(null,b)}Bcp(b){return(b||"").split(RegExp("\r\n|\r|\n"))}ltn(b){return b&&""!==b?!1:!0}Vzi(b,h,r){h=h.ra.Dh(r?0:h.characterData.length);if(!h)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Hb||!h.Hb.length)return 0;
if(!b)return r?0:h.Hb.length;for(let A=0;A<h.Hb.length;A++){const L=h.Hb.K(A);if(Q.a.hw(L.se,b)&&L.Wc===r)return r?A+1:A}return r?0:h.Hb.length}Cll(b,h){var r=b.node,A=h.node,L=b.contextId===kc.a.paragraph?0:b.cpBegin,Z=h.contextId===kc.a.paragraph?Cd.ParagraphReader.textLength(A):h.cpEnd;r=this.Gp.Maa(r,L,b.Fb);A=this.Gp.Maa(A,Z,h.Tb);Z=!r||!r.count;L=!A||!A.count;if(Z&&L)return{returnValue:!0,start:b,end:h};if(Z)return{returnValue:this.DDe(b,A.K(A.count-1).se,!0),start:b,end:h};if(L)return{returnValue:this.DDe(h,
r.K(r.count-1).se,!1),start:b,end:h};if(r.count===A.count)return r=r.K(r.count-1),A=A.K(A.count-1),{returnValue:r.se.equals(A.se),start:b,end:h};r=(Z=r.count<A.count)?A.K(A.count-1):r.K(r.count-1);return{returnValue:Z?this.DDe(b,r.se,!0):this.DDe(h,r.se,!1),start:b,end:h}}DDe(b,h,r){var A=b.node;let L;if(r){L=b.contextId===kc.a.paragraph?0:b.cpBegin;var Z=b.Fb}else L=b.contextId===kc.a.paragraph?Cd.ParagraphReader.textLength(A):b.cpEnd,Z=b.Tb;A=A.ra.Dh(L);if(-1===Z||!A||!A.Hb||!A.Hb.length)return!1;
A=A.Hb;if(r)for(r=Z;r<A.length;r++){Z=A.K(r);if(!Z.Wc)break;if(Z.se.equals(h))return b.Fb=r+1,!0}else for(r=Z-1;0<=r;r--){Z=A.K(r);if(Z.Wc)break;if(Z.se.equals(h))return b.Tb=r,!0}return!1}Bjn(b,h){return this.A$k(b,h)&&b.Fb===b.Tb&&(b.contextId===kc.a.Vc||b.contextId===kc.a.paragraph&&!b.node.characterData.length)}A$k(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Tb===h.Tb}u8j(b,h){if(b&&h.zg){var r=this.th.dr(b.id,!0),A=this.lh.hsa(h.rv,!0);r.equals(A?A.id:null)&&this.th.fJ(b.id,h.objectId,!0);r=this.th.dr(b.id,
!1);A=this.lh.hsa(h.IA,!1);r.equals(A?A.id:null)&&this.th.fJ(b.id,h.objectId,!1)}}static get Qd(){return null!=Kw.Q5g?Kw.Q5g:Kw.Q5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static iQb(b){return h=>h.type===b}static qxm(){return b=>12===b.type||15===b.type}static oYh(b,h){return b.uf===h.Ugj||b.parentNode&&h.Crj(b.parentNode)?!1:!0}}Object(u.a)(Kw,"ContentControlOperator",null,[654,10,655]);class $J{constructor(b,h,r){this.fd=b;this.zz=h;this.VGb=r}EJi(b){const h=
this.jQb();return h&&b&&this.gRb(h,b)?this.zRm(h):null}gRb(b,h,r=!1){if(!b||!h)return!1;do{var A=b.currentNode;if(!A)break;A=A.ka(Vc.a.ilc,null);if(A===h||r&&A&&A.includes(h))return!0}while(b.Kf(29));return!1}zRm(b){var h=b.Vb(1);b.uc();b=b.xL(1);if(!h||!b)return null;h=qc.SelectionFactory.Aai(h,b);b=he.a.vk(h,!1,!1);return Fq.a.aga&&!b?null:qc.SelectionFactory.Vy(h,b.Xc)}jQb(){const b=this.fd.Ql();b.set(this.zz.value);this.VGb.ZR(b);return b.Vb(28)&&b.Vb(29)?b:null}QJf(){const b=this.fd.Ql();b.set(this.zz.value);
this.VGb.ZR(b);return b.Vb(28)?b:null}ftm(b){var h=this.jQb();if(!h||!b||!this.gRb(h,b,!1))return null;h.je();b=1<h.ar();h.je();h.je();h=h.currentNode;return Cd.ParagraphReader.Wb(h)?{Roe:h,uNi:b}:{Roe:null,uNi:b}}twi(){const b=this.jQb();return this.gRb(b,ts.a.mdi,!0)?b.currentNode.getValue(Vc.a.ilc):null}}Object(u.a)($J,"GlossaryNavigator",null,[652]);class QH{constructor(b,h,r,A,L,Z){this.sr=b;this.lh=h;this.Wm=r;this.hb=A;this.Rh=L;this.Gja=Z}ynd(b,h,r){if(!this.Gja)return 1;if(!({Bp:L}=this.p0f(b)).returnValue||
!this.Rh.v2i(L,h)||this.mBj(b,h))return 2;var A=this.Rh.Esi(h);var L=A.K(0).djc();L&&L.count||(L=new nb.a,L.add(b.objectId));b=this.lh.lei(A);r=r.split("\n");h=Object(Ca.a)(hb.a,this.lh.RJf(h));h=this.lh.LNh(h,b,r.length);for(b=0;b<h.count;++b){A=h.K(b);this.sr.We(xc.a.createTextRange(A,0,0),r[b]);for(let Z=0;Z<L.count;++Z)this.sr.qya(A,L.K(Z),0,!0,!0),this.sr.qya(A,L.K(L.count-Z-1),A.characterData.length,!0,!1)}return 0}mBj(b,h){if(!this.Gja)return 1;let r;if(!({Bp:r}=this.p0f(b)).returnValue||!this.Rh.v2i(r,
h))return 2;h=this.Rh.Esi(h);if(0<h.count&&(h=this.Wm.ZO(xc.a.create(h.K(0)),xc.a.create(h.K(h.count-1)),2)))for(const A of h)if(A.id!==b.id&&!this.Wm.lDa(A,!0))return 2;return 0}$oc(b){if(!this.Gja||!({Bp:r}=this.p0f(b)).returnValue)return!1;b=b.LFf();for(var h of b)if(!h.Tla||!h.isSupported)return!1;if(this.Rh.lhn(r))return!1;var r=Object(Ca.a)(hb.a,this.lh.RJf(r));h=new nb.a;this.hb.HQb(r,!0,!1,h);for(const A of h)if(0<A.ka(Vc.a.NOb,0)||this.hb.o9a(A).fz)return!1;return!0}p0f(b){let h=null;return b&&
b.rv.toString()===b.IA.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.lh.jv(b.rv))&&14===h.type?{returnValue:!0,Bp:h}:{returnValue:!1,Bp:null}:{returnValue:!1,Bp:h}}}Object(u.a)(QH,"TableContentControlEditor",null,[651]);class fF{lhn(b){let h=!1;const r=new hb.a;r.set(b);Kh.forEachCellInTable(r,A=>{if(!$g.TableCellReader.Ng(A)){let L=fo.OutlineNavigator.Gba(A);for(;L;){if(Eb.a.Dlc(A))return h=!0,!1;L=A.Ci(1)}}return!0});return h}v2i(b,h){const r=new hb.a;r.set(h);return $g.TableCellReader.SBa(h)&&
r.zb(14)&&r.kd(14).id===b.id?!0:!1}Esi(b){const h=new nb.a,r=new hb.a;r.set(b);b=new nb.a;Cd.ParagraphReader.HQb(r,!0,!1,b);for(const A of b)h.add(A);return h}}Object(u.a)(fF,"TableReader",null,[433]);class gF{constructor(){this.Wm=null}get name(){return"WordEditor.ContentControl"}init(){y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled")&&(IH.a.yZa(Object(D.a)(Wa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Wa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").UXn,
"onContentControlRangeChanged")),this.Wm=Wa.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator"),Wa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Wa.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.Wm&&(this.Wm.dispose(),this.Wm=null)}wc(b){b.ia("WordEditor.ContentControl.Perf.IPerfLogger",()=>new KH.a(rd.a.Je)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new NH(Wa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();
b.ia("WordEditor.ContentControlNodeFactory",()=>new Qp(Wa.a.instance.Ta("Box4.ContentControlConfigSettings"),Wa.a.instance.Ta("Box4.ContentControl.IContentControlOperator"))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new qx(new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),new Xi.a,Object(so.a)(),Wa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Wa.a.instance.resolve("Box4.IOutlineEditor"),Wa.a.instance.resolve("Box4.IOutlineElementEditor"),
Wa.a.instance.resolve("Box4.IParagraphReader"),Wa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Wa.a.instance.Ta("Box4.ContentControlConfigSettings"),Wa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Wa.a.instance.Ta("WordEditor.ContentControl.GlossaryEditor"),Wa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ia("WordEditor.ContentControl.GlossaryNavigator",()=>new $J(new Xi.a,new rg.a(()=>
ab.StaticActiveAppFrame.za().kb.hd),Object(so.a)())).as("WordEditor.ContentControl.IGlossaryNavigator").ha();b.ia("WordEditor.ContentControl.ContentControlOperator",()=>new Kw(new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Wa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),
If.a.instance,Wa.a.instance.resolve("Box4.ISelectionFactory"),Wa.a.instance.resolve("Box4.IFormattingEditor"),Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"),Wa.a.instance.Oa("Box4.IContentControlDataChangedManager"),y.AFrameworkApplication.va,Wa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Wa.a.instance.resolve("Box4.IContentControlChpHelper"),
Wa.a.instance.Ta("Box4.ContentControlConfigSettings"),Wa.a.instance.Oa("Box4.IContentControlReader"),Wa.a.instance.resolve("Box4.IParagraphReader"),Wa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Wa.a.instance.Ta("Box4.Actors.IVirtualSelectionMerger"),Wa.a.instance.resolve("Box4.IFeatureHelper"),Wa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Wa.a.instance.Ta("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new rx(new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Wa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Wa.a.instance.Ta("Box4.ContentControlConfigSettings"),Wa.a.instance.resolve("Box4.IContentControlChpHelper"),Wa.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ia("WordEditor.ContentControl.ContentControlChpManager",()=>new jD(Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.Ta("Box4.ContentControlConfigSettings"),Wa.a.instance.resolve("Box4.IParagraphReader"),Wa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ia("WordEditor.ContentControl.GlossaryEditor",()=>new Wv(Wa.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Wa.a.instance.resolve("Box4.IOutlineElementEditor"),Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Wa.a.instance.resolve("Box4.TextFormattingHelper"),Wa.a.instance.resolve("Box4.IFormattingEditor"),ed.a.jf.Tl.qf(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",
()=>new QH(Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Wa.a.instance.resolve("Box4.IParagraphReader"),new fF,y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();y.AFrameworkApplication.J.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ia("Box4.ContentControlConverter",()=>new cF(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ia("WordEditor.ContentControl.ContentControlCCP",()=>new MH(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new Zy(new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),Wa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Wa.a.instance.resolve("Box4.Actors.TextFormattingActor"),Wa.a.instance.resolve("Box4.TextFormattingHelper"),y.AFrameworkApplication.J)).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){E.a.instance.Mc(new gF)}}
Object(u.a)(gF,"ContentControlPackage",null,[0,1]);var aK=d(1307),wL=d(1419),bK=d(1795),cK=d(1540);class hF{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(u.a)(hF,"UxManagerMenuActionTelemetryData",null,[]);class RH extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.rxl=r}}Object(u.a)(RH,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class mD extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(u.a)(mD,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class MB{constructor(b,h,r,A,L,Z,oa=!1,Ba=null,gb=null,Ab=null,Jb=!1,Tb=null,jc=!1,Hc=!0,hd=null,Gd=!1,de=10){this.target=this.container=this.Jg=null;this.isDismissed=!1;this.Xed=this.Jed=this.hmi=this.u0=this.Tv=this.wga=this.tCa=this.AMa=this.documentElement=this.Yua=this.editingElement=null;this.isFocused=!1;this.l_d=null;this.bjg=this.MXf=!1;this.PEe=null;this.cqe=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=A;this.hUk=
L;this.uXa=Z;this.xUa=oa;this.JTj=Ba;this.Gra=gb;this.hostServices=Ab;this.L7o=Jb;this.gqj=Tb;this.VTj=jc;this.sVl=Hc;this.hmi=hd;this.showDictationCommandUx=Gd;this.source=de}}Object(u.a)(MB,"UxManagerState",null,[]);var NB=d(1601);class ho{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.Zb=b;this.ib=h;this.mB=r;this.qd=A;this.oe=L;this.Jb=Z;this.Nj=oa;this.Xm=Ba;this.N5=gb;this.G4b=Ab;this.X7e=!1;this._state=null;this.shouldIgnoreFocusEvent=Jb=>{var Tb;return this.qd.Gd.vw&&!this.qd.Gd.BX&&Jb===(null===
(Tb=this.qd.Ie)||void 0===Tb?void 0:Tb.editingElement)};this.sa=new Bf.a;this.wMd=new Ha.a;this.jff((Jb,Tb)=>{ho.RFn(r,Tb.definition,Tb.source)});this.N0k((Jb,Tb)=>{ho.QFn(r,Tb.definition,Tb.source,Tb.rxl)});this.Zb.ie(ho.w3d).IL=!0;y.AFrameworkApplication.va.qa(Ec.a.iZc,kc.a.view,this.iZc.bind(this))}jff(b){this.sa.addHandler(ho.I7f,b)}zDj(b){this.sa.removeHandler(ho.I7f,b)}Kno(b,h){this.sa.raiseEvent(ho.I7f,new mD(b,h))}N0k(b){this.sa.addHandler(ho.idj,b)}Jno(b,h,r){this.sa.raiseEvent(ho.idj,new RH(b,
h,r))}wBp(b){var h;if(!b.isDismissed&&b.Yua){var r=NB.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=NB.b(r);var A=rd.a.getElementBounds(b.Yua);r.width||r.height?r.x+r.width<A.x||r.x>A.x+A.width||r.y+r.height<A.y||r.y>A.y+A.height?this.dismiss():(A=b.target,A.style.left=r.x+"px",A.style.top=r.y+"px",A.style.width=r.width+"px",A.style.height=r.height+"px",null===(h=b.Jg)||void 0===h?void 0:h.updatePosition(),b.Jg||v.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):
(v.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}Bxj(b){b.isDismissed||b.PEe||(b.PEe=new mf.a(2,1,1,()=>{b.PEe=null;this.wBp(b)},147),this.Jb.$b(b.PEe))}AMa(b,h){!b.isDismissed&&b.sVl&&0<h.VP.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}e5k(b){return!!b&&b.id===ho.kUk}tCa(b,h){if(b.isDismissed||
!h||!h.Lb)return!1;h=h.Lb;const r=h.keyCode,A=!b.isFocused&&!!b.Jg,L=h.altKey||h.ctrlKey||h.shiftKey;let Z=!1;r===jf.a.J4?(this.dismiss(),v.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),Z=!0):r!==jf.a.Pu&&r!==jf.a.pz||!A||L||!this.e5k(b.definition)?r!==jf.a.K2b&&r!==jf.a.Htd||!A||L||(this.Jmg(b),b.Jg?(b.Jg.focus(),Z=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.Jg.executeDefaultAction(),v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),Z=!0);Z&&(h.preventDefault(),h.stopPropagation());return Z}Jed(b,h){if(b.isDismissed||!b.Jg)return v.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Jg),!1;b.Jg.invokeBadgeId(h);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}Xed(b,h){if(b.isDismissed||!b.Jg)return v.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Jg),!1;b.Jg.executeActionFromString(h);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}wga(b,h){if(b.isDismissed||!h||!h.Lb||!b.Jg)return v.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===h?
0:h.Lb),!b.Jg),!1;const r=b.target;b=b.Jg.getElementBounds();var A=h.Lb;h=A.clientX;A=A.clientY;r&&ho.jtj(h,A,rd.a.getElementBounds(r),16)||b&&ho.jtj(h,A,ho.cfl(b),4)||this.dismiss();return!1}q1o(b){var h=NB.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=NB.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=ho.Trf();b.target=h;b.editingElement=this.qd.Ie.editingElement;b.Yua=this.qd.Gd.container;b.documentElement=document.documentElement;b.AMa=(r,A)=>{this.AMa(b,A)};b.tCa=
r=>this.tCa(b,r);b.wga=r=>this.wga(b,r);b.u0=()=>{this.Bxj(b)};b.Tv=()=>{this.Bxj(b)};b.showDictationCommandUx&&(b.Jed=r=>this.Jed(b,r),b.Xed=r=>this.Xed(b,r),this.G4b&&this.G4b.execute(r=>{r.EXo(b.Jed);r.GXo(b.Xed)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.AB(b.AMa);this.Nj.a2(b.Tv);this.oe.ub(od.a.WK,b.editingElement,b.tCa);b.xUa&&this.Xm.ub(od.a.Sta,b.documentElement,b.wga);zc.a.addHandler(b.Yua,"scroll",b.u0);b.uXa||this.Jmg(b);return!0}oRb(b,h){const r=
!!b.Jg;this.Jno(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Zb.currentScope.name===ho.w3d&&this.Zb.bV(ho.w3d);b.AMa&&this.ib.gna(b.AMa);b.tCa&&b.editingElement&&this.oe.xc(od.a.WK,b.editingElement,b.tCa);this.G4b&&this.G4b.execute(A=>{b.showDictationCommandUx&&(A.ZGo(),A.$Go());A.nOj(!1,b.showDictationCommandUx)});b.wga&&b.documentElement&&b.xUa&&this.Xm.xc(od.a.Sta,b.documentElement,b.wga);b.u0&&b.Yua&&
zc.a.removeHandler(b.Yua,"scroll",b.u0);b.Tv&&this.Nj.Yga(b.Tv);b.Jg=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.Yua=null;b.AMa=null;b.tCa=null;b.wga=null;b.u0=null;b.Tv=null;b.Jed=null;b.Xed=null;r&&b.Gra&&(b.MXf?b.bjg=!0:b.Gra(b.l_d))}K9a(b,h){var r;if(!h)return!1;switch(h.actionType){case lq.b.Toggle:if(h.objectFulfillment===ho.tmp)return this.X7e=!this.X7e,this.LKg(),this.eZc(b),!0;if(h.objectFulfillment===ho.xmp)return{value:r}=this.wMd.Ec(h.suggestionGroup.type,
!1),this.wMd.W(h.suggestionGroup.type,!r),this.eZc(b),!0;break;case lq.b.GiveFeedback:if(bK.a.Fin(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type)||cK.a.wtn(h.objectName))break;this.focus();this.LKg();this.eZc(b);return!0;case lq.b.RevealSuggestions:this.eZc(b)}b.MXf=!0;h=b.hUk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.MXf=!1;h&&this.eZc(b);b.bjg&&(b.bjg=!1,b.Gra(b.l_d),b.l_d=null);return h}eZc(b){b.wga&&b.documentElement&&b.xUa&&(this.Xm.xc(od.a.Sta,b.documentElement,b.wga),b.xUa=
!1)}w5o(b,h){return b.id===wL.a.Mlb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}CDe(b){var h;if(this.q1o(b)){var r=1;y.AFrameworkApplication.J.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var A=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(A=b.definition.suggestionGroups[0].type,A=this.wMd.tb(A)?this.wMd.K(A):b.L7o);h=!1;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);r={containerElement:b.container,
targetElement:b.target,definition:b.definition,onAction:L=>this.K9a(b,L),onDismiss:L=>{this.oRb(b,L)},keepCurrentFocus:b.uXa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.X7e,showDescription:A,showEditorButton:b.VTj,showEditorBranding:this.w5o(b.definition,b.VTj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.hmi,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};
b.gqj&&b.gqj(r);this.mB.createContextualUi(r).then(L=>{this.Kno(b.definition,b.source);b.Jg=L;v.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.JTj&&b.JTj();this.G4b&&9!==b.source&&this.G4b.execute(Z=>Z.nOj(!0,b.showDictationCommandUx))}).catch(L=>{this.oRb(b,{JTp:aK.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",L)});0<b.cqe&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.cqe)}else 5<++b.cqe?(v.ULS.sendTraceTag(50968330,
341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Jb.$b(new mf.a(2,1,Math.pow(3,b.cqe),()=>{b.isDismissed||this.CDe(b)},146))}get zI(){return!!this._state&&!this._state.isDismissed}fKg(b,h){this.zI&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.zI?this._state.definition:null}set definition(b){this.zI&&(this._state.definition=b,this._state.Jg&&this._state.Jg.setDefinition(b))}focus(){this.zI&&this._state.Jg&&(this._state.isFocused||
this.Jmg(this._state),this._state.Jg.focus())}LKg(){this.zI&&this._state.Jg&&this._state.Jg.updatePosition()}Jmg(b){this.Zb.EN(ho.w3d,!1);b.isFocused=!0}Dna(b,h,r,A,L,Z=null,oa=null,Ba=null,gb=!1,Ab=null,Jb=!1,Tb=!0,jc=null,Hc=!1,hd=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Gd,de;if(!({paragraphNode:de,start:b,end:Gd}=ho.bqp(b)).returnValue)return!1;this._state=new MB(de,b,Gd,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd);this.CDe(this._state);return!0}v_b(b){this._state&&(this._state.l_d=
b)}iZc(b,h,r){if(1===r)return this.zI?32:0;this.zI&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.Jg)||void 0===b?void 0:b.dismiss())}static RFn(b,h,r){r=new hF(r);b.logAction({actionType:lq.b.SessionStart,engagement:lq.a.Try,objectName:ho.J_j,objectId:h.id,data:r});if(h.suggestionGroups)for(const A of h.suggestionGroups)b.logAction({actionType:lq.b.Presented,engagement:lq.a.See,objectName:A.type,objectId:A.id,data:r})}static QFn(b,h,r,A){r=
new hF(r);b.logAction({actionType:lq.b.SessionEnd,engagement:lq.a.None,objectName:ho.J_j,objectId:h.id,data:r},A)}static Trf(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static cfl(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static jtj(b,h,r,A){const L=r.y-A,Z=r.x+r.width+A,oa=r.y+r.height+A;return r.x-A<=b&&b<=Z&&L<=h&&h<=oa}static bqp(b){let h,r;if(!b||!Cd.ParagraphReader.Wb(b.node)||b.contextId!==kc.a.Vc&&b.contextId!==kc.a.Cd&&b.contextId!==
kc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==kc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}Hqc(){this.N5&&this.N5.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}ho.kUk="ActionSet";ho.J_j="IntentGroup";ho.w3d="CanvasContextualUxReact";ho.tmp="Context";ho.xmp="Description";ho.I7f="MenuDidOpen";ho.idj="MenuDidClose";Object(u.a)(ho,"UxManager",null,[]);class SH{constructor(){this.Z=
null}get name(){return"WordEditor.CanvasContextualProvider"}wc(b){this.Z=b}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){const b=y.AFrameworkApplication.J.$("EditorGoalsEnabled"),h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1);(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(54)||kn.a.qLa||
y.AFrameworkApplication.J.$("RewriteIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.Z.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("canvasContextual")).then(()=>{this.Z.ia("CanvasContextual.ICanvasContextualController",()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:y.AFrameworkApplication.uiCulture,
dataCulture:y.AFrameworkApplication.dataCulture,isRightToLeft:y.AFrameworkApplication.isRtl,ulsLogger:new cn.a,dimeCallback:async()=>{this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.Z.Ta("Common.IInProductMessagingUIManager").execute(r=>{r.i7i()})},getSoftPaywallData:()=>this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),
logSystemInitiatedFeedback:async r=>{this.Z.Ta("Common.ISystemInitiatedFeedback").execute(A=>A.logActivity(r,null))}})).ha();this.Z.ia("WordEditor.CanvasContextualProvider.UxManager",()=>new ho(Sg.FocusManager.instance(),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("CanvasContextual.ICanvasContextualController"),Object(Kb.a)(),Cb.KeyInputManager.instance,y.AFrameworkApplication.pc,y.AFrameworkApplication.ua,y.AFrameworkApplication.ua.S8,this.Z.Ta("Common.ISystemInitiatedFeedback"),this.Z.Ta("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();
this.Z.resolve("CanvasContextual.ICanvasContextualController");this.Z.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.Z.ia("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new cn.a})).ha(),this.Z.resolve("CanvasContextual.IEditorInitializer").init(),this.Z.ia("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new cn.a})).ha(),
this.Z.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.Z.ia("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new cn.a})).ha(),this.Z.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(r=>{v.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",r)})}dispose(){}static main(){E.a.instance.Mc(new SH)}}Object(u.a)(SH,"PackageManager",
null,[0,1]);class TH{constructor(b,h,r,A){this.Lan=(L,Z,oa)=>{L=null;Z.view.ve&&(L=Z.view);if(!L||!L.lb)return 8;if(!this.KK.JYf())return 2;if(1===oa)return 32;this.SIk.mFl();return 32};this.acj=(L,Z,oa)=>{let Ba=null;Z.view.ve&&(Ba=Z.view);if(!Ba||!Ba.lb)return 8;if(!this.KK.JYf())return 2;if(1===oa)return 32;if(1!==this.KK.Lkc(this.ib.gb,!0).count)return 2;Z=new Sb.GraphTransaction(15);try{if(Z.Ab(Ba.vd),!this.KK.hrp(L===Ec.a.a7f))return 8}finally{Z&&Z.dispose()}return 32};this.ga=b;this.ib=h;this.KK=
r;this.SIk=A}Xb(){this.ga.qa(Ec.a.ybe,kc.a.view,this.Lan);this.ga.qa(Ec.a.a7f,kc.a.view,this.acj);this.ga.qa(Ec.a.bcj,kc.a.view,this.acj)}}Object(u.a)(TH,"IntelligentPlaceholderActor",null,[]);class dK{constructor(){this.SDc=new Ha.a;this.Vxd=new Ha.a}gVk(b,h){let r;({value:r}=this.SDc.Ec(b,r)).returnValue||this.SDc.W(b,r=new Oa.a);r.add(h)}MVk(b,h){this.Vxd.tb(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.Vxd.W(b,h)}fVk(b,h,r){this.gVk(b,h);this.MVk(h,r)}xjm(b){let h;
return({value:h}=this.SDc.Ec(b,h)).returnValue?h:null}Fmm(b){let h;return({value:h}=this.Vxd.Ec(b,h)).returnValue?h:null}ABo(b){let h;if(({value:h}=this.SDc.Ec(b,h)).returnValue){for(const r of h)this.Vxd.remove(r);this.SDc.remove(b)}else v.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(u.a)(dK,"IntelligentPlaceholderAtMentionManager",null,[674]);var eK=d(1704);class lA extends eK.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Fv(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}nTj(b){return!b.ka(Vc.a.yI,
!1)}mVa(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(u.a)(lA,"IntelligentPlaceholderDetailsProvider",eK.a,[]);var OB=d(1861),CM=d(2120),lk=d(1865);class Og{constructor(){this.oFa=""}Ola(b){this.oFa+=b}ZUf(b){this.oFa+=b}rbe(b){this.oFa+=b}Emc(b){this.oFa+=b}JUf(b){this.oFa+=b}}Object(u.a)(Og,"PlainTextFormatCreator",null,[1773]);var fK=d(1582),gK=d(2119);d(337);var UH=d(1581),PB=d(1428);class mA{constructor(){this.oGc=new Ha.a}contains(b){return this.oGc.tb(mA.B1f(b))}add(b){this.oGc.W(mA.B1f(b),
b)}remove(b){this.oGc.remove(mA.B1f(b))}rtp(b){for(const h of b.oGc)this.add(h.value)}cmi(){const b=new nb.a;for(const h of this.oGc)b.add(h.value.pk);return b}static B1f(b){return b.pk.toString()}}Object(u.a)(mA,"CommentRangeSet",null,[]);class nD extends Sys.EventArgs{constructor(b){super();this.ZK=b}}Object(u.a)(nD,"OnFollowUpEventArgs",Sys.EventArgs,[]);class VH extends nD{constructor(b,h){super(b);this.Nco=h}}Object(u.a)(VH,"OnCreateEventArgs",nD,[]);class nA extends nD{constructor(b,h){super(b);
this.ern=h}}Object(u.a)(nA,"OnResolveEventArgs",nD,[]);var oD=d(221);class gy{}gy.vHe="MentionExperienceDegraded";Object(u.a)(gy,"AtMentionsConstants",null,[]);class iF{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.idd=b;this.Fal=h;this.frd=r;this.sUd=A;this.lb=L;this.Xs=Z;this.Ube=oa;this.fTi=Ba;this.Iw=gb;this.hdc=Ab;this.$Ya=null;this.W2n=(Jb,Tb,jc)=>{v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Jb=this.Ube.q$a(Jb,jc.displayName,jc.email,jc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,
Tb),!0);Jb?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.hdc.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:gy.vHe,isInternal:!0})};this.J1n=(Jb,Tb)=>{v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");Tb&&this.hdc.ex(Ec.a.Cml);this.Ube.RWm(Jb.id,Tb)};this.JYn=()=>{this.Xs.Gd.vw&&!this.Xs.Gd.BX&&this.Xs.Ie.myf?this.D_h=!0:(this.idd.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};
this.i4n=()=>{v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.QYk()};this.I1n=(Jb,Tb,jc,Hc=new Map)=>{Hc=Object.assign(new Na.a,{extendedProperties:Hc});this.hdc.logKpiFailure("LPPWordEditorKPI",Jb,{isIntentional:Tb,isInternal:jc,additionalValues:Hc},{name:gy.vHe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:Tb,isInternal:jc,additionalValues:Hc})};(b=Wa.a.instance.Oa("Box4.IEditStateEventManager"))&&b.addHandler(oD.a.FHa,this.vIo.bind(this))}Oee(){return!!this.$Ya}vIo(){this.Oee()&&
this.D_h&&(this.$Ya.updateInputText(this.Had,!1),this.D_h=!1)}ariaNotify(b,h){this.Iw.sendNotification(b,h)}QYk(){const b=this.Xs.Ie.editingElement;if(b){var h=b.getAttribute($c.a.uTc);b.setAttribute($c.a.uTc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}LAo(){const b=this.Xs.Ie.editingElement;if(b){var h=b.getAttribute($c.a.uTc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?
b.setAttribute($c.a.uTc,h.join(" ")):b.removeAttribute($c.a.uTc)):v.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}Yql(){this.LAo();this.$Ya&&this.$Ya.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.$Ya=null;this.fTi.ANj(!0)}ete(){this.idd.gqg(()=>{this.Yql()});this.idd.Wpg((b,h)=>{this.Had=b;if(this.$Ya)1<this.Had.length&&"@"===this.Had.trimEnd()?
(this.hdc.ex(Ec.a.Bml),this.idd.reset()):this.$Ya.updateInputText(this.Had,!1);else if(this.hdc.logKpiUsage("LPPWordEditorKPI",0),this.hdc.ex(Ec.a.s6n),(b=this.Qvm(h))&&b.height){h=b.y;const r=b.height,A=document.createElement("div");A.id="PeoplePicker";A.style.position="absolute";A.style.top=h-5+"px";A.style.left=b.x+"px";A.style.height=r+10+"px";document.body.appendChild(A);this.Fal.createPeoplePicker({editingElementId:this.Xs.Ie.editingElement.id,containerElement:A,automationID:"PeoplePickerAutomationID",
onReplaceTextCallback:this.W2n,onPermissionsReceivedCallback:this.J1n,onDismiss:this.JYn,onShow:this.i4n,onFailure:this.I1n}).then(L=>{L.updateInputText(this.Had,!1);this.$Ya=L;this.fTi.ANj(!1)})}});this.idd.Xpg(b=>{if(this.$Ya)this.$Ya.onKeyDown(b.Lb.rawEvent)})}Qvm(b){var h=this.lb.gb;if(!h)return null;h=h.currentSelection;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Ca.a)(139,h);if(!h)return null;h=Object(Ca.a)(379,h.jm(this.Xs.Gd.Ic));if(!h)return null;h=Object(Ca.a)(42,
h);if(!h)return null;let r=null;try{r=this.frd.f2(this.sUd.hjc(2,b),h,!1,!1,!1,!1)}catch(A){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",A)}return r}}Object(u.a)(iF,"WordEditorAtMentionsHandler",null,[378]);var uv=d(1414);class Bp{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd){this.ga=b;this.fd=h;this.VRa=r;this.ib=A;this.Nq=L;this.Rd=Z;this.iF=oa;this.DDd=Ba;this.Zd=gb;this.kq=Ab;this.jok=Tb;this.Pi=jc;this.Rc=Jb;this.sa=new Bf.a;
this.fj=Hc;this.q9g=hd;PB.a.nff((Gd,de)=>{this.yI(de.ZK,!0)&&this.sa.raiseEvent(Bp.Qed)})}rPh(b){this.sa.addHandler(Bp.Ojj,b)}X1k(b){this.sa.addHandler(Bp.hnj,b)}E1k(b){this.sa.addHandler(Bp.z0n,b)}nff(b){this.sa.addHandler(Bp.Qed,b)}yI(b,h){let r=b.ka(Vc.a.yI,!1);h&&(r=r&&!b.ka(Vc.a.Bea,!1));return r}loc(b){return this.Nq.loc(b)}JCm(b){for(const h of b)for(const r of h)if(Bp.O0f(r.contextId))return r.node.Hc;return null}cKm(b,h,r){const A=new mA,L=b.Hc;for(let Z=0;Z<b.ra.length;Z++){const oa=b.ra.Ub(Z);
if(oa.cp>=h)break;if(oa.Ue&&oa.Ue.length)for(let Ba=0;Ba<oa.Ue.length;Ba++){const gb=oa.Ue.K(Ba);this.yI(L.Eb(gb.pk),r)&&(gb.Wc?A.add(gb):A.remove(gb))}}return A}dKm(b,h,r,A){const L=new mA,Z=b.Hc;for(let oa=0;oa<b.ra.length;oa++){const Ba=b.ra.Ub(oa);if(Ba.cp>r)break;if(Ba.Ue&&Ba.Ue.length)for(let gb=0;gb<Ba.Ue.length;gb++){const Ab=Ba.Ue.K(gb);this.yI(Z.Eb(Ab.pk),A)&&(Ab.Wc?Ba.cp<r&&L.add(Ab):Ba.cp<=h&&L.remove(Ab))}}return L}aGi(b,h){let r;const A=b.node;b.contextId!==kc.a.paragraph?(r=b.cpBegin,
b=b.cpEnd):(r=0,b=A.characterData.length);return r===b?this.cKm(A,r,h):this.dKm(A,r,b,h)}t4c(b,h){return Bp.O0f(b.contextId)?this.aGi(b,h).cmi():new nb.a}Lkc(b,h){const r=new mA;for(const A of b)for(const L of A)Bp.O0f(L.contextId)&&r.rtp(this.aGi(L,h));return r.cmi()}JYf(){var b=this.ib.gb;if(!b||1!==b.length||1!==b.K(0).length)return!1;b=b.K(0).Qa.node;return Cd.ParagraphReader.Wb(b)&&!Cd.ParagraphReader.hza(b)&&this.Nq.Wsb(this.ga,!0)?!0:!1}iSi(b,h){if(!this.JYf())return null;if(this.Nq.RYm())return v.ULS.sendTraceTag(592761861,
323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var A=this.ib.gb.K(0).Qa;A.contextId===kc.a.Vc?(b=b?he.a.T6(A,!1):null)&&b.Nw&&b.Qa.contextId===kc.a.Cd?this.ib.Kc(b):(this.Rd.We(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ib.Kc(qc.SelectionFactory.eL(A.node,A.cpBegin,A.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.fj.BNb||OB.a.instance.A7c();b=this.Nq.ufc(this.ib.gb.currentSelection);
if(!b)return null;this.loc(b)&&this.q9g.ex(Za.a.dMa,{succeeded:!0,jfb:29});var L=this.fd.mg(b);const Z=L.Vb(1);if(!Z||Z.sc!==Ln.a.UX)return null;L=L.Vb(2);if(!L||L.sc!==Ln.a.paragraphNode)return null;this.aKg(b.Hc,b.id);this.sa.raiseEvent(Bp.Ojj,new VH(b,h));r&&(h=A.node,A=A.contextId!==kc.a.paragraph?A.cpEnd:h.characterData.length,this.ib.Kc(qc.SelectionFactory.eL(h,A,A)));return b}ybe(b){return!!this.iSi(!0,b)}N7c(b,h,r,A,L,Z){if(0>h)return!1;A="@"+A;const oa=A+" ",Ba=new Sb.GraphTransaction(15);
try{Ba.Ab(b);this.Rd.We(xc.a.createTextRange(b,h,r),oa);this.Zd.Bg&&(this.kq.gof(b,h,h+A.length),this.kq.vna(b,h+A.length,h+oa.length,1));const gb=this.iF.wF(xc.a.createTextRange(b,h,h+A.length),"mailto:"+L,!1,!0,!1);if(!gb)return!1;const Ab=gb.Jw;if(!Ab)return v.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ib.Kc(qc.SelectionFactory.eL(b,h,h+A.length));const Jb=this.iSi(!1,2);if(!Jb)return!1;Z&&this.DDd.fVk(Z,Ab,Jb.id);this.ib.Kc(qc.SelectionFactory.ue(b,
h+oa.length))}finally{Ba&&Ba.dispose()}return!0}q$a(b,h,r,A){const L=this.ib.Pg;return he.a.mf(L)?this.N7c(L.node,L.cpBegin-b,L.cpBegin,h,r,A):!1}bGm(b){if(1===b.length&&b.K(0).Nw&&(b=b.K(0).Qa,b.contextId===kc.a.Vc&&Cd.ParagraphReader.Wb(b.node))){const h=b.node;for(let r=0;r<h.ra.length;r++){const A=h.ra.Ub(r);if(A.cp===b.cpBegin){b=A.T7d(!0,!0);if(0<b.length)return b[0].pk;break}}}return null}DMb(b,h,r){return this.Nq.eXc(b,h,r).returnValue}u4d(b,h,r,A,L){let Z=!1;const oa=b.characterData;if(h>=
oa.length||r>oa.length||r<h)return{returnValue:!1,cVa:Z};let Ba=h,gb=null;for(let Jb=0;Jb<b.ra.length;Jb++){const Tb=b.ra.Ub(Jb),jc=Tb.cp;if(!(jc<h)){if(Tb.wn&&gb)try{const Hc=oa.substring(Ba,jc),hd=new CM.a;hd.fullName=Hc.startsWith("@")?Hc.substr(1):Hc;UH.a(gb.url,gb.Jw,hd);const Gd=new lk.a;UH.b(gb.Jw,Gd);L&&(Gd.contentId=this.jok.VEf());A.rbe(Hc,hd,Gd);Z=!0;gb=null;Ba=jc}catch(Hc){var Ab=Object.assign(new Na.a,{extendedProperties:new Map});Ab.extendedProperties.set("exception",Hc.message);this.q9g.logKpiFailure("LPPWordEditorKPI",
"FailedToRenderAtMention",{isInternal:!0,additionalValues:Ab},{name:gy.vHe,isInternal:!0,additionalValues:Ab})}jc<=r&&!gb&&(Ab=Math.min(jc,r),Ab>Ba&&A.Ola(oa.substring(Ba,Ab)),Ba=jc);Tb.hyperlink&&Tb.hyperlink.wI&&(gb=Tb.hyperlink);if(jc>=r)break}}return{returnValue:!0,cVa:Z}}Psi(b,h,r,A,L=-1){var Z=!1,oa=b.Eb(h),Ba=b.Eb(uv.k(oa));oa=b.Eb(uv.h(oa));L=0<L?L:Number.MAX_VALUE;b=this.DMb(Ba,h,!0);h=this.DMb(oa,h,!1);if(-1===b||-1===h)return{returnValue:!1,cVa:Z};if(Ba===oa)return this.u4d(Ba,b,h,r,A);
const gb=this.VRa.gUa(Ba,!1,!1);if(!gb)return{returnValue:!1,cVa:Z};Ba=new nb.a;let Ab=0;do Ba.add(gb.DA),Ab+=gb.DA.characterData.length;while(gb.DA!==oa&&gb.Ala()&&Ab<L);for(L=0;L<Ba.count;L++)if(Z=Ba.K(L),oa=Z.characterData,L)if(L===Ba.count-1){if(!({cVa:Z}=this.u4d(Z,0,h,r,A)).returnValue)return{returnValue:!1,cVa:Z}}else{if(!({cVa:Z}=this.u4d(Z,0,oa.length,r,A)).returnValue)return{returnValue:!1,cVa:Z};r.Ola("\n")}else{if(!({cVa:Z}=this.u4d(Z,b,oa.length,r,A)).returnValue)return{returnValue:!1,
cVa:Z};r.Ola("\n")}return{returnValue:!0,cVa:Z}}t4d(b,h){const r=new Og;return this.Psi(b,h,r,!1,-1).returnValue?r.oFa:null}I1d(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(uv.h(r));if(!b)return null;h=this.DMb(b,h,!1);if(-1===h)return null;r=b.characterData;if(h>=r.length||!F.a.bga(r.charAt(h))){r=this.Rc.Lc(15);try{r.Ab(b),this.Rd.We(xc.a.Uc(b,h)," ")}finally{r&&r.dispose()}}return qc.SelectionFactory.ue(b,h+1)}aKg(b,h){const r=b.Eb(h),A=new fK.a;this.Psi(b,h,A,!0).returnValue&&(A.Ola("\n"),this.Nq.v6j(r,
A.gQa),this.sa.raiseEvent(Bp.w5n))}bPo(b,h){for(const r of b){if(r.contains(h))return!0;for(const A of r)for(const L of h)if(A.node===L.node&&A.zj>=L.zj)return!0}return!1}FYc(b,h,r,A,L){const Z=this.ib.gb.clone(),oa=new wr.a(ab.StaticActiveAppFrame.za().kb.Qc);b=qc.SelectionFactory.ue(b,h);r=xc.a.Uc(r,A);b=qc.SelectionFactory.Vy(b,r);this.ib.Kc(b);r=!this.bPo(Z,b);return 32===this.ga.Hf(oa,vb.a.gI,2,!0,null,null)?(r?this.ib.F0(Z):L!==Q.a.nil&&(L=this.I1d(this.Pi.value,L),this.ib.Kc(L)),!0):!1}rzo(b,
h){var r=b.Eb(h);const A=b.Eb(uv.k(r));b=b.Eb(uv.h(r));if(A===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var L=A.characterData.indexOf(r);-1!==L&&this.FYc(A,L,b,L+r.length,h)}}dei(b,h,r){var A=b.Eb(h);if(!A)return!1;const L=b.Eb(uv.k(A));b=b.Eb(uv.h(A));A=this.DMb(L,h,!0);const Z=this.DMb(b,h,!1);if(-1===A||-1===Z||!this.FYc(L,A,b,Z,Q.a.nil))return!1;r&&this.oei(h);return!0}oei(b){this.Nq.brg(b,!0)}hrp(b){var h=this.JCm(this.ib.gb);if(!h)return!1;const r=this.Lkc(this.ib.gb,
!0);if(1!==r.count)return!1;const A=h.Eb(r.K(0));if(b)h=this.dei(h,r.K(0),!1);else{const L=uv.k(A),Z=uv.h(A);Q.a.hw(L,Z)||v.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.IBl(r.K(0));h.Eb(L).Xl(16,!0);h=!0}h&&(A.setValue(Vc.a.Bea,!0),this.sa.raiseEvent(Bp.hnj,new nA(A,b)));return h}FVh(b,h){b=this.Lkc(this.ib.gb,!1);h.Nm[Bp.Ufi]=!!b.count}elj(b,h){if(h.Nm[Bp.Ufi]&&Cd.ParagraphReader.Wb(h.clone)&&(h=h.clone,b=h.Hc)&&(h=xc.a.createTextRange(h,
0,h.characterData.length),h=this.t4c(h,!1),h.count))for(const r of h)(h=b.Eb(r))&&h.setValue(Vc.a.yI,!1)}qom(b,h,r){let A;const L=({kVc:gb}=this.Nq.eXc(h,r,!0)).returnValue;r=({kVc:A}=this.Nq.eXc(h,r,!1)).returnValue;let Z=null,oa=-1,Ba=-1;for(;gb<A;gb++){const Ab=h.ra.Ub(gb);if(Ab.hyperlink&&Ab.hyperlink.wI&&Ab.hyperlink.Jw===b){Z=Ab.hyperlink;oa=Ab.cp;break}}if(!Z||oa<L)return{returnValue:!1,I8h:oa,H8h:Ba};for(b=gb;b<h.ra.length;b++){var gb=h.ra.Ub(b);if(gb.cp>r)break;if(gb.nX){Ba=gb.cp;break}}return{returnValue:-1!==
Ba,I8h:oa,H8h:Ba}}rAo(b){var h=this.DDd.Fmm(b);if(h){var r=null;ab.StaticActiveAppFrame.za()&&(r=ab.StaticActiveAppFrame.za().kb.hd.ud);if(r){var A=r.Eb(h);h=r.Eb(uv.k(A));var L=r.Eb(uv.h(A));if(h!==L)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({I8h:b,H8h:L}=this.qom(b,h,A.id)).returnValue){var Z=new Sb.GraphTransaction(7);try{Z.Ab(h);const oa=xc.a.createTextRange(h,b,L);this.Rd.We(oa,"");this.aKg(r,A.id)}finally{Z&&Z.dispose()}this.ib.gb&&0<this.ib.gb.length?
(r=this.ib.gb.K(0).Qa,r.node===h?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.Kc(qc.SelectionFactory.ue(h,b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,
323,15,"Mention bookmark has no associated comments")}RWm(b,h){if(!h){h=this.DDd.xjm(b);if(!h){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const r of h)this.rAo(r)}this.DDd.ABo(b)}mhm(){OB.a.instance.A7c();const b=new nb.a;for(const r of this.Nq.Fgf)if(r.Dr!==gK.a.bE){var h=Q.a.Bf(r.objectId);h=this.Pi.value.Eb(h);this.yI(h,!0)&&b.add(h)}return b}COo(b){b=this.Nq.LMf(b);this.ib.Kc(b)}IBl(b){b?this.Pi.value.Eb(b).setValue(Vc.a.yI,!1):v.ULS.sendTraceTag(594043491,
323,10,"The given intelligent placeholder guid is null")}static O0f(b){return b===kc.a.Cd||b===kc.a.Vc||b===kc.a.paragraph}}Bp.Ufi="DisableNestedIntelligentPlaceholder";Bp.Ojj="CreateIntelligentPlaceholder";Bp.hnj="ResolveIntelligentPlaceholder";Bp.w5n="UpdateIntelligentPlaceholder";Bp.Qed="DeleteIntelligentPlaceholder";Bp.z0n="MentionAddedToFollowUpEventKey";Object(u.a)(Bp,"IntelligentPlaceholderEditor",null,[663,664,665]);class WH{constructor(b,h,r,A){this.cxa=!1;this.Ps=!0;this.oe=null;this.Amb=
L=>{if(!this.Ps||!this.sll(L,this.ib.gb))return!1;L.Lb.preventDefault();L.Lb.stopPropagation();this.qd.Gd&&this.qd.Gd.r_c(!1);L=this.I1d(this.ib.gb);if(!L)return!1;this.ib.Kc(L);return!0};this.qd=b;this.Pi=h;this.ib=r;this.W9=A}sdc(b,h){this.cxa||(b.uBa?(this.Bmb(h),this.cxa=!0):b.Qja(()=>{this.cxa||(this.Bmb(h),this.cxa=!0)}))}dispose(){this.oe&&this.oe.xc(od.a.WK,this.qd.Ie.editingElement,this.Amb)}Bmb(b){this.oe=b;this.qd.Gd.vj&&this.oe.ub(od.a.WK,this.qd.Ie.editingElement,this.Amb)}sll(b,h){if(b.Lb.keyCode!==
jf.a.pz&&b.Lb.keyCode!==jf.a.Pu||1!==h.length||!h.K(0).Nw)return!1;var r=this.W9.Lkc(h,!0);if(1!==r.count)return!1;const A=h.K(0).Qa.node;if(!Cd.ParagraphReader.Wb(A))return!1;b=this.W9.DMb(A,r.K(0),!0);r=this.W9.DMb(A,r.K(0),!1);return h.K(0).Qa.cpBegin<b||h.K(0).Qa.cpEnd>r?!1:!0}I1d(b){b=this.W9.Lkc(b,!0);if(1!==b.count)return null;b=b.K(0);return this.W9.I1d(this.Pi.value,b)}ANj(b){this.Ps=b}}Object(u.a)(WH,"IntelligentPlaceholderKeyboardListener",null,[662,10]);class XH{constructor(b,h){this.Kcn=
r=>{1===r&&this.ga.Ob(Za.a.dMa,2);2===r&&(this.YCh.instance?this.YCh.instance.uAc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.GX("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new da.a,{name:"DialogResult",int64:r})];me.d(Ec.a.Opi,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.YCh=
h}mFl(){const b=new Ag.StandardDialog;b.Bd=11;b.Ke(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Ke(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.sw(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.Kcn);me.a("FollowUpsPhaseOutDialogShown")}}Object(u.a)(XH,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var wu=d(1386);class jF{constructor(b,h,r,A,L,Z){this.o$=this.u3e=null;this.c8=()=>{this.o$||(this.o$=new mf.a(3,
1,0,()=>{this.o$=null;this.g$d(this.ib.gb)},130),this.Jb.$b(this.o$))};this.Rc=b;this.KK=h;this.ib=r;this.Jb=A;this.Laf=L;this.Pi=Z;this.r5=new hm.a;this.qr=new wu.a;this.Ryh=new ek.a(this.r5);this.KK.rPh((oa,Ba)=>{this.XYk(Ba.ZK)})}XYk(b){b=b.id;const h=this.bEi(this.Pi.value,b);h&&this.qr.W(b,h)}bEi(b,h){const r=b.Eb(h);return!r||this.KK.loc(r)?null:this.KK.t4d(b,h)}$fl(b){const h=new wu.a;var r=this.KK.Lkc(b,!0);if(!r)return h;b=this.Pi.value;for(const A of r)(r=this.bEi(b,A))&&h.W(A,r);return h}brg(b){if(this.u3e){const h=
this.Rc.Lc(15);try{h.Ab(this.Laf()),this.KK.oei(this.u3e)}finally{h&&h.dispose()}}this.u3e=b?this.KK.bGm(b):null}rXm(b){const h=this.Pi.value;if(b=b?this.$fl(b):new wu.a){var r=new ek.a(this.r5),A=new ek.a(this.r5);jF.yrm(this.qr,b,r,A);for(var L of r)this.qr.W(L,b.K(L));for(const Z of A)if(r=this.qr.K(Z),A=this.KK.t4d(h,Z),this.qr.remove(Z),A&&(b=L=!1,Ja.a.T4c().equals(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<A.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?
L=!0:!Ja.a.T4c().equals(r,A),r||L||b)){A=this.Rc.Lc(15);try{A.Ab(this.Laf()),b?this.KK.dei(h,Z,!0):(L&&this.KK.rzo(h,Z),r&&this.KK.aKg(h,Z))}finally{A&&A.dispose()}}}}ZEm(b){const h=new ek.a(this.r5);for(const r of b)for(const A of r)b=A.node,Cd.ParagraphReader.Wb(b)&&h.add(b.id);return h}MVm(b){var h=this.Pi.value;const r=b?this.ZEm(b):new ek.a(this.r5);if(r){b=new nb.a;for(const Z of this.Ryh)if(!r.contains(Z)){var A=h.Eb(Z);if(A){A=A.ra;for(let oa=0;oa<A.length;oa++){const Ba=A.Ub(oa).Ue;if(Ba)for(let gb=
0;gb<Ba.length;gb++){var L=Ba.K(gb);L.Wc&&(L=h.Eb(L.pk))&&L.ka(Vc.a.q3i,!1)&&Q.a.hw(Z,uv.h(L))&&this.KK.loc(L)&&b.add(L)}}}}this.Ryh=r;if(b.count){h=this.Rc.Lc(7);try{h.Ab(this.Laf());for(const Z of b)Z.Vf(Vc.a.q3i)}finally{h&&h.dispose()}}}}g$d(b){this.brg(b);this.rXm(b);this.MVm(b)}s_h(){this.o$&&(this.Jb.wf(this.o$),this.o$=null)}uWb(){if(this.o$||this.Pi.IRf)this.s_h(),this.g$d(null)}ME(){this.ib.AB(this.c8);y.AFrameworkApplication.fG(()=>{this.uWb()})}dispose(){this.ib.gna(this.c8);this.s_h()}static yrm(b,
h,r,A){for(const L of h){const Z=L.key;b.tb(Z)||r.add(Z)}for(const L of b)b=L.key,h.tb(b)||A.add(b)}}Object(u.a)(jF,"IntelligentPlaceholderSelectionCache",null,[10]);var kF;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.Cal=2]="atMention";b[b.Woq=3]="textGesture";b[b.paste=4]="paste";b[b.dLp=5]="workItemIntent";b[b.rWp=6]="characterTrigger"})(kF||(kF={}));Object(u.b)("IntelligentPlaceholderCreation",kF);class Xq{constructor(b,h,r,A){this.FFa=b;this.En=h;this.D4b=r;this.zz=
A}yye(b){return b&&b.Hc&&b.Hc.id.equals(this.zz.value.ud.id)?!0:!1}FSj(b){return this.yye(b)&&b.ka(Vc.a.yI,!1)?!0:!1}lGn(){this.D4b.execute(b=>{b.logAction({actionType:lq.b.SessionStart,engagement:lq.a.Offer,objectName:Xq.kzc})})}Mhe(b,h){const r=2==h&&this.yye(b);if(this.FSj(b)||r){var A=b.getValue(Vc.a.ZG);this.D4b.execute(L=>{L.logAction({actionType:lq.b.Created,engagement:lq.a.None,objectName:Xq.kzc,objectId:A.toString(),objectFulfillment:kF[h]})})}}iEn(b){if(this.FSj(b)){var h=b.getValue(Vc.a.ZG);
this.D4b.execute(r=>{r.logAction({actionType:lq.b.Deleted,engagement:lq.a.None,objectName:Xq.kzc,objectId:h.toString()})})}}OGn(b,h){if(this.yye(b)){var r=b.getValue(Vc.a.ZG);this.D4b.execute(A=>{A.logAction({actionType:lq.b.Resolved,engagement:lq.a.None,objectName:Xq.kzc,objectId:r.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}GHn(b){b===Ec.a.ybe&&this.D4b.execute(h=>{h.logAction({actionType:lq.b.Deleted,engagement:lq.a.None,objectName:Xq.kzc,objectFulfillment:Xq.Hjp})})}PFn(b){if(this.yye(b)){var h=
b.getValue(Vc.a.ZG);this.D4b.execute(r=>{r.logAction({actionType:lq.b.Modified,engagement:lq.a.None,objectName:Xq.kzc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}Lcl(){this.lGn();this.FFa.rPh((b,h)=>{this.Mhe(h.ZK,h.Nco)});this.FFa.X1k((b,h)=>{this.OGn(h.ZK,h.ern)});this.FFa.E1k((b,h)=>{this.PFn(h.ZK)});this.En.wcc((b,h)=>{this.GHn(h.actionId)});PB.a.nff((b,h)=>{this.iEn(h.ZK)})}}Xq.kzc="IntelligentPlaceholder";Xq.Hjp="Undo";Object(u.a)(Xq,"IntelligentPlaceholderTelemetry",null,
[]);class lF{constructor(){this.W9=this.nFd=this.LLd=this.Z=null}get name(){return"WordEditor.IntelligentPlaceholder"}wc(b){this.Z=b;b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new XH(y.AFrameworkApplication.va,b.Ta("Common.App.SafeLinks.ISafeLinksManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new dK).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",
()=>new Bp(y.AFrameworkApplication.va,new Xi.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),b.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new TH(y.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new jF(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),
y.AFrameworkApplication.pc,()=>ab.StaticActiveAppFrame.za().kb.Qc.vd,new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new WH(Object(Kb.a)(),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd.ud),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new Xq(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Ta("CanvasContextual.ICanvasContextualController"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd))).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{this.Ho()})}Ho(){const b=this.Z.resolve("Box4.IFeatureHelper");this.Z.Ta("WordEditor.CanvasContextualProvider.UxManager");this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Xb();
this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").Lcl();this.W9=this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");bp.a.A0k(Object(D.a)(this.W9,this.W9.FVh,"beforeIntelligentPlaceholderPaste"));bp.a.oRd(Object(D.a)(this.W9,this.W9.elj,"onIntelligentPlaceholderPaste"));this.LLd=this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(90)||this.LLd.ME();this.nFd=this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.nFd.sdc(ab.StaticActiveAppFrame.za().kb,Cb.KeyInputManager.instance);this.Uvo(this.Z.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.LLd&&this.LLd.dispose();this.nFd&&this.nFd.dispose();this.W9&&(bp.a.KBo(Object(D.a)(this.W9,this.W9.FVh,"beforeIntelligentPlaceholderPaste")),bp.a.oCo(Object(D.a)(this.W9,this.W9.elj,"onIntelligentPlaceholderPaste")))}Uvo(b,h,r){b&&b.execute(A=>
{A.dY(new lA(h,r))})}static main(){E.a.instance.Mc(new lF)}}Object(u.a)(lF,"PackageManager",null,[0,1]);var YH=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",
attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},
children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",
attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",
Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},Ls=d(2183),pD=d(2176),et=d(2131);class hy{}hy.wcp="Search_16x16x32";hy.ocp="ClosePaneGlyph_16x16x32";
Object(u.a)(hy,"SearchBoxIcons",null,[]);var oA=d(2134),ft=d(2135),tx=d(2133);class Xv{constructor(){this.Nhh=null}get key(){return"FIND_HIT"}get Fv(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.Nhh=b.node.yVa()}rEa(b){let h=null;for(const r of this.Nhh)if(r.Dc<=b&&b<r.end)return h=Object.assign(new UA.a,{dG:this.key,contentObject:r}),{returnValue:!0,JG:h};return{returnValue:!1,JG:h}}}Object(u.a)(Xv,"FindHitDetailsProvider",null,[299,300]);var qD=d(1643),Un=d(1541),
QB=d(1604),mF=d(1650);class Yv{constructor(b,h,r,A,L,Z,oa,Ba=null,gb=null){this.Ym=null;this.find=(Ab,Jb,Tb,jc,Hc)=>1===Tb?32:void 0===Hc||null===Hc?8:Hc.length?this.ODg(Hc):(this.Fmf(et.a.initial),32);this.fic=(Ab,Jb,Tb,jc,Hc)=>this.NUj(Ec.a.Xyb,Ab,Jb,Tb,jc,Hc);this.s8l=(Ab,Jb,Tb,jc,Hc)=>this.NUj(Ec.a.Yyb,Ab,Jb,Tb,jc,Hc);this.soi=(Ab,Jb,Tb)=>1===Tb?32:this.ODg(this.kp.uVa());this.yid=(Ab,Jb,Tb,jc,Hc)=>{Ab=!this.kp.eI;Hc[jn.a.Image16by16Class]=Ab?Pb.getImageClass(hy.wcp):Pb.getImageClass(hy.ocp);
Hc[jn.a.LabelText]=Ab?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Hc[jn.a.ApplyLabelTextToControlOnly]=!0;Hc[jn.a.EnsureControlRoleIsButton]=!0;Hc[jn.a.On]=!1;return 32};this.v9l=(Ab,Jb,Tb)=>{if(1===Tb)return 32;this.EKi(!1);return 32};this.H9l=(Ab,Jb,Tb)=>{if(1===Tb)return 32;this.EKi(!0);return 32};this.Ang=(Ab,Jb,Tb,jc,Hc)=>{Hc[Um.a.Visible]=this.kp.UUj;return 32};this.Lng=(Ab,Jb,Tb,jc,Hc)=>{Hc[Um.a.Visible]=this.kp.UUj;return 32};
this.B9d=(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return 32;this.yC.Hld.LKi(Hc);return 32};this.nUd=(Ab,Jb,Tb)=>{if(1===Tb)return 32;this.Fmf(et.a.initial);return 32};this.JVc=(Ab,Jb,Tb)=>{if(1===Tb)return 32;this.Fmf(et.a.initial);this.kp.gA(!1);return 32};this.gIa=(Ab,Jb,Tb)=>{if(1===Tb)return this.Jgn(Ab===Za.a.N2h);this.kp.gIa();return 32};this.uEe=(Ab,Jb,Tb)=>{if(1===Tb)return 32;switch(Ab){case Za.a.tCf:this.kp.matchCase=!this.kp.matchCase;break;case Za.a.NCf:this.kp.matchWholeWord=!this.kp.matchWholeWord}return this.ODg(this.kp.uVa())};
this.$qe=(Ab,Jb,Tb,jc,Hc)=>{Hc[Tg.a.On]=this.kp.matchCase;return 32};this.bre=(Ab,Jb,Tb,jc,Hc)=>{Hc[Tg.a.On]=this.kp.matchWholeWord;return 32};this.jng=(Ab,Jb,Tb,jc,Hc)=>{Ab=this.kp.matchCase;Jb=this.kp.matchWholeWord;Tb="";Ab&&Jb?Tb=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Ab?Tb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Jb&&(Tb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Hc[Zi.a.Value]=Tb;Hc[Zi.a.Visible]=Ab||Jb;return 32};this.zuc=(Ab,Jb,Tb,jc,Hc)=>{Ab=this.kp.y5;Jb="";switch(this.kp.eI){case et.a.EXj:Jb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case et.a.jKj:Jb=Ab?this.lMf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case et.a.Txb:Jb=this.lMf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);
break;case et.a.Uha:Jb=this.lMf(this.kp.oLa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case et.a.hYa:Jb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case et.a.nvc:Jb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case et.a.mvc:Jb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Hc[Zi.a.Value]=Jb;return 32};this.are=(Ab,Jb,Tb,jc,Hc)=>{Hc&&(Hc.CommandValueId=this.kp.uVa());return 32};this.replace=
(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return this.r_f()?32:8;if(!this.r_f())return 8;Ab=this.kp.KQb();"string"===typeof Hc&&Hc&&(Ab=Hc);v.ULS.sendTraceTag(6033813,312,50,"Replace Called");me.a("NavigationPaneReplace");Hc=this.OHb.replace(Ab);this.kp.sSo(Hc);return 32};this.replaceAll=(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return this.lrn()?32:8;Ab=this.kp.KQb();"string"===typeof Hc&&Hc&&(Ab=Hc);me.a("NavigationPaneReplace");this.Ym=this.ee.Xf("UserAction","ReplaceAll");this.kp.Y$(et.a.nvc);v.ULS.sendTraceTag(4065348,
312,50,"Replace All started feedback indicated to user.");QB.a.wEo(this.kp.uVa(),this.kp.KQb());this.OHb.replaceAll(Ab,this.U2n);return 32};this.U2n=(Ab,Jb)=>{this.Ym&&(this.Ym.stop(),this.Ym=null);v.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Ab,["TotalCount"]:Jb});QB.a.tEo(Ab,Jb);this.kp.Y$(et.a.mvc)};this.Swj=(Ab,Jb,Tb,jc,Hc)=>{Jb=!1;if(!Hc)return 8;this.kp.Pj.isVisible&&(Jb=Ab===Ec.a.Sid===this.kp.n4c());Ab!==Ec.a.Sid||this.Zph||(Jb=!1);Hc[Tg.a.On]=Jb;return 32};
this.kng=(Ab,Jb,Tb,jc,Hc)=>{if(!Hc||!this.kp.Pj.isVisible)return 32;Hc[Tg.a.On]=this.kp.oLa;return 32};this.mng=(Ab,Jb,Tb,jc,Hc)=>{if(!Hc)return 32;Hc.currentFindReplaceViewType=this.kp.eI;return 32};this.xlo=(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return 32;Ab=Hc[Tg.a.On];Hc&&(Hc[Tg.a.On]=this.kp.Pj.isVisible);Ab&&!Hc[Tg.a.On]&&(Yv.O2j(),me.a("NavigationPaneCrossClick"));return 32};this.b0a=(Ab,Jb,Tb,jc,Hc)=>{const hd=this.kp.Pj.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",hd);return hd?this.JVc(Ab,
Jb,Tb,jc,Hc):this.Nxc(Ab,Jb,Tb,jc,Hc)};this.Nxc=(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return cc.SessionStatusManager.instance.WA?32:8;if(2===Tb){Yv.O2j();this.o8();qD.FindReplaceUIManager.pjl(Ab,Hc,this.kp.Pj.isVisible);Jb=!0;Ab===Ec.a.Rxc&&void 0!==Hc&&null!==Hc&&(Jb=Hc);this.kp.gA(!0,Jb);Hc=tx.a.initial;switch(Ab){case Ec.a.Oxc:v.ULS.sendTraceTag(42501022,367,50,"");Hc=tx.a.headings;break;case Ec.a.Xyb:Hc=tx.a.find;break;case Ec.a.Yyb:Hc=tx.a.replace;break;case Ec.a.Rxc:Hc=tx.a.intelligentPlaceholder;break;
case Ec.a.b0a:Hc=this.kp.Vfc,Hc||(v.ULS.sendTraceTag(42501023,367,50,""),Hc=tx.a.headings)}Hc!==tx.a.find&&Hc!==tx.a.replace||Yv.cpp();this.kp.pXo(Hc,Jb);mF.a.Tqp();return 32}return 8};this.lMa=()=>{this.kp.eI&&!this.kp.oLa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.kp=h;this.yC=r;this.OHb=A;this.Zph=L;this.ee=oa;gb&&gb(1,this.lMa,null);this.LQa=Ba}o8(){}Xb(){this.ga.fb(Ec.a.aog,kc.a.view,this.xlo,96);this.ga.qa(Ec.a.b0a,kc.a.view,this.b0a);this.ga.qa(Ec.a.Oxc,
kc.a.view,this.Nxc);this.ga.qa(Ec.a.Xyb,kc.a.view,this.Nxc);this.ga.qa(vb.a.yCf,kc.a.view,this.find);this.ga.qa(Za.a.fic,kc.a.view,this.fic);this.ga.qa(vb.a.xCf,kc.a.view,this.soi);this.ga.fb(Za.a.Yko,kc.a.view,this.yid,97);this.ga.qa(vb.a.abg,kc.a.view,this.v9l);this.ga.qa(vb.a.dlg,kc.a.view,this.H9l);this.ga.fb(vb.a.Ang,kc.a.view,this.Ang,97);this.ga.fb(vb.a.Lng,kc.a.view,this.Lng,97);this.ga.qa(Ec.a.B9d,kc.a.view,this.B9d);this.ga.qa(vb.a.eec,kc.a.view,this.nUd);this.ga.qa(Za.a.gIa,kc.a.view,this.gIa);
this.ga.qa(Za.a.N2h,kc.a.application,this.gIa);this.ga.qa(Ec.a.JVc,kc.a.view,this.JVc);this.ga.qa(Za.a.tCf,kc.a.view,this.uEe);this.ga.qa(Za.a.NCf,kc.a.view,this.uEe);this.ga.fb(Za.a.$qe,kc.a.view,this.$qe,97);this.ga.fb(Za.a.bre,kc.a.view,this.bre,97);this.ga.fb(Ec.a.jng,kc.a.view,this.jng,97);this.ga.fb(Ec.a.zuc,kc.a.view,this.zuc,97);this.ga.fb(Ec.a.kng,kc.a.view,this.kng,97);this.ga.fb(Ec.a.mng,kc.a.view,this.mng,97);this.ga.fb(Ec.a.lng,kc.a.view,this.Swj,97);Object(Un.b)()&&this.ga.fb(Ec.a.are,
kc.a.view,this.are,96);this.Zph&&(this.ga.fb(Ec.a.Yyb,kc.a.view,this.Nxc,1028),this.ga.fb(Ec.a.Sid,kc.a.view,this.Swj,97),this.ga.fb(Ec.a.replace,kc.a.view,this.replace,1028),this.ga.fb(Ec.a.replaceAll,kc.a.view,this.replaceAll,1028),y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.fb(Za.a.FCf,kc.a.view,this.s8l,1028));this.ga.qa(Ec.a.Rxc,kc.a.view,this.Nxc)}Kpg(){this.LQa&&
this.LQa.execute(b=>{b.dY(new Xv)})}NUj(b,h,r,A,L,Z){if(1===A)return cc.SessionStatusManager.instance.WA?32:8;if(void 0===Z||null===Z)return 8;this.Nxc(b,r,2,L,Z);b=this.kp;b.Xxg(Z.CommandValueId);Object(Un.b)()&&("MatchCase"in Z&&(b.matchCase=Z.MatchCase),"MatchWholeWord"in Z&&(b.matchWholeWord=Z.MatchWholeWord));return this.soi(h,r,A,L,Z)}ODg(b){if(void 0===b||null===b||!b.length)return 32;b=oA.a.createQuery(b,this.clo);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),
8;this.yC.find(b);return 32}get clo(){let b=ft.a.none;this.kp.matchCase&&(b|=ft.a.matchCase);this.kp.matchWholeWord&&(b|=ft.a.hNg);return b}EKi(b){this.kp.Vfc!==tx.a.headings&&this.kp.y5&&(b?this.yC.Hld.lTm():this.yC.Hld.GKi())}Fmf(b){this.kp.eI&&(this.kp.oLa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.yC.k6a(),this.kp.Y$(b))}Jgn(b){return this.kp.eI===et.a.nvc||b&&!this.kp.eI?8:32}lMf(b){return String.format(b,this.kp.Ryd,this.kp.y5)}r_f(){return this.kp.n4c()&&
0<this.kp.y5}lrn(){return this.r_f()&&this.kp.oLa}static O2j(){null!=y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Yv.Eza)}static Gsm(b,h,r,A){return new Yv(y.AFrameworkApplication.va,b,h,r,A,Sg.FocusManager.instance(),ab.StaticActiveAppFrame.za().Vr,Wa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),
Object(D.a)(y.AFrameworkApplication.ua.uS,y.AFrameworkApplication.ua.uS.ub,"registerHandler"))}static cpp(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)||window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("FindReplaceExperienceSurvey",null)})},Yv.Eza)}static Fsm(b,h,r,A){return Yv.Gsm(b,h,r,A)}}Yv.Eza=5E3;Object(u.a)(Yv,"FindReplaceActor",
null,[]);var rD=d(923),ZH=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.yM},set:function(h){this.yM=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.V2a},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,rH:this.V2a,next:void 0,data:r};
this.first||(this.first=r);this.V2a&&(this.V2a.next=r);this.V2a=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,A){h=this._map.get(h);if(!h)return!1;A={key:r,rH:h,next:h.next,data:A};var L=h.next;L&&(L.rH=A);h.next=A;this._map.set(r,A);return!0};b.prototype.insertBefore=function(h,r,A){h=this._map.get(h);if(!h)return!1;A={key:r,rH:h.rH,next:h,data:A};var L=h.rH;L&&(L.next=A);h.rH=A;this._map.set(r,A);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&
(this.first=r.next),this.V2a===r&&(this.V2a=r.rH),r.rH&&(r.rH.next=r.next),r.next&&(r.next.rH=r.rH),this._map.delete(h))};return b}();class $H{constructor(){this.type="heading"}}Object(u.a)($H,"NavPaneHeadingItem",null,[]);class pA{constructor(){this.type="bookmark"}}Object(u.a)(pA,"NavPaneBookmarkItem",null,[]);class sD{constructor(b,h,r,A,L,Z,oa){var Ba;this.hb=b;this.ib=h;this.Zb=r;this.Ep=A;this.zP=L;this.tJ=Z;this.oyk=oa;this.X3a=0;this.yHd=new Map;this.Nkh=!1;this.$Ea=new Map;this.tDd=null===
(Ba=y.AFrameworkApplication.J)||void 0===Ba?void 0:Ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",!1)}get headingsReady(){return this.Nkh}set headingsReady(b){this.Nkh=b}get gYb(){return this.X3a}get O3(){this.F3a&&0!=this.F3a.length()||(this.F3a=this.$fo());return this.F3a}set O3(b){this.F3a=b}get h_b(){return this.nMk}set h_b(b){this.h_b&&(this.h_b.isSelected=!1);b.isSelected=!0;this.nMk=b}MKf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}$fo(){const b=
new ZH;if(!this.zP)return b;this.yHd=new Map;let h;const r=[];for(const A of this.zP.paragraphs()){const L=this.XBi(A,r);null===L||void 0===L?void 0:L.forEach(Z=>{(h=this.HDi(Z,r))&&"heading"===h.type&&h.indentLevel<Z.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,Z.isHidden=!1):(h.isCollapsed=!0,Z.isHidden=!0));b.insert(this.MKf(Z,A),Z)})}return b}HDi(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}NKg(b){var h,r,A;let L=Cd.ParagraphReader.zAa(b),Z=
!1;9===L&&this.$Ea.has(b.id.toString())&&(L=this.$Ea.get(b.id.toString()),Z=!0);y.AFrameworkApplication.$c("InitialHeadingsInNavPaneFix-tf;InitialHeadingsInNavPaneFix-cf");const oa=this.tDd?null===(r=null===(h=this.F3a)||void 0===h?void 0:h.get(b.id.toString()))||void 0===r?void 0:r.data:null===(A=this.O3.get(b.id.toString()))||void 0===A?void 0:A.data;if(oa){if(oa.indentLevel===L){h=On.AParagraphNode.KP(b.characterData.trim());r=this.Ep.value.eig(b);this.tDd&&this.uYi(b)&&this.fei(b);if(h!==oa.text||
oa.hasBookmark!==r)return oa.text=h,oa.hasBookmark=r,!0;!Z&&oa.isPurelyADH&&(oa.isPurelyADH=!1,--this.X3a);return!1}this.Dhd();return!0}if(9===L)return this.lfn(b)?(this.Dhd(),!0):!1;this.Dhd();return!0}lfn(b){var h;const r=this.Ep.value.pGf(b);b=null!==(h=this.yHd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=0;h<b;++h)if(!this.O3.get(r[h].uqb()))return!0;return!1}fei(b){var h;if((this.tDd?null===(h=this.F3a)||void 0===h?0:h.get(b.id.toString()):this.O3.get(b.id.toString()))||
this.Ep.value.eig(b))return this.Dhd(),!0;this.$Ea.has(b.id.toString())&&(this.$Ea.delete(b.id.toString()),--this.X3a);return!1}Dhd(){const b=new ZH;this.X3a=0;if(this.zP){this.yHd=new Map;var h=[],r,A;for(const L of this.zP.paragraphs()){const Z=this.XBi(L,h);null===Z||void 0===Z?void 0:Z.forEach(oa=>{var Ba=this.MKf(oa,L);A=this.HDi(oa,h);this.HIo(Ba,oa,A);b.insert(Ba,oa);"heading"===(null===r||void 0===r?void 0:r.type)&&(Ba=r,Ba.indentLevel>=oa.indentLevel&&(Ba.isCollapsed=void 0));r=oa})}this.tDd?
this.F3a=b:this.O3=b}else this.O3=b}HIo(b,h,r){var A,L;if(b=null===(A=this.F3a.get(b))||void 0===A?void 0:A.data)b.isSelected&&(h.isSelected=!0,this.h_b=h),h.isHidden=b.isHidden;if(r){if(A=null===(L=this.F3a.get(this.MKf(r,r.paragraphNode)))||void 0===L?void 0:L.data)r.isCollapsed=A.isCollapsed;r.isCollapsed?h.isHidden=!0:r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}XBi(b,h){var r=Cd.ParagraphReader.zAa(b),A=!this.uYi(b);const L=this.wln(r)&&A?!0:!1;A=this.$Ea.has(b.id.toString())&&
A;const Z=[];if(L)Z.push(this.g$h(b,r,!1,h));else if(A)this.X3a+=1,this.Q_c&&(r=this.$Ea.get(b.id.toString()),Z.push(this.g$h(b,r,!0,h)));else{let oa=0;this.Ep.value.pGf(b).forEach(Ba=>{const gb=new pA;gb.text=Ba.uqb();gb.isSelected=!1;gb.bookmarkManager=this.Ep;gb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;oa+=1;Z.push(gb)});this.yHd.set(b.id.toString(),oa)}return Z}g$h(b,h,r,A){var L,Z;const oa=new $H;oa.text=On.AParagraphNode.KP(b.characterData.trim());oa.indentLevel=h;oa.paragraphNode=
b;oa.isSelected=!1;oa.isPurelyADH=r;oa.listMarker=this.cLf(b);oa.hasBookmark=this.Ep.value.eig(b);for(b=null===(L=A[A.length-1])||void 0===L?void 0:L.indentLevel;b&&b>=h;)A.pop(),b=null===(Z=A[A.length-1])||void 0===Z?void 0:Z.indentLevel;(!b||b<h)&&A.push(oa);return oa}uYi(b){return this.hb.Wb(b)&&0===this.hb.textLength(b,9)}prm(b){for(b=this.zP.skc(b);b;){let h=this.O3.get(b.node.id.toString());for(;h;){const r=h.data;if("heading"===r.type&&!r.isHidden)return r;h=h.rH}b=b.rH}}s4l(b){(b=this.O3.get(b))&&
(1==b.data.isCollapsed?this.ZUj(b):this.M0m(b))}onClickHeading(b){var h;this.h_b=b=null===(h=this.O3.get(b))||void 0===h?void 0:h.data;h=qc.SelectionFactory.ue(b.paragraphNode,0);this.ib.Kc(h);this.Zb.Gg(Qf.AFrame.Do)}onClickBookmark(b){var h;this.h_b=b=null===(h=this.O3.get(b))||void 0===h?void 0:h.data;this.Ep.value.hTm(b.text);this.Zb.Gg(Qf.AFrame.Do)}uOi(b){var h,r;if(b=null===(r=null===(h=b.entries())||void 0===h?void 0:h.next())||void 0===r?void 0:r.value)if(h=this.prm(b[0]))this.h_b=h}onShareHeadingClick(b){var h;
me.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.O3.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Vc.a.ed),this.oyk.value.h$h(h)}YJg(b,h){const r=b.id.toString(),A=this.$Ea.has(r);if(!A||this.$Ea.get(r)!==h){this.$Ea.set(r,h);if(this.Q_c)return this.NKg(b);A||this.O3.get(r)||(this.X3a+=1)}return!1}jQl(b){const h=b.id.toString(),r=this.$Ea.has(h);if(r){this.$Ea.delete(h);if(this.Q_c)return this.NKg(b);r&&!this.O3.get(h)&&--this.X3a}return!1}omp(b){this.Q_c=b;this.Dhd()}xKg(b){var h;
const r=null===(h=this.O3.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.cLf(b);if(r.listMarker===b)return!1;this.ivp();return!0}MZd(b){var h;b=null===(h=this.O3.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}ZUj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.wap(r):
this.ZUj(r));return b}M0m(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!0}wap(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}wln(b){return 0<=b&&8>=b}ivp(){let b=this.O3.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.cLf(h.paragraphNode)}b=b.next}}cLf(b){var h;if(b.hE instanceof rD.a)return this.XQm(null===(h=this.tJ.HXa(b.hE))||void 0===h?void 0:h.FU)}XQm(b){for(let h=
0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(u.a)(sD,"NavPaneHeadingsManager",null,[]);var tD=d(1542);class iy{constructor(){this.OHb=this.yC=this.yHc=this.aBd=this.Z=null}get name(){return"WordEditor.FindReplace"}wc(b){var h;this.Z=b;y.AFrameworkApplication.$c("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",
!1))&&mF.a.initialize(b.Ta("Common.IDynamicScriptLoaderProvider"),b.Ta("Common.IZoomManager"),b.Ta("WordEditor.IMainViewModeManager"),"WACViewPanelContainer");const r=new sD(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),Sg.FocusManager.instance(),b.nf("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.nf("WordEditor.Actors.HeadingsActor"));this.Z.ia("WordEditor.FindReplace.NavPaneHeadingsManager",()=>r).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){iy.rc.er.continueWith(()=>
{this.Ho()})}Ho(){if(ed.a.tNg){const b=ed.a.hGe;this.yHc=qD.FindReplaceUIManager.getInstance(b);this.yC=pD.a.createInstance(this.yHc,Ls.a.instance,tD.a.instance,!0);this.OHb=this.yC.oZb;this.aBd=Yv.Fsm(this.yHc,this.yC,this.OHb,b);this.aBd.Xb();this.aBd.o8();this.aBd.Kpg();ab.StaticActiveAppFrame.za().Ge()}}dispose(){this.yHc&&this.yHc.dispose()}static get rc(){return null!=iy.PUg?iy.PUg:iy.PUg=Wa.a.instance.resolve("Box4.IFeatureHelper")}}Object(u.a)(iy,"FindReplacePackageManager",null,[0,1]);class RB{constructor(){}VEf(){return"_@_"+
eb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}$xp(b,h,r,A){h.tSo(b,A);h.Cl(b,Ke.a.Mca,!0);h.Cl(b,Vc.a.lXa,!0);h.Cl(b,Vc.a.C2,RB.ini(r));h.Cl(b,Vc.a.jt,15)}A3k(b,h,r,A){const L=b.UXd(A);h.Cl(L,Ke.a.Mca,!0);h.Cl(L,Vc.a.jt,47);h.Cl(L,Vc.a.C2,RB.ini(r));b=b.UXd(A);h.Cl(b,Ke.a.Mca,!0);h.Cl(b,Vc.a.jt,16);return[L.Hk,b.Hk]}Zem(b,h,r){b=b.UXd(r);h.Cl(b,Ke.a.Mca,!0);h.Cl(b,Vc.a.STb,!0);return b.Hk}static ini(b){return String.format(' HYPERLINK "{0}"',b)}}Object(u.a)(RB,"AtMentionHyperlinkConfigurator",
null,[380]);var Zv=d(1560);class SB{constructor(b,h,r){this.Xia=b;this.ib=h;this.zMi=this.XUi=this.FWe=!1;this.GWb=this.GWb.bind(this);this.HWb=this.HWb.bind(this);this.OWb=this.OWb.bind(this);r&&r.execute(A=>{this.A1a=A});qo.a.MSd.LHf.then(A=>{this.zMi=!0;this.XUi=A.isSuccess})}ete(){this.Xia.Wpg(this.GWb);this.Xia.Xpg(this.HWb);this.Xia.gqg(this.OWb)}Oee(){return!1}GWb(b,h,r){var A,L;h=Date.now();if(this.A1a)if(this.zMi&&!this.XUi)v.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");
else{var Z=null===(L=null===(A=this.ib.gb)||void 0===A?void 0:A.currentSelection)||void 0===L?void 0:L.Xc;Z?(A=Z.node,Cd.ParagraphReader.Wb(A)?(L=Cd.ParagraphReader.text(A),0>r||r>L.length?v.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the prefix was not within the bounds of the paragraph."):1<b.length&&("@"===b.trimEnd()||Zv.a.Uud&&"/"===b.trimEnd())?(me.c(Ec.a.GAl,!0,void 0,void 0,void 0,void 0),this.Xia.reset()):(this.FWe?this.A1a.zyp():(this.FWe=
!0,this.A1a.q$o(Z)),this.A1a.fKg(r,r+b.length),b=L.substring(0,r)+b,this.A1a.nFf(A,b,r,h))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}HWb(b){if(this.A1a)this.A1a.onKeyDown(b)}OWb(){this.FWe=
!1;this.A1a&&this.A1a.x3h()}}Object(u.a)(SB,"ContextIQUserInitHandler",null,[378]);class vv{constructor(){this.mB=null}get name(){return"WordEditor.AtMentions"}wc(b){this.Z=b;b.ia("Box4.IAtMentionHyperlinkConfigurator",()=>new RB(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:vv.Zdk,featureName:vv.Efk,topLevelKpiName:vv.Ijk,vetoPillar:7};b.ia("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Mo.a(xa.Health.instance,new Mn.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>
{this.Ho()})}dispose(){}Ho(){this.Z.Ta("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{y.AFrameworkApplication.J.$("ConsumerMentionsHostIsEnabled")&&(h=h&&y.AFrameworkApplication.J.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||Zv.a.Vud())&&this.CBn()})});this.Z.resolve("Box4.IAtMentionHyperlinkConfigurator")}CBn(){(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.Z.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("canvasAtMentions")).then(()=>
{y.AFrameworkApplication.J.vp(()=>{this.muo()})})}muo(){const b={peopleAPI:this.Z.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:y.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.jun()};this.mB=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.Z.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&Zv.a.Wud()||
!r&&Zv.a.Vud()?(Zv.a.MWf=!r,this.Z.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new SB(this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.Z.resolve("Box4.ISelectionManager"),this.Z.Ta("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):this.Z.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new iF(this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.mB,this.Z.resolve("Box4.ITextMetricsAdapter"),this.Z.resolve("Box4.ICaretPositionManager"),this.Z.resolve("Box4.ISelectionManager"),
Object(Kb.a)(),this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.Z.resolve("Common.Utils.IAriaNotifier"),this.Z.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();this.Z.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").ete()})})}jun(){var b,h;const r=null!==(b=y.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==
(h=y.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===vv.Cdk&&b===vv.Bdk}}vv.Cdk="-4";vv.Bdk="DC2";vv.Zdk="webasynccollabeng";vv.Efk="AtMentions";vv.Ijk="AtMentionsFeatureUsage";Object(u.a)(vv,"PackageManager",null,[0,1]);var Yq=d(1715);class uD{constructor(b,h,r,A){this.ga=b;this.Re=h;this._augLoopRuntimeManager=r;this.VSk=A;this.cya=0;this.UPd=this.aac=!1;this.gah=this.HBh=this.O_e=this.IBh=0;this.JCb=null;this.cuk=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",
!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0],["Rewrite",!0]]);this.Psk=[{id:`${yr.juc}_${1}`},{id:`${yr.juc}_${2}`},{id:`${yr.juc}_${3}`},{id:mp.a.gZd},{id:mp.a.DXd},{id:mp.a.Ogd},{id:mp.a.Mgd}];this.Wmk=[{id:"OpenCopilotComposeDraftContent"},{id:"OpenCopilotComposeRewrite"},{id:"OpenCopilotComposeVisualizeAsTable"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},
{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"Sort"},{id:"ResetPictureEdits"},{id:"ReviewDesignerSuggestion"}];this.Sxd=new Map;this.knh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.LEk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.dqk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Re.ub(this,Yq.SearchSuggestionAnnotation.getTypeName());
(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"))&&this.Sxd.set("InsertLink","InsertLinkFlyout");this.Sxd.set("GraphicsEditor","");this.Z5j();this.Xb(this.ga)}jio(b,h){if(this.knh){var r=Date.now();this.O_e&&1250>r-this.O_e||this.RGb||(this.O_e=r,this.JCb=b,this.NMd=this.ULm(h),this.zHo(),this.VFo())}}gH(b,h){if(b.annotationType===Yq.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===tt.a.getTypeName()&&(h=Date.now(),b=b.content,this.RGb&&
this.RGb===b.correlationId)){window.clearTimeout(this.cya);this.RGb=void 0;var r=this.aac,A=this.Yzm(b),L=A&&0<A.length;L&&(this.mzp(A),this.UPd&&(r=!1));r&&this.zEj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.HBh,["canvasContextRetrievalTime"]:this.gah,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.IBh,["containsZTM"]:L,["shouldFallBack"]:this.aac,
["fallBack"]:r};v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}Yzm(b){const h=this.pNf(b.intentSuggestions,Yq.IntentIds.ZeroTermMenu,Yq.ObjectSemantic.GenericSuggestions,Yq.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}pNf(b,h,r,A){return Array.isArray(b)?b.filter(L=>L.intent===h&&L.result.semantic===r&&L.result.type===A).map(L=>L.result.value):[]}Xb(b){b.fb(Za.a.L9i,kc.a.application,this.WFo.bind(this),96)}ULm(b){const h=[],r=new Map,A=Date.now();for(const L of b){if(!L)continue;
b=[];const Z={itemsMetadata:new Ha.a};for(let oa=0;oa<L.ControlList.length;oa++){const Ba=L.ControlList[oa];if(Ba&&!Ba.ExternalId)continue;b.push(Ba.ExternalId);const gb={timeStamp:A,source:"FallbackZeroTermMenu",confidenceScore:-1};Z.itemsMetadata[Ba.ExternalId]=gb;r.set(Ba.ExternalId,gb)}h.push(appChrome.api.menuSection(b,L.Title,L.Lang,L.Id,Z))}return{sections:h,commands:r}}t2j(b){return this.Sxd.has(b)?this.Sxd.get(b):b}SOa(b){const h={};for(const r of b)b=this.t2j(r.suggestion),appChrome.selectors.isControlDefined(b)&&
(h[b]=appChrome.selectors.getModelType(b));ab.StaticActiveAppFrame.za().X3d(h)}$gn(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.cuk.has(b)?this.NMd.commands.has(b):!0}nbi(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.JCb})}hqb(b=!1){b=b?wo.a.instance.vHc:wo.a.instance.hqb();const h=[],r=Date.now();for(const A of b)A.commandId&&h.push({Id:A.commandId,TimeElapsedSinceClick:(r-A.timeStamp)/
1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.az});return h}l2c(){const b=wo.a.instance.l2c(),h=[],r=Date.now();for(const A of b)A.controlId&&h.push({Id:A.controlId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.az});return h}FGf(){const b={semantic:Yq.ObjectSemantic.CanvasContext,type:Yq.ObjectSchemaType.WordCanvasContext,value:{contentType:this.JCb}};if(this.dqk){const h=Date.now(),r=this.VSk.FGf(If.a.instance.gb.currentSelection);
r&&r.value.contentType&&(b.value=r.value);this.gah=Date.now()-h}return b}Ovi(){const b=this.l2c(),h=this.hqb(),r=this.hqb(!0),A=[];A.push({semantic:Yq.ObjectSemantic.ControlIdHistory,type:Yq.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Yq.SequenceType.ControlId,Sequence:b}});A.push({semantic:Yq.ObjectSemantic.CommandIdHistory,type:Yq.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Yq.SequenceType.CommandId,Sequence:h}});A.push({semantic:Yq.ObjectSemantic.FilteredCommandIdHistory,
type:Yq.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Yq.SequenceType.CommandId,Sequence:r}});A.push(this.FGf());return A}Z5j(){this._augLoopRuntimeManager.getSession().then(b=>this.Lwd=b).catch(()=>{this.Lwd=void 0})}VFo(){const b=Date.now(),h=this.Ovi(),r=[Yq.IntentIds.ZeroTermMenu,Yq.IntentIds.Logging];this.HBh=Date.now()-b;this.RYj(r,h,"ContextualMenu")}WFo(b,h,r){2===r&&(b=this.Ovi(),this.RYj([Yq.IntentIds.Logging],b,"Floatie"));return 32}RYj(b,h,r){if(0===b.length||0===h.length)v.ULS.sendTraceTag(556892510,
1303,15,"No search suggestion al workflow will be activated");else{var A=new Yq.SearchSuggestionSignal({correlationId:this.x2c("ACM"),intents:b,contextObjects:h,entryPoint:r});this.aac=0<=b.indexOf(Yq.IntentIds.ZeroTermMenu);this.IBh=Date.now();this.RGb=A.correlationId;this.cya=window.setTimeout(()=>{this.a3n(A.correlationId)},750);h=new tt.m({parentPath:["Signal",Yq.SearchSuggestionSignal.getTypeName()],items:[{id:eb.a.create().toString(),body:A}]});this.Lwd&&!this.Lwd.isClosed?this.Lwd.submitOperation(h):
(this._augLoopRuntimeManager.submitOperation({operation:h}),this.Z5j());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:A.correlationId,["shouldFallBack"]:this.aac,["intents"]:b}))}}x2c(b){const h=eb.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}a3n(b){this.RGb&&this.RGb===b&&(this.RGb=void 0,this.aac&&this.zEj(),v.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",
["correlationId"]:b,["shouldFallBack"]:this.aac})))}zEj(){const b=this.nbi(this.NMd.sections);appChrome.api.dispatch(b);this.i5h()}i5h(){this.UPd=!0}zzo(b){var h,r;const A=[],L=new Map;if(!b||0===b.length)return A;for(const Z of b){if(!Z||!Z.controlIds||0===Z.controlIds.length)continue;b={controlIds:[],id:Z.id,title:Z.title,lang:Z.lang,data:{itemsMetadata:new Ha.a}};const oa="CommandsZTM"===Z.id;for(const Ba of Z.controlIds){if(L.has(Ba))continue;if(oa&&b.controlIds.length>=this.LEk)break;const gb=
null===(r=null===(h=Z.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Ba];L.set(Ba,gb);b.controlIds.push(Ba);gb&&(b.data.itemsMetadata[Ba]=gb)}0<b.controlIds.length&&A.push(b)}return A}zHo(){this.UPd=!1;if(this.knh){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}mzp(b){this.UPd||(b=this.Qfm(b),0<b.length&&appChrome.api.dispatch(b))}Qfm(b){const h=[];let r=
[];var A=this.uFm();A&&0<A.length&&r.push(...A);(A=this.Qem())&&r.push(A);Array.isArray(b)&&0<b.length&&(b=this.rza(b))&&(b.id="CommandsZTM",r.push(b));(b=this.Fem())&&r.push(b);r=this.zzo(r);if(0===r.length)return[];h.push(this.nbi(r));this.i5h();return h}uFm(){var b,h;const r=null===(b=this.NMd)||void 0===b?void 0:b.sections.filter(A=>{var L;return null===(L=A.id)||void 0===L?void 0:L.startsWith(yr.rii)});for(const A of r)if(null===(h=A.data)||void 0===h?0:h.itemsMetadata)for(const L in A.data.itemsMetadata)A.data.itemsMetadata[L].source=
"PassThroughZeroTermMenu";return r}Qem(){const b=this.Hri(this.Psk,"DefaultZeroTermMenu");return this.rza(b)}Fem(){const b=this.Hri(this.Wmk,"AdvertizedZeroTermMenu");return this.rza(b)}Hri(b,h){const r=[];for(const A of b)A&&this.A5o(A)&&this.NMd.commands.has(A.id)&&r.push({suggestion:A.id,rankingScore:-1,suggestionSource:h});return r}A5o(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}rza(b){const h=[],r={itemsMetadata:new Ha.a},A=
Date.now();this.SOa(b);for(const L of b)b=this.t2j(L.suggestion),this.$gn(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:A,source:L.suggestionSource,confidenceScore:L.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}}Object(u.a)(uD,"AugLoopSearchSuggestionManager",null,[114,346]);class Zt{constructor(){this.Z=null}get name(){return"WordEditor.ContextualSearch"}wc(b){this.Z=b;this.Z.ia("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new uD(y.AFrameworkApplication.va,
this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.Z.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>{qo.a.im().then(()=>{this.start()})})}start(){this.Z.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){E.a.instance.Mc(new Zt)}}Object(u.a)(Zt,"PackageManager",
null,[0,1]);var xL=d(454),$v=d(958);class nF extends $v.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(u.a)(nF,"BootMessage",$v.a,[]);var oF=d(1061);class aI{constructor(){this.vO=null;this.F0n=b=>{if(b.target===this.vO)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=H.a(b.data);this.SAe(h.api)?this.ywd.K(h.api).mje(h.method,h):v.ULS.sendTraceTag(50739144,
3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.ywd=new yc.a}g1f(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(b,h){let r=!1;try{this.vO=new Worker(b);this.vO.onmessage=this.F0n;const A=Object.assign(new nF,{api:0,method:0,scripts:h,documentUrl:document.URL});
this.postMessage(A);this.g1f()&&oF.a.Clk(this.vO);r=!0}catch(A){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",A)}return r}postMessage(b){try{const h=H.c(b);this.vO.postMessage(h)}catch(h){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}SAe(b){return this.ywd.tb(b)}HUk(b,h){this.SAe(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
b);this.ywd.W(b,h)}kim(b){return this.SAe(b)?this.ywd.K(b):null}}Object(u.a)(aI,"WebWorker",null,[1524]);class pF{constructor(){this.LNg=[]}MLl(b,h){if(h){var r=y.AFrameworkApplication.mC(b.SJj,7),A=[];for(let L=0;L<b.$0b.length;L++){let Z;switch(b.$0b[L].format){case 5:case 6:Z=xL.a.OQb(b.$0b[L].name);break;default:Z=b.$0b[L].name}A.push(y.AFrameworkApplication.mC(Z,b.$0b[L].format))}try{const L=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),Z=new aI;if(Z.create(L,
A))for(this.LNg.push(Z),r=0;r<b.RAe.length;r++){const oa=h.SDl(Z,b.RAe[r]);oa&&Z.HUk(b.RAe[r],oa)}}catch(L){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",L.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(u.a)(pF,"WebWorkerCollection",null,[]);class vD{constructor(b,h){this.tcf=new pF;if(b){b=b.create();for(let r=0;r<b.length;r++)this.tcf.MLl(b[r],h)}else v.ULS.sendTraceTag(50442779,3007,
10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let A=!1;for(let Z=0;Z<this.tcf.LNg.length;Z++){var L=this.tcf.LNg[Z];L.SAe(b)&&((L=L.kim(b))?A=L.callMethod(h,r)||A:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}A||v.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(u.a)(vD,
"WebWorkerRouter",null,[1523]);class hK extends $v.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(u.a)(hK,"SettingsMessage",$v.a,[]);class jy{constructor(b){this.vO=b}}Object(u.a)(jy,"WebWorkerApiMain",null,[]);class wD extends jy{constructor(b){super(b)}g1f(){return!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.Kkl(h);v.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}mje(b,h){switch(b){case 14:this.dWm(h);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",
b)}}Kkl(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new hK,{api:0,method:1,
appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:y.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Cm.a.instance.WF,LocalCobaltMachineId:Cm.a.instance.tma,LocalCobaltClusterId:Cm.a.instance.Fta,LocalCobaltSessionHasBackup:Cm.a.instance.Gta,WaciiEnabledRequests:Cm.a.instance.hoa,SettingsRoutedToServer:Cm.a.instance.Rzg,WacClusterId:y.AFrameworkApplication.Fe.T0});this.vO.postMessage(b);return!0}dWm(b){this.g1f()&&b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),
this.zDp())}async zDp(){try{const b=await new oF.a.Dlk.WorkerUtilsTestClass(10);await b.Xh(5);15==await b.counter?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(u.a)(wD,"InitializeWorkerApiMain",jy,[]);class TB extends $v.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=
null;this.appMode=hp.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(u.a)(TB,"CatchUpNetworkRequestWorkerRequestMessage",$v.a,[]);class iK extends jy{constructor(b,h){super(b);this.OUc=h}callMethod(b,h){if(4===b)return b=Object.assign(new TB,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.vO.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}mje(b,
h){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.OUc.QSo(h);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(u.a)(iK,"CatchUpNetworkRequestWorkerExternalApi",jy,[]);class ux extends $v.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(u.a)(ux,
"LocalInferenceMessage",$v.a,[]);class jK{constructor(){this.prediction=this.context=null}}Object(u.a)(jK,"LocalInferenceOutput",null,[]);class ak{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(u.a)(ak,"TextPredictionConfig",null,[]);class to{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(u.a)(to,"TextPredictionSettings",null,[]);class wv{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(u.a)(wv,"TextPredictionDynamicPayload",
null,[]);class xD extends jy{constructor(b,h){super(b);this.aTk=h}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.Qkl(h);case 7:return this.Lkl(h);case 9:return this.Pkl(h);case 10:return this.Mkl(h);case 13:return this.Nkl(h);case 14:return this.Okl(h);default:return v.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}mje(b,h){switch(b){case 9:this.hXm(h);break;default:v.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}hXm(b){b&&b.prediction&&(b=Object.assign(new jK,{prediction:b.prediction,context:b.context}),this.aTk.WUh().vio(b))}Lkl(b){if(1>b.length)return v.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ux,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.vO.postMessage(b);return!0}Qkl(b){if(1>b.length)return v.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ux,{api:4,method:8,paragraphContent:b});this.vO.postMessage(b);
return!0}Pkl(b){if(2>b.length)return v.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new ux,{api:4,method:9,paragraphContent:b,context:h});this.vO.postMessage(h);return!0}Mkl(b){if(1>b.length)return v.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ux,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.vO.postMessage(b);return!0}Nkl(b){if(1>b.length)return v.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ux,{api:4,method:13,textPredictionConfig:this.Ywi(b)});this.vO.postMessage(b);return!0}Okl(b){if(1>
b.length)return v.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Gb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new ux,{api:4,method:14,textPredictionConfig:this.Ywi(b)});this.vO.postMessage(b);return!0}getConfig(b=null){return Object.assign(new ak,{scriptDirectory:y.AFrameworkApplication.L8+"/intelligence/",settings:Object.assign(new to,{extendedRankLimit:0}),modelFilesUrl:b})}Ywi(b=
null){return Object.assign(new ak,{scriptDirectory:y.AFrameworkApplication.L8+"/intelligence/",settings:Object.assign(new to,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(u.a)(xD,"LocalInferenceWorkerApiMain",jy,[]);class Vg extends jy{constructor(b){super(b);y.AFrameworkApplication.fG(()=>{this.uWb()})}callMethod(b){v.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}mje(b){v.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}uWb(){const b=Object.assign(new $v.a,{api:3,method:6});this.vO.postMessage(b)}}Object(u.a)(Vg,"ShutdownWorkerApiMain",jy,[]);class bI{constructor(b){this.container=b}SDl(b,h){let r=null;switch(h){case 0:r=new wD(b);break;case 2:r=new iK(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:r=new Vg(b);break;case 4:r=new xD(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return r}}Object(u.a)(bI,"WordWebWorkerApiFactory",null,[347]);var kK=d(333);class yD{constructor(b,h){this.name=b;this.format=h}}Object(u.a)(yD,"ImportedScript",null,[]);class lK{constructor(){this.RAe=this.$0b=this.SJj=null}}Object(u.a)(lK,"WebWorkerConfig",null,[]);var Ud=d(1347);class ky{constructor(b){this.FGh=[];this.zBk=b;if(y.AFrameworkApplication.J){b=y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||
y.AFrameworkApplication.J.$("IsCombinedBundleEnabled");const r=y.AFrameworkApplication.J.jb("ContentBaseUrl")?6:5;var h=y.AFrameworkApplication.J.jb("AppScriptBaseName");const A=b?"":".";if(h){const L=b?"":"{0}";h+=`${A}${L}worker.js`;this.FGh.push(new yD(`MicrosoftAjax${b?"":"DS"}.${L}js`,r),new yD(h,r))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new lK,{SJj:"workerboot",$0b:this.FGh,RAe:[0,2,3,4]});this.zBk&&this.jjn()&&h.$0b.push(new yD("intelligence/edge-inference-web.js",5));b.push(h);return b}jjn(){return(new kK.a("arrowFunction",()=>{try{Object(Ud.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(u.a)(ky,"WordWebWorkerConfigFactory",null,[345]);class qF{constructor(){this.Aa=this.Z=null}get name(){return"WordEditor.Workers"}init(){const b=this.Z.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Aa.appSettings,y.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}wc(b){this.Z=b;this.Aa=this.Z.resolve("Common.IAppSettingsManager");const h=this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new vD(new ky(h),new bI(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){E.a.instance.Mc(new qF)}}Object(u.a)(qF,"WordEditorWorkersPackage",null,[0,1]);var rF=d(1149);class mK{constructor(){this.NKd=
[]}pFi(b,h){let r=-1,A=null;A=L=>{L?h(this.NKd[r]):(++r,r<this.NKd.length?this.NKd[r].bec(b,A):h(null))};A(!1)}bec(b,h){this.pFi(b,r=>{h(!!r)})}vvc(b,h,r){this.pFi(b,A=>{if(!A)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");A.vvc(b,h,r)})}$Nh(b){this.NKd.push(b)}}Object(u.a)(mK,"CompositeExternalContentURLResolver",null,[353,354]);var nK=d(1341);class qA extends nK.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(u.a)(qA,"ExternalContentEmbedResponse",nK.a,[]);var cI=d(1368),sF=d(769),dI=d(1134),eI=d(1261),rA=d(730),aw=d(520),vx=d(163),bw=d(884),xv;(function(b){b[b.Wif=0]="autoCorrect";b[b.Z4l=1]="externalComponentPaste";b[b.j5l=2]="externalHyperlinkPaste";b[b.r0p=3]="externalContentFloatieConversion"})(xv||(xv={}));Object(u.b)("ExternalContentConversionContext",xv);class Bh{constructor(){this.wUb=this.vUb=null;this.oBf=new eI.ExternalContentEmbedRetriever;
this.CPc=!0;this.kHc=this.ap=this.fPi=this.ePi=this.Fm=this.rt=null;this.dhd=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Itc=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=Bh.$ra&&Bh.$ra.Qvi()}get g0b(){return this.CPc}set g0b(b){this.CPc=b}qmf(b,h){let r=!1;if(b){switch(b.contextId){case kc.a.Vc:r=!h;break;case kc.a.Cd:r=!0}r&&!bw.a(b.node)&&(r=!1)}return r}Cvn(b){const h=b.startsWith(Ic.a.luc),
r=b.startsWith(Ic.a.iid),A=b.startsWith(Ic.a.Rqe);return(h||r||A)&&Ic.a.qXa(b)}ryj(){this.ap=Q.a.create();Bh.Gf.TMb(this.ap,4);Bh.Gf.n8(this.ap,0,Bh.Gf.Wo());this.pSb(this.vUb,3,this.wUb,!0)}sWa(b,h,r){this.ap=Q.a.create();Bh.Gf.TMb(this.ap,r?0:2);Bh.Gf.n8(this.ap,0,Bh.Gf.Wo());this.kHc();this.pSb(b,r?0:2,h)}npe(b,h){this.ap=Q.a.create();Bh.Gf.TMb(this.ap,1);Bh.Gf.n8(this.ap,0,Bh.Gf.Wo());this.pSb(b,1,h)}xbe(b,h,r,A){if(!b||!b.isConnected||!Id.a.Eq(b))return null;const L=new rA.a;L.setValue(cg.a.$lc,
r);L.setValue(cg.a.kWa,h);L.O6a=this.ePi;L.Fv=this.fPi;L.providerName=A;L.yab=1===r;L.creationTime=Date.now();hb.a.eb(b).Wf(L,2);this.Icd(L);return L}kAj(b){this.kHc=b}mIe(b,h){const r=Bh.m4.rgc(h)||0;h=Bh.m4.s7a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=h/A)}wPg(b,h,r){if(null!=b&&null!=h&&!F.a.Qf(r)){var A=Bh.sed.okc(r);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?A.kva=!1:A.kva=!0;A.hideFloatie=!0;this.mIe(b,h.node);this.Cmc(b,h,!1,!1,A,r)}}irb(b){return b?b.He:0}fMg(b,h,r){let A=null;const L=b.node;if(!Cd.ParagraphReader.Wb(L)||!L.isConnected)return{returnValue:!1,Ova:A};if(r)return{returnValue:!0,Ova:b};r=b.cpBegin;const Z=b.cpEnd,oa=Cd.ParagraphReader.text(L);if(0<=r&&Z<=oa.length&&oa.substring(r,Z)===h)return{returnValue:!0,Ova:b};const Ba=oa.indexOf(h);return 0<=Ba?(A=xc.a.createTextRange(L,Ba,Ba+h.length),{returnValue:!0,Ova:A}):0<=r&&Z<=oa.length&&
this.Clc(b)?{returnValue:!0,Ova:b}:{returnValue:!1,Ova:A}}Clc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=xc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Ic.a.Oz(h,!1);if(1===h.length){h=h[0];const r=Cd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}T0f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}ffb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&
window.setTimeout(()=>{const r=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");r&&r.execute(A=>{A.logActivity(b,h)})},Bh.Eza)}yIf(b,h){const r=!F.a.baa(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):
WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}pSb(b,h,r,A=!1){if(this.Cvn(r)){var L=Bh.sed.okc(r);if(L)if(this.T0f(L)){v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Ca.a)(xc.a,b);var Z=!h;this.qmf(b,Z)?this.g9c(r)?(h=1===h,A=this.xtm(b),L.hideFloatie=!0,this.Cmc(A,b,Z,h,L,r)):this.Lkg(b,h,L,r,A):Bh.Gf.hU(this.ap,2,"URL inserted in Non-Embedable context",Bh.Gf.Wo())}else v.ULS.sendTraceTag(577521882,
324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Bh.Gf.hU(this.ap,2,"Size provided is not valid for OEmbed",Bh.Gf.Wo())}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Bh.Gf.hU(this.ap,2,"URL inserted is not valid for ExternalContent",Bh.Gf.Wo())}xtm(b){const h=new qA;h.Width=Bh.m4.rgc(b.node)||0;h.Height=Bh.m4.s7a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}g9c(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=Bh.p3&&Bh.p3.p2i(b)}Lkg(b,h,r,A,L){const Z=!h,oa=1===h,Ba=Bh.m4.rgc(b.node)||0,gb=Bh.m4.s7a(b.node)||0,Ab=cI.a.lqf(r.zLg,!0,Ba,gb);this.dcd(b,A,h,!0);this.oBf.P0h(Ab,Jb=>{Bh.Gf.n8(this.ap,4,Bh.Gf.Wo());Bh.Gf.Gnd(this.ap,this.irb(Jb.data));if(Jb=this.Rkg(Jb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Tb=vx.q(Jb.MediaType);Bh.Gf.Sse(this.ap,7,Tb);Tb=b;({Ova:Tb}=this.fMg(b,A,oa)).returnValue?(this.dcd(Tb,
A,h,!1),null==r.width?0<Ba&&Jb.Width>Ba&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Jb.Width=Ba):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Jb.Width=this.Itd(r.width,Jb.Width,Ba)),null==r.height?0<gb&&Jb.Height>gb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),
Jb.Height=gb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Jb.Height=this.Itd(r.height,Jb.Height,gb)),Bh.$ra.ghb||L?this.Cmc(Jb,Tb,Z,oa,r,A):(this.vUb=b,this.wUb=A,this.rXc(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Bh.Gf.hU(this.ap,2,"No conversion as the context is no longer valid for the external content conversion",
Bh.Gf.Wo()));oa&&this.w6a(Tb.node)}else oa&&this.w6a(b.node),Bh.Gf.hU(this.ap,1,"URL not oEmbedable",Bh.Gf.Wo())},Jb=>{Bh.Gf.n8(this.ap,4,Bh.Gf.Wo());Bh.Gf.Gnd(this.ap,this.irb(Jb.data));oa&&this.w6a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl");Bh.Gf.hU(this.ap,2,"ExternalContentEmbedRequest failed",Bh.Gf.Wo())},Jb=>{oa&&this.w6a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Jb)},this.ap)}Itd(b,h,r){!b&&
0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&(h=b);return h}Cmc(b,h,r,A,L,Z){this.Fm=eb.a.create();b.Width=b.Width/b.Height*(b.Height-(aw.a.b6c+aw.a.r6))+2*aw.a.r6;const oa=new Sb.GraphTransaction(15);oa.Ab(h.node);oa.Ph=Ec.a.sWa;const Ba=this.Clc(h);null!=L.kva&&!L.kva||A||Ba||(b.Title=""===L.title||L.title?L.title:b.Title,!b.Title&&""!==b.Title)||(h=this.dVf(h,oa,b.Title,Z,r));if(h){A&&
(h=this.nvf(h));var gb=this.jYd(h,A);if(gb){r=vx.q(b.MediaType);var Ab=this.d8d(b,r);this.ePi=b.IFrameHtml;this.fPi=b.Title;if(gb=this.MUf(gb,Ab,oa,A,Z,r,b.ProviderName))oa.QLa(this.Fm,1),oa.dispose(),this.vUb=h,this.wUb=Z,this.nhg(L,b,gb),this.ykg(Z,A||L.hideFloatie,Ba,r,b.Title,b.ProviderName)}else oa.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Bh.Gf.hU(this.ap,2,"Could not create IP context on splitting the paragraph",
Bh.Gf.Wo())}else Bh.Gf.hU(this.ap,2,"GraphNodeContext is null",Bh.Gf.Wo())}d8d(b,h){const r=new lj.DictionaryPropertySet;Bh.HR.iqe(r,b.Width,b.Height);b=this.xIf(h,b.Title);r.setValue(Ke.a.imageAltText,b);r.setValue(Vc.a.oX,Sf.a.wD());r.setValue(Vc.a.imageType,kp.other);return r}MUf(b,h,r,A,L,Z,oa){if(!b)return null;b=Bh.HR.Cbe(b,h);if(!b)return r.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Bh.Gf.hU(this.ap,2,"The anchored image could not be inserted",
Bh.Gf.Wo()),null;r=b.node;L=this.xbe(r,L,Z,oa);Bh.Gf.CKg(this.ap,L.id);A||this.Oxg(r);return r}nhg(b,h,r){F.a.baa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Bh.Gf.n8(this.ap,8,Bh.Gf.Wo()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.E_d(r,h.Thumbnail))}ykg(b,h,r,A,L,Z){h||this.rXc(b);this.ffb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.soe("IsHyperlinkWithNonURLDisplayText",
r,Z);this.ariaNotify(A,L);Bh.Gf.n8(this.ap,5,Bh.Gf.Wo())}soe(b,h,r){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new da.a,{name:b,bool:h}),Object.assign(new da.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.g0b&&Bh.Iw&&(b=this.yIf(b,h),Bh.Iw.sendNotification(b,!0))}dVf(b,h,r,A,L){if(L){if((L=Ic.a.Oz(b,
!1))&&1!==L.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Bh.Op.fV(L[0].paragraph,L[0].hyperlink)}return this.vsg(b,r,A)}nvf(b){const h=b.node,r=Cd.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=xc.a.createTextRange(h,0,r.length),Bh.Cg.We(b,""),xc.a.Uc(h,0)):b}jYd(b,h){return h?b:this.wJf(b)}wJf(b){const h=Cd.ParagraphReader.text(b.node),r=hb.a.eb(b.node);if(r.Nd()){b=
xc.a.Uc(b.node,b.cpEnd);fg.OutlineElementNavigator.me(r);const A=Bh.Mf.Psa(r);Bh.Vh.Eca(r,A,b,!0,!0,!0,!0);""!=h&&Bh.Vh.yy(r,!1,!0);r.je();return xc.a.Uc(r.currentNode,0)}return null}Rkg(b){if(!({group:b}=hn.a.D4(b.data.Pe)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}vsg(b,h,r){const A=b.cpBegin+h.length;Bh.Cg.We(b,h);b=xc.a.createTextRange(b.node,b.cpBegin,A);Bh.Op.wF(b,r,!1);return b}xIf(b,h){const r=!F.a.baa(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}E_d(b,h){b.Hj().Ag.nE(()=>{this.Pkg(h,b)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Icd(b){b=hb.a.eb(b);b.zb(12);b.kd(12);b.Aq.RT=!0}w6a(b){b.Btc=null}Oxg(b){b=
hb.a.eb(b);b.zb(11)&&(b.kd(11),b.Nd()&&b.Tk()&&b.je()&&Cd.ParagraphReader.Wb(b.currentNode)&&(b=qc.SelectionFactory.ue(b.currentNode,0),If.a.instance.Kc(b)))}dcd(b,h,r,A){const L=b.cpBegin,Z=b.cpEnd;b=Cd.ParagraphReader.text(b.node).trim();L||b!==h&&""!==b?L?Z===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xv[r],A):0<L&&Z<b.length&&v.ULS.sendTraceTag(590958602,
324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xv[r],A):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xv[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xv[r],A)}rXc(b){this.ygc();const h=new Wx.a(1,y.AFrameworkApplication.isRtl);h.Pgd=b;Bh.wpb.qjd(h)}ygc(){const b=new gu.a(!0);Bh.Wba.$Ma(b)}Pkg(b,h){if(b=this.FLf(b,h))h=Array(1),h[0]=b,b=sF.a.construct(h,!1,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.rt.Bq:null),h=this.stf(),this.ayb(h,b)}FLf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.rt=h.Hj();(new hb.a).set(h);if(!h.anchor||
!h.anchor.Gr||!h.anchor.Gr.ht)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Gr.ht.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ka(Ge.a.ZJ,Cl.a.Gu);const A=h.getValue(Ke.a.VG),L=nh.a.xf(Id.a.FF(h.properties),0),Z=nh.a.xf(Id.a.rL(h.properties),1);return dI.a.construct(h.id.toString(),b,h.ka(Ke.a.imageAltText,
""),L,Z,h.ka(Vc.a.R_,""),r,h.ka(Vc.a.oX,0),h.ka(Vc.a.Zla,!1),h.ka(Ge.a.Mka,-1),h.ka(Vc.a.Mub,Box4Intl.Box4Strings.l_Picture),h.ka(Ke.a.FBa,!1),A,h.ka(Vc.a.runId,1),h.ka(Vc.a.ed,0))}ayb(b,h){y.AFrameworkApplication.Fe.Xj(b,2,H.c(h),{},!1,2,this.dhd,this.Itc,null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}stf(){let b=Ma.a.A1c("PicturePaste.ashx");const h=Ln.a.nWa;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&
(b=Ma.a.Jp(b,Wj.a.fileId,this.rt.Bq));b=Ma.a.Jp(b,Wj.a.cellId,this.rt.il.toString());this.Fm||(this.Fm=eb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Ma.a.Jp(b,Wj.a.h_,this.Fm.toString());b=Ma.a.Jp(b,Wj.a.classId,h.toString());this.rt.$G&&(b=Ma.a.Jp(b,Wj.a.$G,this.rt.$G));b=Ma.a.Jp(b,Wj.a.ZAb,"1");b=Ma.a.Jp(b,Ii.a.imageType,kp.other.toString());b=Cm.a.instance.Nef(b);b=Ma.a.Jp(b,Wj.a.Jya,this.rt.Ag.Pr.toString());b=Ma.a.Jp(b,
Wj.a.ytc,"0");return b=Ma.a.Jp(b,Wj.a.F2b,"1")}static get wpb(){return null!=Bh.yUg?Bh.yUg:Bh.yUg=Wa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get $ra(){Bh.MFa||(Bh.MFa=Wa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Bh.MFa}static get Wba(){return null!=Bh.r2g?Bh.r2g:Bh.r2g=Wa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Iw(){return null!=Bh.ZRg?Bh.ZRg:Bh.ZRg=Wa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get m4(){return null!=
Bh.O3g?Bh.O3g:Bh.O3g=Wa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get HR(){return null!=Bh.uXg?Bh.uXg:Bh.uXg=Wa.a.instance.resolve("WordEditor.IImageEditor")}static get Mf(){return Bh.Vh||(Bh.Vh=Wa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Op(){return null!=Bh.lXg?Bh.lXg:Bh.lXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Cg(){return null!=Bh.GSg?Bh.GSg:Bh.GSg=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Gf(){return null!=
Bh.HUg?Bh.HUg:Bh.HUg=Wa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get sed(){return null!=Bh.T0g?Bh.T0g:Bh.T0g=Wa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get p3(){return null!=Bh.K0g?Bh.K0g:Bh.K0g=Wa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}Bh.Vh=null;Bh.Eza=5E3;Bh.MFa=null;Object(u.a)(Bh,"ExternalContentEditor",null,[360]);var $y=d(264),UB=d(980);class VB{constructor(b,h){this.ghb=!0;this.Wbb=r=>{if(null!=r.result)return r.result.Value;
v.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.ghb};this.rMa=r=>{r.Zo||r.Yi?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.yYh(r.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.ghb};this.dw=b;this.NK=h}Qvi(){const b=
new Pg.a;this.j1i()&&this.NK?this.NK.Wcb($y.a.MWc).CWRCo(this.Wbb,0).CWRCo(this.rMa,8):b.gg(this.ghb)}H4(b){this.NK&&this.NK.H4($y.a.MWc,new UB.a($y.a.MWc,b))}RLo(b){this.j1i()&&(this.dw.wna("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.yYh(b),this.H4(b))}j1i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}yYh(b){this.ghb=b}}Object(u.a)(VB,"ExternalContentSettingInfo",null,[359]);var sA=d(1123);class fI{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(u.a)(fI,"FluidComponentProperties",null,[]);class gI{constructor(){this.loopType=this.Fv=this.O6a=this.url=null;this.mediaType=0;this.vaj=null}}Object(u.a)(gI,"IFrameProps",null,[]);class Il{static get m4(){return null!=
Il.M3g?Il.M3g:Il.M3g=Wa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get HR(){return Il.Dk||(Il.Dk=Wa.a.instance.resolve("WordEditor.IImageEditor"))}static get Iw(){return null!=Il.YRg?Il.YRg:Il.YRg=Wa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get Op(){return null!=Il.gXg?Il.gXg:Il.gXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Mf(){return null!=Il.p1g?Il.p1g:Il.p1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Cg(){return null!=
Il.ESg?Il.ESg:Il.ESg=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static qXa(b){const h=b.startsWith(Ic.a.luc),r=b.startsWith(Ic.a.iid),A=b.startsWith(Ic.a.Rqe);return(h||r||A)&&Ic.a.qXa(b)}static qmf(b,h){let r=!1;if(b){switch(b.contextId){case kc.a.Vc:r=!h;break;case kc.a.Cd:r=!0}r&&!bw.a(b.node)&&(r=!1)}return r}static Clc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=xc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Ic.a.Oz(h,!1);if(1===h.length){h=h[0];const r=Cd.ParagraphReader.text(b.node).substring(h.cpBegin,
h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static xIf(b,h){const r=!F.a.baa(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static Icd(b){b=
hb.a.eb(b);b.zb(12);b.kd(12);b.Aq.RT=!0}static d8d(b,h,r,A){const L=new lj.DictionaryPropertySet;Il.HR.iqe(L,h,b);b=Il.xIf(A,r);L.setValue(Ke.a.imageAltText,b);L.setValue(Vc.a.oX,Sf.a.wD());L.setValue(Vc.a.imageType,kp.other);return L}static xbe(b,h,r){if(!b||!b.isConnected||!Id.a.Eq(b))return null;const A=new rA.a;A.setValue(cg.a.$lc,h.mediaType);A.setValue(cg.a.kWa,h.url);A.setValue(Od.a.loopComponentType,h.loopType);A.O6a=h.O6a;A.Fv=h.Fv;A.providerName=r;A.creationTime=Date.now();A.yab=1===h.mediaType;
A.createMode=h.vaj;hb.a.eb(b).Wf(A,2);Il.Icd(A);return A}static jYd(b,h){return h?b:Il.wJf(b)}static wJf(b){const h=Cd.ParagraphReader.text(b.node),r=hb.a.eb(b.node);if(r.Nd()){b=xc.a.Uc(b.node,b.cpEnd);fg.OutlineElementNavigator.me(r);const A=Il.Mf.Psa(r);Il.Mf.Eca(r,A,b,!0,!0,!0,!0);""!=h&&Il.Mf.yy(r,!1,!0);r.je();return xc.a.Uc(r.currentNode,0)}return null}static Oxg(b){b=hb.a.eb(b);b.zb(11)&&(b.kd(11),b.Nd()&&b.Tk()&&b.je()&&Cd.ParagraphReader.Wb(b.currentNode)&&(b=qc.SelectionFactory.ue(b.currentNode,
0),If.a.instance.Kc(b)))}static yIf(b,h){const r=!F.a.baa(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,
h){Il.Iw&&(b=Il.yIf(b,h),Il.Iw.sendNotification(b,!0))}static soe(b,h,r,A=""){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:r,dataFields:[Object.assign(new da.a,{name:b,bool:h}),Object.assign(new da.a,{name:"ProviderName",string:A})]}))}}Object(u.a)(Il,"ExternalContentHelper",null,[]);var WB=d(758);class $t{constructor(){this.Fm=this.rt=null}E_d(b,h,r){b.Hj().Ag.nE(()=>{this.Pkg(h,b,r)},()=>
{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Pkg(b,h,r){if(b=this.FLf(b,h))h=Array(1),h[0]=b,r=sF.a.construct(h,r,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.rt.Bq:null),b=this.stf(),this.ayb(b,r)}FLf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.rt=h.Hj();(new hb.a).set(h);if(!h.anchor||!h.anchor.Gr||!h.anchor.Gr.ht)return v.ULS.sendTraceTag(592996171,
324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Gr.ht.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ka(Ge.a.ZJ,Cl.a.Gu);const A=h.getValue(Ke.a.VG),L=nh.a.xf(Id.a.FF(h.properties),0),Z=nh.a.xf(Id.a.rL(h.properties),1);return dI.a.construct(h.id.toString(),b,h.ka(Ke.a.imageAltText,""),L,Z,h.ka(Vc.a.R_,""),r,h.ka(Vc.a.oX,0),h.ka(Vc.a.Zla,
!1),h.ka(Ge.a.Mka,-1),h.ka(Vc.a.Mub,Box4Intl.Box4Strings.l_Picture),h.ka(Ke.a.FBa,!1),A,h.ka(Vc.a.runId,1),h.ka(Vc.a.ed,0))}ayb(b,h){y.AFrameworkApplication.Fe.Xj(b,2,H.c(h),{},!1,2,this.dhd.bind(this),this.Itc.bind(this),null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}dhd(){v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}Itc(){v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}stf(){let b=
Ma.a.A1c("PicturePaste.ashx");const h=Ln.a.nWa;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Ma.a.Jp(b,Wj.a.fileId,this.rt.Bq));b=Ma.a.Jp(b,Wj.a.cellId,this.rt.il.toString());this.Fm||(this.Fm=eb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Ma.a.Jp(b,Wj.a.h_,this.Fm.toString());b=Ma.a.Jp(b,Wj.a.classId,h.toString());this.rt.$G&&(b=Ma.a.Jp(b,Wj.a.$G,this.rt.$G));b=Ma.a.Jp(b,
Wj.a.ZAb,"1");b=Ma.a.Jp(b,Ii.a.imageType,kp.other.toString());b=Cm.a.instance.Nef(b);b=Ma.a.Jp(b,Wj.a.Jya,this.rt.Ag.Pr.toString());b=Ma.a.Jp(b,Wj.a.ytc,"0");return b=Ma.a.Jp(b,Wj.a.F2b,"1")}}Object(u.a)($t,"ExternalContentThumbnailHelper",null,[]);class cw extends $t{constructor(){super(...arguments);this.ap=null}static get Gf(){return null!=cw.GUg?cw.GUg:cw.GUg=Wa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}lak(b,h,r){return Il.qXa(h)?Il.qmf(b,r)?!0:(cw.Gf.hU(this.ap,2,"URL inserted in Non-Embedable context",
cw.Gf.Wo()),!1):(v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),cw.Gf.hU(this.ap,2,"URL inserted is not valid for ExternalContent",cw.Gf.Wo()),!1)}}Object(u.a)(cw,"AbstractExternalContentEditor",$t,[360]);var Ms=d(1158),tF=d(1150);class xn extends cw{constructor(b){super();xn.yRa=b;this.B4f()}B4f(){tF.a.B4f(xn.yRa.xwi())}static get ql(){return null!=xn.U1g?xn.U1g:xn.U1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}YFl(b,h){h=this.rBi(b,
h);this.eSi(h,b,5)}sWa(b,h,r){if(this.lak(b,h,r)){var A=this.rBi(b,null);A.url=h;this.eSi(A,b,r?0:2)}}npe(b,h){this.sWa(b,h,!1)}eSi(b,h,r){this.Fm=eb.a.create();const A=new Sb.GraphTransaction(15);A.Ab(h.node);A.Ph=Ec.a.wan;const L=Il.Clc(h),Z=vx.q(b.mediaType),oa=Il.d8d(b.height,b.width,b.title,Z);h=this.Qxp(h,1==r);(h=Il.Dk.Cbe(h,oa))?(h=h.node,Il.xbe(h,{url:b.url,mediaType:Z,Fv:b.title,loopType:b.type,vaj:r},void 0)||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),
A.QLa(this.Fm,1),A.dispose(),this.E_d(h,b.thumbnail,!1),this.Seo(L,Z,b.type)):v.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}Qxp(b,h){Il.Cg.We(b,"");return Il.jYd(b,h)}Seo(b,h,r){Il.soe("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Il.ariaNotify(h,this.Bim(r))}Bim(b){switch(b){case WB.a.CheckList:return"Checklist Component";case WB.a.TaskAssignment:return"Task List Component";case WB.a.Poll:return"Poll Component";
default:return"Fluid Component"}}rBi(b,h){const r=new fI;r.width=Il.m4.rgc(b.node)||0;vx.j()?r.height=null!=xn.yRa&&xn.yRa.uwi(h)||Il.m4.s7a(b.node)||0:r.height=null!=xn.yRa&&xn.yRa.uwi(h)+2*aw.a.r6||Il.m4.s7a(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.ytm();r.url=null!=xn.yRa&&xn.yRa.XHf();return r}ytm(){return xn.yRa.xwi()}static g9c(b){y.AFrameworkApplication.$c("2cejb611;b0jjh576");return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=xn.yRa&&xn.yRa.p2i(b)&&Ms.a.vql(b)}}Object(u.a)(xn,"FluidComponentEditor",cw,[]);class hI{get c5l(){return null!=this.xUg?this.xUg:this.xUg=Wa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get q3d(){return null!=this.RVg?this.RVg:this.RVg=Wa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}Neo(b,h){b&&(xn.g9c(h)?this.q3d.sWa(b,h,!0):this.c5l.sWa(b,h,!0))}}Object(u.a)(hI,"PostHyperlinkAutoCorrectStrategy",null,[355]);class tA{bec(b,h){h(tA.Xeo.test(b))}vvc(b,
h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new qA,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:tA.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}tA.Xeo=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$",
"i");tA.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(u.a)(tA,"PowerBIURLResolver",null,[353,354]);class ly{constructor(b){this.pJh=b}bec(b,h){let r=!1;try{if(ly.Ftn(b)){const A=this.pJh.okc(b);r=null!=A.width&&null!=A.height&&!!A.thumbnailUrl&&!!A.title&&null!=A.kva}}catch(A){}h(r)}vvc(b,h){var r=this.pJh.okc(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new qA,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static Ftn(b){for(const h of ly.Agp)if(b.startsWith(h))return!0;return!1}static laa(){return new ly(Wa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}ly.Agp=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(u.a)(ly,"WedgeComponentExperimentsURLResolver",null,[353,
354]);var XB=d(896);let uA=!1;class Wu{static S8o(b){Wu.AZi||Wu.addEventListener();const h=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(Wu.hhp,Wu.ghp,!0);Wu.AZi=!0}static Tsl(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();uA=!0}}Wu.sIn="LoopHomeTabFlightActivity";Wu.hhp="switchToInsertTabAndClickLoopButtonEvent";Wu.AZi=!1;Wu.ghp=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));
const r=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.jc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new mf.a(0,1,r,()=>{Wu.Tsl()});null===(h=y.AFrameworkApplication.pc)||void 0===h?void 0:h.$b(b)};Object(u.a)(Wu,"FluidComponentsTUIHelper",null,[]);class YB{constructor(b,h,r){this.ga=b;this.bwk=h;this.xl=r;this.mph=!1;this.Pth=1E3;this.Qth=15E3;this.a8e=this.S7e=!0;this.a8e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",
!1);this.Pth=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.Qth=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Xb(){this.ga.fb(Ec.a.jSi,kc.a.Vc,this.Xan.bind(this),1028);this.ga.fb(Ec.a.Tpe,kc.a.Vc,this.Tpe.bind(this),1028);this.ga.fb(Ec.a.T7c,kc.a.Vc,this.PUf.bind(this),1028);this.ga.fb(Ec.a.G7c,kc.a.Vc,
this.PUf.bind(this),1028);this.ga.fb(Ec.a.Gbe,kc.a.Vc,this.PUf.bind(this),1028);this.ga.fb(Ec.a.h6i,kc.a.Vc,this.Sgk.bind(this),1028)}Xan(){return 32}Tpe(b,h,r){if(2!==r)return 32;this.a8e&&(this.cDj(),this.hpp());return 32}PUf(b,h,r){var A,L;if(1===r){if(!this.Cde(b)||!XB.a.XXi())return v.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;if(!h.Al||!he.a.mf(h)||(null===(A=this.xl)||void 0===A?0:A.p2(h))||(null===(L=this.xl)||void 0===L?0:L.ama(h)))return 2;if(h&&
h.node&&bw.a(h.node))return 32}else if(2===r)return this.bwk.YFl(h,YB.wtm(b)),this.cDj(),32;return 2}hpp(){if(null!=cb.a.instance.getItem("LoopComponentSurveyShowed")||uA)this.S7e=!1;if(this.S7e){let b=this.qBi();window.setTimeout(()=>{b&&"hidden"!==b.visibility&&(this.mph=!0)},this.Pth);this.FKk=window.setTimeout(()=>{const h=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");this.mph&&h&&h.execute(r=>{(b=this.qBi())&&"hidden"===b.visibility&&!uA&&(v.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),
r.meb("WordLoopFeedbackSurvey",null),this.S7e=!1,cb.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.Qth)}}qBi(){var b,h;let r=null;try{const A=document.getElementById("Ribbon-LoopComponentDropdown");A&&(r=Dn.a.WB(null===(h=null===(b=A.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(A){v.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=A?A.toString():""))}return r}cDj(){this.a8e&&window.clearTimeout(this.FKk)}Cde(b){return b===
Ec.a.G7c||b===Ec.a.T7c?Ms.a.Cde():!0}Sgk(b,h,r){2===r&&F.a.GX("https://go.microsoft.com/fwlink/?linkid=2194838")&&ed.a.dvg.uAc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static wtm(b){switch(b){case Ec.a.T7c:return WB.a.TaskAssignment;case Ec.a.G7c:return WB.a.CheckList;case Ec.a.Gbe:return WB.a.Poll;default:return null}}}Object(u.a)(YB,"FluidComponentsActor",null,[]);class zj extends cw{constructor(){super();this.wUb=this.vUb=null;this.oBf=new eI.ExternalContentEmbedRetriever;this.kHc=
null;null!=zj.$ra&&zj.$ra.Qvi()}ryj(){this.ap=Q.a.create();zj.Gf.TMb(this.ap,4);zj.Gf.n8(this.ap,0,zj.Gf.Wo());this.pSb(this.vUb,3,this.wUb,!0)}sWa(b,h,r){this.ap=Q.a.create();zj.Gf.TMb(this.ap,r?0:2);zj.Gf.n8(this.ap,0,zj.Gf.Wo());this.kHc();this.pSb(b,r?0:2,h)}npe(b,h){this.ap=Q.a.create();zj.Gf.TMb(this.ap,1);zj.Gf.n8(this.ap,0,zj.Gf.Wo());this.pSb(b,1,h)}kAj(b){this.kHc=b}mIe(b,h){const r=zj.m4.rgc(h)||0;h=zj.m4.s7a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=
h/A)}wPg(b,h,r){if(null!=b&&null!=h&&!F.a.Qf(r)){var A=zj.sed.okc(r);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.kva=!1:A.kva=!0;A.hideFloatie=!0;this.mIe(b,h.node);this.Cmc(b,h,!1,!1,A,r)}}irb(b){return b?b.He:0}fMg(b,h,r){let A=null;const L=b.node;if(!Cd.ParagraphReader.Wb(L)||!L.isConnected)return{returnValue:!1,Ova:A};if(r)return{returnValue:!0,Ova:b};r=b.cpBegin;const Z=b.cpEnd,oa=Cd.ParagraphReader.text(L);
if(0<=r&&Z<=oa.length&&oa.substring(r,Z)===h)return{returnValue:!0,Ova:b};const Ba=oa.indexOf(h);return 0<=Ba?(A=xc.a.createTextRange(L,Ba,Ba+h.length),{returnValue:!0,Ova:A}):0<=r&&Z<=oa.length&&Il.Clc(b)?{returnValue:!0,Ova:b}:{returnValue:!1,Ova:A}}T0f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}ffb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");
r&&r.execute(A=>{A.logActivity(b,h)})},zj.Eza)}pSb(b,h,r,A=!1){if(this.lak(b,r,!h)){var L=zj.sed.okc(r);L&&(this.T0f(L)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.Lkg(b,h,L,r,A)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),zj.Gf.hU(this.ap,2,"Size provided is not valid for OEmbed",zj.Gf.Wo())))}}Lkg(b,h,r,A,L){const Z=!h,oa=1===h,Ba=zj.m4.rgc(b.node)||0,gb=zj.m4.s7a(b.node)||0,Ab=cI.a.lqf(r.zLg,
!0,Ba,gb);this.dcd(b,A,h,!0);this.oBf.P0h(Ab,Jb=>{zj.Gf.n8(this.ap,4,zj.Gf.Wo());zj.Gf.Gnd(this.ap,this.irb(Jb.data));if(Jb=this.Rkg(Jb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Tb=vx.q(Jb.MediaType);zj.Gf.Sse(this.ap,7,Tb);Tb=b;({Ova:Tb}=this.fMg(b,A,oa)).returnValue?(this.dcd(Tb,A,h,!1),null==r.width?0<Ba&&Jb.Width>Ba&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),
Jb.Width=Ba):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Jb.Width=this.Itd(r.width,Jb.Width,Ba)),null==r.height?0<gb&&Jb.Height>gb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Jb.Height=gb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Jb.Height=this.Itd(r.height,Jb.Height,
gb)),zj.$ra.ghb||L?this.Cmc(Jb,Tb,Z,oa,r,A):(this.vUb=b,this.wUb=A,this.rXc(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),zj.Gf.hU(this.ap,2,"No conversion as the context is no longer valid for the external content conversion",zj.Gf.Wo()));oa&&this.w6a(Tb.node)}else oa&&this.w6a(b.node),zj.Gf.hU(this.ap,1,"URL not oEmbedable",zj.Gf.Wo())},Jb=>{zj.Gf.n8(this.ap,4,zj.Gf.Wo());zj.Gf.Gnd(this.ap,
this.irb(Jb.data));oa&&this.w6a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl.");zj.Gf.hU(this.ap,2,"ExternalContentEmbedRequest failed",zj.Gf.Wo())},Jb=>{oa&&this.w6a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Jb)},this.ap)}Itd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&
(h=b);return h}Cmc(b,h,r,A,L,Z){this.Fm=eb.a.create();b.Width=b.Width/b.Height*(b.Height-(aw.a.b6c+aw.a.r6))+2*aw.a.r6;const oa=new Sb.GraphTransaction(15);oa.Ab(h.node);oa.Ph=Ec.a.sWa;const Ba=Il.Clc(h);null!=L.kva&&!L.kva||A||Ba||(b.Title=""===L.title||L.title?L.title:b.Title,!b.Title&&""!==b.Title)||(h=this.dVf(h,oa,b.Title,Z,r));if(h){A&&(h=this.nvf(h));var gb=Il.jYd(h,A);if(gb){r=vx.q(b.MediaType);var Ab=Il.d8d(b.Height,b.Width,b.Title,r);(gb=this.MUf(gb,Ab,A,{url:Z,O6a:b.IFrameHtml,Fv:b.Title,
mediaType:r},b.ProviderName))?(oa.QLa(this.Fm,1),oa.dispose(),this.vUb=h,this.wUb=Z,this.nhg(L,b,gb),this.ykg(Z,A||L.hideFloatie,Ba,r,b.Title,b.ProviderName)):oa.dispose()}else oa.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),zj.Gf.hU(this.ap,2,"Could not create IP context on splitting the paragraph",zj.Gf.Wo())}else zj.Gf.hU(this.ap,2,"GraphNodeContext is null",zj.Gf.Wo())}MUf(b,h,r,A,L){if(!b)return null;
b=zj.HR.Cbe(b,h);if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),zj.Gf.hU(this.ap,2,"The anchored image could not be inserted",zj.Gf.Wo()),null;b=b.node;A=Il.xbe(b,A,L);zj.Gf.CKg(this.ap,A.id);r||Il.Oxg(b);return b}nhg(b,h,r){F.a.baa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(zj.Gf.n8(this.ap,8,zj.Gf.Wo()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.E_d(r,h.Thumbnail,!1))}ykg(b,h,r,A,L,Z){h||this.rXc(b);this.ffb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Il.soe("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",Z);Il.ariaNotify(A,L);zj.Gf.n8(this.ap,5,zj.Gf.Wo())}dVf(b,h,r,A,L){if(L){if((L=Ic.a.Oz(b,!1))&&1!==L.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Il.Op.fV(L[0].paragraph,
L[0].hyperlink)}return this.vsg(b,r,A)}nvf(b){const h=b.node,r=Cd.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=xc.a.createTextRange(h,0,r.length),Il.Cg.We(b,""),xc.a.Uc(h,0)):b}Rkg(b){if(!({group:b}=hn.a.D4(b.data.Pe)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}vsg(b,h,r){const A=b.cpBegin+h.length;Il.Cg.We(b,h);b=xc.a.createTextRange(b.node,b.cpBegin,A);Il.Op.wF(b,r,!1);return b}w6a(b){b.Btc=null}dcd(b,h,r,A){const L=b.cpBegin,Z=b.cpEnd;b=Cd.ParagraphReader.text(b.node).trim();
L||b!==h&&""!==b?L?Z===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xv[r],A):0<L&&Z<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xv[r],A):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xv[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xv[r],A)}rXc(b){this.ygc();const h=new Wx.a(1,y.AFrameworkApplication.isRtl);h.Pgd=b;zj.wpb.qjd(h)}ygc(){const b=new gu.a(!0);zj.Wba.$Ma(b)}static get wpb(){return null!=zj.zUg?zj.zUg:zj.zUg=Wa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get $ra(){zj.MFa||(zj.MFa=Wa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));
return zj.MFa}static get Wba(){return null!=zj.s2g?zj.s2g:zj.s2g=Wa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get m4(){return null!=zj.N3g?zj.N3g:zj.N3g=Wa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get HR(){return null!=zj.tXg?zj.tXg:zj.tXg=Wa.a.instance.resolve("WordEditor.IImageEditor")}static get sed(){return null!=zj.S0g?zj.S0g:zj.S0g=Wa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}zj.Eza=5E3;zj.MFa=null;
Object(u.a)(zj,"ExternalContentEditorV2",cw,[]);class uF{constructor(){this.Fd=this.Z=null}get name(){return"WordEditor.ExternalContent"}get rc(){return this.Fd?this.Fd:this.Fd=this.Z.resolve("Box4.IFeatureHelper")}wc(b){var h;this.Z=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new rF.a(Tq.a.instance,Ao.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new hI).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();
b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new VB(b.resolve("Box4.IRoamingServiceRequestManager"),b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new zj).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ia("WordEditor.ExternalContent.FluidComponentEditor",
()=>new xn(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ia("WordEditor.ExternalContent.FluidComponentsActor",()=>new YB(y.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),Be.a.instance)).ha(),(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Wu.S8o(Wu.sIn)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new Bh).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.rc.er.continueWith(()=>
{this.Ho()});y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.Z.resolve("WordEditor.ExternalContent.FluidComponentsActor").Xb()}dispose(){}PFl(){const b=new mK;this.jji()&&b.$Nh(ly.laa());b.$Nh(new tA);return b}Ho(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.Z.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new sA.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();
this.jji()&&(this.Z.ia("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.PFl()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.Z.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}jji(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){E.a.instance.Mc(new uF)}}Object(u.a)(uF,"ExternalContentPackage",null,[0,1]);var az;(function(b){b[b.invalid=
-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.Nuf=6]="decimal";b[b.iVp=7]="bar";b[b.Bvb=8]="num"})(az||(az={}));Object(u.b)("TabStopValues",az);class uo{}uo.hdi=8;uo.rPl=1;uo.Baa="wwaengidc";uo.kpiName="WordRuler";uo.precision=.0625;uo.lip=1;uo.SDp="ShowHideRuler";Object(u.a)(uo,"Constants",null,[]);var zD=d(1062);class cp{static Hkc(b,h){if(!cp.E$c)return null;switch(b){case "Left":return r=>{const A=r.rulerCanvasProps;
r=r.indents;return{GUb:0,LZb:A.scale-(A.margins[1].value+r[2].value+Math.max(r[0].value,r[1].value)+8*A.precision)}};case "Right":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{GUb:0,LZb:A.scale-(r[2].value+(A.margins[0].value+Math.max(r[0].value,r[1].value))+8*A.precision)}};case "MoveTableColumn":return()=>{let r=0,A=0;if(0===h){var L={};32===cp.Pb.Qb(vb.a.Cuc,2,L)&&(r=Tf.a.iB(L.MinIndent),A=Tf.a.iB(L.MaxIndent))}else L={pp:h-1},32===cp.Pb.Qb(vb.a.Auc,2,L)&&(r=Tf.a.iB(L.MinResize),A=Tf.a.iB(L.MaxResize));
return{GUb:r,LZb:A}};case "Top":return r=>{r=r.rulerCanvasProps;return{GUb:0,LZb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{GUb:0,LZb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static r8d(b){if(!cp.E$c)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var r=h.rulerCanvasProps,A=h.indents,L=h.ipContextIndex;h=r.margins;var Z=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){L=h[0].value;
h=h[1].value+A[2].value;var oa=L;"LeftIndent"===b&&(oa+=Math.max(A[0].value,A[1].value));A=-1*L;r=Z-(oa+h+8*r)}else{Z=0;for(oa=0;oa<=L;oa++)Z+=h[oa].value;oa=0;if("LeftIndent"===b){oa=A[0].value;const Ba=A[1].value;Z+=Math.max(oa,Ba);oa=Math.max(oa,Ba)}h=h[L+1].value;oa+=A[2].value;A=-1*Z;r=h-oa-r}return{GUb:A,LZb:r}};case "RightIndent":return h=>{var r=h.rulerCanvasProps,A=h.indents,L=h.ipContextIndex,Z=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==Z[0].type){var oa=Z[0].value;Z=Z[1].value;
L=A[0].value;var Ba=A[1].value;A=-1*Z;h-=oa+Z+Math.max(L,Ba)+8*r}else{oa=0;for(Ba=0;Ba<=L;Ba++)oa+=Z[Ba].value;Z=Z[L+1].value;L=A[0].value;Ba=A[1].value;A=-1*(h-oa-Z);h=Z-Math.max(L,Ba)-r}return{GUb:A,LZb:h}}}return null}static yJm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,A=b.ipContextIndex,L=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==L[0].type?(A=L[0].value,L=L[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(A+L+b)):(h=r[2].value,L=L[A+1].value,r=Math.min(r[0].value,
r[1].value)+b,b=L-(h+b));return{GUb:r,LZb:b}}}static get Pb(){return null!=cp.ORg?cp.ORg:cp.ORg=y.AFrameworkApplication.va}static get E$c(){null==this.ajb&&(y.AFrameworkApplication.jga("WoRul910;WoRul910cf"),this.ajb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.ajb}}cp.ajb=null;Object(u.a)(cp,"RulerPropertyBoundaryHelper",null,[]);var vA=d(939),yL=d(1385),bz=d(957),ZB=d(1221),op=d(1222);class xu{constructor(b,
h,r,A,L,Z,oa){this.W7n="OutlineContainer";this.HRk="UpdateCustomTabFailed";this.GHb="ReadRulerPropertiesFailed";this.LRk="UpdateIndentFailed";this.eJh="UpdateMarginFailed";this.jne=Ba=>{(Ba.button===Sys.UI.MouseButton.rightButton||this.Lrn&&Ba.button===Sys.UI.MouseButton.leftButton)&&this.s6e.show(new Sys.UI.Point(Ba.clientX,Ba.clientY),2)};this.U8j=()=>{this.s0a()};this.St=b;this.m9b=h;this.ga=r;this.s6e=A;this.rA=L;this.cT=Z;this.q6b=null;this.JFb=oa;this.nA=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.F7;
this.$lj=this.Tme.bind(this);this.Yoj=this.mv.bind(this);this.T8j=this.s0a.bind(this)}ME(){this.xef();this.fOh();this.m9b.Tl.qf(10).Qo(this.$lj);zc.a.addHandler(this.Sbf,od.a.scroll,this.U8j);this.St.execute(h=>{h.gY(this.Yoj)});const b=[this.aDi(),document.getElementById(Nk.a.pBc),document.getElementById("PageContentContainer")];this.lqg(b);ab.StaticActiveAppFrame.za().OQ.registerBoundingWindowRectsChanged("documentPanel",(h,r)=>{"undefined"!==r&&this.vfb([1,0])})}lqg(b){this.q6b?this.q6b.register(b,
this.T8j):bz.a(yL.a.t6k,()=>{appChrome.getResizeObserver().then(h=>{this.q6b=h.createResizeObserver();this.q6b.register(b,this.T8j);return null})})}aDi(){return 0===this.cT.Gv?this.iyh:this.Ayh}get Sbf(){return document.getElementById(Nk.a.H0a)}get iyh(){const b=document.getElementsByClassName(this.W7n);return b&&0<b.length?b[0]:null}get vIk(){var b=this.rA.VOb;if(!b)return null;b=this.UNo(Cd.ParagraphReader.rU(b));return vA.a.eDi(b)}get URa(){return this.JFb.value}get Ayh(){return this.URa.fg(this.URa.vd).gS}UNo(b){return 0<
b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get tQ(){return this.St&&this.St.instance?this.St.instance.nl:uo.rPl}Wjc(){const b={};return 32!==this.ga.Qb(vb.a.VMa,2,b)?(v.ULS.sendTraceTag(529065947,ZB.a.DQn,op.a.warning,"Unable to read page properties for Ruler"),bm.recordQosError(this.GHb,[bm.rja],"Unable to read page properties for Ruler"),null):b}dispose(){this.eOi();this.m9b.Tl.qf(10).LP(this.$lj);zc.a.removeHandler(this.Sbf,od.a.scroll,this.U8j);this.St.execute(b=>{b.hNa(this.Yoj)});
this.q6b&&this.q6b.dispose();ab.StaticActiveAppFrame.za().OQ.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.vfb([1,0])})}get ZZi(){null==xu.WWe&&(xu.WWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&y.AFrameworkApplication.J.$("RulerThemingIsEnabled"):!1);return xu.WWe}get Lrn(){null==xu.CXe&&(xu.CXe=y.AFrameworkApplication.J?
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRulerContextMenuOnLeftClick",!1):!1);return xu.CXe}}xu.WWe=null;xu.CXe=null;Object(u.a)(xu,"ARuler",null,[395]);var AD=d(307);class gt extends xu{constructor(b,h,r,A,L,Z,oa,Ba){super(b,h,r,L,Z,oa,Ba);this.UR="HorizontalRuler";this.Hek="CustomTabModificationFromRuler";this.kgk="IndentModificationFromRuler";this.uHe="MarginModificationFromRuler";this.ilh=this.hlh=this._tabStops=null;this.kYn=(gb,Ab,Jb)=>{if(!(gb>=this._tabStops.length)){gb=
this._tabStops[gb];var Tb="Modify"===Jb?this.ga.Qb(Ec.a.qrc,2,{["tabStop"]:gb,["value"]:Tf.a.lD(Ab)}):this.ga.Qb(Ec.a.Ycb,2,gb);if(32===Tb){Ab=1;var jc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Jb,az[gb.Hha]);v.ULS.sendTraceTag(591213271,3014,50,jc)}else Ab=0,jc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Jb,az[gb.Hha]),v.ULS.sendTraceTag(591213272,3014,15,jc),bm.recordQosError(this.HRk,[bm.rja],"Unable to modify custom tab using ruler");
me.a(this.Hek,32===Tb,void 0,[Object.assign(new da.a,{name:"Operation",string:Jb}),Object.assign(new da.a,{name:"TabType",int64:az[gb.Hha]})]);Jb=new Map;Jb.set("Command","OnCustomTabChange");Jb.set("Source",this.UR);Jb.set("Response",jc);xa.Health.instance.recordKpiUsage(uo.kpiName,Ab,uo.Baa,Jb)}};this.A_n=(gb,Ab)=>{var Jb=new zD.a;Jb.unit=1;Jb.value=Tf.a.lD(Ab);Ab=8;switch(gb){case "FirstLineIndent":Ab=this.ga.Qb(vb.a.nod,2,Jb);break;case "HangingIndent":Ab=this.ga.Qb(vb.a.ood,2,Jb);break;case "LeftIndent":Ab=
this.ga.Qb(vb.a.e$a,2,Jb);break;case "RightIndent":Ab=this.ga.Qb(vb.a.d$a,2,Jb)}let Tb;32===Ab?(Jb=1,Tb=String.format("Indents set using Ruler. Indent: {0}",gb),v.ULS.sendTraceTag(592517017,3014,50,Tb)):(Jb=0,Tb=String.format("Unable to set indent using Ruler. Indent: {0}",gb),v.ULS.sendTraceTag(592496523,3014,15,Tb,gb),bm.recordQosError(this.LRk,[bm.rja],"Unable to set indent using Ruler."));me.a(this.kgk,32===Ab,void 0,[Object.assign(new da.a,{name:"Type",string:gb})]);gb=new Map;gb.set("Command",
"OnIndentChange");gb.set("Source",this.UR);gb.set("Response",Tb);xa.Health.instance.recordKpiUsage(uo.kpiName,Jb,uo.Baa,gb)};this.Rsc=(gb,Ab)=>{if(bm.instance.$fa)switch(Ab.ybb){case 3:case 2:case 1:this.lqg([this.Ayh]);break;case 0:this.lqg([this.iyh])}};this.Qeg=(gb,Ab,Jb)=>{let Tb;Tb="Left"===gb?this.ga.Qb(vb.a.sna,2,Tf.a.lD(Ab)):"Right"===gb?this.ga.Qb(vb.a.Rdb,2,Tf.a.lD(Ab)):Jb?this.ga.Qb(vb.a.uBe,2,{["columnIndex"]:Jb-1,["width"]:Tf.a.lD(Ab)}):this.ga.Qb(vb.a.cxc,2,Tf.a.lD(Ab));32===Tb?(Ab=
1,Jb=String.format("Margins set using Ruler. Margin: {0}",gb),v.ULS.sendTraceTag(592517018,3014,50,Jb)):(Ab=0,Jb=String.format("Unable to set margins using Ruler. Margin: {0}",gb),v.ULS.sendTraceTag(592496524,3014,15,Jb),bm.recordQosError(this.eJh,[bm.rja],"Unable to set margins using Ruler."));me.a(this.uHe,32===Tb,void 0,[Object.assign(new da.a,{name:"Type",string:gb})]);gb=new Map;gb.set("Command","OnMarginChange");gb.set("Source",this.UR);gb.set("Response",Jb);xa.Health.instance.recordKpiUsage(uo.kpiName,
Ab,uo.Baa,gb)};this.tSa=A;this.es={}}get mX(){return this.hlh}get BKa(){return this.ilh}renderRuler(){this.mX.classList.remove("HideWACHorizontalRulerContainer");this.mX.classList.add("ShowWACHorizontalRulerContainer");var b=this.Wjc();if(b){var h=this.Qeg,r=this.A_n,A=this.kYn,L=this.dsd(),Z=this.n3j(),oa=this.m3j();L&&Z&&oa||(this.es.disabled=!0);this.es.onIndentChange=r;this.es.onMarginChange=h;this.es.onTabChange=A;this.s0a();b=nh.a.Mj(b.pageWidth,0);this.BKa.style.width=(b*this.tQ).toString()+
"px";return this.tSa().then(Ba=>{Ba.renderRuler(this.BKa,this.es)})}}m3j(){const b=[];var h={};if(32!==this.ga.Qb(Ec.a.jYb,2,h))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),bm.recordQosError(this.GHb,[bm.rja],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.es.tabs=b,!0;this._tabStops=r;h="";for(const A of r){switch(A.Hha){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h=
"DecimalTab";break;case 7:h="BarTab"}r=nh.a.cZa(A.gOa,0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:cp.yJm()})}this.es.tabs=b;return!0}vfb(b){var h;if(this.mX){this.mX.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.es&&delete this.es.disabled;for(const r of b)switch(r){case 0:b=this.n3j();const A=this.m3j();b&&A||(this.es.disabled=!0);break;case 1:this.dsd()||(this.es.disabled=!0)}if(null===(h=this.rA.currentSelection)||void 0===h?0:h.f9c)this.es.disabled=!0;this.tSa().then(r=>
{r.renderRuler(this.BKa,this.es);return null})}}dsd(){const b={};var h=this.Wjc();if(!h)return!1;b.scale=Tf.a.iB(h.pageWidth);b.precision=uo.precision;b.rulerType="Horizontal";if(!this.e6n())return this.es.ipContextIndex=0,this.es.permittedUnits=uo.hdi,h=[{["type"]:"Left",["value"]:Tf.a.iB(h.marginLeft),["getRulerPropertyBoundary"]:cp.Hkc("Left",0)},{["type"]:"Right",["value"]:Tf.a.iB(h.marginRight),["getRulerPropertyBoundary"]:cp.Hkc("Right",1)}],b.margins=h,this.es.rulerCanvasProps=b,!0;var r={};
h={};var A=this.ga.Qb(vb.a.Yid,2,r);const L=this.ga.Qb(vb.a.uYb,2,h);if(32!==A||32!==L)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),bm.recordQosError(this.GHb,[bm.rja],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;A=h.TablePosition;if(!A||!r||0>=r.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),bm.recordQosError(this.GHb,[bm.rja],"Cannot show table properties on the ruler as they are null"),
!1;h=Array(r.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Tf.a.iB(A.x/this.tQ),["getRulerPropertyBoundary"]:cp.Hkc("MoveTableColumn",0)};for(A=0;A<r.length;A+=1)h[A+1]={["type"]:"MoveTableColumn",["value"]:Tf.a.iB(r[A]),["getRulerPropertyBoundary"]:cp.Hkc("MoveTableColumn",A+1)};this.es.ipContextIndex=this.pNm();this.es.permittedUnits=uo.lip;b.margins=h;this.es.rulerCanvasProps=b;return!0}n3j(){var b={};if(32!==this.ga.Qb(vb.a.Kcb,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),
bm.recordQosError(this.GHb,[bm.rja],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=cp.r8d("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=cp.r8d("HangingIndent");const A={type:"RightIndent"};A.getRulerPropertyBoundary=cp.r8d("RightIndent");const L={type:"LeftIndent"};L.getRulerPropertyBoundary=cp.r8d("LeftIndent");this.es.rtl=b.isRtl;b=b.Cu;h.value=1===b.specialIndentType?Tf.a.iB(b.yha+b.RA):2===b.specialIndentType?
Tf.a.iB(b.RA-b.yha):Tf.a.iB(b.RA);r.value=Tf.a.iB(b.RA);L.value=Tf.a.iB(b.RA);A.value=Tf.a.iB(b.Hfa);this.es.indents=[h,r,A,L];return!0}fOh(){zc.a.addHandler(this.mX,od.a.dC,this.jne);this.cT.ySc(this.Rsc)}eOi(){this.mX&&(this.mX.classList.remove("ShowWACHorizontalRulerContainer"),this.mX.classList.add("HideWACHorizontalRulerContainer"),zc.a.removeHandler(this.mX,od.a.dC,this.jne));this.tSa().then(b=>{b.dispose(this.BKa);return null});this.cT.Ite(this.Rsc)}mv(){this.W8j();this.s0a();this.vfb([1,0])}Tme(b,
h){b=h.property;if(b===Vc.a.pageWidth||b===Vc.a.marginLeft||b===Vc.a.marginRight)this.W8j(),this.s0a(),this.vfb([1])}W8j(){var b=this.Wjc();b&&(b=nh.a.Mj(b.pageWidth,0),this.BKa.style.width=Math.round(b*this.tQ).toString()+"px")}s0a(){window.requestAnimationFrame(()=>{var b=this.aDi();b&&(b=rd.a.getElementBounds(b),y.AFrameworkApplication.isRtl?this.BKa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.BKa.style.marginLeft=b.x.toString()+"px")})}pNm(){const b=
hb.a.eb(this.rA.VOb);if(b.zb(14))return b.kd(16),ev.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");bm.recordQosError(this.GHb,[bm.rja],"Unable to read table column index for Ruler");return 0}e6n(){let b=!0;const h=this.rA.currentSelection.ZT();if(null===h)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),bm.recordQosError(this.GHb,[bm.rja],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=
hb.a.eb(h.current.node);r.Nd();b=b&&si.TableReader.Ix(r)}return b}xef(){if(!this.BKa&&!this.mX){this.hlh=document.createElement("div");this.mX.id=gt.Dyk;this.mX.className=gt.Cyk;this.mX.setAttribute($c.a.Wja,WordEditorIntl.WordEditorStrings.L_Ruler);this.mX.setAttribute($c.a.Wh,$c.a.lUh);this.mX.classList.add("HideWACHorizontalRulerContainer");if(this.ZZi){var b=y.AFrameworkApplication.J.jb("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");
Pc.a.oAa(b,!h)&&this.mX.classList.add(gt.eFk)}this.ilh=document.createElement("div");this.BKa.className=gt.Byk;this.BKa.id=gt.Eyk;this.mX.appendChild(this.BKa);b=null;this.nA&&((b=Object(AD.a)("EditorBars"))&&b.appendChild(this.mX),this.mX.classList.add("regionComposer"));b||(b=document.getElementById(Nk.a.pBc),b.insertBefore(this.mX,b.firstChild))}}static YG(){return new gt(Wa.a.instance.Ta("Common.IZoomManager"),ed.a.jf,y.AFrameworkApplication.va,Ol.UISurfaces.PFi,Wa.a.instance.resolve("WordEditor.IRulerContextMenu"),
Bt.a.instance,Wa.a.instance.resolve("WordEditor.IMainViewModeManager"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc))}static get instance(){return null!=gt.QYg?gt.QYg:gt.QYg=gt.YG()}}gt.Dyk="WACHorizontalRulerContainer";gt.Cyk="WACHorizontalRulerContainer";gt.Eyk="WACHorizontalRuler";gt.Byk="WACHorizontalRuler";gt.eFk="ModernUxWACHorizontalRulerContainer";Object(u.a)(gt,"HorizontalRuler",xu,[]);var my=d(1563);class Ns extends xu{constructor(b,h,r,A,L,Z,oa,Ba){super(b,h,r,L,Z,oa,Ba);this.UR="VerticalRuler";
this.uHe="MarginModificationFromRuler";this.VJh=this.UJh=null;this.Qeg=(gb,Ab)=>{let Jb=8;"Top"===gb?Jb=this.ga.Qb(vb.a.Sdb,2,Tf.a.lD(Ab)):"Bottom"===gb&&(Jb=this.ga.Qb(vb.a.Qdb,2,Tf.a.lD(Ab)));let Tb;32===Jb?(Ab=1,Tb=String.format("Margins set using Ruler. Margin: {0}",gb),v.ULS.sendTraceTag(529065945,3014,50,Tb)):(Ab=0,Tb=String.format("Unable to set margins using Ruler. Margin: {0}",gb),v.ULS.sendTraceTag(529065946,3014,15,Tb),bm.recordQosError(this.eJh,[bm.rja],"Unable to set margins using Ruler."));
me.a(this.uHe,32===Jb,void 0,[Object.assign(new da.a,{name:"Type",string:gb})]);gb=new Map;gb.set("Command","OnMarginChange");gb.set("Source",this.UR);gb.set("Response",Tb);xa.Health.instance.recordKpiUsage(uo.kpiName,Ab,uo.Baa,gb)};this.tSa=A;this.es={}}get M4(){return this.UJh}get dPa(){return this.VJh}renderRuler(){this.M4.classList.remove("HideWACVerticalRulerContainer");this.M4.classList.add("ShowWACVerticalRulerContainer");var b=this.Wjc();if(b){var h=this.Qeg;this.dsd()||(this.es.disabled=
!0);this.es.onMarginChange=h;this.s0a();b=nh.a.Mj(b.pageHeight,1);this.dPa.style.height=(b*this.tQ).toString()+"px";this.tSa().then(r=>{r.renderRuler(this.dPa,this.es);return null})}}vfb(b){var h;if(this.M4){this.M4.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.es&&delete this.es.disabled;for(const r of b)switch(r){case 1:this.dsd()?this.s0a():this.es.disabled=!0}if(null===(h=this.rA.currentSelection)||void 0===h?0:h.f9c)this.es.disabled=!0;this.tSa().then(r=>{r.renderRuler(this.dPa,
this.es);return null})}}dsd(){const b={},h=this.Wjc();if(!h)return!1;b.scale=Tf.a.iB(h.pageHeight);b.precision=uo.precision;b.rulerType="Vertical";this.es.ipContextIndex=0;this.es.permittedUnits=uo.hdi;b.margins=[{["type"]:"Top",["value"]:Tf.a.iB(h.marginTop),["getRulerPropertyBoundary"]:cp.Hkc("Top",0)},{["type"]:"Bottom",["value"]:Tf.a.iB(h.marginBottom),["getRulerPropertyBoundary"]:cp.Hkc("Bottom",1)}];this.es.rulerCanvasProps=b;return!0}fOh(){this.xef();zc.a.addHandler(this.M4,od.a.dC,this.jne)}eOi(){this.M4&&
(this.M4.classList.remove("ShowWACVerticalRulerContainer"),this.M4.classList.add("HideWACVerticalRulerContainer"),zc.a.removeHandler(this.M4,od.a.dC,this.jne));this.tSa().then(b=>{b.dispose(this.dPa);return null})}mv(){this.S8j();this.s0a();this.vfb([1])}Tme(b,h){b=h.property;if(b===Vc.a.pageHeight||b===Vc.a.marginTop||b===Vc.a.marginBottom)this.S8j(),this.s0a(),this.vfb([1])}S8j(){var b=this.Wjc();b&&(b=nh.a.Mj(b.pageHeight,1),this.dPa.style.height=Math.round(b*this.tQ).toString()+"px")}s0a(){window.requestAnimationFrame(()=>
{var b=this.vIk;if(b){const h=rd.a.getElementBounds(b);this.dPa.style.height=h.height.toString()+"px";b=this.jPm(b);this.dPa.style.marginTop=b+"px"}})}jPm(b){b=b.getBoundingClientRect().y;const h=this.Sbf.getBoundingClientRect().y;return b-h}xef(){if(!this.dPa&&!this.M4){this.UJh=document.createElement("div");this.M4.id=Ns.ySk;this.M4.className=Ns.xSk;this.M4.setAttribute($c.a.Wja,WordEditorIntl.WordEditorStrings.L_Ruler);this.M4.setAttribute($c.a.Wh,$c.a.lUh);this.M4.classList.add("HideWACVerticalRulerContainer");
if(this.ZZi){var b=y.AFrameworkApplication.J.jb("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");Pc.a.oAa(b,!h)&&Sys.UI.DomElement.addCssClass(this.M4,Ns.fFk)}this.VJh=document.createElement("div");this.dPa.className=Ns.wSk;this.dPa.id=Ns.zSk;this.M4.appendChild(this.dPa);b=document.getElementById(Nk.a.pBc);b.insertBefore(this.M4,b.firstChild)}}static YG(){return new Ns(Wa.a.instance.Ta("Common.IZoomManager"),ed.a.jf,y.AFrameworkApplication.va,
Ol.UISurfaces.PFi,Wa.a.instance.resolve("WordEditor.IRulerContextMenu"),Bt.a.instance,Wa.a.instance.resolve("WordEditor.IMainViewModeManager"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc))}static get instance(){return null!=Ns.PYg?Ns.PYg:Ns.PYg=Ns.YG()}}Ns.ySk="WACVerticalRulerContainer";Ns.xSk="WACVerticalRulerContainer";Ns.zSk="WACVerticalRuler";Ns.wSk="WACVerticalRuler";Ns.fFk="ModernUxWACVerticalRulerContainer";Object(u.a)(Ns,"VerticalRuler",xu,[]);class bm{constructor(b,h,r,A,L,Z,oa,Ba,gb){this.TTe=
this.xWe=!1;this.UR="RulerActor";this.RCh=null;this.$fa=!1;this.uqk="ClearAllTabStopsFailed";this.$Eh="ShowHideRulerFailed";this.mVd=(Ab,Jb,Tb)=>{if(1===Tb)return 32;Ab=this.ga.Ob(Ec.a.fZb,2,null);32===Ab?(Tb=1,Jb=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,Jb)):(Tb=0,Jb=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,3014,15,Jb),bm.recordQosError(this.uqk,[bm.rja],Jb));const jc=new Map;jc.set("Command","ClearAllTabStops");
jc.set("Source",this.UR);jc.set("Response",Jb);xa.Health.instance.recordKpiUsage(uo.kpiName,Tb,uo.Baa,jc);return Ab};this.J7c=(Ab,Jb,Tb)=>{if(1===Tb)switch(Ab){case Ec.a.sjf:case Ec.a.Ouf:return 2;default:return 32}Jb=this.s6e.lIm();switch(Ab){case Ec.a.U2f:var jc=1;break;case Ec.a.Dug:jc=4;break;case Ec.a.$mf:jc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Ab=new EB.a(Jb,jc,0,1);Ab=this.ga.Qb(Ec.a.xnd,2,Ab);32===Ab?(Tb=1,Jb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",
az[jc],Jb.toString()),v.ULS.sendTraceTag(591213269,3014,50,Jb)):(Tb=0,Jb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",az[jc],Jb.toString()),v.ULS.sendTraceTag(591213270,3014,15,Jb));jc=new Map;jc.set("Command","InsertCustomTabStopRuler");jc.set("Source",this.UR);jc.set("Response",Jb);xa.Health.instance.recordKpiUsage(uo.kpiName,Tb,uo.Baa,jc);return Ab};this.A0b=(Ab,Jb,Tb,jc,Hc)=>{var hd;if(this.xWe||1===Tb&&Yj.a.iba(Jb.Lk))return 8;(null===(hd=y.AFrameworkApplication.J)||
void 0===hd?0:hd.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1))&&Jb.contextId!=kc.a.view&&(v.ULS.sendTraceTag(508359384,3014,15,String.format("context id: {0}",Jb.contextId)),Jb=new wr.a(ab.StaticActiveAppFrame.za().kb.Qc));return this.$fa?this.f6c(Ab,Jb,Tb,jc,Hc):this.H9o(Jb,Tb)};this.EKo=()=>{this.$fa?v.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.Ob(vb.a.A0b,2)?(v.ULS.sendTraceTag(574128527,
3014,50,"Ruler could not be enabled"),bm.recordQosError(this.$Eh,[bm.rja],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.f6c=(Ab,Jb,Tb)=>{if(1===Tb||!this.$fa)return 32;this.$fa=!1;this.t6e.jJj(!1);this.Aib.dispose();this.gge()&&this.lxf();this.V8j();v.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Ab=new Map;Ab.set("Command","HideRuler");Ab.set("Source",this.UR);Ab.set("Response","");xa.Health.instance.recordKpiUsage(uo.kpiName,
1,uo.Baa,Ab);return 32};this.Jre=(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return 32;Hc&&(Hc[Tg.a.On]=this.$fa);return 32};this.d7m=Ab=>{this.$fa=Ab.result};this.K$d=()=>{this.xWe=!1};this.QNi=()=>{this.xWe=!0};this.ga=b;this.Aib=h;this.Ebf=r;this.L3b=A;this.s6e=L;this.t6e=Z;bm.ul=Ba;this.m7b=oa;this.cT=gb;this.m7b.f2k(this.QNi);this.m7b.tPh(this.K$d)}initialize(){this.Xb();this.RCh=this.EKo;window.addEventListener("TurnRulerOnAction",this.RCh,!0);return this.t6e.xJm().continueWith(this.d7m,8)}Xb(){this.ga.qa(vb.a.A0b,
kc.a.view,this.A0b);this.ga.fb(vb.a.Jre,kc.a.view,this.Jre,96);this.ga.qa(Ec.a.sjf,kc.a.view,this.J7c);this.ga.qa(Ec.a.$mf,kc.a.view,this.J7c);this.ga.qa(Ec.a.mVd,kc.a.view,this.mVd);this.ga.qa(Ec.a.Ouf,kc.a.view,this.J7c);this.ga.qa(Ec.a.f6c,kc.a.view,this.f6c);this.ga.qa(Ec.a.U2f,kc.a.view,this.J7c);this.ga.qa(Ec.a.Dug,kc.a.view,this.J7c);my.a.jd.addHandler(my.a.Jme,this.Qfd.bind(this));this.cT.jRd(this.Rsc)}vRi(){this.$fa&&(this.Aib.ME(),this.Aib.renderRuler(),this.gge()&&this.xEj())}xEj(){this.Ebf.ME();
this.Ebf.renderRuler()}lxf(){this.Ebf.dispose()}gge(){return this.isPaginatedView()}gpp(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1)&&this.$fa&&Wa.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("LocateRulerActivity",null)})}jAc(){this.$fa||Wa.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}$Z(){this.m7b.tCo(this.QNi);this.m7b.gCo(this.K$d);this.$fa&&(this.Aib.dispose(),
this.gge()&&this.lxf())}V8j(){if(this.L3b){const b={};b[uo.SDp]="ToggleButtonModel";this.L3b.eJ(b)}}H9o(b,h){if(!bm.ul.Vaa(b.Lk))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),bm.recordQosError(this.$Eh,[bm.rja],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.$fa=!0;this.t6e.jJj(!0);this.vRi();this.V8j();v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.UR);
b.set("Response","");xa.Health.instance.recordKpiUsage(uo.kpiName,1,uo.Baa,b);return 32}isPaginatedView(){var b,h;return 1===(null===(b=this.cT)||void 0===b?void 0:b.Gv)||2===(null===(h=this.cT)||void 0===h?void 0:h.Gv)}Qfd(b,h){switch(h.documentMode){case "View":this.$fa&&(this.ga.Ob(vb.a.A0b,2),this.TTe=!0);break;case "Edit":this.TTe&&(this.ga.Ob(vb.a.A0b,2),this.TTe=!1)}}Rsc(b,h){if(bm.instance.$fa)switch(h.ybb){case 2:case 1:bm.instance.xEj();break;case 3:case 0:bm.instance.lxf()}}static recordQosError(b,
h,r){const A=Object.assign(new Na.a,{extendedProperties:new Map});r&&A.extendedProperties.set("exception",r);xa.Health.instance.recordQosError(b,h,!1,!0,!1,!1,A)}static YG(){return new bm(y.AFrameworkApplication.va,gt.instance,Ns.instance,ab.StaticActiveAppFrame.za(),Wa.a.instance.resolve("WordEditor.IRulerContextMenu"),Wa.a.instance.Oa("WordEditor.Ruler.IRulerSettingInfo"),Wa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Tq.a.instance,Wa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
bm.QXg?bm.QXg:bm.QXg=bm.YG()}}bm.ul=null;bm.rja="RulerInteractionFailed";Object(u.a)(bm,"RulerActor",null,[]);class BD{constructor(b,h){this.POc=null;this.Wbb=r=>r.result?r.result.Value.toString():"";this.rMa=r=>{if(r.Zo||r.Yi)v.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.POc=!1;else{r=r.result;const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1);"true"===r.toLowerCase()&&A&&v.ULS.sendTraceTag(508703490,
3014,50,"Roaming setting is set to true by default");""===r&&y.AFrameworkApplication.J&&(!A||appChrome.api.isSmallDevice()||appChrome.api.isVerySmallDevice()?r=y.AFrameworkApplication.J.jb("RulerDefaultOn"):(r="true",v.ULS.sendTraceTag(508703489,3014,50,"Enabling Ruler by default for undefined roaming setting for large screens")));this.POc="true"===r.toLowerCase();v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully.")}return this.POc};
this.dw=b;this.NK=h}xJm(){const b=new Pg.a;if(null==this.POc){if(this.o1i())return this.NK.Wcb($y.a.nmd).CWRCo(this.Wbb,0).CWRCo(this.rMa,8);b.gg(!1)}else b.gg(this.POc);return b.task}H4(b){this.NK.H4($y.a.nmd,new UB.a($y.a.nmd,b))}jJj(b){this.o1i()&&(this.dw.wna("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.H4(b)}o1i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,
3014,50,"User is anonymous ");else return!0;return!1}}Object(u.a)(BD,"RulerSettingInfo",null,[370]);class zL{constructor(){this.Fmh=this.Z=null}get name(){return"WordEditor.Ruler"}wc(b){this.Z=b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.Z.ia("WordEditor.Ruler.RulerSettingInfo",()=>new BD(this.Z.resolve("Box4.IRoamingServiceRequestManager"),this.Z.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.Z.resolve("Box4.IFeatureHelper").er.continueWith(()=>
{this.Ho()});this.Fmh=bm.instance.initialize();v.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Ho(){this.Fmh.continueWith(()=>{bm.instance.vRi();bm.instance.jAc();bm.instance.gpp()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){bm.instance.$Z();v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(u.a)(zL,"PackageManager",null,[0,1]);class CD{constructor(){this.rmc=this.Jcc=null}}Object(u.a)(CD,"CreatePickerCustomizationDictionaryOptions",
null,[1829]);class DD{}DD.mh="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(u.a)(DD,"InsertMediaM365DialogHtml",null,[]);class ny{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de){this.WM=de;this.jhb=null;this.QXf=this.eFd=!1;this.KUj=qe=>{if(qe.rawEvent&&(qe=qe.rawEvent.data))try{const oe=Sys.Serialization.JavaScriptSerializer.deserialize(qe,
!0),ge=oe.MessageId?oe.MessageId.toString():null;oe&&ge&&(ge===K.a.Emc||ge===K.a.FUf)&&this.KMc.start(ge===K.a.Emc?this.Pib:this.Rmh)}catch(oe){}};this.kxp=(qe,oe,ge,$d,lf)=>{if(1===ge)return 32;this.Hph?qe=CommonUIStrings.l_OneDriveName:""!==this.FCd?qe=this.FCd:(qe=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));lf[Um.a.LabelText]=qe;return 32};this.nxp=(qe,oe,ge,$d,lf)=>{if(1===ge)return 32;
if(!y.AFrameworkApplication.HYf())return lf[Um.a.Visible]=!1,32;this.Hph?qe=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.FCd?qe=String.format(CommonUIStrings.l_ChangePictureFromHost,this.FCd):(qe=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));lf[Um.a.LabelText]=qe;return 32};this.lxp=(qe,oe,ge,$d,
lf)=>{if(1===ge)return 32;y.AFrameworkApplication.J.$("InsertOnlinePictureEnabled")||(lf[Um.a.Visible]=!1);return 32};this.mxp=(qe,oe,ge,$d,lf)=>{if(1===ge)return 32;y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled")||(lf[Um.a.Visible]=!1);return 32};this.fze=(qe,oe,ge)=>{oe=this.XIc.value.fka(oe);if(1===ge)return oe&&this.Oib.xmn?32:8;if(2!==ge||!oe)return 8;this.jhb=eb.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");
qe=this.Ywm(qe,this.jhb);qe=this.Ddf(qe);qe=this.xDd.t3c(qe);qe.correlationId=this.jhb;qe.YUf=this.Smh;qe.Ota=1;return this.dze(qe,CommonUIStrings.L_PictureInsertTitle,this.Pib)};this.K8o=(qe,oe,ge)=>{qe=32===this.ga.Hf(oe,vb.a.JR,1,!1,null,null);if(1===ge)return qe&&this.Oib.TYi?32:8;if(2!==ge||!qe)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.dze(this.Qmh.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,
this.Rmh)};this.xUj=(qe,oe,ge)=>{qe=this.XIc.value.fka(oe);if(1===ge)return qe&&this.Oib.GYf?32:8;if(2!==ge||!qe)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.dze(this.Qmh.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.Pib)};this.bze=(qe,oe,ge)=>{oe=this.XIc.value.fka(oe);if(1===ge)return oe&&this.Oib.zmn?32:8;if(2!==ge||!oe)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");
this.jhb=eb.a.create();ge=y.AFrameworkApplication.J.$("StockImagesFreemiumExperienceIsEnabled")&&this.vK.isFreemiumUpsellEnabled();ge=this.eFd?1:ge?0:-1;qe=this.Hzm(qe,this.jhb,ge);qe=this.xDd.t3c(qe);qe.mh=DD.mh;qe.correlationId=this.jhb;qe.Ota=2;qe.YUf=this.Smh;qe.pTa=this.vK;qe.userLicenseType=ge;return this.dze(qe,CommonUIStrings.L_PictureInsertTitle,this.Pib)};this.gze=(qe,oe,ge)=>{oe=this.XIc.value.fka(oe);qe=Wa.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ge)return oe&&
!this.Oib.GYf&&qe&&qe.Q_f()&&!y.AFrameworkApplication.Ife?32:8;if(2!==ge||!oe||!qe)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.jhb=eb.a.create();ge=ny.QJh;oe=!1;y.AFrameworkApplication.IYf()&&(oe=this.hgm());const $d=new CD;$d.Jcc=oe;$d.rmc=!0;ge=qe.fYd(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,ge,"Insert Media",1,$d);qe.Q2c(ge).then(lf=>{if(null!=lf&&0<lf.length){const wf=[];for(let gi=0;gi<lf.length;gi++){const Di=
lf[gi][G.a.Ysj],Yl=lf[gi][G.a.Xsj],xk={};xk.Extension=Di;xk.OriginalUrl=Yl;xk.caption=Di;wf.push(xk)}this.Pib.uWa=vb.a.s6;this.Pib.p$a(wf)}});return 32};this.eze=(qe,oe,ge)=>{var $d=this.XIc.value.fka(oe);oe=Wa.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ge)return $d&&oe&&oe.Q_f()?32:8;if(2!==ge||!$d||!oe)return 8;ge=Wa.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");null!=ge&&ge.Q6l(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",
!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.jhb=eb.a.create();ge=ny.QJh;$d=new CD;$d.Jcc=!0;$d.rmc=!0;ge=oe.fYd(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,ge,"InsertPictureFromMobile",3,$d);oe.Q2c(ge).then(lf=>{if(null!=lf&&0<lf.length){var wf=[];const gi=qe===vb.a.Dbe;let Di=!1;const Yl=y.AFrameworkApplication.J.jb("PhoneLinkServiceEndpoint");for(let xk=0;xk<lf.length;xk++){const Vn=
lf[xk][G.a.Ysj],Dx=lf[xk][G.a.Xsj],qy={};qy.Extension=Vn;qy.OriginalUrl=Dx;qy.caption=Vn;wf.push(qy);Di||(Di=-1!==qy.OriginalUrl.indexOf(Yl))}this.Pib.uWa=vb.a.s6;this.Pib.p$a(wf);wf={};wf.InsertImageCount=lf.length;Di&&me.c(gi?vb.a.Yan:vb.a.Wnl,void 0,void 0,void 0,void 0,void 0,wf)}});return 32};this.KMc=A;this.gId=L;this.xDd=oa;this.Qmh=Ba;this.z1=gb;this.ga=b;this.XIc=Z;this.Hph=jc;this.FCd=hd;this.Oib=r;this.Pib=Ab;this.Rmh=Jb;this.Smh=Gd;(this.vK=Tb)&&this.vK.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(qe=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",qe)).then(qe=>{(this.eFd=qe)||this.vK.Cua("MsoPremiumStockImages",()=>{this.eFd=!0;v.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Xb(){(this.Oib.GYf||this.Oib.TYi)&&this.Oib.ymn&&this.dgo();this.Tvo();this.Svo();this.ga.fb(vb.a.w0h,kc.a.view,this.xUj,1284);this.ga.fb(vb.a.Mwj,
kc.a.view,this.nxp,1124);this.ga.fb(vb.a.SUf,kc.a.view,this.xUj,1284);this.ga.fb(vb.a.tng,kc.a.view,this.kxp,1124);this.ga.fb(vb.a.hbn,kc.a.view,this.K8o,1284)}Tvo(){this.ga.fb(vb.a.insertOnlinePicture,kc.a.view,this.fze,1284);this.ga.fb(vb.a.Abe,kc.a.view,this.bze,1284);this.ga.X3("word_insertOnlinePictures",!0,vb.a.insertOnlinePicture,kc.a.view,this.fze,b=>{ab.StaticActiveAppFrame.za().m2b(b,Object(D.a)(new mp.a,(new mp.a).Dqb,"getCommandById"))});this.ga.X3("word_insertOnlinePictures",!0,vb.a.Abe,
kc.a.view,this.bze,b=>{ab.StaticActiveAppFrame.za().m2b(b,Object(D.a)(new mp.a,(new mp.a).Dqb,"getCommandById"))});this.ga.fb(vb.a.hnf,kc.a.view,this.fze,1284);this.ga.fb(vb.a.jnf,kc.a.view,this.gze,1284);this.ga.X3("word_insertOnlinePictures",!0,vb.a.jnf,kc.a.view,this.gze);this.ga.fb(vb.a.knf,kc.a.view,this.bze,1284);this.ga.fb(vb.a.Kwj,kc.a.view,this.lxp,1284);this.ga.fb(vb.a.Lwj,kc.a.view,this.mxp,1284);this.ga.X3("word_insertOnlinePictures",!0,vb.a.hnf,kc.a.view,this.fze);this.ga.X3("word_insertOnlinePictures",
!0,vb.a.knf,kc.a.view,this.bze);this.ga.fb(vb.a.UUf,kc.a.view,this.gze,1284);this.ga.X3("word_insertOnlinePictures",!0,vb.a.UUf,kc.a.view,this.gze,b=>{ab.StaticActiveAppFrame.za().m2b(b,Object(D.a)(new mp.a,(new mp.a).Dqb,"getCommandById"))})}Svo(){y.AFrameworkApplication.IYf()&&(this.ga.fb(vb.a.Dbe,kc.a.view,this.eze,1284),this.ga.fb(vb.a.inf,kc.a.view,this.eze,1284),this.ga.X3("mso_insertMobileDevicePictures",!0,vb.a.Dbe,kc.a.view,this.eze,b=>{ab.StaticActiveAppFrame.za().m2b(b,Object(D.a)(new mp.a,
(new mp.a).Dqb,"getCommandById"))}),this.ga.X3("mso_insertMobileDevicePictures",!0,vb.a.inf,kc.a.view,this.eze,b=>{ab.StaticActiveAppFrame.za().m2b(b,Object(D.a)(new mp.a,(new mp.a).Dqb,"getCommandById"))}))}dgo(){y.AFrameworkApplication.ua.get_element().appendChild(this.gId.$7a);zc.a.addHandler(this.gId.$7a.contentWindow,"message",this.KUj);this.QXf=!0}Ywm(b,h){let r=0;y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb&&5===y.AFrameworkApplication.ua.Gb.Mk&&(r=12);const A=kg.a.Eg(y.AFrameworkApplication.lcid);
return String.format(y.AFrameworkApplication.J.appSettings.WordInsertPictureServiceEndpoint,b===vb.a.insertOnlinePicture?1:0,y.AFrameworkApplication.lcid,A?A.name:"en-us",y.AFrameworkApplication.buildVersion,h,r,y.AFrameworkApplication.J.jb("UserId"))}dze(b,h,r){try{return b.cze(h,r,void 0),v.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(A){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",
A.toString()),this.qq(le.a.aed,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}Hzm(b,h,r){if(vb.a.Abe===b)return b=this.z1.yXh(y.AFrameworkApplication.J.jb("InsertOnlineM365PictureEndpoint"),h.toString(),1,r),this.Ddf(b);b=this.z1.yXh(y.AFrameworkApplication.J.jb("InsertOnlineM365PictureEndpoint"),h.toString(),0,r);return this.Ddf(b)}qq(b,h,r){const A=new Ag.StandardDialog(!0);A.Au=y.AFrameworkApplication.Qfa;A.Bd=0;A.Ke(1,CommonUIStrings.l_DialogClose);A.Iy(b,
h,r,()=>{})}hgm(){const b=Wa.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.ykm():!1}dispose(){this.QXf&&this.gId.$7a.contentWindow&&(zc.a.removeHandler(this.gId.$7a.contentWindow,"message",this.KUj),this.QXf=!1)}Ddf(b){return this.WM&&this.WM.UO?(b=new qb.QueryStringBuilder(b),b.Ae("theme","4"),b.toString()):b}}ny.QJh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(ny,"InsertMediaActor",null,[10]);var cz=d(978);class oy extends cz.a{constructor(b,h){super(b,
Ma.a.getOrigin(h))}Ur(b,h){this.isEnabled()&&this.Lja(this.Keb)&&(this.Bv(b),this.LE(b,h))}}Object(u.a)(oy,"InsertMediaCrossDocumentMessenger",cz.a,[391,39,10]);class oK{getInstance(b,h){return new oy(b,h)}}Object(u.a)(oK,"InsertMediaCrossDocumentMessengerFactory",null,[388]);var dz=d(789);class ez{}ez.mh="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(ez,"InsertMediaDialogHtml",null,[]);var Cp;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(Cp||(Cp={}));Object(u.b)("HubbleAction",Cp);var dw;(function(b){b[b.unknown=0]="unknown";b[b.qVp=1]="bing";b[b.vPp=2]="M365";b[b.n5p=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.gae=5]="hubble"})(dw||(dw={}));Object(u.b)("InsertMediaProviders",dw);class vF extends Dg.a{constructor(b,h,r,A=null,L=!1){super(!1,!1,L);this.Az=null;this.mHc=!1;this.Acd=this.r3=
null;this.Tlf="KeepFocusDiv";this.OTd="KeepFocusStartDiv";this.correlationId=null;this.Ota=0;this.pTa=this.YUf=null;this.userLicenseType=0;this.NZe=null;this.K_n=()=>{this.r3&&(this.r3.style.visibility="visible",window.setTimeout(()=>{if(this.Oj){const Z=this.Oj.getElementById(this.OTd);Z&&Z.focus()}},0))};this.dga=Z=>{Z.keyCode===Sys.UI.Key.tab&&(Z.target.id!==this.Tlf||Z.shiftKey?Z.target.id===this.OTd&&Z.shiftKey&&(Z.preventDefault(),this.Oj.getElementById(this.Tlf).focus()):(Z.preventDefault(),
this.Oj.getElementById(this.OTd).focus()))};this.qjj=()=>{v.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.zOb(this.a6a);this.byb(1)};this.geg=()=>{this.Az&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Az.sendMessage(K.a.nNj,{["CustomHeaders"]:""}))};this.Kkj=()=>{this.Az&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Az.sendMessage(K.a.OZo,{["SessionId"]:y.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};
this.Jkj=()=>{this.Az&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Az.sendMessage(K.a.PSo,{["CID"]:""}))};this.e0n=()=>{this.pTa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.pTa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.yDd=b;this.W5b="";this.z1=r;this.Kxa=[];this.sJd=h;this.mh=A||ez.mh;this.Ig="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async cze(b,
h){this.W5b=b;this.mHc=!1;this.showDialog(this.W5b,null);this.r3=this.zjc(this.Bj("insertmediaframe"));if(!this.r3)throw this.zOb(this.a6a),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.OTd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.r3.parentNode.insertBefore(b,this.r3.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",
this.Tlf);b.setAttribute("tabindex","0");this.r3.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.cwf,"keydown",this.dga);this.r3.src=this.yDd;this.r3.style.width="100%";this.r3.style.height="100%";this.r3.frameBorder="0";y.AFrameworkApplication.J.$("ShowInsertMediaIframeWhenIframeIsReady")&&aa.a.nj?(this.r3.style.visibility="hidden",this.Acd=this.K_n,zc.a.addHandler(this.r3,"load",this.Acd)):this.r3.style.visibility=
"visible";this.zjc(this.Bj("WACDialogButtonPanel")).style.display="none";this.zjc(this.Bj("WACDialogTitleText")).style.display="none";2===this.Ota&&(this.zjc(this.Bj("WACDialogTitlePanel")).style.display="none",this.zjc(this.Bj("WACDialogBodyPanel")).style.padding="0");Sg.FocusManager.instance().$t().scope.IL=!0;this.Az=this.sJd.getInstance(this.r3.contentWindow,this.yDd);this.Az.Lja("https://osiziwuspersimmon002.blob.core.windows.net");this.Az.Lja("https://osizewuspersimmon001.blob.core.windows.net");
this.Az.Lja("https://osizpscuspersimmon000.blob.core.windows.net");this.Az.Lja("https://cdn.hubblecontent.msit.osi.office.net");this.Az.Lja("https://cdn.hubblecontent.osi.office.net");this.Az.Ur(K.a.mNh,r=>{this.Eij(r,Object(D.a)(h,h.p$a,"insertMediaCallback"))});this.Az.Ur(K.a.insert,r=>{this.vme(r,Object(D.a)(h,h.p$a,"insertMediaCallback"))});this.Az.Ur(K.a.JNh,r=>{this.Ylj(r)});this.Az.Ur(K.a.mwi,this.geg);this.Az.Ur(K.a.getSessionId,this.Kkj);this.Az.Ur(K.a.Yti,this.Jkj);this.Az.Ur(K.a.kUd,this.qjj);
2!==this.Ota||this.userLicenseType||(this.Az.Ur(K.a.fzn,this.e0n),this.NZe=this.pTa.Cua("MsoPremiumStockImages",r=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Az.sendMessage(K.a.iCp,{["LicenseTier"]:r.toString()})}));this.byb(3)}dispose(){this.pTa&&this.NZe&&this.pTa.iZb("MsoPremiumStockImages",this.NZe);this.Az&&(this.Az.dispose(),this.Az=null);this.Acd&&(zc.a.removeHandler(this.r3,"load",this.Acd),this.Acd=null);super.dispose()}Eij(b,h){v.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.z1.kao(b))this.Kxa.push(b),this.mHc&&(h(this.Kxa),this.mHc=!1)}qq(){const b=new Ag.StandardDialog(!0);b.Au=y.AFrameworkApplication.Qfa;b.Bd=0;b.Ke(1,CommonUIStrings.l_DialogOk);b.sw(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}byb(b){if(2===this.Ota){const r=y.AFrameworkApplication.J.jb("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new da.a,{name:"InsertedFiles",
int64:this.Kxa.length}));h.push(Object.assign(new da.a,{name:"MediaDetails",string:JSON.stringify(this.Kxa)}));h.push(Object.assign(new da.a,{name:"DialogResult",string:Cp[b]}));h.push(Object.assign(new da.a,{name:"DialogMode",string:this.BBi()}));h.push(Object.assign(new da.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new da.a,{name:"Provider",string:dw[this.Ota]||"Unknown"}));Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),
dataFields:h}))}}}BBi(){return 3===this.Ota?"Icons":5===this.Ota?"ExternalContent":"Images"}zjc(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}vme(b,h){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.zOb(this.a6a);h?this.Kxa&&50<this.Kxa.length?(this.qq(),this.byb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Kxa.length,dw[this.Ota])):this.Kxa&&0<
this.Kxa.length?(h(this.Kxa),this.byb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Kxa.length,dw[this.Ota])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.mHc=!0,h(this.Kxa),this.byb(2)):this.byb(2)}Ylj(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),Y.a.sendOtelEvent(Object.assign(new dz.a,{otelEvent:b})))}}Object(u.a)(vF,
"InsertMediaDialog",Dg.a,[385,10]);class iI{constructor(b,h){this.pVe=b;this.z1=h}t3c(b,h=!1){return new vF(b,this.pVe,this.z1,ez.mh,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(iI,"InsertMediaDialogFactory",null,[387]);class jI{constructor(b,h,r){this.sVi=!1;this.correlationId=null;this.Ota=0;this.YUf=null;this.Iyk=b;this.iRc=[];this.GCd=h;this.DGh=r.split(";")}async cze(b,h){Array.clear(this.iRc);b=this.Iyk.value;b.Lja(this.GCd);b.Bv(h.p6c);this.sVi||(b.LE(h.p6c,r=>{this.vme(r,h)}),
this.sVi=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.tbi,{["FileExtensionFilterList"]:this.DGh})}O_k(b){Array.contains(this.iRc,b)||this.iRc.push(b)}vme(b,h){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.Grj(b);const r=[];for(let A=0;A<b.length;A++){const L=b[A];h.vde(L,this.DGh)?r.push(L):this.O_k(h.qFi(L))}r&&r.length?h.p$a(r):v.ULS.sendTraceTag(20509843,352,
50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.iRc.length&&(h=this.iRc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.o$o(h))}o$o(b){const h=new Ag.StandardDialog;h.Bd=0;h.lV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(u.a)(jI,"InsertMediaFromHostManager",null,[385,10]);class $B{constructor(b){this.Ozk=
b}t3c(){throw Error.notImplemented();}getInstance(){return this.Ozk}}Object(u.a)($B,"InsertMediaFromHostManagerFactory",null,[386,387]);class aC{constructor(){this.$7a=document.createElement("iframe");this.$7a.src="about:blank";this.$7a.style.visibility="hidden";this.$7a.style.position="absolute";this.$7a.style.zIndex="-100"}}Object(u.a)(aC,"InsertMediaFromHostOneDriveHostFrame",null,[383]);class wA extends cz.a{constructor(b,h){super(b,"*"===h?h:Ma.a.getOrigin(h));this.oMh(K.a.Emc);this.oMh(K.a.FUf)}lue(){}}
Object(u.a)(wA,"InsertMediaFromOneDriveCrossDocumentMessenger",cz.a,[384,39,10]);class fz{}Object(u.a)(fz,"OnlineMediaSearchResult",null,[]);class py{yXh(b,h,r,A){const L=kg.a.Eg(y.AFrameworkApplication.lcid).name,Z=y.AFrameworkApplication.buildVersion,oa=F.a.HT(y.AFrameworkApplication.J.jb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ba=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;y.AFrameworkApplication.$c("ShIns226;ShIns226cf");
return String.format(b,y.AFrameworkApplication.lcid,L,Z,h,py.xIe,oa,A,r,Ba)}return String.format(b,y.AFrameworkApplication.lcid,L,Z,h,py.xIe,oa,A,r)}kao(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new fz,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||
"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}mao(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let A=0;A<b.length;A++){var r=b[A];r&&(r=Object.assign(new fz,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}Fig(b){const h=[];for(let A=0;A<b.data.files.length;A++){var r=b.data.files[A];
r&&(r=Object.assign(new fz,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0}),h.push(r))}return h}vde(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}Zfo(b){let h="";if(b)for(let r=0;r<b.length;r++){const A=b[r];A&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',A.OriginalUrl,A.Width,A.Height))}return h}}py.xIe=0;Object(u.a)(py,
"InsertMediaHelper",null,[382]);class kI{constructor(b,h,r,A,L){this.xmn=b;this.GYf=h;this.TYi=r;this.ymn=A;this.zmn=L}}Object(u.a)(kI,"InsertMediaSettingsManager",null,[]);class lI{constructor(b){this.hJc=vb.a.JR;this.ga=b}get uWa(){return this.hJc}set uWa(b){this.hJc=b}p$a(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Qb(this.uWa,2,b[h]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
b.length)}catch(h){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(u.a)(lI,"InsertOneDriveFileHandler",null,[369]);class wF extends lI{constructor(b){super(b)}get tbi(){return K.a.FUf}get p6c(){return K.a.uan}Grj(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}qFi(){Uc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}vde(){return!0}Xvj(b,
h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.p6c,r))}Jrj(b){const h=[];for(let r=0;r<b.data.files.length;r++){const A=b.data.files[r];if(A){const L={};L.DisplayText=String.format("{0}{1}",A.name,A.extension);L.Url=this.Y$l([A.urls.viewInBrowser,A.urls.open,A.urls.download]);h.push(L)}}return h}Y$l(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(u.a)(wF,"InsertOneDriveFileHelper",
lI,[368,369]);class xF{constructor(b,h,r,A){this.Jo=A;this.hJc=vb.a.s6;this.Qp=null;this.P1n=()=>{bd.a.kV&&this.Jo.XL([26],this.Yd)};this.ga=b;this.z1=h;this.Bja=r;bd.a.kV&&(this.Yd=fl.a.getInstance(Tc.a),rq.a.Rpg(this.P1n))}get Pb(){return this.ga}get Iw(){return this.Qp||(this.Qp=Wa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get uWa(){return this.hJc}set uWa(b){this.hJc=b}p$a(b){try{bd.a.kV&&this.Jo.cY([26]);v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",
b.length);const h=this.z1.Zfo(b);let r=2;if(h&&0<h.length){const A=new lj.DictionaryPropertySet;A.setValue(Od.a.XX,h);A.setValue(Od.a.Vfa,!0);if(this.Bja){const L=this.Bja.cqd();L.Ycc("insertOnlineImage");A.setValue(Od.a.Zya,L)}r=this.ga.Qb(this.uWa,2,A)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){v.ULS.lz(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}
Object(u.a)(xF,"InsertOnlineImageHandler",null,[369]);class bC extends xF{constructor(b,h,r,A=null){super(b,h,A,r)}get tbi(){return K.a.Emc}get p6c(){return K.a.Ian}Grj(b){return this.z1.mao(b)}qFi(b){return b.Type}vde(b,h){return this.z1.vde(b.Type,h)}Jrj(b){return this.z1.Fig(b)}Xvj(b,h,r){r=r(b);if(r.length){b=[];for(let A=0;A<r.length;A++){const L=r[A],Z={};Z.Extension=L.Type;Z.SourceUrl=L.OriginalUrl;Z.caption=L.Type;Z.SourceUrl=L.OriginalUrl;Z.Width=L.Width;Z.Height=L.Height;b.push(Z)}r={};
r.Items=b;h.sendMessage(this.p6c,r)}}}Object(u.a)(bC,"InsertOnlineImageHelper",xF,[368,369]);class pK{constructor(b,h){this.SDb=b;this.sJd=h}start(b){this.SDb.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.sJd.getInstance(window.frames[0].parent,
window.document.URL),r.Xvj(h,b,A=>r.Jrj(A))):v.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(u.a)(pK,"OneDriveFilePickerHelperV5",null,[367]);class ew{constructor(){this.wDd=this.Z=null}get name(){return"Box4.Media"}wc(b){this.Z=b;b.ia("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new aC).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new kI(Boolean.parse(y.AFrameworkApplication.J.appSettings.InsertOnlinePictureEnabled||
"false"),y.AFrameworkApplication.HYf(),!1,y.AFrameworkApplication.rBg(),y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new pK(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();b.ia("Box4.Media.InsertMediaActor",()=>new ny(y.AFrameworkApplication.va,y.AFrameworkApplication.J,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new rg.a(()=>Wa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),y.AFrameworkApplication.qab,y.AFrameworkApplication.Bta,
y.AFrameworkApplication.V2m,y.AFrameworkApplication.J.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new iI(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",()=>new $B(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();
b.ia("Box4.Media.InsertMediaFromHostManager",()=>new jI(new rg.a(()=>{if(y.AFrameworkApplication.rBg()){var r=Wa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").$7a;r=new wA(r.contentWindow,"*")}else r=y.AFrameworkApplication.N_;return r}),y.AFrameworkApplication.rBg()?Ma.a.getOrigin(window.document.URL):Ma.a.getOrigin(y.AFrameworkApplication.Ewb),y.AFrameworkApplication.J.appSettings.ImageFetcherSupportedExtensions)).ha();b.register(oK,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();
b.register(py,"Box4.Media.InsertMediaHelper").ha();b.ia("Box4.Media.InsertOnlineImageHelper",()=>new bC(y.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),new ck.b,b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Media.InsertOneDriveFileHelper",()=>new wF(y.AFrameworkApplication.va)).ha()}init(){this.wDd=this.Z.resolve("Box4.Media.InsertMediaActor");this.wDd.Xb()}dispose(){this.wDd&&this.wDd.dispose()}}Object(u.a)(ew,"MediaPackage",null,[0,1]);var yv=d(989);class wx{get name(){return"Box4.PlaceholderText"}wc(b){this.Z=
b;this.Z.ia("Box4.PlaceholderText.PlaceholderTextProvider",()=>new yv.a(ab.StaticActiveAppFrame.za().kb.Qc,this.Z.resolve("Box4.ObjectSpaceParagraphCollection"),this.Z.resolve("Box4.ITextRenderingStrategy"),this.Z.Ta("Common.Interface.IEditNotificationManager"),ed.a.jf.Tl.qf(12),this.Z.nf("Box4.IParagraphReader"))).ha()}init(){this.Z.resolve("Box4.PlaceholderText.PlaceholderTextProvider").init()}dispose(){}static main(){E.a.instance.Mc(new wx,4)}}Object(u.a)(wx,"PlaceholderTextPackage",null,[0,1]);
var mI=d(1868);class e{constructor(b,h,r,A){this.p9b=b;this.hja=h;this.EBk=r;this.vr=A;this.imj=()=>{(y.AFrameworkApplication.ZDj||this.Hbl())&&this.BAc()}}init(){e.Ibl&&this.EBk&&this.eY()}eY(){this.hja.ut(this.imj)}BAc(){this.hja.kS(this.imj)}Hbl(){var b;if(!this.p9b)return!1;const h=this.ssm();if(h){let r=h;if(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))r=new mI.a(h,!0);if(32===y.AFrameworkApplication.va.Qb(Za.a.Iua,
2,r)&&this.vr)return this.vr.execute(A=>{A.logActivity("AutoRenameDocumentCallout",null);y.AFrameworkApplication.pc.$b(new mf.a(5,1,12E4,()=>{A.logActivity("AutoRenameSentimentSurvey",null)},0,"floodgateSurveyForAutoRenameSentiment"))}),me.a("AutoRenameDocumentSuccess"),!0}return!1}ssm(){let b,h=this.p9b.mic();for(;h;){const r=h.node;if(0<Cd.ParagraphReader.textLength(r,9)&&(b=On.AParagraphNode.tsm(r.characterData.trim()),0<b.length))break;h=h.next}return b}static get Ibl(){var b;null===this.yKe&&
(this.yKe=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1));return this.yKe}}e.yKe=null;Object(u.a)(e,"AutoRenameExecutor",null,[]);class n{oon(b){var h;if(!y.AFrameworkApplication.BI)return!1;var r=y.AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended;r=0<=(null===r||void 0===r?void 0:r.toLowerCase().indexOf("new"));return(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocumentFileNew",
!1))?(h=y.AFrameworkApplication.sessionStartInfoSettings.SessionOrigin,h=0<=(null===h||void 0===h?void 0:h.toLowerCase().indexOf("wacfilenew")),(r||h)&&this.S8c(b)):r&&this.S8c(b)}S8c(b){return b.value.Vja(ab.StaticActiveAppFrame.za().kb.Qc.vd)}get name(){return"Box4.AutoRename"}wc(b){this.Z=b;this.Z.ia("Box4.AutoRename.AutoRenameExecutor",()=>new e(this.Z.resolve("Box4.ObjectSpaceParagraphCollection"),ed.a.jf.Tl.qf(12),this.oon(this.Z.nf("Box4.IParagraphReader")),b.Ta("Common.ISystemInitiatedFeedback"))).ha()}init(){this.Z.resolve("Box4.AutoRename.AutoRenameExecutor").init()}dispose(){}static main(){E.a.instance.Mc(new n,
20)}}Object(u.a)(n,"AutoRenamePackage",null,[0,1]);var C=d(354);class S{constructor(){this.cKo="getAddinShortcutsPreference";this.dKo="saveAddinShortcutsPreference";this.eKo="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Ngm=6E4;this.zke=this.yra=this.Bca=null}zFi(b){return String.format(this.eKo,y.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",b,y.AFrameworkApplication.rm)}executeRequest(b,h,r,A,L=null){return S.OT.oKb(b,h,L,null,r,A,!1,null,this.Ngm)}saveSetting(b,
h,r,A,L){return this.kJj(b,h,r,null,A,L)}startBatchUpdateScope(){this.zke=[]}saveShortcutInfoArrayBatch(b,h,r){this.hMo(r,b,h)}hMo(b,h,r){const A={action:"",addinId:"",ownerType:0};A.timestamp=(new Date).toUTCString();const L=this.getShortcutInfoArray(h.toString(),r.toString());b?(A.shortcutInfoArray=b,this.Cdf(h,r,b)):L&&(A.shortcutInfoArray=L);b={};b[h.toString()]=A;h=new C.a(r.toString(),b);this.zke.push(h)}commitBatchUpdateScope(){return this.hpd()?this.jMo().then(()=>{this.Mdc();return Promise.resolve(!0)}):
this.lMo().then(()=>{this.Mdc();return Promise.resolve(!0)})}jMo(){return this.getSetting().then(b=>{let h=null;if(b&&!({av:h}=H.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.zke){(b=h[r.key])||(b={});const A=r.value;for(const L of mb.a.CR(A))b[L]=A[L];h[r.key]=b}this.Bca=h;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(h)),Promise.resolve(!0)}catch(r){return v.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}lMo(){return this.uRo().then(b=>this.Bve(b))}uRo(){return this.RMf().then(b=>{let h=null;b&&(({av:h}=H.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.zke){(b=h[r.key])||(b={});const A=r.value;for(const L of mb.a.CR(A))b[L]=A[L];h[r.key]=b}this.Bca=h;return H.c(h)})}saveShortcutInfoArray(b,h,
r){return this.kJj(0,"","",r,b,h)}kJj(b,h,r,A,L,Z){const oa=this.hpd(),Ba={};Ba.action=r;Ba.addinId=h;Ba.ownerType=b;Ba.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(L.toString(),Z.toString());0===b&&A?(Ba.shortcutInfoArray=A,this.Cdf(L,Z,A)):h&&(Ba.shortcutInfoArray=h);b={};b[L.toString()]=Ba;L=new C.a(Z.toString(),b);return oa?this.iMo(L):this.kMo(L)}iMo(b){return this.getSetting().then(h=>{let r=null;if(h&&!({av:r}=H.d(h)).returnValue)return v.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.Bca=r;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(r)),Promise.resolve(!0)}catch(A){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",A),Promise.resolve(!1)}})}kMo(b){return this.tRo(b).then(h=>this.Bve(h))}tRo(b){return this.RMf().then(h=>{let r=null;h&&(({av:r}=H.d(h)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
r||(r={});r[b.key]=b.value;this.Bca=r;return H.c(r)})}saveSettings(b){this.Bca=H.a(b);this.Mdc();return this.hpd()?this.nJj(b):this.Bve(b)}nJj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}Bve(b){const h={};h.Wac=b;const r=H.c(h);return new Promise(A=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)A(!1);else{var L=this.executeRequest(this.zFi(this.dKo),
2,"SaveAddinShortcutsPreferenceRequest","38",r);L.continueWith(()=>{if(L.Zo||L.Yi)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),A(!1);else{var Z=L.result;void 0!==Z.args&&null!==Z.args&&void 0!==Z.args.data&&null!==Z.args.data&&Z.args.data.He===ha.a.qz?A(!0):A(!1)}})}}catch(Z){v.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",Z.toString()),A(!1)}})}getSetting(){const b=this.hpd();return this.Bca?Promise.resolve(H.c(this.Bca)):
b?this.TKm():this.RMf()}hpd(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser"),h=y.AFrameworkApplication.J.$("IsRoamingServiceEnabled");var r=y.AFrameworkApplication.J.jb("Puid");const A=y.AFrameworkApplication.J.jb("UserPrincipalName");r=!(void 0===r||null===r)&&!(void 0===A||null===A)&&0<r.length&&0<A.length;return b||!h||!r}TKm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",
b),Promise.resolve("")}}RMf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.zFi(this.cKo),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.Zo||r.Yi)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let L="";var A=r.result;A&&A.args&&A.args.data?A.args.data.He!==ha.a.qz?v.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",A.args.data.He):A.args.data.Pe?(A=H.a(A.args.data.Pe),A.Wac&&(L=A.Wac)):v.ULS.sendTraceTag(522739865,
0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(L)}})}catch(r){v.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.hpd(),r=this;return this.getSetting().then(A=>{let L=null;A&&(L=H.a(A));if(!L)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const Z of mb.a.CR(L)){A=L[Z.toString()];for(const oa of mb.a.CR(A)){const Ba=A[oa];if(Ba.addinId===b)delete A[oa.toString()];else if(0===Ba.ownerType&&Ba.shortcutInfoArray){const gb=Ba.shortcutInfoArray,Ab=new nb.a;for(let Jb=0;Jb<gb.length;++Jb)gb[Jb].addinId!==b&&Ab.add(gb[Jb]);Ba.shortcutInfoArray=Ab.toArray()}}mb.a.count(A)||delete A[Z]}r.Bca=L;r.ozo(b);return h?r.nJj(H.c(L)):r.Bve(H.c(L))})}Mdc(){if(this.Bca){this.yra=null;const r=this.Bca;for(const A in r){var b=A;const L=
r[A];for(const Z in L){var h=Z;const oa=L[Z];oa.shortcutInfoArray&&this.Cdf(parseInt(h),parseInt(b),oa.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({av:h}=H.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.Bca=h;this.Mdc();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,r){return this.Bca&&
(r=this.Bca[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.Bca&&(h=this.Bca[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.Mdc();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.yra)return Promise.resolve(!0);var r=this.yra[b];
if(!r)return Promise.resolve(!0);var A=r[h];r=A.modifiers;A=A.keyCode;const L=this.getShortcutInfoArray(r.toString(),A.toString());if(!L||!L.length)return Promise.resolve(!0);let Z=0;for(const oa of L){if(oa.addinId===b&&oa.action===h)break;++Z}if(Z>=L.length)return Promise.resolve(!0);L.splice(Z,1);return this.saveShortcutInfoArray(r,A,L).then(()=>{this.Mdc();return Promise.resolve(!0)})}Cdf(b,h,r){this.yra||(this.yra={});for(const A of r){r=A.addinId;const L=A.action;let Z=this.yra[r];Z||(Z={});
const oa={};oa.modifiers=b;oa.keyCode=h;Z[L]=oa;this.yra[r]=Z}}ozo(b){b in this.yra&&delete this.yra[b]}isActionCustomized(b,h){return this.yra&&(b=this.yra[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.yra&&(b=this.yra[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.Bca}static instance(){S.egf||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),S.egf=new S,S.OT=y.AFrameworkApplication.Fe);return S.egf}}S.egf=null;S.OT=null;Object(u.a)(S,
"AddinShortcutsPreferenceSettingHelper",null,[]);class ja{constructor(b,h){this.Jyd=null;new nb.a;this.Moh=!0;this.aCd=b;this.Mjh=h}aff(b){this.Mjh.addHandler("GoalChangedEvent",b)}ETn(){this.Mjh.raiseEvent("GoalChangedEvent")}cXf(b,h){return this.Jyd&&this.Moh?b in this.Jyd?this.Jyd[b]:"Formality"===h&&this.aCd.GMf().formality?!1:!0:!0}wTo(b,h){h===this.aCd.GMf().formality&&(this.Jyd=b,this.ETn())}Oxp(b){this.Moh=b}}Object(u.a)(ja,"GoalChangeSource",null,[342,343,344]);var ya=d(1607),kb=d(1722),
Rb=d(1436);class sc{constructor(b,h,r,A,L,Z){this.RQa=h;this.TFa=r;this.Re=b;this.LC=A;this.Sg=L;this.Pxk=Z;this.TFa.dTb()&&this.initialize()}initialize(){return this.LC.im().then(()=>{this.Re.ub(this,ya.a.getTypeName());this.Re.addHandler(this,kb.a.getTypeName())}).catch(b=>{this.Sg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}gH(b,h){if(h===Ip.a.getTypeName()||h===Rb.a.getTypeName())if(!b||!b.content)this.Sg.sendTraceTag(528274564,
2252,10,"Handled annotation is invalid");else if(gq.a.getTypeNameFor(b.content)===ya.a.getTypeName()||gq.a.getTypeNameFor(b.content)===kb.a.getTypeName())if(gq.a.getTypeNameFor(b.content)===ya.a.getTypeName()){var r=b.content;this.Sg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.RQa.wTo(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(gq.a.getTypeNameFor(b.content)===kb.a.getTypeName())if(b=
b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.Pxk.Oxp(!!r.supportType);return}this.Sg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Sg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(u.a)(sc,"GoalsAnnotationHandler",null,[114]);class Fc{constructor(b){this.Aa=b}dTb(){return this.Aa.$("EditorGoalsEnabled")}}Object(u.a)(Fc,"GoalsGate",null,[341]);var gd=d(1152),td=d(1159),Bd=d(1543);
class wd{}wd.qZd=0;wd.wZd="1.0";wd.settingType="Goals";Object(u.a)(wd,"GoalsConstants",null,[]);var te=d(1606);class Le{constructor(b,h,r,A,L){this.K9b=null;this.mYi=!1;this.pzh=b;this.cCd=h;this.Sg=r;this.TFa=A;this.YSe=L;this.TFa.dTb()?this.ppo():this.TFa.dTb()&&this.Iwg(wd.qZd,wd.wZd)}ppo(){new Promise(b=>{this.pzh.ODi(wd.settingType,h=>{this.qpo(h)?(this.Iwg(this.K9b.formality,this.K9b.version),b(this.K9b)):(this.Iwg(wd.qZd,wd.wZd),b(null))})})}qpo(b){this.mYi=!0;if(!b||!b.Kyb)return this.Sg.sendTraceTag(528274529,
2252,50,"No persisted goal is registered."),!1;b=b.Kyb.properties;var h=b.getValue(Vc.a.SSi);h=parseInt(h);b=b.getValue(Vc.a.TSi);if(!this.cCd.oMg(b))return this.Sg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.K9b=b=Object.assign(new te.a,{formality:h,version:b});this.Sg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}Iwg(b,h){b=Object.assign(new Bd.a,
{formality:b,version:h});this.YSe.MLj(b)}vLp(b){if(this.cCd.oMg(b.version)){var h=gd.a.uGl(b.version,b.formality.toString());this.pzh.ONh(Object.assign(new td.a,{Kyb:h,settingType:wd.settingType}))?this.K9b=b:this.Sg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Sg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}DAi(){this.mYi||this.Sg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");
return this.K9b}}Object(u.a)(Le,"GoalsPersistenceHandler",null,[340]);class Oe{constructor(b,h,r,A){this.Sg=b;this.ZSe=h;this.cCd=r;this.TFa=A;this.bCd=Object.assign(new te.a,{formality:wd.qZd,version:wd.wZd});this.M7e=this.TFa.dTb()}GMf(){this.M7e&&(this.M7e=!1,this.ZSe.DAi()&&(this.bCd=this.ZSe.DAi()));return this.bCd}wZo(b){this.M7e=!1;this.cCd.oMg(b.version)?(this.TFa.dTb()&&this.ZSe.vLp(b),this.bCd=b):(this.Sg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",
b.version),this.bCd=Object.assign(new te.a,{formality:wd.qZd,version:wd.wZd}))}}Object(u.a)(Oe,"GoalsProvider",null,[338,339]);class We{constructor(b,h,r,A){this.Re=b;this.LC=h;this.IY=r;this.Sg=A}MLj(b){b=Object.assign(new Ip.a,{parentPath:["Signal",Bd.a.getTypeName()],items:[Object.assign(new iu.a,{body:b})]});this.N0d(b)}N0d(b){this.LC.im().then(()=>{this.Wcf(b)}).catch(h=>{this.Sg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}Wcf(b){this.Re.activateAnnotation(ya.a.getTypeName(),
We.Ncc).then(()=>{this.IY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ka.a,{operation:b}))}).catch(h=>{this.Sg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}We.Ncc="GoalSelected";Object(u.a)(We,"GoalsSignalSender",null,[337]);class Xf{constructor(){Xf.Dbf=new RegExp(Xf.uSk)}oMg(b){return!!b.match(Xf.Dbf)&&1===b.match(Xf.Dbf).length}}Xf.uSk="[0-9]+[.]?[0-9]*";Xf.Dbf=null;Object(u.a)(Xf,"GoalsValidator",null,[336]);class Gg{constructor(){this.Z=
null}get name(){return"WordEditor.Goals"}init(){this.Z.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}wc(b){this.Z=b;this.Z.ia("WordEditor.Goals.GoalsValidator",()=>new Xf).as("WordEditor.Goals.IGoalsValidator").ha();this.Z.ia("WordEditor.Goals.IGoalsGate",()=>new Fc(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ia("WordEditor.Goals.GoalsProvider",()=>new Oe(this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.Z.resolve("WordEditor.Goals.IGoalsValidator"),
this.Z.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();this.Z.ia("WordEditor.Goals.GoalChangeSource",()=>new ja(this.Z.resolve("WordEditor.Goals.IGoalReader"),new Bf.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.Z.ia("WordEditor.Goals.GoalsPersistenceHandler",()=>new Le(this.Z.resolve("Box4.PersistenceSettingsManager"),this.Z.resolve("WordEditor.Goals.IGoalsValidator"),
this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.Z.ia("WordEditor.Goals.GoalsAnnotationHandler",()=>new sc(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Common.IUlsWrapper"),
this.Z.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();this.Z.ia("WordEditor.Goals.GoalsSignalSender",()=>new We(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){E.a.instance.Mc(new Gg)}}Object(u.a)(Gg,"WordEditorGoalsPackage",
null,[0,1]);var Ph=d(1856),Aj=d(636),Ih=d(1458);class Nm{constructor(){this.annotation=null;this.languages=new ek.a(Ja.a.vh())}}Object(u.a)(Nm,"CritiqueCountWrapper",null,[]);class Sk{constructor(){this.twa=new Ha.a}r5d(){return this.twa}oQi(b,h,r,A){if(this.twa.tb(r)){this.twa.K(r).annotation.count+=h;r=this.twa.K(r).languages;for(var L of A)r.add(L)}else L=Q.a.create().toString(),b=Object.assign(new Ih.a,{id:L,categoryName:b,count:h}),this.twa.add(r,Object.assign(new Nm,{annotation:b,languages:A}))}}
Sk.mj=389;Object(u.a)(Sk,"BaseCritiquesByTypeCounter",null,[328]);class hk extends Sk{constructor(b){super();this.LHb=new Oa.a;this.NNe=new Oa.a;this.CPd=b}HUm(b){const h=b.annotation;try{if(h&&Aj.a(gq.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===Ip.a.getTypeName()){this.CPd.CBo(h.parentPath,r);const A=r.M_.state;if(60!==A&&70!==A)return this.LHb.contains(h.id)&&this.LHb.remove(h.id),this.O5m(h.id,r),Ph.a.Azb(h,8),!0;this.LHb.add(h.id)}else if(b.opType===yq.a.getTypeName())if(this.LHb.contains(h.id))this.LHb.remove(h.id);
else if(this.Cci(r.typeId,h.id))return Ph.a.Azb(h,16),!0}}catch(r){Ph.a.$bd(r,[h],!0)}return!1}GUm(b){if((b=b.annotation)&&Aj.a(gq.a.getTypeNameFor(b.content))){const h=b.content,r=h.M_.state;if((60===r||70===r)&&!this.LHb.contains(b.id))return this.LHb.add(b.id),this.Cci(h.typeId,b.id)}return!1}O5m(b,h){this.NNe.add(b);b=new ek.a(Ja.a.vh());h.language&&b.add(h.language);this.oQi(h.categoryName,1,h.typeId,b)}Cci(b,h){if(!this.NNe.contains(h))return!1;if(!this.twa.tb(b))return v.ULS.sendTraceTag(589866503,
Sk.mj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.twa.K(b).annotation.count)return v.ULS.sendTraceTag(589866504,Sk.mj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.NNe.remove(h);this.twa.K(b).annotation.count--;return!0}}Object(u.a)(hk,"AlCritiquesByTypeCounter",Sk,[332,328]);var al=d(1672);class Cj extends Nv.a{constructor(b,
h,r,A,L,Z,oa,Ba,gb){var Ab;super();this.Re=b;this.CPd=h;this.EJe=r;this.Ieh=A;this.RQa=L;this.wxa=Z;this.tk=oa;this.Eda=this.bdh=!1;this.c1e=new Ha.a;this.eZn=(Jb,Tb)=>{this.CPd.HVm(Tb)&&(this.Eda=!0,this.r0())};this.dWn=(Jb,Tb)=>{this.EJe.HUm(Tb)&&this.k_b()};this.akj=()=>{this.k_b()};this.Fcg=(Jb,Tb)=>{this.EJe.GUm(Tb)&&this.k_b()};this.Rvb=()=>{this.k_b()};this.k_b=()=>{let Jb=!1;this.tk.le(()=>{var Tb=this.vom();const jc=new nb.a;for(const Hc of Tb)Tb=Object.assign(new al.a,{id:Hc.id,parentPath:qo.a.RNb,
content:Hc,annotationType:gq.a.getTypeNameFor(Hc)}),jc.add(Tb),Jb||(Jb=0<Hc.count);this.Re.vTo(jc)},"CC:SATH");!this.bdh&&Jb&&(Y.a.sendTelemetryEvent({...(new ka.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.bdh=!0)};this.Uhn=(Jb,Tb,jc)=>{const Hc=!this.RQa||this.RQa.cXf(Jb,jc);Jb=this.wxa&&this.wxa.instance?this.wxa.instance.bXf(Jb,jc,Tb.substr(1,Tb.length-2)):!0;return Hc&&Jb};null===Ba||void 0===Ba?void 0:Ba.aff(this.Rvb);gb.Zua(this,7);null===(Ab=this.wxa)||void 0===Ab?void 0:
Ab.execute(Jb=>{Jb.Bff(this.k_b)})}get index(){return 3}run(){this.Eda&&(this.k_b(),this.Eda=!1)}Cmj(){this.k_b()}$Cl(b){let h=0;if(({value:h}=this.c1e.Ec(b.categoryName,0)).returnValue)if(h!==b.count)this.c1e.W(b.categoryName,b.count);else return!1;else this.c1e.add(b.categoryName,b.count);return!0}vom(){const b=new Ha.a;var h=this.CPd.r5d();const r=this.EJe.r5d();this.gKg(b,h);this.gKg(b,r);this.Ieh&&(h=this.Ieh.r5d(),this.gKg(b,h));h=new nb.a;for(const A of b.values)this.$Cl(A)&&h.add(A);return h}gKg(b,
h){for(const L of h){h=L.value.annotation;const Z=L.key;var r=this.sRo(L.value.languages);if(!b.tb(h.categoryName)){var A=Q.a.create().toString();A=Object.assign(new Ih.a,{id:A,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,A)}this.Uhn(Z,r,h.categoryName)&&(r=b.K(h.categoryName),r.count+=h.count,r.countsByTypeId[Z]=(r.countsByTypeId[Z]?r.countsByTypeId[Z]:0)+h.count)}}sRo(b){const h=[];let r=0;for(const A of b)h[r++]=A;return H.c(h)}}Object(u.a)(Cj,"CritiquesCounter",
Nv.a,[330,331]);class Lg{constructor(b){this.k5=b}r5d(){const b=new Ha.a,h=new ek.a(Ja.a.vh()),r=Object.assign(new Ih.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.k5.lFc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new Nm,{annotation:r,languages:h}));return b}}Object(u.a)(Lg,"DictationCritiquesByTypeCounter",null,[329,328]);class mq extends Sk{constructor(b){super();this.Rgb=new Ha.a;this.Re=b}HVm(b){const h=qo.a.I7d(b.nodeId);if(!qo.a.Qf(h)){if(b.ppb&&
b.ppb.length){let r=null;for(const A of b.ppb)A.errorDetails.X$a()||(b=this.awi(A),qo.a.Qf(b)||(r||(r=new Ha.a),r.tb(b)||r.add(b,new nb.a),r.K(b).add(A)));this.Dci(h);r?this.uXo(h,r):this.Rgb.remove(h)}else{if(!this.Rgb.tb(h))return!1;this.Dci(h);this.Rgb.remove(h)}return!0}return!1}CBo(b,h){var r;if(({value:r}=this.Rgb.Ec(b,r)).returnValue)for(const L of r)if(b=L.value,0<b.count&&this.CHf(b.K(0))===h.categoryName)for(r=b.count-1;0<=r;r--){var A=b.K(r).end-b.K(r).Dc;b.K(r).Dc===h.range.start&&A===
h.range.length&&(A=this.awi(b.K(r)),this.twa.tb(A)&&(A=this.twa.K(A).annotation,A.count=Math.max(0,A.count-1)),b.removeAt(r))}}Dci(b){if(this.Rgb.tb(b))for(const r of this.Rgb.K(b)){var h=r.key;b=r.value;this.twa.tb(h)&&(h=this.twa.K(h).annotation,h.count=Math.max(0,h.count-b.count))}}uXo(b,h){const r=new Ha.a,A=new Ha.a;for(const L of h){h=L.key;A.add(h,new ek.a(Ja.a.vh()));for(const Z of L.value){const oa=Z.end-Z.Dc,Ba=this.CHf(Z);this.bpl(b,Ba,Z.Dc,oa)?v.ULS.sendTraceTag(589866513,Sk.mj,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,Z.Dc,oa):(r.tb(h)||r.add(h,new nb.a),r.K(h).add(Z),A.K(h).add(this.xom(Z)))}}this.Rgb.W(b,r);for(const L of this.Rgb.K(b))0<L.value.count&&(b=this.CHf(L.value.K(0)),this.oQi(b,L.value.count,L.key,A.K(L.key)))}awi(b){let h=null;b&&(b=Object(Ca.a)(326,b.errorDetails))&&b.wu&&(h=b.wu.TypeId);return h}CHf(b){let h=null;b&&(b=Object(Ca.a)(326,b.errorDetails))&&b.wu&&(h=b.wu.CategoryTitle);return h}xom(b){let h="";b&&b.errorDetails&&(h=kg.a.Eg(b.errorDetails.lcid).name);return h}bpl(b,h,r,A){if((b=
this.Re.w4d(b))&&0<b.count)for(const L of b)if(b=gq.a.getTypeNameFor(L.content),L&&Aj.a(b)&&(b=L.content,b.categoryName===h&&b.range.start===r&&b.range.length===A))return!0;return!1}}Object(u.a)(mq,"WacCritiquesByTypeCounter",Sk,[327,328]);class uk{constructor(){this.Z=null}get name(){return"WordEditor.CritiqueCounts"}wc(b){this.Z=b}init(){var b=this.Z.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.Z.ia("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new mq(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ia("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new hk(this.Z.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.Z.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.Z.ia("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new Lg(this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.Z.ia("WordEditor.CritiqueCounts.ICritiquesCounter",
()=>new Cj(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.Z.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.Z.Oa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.Z.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.Ta("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Cq.a.instance,this.Z.Oa("WordEditor.Goals.IGoalChangeSource"),this.Z.resolve("Box4.Graph.IGraphTransactionManager"))).ha();
b=this.Z.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.Z.resolve("Box4.Proofing.IErrorRangeEditor").yPh(b.eZn);this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").jPh(b.dWn);this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").iPh(b.Fcg);h&&(h=this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.VOh(b.akj),h.WOh(b.akj))}}dispose(){}static main(){E.a.instance.Mc(new uk)}}Object(u.a)(uk,"WordEditorCritiqueCountsPackage",null,[0,1]);class au{get name(){return"WordEditor.GraphicsEditor"}wc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new au)}}
Object(u.a)(au,"PackageManager",null,[0,1]);var ED=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",
attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",
attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]},xA=d(550);class yF{constructor(b){this.vuk={};this.Zb=b;this.VHb=new re.a}SUa(b,h){const r=this.Zb.Jwb,A=parseInt(b);return b&&A!==Vd.ActionManager.$yf?this.VHb.tb(r)?(b=this.VHb.K(r).qlc(A,h,2),32===b||1===b):!1:!1}xLa(b){const h=parseInt(b),r=this.Zb.Jwb;return b&&h!==Vd.ActionManager.$yf?this.VHb.tb(r)?
32===this.VHb.K(r).qlc(h,this.vuk,1):!1:!0}$Aj(b,h){this.VHb.W(b,h)}uSj(b){b=parseInt(b);const h=this.Zb.Jwb;return!!h&&!!this.VHb.K(h)&&this.VHb.K(h).Zgn(b)}}Object(u.a)(yF,"NonCanvasCuiUser",null,[1780,406]);var fw=d(1181),xx;(function(b){b[b.qSp=0]="UnspecifiedGallery";b[b.WMp=1]="CharacterCodeGallery";b[b.xOp=2]="FontStyleGallery";b[b.ZOp=3]="InkThicknessGallery";b[b.VOp=4]="IconGallery";b[b.qPp=5]="ListGallery";b[b.NRp=6]="TableStyleGallery";b[b.sQp=7]="PageNumberGallery";b[b.VMp=8]="ChangeColorsGallery"})(xx||
(xx={}));Object(u.b)("GalleryType",xx);class bu{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(u.a)(bu,"CommonGalleryButtonProps",null,[]);class zF extends bu{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(u.a)(zF,"AdditionalTableStyleGalleryButtonProps",bu,[]);class FD extends zF{constructor(){super()}}Object(u.a)(FD,"AdditionalChangeColorsGalleryButtonProps",zF,[]);class nI extends bu{constructor(){super();this.character=null}}
Object(u.a)(nI,"AdditionalCharacterCodeGalleryButtonProps",bu,[]);class Xu extends bu{constructor(){super();this.menuModel=this.previewStyleFontNameAndSize=this.previewStyleLabel=this.styleDisplayName=null}}Object(u.a)(Xu,"AdditionalFontStyleGalleryButtonProps",bu,[]);class yu{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(u.a)(yu,"AdditionalGalleryProperties",null,[]);class gw extends bu{constructor(){super();
this.largePreviewIconStyle=this.largeFullIconStyle=this.role=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(u.a)(gw,"AdditionalIconButtonProperties",bu,[]);class yA extends bu{constructor(){super();this.styleDisplayName=null}}Object(u.a)(yA,"AdditionalInkThicknessGalleryButtonProps",bu,[]);class gz extends bu{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(u.a)(gz,"AdditionalListGallerButtonProps",bu,[]);class ht extends bu{constructor(){super();
this.text=null}}Object(u.a)(ht,"AdditionalPageNumberGalleryButtonProps",bu,[]);var hw=d(1112);const hz=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(Ca.a)(Object,r[b])){if((b=Object(Ca.a)(String,r.value))&&b===h)return!1;b=Object(Ca.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let A=null;for(let L=0;L<r.length;L++){const Z=Object(Ca.a)(Object,r[L]);if(Object(Ca.a)(String,Z.key)===b){A=Z;break}}if(A&&Object(Ca.a)(String,A.text)===
h)return!1}}return!0},Os=(b,h,r,A)=>{if(0<(A&2)){A=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":A.push(it(b,r[Tg.a.On]));break;case "CheckboxModel":A.push(appChrome.actions.toggleCheckbox(b,r[Tg.a.On]));break;case "ComboBoxModel":if(!hz(b,r[xb.a.Value]))break;(h=r[xb.a.Key])?A.push(appChrome.actions.updateComboBoxKey(b,h,r[xb.a.Value])):A.push(appChrome.actions.updateComboBoxValue(b,r[xb.a.Value]));break;case "FontPickerModel":A.push(appChrome.actions.updateFontPickerSelectedFont(b,
r[hw.a.SelectedFont]));break;case "SplitButtonModel":A.push(it(b,r[jn.a.On]));break;case "SpinButtonModel":A.push(appChrome.actions.updateSpinButton(b,r[Ji.a.Number],Tf.a.Q6a(r[Ji.a.UnitType]),r[Ji.a.Text],r[Ji.a.MaxValue],r[Ji.a.Alt]));break;case "ColorPickerModel":A.push(appChrome.actions.updateColorPickerSelectedColor(b,r[Lm.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":A.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[je.a.Text]));break;case "CompoundButtonModel":r[Tg.a.Description]&&
A.push(appChrome.actions.updateCompoundButtonDescription(b,r[Tg.a.Description]));Tg.a.On in r&&A.push(it(b,r[Tg.a.On]));break;case "SliderModel":r.snapToStep?A.push(appChrome.actions.updateSliderSelectedValue(b,r[Si.Value])):A.push(appChrome.actions.updateSliderValue(b,r[Si.Value],r[Si.MinValue]||0,r[Si.MaxValue],r[Si.Text]));break;case "FlyoutAnchorModel":Jd.a.ImageIsVisible in r&&A.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[Jd.a.ImageIsVisible]));Tg.a.On in r&&A.push(it(b,r[Tg.a.On]));break;
case "InputBoxModel":A.push(appChrome.actions.updateInputBoxValue(b,r[gl.a.Text]))}h=A;var L=Object(Ca.a)(String,r[em.a.iconColor]);void 0!==L&&null!==L&&h.push(appChrome.actions.updateIconColor(b,L));AF(b,r,A);h=A;(L=Object(Ca.a)(Object,r[em.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,L));h=A;L=Object(Ca.a)(String,r[em.a.customTooltip]);void 0!==L&&null!==L&&h.push(appChrome.actions.setControlCustomTooltip(b,L));b=A;(r=Array.isArray(r[em.a.tpg])?r[em.a.tpg]:null)&&b.push.apply(b,r);
return A}return null},iz=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),it=(b,h)=>appChrome.actions.toggleButton(b,h),AF=(b,h,r)=>{h=Object(Ca.a)(String,h[em.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,h))};class oI{constructor(b,h,r,A){this.rl=A;this.Fxa=b;this.uB=h;this.y$b=r;this.dKc={}}Tdo(b,h,r,A,L=null){const Z=b.ExternalGalleryId||b.ExternalId;var oa=b.ExternalId;A.push(Z);if(appChrome.selectors.isControlDefined(Z))b.GalleryStyle&&eg.d("setGalleryStyles")&&
h.push(appChrome.actions.setGalleryStyles(Z,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(Z,Object.assign(new yu,{columns:b.Width,sections:[appChrome.api.gallerySection([],oa)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}r=0;if(eg.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){oa=[];A=[];const gb=[],Ab={};for(var Ba of b.GallerySections){oa.push(appChrome.api.gallerySection([],Ba.SectionId,Ba.Title));0===r&&Ba.GalleryButtons&&0<
Ba.GalleryButtons.length&&(r=Ba.GalleryButtons[0].Type);this.hEi(Ba.GalleryButtons,L,Ab);const Jb=this.Ndf(A,Ba.GalleryButtons,Ab);A.push.apply(A,this.MLf(Jb,Z,Ba.SectionId,!1,r,L,!0,Ab));gb.push.apply(gb,Jb)}h.push(appChrome.actions.setGallerySections(Z,oa));h.push.apply(h,A);h.push.apply(h,this.hJf(Z,xx[r],gb,null,5===b.Type,!0,null,Ab))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Ba=this.hEi(b.GalleryItems,L,null),h.push.apply(h,this.MLf(this.Ndf(h,b.GalleryItems,Ba),
Z,oa,!1,r,L,!1,Ba))}FGm(b,h){const r=[];let A=null,L=!1;if(!b)return null;const Z=this.Fxa.khd(this.uB,b.commandId,h);r.push(iz(b.externalUxCommand,!Z));if(b.previewControlIds){const gb=[];for(let Ab=0;Ab<b.previewControlIds.length;Ab++){var oa={},Ba=b.previewControlIds[Ab];oa.SourceControlId=Ba;const Jb=this.rl.getCommandByExternalUxId(Ba);this.V7d(Jb||b,oa);oa[je.a.On]&&(A=oa.SourceControlId,oa[je.a.HighlightOn]&&(L=!0));AF(Ba,oa,r);if(oa=Object(Ca.a)(lx.a,oa[je.a.GalleryButtonProps]))gb.push(oa),
Z&&(Ba=this.Fxa.khd(this.uB,oa.Command,h),oa.IsDisabled=!Ba)}0<gb.length&&r.push.apply(r,this.MLf(this.Ndf(r,gb),b.externalUxCommand,b.externalUxCommand,!0,gb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,A));L&&(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",A),r.push(appChrome.actions.highlightSelectedFontStyle(A)))}return r}Ndf(b,h,r=null){const A=[],L=[];for(let oa=0;oa<h.length;oa++){const Ba=h[oa],gb=xf.b(Ba.ExternalId)?
Ba.Id:Ba.ExternalId;A.push(gb);const Ab=r&&r[gb]?r[gb].result:-1;switch(Ba.Type){case 1:var Z=Ba;L.push(appChrome.api.createCharacterCodeGalleryButtonModel(gb,Object.assign(new nI,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,character:Z.Character,style:Z.Style,title:Z.Alt})));break;case 2:Z=Ba;L.push(appChrome.api.createFontStylesGalleryButtonModel(gb,Object.assign(new Xu,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,styleDisplayName:Z.LabelText,style:Z.Style,title:Z.Alt,previewStyleLabel:Z.PreviewStyleLabel,
previewStyleFontNameAndSize:Z.previewStyleFontNameAndSize,menuModel:Z.menuModel})));break;case 3:Z=Ba;L.push(appChrome.api.createInkThicknessGalleryButtonModel(gb,Object.assign(new yA,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,styleDisplayName:Z.LabelText,style:Z.Style,title:Z.Alt})));break;case 4:Z=Ba;L.push(appChrome.api.createIconGalleryButtonModel(gb,Object.assign(new gw,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,icon:[Z.Icon],role:Z.Role,fullIconStyle:Z.FullIconStyle,previewIconStyle:Z.PreviewIconStyle,
largePreviewIconStyle:Z.LargePreviewIconStyle,label:Z.LabelText,title:Z.Alt})));break;case 5:Z=Ba;L.push(appChrome.api.createListGalleryButtonModel(gb,Object.assign(new gz,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,infoAtLevel:Z.LevelInfo,ariaLabel:Z.Alt})));break;case 6:Z=Ba;L.push(appChrome.api.createTableStyleGalleryButtonModel(gb,Object.assign(new zF,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,tableCellStyles:Z.TableCellStyles,tableStyles:Z.TableStyles,title:Z.Alt,columns:Z.columns})));break;case 8:Z=
Ba;L.push(appChrome.api.createChangeColorsGalleryButtonModel(gb,Object.assign(new FD,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,tableCellStyles:Z.TableCellStyles,tableStyles:Z.TableStyles,title:Z.Alt})));break;case 7:Z=Ba,L.push(appChrome.api.createPageNumberGalleryButtonModel(gb,Object.assign(new ht,{disabled:-1!==Ab?1>(Ab&1):Z.IsDisabled,text:Z.Text,title:Z.Alt})))}this.rl.addCommandToMaps(Object.assign(new vt.a(gb,Ba.Command),{queryCommandId:Ba.QueryCommand,menuItemId:Ba.MenuItemId}))}b.push(appChrome.actions.addControls(L));
return A}MLf(b,h,r,A,L,Z=null,oa=!1,Ba=null){const gb=[];A?gb.push(appChrome.actions.populateGalleryItems(h,b)):(this.dKc[h]=!1,oa||(A=!0,appChrome.selectors.isControlDefined(h)&&(A=appChrome.selectors.getGalleryState(h),A=A.disableIndividualButtons?A.disableIndividualButtons:!0),gb.push.apply(gb,this.hJf(h,xx[L],b,null,5===L,A,Z,Ba))),gb.push(appChrome.actions.updateGallerySectionItems(h,r,b)));return gb}pum(b){return this.hJf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?
b.disableIndividualButtons:!0)}hJf(b,h,r,A,L,Z=!0,oa=null,Ba=null){const gb=[];if(b in this.dKc){if(this.dKc[b])return delete this.dKc[b],gb;this.dKc[b]=!0}let Ab=null,Jb=-1;if(r)({qri:Jb,returnValue:Ab}=this.dNh(h,r,gb,Z,oa,Ba));else if(A)for(const Tb of A)(r=({qri:Jb}=this.dNh(h,Tb.galleryButtons,gb,Z,null,Ba)).returnValue)&&(Ab=r);gb.push(appChrome.actions.updateGallerySelectedId(b,Ab));Z&&gb.push(iz(b,!1));L&&0<Jb&&gb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Jb));return gb}gEi(b,
h=null){const r={},A={};A.SourceControlId=b;A.Location=h;b=this.rl.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=A,r;b=this.V7d(b,A);r.result=b;r.props=A;return r}hEi(b,h=null,r=null){r||(r={});for(const A of b)b=xf.b(A.ExternalId)?A.Id:A.ExternalId,r[b]=this.gEi(b,h);return r}dNh(b,h,r,A,L=null,Z=null){let oa,Ba=null;oa=-1;let gb=!1;for(const Jb of h){var Ab=this.mum(b);h=Z&&Z[Jb]&&-1!==Z[Jb].result?Z[Jb]:this.gEi(Jb,L);const Tb=h.result;h=h.props;A&&r.push(iz(Jb,1>(Tb&1)));(Ab=Os(Jb,
Ab,h,Tb))&&r.push.apply(r,Ab);h[je.a.On]&&(Ba=Jb,h[je.a.HighlightOn]&&h[je.a.HighlightOn]&&(gb=!0));void 0!==h[em.a.labelText]&&null!==h[em.a.labelText]&&(Ab=this.rl.getCommandByExternalUxId(Jb),r.push(appChrome.actions.setControlLabel(Ab.externalUxCommand,h[em.a.labelText])));h[je.a.IsRtl]&&0>oa&&(oa=h[je.a.IsRtl])}gb&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ba),r.push(appChrome.actions.highlightSelectedFontStyle(Ba)));return{returnValue:Ba,qri:oa}}mum(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}V7d(b,h){h.MenuItemId=b.menuItemId;return this.Fxa.sua(this.uB,this.y$b,
b.commandId,b.queryCommandId,h)}}Object(u.a)(oI,"ReactGalleryPoller",null,[]);var BF=d(714),GD=d(665),yx=d(1725),cC=d(792),pI=d(1726);class zx{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(u.a)(zx,"PopulateFontPickerDataProps",null,[]);var Ax=d(292),Xl=d(1915);class cu{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1;this.secondaryText=null}}Object(u.a)(cu,"CommonOptionalButtonProperties",null,[]);class HD extends cu{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(u.a)(HD,"OptionalButtonProperties",cu,[]);class qI extends cu{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(u.a)(qI,"OptionalCompoundButtonProperties",
cu,[]);class qK extends cu{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(u.a)(qK,"OptionalErrorViewProperties",cu,[]);class rI extends cu{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(u.a)(rI,"OptionalFlyoutAnchorProperties",cu,[]);class rK extends cu{constructor(){super();this.isBanner=
null}}Object(u.a)(rK,"OptionalLabelProperties",cu,[]);class Bx extends cu{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(u.a)(Bx,"OptionalMultipActionButtonProperties",cu,[]);class sK extends HD{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(u.a)(sK,"OptionalPersonaButtonProperties",HD,[]);
class dC extends cu{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1;this.stylingParameters=null}}Object(u.a)(dC,"OptionalToggleButtonProperties",cu,[]);var Er=d(1728),Nd=d(1727),Cx=d(493);class qi{constructor(){this.q4h=this.actions=null;this.abk=!1}}Object(u.a)(qi,"PopulateActions",null,[]);class Zq{WGi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.yHm(b);case "InkButtonModel":return this.xHm(b);
case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}yHm(b){const h={};h[Tg.a.On]=appChrome.selectors.getButtonToggleState(b);return h}xHm(b){const h={};h[Tg.a.On]=eg.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(u.a)(Zq,"ReactStatePropsSelector",null,
[]);class Lw{constructor(b,h,r,A,L){this.Fxa=b;this.uB=h;this.y$b=r;this.rl=A;this.p9e={};this.mKk=new Zq;this.FHb=L}SVj(b){const h=b.populationProps.populateQueryCommandId;return b.populationProps.populateOnlyOnce&&h in this.p9e}$Hm(b,h,r=null){const A=[],L={};if(!this.SVj(b)){const Z=b.populationProps.populateQueryCommandId,oa={};oa.MenuId=b.externalUxCommand;oa.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Fxa.sua(this.uB,this.y$b,Z,Z,oa,this.Wwm(r))&1))if("FontPickerModel"===h)this.p9e[Z]=
!0,A.push(Lw.jGm(b,oa)),L[b.externalUxCommand]="FontPickerModel";else if(oa.MenuItems)switch(this.p9e[Z]=!0,h){case "ComboBoxModel":A.push(Lw.hGm(b,oa));L[b.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":A.push.apply(A,this.kJi(b.externalUxCommand,h,oa.MenuItems,L,r&&"location"in r?r.location:null))}}return Object.assign(new qi,{actions:A,q4h:L,abk:this.isShadowMenuOpen(r)})}DBi(b,
h,r,A,L,Z,oa,Ba,gb=null){let Ab=null;const Jb=[];xf.c(b.Title)||(Ab=b.Title);for(let Tb=0;Tb<b.ControlList.length;Tb++){const jc=Object(Ca.a)(no.a,b.ControlList[Tb]);if(!jc||jc.ExternalId)Z&&this.wmm(jc,Z),h.push.apply(h,this.iGm(jc,oa,Jb,L,r,A,gb))}return Ba?appChrome.api.menuSection(Jb,Ab,b.Lang):null}kJi(b,h,r,A,L=null){const Z=[],oa=[],Ba=[],gb=[];for(var Ab=0;Ab<r.MenuSectionList.length;Ab++){var Jb=Object(Ca.a)(hh.a,r.MenuSectionList[Ab]);Jb&&(Jb=this.DBi(Jb,Z,b,h,gb,A,oa,r.UpdateDynamically,
L),r.UpdateDynamically&&Ba.push(Jb))}Ab=null;r.MenuFooterSection&&(Ab=this.DBi(r.MenuFooterSection,Z,b,h,gb,A,oa,r.UpdateDynamically,L));r.UpdateDynamically&&Z.push(appChrome.actions.updateMenu(b,Ba,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,Ab,r.IsFlexLayout));0<oa.length&&Z.splice(0,0,appChrome.actions.addControls(oa));0<gb.length&&eg.d("setStatefulSplitButtonMruBypassControls")&&Z.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,gb));return Z}wmm(b,
h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Ca.a)(Cw.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}iGm(b,h,r,A,L,Z,oa=null){const Ba=[];switch(b.ControlType){case 14:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(A=Object(Ca.a)(cC.a,b),null!=A.IsBanner&&A.IsBanner&&this.Ado(Object(Ca.a)(cC.a,b),Ba,h,r));break;case 1:case 3:b=Object(Ca.a)(Mj.a,b);this.Ddo(b,Ba,h,r);b.MenuItemsStatefulData&&eg.d("setStatefulSplitButtonMenuItemsStatefulData")&&Ba.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(L,b.MenuItemsStatefulData));break;case 2:this.qeo(Object(Ca.a)(Cx.a,b),Ba,h,r);break;case 6:this.Edo(Object(Ca.a)(SJ.a,b),Ba,h,r);break;case 4:this.jeo(Object(Ca.a)(Bj,b),Ba,h,r);break;case 7:this.Gdo(Object(Ca.a)(Cw.a,
b),Ba,h,r);break;case 12:this.Ndo(Object(Ca.a)(yx.a,b),Ba,h,r);break;case 13:this.feo(Object(Ca.a)(pI.a,b),Ba,h,r);break;case 9:b=Object(Ca.a)(ni.a,b);this.Pdo(b,Ba,h,r);"StatefulSplitButtonModel"===Z&&A.push(b.ExternalId);break;case 8:this.FHb.Tdo(Object(Ca.a)(Oo.a,b),Ba,h,r,oa)}return Ba}Ado(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,
b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Xl.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new rK,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}Ddo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&
h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),b.SecondaryText&&h.push(appChrome.actions.setButtonSecondaryText(b.ExternalId,b.SecondaryText)),this.MRd()&&((r=this.zVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Xl.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Gb.a)(ix,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,
Object.assign(new qI,{iconSet:(new Xl.a(this.zVa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null,secondaryText:b.SecondaryText}))):(A=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new HD,{iconSet:(new Xl.a(this.zVa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,secondaryText:b.SecondaryText,
commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==A&&null!==A?A:!0})))),this.rl.addCommandToMaps(Object.assign(new vt.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&eg.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}Edo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.MRd()&&((r=this.zVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Xl.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new dC,{iconSet:(new Xl.a(this.zVa(b))).iconSet,
keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.rl.addCommandToMaps(Object.assign(new vt.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}Ndo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&
h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Xl.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new qK,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}feo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=
b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,r))):(r.push(appChrome.api.createMultiActionButtonModel(b.Id,
Object.assign(new Bx,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.rl.addCommandToMaps(new vt.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&this.rl.addCommandToMaps(new vt.a(b.ActionId,
b.ActionIdMapped)))}qeo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.MRd()&&((r=this.zVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Xl.a(r)).iconSet)),y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new dC,{iconSet:(new Xl.a(this.zVa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,
b.LabelText,Object.assign(new dC,{iconSet:(new Xl.a(this.zVa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))),this.rl.addCommandToMaps(Object.assign(new vt.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}jeo(b,h,r,A){A.push(b.ExternalId);A=this.HFm(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,
A,b.LabelText)):eg.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,A,b.LabelText,Object.assign(new sK,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}Pdo(b,h,r,A){A.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.MRd()&&((r=this.zVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new Xl.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{A=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const L=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new rI,{iconSet:(new Xl.a(this.zVa(b))).iconSet,
keytip:b.KeyTip,hideIcon:A,toggled:L,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.rl.addCommandToMaps(Object.assign(new vt.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new BF.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.kJi(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}Gdo(b,h,r,A){b.McuLayout&&A.push(b.McuExternalId);A.push(b.ExternalId);
A=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(A=this.mKk.WGi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.rl.addCommandToMaps(Object.assign(new vt.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),A=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.rl.addCommandToMaps(Object.assign(new vt.a(b.ExternalId,
b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const L=[];for(let Z=0;Z<b.Colors.length;Z++){const oa=b.Colors[Z],Ba=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",!1)?oa.Disabled:!1;Z<A?r.push(appChrome.api.colorPickerCell(oa.Color,oa.DisplayColor,oa.Alt,Ba)):L.push(appChrome.api.colorPickerCell(oa.Color,oa.DisplayColor,oa.Alt,Ba))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,
r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,L));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}zVa(b){return b.Image32by32Class?this.rl.vxi(b.Image32by32Class):b.Image16by16Class?this.rl.vxi(b.Image16by16Class):b.ExternalImageId}HFm(b){return b?Object.assign(new Nd.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,
isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new Er.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}Wwm(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}MRd(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static jGm(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,A)=>{Wa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(L=>
{L.isFeatureEnabled(Ax.a.IUb,!1).then(Z=>{let oa=h.fonts;Z||L.isFreemiumUpsellEnabled()||(oa=Me.a.nbk(oa,Ba=>Ba.fontType!==Ax.a.Ikg));Z=Object.assign(new zx,{commandId:b.externalUxCommand,fonts:oa,isSubscriber:Z,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});r(Z)}).catch(A)})}))}static hGm(b,h){const r=[];for(let A=0;A<h.MenuItems.MenuSectionList.length;A++){const L=h.MenuItems.MenuSectionList[A];L.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+
A.toString(),L.Title));for(let Z=0;Z<L.ControlList.length;Z++){const oa=Object(Ca.a)(GD.a,L.ControlList[Z]);oa&&r.push(appChrome.api.comboBoxItem(oa.MenuItemId,oa.LabelText,oa.Styles,oa.CommandValueId,oa.AriaLabel,oa.Data,oa.Disabled))}A<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+A.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(u.a)(Lw,"ReactPopulateQueryCommandPoller",null,[]);class du{constructor(b,h,r,A,L){this.rl=
r;this.Fxa=b;this.uB=h;this.y$b=A;this.FHb=L}ZHm(b,h,r){const A=[];if(this.nhn(h))b=this.ZLm(b,h,r),void 0!==b&&null!==b&&A.push.apply(A,b);else if(b){var L=this.V7d(b,r);em.a.visible in r&&A.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[em.a.visible]));A.push(iz(b.externalUxCommand,1>(L&1)));void 0!==r[em.a.labelText]&&null!==r[em.a.labelText]&&A.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[em.a.labelText]));void 0!==h&&null!==h&&(L=Os(b.externalUxCommand,
h,r,L),void 0!==L&&null!==L&&A.push.apply(A,L),"PeopleWell"===h&&this.RYk(b.externalUxCommand,r,A))}return A}nrm(b,h,r){const A=[];switch(h){case "FlyoutAnchorModel":var L=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var Z=appChrome.selectors.getSplitButtonState(b);if(Z=this.rl.getCommandByExternalUxId(Z.command))r=this.Fxa.khd(this.uB,Z.commandId,r),A.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),A.push(iz(b,!1));return A;default:return null}h=
!1;for(Z in L)if(L=this.rl.getCommandByExternalUxId(Z),xf.c(L))h=!0;else if(r.SourceControlId=L.externalUxCommand,this.Fxa.khd(this.uB,L.commandId,r))return A.push(iz(b,!1)),A;A.push(iz(b,!h));return A}ZLm(b,h,r){switch(h){case "PreviewGalleryModel":return this.FHb.FGm(b,r);case "GalleryModel":return this.FHb.pum(r)}return null}nhn(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}V7d(b,h){h.MenuItemId=b.menuItemId;return this.Fxa.sua(this.uB,this.y$b,b.commandId,b.queryCommandId,h)}RYk(b,h,
r){const A=h[Jd.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[Jd.a.LabelText];A&&0<A.length&&(h=String.format.apply(null,[h].concat(A)));r.push(this.rQm(b,h))}rQm(b,h){return appChrome.actions.updatePeopleWell(this.cmm(b),h)}cmm(b){const h=[];var r={};b=this.rl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Fxa.sua(this.uB,this.y$b,"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const A=r.ControlList[b],L={};
L.name=A.Alt;L.id=A.MenuItemId;L.description=A.Description;L.color=A.ImageBackColor;L.joinTime=A.JoinTimeInMS;L.imageUrl=A.ImageUrl;L.activeStatus=A.ActiveStatus;L.isAnonymous=A.IsAnonymous;L.canJump=A.CanJump;L.upn=A.Upn;h.push(L)}return h}}Object(u.a)(du,"ReactQueryCommandPoller",null,[]);var Co=d(1690);class tK{constructor(b,h,r){this.rl=b;this.uB=h;b=new Co.a;this.NOk=new Zq;this.FHb=new oI(b,this.uB,r,this.rl);this.LAh=new Lw(b,this.uB,r,this.rl,this.FHb);this.zAh=new du(b,this.uB,this.rl,r,
this.FHb)}nKa(){const b=[];if(!eg.c())return b;b.push.apply(b,this.pQm());var h=this.kqm();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.lqm();for(const A of r)b.push(appChrome.actions.updateControlEnabledDisabledState(A,!0)),delete h[A];b.push.apply(b,this.n9d(h))}return b}lhd(b,h){eg.c()&&(b=this.n9d(b,h),appChrome.api.dispatch(b))}akg(b,h,r=null){if(!xf.c(b)&&b.populationProps&&!this.LAh.SVj(b)){b=this.LAh.$Hm(b,h,r);if(!b.abk){let A;
(A=b.actions).push.apply(A,this.n9d(b.q4h,eg.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}n9d(b,h=0){const r=[],A={};if(eg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var L of appChrome.selectors.getActiveGroupIds())for(var Z of appChrome.selectors.getVisibleControlsInGroup(L))A[Z]=!0;for(const oa in b)L=oa,Z=b[oa],0===h&&A[L]&&(h=2),r.push.apply(r,
this.oQm(L,Z,h));return r}oQm(b,h,r=0){const A=[],L=this.rl.getCommandByExternalUxId(b);let Z={};appChrome.selectors.isControlDefined(b)&&(Z=this.NOk.WGi(b,h));Z[fw.a.jfb]=r;xf.c(L)?(Z.ExternalUxId=b,(b=this.zAh.nrm(b,h,Z))&&0<b.length&&A.push.apply(A,b)):(Z.MenuItemId=L.menuItemId,Z.SourceControlId=b);A.push.apply(A,this.zAh.ZHm(L,h,Z));return A}pQm(){const b=[],h=appChrome.selectors.getContextualTabIds(),r=appChrome.selectors.getActiveContextualTabIds();for(let L=0;L<h.length;L++){var A=this.rl.vNf(h[L]);
A&&(A=this.uB.xLa(A),0<=Array.indexOf(r,h[L])!==A&&b.push(appChrome.actions.activateDeactivateContextualTab(h[L],A)))}return b}kqm(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.rl.vNf(b);r&&(this.uB.xLa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}lqm(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.rl.Hum(r))for(const A of b)this.uB.xLa(A.commandId)||((b=A.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(A.externalUxGroupId)),
h.push.apply(h,b));return h}}Object(u.a)(tK,"ReactRibbonRootPoller",null,[1767]);class ID{constructor(b,h,r=null){this.uB=this.fGa=this.okb=null;this.$9b=h;b.dTa(this);this.tH=r}get wta(){this.fGa||(this.fGa=new Date,this.fGa.setTime(0));return this.fGa}set wta(b){this.fGa=b}get kca(){return 2}get tH(){return this.uB}set tH(b){this.uB=b}get Nuc(){this.okb||(this.okb=new tK(this.$9b,this.tH,this.kca));return this.okb}Cnb(){const b=document.activeElement;Je.a.isEditable(b)&&b.blur()}executeCommand(b,
h,r,A,L,Z,oa,Ba=2){xf.c(this.tH)||(L=new gm.a,L.CommandLocation=Ba,L.InvocationMethod=A,L.CommandTabName=r,h[fw.a.jfb]=Ba,this.tH.SUa(b,h,L,Z,oa),this.SDn(b,h))}nKa(){return xf.c(this.tH)?[]:this.Nuc.nKa()}xn(){const b=this.nKa();0<b.length&&(this.wta=new Date,appChrome.api.dispatch(b))}Wsd(){eg.c()&&this.Nuc.lhd({PeopleWell:"PeopleWell"},18)}Lsd(){}SDn(b,h){try{const r=Wa.a.instance.Oa("Common.ISystemInitiatedFeedback");if(r&&h){const A=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;
let L=(A?"_"+A:"")+(h.SqmControlId?"_"+h.SqmControlId:"");L=L.length?L:"_"+b;r.X4f("Ribbon"+L)}}catch(r){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(r?r.toString():""))}}}Object(u.a)(ID,"ReactRibbonRoot",null,[544,1768]);var MD=d(1608);class vI{constructor(b){this.Ubf=this.xTe=!1;this.ehb=null;this.$$g=!1;this.ES=null;this.axa=!1;this.XXn=h=>{h.Lb&&h.Lb.target&&"input"===h.Lb.target.tagName.toLowerCase()&&Sg.FocusManager.instance().RE("ribbon");return!1};this.J4e=b;Zf.a.instance.ub(od.a.dC,
this.t2c(),this.XXn);(b=Wa.a.instance.Ta("Common.IActionContextProvider"))&&b.execute(h=>{this.ES=h});y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&y.AFrameworkApplication.ua.Gb.tN?zk.a.get_instance().Sk(16,()=>{this.isReady?this.initializeContextualUI(this.t2c()):zk.a.get_instance().Sk(7,()=>{this.initializeContextualUI(this.t2c())})}):zk.a.get_instance().Sk(7,()=>{this.initializeContextualUI(this.t2c())})}get f3(){return this.axa}get isReady(){return y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
y.AFrameworkApplication.ua.Gb.tN?zk.a.get_instance().isCompleted(16)&&zk.a.get_instance().isCompleted(7):zk.a.get_instance().isCompleted(7)}zll(){if(this.$$g)return!0;try{return Promise.resolve(null),this.$$g=!0}catch(b){return!1}}sJg(b){if(!this.isReady||this.Ubf)return this.T5f("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.zll())return this.T5f("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(y.AFrameworkApplication.H_d||""!==y.AFrameworkApplication.dv)if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",
!1)||"DocGen"===y.AFrameworkApplication.dv||"ContentAssemblyView"===y.AFrameworkApplication.dv)return this.T5f("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.Ubf=!0;let h=Za.a.Qg;switch(b){case 1:h=Za.a.showContextMenu;break;case 0:h=Za.a.showFloatie;break;case 2:h=Za.a.Jxc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Ubf=!1;me.c(h)},0)});return!1}FJi(b){return Ol.UISurfaces.J8a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=
h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const A of b)Array.contains(h,A)||r.push(A);return r}return b})}showFloatie(b,h,r,A=null){let L=A;A||(L={});L.sharedApiStartTime=window.performance.now();this.sJg(0)||this.FJi(h).then(Z=>{if(0>=Z.length)return null;this.Uzg(Z).then(()=>{const oa={};oa.target=b;Ol.UISurfaces.J8a().then(Ba=>{appChrome.api.dispatch(Ba.showFloatie(oa,r,void 0,this.BKf(),L));this.axa=!0;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",
!1)&&y.AFrameworkApplication.va&&y.AFrameworkApplication.va.Ob(Za.a.L9i,2);return null})});return null})}showContextMenu(b,h,r=null,A=null){this.sJg(1)||this.STj(b,h,r,A)}STj(b,h,r=null,A=null){const L={};L.sharedApiStartTime=window.performance.now();this.Uzg(null).then(()=>{const Z={};Z.target=b;A&&(Z.directionalHint=A);Ol.UISurfaces.J8a().then(oa=>{appChrome.api.dispatch(oa.showContextMenu(Z,h,r,void 0,this.BKf(),L));return null})})}Ixc(b,h,r,A=null){const L={};L.sharedApiStartTime=window.performance.now();
this.sJg(2)||this.FJi(h).then(Z=>{0>=Z.length?this.STj(b,r,A):this.Uzg(Z).then(()=>{const oa={};oa.target=b;const Ba={};Ba.target=b;Ol.UISurfaces.J8a().then(gb=>{appChrome.api.dispatch(gb.showContextualUI(oa,Ba,r,void 0,A,this.BKf(),L));this.axa=!0;return null})});return null})}T5f(b){v.ULS.sendTraceTag(561394519,340,15,b)}Nwf(){this.isReady&&Ol.UISurfaces.isLoaded()&&Ol.UISurfaces.J8a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.isReady&&Ol.UISurfaces.isLoaded()&&
Ol.UISurfaces.J8a().then(b=>{this.axa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}jZc(){this.isReady&&Ol.UISurfaces.isLoaded()&&Ol.UISurfaces.J8a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.axa=!1;return null})}initializeContextualUI(b){return Ol.UISurfaces.J8a().then(h=>{this.xTe||(h.initializeContextualUI(b),this.xTe=!0);return null})}Uzg(b){if(!this.xTe)return this.initializeContextualUI(this.t2c()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);
return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var r=[];Ol.UISurfaces.J8a().then(A=>{r.push.apply(r,this.J4e.Nuc.n9d(A.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}t2c(){if(this.ehb)return this.ehb;this.ehb=MD.a("div");this.ehb.id="ReactContextualUIDiv";this.ehb.style.position="absolute";this.ehb.style.zIndex="1001";document.body.insertBefore(this.ehb,
document.body.firstChild);return this.ehb}BKf(){return this.ES?this.ES.contentType:"Unknown"}}Object(u.a)(vI,"ReactContextualUILauncher",null,[1769]);class wI extends GB.a{constructor(){super()}}Object(u.a)(wI,"FloatieBuildOptions",GB.a,[]);class xI extends Uv.a{constructor(){super()}}Object(u.a)(xI,"FloatieBuildContext",Uv.a,[]);var wK=d(1503);class kz extends Fp.a{constructor(b,h,r){super(b,h,r,null);this.h3n=A=>{this.Agl(A.xid,A.GWc);this.rR.ipi=this;this.rR.yn();this.rR.Tc.style.display="none";
this.placeholder.appendChild(this.rR.Tc);this.Pya.continueWith(()=>{this.Pya.result.xWb(this.rR)},11);Rk.a.instance.ub(od.a.kt,this.rR.Tc,Object(D.a)(this.rR,this.rR.yE,"onPointerDown"))};if(xf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get rR(){return this.root}L0o(b){this.root=b}zgl(){const b=new xI,h=new xH.a;h.cjd=1;h.handler=this.h3n;h.data=b;this.Cza.rve(h)}Agl(b,h){b=Jj.a.kla(b,Jj.a.Gfk);if(xf.c(b))throw Error.create("No floatie element was present in the data");
b=new Jj.a(b);this.L0o(new Fv(b.attributes[Jj.a.id],b.attributes));b=Jj.a.kla(b.node,Jj.a.iHe);this.llf(b,h)}llf(b,h){b=Jj.a.Gx(b);for(let r=0;r<b.length;r++){if(this.aXa(b[r]))continue;const A=this.rlf(b[r],h);this.rR.Wf(A)}}rlf(b,h){var r=new Jj.a(b);b=new wK.Group(this.rR,r.attributes[Jj.a.id],r.attributes[Jj.a.X0a],r.attributes[Jj.a.$Bc],r.attributes[Jj.a.R0a],!1,r.name===Jj.a.Jjk,!1,r.attributes);r=Jj.a.Gx(r.node);for(let A=0;A<r.length;A++)b.Wf(this.FTd(r[A],h));return b}FTd(b,h){b=new Jj.a(b);
var r=b.attributes[Jj.a.id];b=Jj.a.Gx(b.node);var A=2;2===b.length&&(A=3);r=new dj.a(this.rR,r,A,2,1);for(A=0;A<b.length;A++){const Z=new Jj.a(b[A]);var L=Jj.a.kla(Z.node,Jj.a.kBb);L=Jj.a.Gx(L);this.zlf(r.o8d(A+1),L,Z.attributes[Jj.a.id],h)}return r}zlf(b,h,r,A){for(r=0;r<h.length;r++){if(this.aXa(h[r]))continue;const L=new Jj.a(h[r]),Z=this.dka(h[r],A);Z&&b.Wf(Z.MW(L.attributes[Jj.a.aCc]))}}}Object(u.a)(kz,"FloatieBuilder",Fp.a,[]);class mr{constructor(b,h){this.Bw=null;this.Tvl=b;this.XNe=h;this.vZn=
this.dme.bind(this)}get rR(){return this.Bw}Fnb(b,h,r){h=new Eo.a(tj.a.Z5a,Box4Intl.Box4Strings,null,null,h);const A=new wI;A.bJ=r||{};A.bJ.floatieshadingColor=!1;const L=new kz(A,document.body,this.Tvl.cIj);L.Cza=new zH.a(b,h);L.zgl();this.XNe.execute(Z=>{L.rR.tH=Z});L.rR.swo(this.vZn);L.rR.Bvo(()=>[]);this.Bw=L.rR;return this.rR}}Object(u.a)(mr,"AFloatieInitializer",null,[]);class yI extends mr{constructor(b,h,r,A){super(h,r);this.Sjg=()=>{this.rR.xn()};this.ii=b;this.HK=A}Fnb(b,h,r){if(b=super.Fnb(b,
h,r))b.euc=!0,b.nqe=!0,b.preventDismissOnScroll=!0;this.ii.B5a(this.Sjg);return b}t7c(b,h,r=null){this.HK.OVh(()=>this.Fnb(b,h,r))}dme(){this.rR.euc=!0}}Object(u.a)(yI,"PasteFloatieInitializer",mr,[]);var FF=d(824);class Yu{WDa(b,h){this.$ll&&this.D7o(b,h,Yu.L7f,Yu.currentSelection)}D7o(b,h,r,A){switch(r){case 1:case 6:case 2:case 3:case 4:Yu.vyf.show(A,b,h)}}jdj(){switch(Yu.L7f){case 5:case 1:return!0;default:return!1}}RMl(){return Yu.L7f}get $ll(){return 1!==ab.StaticActiveAppFrame.za().state}static get vyf(){return null!=
Yu.lUg?Yu.lUg:Yu.lUg=Wa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static Zzm(b){if(!b)return 0;if(2===ab.StaticActiveAppFrame.za().mode){const h=b.Qa.node,r=hb.a.eb(h);r.Ks();return lu.e(r.currentNode)?2:y.AFrameworkApplication.J2b||!OC.isEmbeddedFileNode(h)||OC.isInvalid(h)?Yj.a.Pln(b.Qa)||Yj.a.XXf(b.Qa)?6:1:3}return 4}static get currentSelection(){return If.a.instance.gb.currentSelection}static get L7f(){return Yu.Zzm(Yu.currentSelection)}}Object(u.a)(Yu,"SelectionContextMenuProvider",
null,[1533]);class Pm{constructor(b,h){this.nqe=this.euc=!1;this.V5c=!0;this.bO=b;this.rl=h}get isVisible(){return this.bO.f3}get controls(){return null}dismissFloatie(){this.bO.dismissFloatie();return!0}Ozf(){}ieb(b,h,r,A,L=null){this.bO.showFloatie(Object.assign(new wj.a,{x:b.x,y:b.y}),this.AFf(r),r,L)}VPb(){return new Sys.UI.Bounds(0,0,0,0)}K6(){return this.dismissFloatie()}AFf(){return[]}}Object(u.a)(Pm,"ReactFloatie",null,[357,358]);class iG{constructor(b){this.Qyd=null;this.bO=b}dispose(){}K6(){this.bO.jZc();
return!0}showContextMenu(b,h){this.x0b(b,h.clientPoint,h.yg)}x0b(b,h,r){this.geb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}geb(b,h,r,A=null){this.Qyd?this.bO.Ixc(Object.assign(new wj.a,{x:h.x,y:h.y}),this.Qyd.AFf(r),r,b):this.bO.showContextMenu(Object.assign(new wj.a,{x:h.x,y:h.y}),r,b,A);this.Qyd=null}Jxc(b,h,r,A){this.Qyd=Object(Ca.a)(Pm,r);A.WDa(b,h);return!0}}Object(u.a)(iG,"ReactContextMenuController",null,[723,10]);var eJ=
d(477);class fJ{constructor(){this.lna=this.text=this.Vsa=null}}Object(u.a)(fJ,"BusinessBarButtonData",null,[]);class jG{constructor(){this.text=this.Vsa=null}}Object(u.a)(jG,"BusinessBarLinkData",null,[]);var Hu=d(746),$u=d(244);class Lt{constructor(b,h,r,A){this.whh=this.Jeh=this.Fhb=this.Ich=null;this.Nt=b;this.hwa=h;this.ga=r;this.Aa=A}qjg(){this.YUc();this.ZUc();this.wec()}ZUc(){}YUc(){const b=ab.StaticActiveAppFrame.za().kb.hd;b&&(this.Ich=this.xfb(this.Ich,1,2===ab.StaticActiveAppFrame.za().mode&&
b.XWf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}R3i(){return y.AFrameworkApplication.ua&&1===y.AFrameworkApplication.ua.mode}wec(){let b=null;if(10<=ed.a.jf.qK){if(ed.a.jf.Pca.$Va){var h=ed.a.jf.MGb;$u.a.OSb(h)?22===h?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===h||20===h?b=aa.a.Di?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===h?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===h?b=aa.a.Di?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:
Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===h&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):$u.a.KRf(ed.a.jf.Pca.oea)||ed.a.fn||this.R3i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}}else if(h=ab.StaticActiveAppFrame.za().kb.activeSection){const r=h.egd;$u.a.OSb(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=aa.a.Di?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:
23===r?b=aa.a.Di?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):$u.a.KRf(h.k5a)||ed.a.fn||this.R3i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.whh=this.xfb(this.whh,5,!!b,b)}kUj(b,h,r,A){b=this.hwa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.OQd(h,()=>{rd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});A&&(b.kka=A);this.Nt.Iz(b,!0)}t8o(b,
h,r){this.kUj(b,h,r,null)}F8o(b){b=this.hwa.create(null,b,null);b.closeable=!0;b.id=20;this.Nt.Iz(b)}N7o(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.Fhb||(this.Fhb=this.hwa.create(b,h,null),this.Fhb.closeable=!0,this.Fhb.id=27,this.Nt.Iz(this.Fhb))}y0m(){this.Fhb&&(this.Fhb=this.xfb(this.Fhb,27,!1,""))}IBg(b){this.Jeh=this.xfb(this.Jeh,30,!0,b)}xfb(b,h,r,A,L=!1,Z="",oa=null,Ba=null,gb=null){r?b?b.message=A:(b=this.hwa.create(Z,
A,null),b.id=h,b.closeable=L,oa&&b.addButton(oa.text,oa.Vsa,oa.lna),Ba&&b.OQd(Ba.text,Ba.Vsa),gb&&(b.kka=gb),this.Nt.Iz(b,!1)):b&&(this.Nt.removeEntry(b),b=null);return b}vdf(b){this.Nt.Iz(b,void 0)}}Object(u.a)(Lt,"BusinessBarController",null,[430]);class Bv extends Lt{constructor(b,h,r,A){super(b,h,r,A);this.gxa=null}TJf(b,h,r=null,A=null,L=null,Z=2){if(this.gxa)return null;this.gxa=this.hwa.create(h,r||"",null);this.gxa.id=6;this.gxa.image=Z;this.gxa.R9c=!1;b&&(this.gxa.errorCode=b);this.gxa.closeable=
!1;h=y.AFrameworkApplication.VE&&this.Aa.$("ShowFeedbackButtonOnKickoutBusinessBar");A?(this.gxa.addButton(A,L,""),h&&this.gxa.jOh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.sKi(b)})):h&&this.gxa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.sKi(b)},"");this.Nt.Iz(this.gxa,void 0,null,null,null);return this.gxa}sKi(b){v.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb(Za.a.yla,2,{["ErrorCode"]:b})}static get pj(){return pl.PageReader.instance}}
Object(u.a)(Bv,"BusinessBarController",Lt,[429,430]);class pw{static get Zhj(){const b=F.a.$i(kg.a.Eg(y.AFrameworkApplication.lcid).name);return pw.Son?String.format("https://support.office.com/{0}/client/results?Shownav=true&lcid=1033&ns=WDWAEndUser&version=15&omkt={0}&ver=15&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER&HelpID=WordODF",b):String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}static get Son(){if(null!=pw.a_g)var b=pw.a_g;else{var h;
y.AFrameworkApplication.$c("d932d186;491d2669");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogLearnMoreUrlChangeEnabled",!1);b=pw.a_g=b}return b}}Object(u.a)(pw,"OdtUtils",null,[]);class Yw extends Bv{constructor(b,h,r,A){super(b,h,r,A);this.AGb=this.oCb=this.iIc=this.Wth=this.WSa=this.cuh=this.kFh=null;this.JDk="https://go.microsoft.com/fwlink/?linkid=2134357"}qjg(){super.qjg();this.Wpl();this.tql()}ZUc(){const b=ab.StaticActiveAppFrame.za().kb.hd;
if(b){var h=ed.a.l3;if(ed.a.wt||ed.a.fn||h&&y.AFrameworkApplication.qw)this.kFh=this.xfb(this.kFh,4,Bv.pj.pab(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.cuh=this.xfb(this.cuh,3,Bv.pj.eab(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.Wth=this.xfb(this.Wth,8,Bv.pj.Nzl(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,!0),Bv.pj.dUb(b)?this.WSa||(this.WSa=this.hwa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,
null),this.WSa.id=14,this.WSa.closeable=!0,this.WSa.image=3,this.WSa.addButton(Box4Intl.Box4Strings.L_LearnMore,Hu.a.Ozn,""),this.Nt.Iz(this.WSa,!1)):this.WSa&&(this.Nt.removeEntry(this.WSa),this.WSa=null)}}Wpl(){if(Fl.a.Y9c){const b=pw.Zhj,h=this.hwa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,null);h.id=9;h.closeable=!0;h.WXk(b);this.Nt.Iz(h,!0)}}get Nun(){return this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",
!1)?aa.a.Oun:!1}tql(){this.Nun&&!this.AGb&&(this.AGb=this.hwa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.AGb.id=15,this.AGb.closeable=!0,this.AGb.R9c=!1,this.AGb.addButton(Box4Intl.Box4Strings.L_DownloadNow,Hu.a.Qup,""),this.Nt.Iz(this.AGb,!1))}u8o(b,h){if(ab.StaticActiveAppFrame.za().kb.hd){const r=new fJ;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.Vsa=()=>{b()};const A=new jG;A.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;
A.Vsa=()=>{rd.a.openWindow(4,y.AFrameworkApplication.privacyUrl)};this.iIc=this.xfb(this.iIc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,r,A,()=>{h()})}}G0m(){this.iIc&&(this.iIc=this.xfb(this.iIc,25,!1,""))}v7o(){if(ab.StaticActiveAppFrame.za().kb.hd){const b=new jG;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.Vsa=()=>{rd.a.openWindow(4,this.JDk)};this.oCb||(this.oCb=this.hwa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,
WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.oCb.id=32,this.oCb.closeable=!0,this.oCb.image=3,this.oCb.OQd(b.text,b.Vsa),this.Nt.Iz(this.oCb,!1))}}z7(b){return this.Nt.z7(b)}Iz(b,h){this.Nt.Iz(b,h)}}Object(u.a)(Yw,"BusinessBarController",Bv,[428,429,430]);class ws{constructor(){this.menuTargetType=null}}Object(u.a)(ws,"MenuTargetDescriptor",null,[]);class uf{static get iaa(){return null!=uf.tTg?uf.tTg:uf.tTg=Wa.a.instance.resolve("Box4.IContextMenuController")}static showContextMenu(b,
h){uf.iaa.showContextMenu(b,h)}static x0b(b,h,r){uf.iaa.x0b(b,h,r)}static geb(b,h,r,A=null){uf.iaa.geb(b,h,r,A)}}Object(u.a)(uf,"BaseContextMenu",null,[]);class wi extends uf{constructor(b,h,r,A=!1,L,Z=null,oa){super();this.ztj=(Ba,gb,Ab,Jb,Tb)=>{if(1===Ab)return 32;Ba=Tb.az;Tb=Tb.rd;gb=Object.assign(new Ee.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.OHl(gb,Ba,Tb.IsShadowMenuOpen);Tb.MenuItems=gb;return 32};this.Sjo=h;this.ko=r;this.Rkb=Z;this.dXe=A;this.Xb(b);this.zgb=
oa;wi.y4a[1]=vb.a.bAe;wi.y4a[2]=vb.a.G9d;wi.y4a[3]=vb.a.GAe}get vZl(){return mp.a.gZd}get uZl(){return mp.a.DXd}get wZl(){return mp.a.Ogd}get tyf(){return mp.a.Jig}Xb(b){b.fb(vb.a.dkg,kc.a.application,this.ztj,96);b.fb(vb.a.Btj,kc.a.application,this.ztj,96)}show(b,h,r){let A=null,L=new Sys.UI.Bounds(0,0,0,0);const Z=this.kHm(b);if(Z&&(b=b.Qa.node)&&(b=b.fg(Object(Kb.a)().Gd.Ic))){L=GG.a.Ev(b,Z.end);if(y.AFrameworkApplication.isRtl&&L.x>h.x||!y.AFrameworkApplication.isRtl&&L.x+L.width<h.x||L.y+L.height<
h.y)L=GG.a.Ev(b,Z.end-1);h.x=L.x+(y.AFrameworkApplication.isRtl?0:L.width);h.y=L.y+L.height;A=6}uf.geb("ContextMenu",new Sys.UI.Bounds(h.x,h.y,L.width,L.height),r,A)}T2(b,h){return this.ypd(b)||wi.uec(vb.a.mergeCells)||wi.uec(vb.a.aOa)||this.uCg(b)||this.NTj(b,h)||wi.CUj()||wi.pUj(b).returnValue}ypd(b){return 2===ab.StaticActiveAppFrame.za().mode&&this.N9c(b)}OXc(b,h,r=null){if(zt.nD()&&2===ab.StaticActiveAppFrame.za().mode){h=this.zgb.C7h(b.Qa);if(!h||!this.Arn()&&!this.btn(h.errorDetails))return;
h=h.errorDetails}else{if(!this.ypd(b))return;h=this.EEi(b)}var A=kg.a.Eg(h.lcid);const L=A?A.name:"UNKNOWN";A=Object(Gb.a)(Vo.a,h)?h.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,A,L);if(b=this.Sjo.yfc(b,h))r.push.apply(r,b),this.pHn(h,A)}btn(b){return b&&(1===b.proofingType||2===b.proofingType)}Arn(){y.AFrameworkApplication.$c("gec07842;ae49c383");return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}pHn(b,h){const r=wi.y4a[b.proofingType];r&&(y.AFrameworkApplication.va.Ob(r,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,zt.nD()))}EEi(b){return this.ko.msa(b.Qa).errorDetails}N9c(b){return this.ko.bwe(b)}Ajc(){return null}$Xd(){}kHm(b){return this.N9c(b)?this.ko.msa(b.Qa):(b=this.Ajc(b))?new ic.a(b.vu,b.cpEnd):null}uCg(b){if(2!==ab.StaticActiveAppFrame.za().mode||!b)return!1;b=Pv.a.IIa(b.toArray());
return!!Object(Nl.a)().EW(b,14)}aVj(b,h){return 2===h||3===h&&!this.N9c(b)}NTj(b,h){return 3!==h||this.N9c(b)}pEl(){const b=[];b.push(Object.assign(new Mj.a,{ExternalId:this.vZl}));b.push(Object.assign(new Mj.a,{ExternalId:this.uZl}));b.push(Object.assign(new Mj.a,{ExternalId:this.wZl}));return b}$Il(){const b=[];this.dXe&&b.push(Object.assign(new Mj.a,{ExternalId:this.tyf}));return b}static get Pd(){return null!=wi.t0g?wi.t0g:wi.t0g=Wa.a.instance.resolve("Box4.List.IListReader")}static get Oln(){null==
wi.zWe&&(wi.zWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return wi.zWe}static get Kdd(){null==wi.vBb&&(wi.vBb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return wi.vBb}static get tya(){null==wi.Xca&&(wi.Xca=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return wi.Xca}static uec(b){return 32===y.AFrameworkApplication.va.Ob(b,1)}static CUj(){return 2===
ab.StaticActiveAppFrame.za().mode&&!!ed.a.EB.FJ&&ed.a.EB.FJ.D$c(vb.a.eoe.toString())}static EUj(b){if(1!==b.length||!b.Qa.Al)return!1;b=hb.a.eb(b.Qa.node);b.zb(11);b.uc();return(sf.ListItemReader.De?sf.ListItemReader.Fg(b):b.zu(4))&&!wi.Pd.Uw(b).listType?!0:!1}static pUj(b){let h=!1,r=!1;if(!b)return{returnValue:!1,Krb:h,z6c:r};if(wi.Kdd)return wi.E8o(b,r);if(!(b.Nw||wi.Oln&&2===b.length&&b.Xc.contextId===kc.a.Zc))return{returnValue:!1,Krb:h,z6c:r};b=b.Qa.clone();h=32===y.AFrameworkApplication.va.Hf(b,
vb.a.$bb,1,!0,null,null);r=32===y.AFrameworkApplication.va.Hf(b,vb.a.JR,1,!0,null,null);return{returnValue:h||r,Krb:h,z6c:r}}static E8o(b,h){let r;h=b.Qa.clone();r=wi.tya&&xl.l(h);let A=!r&&32===y.AFrameworkApplication.va.Hf(h,vb.a.$bb,1,!0,null,null);if(b.Nw||2===b.length&&b.Xc.contextId===kc.a.Zc)h=!r&&32===y.AFrameworkApplication.va.Hf(h,vb.a.JR,1,!0,null,null);else{h=!0;const L=b.length;for(let Z=0;Z<L;Z++){const oa=b.K(Z).clone();if(oa.contextId===kc.a.paragraph||oa.contextId===kc.a.Cd)(r=wi.tya&&
xl.l(oa))||(h=32===y.AFrameworkApplication.va.Hf(oa,vb.a.JR,1,!0,null,null)&&h);else if(oa.contextId!==kc.a.Zc)return h=A=!1,{returnValue:!1,Krb:A,z6c:h}}}return{returnValue:A||h,Krb:A,z6c:h}}static EBi(b){const h=Object.assign(new hh.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new Mj.a,{ExternalId:r}));return h}static oE(b){const h=[];for(const r of b)h.push(Object.assign(new Mj.a,{ExternalId:r}));return h}}wi.zWe=null;wi.vBb=null;wi.Xca=null;wi.y4a=[];Object(u.a)(wi,"AEditSurfaceContextMenu",
uf,[]);var Kx=d(724),qq=d(1492),Cz=d(1801),vC=d(1032);class qw{static Jgm(b,h,r){return r.J.$("AddInCommandsIsEnabled")?(h=[],qw.uDl(b,Fl.a.hm.kb.Qc.lb.J0,h),h):[]}static uDl(b,h,r){2===Fl.a.hm.mode&&ik.iNh&&(h=hb.a.eb(h),ik.iNh(r,b,h))}static sGm(b,h,r){h=[];r.sgo.yfc(r.xhm(b),h);return h}static dqm(b,h,r){const A=[];if(r.ypd(b))return A;kn.a.qLa&&!aa.a.As||r.iwf.$Xd(b,null,h,A);return A}static HLm(b,h,r){const A=[];r.OXc(b,h,A);return A}}Object(u.a)(qw,"ContextMenuSectionHelper",null,[]);class Rh{static Spm(b,
h,r){h=[];r.QSl(b)&&h.push(Object.assign(new Mj.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.JIm(b)}));return h}static gAm(){return wi.uec(vb.a.mergeCells)?wi.oE(["MergeCells"]):wi.uec(vb.a.gAe)?wi.oE(["SplitCells"]):[]}static INm(){return wi.uec(vb.a.Uze)&&(y.AFrameworkApplication.$c("4aah1391;h7hg6461"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableSortInContextMenuEnabled",!1))?wi.oE(["Sort"]):[]}static tPm(b,h,r){h=[];if(!r.ti.f6h(b))return h;b=r.ti.OIi(b);
h.push(Object.assign(new Mj.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new Mj.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static Mkm(b,h,r){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&
b&&b.Qa&&b.Qa.node&&r.Ac&&r.Ac.Rgj(b.Qa.node)?wi.oE(["ShowCatchUpActivitiesForParagraph"]):[]}static Lqm(b){return ik.R7o(b)?wi.oE(["Draw"]):ik.tUj(b)?wi.oE(["EditIllustration"]):[]}static qSm(b){return ik.v$o(b)?[Object.assign(new ni.a,{ExternalId:"WrapTextMenu"})]:[]}static CIm(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isResetPictureEnabled",!1)&&ik.C9o(b)?wi.oE(["ResetPictureEdits"]):[]}static e8d(b,h,r){return r.iTl(b)?wi.oE(["CreatePullQuote"]):[]}static getContentControls(b,
h,r){return r.PSl()?wi.oE(["RemoveContentControl"]):[]}static Cmm(){return wi.oE(["NewComment"])}static glm(b){const h=[];!ik.tCg(b)&&ik.WBg(b)&&cc.SessionStatusManager.instance.WA&&b.FL&&h.push(Object.assign(new ni.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static cxm(b,h,r){h=[];!ik.tCg(b)&&ik.WBg(b)&&cc.SessionStatusManager.instance.WA&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.FL&&!y.AFrameworkApplication.J.$("ChangePicturesIsEnabled")?
h.push(...wi.oE(["ChangePicture"])):h.push(...r.YGl().ControlList),(b=ik.Yzi())&&0<b.length&&(r=r.RKl(b),null!=r&&h.push(...r.ControlList)));return h}static gHm(){return wi.CUj()?wi.oE(["SetProofingLanguage"]):[]}static SIm(b,h,r){return r.yrn&&r.D9o(b)?wi.oE(["Rewrite"]):[]}static Mym(b){return wi.EUj(b)?wi.oE(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static REm(){return ik.OUj()?wi.oE(["ParagraphOptions"]):[]}static Xvm(b){return ik.tUj(b)?wi.oE(["EditIllustration"]):[]}static xLm(b){return ik.tCg(b)?
wi.oE(["ShowSmartLookupPane"]):[]}static EPm(b){return ik.HUj(b)?wi.oE(["ModernTranslatorSplitButton"]):[]}static fvm(b,h,r){h=[];if(b.Nw){const A=b.Qa;if(A.contextId===kc.a.paragraph||A.contextId===kc.a.Vc||A.contextId===kc.a.Cd){b=b.Qa.node;if(!r.Og.Wb(b)||b.Fq||""===b.characterData)return h;r.wXl.o6d(b)&&h.push(...wi.oE(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(b.Nw){const A=b.Qa;(he.a.mf(A)||he.a.B$a(A))&&r.iel.N5d(b.Qa.node,b.Qa.cpBegin)&&(h.push(...wi.oE(["DeleteBookmarkContextMenu"])),
h.push(...wi.oE(["EditBookmarkNameContextMenu"])))}return h}static mla(b){let h=!1,r=!1;const A=[];({Krb:h,z6c:r}=wi.pUj(b)).returnValue&&(h?r?A.push(...wi.oE(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):A.push(...wi.oE(["OpenHyperlink"])):r&&(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")?A.push(...wi.oE(["InsertLinkFlyout"])):A.push(...wi.oE(["InsertLink"]))));return A}static Xlm(b,h,r){const A=[];
if(!r.NTj(b,h))return A;2===ab.StaticActiveAppFrame.za().mode?(A.push(...r.pEl()),A.push(...r.$Il()),3===h&&r.N9c(b)&&A.push(Object.assign(new Mj.a,{ExternalId:"Delete"}))):(!y.AFrameworkApplication.dV&&!y.AFrameworkApplication.cG||y.AFrameworkApplication.hpb)&&A.push(Object.assign(new Mj.a,{ExternalId:"Copy"}));return A}static RFf(b,h,r){return r.uCg(b)&&r.aVj(b,h)?wi.oE(["EditTableAltText"]):[]}static bAi(b,h,r){return r.$Sl(b)?wi.oE(["ShowIntentSuggestion"]):[]}static vNm(b,h,r){const A=[];r.uCg(b)&&
!r.aVj(b,h)&&(A.push(Object.assign(new ni.a,{ExternalId:"InsertTableMenu"})),A.push(Object.assign(new ni.a,{ExternalId:"DeleteTableMenu"})),A.push(Object.assign(new ni.a,{ExternalId:"SelectTableMenu"})));return A}static BNm(b,h,r){return r.Z9o(b)?wi.oE(["UpdateTableOfContents"]):[]}static Crm(b){return ik.Y7o(b)?wi.oE(["ShowHideEquationToolsPane"]):[]}static $nm(b,h,r){b=r.Mim(b).map(A=>{switch(A.category){case "draftContent":return"OpenCopilotComposeDraftContent";case "rewrite":return"OpenCopilotComposeRewrite";
case "visualize":return"OpenCopilotComposeVisualizeAsTable";default:throw Error("Not supported category for compose action");}});return wi.oE(b)}}Object(u.a)(Rh,"ContextMenuSectionItemHelper",null,[]);class ik extends wi{get Og(){return this.hb}get wXl(){return this.Z1a}static get iNh(){return ik.n8g}constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de,qe,oe=!1,ge=null,$d=null,lf,wf,gi,Di){super(b,h,r,oe,void 0,ge,lf);this.YZd=Di;this.M3e=this.ES=null;this.WVe=this.Hkh=!1;this.Fmd=new Map;this.nC=
{};this.Zub={};this.ga=b;this.J=A;this.ti=L;this.uZ=Ba;this.LK=gb;this.Wn=Ab;this.aSk=!!ge;this.iwf=Jb;this.sgo=Tb;this.reh=Gd;this.Koa=de;this.iel=qe;this.Z1a=gi;this.hb=wf;hd&&hd.execute(Yl=>{this.jDh=Yl});jc&&jc.execute(Yl=>{this.M3e=Yl});this.Ac=oa;this.uv=Hc;$d&&$d.execute(Yl=>{this.ES=Yl});this.U6m();this.neo();this.T6l();this.J6l().catch(()=>{v.ULS.sendTraceTag(508679947,3048,50,"Fetching copilot state for context menu failed.")});this.meo()}get tyf(){return this.aSk?mp.a.Mgd:super.tyf}Mto(b){ik.n8g=
b}M5o(){const b=Fl.a.hm.kb.Qc.lb.gb.currentSelection;return this.ypd(b)&&2!==this.EEi(b).errorType}T2(b,h){return super.T2(b,h)||ik.OUj()||wi.EUj(b)||ik.WBg(b)||ik.HUj(b)}OHl(b,h,r){const A=[];let L=null;try{L=Fl.a.hm.kb.Qc.lb.gb.currentSelection}catch(Z){v.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.aeo(L,h,A,this.Onm(L));b.MenuSectionList.push(...A);this.fXo(b);!r&&this.jDh&&this.jDh.jio(b.MenuTargetDescriptor.menuTargetType,
A)}Onm(b){return wi.uec(vb.a.mergeCells)?Ir.MQg:b.f9c?Ir.cPg:b.FL?Ir.dQg:b.Poc()?Ir.WOg:b.LWa?Ir.OOg:Ir.hPg}ZGl(b){b=ik.kHl(b);return Object.assign(new Mj.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}SKl(b){return(b=ik.Eek(b))?Object.assign(new Mj.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}YGl(){const b=Object.assign(new hh.a,{ControlList:[]}),h=ik.Yzi();b.ControlList.push(this.ZGl(h));return b}RKl(b){const h=Object.assign(new hh.a,{ControlList:[]});if(b&&0<b.length){b=this.SKl(b);
if(null==b)return null;h.ControlList.push(b)}return h}npc(b){return b.FL||2<b.length||!b.length||2===b.length&&!he.a.pl(b.Xc)||1===b.length&&he.a.pl(b.Xc)?!1:this.S0f(b.Qa)}S0f(b){return Cd.ParagraphReader.Wb(b.node)?""!==Cd.ParagraphReader.text(b.node).trim():!1}Z9o(b){var h=hb.a.eb(b.Qa.node);h=Object(Ca.a)(Kx.a,h.currentNode);return b.FL?!1:!!h&&h.Fq}T6l(){this.J.$("RewriteIsEnabled")||this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.uv.execute(b=>
{b.isFeatureEnabled(qq.a.ggj,!1).then(h=>{h||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.Hkh=h;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}async J6l(){v.ULS.sendTraceTag(508679949,3048,50,"Fetching copilot state for context menu.");this.WVe=await (await Object(vC.b)(this.gCl)).isEnabled();v.ULS.sendTraceTag(508679948,3048,50,`Fetching copilot state for context menu complete. Enabled: ${this.WVe}`)}get yrn(){return this.J.$("RewriteIsEnabled")||
this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Hkh&&!this.WVe:!1}D9o(b){if(!this.npc(b)||b.LWa||b.Poc())return!1;b=b.Qa;if(Cd.ParagraphReader.en(b)||he.a.mf(b)||he.a.Zl(b)){b=this.LK.iKa(b);b||(b=y.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}$Sl(b){if(1!==b.length||aa.a.As)return!1;const h=kn.a.qLa;if(h&&
this.M5o()||zt.nD()&&!this.zgb.C7h(b.Qa))return!1;const r=ik.rc.isFeatureEnabled(54);return b.K(0).contextId===kc.a.Vc&&(h||r)&&0<this.Wn.u3c(b.K(0),0).count||h&&this.Ajc(b)?!0:!1}QSl(b){return 1===b.length&&this.reh.YB(b.Qa.node).$la}JIm(b){var h,r;const A=null===(h=this.YZd)||void 0===h?void 0:h.hX(null===(r=null===b||void 0===b?void 0:b.Qa)||void 0===r?void 0:r.node);return Cz.a.HIi(A)}get Sw(){return null!=this.STg?this.STg:this.STg=Wa.a.instance.Oa("WordEditor.Designer.IDesignerTaskPane")}get jCl(){return null!=
this.wTg?this.wTg:this.wTg=Wa.a.instance.Oa("WordEditor.Copilot.Compose.CopilotComposeTriggerConditions")}get gCl(){return null!=this.vTg?this.vTg:this.vTg=Wa.a.instance.Ta("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}iTl(b){if(!this.Koa.JWi()||!this.Sw||this.Sw.isVisible||!(1===b.length||2===b.length&&he.a.pl(b.Xc))||b.cub||!he.a.Zl(b.Qa)&&b.Qa.contextId!==kc.a.paragraph||b.y1i()||this.reh.YB(b.Qa.node).$la)return!1;const h=Cd.ParagraphReader.text(b.Qa.node),r=b.Qa.contextId===kc.a.paragraph?
0:b.Qa.cpBegin,A=b.Qa.contextId===kc.a.paragraph?h.length:b.Qa.cpEnd-r;return 1>A||1500<A||F.a.Qf(F.a.oDa(h.substr(r,A)))||1!=At.a.Fqb(b.Qa.node)?!1:!0}PSl(){return 32==this.ga.Ob(vb.a.qkd,1)}Ajc(b){return this.iwf.Ajc(b)}$Xd(b,h,r,A=null){this.ypd(b)||this.iwf.$Xd(b,h,r,A)}xhm(b){return this.M3e?this.M3e.yhm(b):[]}fXo(b){const h=this.ES?this.ES.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new ws,{menuTargetType:h})}static get rc(){return null!=ik.vVg?ik.vVg:ik.vVg=Wa.a.instance.resolve("Box4.IFeatureHelper")}static WBg(b){return y.AFrameworkApplication.Y2&&
!b.LWa&&Wa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").jvn()}static f8d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.VA(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static kHl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=ik.f8d(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static Eek(b){b=ik.f8d(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,
b):null}static Yzi(){const b=(new Us.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static tUj(b){const h=ik.rc.isFeatureEnabled(42);return!b.yWc&&h&&!aa.a.As&&b.LWa}static R7o(b){const h=ik.rc.isFeatureEnabled(42);return!b.yWc&&h&&!aa.a.As&&b.FL}static tCg(b){return y.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")&&!b.Poc()}static HUj(b){return y.AFrameworkApplication.J.$("LanguageTranslationIsEnabled")&&!b.LWa&&!b.Poc()}static Y7o(b){return b.z1i()&&
y.AFrameworkApplication.ua.Gb.w$c}static OUj(){return 2===Fl.a.hm.mode}static v$o(b){return b.FL}static C9o(b){return b.FL}Mim(b){var h,r;return null!==(r=null===(h=this.jCl)||void 0===h?void 0:h.mrm(b))&&void 0!==r?r:[]}aeo(b,h,r,A){this.Zub[A].forEach(L=>{const Z=Object.assign(new hh.a,{ControlList:[]}),oa=Z.ControlList;L.forEach(Ba=>{Ba instanceof Xn?r.push(...this.Fmd.get(Ba)(b,h,this)):oa.push(...this.nC[Ba](b,h,this))});(null===oa||void 0===oa?0:oa.length)&&r.push(Z)})}meo(){this.Fmd.set(Xn.FGe,
qw.Jgm);this.Fmd.set(Xn.q3b,qw.sGm);this.Fmd.set(Xn.ZGe,qw.dqm);this.Fmd.set(Xn.QHe,qw.HLm)}neo(){this.nC[Zg.lBb]=Rh.Xlm;this.nC[Zg.WHe]=Rh.vNm;this.nC[Zg.XHe]=Rh.BNm;this.nC[Zg.YGe]=Rh.Spm;this.nC[Zg.tHe]=Rh.gAm;this.nC[Zg.YHe]=Rh.INm;this.nC[Zg.JGe]=Rh.RFf;this.nC[Zg.oHe]=Rh.cxm;this.nC[Zg.fvd]=Rh.bAi;this.nC[Zg.nHe]=Rh.Xvm;this.nC[Zg.PHe]=Rh.xLm;this.nC[Zg.$He]=Rh.EPm;this.nC[Zg.BHe]=Rh.gHm;this.nC[Zg.GHe]=Rh.SIm;this.nC[Zg.ivd]=Rh.Mym;this.nC[Zg.lvd]=Rh.REm;this.nC[Zg.CHe]=Rh.e8d;this.nC[Zg.Pud]=
Rh.getContentControls;this.nC[Zg.wIe]=Rh.qSm;this.nC[Zg.FHe]=Rh.CIm;this.nC[Zg.$Ge]=Rh.Lqm;this.nC[Zg.QGe]=Rh.glm;this.nC[Zg.ZHe]=Rh.tPm;this.nC[Zg.PGe]=Rh.Mkm;this.nC[Zg.Nud]=Rh.getBookmark;this.nC[Zg.kHe]=Rh.fvm;this.nC[Zg.mHe]=Rh.mla;this.nC[Zg.kPa]=Rh.Cmm;this.nC[Zg.fvd]=Rh.bAi;this.nC[Zg.bHe]=Rh.Crm;this.nC[Zg.zOg]=Rh.$nm}U6m(){const b=[Zg.tHe,Zg.YHe,Zg.JGe,Zg.WHe];this.Zub[Ir.MQg]=[[Zg.lBb],b,[Zg.kPa],[Xn.q3b],[Zg.Pud]];this.Zub[Ir.dQg]=[[Zg.lBb],[Zg.QGe,Zg.$Ge,Zg.wIe,Zg.FHe],b,[Zg.kPa],[Xn.q3b]];
this.Zub[Ir.WOg]=[[Zg.bHe],[Zg.ivd,Zg.lvd],[Zg.Nud,Zg.kPa],[Xn.q3b]];this.Zub[Ir.hPg]=[[Zg.fvd],[Zg.YGe],[Xn.QHe],[Xn.ZGe],[Zg.lBb],[Zg.oHe,Zg.nHe,Zg.PHe,Zg.$He],[Zg.BHe,Zg.GHe,Zg.lvd],[Zg.zOg],[Zg.ivd],b,[Zg.Pud],[Zg.mHe,Zg.Nud,Zg.kHe,Zg.kPa],[Zg.CHe],[Zg.ZHe],[Zg.PGe],[Xn.FGe],[Zg.XHe],[Xn.q3b]];this.Zub[Ir.cPg]=[[Zg.lBb],[Zg.kPa]];this.Zub[Ir.OOg]=[[Zg.lBb],[Zg.nHe]];this.Zub[Ir.Qgk]=[[Zg.fvd],[Zg.YGe],[Xn.QHe],[Xn.ZGe],[Zg.lBb],[Zg.QGe],[Zg.$Ge],[Zg.wIe],[Zg.FHe],[Zg.oHe],[Zg.PHe],[Zg.$He],[Zg.BHe],
[Zg.GHe],[Zg.bHe],[Zg.ivd],[Zg.lvd],[Zg.mHe],[Zg.tHe],[Zg.YHe],[Zg.JGe],[Zg.WHe],[Zg.Nud],[Zg.kHe],[Zg.kPa],[Zg.CHe],[Zg.Pud],[Zg.ZHe],[Zg.PGe],[Xn.FGe],[Zg.XHe],[Xn.q3b]]}}ik.n8g=null;Object(u.a)(ik,"EditSurfaceContextMenu",wi,[]);var Ir;(function(b){b[b.MQg=1]="TABLE_MULTI_CELL";b[b.hPg=2]="GENERIC";b[b.dQg=3]="PICTURE";b[b.WOg=4]="EQUATION";b[b.Qgk=5]="LEGACY";b[b.cPg=6]="FLUID";b[b.OOg=7]="DRAWING"})(Ir||(Ir={}));Object(u.b)("Scenarios",Ir);class Xn{}Xn.FGe=new Xn;Xn.q3b=new Xn;Xn.ZGe=new Xn;
Xn.QHe=new Xn;Object(u.a)(Xn,"Sections",null,[]);var Zg;(function(b){b[b.fvd=1]="INTENT_SUGGESTION";b[b.lBb=2]="ESSENTIALS";b[b.oHe=3]="INSIGHT";b[b.nHe=4]="ILLUSTRATION";b[b.PHe=5]="SMART_LOOKUP";b[b.$He=6]="TRANSLATE";b[b.BHe=7]="PROOFING";b[b.GHe=8]="REWRITE_SUGGESTIONS";b[b.ivd=9]="LISTS";b[b.lvd=10]="PARAGRAPH_OPTIONS";b[b.tHe=11]="MERGE_SPLIT_CELLS";b[b.YHe=12]="TABLE_SORT";b[b.JGe=13]="ALT_TEXT";b[b.mHe=14]="HYPERLINK";b[b.Nud=15]="BOOKMARK";b[b.kHe=16]="HEADING_LINK";b[b.kPa=17]="COMMENT";
b[b.CHe=18]="PULL_QUOTE";b[b.wIe=19]="WRAP_TEXT";b[b.FHe=20]="RESET_PICTURE";b[b.$Ge=21]="DRAW";b[b.ZHe=22]="TRACK_CHANGE";b[b.PGe=23]="CATCHUP_ACTIVITIES";b[b.XHe=24]="TABLE_OF_CONTENTS";b[b.YGe=25]="DESIGNER_REVIEW";b[b.WHe=26]="TABLE_ITEMS";b[b.QGe=27]="CHANGE_PICTURE";b[b.bHe=28]="EQUATION_TOOLS";b[b.Pud=29]="CONTENT_CONTROL";b[b.zOg=30]="COPILOT_COMPOSE"})(Zg||(Zg={}));Object(u.b)("SectionItem",Zg);class Lx extends uf{constructor(b,h,r){super();this.jl=null;this.Xpe=(A,L,Z,oa,Ba)=>{if(1===Z)return 32;
A=[];L=[];this.N5o()&&L.push("InsertTabStopMenuSplitButton");this.y5o()&&L.push("ClearAllTabStops");L.push("HideRuler");A.push(Lx.EBi(L));L=Object.assign(new Ee.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});L.MenuSectionList.push(...A);Ba.MenuItems=L;return 32};this.ga=b;this.St=h;this.rA=r;this.Xb()}get Aib(){return document.getElementById("WACHorizontalRuler")}get tQ(){return this.St&&this.St.instance?this.St.instance.nl:1}get target(){return this.jl}show(b,h){this.jl=
b;uf.x0b("RulerContextMenu",b,h);v.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",Lx.UR);b.set("Response","Ruler Context menu invoked.");xa.Health.instance.recordKpiUsage(Lx.kpiName,1,Lx.Baa,b)}lIm(){var b=0,h=(this.target.x-rd.a.sGf(this.Aib))/this.tQ;h=nh.a.bA(h,0);var r={},A=this.rA.VOb,L=hb.a.eb(A);L.Nd();if(!si.TableReader.Ix(L))return 32===this.ga.Qb(vb.a.VMa,2,r)&&(b=r.marginLeft),h-b;b={};L={};r=this.ga.Qb(vb.a.Yid,2,b);var Z=
this.ga.Qb(vb.a.uYb,2,L);if(32!==r||32!==Z)return v.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;Z=L.TablePosition;if(!Z||!b||0>=b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;L=hb.a.eb(A);L.zb(14)&&(L.kd(16),r=ev.a(L,!0));A=Z.x/this.tQ;for(L=0;L<r;L++)A+=b[L];return h-A}Xb(){this.ga.fb(Ec.a.Xpe,kc.a.application,this.Xpe,96)}N5o(){var b={},h={},r=this.ga.Qb(vb.a.VMa,
2,b),A=this.ga.Qb(vb.a.Kcb,2,h);if(32===r&&32===A){A=h.Cu;r=nh.a.Mj(A.Hfa,0);A=1===A.specialIndentType?nh.a.Mj(A.RA,0):nh.a.Mj(A.RA-A.yha,0);const L=nh.a.Mj(b.marginLeft,0);b=nh.a.Mj(b.marginRight,0);const Z=rd.a.sGf(this.Aib),oa=rd.a.tGf(this.Aib);h.isRtl?(h=Z+this.tQ*Math.max(b,b+r),r=oa-this.tQ*Math.max(L,L+A)):(h=Z+this.tQ*Math.max(L,L+A),r=oa-this.tQ*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}y5o(){var b={};if(32!==this.ga.Qb(Ec.a.jYb,2,b)||!b)return!1;b=b.customTabs;
return!b||0>=b.length?!1:!0}static EBi(b){const h=Object.assign(new hh.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new Mj.a,{ExternalId:r}));return h}}Lx.Baa="wwaengidc";Lx.kpiName="WordRuler";Lx.UR="RulerContextMenu";Object(u.a)(Lx,"RulerContextMenu",uf,[427]);var Ss=d(285),rw=d(1370),lz=d(469),zu=d(770),ij=d(1169),Dj=d(1724);class Iq{constructor(){this.lineStyle=Mi.a.WH;this.lqc=Mi.a.XH;this.borderColor=Mi.a.e2}}Object(u.a)(Iq,"TableBorderFormattingData",null,[]);var bl=
d(716);class Mt{constructor(){this.d3=this.LYi=!1;this.Zzb=bl.a.none;this.Jx=0;this.Ofb=1}}Object(u.a)(Mt,"WrapTextPropertiesData",null,[]);var wC=d(1071);class cl extends ij.a{constructor(b=null){super(b);this.pDh=new Dj.a;this.PKh=new Mt;this.TGh=new Iq;this.uTe=!1;this.wPi=h=>{const r=new Ss.a;r.yJa=!0;r.wO=h;return r};this.mY=()=>{const h=new Ss.a;h.ARb=!1;h.wO=vb.a.VMa;h.rd=this.pDh;h.Coc=!0;h.gma=!0;return h};this.mxj=()=>{const h=new Ss.a;h.ARb=this.uTe;this.uTe=!0;h.wO=vb.a.YMa;h.rd=this.TGh;
h.Coc=!0;h.gma=!0;return h};this.pud=()=>{const h=new Ss.a;h.ARb=!1;h.wO=Ec.a.Iuc;h.rd=this.PKh;h.Coc=!0;h.gma=!0;return h};this.vae=(h,r)=>{const A=new Ss.a;A.rd=new lj.DictionaryPropertySet;switch(h){case Ec.a.P6c:A.rd.setValue(Od.a.ksb,r[Ji.a.Number]);break;case Ec.a.M6c:A.rd.setValue(Od.a.hsb,r[Ji.a.Number]);break;case Ec.a.N6c:A.rd.setValue(Od.a.isb,r[Ji.a.Number]);break;case Ec.a.O6c:A.rd.setValue(Od.a.jsb,r[Ji.a.Number])}return A};this.nlo=()=>{const h=new Ss.a;h.rd=new lj.DictionaryPropertySet;
h.gma=!0;return h}}initialize(){super.initialize();this.od.W(Ec.a.n2f,rw.a.wsb);this.od.W(Ec.a.q2f,rw.a.wsb);this.od.W(Ec.a.s2f,rw.a.wsb);this.od.W(Ec.a.sng,cl.kZa);this.od.W(Ec.a.Sid,cl.kZa);this.od.W(Ec.a.lng,cl.kZa);this.od.W(Za.a.Euc,cl.kZa);this.od.W(vb.a.ore,this.mY);this.od.W(vb.a.nre,this.mY);this.od.W(vb.a.mre,this.mY);this.od.W(vb.a.qre,this.mY);this.od.W(vb.a.pre,this.mY);this.od.W(vb.a.lre,this.mY);this.od.W(vb.a.xre,this.mY);this.od.W(vb.a.wre,this.mY);this.od.W(vb.a.vre,this.mY);this.od.W(vb.a.sre,
this.mY);this.od.W(vb.a.tre,this.mY);this.od.W(vb.a.ure,this.mY);this.od.W(vb.a.Hng,this.mY);this.od.W(vb.a.Gng,this.mY);this.od.W(vb.a.Umg,this.mY);this.od.W(vb.a.Wmg,this.mY);this.od.W(vb.a.Vmg,this.mY);this.od.W(vb.a.Tmg,this.mY);this.od.W(vb.a.Tdb,cl.eKn);this.od.W(vb.a.i_a,cl.p9n);this.od.W(vb.a.hyb,cl.zvl);Object(wC.a)()&&(this.od.W(vb.a.Swc,cl.tAn),this.od.W(vb.a.wng,this.mY),this.od.W(vb.a.vng,this.mY));this.od.W(vb.a.Eqa,cl.kZa);this.od.W(vb.a.IXb,cl.kZa);this.od.W(vb.a.nZa,cl.kZa);this.od.W(vb.a.Eya,
cl.kZa);this.od.W(vb.a.bDa,cl.kZa);this.od.W(Ec.a.shd,cl.kZa);this.od.W(Ec.a.H3d,rw.a.JDf);this.od.W(Ec.a.I3d,this.gsi);this.Kn.W(Ec.a.qhd,rw.a.wUa);this.Kn.W(Ec.a.rhd,rw.a.wUa);this.od.W(vb.a.S_b,rw.a.X7a);this.od.W(vb.a.R_b,rw.a.X7a);this.od.W(vb.a.Cyb,rw.a.X7a);this.od.W(vb.a.Ung,this.sH);this.od.W(vb.a.Sng,this.sH);this.od.W(vb.a.Tng,this.sH);this.od.W(vb.a.aM,cl.Jjo);this.Kn.W(Ec.a.bse,cl.kkd);this.Kn.W(Ec.a.cse,cl.kkd);this.Kn.W(Ec.a.dse,cl.kkd);this.Kn.W(Ec.a.$re,cl.kkd);this.Kn.W(Ec.a.ase,
cl.kkd);this.od.W(Ec.a.bse,this.pud);this.od.W(Ec.a.cse,this.pud);this.od.W(Ec.a.dse,this.pud);this.od.W(Ec.a.$re,this.pud);this.od.W(Ec.a.ase,this.pud);this.od.W(Ec.a.uGe,cl.GBc);this.od.W(Ec.a.vGe,cl.GBc);this.od.W(Ec.a.wGe,cl.GBc);this.od.W(Ec.a.xGe,cl.GBc);this.od.W(Ec.a.yGe,cl.GBc);this.od.W(Ec.a.zGe,cl.GBc);this.od.W(Ec.a.SNa,cl.Gic);this.od.W(Ec.a.iUj,cl.Gic);this.od.W(Ec.a.jUj,cl.Gic);this.od.W(Ec.a.Zye,cl.Gic);this.od.W(Ec.a.$ye,cl.Gic);this.od.W(Ec.a.lpd,cl.Gic);this.od.W(Ec.a.Twb,this.nlo);
this.od.W(Ec.a.Did,cl.k4d);this.od.W(Ec.a.dre,cl.k4d);this.od.W(Ec.a.ere,cl.k4d);this.od.W(Ec.a.fre,cl.k4d);this.od.W(Ec.a.P6c,this.vae);this.od.W(Ec.a.M6c,this.vae);this.od.W(Ec.a.N6c,this.vae);this.od.W(Ec.a.O6c,this.vae);this.od.W(vb.a.Hsa,this.wPi);this.od.W(vb.a.PNb,this.wPi);this.od.W(Ec.a.Rwb,cl.Rwb);this.od.W(Ec.a.hze,rw.a.X7a);this.od.W(vb.a.Yng,this.mxj);this.od.W(vb.a.Zng,this.mxj)}clearCache(){super.clearCache();this.uTe=!1;this.pDh=new Dj.a;this.PKh=new Mt;this.TGh=new Iq}IHf(){const b=
super.IHf();b.OHa=cl.OHa;b.I5a=cl.I5a;return b}static get M8n(){return null!=cl.A1g?cl.A1g:cl.A1g=Wa.a.instance.Oa("WordEditor.IPageCommandStringBuilder")}static get gB(){cl.Zxa||(cl.Zxa=Wa.a.instance.Oa("WordEditor.ITableBorderManager"));return cl.Zxa}static kZa(b,h){b=new Ss.a;b.rd=h;return b}static Ond(b,h,r){h[Tg.a.Description]=b?b.bKn(r):null}static OHa(b,h){const r=Object(Ca.a)(Dj.a,b.rd),A=Object(Ca.a)(lz.a,b.rd),L=Object(Ca.a)(Mt,b.rd),Z=Object(Ca.a)(Iq,b.rd);let oa=!0;const Ba=cl.M8n;switch(b.mwb){default:oa=
ij.a.OHa(b,h);break;case vb.a.ore:h[em.a.Icon]=r.DBa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Tg.a.On]=!r.tVb;cl.Ond(Ba,h,0);break;case vb.a.nre:h[em.a.Icon]=r.DBa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Tg.a.On]=1===r.tVb;cl.Ond(Ba,h,1);break;case vb.a.mre:h[em.a.Icon]=r.DBa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Tg.a.On]=2===r.tVb;cl.Ond(Ba,h,2);break;case vb.a.qre:h[em.a.Icon]=r.DBa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";
h[Tg.a.On]=3===r.tVb;cl.Ond(Ba,h,3);break;case vb.a.pre:h[em.a.Icon]=r.DBa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Tg.a.On]=4===r.tVb;cl.Ond(Ba,h,4);break;case vb.a.lre:h[em.a.Icon]=r.DBa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Tg.a.On]=5===r.tVb;break;case vb.a.xre:h[Tg.a.On]=!r.gXb;h[Tg.a.Description]=Ba?Ba.rgd(0):null;break;case vb.a.wre:h[Tg.a.On]=1===r.gXb;h[Tg.a.Description]=Ba?Ba.rgd(1):null;break;case vb.a.vre:h[Tg.a.On]=2===r.gXb;
h[Tg.a.Description]=Ba?Ba.rgd(2):null;break;case vb.a.sre:h[Tg.a.On]=3===r.gXb;h[Tg.a.Description]=Ba?Ba.rgd(3):null;break;case vb.a.tre:h[Tg.a.On]=4===r.gXb;h[Tg.a.Description]=Ba?Ba.rgd(4):null;break;case vb.a.ure:h[Tg.a.On]=5===r.gXb;break;case vb.a.Hng:h[Tg.a.On]=!r.DBa;break;case vb.a.Gng:h[Tg.a.On]=r.DBa;break;case vb.a.Umg:h[Tg.a.On]=1===r.TVc;break;case vb.a.Wmg:h[Tg.a.On]=2===r.TVc;break;case vb.a.Vmg:h[Tg.a.On]=3===r.TVc;break;case vb.a.Tmg:h[Tg.a.On]=0===r.TVc;break;case vb.a.wng:h[Tg.a.On]=
-1===r.A6i;break;case vb.a.vng:h[Tg.a.On]=2===r.A6i;break;case vb.a.Ung:h[Tg.a.On]=A.Cu?!A.Cu.specialIndentType:!1;break;case vb.a.Sng:h[Tg.a.On]=A.Cu?1===A.Cu.specialIndentType:!1;h[Um.a.Image16by16Class]=A.isRtl?Pb.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Pb.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case vb.a.Tng:h[Tg.a.On]=A.Cu?2===A.Cu.specialIndentType:!1;h[Um.a.Image16by16Class]=A.isRtl?Pb.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Pb.getImageClass("IndentSpecialHanging_Server_16x16x32");
break;case Ec.a.bse:h[Tg.a.On]=1===L.Ofb;break;case Ec.a.cse:h[Tg.a.On]=8===L.Ofb;break;case Ec.a.dse:h[Tg.a.On]=9===L.Ofb;break;case Ec.a.$re:h[Tg.a.On]=3===L.Ofb;break;case Ec.a.ase:h[Tg.a.On]=4===L.Ofb;break;case Ec.a.Twb:h[Tg.a.On]=b.rd.ka(Od.a.zBa,!1);break;case Ec.a.Rwb:h[xb.a.IsFreeForm]=!0;h[xb.a.Value]=b.rd[Zi.a.Value];break;case vb.a.Yng:h[je.a.On]=cl.gB.Kti(h.MenuItemId)===Z.lineStyle;break;case vb.a.Zng:h[je.a.On]=cl.gB.Lti(h.MenuItemId)===Z.lqc}return oa}static eKn(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=
0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Ss.a;h.rd=b;return h}static p9n(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Ss.a;h.rd=b;return h}static zvl(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=
2;break;case "buttonThreeColumns":b=3}h=new Ss.a;h.rd=b;return h}static tAn(b,h){b=3;switch(h.MenuItemId){case "buttonLineNumberingNone":b=-1;break;case "buttonLineNumberingContinuous":b=2}h=new Ss.a;h.rd=b;return h}static Rwb(){const b=new Ss.a;b.wO=Ec.a.Rwb;b.rd={};b.gma=!0;b.Coc=!0;return b}static GBc(b,h){const r=new Ss.a;r.rd=new lj.DictionaryPropertySet;let A=1;switch(b){case Ec.a.xGe:A=1;break;case Ec.a.yGe:A=8;break;case Ec.a.zGe:A=9;break;case Ec.a.vGe:A=3;break;case Ec.a.wGe:A=4}r.rd.setValue(Od.a.Ofb,
A);r.rd.setValue(Od.a.ZNa,h[Tg.a.SourceControlId]);return r}static Gic(b,h,r){b=new Ss.a;b.rd=r.InvocationMethod;return b}static Jjo(b,h){b=new Ss.a;b.rd=h;return b}static kkd(){const b=new zu.a;b.wO=Ec.a.Iuc;return b}static k4d(){const b=new Ss.a;b.rd=new lj.DictionaryPropertySet;b.s$c=!0;return b}static I5a(b,h){let r=!0;switch(b.mwb){case Ec.a.Did:b=b.rd.ka(Od.a.ksb,0);h[Ji.a.Number]=b;h[Ji.a.UnitType]=7;break;case Ec.a.dre:b=b.rd.ka(Od.a.hsb,0);h[Ji.a.Number]=b;h[Ji.a.UnitType]=7;break;case Ec.a.ere:b=
b.rd.ka(Od.a.isb,0);h[Ji.a.Number]=b;h[Ji.a.UnitType]=7;break;case Ec.a.fre:b=b.rd.ka(Od.a.jsb,0);h[Ji.a.Number]=b;h[Ji.a.UnitType]=7;break;default:r=ij.a.I5a(b,h)}return r}}cl.Zxa=null;Object(u.a)(cl,"CuiActionBridge",ij.a,[]);class fC extends Dg.a{constructor(b){super();this.Xvl=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.s2o=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.b_d=this.jIb=this.D9=this.n3a=this.G7e=null;this.pIj=h=>{h.target.setAttribute($c.a.vmb,$c.a.mq);Sys.UI.DomElement.removeCssClass(this.jIb,
"inactiveRowSelection");this.jIb=h.target};this.oIj=h=>{h.target.removeAttribute($c.a.vmb);Sys.UI.DomElement.addCssClass(h.target,"inactiveRowSelection")};this.i0h=h=>{(h=h.target.parentNode)&&h!==this.jIb&&this.e4(h)};this.i_j=h=>h.Lb.keyCode===jf.a.Pu?(h.Lb.stopPropagation(),!0):!1;this.gLh=h=>{if(!h.Lb)return!1;const r=h.Lb.keyCode;if(h.eventName===od.a.ij){h=this.Ewm(this.jIb);let A=-1;const L=mb.a.count(this.iye)-1;r===Sys.UI.Key.down?A=h<L?h+1:0:r===Sys.UI.Key.up?A=0<h?h-1:L:r===Sys.UI.Key.home?
A=0:r===Sys.UI.Key.end&&(A=L);-1!==A&&this.e4(this.D9.tBodies[0].children[A])}return!0};this.Zb=b;this.mh="<div id='AccessibilityHelpDialogBody'></div>";this.Ig="AAccessibilityHelpDialog";this.Bd=6;this.Ke(0,CommonUIStrings.l_DialogClose)}get hwf(){return null}get iye(){this.G7e||(this.G7e=this.k8m());return this.G7e}get dip(){return 300}get uej(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get tej(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get f7a(){return this.Zb.$t()}d_a(b){super.d_a(b);
this.Kdo()}y_a(){this.showDialog(this.dialogTitle,Object(D.a)(this,this.DTk,"accHelpDialogResultHandler"));this.bNa();this.setFocus()}setFocus(){this.D9?(this.jIb=this.D9.tBodies[0].firstChild,this.e4(this.jIb)):this.jJ&&"none"!==this.jJ.style.display?this.e4(this.jJ):this.e4(this.lB)}Lqa(){this.oe.ub(od.a.ij,this.b_d,this.gLh);if(this.D9){this.oe.ub(od.a.gi,this.D9,this.i_j);const b=this.D9.tBodies[0].children;for(let h=0;h<b.length;h++)if(zc.a.addHandler(b[h],od.a.focus,this.pIj),zc.a.addHandler(b[h],
od.a.blur,this.oIj),aa.a.As){const r=b[h].children;for(let A=0;A<r.length;A++)zc.a.addHandler(r[A],od.a.focus,this.i0h)}}super.Lqa()}Fob(){this.oe&&(this.oe.xc(od.a.ij,this.b_d,this.gLh),this.D9&&this.oe.xc(od.a.gi,this.D9,this.i_j));if(this.D9){const b=this.D9.tBodies[0].children;for(let h=0;h<b.length;h++)if(zc.a.removeHandler(b[h],od.a.focus,this.pIj),zc.a.removeHandler(b[h],od.a.blur,this.oIj),aa.a.As){const r=b[h].children;for(let A=0;A<r.length;A++)zc.a.removeHandler(r[A],od.a.focus,this.i0h)}}super.Fob()}bNa(){this.f7a.scope.ot(this.Zb.BZ);
this.f7a.scope.ot(this.Zb.CZ);this.f7a.scope.bindAction(this.Zb.BZ,Za.a.RRc);this.f7a.scope.bindAction(this.Zb.CZ,Za.a.QRc)}HXm(b){if(!this.f7a.Uk||!this.f7a.Uk.tra)return 2;var h=this.f7a.Uk.tra;if(this.D9&&(h===this.lB&&b===Za.a.RRc||h===this.n3a&&b===Za.a.QRc))this.e4(this.jIb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Za.a.RRc?h=this.n3a:b===Za.a.QRc&&(h=this.lB),h&&this.e4(h);else if(b===Za.a.RRc)this.f7a.urc();else if(b===Za.a.QRc)this.f7a.rrc();else return 2;return 32}DTk(){}Kdo(){this.b_d=
document.getElementById("AccessibilityHelpDialogBody")||this.Jq;this.OKl();this.oKl();this.VHl()}OKl(){if(this.hwf){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.hwf;b.appendChild(h);this.Ooa.appendChild(b)}}oKl(){if(this.iye&&!mb.a.isEmpty(this.iye)){this.D9=document.createElement("table");this.D9.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute($c.a.Wh,
$c.a.xTc);b.appendChild(h);var r=Je.a.pXc(14,this.Xvl);h.appendChild(r);r=Je.a.pXc(14,this.s2o);h.appendChild(r);this.D9.appendChild(b);b=document.createElement("tbody");h=0;r=this.iye;for(const Z in r){var A=Z,L=r[Z];const oa=document.createElement("tr");oa.tabIndex=0;oa.setAttribute($c.a.Wh,$c.a.xTc);oa.id="SelectableTableRow"+h++;A=Je.a.pXc(15,A);oa.appendChild(A);L=Je.a.pXc(15,L);oa.appendChild(L);b.appendChild(oa)}b.style.maxHeight=this.dip+"px";this.D9.appendChild(b);this.b_d.appendChild(this.D9)}}VHl(){if(this.tej&&
this.uej){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.n3a=document.createElement("a");this.n3a.innerText=this.tej;this.n3a.href=this.uej;this.n3a.target="_blank";this.n3a.id=this.Bj("AccessibilityHelpDialogLink");this.n3a.className=Qf.AFrame.Igf;b.appendChild(this.n3a);this.Oc.insertBefore(b,this.Oc.lastChild)}}Ewm(b){return Number.parseInvariant(b.id.substr(18))}W1(b,h,r,A=null){b&&h&&r&&(r=A?String.format(r,A):r,b[h]=r)}NGi(b,h){return aa.a.Jl?h:b}}Object(u.a)(fC,
"AAccessibilityHelpDialog",Dg.a,[26]);class jt extends fC{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get hwf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}k8m(){const b=this.NGi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.NGi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.W1(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.W1(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.W1(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.W1(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.W1(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&this.W1(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&this.W1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(jt.rc&&jt.rc.isFeatureEnabled(54)||kn.a.qLa)&&this.W1(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get rc(){return null!=jt.gVg?
jt.gVg:jt.gVg=Wa.a.instance.Oa("Box4.IFeatureHelper")}}Object(u.a)(jt,"AccessibilityHelpDialog",fC,[]);var BA=d(399);class ND{static get mh(){return Dg.a.uy(ND.lo,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}ND.lo="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(u.a)(ND,"ApplyStylesDialogHtml",null,[]);class CA extends Dg.a{constructor(b,h){super();this.wJ=null;this.qQc=!1;this.FJb=this.Bgb=this.DMc=this.IMc=this.GQc=null;this.E9k=(r,A)=>{if(this.zh.ow){if(r){r=A.styleList;A=A.styleText;if(-1===r||F.a.xh(A)!==F.a.xh(this.wJ[r]))r=this.fHi(A);A=this.wJ[r];r=this.Yb.ro();Ki.a.Kg.vn?(r=r.gv(),A=this.Yb.Be(r.GAa(A))):A=this.Yb.Be(r.qKa(A));y.AFrameworkApplication.va.Hf(this._context,vb.a.zT,2,!1,new BA.a,A)}this.zh.O8()}};this.P4n=r=>{this.qQc?(this.qQc=
!1,this.validate()):"value"===r.rawEvent.propertyName&&(this.qQc=!0,this.N1.value!==this.GQc&&(this.GQc=this.N1.value,this.iVh()))};this.l0n=()=>{-1!==this.$pa.selectedIndex&&(aa.a.c0&&(this.qQc=!0),this.GQc=this.wJ[this.$pa.selectedIndex],this.N1.value=this.wJ[this.$pa.selectedIndex],this.validate())};this.onKeyDown=r=>{aa.a.cM?r.keyCode!==jf.a.JD&&r.keyCode!==jf.a.I4||this.Bgb||this.FJb||(this.FJb=new mf.a(0,1,1,this.MEp),y.AFrameworkApplication.pc.$b(this.FJb)):aa.a.c0&&r.keyCode===jf.a.JD&&(this.qQc=
!0)};this.HI=()=>{this.Bgb||(this.Bgb=new mf.a(0,1,1,this.jbl),y.AFrameworkApplication.pc.$b(this.Bgb));this.FJb&&(y.AFrameworkApplication.pc.wf(this.FJb),this.FJb=null)};this.jbl=()=>{this.Bgb=null;this.iVh()};this.MEp=()=>{this.FJb=null;this.validate()};this._context=b;this.Fd=h;this.Ig="ApplyStylesDialog";this.zh=this._context.view;this.hNf();b=this.Ofp();h="";this.wJ.length>b&&(h=this.wJ[b]);h={["styleText"]:h,["styleList"]:b};this.mh=ND.mh;this.Uh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,
this.E9k,h);this.$pa=document.getElementById("styleList");this.pkg();this.$pa.selectedIndex=b;this.N1=document.getElementById("styleText");this.N1.focus();this.N1.select();this.VHd=this.l0n;zc.a.addHandler(this.$pa,"change",this.VHd);this.UHd=this.onKeyDown;zc.a.addHandler(this.N1,"keydown",this.UHd);aa.a.c0?(this.IMc=this.P4n,zc.a.addHandler(this.N1,"propertychange",this.IMc),this.GQc=this.wJ[b]):(this.DMc=this.HI,zc.a.addHandler(this.N1,"keypress",this.DMc))}get Yb(){return null!=this.V6g?this.V6g:
this.V6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Kg(){return null!=this.v4g?this.v4g:this.v4g=Wa.a.instance.Oa("Box4.Styles.StyleSettings")}Ofp(){var b=this.zh.lb;if(!b||!b.gb)return Uc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.gb.currentSelection;if(!b)return Uc.b(579216409,3018,15,"CurrentSelection is null"),0;Cd.ParagraphReader.en(b.Qa)&&(b=he.a.vk(b,!0,!1));b=b.Qa;if(!b||!he.a.Xw(b))return Uc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",
!b),0;var h=Ya.FormattingReader.Vs(b);(h=Ya.FormattingReader.MAa(h))||(h=this.Yb.Cq(b.node));if(!h)return 0;b=this.Yb.wL(h);b=Array.indexOf(this.wJ,b);0>b&&(b=0);return b}pkg(){const b=this.wJ.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.wJ[h];this.$pa.add(r,null)}}hNf(){var b=Ki.a.Np();if(b){if(this.Kg.vn){var h=(new pv.WACStyleSet).gla(b);b=h.Qw}else{var r=(new pv.WACStyleSet).Uaa(b);b=r.Qw}var A=this.Fd.isFeatureEnabled(102)&&!!this.Yb.Xg;
this.wJ=[];for(let L=0;L<b;L++){let Z;Z=r instanceof pv.WACStyleSet?r.FAa(L):h.vla(L);if(this.Yb.isHidden(Z))continue;const oa=this.Yb.JF(Z);if(!A){if(3===oa)continue}else if(3===oa&&this.Yb.Be(Z)===$C.a.gWb)continue;Array.add(this.wJ,this.Yb.wL(Z))}this.wJ.sort(CA.Dxl)}else Uc.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.IMc&&zc.a.removeHandler(this.N1,"propertychange",this.IMc);this.UHd&&zc.a.removeHandler(this.N1,"keydown",this.UHd);this.VHd&&zc.a.removeHandler(this.$pa,
"change",this.VHd);this.DMc&&zc.a.removeHandler(this.N1,"keypress",this.DMc);this.Bgb&&y.AFrameworkApplication.pc.wf(this.Bgb);this.Bgb=this.DMc=this.$pa=this.N1=this.UHd=this.IMc=this.VHd=null;super.dispose()}iVh(){var b=this.N1.value,h=this.a6m(b);const r=-1===h?b:this.wJ[h];b=b.length;const A=r.length;this.GQc=r;this.N1.value=r;this.$pa.selectedIndex=h;A>b&&(aa.a.cM?this.N1.setSelectionRange(b,A):aa.a.c0&&(h=this.N1.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",
A-b),h.select()));this.validate();this.N1.focus()}a6m(b){let h=0,r=this.wJ.length,A=-1;for(b=F.a.xh(b);h<r;){const L=Math.floor((h+r)/2),Z=CA.Epf(b,this.wJ[L]);if(!Z){A=L;break}0<Z?h=L+1:r=L}if(A>h)for(;!CA.Epf(b,this.wJ[A-1])&&(A--,A!==h););return A}validate(){const b=-1===this.fHi(this.N1.value),h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}fHi(b){b=F.a.xh(b);
const h=this.wJ.length;for(let r=0;r<h;r++)if(b===F.a.xh(this.wJ[r]))return r;return-1}static Epf(b,h){const r=Math.min(b.length,h.length);b=F.a.xh(b);h=F.a.xh(h);for(let A=0;A<r;A++){const L=F.a.charCodeAt(b,A),Z=F.a.charCodeAt(h,A);if(L!==Z)return L-Z}return b.length<=h.length?0:1}static Dxl(b,h){return CA.Epf(b,h)}}Object(u.a)(CA,"ApplyStylesDialog",Dg.a,[]);var mz=d(227);class OD extends Ag.StandardDialog{constructor(b){super();this.dw=b;this.J7o()}J7o(){this.Bd=1;this.qY(1);this.Ke(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);
this.sw(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.xvf.bind(this))}xvf(b){1===b&&this.dw.wna("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Yi?Uc.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.wk,h.wk.stack):(this.wHo(),Uc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}wHo(){mz.a.SAb="{}"}}Object(u.a)(OD,"DeleteSavedStylesConfirmationDialog",Ag.StandardDialog,
[]);class Au extends Ag.StandardDialog{constructor(b,h){super();this.xvf=L=>{if(1===L){L=new Map;L.set("Source","DeleteStyleConfirmationDialog");L.set("Action","DeleteStyle");xa.Health.instance.recordKpiUsage(zr.a.MEa,0,zr.a.UB,L);var Z=Ki.a.Np();L=new Sb.GraphTransaction(15);L.Ab(Z);L.Ph=vb.a.DNb;this.mM.Ydi(this.oGh)?Uc.b(578359694,3018,50,"User deleted a style via UI."):(Z=new Map,Z.set("Source","DeleteStyleConfirmationDialog"),Z.set("Action","DeleteStyle"),Z=Object.assign(new Na.a,{extendedProperties:Z}),
xa.Health.instance.recordKpiFailure(zr.a.MEa,"DeleteStyleFailed",!1,!0,Z),Uc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));L.dispose()}};h||Uc.b(590128417,3018,10,"styleId is null");let r=null,A=null;if(this.zh=b.view)A=this.zh.lb;A&&(r=A.gb.currentSelection.Qa);r?(b=r.node)?(this.FM=Object(so.a)().Iu(b))?(this.oGh=new nb.a,this.oGh.add(h),this.K7o(h)):Uc.b(590128448,3018,10,"_pageContenNode is null."):Uc.b(590128419,3018,10,"node is null."):Uc.b(590128418,
3018,10,"nodeContext is null.")}get mM(){return null!=this.M6g?this.M6g:this.M6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get Yb(){return null!=this.d7g?this.d7g:this.d7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}K7o(b){const h=(new pv.WACStyleSet).Uaa(this.FM);h?((b=h.nh(b))||Uc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.Yb.wL(b),this.Bd=4,this.qY(2),this.sw(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,
b),0,this.xvf)):Uc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(u.a)(Au,"DeleteStyleConfirmationDialog",Ag.StandardDialog,[]);class PD{static get mh(){return Dg.a.uy(PD.lo)}}PD.lo="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(u.a)(PD,"DeleteStyleDialogHtml",null,[]);class zI extends Dg.a{constructor(b){super();this.FM=this.wJ=null;this.lRl=(h,r)=>{this.zh.ow&&(h?(h=r.styleList,-1!==h&&(h=this.wJ[h],
r=this.Yb.ro(),Ki.a.Kg.vn?(r=r.gv(),h=this.Yb.Be(r.GAa(h))):h=this.Yb.Be(r.qKa(h)),this.VYc.kRl(this._context,h),this.zh.O8())):this.zh.O8())};this._context=b;this.Ig="DeleteStyleDialog";this.Bd=1;this.Ke(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.zh=this._context.view;this.hNf();this.mh=PD.mh;this.Uh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.lRl,{["styleList"]:0});this.$pa=document.getElementById("styleList");this.pkg();this.$pa.selectedIndex=0;this.$pa.focus()}get Yb(){return null!=
this.Y6g?this.Y6g:this.Y6g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get VYc(){return null!=this.UTg?this.UTg:this.UTg=Wa.a.instance.resolve("WordEditor.UI.IDialogFactory")}pkg(){const b=this.wJ.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.wJ[h];this.$pa.add(r,null)}}hNf(){if(this.FM=Ki.a.Np()){var b=(new pv.WACStyleSet).Uaa(this.FM),h=b.gv();var r=Ki.a.Kg.vn?h.Qw:b.Qw;this.wJ=[];for(let L=0;L<r;L++){let Z;Z=Ki.a.Kg.vn?h.vla(L):b.FAa(L);
if(!this.Yb.isHidden(Z)&&this.Yb.ne(Z,b)){var A=this.Yb.JF(Z);if(2===A||1===A)Z.hasProperty(Vc.a.linkedStyle)&&2!==A||(A=Z.ka(Vc.a.eE,null))&&0<A.length||this.wJ.push(this.Yb.wL(Z))}}this.wJ.sort()}else Uc.b(578650370,3018,15,"PageContentNode is null")}}Object(u.a)(zI,"DeleteStyleDialog",Dg.a,[]);var QD=d(793);class gC{constructor(b){this.ao=null;this.qR=b}}Object(u.a)(gC,"PropertySetChangedState",null,[]);class nz{static Who(b,h,r){if(b&&h){var A=new gC(h),L=(Z,oa,Ba)=>{r.Vho(Z,oa,Ba,A)};b=new QD.a(h,
b);b.tRd=L;b.MUd=L;b.Pte=L;b.Ccb()}}}Object(u.a)(nz,"PropertySetChangedManager",null,[]);class oz{constructor(b){this.hSa=b}Vho(b,h,r,A){const L=this.hSa[b.id.toString()];L&&L(b,h,r,A)}}Object(u.a)(oz,"PropertyChangedProcessor",null,[]);const ry=(b,h,r)=>{const A=Bt.a.instance.VOb;if(A){const L=new Sb.GraphTransaction(15);L.Ab(A);nz.Who(b,h,new oz(r));L.dispose()}};class RD{static get mh(){return Dg.a.uy(RD.lo,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}RD.lo="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(u.a)(RD,"MarginsDialogHtml",null,[]);class Im{static get i8(){return null!=Im.B1g?Im.B1g:Im.B1g=Wa.a.instance.Oa("WordEditor.IPageCommands")}static aKn(b,h,r){Im.i8&&null!==r&&Im.i8.rxe(0,r)}static XJn(b,h,r){Im.i8&&null!==r&&Im.i8.rxe(3,r)}static ZJn(b,h,r){Im.i8&&null!==r&&Im.i8.rxe(1,r)}static $Jn(b,h,r){Im.i8&&null!==r&&Im.i8.rxe(2,r)}static y9n(b,h,r){Im.i8&&null!==r&&Im.i8.i_a(0,r)}static $8n(b,h,r){Im.i8&&null!==r&&Im.i8.i_a(1,r)}static Avl(b,h,r){Im.i8&&null!==r&&(b==De.a.SG?Im.i8.Cwe(0,
r):b==De.a.aI?Im.i8.Cwe(1,r):b==De.a.bra?Im.i8.Cwe(2,r):b==De.a.separator&&Im.i8.Cwe(3,r))}}Object(u.a)(Im,"PageLevelPropertyChangedHandlers",null,[]);const Bu=[Ec.a.Wfd,Ec.a.Vfd,Ec.a.foe,Ec.a.goe,Ec.a.kre,Ec.a.hre,Ec.a.ire,Ec.a.jre];class kt extends Dg.a{constructor(b,h,r,A,L){super();this.F1c=(Z,oa)=>{var Ba=kt.fid(Z);Z=ed.a.yba;this.wq.hasProperty(Ba)?(Ba=this.wq.getValue(Ba),oa[Ji.a.Number]=Tf.a.cPa(Ba,Z)):oa[Ji.a.Number]=0;oa[Ji.a.UnitType]=Z};this.qnd=(Z,oa)=>{this.wq.setValue(kt.fid(Z),Tf.a.JOa(oa[Ji.a.Number],
oa[Ji.a.UnitType]));this.zv.xn()};this.cKn=Z=>{let oa=!1;1===Z&&(Math.abs(this.wq.getValue(Vc.a.marginTop))+Math.abs(this.wq.getValue(Vc.a.marginBottom))+ed.a.LEa<=this.hya.getValue(Vc.a.pageHeight)&&this.wq.getValue(Vc.a.marginLeft)+this.wq.getValue(Vc.a.marginRight)+ed.a.LEa<=this.hya.getValue(Vc.a.pageWidth)?ry(this.$Fa,this.wq,kt.zkc()):oa=!0);this.dispose();oa&&this.HNa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.YJn)};this.YJn=()=>{Wa.a.instance.resolve("WordEditor.UI.IDialogFactory").D$h(this.$Fa,
this.hya,this.Y9)};this.Ig="MarginsDialog";this.hya=h.clone();this.$Fa=b.clone();this.wq=b.clone();this.Y9=r;this.XY=!1;this.zv=L;this.mh=RD.mh;r&&(this.MFc=Ev.a.N1b);this.Uh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.cKn,null);this.y7c();this.U8e=document.getElementById("DialogMarginTopSpinner");this.e4(this.U8e)}Jba(){this.DTd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Ec.a.Wfd,Ec.a.kre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.DTd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Ec.a.Vfd,Ec.a.hre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.DTd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Ec.a.foe,Ec.a.ire,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.DTd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Ec.a.goe,Ec.a.jre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}y7c(){for(const b of Bu)Object(Hm.a)(b,this.qnd,this.F1c);this.zv.tua("DialogMarginTopSpinner");
this.zv.tua("DialogMarginBottomSpinner");this.zv.tua("DialogMarginLeftSpinner");this.zv.tua("DialogMarginRightSpinner")}dispose(){for(const b of Bu)Object(Hm.b)(b);this.zv.B0("DialogMarginTopSpinner");this.zv.B0("DialogMarginBottomSpinner");this.zv.B0("DialogMarginLeftSpinner");this.zv.B0("DialogMarginRightSpinner");super.dispose()}DTd(b,h,r,A,L){r=kt.Zgl(h,r,A,L);this.RKb(r,b,h)}RKb(b,h,r){h=document.getElementById(h);this.zv.r5a(r,b);b=this.zv.OPb(r,"Medium");h.appendChild(b)}static zkc(){return kt.hSa||
(kt.hSa=kt.xfc())}static xfc(){const b={};b[Vc.a.marginTop.id.toString()]=Im.aKn;b[Vc.a.marginBottom.id.toString()]=Im.XJn;b[Vc.a.marginLeft.id.toString()]=Im.ZJn;b[Vc.a.marginRight.id.toString()]=Im.$Jn;return b}static Zgl(b,h,r,A){let L=!0;if(h===Ec.a.Wfd||h===Ec.a.Vfd)L=!1;return Ak.j(b,h,r,A,[kt.ahl(L),kt.$gl(L)])}static ahl(b){return Ak.l("inch",b?"0":"-22","22",".1")}static $gl(b){return Ak.l("centimeter",b?"0":"-55.8","55.8","1")}static fid(b){let h=null;switch(b){case Ec.a.Wfd:case Ec.a.kre:h=
Vc.a.marginTop;break;case Ec.a.Vfd:case Ec.a.hre:h=Vc.a.marginBottom;break;case Ec.a.foe:case Ec.a.ire:h=Vc.a.marginLeft;break;case Ec.a.goe:case Ec.a.jre:h=Vc.a.marginRight}return h}}kt.hSa=null;Object(u.a)(kt,"MarginsDialog",Dg.a,[]);class jw{static get mh(){return Dg.a.uy(jw.lo,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}jw.lo="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(jw,"PaperSizeDialogHtml",null,[]);const AI=[Ec.a.joe,Ec.a.ioe,Ec.a.zre,Ec.a.yre];class aq extends Dg.a{constructor(b,h,r,A,L){super();this.F1c=(Z,oa)=>{var Ba=this.fid(Z);Z=ed.a.yba;this.wq.hasProperty(Ba)?(Ba=this.wq.getValue(Ba),oa[Ji.a.Number]=Tf.a.cPa(Ba,Z)):oa[Ji.a.Number]=0;oa[Ji.a.UnitType]=Z};this.qnd=(Z,oa)=>{this.wq.setValue(this.fid(Z),Tf.a.JOa(oa[Ji.a.Number],oa[Ji.a.UnitType]));this.zv.xn()};this.L9n=Z=>{let oa=!1;1===Z&&(this.wq.getValue(Vc.a.pageHeight)>=ed.a.LEa+this.hya.getValue(Vc.a.marginTop)+
this.hya.getValue(Vc.a.marginBottom)&&this.wq.getValue(Vc.a.pageWidth)>=ed.a.LEa+this.hya.getValue(Vc.a.marginLeft)+this.hya.getValue(Vc.a.marginRight)?ry(this.$Fa,this.wq,aq.zkc()):oa=!0);this.dispose();oa&&this.HNa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.K9n)};this.K9n=()=>{Wa.a.instance.resolve("WordEditor.UI.IDialogFactory").eai(this.$Fa,this.hya,this.Y9)};this.Ig="PaperSizeDialog";this.hya=h.clone();this.$Fa=b.clone();this.wq=b.clone();this.Y9=r;this.XY=!1;this.zv=L;this.mh=jw.mh;
r&&(this.MFc=Ev.a.N1b);this.Uh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.L9n,null);this.y7c();this.U8e=document.getElementById("DialogWidthSpinner");this.e4(this.U8e)}Jba(){this.FXh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Ec.a.joe,Ec.a.zre,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.FXh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Ec.a.ioe,Ec.a.yre,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}y7c(){for(const b of AI)Object(Hm.a)(b,
this.qnd,this.F1c);this.zv.tua("DialogWidthSpinner");this.zv.tua("DialogHeightSpinner")}dispose(){for(const b of AI)Object(Hm.b)(b);this.zv.B0("DialogWidthSpinner");this.zv.B0("DialogHeightSpinner");super.dispose()}FXh(b,h,r,A,L){r=aq.ohl(h,r,A,L);this.RKb(r,b,h)}RKb(b,h,r){h=document.getElementById(h);this.zv.r5a(r,b);b=this.zv.OPb(r,"Medium");h.appendChild(b)}fid(b){let h=null;switch(b){case Ec.a.ioe:case Ec.a.yre:h=Vc.a.pageHeight;break;case Ec.a.joe:case Ec.a.zre:h=Vc.a.pageWidth}return h}static zkc(){return aq.hSa||
(aq.hSa=aq.xfc())}static xfc(){const b={};b[Vc.a.pageWidth.id.toString()]=Im.y9n;b[Vc.a.pageHeight.id.toString()]=Im.$8n;return b}static ohl(b,h,r,A){return Ak.j(b,h,r,A,[aq.qhl(),aq.phl()])}static qhl(){return Ak.l("inch",aq.cWj,aq.byn,aq.Vap)}static phl(){return Ak.l("centimeter",aq.cWj,aq.ayn,aq.Uap)}}aq.cWj="0";aq.byn="22";aq.Vap=".1";aq.Uap="1";aq.ayn="55.8";aq.hSa=null;Object(u.a)(aq,"PaperSizeDialog",Dg.a,[]);const Qs=RegExp("[{|}|;|\\\\]"),Ck=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
r=b.Qw;let A;for(A=1;A<=r;A++){const L=h+A;if(!(b.JVa(L)||b.Rkc(L)||b.JVa(L+"Char")||b.Rkc(L+"Char")))break}return h+A};class Mw extends Dg.a{constructor(b,h,r,A,L){var Z,oa,Ba,gb;super(!1,!1,!0);this.context=b;this.Pb=h;this.E2=r;this.Yb=A;this.IYa=L;this.o1d=null;this.wyj=(Ab,Jb)=>{if(this.ge.ow){if(0!==Ab){Ab="string"===typeof Jb.styleText?Jb.styleText:null;Jb=this.rqd;var Tb=Ab;const jc=F.a.oDa(Tb);let Hc=null;if(0===jc.length)Hc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<Tb.length)Hc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(Qs.test(Tb))Hc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Jb.GAa(Tb)||Jb.Rkc(jc))Hc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Jb=Hc)?(this.o1d=Jb,Jb=Ck(this.rqd),Ab=this.NPb(Ab,Jb),this.o1d=null,this.XY=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.wyj,Ab),this.XY=!0):(this.hide(),Jb=new Map,Jb.set("Source","ReactCreateNewStyleDialog"),Jb.set("Action","CreateStyle"),
xa.Health.instance.recordKpiUsage(zr.a.MEa,0,zr.a.UB,Jb),this.Wdf(Ab)||(Ab=new Map,Ab.set("Source","ReactCreateNewStyleDialog"),Ab.set("Action","CreateStyle"),Ab=Object.assign(new Na.a,{extendedProperties:Ab}),xa.Health.instance.recordKpiFailure(zr.a.MEa,"CreateStyleFailed",!1,!0,Ab)))}else this.hide();this.ge.O8()}};this.Ig="CreateNewStyleDialog";this.ge=b.view;(b=null===(gb=null===(Ba=null===(oa=null===(Z=this.ge)||void 0===Z?void 0:Z.lb)||void 0===oa?void 0:oa.gb)||void 0===Ba?void 0:Ba.currentSelection)||
void 0===gb?void 0:gb.Qa)?(Z=b.node)?(this.Oh=this.IYa.Iu(Z))?(this.rqd=(new pv.WACStyleSet).gla(this.Oh),(this.cWb=this.E2.l2d(b))?(Z=this.cWb.ka(Ke.a.fontSize,22),16>Z?Uc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=Z?Uc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=Z?Uc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Uc.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),
this.srg(this.cWb),this.Oh&&this.cWb&&(this.vda=!1,Z=Ck(this.rqd),Z=this.NPb(Z,Z),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.wyj,Z))):Uc.b(592737758,3018,10,"_newStyleProperties is null.")):Uc.b(592737757,3018,10,"_pageContenNode is null."):Uc.b(592725466,3018,10,"node is null."):Uc.b(556917206,3018,10,"nodeContext is null.")}srg(b){b.Vf(cg.a.gx,cg.a.Lw,...zr.a.Waa())}NPb(b,h){const r=52<=this.cWb.ka(Ke.a.fontSize,Pn.a.VO),A=kB.a.HHf(this.cWb,"97%",26,!1,!0,r);A["padding-left"]=
"5px";r||(A["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>A};this.o1d&&(b.errorMessage=this.o1d);return{["id"]:this.Ig,["bodyControls"]:b}}Wdf(b){const h=new Sb.GraphTransaction(15);h.Ab(this.Oh);h.Ph=vb.a.UMb;const r=Ki.a.Wdf(b,Ki.a.IEi(this.cWb),null,this.Oh);r&&(Uc.b(593078046,
3018,50,"User created linked style"),this.rqd=(new pv.WACStyleSet).gla(this.Oh),b=F.a.oDa(F.a.P_(b)),b=this.rqd.Rkc(b),this.Pb.Hf(this.context,vb.a.zT,2,!1,new BA.a,this.Yb.Be(b)));h.dispose();return r}}Object(u.a)(Mw,"ReactCreateNewStyleDialog",Dg.a,[]);class Nw extends Dg.a{constructor(b,h=!1,r){super(!1,!1,h);let A=h=this.zM=null;this.Ig=Nw.id;this.zh=b.view;this.Ep=r;this.zh&&(A=this.zh.lb);A&&A.gb&&A.gb.currentSelection&&(h=A.gb.currentSelection.Qa);h?(b=h.node)?(this.FM=Object(so.a)().Iu(b))||
v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}wEp(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.dhm();const A=""===F.a.oDa(b),L=b.length>Nw.oLn;r=r.includes(b);h=h.test(b);b=b.startsWith("_");let Z=null;if(A||L||r||b||!h)Z=A?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:L?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:
b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return Z}$fn(b,h){return b?b===h:!1}dhm(){const b=this.Ep.r4d(!1),h=[];for(let r=0;r<b.count;r++){const A=b.K(r).ka(Vc.a.tu,"");h.push(A)}return h}}Nw.id="BookmarkEditDialog";Nw.oLn=40;Object(u.a)(Nw,"AEditBookmarkDialog",Dg.a,[]);class BI extends Nw{constructor(b,h,r){super(b,!0,r);this.XQe=null;this.m2a=
"wwaengidc";this.gKc="ReactCreateEditBookmarkNameDialog";this.grh="EditBookmarkName";this.hxa="EditBookmarkNameDialog";this.XKe=h;this.Ep=r;this.FM&&(this.vda=!1,b=this.NPb(h.properties.ka(Vc.a.tu,null)),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.yyj.bind(this),b))}yyj(b,h){if(this.zh.ow){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.XKe.hasProperty(Vc.a.tu)?r=this.XKe.getValue(Vc.a.tu):v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.wEp(b);
this.$fn(b,r)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.XQe=h,r=this.NPb(b),this.XQe=null,this.XY=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.yyj.bind(this),r),this.XY=!0):(this.hide(),r=new Map,r.set("Source",this.gKc),r.set("Action",this.grh),xa.Health.instance.recordKpiUsage(this.hxa,0,this.m2a,r),this.Mnl(b)||(r=new Map,r.set("Source",this.gKc),r.set("Action",this.grh),
r=Object.assign(new Na.a,{extendedProperties:r}),xa.Health.instance.recordKpiFailure(this.hxa,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.zh.O8()}}Mnl(b){b=F.a.oDa(F.a.P_(b));try{const h=this.Ep.Cvp(this.XKe,b);if(h)v.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return v.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",
h.Message),!1}}NPb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.XQe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.Ig,["bodyControls"]:h}}}Object(u.a)(BI,"ReactEditBookmarkNameDialog",Nw,[]);class Ft extends Dg.a{constructor(b,h,r,A){super(!1,!1,!0);this.xvl=()=>{this.VYc.m9h(this.WQi,this.yFe,this.dad)};this.yvl=(L,Z)=>{Z&&1===L&&(Z.columnsCountSpinButtonProps&&this.k0.setValue(De.a.SG,Z.columnsCountSpinButtonProps.value),Z.columnsWidthSpinButtonProps&&
(L=Z.columnsWidthSpinButtonProps,this.k0.setValue(De.a.aI,[Tf.a.JOa(L.value,Tf.a.dUa(L.unitType.toLowerCase()))])),Z.columnsSpacingSpinButtonProps&&(L=Z.columnsSpacingSpinButtonProps,this.k0.setValue(De.a.bra,Tf.a.JOa(L.value,Tf.a.dUa(L.unitType.toLowerCase())))),Z.columnsLineBetweenCheckboxProps&&this.k0.setValue(De.a.separator,Z.columnsLineBetweenCheckboxProps.checked),this.Bvl()&&(Z=Ft.iTd,this.D$k()?ry(this.WQi,this.k0,this.zkc):Z=Z!==Ft.iTd?Z:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),
Z!==Ft.iTd&&this.HNa(Z,this.xvl)))};this.Bvl=()=>this.k0.hasProperty(De.a.SG)&&this.k0.hasProperty(De.a.aI)&&this.k0.hasProperty(De.a.bra)&&this.k0.hasProperty(De.a.separator);this.J4d=(L,Z,oa)=>Math.floor((L-(Z-1)*oa)/Z);this.CGf=(L,Z,oa)=>1==Z?0:Math.floor((L-Z*oa)/(Z-1));this.b4k=(L,Z,oa,Ba)=>{const gb=L/Z;oa<Ft.eyc?(oa=Ft.eyc,Ba=this.CGf(L,Z,oa)):oa>gb&&(oa=gb,Ba=this.CGf(L,Z,oa));return[oa,Ba]};this.Z3k=(L,Z,oa,Ba)=>{const gb=(L-Ft.eyc*Z)/(Z-1);0>Ba?(Ba=0,oa=this.J4d(L,Z,Ba)):Ba>gb&&(Ba=gb,oa=
this.J4d(L,Z,Ba));return[oa,Ba]};this.JOa=(L,Z)=>Tf.a.JOa(L,Tf.a.dUa(Z));this.RXc=(L,Z,oa,Ba,gb)=>({["unitType"]:L,["unitPlaceholder"]:F.a.Gpe(Z),["minValue"]:oa,["maxValue"]:Ba,["step"]:gb});this.WQi=b.clone();this.k0=b.clone();this.yFe=h.clone();this.owb=this.yFe.getValue(Vc.a.pageWidth)-this.yFe.getValue(Vc.a.marginLeft)-this.yFe.getValue(Vc.a.marginRight);this.AVb=Math.floor(this.owb/Ft.eyc);this.dad=r;this.VYc=A;this.Ig=Ft.id;b={};b.getUnitValue=3==ed.a.yba?Tf.a.iB:Tf.a.l0a;b.getCalculatedWidthValue=
this.J4d;b.getCalculatedSpacingValue=this.CGf;b.twipsFromValueAndUnits=this.JOa;b.adjustWidthForLimits=this.b4k;b.adjustSpacingForLimits=this.Z3k;b.pageContentWidth=this.owb;b.maxColumnCount=this.AVb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.nmm();b.columnsWidthSpinButtonProps=this.rmm();b.columnsSpacingSpinButtonProps=this.pmm();b.columnsLineBetweenCheckboxProps=
this.omm();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Uh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.yvl.bind(this),b)}nmm(){var b=[this.RXc("None",0,1,this.AVb,1)];const h=this.YMf(De.a.SG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Tf.a.Q6a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",
["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.a0b(h,b)}rmm(){var b=[this.RXc("Inch",3,.5,Tf.a.iB(this.owb),.1),this.RXc("Centimeter",1,1.27,Tf.a.l0a(this.owb),1)];const h=ed.a.yba,r=this.YMf(De.a.aI);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Tf.a.Q6a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.a0b(r,b)}pmm(){var b=[this.RXc("Inch",3,0,Tf.a.iB(this.owb-2*Ft.eyc),.1),this.RXc("Centimeter",1,0,Tf.a.l0a(this.owb-2*Ft.eyc),1)];const h=ed.a.yba,r=this.YMf(De.a.bra);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,
["unitType"]:Tf.a.Q6a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.a0b(r,b)}omm(){const b=this.k0.getValue(De.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,
["checked"]:b}}get zkc(){return null!=this.MWg?this.MWg:this.MWg=(()=>this.xtf())()}xtf(){const b={};b[De.a.SG.id.toString()]=b[De.a.aI.id.toString()]=b[De.a.bra.id.toString()]=b[De.a.separator.id.toString()]=Im.Avl;return b}D$k(){const b=this.k0.getValue(De.a.aI),h=this.k0.getValue(De.a.SG),r=this.k0.getValue(De.a.bra);let A=0;for(let L=0;L<h;L++)A+=b[0];if(h<=this.AVb&&(h-1)*r+A<=this.owb)return!0;v.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",
h,b[0],r);return!1}YMf(b){if(this.k0.hasProperty(b)){if(b==De.a.SG)return this.k0.getValue(b);if(b==De.a.aI){var h=ed.a.yba;b=this.k0.getValue(De.a.bra);const r=this.k0.getValue(De.a.SG);return Tf.a.cPa(this.J4d(this.owb,r,b),h)}if(b==De.a.bra){if(1==this.k0.getValue(De.a.SG))return 0;h=ed.a.yba;b=this.k0.getValue(b);return Tf.a.cPa(b,h)}}return 0}a0b(b,h){h.value=isNaN(b)?Ft.iTd:b;return h}}Ft.id="ColumnsDialog";Ft.iTd="";Ft.eyc=720;Object(u.a)(Ft,"WordReactColumnsDialog",Dg.a,[]);var xK=d(492),
Dp=d(891);class CI{constructor(){this.xWj=this.Xqj=this.Vqj=this.P9n=this.aig=!1}}Object(u.a)(CI,"Box4PropertySetChangedState",null,[]);class Rl{static get umc(){return null!=Rl.xXg?Rl.xXg:Rl.xXg=Wa.a.instance.Oa("Box4.IIndentationCommands")}static get y4i(){return null!=Rl.N_g?Rl.N_g:Rl.N_g=Wa.a.instance.Oa("Box4.IJustificationCommands")}static get H8(){return null!=Rl.U3g?Rl.U3g:Rl.U3g=Wa.a.instance.Oa("Box4.ISpacingCommands")}static Xwn(b,h,r){Rl.y4i&&r&&(null===h||11!==r||10!==h&&9!==h)&&Rl.y4i.wH(r)}static yAn(b,
h,r){Rl.H8&&r&&Rl.H8.UE(r)}static NAl(b,h,r){h!=r&&Rl.H8.Nwc(r)}static kxn(b,h,r){h!=r&&Rl.H8.Lnd(r)}static kHp(b,h,r){h!=r&&Rl.H8.Aod(r)}static ixn(b,h,r){h!=r&&Rl.H8.Knd(r)}static crj(b,h,r,A){Rl.H8&&void 0!==r&&null!==r&&(b=Rl.$1c(A),!b.aig&&A.qR.hasProperty(Od.a.otc)&&A.qR.hasProperty(Od.a.ptc)&&(h=A.qR.getValue(Od.a.ptc),A=A.qR.getValue(Od.a.otc),b.aig=!0,Rl.H8.nha(1,h,A)))}static brj(b,h,r,A){Rl.H8&&void 0!==r&&null!==r&&(b=Rl.$1c(A),!b.P9n&&A.qR.hasProperty(Od.a.mtc)&&A.qR.hasProperty(Od.a.ntc)&&
(h=A.qR.getValue(Od.a.ntc),A=A.qR.getValue(Od.a.mtc),b.aig=!0,Rl.H8.nha(0,h,A)))}static Uqj(b,h,r,A){Rl.umc&&void 0!==r&&null!==r&&(b=Rl.$1c(A),!b.Vqj&&A.qR.hasProperty(Od.a.GMa)&&A.qR.hasProperty(Od.a.HMa)&&(h=A.qR.getValue(Od.a.HMa),A=A.qR.getValue(Od.a.GMa),b.Vqj=!0,Rl.umc.XOj(1,h,A)))}static Wqj(b,h,r,A){Rl.umc&&void 0!==r&&null!==r&&(b=Rl.$1c(A),!b.Xqj&&A.qR.hasProperty(Od.a.rwb)&&A.qR.hasProperty(Od.a.swb)&&(h=A.qR.getValue(Od.a.swb),A=A.qR.getValue(Od.a.rwb),b.Xqj=!0,Rl.umc.XOj(0,h,A)))}static eDg(b,
h,r,A){Rl.umc&&void 0!==r&&null!==r&&(b=Rl.$1c(A),!b.xWj&&A.qR.hasProperty(Od.a.E_a)&&A.qR.hasProperty(Od.a.F_a)&&(h=0,A.qR.hasProperty(Od.a.I8)&&(h=A.qR.getValue(Od.a.I8)),r=A.qR.getValue(Od.a.F_a),A=A.qR.getValue(Od.a.E_a),b.xWj=!0,Rl.umc.Lxe(h,r,A)))}static $1c(b){b.ao||(b.ao=new CI);return b.ao}}Object(u.a)(Rl,"ParagraphLevelPropertyChangedHandlers",null,[]);class Ow{constructor(){this.hSa=null}AEm(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,
["forId"]:"SpacingGroup"};var r=Dp.a("Point",5,0,1584,1),A=Dp.a("Line",4,0,327,1),L=[r,A];A=Dp.d();var Z=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];var oa;({fyc:gb,lfb:Ba,hnc:oa}=Dp.c(b,Od.a.ptc,Od.a.otc));var Ba={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Tf.a.Q6a(Ba),["validUnits"]:L,["numberFormatInfo"]:A,["validReservedValues"]:Z};
oa?Ba.reservedValue=Z[0]:Ba.value=isNaN(gb)?"":gb;h.beforeSpacingSpinButtonProps=Ba;({fyc:gb,lfb:Ba,hnc:oa}=Dp.c(b,Od.a.ntc,Od.a.mtc));L={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Tf.a.Q6a(Ba),["validUnits"]:L,["numberFormatInfo"]:A,["validReservedValues"]:Z};oa?L.reservedValue=Z[0]:L.value=isNaN(gb)?"":gb;h.afterSpacingSpinButtonProps=
L;Z=(L=b.hasProperty(Od.a.xa))&&Dp.f(b,Ow.Oab.pQb(b));L=L?Dp.g(b,Ow.Oab.pQb(b),Z):null;var gb={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:Dp.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],
["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};L?gb.selectedKey=L:gb.defaultSelectedKey="";h.lineSpacingComboBoxProps=gb;L=0;gb=!1;b.hasProperty(Od.a.xa)&&b.hasProperty(Od.a.Pab)&&2===b.getValue(Od.a.Pab)&&Z&&(L=Ow.Oab.pQb(b),gb=!0,1>L&&(L=Number.NaN));b=[Dp.a("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",
["validUnits"]:b,["numberFormatInfo"]:A,["validReservedValues"]:r};gb?b.value=L:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}zkc(){return this.hSa||(this.hSa=this.xfc())}xfc(){const b={};b[Od.a.xa.id.toString()]=Rl.yAn;b[Od.a.ntc.id.toString()]=Rl.brj;b[Od.a.mtc.id.toString()]=Rl.brj;b[Od.a.ptc.id.toString()]=Rl.crj;b[Od.a.otc.id.toString()]=Rl.crj;return b}static get Oab(){return null!=Ow.$_g?Ow.$_g:Ow.$_g=Wa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(u.a)(Ow,"ReactParagraphDialog",
null,[]);const DI=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,GF=(b,h,r,A)=>{let L=ed.a.yba;b.hasProperty(h)&&b.hasProperty(r)&&!A?(h=b.getValue(h),b=b.getValue(r),h?2===b?L=2:h=Tf.a.cPa(h,L):ed.a.mLa&&(L=2)):(h=Number.NaN,ed.a.mLa&&(L=2));return{fyc:h,lfb:L}},yK=b=>{let h="0";b.hasProperty(Od.a.I8)&&(b=b.getValue(Od.a.I8),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},pz=(b,h)=>{if(h.hasProperty(Od.a.I8)&&2===h.getValue(Od.a.I8)&&h.hasProperty(Od.a.F_a)&&
h.hasProperty(Od.a.E_a)&&b.hasProperty(Od.a.HMa)&&b.hasProperty(Od.a.GMa)){var r=b.getValue(Od.a.HMa),A=b.getValue(Od.a.GMa);r=(new Qt.a(A,r)).Qu;A=h.getValue(Od.a.F_a);h=h.getValue(Od.a.E_a);h=(new Qt.a(h,A)).Qu;b.setValue(Od.a.HMa,r+h);b.setValue(Od.a.GMa,1)}},So=b=>{const h=b.getValue(Od.a.HMa);b=b.getValue(Od.a.GMa);return(new Qt.a(b,h)).Qu},be=b=>{const h=b.getValue(Od.a.swb);b=b.getValue(Od.a.rwb);return(new Qt.a(b,h)).Qu},HF=(b,h)=>h.hasProperty(Od.a.HMa)&&h.hasProperty(Od.a.GMa)&&h.hasProperty(Od.a.swb)&&
h.hasProperty(Od.a.rwb)&&b.hasProperty(Vc.a.marginLeft)&&b.hasProperty(Vc.a.marginRight)&&b.hasProperty(Vc.a.pageWidth),tC=b=>b.hasProperty(Od.a.ygd)?b.getValue(Od.a.ygd):!1,FL=b=>b.hasProperty(De.a.keepWithNext)?b.getValue(De.a.keepWithNext):!1,Qk=b=>b.hasProperty(De.a.widowControl)?b.getValue(De.a.widowControl):!1,pq=b=>b.hasProperty(De.a.keepTogether)?b.getValue(De.a.keepTogether):!1;class DA extends Dg.a{constructor(b,h,r,A){super(!1,!1,!0);this.OKh=null;this.Z9n=()=>{Wa.a.instance.resolve("Box4.UI.IBox4DialogFactory").rYd(this.$Fa,
this.hya,this.Y9)};this.a$n=(gb,Ab)=>{if(Ab&&(1===gb||2===gb)){if(Ab.alignmentComboBoxProps){var Jb=parseInt(Ab.alignmentComboBoxProps.selectedKey);isNaN(Jb)||DI(Jb)&&this.wq.setValue(Od.a.Jx,Jb)}var Tb=Ab.bySpinButtonProps;Jb=!!Tb&&""!==Tb.value;var jc=Ab.didChangeSpecialIndentationComboBoxValue;if(Ab.specialIndentationComboBoxProps){var Hc=parseInt(Ab.specialIndentationComboBoxProps.selectedKey);1!==Hc&&2!==Hc&&Hc||!(Hc||jc||Jb)||this.wq.setValue(Od.a.I8,Hc)}if(Tb){Hc=Tb.value;Tb=Tf.a.dUa(Tb.unitType.toLowerCase());
let hd;0<=Hc||(Hc=0);2===Tb?hd=2:(hd=1,Hc=Tf.a.JOa(Hc,Tb));if(Jb||jc)this.wq.setValue(Od.a.F_a,Hc),this.wq.setValue(Od.a.E_a,hd)}Ab.beforeTextSpinButtonProps&&(jc=Ab.beforeTextSpinButtonProps,Jb=Tf.a.dUa(jc.unitType.toLowerCase()),jc=""===jc.value?Number.NaN:jc.value,isNaN(jc)||(Hc=jc,2===Jb?Tb=2:(Tb=1,Hc=Tf.a.JOa(jc,Jb)),this.wq.setValue(Od.a.HMa,Hc),this.wq.setValue(Od.a.GMa,Tb)));Ab.afterTextSpinButtonProps&&(jc=Ab.afterTextSpinButtonProps,Jb=Tf.a.dUa(jc.unitType.toLowerCase()),jc=""===jc.value?
Number.NaN:jc.value,isNaN(jc)||(Hc=jc,2===Jb?Tb=2:(Tb=1,Hc=Tf.a.JOa(jc,Jb)),this.wq.setValue(Od.a.swb,Hc),this.wq.setValue(Od.a.rwb,Tb)));Ab.beforeSpacingSpinButtonProps&&(Jb=Ab.beforeSpacingSpinButtonProps,jc=Tf.a.dUa(Jb.unitType.toLowerCase()),Hc=Jb.reservedValue,""!==Jb.value&&(Hc===Box4Intl.Box4Strings.L_SpinnerAuto?(jc=1,Jb=0):(jc=4===jc?2:4,Jb=Jb.value),this.wq.setValue(Od.a.ptc,Jb),this.wq.setValue(Od.a.otc,jc)));Ab.afterSpacingSpinButtonProps&&(Jb=Ab.afterSpacingSpinButtonProps,jc=Tf.a.dUa(Jb.unitType.toLowerCase()),
Hc=Jb.reservedValue,""!==Jb.value&&(Hc===Box4Intl.Box4Strings.L_SpinnerAuto?(jc=1,Jb=0):(jc=4===jc?2:4,Jb=Jb.value),this.wq.setValue(Od.a.ntc,Jb),this.wq.setValue(Od.a.mtc,jc)));if(Ab.atSpinButtonProps||Ab.lineSpacingComboBoxProps)if(Jb=Ab.atSpinButtonProps.value,1<Jb)this.wq.setValue(Od.a.xa,Jb),this.wq.setValue(Od.a.Pab,2);else if(Jb=Ab.lineSpacingComboBoxProps.selectedKey)Jb=Dp.e(Jb),Jb=1<=Jb?Jb:1,this.wq.setValue(Od.a.xa,Jb),this.wq.setValue(Od.a.Pab,2);Ab.contextualSpacingCheckboxProps&&this.wq.setValue(Od.a.ygd,
Ab.contextualSpacingCheckboxProps.checked);Ab.keepWithNextCheckboxProps&&this.wq.setValue(De.a.keepWithNext,Ab.keepWithNextCheckboxProps.checked);Ab.widowOrphanCheckboxProps&&this.wq.setValue(De.a.widowControl,Ab.widowOrphanCheckboxProps.checked);Ab.keepTogetherCheckboxProps&&this.wq.setValue(De.a.keepTogether,Ab.keepTogetherCheckboxProps.checked);pz(this.$Fa,this.$Fa);pz(this.wq,this.$Fa);Ab="";Jb=this.hya;jc=this.wq;if(Hc=HF(Jb,jc))Hc=jc.hasProperty(Od.a.F_a)&&jc.hasProperty(Od.a.E_a);Hc?(Hc=jc.getValue(Od.a.F_a),
Tb=jc.getValue(Od.a.E_a),Hc=(new Qt.a(Tb,Hc)).Qu,Jb=So(jc)+be(jc)+Jb.getValue(Vc.a.marginRight)+Jb.getValue(Vc.a.marginLeft)+Hc+ed.a.LEa<=Jb.getValue(Vc.a.pageWidth)):Jb=HF(Jb,jc)?So(jc)+be(jc)+Jb.getValue(Vc.a.marginRight)+Jb.getValue(Vc.a.marginLeft)+ed.a.LEa<=Jb.getValue(Vc.a.pageWidth):!0;Jb?ry(this.$Fa,this.wq,this.iSm(this.C7e?this.C7e.xfc():{})):Ab=""!==Ab?Ab:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Ab?this.HNa(Ab,this.Z9n):2===gb&&(me.c(Ec.a.Kxc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),
this.ga.Qb(Ec.a.Kxc,2,null))}};this.$Fa=b.clone();this.wq=b.clone();this.hya=h.clone();this.Y9=r;this.ga=A;this.C7e=new Ow;b=this.C7e.AEm(this.wq);h=Dp.a("Inch",3,-11,22,.1);r=Dp.a("Inch",3,0,22,.1);var L=Dp.a("Centimeter",1,-27.94,55.88,1);A=Dp.a("Centimeter",1,0,55.88,1);var Z=Dp.a("Character",2,-316.8,316.8,.5),oa=Dp.a("Character",2,0,316.8,.5);h=[h,L,Z];A=[r,A,oa];r=Dp.d();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};L=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];Z=["1","2","3","6","7"];let Ba=5;oa=this.wq.hasProperty(Od.a.Jx)?this.wq.getValue(Od.a.Jx):0;if(10===oa||9===oa)oa=11;if(y.AFrameworkApplication.lcid===kg.a.Eg("AR-SA").LCID||11===oa)b.isKashidaSupported=!0,L[Ba]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
Z[Ba]="11",Ba=6;if(y.AFrameworkApplication.lcid===kg.a.Eg("TH-TH").LCID||13===oa)b.isThaiSupported=!0,L[Ba]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,Z[Ba]="13";L={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:Dp.b(L,Z),["allowFreeForm"]:!1};DI(oa)?L.selectedKey=oa.toString():L.defaultSelectedKey="";b.alignmentComboBoxProps=
L;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};oa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:FL(this.wq)};b.keepWithNextCheckboxProps=oa;oa={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:Qk(this.wq)};
b.widowOrphanCheckboxProps=oa;oa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:pq(this.wq)};b.keepTogetherCheckboxProps=oa;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};L=yK(this.wq);oa="0"===L;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:Dp.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:L,["allowFreeForm"]:!1};Z=ed.a.yba;L=0;({fyc:L,lfb:Z}=GF(this.wq,Od.a.F_a,Od.a.E_a,oa));A={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Tf.a.Q6a(Z),["validUnits"]:A,["numberFormatInfo"]:r};A=this.a0b(L,A);b.bySpinButtonProps=A;oa=ed.a.yba;A=0;({fyc:A,lfb:oa}=GF(this.wq,Od.a.HMa,Od.a.GMa,!1));oa={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Tf.a.Q6a(oa),["validUnits"]:h,["numberFormatInfo"]:r};
oa=this.a0b(A,oa);b.beforeTextSpinButtonProps=oa;oa=ed.a.yba;A=0;({fyc:A,lfb:oa}=GF(this.wq,Od.a.swb,Od.a.rwb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Tf.a.Q6a(oa),["validUnits"]:h,["numberFormatInfo"]:r};h=this.a0b(A,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:tC(this.wq)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=xK.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?
void 0:"left",["margin-left"]:"0"}}};this.Uh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.a$n,h)}iSm(b){return this.OKh||(this.OKh=this.xtf(b))}xtf(b){b[Od.a.Jx.id.toString()]=Rl.Xwn;b[Od.a.GMa.id.toString()]=Rl.Uqj;b[Od.a.HMa.id.toString()]=Rl.Uqj;b[Od.a.rwb.id.toString()]=Rl.Wqj;b[Od.a.swb.id.toString()]=Rl.Wqj;b[Od.a.I8.id.toString()]=Rl.eDg;b[Od.a.E_a.id.toString()]=Rl.eDg;b[Od.a.F_a.id.toString()]=Rl.eDg;b[Od.a.ygd.id.toString()]=Rl.NAl;b[De.a.keepWithNext.id.toString()]=Rl.kxn;b[De.a.widowControl.id.toString()]=
Rl.kHp;b[De.a.keepTogether.id.toString()]=Rl.ixn;return b}a0b(b,h){h.value=isNaN(b)?"":b;return h}}Object(u.a)(DA,"WordReactParagraphDialog",Dg.a,[]);class IF{YDl(b){new CA(b,Wa.a.instance.resolve("Box4.IFeatureHelper"))}iIl(b,h){new Mw(b,h,Wa.a.instance.resolve("Box4.IFormattingReader"),Wa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Object(so.a)())}pZl(b,h,r){new BI(b,h,r)}D$h(b,h,r){new kt(b,h,r,Wa.a.instance.resolve("WordEditor.IPageCommands"),Wa.a.instance.resolve("Common.IStandaloneRootController").uha)}eai(b,
h,r){new aq(b,h,r,Wa.a.instance.resolve("WordEditor.IPageCommands"),Wa.a.instance.resolve("Common.IStandaloneRootController").uha)}m9h(b,h,r){new Ft(b,h,r,Wa.a.instance.resolve("WordEditor.UI.IDialogFactory"))}oDl(b){return new jt(b)}rYd(b,h,r){new DA(b,h,r,y.AFrameworkApplication.va)}fRl(){const b=Wa.a.instance.Oa("Box4.IRoamingServiceRequestManager");null==b?Uc.b(524834398,3018,10,"Roaming service not resolved."):new OD(b)}kRl(b,h){new Au(b,h)}yvf(b){return new zI(b)}}Object(u.a)(IF,"DialogFactory",
null,[412,413]);class hC extends Dg.a{constructor(b,h,r=null){super(!1,!1,!0);this.Ugi="DoNotCheckSpellingCheckbox";this.$if="AutoDetectLanguageCheckbox";this.fhi="DocumentChoiceGroup";this.Tyd=0;this.T4i="LanguageList";this.documentContext="DocumentContext";this.Sr="RangeContext";this.Spl="CheckmarkWithDynamicColor_16";this.Pda=null;this.nWo=(A,L)=>{const Z=ih.a.instance.rq(vb.a.rOj);if(1!==A)Z.properties.W("canceled","true");else{A=L[this.T4i].replace(hC.kQg,"");var oa=parseInt(A),Ba=Boolean.parse(L[this.Ugi]),
gb;xA.a.xua&&(gb=Boolean.parse(L[this.$if]));L=L[this.fhi];L===this.documentContext?this.rFd.ZTo(oa,Ba):this.rFd.vZo(oa,Ba);xA.a.xua&&this.$if&&null!==this.Pda&&this.Pda.gMo(gb);Z.properties.W("PreviousLCID",this.Tyd.toString());Z.properties.W("ChangedLCID",oa.toString());Z.properties.W("NoProof",Ba.toString());xA.a.xua&&Z.properties.W("AutoDetect",gb.toString());this.krh.mWo(oa,this.Tyd);me.d(vb.a.rOj,!0,void 0,void 0,void 0,void 0,[Object.assign(new da.a,{name:"SelectedLcid",string:A}),Object.assign(new da.a,
{name:"NoProof",string:Ba.toString()}),Object.assign(new da.a,{name:"Context",string:L}),xA.a.xua?Object.assign(new da.a,{name:"AutoDetect",string:gb.toString()}):null].filter(Boolean));ab.StaticActiveAppFrame.za().Ge(!0)}Z.end()};this.krh=h;this.rFd=b;this.Pda=r}YBg(){const b=Array(2);b[0]={["key"]:this.Sr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=
Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.fhi,["defaultSelectedKey"]:this.Gpm(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.Tyd=({Wjo:this.Csk}=this.rFd.ZJm()).returnValue;h.languageListPropsProvider=this.Lxm();h.spellingCheckboxProps={["id"]:this.Ugi,["checked"]:!this.Csk,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};xA.a.xua&&(h.autoDetectLanguageCheckboxProps={["id"]:this.$if,["checked"]:null!==
this.Pda?this.Pda.QLf():!1,["label"]:WordEditorIntl.WordEditorStrings.l_AutoDetectLanguage,["checkmarkIcon"]:this.Spl});this.Uh(Box4Intl.Box4Strings.l_Language,this.nWo,{["id"]:"LanguageDialog",["bodyControls"]:h})}Gpm(){return this.rFd.mf()?this.documentContext:this.Sr}Lxm(){return()=>{let b,h;const r=({selectedIndex:b,iyc:h}=this.krh.Kxm(this.Tyd)).returnValue;for(let A=0;A<r.length&&A<h;A++)r[A].value=hC.kQg+r[A].value;return{["id"]:this.T4i,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}
hC.kQg="recent-";Object(u.a)(hC,"ReactLanguageDialog",Dg.a,[411]);class EI extends mr{constructor(b,h,r,A){super(h,r);this.Sjg=()=>{this.rR.xn()};this.ii=b;this.HK=A}Fnb(b,h,r){if(b=super.Fnb(b,h,r))b.euc=!0,b.nqe=!0,b.preventDismissOnScroll=!0;this.ii.B5a(this.Sjg);return b}t7c(b,h,r=null){this.HK.OVh(()=>this.Fnb(b,h,r))}dme(){this.rR.euc=!0}}Object(u.a)(EI,"ExternalContentFloatieInitializer",mr,[]);class Ay{DXb(){bm.instance.$fa&&(gt.instance.vfb([1,0]),bm.instance.gge()&&Ns.instance.vfb([1]))}}
Object(u.a)(Ay,"RulerUser",null,[409]);class Pw{constructor(){this.whitelistedControlIds=null}}Object(u.a)(Pw,"StatusBarProps",null,[]);class Rs{constructor(b,h,r=!0){this.sa=new Bf.a;this.TXj=()=>4;this.cKd=!1;this.L4e=null;this.Eja=h.eJ;this.X8e=h.QXj;r?zk.a.get_instance().Sk(7,()=>{this.IXh(b,h)}):this.IXh(b,h)}IXh(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();Cq.a.instance.le(()=>{Ol.UISurfaces.cMm().then(A=>{r.StatusBarApiResolutionTime=
Date.now();const L=Object.assign(new Pw,{whitelistedControlIds:h.whitelistedControlIds});A.initializeNewStatusBar(b,L,this.X8e);this.L4e=A;this.cKd=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=Date.now();Cq.a.instance.le(()=>{const Z=[];if(h.bJ){const oa=h.bJ;for(const Ba in oa)Z.push(appChrome.actions.updateControlHiddenState(Ba,oa[Ba]));appChrome.api.dispatch(Z)}r.PollingStartTime=Date.now();this.DXb();r.PollingEndTime=Date.now();
v.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.boo();return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.rva&&b){Rs.vkh||(y.AFrameworkApplication.va.qa(Za.a.SXj,Gc.a.frame,this.TXj),y.AFrameworkApplication.va.qa(Za.a.RXj,Gc.a.frame,this.TXj),Rs.vkh=!0);const A=Ev.a.jbe(h.rva,
h.INj,b,!1);A.IL=!0;this.EYb(A,Za.a.SXj,Za.a.RXj)}},0)}DXb(){this.cKd&&this.Eja&&window.setTimeout(()=>{this.Eja(this.L4e.selectors.getStatusBarControlsMap(this.X8e),7)},0)}iyb(b,h){this.cKd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}aV(b){this.cKd&&this.Eja&&window.setTimeout(()=>{const h=this.L4e.selectors.getStatusBarControlsMap(this.X8e);if(h[b]){const r={};r[b]=h[b];this.Eja(r,7)}},0)}EYb(b,h,r){const A=Cb.KeyInputManager.oc(jf.a.pz,0),
L=Cb.KeyInputManager.oc(jf.a.pz,4);b.ot(A);b.ot(L);b.bindAction(A,h);b.bindAction(L,r)}boo(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}Rs.vkh=!1;Object(u.a)(Rs,"ReactStatusBar",null,[]);class Ex{constructor(){this.whitelistedControlIds=this.bJ=this.eJ=null;this.Hvn=!1;this.INj=this.rva=this.QXj=null}}Object(u.a)(Ex,"ReactStatusBarInitOptions",null,[]);var Rp=d(484);class Gt{constructor(b,h,r,A,L){this.$9b=this.iSa=this.Aa=null;this.Bep=()=>{const Z=ab.StaticActiveAppFrame.za().tq.getRegion(Nk.a.rva);
Z&&Z.I8f()};this.iYm=(Z,oa,Ba,gb,Ab)=>{if(!Ab)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ba)return 32;Ab&&2===Ab.length&&this.iSa&&this.iSa.iyb(Ab[0],Ab[0]);return 32};this.etd=Z=>{ab.StaticActiveAppFrame.za().eJ(Z)};this.ga=A;Cq.a.instance.le(()=>{this.Aa=L;this.$9b=this.iSa=null;const Z={};y.AFrameworkApplication.VUj||(Z[Rp.a.yKo]=!0);Z.GiveFeedback=!y.AFrameworkApplication.VE;this.Aa.$("OfficeOnlineInGallatinTextVisible")||
(Z.CenterStatusLabel=!0);Z[Rp.a.rqj]=!0;this.Aa.$("WPMPackageIsEnabled")&&this.Aa.$("WPMStatusBarLabelIsEnabled")||(Z[Rp.a.PNg]=!0);this.Aa.$("AddInCommandsIsEnabled")||(Z[Rp.a.rXk]=!0);this.Aa.$("WordEditorShowOcsConnectionStatus")||(Z[Rp.a.hcg]=!0);Z[Rp.a.aIp]=!0;this.Aa.$("ReadingTimeIsEnabled")||(Z[Rp.a.Lyj]=!0);window.setTimeout(()=>{this.o9m(b,Z)},0)},"SBU:I")}Xb(){this.ga.fb(vb.a.wAe,kc.a.application,this.iYm,96)}o9m(b,h){this.$9b=Wa.a.instance.Oa("WordEditor.WordEditorReactCommandDefinitionMapping");
const r={};for(const L in h){var A=h[L];r[this.XLf(L)]=A}this.iSa=new Rs(b,Object.assign(new Ex,{bJ:r,eJ:this.etd,Hvn:!1,QXj:"WordEditorStatusBar",rva:Nk.a.rva,INj:this.Bep}))}XLf(b){let h="";if(this.$9b){const r=this.$9b.zIf(b);r&&0<r.count&&(h=r.K(0))}return h&&""!==h?h:b}DXb(){this.iSa&&this.iSa.DXb()}iyb(b,h){this.iSa&&this.iSa.iyb(this.XLf(b),h)}aV(b){this.iSa&&this.iSa.aV(this.XLf(b))}dispose(){}}Object(u.a)(Gt,"StatusBarUser",null,[410,10]);var FI=d(1591);class nr{constructor(b){this.ild=(h,
r,A,L,Z)=>{this.ga.Ob(this.rsm(Z[FI.a.Eoe]),2);return 32};this.ga=b;this.ga.qa(Za.a.ild,Gc.a.frame,this.ild);this.ga.qa(Za.a.fFj,Gc.a.frame,Vd.ActionManager.eg)}}Object(u.a)(nr,"FileMenuSQMInformation",null,[1813]);class qz extends nr{constructor(b){super(b);this.Ouo()}Ouo(){this.ga.qa(Za.a.Fsg,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.$Ej,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.Gsg,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.aFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.bFj,
Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.Hsg,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.cFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.dFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.eFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.EFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.ZEj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.FFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.iFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.jFj,Gc.a.frame,Vd.ActionManager.eg)}rsm(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Za.a.Fsg;
case "tabHome":case "FileHomePage":return y.AFrameworkApplication.$c("1ba3i132;45gid285"),Za.a.$Ej;case "menuJewelInfo":case "FileInfoPage":return Za.a.Gsg;case "menuJewelNew":case "FileNewPage":return Za.a.aFj;case "menuJewelOpen":case "FileOpenPage":return Za.a.bFj;case "menuJewelPrint":case "FilePrintPage":return Za.a.Hsg;case "menuJewelSaveAs":case "FileSaveAsPage":return Za.a.cFj;case "menuJewelDownload":case "FileDownloadPage":return Ec.a.ZEj;case "menuJewelShare":case "FileSharePage":return Za.a.dFj;
case "menuJewelTransform":case "FileTransformPage":return Za.a.eFj}return Za.a.fFj}}Object(u.a)(qz,"WordEditorFileMenuSQMInformation",nr,[]);var iC=d(1585);class rz{constructor(b){this.ga=b;this.ga.qa(Za.a.jld,Gc.a.frame,Object(D.a)(this,this.jld,"reportTabSwitch"));this.ga.qa(Za.a.AFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.BFj,Gc.a.frame,Vd.ActionManager.eg)}jld(b,h,r,A,L){this.ga.Ob(this.VIm(L[iC.a.uFg]),2);return 32}}Object(u.a)(rz,"RibbonSQMInformation",null,[1765]);class JF extends rz{constructor(b){super(b);
this.jxo()}jxo(){this.ga.qa(Za.a.rFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.tFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.Jsg,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.uFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.vFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.wFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.xFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.yFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.zFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.Ksg,
Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.mue,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Za.a.CFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.DFj,Gc.a.frame,Vd.ActionManager.eg);this.ga.qa(Ec.a.sFj,Gc.a.frame,Vd.ActionManager.eg)}VIm(b){var h;switch(b){case "tabAddins":case "Addins":return Za.a.rFj;case "tabHome":case "Home":return Za.a.uFj;case "tabInsert":case "Insert":return Za.a.vFj;case "tabDeveloper":case "Developer":return Za.a.tFj;case "tabPageLayout":case "Layout":return Ec.a.wFj;
case "tabReferences":case "References":return Ec.a.zFj;case "tabReview":case "Review":return Ec.a.Ksg;case "tabView":case "View":return Za.a.CFj;case "Table":case "TableLayout":return(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.tableCellSizeUpdate",!1))?Ec.a.iBe:Ec.a.mue;case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Ec.a.mue;case "tabMailings":case "Mailings":return Ec.a.xFj;case "tabWordDesign":case "Design":return Ec.a.DFj;
case "tabHelp":case "Help":return Ec.a.Jsg;case "ctabPictureTools":case "Picture":return Ec.a.yFj;case "Copilot":return Ec.a.sFj}return Za.a.BFj}}Object(u.a)(JF,"WordEditorRibbonSQMInformation",rz,[]);class Fx{constructor(b=null,h=null,r=null){this.bJ=b||{};this.e3j=h||[];this.i3j=r||{}}}Object(u.a)(Fx,"RibbonTrimmingProperties",null,[]);class EA{constructor(b,h,r){this.Cza=b;this.bJ=h;this.m1f=r}}Object(u.a)(EA,"ReactRibbonJewelProperties",null,[]);class Cu{constructor(){this.Uoo=(b,h,r,A,L)=>{if(1===
r)return 32;y.AFrameworkApplication.jga("54hi9858;4f638686");if(!L)return 32;b=L.SourceControlId;17!==L.UILocation||"New"!==b&&"Open"!==b||(L=[],eg.d("setFileMenuSelectedPage")&&("New"===b&&y.AFrameworkApplication.ua?2===y.AFrameworkApplication.ua.Gb.Mk?L.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):L.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&y.AFrameworkApplication.ua&&(2===y.AFrameworkApplication.ua.Gb.Mk?L.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):
L.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),L.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(L));return 32};y.AFrameworkApplication.va.qa(Za.a.CXa,Gc.a.frame,this.Uoo)}Q5i(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}wZa(){return!1}otj(){}Bgi(){}}Object(u.a)(Cu,"ReactFileMenu",null,[426]);class sz{esf(){const b=new Cu,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));
appChrome.api.dispatch(h);return b}}Object(u.a)(sz,"ReactFileMenuFactory",null,[422]);class oq{constructor(b,h,r,A=!1){this.xzc=b;this.Joh=this.xzc.P$a;this.ile=Wa.a.instance.Oa("Common.IOfficeTrialExperience");this.qVb=Wa.a.instance.Oa("Common.IMacOfficeOffer");oq.CLe=!1;this.Spn=A;this.ga=h;this.Zb=r}get Pb(){return this.ga}get focusManager(){return this.Zb}mif(){return this.Joh&&!!this.ile&&!!this.qVb}J0a(b,h){this.xzc.vp(()=>{v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.Joh=
!0;this.QAf(b,h)});Wa.a.instance.Ta("Common.IOfficeTrialExperience").execute(r=>{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.ile=r;this.QAf(b,h)});Wa.a.instance.Ta("Common.IMacOfficeOffer").execute(r=>{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.qVb=r;this.QAf(b,h)})}QAf(b,h){oq.CLe||(this.mif()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),oq.CLe=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}
oq.CLe=!1;Object(u.a)(oq,"RibbonDependencies",null,[75]);class Du{constructor(b,h,r){this.iEb=b;this.ga=h;this.Zb=r}}Object(u.a)(Du,"WoncaRibbonUserFactory",null,[103]);class Qw{constructor(b,h){this.UMe=b;this.Dbc=h}Gyb(b){this.UMe.Gyb(b);this.Dbc&&this.Dbc.Gyb(b)}Jnd(b){this.UMe.Jnd(b);this.Dbc&&this.Dbc.Jnd(b)}htd(b){this.UMe.htd(b);this.Dbc&&this.Dbc.htd(b)}}Object(u.a)(Qw,"RibbonCommandTrimmer",null,[102]);var ar=d(1217),KF=d(1129);class GI{constructor(b,h){this.Aa=b;this.r$b=h}Gyb(b){aa.a.Di&&
6>aa.a.V9a&&(b.fseaInsertPicture=!0);this.Aa.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Aa.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Aa.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);XB.a.w_i()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Aa.$("InsertOnlinePictureEnabled"),r=y.AFrameworkApplication.HYf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r||(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=
!0);if(r||y.AFrameworkApplication.Ife)b.fseaInsertPictureFromOneDrive=!0;r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;y.AFrameworkApplication.IYf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);y.AFrameworkApplication.kAc&&(b.btnOpenInClient=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")&&this.lAc(b)}Jnd(b){b.menuJewel=!0;y.AFrameworkApplication.VE||(b.jbtnGiveFeedback=
!0)}lAc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}htd(b){delete b.menuJewel;y.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);y.AFrameworkApplication.gld||(b.jbtnReportAbuse=!0);y.AFrameworkApplication.WBe||(b.jbtnTermsOfUse=!0);y.AFrameworkApplication.A2d||(b.jbtnFileSharing=!0);y.AFrameworkApplication.qxb||(b.jbtnShareRWC=!0);y.AFrameworkApplication.fCf||
y.AFrameworkApplication.HLg||(b.jbtnVersion=!0);this.r$b.ile&&this.r$b.ile.RUn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.r$b.qVb&&this.r$b.qVb.x4o||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);y.AFrameworkApplication.kAc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[ed.a.wt?"btnjOpenInClient":"btnjEditInClient"]=!0;y.AFrameworkApplication.Bpp&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&
y.AFrameworkApplication.J.$("DisablePrint")?this.lAc(b):y.AFrameworkApplication.J.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;y.AFrameworkApplication.cG&&(this.lAc(b),b.faShare=!0);if(y.AFrameworkApplication.dV||aa.a.mXa||!y.AFrameworkApplication.q6c&&!y.AFrameworkApplication.XBf&&!y.AFrameworkApplication.FLg)b.jbtnFileEmbed=!0;ar.a.B5m()||(b.btnjClose=!0);y.AFrameworkApplication.qab?(b.jbtnVersion=!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):
y.AFrameworkApplication.fge()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);y.AFrameworkApplication.Pog||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Aa.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&
b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.Q0i;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(y.AFrameworkApplication.hL||".ODT"===ed.a.l0c.toUpperCase()||!y.AFrameworkApplication.J.$("WordEditorAppsForOfficeRibbonIsEnabled")||!KF.a.NRd||y.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(u.a)(GI,"WoncaCommandTrimmer",null,[102]);var FA=d(993);d(744);var jC=d(1590),
ag=d(1805);class SD{constructor(b,h){this.q1=this.AM=null;this._clientId=b;this.Tda=h}z2l(){if(!xf.c(this.q1))return this.q1;this.Xzf();if(xf.c(this.q1))throw Error.create("HeaderSkeleton.EnsureTopBarDomElement _elmTopBar1 is null or undefined");this.q1.style.display="block";this.Tda&&this.Tda.a2(Object(D.a)(this,this.Tv,"onResize"));return this.q1}Tv(){this.CDa()}CDa(){this.Ezf()?(document.getElementById("application").style.minWidth="0px",(new ag.a(this.q1,null,y.AFrameworkApplication.isRtl)).BMo(this.q1)):
y.AFrameworkApplication.ua.Gb.tN||jC.a.CMo(this.q1,y.AFrameworkApplication.isRtl)}Ezf(){return y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("EnhancedMobileViewIsEnabled"):!1}Xzf(){if(xf.c(this.AM)){var b;({a6c:b}=Ev.a.fsd(!y.AFrameworkApplication.K_)).returnValue?(this.AM=MD.a("div"),this.AM.className=Ev.a.e5l,this.AM.id=Eo.a.P1d,b.appendChild(this.AM),this.Qzf(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.oba&&!y.AFrameworkApplication.K_&&this.Rzf(),this.y2l()):y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("ReactHeaderCrashLogs")&&v.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}y2l(){xf.c(this.q1)&&(this.q1=MD.a("div"),this.q1.className=Ev.a.PHg,this.q1.style.display="none",this.AM.appendChild(this.q1))}Qzf(){Sys.UI.DomElement.addCssClass(this.AM,Ev.a.f5l);y.AFrameworkApplication.isRtl&&MD.b(this.AM,"cui-rtl")}Rzf(){Sys.UI.DomElement.addCssClass(this.AM,"FlexBoxLayout")}}Object(u.a)(SD,"HeaderSkeleton",
null,[]);var kw=d(626);class TD{constructor(){this.TCc=null}Irp(){this.TCc||(this.TCc=Wa.a.instance.Oa("Common.App.AccountSwitching.IAccountSwitching"))||v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}igm(){this.Irp();return this.TCc?this.TCc.getCustomAuthConfig():null}static cin(){return y.AFrameworkApplication.J.$("UiHostSupportsCustomAuthConfig")}}Object(u.a)(TD,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class kC{constructor(){this.Ppc=this.cultureName=null}}
Object(u.a)(kC,"HeaderCultureInfo",null,[]);var Rw=d(1609);class UD{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(u.a)(UD,"SearchInitializationSettings",null,[]);var sy=d(306);class ui{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(u.a)(ui,"DocumentTitleAppProps",null,[]);class VD{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(u.a)(VD,"DocumentTitleCalloutAppProps",null,[]);class LF{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(u.a)(LF,"HeaderAppProps",null,[]);class vi{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(u.a)(vi,"HeaderControls",null,[]);class MF{constructor(){this.command=
this.label=null}}Object(u.a)(MF,"WorkflowButtonAppProps",null,[]);var tz;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.c6p=2]="insufficientPermission";b[b.B5p=3]="incompatibleEditorsPresent";b[b.o_p=4]="editorsPresent";b[b.Lke=5]="notSupported"})(tz||(tz={}));Object(u.b)("RenameDisableReason",tz);class WD{constructor(b=""){this.Lvg=this.documentTitleAppProps=this.MNg=null;this.UOf=()=>{if(!this.MNg){const h=kw.a();if(h){const r=this.QHm(h.command);r&&(this.MNg=Object.assign(new MF,
{command:r,label:h.label}))}}return this.MNg};this.PYn=()=>{zk.a.get_instance().kK(17)};this.onMove=()=>{const h={};h.MoveButtonClickedTime=new Date;y.AFrameworkApplication.va.Qb(Za.a.QVb,2,h)};this.uqm=()=>{let h=null,r=null;var A=Wa.a.instance.Oa("Common.IRenameProps");A?(A=A.hFi(),0!==A&&(h=this.pIm(A),r=tz[A])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new VD,{breadcrumbBrandName:y.AFrameworkApplication.Et.breadcrumbBrandName,breadcrumbBrandUrl:y.AFrameworkApplication.Et.breadcrumbBrandUrl,
breadcrumbFolderName:y.AFrameworkApplication.Et.breadcrumbFolderName,breadcrumbFolderUrl:y.AFrameworkApplication.Et.breadcrumbFolderUrl,hideDocumentTitleInput:y.AFrameworkApplication.ua.Gb.C0m,isVersionHistoryEnabled:this.Q5o(),documentExtension:F.a.jla(y.AFrameworkApplication.fileName),isMoveEnabled:32===y.AFrameworkApplication.va.Ob(Za.a.QVb,1),onMove:this.onMove,message:h,renameDisableReason:r,openBreadcrumbsInNewTab:y.AFrameworkApplication.J.$("OpenLinksInNewWindow")})};this.Vwi=()=>{if(!this.documentTitleAppProps){const h=
y.AFrameworkApplication.Et.zA;this.documentTitleAppProps=Object.assign(new ui,{documentTitle:y.AFrameworkApplication.J_d?h:F.a.qL(h),onFirstRender:this.PYn,getCalloutAppProps:this.uqm,isShared:!1})}return this.documentTitleAppProps};this.UAl=h=>{appChrome.getHeaderApi().then(r=>{r.setNavBarData(h.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")};this.onFirstRender=()=>{Wa.a.instance.Ta("Common.App.O365Shell.IO365ShellActor").execute(h=>{h.l2o.continueWith(this.UAl,
3)});zk.a.get_instance().kK(15)};this.onFullyLoaded=()=>{zk.a.get_instance().kK(16)};this.OOk=""!==b?b:Bb.a.o4}QHm(b){const h=Wa.a.instance.Oa("Common.IExternalUICommandDefinitionMapping").Dqb(b);if(h&&0<h.length)return h[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}Xnm(){return Object.assign(new vi,{workflowButton:this.UOf()})}pIm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;
case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}Q5o(){return!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.Q1i}r3o(){return!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.P1i}x5o(){const b=!kw.b()&&!y.AFrameworkApplication.hideHeader&&!y.AFrameworkApplication.URf&&(y.AFrameworkApplication.J.$("SkypeWebControlIsEnabled")||
y.AFrameworkApplication.J.$("TeamsChatIsEnabled"));v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}auo(b=!1){appChrome.getHeaderApi().then(h=>{const r=Wa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",A=>{r.onFlexPaneOpen(A)});h.setHeaderCommandHandler("OnFlexPaneClose",A=>{r.onFlexPaneClose(A)});
h.setHeaderCommandHandler("SetCookie",A=>Pc.a.set(A.cookieName,A.value));h.setHeaderCommandHandler("GetCookie",A=>this.Znm(A));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",this.UOf);b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",this.Vwi),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.QYn();return null}));Rw.a.gfe()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(D.a)(this,this.UFi,"getSearchInitializationSettings"))})}QYn(){Wa.a.instance.Ta("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>
{b.KAb(!1,y.AFrameworkApplication.va.mode)})}Znm(b){b=Pc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}OMm(){return sy.AppChromeOverrideUtilities.isEnabled?sy.AppChromeOverrideUtilities.K7d("suiteux-shell",!1):this.OOk+y.AFrameworkApplication.mna+"suiteux-shell"}tla(b=!1){a:{try{var h=kg.a.Eg(y.AFrameworkApplication.lcid);if(h){var r=Object.assign(new kC,{cultureName:h.name,Ppc:h.Ppc});break a}}catch(A){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
y.AFrameworkApplication.lcid.toString())}r=Object.assign(new kC,{cultureName:"en-us",Ppc:"en"})}h=Wa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new LF,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.Ppc,isConsumer:!y.AFrameworkApplication.KLg,showAppLauncher:kw.h(),showMeControl:kw.g(),hideUserName:y.AFrameworkApplication.S$d,defaultDocumentTitleToLeft:y.AFrameworkApplication.Uci,assetsContainerOverride:this.OMm(),controls:this.Xnm(),
documentTitleAppProps:b?null:this.Vwi(),showDocumentTitleControl:!b,showWorkflowButton:!!this.UOf(),showChatControl:this.x5o(),showGoPremiumControl:kw.i(),showDiscoverPremiumButton:kw.f(),enableSearchControl:Rw.a.Xrn(),onFlexPaneOpen:Object(D.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(D.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.r3o(),testTraffic:y.AFrameworkApplication.J.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,onFullyLoaded:this.onFullyLoaded,
enableUpdatedRUMReporting:y.AFrameworkApplication.s3o()});!y.AFrameworkApplication.J2b||y.AFrameworkApplication.GCg?(r.userDisplayName=y.AFrameworkApplication.userName,r.emailAddress=y.AFrameworkApplication.J.jb("UserPrincipalName"),r.userID=y.AFrameworkApplication.J.jb("Puid")||"",r.signOutLink=y.AFrameworkApplication.GCg):y.AFrameworkApplication.signInUrl&&(r.signInLink=y.AFrameworkApplication.signInUrl);Rw.a.gfe()&&(h=this.UFi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=
h.getTokenRequestDictionary,r.enableVanillaSearchBox=y.AFrameworkApplication.J.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);TD.cin()&&(h=new TD,r.shellAuthProviderConfigPromise=Object(D.a)(h,h.igm,"getAccountSwitchingConfig"));this.ZUk();this.auo(b);y.AFrameworkApplication.$c("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return r}ZUk(){y.AFrameworkApplication.J.$("SideLoadingIsEnabled")&&zk.a.get_instance().Sk(16,()=>{appChrome.getHeaderApi().then(b=>{b.setCustomHeaderButtonBadgeCharacter("overrideSettingButtonId",
"\u25b6");b.setCustomHeaderButtonBadgeLabel("overrideSettingButtonId","Sideloading is active so javascript is coming from an unofficial source.");b.setCustomHeaderButtonBadgeColors("overrideSettingButtonId",{badgeColor:"green",badgeHoverColor:"green",badgeFontColor:"white",badgeFontHoverColor:"white"});return null})})}UFi(){if(!this.Lvg){const b=new Rw.a;let h=y.AFrameworkApplication.J.jb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.Lvg=Object.assign(new UD,{loadTellMeResources:b.zCn(),
getTokenRequestDictionary:Object(D.a)(b,b.bPm,"getTokenRequestDict"),userRing:h})}return this.Lvg}}Object(u.a)(WD,"ReactSharedHeaderPropsHelper",null,[2002]);class XD{constructor(){this.label=this.value=null}}Object(u.a)(XD,"TextInfoSectionField",null,[]);var Pj=d(952),Dh=d(1190);class Eu{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(u.a)(Eu,"CommandDefinition",null,[]);class Ep{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=
null}}Object(u.a)(Ep,"CommandDefinitionMapping",null,[]);const bq=b=>Object.assign(new Ep,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new Eu,{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new Eu,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(Za.a.Qg),addCommandToMaps:Object(D.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(D.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(D.a)(b,
b.addTabToMap,"addTabToMap")});var lC=d(1287);class Sw{}Object(u.a)(Sw,"RibbonInitState",null,[]);var NF=d(431),Gx=d(1251);class OF{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,r);return h}}Object(u.a)(OF,"ReactAsyncDispatcher",null,[]);var YD=d(1674);class PF{constructor(b,h){this.jOk=b;this.Yqk=h}}Object(u.a)(PF,"ReactExecuteCommandContext",null,[]);class Hq{}Hq.Trigger="FontTrigger";Hq.Name="FontName";Hq.Action="FontAction";Hq.Level="FontLevel";Hq.IsPinned="FontIsPinned";
Object(u.a)(Hq,"FontPickerLogProperties",null,[]);class ZD{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab=null,Jb=null){this.D1=null;this.zEh=!1;this.OQe=[];this.Oyd=-1;this.VNd=!1;this.uPk=0;this.QEc=null;this.hAh=!1;this.syd=null;this.Kth=!1;this.yxp=(Tb,jc)=>{const Hc=Tb.launcherId;this.wxc(Hc,jc)&&(jc=appChrome.selectors.getFlyoutAnchorMenuItems(Hc),this.MAc(jc,Hc,eg.g(Tb)))};this.vyp=(Tb,jc)=>{const Hc=Tb.launcherId;this.wxc(Hc,jc)&&(jc=eg.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(Hc):
appChrome.selectors.getFlyoutAnchorMenuItems(Hc),this.MAc(jc,Hc,eg.g(Tb)))};this.eAp=(Tb,jc)=>{const Hc=Tb.launcherId;this.wxc(Hc,jc)&&(jc=appChrome.selectors.getPreviewGalleryMenuItems(Hc),this.MAc(jc,Hc,eg.g(Tb)))};this.XAp=(Tb,jc)=>{const Hc=Tb.launcherId;this.wxc(Hc,jc)&&(jc=appChrome.selectors.getSplitButtonMenuItems(Hc),this.MAc(jc,Hc,eg.g(Tb)))};this.bBp=(Tb,jc)=>{const Hc=Tb.launcherId;this.wxc(Hc,jc)&&(jc=appChrome.selectors.getStatefulSplitButtonMenuItems(Hc),this.MAc(jc,Hc,eg.g(Tb)))};
this.pja=b;this.okb=h;this.i6e=Object(Ca.a)(1768,b);this.rl=r;this.Zb=A;L&&(this.D1=new YD.a(L,A));this.KLk=Z;this.xvk=oa;this.vr=Ab;this.ga=Ba;this.BFb={};this.Aa=gb;this.zRg=Jb;gb&&(gb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||gb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&dl.a.instance.ehf.CWR(()=>this.zEh=!0);gb&&(b=this.Aa.jb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({av:this.QEc}=H.d(b));this.QEc||(this.QEc={})}get nLj(){return!!window.appChrome&&
!!appChrome.selectors}OJj(){-1!==this.Oyd&&window.clearTimeout(this.Oyd);this.Oyd=window.setTimeout(()=>{for(this.Oyd=-1;0<this.OQe.length;){if(zf.a.instance.Yz){this.OJj();break}const b=this.OQe.shift();b&&this.executeCommand(b.jOk,b.Yqk)}},0)}executeCommand(b,h){if(zf.a.instance.Yz){if(this.zEh){this.OQe.push(new PF(b,h));this.OJj();return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
b,h.modelType,mb.a.toJSON(h.payload));if(this.Aa.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.rl.getCommandByExternalUxId(b),A=h.modelType;this.zRg&&this.zRg.UDn(b,h);this.tYf&&r&&window.Event&&(window.Event.ActionCommandId=r.commandId);r?this.G3l(b,r,A,h):this.H3l(b,A,h);this.$ol(h);this.npp(h);this.HJn(b,h)}}H3l(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.Dli(r,b);break;case "ButtonModel":this.B3l(r,b)}}Rzp(b,h,r,A,L){const Z=Date.now();if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=
r.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.Aa&&this.Aa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_EnableUnDismissWhenClickingMenu")?(h=!0,xf.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.w6()):this.w6();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=
r.payload.commandValueId;L=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;L=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=A;v.ULS.sendTraceTag(508118238,207,50,"UpdateParametersForButton executed for command :{0} and time taken in execution :{1}",A,Date.now()-Z);return L}Szp(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.rl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":b=this.rl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.w6();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}G3l(b,h,r,A){var L=this.Jdo(A,r),Z=h.commandId;const oa={},
Ba={};switch(r){case "SplitButtonModel":if(this.w5c(A.payload,this.XAp,L))return;oa.MenuItemId=h.menuItemId;this.uzg(A,oa);break;case "StatefulSplitButtonModel":if(this.w5c(A.payload,this.bBp,L))return;r=A.payload.statefulData;L=A.payload.statefulMode;"color"===L?oa.Color=r:"icon"===L&&(r=this.rl.getCommandByExternalUxId(r))&&(oa.MenuItemId=r.menuItemId);break;case "FileMenu":oa.MenuItemId=h.menuItemId;oa.SourceControlId=b;A.payload&&"FileMenuPageSwitchPayload"===A.payload.type&&this.QVm(Z,A.payload,
b);break;case "TellMe":Z=this.Szp(Z,A,oa);oa.SourceControlId=b;oa.Location=A.payload.location;break;case "ButtonModel":A.payload&&"TabSwitchPayload"===A.payload.type?this.KXm(oa,A):Z=this.Rzp(oa,h,A,b,Z);break;case "CompoundButtonModel":oa.MenuItemId=h.menuItemId;oa.CommandValueId=A.payload.commandValueId;oa.SourceControlId=b;this.uzg(A,oa);this.w6();break;case "ToggleButtonModel":case "InkButtonModel":oa.MenuItemId=h.menuItemId;oa.SourceControlId=b;this.uzg(A,oa);this.w6();break;case "FontPickerModel":switch(A.payload.type){case "MenuOpenPayload":Z=
this.rl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;oa[hw.a.FontPickerId]=A.payload.launcherId;break;case "MenuClosePayload":Z=this.rl.getCommandByExternalUxId("FontPickerMenuClose").commandId;oa[hw.a.FontPickerId]=A.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=A.payload.font;L=null;"string"===typeof r?(L=Qo.FontUtils.jYa(r),oa.CommandValueId=L,L=Qo.FontUtils.oYd(L)):(r.data?(oa.CommandValueId=r.data.fontToApply,oa.MenuItemId=r.data.themeIndex,oa[hw.a.Formatting]=r.data):
oa.CommandValueId=r.name,L=r);oa.SourceControlId=b;oa[hw.a.RequestUpdateMru]=L;Ba[Hq.Name]=A.payload.nameToLog?A.payload.nameToLog:"string"===typeof r?Qo.FontUtils.Rce(r)?"*"+r:Qo.FontUtils.DXf(r)?"[EF]":"[MF]":"";Ba[Hq.IsPinned]=A.payload.isPinned;Ba[Hq.Level]=A.payload.level;this.m5f();break;case "FontPickerFontInfoRequestedPayload":oa.CommandValueId=A.payload.font.name;oa[hw.a.Trigger]=A.payload.trigger;Ba[Hq.Trigger]=A.payload.trigger;Ba[Hq.Name]=A.payload.nameToLog;this.m5f();break;case "FontPickerFontPinningPayload":r=
A.payload.isPinned;oa.CommandValueId=A.payload.fontKey;oa[hw.a.IsPinned]=r;Ba[Hq.Name]=A.payload.nameToLog;Ba[Hq.Action]=r?"pin":"unpin";Ba[Hq.Level]=A.payload.level;this.m5f();break;default:return}break;case "ComboBoxModel":var gb=A.payload.type;switch(gb){case "MenuOpenPayload":case "MenuPopulatePayload":this.wxc(A.payload.launcherId,L)&&(Z={},Z[A.payload.launcherId]=r,this.okb.lhd(Z,eg.g(A.payload)),this.BFb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=
A.payload.newValue;if(!r)return;r.value?(oa[xb.a.Value]=r.value,oa[xb.a.IsFreeForm]=!0):(oa[xb.a.Value]=r.text,oa.MenuItemId=r.key,oa.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===gb&&(Z=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":Z=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(A.payload.type){case "ZeroTermContextMenuClosePayload":r=mb.a.CR(A.payload);for(gb of r)oa[gb]=A.payload[gb];break;default:this.w5c(A.payload,this.yxp,L),oa.launcherId=
A.payload.launcherId}break;case "InkFlyoutAnchorModel":this.w5c(A.payload,this.vyp,L);oa.launcherId=A.payload.launcherId;break;case "ColorPickerModel":switch(A.payload.type){case "ColorPickerPayload":oa[Lm.Color]=A.payload.selectedColorId;oa.colorRGB=A.payload.color;break;case "ColorPickerPreviewPayload":Z=h.commandPreviewId;oa[Lm.Color]=A.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":Z=h.commandRevertId;break;default:return}break;case "SpinButtonModel":oa[Ji.a.Number]=A.payload.value;
oa[Ji.a.UnitType]=Tf.a.dUa(A.payload.unitType.toLowerCase());oa[Ji.a.Text]=A.payload.reservedValue;break;case "SliderModel":oa[Si.Value]=A.payload.value;break;case "InsertTableModel":oa[Mg.a.Rows]=A.payload.rows;oa[Mg.a.Columns]=A.payload.columns;break;case "CheckboxModel":oa[Tg.a.On]=A.payload.checked;oa.MenuItemId=h.menuItemId;oa.TerminalParentControlId=A.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.w5c(A.payload,this.eAp,L)){oa.launcherId=A.payload.launcherId;break}this.Dli(A,
b);return;case "DocumentTitleModel":switch(A.payload.type){case "DocumentTitleRenamePayload":oa.getNewDocumentTitle=A.payload.getNewDocumentTitle;break;case "MenuOpenPayload":Z={};Z[A.payload.launcherId]=r;this.okb.lhd(Z,eg.g(A.payload));this.BFb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":oa.MenuItemId=A.payload.url;this.KEn(A.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":oa.MenuItemId=A.payload.assetId;oa.SourceControlId=
b;y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&(oa.IsPremium=A.payload.isPremium||!1);this.LEn(A.payload.pageId);break;case "CoauthorGallery":oa.RenderTime=A.triggerTime;break;case "PeopleWell":oa.RenderTime=A.triggerTime;break;case "SyncStatus":oa.SourceControlId=b;break;case "InputBoxModel":oa.Text=A.payload.newValue;break;case "PersonaButtonModel":oa.CommandValueId=A.payload.commandValueId;this.TWm(A.payload);break;case "MultiActionButtonModel":oa.CommandValueId=A.payload.commandValueId;
oa.Href=A.payload.href;oa.SourceControlId=b;oa.Type=A.payload.type;oa.TerminalParentControlId=A.payload.terminalParentControlId;this.w6();break;default:return}Z&&!this.isShadowMenuOpen(A.payload)&&(A.payload&&"terminalParentControlId"in A.payload&&(oa.ParentMenuId=A.payload.terminalParentControlId),oa.CommandValueId||(oa.CommandValueId=oa.MenuItemId),h.legacyControlId&&(oa.LegacyId=h.legacyControlId),oa.SourceControlId||(oa.SqmControlId=b),this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&oa.launcherId&&(h=this.rl.getCommandByExternalUxId(oa.launcherId))&&(oa.launcherCommandId=parseInt(h.commandId)),A.payload&&!xf.c(A.payload.PRIReadinessCheck)&&(oa.PRIReadinessCheck=A.payload.PRIReadinessCheck,this.hAh=!0),A.payload&&!xf.c(A.payload.shouldTakeFocus)&&(oa[fw.a.t_a]=A.payload.shouldTakeFocus),h=this.Udf(A,oa),A.payload&&!xf.c(A.payload.interactiveUid)&&(Ba.interactive_uid=A.payload.interactiveUid),xf.c(A.triggerTime)||(Ba.TriggerTime=A.triggerTime),A.payload&&!xf.c(A.payload.userActionKey)&&
(Ba.userActionKey=A.payload.userActionKey),this.Kxg(Ba,A,b,Z),this.i6e.executeCommand(Z,oa,this.getSelectedTabId(),h,!0,()=>{this.F8f(oa,b)},Ba,eg.g(A.payload)))}Kxg(b,h,r,A){if(this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&A&&h.payload){const L=!xf.c(h.payload.launcherId);r=this.WIj(this.qCm(L?h.payload.launcherId:r,A),A,!1);b.ControlId=r;const Z=h.payload.inputMethod,oa=h.payload.location;xf.c(Z)||xf.c(oa)||this.bEn(1===Z,2===
Z||3===Z||4===Z,L&&("Overflow"===oa||"ToolBarOverflow"===oa)||"TabSwitchPayload"===h.payload.type,r,oa)}this.Aa&&this.Aa.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.WIj(h.payload.terminalParentControlId,A,!0))}bEn(b,h,r,A,L){this.syd||(this.syd={});const Z=[];L=lg.a.Naa("UILocation",L,2);Array.add(Z,L);if(L=this.getSelectedTabId())L=lg.a.Naa("Tab",L,2),Array.add(Z,L);this.syd[A]||r||(this.syd[A]=1,h?this.Vbd("DistinctUserInitiatedTerminalCommand",
Z):b&&this.Vbd("DistinctUserInitiatedKeyboardCommand",Z));h?r?this.Vbd("UserInitiatedNavigationalCommand",Z):this.Vbd("UserInitiatedTerminalCommand",Z):b&&this.Vbd("UserInitiatedKeyboardCommand",Z)}Vbd(b,h){me.b(b,null,0,!0,0,h)}WIj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;v.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}qCm(b,h){h=parseInt(h);h=Vd.ActionManager.epf(h)||Vd.ActionManager.D$(h)||"";return!xf.c(h)&&h in this.QEc?this.QEc[h]:100<b.length?"":b}m5f(){this.vr&&this.vr.execute(b=>{b.X4f("ModernFontPickerExperience")})}Udf(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,h[fw.a.az]=r);return r}F8f(b,h){const r=Object(Ca.a)(Qf.AFrame,y.AFrameworkApplication.ua);if(this.Zb&&this.LSj(b)){if(!this.Zb.currentScope&&r){let A="null";if(b){const L=
b.Value;delete b.Value;A=mb.a.toJSON(b);xf.c(L)||(b.Value=L)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,A,r.pdb)}this.Zb.zDf()}(this.Zb&&this.Zb.currentScope&&this.Zb.currentScope.name!==Qf.AFrame.Oga&&r&&this.Zb.currentScope.name!==r.pdb||this.LSj(b))&&this.Gul(b)}LSj(b){return!!b&&!xf.c(b[fw.a.t_a])&&b[fw.a.t_a]}Gul(b){fw.a.az in b&&1===b[fw.a.az]&&Pj.ShyRibbon.cnb(1,
0)}KXm(b,h){eg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.w6();this.pja.xn();if(this.KLk&&this.ga){const r={};r[iC.a.uFg]=h.payload.tabId;this.ga.Qb(Za.a.jld,2,r,this.bP(h));xf.c(h.payload.inputMethod)||(this.ga.Ob(Za.a.AFj,2),this.VNd||this.a$o(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.rl.vNf(h);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.vr&&h){const r=h+"TabSwitchActivity";
this.vr.execute(A=>{A.X4f(r)})}}w5c(b,h,r){const A=b.type;return"MenuClosePayload"===A?!0:"MenuOpenPayload"===A?(h(b,r),!0):!1}TWm(b){b=b.type;"MenuOpenPayload"===b?y.AFrameworkApplication.Fqd=!0:"MenuClosePayload"===b&&(y.AFrameworkApplication.Fqd=!1)}Jdo(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=b.payload.launcherId,A=this.rl.getCommandByExternalUxId(r);return A&&A.populationProps?((b=this.okb.akg(A,h,b.payload))&&
r in this.BFb&&delete this.BFb[r],b):!1}getSelectedTabId(){return this.nLj?appChrome.selectors.getSelectedTabId():null}MAc(b,h,r){this.okb.lhd(b,r);this.BFb[h]=new Date}wxc(b,h){let r=!0;b in this.BFb&&(r=this.BFb[b].getTime()<this.pja.wta.getTime());return r&&!h&&this.nLj}Dli(b,h){const r={};var A=b.payload.selectedGalleryId;const L=this.rl.getCommandByExternalUxId(A);if(L){r.SourceControlId=A;r.MenuItemId=L.menuItemId;r.SqmControlId=h;L.legacyControlId&&(r.LegacyId=L.legacyControlId);b.payload&&
!xf.c(b.payload.shouldTakeFocus)&&(r[fw.a.t_a]=b.payload.shouldTakeFocus);this.dFm(b.payload,r);(A=this.bP(b))||(A={});this.Kxg(A,b,h,L.commandId);const Z=this.Udf(b,r);this.i6e.executeCommand(L.commandId,r,this.getSelectedTabId(),Z,!0,()=>{this.F8f(r,h)},A,eg.g(b.payload))}}B3l(b,h){const r=this.rl.getCommandByExternalUxId(h);if(r){const A={};A.SourceControlId=h;A.MenuItemId=h;A.SqmControlId=h;b.payload&&!xf.c(b.payload.shouldTakeFocus)&&(A[fw.a.t_a]=b.payload.shouldTakeFocus);let L=this.bP(b);L||
(L={});this.Kxg(L,b,h,r.commandId);const Z=this.Udf(b,A);this.i6e.executeCommand(r.commandId,A,this.getSelectedTabId(),Z,!1,()=>{this.F8f(A,h)},L,eg.g(b.payload))}}dFm(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}uzg(b,h){b.payload&&"toggled"in b.payload&&(h[Tg.a.On]=b.payload.toggled)}HJn(b,h){if("MenuOpen"===b){if(this.D1&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.D1.onMenuOpen()}else if("MenuClose"===b&&this.D1)this.D1.onMenuClose()}w6(){this.D1&&
this.D1.mdg()}bP(b){let h=null;xf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}QVm(b,h,r){if(this.xvk&&this.ga){const A={};A[FI.a.Eoe]=r;this.ga.Qb(Za.a.ild,2,A)}this.MAc(h.pageControlIdMap,b,eg.g(h))}LEn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(Za.a.EFj,2);break;case "FileNewPage":this.ga.Ob(Za.a.FFj,2)}}KEn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(Za.a.iFj,2);break;case "FileOpenPage":this.ga.Ob(Za.a.jFj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===
b.type&&b.isShadowRendering}a$o(b){if(y.AFrameworkApplication.J.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.vr.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.VNd=!0;else{if(y.AFrameworkApplication.J.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.vr.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.uPk)){this.VNd=!0;return}y.AFrameworkApplication.J.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.Ob(Za.a.D0b,2)&&(this.VNd=
!0)}}$ol(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.hAh&&appChrome.PRIToastManager.dismissToast()}npp(b){!this.Kth&&this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(b=eg.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),
this.Kth=!0)}get tYf(){var b,h;return null!==(h=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScopeAsyncEnabled",!1))&&void 0!==h?h:!1}}Object(u.a)(ZD,"ReactExecuteCommandHandler",null,[]);class zK{constructor(){this.x2d=null}get LAb(){return 0}get fbb(){return 0}get $La(){return!1}CDa(){}i1j(){}u2(){return!1}KNj(){}K6(){return!1}VOa(b){return this.x2d&&this.x2d.wZa(b)?!0:!1}get Ina(){return!1}iyb(){}cde(){return!1}get oXd(){return null}set oXd(b){}$ja(){}Vea(){}DOf(){return null}LUa(){}refresh(){}get controls(){return null}Tuc(){return!1}Cnb(){}xn(){}get tH(){return null}set tH(b){}Lsd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(u.a)(zK,"ReactRibbonExternal",null,[543,462,544]);class AK{constructor(b,h,r,A){this.zZn=(L,Z)=>{if((L=Object(Ca.a)(Qf.AFrame,y.AFrameworkApplication.ua))&&Z.Agj&&y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.PBa){const oa=appChrome.selectors.getShyState();oa.isActive&&Z.Agj.name===L.pdb&&Pj.ShyRibbon.cnb(oa.state,1)}};this.LHj=()=>4;this.KHj=()=>4;this.GHj=()=>{eg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.PBa&&
appChrome.selectors.getShyState().isActive&&Pj.ShyRibbon.cnb(1,0),this.Zb.Gg(Qf.AFrame.Do));return 4};this.o3n=L=>{L.Lb&&L.Lb.target&&"input"!==L.Lb.target.tagName.toLowerCase()&&L.Lb.preventDefault();return!1};this.Zb=b;this.ga=h;this.iKh=r;this.s$b=A}initialize(){this.ga.qa(Za.a.Uld,Gc.a.frame,this.LHj);this.ga.qa(Za.a.Tld,Gc.a.frame,this.KHj);this.ga.qa(Za.a.Zue,Gc.a.frame,this.GHj);var b=Ev.a.jbe(this.s$b,null,this.iKh,!1);b.IL=!0;this.EYb(b,Za.a.Uld,Za.a.Tld);b.bindAction(Cb.KeyInputManager.oc(jf.a.Dfb,
0),Za.a.Zue);b=this.Zb.ie(Qf.AFrame.Oga);b.IL=!0;this.EYb(b,Za.a.B7a,Za.a.B7a);Zf.a.instance.ub(od.a.dC,this.iKh,this.o3n);b=Gp.a.instance;eg.a("enterKeytipMode")&&b.JXo(this.s$b,()=>{appChrome.api.enterKeytipMode(!1)});eg.a("exitKeytipMode")&&b.FXo(this.s$b,()=>{appChrome.api.exitKeytipMode();Pj.ShyRibbon.cnb(1,0)});y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.PBa&&(b=Object(Ca.a)(Sg.FocusManager,this.Zb))&&b.p1k(this.zZn)}H9m(b){b=Ev.a.jbe(b,null,document.getElementById("WACToolbarContainer"),
!1);b.IL=!0;this.EYb(b,Za.a.Uld,Za.a.Tld)}EYb(b,h,r){const A=Cb.KeyInputManager.oc(jf.a.pz,0),L=Cb.KeyInputManager.oc(jf.a.pz,4);b.ot(A);b.ot(L);b.bindAction(A,h);b.bindAction(L,r)}dispose(){this.ga.Fy(Za.a.Uld,Gc.a.frame,this.LHj);this.ga.Fy(Za.a.Tld,Gc.a.frame,this.KHj);this.ga.Fy(Za.a.Zue,Gc.a.frame,this.GHj)}}Object(u.a)(AK,"ReactRibbonFocusManager",null,[10]);class Tw{constructor(b,h,r,A,L,Z,oa,Ba=null,gb=!0,Ab=null,Jb=null){this.dib=this.ROd=this.PMe=this.pja=null;this.aEh=[];this.t$b=null;
this.Qmo=()=>{y.AFrameworkApplication.J.vp(()=>{this.MVl()})};this.TGn=()=>{if(y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.Bs){var Tb=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(Tb.execute(Hc=>{Hc.logActivity("SingleRibbonModeActivity",null)}),y.AFrameworkApplication.$c("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(Tb.execute(Hc=>{Hc.logActivity("MultiRibbonModeActivity",
null)}),y.AFrameworkApplication.$c("69a7h198;dfd7j584"));if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeActivity")){var jc=Je.a.srb();Tb=Je.a.D_();jc=1550<jc?"Large":1050<jc?"Medium":"Small";Tb=850<Tb?"Large":675<Tb?"Medium":"Small";me.a("ScreenBucket_W_"+jc+"_H_"+Tb);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeAction")&&me.c(this.IJm(jc,
Tb))}}};this.$Bg=()=>{const Tb=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");Tb&&Tb.execute(jc=>{jc.logActivity("SingleLineToolBarOptOut",null)});return 32};this.xDn=()=>{this.ga.qa(Za.a.AIg,Gc.a.frame,Object(D.a)(this,this.AIg,"triggerModeSwitcherTUI"));this.ga.fb(Za.a.$Bg,Gc.a.frame,this.$Bg,96);window.setTimeout(()=>{const Tb=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");Tb&&y.AFrameworkApplication.J.$("Fluent2StyleIsEnabled")&&(Tb.execute(jc=>{jc.logActivity("VNextStylesOn",null)}),
Tb.execute(jc=>{jc.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)};this.yxo=()=>{zk.a.get_instance().Sk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const Tb=appChrome.api.getRibbonSubComponentMappings();for(const Hc in Tb){var jc=Hc;const hd=Tb[Hc];if(hd)for(const Gd of hd)y.AFrameworkApplication.va.t_(Gd)?appChrome.api.reportRibbonSubComponentBehaviorMapped(jc):y.AFrameworkApplication.va.CXo(Gd,this.xIl(jc));else appChrome.api.reportRibbonSubComponentBehaviorMapped(jc)}};
this.oSa=b;this.$_e=h;this.s$b=r;this.Zb=A;this.ga=L;this.rl=Z;this.pja=Ab?Ab:new ID(Su.instance,this.rl);this.bKc=oa;this.uCh=new zK;this.pSa=Ba;this.N7e=gb;new OF;this.Bhh=Jb;zk.a.get_instance().Sk(7,Object(D.a)(this,this.bZo,"setRibbonPostInteractiveReady"));zk.a.get_instance().Sk(7,this.TGn);zk.a.get_instance().Sk(19,this.xDn);zk.a.get_instance().Sk(7,this.yxo);zk.a.get_instance().Sk(7,this.Qmo)}initialize(b,h,r=null){this.N7e||this.kK(5);r?r.then(()=>{this.rEj()}).catch(()=>v.ULS.sendTraceTag(561394319,
340,10,"Failed to load the resources for the Ribbon")):NF.a.krd(NF.a.krd(Mf.Task.WAA(this.q7i(b),this.p7i(Tw.ork)),()=>this.p7i(Tw.Dnk)),()=>this.q7i(h)).continueWith(()=>{this.rEj()},11)}dispose(){this.Qsp();this.dib&&this.dib.Bgi();this.t$b&&this.t$b.dispose();for(const b of this.aEh)zk.a.get_instance().srl(b);y.AFrameworkApplication.va.Fy(Za.a.FFo,Gc.a.frame,Vd.ActionManager.eg)}p7i(b){return Wa.a.instance.resolve("Common.ISharedDependencyLoader").yqc(y.AFrameworkApplication.mC(b,2))}q7i(b){return""===
b?Mf.Task.a7(!0):Wa.a.instance.resolve("Common.ISharedDependencyLoader").yqc(y.AFrameworkApplication.mC(b,3))}q9m(){(this.pSa||this.bKc)&&appChrome.api.dispatch(this.cJi());this.c0o();eg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(y.AFrameworkApplication.L8);this.pja.xn()}rEj(){this.q9m();this.N7e&&(appChrome.renderAppChrome(this.oSa,eg.e()),this.kK(10));this.tMh();this.mlf();this.N7e&&this.kK(5);this.nRi()}nRi(){this.Zb&&this.ga&&this.s$b&&(this.t$b=new AK(this.Zb,this.ga,this.oSa,
this.s$b),this.t$b.initialize())}get Sld(){return this.uCh}setCommandDefinitionMapping(){if(eg.a("setCommandDefinitionMapping")){const b=bq(this.rl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.PBa&&eg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.Rtc()})}tMh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Ca.a)(ID,
this.pja);this.PMe=new ZD(this.pja,b.Nuc,this.rl,this.Zb,this.$_e,Wa.a.instance.Oa("Common.IRibbonSQMInformation"),Wa.a.instance.Oa("Common.IFileMenuSQMInformation"),y.AFrameworkApplication.va,y.AFrameworkApplication.J,Wa.a.instance.Ta("Common.ISystemInitiatedFeedback"),null);this.jdl();this.OUm()}jdl(){this.ROd=appChrome.api.bindCommandHandler((b,h)=>{this.PMe.executeCommand(b,h)})}Qsp(){this.ROd&&(this.ROd(),this.ROd=null)}c0o(){appChrome.api.initializeLogger(new cn.a)}nKa(){return this.pja?this.pja.nKa():
[]}Rtc(){Cq.a.instance.le(()=>{let b=null;Cq.a.instance.le(()=>{b=this.nKa()},"RB:GA");b&&0<b.length&&(this.pja.wta=new Date,Cq.a.instance.le(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.dib&&Cq.a.instance.le(()=>{this.dib.otj()},"RB:J")},"RB:PFSU")}Wsd(){this.pja.Wsd()}xWb(){}mUk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}cJi(){var b=
y.AFrameworkApplication.J;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Wa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(A=>{A&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.Jxi());b=new lC.a(this.rl);this.pSa.bJ&&(Gx.a.Epp(this.pSa.bJ),
h.push.apply(h,b.n4d(this.pSa.bJ)));if(this.pSa.e3j)for(const r of this.pSa.e3j)h.push(appChrome.actions.updateGallerySectionHiddenState(r.g4d,r.slq,r.Opq));h.push.apply(h,b.osi(this.pSa.i3j));return h}Jxi(){const b=[];if(this.bKc&&this.bKc.bJ){const r=this.bKc.bJ;for(const A in r){var h=r[A];const L=this.rl.zIf(A);if(L)for(const Z of L)b.push(appChrome.actions.updateControlHiddenState(Z,h))}}return b}SOa(b){b&&this.pja.Nuc.lhd(b,0)}akg(b){this.pja.Nuc.akg(this.rl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),
{inputMethod:0})}MVl(){const b=y.AFrameworkApplication.J.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=y.AFrameworkApplication.J.appSettings;h&&appChrome.api.dispatch(this.SAp(b,"Shared"===(h.SharingStatus||"")))}SAp(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}kK(b){zk.a.get_instance().kK(b);this.aEh.push(b)}bZo(){eg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new Sw,{postRibbonInteractiveReady:!0})))}mlf(){this.bKc&&
this.Bhh&&(this.dib=this.Bhh.esf(),this.uCh.x2d=this.dib)}dzn(b,h){this.dib&&this.dib.Q5i(b,h)}yug(b,h,r){if(1===r)return 32;this.nPj(!0);this.Rtc();y.AFrameworkApplication.ua.Ge();return 32}zug(b,h,r){if(1===r)return 32;this.nPj(!1);this.nZo();this.Rtc();y.AFrameworkApplication.ua.Ge();return 32}AIg(b,h,r){if(1===r)return 32;(b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&b.execute(A=>{A.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}nZo(){Pc.a.q_a(y.AFrameworkApplication.J.jb("IsSimplifiedRibbonOnCookieName"),
"true",Pc.a.$Xa)}nPj(b){Pc.a.q_a(y.AFrameworkApplication.J.jb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Pc.a.$Xa)}IJm(b,h){return"Large"===b?"Large"===h?Za.a.gNo:"Medium"===h?Za.a.hNo:Za.a.iNo:"Medium"===b?"Large"===h?Za.a.jNo:"Medium"===h?Za.a.kNo:Za.a.lNo:"Large"===h?Za.a.mNo:"Medium"===h?Za.a.nNo:Za.a.oNo}xIl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}OUm(){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&eg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&y.AFrameworkApplication.Ctc.adf){const b=y.AFrameworkApplication.Ctc.adf,h=y.AFrameworkApplication.Ctc.TLh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;Tw.NHj.tb(r)?Tw.NHj.K(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.PMe.executeCommand(b,h))}}}Tw.ork="common";Tw.Dnk=
"appChrome";Tw.NHj=new Dh.a(Ja.a.T4c());Object(u.a)(Tw,"ReactRibbonUser",null,[795,127,10]);class uz extends Tw{constructor(b,h,r,A,L,Z,oa,Ba,gb=null,Ab=!0,Jb=null,Tb=null){super(b,h,A,L,Z,oa,Ba,gb,Ab,Jb,Tb);this.QBd=null;this.iEb=r;this.iEb.execute(jc=>{this.QBd=jc});this.iEb.execute(jc=>{this.pja.tH=jc})}nKa(){return this.QBd?(this.QBd.clearCache(),super.nKa()):[]}xWb(b){if(!b)throw Error.argumentNull();this.iEb.execute(h=>{b.tH=h})}}Object(u.a)(uz,"ReactRibbonUser",Tw,[]);var BK=d(997);class mC extends uz{constructor(b,
h,r,A,L,Z,oa,Ba,gb,Ab=!0,Jb=null,Tb=null){super(h,b.uaa,A,Nk.a.Qua,L.focusManager,L.Pb,oa,Ba,gb,Ab,Jb,Tb);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.hUe=b;this.Tda=Z;L.J0a(()=>{this.yAp();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?zk.a.get_instance().Sk(7,()=>{this.cRi()}):this.cRi()},null)}get xWi(){return!!y.AFrameworkApplication.J.appSettings.BootActivityNavigationId}cRi(){this.yGl();this.esf();
this.cuo()}yAp(){this.oSa.classList.add("FlexBoxLayout");this.hUe.ksa().classList.add("cui-exth");this.hUe.ksa().classList.add("FlexBoxLayout");this.hUe.ksa().classList.add("ScrollableRibbon")}yGl(){y.AFrameworkApplication.K_||this.QKl()}QKl(){if(!y.AFrameworkApplication.K_){var b=(new SD(mC.ILk,this.Tda)).z2l(),h=Ev.a.jbe(Nk.a.cWa,null,b,!0);h.IL=!0;this.EYb(h,Za.a.Uld,Za.a.Tld);h.bindAction(Cb.KeyInputManager.oc(jf.a.Dfb,0),Za.a.Zue);bz.a(1,()=>{this.PDo(b)})}}PDo(b){const h=new WD;appChrome.renderSharedHeader(b,
h.tla()).then(this.Pwf.bind(this))}jCj(){y.AFrameworkApplication.ua.Gb.O1i?appChrome.getHeaderApi().then(b=>{document.getElementById(y.AFrameworkApplication.ypb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new BK.a).Pwf()}Pwf(){this.xWi&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?(zk.a.get_instance().Sk(12,this.jCj.bind(this),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.jCj()}EYb(b,
h,r){const A=Cb.KeyInputManager.oc(jf.a.pz,0),L=Cb.KeyInputManager.oc(jf.a.pz,4);b.ot(A);b.ot(L);b.bindAction(A,h);b.bindAction(L,r)}esf(){const b=!!this.pSa&&"FileMenu"in this.pSa.i3j;y.AFrameworkApplication.ua.Gb.gXa&&!b&&bz.a(1,this.oDo.bind(this))}oDo(){const b=[];if(y.AFrameworkApplication.J.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new XD,{label:CommonUIStrings.L_DiagnosticsSessionId,value:y.AFrameworkApplication.userSessionId}),Object.assign(new XD,{label:CommonUIStrings.L_DiagnosticsBuild,
value:y.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.Jxi());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}cuo(){this.ga.qa(Za.a.S_a,kc.a.view,this.S_a.bind(this));this.ga.qa(Za.a.yug,kc.a.view,this.yug.bind(this));this.ga.qa(Za.a.zug,kc.a.view,this.zug.bind(this))}activateRibbonTab(b){this.mUk(b)}Rtc(){zk.a.get_instance().isCompleted(7)&&this.QBd&&(db.a.mark(4893),kB.a.dAp(),
super.Rtc(),db.a.mark(4894))}S_a(b,h,r,A,L){if(2===L[fw.a.az]){if(r=Object(Ca.a)(wr.a,h))A=Object(Ca.a)(hA.a,r.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,mb.a.join(L," ",":")),8;if(A&&""!==A.nL)Yj.a.iba(h)&&Yj.a.htb()||(this.Zb.Gg(A.nL),appChrome.selectors.getShyState().isActive&&Pj.ShyRibbon.cnb(0,1));else return v.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",
Object.getTypeName(r.view),b,mb.a.join(L," ",":"),this.kxm(r.view)),8}return 32}kxm(b){return b?"is ContentEditableView: "+b.Kk+" is Editing View: "+b.Ula+" is HtmlView: "+b.U$a+" is InteractiveView: "+b.ve+" is NavigationPaneView: "+b.mon+" is PageView: "+b.vj+" is WordNavigationPaneHeadingsView "+b.d1f:"null view"}}mC.ILk="WACRibbon";Object(u.a)(mC,"ReactRibbonUser",uz,[794,795,127,10]);class CK extends mC{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc=null,hd,Gd){super(b,h,r,A,L,Z,oa,Ba,gb,!1,
Ab,Hc);this.D5k=()=>{this.vr&&this.vr.execute(de=>{de.logActivity("WordShyRibbon",null)});return 32};this.B1o=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&"true"!==Pc.a.get(y.AFrameworkApplication.J.jb("ReactRibbonMLRPreferenceCookieName"))&&zk.a.get_instance().Sk(20,()=>{this.vr.execute(de=>{de.logActivity("FloodgateFirstStart",null)})})};this.E8m=()=>{qg.a.instance.rf(qh.a.S9m,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(de=>
{var qe;this.pSa&&de.push.apply(de,this.cJi());(this.OEh||this.PEh)&&this.Rkb&&de.push.apply(de,this.Pkm());de.push(appChrome.actions.setControlCustomTooltip(mp.a.Nzn,CommonUIStrings.l_LoopsLearnMoreTooltip));de.push(appChrome.actions.setControlCustomTooltip(mp.a.Gql,"Plan and manage tasks with to-do lists you can share and work on with others."));de.push(appChrome.actions.setControlCustomTooltip(mp.a.fjp,"Assign tasks, set due dates, and track in a table you can easily edit."));de.push(appChrome.actions.setControlCustomTooltip(mp.a.ido,
"Make surveys to get quick feedback, schedule, and plan."));var oe=null===(qe=y.AFrameworkApplication.J)||void 0===qe?void 0:qe.jb("ReactShyRibbonPreferenceCookieName");qe=Pc.a.get(oe);this.z1o(qe);this.B1o();de.push.apply(de,this.nKa());de.push(appChrome.actions.setControlBehaviorAttached(!0));const ge=Wa.a.instance.resolve("WordEditor.IModeSwitcherControl");qe=ge.Nwm();y.AFrameworkApplication.$c("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",
!1)&&(oe=appChrome.selectors.getModeSwitcherMode())&&oe!==qe.activeMode&&v.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${qe.activeMode}, Actual: ${oe}`);"Suggest"===qe.activeMode||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===qe.activeMode?appChrome.getUpdateAppModeAndTabsActions(qe,!0).then($d=>{appChrome.api.dispatch(de.concat($d));ge.Rcj();this.tRi()}):(de.push(appChrome.actions.updateModeSwitcher(qe)),
appChrome.api.dispatch(de),ge.Rcj(),this.tRi())})};this.Rkb=Jb;this.OEh=Tb;this.PEh=jc;this.vr=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");this.Jb=hd;this.ySe=Gd}R9m(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");zk.a.get_instance().kK(5);const b=this.xWi&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?12:10;zk.a.get_instance().Sk(b,this.E8m,11);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.PYk()}PYk(){this.Jb.$b(new mf.a(5,
1,0,()=>{this.ySe.execute(b=>{b.hYo()})}))}Pkm(){const b=[];this.OEh&&(b.push(appChrome.actions.setButtonSecondaryText(mp.a.gZd,this.Rkb.jSf)),b.push(appChrome.actions.setButtonSecondaryText(mp.a.DXd,this.Rkb.iSf)),b.push(appChrome.actions.setButtonSecondaryText(mp.a.Ogd,this.Rkb.kSf)));this.PEh&&b.push(appChrome.actions.setButtonSecondaryText(mp.a.Mgd,this.Rkb.b2m));return b}z1o(b){"true"===b?this.vr.execute(h=>{h.logActivity("OptInShyRibbonNormalScreenActivity",null)}):"false"!==b&&""!==b||!(1300>
window.innerWidth||700>window.innerHeight)||this.vr.execute(h=>{h.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});document.addEventListener("ShyRibbonSmallScreenActivity",()=>{requestAnimationFrame(()=>setTimeout(()=>{var h;null===(h=document.getElementById("RibbonModeToggle"))||void 0===h?void 0:h.click()},0))},!1);y.AFrameworkApplication.va.fb(Za.a.eRh,Gc.a.frame,this.D5k,96)}tRi(){y.AFrameworkApplication.Ctc.Psp();this.tMh();this.mlf();this.nRi();zk.a.get_instance().kK(7);qg.a.instance.H$(qh.a.ZSc,
qh.a.xug,(new Date).getTime());y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&this.t$b&&this.t$b.H9m(rs.a.FVj)}SOa(b){if(b){const h=this.Jyi();try{super.SOa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}nKa(){const b=this.Jyi();try{return super.nKa()}finally{null===b||void 0===b?void 0:b.dispose()}}Jyi(){var b;let h=void 0;const r=null===(b=ed.a.jf)||void 0===b?void 0:b.Tl;r&&(h=new Sb.GraphTransaction(ed.a.kXi()&&ed.a.xYf?0:
2),h.set(r));return h}}Object(u.a)(CK,"ReactRibbonUser",mC,[]);class HI extends Du{constructor(b,h,r,A,L,Z,oa,Ba){super(b,h,r);this.dXe=y.AFrameworkApplication.J.$("PasteWithOptionsFromRibbon")&&aa.a.B7;this.rl=L;this.J4e=Z;this.Jb=oa;this.ySe=Ba}TJl(b,h){const r=new oq(y.AFrameworkApplication.J,this.ga,this.Zb,this.dXe),A=new FA.a(r);return this.tKl(b,h,A,r)}tKl(b,h,r,A){var L=new Qw(new GI(y.AFrameworkApplication.J,A),r);r=this.n9m(L);const Z={};L.Gyb(Z);L=!aa.a.B7;const oa=aa.a.Nr||aa.a.nj;var Ba=
aa.a.Jl;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ba=aa.a.Di||Ba);Ba=new FF.a(Ba);b=new CK(b,h,WordEditorIntl.WordEditorStrings,this.iEb,A,b,this.rl,r,new Fx(Z),this.J4e,Ba,L,oa,new sz,this.Jb,this.ySe);b.R9m();return b}n9m(b){const h={};b.Jnd(h);b.htd(h);return new EA(null,h,"jewelWordEditor")}}Object(u.a)(HI,"WordEditorRibbonUserFactory",Du,[]);class wn{constructor(b,h){this.uB=b;this.rHd=h}SUa(b,h,r,A=null,L=null){return this.rHd.uSj(b)?this.rHd.SUa(b,h,r,A,L):this.uB.SUa(b,
h,r,A,L)}xLa(b,h=null){return this.rHd.uSj(b)?this.rHd.xLa(b):this.uB.xLa(b,h)}}Object(u.a)(wn,"RootCuiUser",null,[406]);class Cn extends wn{constructor(b,h){super(b,h)}clearCache(){this.uB.clearCache()}}Object(u.a)(Cn,"WordGeneralCuiUser",wn,[405,406]);var PM=d(1375);class DK{static getSelectedText(){const b=(new Us.a).HMf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static f8d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.VA(b,h)?h-1:h),b=b.length>h?b.substr(0,
h).trim()+"...":b);return b}}Object(u.a)(DK,"SearchUtils",null,[]);class eu extends Pm{constructor(b,h,r){super(b,r);this.wK=h}AFf(b){const h=[];var r=If.a.instance.gb.currentSelection;const A=!!this.wK&&this.wK.D$c(vb.a.bnf.toString()),L=!!this.wK&&this.wK.D$c(vb.a.vYb.toString()),Z=!A&&!r.LWa&&eu.Edb.jdj(),oa=!(y.AFrameworkApplication.dv&&eu.UYi)&&(!!this.wK&&this.wK.D$c(Za.a.dMa.toString())||!!OB.a.instance&&(3===OB.a.instance.mode||2===OB.a.instance.mode)),Ba=r.z1i()&&y.AFrameworkApplication.ua.Gb.w$c;
var gb=!1;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){gb=!!r&&(r.Nw||2===r.length&&he.a.pl(r.Xc));var Ab=DK.getSelectedText();gb=gb&&0<Ab.length&&60>Ab.length}b=(Ab=3===b||aa.a.Di||y.AFrameworkApplication.gEf)&&eu.vyf.T2(r,b);r=eu.UYi&&r&&1===r.length&&r.K(0).contextId===kc.a.Vc;Ab&&h.push(this.rl.qsa("ClipboardGroup")[0].externalUxGroupId);Z&&(h.push(this.rl.qsa("TextFormattingGroup")[0].externalUxGroupId),
h.push(this.rl.qsa("StylesGroup")[0].externalUxGroupId));gb&&h.push(this.rl.qsa("DefineGroup")[0].externalUxGroupId);A&&h.push(this.rl.qsa("PictureToolsGroup")[0].externalUxGroupId);L&&h.push(this.rl.qsa("TableToolsGroup")[0].externalUxGroupId);Ba&&h.push(this.rl.qsa("EquationToolsGroup")[0].externalUxGroupId);oa&&h.push(this.rl.qsa("CommentGroup")[0].externalUxGroupId);r&&h.push(this.rl.qsa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.rl.qsa("ContextMenuGroup")[0].externalUxGroupId);
PM.a.TVi&&eu.Ein&&h.push(this.rl.qsa("DesignerGroup")[0].externalUxGroupId);eu.Znn&&h.push(this.rl.qsa("MiniTemplateGroup")[0].externalUxGroupId);return h}static get vyf(){return null!=eu.kUg?eu.kUg:eu.kUg=Wa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get Edb(){return null!=eu.i3g?eu.i3g:eu.i3g=Wa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static t7c(b,h,r,A){b.fdl(()=>eu.Fnb(h,r,A))}static Fnb(b,h,r){return new eu(b,h,r)}static get Ein(){null===this.$Ve&&(y.AFrameworkApplication.$c("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),
this.$Ve=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.$Ve}static get UYi(){null!==this.HWe||"Templatization"!==y.AFrameworkApplication.dv&&"ContentAssemblyEdit"!==y.AFrameworkApplication.dv||(y.AFrameworkApplication.$c("insertSnippetTreatment;insertSnippetControl"),this.HWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",
!1):!1);return this.HWe}static get Znn(){null==this.VWe&&(y.AFrameworkApplication.$c("MiniTemplateV2ConsumerExp;MiniTemplateV2ConsumerExpCf"),this.VWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1):!1);return this.VWe}}eu.$Ve=null;eu.HWe=null;eu.VWe=null;Object(u.a)(eu,"WordReactFloatie",Pm,[]);class EK{constructor(){this.via=this.gQc=this.Z=null}get name(){return"WordEditor.UI"}init(){var b;this.Z.resolve("WordEditor.UI.BusinessBarController").qjg();
const h=ed.a.EB.FJ,r=ab.StaticActiveAppFrame.za();eu.t7c(r,this.Z.resolve("Common.IReactContextualUILauncher"),h,this.Z.resolve("Common.IExternalUICommandDefinitionMapping"));this.via=this.Z.Oa("Box4.IContextMenuController");const A=new yI(r,h,this.Z.Ta("Box4.IGeneralCuiUser"),this.Z.resolve("Box4.UI.PasteFloatieManager")),L={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=y.AFrameworkApplication.J)||void 0===
b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:L["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:L["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:L["floatie.gbUseSmartPasteButton"]=!1}A.t7c("PasteFloatieData",null,L);this.Z.resolve("WordEditor.UI.CuiActionBridge").initialize();(new EI(r,h,this.Z.Ta("Box4.IGeneralCuiUser"),this.Z.resolve("Box4.UI.ExternalContentFloatieManager"))).t7c("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],
{});this.Z.resolve("Box4.IGeneralCuiUser");zk.a.get_instance().Sk(7,()=>{this.gQc=this.Z.resolve("WordEditor.UI.StatusBarUser");this.gQc.Xb()})}dispose(){this.gQc&&(this.gQc.dispose(),this.gQc=null);this.via&&(this.via.dispose(),this.via=null)}wc(b){this.Z=b;b.ia("WordEditor.UI.BusinessBarController",()=>new Yw(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),y.AFrameworkApplication.va,y.AFrameworkApplication.J)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();
let h=aa.a.Jl;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=aa.a.Di||h);b.ia("Box4.UI.ShortcutHintMapping",()=>new FF.a(h));const r=aa.a.Nr||aa.a.nj,A=y.AFrameworkApplication.J.$("PasteWithOptionsFromContextMenu")&&(aa.a.B7||r),L=y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled");b.ia("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new zt(Wa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Wa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Bf.a)).ha();
b.ia("WordEditor.UI.EditSurfaceContextMenu",()=>new ik(y.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),y.AFrameworkApplication.J,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,L?b.Ta("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Oa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Ta("Box4.IPresenceDataManager"),b.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Ta("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
A,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Wa.a.instance.Ta("Common.IActionContextProvider"),Wa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Oa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ia("Box4.ISelectionContextMenuProvider",()=>new Yu).ha();b.ia("WordEditor.UI.CuiActionBridge",()=>new cl(y.AFrameworkApplication.J)).as("Box4.UI.CuiActionBridge").ha();
b.ia("WordEditor.UI.DialogFactory",()=>new IF).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ia("Common.NonCanvasCuiUser",()=>new yF(Sg.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ia("WordEditor.UI.WordGeneralCuiUser",()=>new Cn(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.StatusBarUser",()=>new Gt(ab.StaticActiveAppFrame.za().$Dg,b.Ta("Box4.IGeneralCuiUser"),
b.resolve("Box4.IFeatureHelper"),y.AFrameworkApplication.va,y.AFrameworkApplication.J,ab.StaticActiveAppFrame.za())).as("WordEditor.IStatusBarUser").ha();const Z=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("CommandUI.ReactRibbonRoot",()=>new ID(Su.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),Z)).ha();const oa=b.Ta("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new HI(oa,y.AFrameworkApplication.va,Sg.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),
b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),y.AFrameworkApplication.pc,b.Ta("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();let Ba=null;xA.a.xua&&(Ba=this.Z.resolve("Box4.Proofing.IProofingLanguageAutoDetectSettingsInfo"));b.ia("WordEditor.UI.ReactLanguageDialog",()=>new hC(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"),Ba)).as("Box4.UI.ILanguageDialog");b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",
()=>new JF(y.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new qz(y.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ia("WordEditor.UI.RulerUser",()=>new Ay).as("WordEditor.IRulerUser");b.ia("WordEditor.UI.RulerContextMenu",()=>new Lx(y.AFrameworkApplication.va,Wa.a.instance.Ta("Common.IZoomManager"),Bt.a.instance)).as("WordEditor.IRulerContextMenu").ha();b.ia("Common.IReactContextualUILauncher",()=>
new vI(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Box4.IContextMenuController",()=>new iG(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){y.AFrameworkApplication.$c("5b6i5792;30d4f535");mj.instance.kji();mj.instance.lzf();E.a.instance.Mc(new EK,6)}}Object(u.a)(EK,"WordEditorUIPackage",null,[0,1]);var GL=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",
attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",
Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",
Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},$D={};$D.VBc=function(){function b(){return oa()&&(hd()||3<=(Tb()?Gd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}
function A(Ff){Ff=(new RegExp(Ff+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Qi=-1;null!=Ff&&2<=Ff.length&&(Qi=parseFloat(Ff[1]),isNaN(Qi)&&(Qi=-1));return Qi}function L(){HM||(HM=!0,IM=A("Windows Phone"));return 8<=IM}function Z(){return"function"==typeof navigator.msLaunchUri&&!r()&&!Hc()&&!Ba()}function oa(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ba(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function gb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||
0<=window.navigator.userAgent.indexOf("Trident/")}function Ab(){return gb()?8==window.document.documentMode:!1}function Jb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Tb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function jc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Hc(){var Ff=window.navigator.userAgent.toLowerCase();return 0<=Ff.indexOf("android")&&0<=Ff.indexOf("chrome")}function hd(){return 3<=(Jb()?Gd("firefox/"):
0)}function Gd(Ff){var Qi=window.navigator.userAgent.toLowerCase(),vk=Qi.indexOf(Ff);return 0<=vk?parseInt(Qi.substring(vk+Ff.length,Qi.length)):0}function de(Ff,Qi,vk,Tk,Do){if(Tk&&null!=Qi)Qi();else if(Z())navigator.msLaunchUri(Ff,Qi,vk);else if(!(jc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&oa())||Ba())oe(Ff,Qi,vk);else if(jc()&&Do)a:{try{window.open(Ff,"_self")}catch(Fr){null!=vk&&vk();break a}null!=Qi&&Qi()}else qe(Ff,
Qi,vk)}function qe(Ff,Qi,vk){var Tk=document.getElementById("OICLinkTag");null==Tk&&(Tk=document.createElement("a"),Tk.id="OICLinkTag",Tk.style.visibility="hidden",Tk.href="",0==($p.Options&iw.SupportsTopTargetNavigation)||$p.NoBrowserModalDialogs?Tk.target="_blank":Tk.target="_top",document.body.appendChild(Tk),null!=Tk.addEventListener&&Tk.addEventListener("click",function(Do){null!=Do.stopPropagation&&Do.stopPropagation()},!1));try{Tk.href=Ff,Tk.dispatchEvent(new MouseEvent("click"))}catch(Do){null!=
vk&&vk();return}null!=Qi&&Qi()}function oe(Ff,Qi,vk){var Tk=document.getElementById("OICFrame");null==Tk&&(Tk=document.createElement("iframe"),Tk.className="ObjectInDialog",Tk.style.visibility="hidden",Tk.src="about:blank",document.body.appendChild(Tk),Tk.id="OICFrame");try{Tk.contentWindow.location.href=Ff}catch(Do){null!=vk&&vk();return}null!=Qi&&Qi()}function ge(Ff){return 0!=(Ff.Options&iw.SkipProtocolHandler)||Ab()}function $d(Ff){return Ff===eC.ReadOnly||Ff===eC.ReadWrite}function lf(Ff,Qi,
vk,Tk){var Do;try{var Fr=new ActiveXObject("SharePoint.OpenDocuments.4");return(Do=Fr.ViewDocument3(window.self,Ff,Qi,Tk))?(JD(jz.O14ActiveX),dp.None):dp.Failed}catch($q){}if(iw.O14Only===(vk&iw.O14Only))return $p.DescriptiveUnattemptedEnums?dp.O14AttemptFailure:dp.Unattempted;try{return Fr=new ActiveXObject("SharePoint.OpenDocuments.3"),(Do=Fr.ViewDocument3(window.self,Ff,Qi,Tk))?(JD(jz.O12ActiveX),dp.None):dp.Failed}catch($q){}if(iw.O12UpOnly===(vk&iw.O12UpOnly))return $p.DescriptiveUnattemptedEnums?
dp.O12UpOnlyFail:dp.Unattempted;try{return Fr=new ActiveXObject("SharePoint.OpenDocuments.2"),(Do=$d(Qi)?Fr.ViewDocument2(window.self,Ff,Tk):Fr.EditDocument2(window.self,Ff,Tk))?(JD(jz.O11ActiveX),dp.None):dp.Failed}catch($q){}return $p.DescriptiveUnattemptedEnums?dp.ActiveXUnattempted:dp.Unattempted}function wf(Ff,Qi,vk,Tk,Do){Ff==nq.Visio&&vk==eC.ReadWrite&&(vk=eC.WriteOnly);Tk=Tk||r()&&!L();if(!Tk){Tk="";if(Ff==nq.PowerPoint){Ff=Tk;Tk=$p.DocumentExtension;vk=$d(vk);var Fr=new Set([".pot",".potm",
".potx"]),$q=new Set([".pps",".ppsm",".ppsx"]);vk=vk&&Fr.has(Tk)?"nft|ofc|":vk&&$q.has(Tk)?"ofv|ofs|t|":!vk&&$q.has(Tk)?"ofe|ofs|t|":vk?"ofv|ofc|":"ofe|";vk=Ff+vk}else vk=$d(vk)?Tk+"ofv|ofc|":Tk+"ofe|";Ff=$p.SessionOrigin?"or|"+$p.SessionOrigin+"|":"";Ff+=$p.ClickTime?"ct|"+$p.ClickTime+"|":"";Ff+=$p.CorrelationId?"cid|"+$p.CorrelationId+"|":"";Tk=vk+Di(Ff);Do+=Di(Tk+"u|")}Do+=Di(Qi);Qi=window.location.href;vk=Qi.toLowerCase().indexOf("&wdlor=");-1!=vk?(vk+=7,Ff=Qi.indexOf("&",vk),Qi=-1==Ff?Qi.substr(vk):
Qi.substring(vk,Ff)):Qi=void 0;if(null!=Qi&&"undefined"!=typeof Qi){vk="";try{vk=decodeURIComponent(Qi)}catch(DF){}0<vk.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(vk)&&(Do=Do+"|f|"+vk)}return Do}function gi(Ff,Qi,vk,Tk,Do,Fr){var $q=uK(Ff);if(null==$q)return AA($p.DescriptiveUnattemptedEnums?dp.ProtocolHandlerIsNull:dp.Unattempted,$p.Application),!1;Ff=wf(Ff,Qi,vk,Tk,$q);de(Ff,Yl,xk,Do,Fr);return!0}function Di(Ff){if(oa()&&jc()){var Qi="";try{Qi=decodeURI(Ff)}catch(vk){}if(Qi==
Ff)return encodeURI(Ff)}return Ff}function Yl(){JD(jz.ProtocolHandler)}function xk(){$p.Options|=iw.SkipProtocolHandler;BL($p,KD,LD)}function Vn(){null!=DL&&DL(jz.RoamingProtocolHandler)}function Dx(){null!=EL&&EL(dp.ControlNeeded)}function qy(){var Ff=document.getElementById("npSharePointPlugin");if(null==Ff){Ff="application/x-sharepoint";oa()&&3<=(Tb()?Gd("version/"):0)&&zA("application/x-sharepoint-webkit",!0)&&(Ff="application/x-sharepoint-webkit");if(!zA(Ff,!0))if(oa()&&zA("application/officelive",
!0))Ff="application/officelive";else return null;var Qi=document.createElement("object");Qi.id="npSharePointPlugin";Qi.type=Ff;Qi.style.width="0px";Qi.style.height="0px";Qi.style.setProperty("visibility","hidden","");document.body.appendChild(Qi);Ff=document.getElementById("npSharePointPlugin")}return Ff}function zA(Ff,Qi){var vk=window.navigator.mimeTypes;if(null==vk)return!1;Ff=vk[Ff];return!Ff||Qi&&!Ff.enabledPlugin?!1:!0}function sI(Ff){try{if(null!=new ActiveXObject(Ff))return!0}catch(Qi){}return!1}
function tI(Ff){switch(Ff){case nq.OneNote:return"OneNote.Notebook";default:return""}}function uK(Ff){if(Ff!=nq.OneNote&&r()&&!L())return"office:";switch(Ff){case nq.Excel:return"ms-excel:";case nq.OneNote:return"onenote:";case nq.PowerPoint:return"ms-powerpoint:";case nq.Visio:return"ms-visio:";case nq.Word:return"ms-word:";case nq.Project:return"ms-project:";case nq.Publisher:return"ms-publisher:";case nq.Infopath:return"ms-infopath:";case nq.Access:return"ms-access:";default:return""}}function AL(Ff){switch(Ff){case nq.Excel:return"root\\office15\\excel.exe";
case nq.PowerPoint:return"root\\office15\\powerpnt.exe";case nq.Visio:return"root\\office15\\visio.exe";case nq.Word:return"root\\office15\\winword.exe";case nq.Project:return"root\\office15\\winproj.exe";case nq.Publisher:return"root\\office15\\mspub.exe";case nq.Infopath:return"root\\office15\\infopath.exe";case nq.Access:return"root\\office15\\msaccess.exe";default:return null}}function BL(Ff,Qi,vk){$p=Ff;KD=Qi;LD=vk;if(Ff.DocumentUrl){var Tk=vk=Qi=Ff.DocumentUrl;try{Tk=decodeURIComponent(Ff.DocumentUrl)}catch(EF){}try{vk=
encodeURI(Ff.DocumentUrl)}catch(EF){}Qi=Qi+""+Ff.CorrelationIdForWinClient;Tk+=Ff.CorrelationIdForWinClient;vk+=Ff.CorrelationIdForWinClient;Ff.Mode===eC.ReadWrite&&iw.CheckoutRequired===(Ff.Options&iw.CheckoutRequired)&&(Ff.Mode=eC.ForceCheckout);iw.HostIsEditOnly===(Ff.Options&iw.HostIsEditOnly)&&(Ff.Mode=eC.WriteOnly);if(ge(Ff)?0:oa()&&(Ff.Application==nq.OneNote||zA("application/x-sharepoint-protocolhandler",!1)||zA("application/x-sharepoint-webkit-protocolhandler",!1))||Z()||Hc()||!(b()||hd()||
"ActiveXObject"in window&&!r()||jc())||15<=uI())gi(Ff.Application,Ff.EncodeUrl?vk:Qi,Ff.Mode,Ff.Application==nq.OneNote,Ff.SilentExternalHandler,Ff.NavigateUsingWindowOpen);else{var Do;if(Do=Ab())a:{var Fr=Ff.EncodeUrl?Qi:Tk,$q=Ff.Mode,DF=tI(Ff.Application);try{Do=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Fr,$q,DF);break a}catch(EF){}Do=!1}if(Do)JD(jz.O15ActiveX);else{if(b()||hd()){var Ps=Ff.EncodeUrl?Qi:Tk;Tk=Ff.Mode;Do=tI(Ff.Application);Fr=qy();if(null==Fr)Ps=
$p.DescriptiveUnattemptedEnums?dp.PluginIsNull:dp.Unattempted;else{$q=!1;try{$q=Fr.ViewDocument3(window.self,Ps,Tk,Do)}catch(EF){}if(!$q)try{$q=$d(Tk)?Fr.ViewDocument2(window.self,Ps,Do):Fr.EditDocument2(window.self,Ps,Do)}catch(EF){}$q?(JD(jz.NpapiPlugin),Ps=dp.None):Ps=dp.Failed}}else{try{Ps=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ps&&Ps.SaveSSOCreds()}catch(EF){}Ps=lf(Ff.EncodeUrl?Qi:Tk,Ff.Mode,Ff.Options,tI(Ff.Application))}if(Ps!=dp.None){if(Tk=Ff.CouldUseRoamingApps)vK||(vK=!0,GM=A("Windows NT")),
Tk=6.1<=GM&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(gb()||hd()||jc());if(Tk&&Ff.Application!=nq.OneNote){if(!$D.VBc.TMp()){AA(dp.ControlNeeded,$p.Application);return}if(Ff.RoamingAppsLauncher){"undefined"==typeof Ff.RoamingAppsLauncher||null==Ff.RoamingAppsLauncher?AA($p.DescriptiveUnattemptedEnums?dp.RoamingLauncherIsNull:dp.Unattempted,$p.Application):"undefined"==typeof Ff.RoamingBitsUrl||null==Ff.RoamingBitsUrl?$D.VBc.mPp(Ff.DocumentUrl,Ff.RoamingAppsLauncher,Ff.Application,Ff.ApplicationParameters,
KD,LD):$D.VBc.Rgk(Ff.DocumentUrl,Ff.RoamingAppsLauncher,Ff.RoamingApplicationExe,Ff.ApplicationParameters,Ff.RoamingPlatform,Ff.RoamingBitsUrl,KD,LD);return}if(!Ff.ContinueIfLauncherIsNull){AA(dp.LauncherNeeded,$p.Application);return}}iw.NoProtocolHandlerFallback==(Ff.Options&iw.NoProtocolHandlerFallback)||ge(Ff)||gb()||oa()&&!($p.DescriptiveUnattemptedEnums?Ps>=dp.O14Unattempted&&Ps<=dp.DocumentUrlIsNull:Ps==dp.Unattempted)?AA(Ps,$p.Application):gi(Ff.Application,Ff.EncodeUrl?vk:Qi,Ff.Mode,Ff.Application==
nq.OneNote,Ff.SilentExternalHandler,Ff.NavigateUsingWindowOpen)}}}}else AA($p.DescriptiveUnattemptedEnums?dp.DocumentUrlIsNull:dp.Unattempted,$p.Application)}function JD(Ff){null!=KD&&KD(Ff)}function AA(Ff,Qi){"undefined"==typeof Qi&&(Qi=null);null!=LD&&LD(Ff,Qi)}function uI(){var Ff=0;if(b()||hd()||jc()){var Qi=qy();try{null!=Qi&&(Ff=Qi.GetOfficeVersion())}catch(vk){}}else sI("SharePoint.OpenDocuments.5")?Ff=15:sI("SharePoint.OpenDocuments.4")?Ff=14:sI("SharePoint.OpenDocuments.3")?Ff=12:sI("SharePoint.OpenDocuments.2")&&
(Ff=11);return Ff}function CL(){return oa()&&(zA("application/x-sharepoint",!0)||zA("application/x-sharepoint-webkit",!0))}var DM="",EM="",FM="",KD,LD,DL,EL,$p,vK,GM,HM,IM,eC={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},iw={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},dp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,
O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},jz={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},nq={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:eC,OpenDocumentOptions:iw,OpenDocumentFailureType:dp,
OpenDocumentControl:jz,OfficeApplication:nq,EditDocumentInClient:BL,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=nq.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=
this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:uI,IsO14MacPluginInstalled:CL,OfferOfficeInDialog:function(){return h()&&11>=uI()},OfferOfficeNoIntrusive:function(){return h()&&15>uI()},OfferMacOffice:function(){return oa()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!CL()},InstallRoamingControl:function(){Jb()?window.InstallTrigger.install({Office:{URL:EM}}):oe(FM,null,null)},CanUseRoamingControl:function(){if(Z())return!0;
if(jc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Jb()){var Ff=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Ff);var Qi=document.createEvent("Events");Qi.initEvent("RoamingOfficeInstalled",!0,!1);Ff.dispatchEvent(Qi);return!!Ff.getAttribute("installed")}if(gb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(vk){}return!1},
InitUrls:function(Ff,Qi,vk){DM=Ff;EM=vk;FM=Qi},LaunchRoamingApps:function(Ff,Qi,vk,Tk,Do,Fr){$D.VBc.Rgk(Ff,Qi,AL(vk),Tk,"x86",DM,Do,Fr)},LaunchRoamingApps2:function(Ff,Qi,vk,Tk,Do,Fr,$q,DF){var Ps="";null!=Tk&&(Ps+=" "+Tk);null!=Ff&&(Ps+=' "'+Ff+'"');if(Z()||jc())DL=$q,EL=DF,$q='office: "'+(Fr+'" "')+(vk+'" "ROAMING"'),$q+=' "'+Qi+'"',$q+=' "'+Do+'"',$q+=" "+Ps,de($q,Vn,Dx,!1,!1);else if(Jb())Ff=document.createElement("RoamingExtensionElement"),Ff.setAttribute("cabUrl",Fr),Ff.setAttribute("app",vk),
Ff.setAttribute("licensingEntitlements",Qi),Ff.setAttribute("platform",Do),Ff.setAttribute("args",Ps),document.documentElement.appendChild(Ff),Qi=document.createEvent("Events"),Qi.initEvent("RoamingOfficeLaunch",!0,!1),Ff.dispatchEvent(Qi),null!=$q&&$q(jz.RoamingFFExtension);else if(gb()){if(Ff=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Ff)try{Ff.HrConfigureSingle(Fr,vk,Qi,Do,Ps),null!=$q&&$q(jz.RoamingActiveX)}catch(EF){}}else null!=DF&&DF(dp.Failed)},ShouldShowDialog:function(){return!r()},
NavigateToUrlUsingClickingOnATag:qe,OpenDocumentWithProtocolHandler:gi,OpenDocumentWithProtocolHandlerNoCallBack:function(Ff,Qi,vk,Tk){var Do=uK(Ff);if(null==Do)return AA($p.DescriptiveUnattemptedEnums?dp.ProtocolHandlerNoCallbackIsNull:dp.Unattempted,$p.Application),!1;Ff=wf(Ff,Qi,vk,Tk,Do);de(Ff,null,null,!1,!1);return!0}}}();$D.ClientUtils=$D.VBc;var eP=d(1389);class HL{constructor(b,h,r){this.r5n=(A,L,Z,oa,Ba)=>{if(1===Z)return 32;Ba?(A=Ba.SourceControlId,"btnjTryMacOfficeForWordEditor"===A?rd.a.Tm(Ma.a.X8a(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===A&&rd.a.Tm(Ma.a.X8a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.S5i();return 32};this.Joj=(A,L,Z)=>{if(1===Z)return 32;switch(A){case Za.a.$3j:rd.a.Tm(Ma.a.X8a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Za.a.Z3j:rd.a.Tm(Ma.a.X8a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};this.ga=b;this.CBk=h;this.Z9=r}Xb(){this.ga.qa(Za.a.grp,Gc.a.frame,
this.r5n);this.ga.qa(Za.a.$3j,Gc.a.frame,this.Joj);this.ga.qa(Za.a.Z3j,Gc.a.frame,this.Joj)}S5i(){rd.a.Tm(HL.dJn,"_blank",void 0,"LaunchMacTrialWindow")}get Xod(){return this.CBk&&aa.a.Jl&&!aa.a.WZf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get x4o(){const b=this.Xod;b||y.AFrameworkApplication.Bn.GSo();return b}get w4o(){return this.Xod}static get dJn(){return Ma.a.Raa("522401")}}Object(u.a)(HL,"MacOfficeOffer",null,[1978]);class IL{constructor(b,h,r){this.s5n=(A,L,Z,oa,Ba)=>{if(this.hPd&&1===
Z)return this.isFreemiumUpsellEnabled&&this.Yod?32:8;2===Z&&(Ba?(A=Ba.SourceControlId,"btnjTryOfficeForWordEditor"===A?rd.a.Tm(Ma.a.X8a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===A?rd.a.Tm(Ma.a.X8a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.r2f()):this.r2f());return 32};this.YIg=(A,L,Z,oa,Ba)=>{if(this.hPd&&1===Z)return this.isFreemiumUpsellEnabled&&this.Yod?32:8;2===Z&&(Ba?(A=Ba.SourceControlId,rd.a.Tm(Ma.a.Raa("862405")+this.bFm(A),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):rd.a.Tm(Ma.a.Raa("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};this.e4j=(A,L,Z)=>{if(this.hPd&&1===Z)return this.isFreemiumUpsellEnabled&&this.Yod?32:8;if(2===Z)switch(A){case Za.a.d4j:rd.a.Tm(Ma.a.X8a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Za.a.c4j:rd.a.Tm(Ma.a.X8a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};this.ga=b;this.JBk=h;this.vK=null;(this.hPd=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&Wa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(A=>{this.vK=A});this.Z9=r}Xb(){this.ga.qa(Za.a.srp,Gc.a.frame,this.s5n);this.ga.qa(Za.a.YIg,Gc.a.frame,this.YIg);this.ga.qa(Za.a.d4j,Gc.a.frame,this.e4j);this.ga.qa(Za.a.c4j,Gc.a.frame,this.e4j)}get RUn(){return this.Yod}get QUn(){return this.Yod&&MSOJS.ClientUtils.OfferOfficeInDialog()}get Yod(){return this.JBk&&!aa.a.Jl}get isFreemiumUpsellEnabled(){let b=!1;this.vK&&(b=this.vK.isFreemiumUpsellEnabled());
return b}r2f(b=null){let h=0;b&&(h=b);rd.a.Tm(IL.Bym(h),"_blank",void 0,"LaunchOfficeOffer")}bFm(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;
case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static Bym(b){if(aa.a.Di)switch(b){case 1:return Ma.a.Raa("393806");case 2:return Ma.a.Raa("393810");case 3:return Ma.a.Raa("393809");case 5:return Ma.a.Raa("393805")}else if(aa.a.vI)switch(b){case 1:return Ma.a.Raa("521979");
case 3:return Ma.a.Raa("521980");case 5:return Ma.a.Raa("521978");case 2:return Ma.a.Raa("522490")}else{if(2===b)return Ma.a.Raa("517778");if(1===b)return Ma.a.X8a(30)}return Ma.a.Raa("522402")}}Object(u.a)(IL,"OfficeTrialExperience",null,[1953]);class QM{wc(b){b.register(IL,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().Ud(()=>new IL(y.AFrameworkApplication.va,y.AFrameworkApplication.CZf,y.AFrameworkApplication.lcid));b.register(HL,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().Ud(()=>
new HL(y.AFrameworkApplication.va,y.AFrameworkApplication.NZi,y.AFrameworkApplication.lcid))}}Object(u.a)(QM,"OpenInClientConfiguration",null,[1]);class iO{constructor(b=!1,h=!1,r=!1,A=!1,L=!0,Z=!1,oa=!0,Ba=!0,gb=!0,Ab=!1,Jb=!1,Tb=!1,jc=!1,Hc=!1,hd=!1,Gd=!1,de=!1,qe=!1,oe=null,ge=null,$d=null,lf=null,wf=null,gi=null,Di=null,Yl=null,xk=null){this.ync=!1;this.FIk=b;this.KIk=h;this.jNk=r;this.hNk=A;this.cNk=L;this.dNk=Z;this.fNk=oa;this.gNk=Ba;this.eNk=gb;this.uNk=Ab;this.ONk=Jb;this.tNk=Tb;this.fPk=
jc;this.nNk=Hc;this.Mzk=hd;this.GNk=Gd;this.PNk=de;this.fqk=qe;this.lNk=oe;this.sNk=ge;this.iNk=wf;this.qNk=$d;this.kNk=lf;this.pNk=gi;this.rNk=Di;this.mNk=Yl;this.oNk=xk}get Srj(){return this.FIk}get Tao(){return this.KIk}get qSj(){return this.jNk}get pSj(){return this.hNk}get G3o(){return this.cNk}get H3o(){return this.dNk}get J3o(){return this.fNk}get K3o(){return this.gNk}get I3o(){return this.eNk}get Pyb(){return this.nNk}get y$m(){return this.Mzk}get ZSj(){return this.GNk}get zTj(){return this.PNk}get Eml(){return this.fqk}get tSj(){return this.uNk}get U5o(){return this.ONk}get T3o(){return this.tNk}get sgp(){return this.fPk}get rSj(){return this.lNk||
Object(D.a)(this,this.Gvc,"returnFalse")}get S3o(){return this.sNk||Object(D.a)(this,this.Gvc,"returnFalse")}get R3o(){return this.qNk||Object(D.a)(this,this.hug,"returnTrue")}get M3o(){return this.kNk||Object(D.a)(this,this.hug,"returnTrue")}get L3o(){return this.iNk||Object(D.a)(this,this.Gvc,"returnFalse")}get Q3o(){return this.pNk||Object(D.a)(this,this.hug,"returnTrue")}get sSj(){return this.rNk||Object(D.a)(this,this.Gvc,"returnFalse")}get N3o(){return this.mNk||Object(D.a)(this,this.Gvc,"returnFalse")}get P3o(){return this.oNk||
Object(D.a)(this,this.Gvc,"returnFalse")}hug(){return!0}Gvc(){return!1}}Object(u.a)(iO,"HtmlTranslatorSettings",null,[233]);class ty{constructor(b,h,r,A,L,Z,oa){this.tg=b;this.Cg=h;this.UZ=r;this.uBf=A;this.Lj=L;this.Qd=Z;this.LF=oa}Ran(b,h){var r;b=h.view;h=h.Lk;if(!h||!this.tg.uXi(h,!0)||this.uBf&&this.uBf.instance&&this.uBf.instance.zX(h))return 2;var A=ty.veb?!ty.Q_.CBa(h):!0;this.UZ&&A&&this.UZ.wAc(h.node,jf.a.Pu,h.cpBegin);A=h.node;(null===(r=this.LF)||void 0===r?0:r.replaceText)&&this.LF.yoc(A)?
(r=A.ra.E7a(h.cpBegin),this.LF.replaceText(A,r,r,Am.a.qbd)):this.Cg.Lla(h,L=>new Am.a(L));if(this.Qd.Bg){r=new Sb.GraphTransaction(15);try{r.Ab(h.node),this.Lj.vna(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}A=h.node;r=h.cpEnd+1;" "===Cd.ParagraphReader.text(A).charAt(r)&&(A=xc.a.createTextRange(A,r,r+1),this.Cg.We(A,"\u00a0"));h=xc.a.Uc(h.node,r);b.lb.Kc(qc.SelectionFactory.Uo(h));return 32}static get Q_(){return null!=ty.nXg?ty.nXg:ty.nXg=Wa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get veb(){null==
ty.Wpa&&(ty.Wpa=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return ty.Wpa}}ty.Wpa=null;Object(u.a)(ty,"InsertLineBreakStrategy",null,[]);class lw{static get Mf(){return null!=lw.h1g?lw.h1g:lw.h1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Lj(){return null!=lw.w5g?lw.w5g:lw.w5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Qd(){return null!=lw.b6g?lw.b6g:lw.b6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static nbn(b,
h,r,A,L){if(L&&L.hasProperty(Od.a.targetObject)){var Z=h.view.vd.Hc.Eb(L.getValue(Od.a.targetObject));Z=xc.a.create(Z)}else Z=Object(Nl.a)().EW(h.Lk,11);if(!Z)return 8;b=y.AFrameworkApplication.va.Hf(Z,b,r,!0,A,L);if(32===b&&2===r){if(!h.view.ve)return 2;h=h.view;A=h.lb.Pg;if(A=Object(Nl.a)().EW(A,11)){r=new zl.a;r.set(A.node);r.Nd();if(L&&L.hasProperty(Od.a.targetObject))for(L=L.zf(Od.a.targetObject);!r.currentNode.id.equals(L)&&r.uc()&&(fg.OutlineElementNavigator.me(r),11===r.uf););fg.OutlineElementNavigator.y3(r,
!1,!1);L=he.a.EJa(r,!0);L=Cd.ParagraphReader.uu(L)?qc.SelectionFactory.ue(L,0):qc.SelectionFactory.Er(L);h.lb.Kc(L)}}return b}static Bbe(b,h,r,A,L){b=b===vb.a.Q7c;h=h.node;if(L&&L.hasProperty(Od.a.targetObject)&&!h.id.equals(L.zf(Od.a.targetObject)))return 2;if(1===r)return 32;r=new hb.a;r.set(h);r.zb(10);lw.Mf.yy(r,b,!0);lw.Qd.Bg&&(r=fg.OutlineElementNavigator.Me(r),lw.Lj.Z_b(r,1));return 32}}Object(u.a)(lw,"InsertOutlineElementStrategy",null,[]);class II{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.rSi=
(Tb,jc,Hc)=>{var hd,Gd;if(null===(hd=this.tda)||void 0===hd?0:hd.G_a)return this.tda.G_a(Hc,jc.cpBegin,{Fb:jc.Fb,Tb:jc.Tb});hd=!jc.cpBegin;Hc=jc.cpBegin===Cd.ParagraphReader.textLength(Hc);const de=!(null===(Gd=pf.a.xd())||void 0===Gd||!Gd.xm);let qe=!0;de&&hd&&!Hc?(qe=!1,Gd=new hb.a,Gd.nd(Tb),Gd.Nd(),this.Vh.yy(Gd,!0,!1)):Gd=this.Vh.Psa(Tb);this.Vh.Eca(Tb,Gd,jc,!1,!0,qe,!1,!0);!de||hd||Hc||(Tb=Object(Nl.a)().h5d(jc),pf.a.xd().Bk.IG(Tb));return Gd};this.$0=h;this.Huk=b;this.oB=Z;this.SDk=L;this.Vh=
r;this.Dsk=A;this.xl=oa;this.ib=Ba;this.EG=gb;this.iFc=Ab;this.tda=Jb}FRn(b,h,r,A,L){if(!h.view.ve)return 2;h=h.view;let Z=null;h.vj&&(Z=h);const oa=h.lb.Pg;var Ba=!0;let gb=!1,Ab=null;if(!oa)return 2;const Jb=new Sb.GraphTransaction(15);Jb.Ab(h.vd);let Tb=null;2===r&&(Tb=new zl.a,Tb.set(oa.node),Tb.Nd(),Ab=new yE.a(Tb),fg.OutlineElementNavigator.me(Tb),Ba=Eb.a.isEmpty(Tb,!1),{JSj:Ba,sbk:gb}=this.Dsk.KSj(Tb,Ba,vw.a.zQb,-1,oa));b=y.AFrameworkApplication.va.Hf(oa,b,r,!1,A,L);Ba&&32===b&&2===r&&(gb||
fg.OutlineElementNavigator.bMa(Tb,!1,!he.a.mf(oa),!1),gb&&Ab&&Ab.restore(Tb),this.oB.freeze(),(r=qc.SelectionFactory.qp(Tb.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.lb.Kc(r),this.oB.qOa(),this.Huk.ih.uI());Z&&(Ba||Z.b4(),Z.Ie&&Z.BX&&(Z.Ie.lK=!0));Iz.GrippersManager.instance.s2b(1);Jb.dispose();return b}vE(b,h,r){b=!1;if(Id.a.A7(h)||Id.a.y$a(h))h=this.HBl(h),b=!0;const A=h;if((h=he.a.mf(h))&&this.xl.Lh&&!this.xl.uon(A))return 2;if(1===r)return 32;
const L=A.node,Z=new hb.a;Z.set(L);Z.Nd();fg.OutlineElementNavigator.me(Z);r=new Sb.GraphTransaction(15);r.ju(Z);h?(this.iFc.instance&&this.iFc.instance.GOa(A),Cd.ParagraphReader.Wb(L)&&A.cpBegin===Cd.ParagraphReader.textLength(L)&&xl.m(A)&&9===Cd.ParagraphReader.zAa(L)&&this.oB.CCl(A),sf.ListItemReader.Fg(Z)?this.SDk.execute(Z,A,L,this.rSi):this.rSi(Z,A,L),this.$0&&this.$0.wAc(L,jf.a.Pu,A.cpBegin),b&&(fg.OutlineElementNavigator.ft(Z,!1,!1),b=Z.Vb(2),(b=this.EG.ue(b,0))&&this.ib.Kc(b))):this.Vh.yy(Z,
!0,!0);r.dispose();ab.StaticActiveAppFrame.za()&&ab.StaticActiveAppFrame.za().Ge();return 32}HBl(b){if(Id.a.A7(b))var h=xc.a.Uc(b.node,b.cpBegin);else{h=Cd.ParagraphReader.c_(b.node);var r=h.properties.zf(Vc.a.Iq);b=b.node.properties.getValue(Vc.a.runId);r=II.AHf(b,r,h.ra);h=xc.a.Uc(h,r)}return h}static ICf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static AHf(b,h,r){let A=0;b=II.ICf(b,h);let L=0;if(b===h.length)L=r.length-1;else for(;L<r.length;){h=r.Ub(L);if(h.formatting&&h.formatting.te===
b)break;L++}L<r.length&&(A=r.Ub(L).cp);return A}}Object(u.a)(II,"NewLineStrategy",null,[]);class QF{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd,Gd,de){this.En=null;this.lqa=b;this.yAd=oa;this.kHd=new II(this,h,r,A,L,Z,Ba,Jb,Tb,hd,Gd);this.Pmh=new ty(Ba,gb,h,Ab,jc,Hc,Gd);this.Qgh=de}get ih(){return this.En||(this.En=this.lqa())}Xb(){const b=y.AFrameworkApplication.va,h=Object(D.a)(this.kHd,this.kHd.vE,"newLine");b.fb(vb.a.enter,kc.a.view,Object(D.a)(this.yAd.value,this.yAd.value.M2l,"enterView"),
1124);b.fb(vb.a.RRj,kc.a.view,Object(D.a)(this.yAd.value,this.yAd.value.p2o,"shiftEnterView"),1124);b.qa(vb.a.vE,kc.a.view,Object(D.a)(this.kHd,this.kHd.FRn,"newLineView"));b.qa(vb.a.vE,kc.a.Vc,h);b.qa(vb.a.vE,kc.a.image,h);b.qa(vb.a.vE,kc.a.Cd,h);b.qa(vb.a.vE,kc.a.L$,h);b.qa(vb.a.vE,kc.a.epb,h);b.qa(vb.a.vE,kc.a.B7c,h);b.qa(vb.a.vE,kc.a.paragraph,h);b.qa(vb.a.vE,kc.a.UJ,h);b.qa(vb.a.vE,kc.a.POa,h);b.Pc(vb.a.vE,1124);b.fb(vb.a.M7c,kc.a.view,Object(D.a)(this.Pmh,this.Pmh.Ran,"insertLineBreakView"),
1028);b.qa(vb.a.Q7c,kc.a.view,lw.nbn);b.qa(vb.a.Q7c,kc.a.eS,lw.Bbe);b.Pc(vb.a.Q7c,1092);qu.a.ftb&&this.Qgh&&(b.qa(vb.a.T_c,kc.a.view,this.Qgh.T_c),b.Pc(vb.a.T_c,1124))}static get instance(){return null!=QF.rYg?QF.rYg:QF.rYg=QF.Qm()}static Qm(){return new QF(()=>Wa.a.instance.resolve("Box4.IUndoManager"),Wa.a.instance.Oa("Box4.IAutoCorrectScheduler"),Wa.a.instance.resolve("Box4.IOutlineElementEditor"),Wa.a.instance.resolve("Box4.List.ICursorMovementValidator"),Wa.a.instance.resolve("Box4.List.ListNewLineStrategy"),
Wa.a.instance.resolve("Box4.IInsertionPointFormatting"),Wa.a.instance.nf("Box4.Actors.IEnterViewStrategy"),Be.a.instance,Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.Ta("Box4.IExternalSelectionManager"),If.a.instance,Wa.a.instance.resolve("Box4.ISelectionFactory"),Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Wa.a.instance.Ta("Box4.IContentControlConverter"),Wa.a.instance.resolve("Box4.IBox4GraphWriter"),
qu.a.ftb?Wa.a.instance.resolve("Box4.Actors.ExpandParagraphStrategy"):null)}}Object(u.a)(QF,"EnterActor",null,[]);var JL=d(1290),RM=d(598);class Ik{static get ql(){return null!=Ik.V1g?Ik.V1g:Ik.V1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}static get H8(){return null!=Ik.T3g?Ik.T3g:Ik.T3g=Wa.a.instance.Oa("Box4.ISpacingCommands")}static get uzb(){return null!=Ik.e4g?Ik.e4g:Ik.e4g=Wa.a.instance.Oa("Box4.Styles.IWACStyleReader")}static get Oab(){return null!=Ik.b0g?Ik.b0g:Ik.b0g=Wa.a.instance.Oa("Box4.ILineSpacingHelper")}static get Lj(){return null!=
Ik.D5g?Ik.D5g:Ik.D5g=Wa.a.instance.Oa("Box4.TrackChange.ITrackChangeEditor")}static get Qd(){return null!=Ik.g6g?Ik.g6g:Ik.g6g=Wa.a.instance.Oa("Box4.TrackChange.ITrackChangeManager")}static Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.d3f,kc.a.view,Sn.a.zx);b.Pc(vb.a.d3f,1028);b.qa(vb.a.UE,kc.a.view,Sn.a.zx);b.qa(vb.a.UE,kc.a.paragraph,Ik.qSd);b.Pc(vb.a.UE,1036);b.qa(vb.a.Nwc,kc.a.paragraph,Ik.a8k);b.qa(vb.a.Nwc,kc.a.view,Sn.a.zx);b.Pc(vb.a.Nwc,1036);b.qa(vb.a.Lnd,kc.a.paragraph,Ik.Khf);b.qa(vb.a.Lnd,
kc.a.view,Sn.a.zx);b.qa(vb.a.Aod,kc.a.paragraph,Ik.fif);b.qa(vb.a.Aod,kc.a.view,Sn.a.zx);b.qa(vb.a.Knd,kc.a.paragraph,Ik.Jhf);b.qa(vb.a.Knd,kc.a.view,Sn.a.zx);b.qa(vb.a.Cef,kc.a.view,Ik.v3k);b.Pc(vb.a.Cef,1036);b.qa(vb.a.nrg,kc.a.view,Ik.WCo);b.Pc(vb.a.nrg,1036);b.qa(vb.a.Bef,kc.a.view,Ik.u3k);b.Pc(vb.a.Bef,1036);b.qa(vb.a.mrg,kc.a.view,Ik.VCo);b.Pc(vb.a.mrg,1036);b.qa(vb.a.m_a,kc.a.view,Sn.a.zx);b.qa(vb.a.m_a,kc.a.paragraph,Ik.qSd);b.Pc(vb.a.m_a,1036);b.qa(vb.a.l_a,kc.a.view,Sn.a.zx);b.qa(vb.a.l_a,
kc.a.paragraph,Ik.qSd);b.Pc(vb.a.l_a,1036);b.qa(vb.a.fAe,kc.a.view,Ik.eAe);b.qa(vb.a.fAe,kc.a.paragraph,Ik.eAe);b.Pc(vb.a.fAe,1028);b.qa(vb.a.oDg,kc.a.view,Ik.eAe);b.qa(vb.a.oDg,kc.a.paragraph,Ik.eAe);b.Pc(vb.a.oDg,1028);b.qa(vb.a.Yze,kc.a.view,Sn.a.zx);b.qa(vb.a.Yze,kc.a.paragraph,Ik.oTh);b.Pc(vb.a.Yze,1028);b.qa(vb.a.Xze,kc.a.view,Sn.a.zx);b.qa(vb.a.Xze,kc.a.paragraph,Ik.oTh);b.Pc(vb.a.Xze,1028)}static oTh(b,h,r,A,L){if(1===r)return 32;b===vb.a.Yze?b=vb.a.m_a:b===vb.a.Xze&&(b=vb.a.l_a);return Ik.qSd(b,
h,r,A,Ik.tao(L))}static tao(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new JL.a;h.value=parseFloat(r);h.unit=parseInt(b);return h}static eAe(b,h,r,A,L){if(2===r){h=L[Ji.a.Text];r=L[Ji.a.Number];L=L.Increment;A=new JL.a;let Z=!1;""===h||L&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(A.value=0,A.unit=ed.a.mLa?2:4,Z=!0):r||L||(A.value=0,A.unit=1,Z=!0);Z&&(y.AFrameworkApplication.va.Qb(b===vb.a.fAe?vb.a.m_a:vb.a.l_a,2,A),ab.StaticActiveAppFrame.za().Ge())}return 32}static qSd(b,
h,r,A,L){if(!({Hz:r}=Sn.a.BAg(r,h)).returnValue)return r;h=h.node;switch(b){case vb.a.UE:Ik.ql.UE(h,new RM.a(2,L));break;case vb.a.m_a:b=new RM.a(L.unit,L.value);Ik.ql.fyb(h,b);break;case vb.a.l_a:b=new RM.a(L.unit,L.value),Ik.ql.eyb(h,b)}A&&At.a.Vzb&&(A.Xt|=At.a.Fqb(h));return 32}static v3k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Ik.cHi(h);if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),
8;b=(b=b.ka(Vc.a.Uj,240)/20)?b:Ik.gPl;Ik.H8.nha(1,b,4);return 32}static WCo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Ik.H8.nha(1,0,4);return 32}static u3k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Ik.cHi(h);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ka(Vc.a.ta,240)/20;Ik.H8.nha(0,b?b:12,4);return 32}static VCo(b,
h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Ik.H8.nha(0,0,4);return 32}static Khf(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=h.node;h=b.LA();Ik.ql.Khf(b,L);h&&Ik.Lj.YP(b,h,Ik.Qd.Bg)}return 32}static fif(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=h.node;h=b.LA();Ik.ql.fif(b,L);h&&Ik.Lj.YP(b,h,Ik.Qd.Bg)}return 32}static Jhf(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=h.node;h=b.LA();Ik.ql.Jhf(b,L);
h&&Ik.Lj.YP(b,h,Ik.Qd.Bg)}return 32}static a8k(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=new Map;b.set("Value",L.toString());xa.Health.instance.recordKpiUsage(pk.a.Eab.ump,0,pk.a.UB,b);h=h.node;b=h.LA();h.hasProperty(Vc.a.ny)&&h.removeProperty(Vc.a.ny);Ik.Oab.p5d(h)!==L&&h.setValue(Vc.a.ny,L);(L=Ik.Oab.dkc(h,!0))&&L.Xl(4,!0);(L=Ik.Oab.dkc(h,!1))&&L.Xl(4,!0);b&&Ik.Lj.YP(h,b,Ik.Qd.Bg)}return 32}static cHi(b){b=b.view;return b.ve&&(b=b.lb)&&b.gb.currentSelection?Ik.uzb.Cq(b.gb.currentSelection.Qa.node):
null}}Ik.gPl=12;Object(u.a)(Ik,"SpacingActor",null,[]);class nC{process(){}}Object(u.a)(nC,"NoOpFormattingViewOperationFinishedStageProcessor",null,[1592]);class jO{constructor(b){this.Ee=b}kVo(b,h){b&&h&&h.cache&&(this.Ee.lha(b,h.cache.pI),this.Ee.pC(b,h.cache.fontSize))}pQb(){return null}HVa(){return null}Okc(){return null}fX(){return null}}Object(u.a)(jO,"FormattingStewardBridge",null,[1591]);class kO{wc(b){b.ia("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new nC).ha();b.ia("Box4.Actors.IFormattingStewardBridge",
()=>new jO(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(u.a)(kO,"WoncaActorsConfiguration",null,[1]);class lO{constructor(b,h,r,A,L,Z,oa,Ba){this.ga=b;this.upk=h;this.tpk=r;this.s$g=A;this.IIk=L;this.UId=Z;this.MIk=oa;this.NIk=Ba}get Pb(){return this.ga}sfl(b){this.Pb.Zma(b,this.upk,null,null)}qfl(b){this.Pb.Zma(b,this.tpk,null,null)}s6(b,h,r){r?this.Pb.Zma(b,this.s$g,h,null):this.Pb.Qb(this.s$g,2,h)}Wao(b,h){this.Pb.Zma(b,this.UId,h,null)}P3(b,h){this.Pb.Zma(b,this.MIk,h,null)}xwb(b,h){this.Pb.Zma(b,
this.NIk,h,null)}Nig(b,h=!1){const r=new lj.DictionaryPropertySet;r.setValue(Od.a.XX,b);r.setValue(Od.a.msj,!0);r.setValue(Od.a.K$a,h);this.Pb.Qb(this.IIk,2,r)}}Object(u.a)(lO,"ClipboardCommands",null,[1585]);class mO{}Object(u.a)(mO,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1584]);class nO{constructor(b){this.ga=b}get Pb(){return this.ga}XOj(b,h,r){let A=0;b?1===b&&(A=vb.a.e$a):A=vb.a.d$a;b=new zD.a;b.unit=r;b.value=h;this.Pb.Qb(A,2,b)}Lxe(b,h,r){let A=0;1===b?A=vb.a.R_b:2===b?A=vb.a.Cyb:
b||(A=vb.a.S_b);b=new zD.a;b.unit=r;b.value=h;this.Pb.Qb(A,2,b)}}Object(u.a)(nO,"IndentationCommands",null,[1582]);var KL;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.Q5p=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.xZp=7]="distribute";b[b.margin=8]="margin";b[b.q4p=9]="highKashida";b[b.w8p=10]="lowKashida";b[b.U8p=11]="mediumKashida";b[b.bfq=12]="numTab";b[b.epq=13]="thaiDistribute";b[b.start=14]="start";
b[b.end=15]="end"})(KL||(KL={}));Object(u.b)("Justification",KL);class oO{constructor(b){this.pRa={};this.ga=b;this.Q6m()}get Pb(){return this.ga}wH(b){b=this.pRa[KL[b]];void 0!==b&&null!==b&&this.Pb.Ob(b,2)}Q6m(){this.pRa.left=vb.a.O7;this.pRa.center=vb.a.X$;this.pRa.right=vb.a.t8;this.pRa.both=vb.a.TJa;this.pRa.lowKashida=vb.a.jUb;this.pRa.mediumKashida=vb.a.jUb;this.pRa.highKashida=vb.a.jUb;this.pRa.distribute=vb.a.oZc;this.pRa.thaiDistribute=vb.a.uod}}Object(u.a)(oO,"JustificationCommands",null,
[1581]);class pO{constructor(b){this.ga=b}UE(b){this.ga.Qb(vb.a.UE,2,b)}Nwc(b){this.ga.Qb(vb.a.Nwc,2,b)}Lnd(b){this.ga.Qb(vb.a.Lnd,2,b)}Aod(b){this.ga.Qb(vb.a.Aod,2,b)}Knd(b){this.ga.Qb(vb.a.Knd,2,b)}nha(b,h,r){this.ga.Qb(b?vb.a.m_a:vb.a.l_a,2,Object.assign(new JL.a,{value:h,unit:r}))}}Object(u.a)(pO,"SpacingCommands",null,[1579]);class qO{constructor(b,h,r){this.Pb=b;this.PZc=h;this.PZl=r;this.B6n=(A,L,Z)=>{if(1===Z)return this.PZc.c2?32:8;this.PZc.nCn();this.PZl().S7o(this.PZc.Vqm());return 32}}Xb(){this.Pb.fb(vb.a.kwb,
kc.a.application,this.B6n,1028)}}Object(u.a)(qO,"EditorSettingsUIActor",null,[]);class rO extends Dg.a{constructor(b,h){super(!1,!1,!0);this.RZl=b;this.EXa=h;this.QZl=r=>{1!==r?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.RZl.mvp(),v.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async S7o(b){const h=await this.EXa.JUb;b={["id"]:"SettingsDialog",["uiLanguage"]:y.AFrameworkApplication.uiCulture,["selectedLanguage"]:kg.a.Eg(y.AFrameworkApplication.lcid).name,
["isGoalActive"]:!1,["isSubscription"]:h.nad,["editorSettings"]:b};this.Uh(Box4Intl.Box4Strings.l_EditorSettings,this.QZl,b);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(u.a)(rO,"EditorSettingsDialog",Dg.a,[]);var fP=d(237);class sO{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){var Hc;this.aHb=this.Iic=this.vEc=null;this.t8e=0;this.rZd=null;this.JVe=!1;this.sa=new Bf.a;this.Ide=!1;this.kEf=null===(Hc=y.AFrameworkApplication.J)||void 0===Hc?void 0:Hc.getBooleanFeatureGate("Microsoft.Office.WordOnline.FormatPainterStylesBugFixIsEnabled",
!1);this.ew=b;this.oB=h;this.Ee=r;this.xv=A;this.hb=L;this.Rd=Z;this.xl=oa;this.Fd=Ba;this.Zd=gb;this.kq=Ab;this.EZ=Jb;this.hy=Tb;this.Gp=jc}get z0l(){return this.Fd?this.Fd.isFeatureEnabled(34):!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled")}get mEf(){return null!=this.gWg?this.gWg:this.gWg=Wa.a.instance.resolve("Box4.IFormatPainterStrategy")}get xU(){return this.JVe}set xU(b){this.JVe!==b&&(this.JVe=this.Ide=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}C0k(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",
b)}Wsj(b){const h=b.Qa;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();y.AFrameworkApplication.$c("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.kEf&&(this.rZd=Ya.FormattingReader.G9a(h.node));var r=h.node;b=this.e_i(b);if(this.mEf.F4o(h.contextId,b))try{y.AFrameworkApplication.$c("c8cgd193;5b834819"),this.aHb=this.hb.o9a(r)}catch(A){throw v.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",A.message),A;}this.Iic=this.hy.Cq(r);
r=Ya.FormattingReader.Vs(h);r.mo&&(this.vEc=Object(Ca.a)(YC.a,r.mo.clone()));y.AFrameworkApplication.$c("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.kEf&&(this.Iic.getValue(Ke.a.fontColor)||this.rZd.setValue(Ke.a.fontColor,Ql.a.auto));this.t8e=b?kc.a.paragraph:h.contextId}KSh(b){if(b){const r=this.e_i(b);for(let A=0;A<b.length;A++){const L=b.K(A);if(null===L||void 0===L?0:L.Al)this.FKb(L,r);else if(0==(null===L||void 0===L?void 0:L.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",
L);else if(L)for(let Z=0;Z<L.length;Z++){var h=L.getContext(Z);if(null===h||void 0===h?0:h.Ww){if(h)for(let oa=0;oa<h.length;oa++)L.addContext(h.getContext(oa))}else(null===h||void 0===h?0:h.Al)?this.FKb(h,r):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}NSh(b,h){if(h){var r=b.node,A=r.ra.last,L=this.Rd.R7a(r),Z=L.Of(L.Ib);this.OSh(L,h,null,null);this.kq.x_b(r,A,b.cpBegin,b.cpEnd,Z,L,this.Zd.Bg)}}n8k(b,h,r,A){if(h||r)0<xl.g(b).length&&
v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.EZ.AW(b,L=>{this.OSh(L,h,r,A)})}OSh(b,h,r,A){this.Ee.Wqa(b);y.AFrameworkApplication.$c("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.kEf&&this.zt(b,A);b.mo&&b.mo.removeProperty(Ke.a.highlight);this.Ee.Unf(b);r&&(r=r.clone(),r.Vf(...zr.a.Waa()),this.zt(b,r.Ti()));this.zt(b,h)}zt(b,h){if(h){var r=b.paragraph.Hc;if(r){var A=b.mo;A=A?Object(Ca.a)(Gl.a,A.clone()):YC.a.ZTa(Ln.a.uwb);for(const oa of h.Zj())if(oa!==
Vc.a.Jw&&oa!==Vc.a.C2&&oa!==Ke.a.tE&&oa!==Ke.a.lba&&oa!==Vc.a.$sb&&oa!==Ke.a.RF&&oa!==Vc.a.Gab&&oa!==Vc.a.noProof){if(oa===cg.a.Lw){var L=h.ka(cg.a.Lw,Q.a.nil);if(L!==Q.a.nil)if(L=this.hy.ro().wla(L,r)){var Z=this.hy.wL(L);if(Z===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(L=this.hy.IF(b.paragraph),Ki.a.Kg.vn?(Z=L.gv().GAa(Z),L=L.nh(this.hy.Be(Z))):L=L.qKa(Z),L){A.lza(L.Ti(),...zr.a.Waa());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,
354,50,"Applied character style on formatting is not present in Object Space")}A.setValue(oa,h.zf(oa))}A.BLa?h=r.JP(A,!0):(r.hu(A),h=A);b.Hk=h.id}}}e_i(b){return!b.Nw&&b.Xc.contextId!==kc.a.Zc}reset(){this.aHb=this.Iic=this.rZd=this.vEc=null;this.t8e=kc.a.none}FKb(b,h){if(b.contextId===kc.a.Vc||b.contextId===kc.a.Cd)var r=this.xl.jba(b);else if(b.contextId===kc.a.paragraph)r=this.xl.Iee(b);else if(b.contextId===kc.a.Zc)r=this.xl.qde(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",
b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(Ca.a)(On.AParagraphNode,b.node);var A=!1;r&&(A=b.contextId===kc.a.Cd&&!!r&&!b.cpBegin&&b.cpEnd===this.hb.textLength(r));if(h=this.mEf.B2o(this.t8e,b.contextId,h,A))try{Cd.ParagraphReader.Wb(r)?(this.Iic&&this.ew.ZP(this.Iic,r,!0),this.xv.fTh(r,this.aHb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
b.node.type)}catch(L){throw v.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",L.message),L;}A=b;b.contextId===kc.a.paragraph?A=xc.a.createTextRange(r,0,Cd.ParagraphReader.textLength(r)):b.contextId===kc.a.Vc&&(A=this.oB.MMf(b),A=If.a.SMb(A));if(A&&A.contextId===kc.a.Cd){const L=this.Gp.Q7d(A);L&&(A=L);try{this.n8k(A,this.vEc,h?null:this.Iic,h?null:this.rZd)}catch(Z){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",Z.message),Z;}}if(b.contextId===
kc.a.paragraph||b.contextId===kc.a.Zc)h=new hb.a,h.set(r),h.Nd(),h.kd(11),A=sf.ListItemReader.Fg(h),r=!Cd.ParagraphReader.textLength(r),v.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",A,r),A?(r=sf.ListItemReader.h7(h),sf.ListItemReader.isListItem(r)&&this.NSh(b,this.vEc)):this.z0l&&this.NSh(b,this.vEc)}}}Object(u.a)(sO,"FormatPainter",null,[1532]);var LL=d(117);class GA{constructor(b,h,r,A,L,Z,oa,Ba=!1,gb,Ab,Jb){this.OEd=!1;this.nSe=new Iy.a;this.UVm=()=>{this.XV.xU=
!1;return 32};this.VVm=(Tb,jc,Hc)=>{Tb=!1;if(jc=this.rA.cfa){switch(jc.contextId){case kc.a.Cd:case kc.a.paragraph:case kc.a.Zc:case kc.a.Vc:Tb=!0}Tb&&he.a.Zl(jc)&&xl.b(jc)&&(this.zd.fc(Df.a.Pn,{["Reason"]:gf.a.wWc}),Tb=!1);Tb&&Cd.ParagraphReader.xX(jc)&&(this.zd.fc(Df.a.Pn,{["Reason"]:gf.a.XQ}),Tb=!1)}if(1===Hc||!Tb)return Tb?32:8;6!==this.ga.gE?(this.XV.xU?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),
this.XV.Wsj(this.rA.currentSelection),this.OEd||(this.ii.A5a(this.M6j),(Hc=this.ii.kb.Gw)&&Hc.vj&&Hc.ZOh(this.L6j),this.OEd=!0)),this.XV.xU=!this.XV.xU):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.XV.Wsj(this.rA.currentSelection),this.XV.xU=!1);return 32};this.TVm=(Tb,jc,Hc,hd,Gd)=>{if(6===this.ga.gE||this.XV.xU){v.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.gE);Tb=this.ii.Vr.Xf("UserAction","FormatPainterApply");
if(GA.rc&&GA.rc.rE(107)){Gd=Gd?Gd.KeepBrushActive:!1;Hc=null;this.rA.currentSelection&&2===this.rA.currentSelection.trigger&&(Gd=Gd||this.XV.Ide,this.XV.Ide&&he.a.ym(this.rA.currentSelection)&&(Hc=he.a.T6(this.rA.currentSelection.Qa,!1)))&&(Hc.trigger=2);this.XV.Ide=!1;if(Gd||2!==this.rA.currentSelection.trigger)jc=new Sb.GraphTransaction(15),Hc&&Hc.Qa?(jc.set(Hc.Qa.node.Fk),this.ib.Kc(Hc)):jc.set(this.rA.VOb.Fk),Hc=qc.SelectionFactory.Uo(this.ib.Pg),this.XV.KSh(Hc),jc.dispose();this.XV.xU=Gd}else Gd=
new Sb.GraphTransaction(15),Gd.set(this.rA.VOb.Fk),jc=qc.SelectionFactory.Uo(this.ib.Pg),this.XV.KSh(jc),this.XV.xU=!1,Gd.dispose();Tb.stop()}return 32};this.M6j=()=>{this.Une(this.XV.xU)};this.L6j=()=>{this.Une(this.XV.xU)};this.ii=b;this.Zb=h;this.ga=r;this.zd=A;this.rA=L;this.XV=Z;this.ib=oa;this.VAk=Ba;this.mA=gb;this.XD=Ab;this.Jsk=Jb}get Dih(){return aa.a.au||aa.a.cfe?"url("+this.nyi()+"), pointer":'url("'+this.nyi()+'"), pointer'}nyi(){return this.XD?this.mA.tAa(tj.a.Aj("FormatPainterText.cur"),
tj.a.Aj("FormatPainterTextDarkMode.cur"),new LL.a(nn.a.YO())):tj.a.Aj("FormatPainterText.cur")}Xb(){const b=this.Zb.ie(Nk.a.AF);b.bindAction(Cb.KeyInputManager.oc(jf.a.Dfb,0),vb.a.lEf);b.bindAction(Cb.KeyInputManager.oc(jf.a.rBb,6),vb.a.Z3d);this.VAk||b.bindAction(Cb.KeyInputManager.oc(jf.a.uBb,6),vb.a.s8a);this.ga.fb(vb.a.Z3d,kc.a.view,this.VVm,1028);this.ga.fb(vb.a.s8a,kc.a.view,this.TVm,1028);this.ga.fb(vb.a.lEf,kc.a.view,this.UVm,1028);this.XV.C0k(()=>{this.mLg(this.XV.xU)});this.XD&&this.Jsk.kRd(()=>
{this.Une(this.XV.xU)})}mLg(b){const h=this.ii.Vr.Xf("UserAction","FormatPainterUpdateCursor");this.Une(b);this.ii.Ge();h.stop()}K6j(b,h){for(let r=0;r<b.length;r++)this.J6j(b[r],h);(b=this.ii.kb.Gw)&&b.ve&&this.J6j(b.Hi.editingElement,h)}J6j(b,h){b.style.cursor=h?this.Dih:""}Une(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.Dih;if(this.ii.kb.isEditingAllowed||this.ii.kb.Wz){if(b&&!r||!b&&r)this.K6j(h,b),this.g7j(b);b||!this.OEd||
this.nSe.count||(this.ii.ADj(this.M6j),(b=this.ii.kb.Gw)&&b.vj&&b.QBo(this.L6j),this.OEd=!1)}else r&&(this.K6j(h,!1),this.g7j(!1))}}g7j(b){const h=this.ii.kb.Gw;h&&(b?this.nSe.add(h.vd.$k):this.nSe.remove(h.vd.$k))}static get rc(){return null!=GA.ZUg?GA.ZUg:GA.ZUg=Wa.a.instance.Oa("Box4.IFeatureHelper")}}Object(u.a)(GA,"FormatPainterActor",null,[]);class uy{constructor(b,h,r){this.Vn=r}M2l(b,h,r,A,L){let Z;if(!({ge:r,selected:Z,Hz:Ab,E9c:gb}=this.TSj(h,r,!1)).returnValue)return Ab;db.a.mark(5013);
var oa=uy.Pw.EO(Z);for(var Ba=0;Ba<oa.length;++Ba){if(!oa[Ba].isValid)continue;const Jb=oa[Ba].iterator;Jb.Ks();if(fm.OutlineReader.zy(Jb))return this.Oki(r,Jb)}var gb=gb?vb.a.M7c:this.xrm();if(Z.Ww||he.a.Zl(Z)||Cd.ParagraphReader.en(Z)&&!he.a.fba(Z)){if(uy.rc&&uy.rc.isFeatureEnabled(21)&&Object(Nl.a)().zCg(Z).returnValue)return 8;var Ab=this.Pki(h,r,b,A,L,gb)}else if(he.a.pl(Z))Ab=this.Nki(h,r,b,A,L,gb);else if(he.a.mf(Z)){Ab=new hb.a;Ab.set(Z.node);Ab.zb(10);oa=Ic.a.Oz(Z,!1);if(0<oa.length){if(!oa[0].hyperlink)return v.ULS.sendTraceTag(38835461,
324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",oa[0].cpBegin,oa[0].cpEnd),8;ed.a.wic(oa[0].hyperlink.url);return 32}$g.TableCellReader.h3(Ab)&&(Kh.returnToContainingCell(Ab),$g.TableCellReader.Xla(Ab)&&(oa=new hb.a,oa.nd(Ab),Kh.returnToContainingRow(oa),fm.OutlineReader.UA(Ab,Z,!1)&&(Ba=Z,Vm.a.RXi(oa)&&0>=Ba.Fb&&(gb=vb.a.Q7c,Kh.returnToContainingTable(Ab),fg.OutlineElementNavigator.me(Ab),L||(L=new lj.DictionaryPropertySet),L.Wg(Od.a.targetObject,Ab.currentNode.id)))));qu.a.ftb&&Z.node.Inb.ktb&&
(L||(L=new lj.DictionaryPropertySet),L.Wg(Od.a.targetObject,Ab.currentNode),gb=vb.a.T_c);Ab=this.Qki(h,r,b,A,L,gb)}else he.a.fba(Z)&&(Ab=y.AFrameworkApplication.va.Hf(h,vb.a.vE,2,!1,A,L));db.a.mark(5014);return Ab}TSj(b,h,r){let A=null,L=null,Z=!1;if(1===h)return{returnValue:!1,ge:A,selected:L,Hz:32,E9c:Z};if(!b.view.ve)return{returnValue:!1,ge:A,selected:L,Hz:2,E9c:Z};A=b.view;L=A.lb.Pg;return!L||!uy.tg.uXi(L,r)||uy.tg.ama(L,oa=>Z=oa)&&!Z?{returnValue:!1,ge:A,selected:L,Hz:2,E9c:Z}:this.Vn&&this.Vn.instance&&
this.Vn.instance.zX(L)?{returnValue:!1,ge:A,selected:L,Hz:4,E9c:Z}:{returnValue:!0,ge:A,selected:L,Hz:2,E9c:Z}}p2o(b,h,r,A,L){let Z,oa;if(!({ge:r,selected:Z,Hz:oa}=this.TSj(h,r,!0)).returnValue)return oa;const Ba=uy.Pw.EO(Z);for(let gb=0;gb<Ba.length;++gb){if(!Ba[gb].isValid)continue;const Ab=Ba[gb].iterator;Ab.Ks();if(fm.OutlineReader.zy(Ab))return this.Oki(r,Ab)}Z.Ww||he.a.Zl(Z)?oa=this.Pki(h,r,b,A,L,vb.a.M7c):he.a.pl(Z)?oa=this.Nki(h,r,b,A,L,vb.a.M7c):he.a.mf(Z)?oa=this.Qki(h,r,b,A,L,vb.a.M7c):
he.a.fba(Z)&&(oa=y.AFrameworkApplication.va.Hf(h,vb.a.vE,2,!1,A,L));return oa}Oki(b,h){b.lb.Kc(qc.SelectionFactory.qp(h.currentNode,!1));return 32}Pki(b,h,r,A,L,Z){const oa=new Sb.GraphTransaction(15);oa.Ph=r;oa.Ab(h.vd);h=new lj.DictionaryPropertySet;h.setValue(Od.a.tZc,!0);h=y.AFrameworkApplication.va.Hf(b,vb.a.gI,2,!0,A,h);32===h&&(h=y.AFrameworkApplication.va.Hf(b,Z,2,!1,A,L));oa.dispose();return h}Nki(b,h,r,A,L,Z){const oa=new Sb.GraphTransaction(15);oa.Ph=r;oa.Ab(h.vd);h.lb.Kc(he.a.vk(h.lb.gb.K(0),
!1,!1));b=y.AFrameworkApplication.va.Hf(b,Z,2,!1,A,L);oa.dispose();return b}Qki(b,h,r,A,L,Z){const oa=new Sb.GraphTransaction(15,r);oa.Ph=r;oa.Ab(h.vd);b=y.AFrameworkApplication.va.Hf(b,Z,2,!1,A,L);oa.dispose();return b}static get Pw(){return Object(Nl.a)()}static get tg(){return Be.a.instance}static get rc(){return null!=uy.VUg?uy.VUg:uy.VUg=Wa.a.instance.Oa("Box4.IFeatureHelper")}}Object(u.a)(uy,"AEnterViewStrategy",null,[1600]);class SM extends uy{constructor(b,h,r){super(b,h,r)}xrm(){return vb.a.vE}}
Object(u.a)(SM,"EnterViewStrategy",uy,[]);class TM{constructor(b){this.Rm=this.transaction=null;this.ge=b;this.IWc=this.fp=0}}Object(u.a)(TM,"SelectAllArguments",null,[]);class oC{constructor(b,h,r){this.R8n=b;this.Hzn=h;this.Yo=r;this.D4l=(A,L,Z)=>L.view.vj?this.Y7a(L,Z,this.uXj):this.oOo(L,Z);this.Xhd=(A,L)=>L.fp?1===L.fp?(L.ge.lb.lod(L.Rm,A),L.fp=2,!0):2===L.fp?(L.ge.lb.gb.e7a=L.Rm.e7a,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableScrollingOnSelectAll",!1)&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionAprIsEnabled",!1)&&(L.ge.Axc=!1),this.ih.uI(),L.transaction.FNa(A),L.fp=3,L.transaction.dispose(),db.a.mark(5799),!0):!1:(L.transaction=this.Yo.Lc(2),L.transaction.Ab(L.ge.vd),L.fp=1,!0);this.oOo=(A,L)=>{if(1===L)return 32;if(!A.view.ve)return 2;A=A.view;return A.lb&&A.lb.gb&&A.lb.gb.currentSelection?this.uXj(A).Dfa?1:32:8};this.uXj=A=>{A.vj&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");A=
new Tt.a(null,this.bjo,new TM(A));A.nm("SelectAllInOutline");A.run();return A};this.bjo=(A,L)=>{if(!L.fp)return L.Rm=qc.SelectionFactory.pOo(L.ge.lb.gb.currentSelection),L.transaction=this.Yo.Lc(2),L.transaction.Ab(L.ge.vd),L.fp=1,!0;if(1===L.fp){if(!L.IWc)return L.ge.lb.Kc(L.Rm.K(0),A),++L.IWc,!0;if(L.IWc<L.Rm.length)return L.ge.lb.KZk(L.Rm.K(L.IWc),A),++L.IWc,!0;L.fp=2}return 2===L.fp?(L.ge.lb.gb.e7a=L.Rm.e7a,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableScrollingOnSelectAll",
!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionAprIsEnabled",!1)&&(L.ge.Axc=!1),this.ih.uI(),L.transaction.FNa(A),L.fp=3,L.transaction.dispose(),!0):!1}}get ih(){return this.Hzn.value}Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.WDa,Gc.a.frame,oC.RTj);b.qa(vb.a.iAg,Gc.a.frame,oC.RTj);b.fb(vb.a.Y7a,kc.a.view,this.D4l,2);b.fb(vb.a.E5a,kc.a.view,Qf.AFrame.Qg,100);b.fb(vb.a.K8f,kc.a.view,oC.K8f,4)}Y7a(b,h,r){if(1===h)return 32;if(!b.view.ve)return 2;h=
b.view;if(!h.lb)return 8;const A=h.lb.gb;if(!A||!A.length)return 8;db.a.mark(5798);ab.StaticActiveAppFrame.za().kb.isEditingAllowed||ab.StaticActiveAppFrame.za().kb.Wz||h.vj?b=he.a.YKf(A):(Sg.FocusManager.instance().RE(Qf.AFrame.Do),b=qc.SelectionFactory.rKj(h.vd));if(!b)return 8;A.e7a||v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");r&&this.R8n.vTb(he.a.kwi(b))?r=r(h):(r=new TM(h),r.Rm=b,r=new Tt.a(null,this.Xhd,r),r.nm("ExpandSelection"),r.run());return r.Dfa?1:32}static get Edb(){return null!=
oC.h3g?oC.h3g:oC.h3g=Wa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static K8f(b,h,r){if(1===r)return 32;if(!h.view.ve)return 8;b=h.view;h=qc.SelectionFactory.qp(b.root.graphNode,!0);if(!h)return 8;b.lb.Kc(h);return 32}static RTj(){var b=ab.StaticActiveAppFrame.za().kb.Gw;if(!b.ve)return 2;if(b.ve&&1!==ab.StaticActiveAppFrame.za().state){db.a.mark(4668);var h=b.lb.gb.currentSelection;if(!h&&y.AFrameworkApplication.J.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=he.a.Pqa(h);let r=
h.x,A=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,A=b.y;oC.Edb.WDa(new Sys.UI.Point(r,A),1);db.a.mark(4669)}return 32}}Object(u.a)(oC,"SelectAllHandlers",null,[1580]);class tO{Twe(){}}Object(u.a)(tO,"FontNameFormattingStrategyNoop",null,[1583]);var gP=d(1049);class ML{constructor(b,h,r,A,L,Z){this.hWh=this.kWh=null;this.gt=b;this.gWh=h;this.Wdl=r;this.fel=A;this.kWh=L;this.hWh=Z}}Object(u.a)(ML,"BookmarkHighlightContext",
null,[]);class Gr extends hs.a{constructor(){super()}get Afa(){return!0}get Xrb(){return 5}get U9a(){if(null!=this.x5)return this.x5;this.x5=[];this.x5.push(new Nq.a(Mp.a.lTd,Mp.a.lTd));this.x5.push(new Nq.a(Mp.a.$jf,Mp.a.$jf));this.x5.push(new Nq.a(Mp.a.VTc,Mp.a.VTc));return this.x5}wMa(b,h){this.Afa&&Cq.a.instance.le(()=>{const r=this.vs.OIa;var A=this.vs.Qad;if(r)if(5===r.type){A=r.$B;if(r.VL&&r.VL.gt.includes(b))for(const L of h.WMa("*"))this.vs.BZa(L);A&&A.gt.includes(b)&&this.vyb(h,r.action,
A,b)}else A&&5===A.type&&3===r.action&&A.$B.gt.includes(b)&&this.vyb(h,0,A.$B,b)},"BHA:OPHC")}oXa(b){return Object(Gb.a)(ML,b)}p9a(b,h){if(b)for(const r of b.gt)h.add(r)}vyb(b,h,r,A){0===h&&b.htmlElement&&Cq.a.instance.le(()=>{const L=b.WMa("*"),Z=L.length,oa=Mp.a.lTd;var Ba=A.id===r.kWh,gb=A.id===r.hWh;let Ab=!1;var Jb=0,Tb=[];const jc=Array(Z);for(let Gd=0;Gd<Z;Gd++){var Hc=L[Gd];const de=Xp.a(Hc);jc[Gd]=de;const qe=Hc.classList;if(0!=jc[Gd]){const oe=!qe.contains(Mp.a.mI),ge=ii.a.Eb(Hc,Mp.a.ZKb);
ge&&Tb.push(...ge);if(Ba){let $d;if(($d=ii.a.Eb(Hc,Mp.a.nTd))&&ge&&1===$d.length&&1===ge.length&&$d[0].equals(ge[0]))continue;$d&&(Jb+=$d.length,1===de?qe.add(Mp.a.$jf):qe.add(oa));if(ge)for(const lf of ge)this.Fce(r,lf)&&(Jb--,Ab&&qe.add(Mp.a.VTc));0!==Jb&&oe&&qe.add(oa)}if(!Ba&&!gb&&r.fel.has(A.id))if((Hc=ii.a.Eb(Hc,Mp.a.ZKb))&&Ab){qe.add(oa);for(const $d of Hc)if(this.Fce(r,$d)){qe.add(Mp.a.VTc);break}}else oe&&qe.add(oa)}Ab=!qe.contains(Mp.a.M7a)}if(gb&&!Ba){Ba=new Set;for(var hd of Tb)this.Fce(r,
hd)&&Ba.add(hd);Ab=!1;for(Tb=0;0!==Ba.size&&Tb<Z;Tb++){Jb=L[Tb];hd=Jb.classList;if(0!=jc[Tb])if(gb=!1,Jb=ii.a.Eb(Jb,Mp.a.ZKb)){for(const Gd of Jb)this.Fce(r,Gd)&&(Ba.delete(Gd),gb=!0);0!==Ba.size&&hd.add(oa);Ab&&gb&&hd.add(Mp.a.VTc)}else hd.contains(Mp.a.mI)||hd.add(oa);Ab=!hd.contains(Mp.a.M7a)}}},"BHA:SPH")}Fce(b,h){for(const r of b.Wdl)if(h.equals(r))return!0;return!1}}Object(u.a)(Gr,"BookmarkHighlightActor",hs.a,[296]);var Hx=d(1918),FK;(function(b){b[b.Y6p=0]="jsonToDocumentXml";b[b.YXl=1]="documentXmlToJson";
b[b.ZXl=2]="documentXmlToThemeJson";b[b.yqq=3]="unsupported"})(FK||(FK={}));Object(u.b)("GraphicsEditorConversionRequestType",FK);var uO=d(1649);class NL{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.If=b;this.AG=h;this.hb=L;this.LY=Z;this.Dk=oa;this.ee=Ba;this.Fd=Ab;this.Aa=gb}vwg(b,h,r,A){const L=b.GLh(h);if(L){var Z=Object(Gb.a)(uO.a,b),oa=this.ee.Xf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",Z,r)),Ba=h.Lk.node,gb=()=>{r||this.Xzo(h.Lk,
L.getId())};Z=NL.vXh();A=this.TXh(L.getId().toString(),Ba,A,r);try{b.XRh(A,h)}catch(Ab){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Ab.message);this.qq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.If.Xj(Z,2,A.toString(),{},!0,0,Ab=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");
b.Gsc(Ab,L,()=>{this.qq(b.k8d())},gb,Ba,h,oa)},Ab=>{const Jb=415===Ab.data.He;let Tb="";Ab&&Ab.data&&Ab.data.wi&&"X-CorrelationId"in Ab.data.wi&&Ab.data.wi["X-CorrelationId"]&&(Tb=Ab.data.wi["X-CorrelationId"]);b.TU(`Graphics editor request failed. HttpStatus [${Ab.data.He}], CorrelationId [${Tb}]`,L,Ba,gb,()=>{this.qq(Jb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.k8d())},oa,Jb)},null)}else this.qq(b.k8d())}XPo(b,h,r){return new Promise((A,L)=>{var Z=b.Lk,oa=null;oa=
cm.a.oZf(Z)?Z.getContext(0).node:Z.node;Z=NL.vXh();oa=this.TXh(h.toString(),oa,r,!1);oa.Ae(Hx.a.frf,FK.ZXl.toString());this.If.Xj(Z,2,oa.toString(),{},!0,0,Ba=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");A(Ba.data.Pe)},Ba=>{v.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ba.data.He}`);this.qq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);
L(null)},null)})}TXh(b,h,r,A){const L=h.Hj(),Z=new qb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.Mja(Z);Z.Ae(Hx.a.EAe,this.lmn(h)?"true":"false");Z.Ae(Wj.a.nodeId,b);Z.Ae(Wj.a.cellId,L.il.toString());Z.Ae(Wj.a.fileId,L.Bq);Z.Ae(Wj.a.h_,r.toString());Z.Ae(Hx.a.l4l,A?"true":"false");if(b=!!this.Fd&&this.Fd.isFeatureEnabled(42)){Z.Ae(Ii.a.$sj,b.toString());if(b=this.Fd.isFeatureEnabled(82))Z.Ae(Ii.a.qco,b.toString()),Z.Ae(Ii.a.g4m,"true");this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",
!1)&&Z.Ae(Ii.a.Bco,"true")}Z.Ae(Ii.a.tVh,"true");Cm.a.instance.rKb(Z);return Z}lmn(b){if(!this.AG)return!1;b=this.AG.Iu(b);return!!b&&b.zf(Vc.a.c0f)}Xzo(b,h){b.cpBegin===b.cpEnd-1&&this.Dk.bvc(b.node,h,this.hb,this.LY)}qq(b){const h=new Ag.StandardDialog;h.Bd=0;h.Iy(le.a.cyf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);ab.StaticActiveAppFrame.za().Ge()}static vXh(){const b=new qb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");
y.AFrameworkApplication.Mja(b);return b.toString()}}Object(u.a)(NL,"GraphicsEditorRequestManager",null,[401]);class JI extends bC{constructor(b,h,r){super(b,h,r);this.uWa=vb.a.JR}p$a(b){null!=b&&0<b.length&&this.Pb.Qb(this.uWa,2,b[0])}Rdk(b,h,r,A){const L=kg.a.Eg(y.AFrameworkApplication.lcid).name;b=String.format(b,y.AFrameworkApplication.lcid,L,y.AFrameworkApplication.buildVersion,h,py.xIe,r);b+="&flipgrid=1&ted=1";y.AFrameworkApplication.$c("h1b04136;di786241");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OnlineMediaAccessibilityChangesEnabled",
!1)&&(b+="&resize_picker=1");A&&this.b2i()&&(A=new qb.QueryStringBuilder(b),A.SK("stream2","1"),y.AFrameworkApplication.J.$("GetCustomHeaderEnabled")&&A.SK("enablegetcustomheader","1"),b=A.toString());return b}b2i(){y.AFrameworkApplication.$c("EnableStream2VideosInsertion;EnableStream2VideosInsertioncf");y.AFrameworkApplication.$c("EnableStream2Videos;EnableStream2Videoscf");return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2VideosInsertion",
!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)?!0:!1}}Object(u.a)(JI,"InsertHubbleMediaHelper",bC,[]);class vO{constructor(b,h,r,A,L,Z,oa,Ba,gb){this.fFd=!1;this.ga=b;this.Aa=h;this.xDd=r;this.z1=A;this.HAd=L;this.xl=Z;this.Bok=Ba;this.Hnk=oa;this.rl=gb;this.z1.b2i()&&oa.isFeatureEnabled("OmgStreamTwo",!1).then(Ab=>{this.fFd=Ab;this.fFd||(this.lGh=oa.Cua("OmgStreamTwo",Jb=>{this.fFd=Jb.isEnabled}))})}dispose(){this.lGh&&this.Hnk.iZb("OmgStreamTwo",
this.lGh)}Xb(){const b=this.Z6n.bind(this);this.ga.fb(Ec.a.Wgg,kc.a.Vc,b,1028);const h=this.jbn.bind(this);this.ga.fb(Ec.a.RUf,kc.a.Vc,h,1028);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)&&(this.X3(Ec.a.Wgg,b),this.X3(Ec.a.RUf,h))}X3(b,h){this.ga.X3("word_insertOnlineVideos",!0,b,kc.a.Vc,h,r=>{ab.StaticActiveAppFrame.za()&&this.rl&&ab.StaticActiveAppFrame.za().m2b(r,this.rl.Dqb)})}jbn(b,h,r,A,L){if(1!==r){if(null==L)return 16;
if(!h.Al||!he.a.mf(h))return 2;b=this.hrm(L);L=L.OriginalUrl;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.HAd.wPg(b,h,L)}return 32}hkk(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}hrm(b){const h=new qA;h.MediaType=b.ContentType;
h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}Z6n(b,h,r){var A,L;if(1!==r)h=F.a.HT(this.Aa.jb("UserId")).toString(),h=this.z1.Rdk(this.Aa.appSettings.InsertVideoHubbleEndpoint,eb.a.create().toString(),h,this.fFd),this.z1.uWa=Ec.a.RUf,h=this.xDd.t3c(h,!0),h.correlationId=eb.a.create(),h.Ota=5,h.cze(null,this.z1,this.Bok),Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new da.a,
{name:"ActionId",int64:b})]})),this.hkk();else if(!(h&&h.node&&bw.a(h.node))||(null===(A=this.xl)||void 0===A?0:A.p2(h))||(null===(L=this.xl)||void 0===L?0:L.ama(h)))return 2;return 32}}Object(u.a)(vO,"OnlineMediaActor",null,[]);const hP={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net",
"https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class pC extends vF{constructor(b,h,r,A=null,L=!1){super(b,h,r,A,L);this.tIc=null;this.geg=()=>{this.Az&&(v.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!pC.dHa} time: ${(new Date).getTime()-this.ki}`),this.Az.sendMessage(K.a.nNj,{["CustomHeaders"]:pC.dHa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}V1c(){const b=
{};b.insertMediaServiceEndpoint=this.yDd;b.iFrameId="mediaiframe";return b}async cze(b,h,r){r&&(this.ki=(new Date).getTime(),Date.now()>pC.YHh&&await this.refreshToken(r));this.W5b=b;this.tIc=h;this.mHc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.V1c(),["componentIsVisibleCallback"]:this.Zhk.bind(this)};this.Uh(this.W5b,null,b)}Zhk(){this.r3=this.zjc(this.Bj("mediaiframe"));let b=this.yDd;if(y.AFrameworkApplication.J.$("NewInsertMediaServiceEndpoint")){var h=new URL(b);(h=hP[h.protocol+
"//"+h.host])?b=h:v.ULS.sendTraceTag(508937025,352,10,"Target URL not found")}this.Az=this.sJd.getInstance(this.r3.contentWindow,b);this.Az.Ur(K.a.mNh,r=>{this.Eij(r,this.tIc.p$a.bind(this.tIc))});this.Az.Ur(K.a.insert,r=>{this.vme(r,this.tIc.p$a.bind(this.tIc))});this.Az.Ur(K.a.JNh,this.Ylj.bind(this));this.Az.Ur(K.a.mwi,this.geg.bind(this));this.Az.Ur(K.a.getSessionId,this.Kkj.bind(this));this.Az.Ur(K.a.Yti,this.Jkj.bind(this));this.Az.Ur(K.a.kUd,this.qjj.bind(this));this.byb(3)}byb(b){const h=
[];h.push(Object.assign(new da.a,{name:"DialogResult",string:Cp[b]}));h.push(Object.assign(new da.a,{name:"DialogMode",string:this.BBi()}));h.push(Object.assign(new da.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new da.a,{name:"Provider",string:dw[this.Ota]||"Unknown"}));Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.tV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");
h.IsSuccess&&(pC.YHh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,pC.dHa=h.Token);v.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!pC.dHa} time: ${(new Date).getTime()-this.ki}`)}catch(h){v.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ki} error: ${h} `)}}}pC.YHh=0;Object(u.a)(pC,"OnlineMediaDialog",vF,[]);class wO{constructor(b,h){this.pVe=
b;this.z1=h}t3c(b,h=!1){return new pC(b,this.pVe,this.z1,null,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(wO,"OnlineMediaDialogFactory",null,[402]);class xO extends Gv{constructor(){super(1,3);this.bO=Wa.a.instance.resolve("Common.IReactContextualUILauncher");this.T_j=!1}ieb(){y.AFrameworkApplication.va.Ob(Ec.a.Mxc,2)}Y0d(){this.kpi&&!this.Bw&&(this.Bw=this.GQa())}L1d(){if(this.Bw&&this.Bw.isVisible){var b=Object(Ca.a)(Mk.a,this.Bw.controls["ExternalContentFloatie.FlyoutAnchor"]);
b.behavior.py(b.Kqb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute($c.a.zSd)||"",$c.a.DO===h&&b.click())}}f3(){return this.bO.f3}}Object(u.a)(xO,"ExternalContentFloatieManager",Gv,[]);class Hr{constructor(){Hr.c9m()}get Yb(){return null!=this.c7g?
this.c7g:this.c7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Fv(){return null}X1b(b){var h=null;if(!Cd.ParagraphReader.Fh(b))return{returnValue:!1,Iea:h};if((b=this.Yb.Cq(b.currentNode))&&2===this.Yb.JF(b)){const r=this.Yb.Be(b);Hr.tT.contains(r)&&(h=this.Yb.wL(b),h=Object.assign(new yC.a,{dG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Iea:h}}Gqb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static c9m(){Hr.tT=
new ln.a;Hr.tT.add(kk.StyleReader.styleIdHeading1);Hr.tT.add(kk.StyleReader.styleIdHeading2);Hr.tT.add(kk.StyleReader.styleIdHeading3);Hr.tT.add(kk.StyleReader.U0b);Hr.tT.add(kk.StyleReader.sqd);Hr.tT.add(kk.StyleReader.tqd);Hr.tT.add(kk.StyleReader.IAe);Hr.tT.add(kk.StyleReader.HAe);Hr.tT.add(kk.StyleReader.wordStyleIdHeading1);Hr.tT.add(kk.StyleReader.wordStyleIdHeading2);Hr.tT.add(kk.StyleReader.wordStyleIdHeading3);Hr.tT.add(kk.StyleReader.yBc);Hr.tT.add(kk.StyleReader.zBc);Hr.tT.add(kk.StyleReader.ABc);
Hr.tT.add(kk.StyleReader.lud);Hr.tT.add(kk.StyleReader.mud);Hr.tT.add(kk.StyleReader.nud);Hr.tT.add(kk.StyleReader.dBb);Hr.tT.add(kk.StyleReader.oud)}}Hr.tT=null;Object(u.a)(Hr,"ParagraphStyleDetailsProvider",null,[732,300]);class Uw{constructor(b,h,r,A){this.LQa=b;this.tDk=h;this.CDk=r;this.DDk=A}Lpg(){this.LQa.execute(b=>{b.aZb(this.tDk.value);b.aZb(new Hr);b.aZb(this.DDk.value);b.dY(this.CDk.value)})}}Object(u.a)(Uw,"AccessibilityActor",null,[]);class fL{constructor(b,h,r){this.Ai=null;this.ipd=
(A,L,Z)=>{if(1===Z)return 32;this.Ai=this.lGc.value.oDl(this.Zb);if(!this.Ai)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.Ai.y_a();return 32};this.hLh=A=>this.Ai?this.Ai.HXm(A):2;this.ga=b;this.lGc=h;this.Zb=r}Xb(){if(y.AFrameworkApplication.J.$("UIDiscoverabilityEnabled")){var b=Cb.KeyInputManager.oc(jf.a.qBb,5);this.Zb.ie(Qf.AFrame.Do).ot(b);this.Zb.ie(Qf.AFrame.Gq).bindAction(b,Za.a.ipd);this.ga.qa(Za.a.ipd,Gc.a.frame,this.ipd);this.ga.qa(Za.a.RRc,
Gc.a.frame,this.hLh);this.ga.qa(Za.a.QRc,Gc.a.frame,this.hLh)}}}Object(u.a)(fL,"AccessibilityHelpDialogActor",null,[]);var RF=d(1048),uM=d(1302);class gL{constructor(b,h){this.dyk=b.jc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.smk=RF.a.dH(26,5,new uM.a)}fY(){this.ga.fY(this)}E3(){}C3(b){const h=+b.endTime-+b.startTime;if(h>this.dyk){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=Vd.ActionManager.D$(b.actionId))&&b.length||(b="UnknownAction");this.smk.track(h,
b+"_"+r)}}}Object(u.a)(gL,"ActionHangDetector",null,[119]);var hL=d(2184);class SF extends lc{constructor(b,h=null){super(b,void 0,y.AFrameworkApplication.t7a,new jb(b,!1),void 0,void 0,h)}get rbb(){return this.pde?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get nqc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get wbd(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get VXc(){return y.AFrameworkApplication.t7a?
"UIFontDialogTextLarge":null}get pde(){return"VersionHistory"===this.HZh?!1:!y.AFrameworkApplication.ua.Gb.isBusinessUser&&!y.AFrameworkApplication.ua.Gb.isEduUser}Nhe(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}h5f(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}Ybd(){v.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");y.AFrameworkApplication.va.Ob(Za.a.Nhi,2)}}Object(u.a)(SF,"DownloadACopyDialog",lc,[]);var hG;(function(b){b[b.Unknown=
0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.IQp=7]="Publisher";b[b.YOp=8]="Infopath";b[b.fMp=9]="Access"})(hG||(hG={}));Object(u.b)("OfficeApplication",hG);var lE;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.dTp=2]="WriteOnly";b[b.yOp=3]="ForceCheckout";b[b.cTp=4]="WriteLocalCopy";b[b.hQp=5]="OpenInBrowser"})(lE||(lE={}));Object(u.b)("OpenDocumentMode",lE);
class KI extends Dg.a{constructor(){super(!1,!1,!0)}coe(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};
h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Uh("Send feedback to Microsoft",this.LXo.bind(this),b);return new Promise(r=>{this.xGk=r})}LXo(b,h){1===b&&this.Gha(h.selectedReason)}dispose(){super.dispose();this.xGk()}Gha(b){const h={},r={},A={},L={},Z={};h.appId=2155;h.manifestType="Fps";
h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=eb.a.create().toString();Z.reason=b;const oa={},Ba={numberOfOptions:5};Ba.selectedRating=b;oa.rating=[Ba];L.surveySpecificData=JSON.stringify(oa);A.extendedManifestData=JSON.stringify(L);h.application=A;Z.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=Z;h.telemetry=this.wLb();h.web=this.jUc();r["Content-Type"]="application/json";this.ZMa(JSON.stringify(h),r)}jea(b,h,r,A){h&&b&&A&&r&&A in h&&(b[r]=
h[A])}wLb(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=y.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.jea(h,b,"audienceGroup","AudienceGroup");this.jea(h,b,"osBuild","OsVersion");this.jea(h,b,"platform","Platform");this.jea(h,b,"processSessionId","WACSessionID");return h}jUc(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};this.jea(h,b,"browser","Browser");this.jea(h,b,"browserVersion","BrowserVersion");this.jea(h,b,"dataCenter",
"WACDatacenter");return h}ZMa(b,h,r=0){let A=0;3<r||(1===r?A=200:1<r&&(A=200+500*(r-1)),y.AFrameworkApplication.pc.$b(new mf.a(2,1,A,()=>{y.AFrameworkApplication.Fe.Xj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.ZMa(b,h,r+1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(u.a)(KI,"WordOpenInClientFeedbackDialog",
Dg.a,[]);var Bz=d(1363),LI=d(2179);const uC=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},GK=b=>b.Lb.keyCode===jf.a.Pu||b.Lb.keyCode===jf.a.B0a?(b.Df.click(),!0):!1,TF=(b,h,r,A,L,Z,oa)=>{const Ba=document.createElement("a");Ba.className="ProtocolLaunchingDialogButtonAnchor";Ba.className+=" OICDialog";Ba.id=b;Ba.setAttribute($c.a.Wh,$c.a.N$);Ba.style.padding="0";Ba.style.margin="0";A&&AM(L,
h,r,A,Ba);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=L;Ba.appendChild(b);Ba.tabIndex=0;Z&&jg.a.instance.ub(od.a.click,Ba,Z);oa&&Cb.KeyInputManager.instance.ub(od.a.gi,Ba,oa);return Ba},AM=(b,h,r,A,L)=>{var Z=document.createElement("img");Z.alt=b;Z.className=Pb.getImageClassWithCluster(r,A);Z.src=h;Z.setAttribute($c.a.Wh,$c.a.xA);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(Z);Z=document.createElement("span");
Z.className="ProtocolLaunchingDialogIconContainer";Z.appendChild(b);L.appendChild(Z)};class UF{static get mh(){return Dg.a.uy(UF.lo,CommonUIStrings.l_OICLaunchDialogTitle)}}UF.lo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(UF,"OICLaunchDialogHtml",null,[]);class UM extends Dg.a{constructor(b){super();this.t4b=this.eCb=null;this.TV=!1;this.lnj=()=>{this.hide();this.xo.wvc();return!0};this.rnj=()=>{v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();y.AFrameworkApplication.va.Ob(Za.a.GZb,2);return!0};this.fVn=()=>{this.xo.wvc()};this.xo=b;this.mh=UF.mh;this.Bd=5;this.Ig="OICLaunchDialog";this.showDialog("",this.fVn);this.pOj();this.x8("ProtocolLaunchingDialogTitle");4!==y.AFrameworkApplication.ua.Gb.FUa&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.e4(this.eCb);v.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Jba(){this.eCb=TF("BtnRichClient",this.xo.Fgc,this.xo.lmc,this.xo.mTf,CommonUIStrings.l_OICLaunchRichClient,this.rnj,GK);document.getElementById("OICLaunchRichClient").appendChild(this.eCb);uC(this.eCb);this.t4b=TF("BtnReturn",this.xo.Fgc,
this.xo.lmc,this.xo.QPi,CommonUIStrings.l_OICReturnToOnlineClient,this.lnj,GK);document.getElementById("OICReturnToApp").appendChild(this.t4b);uC(this.t4b)}dispose(){this.TV||(this.eCb&&(jg.a.instance.xc(od.a.click,this.eCb,this.rnj),Cb.KeyInputManager.instance.xc(od.a.gi,this.eCb,GK)),this.t4b&&(jg.a.instance.xc(od.a.click,this.t4b,this.lnj),Cb.KeyInputManager.instance.xc(od.a.gi,this.t4b,GK)),super.dispose(),this.TV=!0)}}Object(u.a)(UM,"OICLaunchDialog",Dg.a,[]);class mE{static get mh(){return 0!==
y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.Excel.PromoteOpenInDesktop",0)?Dg.a.uy(mE.BTl,CommonUIStrings.l_OICDialogTitle):Dg.a.uy(mE.lo,CommonUIStrings.l_OICDialogTitle)}}mE.lo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
mE.BTl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'></div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonDownloadClientApp'> <div id='ProtocolHandlerDialogDownloadClientApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(mE,"ProtocolLaunchingDialogV2Html",null,[]);class MI extends Dg.a{constructor(b){super();this.r4b=this.s4b=this.f1a=null;this.TV=!1;this.Lgb=null;this.tkj=h=>this.yle(h,0);this.jkj=h=>this.yle(h,3);this.Mkj=h=>this.yle(h,2);this.knj=h=>this.yle(h,1);this.qkj=()=>{this.hide();4===y.AFrameworkApplication.ua.Gb.FUa?(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.xo.wvc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.xo.p5c());
return!0};this.ikj=()=>{v.ULS.sendTraceTag(0,211,50,"Open download client app page");return!0};this.gme=()=>{v.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0};this.hne=()=>{v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";y.AFrameworkApplication.va.Ob(Za.a.GZb,2);return!0};this.Emg=()=>{this.xo.wvc()};this.xo=b;this.mh=mE.mh;this.Bd=5;this.Ig="ProtocolLaunchingDialog";this.MFc="OICRetryDialog";y.AFrameworkApplication.pc.Orb&&
y.AFrameworkApplication.pc.restart();y.AFrameworkApplication.pc.$b(new mf.a(2,1,5E3,()=>{this.fhp()},101));this.showDialog("",this.Emg);this.pOj();this.x8("Issues");this.Cpi();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Jba(){const b=document.getElementById("Issues");if(b){AM("",this.xo.Fgc,this.xo.lmc,this.xo.mTf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.xo.lpj?
CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);uC(b);b.style.display="none"}0!==y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.Excel.PromoteOpenInDesktop",0)&&(this.r4b=TF("DownloadClientApp",this.xo.Fgc,this.xo.lmc,"",CommonUIStrings.l_OICDialogSectionDownloadClientApp,this.ikj,this.jkj),document.getElementById("ProtocolHandlerDialogDownloadClientApp").appendChild(this.r4b),uC(this.r4b));y.AFrameworkApplication.ua.Gb.uKi?(this.s4b=
TF("GiveFeedback",this.xo.Fgc,this.xo.lmc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,this.gme,this.Mkj),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.s4b),uC(this.s4b)):document.getElementById("ButtonGiveFeedback").style.display="none";0===y.AFrameworkApplication.ua.Gb.FUa||y.AFrameworkApplication.AUl?document.getElementById("ButtonEdit").style.display="none":(this.f1a=TF("Edit",this.xo.Fgc,this.xo.lmc,"",2===y.AFrameworkApplication.ua.Gb.Mk?4===y.AFrameworkApplication.ua.Gb.FUa?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===y.AFrameworkApplication.ua.Gb.FUa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this.qkj,this.tkj),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.f1a),uC(this.f1a));0===y.AFrameworkApplication.ua.Gb.FUa&&!y.AFrameworkApplication.CZf&&b&&(b.style.display="none")}Dpi(){return this.Lgb?(this.e4(this.Lgb),!0):!1}Cpi(){return this.f1a?(this.e4(this.f1a),!0):!1}yle(b,
h){let r=!1;if(b.Lb.keyCode===jf.a.Pu||b.Lb.keyCode===jf.a.B0a)b.Df.click(),r=!0;else if(b.Lb.keyCode===Sys.UI.Key.down||b.Lb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.Cpi();break;case 0:r=this.Dpi()}return r}Jeg(){eJ.Redirect.showHelp("OICFailure");return!0}fhp(){var b=document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!b.children.length&&(this.Lgb=TF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,this.hne,this.knj),b.appendChild(this.Lgb),uC(this.Lgb),this.f1a||this.Dpi())}}dispose(){this.TV||(this.f1a&&(jg.a.instance.xc(od.a.click,this.f1a,this.qkj),Cb.KeyInputManager.instance.xc(od.a.gi,this.f1a,this.tkj)),this.r4b&&(jg.a.instance.xc(od.a.click,this.r4b,this.ikj),Cb.KeyInputManager.instance.xc(od.a.gi,this.r4b,this.jkj)),this.s4b&&(jg.a.instance.xc(od.a.click,this.s4b,this.gme),Cb.KeyInputManager.instance.xc(od.a.gi,
this.s4b,this.Mkj)),this.Lgb&&(jg.a.instance.xc(od.a.click,this.Lgb,this.hne),Cb.KeyInputManager.instance.xc(od.a.gi,this.Lgb,this.knj)),super.dispose(),this.TV=!0)}}Object(u.a)(MI,"ProtocolLaunchingDialog",Dg.a,[]);class HK extends Ag.StandardDialog{constructor(b){super();this.gme=h=>{v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.ykj(h)};this.hne=()=>{v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");y.AFrameworkApplication.va.Ob(Za.a.GZb,2)};this.Emg=h=>{HK.EMi?3===
h?this.jHj():2===h||0===h?this.h7h():1===h&&this.Dec():2===h?this.jHj():(1===h||0===h)&&this.h7h()};this.xo=b;this.Ig="ProtocolLaunchingDialog";y.AFrameworkApplication.pc.Orb&&y.AFrameworkApplication.pc.restart();y.AFrameworkApplication.ua.Gb.uKi&&this.OWk(this.gme);HK.EMi?(this.Bd=12,this.Ke(1,CommonUIStrings.l_CloseFile),this.Ke(2,CommonUIStrings.l_OICDialogContinueHere),this.Ke(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Bd=4,this.Ke(1,CommonUIStrings.l_OICDialogContinueHere),this.Ke(2,CommonUIStrings.l_OICDialogLaunchAgain));
this.bvb(CommonUIStrings.l_OICDialog2ndTitle,5===this.xo.lpj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,this.Emg,null)}Dec(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");y.AFrameworkApplication.va.Qb(Za.a.close,2,yk.a)}jHj(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.hne,0)}h7h(){4===y.AFrameworkApplication.ua.Gb.FUa||y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&
1===y.AFrameworkApplication.ua.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.xo.wvc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.xo.p5c())}static get EMi(){return y.AFrameworkApplication.J.$("OICDialogThreeActions")&&32===y.AFrameworkApplication.va.Ob(Za.a.close,1)}}Object(u.a)(HK,"StandardProtocolLaunchingDialog",Ag.StandardDialog,[]);class VM{}Object(u.a)(VM,"EditDocumentInClientParams",null,[]);class iL{static jii(b,h,r,
A,L,Z,oa=!1,Ba=!1,gb="",Ab=!1,Jb=!1,Tb=!1,jc="",Hc="",hd="",Gd=""){const de=new VM;de.DocumentUrl=b;de.DocumentExtension=Gd;de.Mode=h;de.Options=r;de.Application=A;de.SilentExternalHandler=oa;de.EncodeUrl=Ba;de.CorrelationIdForWinClient=gb;de.NavigateUsingWindowOpen=Ab;de.DescriptiveUnattemptedEnums=Jb;de.NoBrowserModalDialogs=Tb;de.SessionOrigin=jc;de.CorrelationId=Hc;de.ClickTime=hd;MSOJS.ClientUtils.EditDocumentInClient(de,L,Z)}}Object(u.a)(iL,"ClientUtils",null,[]);var bO=d(558),WM=d(956);class aE{constructor(b){this.M3a=
this.IGc=this.HEc=null;this.OHc=!1;this.LPe=this.o_e=this.vwh=null;this.Bxd=this.lA=this.VLd="";this.application=this.GC=0;this.Ogp=this.dFg=!1;this.dJo=(h,r,A)=>r.contextId!==Gc.a.frame?2:1===A?32:this.GZb();this.oij=()=>{this.Aof()};this.pij=()=>{this.wvc()};this.nlj=()=>{this.M5i()};this.M3m=()=>this.Ofi(!0);this.lDp=b&&y.AFrameworkApplication.J.$("OICLaunchDialogIsEnabled");y.AFrameworkApplication.va.t_(Za.a.GZb)||y.AFrameworkApplication.va.qa(Za.a.GZb,Gc.a.frame,this.dJo);this.uVj=!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("SilentExternalHandler")}get lpj(){return this.GC}F_o(b,h="",r=""){this.lA=r||eb.a.create().toString();this.VLd=h||bO.a.vCi();this.Bxd=b}get options(){let b=0;y.AFrameworkApplication.sGo&&(b|=1);y.AFrameworkApplication.tpj&&(b|=4);this.Igp()&&(b|=64);return b}Igp(){return!(2===this.application&&y.AFrameworkApplication.J.$("IsEmbeddedScenario"))}get Fgc(){return y.AFrameworkApplication.Lr}get lmc(){return y.AFrameworkApplication.Bfa}get QPi(){return""}get mTf(){return""}get Ngp(){return y.AFrameworkApplication.J.$("OneNoteMobileViewerIsEnabled")}get Dkp(){return this.vwh||
(this.vwh=Wa.a.instance.resolve("Common.IOfficeTrialExperience"))}Aof(){this.dFg||this.D3l()}wvc(){this.Ogp||this.Nli()}Nyj(b){return this.lDp&&aa.a.Di?(new UM(this),32):this.g5h(b)}g5h(b){const h=({pAb:b}=this.Lyn(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Dc(b,h,r,A,L,Z,oa=""){this.HEc=b;this.LPe=oa;this.IGc=h;this.M3a=Z;this.application=r;this.GC=A;return y.AFrameworkApplication.Uhi?(this.M5i(),32):y.AFrameworkApplication.Bta&&!y.AFrameworkApplication.BOi?
(y.AFrameworkApplication.nCg(),8):this.DVh(L)}get eVn(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}GZb(){this.eVn&&this.zDn();return this.g5h(this.OHc)}DLj(){const b=new WM.a(K.a.QX);b.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();b.Values[cz.a.Pbi]=y.AFrameworkApplication.userSessionId;return this.M3a.value.send(b)?32:8}zDn(){xa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Na.a,{inStaging:!1}))}OQo(b){const h=new WM.a(K.a.nGp);h.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();h.Values[cz.a.Pbi]=y.AFrameworkApplication.userSessionId;h.Values[G.a.mGp]=b;this.M3a.value.send(h)}Lyn(b){this.OHc=b;this.OQo(5===this.GC?aE.I6n:aE.O6n);return 5===this.GC?this.Kyn():this.Oyn()}Kyn(){this.W5i();return{returnValue:32,pAb:"HostEditUrl,"}}Oyn(){let b;var h=b="";y.AFrameworkApplication.mOh&&(h="|f|"+y.AFrameworkApplication.userSessionId);
const r=y.AFrameworkApplication.J.$("IsAssignmentMode")&&y.AFrameworkApplication.J.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||y.AFrameworkApplication.iad||aa.a.mXa,A=y.AFrameworkApplication.J.$("UnattemptedEnumIsEnabled"),L=y.AFrameworkApplication.J.$("NoBrowserModalDialogs");var Z=y.AFrameworkApplication.va.bP(3588168074);Z&&this.F_o(Z.epochClickTime,Z.sessionOrigin,Z.correlationId);this.E$i();if(y.AFrameworkApplication.ouj){b+="NewOrder,";Z=8;this.M3a&&this.M3a.value&&this.M3a.value.isEnabled()&&
y.AFrameworkApplication.C2b&&(b+="Post,",Z=this.DLj());if(32===Z)return{returnValue:Z,pAb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return y.AFrameworkApplication.Et.Rba?(v.ULS.shipAssertTag(5566816,211,!!y.AFrameworkApplication.Et.Rba),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ua.MX(!0,y.AFrameworkApplication.Et.Rba),pAb:b}):this.HEc?(v.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId),
b+="DocUrl,",iL.jii(this.HEc,this.GC,this.options,this.application,Object(D.a)(this,this.skj,"onEditInClientSuccess"),Object(D.a)(this,this.rkj,"onEditInClientFailure"),this.uVj,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,L,this.VLd,this.lA,this.Bxd,this.LPe),{returnValue:32,pAb:b}):{returnValue:8,pAb:b}}b+="OldOrder,";if(!this.HEc&&y.AFrameworkApplication.Et.Rba)return this.M3a&&this.M3a.value&&this.M3a.value.isEnabled()&&y.AFrameworkApplication.C2b?(b+="Post,",h=this.DLj()):(v.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(v.ULS.shipAssertTag(22595484,211,!!y.AFrameworkApplication.Et.Rba),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ua.MX(!0,y.AFrameworkApplication.Et.Rba),pAb:b}):{returnValue:h,pAb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId);b+="DocUrl,";iL.jii(this.HEc,this.GC,this.options,this.application,Object(D.a)(this,this.skj,"onEditInClientSuccess"),
Object(D.a)(this,this.rkj,"onEditInClientFailure"),this.uVj,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,L,this.VLd,this.lA,this.Bxd,this.LPe);return{returnValue:32,pAb:b}}sFo(b){y.AFrameworkApplication.Bn.setDw(8981,b)}skj(b){this.sFo(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Ngp||this.W5i(),this.E$i()):this.dFg||this.Aof()}rkj(b,h=0){v.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",
b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.IGc&&!this.OHc;let A=0;1===b&&(A=2);6<=b&&13>=b&&(A=1,1===h&&(this.dFg=!0));this.Dkp.QUn?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",A),LI.a.instance.wIl(this.OHc?this.oij:this.pij,r?this.nlj:null,this.Ofi(!1)?this.M3m:null,A,h)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",A),LI.a.instance.uIl(this.OHc?this.oij:this.pij,r?this.nlj:null,
A))}}E$i(){try{const b=[Object.assign(new da.a,{name:"CorrelationId",string:this.lA}),Object.assign(new da.a,{name:"SessionOrigin",string:this.VLd}),Object.assign(new da.a,{name:"ClickTime",string:this.Bxd}),Object.assign(new da.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];me.a("OpenInClientCompleted",!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}W5i(){y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.kH&&y.AFrameworkApplication.J.$("StandardProtocolDialogIsEnabled")?
new HK(this):new MI(this)}Ofi(b){const h=(aa.a.z9c||aa.a.au)&&!!y.AFrameworkApplication.h_d;h&&b&&(rd.a.Tm(y.AFrameworkApplication.h_d,"_blank",void 0,"OpenInClient"),this.Aof());return h}}aE.O6n="OpenInDesktop";aE.I6n="OpenInBrowser";Object(u.a)(aE,"AOpenInClientOperation",null,[]);class vz extends aE{constructor(b,h,r=!1){super(r);this.ozk=b;this.nzk=h}get QPi(){return this.nzk}get mTf(){return this.ozk}D3l(){y.AFrameworkApplication.va.Qb(Za.a.close,2,yk.a)}Nli(){}DVh(b){return this.Nyj(b)}M5i(){v.ULS.shipAssertTag(5566817,
211,!!this.IGc);y.AFrameworkApplication.Qfa?y.AFrameworkApplication.ua.MX(!0,this.IGc):rd.a.Tm(this.IGc,void 0,void 0,"LaunchDownload")}p5c(){y.AFrameworkApplication.ua.Gb.p5c()}}Object(u.a)(vz,"OpenInClientOperation",aE,[]);class vM extends vz{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.wyo=b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");ed.a.Ana?ed.a.Bk.jkd(!1,"OpenInWordOperation").then(()=>{this.Xgg(b)}).catch(()=>{this.y9i(b,
-1)}).finally(()=>{v.ULS.sendTraceTag(508077649,211,15,"Kick out session after open in desktop.");cc.SessionStatusManager.instance.Kpc()}):ed.a.rV.nE(this.Xgg,this.y9i,b)};this.y9i=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new Ag.StandardDialog;h.Bd=0;h.Iy(le.a.wtp,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.YCn:this.ZCn)};this.YCn=()=>{y.AFrameworkApplication.va.Qb(Za.a.close,2,yk.c)};this.ZCn=()=>{ab.StaticActiveAppFrame.za().eca(null)};
this.Xgg=b=>{y.AFrameworkApplication.Fqd=!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.Nyj(b)}}Tcl(b){ed.a.jf.Dbb.qmc||pf.a.xd().ZE.$o?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.Xgg(b)):Ty.a.iU(Bz.a.ypj,!0,this.wyo,null,b)}DVh(b){this.Tcl(b);return 32}Nli(){ab.StaticActiveAppFrame.za().eca(null)}}Object(u.a)(vM,"OpenInWordOperation",vz,[]);const NI=(b,h)=>{v.ULS.sendTraceTag(41186076,306,
50,"Toggling readonly recommended setting for the document.");b[Tg.a.On]=pl.PageReader.instance.qw(h);pl.PageReader.instance.qw(h)?b[Tg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Tg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},cO=(b,h,r,A,L)=>{if(!ab.StaticActiveAppFrame.za()||!ab.StaticActiveAppFrame.za().kb||!y.AFrameworkApplication.sn.qqb)return 8;h=ab.StaticActiveAppFrame.za().kb.hd;if(!h)return 8;if(b===vb.a.Qqe&&2===r){b=new Sb.GraphTransaction(15);
try{b.Ab(h),pl.PageReader.instance.Dmp(h)}finally{b&&b.dispose()}NI(L,h)}return 32},dO=(b,h,r,A,L)=>{if(!ab.StaticActiveAppFrame.za()||!ab.StaticActiveAppFrame.za().kb)return 8;b=ab.StaticActiveAppFrame.za().kb.hd;if(!b)return 8;L[Tg.a.Alt]=y.AFrameworkApplication.sn.qqb?"":CommonUIStrings.l_ProtectDocumentToolTip;NI(L,b);return 32};var eO=d(1100),wM=d(708);class xM extends hL.a{constructor(b,h){super(b,h);this.ieh=this.JJh=this.Nqh=this.Mqh=this.Fph=!1;this.NSc=new nb.a("docx doc docm dot dotx odt dotm".split(" "));
this.Qcd=100;this.DQl="949ada80-0026-4db3-a953-c99083e6a84f";this.uQl=500;this.Wlj=(r,A,L,Z,oa)=>{var Ba;if(A.contextId!==Gc.a.frame)return 2;if(!(ed.a.DVc||y.AFrameworkApplication.Et.Rba||y.AFrameworkApplication.C2b||this.Fph))return v.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.Fph=!0,8;if(1===L)return cc.SessionStatusManager.instance.Jk?8:32;let gb=!1;void 0!==oa&&null!==oa&&(gb=oa);if(null===(Ba=y.AFrameworkApplication.J)||void 0===Ba?0:Ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",
!1))(new KI).coe().then(()=>this.openDocument(r,gb));else return this.openDocument(r,gb);return 32};this.VEe=(r,A,L)=>{if(1==L){if(!eO.a.JWe)return this.Mqh||(v.ULS.sendTraceTag(508703937,231,50,"Open files from PC is shown as disabled"),this.Mqh=!0),64;if(!y.AFrameworkApplication.Fe.$td)return this.Nqh||(v.ULS.sendTraceTag(508598026,231,50,"Open files from PC is shown as disabled due to empty token"),this.Nqh=!0),64}else if(2==L)return me.a("OpenFileFromPC"),(r=this.pKl())?this.J8o(L,r):2;return 32};
this.JZd=(r,A,L)=>{if(1==L){if(!y.AFrameworkApplication.J.$("IsDocumentOwner"))return this.JJh||(v.ULS.sendTraceTag(508121345,306,50,"User is not document owner"),this.JJh=!0),8;this.ieh||(v.ULS.sendTraceTag(508118243,306,50,"Delete Document is enabled"),this.ieh=!0);return 32}if(2==L)return r=new Ag.StandardDialog,r.Bd=1,r.maxWidth=this.uQl,r.Ke(1,WordEditorIntl.WordEditorStrings.L_DeleteFileConfirmationDialogPrimaryButton),r.KQd(WordEditorIntl.WordEditorStrings.L_LearnMore,this.DQl),r.lV(WordEditorIntl.WordEditorStrings.L_DeleteFileConfirmationDialogTitle,
WordEditorIntl.WordEditorStrings.L_DeleteFileConfirmationDialogDescription,Z=>{1===Z&&(v.ULS.sendTraceTag(508118241,306,50,"Confirmed Delete Document request"),this.KPo())}),32};this.FWl=r=>{this.nEn();if(!y.AFrameworkApplication.iad&&y.AFrameworkApplication.ua.Gb.tAg(Za.a.Tea.toString()))this.KDa(!0,K.a.download,!0,{});else if(y.AFrameworkApplication.J.$("WordEditorDownloadACopyUiIsEnabled")){let A=y.AFrameworkApplication.ZNb,L=null;r&&(r.FileDownloadUrl&&(A=r.FileDownloadUrl.toString()),r.CallSource&&
(L=r.CallSource.toString()));new SF(A,L)}else super.Tea(0,null,2,null,null)};this.Zkl=r=>{super.workflow(0,null,2,null,r)};this.N5=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback")}get GUf(){this.Omh||(this.Omh=Wa.a.instance.resolve("Common.IInsertFileUploader"));return this.Omh}get WSd(){this.HS||(this.HS=new Sq.a);return this.HS}Xb(){super.Xb();this.ga.qa(vb.a.QX,Gc.a.frame,this.Wlj);this.ga.Pc(vb.a.QX,12288);var b=this.ga;b.fb(vb.a.Qqe,kc.a.application,cO,4);b.fb(vb.a.Nng,kc.a.application,dO,
96);this.ga.qa(Za.a.Rgg,Gc.a.frame,this.Wlj);this.ga.qa(vb.a.P9j,kc.a.view,this.VEe);this.ga.qa(vb.a.Q9j,kc.a.view,this.VEe);this.ga.qa(vb.a.JZd,kc.a.view,this.JZd)}openDocument(b,h){v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new vM).Dc(ed.a.DVc,y.AFrameworkApplication.ZNb,hG.Word,b===Za.a.Rgg?lE.OpenInBrowser:lE.WriteOnly,h,new rg.a(()=>this.N_))}YSd(b){return yi.a.instance.dIa()?!0:ab.StaticActiveAppFrame.za().$Ij(Bz.a.Dec,Hu.a.Vtl,b)}pKl(){return()=>
{window.addEventListener("fileUploadedSuccessfully",this.rpp,{once:!0});this.GUf.bXo(this.Qcd);this.GUf.eSo(this.NSc);this.GUf.showDialog()}}J8o(b,h){return 2===b?(h(),32):2}rpp(){window.addEventListener("focus",()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");null!=b&&b.execute(h=>{me.a("triggerUploadFileFeatureSurvey");h.logActivity("UploadFileFeatureSurvey","UploadFileFloodgateSurveyIsEnabled")})},{once:!0})}async KPo(){var b=await Object(wM.c)(ed.a.Pha,{fileId:y.AFrameworkApplication.rootQuerySignature,
xm:ed.a.sn.ude,Xab:void 0});0==b.response.StatusCode?(v.ULS.sendTraceTag(508118240,306,50,"Document deleted successfully"),rd.a.Tm("https://word.office.com","_top")):(v.ULS.sendTraceTag(508118239,306,50,"Error in Deleting Document with StatusCode {0}",b.response.StatusCode),b=new Ag.StandardDialog,b.Bd=0,b.Ke(1,WordEditorIntl.WordEditorStrings.L_DeleteFileErrorDialogPrimaryButton),b.sw(WordEditorIntl.WordEditorStrings.L_DeleteFileErrorDialogTitle,WordEditorIntl.WordEditorStrings.L_DeleteFileErrorDialogDescription,
0))}Tea(b,h,r,A,L){if(2===r){if(!y.AFrameworkApplication.ZNb&&!y.AFrameworkApplication.ua.Gb.tAg(Za.a.Tea.toString()))return 8;Ty.a.iU(Bz.a.Tea,!0,this.FWl,null,L);return 32}return super.Tea(b,h,r,A,L)}nEn(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.N5&&this.N5.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,A,L){return 2===r?
(Ty.a.iU(Bz.a.workflow,!0,this.Zkl,null,L),32):super.workflow(b,h,r,A,L)}}Object(u.a)(xM,"AppFrameCommandUIActor",hL.a,[]);class yM extends Ag.StandardDialog{constructor(){super();this.Bd=0;this.bvb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(u.a)(yM,"WheresTheSaveButtonDialog",Ag.StandardDialog,[]);const IK=(b,h,r)=>{if(1===r)return 32;
new yM;return 32};var OL=d(560),XM=d(1379);class Av extends hl.a{constructor(b,h,r,A,L=null){super();this.M7=L;this.hpk=56;this.ANc="px";this.ADc="aria-label";this.BPa="BookmarkIndicator";this.blh="HighlightBookmarkedContent";this.zyk="HighlightBookmark";this.m2a="wwaengidc";this.hel="Bookmark_24";this.hb=b;this.$g=h;this.dZ=r;(this.pB=A)&&this.pB.gRd(this.mH.bind(this))}T2o(b){if(b.Ij){for(const h of b.Zf.uj)if(this.cSj(h))return!0;return!1}return this.cSj(b.htmlElement)}u_a(b){let h=!1;Cq.a.instance.le(()=>
{h=this.T2o(b)},"BIA:SCIVE");return h}cSj(b){return Av.U7e?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}fUa(b){const h=[];Cq.a.instance.le(()=>{const r=b.g6a(0,this.hpk,this.zoom);h.push(this.Mea(b.I3,r,b.nBc[0].y-b.r7[0].y))},"BIA:CIs");return h}Mea(b,h,r){const A=b.Kh.ownerDocument,L=oo.a.createElement(A,po.a.div);L.className=Av.kpk;Av.g$g;L.style.left=h+this.ANc;L.style.top=r+this.ANc;h=oo.a.createElement(A,po.a.div);eg.a("renderIcon")&&
appChrome.api.renderIcon(this.hel,h);h.setAttribute("role","img");h.setAttribute("alt","Bookmark");h.title="Bookmark";h.setAttribute(this.ADc,"Bookmark");L.appendChild(h);b={context:new ML([],L,new Set,new Set,null,null),kcg:b,container:L};this.$g.LI(od.a.click,L,this.Zta.bind(this),b);return L}tVd(){const b=Object.assign(new yn.a,{action:1,type:5,$B:null,VL:this.sia});this.sia=null;this.dZ.vH(b)}mH(b,h){this.sia&&(h.U7a.Df.classList.contains("BookmarkHighlightSelected")||this.tVd())}Zta(b){this.Rcb(this.blh,
this.zyk);if(null==b){var h=new Map;h.set("Source",this.BPa);h=Object.assign(new Na.a,{additionalValues:h});xa.Health.instance.recordKpiFailure(this.blh,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.uq.context;if(Av.oab(h,this.sia))return!0;h=this.oJf(b.uq.kcg,h,b.uq.container);b=Object.assign(new yn.a,{action:0,type:5,$B:h,VL:this.sia});this.sia=h;this.dZ.vH(b);return!0}oJf(b,h,r){h={iWh:new Set,jXb:new Set,lWh:null,Zjf:null};const A=this.hb.Kv(b.Cb,!0,!1),L=[];if(A)for(const Z of A)L.push(Z);
this.JYk(b,h,L);h=new ML(L,r,h.iWh,h.jXb,h.lWh,h.Zjf);this.sia&&this.sia.gt===L&&(r.className+=String.format(" {0}",Av.gpk),this.sia=h);return h}JYk(b,h,r){var A;if(b.Ij){var L=new Set;for(const oa of b.Zf.uj)oa.querySelectorAll("*").forEach(L.add,L);b=Array.from(L.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let Z=[];h.jXb.add(r[0].id);h.lWh=r[0].id;h.Zjf=r[0].id;b.forEach(oa=>{const Ba=ii.a.Eb(oa,Mp.a.nTd);if(Ba)for(const gb of Ba)Z.push(gb),h.iWh.add(gb);if(!Z.length)return!0;
oa=ii.a.Eb(oa,Mp.a.ZKb);if(!oa)return!0;Z=XM.a.$uc(Z,oa)});for(b=this.hb.pg(r[r.length-1],!1,!0);Z.length&&b;)h.jXb.add(b.id),h.Zjf=b.id,r.push(b),L=this.M7.value.jm(b),L=null===(A=null===L||void 0===L?void 0:L.htmlElement)||void 0===A?void 0:A.querySelectorAll("."+Mp.a.Yjf),null===L||void 0===L?void 0:L.forEach(oa=>{(oa=ii.a.Eb(oa,Mp.a.ZKb))&&(Z=XM.a.$uc(Z,oa))}),b=this.hb.pg(b,!1,!0)}Rcb(b,h){const r=new Map;r.set("Source",this.BPa);r.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.m2a,
r)}static oab(b,h){return!!h&&!!b&&b.gWh===h.gWh}}Av.gpk="WordBookmarkIndicatorContainerSelected";Av.U7e=!0;Av.g$g="WordBookmarkIndicatorContainer";Av.kpk="WordBookmarkSvgIndicatorContainer";Object(u.a)(Av,"BookmarkIndicatorActor",hl.a,[325]);class zM{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab=null,Jb=null,Tb=null,jc=null,Hc=null,hd=null,Gd=null){var de,qe;this.Kia="_";this.y2a="OLE_LINK";this.Pwd=(null===(de=y.AFrameworkApplication.J)||void 0===de?0:de.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",
!1))?WordEditorIntl.WordEditorStrings.L_Bookmark:"Bookmark";this.Jok=(null===(qe=y.AFrameworkApplication.J)||void 0===qe?0:qe.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?new RegExp("^"+this.Pwd+"\\d+$","i"):/^BOOKMARK\d+$/i;this.BPa="BookmarkRibbonOptions";this.epk="BookmarkFloatieOptions";this.Rch="CreateBookmarkOnRange";this.Sch="CreateBookmarkOnView";this.Qch="CreateBookmarkOnIP";this.SNe="CreateBookmark";this.m2a="wwaengidc";this.ZEh="ShowHideBookmarksOnDocument";
this.geh="DeleteBookmark";this.ftk="DeleteBookmarkAction";this.UNk="ShowHideBookmarks";this.YEh="ShowBookmarksFloatie";this.RNk="ShowBookmarksFloatieAction";this.Mfh="EditBookmark";this.fuk="EditBookmarkAction";this.bkf="BookmarksUsage";this.jel="InsertTabSwitchActivity";this.Qbn="Insert";this.L3b=b;this.ga=h;this.ib=r;this.Ep=A;this.zz=L;this.V9=Z;this.Rc=oa;this.bO=Ba;this.vr=Jb;this.f$g=gb;this.Qe=Ab;this.C9=Hc;this.yo=Tb;this.qd=jc;this.FV=hd;this.xl=Gd}get nv(){return this.zz.value}Xb(){this.ga.qa(Ec.a.DIa,
kc.a.view,this.DIa.bind(this));this.ga.fb(Za.a.S_a,kc.a.application,this.ppp.bind(this),96);this.ga.qa(Ec.a.DIa,kc.a.Cd,this.jEl.bind(this));this.ga.qa(Ec.a.DIa,kc.a.Vc,this.iEl.bind(this));this.ga.qa(Ec.a.deleteBookmark,kc.a.view,this.deleteBookmark.bind(this));this.ga.qa(Ec.a.pyf,kc.a.view,this.oZl.bind(this));this.ga.fb(Ec.a.ITj,kc.a.view,this.z8o.bind(this),1028);this.ga.fb(Ec.a.Wqe,kc.a.application,this.Wqe.bind(this),96);this.ga.fb(Ec.a.Sye,kc.a.Vc,this.Sye.bind(this),1028);this.ga.fb(vb.a.ehe,
kc.a.view,this.ehe.bind(this),1028);this.ga.fb(Ec.a.Y$d,kc.a.view,this.Y$d.bind(this),1028);this.ga.Pc(Ec.a.DIa,1028)}ppp(b,h,r,A,L){return L&&L.NewContextId===this.Qbn?(this.Dhe(this.jel),32):2}DIa(b,h,r,A,L){var Z,oa;b=this.ib.Pg;if(!b||b.contextId===kc.a.L$)return 2;if(1===r)return Yj.a.iba(h)||(null===(Z=this.xl)||void 0===Z?0:Z.p2(b))||(null===(oa=this.xl)||void 0===oa?0:oa.ama(b))?8:32;h=this.ib.gb.currentSelection;if(!h||this.Qe.ym(h))return 2;this.lcd(L,"User is trying to create bookmark from UILocation : {0}");
this.Rcb(this.Sch,this.SNe);if(h&&this.Ep.tdf(this.uqb(),h))return this.Dhe(this.bkf),32;L=new Map;L.set("Source",this.BPa);L=Object.assign(new Na.a,{additionalValues:L});xa.Health.instance.recordKpiFailure(this.Sch,"Unable to create bookmark",!1,!0,L);return 8}jEl(b,h,r,A,L){if(1===r)return 32;if(kc.a.Cd!==h.contextId)return 8;this.lcd(L,"User is trying to create bookmark from UILocation : {0}");b=this.ib.gb.currentSelection;if(!b)return 2;this.Rcb(this.Rch,this.SNe);if(this.Ep.tdf(this.uqb(),b))return this.Dhe(this.bkf),
32;b=new Map;b.set("Source",this.BPa);b=Object.assign(new Na.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.Rch,"Unable to create bookmark for range",!1,!0,b);return 8}iEl(b,h,r,A,L){if(1===r)return 32;if(kc.a.Vc!==h.contextId)return 8;this.lcd(L,"User is trying to create bookmark from UILocation : {0}");b=this.ib.gb.currentSelection;if(!b)return 2;this.Qe.ym(b)&&(h=b.Qa,this.Qe.Qtb(h)?(b=this.Qe.T6(h,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),
b=this.Qe.T6(h,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.Rcb(this.Qch,this.SNe);if(this.Ep.tdf(this.uqb(),b))return this.Dhe(this.bkf),32;b=new Map;b.set("Source",this.BPa);b=Object.assign(new Na.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.Qch,"Unable to create bookmark for IP",!1,!0,b);return 8}Wqe(b,h,r,A,L){1===r&&32;L[Tg.a.On]=Av.U7e;return 32}z8o(b,h,r,A,L){if(1===r)return 32;this.Rcb(this.ZEh,this.UNk);
(b=L[Tg.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Av.U7e=b;b=Object(so.a)().qU(this.nv);if(null!==b)return this.wjd(b),this.L3b.eJ({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.BPa);b=Object.assign(new Na.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.ZEh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,A,L){b=this.ib.gb.currentSelection;if(!b)return 2;b=b.Qa;b=this.Ep.N5d(b.node,
b.cpBegin);if(1===r)return b?32:8;this.lcd(L,"User is trying to delete bookmark from UILocation : {0}");this.bO.f3&&(v.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.bO.dismissFloatie());this.Rcb(this.geh,this.ftk);b||v.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.Ep.EBj(b.id))return this.f$g&&this.f$g.tVd(),32;r=new Map;r.set("Source",this.BPa);r=Object.assign(new Na.a,{additionalValues:r});xa.Health.instance.recordKpiFailure(this.geh,
"Unable to delete bookmark",!1,!0,r);return 8}oZl(b,h,r,A,L){b=this.ib.gb.currentSelection;if(!b)return 2;b=b.Qa;b=this.Ep.N5d(b.node,b.cpBegin);if(1===r)return b?32:8;this.lcd(L,"User is trying to edit bookmark from UILocation : {0}");this.bO.f3&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.bO.dismissFloatie());this.Rcb(this.Mfh,this.fuk);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.C9.value.pZl(h,
b,this.Ep),32;h=new Map;h.set("Source",this.BPa);h=Object.assign(new Na.a,{additionalValues:h});xa.Health.instance.recordKpiFailure(this.Mfh,"Unable to edit bookmark",!1,!0,h);return 8}lcd(b,h){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}Sye(b,h,r,A,L){1===r&&32;this.Rcb(this.YEh,this.RNk);if(h.contextId===kc.a.Vc)return b=Array(1),b.push("Bookmarks"),this.bO.showFloatie(L.location,b,1),32;L=new Map;L.set("Source",this.epk);L=Object.assign(new Na.a,{additionalValues:L});
xa.Health.instance.recordKpiFailure(this.YEh,"Unable to show bookmark floatie",!1,!0,L);return 8}ehe(b,h,r,A,L){let Z;return 1===r?(Cq.a.instance.le(()=>{Z=this.ga.Hf(h,vb.a.JR,r,!0,A,L);32!==Z&&(Z=this.ga.Hf(h,Ec.a.DIa,r,!0,A,L))},"BA:LFE"),Z):8}Y$d(b,h,r){var A;if(1===r)return 32;if(b=this.ib.gb.currentSelection){b=b.Qa.node;if(h=this.nmi(b))return h.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.Ep.N5d(b,0)){b=this.FV.Jmb.get(null===(A=b.id)||
void 0===A?void 0:A.toString());A=Object(so.a)().qU(this.nv).Hc.Eb(b);if(A=this.nmi(A))return A.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}nmi(b){let h;b=this.yo.Pm(b).jm(this.qd.Gd.Ic);b.V$a&&(b=b.htmlElement.querySelectorAll("div."+Av.g$g),0<b.length&&(h=b[0]));return h}wjd(b){const h=OL.b(b);if(h){var r=this.Rc.Lc(2);try{for(r.Ab(b);h.moveNext();){if(!Cd.ParagraphReader.Fh(h.iterator))continue;
const A=h.currentNode;this.hYl(A)&&this.V9.FSb(A,!0)}}finally{r&&r.dispose()}}}hYl(b){var h;for(let A=0;A<b.ra.length;A++){const L=b.ra.Ub(A);if(null!=L.Ch)for(let Z=0;Z<L.Ch.length;Z++){var r=L.Ch.K(Z);if(null!=r){r=b.Hc.Eb(r.uo).ka(Vc.a.tu,"");const oa=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");if(!(F.a.Qf(r)||r.startsWith(this.Kia)||oa&&r.startsWith(this.y2a)))return!0}}}}uqb(){var b=this.Ep.r4d(!1);const h=[];for(let r=0;r<b.count;r++){const A=
b.K(r).ka(Vc.a.tu,"");this.Jok.test(A)&&h.push(A)}return 0<h.length?(h.sort((r,A)=>r.localeCompare(A,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.Pwd.length)),this.Pwd+(b+1)):this.Pwd+1}Rcb(b,h){const r=new Map;r.set("Source",this.BPa);r.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.m2a,r)}Dhe(b){this.vr&&this.vr.execute(h=>{h.logActivity(b,null)})}}Object(u.a)(zM,"BookmarkActor",null,[]);class JK{constructor(b,h,r){this.Pb=b;this.yTl=h;this.qg=r;this.cpf=this.cpf.bind(this)}Xb(){this.Pb.qa(Ec.a.n2f,
kc.a.view,this.cpf)}cpf(b,h,r,A,L){return 1===r?32:(b=this.qg.Vaa(h.Lk))?(L=3===L.az,this.yTl.value.m9h(this.lHm(b),this.dRm(b),L),32):2}lHm(b){const h=new lj.DictionaryPropertySet;h.setValue(De.a.SG,this.qg.Eh(b));h.setValue(De.a.aI,this.qg.Laa(b));h.setValue(De.a.bra,this.qg.Cqb(b));h.setValue(De.a.separator,this.qg.x8d(b));return h}dRm(b){const h=new lj.DictionaryPropertySet;h.setValue(Vc.a.marginLeft,this.qg.gN(b));h.setValue(Vc.a.marginRight,this.qg.hN(b));h.setValue(Vc.a.pageWidth,this.qg.Jv(b));
return h}}Object(u.a)(JK,"ColumnsDialogActor",null,[]);var yO=d(881);class YM{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){this.fq=b;this.Gia=h;this.Ee=r;this.sr=A;this.Wm=L;this.Rd=Z;this.Rc=oa;this.xe=Ba;this.ga=gb;this.WAk=Ab;this.Lrk=Jb}get iXf(){return this.WAk}Xb(){this.ga.fb(vb.a.jpd,kc.a.view,this.ean.bind(this),96);this.ga.fb(vb.a.qkd,kc.a.view,this.qkd.bind(this),4);this.ga.fb(vb.a.jSd,kc.a.view,this.jSd.bind(this),1028)}jSd(b,h,r,A,L){if(!Fq.a.Kqf)return 8;b=L.FormattingActionId;L=L.FormattingActionData;
if(!h.view||!h.view.ve)return 2;h=h.view;if(!(b&&L&&h.lb&&h.lb.gb.currentSelection))return 8;h=this.Wm.Dvi(h.lb.gb.currentSelection.toArray());for(const Z of h){h=Z.ka(Vc.a.Ow,0);r=this.fq.getById(h);if(!r)return v.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.Lrk.Bwp(r,b,L))return v.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}ean(b,h,r,A,L){h=this.fq.getById(L);if(!h)return 8;r=h.Xd;if(!r)return 8;
if(Fq.a.vec&&8===h.type||r.ka(Vc.a.gaa,!1))return 2;A=this.fq.vnm(h);if(!A)return 8;L=this.Rc.Lc(7);L.Ab(A.node);if(!this.iXf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Rd.We(A,b),Fq.a.aga?this.Wm.JKb(h,!0):this.JKb(h),r.setValue(Vc.a.gaa,!0),L.dispose(),32;const Z=new lj.DictionaryPropertySet;Z.setValue(Od.a.A9d,A);var oa=r.ka(Vc.a.aUa,"");oa=this.Gia.EJi(oa);if(!oa)return this.sr.We(A,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,
b),Fq.a.aga?this.Wm.JKb(h,!0):this.JKb(h),r.setValue(Vc.a.gaa,!0),L.dispose(),32;Z.setValue(Od.a.X4c,oa);if(1<oa.length&&!h.zg)return L.dispose(),8;Fq.a.aga?this.ga.Qb(vb.a.tpd,2,{X4c:oa,A9d:A,placeholderText:h.placeholderText}):this.ACl(Z);r.setValue(Vc.a.gaa,!0);L.dispose();return 32}qkd(b,h,r){b=h.view.ve?h.view:null;if(!b||!b.lb)return 8;const [A,L]=this.sKm(b.lb.gb);if(0===A.length)return 8;if(1===r){for(var Z of A){var oa=L.get(Z.parentId);if(this.aWi(Z,oa))return 32}return 8}if(2===r){r=this.fbp(A,
L);Z=this.Rc.Lc(15);Z.Ab(b.vd);for(oa of r)r=L.get(oa.parentId),this.aWi(oa,r)&&this.fq.eZb(oa.id);Z.dispose();Object(yO.l)()&&Object(yO.o)("RemoveContentControl");return 32}return 2}sKm(b){var h,r,A=[];for(const Z of b)A.push(...(null!==(h=this.Wm.jsa(Z.Qa,Z.Xc,1))&&void 0!==h?h:[]));if(0===A.length)return[A,new Map];h=[];for(const Z of b)h.push(...(null!==(r=this.Wm.jsa(Z.Qa,Z.Xc,3))&&void 0!==r?r:[]));b=new Map(A.map(Z=>[Z.id,Z]));if(0===h.length)return[A,b];const L=new Map(h.map(Z=>[Z.id,Z]));
A=A.filter(Z=>!L.has(Z.id));b=new Map([...b,...L]);return 0==A.length?[[h[0]],b]:[A,b]}JKb(b){const h=this.sr.mkc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.xe.IF(b.start.node).nh(ts.a.Djg))this.Ee.Wqa(h.formatting),this.Ee.beb(h.formatting,b)}else v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}ACl(b){this.ga.Qb(vb.a.tpd,2,b)}aWi(b,h){return b.Tla&&b.crn&&(!h||h.isEditable)}fbp(b,h){const r=(A,L)=>null==A||null==L||A.id===L.id?!1:
A.id===L.parentId||r(h.get(A.parentId),L);return b.slice().sort((A,L)=>r(A,L)?1:r(L,A)?-1:0)}}Object(u.a)(YM,"ContentControlActor",null,[]);var vy=d(1076);class PL extends Dg.a{constructor(b,h,r){super(!1,!1,!0);this.Psh=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,vy.a.Cgf,vy.a.Bgf,vy.a.Dgf];this.Wnk=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,vy.a.T4k,vy.a.S4k,vy.a.V4k];this.B8g=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];
this.Kxc=()=>{new PL(this.ga,this.P9e,this.XFc)};this.Kwm=()=>{const A=[];for(const L of this.P9e)A.push(this.V8(L));return A};this.aBp=A=>{const L=new Set;this.Cia="";for(const Z of A)if(""!==Z.position){const oa=this.zCi(Z.position);if(0>oa||22<oa){this.Cia=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(L.has(oa)){this.Cia=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.bmp(Z)),L.add(oa)}else{this.Cia=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;
break}""!==this.Cia&&(this._tabStops=[],this.P9e=A)};this.hNl=(A,L)=>{try{if(1===A){if(""!==this.Cia)throw Error.create(this.Cia);L.DefaultTabStop&&(this.XFc=vy.a.Kug(L.DefaultTabStop),this.BEp(this.XFc));if(32!==this.ga.Qb(Ec.a.g2b,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Tf.a.lD(this.XFc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(Z){this.HNa(Z.message,this.Kxc)}};this.ga=b;this.P9e=h;this._tabStops=[];this.XFc=r;this.Cia="";b={["id"]:"CustomTabDialog",
["bodyControls"]:this.V1c()};this.Uh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.hNl,b)}V8(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}zCi(b){return Math.floor(100*parseFloat(b))/100}bmp(b){return new EB.a(Tf.a.lD(this.zCi(b.position)),vy.a.hNm(b.alignment),vy.a.fNm(b.leader),1)}BEp(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Qb(vb.a.VMa,2,h)){var r=h.marginLeft;const A=nh.a.Mj(h.marginRight,
0);r=nh.a.Mj(r,0);h=nh.a.Mj(h.pageWidth,0);if(nh.a.Hla(b,0,!1)>=h-A-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}V1c(){return{["getInitState"]:this.Kwm,["updateState"]:this.aBp,["validPositions"]:this.OGi(0,"Position"),["validAlignments"]:this.bvi(this.B8g,this.B8g,null,"Alignment"),["validLeaders"]:this.bvi(this.Psh,this.Psh,this.Wnk,"Leader"),["defaultTabStopSpinButtonProps"]:this.OGi(.01,"DefaultTabStops"),["defaultTabStopLength"]:this.XFc,["DefaultTabStop"]:"DefaultTabStop",
["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,
["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}OGi(b,h){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:h,["unitType"]:"Inch",["validUnits"]:[Dp.a("Inch",3,b,22,.1)],["numberFormatInfo"]:Dp.d()}}bvi(b,h,r,A){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:A,["options"]:Dp.b(b,h,r)}}}Object(u.a)(PL,"CustomTabDialog",
Dg.a,[]);class VF{constructor(b,h,r){this.qrc=(A,L,Z,oa,Ba)=>{if(2!==Z)return 8;if(!Ba)return 16;A=Ba.tabStop;Ba=Ba.value;if(!A)return 16;me.c(Ec.a.qrc);Ba=new EB.a(Ba,A.Hha,A.Ata,A.vFg);L=L.node;this.wFa.Ycb(L,A);this.wFa.ube(L,Ba);return 32};this.xnd=(A,L,Z,oa,Ba)=>{if(2===Z){if(!Ba)return 16;this.wFa.ube(L.node,Ba);return 32}return 8};this.jYb=(A,L,Z,oa,Ba)=>{A=this.wFa.Hyj(L.node);if(!("customTabs"in Ba))return Ba.customTabs=A,32;L=Ba.customTabs;if(!L||0>=L.length||!A||0>=A.length)return Ba.customTabs=
null,32;Z=[];for(const gb of L)for(const Ab of A)if(Ab.gOa===gb.gOa&&Ab.vFg===gb.vFg&&Ab.Hha===gb.Hha){Z.push(gb);break}Ba.customTabs=Z;return 32};this.Ycb=(A,L,Z,oa,Ba)=>{if(2===Z){if(!Ba)return 16;me.c(Ec.a.Ycb);this.wFa.Ycb(L.node,Ba);return 32}return 8};this.fZb=(A,L)=>{this.wFa.fZb(L.node);return 32};this.g2b=(A,L,Z,oa,Ba)=>{if(2===Z){if(!Ba)return 16;A=Ba.tabStops;Z=Ba.defaultTabStopLength;L=L.node;oa=!1;const gb=this.wFa.uEo(L,A);Ba.defaultTabStopLengthSaved||(oa=this.jT.STo(L,Z),Ba.defaultTabStopLengthSaved=
!0);gb&&me.d(Ec.a.g2b,!0,void 0,void 0,void 0,void 0,[Object.assign(new da.a,{name:"Custom Tab Stops Count",string:A.length.toString()})]);if(null==oa)return v.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;oa&&(this.Rkd&&this.Rkd.ZTi(),this.Qd.Yu(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),me.d(Ec.a.g2b,!0,void 0,void 0,void 0,void 0,[Object.assign(new da.a,{name:"Default Tab Stop Length",string:Z.toString()})]));return 32}return 8};this.TTj=
(A,L,Z)=>{if(2!==Z)return 8;A={};if(32!==this.ga.Qb(Ec.a.u_,2,A))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;L={};if(32!==this.ga.Qb(vb.a.VMa,2,L))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;A=vy.a.Kug(Tf.a.iB(A.defaultTabStop));Z={};Z.defaultTabStopLength=A;Z.sectionPropertiesData=L;if(32!==this.ga.Qb(Ec.a.kMg,2,Z))return v.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),
16;if(!Z.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.wFa.HNa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;L={};if(32!==this.ga.Qb(Ec.a.jYb,2,L))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(L=L.customTabs)||(L=[]);L=vy.a.gNm(L);new PL(this.ga,L,A);me.c(Ec.a.Kxc,!0);return 32};this.Lpn=(A,L,Z,oa,Ba)=>{if(2!==Z)return 8;if(!Ba)return 16;if(Ba.isParagraphValid)return 32;
Z={};if(32!==this.ga.Hf(L,vb.a.Kcb,2,!1,null,Z))return 16;A=Ba.sectionPropertiesData;L=Ba.defaultTabStopLength;var gb=Z.Cu;oa=gb.Hfa;gb=1===gb.specialIndentType?gb.RA:gb.RA-gb.yha;const Ab=A.marginLeft,Jb=A.marginRight;Z.isRtl?(Z=nh.a.Mj(Math.max(Jb,Jb+oa),0),oa=nh.a.Mj(Math.max(Ab,Ab+gb),0)):(Z=nh.a.Mj(Math.max(Ab,Ab+gb),0),oa=nh.a.Mj(Math.max(Jb,Jb+oa),0));A=nh.a.Mj(A.pageWidth,0);L=nh.a.Hla(L,0,!1);Ba.isParagraphValid=L<A-Z-oa;return 32};this.ga=b;this.wFa=h;this.jT=r}get Qd(){return null!=this.L5g?
this.L5g:this.L5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Rkd(){return null!=this.N2g?this.N2g:this.N2g=Wa.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}Xb(){const b=r=>An.OutlineElementGeneralizer.cla(r.gb,!0),h=ed.a.Y_a.nXc(b,!0);this.ga.qa(Ec.a.jYb,kc.a.view,ed.a.Y_a.nXc(b,!1));this.ga.fb(Ec.a.jYb,kc.a.paragraph,this.jYb,96);this.ga.qa(Ec.a.Ycb,kc.a.view,h);this.ga.fb(Ec.a.Ycb,kc.a.paragraph,this.Ycb,96);this.ga.qa(Ec.a.fZb,kc.a.view,
h);this.ga.fb(Ec.a.fZb,kc.a.paragraph,this.fZb,96);this.ga.qa(Ec.a.xnd,kc.a.view,h);this.ga.fb(Ec.a.xnd,kc.a.paragraph,this.xnd,96);this.ga.qa(Ec.a.qrc,kc.a.view,h);this.ga.fb(Ec.a.qrc,kc.a.paragraph,this.qrc,96);this.ga.qa(Ec.a.g2b,kc.a.view,h);this.ga.fb(Ec.a.g2b,kc.a.paragraph,this.g2b,96);this.ga.qa(Ec.a.kMg,kc.a.view,h);this.ga.fb(Ec.a.kMg,kc.a.paragraph,this.Lpn,96);this.ga.qa(Ec.a.Kxc,kc.a.view,this.TTj);this.ga.qa(Ec.a.FSi,kc.a.view,this.TTj)}}Object(u.a)(VF,"CustomTabActor",null,[]);var cP=
d(126),jL=d(630);class OI{constructor(b,h,r,A,L,Z,oa,Ba,gb){this.ga=b;this.wPd=r;this.l1a=(this.zPc=L)&&A;this.hp=Z;this.rW=oa;this.Ksk=Ba;this.XD=gb;this.Snk=h;this.T$i(!0);this.M9i(!0);y.AFrameworkApplication.fG(()=>{this.uWb()});this.l1a&&eg.a("dispatch")&&appChrome.api.dispatch(this.wZj([]))}Xb(){this.l1a&&(this.ga.qa(Ec.a.vmp,kc.a.view,this.xNl.bind(this)),this.ga.qa(Ec.a.Jod,kc.a.view,this.Jod.bind(this)),this.ga.fb(Ec.a.Uid,kc.a.view,this.Uid.bind(this),96));this.zPc&&(this.ga.qa(Ec.a.Kod,
kc.a.view,this.Kod.bind(this)),this.ga.fb(Ec.a.Nre,kc.a.view,this.Nre.bind(this),96))}Ldn(b){if(!this.i4o(b))return!1;const h=Ko.a.instance.Lc(2);try{h.Ab(b.root);const r=hb.a.eb(b.root.graphNode),A=uw.a.zq(r);for(;A.moveNext();){const L=Object(Ca.a)(cP.a,A.currentNode);L&&L.AL(b.Ic,20,!0)}}finally{h&&h.dispose()}return!0}i4o(b){return b&&b.root&&b.ow?b.vj||b.rYf||b.bYi||b.Kk:!1}uGo(){let b=!1;this.wPd.forEach(h=>{this.Ldn(h)&&(b=!0)});return b}wmp(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",
this.hp.UO?"dark":"light");return this.hp.UO?jL.a.hSc(1):jL.a.QBj(1)}zHg(){const b=this.hp.u6;v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.uGo()||(b?!jL.a.hSc(0):!jL.a.QBj(0)))return!1;this.Ksk.Ono(b);return!0}wZj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.hp.UO));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.rHi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",
this.hp.Eeb?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){v.ULS.sendTraceTag(527282835,3023,10,h)}return b}xNl(){return this.zHg()?32:8}Kod(b,h,r){if(1===r)return 32;b=this.rW.Xf("UserAction","sharedUXDarkModeToggle");if(eg.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),
appChrome.api.toggleSharedUXDarkMode(),eg.a("isSharedUXDarkModeOn")?this.hp.UO=appChrome.api.isSharedUXDarkModeOn():this.hp.UO=!this.hp.UO,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.hp.UO);else return 8;appChrome.getHeaderApi().then(A=>{A.hasOwnProperty("refreshThemeOverride")&&A.refreshThemeOverride()});this.wmp()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.l1a&&!this.hp.Eeb&&(this.zHg()||v.ULS.sendTraceTag(561553417,3023,15,
"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");ab.StaticActiveAppFrame.za().eJ(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.hp.UO));this.l1a&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.hp.UO));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.Ri);me.b(this.hp.UO?"DarkModeOn":"DarkModeOff");return 32}Jod(b,
h,r){if(1===r)return 32;b=this.rW.Xf("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.hp.Eeb=!this.hp.Eeb;if(!this.zHg())return 8;h={};h.DarkModeSwitchBackground=this.XD?"ButtonModel":"ToggleButtonModel";ab.StaticActiveAppFrame.za().eJ(h);b.stop();v.ULS.sendTraceTag(555885378,3023,50,"{0}",b.Ri);v.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.hp.Eeb);me.b(this.hp.Eeb?"DarkCanvasOff":
"DarkCanvasOn");return 32}Nre(b,h,r,A,L){if(1===r)return 32;if(!L)return 2;eg.a("isSharedUXDarkModeOn")&&(this.hp.UO=appChrome.api.isSharedUXDarkModeOn());L&&(L[Tg.a.On]=this.hp.UO);return 32}Uid(b,h,r,A,L){if(1===r)return 32;if(!L)return 2;!this.XD&&L&&(L[Tg.a.On]=this.hp.Eeb);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.hp.UO));this.l1a&&this.wZj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.rHi(!1)));appChrome.api.dispatch(b);
return 32}rHi(b){const h={};this.hp.Eeb?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}uWb(){this.zPc&&this.T$i(!1);this.l1a&&this.M9i(!1)}T$i(b){var h;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.hp.UO?"dark":"light",this.hp.YIa);b&&this.hp.UO!=(null===(h=this.Snk)||
void 0===h?void 0:h.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.hp.UO?"dark":"light",this.hp.YIa)}M9i(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.hp.u6?"dark":"light",this.hp.wNl)}}Object(u.a)(OI,"DarkModeActor",null,[]);class Ix{constructor(b){this.En=null;this.lqa=b}get SKb(){return null!=this.aSg?this.aSg:this.aSg=
Wa.a.instance.Oa("Box4.IAutoCorrectRules")}get UZ(){return null!=this.cSg?this.cSg:this.cSg=Wa.a.instance.Oa("Box4.IAutoCorrectScheduler")}get VX(){return null!=this.H1g?this.H1g:this.H1g=Wa.a.instance.Oa("Box4.Pages.IPageContentEditor")}get DN(){return null!=this.c1g?this.c1g:this.c1g=Wa.a.instance.Oa("Box4.IOutlineEditor")}get ih(){return this.En||(this.En=this.lqa())}m6i(b,h,r){if(this.DN&&Ix.tj){var A=Object(Nl.a)().XJf(h);b=A.node;he.a.pl(A)&&(A=xc.a.Uc(b,Cd.ParagraphReader.textLength(b)));var L=
Ya.FormattingReader.language(Ya.FormattingReader.Vs(A));A=hb.a.eb(r.vd);Object(so.a)().Vue(A);var Z=b=null;if(A)for(let oa=A.Vb(1);oa&&!Z;oa=A.Ci(1))fm.OutlineReader.JBa(oa)&&(Z=oa);if(A&&!Z){if(!this.VX||!this.DN)return;b=new Sb.GraphTransaction(7);b.ju(A);Z=this.VX.qYd(A);this.DN.Tja(A,!0);L&&(fg.OutlineElementNavigator.Me(A),A=xc.a.Uc(A.currentNode,0),Ix.tj.jxe(Ya.FormattingReader.Vs(A),L))}L=qc.SelectionFactory.qp(Z,!0);r.lb.Kc(L);he.a.mf(h)&&(r=hb.a.eb(h.node),r.Ks(),fo.OutlineNavigator.gug(r),
this.SKb&&this.UZ&&fm.OutlineReader.UA(r,h,!0)&&(h=this.SKb.pCf(h,-1,!1,jf.a.pz))&&this.UZ.JJj(h));this.ih&&this.ih.uI();b&&b.dispose()}}static get tj(){return null!=Ix.uWg?Ix.uWg:Ix.uWg=Wa.a.instance.Oa("Box4.IFormattingEditor")}static get instance(){return null!=Ix.fZg?Ix.fZg:Ix.fZg=Ix.Qm()}static Qm(){return new Ix(()=>Wa.a.instance.Oa("Box4.IUndoManager"))}}Object(u.a)(Ix,"TitleViewEditor",null,[]);class QL{rvf(b,h,r){return 1===r?32:QL.XQl(h.node)}static XQl(b){const h=new hb.a;h.set(b);h.Ks();
b=new Sb.GraphTransaction(7);b.ju(h);h.Tg();b.dispose();return 32}}Object(u.a)(QL,"DeleteOutlineLevelContentStrategy",null,[]);class Vr{constructor(){this.htk=new QL;this.rvf=(b,h,r,A,L)=>this.htk.rvf(b,h,r,A,L)}Xb(b){const h=this.tei.Bvf.bind(this.tei),r=this.rvf,A=this.iei.ZQl.bind(this.iei);this.Hpg(b,h,r,A);b.qa(vb.a.backspace,kc.a.Vc,A);b.qa(vb.a.backspace,kc.a.Cd,A);b.qa(vb.a.backspace,kc.a.Zc,Vd.ActionManager.cU);b.qa(vb.a.backspace,kc.a.outline,r);b.qa(vb.a.backspace,kc.a.view,h);b.Pc(vb.a.backspace,
1124);b.qa(vb.a.Fza,kc.a.Vc,Vd.ActionManager.cU);b.qa(vb.a.Fza,kc.a.Cd,A);b.qa(vb.a.Fza,kc.a.Zc,Vd.ActionManager.cU);b.qa(vb.a.Fza,kc.a.outline,r);b.qa(vb.a.Fza,kc.a.view,h);b.fb(vb.a.OYd,kc.a.view,h,1124);b.qa(vb.a.gI,kc.a.Vc,A);b.qa(vb.a.gI,kc.a.Cd,A);b.qa(vb.a.gI,kc.a.Zc,Vd.ActionManager.cU);b.qa(vb.a.gI,kc.a.outline,r);b.qa(vb.a.gI,kc.a.view,h);b.Pc(vb.a.gI,1124);b.fb(vb.a.Stf,kc.a.view,h,1124);b.fb(vb.a.Bra,kc.a.view,Vr.Bra,1028)}Hpg(){}static get Mf(){return null!=Vr.g1g?Vr.g1g:Vr.g1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}static get VX(){return null!=
Vr.E1g?Vr.E1g:Vr.E1g=Wa.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get DN(){return null!=Vr.b1g?Vr.b1g:Vr.b1g=Wa.a.instance.resolve("Box4.IOutlineEditor")}static get rc(){return null!=Vr.uVg?Vr.uVg:Vr.uVg=Wa.a.instance.Oa("Box4.IFeatureHelper")}static Bra(b,h,r,A,L){A=h.view;if(!A.lb||!A.lb.gb.currentSelection||he.a.ym(A.lb.gb.currentSelection))return 8;if(1===r)return 32;r=A.lb.gb;const Z=r.currentSelection;var oa=Z.Qa,Ba=null,gb=!1;if(r.GL){if(oa.contextId===kc.a.outline&&1===r.length){for(b=
hb.a.eb(oa.node);b.je();)b.Tg();Vr.DN.Tja(b,!0);fg.OutlineElementNavigator.Me(b);b=qc.SelectionFactory.ue(b.currentNode,0);A.lb.Kc(b);return 32}Ba=oa.node;var Ab=null;if(lu.c(oa)){var Jb=Ba.fg(A.Ic);Jb&&(Jb=Jb.ljq)&&0<=Jb.width&&0<=Jb.height&&(Ab=new QA.a(nh.a.hn(Jb.x,0),nh.a.hn(Jb.y,1)));Ab||(Ab=cB.a(Ba))}else Ab=cB.a(oa.node);oa=hb.a.eb(oa.node);oa.Ks();Object(so.a)().Vue(oa);Ba=Vr.VX.qYd(oa);cB.b(Ba,Ab.x,Ab.y);Vr.DN.Tja(oa,!0);Ba=qc.SelectionFactory.qp(Ba,!0)}else if(1===r.length){gb=r.last;oa=
If.a.SMb(gb);if(Vr.rc&&Vr.rc.isFeatureEnabled(21)&&Object(Nl.a)().zCg(oa).returnValue)return 2;oa=gb.Xc;gb=!r.Yw&&!(null===(Ab=r.currentSelection)||void 0===Ab?0:Ab.vab)&&(he.a.pl(oa)||Cd.ParagraphReader.en(oa)||he.a.fba(oa))}gb&&(gb=he.a.vk(Z,!1,!1,void 0,!1),A.lb.Kc(gb),y.AFrameworkApplication.va.Hf(h,vb.a.vE,2,!1,null,L),Ba=A.lb.gb.currentSelection,A.lb.Kc(Z));L||(L=new lj.DictionaryPropertySet);L.setValue(Od.a.tZc,!0);y.AFrameworkApplication.va.Hf(h,vb.a.gI,2,!0,null,L);if(Ba&&Ba.Qa.isValid)return A.lb.Kc(Ba),
32;r.GL&&Ix.instance.m6i(b,h.Lk,A);he.a.ym(A.lb.gb.currentSelection)||y.AFrameworkApplication.va.Hf(h,vb.a.vE,2,!1,null,L);return 32}static WQl(b,h){if(1===h)return 32;h=new Sb.GraphTransaction(7);h.Ab(b);Vr.Mf.pDa(b);h.dispose();return 32}}Object(u.a)(Vr,"ADeleteActor",null,[]);var ZM=d(248),zO=d(713);class Wn{get tg(){return Be.a.instance}ZQl(b,h,r,A,L){A=null===L||void 0===L?void 0:L.utd;if(1===r)return 32;var Z=b===vb.a.backspace;if(this.tg.Lh){if(this.tg.oYi(h)&&Wn.uka&&(r=h.clone(),r.Tb+=1,
--r.Fb,this.tg.apc(r)))return Wn.uka.pBj([r]),32;if(this.tg.eZf(h,Z))return 2}if(Wn.xy()&&Wn.xy().instance&&Wn.xy().instance.zX(h))return 4;const oa=h.node;var Ba=h.cpBegin;r=h.cpEnd;let gb=h.Fb,Ab=h.Tb;const Jb=Cd.ParagraphReader.text(oa),Tb=Jb.length;let jc=!1;if(Ba===r){if(Z&&!Ba||!Z&&Ba===Tb)return 2;Z?({cp:Ba,returnValue:jc}=this.tg.Lej(oa,Ba),jc||({cp:Ba,Tqa:gb,returnValue:jc}=this.tg.Kej(h,Ba,gb)),jc||(Ba--,F.a.VA(Jb,Ba)&&Ba--),b=vb.a.mjf):({cp:r,returnValue:jc}=this.tg.APn(oa,r),jc||({cp:r,
Tqa:Ab,returnValue:jc}=this.tg.zPn(h,r,Ab)),jc||(r++,F.a.VA(Jb,r)&&r++),b=vb.a.Qdi)}Ba=Ba===r?xc.a.Uc(oa,Ba):xc.a.createTextRange(oa,Ba,r);Ut.a.Gpb&&(Ba.Uea=h.Uea,Ba.Pra=h.Pra);jc&&this.tg.Lh&&(Z?Ba.Fb=gb:Ba.Tb=Ab);if(!this.tg.apc(Ba))return 2;this.aKb(oa);h=new Sb.GraphTransaction(15);h.Ph=b;h.Ab(oa);Z=Object(Gb.a)(zO.a,L)&&L.q8a;if(!Wn.Qd.Bg||Z||Wn.ZHa.jfe(If.a.instance.gb.currentSelection))this.jei(Ba,A);else{Z=Wn.Qd.S5a();try{const Hc=Wn.ti.Spd(Ba);let hd;if(({type:hd}=Hc.m9d()).returnValue){const Gd=
Object(Ca.a)(73,L);Gd&&Gd.ka(Ge.a.kXf,!1)?Wn.Qd.uXb=hd:Wn.Qd.Yu(hd)}L=0;for(let Gd=Hc.length-1;0<=Gd;--Gd){let de;const qe=({Vfe:de}=Hc.getContext(Gd)).returnValue;de?(Wn.Op.zvb(qe,null),L+=Wn.Lj.Fyb(qe,2),Wn.Lj.SXd=r+L):this.jei(qe,A)}}finally{Z&&Z.dispose()}}h.dispose();return 32}aKb(){}static get Qd(){return null!=Wn.O5g?Wn.O5g:Wn.O5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Lj(){return null!=Wn.z5g?Wn.z5g:Wn.z5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get ti(){return null!=
Wn.i6g?Wn.i6g:Wn.i6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Op(){return null!=Wn.kXg?Wn.kXg:Wn.kXg=Wa.a.instance.resolve("Box4.IHyperlinkEditor")}static xy(){return Wn.Vn||(Wn.Vn=Wa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get uka(){Wn.gEb||(Wn.gEb=Wa.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return Wn.gEb.instance}static get ZHa(){return null!=Wn.oSg?Wn.oSg:Wn.oSg=Wa.a.instance.resolve("Box4.IContentControlViewElementManager")}}
Wn.Vn=null;Wn.gEb=null;Object(u.a)(Wn,"ADeleteParagraphContentStrategy",null,[]);var $M=d(226);class HA extends Wn{constructor(){super()}get Cg(){return null!=this.uSg?this.uSg:this.uSg=Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Ar(){return null!=this.lSg?this.lSg:this.lSg=Wa.a.instance.Ta("Box4.ContentControlConfigSettings")}get prc(){return null!=this.M0g?this.M0g:this.M0g=Wa.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get C6(){return null!=this.ZSg?this.ZSg:this.ZSg=
Wa.a.instance.resolve("Box4.IContentControlChpHelper")}get fU(){return null!=this.IVg?this.IVg:this.IVg=Wa.a.instance.resolve("Box4.IFieldEditor")}jei(b,h){this.kQl(b,h)}V3k(b,h,r,A){this.Ar.instance&&this.Ar.instance.Lh&&(b.cpBegin===h.cpBegin?b.Fb=h.Fb:r&&(b.Fb=r.Hb&&r.Hb.length?0:-1),b.Tb=A)}aKb(b){pf.a.aKb(b)}kQl(b,h){var r=b.node;const A=$M.b([new ic.a(b.cpBegin,b.cpEnd)],this.eQm(b));var L=new Ha.a,Z=[];HA.Qul(r,A,L,Z);for(const oa of L.keys)1<L.K(oa)&&VG.a.Jij(Q.a.Bf(oa));this.szo(r,Z);this.prc.vVc(r);
r=b.Tb;L=!!this.Ar.instance&&this.Ar.instance.Lh;for(Z=A.length-1;0<=Z;Z--)r=this.deleteRange(b,A[Z],r,L,h)}eQm(b){const h=[],r=b.node;var A=xl.f(r,oa=>oa.hka);for(var L of A)A=L.Ib.cp,h.push(new ic.a(A,A+1));L=[];Ut.a.mL?this.fU&&(L=this.fU.FIf(r,b)):L=Cd.ParagraphReader.wVa(r);for(var Z of L)this.Gon(Z,b)&&h.push(Z);Z=!!this.Ar.instance&&this.Ar.instance.$sa;this.Ar.instance&&this.Ar.instance.Lh||!Z||!r.Nv||(HA.L6h&&HA.L6h.pyo(b),this.C6&&h.push(...this.C6.Fvi(r).toArray()));return $M.a(h)}Gon(b,
h){return Ut.a.mL?this.fU?!this.fU.EWi(b,h):!1:!b.YM||!HA.SXf(b,h)}szo(b,h){const r=new nb.a;for(const A of h)for(h=0;h<A.length;){h=this.Hzi(A,h,0);if(-1===h)break;let L=this.Hzi(A,h+1,3);if(-1===L)break;if(A.K(h).YM)for(;L>=h;){const Z=A.K(L);r.add(Z.te);A.ZL(Z);L--}h=L+1}b.fna(r)}Hzi(b,h,r){for(;h<b.length;h++){const A=b.K(h);if(1===A.ir&&A.pe===r)return h}return-1}deleteRange(b,h,r,A,L){const Z=h.Dc,oa=h.end;h=null;A&&(h=b.node.ra.Dh(Z));Z<oa&&(A=xc.a.createTextRange(b.node,Z,oa),Ut.a.Gpb&&(A.Uea=
b.Uea,A.Pra=b.Pra),this.V3k(A,b,h,r),this.Cg.We(A,"",void 0,void 0,vb.a.FTc,!1,L));return r=h&&h.Hb&&h.Hb.length?h.Hb.length:-1}static get L6h(){return null!=HA.iTg?HA.iTg:HA.iTg=Wa.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator")}static SXf(b,h){return b.Dc>=h.cpBegin&&b.end<=h.cpEnd}static Qul(b,h,r,A){let L=0;b=b.ra;for(const Z of h)for(;L<b.length;){h=b.Ub(L);if(h.cp>=Z.Dc&&h.cp<Z.end&&(h.lc&&h.lc.Hzl&&A.push(h.lc),h.Ch))for(let oa=0;oa<h.Ch.length;oa++){const Ba=h.Ch.K(oa).uo.toString();
r.tb(Ba)?r.W(Ba,r.K(Ba)+1):r.W(Ba,1)}++L}}}Object(u.a)(HA,"DeleteParagraphContentStrategy",Wn,[]);class PI{static get cJ(){return ZM.a.instance}static tRl(b,h,r){if(1===r)return 32;b=h.node;return PI.cJ.bUd(b)?Vr.WQl(b,r):32}}Object(u.a)(PI,"DeleteUnsupportedObjectStrategy",null,[]);var WF=d(857),aN=d(529);class bN{constructor(b,h,r,A,L){this.LFp=b;this.ica=r;this.rd=A;this.actionId=h;this.utd=L}}Object(u.a)(bN,"DeleteActionData",null,[]);class Ti{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.kei=b;this.tg=
h;this.cJ=r;this.Op=A;this.Q_=L;this.Og=Z;this.nrj=oa;this.Cg=Ba;this.Qd=gb;this.ZHa=Ab}Unp(b){return!he.a.Zl(b)&&!he.a.Pfa(b)}FKm(b,h,r){var A;let L,Z,oa;if(!h&&b&&b.Nw&&(A=b.Qa)&&he.a.mf(A)&&this.Og.Wb(A.node)&&(L=A.node.ra.Dh(A.cpBegin))&&L.wn&&(Z=this.Klm(L))&&Z.hyperlink.wI&&(oa=this.tKm(b,Z.cp)))return oa;if(!b)return null;if(A=this.Wrp(b,h))return A;if(!r)return b;h=he.a.d8a(b,!h,{NE:!1,Du:!0,cH:!0,aJ:!0});return qc.SelectionFactory.Vy(b,h.Qa,!1)}Klm(b){const h=b.paragraph.ra;let r=null;b=
b.cp;for(let A=0;A<h.length;A++){const L=h.Ub(A);if(L.cp>=b)break;L.wn&&(r=null);L.hyperlink&&(r=L)}return r}wKm(b,h){var r=b.Qa.node;if(h){if(h=he.a.C_a(b.Qa.node,b.Qa.cpBegin,!0),b=qc.SelectionFactory.Vy(b,xc.a.Uc(b.Qa.node,h),!1),r=r.ra.Dh(h),r.w7||r.$_)b.Qa.Fb=0}else if(h=he.a.C_a(b.Qa.node,b.Qa.cpBegin,!1),b=qc.SelectionFactory.Vy(b,xc.a.Uc(b.Qa.node,h),!1),r=r.ra.Dh(h),r.w7||r.$_)b.Qa.Fb=r.mz+r.pS;b.Tnc=!0;return b}Wrp(b,h){var r=b.Qa;let A=null;if(!b.Nw||!r||!he.a.mf(r))return null;if(this.Og.Wb(r.node)&&
(A=h?r.node.ra.Dh(r.cpBegin):r.node.ra.T8a(r.cpBegin-1))&&A.BU)return this.wKm(b,h);r=hb.a.eb(b.Qa.node);if(!r.zb(8))return null;fg.OutlineElementNavigator.me(r);let L=!1;const Z=[];if(h?A&&A.ni:0===b.Qa.cpBegin){do(b=h?fg.OutlineElementNavigator.ft(r,!0,!0,!1):fg.OutlineElementNavigator.y3(r,!0,!0,!1))&&(null===b||void 0===b?0:b.qWa)?(Z.push(xc.a.create(fg.OutlineElementNavigator.Me(r))),fg.OutlineElementNavigator.me(r)):L=!0;while(!L);if(0<Z.length)return h=new Oq.Selection(h?Z:Z.reverse(),h),h.Tnc=
!0,h}return null}tKm(b,h){var r=he.a.HJa(b,{NE:!1,Du:!1,cH:!0,aJ:!0});if(!r||!r.Nw||r.Qa.node!==b.Qa.node)return null;r=r.Qa;if(r.cpBegin!==r.cpEnd)return null;const A=this.Og.text(r.node);for(let L=r.cpBegin-1;L>=h;L--)if(!F.a.Zw(A.charCodeAt(L)))return qc.SelectionFactory.Vy(b,xc.a.Uc(r.node,L+1),!1);return qc.SelectionFactory.Vy(b,xc.a.Uc(r.node,h),!1)}Bvf(b,h,r,A,L){var Z,oa;if(1===r)return 32;(r=null===(oa=null===(Z=h.view)||void 0===Z?void 0:Z.lb)||void 0===oa?void 0:oa.Pg)&&Object(Nl.a)().Hci(r).filter(Cd.ParagraphReader.xX).forEach(Ba=>
{var gb;return null===(gb=Cd.ParagraphReader.dKa(Ba.node))||void 0===gb?void 0:gb.Vxe("delete_selection")});oa=!1;b===vb.a.Stf?(b=vb.a.gI,oa=!0):b===vb.a.OYd?(b=vb.a.backspace,oa=!0):b===vb.a.Fza&&(h=new wr.a(ab.StaticActiveAppFrame.za().kb.Qc));if(!h.view.ve)return 2;Iz.GrippersManager.instance.gA(!1);Z=b===vb.a.gI;r=Bt.a.V2c(h);if(oa&&this.tg.Lh&&r&&he.a.ym(r)&&this.tg.eZf(r.Qa,!Z,!0))return 2;oa=this.FKm(r,Z,oa);return this.vRl(b,h,A,L,oa,Z)}vRl(b,h,r,A,L,Z){var oa;const Ba=h.view,gb=Ba.lb;var Ab=
A,Jb=A;b===vb.a.Fza&&(Jb=Ab=null,L=new Oq.Selection(A,!0));if(!L)return 32;const Tb=this.a3o(Ab,Z);if(this.tg.Lh&&Ti.uka&&1===gb.gb.length&&he.a.ym(L)&&L.Nw&&Ti.uka.lOo(L.Qa,Z)||Ut.a.mL&&Ti.fU&&1===gb.gb.length&&he.a.ym(L)&&L.Nw&&Ti.fU.mOo(L.Qa,Z))return 32;let jc;Z?db.a.mark(jc=5009):db.a.mark(jc=5011);Ab=new Sb.GraphTransaction(15);Ab.Ph=b;Ab.Ab(Ba.vd);let Hc=null,hd=({vMo:Hc}=this.Mnm(b,A,gb,L,Hc)).returnValue;var Gd=null;({Aze:Gd}=Object(Nl.a)().zCg(hd)).returnValue&&(hd=Gd);if(!hd)return Ab.dispose(),
32;Gd=!1;y.AFrameworkApplication.$c("b1jb9393;09icj321");if(null===(oa=y.AFrameworkApplication.J)||void 0===oa?0:oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))oa=hd.node,Gd=null===oa||void 0===oa?void 0:oa.Nv;const de=new bN(h,b,r,Jb,Gd);Jb=null;this.tg.Lh&&Ti.uka&&(Jb=Object(Nl.a)().EO(hd),Ti.uka.pBj(Jb));Ut.a.mL&&Ut.a.r7a&&Ti.fU&&1===gb.gb.length&&!he.a.ym(L)&&(Jb||(Jb=Object(Nl.a)().EO(hd)),Ti.fU.tyo(Jb));this.g2j(hd);const qe=this.tsi(hd,L,Z);let oe=null;
Z?oe=new WF.a(L):qe&&(oe=new WF.a(qe));let ge=!1;Jb=Ti.ml;if(he.a.mf(hd)){const $d=nH.a.ikc(Ba.vd,Tb);Jb.le(()=>{this.fQl(h,r,A,hd,Z,oe,L,$d,gb,Tb,de,qe)},"DVS:DAIPC")}else this.Qd.Bg&&!this.ZHa.jfe(L)?(Jb.le(()=>{this.Tnp(b,Ba.vd,hd,Z,L,gb,Tb,de,oe)},"DVS:TCDC"),ge=!0):Jb.le(()=>{ge=this.Gsj(b,Ba.vd,hd,gb,Tb,de,oe,Hc)},"DVS:PUD");this.eam(gb);this.mGj(hd);Ab.dispose();db.a.mark(jc+1);return b===vb.a.Fza?ge?32:8:32}Gsj(b,h,r,A,L,Z,oa,Ba){h=nH.a.ikc(h,L);this.Unp(r)&&h.afb(r);b=Ti.Ac.rq(b);b.properties.W("CountOfParagraphsDeleted",
this.Og.yrf(r).toString());r=this.JVl(r,A,L,h,Z,oa,Ba);b.end();return r}Tnp(b,h,r,A,L,Z,oa,Ba,gb){var Ab=0,Jb=null;const Tb=Object(Nl.a)().EO(r),jc=Tb[Tb.length-1];if(jc.contextId===kc.a.paragraph||jc.contextId===kc.a.Zc){var Hc=hb.a.eb(jc.node);Hc.Nd();fg.OutlineElementNavigator.me(Hc);fg.OutlineElementNavigator.ft(Hc,!0,!1)&&(Jb=fg.OutlineElementNavigator.Me(Hc))&&(Ab=this.Og.textLength(Jb))}else Ab=this.Og.textLength(jc.node)-jc.cpEnd;Hc=Object(Ca.a)(73,Ba.rd);if(Hc=!!Hc&&Hc.ka(Ge.a.kXf,!1))this.Esj(b,
h,r,Z,oa,Ba,gb,!1,Hc);else{Hc=this.Qd.S5a();try{this.Esj(b,h,r,Z,oa,Ba,gb,!0)}finally{Hc&&Hc.dispose()}}if(L.Tnc)Ab=this.tsi(r,L,A),this.Og.Wb(Ab.Qa.node)&&If.a.instance.Kc(Ab);else{if(A){if(r.Ww){b=Tb.length-1;do L=Tb[b],b--;while(!L.node.isConnected&&0<=b)}else L=r;if(!this.Og.Wb(L.node))return;switch(jc.contextId){case kc.a.paragraph:case kc.a.Zc:Ab=Jb&&Jb.isConnected?0:Ab;break;case kc.a.Vc:case kc.a.Cd:break;default:Ab=0}Ab=qc.SelectionFactory.ue(L.node,this.Og.textLength(L.node)-Ab);L.zj===
Ab.Qa.cpBegin&&(Ab.Qa.Fb=L.Fb)}else{Ab=L.Qa.node;if(!this.Og.Wb(Ab))return;Jb=L.Qa.contextId===kc.a.paragraph?0:L.Qa.contextId===kc.a.Zc?this.Og.textLength(Ab):L.Qa.cpBegin;Ab=qc.SelectionFactory.ue(Ab,Jb)}If.a.instance.Kc(Ab)}}Esj(b,h,r,A,L,Z,oa,Ba,gb=!1){r=this.Cem(A,r);r=Ti.ti.Spd(r);({type:Jb}=r.m9d()).returnValue&&Ba&&4!==Jb&&this.Qd.Yu(Jb);for(Ba=r.length-1;0<=Ba;--Ba){var Ab=void 0;var Jb=({Vfe:Ab}=r.getContext(Ba)).returnValue;Ab?(Ab=gb&&Jb.contextId===kc.a.Zc&&Ba===r.length-1,this.Op.zvb(Jb,
2),Ab||Ti.Lj.Fyb(Jb,2)):this.Gsj(b,h,Jb,A,L,Z,oa,null)}}Cem(b,h){if(Object(Gb.a)(cm.a,h)){b=An.OutlineElementGeneralizer.cla(b.gb,!0);for(let r=0;r<b.length;r++)if(b.getContext(r).contextId===kc.a.table)return b}return h}Mnm(b,h,r,A,L){b===vb.a.Fza?(b=Pv.a.IIa(h),L=aN.SelectionReferenceFactory.instance.WMb()):(L=null,b=1===r.gb.length?If.a.SMb(A):r.Pg);return{returnValue:b,vMo:L}}oll(b){return!b.Al||b.contextId!==kc.a.paragraph||!this.Og.Wb(b.node)||this.Qd.Bg||this.tg.Iee(b)?!1:!0}g2j(b){if(b.Ww)for(let h=
0;h<b.length;h++)this.g2j(b.getContext(h));else this.oll(b)&&(b.node.cUd=!0)}mGj(b){if(b.Ww)for(let h=0;h<b.length;h++)this.mGj(b.getContext(h));else b.Al&&(b=b.node)&&this.Og.Wb(b)&&(b.cUd=!1)}tsi(b,h,r){if(b.Al&&he.a.mf(b)&&!r){const A=b.node;let L=b.cpBegin,Z=-1;if(({cp:L}=this.tg.Lej(A,L)).returnValue)return qc.SelectionFactory.ue(A,L);if(({cp:L,Tqa:Z}=this.tg.Kej(b,L,Z)).returnValue)return h=qc.SelectionFactory.ue(A,L),h.Qa.Fb=Z,h.Qa.Tb=Z,h}h=he.a.d8a(h,!r,{NE:!h.Tnc||h.Nw,Du:!1,cH:!1,aJ:!0,
Tya:he.a.ym(h)});this.tg.Lh&&he.a.Zl(b)&&(h.Qa.Tb=h.Qa.Fb=r?b.Tb:b.Fb);return h}fQl(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb){const jc=Ti.ml;!he.a.UA(A.node,A,L)||this.tg.Lh&&this.tg.oYi(A)?jc.le(()=>{this.NQl(A,L,Z,oa,Ba,gb,Ab,Jb)},"DVS:IPM"):jc.le(()=>{const {response:Hc,j4:hd}=this.MQl(b,h,r,A,L,oa,Ba,gb,Jb,Tb);Ti.bhj(Ba,32===Hc);hd&&Ti.Mua(gb,Z)},"DVS:ISE")}vWm(b,h){h.rd||(h.rd=new lj.DictionaryPropertySet);h.rd.setValue(Ge.a.Cta,"delete");h.rd.setValue(Ge.a.qma,"backspace");var r=sf.ListItemReader.De?b:
b.hE;const A=Ti.Pd.M2(r),L=lv.Ayn;if(null===L||void 0===L?0:L.brn(r,A)){h.rd.setValue(Ge.a.qma,"backspace-autocorrect");r=L.S2j+" ";const Z=xc.a.Uc(b,0);this.Cg.We(Z,r);b=qc.SelectionFactory.ue(b,r.length);If.a.instance.Kc(b);v.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",L.S2j)}return y.AFrameworkApplication.va.Hf(h.LFp,A.Uz?vb.a.KN:vb.a.$E,2,!1,h.ica,h.rd)}RVm(b,h,r,A,L){let Z=!1;0<this.nrj.J2(b).Qu&&(L=y.AFrameworkApplication.va.Hf(h,vb.a.avc,2,!1,r,A),Z=!0);return{iX:Z,
response:L}}YVm(b,h,r,A,L){let Z=!1;0<this.nrj.qI(b).Qu&&(L=y.AFrameworkApplication.va.Hf(h,vb.a.ukd,2,!1,r,A),Z=!0);return{iX:Z,response:L}}bXm(b,h,r,A,L){let Z=!1;Ti.fr.ILb(b)&&(L=y.AFrameworkApplication.va.Hf(h,vb.a.KI,2,!1,r,A),Z=!0);return{iX:Z,response:L}}BUm(b,h,r,A,L,Z,oa,Ba,gb,Ab){const Jb=new zl.a;Jb.nd(h);let Tb=!1;if(fg.OutlineElementNavigator.bMa(Jb,!1,!b,!1)){Ab=!0;gb=32;Tb=!0;(new hb.a).nd(Jb);fg.OutlineElementNavigator.Me(Jb);const Hc=Jb.currentNode;Cd.ParagraphReader.hza(Hc)&&Cd.ParagraphReader.dKa(Hc).Vxe("delete_ip");
var jc=new hb.a;jc.set(oa);(jc=this.Og.isEmpty(jc))&&L&&he.a.fba(L.Qa)?(r.afb(Z),fg.OutlineElementNavigator.Me(h),Ti.Mf.pDa(h.currentNode)):Hc.CL?(r.afb(Z),fg.OutlineElementNavigator.me(Jb),Jb.Tg()):b&&jc?this.tg.Y_i(oa)&&!({j4:Ab}=this.Fvj(b,oa,Hc,L,Ab)).returnValue&&(r.afb(Z),Ti.Kl.Vga(h),this.kei.Qfo(oa),h.Tg()):si.TableReader.isTable(Jb)?(r.afb(Z),b&&(Kh.moveToFirstRow(Jb),Kh.moveToFirstColumn(Jb),fo.OutlineNavigator.Gba(Jb),fg.OutlineElementNavigator.Me(Jb),Ba.Kc((new WF.a(qc.SelectionFactory.ue(Jb.currentNode,
0))).restore())),gb=2,Ab=!1):this.Og.Wb(Hc)&&(1==this.Og.textLength(Hc)&&(Ba=xl.e(Hc),1==Ba.length&&8==Ba[0].Sh&&(Ba=xc.a.createTextRange(Hc,0,1),this.Cg.We(Ba,"",void 0,void 0,vb.a.FTc))),({j4:Ab}=this.Fvj(b,oa,Hc,L,Ab)).returnValue||(A.actionId==vb.a.backspace&&r.bAc(oa),this.kei.gQl(b,r,Z,h,oa,Jb)))}return{iX:Tb,response:gb,j4:Ab}}Fvj(b,h,r,A,L){if(this.Qd.Bg){if(Ti.bUa){const Z=Object(Gb.a)(On.AParagraphNode,r)?Ti.bUa.Jee(r):!1,oa=Object(Gb.a)(On.AParagraphNode,h)?Ti.bUa.Jee(h):!1;if(Z!==oa)return{returnValue:!1,
j4:L}}b=b?h:r;if(!Object(Gb.a)(On.AParagraphNode,b))return{returnValue:!1,j4:L};h=b.ra.last;r=y.AFrameworkApplication.userName;if(!h.Wi||h.Wi.authorName!==r)return Ti.Lj.Z_b(b,2),A&&(If.a.instance.Kc(A),L=!1),{returnValue:!0,j4:L}}return{returnValue:!1,j4:L}}nWm(b,h,r,A,L,Z,oa,Ba){Eb.a.wkn(h,b)||({response:oa,j4:Ba}=Ti.DWl(r,A,b,Z,L,oa,Ba));return{iX:!1,response:oa,j4:Ba}}MQl(b,h,r,A,L,Z,oa,Ba,gb,Ab){let Jb=!1,Tb=2;const jc=A.node;let Hc=void 0,hd=!1;const Gd=Ti.ml;if(!L){if(sf.ListItemReader.De?
sf.ListItemReader.isListItem(jc):jc.hE)return Gd.le(()=>{Tb=this.vWm(jc,gb)},"DVS:HLOE"),{response:Tb,j4:Jb};Gd.le(()=>{({response:Tb,iX:hd}=this.RVm(jc,b,h,r,Tb))},"DVS:HIOD");if(hd)return{response:Tb,j4:Jb};Gd.le(()=>{({response:Tb,iX:hd}=this.YVm(jc,b,h,r,Tb))},"DVS:HWPF");if(hd)return{response:Tb,j4:Jb};Hc=this.pAi(jc);Gd.le(()=>{({response:Tb,iX:hd}=this.bXm(Hc,b,h,r,Tb))},"DVS:HPOB");if(hd)return{response:Tb,j4:Jb}}null!==Hc&&void 0!==Hc?Hc:Hc=this.pAi(jc);Gd.le(()=>{({response:Tb,iX:hd,j4:Jb}=
this.BUm(L,Hc,oa,gb,Ab,A,jc,Ba,Tb,Jb))},"DVS:HAOE");if(hd)return{response:Tb,j4:Jb};Gd.le(()=>{({response:Tb,iX:hd,j4:Jb}=this.nWm(L,Hc,h,r,oa,Z,Tb,Jb))},"DVS:HFLOE");return{response:Tb,j4:Jb}}j3o(b){return he.a.Zl(b)||this.cJ.x3i(b)||he.a.Pfa(b)}a3o(b,h){return b&&b.hasProperty(Od.a.tZc)?!b.ka(Od.a.tZc,!1):!h}static get Pd(){return null!=Ti.s0g?Ti.s0g:Ti.s0g=Wa.a.instance.resolve("Box4.List.IListReader")}static get Kl(){return null!=Ti.i0g?Ti.i0g:Ti.i0g=Wa.a.instance.resolve("Box4.List.IListEditor")}static get Mf(){return null!=
Ti.o1g?Ti.o1g:Ti.o1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}static get fr(){return vw.a.zQb}static get Lj(){return null!=Ti.C5g?Ti.C5g:Ti.C5g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get ti(){return null!=Ti.l6g?Ti.l6g:Ti.l6g=Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ac(){return ih.a.instance}static get uka(){Ti.gEb||(Ti.gEb=Wa.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return Ti.gEb.instance}static get fU(){Ti.OEf||
(Ti.OEf=Wa.a.instance.Ta("Box4.IFieldEditor"));return Ti.OEf.instance}static get bUa(){return null!=Ti.lTg?Ti.lTg:Ti.lTg=Wa.a.instance.Oa("Box4.IContentControlReader")}static get Lkn(){var b;y.AFrameworkApplication.$c("fontfix;fontfix-cf");return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.fontFixIsEnabled",!1)}static get ml(){return Cq.a.instance}eam(b){if(1===b.gb.length&&(b=b.gb.K(0),he.a.ym(b))){var h=b.Qa;b=h.node;h=h.cpBegin;var r=
this.Og.text(b);h<r.length&&0<h&&" "===r.charAt(h-1)&&" "===r.charAt(h)&&this.Cg.We(xc.a.createTextRange(b,h-1,h),"\u00a0")}}ecl(b,h){if(!h.hyperlink.otb){const r=new Sb.GraphTransaction(15);try{r.Ab(b.node),this.Q_.fV(b,h)}finally{r&&r.dispose()}h.hyperlink.wI&&this.Qd.Yu(2)}}static DWl(b,h,r,A,L,Z,oa){if(r=he.a.d8a(A,!r,{NE:!1,Du:!1,cH:!1,aJ:!0})){A=qc.SelectionFactory.Vy(A,r.Qa);Z=32;for(r=0;r<A.length;++r){L.afb(A.K(r));const Ba=y.AFrameworkApplication.va.Hf(A.K(r),vb.a.gI,2,!0,b,h);2!==Ba&&(Z=
Ba)}32===Z&&(oa=!0)}return{response:Z,j4:oa}}JVl(b,h,r,A,L,Z,oa){let Ba=!1;this.k3o(b)?(Ba=Ti.Wwf(b,!0,h,r,A,L))&&Ti.XOa(Z,h,oa):this.j3o(b)?(Ba=Ti.Wwf(b,!1,h,r,A,L))&&Ti.XOa(Z,h,oa):(A.normalize(),Ti.XOa(Z,h,oa));return Ba}static XOa(b,h,r){r&&r.Mua()||Ti.Mua(h,b)}static Wwf(b,h,r,A,L,Z){var oa;A||fm.OutlineReader.cXa(b)||(r=Ti.qsd(r))&&L.t_o(r);y.AFrameworkApplication.$c("b1jb9393;09icj321");if(null===(oa=y.AFrameworkApplication.J)||void 0===oa?0:oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))Z.rd?Z.rd.utd=Z.utd:Z.rd={utd:Z.utd};oa=b instanceof cm.a?b.getContext(0).node:b.node;this.Lkn&&(b instanceof cm.a&&0<b.length?(r=b.getContext(0),A=b.getContext(b.length-1),r.contextId==kc.a.paragraph&&A.contextId==kc.a.paragraph&&r.node.id.toString()==this.Ooe.mic().id&&A.node.id.toString()==this.Ooe.Kad().id&&this.p4.xVc(oa,!0)):b.contextId==kc.a.paragraph&&b.node.id.toString()==this.Ooe.mic().id&&b.node.id.toString()==this.Ooe.Kad().id&&this.p4.xVc(oa,!0));oa=Ti.FDm(oa);b=32===y.AFrameworkApplication.va.Hf(b,
Z.actionId,2,h,Z.ica,Z.rd);Ti.bhj(L,b,oa);return b}static get tj(){return null!=Ti.wWg?Ti.wWg:Ti.wWg=Wa.a.instance.resolve("Box4.IFormattingEditor")}static get uzb(){return null!=Ti.g4g?Ti.g4g:Ti.g4g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get p4(){return null!=Ti.c4g?Ti.c4g:Ti.c4g=Wa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Ooe(){return null!=Ti.Q1g?Ti.Q1g:Ti.Q1g=Wa.a.instance.resolve("Box4.IParagraphCollection")}static FDm(b){const h=new iq.a;if(b){let r=
null;b=qc.SelectionFactory.qp(b,!0);if(!b)v.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let A=0;A<b.length;A++)if(Ya.FormattingReader.uqf(b.K(A))){r=b.K(A);break}r&&((b=Ya.FormattingReader.Vs(r))&&b.cache&&b.cache.tE&&(b=b.Of(null),Ti.tj.p8(b)),b&&(h.formatting=b.Hk,h.languageId=Ya.FormattingReader.language(b)),h.goa=Ti.uzb.Cq(r.node))}return h}static bhj(b,h,r){h?b.normalize(r):b.cancel()}static Mua(b,h){h&&Ti.ml.le(()=>{const r=h.restore();r&&b.Kc(r)},"DVS:RS")}NQl(b,
h,r,A,L,Z,oa,Ba){let gb;!h&&({hyperlink:gb}=this.Q_.eoc(b)).returnValue?(r=new WF.a(A),this.ecl(b,gb),L.normalize(),Ti.Mua(Z,r)):Ti.Wwf(b,!1,Z,oa,L,Ba)&&(h&&this.Qd.Bg?(h=Ti.Lj.SXd)?(Z.Kc(qc.SelectionFactory.ue(b.node,h)),Ti.Lj.SXd=null):Ti.Mua(Z,r):Ti.Mua(Z,r))}k3o(b){return b.Ww||fm.OutlineReader.cXa(b)||this.Og.en(b)}static qsd(b){return(b=An.OutlineElementGeneralizer.cla(b.gb,!0))&&1===b.length&&(b=b.getContext(0).node,si.TableReader.kP(b))?b:null}pAi(b){const h=new hb.a;h.set(b);h.Nd();fg.OutlineElementNavigator.me(h);
return h}}Ti.gEb=null;Ti.OEf=null;Object(u.a)(Ti,"ADeleteViewStrategy",null,[]);class Ht{gQl(b,h,r,A,L,Z){const oa=Z.currentNode;fg.OutlineElementNavigator.me(Z);b?(h.bAc(Z.currentNode),Ht.tg.EZi(r,L,oa,!1)||Ht.Mf.merge(A,Z,!1,!1)):Ht.tg.EZi(r,oa,L,!0)||Ht.Mf.merge(Z,A,!1,!1)}Qfo(b){b&&Cd.ParagraphReader.Wb(b)&&(PB.a.pkd(b),Ht.nyf.lgf(b))}static get Mf(){return null!=Ht.k1g?Ht.k1g:Ht.k1g=Wa.a.instance.resolve("Box4.IOutlineElementEditor")}static get nyf(){return null!=Ht.hUg?Ht.hUg:Ht.hUg=Wa.a.instance.resolve("Box4.IDynamicRangeEditor")}static get tg(){return Be.a.instance}}
Object(u.a)(Ht,"DeleteParagraphNodeStrategy",null,[425]);class cN extends Ti{constructor(b,h,r,A,L,Z,oa,Ba,gb){super(new Ht,b,h,r,A,L,Z,oa,Ba,gb)}}Object(u.a)(cN,"DeleteViewStrategy",Ti,[]);class bE extends Vr{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb){super();this.deleteParagraph=(jc,Hc)=>{jc=Hc.node;PB.a.pkd(jc);this.Zzd.lgf(jc);this.Ep&&this.Ep.instance&&this.Ep.instance.jmj(jc);jc.Nv&&(this.Wm.oyo(jc,!this.Lh),this.Lh&&this.Wih.instance&&this.Wih.instance.A6j(jc));return 0};this.eQl=(jc,Hc,hd)=>
{if(1===hd)return 32;jc=ab.StaticActiveAppFrame.za().Vr.Xf("ModelUpdate","DeleteAnchoredObject");Hc=Hc.node;hd=new hb.a;hd.set(Hc);hd.zb(12);var Gd=hd.Dp(12);if(Be.a.instance.d$c(Gd))return 2;pf.a.aKb(Gd);Gd=new Sb.GraphTransaction(7);Gd.Ab(Hc);hd.Tg();Gd.dispose();jc.stop();return 32};this.itk=new HA;this.ktk=new cN(Be.a.instance,ZM.a.instance,Z,oa,Ba,gb,Ab,Jb,Tb);this.Wm=b;this.XHc=h;this.Wih=r;this.Zzd=A;this.Ep=L}get Lh(){return this.XHc.instance?this.XHc.instance.Lh:!1}get tei(){return this.ktk}get iei(){return this.itk}Hpg(b,
h,r,A){const L=PI.tRl,Z=this.eQl;b.qa(vb.a.backspace,kc.a.L$,Z);b.qa(vb.a.backspace,kc.a.POa,L);b.qa(vb.a.gI,kc.a.L$,Z);b.qa(vb.a.gI,kc.a.POa,L);b.qa(vb.a.backspace,kc.a.paragraph,this.deleteParagraph);b.qa(vb.a.gI,kc.a.paragraph,this.deleteParagraph);b.qa(vb.a.Fza,kc.a.paragraph,this.deleteParagraph);b.Pc(vb.a.Fza,64);super.Hpg(b,h,r,A)}static aKb(b){var h;(null===(h=pf.a.xd())||void 0===h?0:h.xm)&&pf.a.xd().Bk.IG(b)}}Object(u.a)(bE,"DeleteActor",Vr,[]);class KK{constructor(){this.Height=this.Width=
0}static construct(b,h){const r=new KK;r.Width=b;r.Height=h;return r}}Object(u.a)(KK,"ViewportInfo",null,[]);class RL extends Aq.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Om(){return RE.a.bhp}static construct(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){const Tb=new RL;Tb.ContractVersion=b;Tb.DocumentContent=h;Tb.EnhancementId=r;Tb.World=
A;Tb.ScalingFactor=L;Tb.DesktopViewportInfo=KK.construct(Z,oa);Tb.MobileViewportInfo=KK.construct(Ba,gb);Tb.MinParagraphCount=Ab;Tb.ContentCulture=Jb;return Tb}}Object(u.a)(RL,"SwayPreviewRequest",Aq.a,[]);var AO=d(608);class XF{static get mh(){return Dg.a.uy(XF.CTl,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,XF.rLo,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}
XF.rLo=tj.a.Aj("progress.gif");XF.CTl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(u.a)(XF,"DigitalPrintDialogHtml",null,[]);class Fu{constructor(b,h,r,A){this.fontFamily=b;this.dIo=h;this.fontWeight=r;this.fontStyle=A}}Object(u.a)(Fu,"FontInfo",null,[]);class Wr{constructor(b,h,r,A){this.styleName=b;this.title=h;this.Olp=r;this.f0m=A}}Object(u.a)(Wr,"StyleVisualInfo",null,[]);class cE extends Dg.a{constructor(b,h,r,A,L=!0){super();this.N9=this.Km=this.tpa=this.E5=this.CCd=this.KGh=this.zNd=this.H9e=this.I9e=this.Z8e=this.tac=this.ySa=this.R5=this.N$b=null;this.tbf=this.g5e=
!1;this.rBd=null;this.KXl=()=>{this.wJj(0)};this.JXl=(Z,oa)=>{this.wJj(oa)};this.Boj=Z=>{this.uAi(Z)===Sys.UI.Key.enter&&(this.Zfg(Z),Z.preventDefault(),Z.stopPropagation())};this.Hkj=Z=>{((Z=Z.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===Z.id||Z.id===ff.a.Wvd)||aa.a.As)&&this.ySa&&this.z_b(this.ySa)};this.Ikj=Z=>{const oa=this.uAi(Z);oa!==Sys.UI.Key.tab&&oa!==Sys.UI.Key.left&&oa!==Sys.UI.Key.right&&oa!==Sys.UI.Key.up&&oa!==Sys.UI.Key.down||this.GXm(oa)||(Z.preventDefault(),Z.stopPropagation(),
this.JZn(oa))};this.feg=()=>{this.tbf||(this.tbf=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),zc.a.removeHandler(this.R5,od.a.scroll,this.feg))};this.Jeg=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.Zfg=Z=>{Z.preventDefault();Z.stopPropagation();y.AFrameworkApplication.va.Ob(vb.a.Mfi,2);Z.target?(Z="button"===Z.target.tagName.toLowerCase()?Z.target:Z.target.parentNode)&&Z.id!==this.N$b&&(v.ULS.sendTraceTag(25231813,382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",
this.N$b,Z.id),this.x0h(Z),this.mai()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.lUl=Z=>{const oa=(new Date).getTime()-this.Beh;qg.a.instance.rf(qh.a.nUl,oa);Z?this.AQo():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),y.AFrameworkApplication.va.Ob(vb.a.Lfi,2))};this.yQo=()=>{this.S9o();try{const Z=cE.khi.u5l(),oa=RL.construct(2,Z,this.N$b,"VerticalWorld",
.3,1366,600,330,280,20,cE.khi.ohb.name);y.AFrameworkApplication.Fe.Xj(String.format("{0}/we/GetSwayPreview.ashx?{1}",ed.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,AO.b(oa),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.Ygo,this.Vuj,oa)}catch(Z){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",Z.message)}};this.Ygo=Z=>{var oa=null;({group:oa}=hn.a.D4(Z.data.Pe)).returnValue?(oa=oa.Responses[0],oa.Succeeded?
(this.Zhe(Z.data,qh.a.chp),this.mnb(),this.ePj(this.H9e,oa.PreviewHtml),this.ePj(this.zNd,oa.PreviewHtmlMobile)):this.Vuj(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.Vuj=()=>{this.T9o();this.I9e.style.background="#E6E6E6";this.KGh.style.background="#E6E6E6"};this.mh=XF.mh;this.Ig="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,382,50,"Print to Web dialog has been opened and we initiated document force save");
this.ZJk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.W5b=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.oPk=r;this.tHc=A;this.Ke(1,this.ZJk);this.Uh(this.W5b,this.lUl,null);this.p8m();this.Jfp();this.Beh=(new Date).getTime();L&&Ty.a.iU(Bz.a.zwf,!1,this.KXl,this.JXl,null);this.A9m();this.O6m();this.UBn();this.F4f();this.LBn();this.mai()}get hAa(){return this.rBd}wJj(b){if(!this.g5e){const h=(new Date).getTime()-this.Beh;qg.a.instance.rf(qh.a.mUl,h);b?v.ULS.sendTraceTag(25548302,
382,15,String.format("We failed to save document with status code {0}",Kc.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.a6a.disabled=!1}}p8m(){this.tac=document.getElementById("digitalPrintStatusMessageDiv");this.Z8e=document.getElementById("digitalPrintStatusMessageIconDiv");this.I9e=document.getElementById("swayDesktopPreviewWrapperDiv");this.H9e=document.getElementById("swayDesktopPreviewHtmlHolder");
this.zNd=document.getElementById("swayMobilePreviewHtmlHolder");this.KGh=document.getElementById("swayMobilePreviewWrapperDiv");this.R5=document.getElementById("swayGallery");this.R5.setAttribute("tabindex","0");zc.a.addHandler(this.R5,od.a.scroll,this.feg);this.R5.setAttribute($c.a.Wh,$c.a.eUh);this.E5=document.getElementById("digitalPrintLearnMoreLink");this.E5.href="https://go.microsoft.com/fwlink/?linkid=871972";zc.a.addHandler(this.E5,od.a.click,this.Jeg);this.tpa=new nb.a;this.CCd=document.getElementById("homeWrapper");
this.x8("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.tHc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}A9m(){this.Km=new nb.a;this.Km.add(new Wr("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));this.Km.add(new Wr("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,
"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Km.add(new Wr("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Km.add(new Wr("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));this.Km.add(new Wr("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,
"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Km.add(new Wr("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Km.add(new Wr("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Km.add(new Wr("CelestialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle",
"swaySwirlHeading swayCelestialHeading"));this.Km.add(new Wr("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Km.add(new Wr("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Km.add(new Wr("Lucent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle",
"swaySimplicityHeading swayLucentHeading"));this.Km.add(new Wr("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Km.add(new Wr("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Km.add(new Wr("Muse",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle",
"swayLightProHeading swayMuseHeading"));this.Km.add(new Wr("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Km.add(new Wr("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Km.add(new Wr("ConvergenceV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle",
"swayVanillaHeading swayConvergenceHeading"));this.Km.add(new Wr("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Km.add(new Wr("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Km.add(new Wr("Aurora",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle",
"swaySwirlHeading swayAuroraHeading"));this.Km.add(new Wr("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Km.add(new Wr("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}O6m(){this.N9=new nb.a;this.N9.add(new Fu("universc","universc","normal","normal"));this.N9.add(new Fu("Miller-Banner_Roman_WebTT",
"Miller-Banner_Roman_WebTT","normal","normal"));this.N9.add(new Fu("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.N9.add(new Fu("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.N9.add(new Fu("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.N9.add(new Fu("Posterama-Regular","Posterama-Regular","normal","normal"));this.N9.add(new Fu("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.N9.add(new Fu("Benton_Modern-Roman_WebTT",
"Benton_Modern-Roman_WebTT","normal","normal"));this.N9.add(new Fu("ArialNova","ArialNova","normal","normal"));this.N9.add(new Fu("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.N9.add(new Fu("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.N9.add(new Fu("RockwellNova","RockwellNova","normal","normal"));this.N9.add(new Fu("SabonNRegLT","SabonNRegLT","normal","normal"));this.N9.add(new Fu("DaytonaThin","DaytonaThin","100","normal"))}UBn(){const b=document.createElement("style");
b.setAttribute("type","text/css");let h="";for(const r of this.N9)h+=String.format(this.oPk,r.fontFamily,r.dIo,r.fontWeight,r.fontStyle);b.innerText=h;this.CCd.appendChild(b)}LBn(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",tj.a.Aj("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}",
"swayPreviewFrameBackground",tj.a.Aj("SwayPreviewFrameHC.svg"));b.innerText=h+r;aa.a.Nr&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.CCd.appendChild(b)}uAi(b){return b?b.keyCode:window.event.keyCode}hide(){this.uqg();super.hide()}uqg(){if(this.R5&&!this.g5e){for(let b=0;b<this.tpa.count;b++)zc.a.removeHandler(this.tpa.K(b),od.a.click,this.Zfg),zc.a.removeHandler(this.tpa.K(b),od.a.ij,this.Boj);zc.a.removeHandler(this.R5,od.a.ij,this.Ikj);zc.a.removeHandler(this.R5,od.a.focus,
this.Hkj);zc.a.removeHandler(this.E5,od.a.click,this.Jeg);this.tbf||zc.a.removeHandler(this.R5,od.a.scroll,this.feg);this.g5e=!0}}F4f(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",tj.a.efl());this.CCd.appendChild(b);for(const h of this.Km)this.Csf(this.R5,h);this.e4(this.R5);this.x0h(this.R5.firstChild);this.R5.firstChild.focus();zc.a.addHandler(this.R5,od.a.ij,this.Ikj);zc.a.addHandler(this.R5,od.a.focus,this.Hkj)}Csf(b,
h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute($c.a.vmb,$c.a.DO);r.setAttribute("title",h.title);r.setAttribute($c.a.Wh,$c.a.hUh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);b.src=tj.a.Aj("swayPublish.png");b.setAttribute($c.a.Wh,$c.a.xA);b.setAttribute("unselectable","on");b.setAttribute($c.a.wA,$c.a.mq);b.id=h.styleName+
"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.Olp;b.setAttribute($c.a.wA,$c.a.mq);b.setAttribute("unselectable","on");b.setAttribute($c.a.Wh,$c.a.xA);r.appendChild(b);const A=document.createElement("label");A.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;A.className=h.f0m;A.setAttribute($c.a.wA,$c.a.mq);b.setAttribute("unselectable","on");A.setAttribute($c.a.Wh,$c.a.xA);r.appendChild(A);zc.a.addHandler(r,od.a.click,this.Zfg);zc.a.addHandler(r,
od.a.ij,this.Boj);this.tpa.add(r)}JZn(b){const h=this.hAa;this.Ebm(b,h,!y.AFrameworkApplication.isRtl)||this.Gbm(b,h,!y.AFrameworkApplication.isRtl)||this.Bbm(b,h)||this.Cbm(b,h)}GXm(b){return b===Sys.UI.Key.tab?(this.hAa&&this.hAa!==this.ySa&&(this.hAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.rBd=this.ySa),!0):!1}Ebm(b,h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.R5.firstChild,this.z_b(b),!0):!1}Gbm(b,h,r){return b===Sys.UI.Key.left&&
r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.R5.lastChild,this.z_b(b),!0):!1}Bbm(b,h){return b===Sys.UI.Key.down?(b=this.tpa.indexOf(h),h=b+2,h<this.tpa.count?(b=this.tpa.K(h))&&this.z_b(b):(h=b%2+1,h=2<=h?0:h,(b=this.tpa.K(h))&&this.z_b(b)),!0):!1}Cbm(b,h){b===Sys.UI.Key.up&&(b=this.tpa.indexOf(h),h=b-2,0<=h?(b=this.tpa.K(h))&&this.z_b(b):(h=b?20+b-1:this.tpa.count-1,(b=this.tpa.K(h))&&this.z_b(b)))}z_b(b){this.hAa&&this.hAa.id!==this.ySa.id&&(this.hAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");
this.rBd=b;this.hAa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.hAa.focus()}Jfp(){this.a6a.className="WACDialogButtonNormal swayPrintToWebButton";this.a6a.setAttribute("tabindex","0");this.lB.className="WACDialogButtonNormal swayCancelButton";this.lB.setAttribute("tabindex","0");this.a6a.disabled=!0}x0h(b){this.hAa&&(this.hAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.ySa&&(this.ySa.className=
"swayGalleryItem swayClip136x90 swayImageBorderButton",this.ySa.setAttribute($c.a.vmb,$c.a.DO));this.N$b=b.id;this.ySa=b;this.ySa.setAttribute($c.a.vmb,$c.a.mq);this.rBd=b;this.hAa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}mai(){zf.a.instance.$b(new mf.a(2,1,50,this.yQo))}ePj(b,h){b.innerHTML=h}AQo(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",
this.N$b));y.AFrameworkApplication.va.Ob(vb.a.Nfi,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",ed.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature,y.AFrameworkApplication.userSessionId,this.N$b);rd.a.openWindow(4,b)}Zhe(b,h){qg.a.instance.rf(h,+b.IO-+b.jH)}T9o(){var b=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.mnb();this.tac.innerText=b;this.tac.style.display="block"}S9o(){this.mnb();this.Z8e.style.display="block";
this.tac.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.tac.style.display="block"}mnb(){this.I9e.style.background="";this.zNd.style.background="";Je.a.KT(this.H9e);Je.a.KT(this.zNd);this.tac.style.display="none";this.Z8e.style.display="none"}static get khi(){return null!=cE.cUg?cE.cUg:cE.cUg=Wa.a.instance.Oa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(u.a)(cE,"DigitalPrintDialog",Dg.a,[]);class SL{constructor(b,h){this._context=this.tl=null;
this.fMe=0;this.zxd=!1;this.zFh=null;this.zwf=(r,A,L,Z,oa)=>{if(1===L)return y.AFrameworkApplication.cG?8:32;this.zFh=oa.SourceControlId;if(y.AFrameworkApplication.J.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.Qxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=A;if(SL.Ynn())return v.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),
this.csf(),32;switch(this.fMe){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.csf();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.Qxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.zxd=!1,this.tl=(new jo.a).create(),this.tl.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,
this.tl.aM(CommonUIStrings.l_DefaultDialogTitle,this.jql,null),y.AFrameworkApplication.Fe.Xj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",ed.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.lql,this.kql,null)}return 32};this.jql=()=>{this.zxd=!0;v.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.lql=r=>{if(!this.zxd){this.tl.close();var A=null;this.Zhe(r.data,qh.a.ahp);({group:A}=hn.a.D4(r.data.Pe)).returnValue?
(r=A.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.fMe=r.HasLicense?1:2,2===this.fMe?this.Qxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):this.csf()):this.Qxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),
this.Qxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.kql=r=>{this.zxd||(this.tl.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.Zhe(r.data,qh.a.$gp),this.Qxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};this.ga=b;this.C9=h}Xb(){y.AFrameworkApplication.dV?v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&
y.AFrameworkApplication.J.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(vb.a.cZc,kc.a.view,this.zwf,4),this.ga.fb(vb.a.Mfi,kc.a.view,Vd.ActionManager.cU,4),this.ga.fb(vb.a.Nfi,kc.a.view,Vd.ActionManager.cU,4),this.ga.fb(vb.a.Lfi,kc.a.view,Vd.ActionManager.cU,4),this.ga.fb(Za.a.g_d,kc.a.view,Vd.ActionManager.cU,4))}csf(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",
this.zFh);new cE(this._context,this.ga,y.AFrameworkApplication.J.jb("SwayFontDownloadUrlTemplate"),y.AFrameworkApplication.J.jb("FileSource"))}Qxc(b){const h=new Ag.StandardDialog;h.Bd=0;h.Cna(CommonUIStrings.l_DefaultDialogTitle,b,null)}Zhe(b,h){qg.a.instance.rf(h,+b.IO-+b.jH)}static Ynn(){return"OneDriveWOPI"===y.AFrameworkApplication.J.jb("FileSource")}}Object(u.a)(SL,"DigitalPrintActor",null,[]);class dN{constructor(){this.DIh=null}S$i(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}p4j(b){if(!b)return v.ULS.sendTraceTag(25007842,
375,15,"Error range is null"),!1;if(!this.I3i(b.errorDetails))return!1;this.DIh=Object(Ca.a)(Vo.a,b.errorDetails).typeId;return!0}Vod(b){return this.I3i(b)?Object(Ca.a)(Vo.a,b).typeId===this.DIh:!1}I3i(b){if(!b)return v.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Ca.a)(Vo.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(u.a)(dN,"DoNotCheckThisCritiqueTypeStrategy",
null,[399]);class eN extends Dg.a{constructor(b,h,r){super(!1,!1,!0);this.Pb=b;this.$ra=r;this.Ttk="DocumentChoiceGroup";this.cgh="EmbededContent";this.Flh="HyperLink";this.YYe=r.ghb;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.V1c()};this.opk=this.a5l.bind(this);this.Ke(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Uh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.opk,b)}V1c(){const b=Array(2);b[0]=
{["key"]:this.cgh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.Flh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const h={};h.documentChoiceGroupProps={["id"]:this.Ttk,["defaultSelectedKey"]:this.YYe?this.cgh:this.Flh,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;
h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;return h}a5l(b,h){1===b?(this.YYe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Ec.a.VUa:Ec.a.xpb,this.Pb.Ob(b,2),this.YYe=h.isExternalContentSelected,Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",
dataFields:[Object.assign(new da.a,{name:"ActionId",int64:b})]}))),this.$ra.RLo(h.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(u.a)(eN,"ExternalContentDefaultSettingsDialog",Dg.a,[]);class Xr{constructor(b,h,r,A,L){this.bO=Wa.a.instance.resolve("Common.IReactContextualUILauncher");this.fCb=Tg.a.On;this.Mxc=()=>{const Z=Array(1);Z.push("ExternalContent");var oa=Wa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").xVa();
oa=Object.assign(new wj.a,{x:oa.x,y:oa.y});this.bO.showFloatie(oa,Z,1);return 32};this.GRb=()=>{this.bO.f3&&this.bO.dismissFloatie();return 32};this.Rwj=(Z,oa,Ba,gb,Ab)=>{if(oa="object"===typeof Ab?Ab:null)Z===Ec.a.hng?(Z=Xr.X2a!==Ec.a.VUa&&Xr.X2a!==Ec.a.xpb,oa[this.fCb]=Xr.X2a===Ec.a.VUa||Z):Z===Ec.a.ing&&(oa[this.fCb]=Xr.X2a===Ec.a.xpb);return 32};this.fmi=(Z,oa,Ba)=>{1!==Ba&&(Z===Ec.a.xpb&&Xr.X2a!==Ec.a.xpb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.En.undo()&&
(oa=new Wx.a(1,y.AFrameworkApplication.isRtl),oa.Pgd="ExternalContent",Xr.wpb.qjd(oa))):Z===Ec.a.VUa&&Xr.X2a!==Ec.a.VUa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.Xgh.ryj()),Xr.X2a=Z);Y.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new da.a,{name:"behavior",string:Ba.toString()}),
Object.assign(new da.a,{name:"ActionId",int64:Z})]}));return 32};this.ga=b;this.En=h;this.Xgh=A;this.pAk=L;this.npk=this.b5l.bind(this);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Xgh.kAj(()=>{this.reset()})}Xb(){this.ga.fb(Ec.a.hng,kc.a.view,this.Rwj,97);this.ga.fb(Ec.a.ing,kc.a.view,this.Rwj,97);this.ga.fb(Ec.a.emi,kc.a.view,this.npk,1028);this.ga.fb(Ec.a.VUa,kc.a.view,this.fmi,1028);this.ga.fb(Ec.a.xpb,kc.a.view,this.fmi,1028);this.pAk||
(this.ga.fb(Ec.a.Mxc,kc.a.view,this.Mxc,96),this.ga.fb(Ec.a.GRb,kc.a.view,this.GRb,96))}c8o(b){new eN(this.ga,b,Xr.$ra)}b5l(b,h,r){1!==r&&this.c8o(Xr.X2a);return 32}static get wpb(){return null!=Xr.AUg?Xr.AUg:Xr.AUg=Wa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get $ra(){Xr.MFa||(Xr.MFa=Wa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Xr.MFa}reset(){Xr.X2a=null!=Xr.$ra?Xr.$ra.ghb?Ec.a.VUa:Ec.a.xpb:Ec.a.VUa}}Xr.X2a=Ec.a.VUa;Xr.MFa=null;
Object(u.a)(Xr,"ExternalContentActor",null,[]);class Vw extends Xx{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){super(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb);this.n8c=jc;this.z1d=!1;this.fnh=null}Tjd(){this.z1d||(super.Tjd(),this.z1d=!0)}aEe(){this.z1d&&(super.aEe(),Vw.nii&&this.fnh&&Vw.nii.removeHandler(oD.a.FHa,this.fnh),this.z1d=!1)}h2b(){if(this.n8c){this.jza.f3&&this.jza.dismissFloatie();const b=new Wx.a(0,y.AFrameworkApplication.isRtl);b.location=this.qcb.xVa();this.showFloatie(null,b)}else this.jza.f3&&
y.AFrameworkApplication.va.Ob(Ec.a.GRb,2),y.AFrameworkApplication.va.Ob(Ec.a.Mxc,2);this.fpc=!1}dismissFloatie(b){!this.OWe&&(b&&(this.qcb.BVf(),this.r5j()),this.jza.f3||this.lRa)&&(this.lRa=!b,this.aEe(),this.n8c?this.jza.dismissFloatie():y.AFrameworkApplication.va.Ob(Ec.a.GRb,2))}showFloatie(b,h){h||(h=new Wx.a(0,y.AFrameworkApplication.isRtl));h.location||(h.location=this.qcb.xVa());if(!h.location)return!1;this.lRa&&(this.lRa=!1,this.Tjd());this.n8c?(b=Array(1),b.push("ExternalContent"),this.jza.showFloatie(this.qcb.xVa(),
b,1)):y.AFrameworkApplication.va.Ob(Ec.a.Mxc,2);return!0}nYc(){if(!this.fpc){const b=new mf.a(3,1,this.xci,()=>{this.h2b()},196);zf.a.instance.$b(b);this.fpc=!0}}hna(){this.n8c?this.jza.f3&&this.jza.dismissFloatie():y.AFrameworkApplication.va.Ob(Ec.a.GRb,2);this.nYc()}b_b(){this.n8c?this.jza.f3&&this.jza.dismissFloatie():y.AFrameworkApplication.va.Ob(Ec.a.GRb,2);this.nYc()}static get nii(){return null!=Vw.jUg?Vw.jUg:Vw.jUg=Wa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(u.a)(Vw,"ExternalContentFloatieEventManager",
Xx,[]);class dE extends Kv{constructor(b,h,r,A,L){super(b,h,r,A,L)}nZh(){if(!this.ib||!this.ib.gb||!this.ib.gb.currentSelection)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.gb.currentSelection.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.CL){do r=this.sEi(r);while(r&&!r.CL&&Object(Gb.a)(On.AParagraphNode,r)&&!r.characterData.trim().length)}let A="";const L=Object(Ca.a)(On.AParagraphNode,r);L&&(A=
L.characterData.length===b.cpBegin||h?L.characterData.trimEnd():L.characterData.substring(0,b.cpBegin).trimEnd());h=L?A.length:b.cpBegin;b=Object.assign(new fB,{SCa:Object(Ca.a)(139,(L?Object(Ca.a)(139,L):Object(Ca.a)(139,r))||b.node),Atc:h});return this.SIf(b)}lzi(b,h){let r=null;const A=Object(Ca.a)(379,b.SCa.jm(h.Ic));if(!A)return null;if(Object(Gb.a)(On.AParagraphNode,b.SCa)){const L=Object(Ca.a)(On.AParagraphNode,b.SCa);if(L.RT){if(b=Object(Ca.a)(Jz.a,Cd.ParagraphReader.dKa(L)))(b=Object(Ca.a)(379,
b.jm(h.Ic)))&&(r=b.getBounds()),r&&(r.height+=dE.lpi,r.width-=dE.Vam);return r}h=Object(Ca.a)(42,A);if(!h)return null;try{if(r=this.plb.f2(b.Atc,h,0<b.Atc,!1,!1,!1))r.height+=dE.lpi}catch(Z){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",Z),r=null}}r||(r=A.getBounds());return r}}dE.lpi=65;dE.Vam=100;Object(u.a)(dE,"ExternalContentFloatiePositionProvider",Kv,[]);class fN{constructor(b,h,r,A,L,Z){this.que=(oa,Ba,gb)=>{if(1===gb)return y.AFrameworkApplication.dV||
y.AFrameworkApplication.cG||y.AFrameworkApplication.eta||cc.SessionStatusManager.instance.Jk?8:32;if(oa===vb.a.print)oa=1;else if(oa===Ec.a.DZc)oa=0;else if(oa===Ec.a.Y_d)oa=3;else if(oa===Ec.a.X_d)oa=2;else return 8;return this.BLo(oa)};this.ga=b;this.C9=h;this.L6b=r;this.Ctk=A;this.Peh=L;this.Dpk=Z}Xb(){var b;y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&this.Ctk||y.AFrameworkApplication.cG?(document.body.classList.add("WACStopPrinting"),""!==this.Peh&&this.Dpk.F8o(this.Peh)):(this.ga.qa(vb.a.print,
kc.a.application,this.que),this.ga.qa(Ec.a.DZc,kc.a.application,this.que),(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&this.ga.qa(Ec.a.Y_d,kc.a.application,this.que),this.ga.qa(Ec.a.X_d,kc.a.application,this.que))}BLo(b){const h=y.AFrameworkApplication.rootQuerySignature;if(!h||""===h||pf.a.xd()&&pf.a.xd().ZE.$o)return 8;this.L6b.Hce=!1;this.L6b.bbk.start();Ty.a.iU(Bz.a.fBl,!0,Object(D.a)(this.L6b,
this.L6b.XFo,"requestFileDownload"),Object(D.a)(this.L6b,this.L6b.FWb,"onForceSaveFailed"),b);return 32}}Object(u.a)(fN,"FileDownloadActor",null,[]);class gN extends Nc{constructor(b,h=null,r=null){super(b,!0,h,!1,void 0,r)}get NSf(){return null}get rbb(){return this.ede?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:y.AFrameworkApplication.t7a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get nqc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get BRd(){return null}get ede(){return"VersionHistory"===
this.HZh?!1:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}Nhe(){v.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");y.AFrameworkApplication.jga("tcopypdf;ccopypdf")}}Object(u.a)(gN,"DownloadAsPdfDialog",Nc,[]);class fu{constructor(){this._url=this.ww=null;this.m4a=this.l4a=0;this.Blb=!1;this.RLa=()=>{y.AFrameworkApplication.Fe.Xj(this._url,1,null,null,!0,2,this.Ybb,this.TU,null)};this.Ybb=b=>{fu.uld();const h=b.data.ina;
let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(A){}r&&("InProgress"===r.text&&22>this.l4a++||"ServiceBusy"===r.text&&3>this.m4a++)?this.pNa(1E3*(this.l4a+this.m4a)):this.ww(!0,r?r.text:null,b.data)};this.TU=b=>{this.Blb?(fu.LGa||(fu.gjb=new Date,fu.LGa=!0,fu.nW=1),18E4>(new Date).getTime()-fu.gjb.getTime()?this.Axb(4<=fu.nW?2E4:1E3):this.I9a(b.data)):4>fu.nW?this.Axb(2E3):this.I9a(b.data)}}send(b,h,r){this._url=b;this.ww=h;this.Blb=r;this.RLa(null)}pNa(b){b=new mf.a(2,1,b,this.RLa);
y.AFrameworkApplication.pc.$b(b)}Axb(b){this.pNa(b);fu.nW++}I9a(b){this.ww(!1,null,b)}static taa(b,h){(new fu).send(b,h,!1)}static uld(){fu.LGa=!1;fu.nW=0}}fu.gjb=null;fu.LGa=!1;fu.nW=0;Object(u.a)(fu,"ClientRequestWithRetry",null,[]);class YF extends lc{constructor(b){super(b,void 0,y.AFrameworkApplication.t7a)}get rbb(){return YF.Ron?WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady.replace("{0}",""):WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}static get Ron(){if(null!=
YF.$Zg)var b=YF.$Zg;else{var h;y.AFrameworkApplication.$c("32d51153;h1018576");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogDownloadLinkRemovalEnabled",!1);b=YF.$Zg=b}return b}get nqc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get wbd(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get VXc(){return y.AFrameworkApplication.t7a?"UIFontDialogTextLarge":null}Nhe(){v.ULS.sendTraceTag(7628378,
324,50,"ODT download dialog displayed")}h5f(){v.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}Ybd(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get fbd(){return pw.Zhj}get yub(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get Jdj(){return!y.AFrameworkApplication.t7a}}Object(u.a)(YF,"DownloadAsOdtDialog",lc,[]);class hN{constructor(b,h){this.cib=this.h5a=null;this.Yhi="downloadpdf";this.CYl="downloadpdfwithoutcomments";
this.cvj="printpdf";this.Yhj="odt";this.neb=r=>{1===ab.StaticActiveAppFrame.za().state||this.h5a||(this.h5a=(new jo.a).create(),r=r.ao,this.ADn(r),1===r?this.h5a.message=this.mDb.bU.isEnabled?y.AFrameworkApplication.t7a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:0===r||3===r?this.h5a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait:2===r&&(this.h5a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait),
this.h5a.aM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.Hce=!0};this.Lba=(r,A,L)=>{this.gEg("Success. Save and Conversion Complete.");L=new qb.QueryStringBuilder(L.request.get_url());y.AFrameworkApplication.Mja(L);L=L.toString();const Z=this.oGo(L);this.Hra(Z);2!==Z&&this.mDb.Eho();if(!r||A)this.D8(Z);else if(this.Hce)this.Hce=!1,this.cib=null;else{this.cib&&y.AFrameworkApplication.pc.wf(this.cib);this.cib=null;if(0===Z||3===Z){A=new da.a;A.name="IsLabeled";
const oa=y.AFrameworkApplication.J.jb("AppliedPolicyId");A.bool=!!(oa&&0<oa.length);me.a("PdfProtectionUsage",r,void 0,[A])}this.RVl(L,Z)}};this.Hce=!1;this.mDb=b;this.bbk=h.UXa("UserAction","WordEditorForceSaveAndPrint")}Hra(b){this.h5a&&(this.KDn(b),this.h5a.close(),this.h5a=null)}D8(b){if(1!==ab.StaticActiveAppFrame.za().state){this.FEn(b);const h=new Ag.StandardDialog;h.Bd=0;h.Ke(1,CommonUIStrings.l_DialogClose);h.Iy(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,
null,!0)}}kMf(b){switch(b){case 0:return this.$Wi?this.CYl:this.Yhi;case 3:return this.Yhi;case 1:return this.cvj;case 2:return this.Yhj;default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),this.cvj}}XFo(b){var h=y.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.nBf(b)+"?"+h+"&type="+this.kMf(b)+"&rndm="+eb.a.create(),1===b&&this.mDb.T6o()&&(h+="&useNamedAction=1"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("CustomFontReadModePDFIsEnabled")&&
Qo.FontUtils.jye()&&(1===b||!b)&&(0<Qo.FontUtils.fci&&(h+="&cfcVer="+Qo.FontUtils.fci),Qo.FontUtils.eci&&(h+="&cfcUrl="+encodeURI(Qo.FontUtils.eci)),Qo.FontUtils.gci&&(h+="&cfcEncData="+encodeURIComponent(Qo.FontUtils.gci)),Qo.FontUtils.dci&&(h+="&cfcBaseUrl="+encodeURI(Qo.FontUtils.dci))),fu.taa(h,this.Lba),this.cib||(this.cib=new mf.a(2,1,500,this.neb),this.cib.ao=b,y.AFrameworkApplication.pc.$b(this.cib))):(this.gEg("failed. QuerySignature is empty."),this.D8(b))}nBf(b){return 2===b?"odt":"pdf"}FWb(){this.gEg("Failed. force save failed.")}oGo(b){if(0<
b.indexOf("&type=downloadpdf")&&this.$Wi)return 0<b.indexOf("&type=downloadpdfwithoutcomments")?0:3;if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri.");return 1}gEg(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.bbk.stop()}RVl(b,h){const r=new nb.a;r.add("access_token");r.add("access_token_ttl");
1!==ab.StaticActiveAppFrame.za().state&&(1===h?this.mDb.t9o(b,r):0===h||3===h?new gN(b):2===h&&new YF(b))}dispose(){}ADn(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 3:v.ULS.sendTraceTag(508078023,203,50,"Download Attempt: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",
b)}}KDn(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 3:v.ULS.sendTraceTag(508078022,203,50,"Download Cancelled: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}FEn(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;
case 3:v.ULS.sendTraceTag(508078021,203,15,"Download Failed: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}get $Wi(){if(null!=this.BZg)var b=this.BZg;else{var h;y.AFrameworkApplication.$c("b62ed219;f72gc351");b=this.BZg=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",
!1)}return b}}Object(u.a)(hN,"FileDownloadManager",null,[]);class eE{get key(){return"LIST"}get Fv(){return Box4Intl.Box4Strings.l_ListContentTitle}X1b(b){let h=null;const r=eE.Pd.Uw(b);if(!r)return{returnValue:!1,Iea:h};b=this.Jym(b,r);h=Object.assign(new yC.a,{dG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Iea:h}}Gqb(b,h){b=b.contentObject;const r=this.rxm(b.fz),A=new Pd.a;h?(h=h.contentObject,h.level!==b.level?(A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),A.add(r)):h.id.equals(b.id)&&h.fz.listType===b.fz.listType||A.add(r)):(A.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(r));return A.toArray().join(" ")}rxm(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Kx);else if(1===b.listType)switch(r){case 1:h=this.ZXh;break;case 2:h=this.wil;break;case 3:h=this.xil;break;default:h=
this.ZXh}return h}static get Pd(){return null!=eE.p0g?eE.p0g:eE.p0g=Wa.a.instance.resolve("Box4.List.IListReader")}}Object(u.a)(eE,"ListDetailsProvider",null,[732,300]);class BO{constructor(){this.fz=this.listId=this.id=null;this.level=0}}Object(u.a)(BO,"ListItemInfo",null,[]);class Pk extends eE{constructor(b){super();this.K9=b}get ZXh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get wil(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get xil(){return WoncaIntl.WoncaStrings.L_BulletStyle3}Jym(b,
h){const r=this.K9.pE(b);return Object.assign(new BO,{id:b.currentNode.id,listId:new Q.a(eb.a.nil,r.listID),fz:h,level:r.level+1})}}Object(u.a)(Pk,"FlatListDetailsProvider",eE,[]);class qC{constructor(b,h){this.ga=b;this.lg=h}get Yb(){return null!=this.Z6g?this.Z6g:this.Z6g=Wa.a.instance.Oa("Box4.Styles.IWACStyleReader")}Xb(){}}Object(u.a)(qC,"FormattingActor",null,[]);var ZF=d(1137),It=d(298),$F=d(1731);class QI{constructor(b,h,r,A,L,Z,oa,Ba){this.Db=b;this.MMk=h;this.Rc=r;this.tEb=A;this.hq=L;this.Aa=
Z;this.Fd=oa;this.tBk=Ba}Gsc(b,h,r,A,L,Z,oa){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.Ri});this.tEb.then(()=>{this.MMk(b.data.Pe);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.Ri});oa.stop()})}TU(b,h,r,A,L,Z,oa){Z.stop();L();oa?(this.Sbo(h,r),v.ULS.sendTraceTag(574377989,3001,
15,"{0}",{["message"]:b,["id"]:Id.a.Rqb(h.Db)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Id.a.Rqb(h.Db)})}XRh(b,h){b.Ae(Hx.a.frf,FK.YXl.toString());if(this.Fd&&this.Fd.isFeatureEnabled(42)){var r=this.hq.Mn(h.Lk);r=this.hq.Ik(r);b.Ae(Ii.a.jt,It.a[r]);5===r&&this.r7k(b,h)}this.tBk&&b.Ae(Ii.a.Iae,"true")}GLh(){return new $F.a(this.Db.id,this.Db)}k8d(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}Sbo(b,h){const r=this.Rc.Lc(7,vb.a.STm);r.Ab(h);b.Db.setValue(Vc.a.n6h,
!0);r.dispose()}r7k(b,h){var r=h.Lk;h=this.hq.Mn(r);var A=r.node;const L=(r=this.hq.mKa(h,A.Hc,!1))?this.hq.BVa(r):"";if(""===L)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");A=(A=this.hq.mKa(h,A.Hc,!0))?this.hq.BVa(A):"";b.Ae(Ii.a.Ysc,L);b.Ae(Ii.a.fbk,A);r=r.ka(cg.a.mni,"");""!==r&&b.Ae(Ii.a.extension,r);b.Ae(Ii.a.width,this.hq.XB(h).toString());b.Ae(Ii.a.height,this.hq.fD(h).toString());b.Ae(Ii.a.fhd,
this.hq.erb(h).toString());r=this.Aa.$("WordEditorImageCropIsEnabled");b.Ae(Ii.a.sbi,r.toString());r&&(r=this.hq.lfa(h),b.Ae(Ii.a.top,r.top.toString()),b.Ae(Ii.a.bottom,r.bottom.toString()),b.Ae(Ii.a.left,r.left.toString()),b.Ae(Ii.a.right,r.right.toString()));r=this.Aa.$("WordEditorImageRotateIsEnabled");b.Ae(Ii.a.kIj,r.toString());r&&(b.Ae(Ii.a.angle,this.hq.K2(h).toString()),h=this.hq.rsa(h),b.Ae(Ii.a.flipH,h.Ppb?"true":"false"),b.Ae(Ii.a.flipV,h.JJa?"true":"false"));b.Ae(Ii.a.Sii,"true")}}Object(u.a)(QI,
"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[416]);class fE{constructor(){this.NQa=null}hdl(b){this.NQa=b}teardown(){null!=this.NQa&&(this.NQa.teardown(),this.NQa=null);this.a4e=null}getGraphicData(){return this.NQa?this.NQa.getGraphicData():null}yyo(){null!=this.a4e&&this.setGraphicData(this.a4e)}setGraphicData(b){this.a4e=b;if(this.NQa)try{this.NQa.setGraphicData(b)}catch(h){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else v.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.NQa?this.NQa.hasEdits():!1}}Object(u.a)(fE,"GraphicsEditorGC2HostUser",null,[418]);var RI=d(1732),SI=d(1082),LK=d(1270),wy=d(808),aG=d(1362),CO=d(1081);class iN{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(u.a)(iN,"GC2ScriptLoader",null,[]);class br{constructor(b,
h,r){this.FMe=b;this._context=h;this.nSa=r}closeEditor(){this.FMe&&(this.FMe(),this.FMe=null)}logActivity(b,h,r,A){me.a(b,h,r,A)}logTrace(b,h,r,A){v.ULS.sendTraceTag(575522531,3001,br.dIn(h),A)}isEnabled(b){const h=y.AFrameworkApplication.J;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Wa.a.instance.resolve("Box4.IFontServiceParser").n8a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=Qo.FontUtils.aFf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==
r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return xa.Health.instance}getFonts(b){const h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",A=`${Wa.a.instance.resolve("Box4.IFontServiceParser").n8a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,A);Qo.FontUtils.mMh();Qo.FontUtils.OMh({});b=Qo.FontUtils.$Ef(()=>!1,(L,Z)=>Z).MenuSectionList;h&&0<b.length&&(b.pop(),
b.push(this.fzl()));return b}fzl(){const b=Qo.FontUtils.aFf(()=>!1,()=>"").fonts.map((h,r)=>{const A=h.name;h=h.displayName;const L=Qo.FontUtils.qta(A);return Object.assign(new GD.a,{MenuItemId:Qo.FontUtils.nKj+r,CommandValueId:A,LabelText:h||A,Styles:{["optionText"]:{["fontFamily"]:h&&!L?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:A})});return Object.assign(new hh.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=
this._context.Lk;var r=Id.a.Mn(h);if(this.Sln(r,h,b)&&(r=Id.a.a9(r,Od.a.e8,""),r.length))return Promise.resolve(r);r=new qb.QueryStringBuilder("/we/GetImage.ashx?");r.kKb(h.node.Hj().Bq);r.Ae(Ii.a.iZd,b);y.AFrameworkApplication.Mja(r);r.Ae(Wj.a.ZAb,"1");Cm.a.instance.rKb(r);r.Ae(Ii.a.tci,"true");const A=r.toString();return new Promise((L,Z)=>{this.nSa.Xj(A,1,null,null,!1,2,oa=>{L(oa.data.Pe)},oa=>{Z(oa.data.He.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=tj.a.Aj("progress.gif");
b.PictureInvalid=tj.a.Aj("CancelRequest.32x32x32.png");return b}getTheme(){const b=Object(so.a)().Iu(this._context.view.vd).properties.ka(Vc.a.lCe,"");return 0===b.length?[]:b.split(" ").map(h=>ed.a.RTa[h])}static dIn(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}Sln(b,h,r){const A=h.node.Hc;h=Id.a.p7d(b,A,!1);b=Id.a.p7d(b,A,!0);return r===h||r===b}}Object(u.a)(br,"GraphicsEditorApp",null,[423]);class jN extends Dg.a{constructor(b,
h,r,A,L){super(!1,!1,!0);this.closeEditor=()=>{this.W6h();this.dispose()};this.Era=Z=>{this.W6h(2===Z)};this.tib=b;this.Xxk=h;this.Xlh=r;this._context=A;this.nSa=L}v8o(b){return new Promise((h,r)=>{this.Uh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.Era,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(A,L)=>this.aLb(A,L,b),["onload"]:A=>{this.onLoad(A,h,r)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,
["onReload"]:()=>{this.tib.yyo()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.tib.hdl(b),h(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}aLb(b,h,r){b=y.AFrameworkApplication.J;const A=CO.a();A.loadScriptWithRetryHandler=h;const L=new br(this.closeEditor,this._context,this.nSa),Z={["bootConfig"]:Object.assign(new LK.a,{scriptBaseUrl:sy.AppChromeOverrideUtilities.isEnabled?sy.AppChromeOverrideUtilities.c7d(y.AFrameworkApplication.lcid):
y.AFrameworkApplication.L8+y.AFrameworkApplication.lcid+"/",isMLRRibbonMode:y.AFrameworkApplication.ua.Gb.yxc,isCombinedBundleEnabled:y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new iN(new SI.DynamicScriptLoader(A)),["publicPath"]:y.AFrameworkApplication.L8,["appSettings"]:b.appSettings,["logger"]:new cn.a,["featureGateManager"]:Object.assign(new wy.a,{getBooleanFeatureGate:Object(D.a)(b,b.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(D.a)(b,
b.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(D.a)(b,b.getStringFeatureGate,"getStringFeatureGate")}),["app"]:L,["resolveScript"]:(oa,Ba)=>aG.a.resolveScript(oa,Ba),["initialTabId"]:r};b.$("DynamicBundlesIsEnabled")&&(r="",y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")||(r=b.$("IsWebpack5RibbonEnabled")?"wp5/":"exp/"),Z.dynamicBundlesPath=sy.AppChromeOverrideUtilities.isEnabled?sy.AppChromeOverrideUtilities.fwc+
r:b.jb("StaticContentUrl")+r);return new Promise((oa,Ba)=>{h("gc2",y.AFrameworkApplication.mC("gc2.js",5),"anonymous",5,!1).then(()=>{oa(Z)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ba(null)})})}W6h(b){b=this.tib.hasEdits()&&!b;this.Xxk(b?this.tib.getGraphicData():null,!!this.Xlh,this.Xlh,b)}}Object(u.a)(jN,"ReactGraphicsEditorDialog",Dg.a,[]);class kN{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc,Hc,hd=!1){this.vri=hd;this.tEb=
this._context=null;this.w8o=(Gd,de,qe,oe,ge)=>{var $d,lf;const wf=!!ge&&Object(Gb.a)(Q.a,ge);try{if(1===qe){const Di=de.view;return this.Dk.fka(de)&&Di.features.XAe?32:8}this.QBk=4===(null===ge||void 0===ge?void 0:ge.InputMethod)?!0:!1;Object(vj.c)()&&(this.vri||ZF.a.spb(()=>{this.vri=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${wf}`);performance.mark("LaunchStart");this._context=de;const gi=new jN(this.tib,this.ndg,wf?ge:null,de,this.If);Gd=null;if(wf){const Di=
null===(lf=null===($d=de.view.lb)||void 0===$d?void 0:$d.gb)||void 0===lf?void 0:lf.currentSelection;if(null===Di||void 0===Di?0:Di.FL)Gd="Draw"}this.tEb=gi.v8o(Gd).then(()=>{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${wf}`)}).catch(()=>{this.tgi()});if(!wf){const Di=Vn=>{this.tEb.then(()=>{this.Nnj(Vn,!1)})};if(y.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Di(JSON.stringify({elements:[]})),
32;let Yl=null;Yl=Object(so.a)().Iu(de.view.vd);const xk=Yl.properties.ka(Vc.a.wri,"");if(0<xk.length)return Di(xk),32;this.eTe.XPo(de,Q.a.create(),eb.a.create()).then(Vn=>{const Dx=this.Rc.Lc(0,vb.a.i5c);Dx.Ab(Yl);Yl.setValue(Vc.a.wri,Vn);Dx.dispose();Di(Vn);return null}).catch(Vn=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Vn.toString(),wf);this.tgi()})}return 32}catch(gi){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",
gi.toString(),wf),8}};this.zVm=(Gd,de,qe,oe,ge)=>{var $d,lf;Gd=de.view;qe=null===(lf=null===($d=null===Gd||void 0===Gd?void 0:Gd.lb)||void 0===$d?void 0:$d.gb)||void 0===lf?void 0:lf.currentSelection;if(null===qe||void 0===qe||!qe.LWa)return 8;if(!Gd.features.XAe)return 32;v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.kii(ge,de);return 32};this.yVm=(Gd,de,qe,oe,ge)=>{var $d,lf,wf=de.view;wf=null===(lf=null===($d=null===wf||void 0===wf?void 0:wf.lb)||void 0===$d?
void 0:$d.gb)||void 0===lf?void 0:lf.currentSelection;return null!==wf&&void 0!==wf&&wf.LWa?this.DLi(Gd,de,qe,oe,ge):8};this.DLi=(Gd,de,qe)=>{if(1===qe)return de.view.features.XAe?32:8;if(2===qe){Gd=Id.a.Mn(de.Lk);if(!Gd)return 2;v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.kii(Gd,de);return 32}return 2};this.Nnj=(Gd,de=!0)=>{this.tib.setGraphicData(Gd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Gd=performance.getEntriesByName("EditorLaunch");
v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${de} Duration: ${Gd[Gd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.ndg=(Gd,de,qe,oe)=>{var ge;this.tib.teardown();if(de&&this._context){var $d=this._context.view.lb.Pg,lf=$d.node;$d.Al&&Cd.ParagraphReader.Wb(lf)&&($d=null===(ge=this.t$)||void 0===ge?void 0:ge.YB(lf),27==(null===$d||void 0===
$d?void 0:$d.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",oe,oe?" Everything deleted: "+(0==(null===Gd||void 0===Gd?void 0:Gd.json.length)):""))}if(oe)if(v.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Gd)if(oe=Gd.json,ge=Gd.width,lf=Gd.height,oe.length||de)if(!oe.length&&de)if(de=this._context.Lk){de=de.node;if(Id.a.cba(de)){if(!this.Dk.Ryo(de,new hb.a,Be.a.instance,bE.aKb)){v.ULS.sendTraceTag(588817116,
3001,10,"Failed to remove anchored image.");return}}else if(!this.Dk.bvc(de,qe,this.hb,this.LY)){v.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else $d=new RI.a(this._context,y.AFrameworkApplication.ua.eWa,!0,this.Dk,this.Aa,Object(so.a)()),Gd=eb.a.create(),qe=new uO.a($d,oe,this.sM,this.En,Gd,Ko.a.instance,
de,qe,this.Dk,this.hq,ge,lf,this.Aa,this.LY,this.Fd,Object(vj.c)(),Object(vj.b)()),this.eTe.vwg(qe,this._context,de,Gd),this.Vha(),this.QBk&&this.lpp();else v.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Aa=h;this.eTe=r;this.Dk=A;this.sM=L;this.En=Z;this.tib=
new fE;this.Rc=Ba;this.hb=gb;this.LY=Ab;this.hq=Jb;this.Fd=jc;this.If=Tb;this.t$=Hc}Xb(){let b=!0;this.Aa.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.Fd&&this.Fd.isFeatureEnabled(42));b&&!aa.a.As&&(this.ga.fb(Ec.a.rPf,kc.a.view,this.w8o,4),this.ga.fb(vb.a.syf,kc.a.view,this.zVm,4),this.ga.fb(Ec.a.lii,kc.a.view,this.yVm,4),this.ga.fb(Ec.a.Qgc,kc.a.view,this.DLi,4))}tgi(){const b=new Ag.StandardDialog;b.Bd=0;b.Iy(le.a.cyf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);ab.StaticActiveAppFrame.za().Ge()}kii(b,h){var r=b.ka(Ge.a.NP,1);const A=b.ka(cg.a.U_,ub.a.finished);r&&A!==ub.a.ZOa?b.ka(Vc.a.n6h,!1)?(h=new Ag.StandardDialog,h.Bd=0,h.Iy(le.a.cyf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),ab.StaticActiveAppFrame.za().Ge(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties"})):(this.ga.Qb(Ec.a.rPf,2,b.id),this.tEb||
(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.tEb=new Promise(L=>{L(null)})),r=eb.a.create(),b=new QI(b,this.Nnj,Ko.a.instance,this.tEb,this.hq,this.Aa,this.Fd,Object(vj.d)(b)),this.eTe.vwg(b,h,!0,r)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Vha(){const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):
v.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}lpp(){const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(u.a)(kN,"GraphicsEditorActor",null,[]);var DO=d(538);class lN{constructor(b,h,r){this.m2a="wwaengidc";this.Gyd="CreateLinkForHeading";this.nsk="CreateLinkForHeadingAction";this.wuk="\ufffc";this.Z1a=
b;this.ga=h;this.hb=r}Xb(){this.ga.qa(Ec.a.wXc,kc.a.paragraph,this.gtf.bind(this));this.ga.qa(Ec.a.wXc,kc.a.Cd,this.gtf.bind(this));this.ga.qa(Ec.a.wXc,kc.a.Vc,this.gtf.bind(this));this.ga.Pc(Ec.a.wXc,1028)}gtf(b,h,r){b=h.node;if(1===r)return this.vZi(b)?32:8;this.wro(this.Gyd,this.nsk);if(!this.vZi(b))return v.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Vc.a.ed);if(!r)return v.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),
r=new Map,r.set("Source",this.Gyd),r=Object.assign(new Na.a,{additionalValues:r}),xa.Health.instance.recordKpiFailure(this.Gyd,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.h$h(r);return 32}h$h(b){b=String.format('{{"{0}":"{1}"}}',DO.a.heading,b);this.ga.Qb(Za.a.Daa,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}vZi(b){return!this.hb.Wb(b)||this.hb.Rnc(b)||this.hb.pLa(b)||b.Fq||""===b.characterData||b.characterData===this.wuk||!this.Z1a.o6d(b)?
!1:!0}wro(b,h){const r=new Map;r.set("Source",this.Gyd);r.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.m2a,r)}}Object(u.a)(lN,"HeadingsActor",null,[]);class mN{o5o(b){return Cd.ParagraphReader.hza(this.Fyi(b))}Dnd(b,h,r){if(b=Cd.ParagraphReader.dKa(this.Fyi(b)))h=b.fg(h),Object(Gb.a)(32,h)&&(vx.m(b)?h.s_o(r):h.Dnd())}Fyi(b){return b&&b.Al&&b?b.node:null}}Object(u.a)(mN,"IFrameFocusStrategy",null,[400]);class nN{constructor(b){this.dHa=null;this.WCd=b}S$i(){v.ULS.sendTraceTag(25007835,
375,50,"Ignore all spelling error triggered")}p4j(b){if(!b)return v.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.dHa=F.a.CCe(b.errorDetails.token,b.errorDetails.lcid);this.WCd.add(this.dHa,b.errorDetails.lcid);return!0}Vod(b){return b?
b.token?F.a.CCe(b.token,b.lcid)===this.dHa:(v.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(u.a)(nN,"IgnoreAllProofingErrorStrategy",null,[399]);var EO=d(1279),FO=d(584),oN=d(379);class pN{constructor(b,h){this.filename=b;this.blob=h}}Object(u.a)(pN,"UploadBlobParameters",null,[]);class qN extends Dl{constructor(b,h,r,A,L,Z,oa,Ba,gb=null){super(b,h,r,null,L,Z,Ba,!1);this.YCk="DragAndDrop";
this.zhh="FileName";this.Chh=0;this.kJh=null;this.rtd=this.Iob=!1;this.Ffh=A;this.Lzh=gb}get T9j(){return"DragDropInsertImage"}get UR(){return this.YCk}get fileExtension(){return this.zhh}get fileSize(){return this.Chh}get U9j(){return this.kJh}xqd(b){const h=new pN(this.Ffh.name,this.Ffh);b.PYj(h);this.kJh=b.ylb}dAa(b,h){this.Lzh&&this.Lzh();super.dAa(b,h)}iMg(b){const h=!!b&&this.coa(b.name,null)&&this.jMg(b,null);b&&(this.zhh=b.name,this.Chh=b.size);h||this.Ohe();return h}}Object(u.a)(qN,"DragDropInsertImageUploader",
Dl,[]);class or{constructor(b,h,r,A,L,Z,oa){this.T6c=Z;this.mV=oa;this.Rie=this.Sie=this.sje=this.tje=0;this.ga=null;this.Xxf=(Ba,gb,Ab)=>{if(ed.a.k_d)return 8;Ba=gb.node;return 1===Ab?Ba?32:2:2===Ab?(Ab=Id.a.Mn(gb),gb=Id.a.U3c(Ab,gb.node.Hj().ud,y.AFrameworkApplication.J,y.AFrameworkApplication.ua.eWa),QC(gb),32):2};this.xbn=(Ba,gb,Ab)=>{const Jb=this.Dk.fka(gb);if(2===Ab&&Jb){if(vb.a.sX===Ba||vb.a.KUd===Ba)y.AFrameworkApplication.Bta?y.AFrameworkApplication.nCg():this.iJl(gb);return 32}return 1!==
Ab||vb.a.sX!==Ba&&vb.a.KUd!==Ba?2:Jb?32:2};this.sSb=(Ba,gb,Ab,Jb,Tb)=>this.Dk.fka(gb)?1===Ab?32:this.Dk.XUf(gb,Tb)?32:2:2;this.HZo=()=>{if(this.ib&&this.ib.gb&&this.ib.gb.currentSelection){const Ba=this.ib.gb.currentSelection.Qa;Ba&&this.ib.Kc(qc.SelectionFactory.ue(Ba.node,Ba.cpBegin))}};this.UYl=(Ba,gb,Ab,Jb,Tb)=>{v.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Ba=Tb.DataTransfer)&&Ba.files&&0<Ba.files.length){v.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",
Ba.files.length));for(Ab=0;Ab<Ba.files.length;Ab++)Jb=Ba.files[Ab],0<=F.a.xh(Jb.type).indexOf("image")&&this.Jan(Jb,gb)&&(Jb=this.ib.gb.currentSelection.Qa,this.ib.Kc(qc.SelectionFactory.ue(Jb.node,Jb.cpBegin+1)));this.lPa();return 32}v.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.zco=(Ba,gb,Ab,Jb,Tb)=>{if(2===Ab)return y.AFrameworkApplication.va.Hf(gb.Lk,Ba,Ab,!0,Jb,Tb);if(!gb.view.ve)return 8;Ba=gb.view;if(!Ba.lb)return 8;Ba=Ba.lb.Pg;Ba=Object(Nl.a)().EO(Ba);
return 1===Ba.length&&this.RQ(Ba[0])?(this.xGn(),32):8};this.pUm=(Ba,gb,Ab)=>{if(!this.RQ(gb))return 8;const Jb=Id.a.Mn(gb),Tb=Id.a.XB(Jb),jc=Id.a.fD(Jb);Ba=Ba===vb.a.Q9d;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ba});if(1===Ab)return this.pj.u7||Id.a.Z$a(Jb)?2:Ba&&Tb<this.Sie&&jc<this.Rie||!Ba&&Tb>this.tje&&jc>this.sje?32:2;Ab=Ba?1.1:.9;this.setSize(Jb,gb,Tb*Ab,jc*Ab,!0);return 32};this.quc=(Ba,gb,Ab,Jb,Tb)=>{if(!this.Iqa(gb))return 8;Ba=Id.a.Mn(gb);gb=Id.a.GVa(Ba);Ab=
Id.a.FVa(Ba);if(0>=gb||0>=Ab)return 2;Ba=Id.a.XB(Ba)/gb*100;Tb.setValue(Od.a.Z6c,Ba);return 32};this.kmc=(Ba,gb,Ab,Jb,Tb)=>{if(!this.Iqa(gb))return 8;Ba=Id.a.Mn(gb);if(1===Ab)return this.pj.u7||Id.a.Z$a(Ba)?2:32;v.ULS.sendTraceTag(20459937,322,50,"Change image scale.");var jc=Tb.ka(Od.a.Z6c,-1)/100,Hc=Tb.ka(Od.a.KPi,!1);const hd=Tb.ka(Od.a.iTf,!0);var Gd=Tb.ka(Od.a.jTf,!0);if(0>=jc)return or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Ksb}),2;const de=Id.a.GVa(Ba),qe=Id.a.FVa(Ba);Ab=Id.a.XB(Ba);Jb=Id.a.fD(Ba);
if(0>=de||0>=qe)return or.Ac.fc(Df.a.G4,{["Reason"]:gf.a.Ksb}),2;Hc?(Hc=hd?jc*Ab:Ab,jc=Gd?jc*Jb:Jb):(Hc=hd?jc*de:Ab,jc=Gd?jc*qe:Jb);Tb=Tb.ka(Od.a.DPi,1);Tb=2==Tb||0==Tb||4==Tb||6==Tb;Gd=this.xKf(gb,Hc);or.Cae&&Gd<Hc&&(Ab==Gd&&(Gd-=.001),Hc=Gd,Tb&&(jc=Gd/Ab*Jb));this.setSize(Ba,gb,Hc,jc);pf.a.xd().xm&&pf.a.xd().Bk.IG(gb.node);this.lPa();return 32};this.oYb=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;Ba=Id.a.Mn(gb);Ba=Id.a.fD(Ba);if(0>=Ba)return 2;Tb.setValue(Od.a.GKa,Ba);return 32};this.GKa=(Ba,gb,
Ab,Jb,Tb)=>{if(!this.Iqa(gb))return 8;Ba=Id.a.Mn(gb);if(1===Ab)return this.pj.u7||Id.a.Z$a(Ba)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Tb=Tb.ka(Od.a.GKa,0);Jb=Id.a.Y$a(Ba);if(0>=Tb)return or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Ksb}),2;var jc=Id.a.GVa(Ba);const Hc=Id.a.FVa(Ba),hd=Id.a.XB(Ba);Ab=Id.a.fD(Ba);Ab=hd/Ab;if(0>=jc||0>=Hc)if(or.Ac.fc(Df.a.G4,{["Reason"]:gf.a.Ksb}),this.SSj(Ba))return 2;Jb=Jb?Tb*Ab:hd;jc=this.xKf(gb,Jb);or.Cae&&jc<Jb&&(Jb=jc,Tb=Jb/Ab);this.setSize(Ba,
gb,Jb,Tb);pf.a.xd().xm&&pf.a.xd().Bk.IG(gb.node);ab.StaticActiveAppFrame.za().Ge();return 32};this.pYb=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;Ba=Id.a.Mn(gb);Ba=Id.a.XB(Ba);if(0>=Ba)return 2;Tb.setValue(Od.a.HKa,Ba);return 32};this.HKa=(Ba,gb,Ab,Jb,Tb)=>{if(!this.Iqa(gb))return 8;Ba=Id.a.Mn(gb);if(1===Ab)return this.pj.u7||Id.a.Z$a(Ba)?2:32;v.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Jb=Tb.ka(Od.a.HKa,0);Ab=Id.a.Y$a(Ba);if(0>=Jb)return or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Ksb}),
2;var jc=Id.a.GVa(Ba);const Hc=Id.a.FVa(Ba);var hd=Id.a.XB(Ba);Tb=Id.a.fD(Ba);hd=Tb/hd;if(0>=jc||0>=Hc)if(or.Ac.fc(Df.a.G4,{["Reason"]:gf.a.Ksb}),this.SSj(Ba))return 2;jc=Jb;Jb=this.xKf(gb,Jb);or.Cae&&Jb<jc&&(jc=Jb);this.setSize(Ba,gb,jc,Ab?jc*hd:Tb);pf.a.xd().xm&&pf.a.xd().Bk.IG(gb.node);ab.StaticActiveAppFrame.za().Ge();return 32};this.rYb=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;Ba=Id.a.Mn(gb);Ba=Id.a.Y$a(Ba);Tb.setValue(Od.a.S_,Ba);return 32};this.S_=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;
Ba=Id.a.Mn(gb);if(1===Ab&&this.pj.u7)return 2;pf.a.xd().xm&&pf.a.xd().Bk.IG(gb.node);Tb&&(gb=Tb.ka(Od.a.S_,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Dk.eOj(Ba,gb),ab.StaticActiveAppFrame.za().Ge());return 32};this.Jcb=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;Ba=Id.a.Mn(gb);Ba=Id.a.x_(Ba);Tb.setValue(Od.a.fsb,Ba);return 32};this.fsb=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;if(1===Ab)return this.pj.u7?2:32;if(pf.a.xd().xm&&(Ba=gb.node.ka(Ge.a.ZJ,Cl.a.Gu),Ba!==
Cl.a.Gu&&(Ba=pf.a.xd().Bk.Vqb(Ba),oN.a.getInstance().eeb(Ba))))return or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),2;Ba=Id.a.Mn(gb);Tb=Tb.ka(Od.a.fsb,null);this.Dk.OVo(Ba,gb,Tb);v.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Qd.Yu(13);return 32};this.Icb=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;Ba=Id.a.Mn(gb);Ba=Id.a.AVa(Ba);Tb.setValue(Od.a.R_,Ba);return 32};this.R_=(Ba,gb,Ab,Jb,Tb)=>{if(!this.RQ(gb))return 8;if(1===Ab)return this.pj.u7?2:32;if(pf.a.xd().xm&&(Ba=gb.node.ka(Ge.a.ZJ,
Cl.a.Gu),Ba!==Cl.a.Gu&&(Ba=pf.a.xd().Bk.Vqb(Ba),oN.a.getInstance().eeb(Ba))))return or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),2;Ba=Id.a.Mn(gb);Tb=Tb.ka(Od.a.R_,null);this.Dk.NVo(Ba,gb,Tb);v.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Qd.Yu(13);return 32};this.Adb=(Ba,gb,Ab)=>{var Jb,Tb;if(1===Ab)return 32;if(!gb.view.ve)return v.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ba),8;gb=gb.view;Ab=null===(Tb=null===(Jb=gb.lb)||void 0===Jb?void 0:Jb.gb)||
void 0===Tb?void 0:Tb.K(0);if(!Ab)return v.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ba),8;Tb=Ab.Qa;Jb=this.mV.Xf("UserAction",Ba.toString());let jc;Ba==vb.a.Svg?jc=this.T6c.Adb(Tb,2):Ba==vb.a.Vvg?(jc=this.T6c.Adb(Tb,0),5==jc&&(jc=this.T6c.Adb(Tb,2))):Ba==vb.a.Wvg&&(jc=this.T6c.Adb(Tb,1),5==jc&&(jc=this.T6c.Adb(Tb,3)));switch(jc){case 4:Tb=32;gb.b4();break;case 5:Tb=2;break;default:Tb=8}Jb.stop();v.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",
jc,Jb.Ri,Ba);return Tb};this.Dk=b;this.Vn=h;this.Qd=r;this.ih=A;this.ib=L;this.Yd=bd.a.pq?fl.a.getInstance(Tc.a):fl.a.getInstance(Xh.a)}get pj(){return pl.PageReader.instance}get $ea(){return this.Vn.instance}get Pb(){return this.ga}z9m(){this.tje=nh.a.hn(1,0);this.sje=nh.a.hn(1,1);this.Sie=nh.a.hn(1920,0);this.Rie=nh.a.hn(1280,1)}Xb(b){this.ga=b;const h=this.zco,r=this.xbn,A=this.sSb,L=this.pUm;b.fb(vb.a.sX,kc.a.view,r,1284);b.qa(vb.a.sSb,kc.a.Vc,A);b.qa(vb.a.Svg,kc.a.view,this.Adb);b.qa(vb.a.Vvg,
kc.a.view,this.Adb);b.qa(vb.a.Wvg,kc.a.view,this.Adb);b.qa(vb.a.sSb,kc.a.image,A);b.Pc(vb.a.sSb,1284);b.fb(vb.a.KUd,kc.a.view,r,1284);b.fb(vb.a.bnf,kc.a.view,h,1028);this.ns(b,vb.a.Q9d,L);this.ns(b,vb.a.BCg,L);this.ns(b,vb.a.quc,this.quc);this.ns(b,vb.a.oYb,this.oYb);this.ns(b,vb.a.pYb,this.pYb);this.ns(b,vb.a.Jcb,this.Jcb);this.ns(b,vb.a.Icb,this.Icb);this.ns(b,vb.a.kmc,this.kmc);this.ns(b,vb.a.axe,this.GKa);this.ns(b,vb.a.bxe,this.HKa);this.ns(b,vb.a.Hnd,this.fsb);this.ns(b,vb.a.y_b,this.R_);this.ns(b,
vb.a.rYb,this.rYb);this.ns(b,vb.a.S_,this.S_);this.ns(b,vb.a.Xxf,this.Xxf);b.fb(vb.a.bii,kc.a.view,this.UYl,4);b.Pc(vb.a.Q9d,4);b.Pc(vb.a.BCg,4);b.Pc(vb.a.quc,69);b.Pc(vb.a.oYb,69);b.Pc(vb.a.pYb,69);b.Pc(vb.a.rYb,69);b.Pc(vb.a.Jcb,69);b.Pc(vb.a.Icb,69);b.Pc(vb.a.S_,4);b.Pc(vb.a.kmc,4);b.Pc(vb.a.axe,4);b.Pc(vb.a.bxe,4);b.Pc(vb.a.Hnd,4);b.Pc(vb.a.y_b,4);this.z9m()}ns(b,h,r){b.qa(h,kc.a.image,r);b.qa(h,kc.a.ZOb,r);b.qa(h,kc.a.Cd,r);b.qa(h,kc.a.L$,r)}iJl(b){new Dl(b,zf.a.instance,y.AFrameworkApplication.J,
null,this.ih,this.ga,new ck.b)}REp(b){return this.pj.u7?(or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Z5l}),!1):or.tg.p2(b)?(or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.UG}),!1):this.$ea&&this.$ea.zX(b)?(or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.Z7a}),!1):!0}Yln(b){const h=Id.a.Mn(b);return h&&5===Id.a.Ik(h)&&this.iXi(b,h)}iXi(b,h){(h=!Id.a.Sjc(h)&&!Id.a.cee(h))||or.Ac.fc(Df.a.Pn,{["Reason"]:gf.a.u6h});return h&&this.REp(b)}Jan(b,h){var r,A;h=new qN(h,
zf.a.instance,y.AFrameworkApplication.J,b,this.ih,this.ga,this.ib,new ck.b,this.HZo);if(h.iMg(b))bd.a.pq?this.Yd.logKpiUsage({kpiName:Tc.d.sKa,kpiType:0}):(null===(A=y.AFrameworkApplication.J)||void 0===A?0:A.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Yd.logKpiUsage({kpiName:Xh.c.IKa,kpiType:0});else return bd.a.pq?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Na.a,{extendedProperties:b}),this.Yd.logKpiFailure({kpiName:Tc.d.sKa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:b},optionalVeto:Object(yh.c)(Tc.d.plc)})):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Na.a,{extendedProperties:b}),this.Yd.logKpiFailure({kpiName:Xh.c.IKa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Xh.c.imc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:null}})):xa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new Fh.a(document.body,Object(D.a)(h,h.jwb,"onUploadFrameInitialized"),Object(D.a)(h,h.aoa,"uploadResponseReceived"),y.AFrameworkApplication.J,!1,void 0,Hg.a(y.AFrameworkApplication.J));return!0}RQ(b){return this.Yln(b)}Iqa(b){const h=Id.a.Mn(b);if(!h)return!1;const r=Wa.a.instance.Oa("Box4.IFeatureHelper"),
A=Id.a.Ik(h);return 5===A||10===A||48===A||11===A||r&&r.isFeatureEnabled(42)&&4===A?this.iXi(b,h):!1}static get Cae(){if(null!=or.vXg)var b=or.vXg;else{var h;y.AFrameworkApplication.$c("9h122341;23147890");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableImageResizeBug",!1);b=or.vXg=b}return b}xKf(b,h){const r=new hb.a;r.set(b.node);he.a.Ou(r);return or.Cae&&$g.TableCellReader.tba(r)?(b=hb.a.eb(b.node),b.zb(16),.92*b.kd(16).width):
h}setSize(b,h,r,A,L=!1){pf.a.xd().xm&&pf.a.xd().Bk.IG(h.node);const Z=Id.a.Y$a(b);let oa=1;r>this.Sie?oa=this.Sie/r:r<this.tje&&(oa=this.tje/r);let Ba=1;A>this.Rie?Ba=this.Rie/A:A<this.sje&&(Ba=this.sje/A);if(Z||L)oa=Math.min(oa,Ba),Ba=Math.min(oa,Ba);1!==oa&&(r*=oa);1!==Ba&&(A*=Ba);this.yxf(b,h,r,A)}yxf(b,h,r,A){this.Dk.TZo(b,h,r,A)}xGn(){v.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}lPa(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorInsertImagesFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}SSj(b){const h=Id.a.GVa(b);b=Id.a.FVa(b);return 0>=h||0>=b}static get tg(){return Be.a.instance}static get Ac(){return ih.a.instance}}Object(u.a)(or,"ImageActor",null,[]);var GO=d(844);class IA{constructor(b,h,r,A,L,Z){this.sI=b;this.graphNode=h;this.$gc=r;this.WTm=A;this.jAa=L;this.Jo=Z;this.PBd=new GO.a(this.Np(),
IA.WBc);if(bd.a.pq||bd.a.kV)this.Yd=fl.a.getInstance(Tc.a)}sra(b){this.qP("crop");this.Jo.cY([7]);if(null===this.sI||void 0===this.$gc||void 0===this.jAa)return this.qD("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");if(void 0===h)return!1;const r=this.jAa.fSm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.nTc(r,h))return this.dVb("crop","Failed to apply and update"),this.qD("crop","Failed to apply and update"),!1}catch(A){return this.dVb("crop",A),
this.qD("crop",A.stack?A.stack:A.message?A.message:A.toString()),!1}this.Jo.XL([7]);this.E4();this.bcd("crop");return!0}rotate(b){this.qP("rotate");this.Jo.cY([8]);if(null===this.sI||void 0===this.$gc||void 0===this.jAa)return this.qD("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.sI.Lga.FFi();if(0!==b){const r=this.jAa.jSm();r.rotation=b;try{if(!this.nTc(r,h))return this.qD("rotate","Failed to apply and update"),!1}catch(A){return this.dVb("rotate",
A),this.qD("rotate",A.stack?A.stack:A.message?A.message:A.toString()),!1}}this.Jo.XL([8]);this.E4();this.bcd("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.qP(r);this.Jo.cY([9]);if(null===this.sI||void 0===this.$gc||void 0===this.jAa)return this.qD(r,"Argument(s) invalid"),!1;const A=this.getGraphicData(r);if(void 0===A)return!1;const L=this.jAa.gSm();L.flip=this.jAa.ptm();L.flip.x=b;L.flip.y=h;try{if(!this.nTc(L,A))return this.qD(r,"Failed to apply and update"),!1}catch(Z){return this.dVb(r,
Z),this.qD(r,Z.stack?Z.stack:Z.message?Z.message:Z.toString()),!1}this.Jo.XL([9]);this.E4();this.bcd(r);return!0}JUd(b,h,r){const A="changePictureBorderProps"+(void 0!==b?"_Weight":"")+(void 0!==h?"_DashType":"")+(void 0!==r?"_Color":"");this.qP(A);this.Jo.cY([10]);if(null===this.sI||void 0===this.$gc||void 0===this.jAa)return this.qD(A,"Argument(s) invalid"),!1;const L=this.getGraphicData(A);if(void 0===L)return!1;const Z=this.jAa.dSm();void 0!==b&&(Z.weight=b);void 0!==h&&(Z.XM=h);void 0!==r&&(Z.color=
r);try{if(!this.nTc(Z,L))return this.dVb(A,"Failed to apply and update"),this.qD(A,"Failed to apply and update"),!1}catch(oa){return this.dVb(A,oa),this.qD(A,oa.stack?oa.stack:oa.message?oa.message:oa.toString()),!1}this.Jo.XL([10]);this.E4();this.bcd(A);return!0}resize(b,h){this.qP("resize");this.Jo.cY([11]);if(null===this.sI||void 0===this.$gc||void 0===this.jAa)return this.qD("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let A=0;var L=0;({width:A,
height:L}=Id.a.$8a(this.sI));b/=A;h/=L;L=this.jAa.kSm();L.scale=this.jAa.sLm();L.scale.width=b;L.scale.height=h;try{if(!this.nTc(L,r))return this.qD("resize","Failed to apply and update"),!1}catch(Z){return this.dVb("resize",Z),this.qD("resize",Z.stack?Z.stack:Z.message?Z.message:Z.toString()),!1}this.Jo.XL([11]);this.E4();this.bcd("resize");return!0}static get WBc(){return Wa.a.instance.Oa("Box4.ICssColorProvider")}getGraphicData(b){try{const h=this.PBd.VNf();return this.sI.getGraphicData(h)}catch(h){this.qD(b,
h.stack?h.stack:h.message?h.message:h.toString())}}nTc(b,h){this.$gc.apply(b,h);b=this.sI.zPb(h);if(void 0===b)return!1;this.Fvp(b);return!0}Fvp(b){const h=new Sb.GraphTransaction(15);h.Ab(this.graphNode);this.sI.setValue(De.a.oN,b.oN);this.WTm.XLo(b.jmi,b.WBa,this.sI);h.dispose()}Np(){return Object(so.a)().Iu(this.graphNode)}qP(b){const h=this.uPg;h.Rob=b;v.ULS.sendTraceTag(509657553,322,50,"{0}",h)}qD(b,h){const r=this.uPg;r.message=h;r.Rob=b;v.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get uPg(){return{["id"]:Id.a.Rqb(this.sI),
["type"]:Id.a.Ik(this.sI)}}bcd(b){bd.a.pq&&this.Yd.logKpiSuccess({kpiName:Tc.d.M9d+Tc.b.h4d+b+It.a[Id.a.Ik(this.sI)].toString()})}dVb(b,h){if(bd.a.pq){const {width:r,height:A}=Id.a.$8a(this.sI);h=Object.assign(new Na.a,{extendedProperties:new Map([["Exception",h.message?h.message:h.toString()]])});h.extendedProperties.set("ErrorLevel","warning");this.Yd.logKpiFailure({kpiName:Tc.d.M9d+Tc.b.h4d+b+It.a[Id.a.Ik(this.sI)].toString(),errorName:"DrawingResponseInvalid"+Object(yh.b)(A,r),optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:h},optionalVeto:Object(yh.c)(Tc.d.cLi,h,null,!1)})}}E4(){if(bd.a.kV){var b=this.Jo.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new Na.a,{durationMs:r}),hasImpliedUsage:!0},this.Yd.logKpiSuccess({kpiName:Tc.d.Dtc+ck.a[h]+It.a[Id.a.Ik(this.sI)].toString(),optionalProperties:b}),this.Jo.evc(Number(h))}}}Object(u.a)(IA,"EditWithGC2Command",null,[]);class rC{XLo(b,h,r){this.WBn(b,h);this.$Lo(r)}WBn(b,h){this.NJ=Array(4);this.NJ[dn.a.left]=
b.Hyf;this.NJ[dn.a.top]=b.Jyf;this.NJ[dn.a.right]=b.Iyf;this.NJ[dn.a.bottom]=b.Gyf;this.TUa=b.TUa;this.UUa=b.UUa;(this.WBa=h)&&this.ABl()}$Lo(b){b.setValue(De.a.QAa,Math.round(this.TUa).toString());b.setValue(De.a.RAa,Math.round(this.UUa).toString());const h=Array(4);this.NJ.forEach((r,A)=>{h[A]=Math.round(r).toString()});b.setValue(De.a.TVa,h);b.setValue(De.a.G$a,this.WBa)}ABl(){this.Zgp();const b=this.TUa/2,h=this.UUa/2;this.TUa%2&&0===this.UUa%2?(--this.NJ[dn.a.left],++this.NJ[dn.a.top]):this.UUa%
2&&0===this.TUa%2&&(++this.NJ[dn.a.left],--this.NJ[dn.a.top]);this.NJ[dn.a.left]+=b-h;this.NJ[dn.a.right]-=b-h;this.NJ[dn.a.top]+=h-b;this.NJ[dn.a.bottom]-=h-b}Zgp(){const b=this.TUa;this.TUa=this.UUa;this.UUa=b}}Object(u.a)(rC,"GraphicsExtents",null,[]);var TL=d(1135),UL=d(1136),MK=d(537);class NK{constructor(){this.aHp={["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,
["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.BNl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8};this.pco={["background1"]:0,["text1"]:1,["background2"]:2,["text2"]:3,["accent1"]:4,["accent2"]:5,["accent3"]:6,["accent4"]:7,["accent5"]:8,["accent6"]:9};this.oco={[0]:"background1",[1]:"text1",[2]:"background2",[3]:"text2",[4]:"accent1",[5]:"accent2",[6]:"accent3",[7]:"accent4",
[8]:"accent5",[9]:"accent6"};this.idi={yNa:{cuc:1}};this.ldi=.75;this.jdi=0;this.Lkp=8;this.BSn=6}qmp(b,h){if(b){var r=this.RFm(b);h=h.Lga.M7d();b.On=void 0===r?!1:r===h}}pmp(b,h){if(b){var r=this.SDi(b);h=h.Lga.HLf();b.On=void 0===r||void 0===h?!1:r===h}}static K4c(b){return b.Lga.K4c()}HOm(b){var h=b.yNa;b=this.oco[h.cuc];const r=h.lIa.iie;h=h.lIa.hie;let A,L;void 0!=r?A=r:void 0!=h&&(L=100-h);return{cuc:b,lIa:{Seb:A,ixc:L}}}xca(b,h,r){var A;const L=null===(A=w())||void 0===A?void 0:A.HIa();h=new IA(b,
h,L,new rC,z(),new ck.b);r=this.WDi(r);if(void 0===r)return!1;A=!!b.Lga.K4c();b=void 0!==b.Lga.HLf();return h.JUd(r,b?void 0:this.jdi,A?void 0:this.idi)}lYo(b,h,r){var A;const L=null===(A=w())||void 0===A?void 0:A.HIa();h=new IA(b,h,L,new rC,z(),new ck.b);r=this.SDi(r);if(void 0===r)return!1;A=!!b.Lga.K4c();b=!!b.Lga.M7d();return h.JUd(b?void 0:this.ldi,r,A?void 0:this.idi)}g4(b,h,r){var A;const L=null===(A=w())||void 0===A?void 0:A.HIa();A=new IA(b,h,L,new rC,z(),new ck.b);h=this.OFm(r,h);if(void 0===
h)return!1;r=!!b.Lga.M7d();b=void 0!==b.Lga.HLf();return A.JUd(r?void 0:this.ldi,b?void 0:this.jdi,h)}dvc(b,h){var r;const A=null===(r=w())||void 0===r?void 0:r.HIa();return(new IA(b,h,A,new rC,z(),new ck.b)).JUd()}OFm(b,h){if(b.length===this.Lkp){b=parseInt(b,16)>>>24;h=Object(so.a)().Iu(h);h=Wq.Oqp(b-1,h);if(void 0===h){v.ULS.sendTraceTag(508692042,322,15,`getPictureBorderColorFromActionData: Could not find theme color info for color index ${b}`);return}b=this.pco[h.iCe];if(void 0===b){v.ULS.sendTraceTag(508683782,
322,15,`getPictureBorderColorFromActionData: Could not find preset scheme color for ${h.iCe}`);return}const r=void 0!==h.Seb?100-h.Seb:100-h.ixc;return{yNa:{cuc:b,lIa:{hie:r,iie:void 0!==h.Seb?100-r:void 0}}}}if(b.length===this.BSn)return{Qld:"#"+F.a.JJ(Ql.a.Cmb(parseInt(b,16)),6)};v.ULS.sendTraceTag(508692041,322,15,"setPictureBorderColor: Invalid action data received.")}RFm(b){b=this.WDi(b);if(void 0!==b)return b=nh.a.z0(b,0,!1),nh.a.Bjg(b)}WDi(b){b=this.aHp[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692040,
322,15,"getPictureBorderWeightFromActionDataInPoints: Invalid action data received.");return b}SDi(b){b=this.BNl[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692039,322,15,"getPictureBorderDashTypeFromActionData: Invalid action data received.");return b}}Object(u.a)(NK,"Gc2PictureBorderHelper",null,[]);var rN=d(395),HO=d(447),sN=d(1367);class ep extends or{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){super(b,h,A,Z,oa,Ba,gb);this.Mth=!1;this.BSe=this.Mda=null;this.Sx=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;
if(1===jc)return this.pj.u7?2:32;Jb=parseInt(hd);v.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Jb);this.sLd.Tmo(Tb,Id.a.Mn(Tb),Jb);this.Rbd(Tb);this.lPa();return 32};this.Bue=(Jb,Tb,jc)=>{if(!this.RQ(Tb))return 8;v.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Jb=Id.a.Mn(Tb);if(1===jc)return this.pj.u7?2:32;jc=Id.a.b9a(Jb);jc===Pt.a.cdb?(jc=new Sb.GraphTransaction(15),jc.Ab(Tb.node),Id.a.pnc()?Jb.setValue(Vc.a.yXb,""):this.BM.Bzo(Jb),jc.dispose(),this.rOc.create(Jb,Tb).Sx(ki.a.nGj),
this.Rbd(Tb)):jc===Pt.a.dRh&&this.rOc.create(Jb,Tb).Sx(ki.a.nGj);return 32};this.$Vm=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;Jb=Id.a.Mn(Tb);if(1===jc)return this.pj.u7||Id.a.Ync(Jb)?2:32;hd&&(this.BM.Brd(Jb,Tb),v.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),ab.StaticActiveAppFrame.za().Ge());this.lPa();return 32};this.aWm=(Jb,Tb,jc,Hc,hd)=>{var Gd;if(!this.RQ(Tb))return 8;if(1===jc)return this.pj.u7?2:32;Jb=Id.a.Mn(Tb);if(hd){jc=Id.a.Jce(Id.a.Mn(Tb));v.ULS.sendTraceTag(22381022,
322,50,"Applying New Image Cropping, isCanvas: "+jc);Hc=hd.ka(Od.a.ksb,0);const qe=hd.ka(Od.a.hsb,0),oe=hd.ka(Od.a.isb,0);hd=hd.ka(Od.a.jsb,0);var de=Id.a.lfa(Jb);const ge=de.bottom,$d=de.left,lf=de.right;if(Hc===de.top&&qe===ge&&oe===$d&&hd===lf)return v.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(Object(vj.d)(Jb)&&(de=null===(Gd=w())||void 0===Gd?void 0:Gd.HIa(),(new IA(Jb,Tb.node,de,new rC,z(),new ck.b)).sra({top:.001*Hc,bottom:.001*
qe,left:.001*oe,right:.001*hd})))return 32;jc?(new TL.a(Jb,new UL.a,new ck.b)).ATo(Hc,qe,oe,hd,this.jYn,Tb):this.sLd.Jmo(Tb,Id.a.Mn(Tb),Hc,qe,oe,hd);this.Rbd(Tb);ab.StaticActiveAppFrame.za().Ge()}return 32};this.Y9d=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;Hc=Id.a.Mn(Tb);if(1===jc)return this.pj.u7||Id.a.Ync(Hc)?2:32;if(hd){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.BM.zBa()||this.BM.Brd(Hc,Tb);switch(Jb){case Ec.a.P6c:Jb=hd.ka(Od.a.ksb,
-1);jc=0;break;case Ec.a.M6c:Jb=hd.ka(Od.a.hsb,-1);jc=1;break;case Ec.a.N6c:Jb=hd.ka(Od.a.isb,-1);jc=2;break;case Ec.a.O6c:Jb=hd.ka(Od.a.jsb,-1);jc=3;break;default:return 8}this.BM.nyp(Jb,jc);this.Rbd(Tb);ab.StaticActiveAppFrame.za().Ge()}return 32};this.Twb=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;Id.a.Mn(Tb);hd&&(Jb=this.BM.zBa(),hd.setValue(Od.a.zBa,Jb));return 32};this.puc=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;Jb=Id.a.Mn(Tb);if(hd){if(this.BM.zBa())({top:Gd,bottom:jc,left:Jb,right:Tb}=
this.BM.Nom());else{Hc=nh.a.xf(Id.a.XB(Jb),0);var Gd=nh.a.xf(Id.a.fD(Jb),1);Tb=Id.a.lfa(Jb);const de=Math.max(Tb.top,0);jc=Math.max(Tb.bottom,0);Jb=Math.max(Tb.left,0);Tb=Math.max(Tb.right,0);Hc=1E5*Hc/(1E5-(Jb+Tb));const qe=1E5*Gd/(1E5-(de+jc));Gd=Math.floor(de*qe/1E5);jc=Math.floor(jc*qe/1E5);Jb=Math.floor(Jb*Hc/1E5);Tb=Math.floor(Tb*Hc/1E5)}hd.setValue(Od.a.ksb,Gd);hd.setValue(Od.a.hsb,jc);hd.setValue(Od.a.isb,Jb);hd.setValue(Od.a.jsb,Tb)}return 32};this.slc=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;
if(1===jc){if(this.pj.u7)return 2;this.$Hn();return 32}Jb=Id.a.Mn(Tb);this.BM.zBa()&&this.BM.Brd(Jb,Tb);Jb=hd.ka(Od.a.ZNa,"");hd=hd.ka(Od.a.Ofb,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:hd,["SourceControlId"]:Jb});switch(hd){case 1:this.BM.O_o(Tb);break;case 8:this.BM.Uxe(Tb,bl.a.N0b,1);break;case 9:this.BM.Uxe(Tb,bl.a.N0b,3);break;case 3:this.BM.Uxe(Tb,bl.a.none,void 0,!0);break;case 4:this.BM.Uxe(Tb,bl.a.none,void 0,!1)}this.lPa();ab.StaticActiveAppFrame.za().Ge();
return 32};this.Iuc=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;Jb=Id.a.Mn(Tb);Tb=Id.a.A7(Tb);jc=Id.a.d3(Jb);Hc=Id.a.Ykc(Jb);Jb=Id.a.Xy(Jb);return this.Hmo(Tb,jc,Hc,Jb,hd)?32:8};this.cWm=(Jb,Tb,jc,Hc,hd)=>{var Gd;if(!this.Iqa(Tb))return 8;Hc=Id.a.Mn(Tb);if(1===jc)return cc.SessionStatusManager.instance.Jk?8:this.pj.u7||Id.a.Znc(Hc)?2:32;this.BM.zBa()&&this.BM.Brd(Hc,Tb);if(hd){const qe=hd.ka(Od.a.W6c,0),oe=Id.a.Jce(Hc);v.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",
qe,oe);jc=Id.a.K2(Hc);var de=Id.a.rsa(Hc);let ge=de.Ppb;de=de.JJa;switch(qe){case 0:jc=hd.ka(Od.a.pX,0);break;case 2:jc-=90;jc=yh.e(jc);break;case 1:jc+=90;jc=yh.e(jc);break;case 4:ge=!ge;break;case 3:de=!de;break;case 5:jc+=hd.ka(Od.a.pX,0),jc=yh.e(jc)}if(Object(vj.d)(Hc))if(hd=null===(Gd=w())||void 0===Gd?void 0:Gd.HIa(),Gd=new IA(Hc,Tb.node,hd,new rC,z(),new ck.b),4===qe){if(Gd.flip(!0,!1))return 32}else if(3===qe){if(Gd.flip(!1,!0))return 32}else if(Gd.rotate(jc))return 32;oe?(new TL.a(Hc,new UL.a,
new ck.b)).iZo(jc,ge,de,this.u3n,Tb):qe?this.rOc.create(Hc,Tb).nYo(jc,ge,de):(Gd=eb.a.create(),hd=new Sb.GraphTransaction(15,vb.a.$aa),hd.Ab(Tb.node),this.BM.XVo(Hc,jc),this.sLd.Pmo(Tb,Id.a.Mn(Tb),jc,Gd),hd.QLa(Gd,1),hd.Ph=Jb,hd.dispose());this.lPa();this.Rbd(Tb);ab.StaticActiveAppFrame.za().Ge()}return 32};this.qYb=(Jb,Tb,jc,Hc,hd)=>{if(!this.RQ(Tb))return 8;Jb=Id.a.Mn(Tb);Jb=Id.a.K2(Jb);if(0>Jb)return 2;hd.setValue(Od.a.pX,Jb);return 32};this.u3n=(Jb,Tb,jc,Hc)=>{if(Jb){const hd=new Sb.GraphTransaction(15,
vb.a.$aa);hd.Ab(Hc.node);Tb.setValue(Od.a.MLb,JSON.stringify(jc));Tb.setValue(Od.a.Bu,Jb);this.BM.exe(Tb,jc.rotationAngle,jc.Plc,jc.kBc);this.qPb(Tb);hd.dispose()}};this.b3n=(Jb,Tb,jc,Hc)=>{if(Jb){const hd=new Sb.GraphTransaction(15);hd.Ab(Hc.node);Tb.setValue(Od.a.MLb,JSON.stringify(jc));Tb.setValue(Od.a.Bu,Jb);this.BM.Lwe(Tb,jc.PDe,jc.zsd);this.qPb(Tb);hd.dispose()}};this.jYn=(Jb,Tb,jc,Hc)=>{if(Jb){const hd=new Sb.GraphTransaction(15);hd.Ab(Hc.node);Tb.setValue(Od.a.MLb,JSON.stringify(jc));Tb.setValue(Od.a.Bu,
Jb);this.BM.RVo(Tb,Math.round(jc.MIa*MK.a.iob),Math.round(jc.JIa*MK.a.iob),Math.round(jc.KIa*MK.a.iob),Math.round(jc.LIa*MK.a.iob));this.qPb(Tb);hd.dispose()}};this.thd=(Jb,Tb,jc,Hc,hd)=>{if(!this.Iqa(Tb))return 8;if(1===jc)return 32;Jb=this.Np(Tb);if(!Jb)return 8;jc=Id.a.Mn(Tb);Object(vj.d)(jc)?(Tb=NK.K4c(jc),void 0===Tb?Tb=ep.chd.mca="":void 0!==Tb.yNa?(Tb=(new NK).HOm(Tb),ep.chd.mca=Tb,Tb=""):Tb=ep.chd.mca=Tb.Qld):(Tb=this.Kp.RDi(nn.a.eX(Tb),jc),ep.chd.mca=Tb);this.IP&&this.IP.NAc(Tb);Tb=ep.chd.cqb(Jb,
ed.a.RTa);if(!Tb)return 8;hd.MenuItems=Tb;return 32};this.g4=(Jb,Tb,jc,Hc,hd)=>{if(!this.Iqa(Tb))return 8;Hc=Id.a.Mn(Tb);if(Object(vj.d)(Hc)){if(!Id.a.tmf(Hc))return 2}else if(Hc&&Id.a.Vz(Hc))return 2;if(1===jc)return 32;if(2!==jc)return 2;if(!hd)return v.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;if(Object(vj.d)(Hc)){if(!this.Ric.g4(Hc,Tb.node,hd))return 8}else{jc=new Sb.GraphTransaction(15);jc.Ab(Tb.node);const Gd=ep.Fva.lka(Tb.node,hd);this.Kp.g4(Hc,hd,Tb,Gd);
this.qPb(Hc);jc.dispose()}Jb==vb.a.cod&&this.IP.cTa(hd);this.Cvd();this.lPa();return 32};this.G3=(Jb,Tb,jc)=>{if(!this.Iqa(Tb))return 8;if(1===jc)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();ep.lFa=new Xw("PictureBorder",vb.a.cod);ep.lFa.Vyb(0);return 32};this.xca=(Jb,Tb,jc,Hc,hd)=>{if(!this.Iqa(Tb))return 8;if(1===jc)return 32;Jb=Id.a.Mn(Tb);if(Object(vj.d)(Jb)){if(!Id.a.tmf(Jb))return 2}else if(Jb&&Id.a.Vz(Jb))return 2;if(!hd)return v.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),
8;if(Object(vj.d)(Jb)){if(!this.Ric.xca(Jb,Tb.node,hd))return 8}else jc=new Sb.GraphTransaction(15),jc.Ab(Tb.node),this.Kp.xca(Jb,hd,Tb),this.qPb(Jb),jc.dispose();this.Cvd();this.lPa();return 32};this.Wdb=(Jb,Tb,jc,Hc,hd)=>{if(!this.Iqa(Tb))return 8;if(1===jc)return 32;Jb=Id.a.Mn(Tb);if(Object(vj.d)(Jb)){if(!Id.a.tmf(Jb))return 2}else if(Jb&&Id.a.Vz(Jb))return 2;if(!hd)return v.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;if(Object(vj.d)(Jb)){if(!this.Ric.lYo(Jb,Tb.node,
hd))return 8}else jc=new Sb.GraphTransaction(15),jc.Ab(Tb.node),this.Kp.Wdb(Jb,hd,Tb),this.qPb(Jb),jc.dispose();this.Cvd();this.lPa();return 32};this.dvc=(Jb,Tb,jc)=>{if(!this.Iqa(Tb))return 8;if(1===jc)return 32;Jb=Id.a.Mn(Tb);if(Object(vj.d)(Jb)){if(!this.Ric.dvc(Jb,Tb.node))return 8}else jc=new Sb.GraphTransaction(15),jc.Ab(Tb.node),Id.a.Blc(Jb)&&(this.Kp.dvc(Jb),this.qPb(Jb)),jc.dispose();this.Cvd();this.lPa();return 32};this.BM=b;this.rOc=r;this.sLd=L;ep.ii=Ab;null===oa||void 0===oa?void 0:oa.AB(ep.Vkl)}get IP(){return null!=
this.H2g?this.H2g:this.H2g=Wa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static Vkl(){ep.Aco()}get Kp(){this.Mda||(this.Mda=new rN.a);return this.Mda}get Ric(){this.BSe||(this.BSe=new NK);return this.BSe}Xb(b){super.Xb(b);this.ns(b,vb.a.Sx,this.Sx);b.Pc(vb.a.Sx,4);this.ns(b,vb.a.Bue,this.Bue);this.ns(b,Ec.a.uGe,this.slc);b.Pc(Ec.a.uGe,4);this.ns(b,Ec.a.vGe,this.slc);this.ns(b,Ec.a.wGe,this.slc);this.ns(b,Ec.a.xGe,this.slc);this.ns(b,Ec.a.yGe,this.slc);this.ns(b,Ec.a.zGe,this.slc);this.ns(b,
Ec.a.Iuc,this.Iuc);b.Pc(Ec.a.Iuc,101);this.ns(b,Ec.a.L6c,this.$Vm);b.Pc(Ec.a.L6c,4);this.ns(b,Ec.a.Twb,this.Twb);b.Pc(Ec.a.Twb,101);this.ns(b,Ec.a.CPi,this.aWm);this.ns(b,Ec.a.P6c,this.Y9d);this.ns(b,Ec.a.M6c,this.Y9d);this.ns(b,Ec.a.N6c,this.Y9d);this.ns(b,Ec.a.O6c,this.Y9d);this.ns(b,Ec.a.Did,this.puc);b.Pc(Ec.a.Did,101);this.ns(b,Ec.a.dre,this.puc);b.Pc(Ec.a.dre,101);this.ns(b,Ec.a.ere,this.puc);b.Pc(Ec.a.ere,101);this.ns(b,Ec.a.fre,this.puc);b.Pc(Ec.a.fre,101);this.ns(b,vb.a.$aa,this.cWm);b.Pc(vb.a.$aa,
4);this.ns(b,vb.a.qYb,this.qYb);b.Pc(vb.a.qYb,101);this.ns(b,vb.a.thd,this.thd);b.Pc(vb.a.thd,4);this.ns(b,vb.a.g4,this.g4);b.Pc(vb.a.g4,4);this.ns(b,vb.a.cod,this.g4);b.Pc(vb.a.cod,4);this.ns(b,vb.a.Ugg,this.G3);b.Pc(vb.a.Ugg,4);this.ns(b,vb.a.aDa,this.aDa.bind(this));b.Pc(vb.a.aDa,4);this.ns(b,vb.a.xca,this.xca);b.Pc(vb.a.xca,4);this.ns(b,vb.a.sYb,this.sYb.bind(this));b.Pc(vb.a.sYb,4);this.ns(b,vb.a.Wdb,this.Wdb);b.Pc(vb.a.Wdb,4);this.ns(b,vb.a.gbg,this.dvc);b.Pc(vb.a.gbg,4)}yxf(b,h,r,A){var L;
v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Id.a.Jce(b));this.BM.zBa()&&this.BM.Brd(b,h);if(Object(vj.d)(b)){const Z=null===(L=w())||void 0===L?void 0:L.HIa();if((new IA(b,h.node,Z,new rC,z(),new ck.b)).resize(r,A))return}Id.a.Vz(b)?(b=eb.a.create(),L=new Sb.GraphTransaction(15),L.Ab(h.node),this.sLd.Omo(h,Id.a.Mn(h),r,A,b),L.QLa(b,1),L.dispose()):Id.a.Exc(b)?(new TL.a(b,new UL.a,new ck.b)).SYo(r,A,this.b3n,h):(super.yxf(b,h,r,A),this.Qd.Yu(13))}RQ(b){if(!b.Al)return!1;
var h=b.node;return(h=Object(vj.c)()?h instanceof sj.a||h instanceof sN.a?h:null:Object(Ca.a)(sj.a,h))&&vx.n(h)?(or.Ac.fc(EO.a.Pn,{["Reason"]:FO.a.XQ}),!1):super.RQ(b)}static Aco(){ep.HGb||(ep.ii.B5a(ep.Mvb),ep.HGb=!0)}Hmo(b,h,r,A,L){return L?(L.LYi=b,L.d3=h,L.Zzb=r,L.Jx=A,L.Ofb=ep.rSm(L),!0):!1}Rbd(b){pf.a.xd().xm&&pf.a.xd().Bk.IG(b.node)}$Hn(){this.Mth||(v.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.Mth=!0)}qPb(b){const h=HO.a.instance.DAf(b);this.BM.cxe(b,h[dn.a.left],h[dn.a.right],
h[dn.a.top],h[dn.a.bottom])}Np(b){return b.contextId===kc.a.view?pl.PageReader.instance.DQb(b):Object(so.a)().Iu(b.node)}aDa(b,h,r,A,L){if(!this.Iqa(h))return 8;2===r&&(b=Id.a.Mn(h),Object(vj.d)(b)?this.Ric.qmp(L,b):this.Kp.ekk(L,b));return 32}sYb(b,h,r,A,L){if(!this.Iqa(h))return 8;2===r&&(b=Id.a.Mn(h),Object(vj.d)(b)?this.Ric.pmp(L,b):this.Kp.dkk(L,b));return 32}Cvd(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=
Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Fva(){return null!=ep.n5g?ep.n5g:ep.n5g=Bq.a.instance}static get chd(){ep.mJ||(ep.mJ=new Wq("PictureBorder"),ep.Kfa(ep.mJ));return ep.mJ}static rSm(b){if(b.LYi)b=1;else switch(b.Zzb){case bl.a.none:b=b.d3?3:4;break;case bl.a.N0b:b=1===b.Jx?8:3===b.Jx?9:2;break;case bl.a.x1j:b=5;break;case bl.a.D0j:b=6;break;case bl.a.x0j:b=7;break;default:b=
0}return b}static Kfa(b){b.PH(3,vb.a.g4);b.PH(4,vb.a.g4);b.PH(5,vb.a.cod);b.PH(6,vb.a.g4);b.z5a(fh.a.instance,1)}}ep.HGb=!1;ep.mJ=null;ep.lFa=null;ep.Mvb=()=>{ep.ii.hvc(ep.Mvb);ep.HGb=!1;if(eg.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else v.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(u.a)(ep,"ImageActor",or,[]);
class Om{static get ql(){return null!=Om.Y1g?Om.Y1g:Om.Y1g=Wa.a.instance.resolve("Box4.IParagraphEditor")}static get jC(){return null!=Om.i2g?Om.i2g:Om.i2g=Wa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get N3(){return Om.ql.fr}static get ih(){return null!=Om.r6g?Om.r6g:Om.r6g=Wa.a.instance.resolve("Box4.IUndoManager")}static Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.dYb,kc.a.view,Sn.a.zx);b.qa(vb.a.dYb,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.dYb,1036);b.qa(vb.a.FNb,kc.a.view,Sn.a.zx);
b.qa(vb.a.FNb,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.FNb,1036);b.qa(vb.a.Bob,kc.a.view,Sn.a.zx);b.qa(vb.a.Bob,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.Bob,1036);b.qa(vb.a.avc,kc.a.view,Sn.a.zx);b.qa(vb.a.avc,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.avc,1036);b.qa(vb.a.ukd,kc.a.view,Sn.a.zx);b.qa(vb.a.ukd,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.ukd,1036);b.qa(vb.a.e$a,kc.a.view,Sn.a.zx);b.qa(vb.a.e$a,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.e$a,1036);b.qa(vb.a.psb,kc.a.view,Sn.a.zx);b.qa(vb.a.psb,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.psb,
1036);b.qa(vb.a.d$a,kc.a.view,Sn.a.zx);b.qa(vb.a.d$a,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.d$a,1036);b.qa(vb.a.gxe,kc.a.view,Om.dAe);b.qa(vb.a.gxe,kc.a.paragraph,Om.dAe);b.Pc(vb.a.gxe,1028);b.qa(vb.a.oyg,kc.a.view,Om.dAe);b.qa(vb.a.oyg,kc.a.paragraph,Om.dAe);b.Pc(vb.a.oyg,1028);b.qa(vb.a.R_b,kc.a.view,Sn.a.zx);b.qa(vb.a.R_b,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.R_b,1036);b.qa(vb.a.Cyb,kc.a.view,Sn.a.zx);b.qa(vb.a.Cyb,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.Cyb,1036);b.qa(vb.a.S_b,kc.a.view,Sn.a.zx);b.qa(vb.a.S_b,
kc.a.paragraph,Om.Cqa);b.Pc(vb.a.S_b,1036);b.qa(vb.a.fDg,kc.a.view,Sn.a.zx);b.Pc(vb.a.fDg,1028);b.qa(vb.a.nod,kc.a.view,Sn.a.zx);b.qa(vb.a.nod,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.nod,1036);b.qa(vb.a.ood,kc.a.view,Sn.a.zx);b.qa(vb.a.ood,kc.a.paragraph,Om.Cqa);b.Pc(vb.a.ood,1036)}static dAe(b,h,r,A,L){2===r&&""===L[Ji.a.Text]&&(b=b===vb.a.gxe?vb.a.e$a:vb.a.d$a,h=new zD.a,h.value=0,h.unit=ed.a.mLa?2:1,y.AFrameworkApplication.va.Qb(b,2,h),ab.StaticActiveAppFrame.za().Ge());return 32}static Cqa(b,h,r,A,L){if(!({Hz:r}=
Sn.a.BAg(r,h)).returnValue)return r;h=h.node;switch(b){case vb.a.dYb:Om.N3.vmg(h,!0);break;case vb.a.FNb:Om.N3.vmg(h,!1);break;case vb.a.Bob:Om.N3.Bob(h);break;case vb.a.avc:Om.N3.jha(h,0);break;case vb.a.ukd:Om.N3.myb(h,0);break;case vb.a.psb:case vb.a.e$a:r=new hb.a;r.set(h);r.zb(11);let Z=L.value;L=L.unit;b===vb.a.psb&&(Z=(new Qt.a(L,Z)).Qu+Om.jC.qI(h).Qu,L=1);Om.N3.PDa(r,L,Z);break;case vb.a.d$a:Om.N3.oyb(h,L.unit,L.value);break;case vb.a.R_b:L?(b=(new Qt.a(L.unit,L.value)).Qu,Om.N3.jha(h,b)):
Om.jC.b6d(h).Qu||Om.N3.jha(h,fm.OutlineReader.u_(h));break;case vb.a.Cyb:L?(b=(new Qt.a(L.unit,L.value)).Qu,Om.N3.myb(h,b)):Om.jC.qI(h).Qu||Om.N3.myb(h,fm.OutlineReader.u_(h));break;case vb.a.S_b:Om.N3.jha(h,0);break;case vb.a.nod:b=L;b=(new Qt.a(b.unit,b.value)).Qu;Om.N3.ezg(h,1,b);break;case vb.a.ood:b=L,b=(new Qt.a(b.unit,b.value)).Qu,Om.N3.ezg(h,2,b)}Om.ih.uI();A&&At.a.Vzb&&(A.Xt|=At.a.Fqb(h));return 32}}Object(u.a)(Om,"IndentationActor",null,[]);var IO=d(394),JO=d(65),wz=d(434),VL=d(1037);class cq{constructor(b){this.E3a=
this.oHa=this.tMc=null;this.yKh=!1;this.rqe=h=>{if(this.oHa)if(h===Za.a.qqe)Sg.FocusManager.instance().getRegion(Qf.AFrame.zcb).urc();else if(h===Za.a.pqe)Sg.FocusManager.instance().getRegion(Qf.AFrame.zcb).rrc();else return 2;else return 2;return 32};this._frame=b}Odp(){if(this.yKh)this.V5i();else{const b=pb.a.create(y.AFrameworkApplication.J.jb("WopiBootstrapUrl"));b.Z1((h,r)=>{r.succeeded?(this.yKh=!0,this.V5i()):v.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});sb.a.m_(b)}}V5i(){if(this.tMc)v.ULS.sendTraceTag(38130908,
323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.Uva;this.oHa=document.createElement("div");b.parentNode.insertBefore(this.oHa,b);this.E3a=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:y.AFrameworkApplication.J.jb("FileName"),reactRoot:this.oHa});this.E3a.setWebpackPublicPath(y.AFrameworkApplication.L8);this.E3a.renderDocumentPanel()}}uxm(b){const h={};h.Container=b;h.BootstrapperUrl=y.AFrameworkApplication.J.jb("WopiBootstrapUrl");h.ApplicationUrl=
this._frame.WAb;b={};b.HostName=y.AFrameworkApplication.J.jb("FileSource");b.HostSessionId=y.AFrameworkApplication.J.jb("HostSessionId");b.UserId=y.AFrameworkApplication.J.jb("UserId");b.DocumentClickTime=new Date(this._frame.cvb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=y.AFrameworkApplication.J.jb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",
IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.cvb;h.Diagnostics=b;b={};b.WopiSrc=y.AFrameworkApplication.J.jb("WopiSrc");b.AccessToken=y.AFrameworkApplication.J.jb("AccessToken");b.AccessTokenTtl=y.AFrameworkApplication.J.jb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=r=>{cq.MZ=r;this.E3a.setMaxPage(cq.MZ.GetPageCount());this.E3a.setCurrentPage(cq.MZ.GetCurrentPage());this.E3a.setPageControlVisible(!0);cq.MZ.RegisterEventHandler("PageChanged",
A=>{this.E3a.setCurrentPage(A.newPage)});cq.MZ.RegisterEventHandler("BrowserEvent",A=>{27===A.keyCode?this.closeViewer():A.button&&1!==A.button||this.oHa.click()});r=this._frame.cvb-(new Date).getTime();v.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.Xb();Sg.FocusManager.instance().EN(Qf.AFrame.zcb,!0);this.buildFocusRegion();this.bNa(Sg.FocusManager.instance().ie(Qf.AFrame.zcb));this.oHa.click()};h.FnOnInitializeFailure=(r,A)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",
r.toString(),A.toString());this.closeViewer()};return h}buildFocusRegion(){const b=Sg.FocusManager.instance();var h=b.getRegion(Qf.AFrame.zcb);h=[2,3];const r=b.ie(Qf.AFrame.zcb),A=new Jg.DOMFocusListing(()=>this.oHa);A.Uga=!0;for(const L of h)A.rn(L);h=b.Rqa(()=>this.oHa,r,A);h.AZa();h.rP=!0;h.K6a=!0;A.iA(A.$ka)}Xb(){y.AFrameworkApplication.va.qa(Za.a.qqe,Gc.a.frame,this.rqe);y.AFrameworkApplication.va.qa(Za.a.pqe,Gc.a.frame,this.rqe)}bNa(b){b.ot(Sg.FocusManager.instance().BZ);b.ot(Sg.FocusManager.instance().CZ);
b.bindAction(Sg.FocusManager.instance().BZ,Za.a.qqe);b.bindAction(Sg.FocusManager.instance().CZ,Za.a.pqe)}loadViewer(b){b=this.uxm(b);this.tMc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.tMc.Complete(b.WopiInfo)}closeViewer(){Sg.FocusManager.instance().bV(Qf.AFrame.zcb);cq.MZ&&(cq.MZ.Dispose(),cq.MZ=null,y.AFrameworkApplication.va.Fy(Za.a.qqe,Gc.a.frame,this.rqe),y.AFrameworkApplication.va.Fy(Za.a.pqe,Gc.a.frame,this.rqe));this.tMc&&(this.oHa.parentNode.removeChild(this.oHa),this.oHa=
this.tMc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");y.AFrameworkApplication.va.Ob(vb.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");y.AFrameworkApplication.va.Ob(Ec.a.DZc,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");y.AFrameworkApplication.va.Ob(Za.a.Tea,2)}zoomInAction(){if(cq.MZ){let b=cq.MZ.GetZoomLevel();b+=.2;cq.MZ.SetZoomLevel(b)}}zoomOutAction(){if(cq.MZ){let b=
cq.MZ.GetZoomLevel();b-=.2;cq.MZ.SetZoomLevel(b)}}setPage(b){if(cq.MZ){const h=cq.MZ.GetPageCount();1>b?(cq.MZ.SetCurrentPage(1),this.E3a.setCurrentPage(1)):1<=b&&b<=h?cq.MZ.SetCurrentPage(b):(cq.MZ.SetCurrentPage(h),this.E3a.setCurrentPage(h))}}static getInstance(b){cq.Z3e||(cq.Z3e=new cq(b));return cq.Z3e}}cq.MZ=null;cq.Z3e=null;Object(u.a)(cq,"PreviewPanelActor",null,[]);class Jm{static get Bak(){return null!=Jm.J6g?Jm.J6g:Jm.J6g=y.AFrameworkApplication.J.jb("ClassicViewModePreferenceCookieName")}static get Fj(){return null!=
Jm.LSg?Jm.LSg:Jm.LSg=Wa.a.instance.Oa("WordEditor.ClientPagination.IClientPaginationSettings")}static Xb(b,h){b.fb(vb.a.readingMode,Gc.a.frame,Jm.ack,128);b.qa(vb.a.hBe,Gc.a.frame,Jm.ack);Jm.DQ=h;b.qa(Ec.a.owe,Gc.a.frame,Jm.owe);b.fb(Ec.a.Lre,Gc.a.frame,Jm.Lre,96);b.qa(Ec.a.$ad,Gc.a.frame,Jm.$ad);b.fb(Ec.a.gre,Gc.a.frame,Jm.gre,96);Jm.Fj.$hc&&Jm.DQ.ySc(Jm.ple)}static ack(b,h,r){if(h.contextId!==Gc.a.frame)return 2;h=Fl.a.hm;switch(b){case vb.a.readingMode:if(!h.WAb)return 8;if(1===r)return cc.SessionStatusManager.instance.Jk?
8:32;b=(new Date).getTime();dl.a.instance.Qso(b);h.cvb=b;y.AFrameworkApplication.J.$("InAppDocumentPreviewIsEnabled")?Ty.a.iU(Bz.a.s8f,!0,Jm.ygo,null,h):Ty.a.iU(Bz.a.s8f,!0,Jm.Yfj,null,h);return 32;case vb.a.hBe:return 32;default:return 2}}static Yfj(b){wz.a()?Jm.TQm(b):Jm.yZj(b)}static TQm(b){const h={};h[G.a.uSf]=Jm.Bak;y.AFrameworkApplication.nN().execute(r=>{r.Bv(K.a.vSf);r.Ktp(K.a.vSf);r.LE(K.a.vSf,A=>{Jm.Hol(A,b)});r.sendMessage(K.a.Bvm,h)})}static Hol(b,h){b.Values[G.a.uSf]===Jm.Bak&&("true"===
b.Values[G.a.POi]?Jm.yZj(h):(Jm.Zwp(),Jm.khp()))}static Zwp(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};y.AFrameworkApplication.$c("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static khp(){y.AFrameworkApplication.qw=
!0;ab.StaticActiveAppFrame.za().N8(1);ab.StaticActiveAppFrame.za().kb.Gw&&ab.StaticActiveAppFrame.za().kb.Gw.vj&&ab.StaticActiveAppFrame.za().kb.Gw.mUf();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&ab.StaticActiveAppFrame.za().Ge();VL.a.B2j(y.AFrameworkApplication.J)}static yZj(b){try{const h=new Ha.a;let r,A;y.AFrameworkApplication.Yak?(r=ed.a.hostUrl,A=3):(r=b.WAb,A=1);b.cvb&&h.add(y.AFrameworkApplication.t8f,b.cvb.toString());y.AFrameworkApplication.VWf&&
h.add(y.AFrameworkApplication.drf,"1");y.AFrameworkApplication.ymf&&h.add(y.AFrameworkApplication.wzl,"1");h.add(IO.a.XLg,IO.a.userSessionData);h.add(y.AFrameworkApplication.tqe,y.AFrameworkApplication.userSessionId);const L=y.AFrameworkApplication.J.jb(y.AFrameworkApplication.Yha);L&&h.add(y.AFrameworkApplication.P4j,L);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");wz.b(y.AFrameworkApplication.J)?wz.d("view",h,wz.c):(r=Ma.a.eef(r,h),y.AFrameworkApplication.Yak?rd.a.Tm(r,rd.a.Vva(A),
void 0,"AuthenticationLostDuringSession"):rd.a.openWindow(A,r,!1,void 0,JO.a.bEj))}catch(h){}}static ygo(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Wa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("previewPanel")).catch(()=>{v.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Jm.Yfj(b)}).then(()=>{cq.getInstance(b).Odp()})}static owe(b,
h,r){if(1===r)return 32;Jm.DQ.kNj(1===Jm.DQ.Gv?Jm.Fj.Lab?3:0:1);ab.StaticActiveAppFrame.za().Ge();return 32}static Lre(b,h,r,A,L){if(1===r)return 32;L[Tg.a.On]=1===Jm.DQ.Gv;return 32}static $ad(b,h,r){if(1===r)return 32;Jm.DQ.kNj(2);ab.StaticActiveAppFrame.za().Ge();return 32}static ple(b,h){2===h.ybb&&(b=ab.StaticActiveAppFrame.za(),b.N8(1),b.Ge())}static gre(b,h,r,A,L){if(!Jm.Fj.BJa)return 8;if(1===r)return 32;L[Tg.a.On]=2===Jm.DQ.Gv;return 32}}Jm.DQ=null;Object(u.a)(Jm,"MainViewModeActor",null,
[]);class tN{constructor(b,h,r){this.dKn=(A,L,Z,oa,Ba)=>1===Z?32:(A=this.ul.Vaa(L.Lk))?(Ba=3===Ba.az,this.C9.value.D$h(this.mHm(A),this.cRb(A),Ba),32):2;this.ga=b;this.C9=h;this.ul=r}Xb(){this.ga.qa(Ec.a.q2f,kc.a.view,this.dKn);this.ga.fb(Ec.a.kre,kc.a.view,Hm.d,96);this.ga.fb(Ec.a.hre,kc.a.view,Hm.d,96);this.ga.fb(Ec.a.ire,kc.a.view,Hm.d,96);this.ga.fb(Ec.a.jre,kc.a.view,Hm.d,96);this.ga.qa(Ec.a.Wfd,kc.a.view,Hm.c);this.ga.qa(Ec.a.Vfd,kc.a.view,Hm.c);this.ga.qa(Ec.a.foe,kc.a.view,Hm.c);this.ga.qa(Ec.a.goe,
kc.a.view,Hm.c)}mHm(b){const h=new lj.DictionaryPropertySet;h.setValue(Vc.a.marginTop,this.ul.usa(b));h.setValue(Vc.a.marginBottom,this.ul.xAa(b));h.setValue(Vc.a.marginLeft,this.ul.gN(b));h.setValue(Vc.a.marginRight,this.ul.hN(b));return h}cRb(b){const h=new lj.DictionaryPropertySet;h.setValue(Vc.a.pageWidth,this.ul.Jv(b));h.setValue(Vc.a.pageHeight,this.ul.qE(b));return h}}Object(u.a)(tN,"MarginsDialogActor",null,[]);class uN{constructor(b,h,r,A,L,Z){this.ga=b;this.Yc=h;this.tj=r;this.ED=A;this.qPg=
L;this.Mf=Z;this.DZ={$jk:["To- Do List"],akk:["DD/MM/YYYY"],bkk:["Add Subtitle here "],ckk:["- Add Item here \u2705  ","- Is your item complete? \u274c "],Cgk:["DD/MM/YYYY"],Dgk:["Journal Entry"],Egk:["Add Heading 1 Here"],Fgk:["- Reflect on your day  ","- What are you doing to take care of yourself?"],Rjk:["\u270f\ufe0f Task List  "],Hdk:["Brainstorming"],Jdk:["\ud83d\udc18 Question "],Kdk:["Add question for the group decision here."," "],Ldk:["\u2728 Background context "],Mdk:["Add relevant context for the project or initiative you're making a decision on here.",
" "],Ndk:["\ud83e\uddca Constraints"],Odk:["- Add a list of possible roadblocks and/or concerns here"," "],Pdk:["\ud83e\udd14 Assumptions "],Qdk:["- Add a list of things that you assume are true/untrue here"," "],Idk:["\ud83c\udfd3 Compare ideas"]};this.BCc=new Gl.a;this.BCc.setValue(Ke.a.bold,!1);this.BCc.setValue(Ke.a.fontSize,76);this.BCc.setValue(Ke.a.font,"Amasis MT Pro Regular");this.BCc.setValue(Ke.a.fontColor,0);this.CCc=new Gl.a;this.CCc.setValue(Ke.a.bold,!1);this.CCc.setValue(Ke.a.fontSize,
42);this.CCc.setValue(Ke.a.font,"Amasis MT Pro Regular");this.CCc.setValue(Ke.a.fontColor,11304704);this.DCc=new Gl.a;this.DCc.setValue(Ke.a.bold,!1);this.DCc.setValue(Ke.a.fontSize,24);this.DCc.setValue(Ke.a.font,"Trade Gothic Next Italic");this.DCc.setValue(Ke.a.fontColor,0);this.ECc=new Gl.a;this.ECc.setValue(Ke.a.bold,!1);this.ECc.setValue(Ke.a.fontSize,24);this.ECc.setValue(Ke.a.font,"Trade Gothic Next");this.ECc.setValue(Ke.a.fontColor,0);this.gCc=new Gl.a;this.gCc.setValue(Ke.a.bold,!1);this.gCc.setValue(Ke.a.fontSize,
76);this.gCc.setValue(Ke.a.font,"Sitka Banner");this.gCc.setValue(Ke.a.fontColor,1338346);this.hCc=new Gl.a;this.hCc.setValue(Ke.a.bold,!1);this.hCc.setValue(Ke.a.fontSize,42);this.hCc.setValue(Ke.a.font,"Sitka Heading");this.hCc.setValue(Ke.a.fontColor,0);this.iCc=new Gl.a;this.iCc.setValue(Ke.a.bold,!1);this.iCc.setValue(Ke.a.fontSize,32);this.iCc.setValue(Ke.a.font,"Sitka Subheading");this.iCc.setValue(Ke.a.fontColor,0);this.jCc=new Gl.a;this.jCc.setValue(Ke.a.bold,!1);this.jCc.setValue(Ke.a.fontSize,
24);this.jCc.setValue(Ke.a.font,"Sitka Text");this.jCc.setValue(Ke.a.fontColor,0);this.FCc=new Gl.a;this.FCc.setValue(Ke.a.bold,!1);this.FCc.setValue(Ke.a.fontSize,40);this.FCc.setValue(Ke.a.font,"Aptos Display");this.FCc.setValue(Ke.a.fontColor,6375183);this.PBc=new Gl.a;this.PBc.setValue(Ke.a.bold,!1);this.PBc.setValue(Ke.a.fontSize,40);this.PBc.setValue(Ke.a.font,"Aptos Display");this.PBc.setValue(Ke.a.fontColor,6375183);this.QBc=new Gl.a;this.QBc.setValue(Ke.a.bold,!1);this.QBc.setValue(Ke.a.fontSize,
24);this.QBc.setValue(Ke.a.font,"Segoe UI Emoji");this.QBc.setValue(Ke.a.fontColor,6375183);this.RBc=new Gl.a;this.RBc.setValue(Ke.a.bold,!1);this.RBc.setValue(Ke.a.fontSize,24);this.RBc.setValue(Ke.a.font,"Segoe UI Emoji");this.RBc.setValue(Ke.a.fontColor,0)}Xb(){this.ga.fb(Ec.a.dej,kc.a.Vc,this.S8k.bind(this),1028);this.ga.fb(Ec.a.r8f,kc.a.Vc,this.mSd.bind(this),1028);this.ga.fb(Ec.a.p8f,kc.a.Vc,this.mSd.bind(this),1028);this.ga.fb(Ec.a.q8f,kc.a.Vc,this.mSd.bind(this),1028);this.ga.fb(Ec.a.o8f,
kc.a.Vc,this.mSd.bind(this),1028)}S8k(){return null===this.Yc.instance?2:32}mSd(b,h,r){if(1===r)return 32;if(2===r){switch(b){case Ec.a.r8f:this.ecn(this.DZ.$jk,this.DZ.akk,this.DZ.bkk,this.DZ.ckk);break;case Ec.a.p8f:this.Nan(this.DZ.Cgk,this.DZ.Dgk,this.DZ.Egk,this.DZ.Fgk);break;case Ec.a.q8f:this.Wbn(this.DZ.Rjk);break;case Ec.a.o8f:this.T$m(this.DZ.Hdk,this.DZ.Jdk,this.DZ.Kdk,this.DZ.Ldk,this.DZ.Mdk,this.DZ.Ndk,this.DZ.Odk,this.DZ.Pdk,this.DZ.Qdk,this.DZ.Idk)}return 32}return 2}Nan(b,h,r,A){const L=
new Sb.GraphTransaction(15);try{const Z=If.a.instance.gb.currentSelection.Qa;let oa=Z.node,Ba;for(Ba=Dd.a.Bo(Z.node);Ba.moveNext();){const jc=Ba.currentNode;if(Cd.ParagraphReader.S$a(jc)&&Cd.ParagraphReader.Wb(jc)){oa=jc;break}}L.Ab(oa);const gb=this.Yc.instance.qF(b,oa,!0).toArray();this.wgk(gb);const Ab=this.Yc.instance.qF(h,oa,!0).toArray();this.xgk(Ab);const Jb=this.Yc.instance.qF(r,oa,!0).toArray();this.ygk(Jb);const Tb=this.Yc.instance.qF(A,oa,!0).toArray();this.zgk(Tb)}finally{L.dispose()}}wgk(b){for(const h of b)b=
h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.gCc)})}xgk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.hCc)})}ygk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.iCc)})}zgk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.jCc)})}ecn(b,h,r,A){const L=new Sb.GraphTransaction(15);try{const Z=If.a.instance.gb.currentSelection.Qa;let oa=Z.node,Ba;for(Ba=Dd.a.Bo(Z.node);Ba.moveNext();){const jc=
Ba.currentNode;if(Cd.ParagraphReader.S$a(jc)&&Cd.ParagraphReader.Wb(jc)){oa=jc;break}}L.Ab(oa);const gb=this.Yc.instance.qF(b,oa,!0).toArray();this.xjk(gb);const Ab=this.Yc.instance.qF(h,oa,!0).toArray();this.yjk(Ab);const Jb=this.Yc.instance.qF(r,oa,!0).toArray();this.zjk(Jb);const Tb=this.Yc.instance.qF(A,oa,!0).toArray();this.Ajk(Tb)}finally{L.dispose()}}xjk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.BCc)})}yjk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,
r=>{this.tj.qha(r,this.CCc)})}zjk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.DCc)})}Ajk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.ECc)})}Wbn(b){const h=new Sb.GraphTransaction(15);try{const r=If.a.instance.gb.currentSelection.Qa;let A=r.node,L;for(L=Dd.a.Bo(r.node);L.moveNext();){const Ab=L.currentNode;if(Cd.ParagraphReader.S$a(Ab)&&Cd.ParagraphReader.Wb(Ab)){A=Ab;break}}h.Ab(A);const Z=this.Yc.instance.qF(b,A,!0).toArray();
this.Gjk(Z);const oa=hb.a.eb(A);oa.zb(23);oa.kd(11);this.Mf.yy(oa,!0,!1,null,!1,!1);const Ba=this.qPg.vza(oa,4,3),gb=hb.a.eb(Ba);Kh.moveToCell(gb,0,0);gb.currentNode.properties.setValue(Ke.a.QG,16247258);gb.kd(14);Kh.moveToCell(gb,0,1);gb.currentNode.properties.setValue(Ke.a.QG,16247258);gb.kd(14);Kh.moveToCell(gb,0,2);gb.currentNode.properties.setValue(Ke.a.QG,16247258);gb.kd(14);gb.Fo(0,-1);gb.Fo(0,-1);gb.Fo(0,-1);A=gb.Fo(0,-1);this.Yc.instance.qF(["Task"],A,!0).toArray();gb.kd(14);gb.Fo(0,-1);
gb.Fo(1,-1);gb.Fo(0,-1);A=gb.Fo(0,-1);this.Yc.instance.qF(["Assigned to"],A,!0).toArray();gb.kd(14);gb.Fo(0,-1);gb.Fo(2,-1);gb.Fo(0,-1);A=gb.Fo(0,-1);this.Yc.instance.qF(["Due Date"],A,!0).toArray()}finally{h.dispose()}}Gjk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.FCc)})}T$m(b,h,r,A,L,Z,oa,Ba,gb,Ab){const Jb=new Sb.GraphTransaction(15);try{const Tb=If.a.instance.gb.currentSelection.Qa;let jc=Tb.node,Hc;for(Hc=Dd.a.Bo(Tb.node);Hc.moveNext();){const Vn=Hc.currentNode;
if(Cd.ParagraphReader.S$a(Vn)&&Cd.ParagraphReader.Wb(Vn)){jc=Vn;break}}Jb.Ab(jc);const hd=this.Yc.instance.qF(b,jc,!0).toArray();this.Ddk(hd);const Gd=this.Yc.instance.qF(h,jc,!0).toArray();this.NBc(Gd);const de=this.Yc.instance.qF(r,jc,!0).toArray();this.Oud(de);const qe=this.Yc.instance.qF(A,jc,!0).toArray();this.NBc(qe);const oe=this.Yc.instance.qF(L,jc,!0).toArray();this.Oud(oe);const ge=this.Yc.instance.qF(Z,jc,!0).toArray();this.NBc(ge);const $d=this.Yc.instance.qF(oa,jc,!0).toArray();this.Oud($d);
const lf=this.Yc.instance.qF(Ba,jc,!0).toArray();this.NBc(lf);const wf=this.Yc.instance.qF(gb,jc,!0).toArray();this.Oud(wf);const gi=this.Yc.instance.qF(Ab,jc,!0).toArray();this.NBc(gi);const Di=hb.a.eb(jc);Di.zb(23);Di.kd(11);this.Mf.yy(Di,!0,!1,null,!1,!1);const Yl=this.qPg.vza(Di,3,4),xk=hb.a.eb(Yl);xk.kd(14);xk.Fo(0,-1);xk.Fo(0,-1);xk.Fo(0,-1);jc=xk.Fo(0,-1);this.Yc.instance.qF(["Idea"],jc,!0).toArray();xk.kd(14);xk.Fo(0,-1);xk.Fo(1,-1);xk.Fo(0,-1);jc=xk.Fo(0,-1);this.Yc.instance.qF(["Pros"],
jc,!0).toArray();xk.kd(14);xk.Fo(0,-1);xk.Fo(2,-1);xk.Fo(0,-1);jc=xk.Fo(0,-1);this.Yc.instance.qF(["Cons"],jc,!0).toArray();xk.kd(14);xk.Fo(0,-1);xk.Fo(3,-1);xk.Fo(0,-1);jc=xk.Fo(0,-1);this.Yc.instance.qF(["Votes"],jc,!0).toArray()}finally{Jb.dispose()}}Ddk(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.PBc)})}NBc(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,this.QBc)})}Oud(b){for(const h of b)b=h.node,this.ED.lea(b,0,b.kY.length,r=>{this.tj.qha(r,
this.RBc)})}}Object(u.a)(uN,"MiniTemplateActor",null,[]);class XL{constructor(b){this.Crd=(h,r,A)=>{if(1===A)return 32;h=y.AFrameworkApplication.ua;if(!h)return 32;h.$Sd();XL.SLo(h);return 32};this.ga=b}Xb(){this.ga.qa(Ec.a.Crd,kc.a.view,this.Crd)}static SLo(b){const h=y.AFrameworkApplication.J.jb("ModernUxExperimentPreferenceCookieName");var r=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");r=Pc.a.oAa(h,!r);Pc.a.q_a(h,(!r).toString(),Pc.a.$Xa);r?v.ULS.sendTraceTag(576075457,
340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");me.d(Ec.a.Crd,!0,void 0,void 0,void 0,void 0,[Object.assign(new da.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.eca(null)}}Object(u.a)(XL,"ModernUxActor",null,[]);var iP=d(893),Yr=d(1809);class KO{constructor(b,h,r,A){this.Rze=Tf.a.lD(1)/6;this.vYo=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;if(oa=this.qg.Vaa(Z.Lk)){if(0<=gb&&gb<Yr.a.S3.length){Z=
new Sb.GraphTransaction(15);Z.Ab(oa);Z.Ph=L;L=Yr.a.S3[gb].tGd;Ba=Yr.a.S3[gb].rGd;const Ab=Yr.a.S3[gb]._marginLeft;gb=Yr.a.S3[gb].sGd;this.Goe(L,Ba,this.qg.qE(oa))&&this.Goe(Ab,gb,this.qg.Jv(oa))?(this.HG.Sdb(oa,L),this.HG.Qdb(oa,Ba),this.HG.sna(oa,Ab),this.HG.Rdb(oa,gb),this.Zd.Yu(11)):this.HNa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);Z.dispose()}else return 2;return 32}v.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk);return 2};this.wYo=(L,Z,
oa,Ba,gb)=>{if(1===oa)return 32;if(oa=this.qg.Vaa(Z.Lk)){if(0<=gb&&gb<Yr.a.uua.length)Z=new Sb.GraphTransaction(15),Z.Ab(oa),Z.Ph=L,L=(Ba=this.qg.C9c(oa))?Yr.a.uua[gb].C3a:Yr.a.uua[gb].D3a,gb=Ba?Yr.a.uua[gb].D3a:Yr.a.uua[gb].C3a,this.Goe(this.qg.xAa(oa),this.qg.usa(oa),gb)&&this.Goe(this.qg.gN(oa),this.qg.hN(oa),L)?(this.HG.Iyg(oa,L),this.HG.Hyg(oa,gb),this.Zd.Yu(11)):this.HNa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),Z.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,
50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk);return 2};this.NXo=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;if(oa=this.qg.Vaa(Z.Lk)){Z=this.qg.C9c(oa);Ba=new Sb.GraphTransaction(15);Ba.Ab(oa);Ba.Ph=L;this.HG.qOj(oa,gb);if(gb&&!Z||!gb&&Z){L=this.qg.Jv(oa);gb=this.qg.qE(oa);this.HG.Iyg(oa,gb);this.HG.Hyg(oa,L);L=this.qg.usa(oa);gb=this.qg.xAa(oa);const Ab=this.qg.gN(oa),Jb=this.qg.hN(oa);Z?(this.HG.Sdb(oa,y.AFrameworkApplication.isRtl?Ab:Jb),this.HG.Qdb(oa,y.AFrameworkApplication.isRtl?Jb:
Ab),this.HG.sna(oa,y.AFrameworkApplication.isRtl?gb:L),this.HG.Rdb(oa,y.AFrameworkApplication.isRtl?L:gb)):(this.HG.Sdb(oa,y.AFrameworkApplication.isRtl?Jb:Ab),this.HG.Qdb(oa,y.AFrameworkApplication.isRtl?Ab:Jb),this.HG.sna(oa,y.AFrameworkApplication.isRtl?Math.abs(L):gb),this.HG.Rdb(oa,y.AFrameworkApplication.isRtl?gb:L));this.Zd.Yu(11)}Ba.dispose();return 32}v.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk);return 2};this.Oce=(L,Z,oa)=>{if(1===oa)return 1===
this.cT.Gv?32:8};this.hyb=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;oa=this.qg.Vaa(Z.Lk);if(!oa)return v.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk),2;Z=new Sb.GraphTransaction(15);Z.Ab(oa);Z.Ph=L;L=Math.floor(this.qg.Jv(oa)/720);if(0>gb||gb>L)return 2;this.HG.s_b(oa,gb);this.MBd.execute(Ab=>{Ab.logActivity("WordWebColumnsActivity",null)});Z.dispose();return 32};this.Fwe=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;oa=this.qg.Vaa(Z.Lk);if(!oa)return v.ULS.sendTraceTag(520618521,
3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk),2;Z=new Sb.GraphTransaction(15);Z.Ab(oa);Z.Ph=L;L=gb[0];Ba=this.qg.Jv(oa);if(720>L||L>Ba)return 2;this.HG.Lwc(oa,gb);this.MBd.execute(Ab=>{Ab.logActivity("WordWebColumnsActivity",null)});Z.dispose();return 32};this.Ewe=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;oa=this.qg.Vaa(Z.Lk);if(!oa)return v.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk),2;Z=new Sb.GraphTransaction(15);Z.Ab(oa);Z.Ph=L;
L=this.qg.Jv(oa);Ba=this.qg.Eh(oa);if(0>gb||gb>(L-720*Ba)/(Ba-1))return 2;this.HG.hTo(oa,gb);this.MBd.execute(Ab=>{Ab.logActivity("WordWebColumnsActivity",null)});Z.dispose();return 32};this.Dwe=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;oa=this.qg.Vaa(Z.Lk);if(!oa)return v.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk),2;Z=new Sb.GraphTransaction(15);Z.Ab(oa);Z.Ph=L;if(null==gb)return 2;this.HG.LZo(oa,gb);this.MBd.execute(Ab=>{Ab.logActivity("WordWebColumnsActivity",
null)});Z.dispose();return 32};this.VMa=(L,Z,oa,Ba,gb)=>{let Ab;try{Ab=this.qg.Vaa(Z.Lk)}catch(Jb){return v.ULS.sendTraceTag(508339925,3009,50,"context.nextContext = {0}",Z.Lk),2}if(Ab)return gb.marginTop=this.qg.usa(Ab),gb.marginBottom=this.qg.xAa(Ab),gb.marginLeft=this.qg.gN(Ab),gb.marginRight=this.qg.hN(Ab),gb.pageWidth=this.qg.Jv(Ab),gb.pageHeight=this.qg.qE(Ab),gb.DBa=this.qg.C9c(Ab),gb.SG=this.qg.Eh(Ab),gb.bra=this.qg.Cqb(Ab),gb.uvl=this.qg.x8d(Ab),gb.tVb=this.Mzm(gb),gb.gXb=this.eEm(gb),gb.TVc=
this.qmm(gb),32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk);return 2};this.sxe=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;if(oa=this.qg.Vaa(Z.Lk)){Z=new Sb.GraphTransaction(15);Z.Ab(oa);switch(L){case vb.a.Sdb:this.HG.Sdb(oa,gb);break;case vb.a.Qdb:this.HG.Qdb(oa,gb);break;case vb.a.sna:this.HG.sna(oa,gb);break;case vb.a.Rdb:this.HG.Rdb(oa,gb)}this.Zd.Yu(11);Z.dispose();return 32}v.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",
Z.Lk);return 2};this.WOj=(L,Z,oa,Ba,gb)=>{if(1===oa)return 32;if(oa=this.qg.Vaa(Z.Lk)){Z=new Sb.GraphTransaction(15);Z.Ab(oa);let Ab=Ba=0;switch(L){case vb.a.Kyg:Ab=gb;this.HG.Iyg(oa,Ab);Ba=this.qg.qE(oa);break;case vb.a.Jyg:Ba=gb,this.HG.Hyg(oa,Ba),Ab=this.qg.Jv(oa)}this.HG.qOj(oa,Ba<Ab);this.Zd.Yu(11);Z.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",Z.Lk);return 2};this.HG=b;this.Zd=h;this.cT=r;this.MBd=A}get qg(){return Tq.a.instance}Nzm(b){var h=
ed.a.jZf,r=h?1:3,A=y.AFrameworkApplication.numberFormat;let L=Yr.a.S3[b].tGd;var Z=Yr.a.S3[b].rGd;var oa=Yr.a.S3[b]._marginLeft;b=Yr.a.S3[b].sGd;L=h?Tf.a.l0a(L):Tf.a.iB(L);Z=h?Tf.a.l0a(Z):Tf.a.iB(Z);oa=h?Tf.a.l0a(oa):Tf.a.iB(oa);b=h?Tf.a.l0a(b):Tf.a.iB(b);h=F.a.RJa(L,r,A);Z=F.a.RJa(Z,r,A);oa=F.a.RJa(oa,r,A);r=F.a.RJa(b,r,A);A={};A.top=h;A.bottom=Z;A.left=oa;A.right=r;return A}bKn(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,A=WordRibbonStrings.PageMarginsLeft,
L=WordRibbonStrings.PageMarginsRight;b=this.Nzm(b);return[[h,b.top,r,b.bottom],[A,b.left,L,b.right]]}rgd(b){var h=ed.a.jZf,r=h?1:3;const A=y.AFrameworkApplication.numberFormat;let L=Yr.a.uua[b].C3a;b=Yr.a.uua[b].D3a;L=h?Tf.a.l0a(L):Tf.a.iB(L);b=h?Tf.a.l0a(b):Tf.a.iB(b);h=F.a.RJa(b,r,A);r=F.a.RJa(L,r,A);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Xb(){const b=y.AFrameworkApplication.va;b.fb(vb.a.Tdb,kc.a.view,this.vYo,4);b.fb(vb.a.i_a,kc.a.view,this.wYo,4);b.fb(vb.a.setOrientation,
kc.a.view,this.NXo,4);b.fb(vb.a.VMa,kc.a.view,this.VMa,96);b.qa(vb.a.Sdb,kc.a.view,this.sxe);b.qa(vb.a.Qdb,kc.a.view,this.sxe);b.qa(vb.a.sna,kc.a.view,this.sxe);b.qa(vb.a.Rdb,kc.a.view,this.sxe);b.qa(vb.a.Kyg,kc.a.view,this.WOj);b.qa(vb.a.Jyg,kc.a.view,this.WOj);b.fb(vb.a.Oce,kc.a.view,this.Oce,4);b.qa(vb.a.hyb,kc.a.view,this.hyb);b.qa(vb.a.Fwe,kc.a.view,this.Fwe);b.qa(vb.a.Ewe,kc.a.view,this.Ewe);b.qa(vb.a.Dwe,kc.a.view,this.Dwe)}Goe(b,h,r){return r>=b+h+ed.a.LEa}Mzm(b){let h=5;for(let r=0;r<Yr.a.S3.length;r++)if(Yr.a.S3[r].tGd===
b.marginTop&&Yr.a.S3[r].rGd===b.marginBottom&&Yr.a.S3[r]._marginLeft===b.marginLeft&&Yr.a.S3[r].sGd===b.marginRight){h=r;break}return h}eEm(b){let h=5;b=new iP.a(Math.min(b.pageWidth,b.pageHeight),Math.max(b.pageWidth,b.pageHeight));for(let r=0;r<Yr.a.uua.length;r++)if(this.o9n(b,Yr.a.uua[r])){h=r;break}return h}qmm(b){let h=0;switch(b.SG){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}o9n(b,h){return Sf.a.dVi(b.D3a,Math.max(h.D3a-this.Rze,0),h.D3a+this.Rze)&&Sf.a.dVi(b.C3a,Math.max(h.C3a-
this.Rze,0),h.C3a+this.Rze)}HNa(b){if(!ff.a.PO){const h=new Ag.StandardDialog;h.Bd=0;h.lV(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(u.a)(KO,"PageActor",null,[364]);class vN{constructor(b){this.ga=b}get Pb(){return this.ga}rxe(b,h){let r=0;b?1===b?r=vb.a.sna:2===b?r=vb.a.Rdb:3===b&&(r=vb.a.Qdb):r=vb.a.Sdb;this.Pb.Qb(r,2,h)}i_a(b,h){let r=0;1===b?r=vb.a.Jyg:b||(r=vb.a.Kyg);this.Pb.Qb(r,2,h)}Cwe(b,h){let r=0;switch(b){case 0:r=vb.a.hyb;break;case 1:r=vb.a.Fwe;break;case 2:r=vb.a.Ewe;break;
case 3:r=vb.a.Dwe}this.Pb.Qb(r,2,h)}}Object(u.a)(vN,"PageCommands",null,[365]);class LO{constructor(b,h,r){this.n9n=(A,L,Z,oa,Ba)=>1===Z?32:(A=this.ul.Vaa(L.Lk))?(Ba=3===Ba.az,this.C9.value.eai(this.nHm(A),this.cRb(A),Ba),32):2;this.ga=b;this.C9=h;this.ul=r}Xb(){this.ga.qa(Ec.a.s2f,kc.a.view,this.n9n);this.ga.fb(Ec.a.zre,kc.a.view,Hm.d,96);this.ga.fb(Ec.a.yre,kc.a.view,Hm.d,96);this.ga.qa(Ec.a.joe,kc.a.view,Hm.c);this.ga.qa(Ec.a.ioe,kc.a.view,Hm.c)}nHm(b){const h=new lj.DictionaryPropertySet;h.setValue(Vc.a.pageWidth,
this.ul.Jv(b));h.setValue(Vc.a.pageHeight,this.ul.qE(b));return h}cRb(b){const h=new lj.DictionaryPropertySet;h.setValue(Vc.a.marginTop,Math.abs(this.ul.usa(b)));h.setValue(Vc.a.marginBottom,Math.abs(this.ul.xAa(b)));h.setValue(Vc.a.marginLeft,this.ul.gN(b));h.setValue(Vc.a.marginRight,this.ul.hN(b));return h}}Object(u.a)(LO,"PaperSizeDialogActor",null,[]);class JA{constructor(b,h,r){this.ga=b;this.C9=h;this.hZ=r}Xb(){this.ga.fb(vb.a.$pc,kc.a.view,this.b$n.bind(this),1028);this.ga.qa(vb.a.$pc,kc.a.paragraph,
this.$9n.bind(this));this.ga.fb(vb.a.nmo,kc.a.view,Hm.d,96);this.ga.fb(vb.a.omo,kc.a.view,Hm.d,96);this.ga.fb(vb.a.ulo,kc.a.view,Hm.d,96);this.ga.fb(vb.a.vlo,kc.a.view,Hm.d,96);this.ga.fb(vb.a.gcp,kc.a.view,Hm.c,96);this.ga.fb(vb.a.fcp,kc.a.view,Hm.c,96);this.ga.fb(vb.a.f7n,kc.a.view,Hm.c,96);this.ga.fb(vb.a.g7n,kc.a.view,Hm.c,96);this.ga.fb(vb.a.T6n,kc.a.view,Hm.c,96);this.ga.fb(vb.a.ecp,kc.a.view,Hm.c,96);this.ga.fb(vb.a.U6n,kc.a.view,Hm.c,96)}$9n(b,h,r,A,L){if(1===r)return 3===this.ga.mode||2===
this.ga.mode?32:8;b=h.node;h=this.N3j(h);L=3===L.az;this.C9.value.rYd(this.k4c(b),this.cRb(h),L);return 32}b$n(b,h,r,A,L){b=h.view.lb;if(!b||JA.tg.xnc(b.Pg))return 8;if(Object(Nl.a)().HEa(Cd.ParagraphReader.xX,b.Pg))return JA.Ac.fc(Df.a.Ne,{["Reason"]:gf.a.XQ}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.gb.currentSelection;h=this.N3j(h);L=3===L.az;if(1===r.length&&he.a.mf(r.K(0)))return r=r.K(0).node,this.C9.value.rYd(this.k4c(r),this.cRb(h),L),32;b=[];for(A=0;A<r.length;A++){const Z=
r.K(A);(!A&&he.a.pl(Z)||Cd.ParagraphReader.en(Z)||he.a.Zl(Z))&&b.push(Z.node)}if(!b.length)return 8;r=Array(b.length);for(A=0;A<b.length;A++)r[A]=this.k4c(b[A]);r=IC.a.gAi(r);this.C9.value.rYd(r,this.cRb(h),L);return 32}k4c(b){const h=new lj.DictionaryPropertySet;h.setValue(Od.a.Jx,Cd.ParagraphReader.Xy(b));const r=this.hZ.HVa(b);var A=r.lineSpacing;h.setValue(Od.a.Pab,A.unit);h.setValue(Od.a.xa,A.value);A=r.beforeSpacing;h.setValue(Od.a.otc,A.unit);h.setValue(Od.a.ptc,A.value);A=r.afterSpacing;h.setValue(Od.a.mtc,
A.unit);h.setValue(Od.a.ntc,A.value);h.setValue(Od.a.ygd,r.ny);h.setValue(De.a.keepWithNext,Cd.ParagraphReader.keepWithNext(b));h.setValue(De.a.widowControl,Cd.ParagraphReader.uBc(b));h.setValue(De.a.keepTogether,Cd.ParagraphReader.keepTogether(b));return h}static get tg(){return Be.a.instance}static get Ac(){return ih.a.instance}}Object(u.a)(JA,"AParagraphDialogActor",null,[]);class wN extends JA{constructor(b,h,r,A,L){super(b,h,r);this.ul=A;this.Sp=L}Xb(){super.Xb();this.ga.fb(vb.a.Zwj,kc.a.view,
Hm.d,96);this.ga.fb(vb.a.$wj,kc.a.view,Hm.d,96);this.ga.fb(vb.a.Alo,kc.a.view,Hm.d,96);this.ga.fb(vb.a.V5m,kc.a.view,Hm.c,96);this.ga.fb(vb.a.X5m,kc.a.view,Hm.c,96);this.ga.fb(vb.a.ccp,kc.a.view,Hm.c,96);this.ga.fb(vb.a.dcp,kc.a.view,Hm.c,96);this.ga.fb(vb.a.b7n,kc.a.view,Hm.c,96);this.ga.fb(vb.a.i7n,kc.a.view,Hm.c,96);this.ga.fb(vb.a.h7n,kc.a.view,Hm.c,96);this.ga.fb(vb.a.hcp,kc.a.view,Hm.c,96);this.ga.fb(vb.a.pmo,kc.a.view,Hm.d,96);this.ga.fb(vb.a.qmo,kc.a.view,Hm.d,96)}N3j(b){return this.ul.Vaa(b.Lk)}k4c(b){const h=
super.k4c(b);var r=this.Sp.fX(b);const A=this.Sp.qI(b);h.setValue(Od.a.GMa,1);h.setValue(Od.a.HMa,r.Qu-A.Qu);r=this.Sp.v9a(b);h.setValue(Od.a.rwb,r.unit);h.setValue(Od.a.swb,r.value);b=this.Sp.Okc(b);b.specialIndentType&&(h.setValue(Od.a.I8,b.specialIndentType),h.setValue(Od.a.E_a,b.unit),h.setValue(Od.a.F_a,b.value));return h}cRb(b){const h=new lj.DictionaryPropertySet;h.setValue(Vc.a.pageWidth,this.ul.Jv(b));h.setValue(Vc.a.pageHeight,this.ul.qE(b));h.setValue(Vc.a.marginTop,Math.abs(this.ul.usa(b)));
h.setValue(Vc.a.marginBottom,Math.abs(this.ul.xAa(b)));h.setValue(Vc.a.marginLeft,this.ul.gN(b));h.setValue(Vc.a.marginRight,this.ul.hN(b));return h}}Object(u.a)(wN,"ParagraphDialogActor",JA,[]);class TI extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.pZi=h}}Object(u.a)(TI,"AfterPasteEventArgs",Sys.EventArgs,[]);class xN{constructor(b){this.TVe=null;this.HAd=b}get q3d(){return null!=this.QVg?this.QVg:this.QVg=Wa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get bde(){this.TVe||
(this.TVe=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(rt.a.Lei));return this.TVe}Qio(b){if(b&&Eb.a.Mh(b.fAa)&&Eb.a.Mh(b.oub)){this.ljo(b);var h=new zl.a;for(h.nd(b.fAa);h&&h.currentNode;){const r=this.J7d(h),A=Cd.ParagraphReader.Wb(r);A&&Cd.ParagraphReader.Jnb(r)&&this.Oio(r);const L=h.currentNode.id===b.oub.currentNode.id;A&&this.bde&&r.Fk.ila(r.type).ise(new TI(r,L));if(L)break;fg.OutlineElementNavigator.ft(h,!1,!1)}}}Oio(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");
const h=b.Btc;b=xc.a.Uc(b,0);xn.g9c(h)?this.q3d.npe(b,h):this.HAd.npe(b,h)}ljo(b){if(b.fAa.currentNode&&b.oub.currentNode&&b.fAa.currentNode.id===b.oub.currentNode.id){const h=this.J7d(b.fAa);Cd.ParagraphReader.Wb(h)?this.Sio(h,b.Yao,b.Xao):v.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}Sio(b,h,r){v.ULS.shipAssertTag(590956771,307,0<=h);v.ULS.shipAssertTag(590958592,307,0<=r);var A=Cd.ParagraphReader.text(b);if(""!==A){var L=xc.a.createTextRange(b,
h,r);L=Ic.a.Oz(L,!1);if(1===L.length){const Z=L[0];L=A.substring(h,r).trim();A=A.substring(Z.cpBegin,Z.cpEnd).trim();h=L===A;L=xc.a.createTextRange(b,Z.cpBegin,Z.cpEnd);if(Z.hyperlink&&h&&!Ic.a.qXa(A))b=Z.hyperlink.url;else if(h)b=A;else{v.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}xn.g9c(b)?this.q3d.sWa(L,b,!1):this.HAd.sWa(L,b,!1)}else v.ULS.sendTraceTag(590958597,
307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",L.length)}}J7d(b){const h=fg.OutlineElementNavigator.Me(b);fg.OutlineElementNavigator.me(b);return h}}Object(u.a)(xN,"PastedContentsProcessorPostMergeAfterPaste",null,[363]);class UI extends Zx{constructor(b,h,r,A,L,Z,oa,Ba){super(A);this.J6e=7;this.xx=this.bHc=null;this.BUe=0;this.yUe=b;this.xl=h;this.ko=r;this.ee=L;this.wmk=oa;this.W3a=Ba;
this.Q5=this.ee.UXa("UserAction","WordIgnoreAll")}Tzg(b){this.yUe.S$i();this.bHc=this.ko.msa(b);this.W3a.xPi(this.bHc,null,!1);return this.yUe.p4j(this.bHc)?(this.Q5.start(),this.xx=new Sb.GraphTransaction(15),this.xx.Ab(b.node),!0):!1}zqe(b){this.$Xb(b.node);return!0}Thd(b){this.$Xb(b);return!0}Aqe(b){this.$Xb(b.node)}jGg(b){this.xx.dispose();this.bHc.errorDetails.lAb(b.actionId);this.Q5.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",
this.BUe,this.Q5.Ri,this.bHc.errorDetails.proofingType));return!0}gyc(b,h){if(super.gyc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}GEi(b){if(b&&b.type!==this.J6e){const h=hb.a.eb(b);return h.zb(this.J6e)?h.kd(this.J6e):b}return b}Uln(b,h){return this.yUe.Vod(h.errorDetails)&&!this.xl.jba(xc.a.createTextRange(b,h.Dc,h.end))}$Xb(b){if(b){var h=this.ko.f7(b,r=>this.Uln(b,r));this.wmk?this.ko.ixb(b,h,!0):0<h.length&&(b.Xl(4,!0),this.ko.iWb(b));this.BUe+=h.length}}}Object(u.a)(UI,
"IgnoreAllCallbackSteps",Zx,[]);class yN{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){this.Nid=(Hc,hd,Gd,de,qe)=>{if(1===Gd)return 32;Hc=this.LK.iKa(hd.view.lb.Pg);if(Hc=kg.a.Eg(Hc))qe[Um.a.LabelText]=Hc.displayName;return 32};this.Hsa=(Hc,hd,Gd,de,qe,oe)=>{const ge=new UI(this.czk,this.xl,this.ko,this.Qe,this.ee,this.uZ,0,this.W3a);return new jB(Hc,hd,Gd,de,qe,oe,ge,this.ga,this.ib,this.Qe,"IgnoreAllOperation")};this.PNb=(Hc,hd,Gd,de,qe,oe)=>{const ge=new UI(this.Ptk,this.xl,this.ko,this.Qe,this.ee,
this.uZ,1,this.W3a);return new jB(Hc,hd,Gd,de,qe,oe,ge,this.ga,this.ib,this.Qe,"DoNotCheckThisCritiqueType")};this.ga=b;this.xl=h;this.ib=r;this.Qe=A;this.ko=L;this.LK=Z;this.ee=oa;this.czk=Ba;this.Ptk=gb;this.$7b=Ab.q$c;this.uZ=Ab;this.W3a=Jb;this.DWe=Tb;this.zgb=jc}Xb(){this.DWe&&(zt.nD()?this.ga.fb(vb.a.Hsa,kc.a.Vc,this.i4m.bind(this),1028):this.ga.wW(vb.a.Hsa,kc.a.view,this.Hsa,1028));this.$7b&&this.ga.wW(vb.a.PNb,kc.a.view,this.PNb,1028);this.ga.fb(Ec.a.Nid,kc.a.view,this.Nid,96)}i4m(b,h,r,A,
L){if(1===r)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.zgb.BQf(L?L:h,null,lq.b.IgnoreAll);return 32}}Object(u.a)(yN,"ProofingActor",null,[]);var YL=d(1730);class xy{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.xo=this.uSa=this.bNd=this.cNd=null;this.mG=this.Dw=this.ks=0;this.kib=this.jib=!1;this.$da=this.q5b=this.p5b=this.o5b=this.r5b=0;this.cMd=null;this.mia=this.wZ=this.Av=this.aT=0;this.Fm=null;this.E2a=0;this.Jfg=Jb=>{var Tb;if(bd.a.pq){var jc=Object.assign(new Na.a,
{extendedProperties:new Map});jc.extendedProperties.set("status",Jb.data.status.toString());jc.extendedProperties.set("httpStatus",Jb.data.He.toString());this.W9i("GraphicSwordRequestFailed",this.E2a,jc)}else 5===this.E2a&&(jc=Object.assign(new Na.a,{extendedProperties:new Map}),jc.extendedProperties.set("status",Jb.data.status.toString()),jc.extendedProperties.set("httpStatus",Jb.data.He.toString()),(null===(Tb=y.AFrameworkApplication.J)||void 0===Tb?0:Tb.$("ShouldLogPicturesExtendedHealthKpis"))?
(Tb={name:Xh.c.Bae,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:jc},jc.extendedProperties.set("ErrorLevel","warning"),this.Yd.logKpiFailure({kpiName:Xh.c.gmc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:jc},optionalVeto:Tb})):xa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,jc));v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",
{["Status"]:Jb.data.status,["HttpStatus"]:Jb.data.He,["Id"]:Jb.data.id},It.a[this.E2a]);this.Wue()};this.Dk=r;this.ZRa=Ab;this._image=b;this._context=h;this.ZEd=!1;(b=Object(so.a)().Iu(h.node))&&b.zf(Vc.a.c0f)&&(this.ZEd=!0);this.VIc=A.$("ImageDataURLPresentationIsEnabled");this.lJk=A.$("WordOartPostRequestIsEnabled");this.Aa=A;this.$r=L;this.ee=Z;this.Zd=oa;this.En=Ba;this.sM=gb;this.Yd=fl.a.getInstance(Xh.a);this.N8m();this.gne=this.Gsc.bind(this)}N8m(){this.xo="";this.ks=Id.a.XB(this._image);this.Dw=
Id.a.fD(this._image);this.$da=Id.a.erb(this._image);this.mG=Id.a.K2(this._image);var b=Id.a.rsa(this._image);this.jib=b.Ppb;this.kib=b.JJa;b=Id.a.lfa(this._image);this.r5b=Math.max(b.top,0);this.o5b=Math.max(b.bottom,0);this.p5b=Math.max(b.left,0);this.q5b=Math.max(b.right,0);this.Fm=eb.a.nil;this.uSa=null;this.E2a=Id.a.Ik(this._image)}ETd(b,h){return(new YL.a(this.$r,this.E2a,this.Aa,this.ks,this.Dw,this.mG,this.$da,this.r5b,this.o5b,this.p5b,this.q5b,this.jib,this.kib,this.ZEd)).build(this._context.node,
this._image,b,h)}resize(b,h){this.xo="Resize";this.qAe();db.a.mark(this.wkc());this.ks=b;this.Dw=h;this.sendMessage(!1,this.gne)}Sx(b){this.xo="Styles";this.qAe();db.a.mark(this.wkc());this.$da=b;this.sendMessage(!1,this.gne)}nYo(b,h,r){this.xo="Rotation";this.qAe();this.mG=b;this.jib=h;this.kib=r;this.sendMessage(!1,this.gne)}mYo(b,h){this.xo="SwordRequestManager";this.qAe();this.uSa=b;this.mG=h.angle;this.ks=h.width;this.Dw=h.height;this.$da=h.styleId;this.r5b=h.top;this.o5b=h.bottom;this.p5b=h.left;
this.q5b=h.right;this.Fm=h.h_;this.sendMessage(!1,this.gne)}sendMessage(b,h){this.ZRa.cY([this.ZRa.SJf(this.xo)]);if(this.Aa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.cob(r);const A=Id.a.xsa(this._image,this.Aa,this.$r);A?bd.a.zyb(this._image,A,4):this._image.setValue(Ge.a.aVa,!0);r.dispose()}this.HXj(b);db.a.mark(this.wkc());b=new qb.QueryStringBuilder(this.ETd(b,!0));this.VIc&&b.Ae(Ii.a.tci,"true");this.lJk?(r=new qb.QueryStringBuilder("WordOart.ashx"),y.AFrameworkApplication.Fe.Xj(r.toString(),
2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.Jfg,null)):y.AFrameworkApplication.Fe.Xj(b.toString(),1,"",null,!0,0,h,this.Jfg,null)}cob(b){b=this.Fm&&this.Fm!==eb.a.nil?new Sb.GraphTransaction(7,vb.a.$aa):new Sb.GraphTransaction(15);b.Ab(this._context.node);return b}get Rfk(){const b=new Sb.GraphTransaction(3);b.Ab(this._context.node);return b}Wue(){this.K0d();this.J0d();const b=this.Rfk;var h=Id.a.VJa(this._image,this._context.node.Hc,this.Aa,this.$r);
this._image.setValue(Ge.a.aVa,!1);this._image.setValue(Od.a.Q6c,h);this._image.setValue(Od.a.pX,-1);this._image.setValue(Ge.a.NP,1);h=Id.a.xsa(this._image,this.Aa,this.$r);this.Aa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Od.a.Ipe),this._image.removeProperty(Od.a.Hpe),h&&bd.a.zyb(this._image,h,3));b.dispose();xy.qq();this.uSa&&this.uSa()}HXj(b){this.ee&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.cNd=this.ee.Xf("WebServiceCall",b))}K0d(){this.cNd&&
(this.cNd.stop(),this.cNd=null)}qAe(){if(this.ee){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.xo,It.a[this.E2a]);this.bNd=this.ee.Xf("WebServiceCall",b)}}J0d(){this.bNd&&(this.bNd.stop(),this.bNd=null)}E4(){if(bd.a.kV){var b=this.ZRa.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new Na.a,{durationMs:r}),hasImpliedUsage:!0},this.Yd.logKpiSuccess({kpiName:Tc.d.Dtc+ck.a[h]+It.a[this.E2a].toString(),optionalProperties:b}),this.ZRa.evc(Number(h))}}Y9i(b){this.Yd.logKpiSuccess({kpiName:Tc.d.h5c+
this.xo+It.a[b].toString()})}X9i(b,h){b=Object.assign(new Na.a,{extendedProperties:new Map([["Exception",b.message]])});this.W9i("GraphicResponseInvalid",h,b)}W9i(b,h,r){r.extendedProperties.set("ErrorLevel","warning");this.Yd.logKpiFailure({kpiName:Tc.d.h5c+this.xo+It.a[h].toString(),errorName:b+Object(yh.b)(this.Dw,this.ks),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:r},optionalVeto:Object(yh.c)(Tc.d.nPf,r,null,!1)})}static qq(){const b=new Ag.StandardDialog;b.Bd=0;b.Iy(le.a.xco,
Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);ab.StaticActiveAppFrame.za()&&ab.StaticActiveAppFrame.za().Ge()}}Object(u.a)(xy,"RenderedImageEditOperation",null,[375]);var OK=d(206),VI=d(528);class zN extends xy{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){super(b,h,r,A,L,Z,oa,Ba,gb,Ab);if(bd.a.pq||bd.a.kV)this.Yd=fl.a.getInstance(Tc.a)}sendMessage(b,h){Object(OK.a)(()=>{let r;r=this.cob(r);this._image.setValue(Ge.a.NP,0);r.dispose()});this.HXj(b);db.a.mark(this.wkc());
this.ZRa.cY([13]);b=new qb.QueryStringBuilder("WordOart.ashx");this.Zlh=this.getUrl(!0,!1);b=new VI.a(b.toString(),2,this.getUrl(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");y.AFrameworkApplication.Fe.send(b).jDa(h,r=>{this.Jfg(r)})}Gsc(b){try{const h=JSON.parse(b.data.nNa);this.Wxk=h[Ii.a.g5c];this.QSk=h[Ii.a.width];this.pyk=h[Ii.a.height];this.K8g=h[Ii.a.OSc];this.OGc=Array(4);
this.OGc[dn.a.left]=h[Ii.a.Wob];this.OGc[dn.a.right]=h[Ii.a.Xob];this.OGc[dn.a.top]=h[Ii.a.Yob];this.OGc[dn.a.bottom]=h[Ii.a.Vob];this.Kqh=void 0!==h[Ii.a.WBa]?"true"===h[Ii.a.WBa].toLowerCase():null;Object(OK.a)(()=>{this.Xsd();this._context.node.Hj().Ag.nE(()=>{this.s$l()},null,null)})}catch(h){bd.a.pq&&(b=Object.assign(new Na.a,{extendedProperties:new Map([["Exception",h.message],["Operation",this.xo]])}),b.extendedProperties.set("ErrorLevel","warning"),this.Yd.logKpiFailure({kpiName:Tc.d.M9d+
Tc.b.AJa+It.a[Id.a.Ik(this._image)].toString(),errorName:"DrawingResponseInvalid"+Object(yh.b)(this.Dw,this.ks),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(yh.c)(Tc.d.cLi,b,null,!1)})),v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.xo,Id.a.Ik(this._image)),this.Wue()}}sme(){v.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Xsd(){let b;
b=this.cob(b);this._image.setValue(De.a.oN,this.Wxk);this.K8g&&this._image.setValue(De.a.QRd,this.K8g);this._image.setValue(De.a.QAa,this.QSk);this._image.setValue(De.a.RAa,this.pyk);this._image.setValue(De.a.TVa,this.OGc);this.izk&&this._image.setValue(Od.a.WRb,this.izk);bd.a.zyb(this._image,this.Zlh,3);this._image.setValue(Vc.a.Uob,this.Zlh);this.Kqh?this._image.setValue(De.a.G$a,this.Kqh):this._image.removeProperty(De.a.G$a);this.hrl();b.dispose()}hrl(){this._image.removeProperty(Od.a.Bu);this._image.removeProperty(Od.a.pX);
this._image.removeProperty(Od.a.Ipe);this._image.removeProperty(Od.a.Hpe)}s$l(){this.sM.GNa(this._context);if(this.Fm&&this.Fm!==eb.a.nil){const b=this._context.node.Hj(),h=new Q.a(this.Fm,1);this.En.Oec(b,h)}this.Zd.Yu(13);bd.a.pq&&this.Yd.logKpiSuccess({kpiName:Tc.d.M9d+Tc.b.AJa+It.a[Id.a.Ik(this._image)].toString()});this.K0d();this.J0d();db.a.mark(this.d4c());this.ZRa.XL([13]);this.E4();Object(OK.a)(()=>{let b;b=this.cob(b);this._image.setValue(Ge.a.NP,1);b.dispose()});this.uSa&&this.uSa()}getUrl(b,
h){b=new qb.QueryStringBuilder(this.ETd(b,h));b.Ae(Ii.a.Iae,"true");return b.toString()}wkc(){return 51511}d4c(){return 51512}}Object(u.a)(zN,"RenderedGraphicEditOperation",xy,[]);var gE=d(587);class ZL extends xy{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){super(b,h,r,A,L,Z,oa,Ba,gb,Jb);this.Vgh=null;this.sme=Tb=>{const jc=this.ETd(!0,!1);let Hc;Hc=this.cob(Hc);this._image.setValue(Vc.a.PSc,this.cMd);var hd=Wa.a.instance.Oa("Box4.IFeatureHelper");bd.a.pq&&this.Y9i(this.MHb);hd&&hd.isFeatureEnabled(42)&&
this._image.setValue(Vc.a.Q1d,this.Vgh);this.Aa.$("WordEditorImageRotateIsEnabled")&&this.Aa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Dk.exe(this._image,this.mG,this.jib,this.kib);const Gd=Id.a.xsa(this._image,this.Aa,this.$r),de=()=>{Gd&&bd.a.zyb(this._image,Gd,3);bd.a.zyb(this._image,jc,3);this.Dk.cxe(this._image,Tf.a.lI(this.aT),Tf.a.lI(this.wZ),Tf.a.lI(this.Av),Tf.a.lI(this.mia));this._image.setValue(Vc.a.Uob,jc);Id.a.Vz(this._image)||this._image.setValue(Vc.a.JKa,Pt.a.cdb);
this.Dk.Lwe(this._image,this.ks,this.Dw);this.Aa.$("WordEditorImageRotateIsEnabled")&&!this.Aa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Dk.exe(this._image,this.mG,this.jib,this.kib);2===Tb.data.status&&Id.a.g3(Tb.data.Pe)&&(this._image.setValue(Od.a.Bu,Tb.data.Pe),Tb.data.request&&this._image.setValue(Od.a.WRb,Object(gE.a)("POST"===Tb.data.request.get_httpVerb()?Tb.data.request.get_body():Tb.data.request.get_url())));this.uSa&&this.uSa();this.sM.GNa(this._context);if(this.Fm&&this.Fm!==
eb.a.nil){const qe=this._context.node.Hj(),oe=new Q.a(this.Fm,1);this.En.Oec(qe,oe)}this.Zd.Yu(13);this.K0d();this.J0d();db.a.mark(this.d4c());this.ZRa.XL([this.ZRa.SJf(this.xo)]);this.E4()};if(this.Aa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Fm&&this.Fm!==eb.a.nil&&(hd=this._context.node.Hj())&&hd.Ag){Hc.dispose();hd.Ag.nE(()=>{let qe;qe=this.cob(qe);de();qe.dispose()},null,null);return}de();Hc.dispose()};if(bd.a.pq||bd.a.kV)this.Yd=fl.a.getInstance(Tc.a);this.MHb=Ab}wkc(){return 51511}d4c(){return 51512}Gsc(b){try{var h=
JSON.parse(b.data.Pe);const L=Sys.Net.XMLDOM("string"===typeof h[Ii.a.cRh]?h[Ii.a.cRh]:null);this.cMd="string"===typeof h[Ii.a.RRd]?h[Ii.a.RRd]:null;const Z=Wa.a.instance.Oa("Box4.IFeatureHelper");Z&&Z.isFeatureEnabled(42)&&(this.Vgh="string"===typeof h[Ii.a.Shc]?h[Ii.a.Shc]:null);aa.a.As&&L.setProperty("SelectionNamespaces","xmlns:mc='"+ki.a.z5k+"'");const oa=L.selectSingleNode("/mc:AlternateContent");if(!oa)throw zm.a.argument("Alternate content element could not be retrieved!");const Ba=oa.firstChild;
if(!Ba)throw zm.a.argument("Alternate content choice element could not be retrieved!");const gb=Ba.firstChild;if(!gb)throw zm.a.argument("Drawing element could not be retrieved!");var r=gb.firstChild;if(!r)throw zm.a.argument("Inline element could not be retrieved!");h=b=null;const Ab=RegExp("effectExtent"),Jb=RegExp("extent");for(const jc of r.childNodes)-1!==jc.nodeName.search(Ab)&&(b=jc),-1!==jc.nodeName.search(Jb)&&(h=jc);if(!b||!h)throw zm.a.argument("Effect extent or extent could not be retrieved!");
this.aT=parseInt(b.selectSingleNode("@l").text);this.wZ=parseInt(b.selectSingleNode("@r").text);this.Av=parseInt(b.selectSingleNode("@t").text);this.mia=parseInt(b.selectSingleNode("@b").text);const Tb=yh.e(this.mG);if(45<=Tb&&135>=Tb||225<=Tb&&315>=Tb){const jc=parseInt(h.selectSingleNode("@cx").text);var A=parseInt(h.selectSingleNode("@cy").text);r=jc/2;A/=2;this.aT-=r-A;this.wZ+=r-A;this.Av-=A-r;this.mia+=A-r}}catch(L){bd.a.pq&&this.X9i(L,this.MHb);v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
L.message,this.xo,It.a[this.MHb]);this.Wue();return}this.sendMessage(!0,this.sme)}}Object(u.a)(ZL,"RenderedDrawingEditOperation",xy,[]);class AN extends xy{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb){super(b,h,r,A,L,Z,oa,Ba,gb,Tb);this.Mda=null;this.sme=jc=>{var Hc;const hd=this.ETd(!0,!1);let Gd;Gd=this.cob(Gd);this._image.setValue(Vc.a.yXb,this.cMd);const de=Id.a.xsa(this._image,this.Aa,this.$r);bd.a.pq?this.Y9i(this.MHb):(null===(Hc=y.AFrameworkApplication.J)||void 0===Hc?0:Hc.$("ShouldLogPicturesExtendedHealthKpis"))&&
this.Yd.logKpiSuccess({kpiName:Xh.c.gmc});const qe=()=>{de&&bd.a.zyb(this._image,de,3);bd.a.zyb(this._image,hd,3);this.Dk.cxe(this._image,Tf.a.lI(this.aT),Tf.a.lI(this.wZ),Tf.a.lI(this.Av),Tf.a.lI(this.mia));this._image.setValue(Vc.a.Uob,hd);Id.a.Vz(this._image)||this._image.setValue(Vc.a.JKa,Pt.a.cdb);this._image.setValue(Vc.a.fhd,this.$da);this._image.setValue(Od.a.c5m,-1);this.Fd.isFeatureEnabled(82)&&Id.a.Blc(this._image)&&this.Kp.dvc(this._image);this._image.setValue(Ge.a.aVa,!1);this.Dk.Lwe(this._image,
this.ks,this.Dw);this.Aa.$("WordEditorImageRotateIsEnabled")&&this.Dk.exe(this._image,this.mG,this.jib,this.kib);this.Aa.$("WordEditorImageCropIsEnabled")&&this.Dk.kyg(this._image,this.r5b,this.o5b,this.p5b,this.q5b);2===jc.data.status&&Id.a.g3(jc.data.Pe)&&(this._image.setValue(Od.a.Bu,jc.data.Pe),jc.data.request&&this._image.setValue(Od.a.WRb,Object(gE.a)("POST"===jc.data.request.get_httpVerb()?jc.data.request.get_body():jc.data.request.get_url())));this.uSa&&this.uSa();this.sM.GNa(this._context);
if(this.Fm&&this.Fm!==eb.a.nil){const oe=this._context.node.Hj(),ge=new Q.a(this.Fm,1);this.En.Oec(oe,ge)}this.Zd.Yu(13);this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateCommandUIAfterSwordEdit",!1)&&ab.StaticActiveAppFrame.za().Ge();this.K0d();this.J0d();db.a.mark(this.d4c());this.ZRa.XL([this.ZRa.SJf(this.xo)]);this.E4()};if(this.Aa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Fm&&this.Fm!==eb.a.nil&&(Hc=this._context.node.Hj())&&Hc.Ag){Gd.dispose();Hc.Ag.nE(()=>{let oe;
oe=this.cob(oe);qe();oe.dispose()},null,null);return}qe();Gd.dispose()};this.MHb=Ab;this.Fd=Jb;if(bd.a.pq||bd.a.kV)this.Yd=fl.a.getInstance(Tc.a)}wkc(){return 7988}d4c(){return 7989}get Kp(){this.Mda||(this.Mda=new rN.a);return this.Mda}Gsc(b){var h;try{const r=b.data.ina;this.cMd=b.data.Pe;aa.a.As&&r.setProperty("SelectionNamespaces","xmlns:pic='"+ki.a.uco+"'");const A=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.aT=parseInt(A.selectSingleNode("@l").text);this.wZ=parseInt(A.selectSingleNode("@r").text);
this.Av=parseInt(A.selectSingleNode("@t").text);this.mia=parseInt(A.selectSingleNode("@b").text)}catch(r){b=Object.assign(new Na.a,{extendedProperties:new Map});b.extendedProperties.set("exception",r.message);b.extendedProperties.set("operation",this.xo);bd.a.pq?this.X9i(r,this.MHb):(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Xh.c.Bae,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},
b.extendedProperties.set("ErrorLevel","warning"),this.Yd.logKpiFailure({kpiName:Xh.c.gmc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):xa.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.xo,It.a[this.MHb]);this.Wue();return}this.sendMessage(!0,
this.sme)}}Object(u.a)(AN,"RenderedPictureEditOperation",xy,[]);class $L{constructor(b,h,r,A,L,Z,oa,Ba){this.Dk=b;this.Aa=h;this.$r=r;this.ee=A;this.Zd=L;this.En=Z;this.sM=oa;this.Fd=Ba}create(b,h){const r=Id.a.Ik(b);return Object(vj.d)(b)?new zN(b,h,this.Dk,this.Aa,this.$r,this.ee,this.Zd,this.En,this.sM,new ck.b):10===r||11===r||48===r||4===r?new ZL(b,h,this.Dk,this.Aa,this.$r,this.ee,this.Zd,this.En,this.sM,r,new ck.b):5===r?new AN(b,h,this.Dk,this.Aa,this.$r,this.ee,this.Zd,this.En,this.sM,r,
this.Fd,new ck.b):null}}Object(u.a)($L,"Factory",null,[335]);class aM{constructor(){this.uZc=b=>{const h=window.performance.now(),r=Ki.a.Np();if(r){b=OL.a(b.ao,r);b=Dd.a.At(b,r);var A=0,L=new Sb.GraphTransaction(3);try{for(L.Ab(r);b.moveNext();){if(!Cd.ParagraphReader.Fh(b.iterator))continue;const Z=b.currentNode;this.Bhi(Z)&&(A++,Z.Xl(4,!0));const oa=window.performance.now()-h;if(2500<A||100<oa){this.QHb=null;this.ejd(Z);break}}}finally{L&&L.dispose()}}else Uc.b(570450380,3018,10,"PageContentNode not found")};
this.QHb=null}ZTi(){const b=Ki.a.Np();this.wjd(b);this.ejd(null)}ejd(b){this.QHb&&(y.AFrameworkApplication.pc.wf(this.QHb),this.QHb=null);this.QHb=new mf.a(1,1,1,this.uZc,198);this.QHb.ao=b;y.AFrameworkApplication.pc.$b(this.QHb)}wjd(b){const h=OL.b(b);if(h){var r=new Sb.GraphTransaction(3);try{for(r.Ab(b);h.moveNext();){if(!Cd.ParagraphReader.Fh(h.iterator))continue;const A=h.currentNode;this.Bhi(A)&&A.Xl(4,!0)}}finally{r&&r.dispose()}}}Bhi(b){b=b.gJ;for(const h of b)if(h.V$a)return 0<h.d1b;return!1}}
Object(u.a)(aM,"RenderParagraphsContainingTabs",null,[]);class PK{constructor(b,h){this.sPe=!0;this.IFc=null;this.kXl=()=>{this.IFc=null;this.sPe=!0;this.vSa&&this.vSa.t0a(!tf.a.fP())};this.wfb=(r,A,L)=>{if(1===L)return 32;2===L&&(r=!1,tf.a.fP()?this.sPe=!1:this.sPe?r=!0:this.HBp(),this.vSa&&this.vSa.t0a(r));return 32};this.ga=b;this.vSa=h}Xb(){this.ga.fb(Za.a.wfb,kc.a.application,this.wfb,1124)}HBp(){this.IFc?y.AFrameworkApplication.pc.wf(this.IFc):this.IFc=new mf.a(4,1,5E3,this.kXl);y.AFrameworkApplication.pc.$b(this.IFc)}}
Object(u.a)(PK,"SaveStatusActor",null,[]);var MO=d(676);class BN{get ovg(){return null!=this.b3g?this.b3g:this.b3g=Wa.a.instance.Oa("Box4.ISaveStyleManager")}get DGo(){return this.CGo||(this.CGo=Wa.a.instance.Oa("Box4.IResetAndDeleteStyleManager"))}get Kg(){return null!=this.x4g?this.x4g:this.x4g=Wa.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.KKb=(r,A,L)=>{r=Ki.a.RTb(A);if(1===L||r)return r?8:32;this.C9.value.YDl(A);return 32};this.UMb=(r,A,L)=>{r=Ki.a.RTb(A);if(1===L||r)return r?
8:32;this.C9.value.iIl(A,this.ga);return 32};this.yvf=(r,A,L)=>{r=Ki.a.RTb(A)||this.d3o();if(1===L||r)return r?8:32;this.C9.value.yvf(A);return 32};this.ga=b;this.C9=h}get Yb(){return null!=this.m7g?this.m7g:this.m7g=Wa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Xb(){this.ga.fb(vb.a.KKb,kc.a.view,this.KKb,1028);this.ga.fb(vb.a.UMb,kc.a.view,this.UMb,4);this.ga.fb(vb.a.DNb,kc.a.view,this.yvf,4);this.ga.fb(vb.a.nvg,kc.a.view,this.pMo.bind(this),4);this.ga.fb(vb.a.Atg,kc.a.view,this.Btg.bind(this),
4);this.ga.fb(vb.a.tvf,kc.a.view,this.gRl.bind(this),4)}pMo(b,h,r){b=Ki.a.RTb(h)||this.i3o();if(1===r||b)return b?8:32;this.ovg.oMo();return 32}Btg(b,h,r){b=Ki.a.RTb(h)||this.g3o();if(1===r||b)return b?8:32;this.DGo.Btg();return 32}gRl(b,h,r){b=Ki.a.RTb(h)||this.c3o();if(1===r||b)return b?8:32;this.C9.value.fRl();return 32}c3o(){return"{}"===mz.a.SAb?!0:!1}g3o(){if(0==mz.a.tP.size)return!0;var b=mz.a.tP;const h=this.Yb.ro();let r=0;for(const A of b.values())b=h.nh(A),this.Yb.ne(b,h)||r++;return 0==
r?!0:!1}i3o(){var b=mz.a.SAb,h=mz.a.tP;const r=this.Yb.ro();if(0==h.size)return!0;if(!({av:b}=H.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const L of h.values()){h=r.nh(L);var A=b[L];if(null==A)return!1;if(A=Ki.a.L8d(A)){if(h=Ki.a.I2c(h,r),Ki.a.Q9c(h,A))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}d3o(){var b=
Ki.a.Np();if(!b)return Uc.b(577368330,3018,15,"PageContentNode is null"),!0;b=this.Kg.vn?(new pv.WACStyleSet).gla(b):(new pv.WACStyleSet).Uaa(b);const h=b.Qw;for(let A=0;A<h;A++){let L;b instanceof pv.WACStyleSet?L=b.FAa(A):b instanceof MO.a&&(L=b.vla(A));if(!this.Yb.isHidden(L)&&this.Yb.ne(L,b)){var r=this.Yb.JF(L);if(2===r||1===r)if(!L.hasProperty(Vc.a.linkedStyle)||2===r)if(r=L.ka(Vc.a.eE,null),!(r&&0<r.length))return!1}}return!0}}Object(u.a)(BN,"StylesActor",null,[]);class bM{constructor(b){this.gBe=
(h,r,A)=>{h=y.AFrameworkApplication.ua;if(1===A)return 1!==h.mode||cc.SessionStatusManager.instance.Jk?2:32;xa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,bM.UB,null);const L={};L[G.a.uSf]=y.AFrameworkApplication.J.jb("ClassicViewModePreferenceCookieName");L[G.a.POi]="true";y.AFrameworkApplication.nN().execute(Z=>{Z.sendMessage(K.a.dfp,L)});return y.AFrameworkApplication.va.Ob(vb.a.readingMode,2)};this.ga=b}Xb(){this.ga.qa(Ec.a.gBe,kc.a.view,this.gBe)}}bM.UB="wwaengidc";Object(u.a)(bM,
"SwitchToClassicViewModeActor",null,[]);class CN{constructor(b,h,r,A,L,Z,oa,Ba,gb){this.angle=r;this.styleId=A;this.width=b;this.height=h;this.top=L;this.bottom=Z;this.left=oa;this.right=Ba;this.h_=gb}}Object(u.a)(CN,"SWordData",null,[]);class DN{constructor(b,h){this.jo=this.A5=this.Wq=null;this.A5e=this.k9b=!1;this.aT=this.wZ=this.mia=this.Av=this.$da=this.Dw=this.ks=this.mG=0;this.Fm=null;this.Lba=()=>{this.A5e=!1;this.k9b&&this.n_c()};this.hq=b;this.rOc=h;this.lRi()}lRi(){this.wZ=this.aT=this.mia=
this.Av=this.$da=this.Dw=this.ks=this.mG=-1;this.Fm=eb.a.nil}n_c(){this.A5e||(this.bFp(),this.CJl(),this.k9b=!1)}CJl(){this.jo=new CN(this.ks,this.Dw,this.mG,this.$da,this.Av,this.mia,this.aT,this.wZ,this.Fm);this.rOc.create(this.A5,this.Wq).mYo(this.Lba,this.jo);this.A5e=!0;let b;Object(Gb.a)(4,this.A5)?b=It.a[Id.a.Ik(this.A5)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
b="generic");v.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.ks,this.Dw,this.mG,this.$da,this.Av,this.mia,this.aT,this.wZ,b);this.lRi()}bFp(){this.ks=-1!==this.ks?this.ks:this.A5.ka(Od.a.HKa,-1);this.Dw=-1!==this.Dw?this.Dw:this.A5.ka(Od.a.GKa,-1);this.ks=-1!==this.ks?this.ks:this.hq.XB(this.A5);this.Dw=-1!==this.Dw?this.Dw:this.hq.fD(this.A5);this.mG=-1!==this.mG?
this.mG:this.hq.K2(this.A5);this.$da=-1!==this.$da?this.$da:this.hq.erb(this.A5);const b=this.hq.lfa(this.A5);this.Av=-1!==this.Av?this.Av:b.top;this.mia=-1!==this.mia?this.mia:b.bottom;this.aT=-1!==this.aT?this.aT:b.left;this.wZ=-1!==this.wZ?this.wZ:b.right}Pmo(b,h,r,A){this.Wq=b;this.mG=r;this.k9b=!0;this.A5=h;this.Fm=A;this.n_c()}Omo(b,h,r,A,L){this.Wq=b;this.k9b=!0;this.A5=h;this.Fm=L;this.A5.setValue(Od.a.HKa,r);this.A5.setValue(Od.a.GKa,A);this.n_c()}Tmo(b,h,r){this.Wq=b;this.k9b=!0;this.A5=
h;this.$da=r;this.n_c()}Jmo(b,h,r,A,L,Z){this.Wq=b;this.Av=r;this.mia=A;this.aT=L;this.wZ=Z;this.k9b=!0;this.A5=h;h=b=0;({width:b,height:h}=this.hq.$8a(this.A5));this.ks=b-(L+Z)/1E5*b;this.Dw=h-(r+A)/1E5*h;this.n_c()}}Object(u.a)(DN,"SWordRequestManager",null,[334]);class QK{constructor(b,h,r,A=null,L=null,Z=null,oa=null,Ba=null,gb=null,Ab=null){this.En=null;this.IJh=!1;this.Hhp=(Jb,Tb,jc,Hc,hd)=>{if(1===jc)return 32;const Gd=Jb===vb.a.gye;if(!Tb.view.ve)return 2;const de=Tb.view,qe=de.lb,oe=qe.Pg;
if(!oe||QK.tg.p2(oe))return 2;if(this.Vn&&this.Vn.instance&&this.Vn.instance.zX(oe))return 4;var ge=null,$d=Vd.ActionManager.qCa,lf=!1,wf=he.a.mf(oe);if(oe.Ww){if(qe.gb.GL&&($d=oe.getContext(0),ge=new hb.a,ge.set($d.node),ge.Ks(),$d=Gd?vb.a.Xvg:vb.a.Sve),$d=this.M9e.lho($d),$d===Vd.ActionManager.qCa){var gi=Object(Nl.a)().EW(oe,16);gi?(Gd&&($d=vb.a.mke),ge=new hb.a,ge.set(gi.node),ge.Nd()):$d=Gd?vb.a.KI:vb.a.eR}}else if(oe.Al)if(ge=new hb.a,ge.set(oe.node),he.a.Ou(ge),fm.OutlineReader.cXa(oe))$d=
Gd?vb.a.Xvg:vb.a.Sve;else{if(this.wUe&&this.wUe.o5o(oe))return this.wUe.Dnd(oe,de.Ic,Gd),32;Id.a.z$a(oe)?$d=Gd?vb.a.Wvg:vb.a.Vvg:($d=Gd?this.M9e.HTm(ge,oe,$d,Tb):this.M9e.GTm(ge,oe,$d),Eb.a.Mh(ge)&&oe.contextId===kc.a.Vc&&(lf=Eb.a.UA(ge,oe,!1)),gi=sf.ListItemReader.Fg(ge)&&lf,$d!==Vd.ActionManager.qCa||$g.TableCellReader.tba(ge)||gi||(this.IJh||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.IJh=!0),y.AFrameworkApplication.va.Ob(vb.a.KRi,2),this.hSi(Tb)))}else return 2;
if(!Gd&&$d===Vd.ActionManager.qCa&&$g.TableCellReader.tba(ge))if(Kh.returnToCell(ge),$g.TableCellReader.XWa(ge)||si.TableReader.JYi(ge)&&$g.TableCellReader.fee(ge)){if($d=this.lUk(),!$d)return 2}else $d=vb.a.Ufj;if($d===Vd.ActionManager.qCa)return 2;switch($d){case vb.a.Ufj:case vb.a.mke:lf=$d===vb.a.mke;wf&&this.V4&&this.$0&&(wf=this.V4.pCf(oe,-1,!0,jf.a.pz))&&this.$0.JJj(wf);jc=32;Kh.returnToCell(ge);Kh.moveToNextOrPreviousCell(ge,lf)&&(wf=!0,lf=!1,fm.OutlineReader.uRf(ge)||(fo.OutlineNavigator.R8f(ge,
!1),fg.OutlineElementNavigator.Me(ge),Cd.ParagraphReader.uu(ge.currentNode)&&(wf=!1,Cd.ParagraphReader.textLength(ge.currentNode)||(lf=!0)),lf||Kh.returnToCell(ge)),lf?ge=qc.SelectionFactory.ue(ge.currentNode,0):(ge=qc.SelectionFactory.Er(ge.currentNode),!wf&&he.a.pl(ge.Xc)&&(wf=ge.toArray(),Array.removeAt(wf,wf.length-1),ge=new Oq.Selection(wf,ge.Pf))),qe.Kc(ge));break;case vb.a.Xvg:case vb.a.Sve:$d===vb.a.Sve?fo.OutlineNavigator.Yej(ge,!1):fo.OutlineNavigator.Yej(ge,!0);qe.Kc(qc.SelectionFactory.Er(ge.currentNode));
jc=32;break;case vb.a.Vpd:jc=y.AFrameworkApplication.va.Hf(Tb,$d,jc,!0,Hc,hd);break;default:if(ge=()=>{const Di=new lj.DictionaryPropertySet;Di.setValue(Ge.a.abe,Jb===vb.a.gye?"ShiftTab":"tab");return Di},jc=y.AFrameworkApplication.va.Hf(Tb,$d,jc,!0,Hc,pi.s4f?ge():hd),!lf&&wf&&($d===vb.a.KI||$d===vb.a.eR)){const Di=he.a.Pqa(qe.gb.currentSelection).y;ed.a.Vuc(()=>{this.DPn(qe,de,Di)})}}32===jc&&Tb.view.ve&&this.ih.uI();return jc};this.lqa=b;this.M9e=h;this.Vn=r;this.V4=A;this.$0=L;this.O9e=Z;this.zPa=
oa;this.Fd=Ba;this.Rc=gb;this.wUe=Ab}get ih(){return this.En||(this.En=this.lqa())}Xb(){const b=y.AFrameworkApplication.va,h=this.Hhp;b.fb(vb.a.tab,kc.a.view,h,1124);b.fb(vb.a.gye,kc.a.view,h,1124);b.qa(vb.a.KRi,kc.a.view,Vd.ActionManager.eg)}DPn(b,h,r){if(b&&h){var A=b.gb.currentSelection;he.a.Pqa(A).y<r?(h=he.a.v0c(h,A,!1),h=he.a.eAa(h,{NE:!1,Du:!1,cH:!1,aJ:!0})):h=he.a.P2d(h,A,!1);b.Kc(h)}}lUk(){return vb.a.s$a}hSi(){}Edd(b,h,r){if(b&&h){var A=b.gb.currentSelection;he.a.Pqa(A).y<r?(h=he.a.v0c(h,
A,!1),h=he.a.eAa(h,{NE:!1,Du:!1,cH:!1,aJ:!0})):h=he.a.eAa(A,{NE:!1,Du:!1,cH:!1,aJ:!0});b.Kc(h)}}static get tg(){return Be.a.instance}}Object(u.a)(QK,"TabActor",null,[]);class cM{constructor(b){this.aJc=b}get fr(){return this.aJc}lho(b){return b}HTm(b,h,r,A){A=A.view;const L=A.lb.gb.currentSelection;if($g.TableCellReader.tba(b))return this.CYi(b,h)?vb.a.KI:vb.a.mke;fg.OutlineElementNavigator.me(b);if(he.a.mf(h))Eb.a.UA(b,h,!1)&&this.VSj(b)?r=vb.a.dYb:he.a.lfe(A,L)&&this.fr.ILb(b)?r=vb.a.KI:he.a.lfe(A,
L)&&(r=vb.a.KI);else if(he.a.Zl(h)){if(!this.fr.ILb(b))return r;he.a.etb(h)?r=vb.a.KI:he.a.U2i(h)&&(r=this.VSj(b)?vb.a.dYb:vb.a.KI)}else this.fr.ILb(b)&&(r=vb.a.KI);return r}GTm(b,h,r){if($g.TableCellReader.h3(b))return this.CYi(b,h)?vb.a.eR:r;fg.OutlineElementNavigator.me(b);if(he.a.mf(h))Eb.a.UA(b,h,!1)&&(!sf.ListItemReader.Fg(b)&&Eb.a.isEmpty(b,!1)?r=Vd.ActionManager.qCa:this.b3o(b)?r=vb.a.Bob:this.fSj(b)?r=vb.a.FNb:this.fr.$dc(b)&&(r=vb.a.eR));else if(he.a.Zl(h)){if(!this.fr.$dc(b))return r;he.a.etb(h)?
r=vb.a.eR:he.a.U2i(h)&&(r=this.fSj(b)?vb.a.FNb:vb.a.eR)}else this.fr.$dc(b)&&(r=vb.a.eR);return r}VSj(b){return sf.ListItemReader.Fg(b)?!1:0<Eb.a.J2(b)?!0:!1}fSj(b){if(sf.ListItemReader.Fg(b))return!1;const h=Eb.a.J2(b);b=fm.OutlineReader.u_(b.currentNode);return h<b?!0:!1}b3o(b){return sf.ListItemReader.Fg(b)?!1:0<Eb.a.qI(b)?!0:!1}static Us(){return new cM(vw.a.zQb)}CYi(b,h){if(this.Hqn){const r=new hb.a;r.nd(b);fg.OutlineElementNavigator.me(r);if(sf.ListItemReader.Fg(r)&&Eb.a.UA(r,h,!1))return!0}return!1}get Hqn(){var b;
y.AFrameworkApplication.$c("egdi3422;7g6fa693");return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(u.a)(cM,"TabActorPromoteDemoteStrategy",null,[356]);class hE extends QK{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){super(b,h,r,A,L,Z,oa,Ba,gb,Ab);this.Tme=(Hc,hd)=>{Hc=hd.property;!this.Rkd||Hc!==Vc.a.pageWidth&&Hc!==Vc.a.marginLeft&&Hc!==Vc.a.marginRight||this.Rkd.ZTi()};this.u_=(Hc,hd,Gd,de,
qe)=>{Hc=fm.OutlineReader.u_(this.LEm(hd));qe.defaultTabStop=Hc;return 32};this.m9b=Jb;this.ga=jc;this.ME();this.ga.qa(Ec.a.u_,kc.a.view,this.u_)}get Rkd(){return null!=this.M2g?this.M2g:this.M2g=Wa.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}ME(){this.m9b.Tl.qf(10).Qo(this.Tme)}hSi(b){const h=b.view,r=h.lb;b=r.Pg;if(this.zPa&&this.Rc){var A=this.Rc.Lc(15);A.Ab(b.node);b.contextId===kc.a.Cd&&y.AFrameworkApplication.va.Ob(vb.a.gI,2);this.zPa.Hbe(r.Pg);A.dispose();var L=he.a.Pqa(r.gb.currentSelection).y;
ed.a.Vuc(()=>{this.Edd(r,h,L)})}}LEm(b){return b.view.lb.gb.currentSelection.Qa.node}static get instance(){return null!=hE.aZg?hE.aZg:hE.aZg=hE.Qm()}static Qm(){return new hE(()=>Wa.a.instance.resolve("Box4.IUndoManager"),cM.Us(),Wa.a.instance.Ta("Box4.IExternalSelectionManager"),Wa.a.instance.resolve("Box4.IAutoCorrectRules"),Wa.a.instance.resolve("Box4.IAutoCorrectScheduler"),Wa.a.instance.Oa("Box4.ITabPresenterFactory"),Wa.a.instance.Oa("Box4.IBlobEditor"),Wa.a.instance.Oa("Box4.IFeatureHelper"),
Wa.a.instance.Oa("Box4.Graph.GraphTransactionFactory"),Wa.a.instance.Oa("Box4.Actors.IIFrameFocusStrategy"),ed.a.jf,Wa.a.instance.Oa("Box4.ITabRenderer"),y.AFrameworkApplication.va)}}Object(u.a)(hE,"TabActor",QK,[]);class us{static get Zu(){return null!=us.SRg?us.SRg:us.SRg=Wa.a.instance.resolve("Box4.IAppFrame")}static get $P(){return null!=us.E3g?us.E3g:us.E3g=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback")}static initialize(){var b,h;Qr.a.Joc=us.Irn;If.a.instance.AB(us.Ykl);if(null===(b=y.AFrameworkApplication.J)||
void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.tableCellSizeUpdate",!1))null===(h=y.AFrameworkApplication.va)||void 0===h?void 0:h.qa(Ec.a.iBe,kc.a.view,us.iBe)}static iBe(b,h,r){if(2===r)return null!=us.$P&&us.$P.execute(A=>{A.logActivity("triggerTableResizeTUI",null);me.a("TableResizeTUITriggered")}),y.AFrameworkApplication.va.Ob(Ec.a.mue,2),32}static Ykl(){us.rIp()}static Irn(b){return!si.TableReader.kmn(b)}static Mvb(){us.Zu.hvc(us.Mvb);us.HGb=!1;const b=appChrome.selectors.getActiveContextualTabIds();
"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static rIp(){var b,h,r;((null===(b=Bt.a.instance.currentSelection)||void 0===b?0:b.DLa)||(null===(h=Bt.a.instance.currentSelection)||void 0===h?0:h.Yw)||(null===(r=Bt.a.instance.currentSelection)||void 0===r?0:r.vab))&&!us.HGb&&(us.Zu.B5a(us.Mvb),us.HGb=!0)}}us.HGb=!1;Object(u.a)(us,"TableActor",null,[]);var NO=d(366),OO=d(684),RK=d(955);class Ai{static get Fva(){return null!=
Ai.m5g?Ai.m5g:Ai.m5g=Bq.a.instance}static get Qd(){return null!=Ai.T5g?Ai.T5g:Ai.T5g=Wa.a.instance.Oa("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get OZj(){Ai.mJ||(Ai.mJ=new Wq("TableBorder"),Ai.Kfa(Ai.mJ));return Ai.mJ}static get gB(){Ai.Zxa||(Ai.Zxa=Wa.a.instance.Oa("WordEditor.ITableBorderManager"),Ai.Zxa.initialize());return Ai.Zxa}static Xb(){const b=y.AFrameworkApplication.va,h=ed.a.Y_a.nXc(r=>Ai.Dem(r));b.qa(vb.a.Dzb,kc.a.view,Ai.Cdb);b.qa(vb.a.Dzb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Dzb,
4);b.qa(vb.a.Heb,kc.a.view,Ai.Cdb);b.qa(vb.a.Heb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Heb,4);b.qa(vb.a.Ieb,kc.a.view,Ai.Cdb);b.qa(vb.a.Ieb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Ieb,4);b.qa(vb.a.Izb,kc.a.view,Ai.Cdb);b.qa(vb.a.Izb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Izb,4);b.qa(vb.a.Fzb,kc.a.view,Ai.Cdb);b.qa(vb.a.Fzb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Fzb,4);b.qa(vb.a.Gzb,kc.a.view,Ai.Cdb);b.qa(vb.a.Gzb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Gzb,4);b.qa(vb.a.Hzb,kc.a.view,Ai.Cdb);b.qa(vb.a.Hzb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Hzb,4);b.qa(vb.a.Ezb,
kc.a.view,Ai.Cdb);b.qa(vb.a.Ezb,kc.a.table,Ai.Bdb);b.Pc(vb.a.Ezb,4);b.qa(vb.a.hTa,kc.a.view,Ai.Cdb);b.qa(vb.a.hTa,kc.a.table,Ai.Bdb);b.Pc(vb.a.hTa,4);b.qa(vb.a.Zpe,kc.a.view,Ai.Zpe);b.qa(vb.a.pha,kc.a.view,Ai.Pxe);b.qa(vb.a.pha,kc.a.s4,Ai.Oxe);b.qa(vb.a.pha,kc.a.I0,Ai.Qxe);b.Pc(vb.a.pha,4);b.qa(vb.a.vvb,kc.a.view,Ai.Pxe);b.qa(vb.a.vvb,kc.a.s4,Ai.Oxe);b.qa(vb.a.vvb,kc.a.I0,Ai.Qxe);b.Pc(vb.a.vvb,4);b.qa(vb.a.Vgg,kc.a.view,Ai.G3);b.Pc(vb.a.Vgg,4);b.qa(vb.a.Zdb,kc.a.view,Ai.Pxe);b.qa(vb.a.Zdb,kc.a.s4,
Ai.Oxe);b.qa(vb.a.Zdb,kc.a.I0,Ai.Qxe);b.Pc(vb.a.Zdb,4);b.fb(vb.a.Utc,kc.a.view,Ai.Utc,1124);b.qa(vb.a.$db,kc.a.view,Ai.Pxe);b.qa(vb.a.$db,kc.a.s4,Ai.Oxe);b.qa(vb.a.$db,kc.a.I0,Ai.Qxe);b.Pc(vb.a.$db,4);b.fb(vb.a.Vtc,kc.a.view,Ai.Vtc,1124);b.qa(vb.a.YMa,kc.a.view,h);b.qa(vb.a.YMa,kc.a.s4,Ai.YMa);b.qa(vb.a.YMa,kc.a.I0,Ai.YMa);b.Pc(vb.a.YMa,97)}static oM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Wa.a.instance.Ta("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}static Cdb(b,h,r,A){if(1===r)return 32;if(!h.view.ve)return 2;const L=h.view;if(!L.lb||!L.lb.gb)return 8;h=L.lb.gb;if(2===r){v.ULS.sendTraceTag(578027873,306,50,"Selecting table border using border gallery");if((r=qc.SelectionFactory.qsd(h))&&si.TableReader.kP(r))return y.AFrameworkApplication.va.Hf(xc.a.create(r),b,2,!1,A,null);r=L.lb.Pg;if(!r)return 8;A=Object(Nl.a)().lU(r,16);r=Object(Nl.a)().EW(r,
14);if(!r)return Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.Lsb),8;if(!Ai.KIg(r.node,A,h))return 8;b=RK.getTableCellBorderContext(kq.TableBorderSelectionCache.oca,kq.TableBorderSelectionCache.NVa(),b);if(!b||0>=b.length)return Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.Lsb),8;kq.TableBorderSelectionCache.Jyb(b);b=qc.SelectionFactory.YMb(b,!0);h=null;b&&(h=qc.SelectionFactory.Bka(b));if(!h||0>=h.currentSelection.length)return Qr.a.recordQosError("TableBorderActionNoResponse",
["TableInteractionFailed"],gf.a.Lsb),8;If.a.instance.F0(h)}return 32}static Bdb(b,h,r){if(1===r)return 32;if(2!==r||14!==h.node.type)return 2;b=RK.getTableBorderContext(h.node,b);if(!b)return Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.Lsb),8;b=qc.SelectionFactory.Bfc(b,!0);h=null;b&&(h=qc.SelectionFactory.Bka(b));if(!h||0>=h.currentSelection.length)return Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.Lsb),8;If.a.instance.F0(h);
return 32}static Zpe(b,h,r,A,L){if(1===r)return 32;b=h.contextId===kc.a.view?pl.PageReader.instance.DQb(h):NO.a.rLf(h);if(!b)return 8;h=new Iq;r="";32===y.AFrameworkApplication.va.Qb(vb.a.YMa,2,h)&&h&&(r=h.borderColor);Ai.OZj.mca=r;b=Ai.OZj.cqb(b,ed.a.RTa);if(!b)return 8;L.MenuItems=b;v.ULS.sendTraceTag(578027874,340,50,"Table border color dropdown menu is opened.");return 32}static Pxe(b,h,r,A,L){if(!Ai.gB)return 2;if(1===r)return 32;if(!h.view.ve)return 2;var Z=h.view;if(!Z.lb||!Z.lb.gb)return 8;
h=Z.lb.gb;if(2===r){v.ULS.sendTraceTag(578027875,306,50,"Setting table border property for the command: {0} with action data {1}",b,Ai.C1c(b,L));r=qc.SelectionFactory.A4j(h);if(!r){const oa=qc.SelectionFactory.qsd(h);oa&&14===oa.type&&(r=zo.TableNodeBorderContext.Cka(oa,4))}if(r)return y.AFrameworkApplication.va.Hf(r,b,2,!0,A,L);r=qc.SelectionFactory.fJg(h);if(!r||0>=r.length){r=Z.lb.Pg;if(!r)return 8;Z=Object(Nl.a)().lU(r,16);r=Object(Nl.a)().EW(r,14);if(!r||!Ai.KIg(r.node,Z,h))return 8;r=RK.getTableCellBorderContext(kq.TableBorderSelectionCache.oca,
kq.TableBorderSelectionCache.NVa(),vb.a.hTa);if(!r||0>=r.length)return 8}Z=Pv.a.IIa(r);if(!Z)return 8;Ai.oM();h=new Sb.GraphTransaction(15);h.Ab(r[0].node);h.Ph=b;b=y.AFrameworkApplication.va.Hf(Z,b,2,!0,A,L);h.dispose();return b}return 32}static Oxe(b,h,r,A,L){if(!Ai.gB)return 2;if(1===r)return 32;if(2!==r||h.contextId!==kc.a.s4)return Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.X1d),2;v.ULS.sendTraceTag(578027904,306,50,"Setting table border property for the table border for the command: {0} with action data {1}",
b,Ai.C1c(b,L));r=h.node;A=new ok;let Z=0;({PZj:A,property:Z}=Ai.Mai(r,b,L,A,Z));Ai.oM();L=!0;const oa=new Sb.GraphTransaction(15);oa.Ab(r);oa.Ph=b;if(L=Ai.gB.KSo(h,A,Z))b=new hb.a,b.set(r),Kh.forEachCellInTable(b,Ba=>{Ba.currentNode.Xl(4,!0);return!0});oa.dispose();L&&Ai.Qd&&Ai.Qd.Yu(16);return L?32:(Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.X1d),8)}static Qxe(b,h,r,A,L){if(!Ai.gB)return 2;if(1===r)return 32;if(2!==r||h.contextId!==kc.a.I0)return Qr.a.recordQosError("TableBorderActionNoResponse",
["TableInteractionFailed"],gf.a.X1d),2;v.ULS.sendTraceTag(578027905,306,50,"Setting table border property for the cell border for the command: {0} with action data {1}",b,Ai.C1c(b,L));r=h.node;A=new ok;let Z=0;({PZj:A,property:Z}=Ai.Mai(r,b,L,A,Z));(b=Ai.gB.zxg(nn.a.eX(h),h,A,Z))&&Ai.Qd&&Ai.Qd.Yu(16);return b?32:(Qr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],gf.a.X1d),8)}static G3(b,h,r){if(1===r)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();Ai.lFa=new Xw("TableBorder",
vb.a.pha);Ai.lFa.Vyb(0);return 32}static Utc(b,h,r,A,L){if(!Ai.gB)return 8;if(1===r)return 32;b=Ai.gB.dFf();L.MenuItems=b;return 32}static Vtc(b,h,r,A,L){if(!Ai.gB)return 8;if(1===r)return 32;b=Ai.gB.eFf();L.MenuItems=b;return 32}static YMa(b,h,r,A,L){if(!Ai.gB)return 2;if(!he.a.X$c(h)&&!he.a.Y$c(h))return 8;b=Object(Ca.a)(Iq,L);if(!b)return 8;he.a.X$c(h)?Ai.gB.xmo(h,b):Ai.gB.Vko(h,b);return 32}static KIg(b,h,r){if(!b||14!==b.type)return v.ULS.sendTraceTag(578027906,306,15,"Table node must be present"),
!1;if(!h)return v.ULS.sendTraceTag(578027907,306,15,"Cell context must be present"),!1;if(r&&r.currentSelection&&r.currentSelection.Xe&&r.currentSelection.Xe.Qa&&r.currentSelection.Xe.Qa.contextId===kc.a.I0&&kq.TableBorderSelectionCache.NVa()&&0<kq.TableBorderSelectionCache.NVa().length)return!0;kq.TableBorderSelectionCache.x7c(b);r=kq.TableBorderSelectionCache.oca;for(let L=0;L<h.length;L++){if(h.getContext(L).contextId!==kc.a.ix)return!1;const Z=h.getContext(L).node;if(!$g.TableCellReader.gr(Z)){var A=
new hb.a;A.set(Z);if(A.zb(14)&&Kh.getContainingTable(A)===b){A.kd(14);A=$g.TableCellReader.WJa(A,Z);if(!A)return!1;Array.add(kq.TableBorderSelectionCache.NVa(),new OO.a(Z,A.rowIndex,A.pp,Z.rowSpan,Z.colSpan));r.leftMostColumnSelected=Math.min(r.leftMostColumnSelected,A.pp);r.rightMostColumnSelected=Math.max(r.rightMostColumnSelected,A.pp);r.topMostRowSelected=Math.min(r.topMostRowSelected,A.rowIndex);r.bottomMostRowSelected=Math.max(r.bottomMostRowSelected,A.rowIndex)}}}kq.TableBorderSelectionCache.oca=
r;return!0}static Kfa(b){b.PH(3,vb.a.pha);b.PH(4,vb.a.pha);b.z5a(fh.a.instance,1)}static Dem(b){const h=b.gb;var r=qc.SelectionFactory.A4j(h);if(!r){const A=qc.SelectionFactory.qsd(h);A&&14===A.type&&(r=zo.TableNodeBorderContext.Cka(A,4))}if(r)return Pv.a.IIa([r]);r=qc.SelectionFactory.fJg(h);if(!r||0>=r.length){r=b.Pg;if(!r)return null;b=Object(Nl.a)().lU(r,16);r=Object(Nl.a)().EW(r,14);if(!r||!Ai.KIg(r.node,b,h))return null;r=RK.getTableCellBorderContext(kq.TableBorderSelectionCache.oca,kq.TableBorderSelectionCache.NVa(),
vb.a.hTa);if(!r||0>=r.length)return null}return Pv.a.IIa(r)}static Mai(b,h,r,A,L){switch(h){case vb.a.pha:A.color=Ai.Fva.lka(b,r);L=3;break;case vb.a.vvb:A.style="none";L=2;break;case vb.a.Zdb:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.style=Ai.gB.Kti(b.MenuItemId));L=2;break;case vb.a.$db:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.weight=Ai.gB.Lti(b.MenuItemId)),L=1}return{PZj:A,property:L}}static C1c(b,h){let r="";if(!h)return r;switch(b){case vb.a.pha:r=h;break;case vb.a.vvb:r=
"none";break;case vb.a.Zdb:case vb.a.$db:(b="object"===typeof h?h:null)&&"MenuItemId"in b&&(r=b.MenuItemId)}return r}}Ai.mJ=null;Ai.lFa=null;Ai.Zxa=null;Object(u.a)(Ai,"TableBorderActor",null,[]);class EN{l$l(b,h,r,A){return b?this.K8l(h,r,A):this.m$l(h,r,A)}poi(b,h,r,A,L){return b?this.N9l(h,r,A,L):this.A9l(h,r,A,L)}w9l(b){let h=!1;var r=b.Pf?b.Xe.Xc:b.Xe.Qa;b=new hb.a;b.set(r.node);b.zb(14);r=null;$g.TableCellReader.Xfa(b)?$g.TableCellReader.lTb(b)||(h=!0,r=Kh.moveToNextRow(b)):r=Kh.moveToNextColumn(b);
return{returnValue:r,WPn:h}}I9l(b){var h=b.Pf?b.Xe.Xc:b.Xe.Qa;const r=new hb.a;r.set(h.node);r.zb(14);h=null;$g.TableCellReader.Xla(r)?$g.TableCellReader.Wla(r)||(h=new hb.a,h.set(b.Qya.node),h.zb(14),b=Vm.a.Ft(h),Vm.a.Ft(r)>b?(Kh.moveToPreviousRow(r),Kh.moveToLastColumn(r),h=r.currentNode):h=Kh.moveToPreviousRow(r)):h=Kh.moveToPreviousColumn(r);return h}Aoi(b,h){var r=b.Pf?b.Xe.Xc:b.Xe.Qa;b=new hb.a;b.set(r.node);b.zb(14);r=null;h?$g.TableCellReader.Wla(b)||(r=Kh.moveToPreviousRow(b)):$g.TableCellReader.lTb(b)||
(r=Kh.moveToNextRow(b));return r}iUb(b,h,r){for(;$g.TableCellReader.Ng(b);)if(h){if(r&&b.yBa(1)||!r&&b.EBa(1))return null;r?Kh.moveToPreviousColumn(b):Kh.moveToNextColumn(b)}else{if($g.TableCellReader.G7(b.currentNode)){const A=new hb.a;A.nd(b);if(this.iUb(A,!0,!0)||this.iUb(A,!0,!1)){b.nd(A);break}}else{if(!r&&Kh.moveToControllingCell(b,2))break;if(r&&Kh.moveToControllingCell(b))break}if(r&&$g.TableCellReader.Wla(b)||!r&&$g.TableCellReader.lTb(b))return null;r?Kh.moveToPreviousRow(b):Kh.moveToNextRow(b)}return b.currentNode}jic(b,
h){if(!Vm.a.isTableRow(b))return null;b=hb.a.eb(b.currentNode);b.zb(14);let r;const A=si.TableReader.oD(b.origin);do r=h?Kh.moveToPreviousRow(b):Kh.moveToNextRow(b);while(A&&r&&Vm.a.PWa(b));return r}ivb(b,h,r,A,L){let Z=null;fg.OutlineElementNavigator.me(b);const oa=Eb.a.isRtl(b.currentNode);if(r)if(Kh.returnToCell(b),h=$g.TableCellReader.Xfa(b),r=$g.TableCellReader.Xla(b),L||!oa&&r||oa&&A&&h)Kh.returnToContainingRow(b),(A=this.jic(b,!0))?Z=qc.SelectionFactory.qp(A,!h):L&&(fg.OutlineElementNavigator.me(b),
L=new zl.a,L.nd(b),(b=fg.OutlineElementNavigator.y3(L,!1,!1))&&(Z=qc.SelectionFactory.qp(b,!1)));else{do oa?Kh.moveToNextColumn(b):Kh.moveToPreviousColumn(b);while($g.TableCellReader.Ng(b)&&!$g.TableCellReader.Wla(b));$g.TableCellReader.Ng(b)||(Z=qc.SelectionFactory.qp(b.currentNode,!oa))}else Eb.a.UA(b,h,oa)||he.a.mf(h)||Kh.returnToCell(b),Z=qc.SelectionFactory.qp(b.currentNode,!oa);return Z}hvb(b,h,r,A,L){let Z=null;fg.OutlineElementNavigator.me(b);const oa=Eb.a.isRtl(b.currentNode);if(r)if(Kh.returnToCell(b),
r=$g.TableCellReader.Xfa(b),h=$g.TableCellReader.Xla(b),L||!oa&&A&&r||oa&&!A&&h)Kh.returnToContainingRow(b),(A=this.jic(b,!1))?Z=qc.SelectionFactory.qp(A,h):(fg.OutlineElementNavigator.me(b),A=new zl.a,A.nd(b),(b=fg.OutlineElementNavigator.ft(A,!1,!1))&&(Z=qc.SelectionFactory.qp(b,!0)));else{do oa?Kh.moveToPreviousColumn(b):Kh.moveToNextColumn(b);while($g.TableCellReader.Ng(b)&&!$g.TableCellReader.Xfa(b));$g.TableCellReader.Ng(b)||(Z=qc.SelectionFactory.qp(b.currentNode,oa))}else Eb.a.UA(b,h,!oa)||
he.a.mf(h)||Kh.returnToCell(b),Z=qc.SelectionFactory.qp(b.currentNode,oa);return Z}}Object(u.a)(EN,"ATableCellSelectionStrategy",null,[1586]);class bG extends EN{constructor(){super()}A9l(b,h,r,A){let L=b.currentSelection,Z=null;if(b.Yw)if(h)if(2===L.Xe.Ama&&!L.Pf&&L.Xe.Xc.equals(L.Qya))L=qc.SelectionFactory.Cai(L.Qya.node,!1);else{var oa=({WPn:b}=this.w9l(L)).returnValue;oa&&($g.TableCellReader.gr(oa)&&(oa=hb.a.eb(oa),oa.zb(14),oa=!b&&this.iUb(oa,!0,!1)?oa.currentNode:b||Kh.moveToNextRow(oa)?this.iUb(oa,
!1,!1):null),oa&&(Z=qc.SelectionFactory.Uo(sx.TableNodeContext.create(oa),L.Pf)))}else L=b.Jha,b=hb.a.eb(L.Xe.Xc.node),b.zb(14),$g.TableCellReader.jLa(b.currentNode)&&Kh.moveToLastGhostCell(b,2),(oa=Kh.moveToNextColumn(b))?(b=$g.TableCellReader.G7(oa),$g.TableCellReader.gr(oa)&&!b&&(oa=hb.a.eb(oa),oa.zb(14),oa=Kh.moveToControllingCell(oa)),b?L=qc.SelectionFactory.qp(L.Xe.Xc.node,!1):Z=qc.SelectionFactory.qp(oa,!0)):(oa=L.Xe.Xc.node,Z=qc.SelectionFactory.qp(oa,!1));else b=h&&L.Pf||!h&&!L.sta?L.Xe.Xc:
L.Xe.Qa,Vm.a.I7(b.node)&&(b=hb.a.eb(b.node),(oa=this.jic(b,!1))?Z=h?qc.SelectionFactory.Uo(sx.TableNodeContext.create(oa),L.Pf):qc.SelectionFactory.qp(oa,!0):L=he.a.vk(qc.SelectionFactory.Er(b.currentNode),!1,!0));return Z?Z:A?he.a.iic(L,!1,h,!0):he.a.eAa(L,{NE:!h,Du:h,cH:r,aJ:!0})}N9l(b,h,r,A){let L=b.currentSelection;var Z=null;if(b.Yw)h?1===L.Xe.Ama&&L.Pf&&L.Xe.Qa.equals(L.Qya)||(Z=this.I9l(L),(Z=this.noi(L,Z))||L.Pf&&(L=L.U0c())):(L=b.Jha,Z=qc.SelectionFactory.qp(L.Xe.Qa.node,!0));else if(h){var oa=
(L.Pf?L.Xe.Xc:L.Xe.Qa).node;b=hb.a.eb(oa);he.a.Ou(b);Vm.a.I7(oa)&&(L.Pf&&1===L.Xe.Ama&&L.sta?(Z=Vm.a.KA(oa).toArray(),(Z=this.noi(L,0<=Z.length-2?Z[Z.length-2]:null))||L.Pf&&(L=L.U0c())):(oa=this.jic(b,!0))?Z=qc.SelectionFactory.Uo(sx.TableNodeContext.create(oa),L.Pf):L=qc.SelectionFactory.qp(b.currentNode,!0))}else Z=he.a.vk(L,!0,!1);return Z?Z:A?he.a.iic(L,!0,h,!0):he.a.HJa(L,{NE:!h,Du:h,cH:r,aJ:!0})}noi(b,h){if(!h)return null;var r=h;$g.TableCellReader.gr(h)&&(r=hb.a.eb(h),r.zb(14),r=this.iUb(r,
!0,!0)?r.currentNode:$g.TableCellReader.W6(h));return r?qc.SelectionFactory.Uo(sx.TableNodeContext.create(r),b.Pf):null}m$l(b,h,r){let A=h.currentSelection,L=null;if(h.Yw){var Z=h.f_>h.jOa;if(r)if(2===h.length&&1===h.Jha.Xe.Ama&&Z)A=he.a.vk(A,!0,!1);else{if(h=this.Aoi(A,!0))$g.TableCellReader.gr(h)&&(h=hb.a.eb(h),h.zb(14),h=this.iUb(h,!1,!0)),h&&(L=qc.SelectionFactory.Uo(sx.TableNodeContext.create(h),A.Pf));L||A.Pf&&(A=A.U0c())}else Z&&(A=h.Jha)}else h=r&&A.Pf?A.Xe.Xc:A.Xe.Qa,Vm.a.I7(h.node)&&(h=
hb.a.eb(h.node),(Z=this.jic(h,!0))?L=r?qc.SelectionFactory.Uo(sx.TableNodeContext.create(Z),A.Pf):qc.SelectionFactory.qp(Z,!0):r&&(A=qc.SelectionFactory.qp(h.currentNode,!0)));return L?L:he.a.dob(b,A,!1,r,r)}K8l(b,h,r){let A=h.currentSelection,L=null;if(h.Yw){const Z=h.f_<h.jOa;if(r)if(2===h.length&&1===h.Jha.Xe.Ama&&Z)A=he.a.vk(A,!1,!1);else{if(h=this.Aoi(A,!1))$g.TableCellReader.gr(h)&&(h=hb.a.eb(h),h.zb(14),h=this.iUb(h,!1,!1)),h&&(L=qc.SelectionFactory.Uo(sx.TableNodeContext.create(h),A.Pf))}else Z&&
(A=h.Jha)}else h=!r||A.Pf?A.Xe.Xc:A.Xe.Qa,Vm.a.I7(h.node)&&(h=hb.a.eb(h.node),(h=this.jic(h,!1))&&(L=r?qc.SelectionFactory.Uo(sx.TableNodeContext.create(h),A.Pf):qc.SelectionFactory.qp(h,A.sta)));return L?L:he.a.dob(b,A,!0,r,r)}}Object(u.a)(bG,"TableCellSelectionStrategy",EN,[]);class dM{constructor(b){this.aM=(h,r,A,L,Z)=>{if(1===A)return 32;h=(new jo.a).create();r="";switch(Z.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;Z=CommonUIStrings.l_DefaultDialogTitle;
break;default:Z=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.aM(Z,null,null);return 32};this.ga=b}Xb(){this.ga.fb(vb.a.aM,kc.a.view,this.aM,1028)}}Object(u.a)(dM,"UIAutomationActor",null,[]);class PO{constructor(b,h,r,A){this.hb=b;this.zPa=h;this.UDc=r;this.O9=A}QIg(b,h,r){return this.UDc.tpn(h)?r?!0:b&&this.hb.Fh(b)?(b=this.Cx(b.currentNode),this.zPa.sSi(b),!0):!1:!1}MQf(b,h){return this.UDc.f3l(b,h)}SQf(b){b&&this.hb.Fh(b)&&(b=this.Cx(b.currentNode),this.zPa.Hbe(b))}Cx(b){return xc.a.Cx(b)}vca(b,
h,r){this.O9.$rj&&this.UDc.cXi(r)&&(this.O9.vca(b,h),b.setValue(Od.a.vXi,!0))}syb(){}Gde(b){return this.UDc.Gde(b)}get Nee(){return this.UDc.Nee}UE(){}nha(){}Lxe(){}get rTj(){return!1}}Object(u.a)(PO,"WordEditorPasteStewardBridge",null,[333]);class QO{constructor(b){this.sa=new Bf.a;this.YIj="WordFileSaveAsButtonClicked";this.tIp=()=>{this.sa.raiseEvent(this.YIj,null);return 32};this.ga=b}Xb(){y.AFrameworkApplication.J.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(Ec.a.Vbk,Gc.a.frame,this.tIp)}w2k(b){this.sa.addHandler(this.YIj,
b)}}Object(u.a)(QO,"WordFileSaveAsActor",null,[]);class FN extends wh{constructor(){super()}mTc(b,h,r,A,L,Z,oa){return yt.a.Ftc(h,r,A,L,Z,oa)}}Object(u.a)(FN,"WordIndentationActorExtension",wh,[]);class cG{constructor(b){this.$z=b;this.Swc=()=>32;this.kee=(h,r,A)=>{if(1===A)return 1===this.$z.Gv?32:8}}Xb(){const b=y.AFrameworkApplication.va;b.qa(vb.a.Swc,kc.a.view,this.Swc);b.qa(vb.a.kee,kc.a.view,this.kee)}}Object(u.a)(cG,"LineNumberingActor",null,[]);class GN extends Dg.a{constructor(b){super(!1,
!1,!0);this.J1f=b;this.Wvl=this.J1f.t2o}Q8o(){const b=Box4Intl.Box4Strings.l_KeyboardShortcutsDialogTitle;this.Bd=null;const h={["id"]:"KeyboardShortcutsDialog",["bodyControls"]:{defaultCheckbox:!0,renderOverrideShortcutsSection:!0,prioritySection:"section2"},["shortcuts"]:this.Wvl};this.Uh(b,this.Lgk.bind(this),h)}Lgk(){}}Object(u.a)(GN,"KeyboardShortcutsDialog",Dg.a,[]);class WI{constructor(){this.uEh=[];this.nKl()}get t2o(){return this.uEh}nKl(){this.$Uk();this.XWk();this.kYk();this.xZk();this.JZk();
this.sZk();this.JUk()}get So(){return aa.a.Jl?"\u2318":"Ctrl"}get gia(){return aa.a.Jl?"Option":"Alt"}get jSf(){return this.So+"+X"}get iSf(){return this.So+"+C"}get kSf(){return this.So+"+V"}get A2m(){return this.So+"+Z"}get d2m(){return this.So+"+Y"}get o1m(){return this.So+"+B"}get z1m(){return this.So+"+I"}get z2m(){return this.So+"+U"}get p1m(){return this.So+"+K"}get Z1m(){return this.So+"+/"}get C1m(){return this.So+"+L"}get f2m(){return this.So+"+R"}get q1m(){return this.So+"+E"}get A1m(){return this.So+
"+J"}get x1m(){return this.So+"+>"}get s1m(){return this.So+"+<"}get v2m(){return this.So+"+X"}get u2m(){return this.So+"+["}get w1m(){return this.So+"+]"}get J1m(){return"\u2192"}get I1m(){return"\u2190"}get L1m(){return this.So+"+\u2192"}get K1m(){return this.So+"+\u2190"}get T1m(){return"\u2191"}get G1m(){return"\u2193"}get U1m(){return this.So+"+\u2191"}get H1m(){return this.So+"+\u2193"}get S1m(){return"Home"}get O1m(){return"End"}get Q1m(){return"Page up"}get P1m(){return"Page down"}get R1m(){return this.So+
"+Home"}get N1m(){return this.So+"+End"}get M1m(){return this.gia+"+Windows"}get n1m(){return"Tab"}get F1m(){return"Tab"}get u1m(){return"Enter"}get r1m(){return this.So+"+F3"}get j2m(){return"Shift+\u2192"}get i2m(){return"Shift+\u2190"}get l2m(){return"Shift+"+this.So+"+\u2192"}get k2m(){return"Shift+"+this.So+"+\u2190"}get q2m(){return"Shift+\u2191"}get g2m(){return"Shift+\u2193"}get r2m(){return"Shift+"+this.So+"+\u2191"}get h2m(){return"Shift+"+this.So+"+\u2193"}get p2m(){return"Shift+Home"}get n2m(){return"Shift+End"}get o2m(){return"Shift+"+
this.So+"+Home"}get m2m(){return"Shift+"+this.So+"+End"}get s2m(){return this.So+"+A"}get y1m(){return this.So+"+M"}get x2m(){return this.So+"+Shift+E"}get l1m(){return this.So+"+"+this.gia+"+="}get e2m(){return this.So+"+"+this.gia+"+-"}get c2m(){return this.So+"+"+this.gia+"+9"}get W1m(){return this.So+"+"+this.gia+"+0"}get m1m(){return this.So+"+Shift+A"}get D1m(){return this.So+"+F6"}get E1m(){return this.So+"+Shift+F6"}get v1m(){return this.gia+"+Q"}get t1m(){return this.gia+"+Windows"}get y2m(){return this.So+
"+Shift+F10"}get Y1m(){return this.So+"+F8"}get X1m(){return this.So+"+F9"}get t2m(){return this.gia+"+F12"}get B1m(){return this.So+"+"+this.gia+"+F7"}get w2m(){return this.So+"+Shift+Y"}get V1m(){return this.So+"+"+this.gia+"+G"}get $1m(){return this.So+"+"+this.gia+"+Space"}get a2m(){return this.gia+"+\u2193"}$Uk(){this.ll(Box4Intl.Box4Strings.L_Cut,this.jSf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.L_Copy,this.iSf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.L_Paste,this.kSf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_UndoShortcutDialogDescription,this.A2m,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_RedoShortcutDialogDescription,this.d2m,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog)}XWk(){this.ll(Box4Intl.Box4Strings.l_BoldShortcutDialogDescription,this.o1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.l_ItalicsShortcutDialogDescription,this.z1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_UnderlineShortcutDialogDescription,this.z2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_BulletedListShortcutDialogDescription,this.p1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_NumberedListShortcutDialogDescription,this.Z1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.l_AlignLeftShortcutDialogDescription,this.C1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_AlignRightShortcutDialogDescription,this.f2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_AlignCenteredShortcutDialogDescription,this.q1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_JustifyShortcutDialogDescription,this.A1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.l_IncreaseFontSizeShortcutDialogDescription,this.x1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_DecreaseFontSizeShortcutDialogDescription,this.s1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_StrikethroughShortcutDialogDescription,this.v2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ShrinkFontSizeShortcutDialogDescription,this.u2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.l_GrowFontSizeShortcutDialogDescription,this.w1m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog)}kYk(){this.ll(Box4Intl.Box4Strings.l_MoveRightOneCharacterShortcutDialogDescription,this.J1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveLeftOneCharacterShortcutDialogDescription,this.I1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveRightOneWordShortcutDialogDescription,
this.L1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveLeftOneWordShortcutDialogDescription,this.K1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveUpOneLineShortcutDialogDescription,this.T1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveDownOneLineShortcutDialogDescription,this.G1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveUpOneParagraphShortcutDialogDescription,
this.U1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveDownOneParagraphShortcutDialogDescription,this.H1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveToStartOfLineShortcutDialogDescription,this.S1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveToEndOfLineShortcutDialogDescription,this.O1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveToPreviousPageShortcutDialogDescription,
this.Q1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveToNextPageShortcutDialogDescription,this.P1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveToStartOfDocumentShortcutDialogDescription,this.R1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveToEndOfDocumentShortcutDialogDescription,this.N1m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog)}xZk(){this.ll(Box4Intl.Box4Strings.l_MoveRibbonDocumentContentShortcutDialogDescription,
this.M1m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ActivateDifferentRibbonTabShortcutDialogDescription,this.n1m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveAmongRibbonCommandsShortcutDialogDescription,this.F1m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ExecuteCurrentRibbonCommandShortcutDialogDescription,this.u1m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.l_CollapseExpandRibbonShortcutDialogDescription,this.r1m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog)}JZk(){this.ll(Box4Intl.Box4Strings.l_SelectRightOneCharacterShortcutDialogDescription,this.j2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectLeftOneCharacterShortcutDialogDescription,this.i2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectRightOneWordShortcutDialogDescription,
this.l2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectLeftOneWordShortcutDialogDescription,this.k2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectUpOneLineShortcutDialogDescription,this.q2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectDownOneLineShortcutDialogDescription,this.g2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectUpOneParagraphShortcutDialogDescription,
this.r2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectDownOneParagraphShortcutDialogDescription,this.h2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectToStartOfLineShortcutDialogDescription,this.p2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectToEndOfLineShortcutDialogDescription,this.n2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectToStartOfDocumentShortcutDialogDescription,
this.o2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_SelectToEndOfDocumentShortcutDialogDescription,this.m2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_WholeDocumentShortcutDialogDescription,this.s2m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog)}sZk(){this.ll(Box4Intl.Box4Strings.l_InsertCommentShortcutDialogDescription,this.y1m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ToggleChangeTrackingShortcutShortcutDialogDescription,
this.x2m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_AcceptChangeShortcutDialogDescription,this.l1m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_RejectChangeShortcutDialogDescription,this.e2m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_PreviousChangeShortcutDialogDescription,this.c2m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_NextChangeShortcutDialogDescription,
this.W1m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog)}JUk(){this.ll(Box4Intl.Box4Strings.l_AccessibilityHelpShortcutDialogDescription,this.m1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_MoveAmongLandmarkRegionsShortcutDialogDescription,this.D1m+" "+Box4Intl.Box4Strings.l_OrStringShortcutsDialog+" "+this.E1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_GoToTellMeBoxShortcutDialogDescription,
this.v1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_DisplayHideKeytipShortcutDialogDescription,this.t1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ToggleTooltipShortcutDialogDescription,this.y2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_NextFootNoteShortcutDialogDescription,this.Y1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_NextEndNoteShortcutDialogDescription,
this.X1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ShowNextCommentShortcutDialogDescription,this.t2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_LaunchAccessibilityCheckerShortcutDialogDescription,this.B1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_ToggleAnnouncementShortcutDialogDescription,this.w2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);
this.ll(Box4Intl.Box4Strings.l_NavigateFirstGraphicObjectShortcutDialogDescription,this.V1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_OpenDialogueMenuShortcutDialogDescription+" "+Box4Intl.Box4Strings.l_WhenDialogIsOpenShortcutsDialog,this.$1m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.ll(Box4Intl.Box4Strings.l_OpenSuggestionShortcutDialogDescription,this.a2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog)}ll(b,
h,r){this.uEh.push({description:b,shortcut:h,section:r,overrideBrowserShortcut:""})}}Object(u.a)(WI,"KeyboardShortcutsCollection",null,[]);class RO{constructor(b){this.Pb=this.Pb=b}Xb(){this.Pb.qa(Ec.a.G4i,kc.a.view,this.aik.bind(this))}aik(b,h,r){if(1===r)return 32;this.yxn=new WI;(new GN(this.yxn)).Q8o();return 32}}Object(u.a)(RO,"KeyboardShortcutsDialogActor",null,[]);class SK{constructor(b,h,r,A,L){this.Pb=b;this.Fva=h;this.kcb=r;this.aG=A;this.Yo=L;this.lFa=this.mJ=null;this.Und=(Z,oa,Ba)=>{if(1===
Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.Dzb,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[1],oa);Ba.dispose();return 32};this.$nd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.Izb,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[0],
oa);Ba.dispose();return 32};this.Wnd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.Heb,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[2],oa);Ba.dispose();return 32};this.Znd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.Ieb,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);
Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[3],oa);Ba.dispose();return 32};this.Snd=(Z,oa,Ba)=>{const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!1);return 0===gb.length?8:1===Ba&&Ab?32:1!==Ba||Ab?Ab?this.Pb.Ob(vb.a.Fzb,Ba):8:8};this.Tnd=(Z,oa,Ba)=>{const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!1);return 0===gb.length?8:1===Ba&&Ab?32:1!==Ba||Ab?Ab?this.Pb.Ob(vb.a.Gzb,Ba):8:8};this.Ynd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;
if(Ab)return this.Pb.Ob(vb.a.Hzb,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[0,1,2,3],oa);Ba.dispose();return 32};this.Vnd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.Ezb,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[4],oa);Ba.dispose();return 32};this.Rnd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,
isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.hTa,Ba);oa=this.xPb(gb);Ba=this.Yo.Lc(15);Ba.Ab(gb[0]);Ba.Ph=Z;for(const Jb of gb)this.kcb.gyb(Jb,[0,1,2,3,4],oa);Ba.dispose();return 32};this.Xnd=(Z,oa,Ba)=>{if(1===Ba)return 32;const {paragraphs:gb,isInsideTable:Ab}=this.k7(oa,!0);if(0===gb.length)return 8;if(Ab)return this.Pb.Ob(vb.a.vvb,Ba);oa=this.Yo.Lc(15);oa.Ab(gb[0]);oa.Ph=Z;for(const Jb of gb)this.kcb.wrl(Jb);oa.dispose();return 32};this.Vpe=(Z,oa,Ba,
gb,Ab)=>{if(1===Ba)return 32;Z=pl.PageReader.instance.DQb(oa);if(!Z)return 8;const {paragraphs:Jb,isInsideTable:Tb}=this.k7(oa,!1);Tb?(Ba=new Iq,this.Pb.Hf(oa,vb.a.YMa,2,!1,void 0,Ba),this.dig.mca=Ba.borderColor):(oa=this.tLf(Jb,!0),this.dig.mca=oa&&void 0!==oa.color?Ql.a.JB(oa.color):"");oa=this.dig.cqb(Z,ed.a.RTa);if(!oa)return 8;Ab.MenuItems=oa;return 32};this.Jng=(Z,oa,Ba,gb,Ab)=>{if(1===Ba)return 32;if(!Ab)return 0;const {paragraphs:Jb,isInsideTable:Tb}=this.k7(oa,!1);Ba=this.tLf(Jb,!0);gb=new Iq;
Tb&&this.Pb.Hf(oa,vb.a.YMa,2,!1,void 0,gb);if(!Ba&&!Tb)return Ab[Tg.a.On]=!1,32;switch(Z){case Ec.a.Cre:Ab[Tg.a.On]=Ab.MenuItemId===this.aG.Tjm(Tb?gb.lineStyle:Ba.style);break;case Ec.a.Dre:Ab[Tg.a.On]=Ab.MenuItemId===this.aG.Wjm(Tb?gb.lqc:Ba.size);break;case Ec.a.Bre:if(!Ba){Ab[Tg.a.On]=!1;break}Ab[Tg.a.On]=Ab.MenuItemId===this.aG.Qjm(Ba.space);break;default:return 8}return 32};this.yxe=(Z,oa,Ba,gb,Ab)=>{const {paragraphs:Jb,isInsideTable:Tb}=this.k7(oa,!0);if(0===Jb.length)return 8;if(1===Ba)return Tb&&
Z===Ec.a.F_b?8:32;oa=this.C1c(Z,Ab);if(Tb)switch(Z){case Ec.a.SDa:return this.Pb.Qb(vb.a.pha,Ba,oa);case Ec.a.G_b:return this.Pb.Qb(vb.a.Zdb,Ba,Ab);case Ec.a.H_b:return this.Pb.Qb(vb.a.$db,Ba,Ab);default:return 8}Ba=this.Yo.Lc(15);Ba.Ab(Jb[0]);Ba.Ph=Z;for(const jc of Jb)if(Ab=this.aG.Z1c(jc),(gb=this.aG.gjc(jc))&&Ab&&0!==Ab.length){switch(Z){case Ec.a.SDa:gb.color=this.Fva.lka(jc,oa);this.Uad.color=gb.color;break;case Ec.a.G_b:gb.style=this.aG.Sjm(oa);this.Uad.style=gb.style;break;case Ec.a.H_b:gb.size=
this.aG.Vjm(oa);this.Uad.size=gb.size;break;case Ec.a.F_b:gb.space=this.aG.Pjm(oa),this.Uad.space=gb.space}this.kcb.gyb(jc,Ab,gb)}Ba.dispose();return 32};this.Utc=(Z,oa,Ba,gb,Ab)=>{if(!this.aG)return 8;if(1===Ba)return 32;Z=this.aG.dFf();Ab.MenuItems=Z;return 32};this.Vtc=(Z,oa,Ba,gb,Ab)=>{if(!this.aG)return 8;if(1===Ba)return 32;Z=this.aG.eFf();Ab.MenuItems=Z;return 32};this.Xdo=(Z,oa,Ba,gb,Ab)=>{if(!this.aG)return 8;if(1===Ba)return 32;Z=this.aG.bfm();Ab.MenuItems=Z;return 32};this.G3=(Z,oa,Ba)=>
{if(1===Ba)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();this.lFa=new Xw(SK.unb,Ec.a.SDa);this.lFa.Vyb(0);return 32};this.Uad=this.aG.UHf()}get dig(){this.mJ||(this.mJ=new Wq(SK.unb),this.Kfa());return this.mJ}Kfa(){this.mJ.PH(3,Ec.a.SDa);this.mJ.PH(4,Ec.a.SDa);this.mJ.z5a(fh.a.instance,1)}Xb(){this.Hto();this.Kto();this.Jto()}Hto(){y.AFrameworkApplication.va;this.Pb.qa(Ec.a.Und,kc.a.view,this.Und);this.Pb.Pc(Ec.a.Und,4);this.Pb.qa(Ec.a.$nd,kc.a.view,this.$nd);this.Pb.Pc(Ec.a.$nd,4);this.Pb.qa(Ec.a.Wnd,
kc.a.view,this.Wnd);this.Pb.Pc(Ec.a.Wnd,4);this.Pb.qa(Ec.a.Znd,kc.a.view,this.Znd);this.Pb.Pc(Ec.a.Znd,4);this.Pb.qa(Ec.a.Snd,kc.a.view,this.Snd);this.Pb.Pc(Ec.a.Snd,4);this.Pb.qa(Ec.a.Tnd,kc.a.view,this.Tnd);this.Pb.Pc(Ec.a.Tnd,4);this.Pb.qa(Ec.a.Ynd,kc.a.view,this.Ynd);this.Pb.Pc(Ec.a.Ynd,4);this.Pb.qa(Ec.a.Vnd,kc.a.view,this.Vnd);this.Pb.Pc(Ec.a.Vnd,4);this.Pb.qa(Ec.a.Rnd,kc.a.view,this.Rnd);this.Pb.Pc(Ec.a.Rnd,4);this.Pb.qa(Ec.a.Xnd,kc.a.view,this.Xnd);this.Pb.Pc(Ec.a.Xnd,4)}Kto(){this.Pb.qa(Ec.a.Vpe,
kc.a.view,this.Vpe);this.Pb.qa(Ec.a.SDa,kc.a.view,this.yxe);this.Pb.Pc(Ec.a.SDa,4);this.Pb.qa(Ec.a.Cre,kc.a.view,this.Jng);this.Pb.qa(Ec.a.G_b,kc.a.view,this.yxe);this.Pb.Pc(Ec.a.G_b,4);this.Pb.fb(Ec.a.Ftj,kc.a.view,this.Utc,1124);this.Pb.qa(Ec.a.Dre,kc.a.view,this.Jng);this.Pb.qa(Ec.a.H_b,kc.a.view,this.yxe);this.Pb.Pc(Ec.a.H_b,4);this.Pb.fb(Ec.a.Gtj,kc.a.view,this.Vtc,1124);this.Pb.qa(Ec.a.Bre,kc.a.view,this.Jng);this.Pb.qa(Ec.a.F_b,kc.a.view,this.yxe);this.Pb.Pc(Ec.a.F_b,4);this.Pb.fb(Ec.a.Etj,
kc.a.view,this.Xdo,1124)}Jto(){this.Pb.qa(Ec.a.Tgg,kc.a.view,this.G3);this.Pb.Pc(Ec.a.Tgg,4)}k7(b,h){b=Bt.a.V2c(b);const r=[];let A=!0;for(const L of b)Cd.ParagraphReader.Wb(L.node)&&(r.push(L.node),Cd.ParagraphReader.EX(L.node)||(A=!1));return!h||1!==r.length||A||b.Qa.contextId!==kc.a.Vc?{paragraphs:r,isInsideTable:A}:{paragraphs:this.kBm(r[0]),isInsideTable:!1}}kBm(b){const h=this.aG.gjc(b),r=this.aG.Z1c(b);if(0===r.length||!h)return[b];const A=[];for(var L=Cd.ParagraphReader.pg(b,!0,!1,!1);L;){var Z=
this.aG.gjc(L),oa=this.aG.Z1c(L);if(Z&&this.aG.HTh(r,oa)&&this.aG.xSd(h,Z))A.push(L);else break;L=Cd.ParagraphReader.pg(L,!0,!1,!1)}L=[];for(Z=Cd.ParagraphReader.pg(b,!1,!1,!1);Z;){oa=this.aG.gjc(Z);const Ba=this.aG.Z1c(Z);if(oa&&this.aG.HTh(r,Ba)&&this.aG.xSd(h,oa))L.push(Z);else break;Z=Cd.ParagraphReader.pg(Z,!1,!1,!1)}return[...A.reverse(),b,...L]}tLf(b,h=!1){if(0!==b.length){var r=this.aG.gjc(b[0]);for(const A of b)if(b=this.aG.gjc(A),h)r=this.Smm(r,b);else if(!this.aG.xSd(r,b)){r=void 0;break}return r}}Smm(b,
h){if(b&&h)return{color:b.color===h.color?b.color:void 0,style:b.style===h.style?b.style:void 0,size:b.size===h.size?b.size:void 0,space:b.space===h.space?b.space:void 0}}C1c(b,h){var r="";if(!h)return r;switch(b){case Ec.a.SDa:r=(r="object"===typeof h?h:null)&&"Color"in r?r.Color:h;break;case Ec.a.G_b:case Ec.a.H_b:case Ec.a.F_b:(h="object"===typeof h?h:null)&&"MenuItemId"in h&&(r=h.MenuItemId)}return r}xPb(b){b=this.tLf(b);b||(b=this.Uad);b||(b=this.aG.UHf());return b}}SK.unb="ParagraphBorder";
Object(u.a)(SK,"ParagraphBorderActor",null,[]);var jP=d(781),SO=d(1157);class KA extends hl.a{constructor(b,h,r,A){super();this.Zuk="CommonControlChevronDown_12";this.Uqk="CommonControlChevronRight_12";this.ADc="aria-label";this.v$b="role";this.lnk="alt";this.Gma=L=>{if(null===L)return!1;this.PEb.get(L.Df).style.visibility="visible";return!0};this.Hma=L=>{if(null===L)return!1;this.PEb.get(L.Df).style.visibility="collapse";return!0};this.PEb=new Map;this.Xm=b;this.$g=h;this.qd=r;this.Vuk=A}u_a(b){b=
this.kN(b);return SO.a.yjn(b)}fUa(b){const h=[];h.push(this.Mea(b.I3));return h}Mea(b){var h;const r=this.kN(b),A=r.Inb;if(A){var L=b.Kh.ownerDocument,Z=b.htmlElement.querySelector(".ParaWrappingDiv");Z=null===Z||void 0===Z?void 0:Z.querySelector("p");Z=null===Z||void 0===Z?void 0:Z.querySelector("span");var oa=parseFloat(null===Z||void 0===Z?void 0:Z.style.lineHeight.slice(0,-2));Z=oo.a.createElement(L,po.a.div);Z.className=KA.Yuk;Z.style.top=`${oa/2}px`;L=this.SGl(L,A.ktb);Z.appendChild(L);this.KVf(Z,
L,A.ktb);oa=null===(h=this.qd.Ie)||void 0===h?void 0:h.dOb;this.opn(b.htmlElement,oa)?this.KVf(oa,L,A.ktb):this.KVf(b.htmlElement,L,A.ktb);this.$g.LI(od.a.click,L,this.Zta.bind(this),r);return Z}}SGl(b,h){const r=oo.a.createElement(b,po.a.div);r.className=KA.Xuk;r.title=h?WordRibbonStrings.CollapsedHeadingExpandButtonTooltip:WordRibbonStrings.ExpandedHeadingCollapseButtonTooltip;r.style.visibility=h?"visible":"collapse";r.setAttribute(this.v$b,"img");r.setAttribute(this.lnk,r.title);r.setAttribute(this.ADc,
r.title);b=oo.a.createElement(b,po.a.div);b.className=KA.Wuk;jP.a.renderIcon(h?this.Uqk:this.Zuk,b);r.appendChild(b);return r}KVf(b,h,r){r?(this.$tp(b),this.PEb.delete(b)):(this.PEb.set(b,h),this.Evo(b))}Evo(b){this.Xm.ub(od.a.w3,b,this.Gma);this.Xm.ub(od.a.MU,b,this.Hma)}$tp(b){this.Xm.xc(od.a.w3,b,this.Gma);this.Xm.xc(od.a.MU,b,this.Hma)}Zta(b){if(null===b)return!1;this.Vuk.n1j(b.uq);return!1}kN(b){return Cd.ParagraphReader.Kv(b.Cb,!0,!1).K(0)}opn(b,h){b=rd.a.getElementBounds(b);h=rd.a.getElementBounds(h);
return null===b||null===h||b.x>h.x+h.width||h.x>b.x+b.width||b.y>h.y+h.height||h.y>b.y+b.height?!1:!0}}KA.Yuk="WordExpandCollapseIndicatorContainer";KA.Xuk="WordExpandCollapseIconContainer";KA.Wuk="WordExpandCollapseIcon";Object(u.a)(KA,"ExpandCollapseIndicatorActor",hl.a,[325]);class Ww{constructor(b=Ww.wob){this.color=b}}Ww.wob=0;Ww.CAo=Ql.a.auto;Object(u.a)(Ww,"ParagraphShadingProperties",null,[]);class Gu{constructor(b,h,r,A,L,Z){this.Pb=b;this.Fva=h;this.IP=r;this.trj=A;this.r$n=L;this.Yo=Z;
this.$3h=this.bWd=null;this.ieo=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;if(2===gb&&!Jb)return 8;oa=pl.PageReader.instance.DQb(Ba);if(!oa)return 8;Ba="";gb={};32===this.Pb.Qb(Ec.a.Qid,2,gb)&&(Ba=gb[Gu.RCa]);this.srj.mca=Ba;this.IP.NAc(Ba);oa=this.srj.cqb(oa,ed.a.RTa);if(!oa)return 8;Jb.MenuItems=oa;return 32};this.PZo=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;this.Pb.Qb(Ec.a.wca,2,Jb);this.IP.cTa(this.Zui(Jb))||v.ULS.sendTraceTag(508151187,340,50,"Color selected from Recent Colors section. Menu: {0}",
Gu.RCa);return 32};this.Qid=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;const {paragraphs:Tb,isInsideTable:jc}=this.k7(Ba);if(0===Tb.length)return 32;if(jc){oa={};if(32===this.Pb.Hf(Ba,vb.a.Qwb,2,void 0,Ab,oa,void 0)){Ba=oa[Gu.qnl];if(!Ba)return 8;Jb[Gu.RCa]=Ql.a.JB(Ba);return 32}return 8}Ba=this.WKm(Tb);if(!Ba)return 8;Jb[Gu.RCa]=Ba;return 32};this.bzg=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;gb=this.Zui(Jb);if(!gb)return 8;const {paragraphs:Tb,isInsideTable:jc}=this.k7(Ba);if(0===Tb.length)return 32;this.hIn&&
1===Tb.length&&Bt.a.V2c(Ba).Qa.contextId===kc.a.Cd&&Object(me.a)("SetShadingOnTextRange");if(jc)return this.Pb.Hf(Ba,vb.a.w8,2,void 0,Ab,gb,void 0);Ba=this.Yo.Lc(15);Ba.Ab(Tb[0]);Ba.Ph=oa;for(const Hc of Tb)oa=new Ww(this.Fva.lka(Hc,gb)),this.trj.bzg(Hc,oa);Ba.dispose();return 32};this.G3=(oa,Ba,gb)=>{if(1===gb)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();this.$3h=new Xw(Gu.RCa,Ec.a.aod);this.$3h.Vyb(0);return 32};this.bof=(oa,Ba,gb,Ab,Jb)=>{if(1===gb)return 32;const {paragraphs:Tb,isInsideTable:jc}=
this.k7(Ba);if(0===Tb.length)return 32;if(jc)return this.Pb.Hf(Ba,vb.a.knb,2,void 0,Ab,Jb,void 0);Ba=this.Yo.Lc(15);Ba.Ab(Tb[0]);Ba.Ph=oa;for(const Hc of Tb)this.trj.bof(Hc);Ba.dispose();return 32}}Xb(){this.Pb.qa(Ec.a.wca,kc.a.view,this.bzg);this.Pb.Pc(Ec.a.wca,1028);this.Pb.qa(Ec.a.aod,kc.a.view,this.PZo);this.Pb.Pc(Ec.a.aod,1028);this.Pb.qa(Ec.a.Qid,kc.a.view,this.Qid);this.Pb.Pc(Ec.a.Qid,1124);this.Pb.qa(Ec.a.zxe,kc.a.view,this.G3);this.Pb.Pc(Ec.a.zxe,1028);this.Pb.qa(Ec.a.Axe,kc.a.view,this.bof);
this.Pb.Pc(Ec.a.Axe,1028);this.Pb.qa(Ec.a.lkg,kc.a.view,this.ieo);this.Pb.Pc(Ec.a.lkg,1124)}get srj(){this.bWd||(this.bWd=new Wq(Gu.RCa),this.Kfa(this.bWd));return this.bWd}Kfa(b){b.PH(3,Ec.a.wca);b.PH(4,Ec.a.wca);b.PH(5,Ec.a.aod);b.PH(2,Ec.a.Axe);b.PH(6,Ec.a.zxe);b.z5a(fh.a.instance,1)}k7(b){b=Bt.a.V2c(b);const h=[];let r=!0;for(const A of b)Cd.ParagraphReader.Wb(A.node)&&(h.push(A.node),Cd.ParagraphReader.EX(A.node)||(r=!1));return{paragraphs:h,isInsideTable:r}}Zui(b){if(!b)return"";const h="object"===
typeof b?b:null;return h&&"Color"in h?h.Color:b}WKm(b){if(0===b.length)return"";const h=this.yGi(b[0]);for(const r of b)if(h!==this.yGi(r))return"";return h}yGi(b){return(b=this.r$n.VKm(b))?Ql.a.JB(b.color):""}get hIn(){if(null!=this.H0g)var b=this.H0g;else{var h;y.AFrameworkApplication.$c("c6dg7724;h7d41461");b=this.H0g=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoggingForParagraphShadingOnRange",!1)}return b}}Gu.RCa="ParagraphShading";
Gu.qnl="CellShading";Object(u.a)(Gu,"ParagraphShadingActor",null,[]);class TK{constructor(){this.iId=this.JEd=null}get name(){return"WordEditor.Actors"}init(){var b;Object(Kb.a)().Ie.igc=!0;y.AFrameworkApplication.va.qa(Ec.a.fHp,Gc.a.frame,IK);this.Z.resolve("WordEditor.Actors.DeleteActor").Xb(y.AFrameworkApplication.va);QF.instance.Xb();Om.Xb();Jm.Xb(y.AFrameworkApplication.va,this.Z.resolve("WordEditor.IMainViewModeManager"));Ik.Xb();hE.instance.Xb();Ai.Xb();this.Z.resolve("WordEditor.Actors.ModeSwitcherControlActor").Xb(y.AFrameworkApplication.va);
this.Z.resolve("WordEditor.Actors.ExternalContentActor").Xb();this.iId=this.Z.resolve("WordEditor.OnlineMedia.OnlineMediaActor");this.iId.Xb();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&this.Z.resolve("Box4.Actors.FormatPainterActor").Xb();y.AFrameworkApplication.J.$("WordEditorAutoSaveImprovementIsEnabled")&&this.Z.resolve("WordEditor.Actors.SaveStatusActor").Xb();y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&
(this.uZ.Vee=!0);y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.Z.resolve("WordEditor.Actors.ModernUxActor").Xb();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.Z.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Xb();this.Z.resolve("WordEditor.Actors.AppFrameCommandUIActor").Xb();this.Z.resolve("Common.IOfficeTrialExperience").Xb();this.Z.resolve("Common.IMacOfficeOffer").Xb();
this.Z.resolve("WordEditor.Actors.MarginsDialogActor").Xb();this.Z.resolve("WordEditor.Actors.PaperSizeDialogActor").Xb();this.Z.resolve("WordEditor.Actors.ColumnsDialogActor").Xb();this.Z.resolve("WordEditor.Actors.FileDownloadActor").Xb();this.Z.resolve("WordEditor.Actors.StylesActor").Xb();this.Z.resolve("WordEditor.Actors.ParagraphDialogActor").Xb();this.Z.resolve("WordEditor.Actors.ProofingActor").Xb();this.Z.resolve("WordEditor.Actors.PageActor").Xb();Object(wC.a)()&&this.Z.resolve("WordEditor.Actors.LineNumberingActor").Xb();
this.Z.resolve("WordEditor.Actors.DarkModeActor").Xb();this.Z.resolve("WordEditor.Actors.ImageActor").Xb(y.AFrameworkApplication.va);this.Z.resolve("WordEditor.Actors.FormattingActor").Xb();this.Z.resolve("WordEditor.Actors.UIAutomationActor").Xb();this.Z.resolve("WordEditor.Actors.ContentControlActor").Xb();this.Z.resolve("WordEditor.Actors.CustomTabActor").Xb();this.Z.resolve("WordEditor.Actors.BookmarkActor").Xb();this.Z.resolve("WordEditor.Actors.HeadingsActor").Xb();const h=this.Z.resolve("Box4.Indicator.IIndicatorManager");
h.eNa(this.Z.resolve("WordEditor.Actors.BookmarkIndicatorActor"));qu.a.ftb&&h.eNa(this.Z.resolve("WordEditor.Actors.ExpandCollapseIndicatorActor"));this.Z.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Xb();this.Z.resolve("WordEditor.Actors.AccessibilityActor").Lpg();this.Z.resolve("WordEditor.Actors.ISWordRequestManager");this.Z.resolve("Box4.Actors.AutoCorrectActor").Xb();this.Z.resolve("WordEditor.Actors.DigitalPrintActor").Xb();this.Z.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");
this.Z.resolve("Box4.Actors.VisiMarkersActor").Xb();this.Z.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.Z.resolve("WordEditor.Actors.ActionHangDetector").fY();this.Z.resolve("WordEditor.Actors.WordFileSaveAsActor").Xb();y.AFrameworkApplication.J.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.Ito():this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").Xb();this.dZ.Vcb(this.fpk);this.Z.resolve("WordEditor.Bookmark.FullBookmarkManager").FYm()&&ab.StaticActiveAppFrame.za().kb.Qji();
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1)&&this.Z.resolve("WordEditor.Actors.MiniTemplateActor").Xb();ab.StaticActiveAppFrame.za().Ge();us.initialize();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.Z.resolve("WordEditor.Actors.ParagraphBorderActor").Xb();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",
!1)&&this.Z.resolve("WordEditor.Actors.ParagraphShadingActor").Xb();y.AFrameworkApplication.$c("KeyboardShortcutsDialog;KeyboardShortcutsDialogCf");(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeyboardShortcutsDialog",!1))&&this.Z.resolve("WordEditor.Actors.KeyboardShortcutsDialogActor").Xb()}dispose(){this.iId&&this.iId.dispose()}Ito(){this.Fd.er.isCompleted?this.Fd&&this.Fd.isFeatureEnabled(42)&&this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").Xb():
this.Fd.er.continueWith(()=>{this.Fd&&this.Fd.isFeatureEnabled(42)&&(this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").Xb(),ab.StaticActiveAppFrame.za().Ge())})}get Rpn(){if(null==this.JEd)if(this.Fd)if(this.Fd.er.isCompleted)this.JEd=this.Fd.isFeatureEnabled(2);else return!1;else this.JEd=!1;return this.JEd}wc(b){var h,r,A,L;this.Z=b;this.Fd=b.Oa("Box4.IFeatureHelper");this.uZ=this.Z.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.uZ.q$c=y.AFrameworkApplication.J.$("WordProofingSecondaryContextualMenuIsEnabled")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new kO).wc(b);b.ia("Box4.IClipboardCommands",()=>new lO(y.AFrameworkApplication.va,vb.a.clf,vb.a.eUc,vb.a.s6,vb.a.Mig,vb.a.paste,vb.a.P3,vb.a.xwb)).ha();b.ia("HtmlImport.IHtmlNormalizerSettings",()=>{const Z=b.resolve("Common.IAppSettingsManager");return new JC(!0,Z.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia("HtmlImport.IHtmlTranslatorSettings",()=>{const Z=b.resolve("Common.IAppSettingsManager"),
oa=Ba=>!Ba.ync;return new iO(Z.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,Z.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,Ba=>Ba.ync,()=>!1,oa,oa,oa,oa,void 0,()=>this.Rpn,Ba=>!Ba.ync)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new PO(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();
b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new xN(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new mO).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ia("Box4.IIndentationCommands",()=>new nO(y.AFrameworkApplication.va)).ha();b.ia("Box4.IJustificationCommands",
()=>new oO(y.AFrameworkApplication.va)).ha();b.ia("Box4.ISpacingCommands",()=>new pO(y.AFrameworkApplication.va)).ha();b.ia("WordEditor.IPageCommands",()=>new vN(y.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.StylesActor",()=>new BN(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"))).ha();b.ia("WordEditor.Actors.DigitalPrintActor",()=>new SL(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"))).ha();b.ia("WordEditor.Actors.FileDownloadManager",()=>new hN(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),
new eP.a)).ha();b.ia("WordEditor.Actors.FileDownloadActor",()=>new fN(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),y.AFrameworkApplication.J.$("DisablePrint"),y.AFrameworkApplication.J.jb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();b.ia("WordEditor.Actors.ParagraphDialogActor",()=>new wN(y.AFrameworkApplication.va,b.nf("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Tq.a.instance,
b.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("WordEditor.Actors.MarginsDialogActor",()=>new tN(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"),Tq.a.instance)).ha();b.ia("WordEditor.Actors.ColumnsDialogActor",()=>new JK(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"),Tq.a.instance)).ha();b.ia("WordEditor.Actors.ModeSwitcherControlActor",()=>new my.a(b.Ta("Common.ISystemInitiatedFeedback"),gP.a.F2c())).as("WordEditor.IModeSwitcherControl").ha();b.ia("WordEditor.Actors.PaperSizeDialogActor",
()=>new LO(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"),Tq.a.instance)).ha();b.ia("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new nN(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(dN,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ia("WordEditor.Actors.ProofingActor",()=>new yN(y.AFrameworkApplication.va,Be.a.instance,Wa.a.instance.resolve("Box4.ISelectionManager"),zy.a.instance,Wa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),
Wa.a.instance.resolve("Box4.ILanguageReader"),Wa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Wa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Wa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.uZ,Wa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),Wa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").OD.loadScript("EditorSettingsManager")).then(()=>{const Z=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");Z.I6m();Z.init();b.ia("Box4.Proofing.EditorSettingsUIActor",()=>new qO(y.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new rO(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();
y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&this.Z.resolve("Box4.Proofing.EditorSettingsUIActor").Xb()});b.ia("WordEditor.Actors.PageActor",()=>new KO(Wa.a.instance.resolve("Box4.IWordSectionEditor"),Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Wa.a.instance.resolve("WordEditor.IMainViewModeManager"),Wa.a.instance.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();
Object(wC.a)()&&b.ia("WordEditor.Actors.LineNumberingActor",()=>new cG(Wa.a.instance.resolve("WordEditor.IMainViewModeManager"))).ha();b.ia("WordEditor.Actors.DarkModeActor",()=>new OI(y.AFrameworkApplication.va,y.AFrameworkApplication.J,fP.a.Asa(),!!ed.a.instance&&ed.a.instance.iLa,!!ed.a.instance&&ed.a.instance.K$c,Wa.a.instance.resolve("Box4.IDarkModeState"),Wa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Wa.a.instance.resolve("Box4.DarkModeEventsManager"),!!ed.a.instance&&
ed.a.instance.LBa)).ha();b.ia("WordEditor.FlatListDetailsProvider",()=>new Pk(b.resolve("WordEditor.IFlatListEditor")));b.ia("WordEditor.Actors.AccessibilityActor",()=>new Uw(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.nf("WordEditor.FlatListDetailsProvider"),b.nf("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.nf("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ia("WordEditor.Actors.AppFrameCommandUIActor",()=>new xM(y.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha();
b.ia("WordEditor.Actors.ImageActor",()=>new ep(b.resolve("WordEditor.IImageEditor"),b.Ta("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),
y.AFrameworkApplication.J)).as("Box4.Actors.ImageActor").ha();b.ia("WordEditor.Actors.WordFileSaveAsActor",()=>new QO(y.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new $L(b.resolve("WordEditor.IImageEditor"),y.AFrameworkApplication.J,y.AFrameworkApplication.ua.eWa,Wa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.Actors.DeleteActor",()=>new bE(Wa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Wa.a.instance.Ta("Box4.ContentControlConfigSettings"),Wa.a.instance.Ta("Box4.IContentControlEditor"),Wa.a.instance.resolve("Box4.IDynamicRangeEditor"),Wa.a.instance.Ta("WordEditor.Bookmark.IBookmarkManager"),Wa.a.instance.resolve("Box4.IHyperlinkEditor"),Wa.a.instance.resolve("Box4.IHyperlinkStrategy"),Wa.a.instance.resolve("Box4.IParagraphReader"),
Wa.a.instance.resolve("Box4.IParagraphIndentationReader"),Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Wa.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();this.Z.ia("WordEditor.Actors.SWordRequestManager",()=>new DN(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),y.AFrameworkApplication.J)).as("WordEditor.Actors.ISWordRequestManager").ha();
b.ia("WordEditor.Actors.TableCellSelectionStrategy",()=>new bG).as("Box4.ITableCellSelectionStrategy").ha();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new sO(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ICharacterPropertiesEditor"),Be.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();b.ia("Box4.Actors.FormatPainterActor",()=>new GA(ab.StaticActiveAppFrame.za(),Sg.FocusManager.instance(),y.AFrameworkApplication.va,ih.a.instance,Bt.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!ed.a.instance&&
ed.a.instance.LBa,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ia("WordEditor.Actors.FormattingActor",()=>new qC(y.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ia("WordEditor.Actors.UIAutomationActor",()=>new dM(y.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.SaveStatusActor",()=>new PK(y.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();b.ia("Box4.Actors.IEnterViewStrategy",()=>new SM(b.Oa("Box4.IAutoCorrectScheduler"),b.nf("Box4.IUndoManager"),
b.Ta("Box4.IExternalSelectionManager"))).ha();b.ia("Box4.ISelectAllHandlers",()=>new oC(pl.PageReader.instance,b.nf("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ia("WordEditor.Actors.ContentControlActor",()=>new YM(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),y.AFrameworkApplication.va,y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ia("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new fL(y.AFrameworkApplication.va,b.nf("WordEditor.UI.IDialogFactory"),Sg.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new tO).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new NL(y.AFrameworkApplication.Fe,Object(so.a)(),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Wa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),y.AFrameworkApplication.J,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();
b.ia("WordEditor.Actors.GraphicsEditorActor",()=>new kN(y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),y.AFrameworkApplication.Fe,
this.Fd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new aM).ha();b.ia("WordEditor.Actors.CustomTabActor",()=>new VF(y.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).ha();b.ia("WordEditor.Actors.HeadingsActor",()=>new lN(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),y.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();
b.ia("WordEditor.Actors.BookmarkActor",()=>new zM(ab.StaticActiveAppFrame.za(),y.AFrameworkApplication.va,If.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.hd),this.Z.resolve("Box4.Indicator.IIndicatorManager"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Common.IReactContextualUILauncher"),this.Z.resolve("WordEditor.Actors.BookmarkIndicatorActor"),zy.a.instance,this.Z.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),
Object(Kb.a)(),this.Z.nf("WordEditor.UI.IDialogFactory"),this.Z.resolve("Box4.BookmarkParagraphMapping"),Be.a.instance)).ha();b.ia("WordEditor.Actors.BookmarkIndicatorActor",()=>new Av(b.resolve("Box4.IParagraphReader"),jg.a.instance,this.Z.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),new rg.a(()=>ab.StaticActiveAppFrame.za().kb.Qc))).ha();qu.a.ftb&&b.ia("WordEditor.Actors.ExpandCollapseIndicatorActor",()=>new KA(Zf.a.instance,jg.a.instance,Object(Kb.a)(),
b.resolve("Box4.IExpandCollapseActionHandler"))).ha();b.ia("Box4.Actors.IIFrameFocusStrategy",()=>new mN).ha();b.ia("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new dE(If.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Object(Kb.a)(),rd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ia("WordEditor.Actors.ExternalContentActor",()=>new Xr(y.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.J,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").ha();b.ia("Box4.UI.ExternalContentFloatieManager",()=>new xO).as("Box4.UI.IFloatieManager").ha();b.ia("WordEditor.Actors.ActionHangDetector",()=>new gL(y.AFrameworkApplication.J,y.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ia("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new Vw(b.resolve("Box4.UI.ExternalContentFloatieManager"),
b.resolve("Box4.IExternalContentFloatieEventSource"),Object(Kb.a)(),mu.a.instance(),y.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),ed.a.jf.Tl.qf(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",()=>new FN).as("Box4.Actors.IIndentationActorExtension").ha();y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia("WordEditor.Actors.ModernUxActor",()=>new XL(y.AFrameworkApplication.va)).ha();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia("WordEditor.Actors.SwitchToClassicViewModeActor",()=>
new bM(y.AFrameworkApplication.va)).ha();(new QM).wc(b);b.ia("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new wO(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ia("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new JI(y.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),new ck.b)).ha();b.ia("WordEditor.OnlineMedia.OnlineMediaActor",()=>new vO(y.AFrameworkApplication.va,
y.AFrameworkApplication.J,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),Be.a.instance,b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),y.AFrameworkApplication.J.$("GetCustomHeaderEnabled")?Wa.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",
!1)?b.resolve("Common.IExternalUICommandDefinitionMapping"):void 0)).ha();(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1))&&b.ia("WordEditor.Actors.MiniTemplateActor",()=>new uN(y.AFrameworkApplication.va,b.Ta("WordEditor.Extension.IInsertApiOperations"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.ITableEditor"),b.resolve("Box4.IOutlineElementEditor"))).ha();
null!==(A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.$("PageLoadStatsDialogIsEnabled"))&&void 0!==A&&A&&d.e(14).then(d.bind(null,2185)).then(Z=>{(new Z.PageLoadStatsActor(()=>b.resolve("WordEditor.IStatusBarUser"))).Xb()});this.fpk=new Gr;this.dZ=this.Z.resolve("Box4.Highlight.IHighlightManager");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.Z.ia("WordEditor.Actors.ParagraphBorderActor",()=>new SK(y.AFrameworkApplication.va,
Bq.a.instance,this.Z.resolve("WordEditor.ParagraphEditors.IParagraphBorderEditor"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1)&&this.Z.ia("WordEditor.Actors.ParagraphShadingActor",()=>new Gu(y.AFrameworkApplication.va,Bq.a.instance,this.Z.resolve("Box4.UI.RecentColorsSectionHandler"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphShadingEditor"),
this.Z.resolve("WordEditor.ParagraphEditors.IParagraphShadingReader"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();y.AFrameworkApplication.$c("KeyboardShortcutsDialog;KeyboardShortcutsDialogCf");(null===(L=y.AFrameworkApplication.J)||void 0===L?0:L.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeyboardShortcutsDialog",!1))&&b.ia("WordEditor.Actors.KeyboardShortcutsDialogActor",()=>new RO(y.AFrameworkApplication.va)).ha()}static main(){E.a.instance.Mc(new TK)}}Object(u.a)(TK,"WordEditorActorsPackage",
null,[0,1]);class HN{constructor(b){this.sEd=!1;this.Nkj=()=>{this.sEd=!0;this.ru.Nte(this.Nkj)};this.ru=b;this.ru.cmb(this.Nkj)}}Object(u.a)(HN,"GraphFullyConnectedGetter",null,[408]);class gg{constructor(){this.Nsh=Object.assign(new wq.a,{})}dWk(b,h){let r;const A=b&1023;({value:r}=this.Nsh.Ec(A,0)).returnValue||gg.VSm().contains(A)||v.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,A);r+=h;this.Nsh.W(A,r);return r}static VSm(){gg.pNd||(gg.pNd=new Oa.a,gg.qc(0),
gg.qc(1),gg.qc(2),gg.qc(3),gg.qc(4),gg.qc(5),gg.qc(6),gg.qc(7),gg.qc(8),gg.qc(9),gg.qc(10),gg.qc(11),gg.qc(12),gg.qc(13),gg.qc(14),gg.qc(15),gg.qc(16),gg.qc(17),gg.qc(18),gg.qc(19),gg.qc(20),gg.qc(21),gg.qc(22),gg.qc(23),gg.qc(24),gg.qc(25),gg.qc(26),gg.qc(27),gg.qc(28),gg.qc(29),gg.qc(30),gg.qc(31),gg.qc(32),gg.qc(33),gg.qc(34),gg.qc(35),gg.qc(36),gg.qc(37),gg.qc(38),gg.qc(39),gg.qc(40),gg.qc(41),gg.qc(42),gg.qc(43),gg.qc(44),gg.qc(45),gg.qc(46),gg.qc(47),gg.qc(48),gg.qc(49),gg.qc(50),gg.qc(51),
gg.qc(52),gg.qc(53),gg.qc(54),gg.qc(55),gg.qc(56),gg.qc(57),gg.qc(58),gg.qc(59),gg.qc(60),gg.qc(61),gg.qc(62),gg.qc(63),gg.qc(64),gg.qc(65),gg.qc(66),gg.qc(67),gg.qc(68),gg.qc(69),gg.qc(70),gg.qc(71),gg.qc(72),gg.qc(73),gg.qc(74),gg.qc(75),gg.qc(76),gg.qc(77),gg.qc(78),gg.qc(79),gg.qc(80),gg.qc(81),gg.qc(82),gg.qc(83),gg.qc(84),gg.qc(85),gg.qc(86),gg.qc(87),gg.qc(88),gg.qc(89),gg.qc(90),gg.qc(91),gg.qc(92),gg.qc(93),gg.qc(94),gg.qc(95),gg.qc(96),gg.qc(97),gg.qc(98),gg.qc(99),gg.qc(100),gg.qc(101),
gg.qc(102),gg.qc(103),gg.qc(104),gg.qc(105),gg.qc(106),gg.qc(107),gg.qc(108),gg.qc(109),gg.qc(110),gg.qc(111),gg.qc(112),gg.qc(113),gg.qc(114),gg.qc(115),gg.qc(116),gg.qc(117),gg.qc(118),gg.qc(119),gg.qc(120),gg.qc(121),gg.qc(122),gg.qc(124),gg.qc(126),gg.qc(127),gg.qc(128),gg.qc(129),gg.qc(130),gg.qc(131),gg.qc(132),gg.qc(133),gg.qc(134),gg.qc(135),gg.qc(136),gg.qc(140),gg.qc(145),gg.qc(146),gg.qc(147));return gg.pNd}static qc(b){gg.pNd.add(b&1023)}}gg.pNd=null;Object(u.a)(gg,"LanguagePerParagraphModel",
null,[]);class UK{constructor(){this.wBg=!1;this.QUd=this.PUd=this.e3b=0;this.y3i=!0;this.bLp=0}}Object(u.a)(UK,"UpdateWordCountStateResult",null,[]);class IN extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(u.a)(IN,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class JN{constructor(){this.B0h=this.A0h=this.wordCount=-1;this.cOb=this.YWh=0;this.bOb=1;this.orj=1033}}Object(u.a)(JN,"WordCountCache",null,[]);class KN extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(u.a)(KN,"WordCountChangedEventArg",Sys.EventArgs,[]);class TO{constructor(){this.tBc=this.cIa=0}}Object(u.a)(TO,"CharsCountResult",null,[]);class UO{constructor(){this.cp=0;this.xBc=null;this.Z$=this.aaa=0}}Object(u.a)(UO,"TextChunkResult",null,[]);class VK{constructor(){this.Kbk=this.aaa=this.Z$=this.wordCount=0}}Object(u.a)(VK,"WordCountStateForParagraph",null,[]);class eM{constructor(){this.Jca=this.zL=this.aaa=this.Z$=this.YU=this.wordCount=0;this.currentNode=null;this.f_=-1;this.cp=
0;this.ejg=[];this.bOb=this.cOb=this.$5a=this.$ig=this.ajg=0;this.sK=this.dYi=!1;this.hBb=new nb.a;this.Hab=new nb.a}}Object(u.a)(eM,"WordCountState",null,[]);class dq{constructor(b,h,r,A,L,Z){this.pdp=1E3;this.sa=new Bf.a;this.SJb=null;this.aJe=0;this.mwk="\ue000";this.DGc=!1;this.nOe=this.eOe=this.ezd=0;this.mdh=this.udh=null;this.aOe=this.$Ne=this.hOe=0;this.mXl=oa=>{this.SJb=null;this.Axf(oa.ao)};this.tJ=h;this.tuk=new RegExp(On.AParagraphNode.RB,"g");this.Pd=b;this.Zi=A;this.$m=r;this.j5a=Z;
this.C2a=L.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.qMk=L.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.dGj()}get cwn(){return!!this.SJb}get CUa(){return this.DGc}set CUa(b){this.DGc=b}get nQd(){return this.aJe}set nQd(b){this.aJe=b}get sXa(){return!this.aJe}get EA(){return this.ezd}get gNb(){return this.eOe}get kNb(){return this.nOe}get $Ml(){return this.udh}get Ztf(){return this.mdh}get aYc(){return this.hOe}get ZXc(){return this.$Ne}get $Xc(){return this.aOe}cmb(b){this.sa.addHandler(dq.dGe,
b)}Nte(b){this.sa.removeHandler(dq.dGe,b)}Sff(b){this.sa.addHandler(dq.oNg,b)}QCo(b){this.sa.removeHandler(dq.oNg,b)}OZd(){this.NZd();this.dGj()}dGj(){this.hOe=this.aOe=this.$Ne=this.nOe=this.eOe=this.ezd=-1}cvf(){this.uAe(this.pdp)}hqd(){const b=new eM;b.dYi=!0;this.NZd();this.Axf(b)}uAe(b,h=null){this.sXa&&(this.cwn&&(h=null,this.NZd()),h||(h=new eM),b=new mf.a(3,1,b,this.mXl,this.v_j),b.ao=h,this.g0k(b))}NZd(){this.SJb&&(this.Zi.wf(this.SJb),this.SJb=null)}I9j(b,h,r,A,L,Z=!0,oa=-1,Ba=-1,gb=-1,
Ab=1033){const Jb=new UK;Jb.e3b=r;Jb.PUd=L;Jb.QUd=A;if(!b.cp&&h.eud&&Z&&!this.cFi(h))return dq.$Bp(b,h.eud),Jb.y3i=!0,Jb;A=0<=Ba&&0<=gb?{yd:Ba,endCp:gb}:void 0;r=this.Tgm(h,A);A&&(Ba=A.yd,gb=A.endCp);r=0<=gb?r.substring(0,gb):r;gb=0<=Ba&&0<=gb?r.substring(Ba,gb):r;A=b.cp>=Ba?b.cp:Ba;L=b.ejg||[];Z=0<b.ajg?b.ajg:0;let Tb=0<b.$ig?b.$ig:0,jc=[];b.sK=!1;do{this.j5a.update();if(!b.dYi&&(Jb.e3b+jc.length/2>dq.$Hp||this.j5a.pvb())){let Gd;L=(Gd=L).concat.apply(Gd,jc);b.cp=A;b.ejg=L;b.$ig=Tb;b.ajg=Z;b.f_=
oa;b.currentNode=h;this.uAe(dq.FLp,b);Jb.wBg=!0;b.sK=!0;return Jb}if((!A||A===Ba)&&0<r.length&&A<r.length){L.push(MC.a.instance.TNf(r,A));var Hc=this.cFi(h);if(0<=oa&&!A&&Hc){b.wordCount+=1;Jb.e3b+=1;const Gd=this.Pd.M2(Hc);Hc=this.tJ.ned(Gd,Hc);Hc=dq.PXd(Hc);b.aaa+=Hc.cIa+1;b.Z$+=Hc.cIa-Hc.tBc}}Hc=this.LJi(r,A,dq.Nql);A=Hc.cp;let hd;jc=(hd=jc).concat.apply(hd,Hc.xBc);Z+=Hc.aaa;Tb+=Hc.Z$}while(-1!==A);b=this.XTk(b,L,jc,r,gb,Jb.e3b,Jb.PUd,Jb.QUd,h,-1===oa,Ab);Jb.e3b=b.wordCount;Jb.PUd=b.Z$;Jb.QUd=
b.aaa;Jb.bLp=b.Kbk;return Jb}Xgi(b,h){const r=Cd.ParagraphReader.textLength(h,9);if(r){h=xl.e(h);var A=0;for(let L=0;L<h.length;L++)if(this.gsb&&5===h[L].Sh&&b.zL++,dq.G2o(h[L])){A++;break}h.length!==r?b.YU++:b.YU+=A}}eSj(b){this.nQd=this.f3o(b.$5a,b.wordCount)?1:0;return!!this.nQd}Woj(b){this.ezd=b.wordCount;this.eOe=b.zL;this.nOe=b.Jca;this.aOe=b.aaa;this.$Ne=b.Z$;this.hOe=b.YU;this.udh=b.hBb;this.mdh=b.Hab;this.jyj(b)}jyj(b){this.sa.raiseEvent(dq.dGe,new KN(b))}iyj(){this.sa.raiseEvent(dq.oNg,
new IN(!1))}f3o(b,h){if(aa.a.As||aa.a.au||aa.a.OF)return!1;(h/=2)||(h=1);return(h?b/h:0)>dq.qLn?!0:!1}get gsb(){const b=!this.W6f||1===this.W6f&&this.qMk;return this.C2a&&b}SBi(b,h){let r=1033,A=0;b=h.WJf(b);h=new gg;for(let L=0;L<b.length;L++){const Z=h.dWk(b[L].lcid,b[L].end-b[L].Dc);A<Z&&(A=Z,r=b[L].lcid)}return r}XTk(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){var Tb;h=(Tb=h).concat.apply(Tb,r);r=MC.a.instance.NJi(h,A);b.wordCount+=r.wordCount;L=dq.PXd(L);Tb=L.cIa-L.tBc;const jc=L.cIa;b.Z$+=Tb;b.aaa+=jc;Z+=r.wordCount;
oa+=L.cIa-L.tBc;Ba+=L.cIa;b.$5a+=r.$5a;const {lZl:Hc,lnp:hd}=dq.WTk(h,A);b.cOb+=Hc;b.bOb+=hd;b.Hab.add(Jb);b.hBb.add(r.wordCount);Ab&&dq.njl(jc,Tb,gb,r,Hc,hd,Jb);b.cp=0;b.ejg=[];b=new VK;b.Z$=oa;b.aaa=Ba;b.wordCount=Z;b.Kbk=r.wordCount;return b}Tgm(b,h){let r=this.yEo(b);r=Cd.ParagraphReader.Hpb(b,9,r,h);return this.Dzo(r)}yEo(b){var h=Cd.ParagraphReader.text(b);b=xl.e(b);if(0<b.length){h=h.split("");for(let A=0;A<b.length;++A){let L=!0;var r=!0;const Z=b[A];if(1===Z.Sh)r=Z,r=22!==r.kind&&2!==r.kind;
else if(5===Z.Sh)L=!1;else if(7===Z.Sh||10===Z.Sh)h[Z.Ib.cp]=this.mwk,L=!1;if(L){if(Z.Ib.cp>=h.length)return"";h[Z.Ib.cp]=r?" ":"C"}}h=h.join("")}return h}Dzo(b){return b.replace(this.tuk,"")}LJi(b,h,r){const A=b.length-h<=r;var L=A?b.length:h+r;const Z=new UO;if(L<h)return Z.cp=-1,Z;Z.xBc=MC.a.instance.vGf(b,h,L);L=dq.PXd(b.substr(h,L));Z.aaa=L.cIa;Z.Z$=L.cIa-L.tBc;if(!Z.xBc.length&&!A)return r===b.length-h?Z:this.LJi(b,h,b.length-h);Z.cp=A||!Z.xBc.length?-1:Z.xBc[Z.xBc.length-1].cp;return Z}g0k(b){this.SJb=
b;this.Zi.$b(this.SJb)}cFi(b){b=sf.ListItemReader.De?b:b.hE;if(sf.ListItemReader.isListItem(b)){const h=this.Pd.M2(b);if(null===h||void 0===h?0:h.Uz)return b}return null}static G2o(b){return 11===b.Sh}static $Bp(b,h){b.wordCount+=h.wordCount;b.Z$+=h.A0h;b.aaa+=h.B0h;b.$5a+=h.YWh;b.cOb+=h.cOb;b.bOb+=h.bOb;b.Hab.add(h.orj);b.hBb.add(h.wordCount)}static njl(b,h,r,A,L,Z,oa){const Ba=new JN;Ba.wordCount=A.wordCount;Ba.B0h=b;Ba.A0h=h;Ba.YWh=A.$5a;Ba.cOb=L;Ba.bOb=Z;Ba.orj=oa;r.eud=Ba}static PXd(b){const h=
b.length,r=new TO;for(let L=0;L<h;L++){var A=b.charCodeAt(L);r.cIa++;if(55296<=A&&56319>=A&&(A=L+1<h?b.charCodeAt(L+1):0,56320<=A&&57343>=A)){L++;continue}F.a.bga(b.charAt(L))&&r.tBc++}return r}static WTk(b,h){let r=0,A=0;for(let L=0;L<b.length;++L){const Z=b[L],oa=Z.RN;(3===oa||2===oa)&&Z.cp<h.length&&(++r,F.a.Gnc(h.charCodeAt(Z.cp))&&++A)}return{lZl:A,lnp:r}}}dq.dGe="wctek";dq.oNg="wcac";dq.FLp=1;dq.Nql=400;dq.$Hp=90;dq.qLn=.1;Object(u.a)(dq,"WordCountManagerBase",null,[420]);class LN extends dq{constructor(b,
h,r,A,L,Z,oa,Ba,gb,Ab,Jb){super(b,h,r,L,gb,Ab);this.iqi=this.FNd=this.Spa=null;this.xYa=()=>{this.cvf()};this.ib=A;this.zd=oa;this.YGh=Ba;this.LK=Jb;this.ib.AB(this.xYa);this.pXe=gb.$("ReadingTimeIsEnabled")}get v_j(){return 66}t9m(){if(this.Spa)return!0;if(!this.ib||!this.ib.gb)return this.zd&&(ed.a.isClosing||y.AFrameworkApplication.Yl?this.zd.fc("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.zd.fc("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.ib.gb.clone();this.Spa=b.ZT(!0);if(!this.Spa||!this.Spa.$U())return this.NZd(),!1;this.YGh&&(this.FNd=this.YGh.create(h=>b.ZT(h),this.$m));this.Spa.moveNext();return!0}get W6f(){return 1}JAl(b){return b===kc.a.Cd||b===kc.a.paragraph?!0:this.gsb&&(b===kc.a.ZOb||b===kc.a.image||b===kc.a.L$)}Axf(b){this.j5a.reset();if(this.t9m()){for(this.gsb&&this.FNd&&(this.FNd.iXl(b,this.j5a)||this.uAe(1,b));this.Spa.current;){const A=-1===b.f_?0:b.f_;let L=0;var h=this.Spa.current;if(!this.JAl(h.contextId)){this.Spa.moveNext();
continue}if(this.gsb&&Id.a.z$a(h)){b.zL++;this.Spa.moveNext();continue}if(!Cd.ParagraphReader.Wb(h.node)){this.Spa.moveNext();continue}const Z=h.node;if(this.CUa&&this.iqi&&this.iqi.V8a(Z))this.Spa.moveNext();else{if(this.gsb&&h.isValid){var r=hb.a.eb(Z);for(r.Vb(6);!r.xs;)Id.a.Eq(r.currentNode)&&b.zL++,r.Ci(6)}r=this.pXe?this.SBi(Z,this.LK):1033;h=this.I9j(b,Z,0,0,0,this.Lde(h),A,h.cpBegin,h.cpEnd,r);if(h.y3i&&(L+=1,100<L)){b.f_=A+1;this.uAe(1,b);return}if(h.wBg)return;this.Xgi(b,Z);this.Spa.moveNext()}}this.FNd=
this.Spa=null;this.eSj(b)?(this.ezd=-1,this.iyj()):this.Woj(b)}}Lde(b){let h=!1;b.contextId===kc.a.paragraph?h=!0:b.contextId===kc.a.Cd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(u.a)(LN,"SelectionWordCountManager",dq,[]);class WK{constructor(b,h){this.Q7b=!1;this.$Ib=null;b&&h&&(this.Gac=b(!1),this.fd=h,this.Gac.moveNext())}iXl(b,h){if(!b||!this.Gac||!this.Gac.current)return!0;do{const r=this.Gac.current;if(r.contextId===kc.a.Mu||r.contextId===kc.a.ix){for(this.$Ib||this.D9m(r.node);this.$Ib.moveNext();)if(14===
this.$Ib.currentNode.type&&b.Jca++,h.update(),h.pvb())return!1;this.gDl(r,b);this.$Ib=null}this.Gac.moveNext()}while(this.Gac.current);return!0}gDl(b,h){const r=this.fd.mg(b.node);r.zb(14);b.contextId===kc.a.Mu&&(Vm.a.RXi(r)&&(this.Q7b=!0),Vm.a.iee(r)&&this.Q7b&&(this.Q7b=!1,h.Jca++));b.contextId===kc.a.ix&&($g.TableCellReader.b9c(r)&&(this.Q7b=!0),$g.TableCellReader.XWa(r)&&this.Q7b&&(this.Q7b=!1,h.Jca++))}D9m(b){this.$Ib=Dd.a.Bo(b);14===b.type?this.$Ib.zp(WK.o0c,b):this.$Ib.zp(WK.o0c,null)}static o0c(b){return b.parentNode?
!0:!1}}Object(u.a)(WK,"TableCountSelectionTraverser",null,[421]);class MN{constructor(b){this.C2a=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.C2a?new WK(b,h):null}}Object(u.a)(MN,"TableCountSelectionTraverserFactory",null,[403]);class fM extends dq{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb){super(b,h,r,L,gb,Ab);this.bIp=Tb=>{if(Tb.xs)return!0;Tb=Tb.role;return 1===Tb||2===Tb||this.gsb&&6===Tb||3===Tb||4===Tb||5===Tb||!this.CUa&&(7===Tb||8===Tb)};this.ga=A;this.hIk=
Z;this.fRk=oa;this.Vch=Ba;this.LK=Jb;this.ga.fb(Ec.a.Ibk,kc.a.application,Vd.ActionManager.eg,64);this.ga.fb(Ec.a.Jbk,kc.a.application,Vd.ActionManager.eg,64);this.pXe=gb.$("ReadingTimeIsEnabled")}get v_j(){return 63}get W6f(){return 0}Axf(b){this.j5a.reset();b.sK=!1;var h=this.hIk();pl.PageReader.instance.vTb(h)||(this.OZd(),this.iyj());h=this.$m.osa(h,7,7).currentNode;var r=this.fHl(b.currentNode,h);h=this.fRk(r,h);h.zp(this.bIp,null);let A=r=0;for(var L=0;h.moveNext();){if(h.currentNode&&(!sf.ListItemReader.De||
!OE.a.wee(h.currentNode))&&sf.ListItemReader.isListItem(h.currentNode)){var Z=this.Pd.M2(h.currentNode);if(Z.Uz){var oa=sf.ListItemReader.De?h.currentNode:this.Pd.CVa(h.currentNode);if(oa&&(oa=oa.ra.last,(null===oa||void 0===oa?0:oa.ni)&&(Fl.a.F8&&oa.Yh||oa.BU)))continue;b.wordCount+=1;if(Z=this.tJ.ned(Z,h.currentNode))Z=dq.PXd(Z),b.aaa+=Z.cIa+1,b.Z$+=Z.cIa-Z.tBc;r+=1;A+=b.aaa;L+=b.Z$}if(!sf.ListItemReader.De)continue}if(this.gsb&&h.currentNode&&Id.a.Eq(h.currentNode))b.zL++;else if(this.gsb&&h.currentNode&&
si.TableReader.kP(h.currentNode))b.Jca++;else if(h.currentNode&&Cd.ParagraphReader.Wb(h.currentNode)){Z=h.currentNode;oa=this.pXe?this.SBi(Z,this.LK):1033;L=this.I9j(b,Z,r,A,L,!0,-1,-1,-1,oa);if(L.wBg){b.sK=!0;return}this.Xgi(b,Z);r=L.e3b;A=L.QUd;L=L.PUd}}this.eSj(b)?(this.OZd(),this.tFo(),this.jyj(b)):this.Woj(b)}fHl(b,h){b?(b=this.Vch(b),b.zb(7)):b=this.Vch(h);return b}tFo(){switch(this.nQd){case 1:this.ga.Ob(Ec.a.Ibk,2);break;case 2:this.ga.Ob(Ec.a.Jbk,2)}}}Object(u.a)(fM,"TotalWordCountManager",
dq,[]);class NN{constructor(){this.eLj=this.dLj=this.jwg=this.fLj=this.I1j=this.J1j=this.G1j=this.H1j=0}get Phj(){return this.akc(this.fLj,this.J1j,"WC")}get $Tn(){return this.akc(this.dLj,this.G1j,"NumCharsNoSp")}get aUn(){return this.akc(this.jwg,this.H1j,"NumCharsWithSp")}get fUn(){return this.akc(this.eLj,this.I1j,"NumParagraphs")}akc(b,h,r){const A=this.Ltd(h,r).toLocaleString();return 0<this.jwg?(b=this.lMg(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),
A)):A}lMg(b,h,r){b=this.Ltd(b,r);return b>h?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}Ltd(b,h){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(u.a)(NN,"DocumentStats",null,[]);class gM{static asf(b){return Dg.a.uy(gM.lo,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.Phj,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.$Tn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.aUn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,
b.fUn)}}gM.lo="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(u.a)(gM,"DocumentStatsDialogHtml",null,[]);class VO extends Dg.a{constructor(b){super();this.TV=!1;this.RXl=()=>{};this.MH=b}Q7o(){this.Ig="DocumentStatsDialog";this.mh=gM.asf(this.MH);this.Bd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.RXl);this.x8("DocumentStatsTable")}Jba(){}dispose(){this.TV||(super.dispose(),this.TV=!0)}}Object(u.a)(VO,"DocumentStatsDialog",Dg.a,[]);class WO{constructor(b,h,r,A,L,Z,oa,Ba,gb){this.$Fh=this.oIc=this.DGc=this.P7b=this.qYe=
!1;this.Ssc=()=>{this.UEe()};this.Bga=()=>{this.UEe()};this.f_o=()=>{this.$Fh=!0;return 32};this.bog=()=>this.ru.sXa?32:8;this.djd=(Ab,Jb,Tb,jc,Hc)=>{if(1===Tb)return this.ru.sXa?32:8;Hc[Tg.a.On]=this.b1f;return 32};this.DCe=(Ab,Jb,Tb)=>{if(1===Tb)return this.ru.sXa?32:8;this.b1f?this.RUl():this.i0l();ab.StaticActiveAppFrame.za().eJ({ShowWordCount:"CheckboxModel"});return 32};this.Xxc=(Ab,Jb,Tb)=>{if(1===Tb)return Yj.a.iba(Jb)?8:this.ru.sXa?32:8;if(this.$Fh)return y.AFrameworkApplication.va.Ob(Ec.a.boe,
2),32;Ab=this.ee.Xf("UserAction","Show Word Count Dialog");Ab.start();this.ru.hqd();this.rT.hqd();this.ru.EA!==this.rT.EA?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Jb=this.vFl();(new VO(Jb)).Q7o();Ab.stop();return 32};this.nid=(Ab,Jb,Tb,jc,Hc)=>{Hc||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===Tb)return 32;if(!this.ru.sXa)return Hc[Um.a.Visible]=
!1,32;Hc[Um.a.Visible]=!0;this.b1f?(Ab=this.ru.EA,0>Ab?Ab=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Ab?(Jb=this.rT?this.rT.EA:-1,Ab=0<Jb?this.DKm(Ab,Jb):String.format(1===Ab?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.xve(Ab))):Ab=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.xve(Ab))):Ab=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Hc[Um.a.LabelText]=Ab;return 32};
this.JNe=oa;this.KNe=Z;this.ru=b;this.rT=h;this.MIb=r;this.SOk=L;this.rT.Sff(this.Ssc);this.ru.Sff(this.Ssc);this.rT.cmb(this.Bga);this.ru.cmb(this.Bga);this.ee=Ba;this.CUa=A;this.C2a=gb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Suf(){return!aa.a.C7}Xb(){const b=y.AFrameworkApplication.va;b.qa(Ec.a.DCe,kc.a.application,this.DCe);b.qa(Ec.a.Xxc,kc.a.view,this.Xxc);b.fb(Ec.a.djd,kc.a.application,this.djd,96);b.fb(Ec.a.nid,kc.a.application,this.nid,96);b.fb(Ec.a.bog,kc.a.application,
this.bog,96);b.qa(Ec.a.iji,kc.a.application,this.f_o)}get CUa(){return this.DGc}set CUa(b){this.DGc=b;this.ru.CUa=b;this.rT.CUa=b}i0l(){this.ru.sXa&&(this.RQj(!0),this.UEe(),this.ru.hqd())}vFl(){const b=new NN;b.J1j=this.ru.EA;b.H1j=this.ru.$Xc;b.G1j=this.ru.ZXc;b.I1j=this.ru.aYc;b.fLj=this.rT.EA;b.dLj=this.rT.ZXc;b.jwg=this.rT.$Xc;b.eLj=this.rT.aYc;return b}orm(){return this.JNe("WACWordCountEnabled",this.Suf)}Qwe(b){this.KNe("WACWordCountEnabled",b?"true":"false",Pc.a.$Xa)}get b1f(){this.P7b||(this.qYe=
this.orm(),this.P7b=!0);return this.qYe}RQj(b){this.Qwe(b);this.qYe=b;this.P7b=!0}RUl(){this.ru.OZd();this.rT.OZd();this.RQj(!1);this.UEe()}get yH(){return null!=this.X3g?this.X3g:this.X3g=(()=>this.MIb())()}UEe(){this.oIc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.OLl()),this.oIc=!0);this.yH&&this.yH.aV(this.SOk)}OLl(){const b={["words"]:this.ru.EA,["charsWithSpaces"]:this.ru.$Xc,["charsWithNoSpaces"]:this.ru.ZXc,["paragraphs"]:this.ru.aYc};this.C2a&&(b.images=this.ru.gNb,
b.tables=this.ru.kNb);return b}xve(b){try{return b.toLocaleString()}catch(h){v.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}DKm(b,h){h>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.xve(h),this.xve(b))}}Object(u.a)(WO,"WordCountActor",
null,[]);class XO extends Nv.a{constructor(b,h,r,A){super();this.BN=(L,Z)=>{if(Z.property===Ke.a.zn||Z.property===Ke.a.Sn)L=Z.node,Z=Fl.a.hm.kb.Qc,Z.ow&&Z.vd&&Z.vd.Hc&&L.Hc&&L.Hc.id===Z.vd.Hc.id&&this.xki(L)};this.hmj=(L,Z)=>{this.xki(Z.node)};this.Z0n=(L,Z)=>{Z.property!==Od.a.cC&&Z.property!==Vc.a.$w||this.r0()};this.Wle=()=>{this.r0()};this.P9=b;this.ru=h;this.Gm=r;this.C2a=A.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}$A(){var b=this.Gm.qf(12);b.Qo(this.BN);b.ut(this.hmj);b.ly(this.hmj);
b=this.Gm.qf(22);b.Qo(this.Z0n);b.ut(this.Wle);b.ly(this.Wle);this.C2a&&this.kwo();this.P9.Zua(this,7)}kwo(){var b=[19,14];for(const h of b)b=this.Gm.qf(h),b.ut(this.Wle),b.ly(this.Wle)}get index(){return 1}run(){this.ru.cvf()}xki(b){b.eud=null;this.r0()}}Object(u.a)(XO,"WordCountAppEventCoordinator",Nv.a,[]);class hM{}hM.YTk="AccurateWordCountButton";Object(u.a)(hM,"WordCountConstants",null,[]);class vl{constructor(b,h){this.ru=b;this.rT=h}getInstance(b){switch(b){case 1:return this.rT;case 0:return this.ru;
default:return this.ru}}}Object(u.a)(vl,"WordCountManagerFactory",null,[324]);class iM{constructor(){this.Z=null}get name(){return"WordEditor.WordCount"}wc(b){this.Z=b;const h=this.Z.resolve("Common.IAppSettingsManager");this.Z.ia("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new MN(h)).ha();this.Z.ia("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new tm.a(10,rd.a.Je);const A=new fM(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),new Xi.a,y.AFrameworkApplication.va,
y.AFrameworkApplication.pc,()=>Fl.a.hm.kb.Qc.vd,Dd.a.At,hb.a.eb,h,r,Wa.a.instance.resolve("Box4.ILanguageReader"));r=new LN(Wa.a.instance.resolve("Box4.List.IListReader"),Wa.a.instance.resolve("Box4.IListMarkerUtility"),new Xi.a,If.a.instance,y.AFrameworkApplication.pc,ru.a.instance,ih.a.instance,Wa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,r,Wa.a.instance.resolve("Box4.ILanguageReader"));return new vl(A,r)}).ha();this.Z.ia("WordEditor.WordCount.GraphFullyConnectedGetter",
()=>new HN(this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=ab.StaticActiveAppFrame.za().kb;b.uBa?this.qva():b.Qja(()=>{this.qva()})}qva(){if(ed.a.jf){var b=ed.a.jf.Tl;if(b){this.Z.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),A=Wa.a.instance.resolve("Common.IAppSettingsManager");
(new WO(h,r,()=>Wa.a.instance.Oa("WordEditor.IStatusBarUser"),this.nqm(),hM.YTk,Pc.a.q_a,Pc.a.oAa,Wa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),A)).Xb();(new XO(Kp.a.instance,h,b,A)).$A();h.cvf()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}nqm(){var b=Fl.a.hm.kb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=
b.Qc;if(!b)return v.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.vd;return b?b.ka(Vc.a.CUa,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){E.a.instance.Mc(new iM)}}Object(u.a)(iM,"PackageManager",null,[0,1]);var kP=d(2132);class XI{constructor(b){this.Q6e=null;b.Ta("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.Q6e=h})}vNj(b){this.Q6e&&this.Q6e.tJf().handleDocumentContentAugloopAnnotation(b)}}Object(u.a)(XI,"DocumentContentExtractionManager",null,[361]);class Yh{}
Yh.$ap="mso_smartLookup";Yh.channelId="SmartLookup";Yh.Zap="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Yh.eWj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Yh.fWj="https://uci.cdn.office.net/mirrored/smartlookup/";Yh.Yap="https://hedwigtestserver.blob.core.windows.net/builds/";Yh.Xap="http://localhost:8080/";Yh.Kpd="current";Yh.dWj="next";Yh.I9n=2;Yh.ktc=1;Yh.ltc=CommonUIStrings.L_SmartLookupPaneTitle;Yh.BD="InsightsTaskPane";Yh.dGg="InsightsTaskPaneData";Yh.MSf=
"InsightsContentFrame";Yh.width=400;Yh.ONn="ApplicationPropertiesRequest";Yh.ZNn="SelectionRequest";Yh.UNn="PageRendered";Yh.NNn="ApplicationProperties";Yh.YNn="Selection";Yh.aOn="Telemetry";Yh.$Nn="TakeFocus";Yh.TNn="LostFocus";Yh.QNn="Keyboard";Yh.RNn="LegalAgreed";Yh.XKp="WordWac";Yh.b6n="OneNoteWAC";Yh.xig="yes";Yh.H_j="appCorrelationId";Yh.Ejp="clientCorrelationId";Yh.I_j="message";Yh.s6i="Microsoft::Office::Insights::LegalAgreed";Object(u.a)(Yh,"InsightsConstants",null,[]);var XK=d(1598);class iE{}
Object(u.a)(iE,"ActivityContractInfo",null,[]);class lt{}Object(u.a)(lt,"BrowserPaneDataField",null,[]);class xz{}Object(u.a)(xz,"BrowserPaneTelemetryEvent",null,[]);class Sl{static fB(b,h){const r=new xz;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new iE,{success:!0});const A=[],L=new lt;L.name="Message";L.dataType=0;L.value=b;b=new lt;b.name="Level";b.dataType=0;b.value=Sl.getLevelString(h);Array.add(A,L);Array.add(A,b);r.dataFields=A;Sl.sendTelemetryEvent(r)}static xLj(b,
h){const r=new xz;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new iE,{success:!0});b=[];const A=new lt;A.name="AppCorrelationId";A.dataType=0;A.value=h;Array.add(b,A);r.dataFields=b;Sl.sendTelemetryEvent(r)}static cQo(b,h,r,A,L,Z){const oa=new xz;oa.eventName="LaunchPaneWithError";oa.isActivity=!1;oa.activityContract=Object.assign(new iE,{success:!0});const Ba=[],gb=new lt;gb.name="IsNetworkConnected";gb.dataType=0;gb.value=b?"true":"false";b=new lt;b.name="IsHostruntimeAvailable";
b.dataType=0;b.value=h?"true":"false";h=new lt;h.name="EntryPoint";h.dataType=0;h.value=r;r=new lt;r.name="RuntimeVersion";r.dataType=0;r.value=A;A=new lt;A.name="IsFirstRelease";A.dataType=1;A.value=L?"true":"false";L=new lt;L.name="IsZeroTerm";L.dataType=1;L.value=Z?"true":"false";Z=new lt;Z.name="IsClientSideRendering";Z.dataType=1;Z.value="false";Array.add(Ba,gb);Array.add(Ba,h);Array.add(Ba,b);Array.add(Ba,r);Array.add(Ba,A);Array.add(Ba,L);Array.add(Ba,Z);oa.dataFields=Ba;Sl.sendTelemetryEvent(oa)}static nwg(b,
h,r){const A=new xz;A.eventName="CDNDownloadLatency";A.isActivity=!0;A.activityContract=Object.assign(new iE,{duration:r,success:!0});r=[];const L=new lt;L.name="CDNHostname";L.dataType=0;L.value=b;b=new lt;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,L);Array.add(r,b);A.dataFields=r;Sl.sendTelemetryEvent(A,1)}static rwc(b,h,r,A,L,Z,oa,Ba){const gb=new xz;gb.eventName="LaunchPane";gb.isActivity=!0;gb.activityContract=Object.assign(new iE,{duration:h,success:!0});h=[];const Ab=new lt;Ab.name=
"AppCorrelationId";Ab.dataType=0;Ab.value=b;b=new lt;b.name="EntryPoint";b.dataType=0;b.value=r;r=new lt;r.name="IsServerSideRendering";r.dataType=1;r.value="true";const Jb=new lt;Jb.name="UxVersion";Jb.dataType=0;Jb.value=A;A=new lt;A.name="FeatureGates";A.dataType=0;A.value=L;L=new lt;L.name="IsFirstRelease";L.dataType=1;L.value=Z?"true":"false";Z=new lt;Z.name="IsZeroTerm";Z.dataType=1;Z.value=oa?"true":"false";oa=new lt;oa.name="IsClientSideRendering";oa.dataType=1;oa.value=Ba?"true":"false";
Array.add(h,Ab);Array.add(h,b);Array.add(h,r);Array.add(h,Jb);Array.add(h,A);Array.add(h,L);Array.add(h,Z);Array.add(h,oa);gb.dataFields=h;Sl.sendTelemetryEvent(gb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Sl.HEn(b.eventName);else{var r=-1<b.eventName.indexOf(Sl.G_j)?b.eventName:Sl.G_j+b.eventName,A=Sl.qpm(b.dataFields);b.isActivity?(b=Object.assign(new Ia.a,{name:r,samplingPolicy:h,dataFields:A,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),Y.a.sendActivityEvent(b)):
(b=Object.assign(new ka.a,{name:r,samplingPolicy:h,dataFields:A}),Y.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static qpm(b){const h=[];if(b&&0<b.length)for(const r of b)(b=lg.a.Naa(r.name,r.value,Sl.bCl(r.dataType)))&&Array.add(h,b);return h}static bCl(b){switch(b){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static HEn(b){const h=Wa.a.instance.Oa("Common.ISystemInitiatedFeedback");
h?h.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Sl.G_j="Office.Insights.SmartLookup.";Object(u.a)(Sl,"TelemetryUtils",null,[]);var dG;(function(b){b[b.other=0]="other";b[b.jlq=1]="searchBoxSearch";b[b.dlq=2]="searchBoxDictionary";b[b.ilq=3]="searchBoxQuickAnswer";b[b.Dnq=4]="smartLookupRibbon";b[b.Cnq=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.lZp=7]="dictionary";b[b.web=8]="web";b[b.xhq=9]="pictures";b[b.files=10]="files";b[b.IVp=
11]="bookmarks";b[b.Hlc=12]="help";b[b.sWp=13]="chartRecommendation";b[b.e8p=14]="linkSkill";b[b.flq=15]="searchBoxFindInDocument";b[b.elq=16]="searchBoxEntity";b[b.llq=17]="searchSkill";b[b.OXp=18]="controlF";b[b.ckq=19]="ribbonFindButton";b[b.Yjq=20]="reuseSlides";b[b.data=21]="data";b[b.CXp=22]="contextMenuDictionary";b[b.FXp=23]="contextMenuSearchSuggestion";b[b.IXp=24]="contextMenuSynonyms";b[b.EXp=25]="contextMenuSearchBoxSearch";b[b.klq=26]="searchBoxSearchZeroTerm";b[b.GXp=27]="contextMenuSearchZeroTerm";
b[b.Neq=28]="note";b[b.Bnq=29]="smartLookupAutoLaunch";b[b.HXp=30]="contextMenuSmartLookupInSubMenu";b[b.DYp=31]="dataDisambiguate";b[b.d8p=32]="linkFiles";b[b.hlq=33]="searchBoxNoteL2";b[b.DXp=34]="contextMenuLaunchL2Document";b[b.FTp=35]="actionAI";b[b.ihq=36]="pasteAsNewSlide";b[b.wnq=37]="slidesCompression";b[b.glq=38]="searchBoxGenerateDeck";b[b.Ihq=39]="powerPointCopilot";b[b.Doq=40]="tellMeService";b[b.Shq=99]="prefetch"})(dG||(dG={}));Object(u.b)("EntryPoint",dG);var mt=d(1490),Jt=d(1508);
class Kt{static Y_(b,h,r,A,L,Z){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;if(L.value.n6o())return Sl.fB("Skipping Serplet launch",10),32;h=Z;if(!h)return 8;b=Kt.uPb();if(r=h.CommandValueId)try{h=H.a(r)}catch(oa){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new mt.a,{selection:h}):(h=L.value.cQb(),r.selection=Object.assign(new Jt.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,
mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=L.value.Xzi();return Kt.Khc(Z,null,r,b,0,L)}static Khc(b,h,r,A,L,Z){const oa={};oa.controlId=b?b.SourceControlId:"shortcut";r&&(oa.entryPoint=dG[r.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,Kt.aX("Show insights",A,oa));h?Z.value.N8o(h,A,L):r&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?Z.value.b7o(r,A):Z.value.O8o(r,A,L));return 32}static aX(b,h,r=null){b={["appCorrelationId"]:h,
["message"]:b};if(r)for(const A in r)b[A]=r[A];return H.c(b)}static uPb(){return eb.a.create().toString()}}Object(u.a)(Kt,"InvokingPaneUtils",null,[]);class YI{}Object(u.a)(YI,"LaunchDataInDoc",null,[]);class ON{}Object(u.a)(ON,"LaunchDataPasteAsSlide",null,[]);class Jx{}Object(u.a)(Jx,"LaunchDataSlidesCompression",null,[]);var nt=d(1474);class jM{constructor(b,h,r,A,L,Z,oa,Ba,gb){this.FGc=this.ICd=this.nx=null;this.sQb=Ab=>{this.nx||3!==Ab.state||(this.nx=Ab,this.ICd=this.nx.Iga)};this.UD=b;this.ga=
h||y.AFrameworkApplication.va;this.gq=r;this.Zb=A;this.dqh=Ba;this.oMc=L;this.Aa=Z;this.Jb=oa;this.y8m();this.u2a=new rg.a(()=>new hg.a(gb.value,this.sQb))}Xb(){this.ga.qa(Za.a.lcn,Gc.a.frame,Object(D.a)(this,this.L8o,"showInsights"));this.ga.qa(Za.a.mcn,Gc.a.frame,Object(D.a)(this,this.M8o,"showInsightsForTellMe"));this.ga.qa(Za.a.definitions,Gc.a.frame,Object(D.a)(this,this.G7o,"showDefinitions"));this.ga.qa(Za.a.$uf,Gc.a.frame,Object(D.a)(this,this.H7o,"showDefinitionsForTellMe"));this.ga.qa(Za.a.VBg,
Gc.a.frame,Object(D.a)(this,this.VBg,"showInsightsForSuggestion"));this.dqh&&(this.ga.qa(Za.a.bba,Gc.a.frame,Object(D.a)(this,this.Y_,"invokeSmartLookupPane")),this.ga.qa(Za.a.l8c,Gc.a.frame,Object(D.a)(this,this.l8c,"invokeInDocSerplet")),this.ga.qa(Za.a.nce,Gc.a.frame,Object(D.a)(this,this.nce,"invokeSerpletRibbon")),this.ga.qa(Za.a.m8c,Gc.a.frame,Object(D.a)(this,this.m8c,"invokeSerpletContextMenu")),this.ga.qa(Za.a.aWf,Gc.a.frame,Object(D.a)(this,this.aWf,"invokeSerpletTellMeZeroTerm")),this.ga.qa(Za.a.$Vf,
Gc.a.frame,Object(D.a)(this,this.$Vf,"invokeSerpletTellMeNotes")),this.ga.qa(Za.a.jce,Gc.a.frame,Object(D.a)(this,this.jce,"invokeImageSerpletContextMenu")),this.ga.qa(Za.a.oce,Gc.a.frame,Object(D.a)(this,this.oce,"invokeSynonymsSerpletContextMenu")),this.ga.qa(Za.a.ice,Gc.a.frame,Object(D.a)(this,this.ice,"invokeDictionarySerpletContextMenu")),this.ga.qa(Za.a.qce,Gc.a.frame,Object(D.a)(this,this.qce,"invokeZeroTermSerpletContextMenu")),this.ga.qa(Za.a.hce,Gc.a.frame,Object(D.a)(this,this.hce,"invokeDefinitionSearchFromFloatie")),
this.ga.qa(Za.a.mce,Gc.a.frame,Object(D.a)(this,this.mce,"invokeSerpletBrowseFiles")),this.ga.qa(Za.a.kce,Gc.a.frame,Object(D.a)(this,this.kce,"invokeInDocSerpletWithLaunchData")),this.ga.qa(Za.a.Yre,Gc.a.frame,Object(D.a)(this,this.Yre,"queryToggleSerplet")),this.ga.qa(Za.a.fxe,Gc.a.frame,Object(D.a)(this,this.fxe,"setInDocSearchParameter")),this.ga.qa(Za.a.ZVf,Gc.a.frame,Object(D.a)(this,this.ZVf,"invokeSerpletSlidesCompression")),this.ga.qa(Za.a.YVf,Gc.a.frame,Object(D.a)(this,this.YVf,"invokeSerpletPasteAsNewSlide")),
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.qa(Za.a.nUi,Gc.a.frame,Object(D.a)(this,this.nen,"invokeSmartLookupPaneConversations")),this.ga.qa(Za.a.gce,Gc.a.frame,Object(D.a)(this,this.gce,"invokeAutoLaunchSearchRequest"))),this.Puo().continueWith(()=>{y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ge(!0)}))}XMh(){this.ga.fb(Za.a.cLa,Gc.a.frame,Object(D.a)(this,this.cLa,"invokeFilesSerplet"),4);this.ga.fb(Za.a.TVf,Gc.a.frame,
Object(D.a)(this,this.cLa,"invokeFilesSerplet"),4);this.ga.fb(Za.a.hUi,Gc.a.frame,Object(D.a)(this,this.aen,"invokeLinkFilesSerplet"),4);if(this.Aa.$("IsTellMeUpSellEnterpriseEnabled")&&this.Aa.$("SmartLookupTokenPrefetchIsEnabled")){const b=mf.a.paa(0,Object(D.a)(this,this.puj,"prefetchToken"),0,177);this.Jb.$b(b)}}Oef(){eg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.qa(Za.a.cLa,Gc.a.frame,Object(D.a)(this,
this.UVf,"invokeFilesSerpletUnavailable")),this.ga.qa(Za.a.TVf,Gc.a.frame,Object(D.a)(this,this.UVf,"invokeFilesSerpletUnavailable")),this.ga.qa(Za.a.hUi,Gc.a.frame,Object(D.a)(this,this.UVf,"invokeFilesSerpletUnavailable")))}puj(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.sAc().then(h=>{let r=1;if(h)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.Rwg("SmartLookupFiles: Token prefetch succeeded",
!0),h=6E4*this.Aa.jc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{v.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.Rwg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Aa.jc("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.Rwg("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Aa.jc("SmartLookupTokenRetryWaitDurationInMinutes",
10);r++}h=new mf.a(3,1,h,Object(D.a)(this,this.puj,"prefetchToken"),177);h.data=r.toString();this.Jb.$b(h)})}Rwg(b="",h=!1){this.oMc.execute(r=>{r&&r.pwc("PrefetchToken",h,0,"SmartLookup",b)})}sAc(){return this.oMc?new Promise(b=>{this.oMc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Aa.jb("SmartLookupShredderServiceEndpoint")).then(A=>{b(!!A&&0<A.length);h.pwc("TryGetTokenInternal",!!A&&0<A.length,Date.now()-r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}Puo(){const b=
new Pg.a;if(this.Aa.$("BrowserSupportsInsightsPaneSSO"))this.XMh(),b.gg(!0);else{if(!this.oMc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.gg(!1),this.Oef(),b.task;this.oMc.execute(h=>{h?h.getToken("SmartLookup",this.Aa.jb("SmartLookupShredderServiceEndpoint")).then(r=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.XMh(),b.gg(!0)):this.Oef()}):(v.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.gg(!1),
this.Oef())})}return b.task}L8o(b,h,r,A,L){if(1===r)return y.AFrameworkApplication.ua&&y.AFrameworkApplication.J.$("OneNoteDelayLoadContextActivationManager")&&!y.AFrameworkApplication.JWc?8:this.UD.value.YYi()?32:8;b=Kt.uPb();h=this.UD.value.cQb();return this.dqh?(h=Object.assign(new Jt.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new mt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new nt.a,{landingTab:"All"})}),
Kt.Khc(L,null,h,b,0,this.UD)):Kt.Khc(L,h,null,b,0,this.UD)}G7o(b,h,r,A,L){if(1===r)return this.UD.value.YYi()?32:8;b=Kt.uPb();h=this.UD.value.cQb();return Kt.Khc(L,h,null,b,1,this.UD)}M8o(b,h,r,A,L){return 1===r?32:this.Oli(L,0)}H7o(b,h,r,A,L){return 1===r?32:this.Oli(L,1)}Oli(b,h){const r=Kt.uPb(),A=b.CommandValueId;let L;try{L=H.a(A)}catch(Z){return v.ULS.sendTraceTag(6295941,1303,15,Kt.aX(String.format("Insights parameters [{0}] is not in proper format.",A),r)),8}return Kt.Khc(b,L,null,r,h,this.UD)}VBg(b,
h,r,A,L){if(1===r)return 32;if(!L)return 8;b=L.query?L.query:"";h=Kt.uPb();r=new XK.a;r.neighborhood=b;r.mentionStart=0;r.mentionLength=b.length;return Kt.Khc(L,r,null,h,0,this.UD)}aen(b,h,r,A){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;const L=y.AFrameworkApplication.J.$("InsertFileLinkSerpletIsEnabled"),Z=this.UD.value.c9a();return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:Z.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new nt.a,
{landingTab:"File"}),entryPoint:L?32:10}))}cLa(b,h,r,A){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;const L=y.AFrameworkApplication.J.$("InvokeReuseSlidesSerpletIsEnabled"),Z=this.UD.value.c9a();return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:Z.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new nt.a,{landingTab:L?"Slide":"File"}),entryPoint:L?20:10}))}UVf(){return 2}l8c(b,h,r,A,L){if(1===r)return cc.SessionStatusManager.instance.Jk?
8:32;const Z=this.UD.value.c9a();L=void 0===L||null===L?18:19;return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:Z.neighborhood,mentionStart:Z.mentionStart,mentionLength:Z.mentionLength}),launchData:Object.assign(new nt.a,{landingTab:"Indoc"}),entryPoint:L}))}kce(b,h,r,A,L){L=L.CommandValueId;if(!L||L&&this.FGc&&L.query===this.FGc.query&&L.matchCase===this.FGc.matchCase&&L.matchWholeWordOnly===this.FGc.matchWholeWordOnly)return 32;const Z=this.UD.value.c9a();
return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:Z.neighborhood,mentionStart:Z.mentionStart,mentionLength:Z.mentionLength}),launchData:Object.assign(new nt.a,{landingTab:"Indoc",data:Object.assign(new YI,{type:4,query:L.query,matchCase:L.matchCase,matchWholeWord:L.matchWholeWordOnly})}),entryPoint:18}))}Yre(b,h,r,A,L){L&&(L[Tg.a.On]=this.UD.value.wTb);return 32}fxe(b,h,r,A,L){if(b=L.CommandValueId)this.FGc=b;return 32}nen(b,h,r){if(1===r)return cc.SessionStatusManager.instance.WA?
32:8;b=this.UD.value.c9a();b=Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new nt.a,{landingTab:"All"})});this.UD.value.Oge(b);return 32}gce(b,h,r){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;b=this.UD.value.c9a();b=Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new nt.a,
{landingTab:"All",data:y.AFrameworkApplication.ZNb})});h=Kt.uPb();this.UD.value.l_b(b,h);return 32}nce(b,h,r,A){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;const L=this.UD.value.Zzi();return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:L.mentionLength}),entryPoint:4,launchData:Object.assign(new nt.a,{landingTab:"All"})}))}m8c(b,h,r,A){return this.Y_(b,h,r,A,Object.assign(new mt.a,{entryPoint:5,
launchData:Object.assign(new nt.a,{landingTab:"All"})}))}aWf(b,h,r,A){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;const L=this.UD.value.c9a();return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:0}),launchData:Object.assign(new nt.a,{landingTab:"All"}),entryPoint:26}))}ice(b,h,r,A){return 1===r?(b=this.UD.value.cQb())&&0<b.mentionLength?32:8:this.Y_(b,h,r,A,Object.assign(new mt.a,{entryPoint:22,
launchData:Object.assign(new nt.a,{landingTab:"All"})}))}hce(b,h,r,A){return 1===r?(b=this.UD.value.cQb())&&0<b.mentionLength?32:8:this.Y_(b,h,r,A,Object.assign(new mt.a,{entryPoint:7,launchData:Object.assign(new nt.a,{landingTab:"All"})}))}jce(b,h,r,A){return this.Y_(b,h,r,A,Object.assign(new mt.a,{launchData:Object.assign(new nt.a,{landingTab:"Image"}),entryPoint:9}))}oce(b,h,r,A){return this.Y_(b,h,r,A,Object.assign(new mt.a,{launchData:Object.assign(new nt.a,{landingTab:"All"}),entryPoint:24}))}$Vf(b,
h,r,A){return this.Y_(b,h,r,A,Object.assign(new mt.a,{launchData:Object.assign(new nt.a,{landingTab:"Notes"}),entryPoint:33}))}qce(b,h,r,A){if(1===r)return cc.SessionStatusManager.instance.WA?32:8;const L=this.UD.value.c9a();return this.Y_(b,h,r,A,Object.assign(new mt.a,{selection:Object.assign(new Jt.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:0}),launchData:Object.assign(new nt.a,{landingTab:"All"}),entryPoint:27}))}ZVf(b,h,r,A,L){if(!L)return 8;const Z=L.url;L=L.selectedSlideIDs;
return this.Y_(b,h,r,A,Object.assign(new mt.a,{launchData:Object.assign(new nt.a,{landingTab:"All",data:Object.assign(new Jx,{type:6,url:Z,selectedSlideIDs:L})}),entryPoint:37}))}YVf(b,h,r,A,L){if(!L)return 8;const Z=L.Selection;L=L.CurrentDocTitle;return this.Y_(b,h,r,A,Object.assign(new mt.a,{launchData:Object.assign(new nt.a,{landingTab:"All",data:Object.assign(new ON,{type:5,selection:Z,currentDocTitle:L})}),entryPoint:36}))}Y_(b,h,r,A,L){return Kt.Y_(b,h,r,A,this.UD,L)}mce(b,h,r){if(1===r)return 32;
this.nx||this.u2a.value.FR("Browse File from Search pane",!0);if(!this.ICd||""===this.ICd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;rd.a.Tm(this.ICd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}y8m(){const b=this.Zb.ie(Yh.BD);b.parent=Qf.AFrame.Gq;b.Nja(Object(D.a)(this,this.qwc,"sendIFrameTakeFocusMessage"));this.gq.xW(Yh.BD)}qwc(){document.activeElement.blur();y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.Jtb||(this.UD.value.QUo(),
this.UD.value.aQo())}dispose(){this.UD.value&&this.UD.value.dispose()}}Object(u.a)(jM,"InsightsActor",null,[10]);const eG=b=>{b=b.split("-");return b[b.length-1]},LA=()=>{var b=ZK();if(b)return Promise.resolve(b);b=$I().replace("SearchWeb","searchweb");b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Yh.dWj+"/":b+Yh.Kpd+"/";b+="version.json";if(aa.a.Wfa)return ZI(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);
b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Sl.fB("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Sl.fB("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=H.b(JSON.stringify(r));return r.version?r.version:""},r=>{Sl.fB("InsightsUtils - Failed to deserialize version: "+r.toString(),10);v.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(h){return Sl.fB("InsightsUtils - Failed to download version.json: "+h.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},ZI=b=>{const h=y.AFrameworkApplication.Fe;return new Promise(r=>{const A=new VI.a(b,1,null,null,!0,2,null);h.send(A).jDa(L=>{L&&L.data?L.data.Pe||(Sl.fB("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
L.data.He,10),r("")):(Sl.fB("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const Z=H.b(L.data.Pe);Z.version&&r(Z.version)}catch(Z){Sl.fB("InsightsUtils - Failed to deserialize version: "+Z.toString(),10),r("")}},L=>{L&&L.data?Sl.fB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+L.data.He,10):Sl.fB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},
YK=()=>y.AFrameworkApplication.J.$("SmartLookupEnableLocalOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),kM=()=>{const b=$I();return YK()||y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion")?b+ZK()+"/":y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Yh.dWj:b+Yh.Kpd},ZK=()=>YK()?"dev":y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion")?y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion").split("/")[1]:
y.AFrameworkApplication.J.jb("SmartLookupClientVersion"),$K=b=>{var h=3===y.AFrameworkApplication.ua.Gb.Mk?"wordwac":2===y.AFrameworkApplication.ua.Gb.Mk?"pptwac":"excelwac";var r=kg.a.Eg(y.AFrameworkApplication.lcid);const A=r?r.name:"en-us";r=$I();const L=yy();h="main_ssr_wac.html?appName="+h+"&culture="+A;return"LOCAL"===L?r+h:r+((""!==b?b:Yh.Kpd)+"/")+h},lM=b=>$I()+(""!==b?b:Yh.Kpd)+"/scripts/microsoft.office.smartlookup.host.runtime.js",$I=()=>{switch(yy()){case "LOCAL":return Yh.Xap;case "PR":const b=
y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion").split("/");return Yh.Yap+b[0]+"/";case "INT":return Yh.Zap;case "EDOG":return Yh.eWj;default:return Yh.fWj}},YO=()=>{if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(yy()){case "EDOG":return Yh.eWj;case "PROD":return Yh.fWj;default:return""}},yy=()=>{if(y.AFrameworkApplication.J.$("SmartLookupEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",
!1))return"EDOG";if(y.AFrameworkApplication.J.$("SmartLookupEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(y.AFrameworkApplication.J.$("SmartLookupEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion")&&
y.AFrameworkApplication.J.jb("SmartLookupPRIntentSvc"))return"PR";if(YK())return"LOCAL";switch(Object(Ca.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=y.AFrameworkApplication.J.jb("UserPrincipalName");b=F.a.xh(b);const h=y.AFrameworkApplication.J.my("SmartLookupINTEnabledForSKITeam")?y.AFrameworkApplication.J.hD("SmartLookupINTEnabledForSKITeam"):
[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},PN=()=>{let b;b=y.AFrameworkApplication.J.$("IntentSvcEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":y.AFrameworkApplication.J.$("IntentSvcEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":y.AFrameworkApplication.J.$("IntentSvcEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":yy();const h=y.AFrameworkApplication.J.jb("IntentServiceEndpoint"),r=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return y.AFrameworkApplication.J.jb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},ZO=()=>{const b=
yy(),h=y.AFrameworkApplication.J.jb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class QN{sendTelemetryEvent(b){Sl.sendTelemetryEvent(b)}}Object(u.a)(QN,"OtelTelemetrySink",null,[377]);class RN{}Object(u.a)(RN,"ApplicationProperties",
null,[]);class SN{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(u.a)(SN,"CurrentDocumentProperties",null,[]);class MA{}Object(u.a)(MA,"EnterpriseUserInfo",null,[]);class TN{}Object(u.a)(TN,"FeatureGates",null,[]);class mM{constructor(b,h){this.rw=this.oj=null;this.vPa="Search";this.pbj=!0;this.GJb=h;this.uv=b;this.uv.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(A=>{this.pbj=A}).catch(A=>{Sl.fB("SearchHelper - Failed to check if Feedback feature is enabled: "+
A.toString(),15)})});b=PN();h=y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")){this.rw={};const r=this.LKm();if(r&&0<r.length)for(let A=0;A<r.length;A++){const L=r[A],Z=this.dLm(L);switch(Z.toLowerCase()){case "true":this.rw[L]=!0;break;case "false":this.rw[L]=!1;break;default:this.rw[L]=Z}}this.rw.EnableInDocumentSearch=
h;this.rw.EnableInDocumentSearchReplace=!0;this.rw.EnableInDocumentParamLocalSearch=!0;this.rw.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.rw.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.rw.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.rw.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.rw.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.rw.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.rw.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.rw.EnableLocalSearch=!0;this.rw.EnableInDocumentStickyFilters=!0;this.rw.IntentServiceEndpoint=b;this.rw.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.rw.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.rw.UXBundleVersion=ZK();this.rw.SmartLookupServicePath=kM();this.rw.EnableAcronymSearch=
!0;this.rw.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.rw.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.rw.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.rw.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.rw.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.rw.ShowDebugInfo="INT"===yy();this.rw.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.rw.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.rw.QnaInMixSection=!0;this.rw.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.rw.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.rw.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.rw.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.rw.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.rw.EnableClientSideRendering=!0}else this.oj=new TN,this.oj.EnableInDocumentSearch=h,this.oj.EnableInDocumentSearchReplace=
!0,this.oj.EnableInDocumentParamLocalSearch=!0,this.oj.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.oj.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.oj.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.oj.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.oj.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.oj.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.oj.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.oj.EnableLocalSearch=!0,this.oj.EnableInDocumentStickyFilters=!0,this.oj.IntentServiceEndpoint=b,this.oj.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.oj.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.oj.UXBundleVersion=ZK(),this.oj.SmartLookupServicePath=kM(),this.oj.EnableAcronymSearch=
!0,this.oj.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.oj.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.oj.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.oj.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.oj.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.oj.ShowDebugInfo="INT"===yy(),this.oj.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.oj.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.oj.QnaInMixSection=!0,this.oj.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.oj.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.oj.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.oj.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.oj.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.oj.EnableClientSideRendering=!0,this.oj.SharedSerpletFeatureGate1=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.oj.SharedSerpletFeatureGate2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.oj.SharedSerpletFeatureGate3=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.oj.SharedSerpletFeatureGate4=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.oj.SharedSerpletFeatureGate5=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.oj.SharedSerpletFeatureGate6=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.oj.SharedSerpletFeatureGate7=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.oj.SharedSerpletFeatureGate8=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.oj.SharedSerpletFeatureGate9=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.oj.SharedSerpletFeatureGate10=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.oj.SharedSerpletFeatureGate11=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.oj.SharedSerpletFeatureGate12=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.oj.SharedSerpletFeatureGate13=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.oj.SharedSerpletFeatureGate14=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.oj.SharedSerpletFeatureGate15=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.oj.SharedSerpletFeatureGate16=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.oj.SharedSerpletFeatureGate17=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.oj.SharedSerpletFeatureGate18=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.oj.SharedSerpletFeatureGate19=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.oj.SharedSerpletFeatureGate20=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.oj.SharedSerpletFeatureGate21=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.oj.SharedSerpletFeatureGate22=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.oj.SharedSerpletFeatureGate23=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.oj.SharedSerpletFeatureGate24=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.oj.SharedSerpletFeatureGate25=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.oj.SharedSerpletFeatureGate26=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.oj.SharedSerpletFeatureGate27=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.oj.SharedSerpletFeatureGate28=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.oj.SharedSerpletFeatureGate29=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.oj.SharedSerpletFeatureGate30=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.oj.SharedSerpletFeatureGate31=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.oj.SharedSerpletFeatureGate32=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.oj.SharedSerpletFeatureGate33=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.oj.SharedSerpletFeatureGate34=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.oj.SharedSerpletFeatureGate35=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.oj.SharedSerpletFeatureGate36=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.oj.SharedSerpletFeatureGate37=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.oj.SharedSerpletFeatureGate38=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.oj.SharedSerpletFeatureGate39=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.oj.SharedSerpletFeatureGate40=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.gLc=Wa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.Qub=mM.isEnterpriseUser();this.QXa=y.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint");this.M6f=Ma.a.nU(y.AFrameworkApplication.J.jb("AppCatalogUrl")||"");this.$In=y.AFrameworkApplication.J.jb("UserPrincipalName");this.Qub&&this.CGi()}dLm(b){return y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}LKm(){const b=y.AFrameworkApplication.J.j8a,h=y.AFrameworkApplication.J.hD("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(const L in b){var A=
{key:L,value:b[L]};A=A&&A.key?A.key:"";for(let Z=0;Z<h.length;Z++)if(-1<A.toLowerCase().indexOf(h[Z].toLowerCase())){const oa=A.split(".");oa&&4===oa.length&&Array.add(r,oa[oa.length-1])}}return r}VMf(b,h,r,A){return new Promise(L=>{this.Wsn().then(Z=>{const oa=new RN;oa.anid="";oa.applicationName=3===y.AFrameworkApplication.ua.Gb.Mk?"WORD":"POWERPNT";oa.applicationVersion=y.AFrameworkApplication.buildVersion;oa.appCorrelationId=b?b:Kt.uPb();oa.themePlatform="web";oa.lcid=y.AFrameworkApplication.lcid;
oa.launchUtcTime=(new Date).toUTCString();y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?oa.featureGates=H.c(this.rw):oa.featureGates=H.c(this.oj);var Ba=kg.a.Eg(y.AFrameworkApplication.lcid);Ba=Ba?Ba.name:null;oa.market=eG(Ba);oa.uiLanguage=Ba;oa.sessionId=y.AFrameworkApplication.userSessionId;oa.themeId=r;oa.parentalControl="yes";oa.processorOnlyMode=Z;oa.isEditingAllowed=h.isEditingAllowed();oa.isFeedbackEnabled=this.pbj;oa.isClientSideRendering=18===A||19===A||15===A;oa.disableClipboard=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&y.AFrameworkApplication.cG&&!y.AFrameworkApplication.hpb;oa.accessToken=this.Qub?this.CGi():"";Z=new MA;Z.CountryCode=eG(Ba);Z.ServiceEndpoint=this.QXa;Z.IsGoLocal=y.AFrameworkApplication.J.$("IsGoLocalEnvironment");Z.IsEnabled=this.Qub;Z.IsEnterpriseEnabled=this.Qub;Z.TenantRoot=this.M6f;Z.Upn=this.$In;Ba=yy();Z.IsEUDB="PROD"===Ba&&""!==y.AFrameworkApplication.J.jb("IntentServiceEndpoint");
oa.enterpriseUserInfo=Z;Z=new SN;Z.filePath=y.AFrameworkApplication.J.jb("EditDocInClientUrl");Z.docName=y.AFrameworkApplication.J.jb("FileName");Z.author=99!==A?h.author():null;Z.createdDate=99!==A?h.createdDate():null;oa.currentDocument=Z;L(oa)})})}Wsn(){return new Promise(b=>{this.uv?this.uv.execute(h=>{h.isFeatureEnabled(Yh.$ap,!0).then(r=>{b(!r)}).catch(r=>{Sl.fB("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}Abo(b){this.gLc&&
this.Qub&&this.f9d(this.QXa).then(h=>{b(h)})}CGi(){return"Dev Box"===y.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.gLc?this.gLc.$Om(this.vPa,this.QXa):""}f9d(b){return"Dev Box"===y.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.gLc?this.gLc.getToken(this.vPa,b):Promise.resolve("")}u4c(){return this.GJb?this.GJb.getVersion():""}hsm(){return y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?H.c(this.rw):H.c(this.oj)}static isEnterpriseUser(){const b=y.AFrameworkApplication.J.jb("SovereignEnvironmentName"),h=y.AFrameworkApplication.J.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(u.a)(mM,"SearchHelper",null,[362]);class jE{constructor(){jE._instance=
""}getVersion(){return jE._instance}s0o(b){jE._instance=b}}jE._instance=null;Object(u.a)(jE,"SmartLookupVersion",null,[]);class UN{}Object(u.a)(UN,"ConfigurationProvider",null,[]);class fG{constructor(b){fG._instance=b}tJf(){return fG._instance}}fG._instance=null;Object(u.a)(fG,"SearchHostRuntime",null,[]);class nM{constructor(){this.Oia=this.R3b=this.Z=null}get name(){return"Common.App.Insights"}wc(b){this.Z=b;const h=xh.a.sq(Wa.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=
y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")||y.AFrameworkApplication.J.$("SmartLookupIsEnabled");b.register(jM,"Common.App.Insights.InsightsActor").ha().Ud(()=>new jM(b.nf("Common.App.Insights.IInsightsManager"),y.AFrameworkApplication.va,Gp.a.instance,Sg.FocusManager.instance(),b.Ta("Common.App.SearchCommon.ISearchOAuthManager"),y.AFrameworkApplication.J,zf.a.instance,r,new rg.a(()=>h.result)));b.register(361,"Common.App.Insights.IDocumentContentExtractionManager").ha().Ud(()=>new XI(b));
r&&(b.register(jE,"Common.App.Insights.SmartLookupVersion").ha().Ud(()=>new jE),b.register(362,"Common.App.SearchCommon.ISearchHelper").ha().Ud(()=>new mM(Wa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Oa("Common.App.Insights.SmartLookupVersion"))))}init(){y.AFrameworkApplication.Y2&&(this.R3b=this.Z.Oa("Common.App.Insights.InsightsActor"),this.R3b.Xb())}tto(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=y.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint");this.Z.resolve("Common.App.SearchCommon.ISearchHelper").f9d(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=ZO();const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new VI.a(h+("?isTelemetryOnly="+A),1,null,r,!0,2,null);y.AFrameworkApplication.Fe.send(r).jDa(()=>{Sl.fB("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
A,50)},L=>{Sl.fB("InsightsPackage - Failed to send refreshmemory API request. Error: "+L.toString(),10)})})}}EYl(){this.Vcn();this.tto()}Vcn(){LA().then(b=>{if(""!==b){const h=this.Z.Oa("Common.App.Insights.SmartLookupVersion");h&&h.s0o(b)}this.a0d();this.R3b=this.Z.resolve("Common.App.Insights.InsightsActor");b=lM(b);b=pb.a.create(b);b.Z1((h,r)=>{r.succeeded?this.r1o()&&this.prefetchZeroTerm():Sl.fB("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.eG,10);this.R3b.Xb()});
sb.a.m_(b)})}r1o(){const b=Object.assign(new UN,{channelId:Yh.channelId,approvedOriginPattern:YK()?"^(http)?://(localhost:8080)$":y.AFrameworkApplication.J.jb("SmartLookupApprovedOriginPattern")});var h=this.Z.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.Z.resolve("Common.App.SearchCommon.ISerpletExecutor"),A=this.Z.resolve("Common.App.SearchCommon.IInsertContentExecutor"),L=new nb.a;h&&L.add(h);r&&L.add(r);A&&L.add(A);h=PN();try{const Z=new QN,oa=SmartLookupHostRuntime.setup(b,
L.toArray(),!0,h,Z);this.Z.register(fG,"Common.App.SearchCommon.SearchHostRuntime").ha().Ud(()=>new fG(oa));return!0}catch(Z){return Sl.fB("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+Z,10),!1}}prefetchZeroTerm(){if(y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Wa.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.Z.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.Z.resolve("Common.App.SearchCommon.IDocumentHelper");h.VMf(null,r,0,99).then(A=>{b.tJf().prefetchZeroTerm(A,y.AFrameworkApplication.userSessionId,kM(),!0,"Indoc",null)})}else Sl.fB("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}a0d(){var b=this.Z.resolve("Common.App.SearchCommon.ISearchHelper");const h=$K(b.u4c());b=b.u4c();b=$I()+(""!==b?b:Yh.Kpd)+"/scripts/microsoft.office.smartlookup.ssr.js";
const r=YO();aa.a.Wfa?this.DYl(h,b):(this.AYl(h,r),this.BYl(b,r))}AYl(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);const L=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),A).then(()=>{""!==h&&Sl.nwg(h,b,(new Date).getTime()-L);this.Z.Oa("Common.App.Insights.SmartLookupVersion")})}catch(Z){Sl.fB("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+Z.toString(),10)}}BYl(b,h){var r=new Sys.Net.WebRequest;
r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);let L=-1;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),zf.a.instance.$b(new mf.a(5,1,r,()=>{const Z=pb.a.create(b);Z.iff(()=>{L=Date.now()});Z.Z1((oa,Ba)=>{Ba.succeeded?""!==h&&Sl.nwg(h,b,Date.now()-L):Sl.fB("InsightsPackage - Failed to prefetch JS file.",
10)});sb.a.m_(Z)}));else{L=Date.now();try{window.fetch(r.getResolvedUrl(),A).then(()=>{""!==h&&Sl.nwg(h,b,Date.now()-L)})}catch(Z){Sl.fB("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+Z.toString(),10)}}}DYl(b,h){if(aa.a.Wfa){var r=y.AFrameworkApplication.Fe;b=new VI.a(b,1,null,null,!0,2,null);r.send(b).jDa(A=>{A&&A.data?A.data.Pe?this.Z.Oa("Common.App.Insights.SmartLookupVersion"):Sl.fB("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
A.data.He,10):Sl.fB("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?Sl.fB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+A.data.He,10):Sl.fB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});y.AFrameworkApplication.J.$("SmartLookupPrefetchJSIsEnabled")&&(h=new VI.a(h,1,null,null,!0,2,null),r.send(h).jDa(A=>{A&&A.data?A.data.Pe||Sl.fB("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
A.data.He,10):Sl.fB("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?Sl.fB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+A.data.He,10):Sl.fB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.R3b&&this.R3b.dispose()}}Object(u.a)(nM,"InsightsPackage",null,[0,1]);var VN=d(1561);class WN{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(u.a)(WN,"DocumentContentParams",null,[]);var aL=d(1919),bL=d(771),XN=d(2139),oM=d(2140),pM=d(2141),ot;(function(b){b.W0a="SearchProvider";b.agb="TextSummarization"})(ot||(ot={}));Object(u.b)("WorkflowType",ot);var vs;(function(b){b.Success="Success";b.yPg="Invoked";b.Error="Error"})(vs||(vs={}));Object(u.b)("LogType",vs);var mw;(function(b){b.ydk="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier=
"BlockedByClassifier";b.xPg="InvalidAnnotation";b.ljk="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(mw||(mw={}));Object(u.b)("ErrorReason",mw);class gG{constructor(b){this.jhi=b;this.Odg=this.Odg.bind(this);this.SWb=this.SWb.bind(this);this.ykp=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.VNo=Date.now();this.Uxb=eb.a.create().toString();this.log({nM:ot.W0a,logType:vs.yPg,
success:!0,correlationId:this.Uxb});var b=yy().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new tt.m({parentPath:["Signal",aL.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new aL.SearchProviderSignal({correlationId:this.Uxb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.hKj=window.setTimeout(()=>{this.onError(ot.W0a,vs.Error,mw.Timeout)},1500)}catch(h){window.clearTimeout(this.hKj),
this.onError(ot.W0a,vs.Error,mw.Other,this.nxi(h))}}async generateDocumentSummaryDetails(){try{if(!gG.U$c)return null;this.xkp=Date.now();this.log({nM:ot.agb,logType:vs.yPg,success:!0});await this.activateAnnotation();const b=new tt.m({parentPath:["Signal",XN.a.getTypeName()],items:[{id:"TextSummarization",body:new XN.a}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.e0j=window.setTimeout(()=>{this.onError(ot.agb,vs.Error,mw.Timeout)},this.ykp);return new Promise(h=>
{this.Hyc=h})}catch(b){window.clearTimeout(this.e0j),this.onError(ot.agb,vs.Error,mw.Other,this.nxi(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get U$c(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get $sn(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.cnc){await qo.a.im();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new bL.a,{annotationType:aL.SearchProviderAnnotation.getTypeName(),handler:this.Odg}))];gG.U$c&&h.push(b(Object.assign(new bL.a,{annotationType:oM.b.getTypeName(),handler:this.SWb})));await Promise.all(h);this.cnc=!0}}SWb(b){var h,r,A;if(this.Hyc)if(this.D_i(b)){if(b=b.items[0],oM.b.typeGuard(b.body))if(window.clearTimeout(this.e0j),b=b.body,b.status!==
pM.a.Success)this.onError(ot.agb,vs.Error,this.Jrm(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({nM:ot.agb,logType:vs.Success,success:!0});var L=null!==b.summary&&""!==b.summary,Z=gG.$sn&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===pM.b.Success&&null!==(null===(r=b.tts)||void 0===r?void 0:r.base64Audio)&&""!==(null===(A=b.tts)||void 0===A?void 0:A.base64Audio);this.Hyc({succeeded:L,summary:L?b.summary:null,audioSucceeded:Z,audioBase64:Z?b.tts.base64Audio:
null});this.Hyc=null}}else this.log({nM:ot.agb,logType:vs.Error,success:!1,n1d:mw.xPg})}Odg(b){if(this.D_i(b)&&(b=b.items[0],aL.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.hKj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Uxb)this.log({nM:ot.W0a,logType:vs.Error,n1d:mw.ydk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Uxb!==b.correlationId)this.log({nM:ot.W0a,logType:vs.Error,n1d:mw.ljk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.F9h(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({nM:ot.W0a,logType:vs.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Uxb=void 0;this.jhi.vNj(h)}else this.onError(ot.W0a,
vs.Error,mw.xPg)}Jrm(b){switch(b.status){case "BlockedByPrefilter":return mw.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return mw.BlockedByQualityCheck;default:return mw.Other}}D_i(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.nM){case ot.W0a:var h=this.VNo;break;case ot.agb:h=this.xkp;break;default:h=-1}const r=Date.now(),A=h?r-h:-1;h=[Object.assign(new da.a,{name:"WorkflowType",string:b.nM}),Object.assign(new da.a,{name:"LogType",string:b.logType}),
Object.assign(new da.a,{name:"ErrorReason",string:b.n1d}),Object.assign(new da.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new da.a,{name:"Message",string:b.message}),Object.assign(new da.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new da.a,{name:"StartTime",int64:h}),Object.assign(new da.a,{name:"EndTime",int64:r}),Object.assign(new da.a,{name:"Duration",int64:A})];Object(me.a)("AugloopSearchProviderData",b.success,A,h)}nxi(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}F9h(b=
"",h="",r=""){return Object.assign(new WN,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,A){h={nM:b,logType:h,success:!1,message:A,n1d:r};switch(b){case ot.W0a:if(!this.Uxb)break;h.correlationId=this.Uxb;this.log(h);this.Uxb=void 0;this.a6l();break;case ot.agb:if(!this.Hyc)break;this.log(h);this.Hyc(null);this.Hyc=null;break;default:return null}}a6l(){this.jhi.vNj(this.F9h())}}Object(u.a)(gG,"AugloopSearchProviderManager",null,[]);class aJ{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(u.a)(aJ,"DocumentContentSearchResults",null,[]);class cL{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,A,L){this.selectRange(h,r,A,L)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new aJ,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new aJ,{results:r,
totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(u.a)(cL,"BaseDocumentContentExecutor",null,[1850,349]);var dL=d(2182),$O=d(1377);class yz{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(u.a)(yz,"DocumentContentSearchParams",null,[]);class qM{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(u.a)(qM,"DocumentSelection",null,[]);class rM{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(u.a)(rM,"IAuthorProperties",null,[]);var sC=d(699);class eL{constructor(){this.B0c=this.ppf=0}}Object(u.a)(eL,"CommentFindResultIndexInfo",null,[]);const sM=b=>{b.Kc(he.a.vk(b.gb.currentSelection,!0,!1))},YN=b=>{b=dL.a.R7d(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class tM{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(u.a)(tM,"DocumentContentSearchResult",null,[]);var aP=d(1875);class ZN{constructor(){this.authorEmail=this.authorName=this.SOb=this.tpf=null}}Object(u.a)(ZN,"CommentFindResults",null,[]);class $N{constructor(){this.end=this.Dc=0}}Object(u.a)($N,"FindResultOffset",null,[]);class Zu{constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab){this.ELe=this.ww=this.ORe=this.yC=null;this.eIh=0;this.qO=null;this.UEc=new nb.a;this.Mbh=null;this.Vu=b;this.hb=h;this.Jkb=r;this.mja=
L;this.P6b=Z;this.TDb=oa;this.yi=Ba;this.ga=gb;this.ib=Ab}xvm(b,h){var r;const A=[];if(12!=b.type)return A;const L=Ya.FormattingReader.Asi(b);let Z=null,oa=-1;var Ba=Ql.a.auto;for(let Ab=0;Ab<=L.length;Ab++){let Jb=-1;var gb=Ql.a.auto;Ab<L.length&&(gb=L[Ab],Jb=gb.cp,gb=null===(r=gb.formatting)||void 0===r?void 0:r.cache,gb=(null===gb||void 0===gb?0:gb.xRb)?gb.highlight:(null===gb||void 0===gb?0:gb.aWa)?gb.ku:Ql.a.auto);if(Ba!=gb){if(Ba!=Ql.a.auto){Z||(Z=this.TDb.vVa(b.id));-1==Jb&&(Jb=Z.length);Ba=
this.Jkb.xYd(Z,oa,Jb,"");const Tb={};Tb.context=Ba.nXd;Tb.startOffsetInContext=Ba.Nue;Tb.endOffsetInContext=Ba.Lue-1;A.push({data:Tb,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:oa,endOffsetInParagraph:Jb-1})}oa=Jb;Ba=gb}}return A}get Cea(){return this.Mbh}initialize(){this.yC=pD.a.createInstance(this,this.mja,tD.a.instance,!1,!0)}search(b,h){this.yC.k6a();this.g_f(b)?(this.ww=h,this.qO=new nb.a,b=this.Ysf(b),this.yC.find(b)):h(null)}searchV2(b,h){this.yC.k6a();if(this.g_f(b)){this.KYi()&&
this.ga.Qb(Za.a.fxe,2,{CommandValueId:b});this.ELe=h;this.eIh=b.totalResultLimit;this.qO=new nb.a;b=this.Ysf(b);this.Mbh=new wq.a;this.yC.find(b);h=this.mja.Ghd(b.text);h=this.mja.pXb(h);b=this.P6b.Bkc(h.join("|"),b);h=this.yi.xR();for(let A=0;A<h.length;A++){const L=h[A],Z=YN(L);var r=this.TDb.lRb(Z,b);const oa=this.TDb.lRb(L.author,b);if(!r&&!oa){v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!Z,!b);continue}r=oa&&0<oa.length?oa:r;let Ba="",gb="";oa&&0<oa.length&&
(Ba=L.author,gb=L.authorId);for(const Ab of r)r=aP.a.createInstance(Ab.Dc,Ab.end,Q.a.Bf(L.objectId),A,32,!1),this.UEc.add(r),this.Cea.tb(A)||this.Cea.add(A,Object.assign(new ZN,{tpf:Z,SOb:[],authorName:Ba,authorEmail:gb}))}}else h(null)}get hoi(){null==this.ORe&&(this.ORe=pD.a.createInstance(this,this.mja,tD.a.instance));return this.ORe}KYi(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}$nc(){var b;
return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.g_f(b);b=h?this.Ysf(b):null;var r={};this.KYi()&&this.ga.Qb(Ec.a.aog,2,r);if(r[Tg.a.On]){if(h){h={};r={};var A={};this.ga.Qb(Ec.a.are,2,h);this.ga.Qb(Za.a.$qe,2,r);this.ga.Qb(Za.a.bre,2,A);if(b.text!=h.CommandValueId||b.matchCase!=r[Tg.a.On]||b.matchWholeWord!=A[Tg.a.On])sM(this.ib),this.ga.Qb(Za.a.fic,2,{CommandValueId:b.text,
MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.hoi,r.k6a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.hoi;return 0<h.Ak.Qna?(b?h.DKi():h.IKi(),h.Ak.fdf-1):-1}Ysf(b){let h=ft.a.none;b.matchCase&&(h|=ft.a.matchCase);b.matchWholeWordOnly&&(h|=ft.a.hNg);return oA.a.createQuery(b.query,h)}g_f(b){return b&&!!b.query&&0<b.query.length}Wxe(){}uwe(){}reset(){}LCf(){}dic(){if(this.ww){var b=this.G9h(this.qO);this.ww(b)}if(this.ELe){b=new aJ;const h=this.qO.count+this.UEc.count>
this.eIh;b.totalResultCount=this.qO.count+this.UEc.count;b.hasTooManyResults=h;h||(this.qO.SA(this.qO.count,this.UEc),b.results=this.G9h(this.qO));this.ELe(b);this.UEc.clear()}}G9h(b){var h;const r=[];var A=Object.assign(new sC.a,{V_:!1,Msa:!0,LKa:this.$nc(),W_:!0});A=this.hb.bKa(this.Vu.value,A);for(const oa of b){var L=oa.Dc;let Ba=oa.end;var Z=void 0;b=-1;let gb=null,Ab=0;if(32===oa.type){gb=Zu.spf;Ab=3;b=A.count+oa.fWa;const Jb=({Dc:L,end:Ba}=VN.a.ZBj(this.Cea.K(oa.fWa).tpf,L,Ba)).returnValue;
Z=this.Jkb.xYd(Jb,L,Ba,Un.a(oa.type));this.Cea.K(oa.fWa).tpf=Jb;this.Cea.K(oa.fWa).SOb.push(Object.assign(new $N,{Dc:L,end:Ba}))}else{if(2===oa.type||4===oa.type)Ab=2===oa.type?1:2,gb=Zu.ORf;if(8===oa.type||16===oa.type)Ab=8===oa.type?6:5,gb=Zu.wbg;for(Z=0;Z<A.count;Z++)if(A.K(Z).id===oa.nodeId){b=Z;break}Z=this.Jkb.yYd(oa)}L=(null===(h=this.Cea)||void 0===h?0:h.tb(oa.fWa))?this.Cea.K(oa.fWa):null;if(0<=b||(null===L||void 0===L?0:L.authorName))b=Object.assign(new tM,{snippet:Z.nXd,subdocumentId:gb,
subdocumentType:Ab,startOffsetInSnippet:Z.Nue,endOffsetInSnippet:Z.Lue-1,paragraphIndex:b,startOffsetInParagraph:oa.Dc-Z.Nue,endOffsetInParagraph:oa.end-Z.Lue-1,authorName:L?L.authorName:"",authorEmail:L?L.authorEmail:""}),r.push(b)}r.sort((oa,Ba)=>oa.paragraphIndex===Ba.paragraphIndex?oa.startOffsetInParagraph-Ba.startOffsetInParagraph:oa.paragraphIndex-Ba.paragraphIndex);return r}update(){}YUa(b,h){switch(b){case 0:h&&0<h.length&&!this.qO&&(v.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),
this.qO=new nb.a);for(const r of h)this.qO.add(r)}}Ayb(){}dispose(){}}Zu.spf="Comment";Zu.ORf="HeaderFooter";Zu.wbg="Note";Zu.LPi="Image";Object(u.a)(Zu,"WordDocumentSearchProcessor",null,[350,10,351]);class kE extends cL{$nc(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,A,L,Z,oa,Ba,gb,Ab,Jb,Tb,jc){super();this.RGa=null;this.BN=(Hc,hd)=>{Hc=hd.node;hd=hd.property;
this.EAg(Hc)&&hd===Ke.a.zn&&this.qRb(Hc,3)};this.Jma=(Hc,hd)=>{Hc=hd.node;!hd.kde&&this.EAg(Hc)&&this.qRb(Hc,1)};this.Zvb=(Hc,hd)=>{Hc=hd.node;this.EAg(Hc)&&this.qRb(Hc,2)};this.Vu=b;this.hb=h;this.qd=r;this.ib=A;this.EG=L;this.gm=Ba;this.Zb=gb;this.B$=Z;this.ZD=oa;this.yi=Ab;this.Tzk=Jb;this.qCh=Q.a.create();this.hte(this.BN,this.Jma,this.Zvb);jc&&jc.execute(Hc=>this.Gpa=Hc);Tb.execute(Hc=>{this.x4a=Hc})}submitDocumentContentExtractionSignal(){this.x4a&&this.x4a.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.x4a?
this.x4a.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.x4a?this.x4a.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.jN(this.MEm());for(const r of this.yi.xR()){var h=dL.a.R7d(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new sC.a,{V_:!1,Msa:!1,W_:!0}),r=this.hb.bKa(this.Vu.value,h);h=[];const A=[];for(var L=0;L<r.count;++L){var Z=
r.K(L);h.push(...this.twm(Z,L));A.push(...this.B$.xvm(Z,L))}r=[];L=this.yi.xR();for(Z=0;Z<L.length;Z++)r.push(this.Dmm(L[Z]));L={};L.images=h;L.comments=r;L.highlights=A;b(L)}selectRange(b,h,r,A,L){const Z=Date.now(),oa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.k_a();if(0>b||0>h||0>r||0>A||b>r||b===r&&h>A)throw Error("Provided select range offsets incorrect");const Hc=Object.assign(new sC.a,{V_:!1,Msa:!0,LKa:this.$nc(),W_:!0}),hd=this.hb.bKa(this.Vu.value,
Hc);if(r>=hd.count){const Gd=Wa.a.instance.resolve("Common.Comments.ICommentModel").xR(),de=r-hd.count;if(de<Gd.length){L=-1;if(this.B$.Cea.tb(de)){const oe=this.B$.Cea.K(de).SOb;for(var Ba=0;Ba<oe.length;Ba++)if(oe[Ba].Dc===h){L=Ba;break}}this.RGa=-1!==L?Object.assign(new eL,{ppf:de,B0c:L}):null;const qe=Gd[de];y.AFrameworkApplication.va.Ob(Ec.a.SW,2);y.AFrameworkApplication.va.Qb(Ec.a.L6,2,null);y.AFrameworkApplication.va.Qb(Ec.a.selectComment,2,Object.assign(new $O.a,{commentId:qe.id,qca:2,i4:!1}))}}else{this.RGa=
null;var gb=hd.K(b),Ab=hd.K(r);if(!this.cge(gb,h)||!this.cge(Ab,A))throw Error("Provided select range offsets incorrect");y.AFrameworkApplication.va.Ob(Ec.a.SW,2);this.Bmp(gb);var Jb=this.EG.ue(gb,h);Ba=this.EG.Vy(Jb,xc.a.Uc(Ab,A+1));if(L){const Gd=Ba.toArray();h=[];for(const de of Gd)h.push(this.D7d(de.node));h.join(" ").includes(L)||(oa.success=!1,oa.message="The text in clicked passage does not match the selected hit")}var Tb=this.gm.value.Gw,jc=this.ib.gb.currentSelection;jc&&jc.equals(Ba)&&this.qd.tha(Tb,
null);this.qd.tha(Tb,Ba);oa.duration=Date.now()-Z;this.logMessage(oa)}}catch(Hc){oa.success=!1,oa.message=Hc.stack,oa.duration=Date.now()-Z,this.logMessage(oa)}}search(b,h){this.k_a();this.B$.search(Object.assign(new yz,{query:b}),h)}searchV2(b,h){this.k_a();this.B$.searchV2(Object.assign(new yz,{query:b}),h)}selectNextPrevHighlight(b){this.k_a();return this.B$.selectNextPrevHighlight(b)}searchWithParam(b,h){this.k_a();this.B$.search(b,h)}searchWithParamV2(b,h){this.k_a();this.B$.searchV2(b,h)}highlight(b){this.k_a();
this.B$.highlight(Object.assign(new yz,{query:b}))}highlightWithParam(b){this.k_a();this.B$.highlight(b)}getRevision(){return this.qCh.toString()}getSelectedText(){const b=this.Tzk.getSelectedText();return Object.assign(new Jt.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new sC.a,{V_:!1,Msa:!0,LKa:this.$nc(),W_:!0}),h=({gt:Z}=this.yKm(b)).returnValue;if(h)return h;var r=this.ib.gb.currentSelection;if(!r||!r.length)return null;
h=r.Qa;r=r.Xc;let A=-1,L=-1;var Z=Z||this.hb.bKa(this.Vu.value,b);b=null;for(let oa=0;oa<Z.count;oa++){const Ba=Z.K(oa);-1===A&&h.node.id===Ba.id&&(A=oa,b=Ba);-1===L&&r.node.id===Ba.id&&(L=oa)}Z=null;5===(null===b||void 0===b?void 0:b.Lra)&&(Z=Zu.ORf);if(1===(null===b||void 0===b?void 0:b.Lra)||2===(null===b||void 0===b?void 0:b.Lra))Z=Zu.wbg;return Object.assign(new qM,{subdocumentId:Z,startParagraphIndex:A,startParagraphOffset:h.zj,endParagraphIndex:L,endParagraphOffset:r.Po})}clearDocumentSelection(){sM(this.ib)}selectRangeV2(b,
h,r,A,L,Z){const oa=Date.now(),Ba={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.k_a();if(0>h||0>r||0>A||0>L||h>A||h===A&&r>L)throw Error("Provided select range offsets incorrect");var gb=Object.assign(new sC.a,{V_:!1,Msa:!0,LKa:this.$nc(),W_:!0});const jc=this.hb.bKa(this.Vu.value,gb);if(b==Zu.spf)this.wKj(r,A,jc.count);else{gb=this.RGa=null;var Ab={};Ab.subdocumentId=b;Ab.startParagraphIndex=h;Ab.startParagraphOffset=r;Ab.endParagraphIndex=
A;Ab.endParagraphOffset=L;gb=b==Zu.LPi?this.yzi(jc.K(h),{isFloatingImage:!1,imageId:"",...Ab}):this.lIi(jc.K(h),jc.K(A),{clickedPassage:Z,...Ab},Ba);var Jb=this.gm.value.Gw,Tb=this.ib.gb.currentSelection;(null===Tb||void 0===Tb?0:Tb.equals(gb))&&this.qd.tha(Jb,null);this.qd.tha(Jb,gb)}Ba.duration=Date.now()-oa;this.logMessage(Ba)}catch(jc){Ba.success=!1,Ba.message=jc.stack,Ba.duration=Date.now()-oa,this.logMessage(Ba)}}selectRangeV3(b){const h=Date.now(),r={activityName:"InDocSelectRangeData",success:!0,
message:"Select Range Succeeded",duration:0};try{this.k_a();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var A=Object.assign(new sC.a,{V_:!1,Msa:!0,LKa:this.$nc(),W_:!0});const oa=this.hb.bKa(this.Vu.value,A);if(b.subdocumentId==Zu.spf)this.wKj(b.startParagraphOffset,
b.endParagraphIndex,oa.count);else{A=this.RGa=null;A=b.subdocumentId==Zu.LPi?this.yzi(oa.K(b.startParagraphIndex),b):this.lIi(oa.K(b.startParagraphIndex),oa.K(b.endParagraphIndex),b,r);var L=this.gm.value.Gw,Z=this.ib.gb.currentSelection;(null===Z||void 0===Z?0:Z.equals(A))&&this.qd.tha(L,null);this.qd.tha(L,A)}r.duration=Date.now()-h;this.logMessage(r)}catch(oa){r.success=!1,r.message=oa.stack,r.duration=Date.now()-h,this.logMessage(r)}}MEm(){const b=Date.now(),h={activityName:"GetParagraphNodes",
success:!0,message:"",duration:0},r=Object.assign(new sC.a,{V_:!1,Msa:!1,W_:!0});h.duration=Date.now()-b;this.logMessage(h);return this.hb.bKa(this.Vu.value,r)}jN(b){const h=Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},A=new nb.a;for(const L of b)A.add(this.D7d(L));r.duration=Date.now()-h;this.logMessage(r);return A}yzi(b,h){if(h.isFloatingImage)return h=Q.a.Bf(h.imageId),b=b.Hc.Eb(h),b=qc.SelectionFactory.Er(b);const r=this.EG.ue(b,h.startParagraphOffset);return b=
this.EG.Vy(r,xc.a.Uc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new Oh.a(b,"O365",h,b);if(!this.Gpa||!this.Gpa.getPersonaIconPropertiesArray)return null;b=await this.Gpa.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new rM,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}lIi(b,h,r,A){if(!this.cge(b,r.startParagraphOffset)||!this.cge(h,r.endParagraphOffset))throw Error("Provided select range offsets incorrect");
r.subdocumentId==Zu.ORf?y.AFrameworkApplication.va.Qb(Ec.a.uub,2,new VC.a(b)):y.AFrameworkApplication.va.Ob(Ec.a.SW,2);r.subdocumentId==Zu.wbg?32===y.AFrameworkApplication.va.Qb(Ec.a.Zbb,2,new VC.a(b))&&y.AFrameworkApplication.va.Ob(Ec.a.J3d,2):y.AFrameworkApplication.va.Qb(Ec.a.L6,2,null);b=this.EG.ue(b,r.startParagraphOffset);h=this.EG.Vy(b,xc.a.Uc(h,r.endParagraphOffset+1));if(r.clickedPassage){b=h.toArray();const L=[];for(const Z of b)L.push(this.D7d(Z.node));L.join(" ").includes(r.clickedPassage)||
(A.success=!1,A.message="The text in clicked passage does not match the selected hit")}return h}wKj(b,h,r){const A=Wa.a.instance.resolve("Common.Comments.ICommentModel").xR();h-=r;if(h<A.length){r=-1;if(this.B$.Cea.tb(h)){const L=this.B$.Cea.K(h).SOb;for(let Z=0;Z<L.length;Z++)if(L[Z].Dc===b){r=Z;break}}this.RGa=-1!==r?Object.assign(new eL,{ppf:h,B0c:r}):null;b=A[h];y.AFrameworkApplication.va.Ob(Ec.a.SW,2);y.AFrameworkApplication.va.Qb(Ec.a.L6,2,null);y.AFrameworkApplication.va.Qb(Ec.a.selectComment,
2,Object.assign(new $O.a,{commentId:b.id,qca:2,i4:!1}))}}k_a(){this.Zb&&(this.Zb.currentScope&&this.Zb.currentScope.name===Yh.BD||this.Zb.Gg(Yh.BD))}wAp(){this.qCh=Q.a.create()}D7d(b){if(b.TSb)return"";b=this.hb.text(b);return On.AParagraphNode.KP(b," ")}cge(b,h){b=this.D7d(b);return h<b.length}qRb(b,h){switch(h){case 1:case 2:case 3:this.wAp()}}logMessage(b){const h=[Object.assign(new da.a,{name:"Message",string:b.message})];Object(me.a)(b.activityName,b.success,b.duration,h)}EAg(b){return!b.TSb&&
this.X9c(b)}X9c(b){const h=this.Vu.value;return!!h&&!!h.ud&&!!b.Hc&&b.Hc.id.equals(h.ud.id)}Bmp(b){this.hb.Rnc(b)?32===y.AFrameworkApplication.va.Qb(Ec.a.Zbb,2,new VC.a(b))&&y.AFrameworkApplication.va.Ob(Ec.a.J3d,2):y.AFrameworkApplication.va.Qb(Ec.a.L6,2,null)}hte(b,h,r){this.ZD&&(this.ZD.Qo(b),this.ZD.ut(h),this.ZD.ly(r))}yKm(b){let h=null;if(!this.yi.iu||!this.RGa)return{returnValue:null,gt:h};const r=Array.indexOf(this.yi.xR(),this.yi.iu);if(0>r)return{returnValue:null,gt:h};h=this.hb.bKa(this.Vu.value,
b);var A=dL.a.R7d(this.yi.iu.text[0]).split("\n");b=0;A=(1===A.length?A[0]:A.join(" ")).length-1;this.RGa&&r===this.RGa.ppf&&this.B$.Cea.tb(r)&&this.B$.Cea.K(r).SOb.length>this.RGa.B0c&&(b=this.B$.Cea.K(r).SOb[this.RGa.B0c].Dc,A=this.B$.Cea.K(r).SOb[this.RGa.B0c].end);return{returnValue:Object.assign(new qM,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:A,subdocumentId:"Comment"}),gt:h}}twm(b,h){const r=[];if(12!=b.type)return r;r.push(...this.Swm(b,
h));r.push(...this.vtm(b,h));return r}vtm(b,h){const r=[],A=hb.a.eb(b);if(!A.QA())return r;let L=A.je();for(;L;){if(!this.NWa(L)){L=A.Mv();continue}const Z=L.properties;Z&&Id.a.t9c(Z)&&r.push(this.q2j(Z,h,0,b.Hc,!0,L.id.toString()));L=A.Mv()}return r}NWa(b){if(19!==b.type||5!==Id.a.Ik(b))return!1;b=hb.a.eb(b);if(!b.QA())return!0;let h=b.je();for(;h;){if(59===h.type)return!1;h=b.Mv()}return!0}Swm(b,h){const r=[],A=b.Hc;if(A){if(!b.hasProperty(Ke.a.Sn))return r;var L=b.ka(Ke.a.Sn,null);if(!L)return r;
b=b.ka(Ke.a.An,null);for(let oa=0;oa<L.length;++oa){var Z=L[oa];if(!Z)continue;Z=A.Eb(Z);if(!Z||!Id.a.t9c(Z)||5!==Id.a.Ik(Z))continue;let Ba=0;0!=oa&&b&&oa-1<b.length&&(Ba=b[oa-1]);r.push(this.q2j(Z,h,Ba,A,!1,""))}return r}}q2j(b,h,r,A,L,Z){A=(new Sys.Net.WebRequest).getResolvedUrl()+Id.a.qDm(b,A);const oa=b.ka(Od.a.Bu,""),Ba={};Ba.base64Encoding=oa;Ba.url=A;Ba.width=Id.a.FF(b);Ba.height=Id.a.rL(b);Ba.altText=Id.a.x_(b);Ba.description=Id.a.AVa(b);Ba.imageId=Z;Ba.isFloatingImage=L;return{data:Ba,startParagraphIndex:h,
endParagraphIndex:h,startOffsetInParagraph:r,endOffsetInParagraph:r+1}}Dmm(b){return{data:{comment:YN(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(u.a)(kE,"WordDocumentContentExecutor",cL,[]);class bJ{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(u.a)(bJ,"BaseDocumentHelper",null,[415]);class cJ extends bJ{constructor(b){super();
this.uem=b}get Kgc(){const b=this.uem.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return ab.StaticActiveAppFrame.za().kb.isEditingAllowed}author(){var b;return null===(b=this.Kgc)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.Kgc)||void 0===b?void 0:b.creationDate}}Object(u.a)(cJ,"WordDocumentHelper",bJ,[]);class bP{constructor(b){this.Maj=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.IUf(b.htmlText)}getId(){return"InsertContentExecutor"}IUf(b){return this.executeCommand(vb.a.Gqa,
b)}executeCommand(b,h){const r=new lj.DictionaryPropertySet;r.setValue(Od.a.XX,h);r.setValue(Od.a.GDa,!1);h=this.Maj.Ob(b,1);32===h&&(h=this.Maj.Qb(b,2,r));return h}}Object(u.a)(bP,"WordInsertContentExecutor",null,[348,349]);var aO=d(1733),c=d(1734);class k{constructor(b,h,r,A,L){this.JFc="undefined";this.$zg="Something went wrong with retrieving a summary. Please try again.";this.oen=(Z,oa,Ba,gb,Ab)=>Kt.Y_(Z,oa,Ba,gb,this.UD,Ab);this.Vye=(Z,oa,Ba,gb,Ab)=>{if(1===Ba)return this.XAk?32:8;Z=DK.getSelectedText();
Z=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,DK.f8d(Z));Ab[Um.a.LabelText]=Z;return 32};this.oFf=(Z,oa,Ba)=>{if(1===Ba)return 32;const gb={};this.x4a?this.x4a.generateDocumentSummary().then(Ab=>{Ab||(Ab=this.$zg,v.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));gb.additionalData=this.Frf(Ab);this.ga.Qb(Za.a.Daa,2,gb)}).catch(()=>{v.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");
gb.additionalData=this.Frf(this.$zg);this.ga.Qb(Za.a.Daa,2,gb)}):(v.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),gb.additionalData=this.Frf(this.$zg),this.ga.Qb(Za.a.Daa,2,gb));return 32};this.vop=(Z,oa,Ba)=>{if(!this.Abj)return v.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Ba)return this.Eun()?32:2;if(2===Ba)this.Abj.f9d(this.Aa.jb("SmartLookupShredderServiceEndpoint")).then(gb=>{gb={token:gb,
files:H.c(this.qsm()),type:"MultiFilesDeckGeneration"};gb=Object.assign(new aO.a,{selection:Object.assign(new Jt.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new nt.a,{landingTab:"All",data:gb}),entryPoint:38});this.ga.Qb(Za.a.bba,2,gb);return 32}).catch(()=>{v.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.UD=b;this.ga=h||y.AFrameworkApplication.va;this.Aa=r;this.DAk=(this.nA=!!y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Gb.F7)&&!!this.Aa&&this.Aa.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.XAk=!!this.Aa&&this.Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);A&&A.execute(Z=>{this.x4a=Z});this.Abj=L}Xb(){this.ga.fb(Ec.a.oVh,Gc.a.frame,this.oen,1028);this.ga.fb(Ec.a.Vye,Gc.a.frame,this.Vye,1028);this.ga.fb(Ec.a.Gri,Gc.a.frame,this.oFf,1028);this.ga.fb(Ec.a.r2j,Gc.a.frame,this.vop,1028);this.DAk&&(this.JFc=ab.StaticActiveAppFrame.za().OQ.getWindowMode(),
this.Wji(this.JFc),ab.StaticActiveAppFrame.za().OQ.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.JFc&&(this.JFc=h,this.Wji(this.JFc))}))}Eun(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}Wji(b){"DP"===b&&Ol.UISurfaces.Lv().then(h=>{h.selectors.getTabbedTaskPaneCount()||
this.ga.Qb(Ec.a.oVh,2,{SourceControlId:"smartlookupAuto"});return null})}Frf(b){return{["documentSummary"]:b}}qsm(){const b=new c.a("docx",y.AFrameworkApplication.J.jb("EditDocInClientUrl"),y.AFrameworkApplication.J.jb("BreadcrumbBrandUrl"),"",y.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(u.a)(k,"WordInsightsActor",null,[]);class t{constructor(){this.Dyd=this.$S=null}c9a(){return this.cQb()}Zzi(){return this.cQb()}Xzi(){return null}N8o(b,
h,r){this.$S||(this.$S=this.iYd());this.$S.mS(b,h,r)}O8o(b,h,r){this.$S||(this.$S=this.iYd());this.$S.fCg(b,h,r)}b7o(b,h){this.Dyd||(this.Dyd=null);this.Dyd&&this.Dyd.fCg(b,h)}l_b(b,h){this.$S||(this.$S=this.iYd());this.$S.l_b(b,h)}Oge(b){this.$S||(this.$S=this.iYd());this.$S.Oge(b)}aQo(){this.$S&&this.$S.qwc()}QUo(){this.$S&&this.$S.Swe()}n6o(){var b=y.AFrameworkApplication.J.jc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-t.x5i<=b;b||(t.x5i=window.performance.now());
return b}dispose(){this.$S&&(this.$S.dispose(),this.$S=null)}get wTb(){return this.$S?this.$S.isVisible:!1}}t.x5i=0;Object(u.a)(t,"InsightsManager",null,[2E3,10]);class B{constructor(b,h,r,A,L,Z=!0,oa=null,Ba=null){this.o9=this.DG=this.hRa=null;this.$Jc=!1;this.Oia=null;this.Zb=h;this.h8b=Z;this.efh=Ba?Ba:new bJ;this.uv=oa;this.gq=b;this.h8b&&(Wa.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime")&&(this.Oia=Wa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").tJf()),this.Kkb=
Wa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.GJb=this.Kkb.u4c())}Vvb(b){if(this.h8b){b=b.rawEvent;try{var h=H.a(b.data)}catch(r){v.ULS.sendTraceTag(595161728,1303,15,this.aX("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.DG&&(b=this.DG.entryPoint);this.Kkb.VMf(this.o9,this.efh,this.Zkc(),b).then(r=>{h.data=r;this.Fwb(h)});break;case 118:h.data=this.DG?this.DG:Object.assign(new mt.a,{selection:Object.assign(new Jt.a,
{neighborhood:this.hRa.neighborhood,mentionStart:this.hRa.mentionStart,mentionLength:this.hRa.mentionLength})});this.Fwb(h);break;case 103:b=H.a(Object(Ca.a)(String,h.data));Sl.sendTelemetryEvent(b);break;case 206:this.Kkb.f9d(h.data).then(r=>{h.data=r;this.Fwb(h)});break;case 112:h.data.shiftPressed?(aa.a.nj&&document.activeElement.blur(),this.gq.W9d(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.aX("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.gq.q5c(0,null,2,null,null),
v.ULS.sendTraceTag(592545155,1303,50,this.aX("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Fsa()}}}Dmd(b){if(this.Oia){var h=0;this.DG&&(h=this.DG.entryPoint);this.Kkb.VMf(this.o9,this.efh,this.Zkc(),h).then(r=>{Sl.xLj("SearchFromHost",this.o9);this.DG.launchData||(this.DG.launchData=new nt.a);const A=kM();try{this.Oia.search(this.DG,r,y.AFrameworkApplication.userSessionId,A,b),this.Kkb.Abo(L=>{Sl.xLj("SearchFromHostWithToken",this.o9);this.Oia.searchAuthenticatedProviders(this.DG,
r,y.AFrameworkApplication.userSessionId,A,null,L)})}catch(L){Sl.fB("BaseSmartLookupPane - Fail to search from host. Error: "+L,10)}}).catch(r=>{Sl.fB("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}rwc(b){if(this.h8b){var h=Sl,r=h.rwc,A=this.o9;b=Math.round(window.performance.now()-b);var L=this.DG?dG[this.DG.entryPoint]:"",Z=this.Kkb.u4c(),oa=this.Kkb.hsm(),Ba=this.DG?this.DG.entryPoint:0;r.call(h,A,b,L,Z,oa,y.AFrameworkApplication.Lgf,this.$Jc,
18===Ba||19===Ba||15===Ba)}}}Object(u.a)(B,"BaseSmartLookupPane",null,[396,10]);class P{constructor(b){this.messageType=null;this.messageType=b}}Object(u.a)(P,"InsightsMessage",null,[]);class ca extends P{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(u.a)(ca,"InsightsMessageWithContent",P,[]);class sa extends ca{constructor(b){super(Yh.NNn,b)}}Object(u.a)(sa,"InsightsMessageAppProperties",ca,[]);class Qa extends ca{constructor(b){super(Yh.YNn,b)}}Object(u.a)(Qa,
"InsightsMessageSelection",ca,[]);class lb extends P{constructor(){super(Yh.$Nn)}}Object(u.a)(lb,"InsightsMessageTakeFocus",P,[]);class Lb extends B{constructor(b,h,r,A,L=null,Z=null,oa=null,Ba=!0,gb=null,Ab=null){super(h,r,L,Z,oa,Ba,gb,Ab);this.Dxd=this.BC=this.Pj=null;this.FId=!1;this.L_n=Jb=>{Jb===this.Pj&&this.Fsa()};this.rsc=()=>{v.ULS.sendTraceTag(6295951,1303,50,this.aX("The iframe is successfully loaded in Insights task pane"))};this.Uvb=()=>{v.ULS.sendTraceTag(6295952,1303,15,this.aX("The iframe failed to load in Insights task pane"))};
this.zDd=b;this.JIc=this.h8b?$K(this.GJb):y.AFrameworkApplication.ncn;this.g2();this.Vpg();this.Qp=A;this.Sdh=0}get isVisible(){return!1}g2(){this.Pj=this.zDd.QXc();y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb.Jtb&&this.Pj.xwo(b=>{b===this.Pj&&(this.Swe(),this.qwc())});this.jUf(this.Pj.K_a.cWh);this.Pj.xn()}jUf(b){b.style.overflow="hidden";const h=Ug.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.BC=h;b.appendChild(this.BC);
this.BC.id=Yh.MSf}Vpg(){zc.a.addHandler(this.BC,"load",this.rsc);zc.a.addHandler(this.BC,"error",this.Uvb);$addHandler(window,"message",Object(D.a)(this,this.Vvb,"onIFrameMessage"))}EJg(){zc.a.removeHandler(this.BC,"load",this.rsc);zc.a.removeHandler(this.BC,"error",this.Uvb);$removeHandler(window,"message",Object(D.a)(this,this.Vvb,"onIFrameMessage"))}dispose(){this.BC&&(this.EJg(),this.BC.parentNode.removeChild(this.BC),this.BC=null);this.Pj&&(this.zDd.Cgc(this.Pj),this.Pj=null)}mS(b,h,r){this.o9=
h;this.Dxd=null;this.Sdh=r;this.$Jc=!b.mentionLength;this.FId=!1;v.ULS.sendTraceTag(6295947,1303,50,this.aX("Start to show Insights"));this.hRa=b;this.JIc&&this.JIc.length?this.BC.src=this.JIc:(this.BC.src=Lb.Jhj,v.ULS.sendTraceTag(6295948,1303,15,this.aX("The Insights URL config setting is null or empty")));this.Qp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.Pj.f0||this.Pj.aqg(this.L_n);this.h8b&&this.Dmd(!1);b=window.performance.now();this.zDd.showTaskPane(this.Pj);this.Pj.xn();
this.rwc(b)}fCg(b,h,r){this.DG=b;this.mS(Object.assign(new XK.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}l_b(){}Oge(){}qwc(){this.BC.src===this.JIc&&this.FId&&(this.Zb.Gg(Yh.BD),this.Fwb(new lb))}Swe(){this.BC&&Sg.FocusManager.LN(this.BC.contentWindow)}Muf(){this.BC.src=Lb.Jhj;this.Pj.yn()}Fsa(){this.zDd.hideTaskPane(this.Pj);this.Muf()}Vvb(b){const h=b.rawEvent;if(h.source===this.BC.contentWindow)if(this.h8b)super.Vvb(b);
else{let r;try{r=H.a(h.data)}catch(A){v.ULS.sendTraceTag(6295953,1303,15,this.aX("Message data [{0}] failed to deserialize.",h.data));return}if(xf.c(r.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.aX("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Yh.ONn:this.Fwb(new sa(this.bxm()));break;case Yh.ZNn:this.Fwb(new Qa(this.hRa));break;case Yh.UNn:this.FId=!0;this.Swe();this.qwc();v.ULS.sendTraceTag(6295955,1303,50,this.aX("Insights pane rendering is completed"));
break;case Yh.aOn:b=r.messageContent;this.Dxd=b.clientCorrelationId;this.o9!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,15,this.aX("App correlation ID on client {0} does not match one on server {1}",this.o9,b.appCorrelationId));break;case Yh.TNn:r.messageContent?(aa.a.nj&&document.activeElement.blur(),this.gq.W9d(0,null,2,null,null),v.ULS.sendTraceTag(6604741,1303,50,this.aX("Insights UX lost focus through Ctrl + Shift + F6"))):(this.gq.q5c(0,null,2,null,null),v.ULS.sendTraceTag(6604742,
1303,50,this.aX("Insights UX lost focus through Ctrl + F6")));break;case Yh.QNn:r.messageContent.keyCode===jf.a.Dfb&&this.Fsa();break;case Yh.RNn:try{this.FId=!1,localStorage.setItem(Yh.s6i,"true")}catch(A){v.ULS.sendTraceTag(17961859,1303,10,this.aX("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}bxm(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.o9;3===y.AFrameworkApplication.ua.Gb.Mk?b.applicationName=Yh.XKp:4===y.AFrameworkApplication.ua.Gb.Mk&&(b.applicationName=
Yh.b6n);b.applicationVersion=y.AFrameworkApplication.buildVersion;var h=kg.a.Eg(y.AFrameworkApplication.lcid);h=h?h.name:null;b.market=eG(h);b.uiLanguage=h;b.sessionId=y.AFrameworkApplication.userSessionId;b.parentalControl=Yh.xig;b.clientType="user";b.legalAgreed=this.jym();b.defaultDefineTab=1===this.Sdh?"true":null;return b}aX(b,...h){const r={};this.o9&&(r[Yh.H_j]=this.o9);this.Dxd&&(r[Yh.Ejp]=this.Dxd);r[Yh.I_j]=String.format.apply(null,[b].concat(h));return H.c(r)}Zkc(){return 5}jym(){try{const b=
localStorage.getItem(Yh.s6i);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,1303,10,this.aX("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Fwb(b){b=H.c(b);this.BC.contentWindow.postMessage(b,Ma.a.getOrigin(this.JIc))}}Lb.Jhj="about:blank";Object(u.a)(Lb,"InsightsPane",B,[]);class bc{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(u.a)(bc,"SmartLookupTaskPaneProps",null,[]);class Cc{}Object(u.a)(Cc,"ActionDescriptor",null,[]);class kd extends B{constructor(b,
h,r,A=null,L=null,Z=null,oa=!0,Ba=null,gb=null){super(h,r,A,L,Z,oa,Ba,gb);this.c$e=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Gb&&y.AFrameworkApplication.ua.Gb.v0f;this.ey=this.c5e=!1;this.MEk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.KEk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.PEk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.OEk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);this.Aoj=()=>{if(this.Oia)this.Oia.onPaneThemeChanged(this.Zkc());return eg.a("getTheme")?appChrome.api.getTheme():null};this.Uvb=()=>{Sl.fB("ReactSmartLookupPane - Iframe component failed to load.",10)};this.rsc=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Sl.fB("ReactSmartLookupPane - Onload detected no network.",
50)};oa||Sl.fB("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.AGa=b;this.Klh=$K(this.GJb)}get isVisible(){return this.ey}l_b(b,h){this.DG=b;this.hRa=b=Object.assign(new XK.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.$Jc=!b.mentionLength;this.o9=h;this.Dmd(!1)}Oge(b){this.DG=b;this.Sxc(Object.assign(new XK.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength}),!1)}mS(b,h){this.o9=h;this.Sxc(b,!0)}fCg(b,h,r){this.DG=b;this.mS(Object.assign(new XK.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}Fsa(){this.kha();this.AGa.hideTaskPane()}Sxc(b,h){cc.SessionStatusManager.instance.WA&&this.Oia?(this.hRa=b,this.$Jc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?y.AFrameworkApplication.J.$("SmartLookupDisableRefreshPaneIsEnabled")?
(this.AGa.updateTaskPane(null),h&&this.IQo()):(h&&this.Dmd(!1),this.c5e=!this.c5e,this.AGa.updateTaskPane(this.LB())):(h&&this.Dmd(this.isVisible),this.AGa.showTaskPane(this.LB())),this.rwc(b)):(this.AGa.showTaskPane(this.LB()),Sl.cQo(cc.SessionStatusManager.instance.WA,!!this.Oia,this.DG?dG[this.DG.entryPoint]:"",this.Kkb.u4c(),y.AFrameworkApplication.Lgf,this.$Jc))}IQo(){if(!this.DG){const b=Object.assign(new Jt.a,{neighborhood:this.hRa.neighborhood,mentionStart:this.hRa.mentionStart,mentionLength:this.hRa.mentionLength});
this.DG=Object.assign(new mt.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.Dmd(this.isVisible)}oQo(){const b=new Cc;b.transactionId=this.o9;b.actionType=15;b.channelId=Yh.channelId;this.Fwb(b)}Vvb(b){const h=b.rawEvent;document.getElementById(Yh.BD)&&h.source!==document.getElementById(Yh.BD).contentWindow||this.bpo(b)}bpo(b){const h=b.rawEvent;let r;try{r=H.b(h.data)}catch(A){v.ULS.sendTraceTag(545604257,1303,15,this.aX("Message data from Serplet [{0}] failed to deserialize.",
h.data));return}switch(r.actionType){case 32:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Je.a.srb()>=this.MEk?this.AGa.updateTaskPane(this.ptf(this.KEk)):Je.a.srb()>=this.PEk&&this.AGa.updateTaskPane(this.ptf(this.OEk)));break;case 33:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.AGa.updateTaskPane(this.ptf(r.data));break;case 42:this.AGa.updateTaskPane(this.bLl(r.data));
break;case 43:this.AGa.updateTaskPane(this.LB());break;default:super.Vvb(b)}}dispose(){}initialize(){this.g2();this.xna()}g2(){this.AGa.QXc()}xna(){const b=this.Zb.ie(Yh.BD);b.parent=Qf.AFrame.Gq;b.IL=!0}XUo(){this.Zb.Gg(Yh.BD)}kha(){this.wab()&&this.Zb.Gg(this.Zb.QW)}Vpg(){$addHandler(window,"message",Object(D.a)(this,this.Vvb,"onIFrameMessage"))}EJg(){$removeHandler(window,"message",Object(D.a)(this,this.Vvb,"onIFrameMessage"))}wab(){return!!this.Zb.currentScope&&this.Zb.currentScope.name===Yh.BD}Fwb(b){b=
H.c(b);document.getElementById(Yh.BD)&&document.getElementById(Yh.BD).contentWindow.postMessage(b,Ma.a.getOrigin(this.Klh))}aX(b,...h){const r={};this.o9&&(r[Yh.H_j]=this.o9);r[Yh.I_j]=String.format.apply(null,[b].concat(h));return H.c(r)}Zkc(){return eg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}qwc(){}Swe(){document.getElementById(Yh.BD)&&Sg.FocusManager.LN(document.getElementById(Yh.BD).contentWindow)}Pqm(){return this.DG?10===this.DG.entryPoint?2===y.AFrameworkApplication.ua.Gb.Mk?
CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.DG.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.DG.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.DG.entryPoint||38===this.DG.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}LB(){var b=CommonUIStrings.L_SmartLookupPaneTitle;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&
(b=this.Pqm());const h=new bc;h.src=this.Klh;h.id=Yh.BD;h.refreshPane=this.c5e;h.onError=this.Uvb;h.onLoad=this.rsc;h.title=b;cc.SessionStatusManager.instance.WA?this.Oia||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new eo.a,{title:b,hideHeader:!1,width:Yh.width,location:Yh.I9n,contentProps:h,isModernPane:!0,onOpen:()=>{this.XUo();this.ey=!0;this.Vpg();eg.a("registerOnThemeChangeCallback")&&
appChrome.api.registerOnThemeChangeCallback(this.Aoj);y.AFrameworkApplication.ua.Ge();if(this.Oia)this.Oia.onPaneStateChanged(!0)},onClose:()=>{this.oQo();this.kha();this.ey=!1;this.EJg();eg.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.Aoj);y.AFrameworkApplication.ua.Ge();if(this.Oia)this.Oia.onPaneStateChanged(!1)}});this.c$e&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}bLl(b){const h=this.LB();h.title=b;h.contentProps.title=b;return h}ptf(b){const h=
this.LB();h.resizeWidth=b;return h}}Object(u.a)(kd,"ReactSmartLookupPane",B,[]);class yd{QXc(){const b=new Eo.a(tj.a.Z5a,WordEditorIntl.WordEditorStrings);return Lq.a.instance.Vai(Yh.BD,Yh.ktc,Yh.width,Yh.dGg,b)}showTaskPane(b){Lq.a.instance.showTaskPane(b)}hideTaskPane(b){Lq.a.instance.hideTaskPane(b)}Cgc(b){Lq.a.instance.Cgc(Yh.BD,b)}}Object(u.a)(yd,"WordInsightsPaneHandler",null,[372]);class Td{QXc(){Lq.a.instance.iUa()}showTaskPane(b){Ol.UISurfaces.Lv().then(h=>{h.showTaskPane(Yh.BD,b);return null})}updateTaskPane(b=
null){Ol.UISurfaces.Lv().then(h=>{h.setSelectedTaskPane(Yh.BD);b&&h.updateTaskPane(Yh.BD,b);return null})}hideTaskPane(){Ol.UISurfaces.Lv().then(b=>{b.hideTaskPane(Yh.BD,2);return null})}}Object(u.a)(Td,"WordReactSmartLookupPaneHandler",null,[371]);class ie extends t{constructor(b,h){super();this.Qy=b;this.ib=h}iYd(){const b=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Gb&&y.AFrameworkApplication.J.$("SmartLookupEnableNativePane");return y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Gb&&
y.AFrameworkApplication.ua.Gb.m_f?new kd(new Td,Gp.a.instance,Sg.FocusManager.instance(),Wa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Wa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Wa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Wa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Wa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new Lb(new yd,Gp.a.instance,Sg.FocusManager.instance(),
Wa.a.instance.resolve("Common.Utils.IAriaNotifier"),Wa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Wa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Wa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Wa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Wa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}cQb(){return this.Qy.getSelectedText()}Xzi(){if(!this.ib||!this.ib.gb||1>this.ib.gb.length)return null;
var b=this.ib.gb.currentSelection.Qa;b=null==b?null:Ya.FormattingReader.Vs(b);return(b=null==b?null:kg.a.Eg(Ya.FormattingReader.language(b)))?b.name:""}c9a(){return this.Qy.HMf()}Zzi(){return this.Qy.HMf()}YYi(){return this.Qy.ain()}}Object(u.a)(ie,"WordInsightsManager",t,[]);var Se=d(218);class Ie{}Object(u.a)(Ie,"CommandMetadataResponse",null,[]);class nd{constructor(){this.OSf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Se.PrivacyDialogManager.Tye()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new Ie;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),A=Array(2);A[0]=r["default"];A[1]=r.icon32;h.svgData=this.getCommandIconSvg(A)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.OSf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.OSf)return this.OSf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=nd.u6l;h.telemetryGroup=r;h.appData=b;return h}}nd.ZNi="FA000000012";nd.queryPrefix="AssetID=";nd.u6l="SearchPane";Object(u.a)(nd,"BaseSerpletExecutor",null,[381,349]);
class Zd extends nd{constructor(b,h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(vb.a.BUb,2,null);break;case 1:this.ga.Qb(Ec.a.B0b,2,null);break;case 2:this.ga.Qb(vb.a.cZc,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb(Za.a.mce,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb(Za.a.d_b,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(Za.a.FCf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};sM(this.ib);this.ga.Qb(Za.a.FCf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(Za.a.fic,2,h)}openNavigationPane(){this.ga.Qb(Ec.a.Oxc,2,null)}openSerpletTaskPane(){this.ga.Qb(Za.a.nUi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb(Za.a.gce,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(A=>b[A.id]=JSON.stringify(A)))}return b}}Object(u.a)(Zd,"WordSerpletExecutor",nd,[]);class Qg extends nM{constructor(){super();this.q2e=null;this.iz=()=>{y.AFrameworkApplication.Y2&&(this.EYl(),qo.a.im().then(()=>this.q2e.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){y.AFrameworkApplication.Y2&&(this.q2e.Oa("WordEditor.Insights.WordInsightsActor").Xb(),
y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?y.AFrameworkApplication.J.vp(this.iz):super.init())}wc(b){super.wc(b);this.q2e=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new Us.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new bP(y.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new Zd(y.AFrameworkApplication.va,If.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new gG(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new Zu(new rg.a(()=>ab.StaticActiveAppFrame.za()?ab.StaticActiveAppFrame.za().kb.hd:
null),b.resolve("Box4.IParagraphReader"),VN.a.instance,y.AFrameworkApplication.J,Ls.a.instance,kP.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),y.AFrameworkApplication.va,If.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new kE(new rg.a(()=>ab.StaticActiveAppFrame.za()?ab.StaticActiveAppFrame.za().kb.hd:null),b.resolve("Box4.IParagraphReader"),Object(Kb.a)(),If.a.instance,b.resolve("Box4.ISelectionFactory"),h,ed.a.jf.Tl.qf(12),
new rg.a(()=>ab.StaticActiveAppFrame.za().kb),Sg.FocusManager.instance(),b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.Ta("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new ie(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();
b.ia("WordEditor.Insights.WordInsightsActor",()=>new k(b.nf("Common.App.Insights.IInsightsManager"),y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ia("Common.App.SearchCommon.IDocumentHelper",()=>new cJ(b.Ta("WordEditor.Extension.DocumentProperties"))).ha()}}Object(u.a)(Qg,"WordInsightsPackage",nM,[]);class Nh{}Object(u.a)(Nh,"ScalingStep",null,[]);class Hi{constructor(b,h,r){this.mJc=
!1;this.ES=null;this.vQc=this.R7b=!1;this.G4a=[];this.yue=A=>{this.oda&&this.oda!==A&&appChrome.api.dispatch(this.QFi(!1))};h.execute(A=>{this.ES=A});b.AB(Object(D.a)(this,this.T3n,"onProcessSetSelectionFinished"));this.vr=r}Ikc(b,h,r){const A=[];for(const L of b)A.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:L},r));return A}oEi(b){const h=[];for(let r=0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));
h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}QFi(b){const h=[];if(b)switch(this.oda){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.oEi("PictureStyles"));h.push(...this.Ikc("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.G4a.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.Ikc(b,
"MoveToOverflow"));break;case "Table":this.vQc||h.push(...this.oEi("TableStyles"));h.push(...this.Ikc(this.G4a,"DropLabel",this.vQc?0:void 0));b=this.G4a.slice().reverse();h.push(...this.Ikc(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.Ikc(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.G4a.slice().reverse(),h.push(...this.Ikc(b,"MoveToOverflow"))}else for(const r of this.G4a)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,"Home"));return h}Hsd(b){const h={};for(const r of b)try{h[r]=
appChrome.selectors.getModelType(r)}catch(A){this.DI("Error","GetModelType failed for "+r)}ab.StaticActiveAppFrame.za().X3d(h)}fvp(b){if(0!==b.length){var h=[],r={},A=!1;for(const L of b)try{if(appChrome.selectors.isControlDefined(L))r[L]=appChrome.selectors.getModelType(L);else{A=!0;break}}catch(Z){this.DI("Error","GetModelType failed for "+L);A=!0;break}if(A)this.oda=void 0,this.iEe(!1);else{if("Image"===this.oda&&!this.R7b)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.R7b=!0;
else if(this.R7b){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));A=appChrome.selectors.getVisibleControlsInGroup("Font");for(const L of A)r[L]=appChrome.selectors.getModelType(L);this.R7b=!1}ab.StaticActiveAppFrame.za().X3d(r);this.G4a=b;r=[];for(const L of b)appChrome.selectors.isControlDisabled(L)&&r.push(L);0<r.length&&this.DI("Disabled",r.join(","));0<this.G4a.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.G4a)),h.push(...this.QFi(!0)),this.mJc=!0);appChrome.api.dispatch(h)}}}iEe(b){if(b||this.mJc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.mJc=b;if("Image"===this.oda||this.R7b){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.Hsd(r)}this.R7b=!b}appChrome.api.dispatch(h)}}jAc(){this.mJc&&this.vr&&this.vr.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}T3n(b,
h){!y.AFrameworkApplication.ua.Gb.yxc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.ES&&h.Rm&&h.Rm.currentSelection&&0!==h.Rm.length?(b=()=>{let r=[],A=!1;var L=this.ES.contentType,Z=appChrome.selectors.getActiveContextualTabIds();L.includes("Image")?(this.yue("Image"),this.oda&&"Image"===this.oda?A=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),
this.oda="Image")):L.includes("Table")&&0<=Z.indexOf("Table")?(L=!(Bt.a.instance.currentSelection.DLa||Bt.a.instance.currentSelection.Yw||Bt.a.instance.currentSelection.vab),(Z="Table"===this.oda&&L!==this.vQc)?this.yue("TableCellEdit"):this.yue("Table"),!this.oda||"Table"!==this.oda||Z?(L?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.vQc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.vQc=!1),this.oda="Table"):A=!0):L.includes("Hyperlink")&&(this.yue("Hyperlink"),this.oda&&"Hyperlink"===this.oda?A=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.oda="Hyperlink"));A?this.mJc||(this.Hsd(this.G4a),this.iEe(!0),this.jAc()):0<r.length?(this.fvp(r),this.jAc()):this.iEe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.iEe(!1)}DI(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new Ia.a;h.name="Events";h.dataFields=lg.a.iI(b);h.durationMs=window.performance.now();Y.a.DNa(h,"TellMeWAC.")}}Object(u.a)(Hi,"AdaptiveTabGroupUpdater",null,[]);class Pf{constructor(){this.Z=null;this.fWn=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.Z.ia("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new Hi(this.Z.resolve("Box4.ISelectionManager"),this.Z.Ta("Common.IActionContextProvider"),this.Z.Ta("Common.ISystemInitiatedFeedback"))).ha(),
this.Z.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}wc(b){this.Z=b}init(){bz.a(1,this.fWn)}dispose(){}}Object(u.a)(Pf,"PackageManager",null,[0,1]);var rk=d(1873),hj=d(1095),Ri=d(1870);const Oi=(b,h,r)=>1===r?32:2===r?(d.e(5).then(d.bind(null,2166)).then(A=>{(0,A.createAndShowDevToolsMenu)()}),32):2;class Ej{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))y.AFrameworkApplication.va.qa(Ec.a.FBg,Gc.a.frame,Oi),null!==sessionStorage.getItem("devToolsRefresh")&&d.e(5).then(d.bind(null,2166))}dispose(){}wc(b){x(b)}static main(){E.a.instance.Mc(new Ej)}}Object(u.a)(Ej,"WordDevToolsPackage",null,[0,1]);d(596);class Vk{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(u.a)(Vk,"FormattingData",null,[]);class Fj extends Vk{constructor(){super();this.hyperlinkData=null}}Object(u.a)(Fj,"RichContentCommandData",
Vk,[]);class tg{constructor(){var b;tg.xj.add(Ec.a.Feb);tg.xj.add(Ec.a.c1b);tg.xj.add(Ec.a.Oyc);tg.xj.add(Ec.a.K0);tg.xj.add(Ec.a.Zag);tg.xj.add(Ec.a.clg);tg.xj.add(Ec.a.deleteComment);tg.xj.add(Ec.a.DYc);tg.xj.add(Ec.a.kvf);tg.xj.add(Ec.a.jze);tg.xj.add(Ec.a.b0a);tg.xj.add(Ec.a.FBg);tg.xj.add(Ec.a.B0b);tg.xj.add(Ec.a.MBg);tg.xj.add(Ec.a.DZc);(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&tg.xj.add(Ec.a.Y_d);
tg.xj.add(Ec.a.X_d);tg.xj.add(vb.a.cZc);tg.xj.add(vb.a.QX);tg.xj.add(vb.a.print);tg.xj.add(vb.a.Qqe);tg.xj.add(vb.a.Nng);tg.xj.add(vb.a.readingMode);tg.xj.add(vb.a.BUb);tg.xj.add(Za.a.c1j);tg.xj.add(Za.a.mu);tg.xj.add(Za.a.Zqd);tg.xj.add(Za.a.d_b);tg.xj.add(Za.a.yla);tg.xj.add(Za.a.ipd);tg.xj.add(Za.a.zBg);tg.xj.add(Za.a.fNg);tg.xj.add(Za.a.Daa);tg.xj.add(Za.a.dMa);tg.xj.add(Za.a.Oof);tg.xj.add(Za.a.CXa);tg.xj.add(Za.a.Gsg);tg.xj.add(Za.a.Fsg);tg.xj.add(Za.a.Hsg);tg.xj.add(Za.a.g_d);tg.xj.add(Za.a.yqa);
tg.xj.add(Za.a.wze);tg.xj.add(Za.a.bUj);tg.xj.add(Za.a.close);tg.xj.add(Za.a.Mre);tg.xj.add(Za.a.Xqe);tg.xj.add(Za.a.koe);tg.xj.add(Za.a.sze);tg.xj.add(Za.a.vze);tg.xj.add(Za.a.WXb);tg.xj.add(Za.a.Iua);tg.xj.add(Za.a.Amc);tg.xj.add(Za.a.mCg);tg.xj.add(Za.a.Vxc);tg.xj.add(Za.a.Tea);tg.xj.add(Za.a.dwc);tg.xj.add(Za.a.Upe);tg.xj.add(Za.a.Euc);tg.xj.add(Za.a.oxj);tg.xj.add(Za.a.O3h);tg.xj.add(Za.a.QVd);tg.xj.add(Za.a.Nof);tg.xj.add(Za.a.Q3h);tg.xj.add(Za.a.P3h);tg.xj.add(Za.a.Oof);tg.xj.add(Za.a.RVd);
tg.xj.add(Ec.a.DGe);tg.xj.add(Ec.a.aOg);tg.xj.add(Ec.a.g3b);tg.xj.add(Ec.a.Zvg);tg.xj.add(Ec.a.Rwb);tg.xj.add(Ec.a.ese);tg.xj.add(Ec.a.$na);tg.xj.add(Za.a.osb);tg.xj.add(Za.a.vob);tg.xj.add(Za.a.Yxc);tg.xj.add(Za.a.Kck);tg.xj.add(Za.a.vxj);tg.xj.add(Ec.a.$id);tg.xj.add(vb.a.GXb);tg.xj.add(vb.a.G3)}}tg.xj=new Set;Object(u.a)(tg,"CommentRibbonCommands",null,[]);class oh{constructor(b,h,r,A,L){this.Ygj=b;this.Mg=h;this.Lp=r;this.hi=A;this.Ykp=L;this.u$b=null;this.bFa=new re.a(0);this.bCb=new re.a(0);
this.cLe=new re.a(0);this.Zaf=!1;this.M7m();this.ixo()}Zgn(b){return this.u$b&&this.Lp.$y?!tg.xj.has(b):!1}qlc(b,h,r){if(b===Za.a.Qg)return 32;if(!this.bFa.tb(b)&&!this.bCb.tb(b)||!this.u$b)return 2;const A=this.bCb.tb(b);var L=A?this.bCb.K(b):this.bFa.K(b);const Z=A?2:this.cLe.K(r);A||1!==Z||(this.Jkn(ab.StaticActiveAppFrame.za().tq.currentScope.name)||ab.StaticActiveAppFrame.za().tq.Gg(this.Mg.an?Qf.AFrame.xt:Qf.AFrame.sR),ab.StaticActiveAppFrame.za().Ge(!0));r=new Fj;switch(L){case 1:r.highlight=
{color:this.OEi(h.Color)};break;case 6:r.fontColor={color:this.OEi(h.Color)}}L=this.u$b.executeCommand(L,Z,r);2===L&&A&&(b===vb.a.muc?h[Tg.a.On]=!!r.bold:b===vb.a.tuc?h[Tg.a.On]=!!r.italic:b===vb.a.Huc?h[Tg.a.On]=!!r.underline:b===vb.a.yuc?h[Tg.a.On]=!!r.strikethrough:b===vb.a.rY?h[Tg.a.On]=!!r.highlight:b===vb.a.hx&&(h[Tg.a.On]=!!r.fontColor));return 2===L?32:1===L?2:8}huo(b){this.u$b=b;this.u$b.registerSelectionChangeHandler(()=>{this.Zaf||(this.Zaf=!0,ab.StaticActiveAppFrame.za().Ge(!0),this.Zaf=
!1)});this.u$b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case jf.a.z3b:case jf.a.Gvd:case jf.a.tIe:case jf.a.Z0a:ab.StaticActiveAppFrame.za().Ge(!0)}h.key!==jf.a.JD&&h.key!==jf.a.I4||ab.StaticActiveAppFrame.za().Ge(!0)})}ixo(){this.Ygj.$Aj(Qf.AFrame.xt,this);this.Ygj.$Aj(Qf.AFrame.sR,this)}M7m(){this.bFa.W(vb.a.bold,0);this.bFa.W(vb.a.fA,3);this.bFa.W(vb.a.strikethrough,4);this.bFa.W(vb.a.underline,5);this.bFa.W(vb.a.rY,1);this.bFa.W(vb.a.Vya,1);this.bFa.W(vb.a.hx,6);this.bFa.W(vb.a.jka,
6);this.bFa.W(vb.a.eva,6);this.bCb.W(vb.a.muc,0);this.bCb.W(vb.a.tuc,3);this.bCb.W(vb.a.yuc,4);this.bCb.W(vb.a.Huc,5);this.cLe.W(1,0);this.cLe.W(2,1)}Jkn(b){return b===Qf.AFrame.xt||b===Qf.AFrame.sR}OEi(b){return b?Ql.a.JB(this.Ykp.lka(this.hi.vd,b)):""}}Object(u.a)(oh,"CommentRibbonCommandHandler",null,[252,253]);class $m{constructor(){this.Z=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.Z.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.Z.resolve("WordEditor.Comments.CommentsState").Gog?
this.Z.resolve("WordEditor.Comments.CommentRibbonCommands"):this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").V3("OnCommentRenderedOnce",()=>{this.Z.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}wc(b){this.Z=b;this.Z.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new oh(this.Z.Oa("Common.INonCanvasCuiUser"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("Common.Comments.ICommentModel"),Fl.a.hm.kb.Qc,Bq.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();
this.Z.ia("WordEditor.Comments.CommentRibbonCommands",()=>new tg).ha()}static main(){E.a.instance.Mc(new $m)}}Object(u.a)($m,"PackageManager",null,[0,1]);var ee=d(2019);class se{constructor(b,h){this.NOl=2E3;this.JLh=null;this.kig=b.prj;this.maxLength=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.NOl);h&&h.execute(r=>{this.JLh=r})}FGf(b){b=this.Gkm(b,this.maxLength);return{semantic:Yq.ObjectSemantic.CanvasContext,type:Yq.ObjectSchemaType.WordCanvasContext,
value:b}}Gkm(b,h){try{return this.Fkm(b,h)}catch(r){return v.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",r),null}}EKm(b,h){const r={N7a:[],rCa:0,selection:{start:null,end:null},cursor:null,tiles:[]},A=b.length;for(let Z=0;Z<A;Z++){const oa=b.K(Z);var L=oa.node;if(!Cd.ParagraphReader.Wb(L)||Array.contains(r.N7a,L.$k))continue;r.N7a.push(L.$k);const Ba=Cd.ParagraphReader.textLength(L);if(r.rCa+Ba>h)break;L=this.kig.Tnb(L);r.tiles.push(L);r.rCa+=Ba;1!==A||
r.cursor||(r.cursor=se.apm(oa,r.tiles.length-1));null===r.selection.start&&0===Z&&(r.selection.start=this.pIi(oa,!0,r.tiles.length-1));null===r.selection.end&&Z===A-1&&(r.selection.end=this.pIi(oa,!1,r.tiles.length-1))}return r}jBm(b,h,r){const A={prd:[],E0j:[],rCa:0};var L=b.K(0).node;let Z=b.K(b.length-1).node;for(b=h;0<b&&(L||Z);){var oa=se.Uvj(L,!0,b,r);if(L=oa.node)L=this.kig.Tnb(L),A.prd.push(L),b-=oa.rCa,L=oa.node,r=oa.N7a;oa=se.Uvj(Z,!1,b,r);if(Z=oa.node)r=this.kig.Tnb(Z),A.E0j.push(r),b-=
oa.rCa,Z=oa.node,r=oa.N7a}A.rCa=h-b;return A}Hkm(b,h){let r=0;var A=this.EKm(b,h);const L={tiles:A.tiles,selection:A.selection,cursor:A.cursor};r+=A.rCa;A=A.N7a;r<h&&(b=this.jBm(b,h-r,A),L.tiles.unshift.apply(L.tiles,b.prd),L.tiles.push.apply(L.tiles,b.E0j),L.selection.start&&(L.selection.start.index+=b.prd.length),L.selection.end&&(L.selection.end.index+=b.prd.length),L.cursor&&(L.cursor.index+=b.prd.length));return L}Fkm(b,h){var r;if(!b)return null;b=this.Hkm(b,h);return{contentType:null===(r=
this.JLh)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}pIi(b,h,r){if(b.contextId===kc.a.Cd||b.contextId===kc.a.paragraph||b.contextId===kc.a.Vc){if(h&&-1!==b.zj)return{index:r,offset:b.zj};if(!h&&-1!==b.Po)return{index:r,offset:b.Po}}return null}static apm(b,h){return b.contextId===kc.a.Vc?{index:h,offset:b.zj}:null}static Uvj(b,h,r,A){A={node:null,rCa:0,N7a:A};if(!b||0>=r||!A.N7a)return A;do A.node=Cd.ParagraphReader.pg(b,h,!1,!1),A.rCa=A.node?
Cd.ParagraphReader.textLength(A.node):0,b=A.node;while(A.node&&(Array.contains(A.N7a,A.node.$k)||!Cd.ParagraphReader.Wb(A.node)||!A.rCa));A.node&&(A.rCa>r?A.node=null:A.N7a.push(A.node.$k));return A}}Object(u.a)(se,"Box4CanvasContextProvider",null,[243]);class Oj{get name(){return"Box4.CanvasContext"}init(){}dispose(){}wc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new se(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Ta("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){E.a.instance.Mc(new Oj)}}
Object(u.a)(Oj,"Box4CanvasContextPackage",null,[0,1]);class fq{constructor(b,h,r,A){this.CK={};this.ybc=this.tLd=0;this.tZd=3E4;this.start=()=>{0!=this.OJb.size&&0===this.ybc&&(this.ybc=window.setInterval(this.gLo,this.tZd),v.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.gLo=()=>{0!=this.OJb.size&&(this.lf.$o?(v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop()):(this.CK.ScanTime=Date.now(),this.CK.NumWatchDogs=this.OJb.size,this.CK.WatchDogManagerScanNumber=
++this.tLd,this.OJb.forEach(async(L,Z)=>{this.CK[Z]=await L.$On();"KickoutComponent"==this.CK[Z].ComponentStatus&&this.L1f(this.Erm(Z));L.Pvn()||v.ULS.sendTraceTag(520974674,306,20,JSON.stringify(this.CK))})))};this.lf=b;this.Qpa=r;this.C1=A;this.bcf=new Map;this.OJb=new Map;h.execute(L=>{this.uk=L;this.uk.BHa((Z,oa)=>{this.F_(oa)})})}F_(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.ybc||(v.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",
b.newState),this.stop()):(this.stop(),this.start(),this.yHo(),v.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.ybc&&(window.clearInterval(this.ybc),this.ybc=0);v.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}b_k(b,h){this.bcf.set(b,h)}aIo(){this.Ifo(this.bcf)}get b5k(){return this.bcf.size===this.OJb.size}Ifo(b){b.forEach((h,r)=>{h.execute(A=>{A?(this.OJb.set(r,A),this.start()):v.ULS.sendTraceTag(512550848,306,10,
"WatchDog {0} resolved to null",r)})})}yHo(){this.OJb.forEach(b=>{b&&b.vDa()});v.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}L1f(b){0<this.Qpa.o0a&&this.C1.lUb(b)}Erm(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?le.a.ZKp:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?le.a.YKp:null}}Object(u.a)(fq,"WatchDogManager",null,[242]);class Sp{constructor(){this.Z=this.NJb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.NJb=this.Z.resolve(this.name);this.P9m()}dispose(){this.NJb&&
this.NJb.stop()}wc(b){this.Z=b;b.ia(this.name,this.LLl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){E.a.instance.Mc(new Sp)}nFp(){if(!this.NJb.b5k){const b=[];let h=0;this.oLd.forEach((r,A)=>{r&&(this.Z.Oa(A)||(b[h++]=A))});if(0<b.length){const r=!this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager").TR;v.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}LLl(){return new fq(this.Z.resolve("Common.ISessionStatus")||cc.SessionStatusManager.instance,
this.Z.Ta("Common.App.VisibilityManagement.IVisibilityManager"),this.Z.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.Z.resolve("Wonca.KickoutExecutor"))}X_k(){window.setTimeout(this.nFp.bind(this),this.UGp)}d0k(){this.oLd=new Map;this.oLd.set("WordEditor.RunawayDataLossMonitorWatchDog",ed.a.fn||ed.a.wt);this.oLd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",!0)}P9m(){this.d0k();this.c0k(this.oLd,this.NJb.b_k.bind(this.NJb));this.NJb.aIo();this.X_k()}c0k(b,h){b.forEach((r,A)=>
{r&&h(A,this.Z.Ta(A))})}get UGp(){return null!=this.H7g?this.H7g:this.H7g=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(u.a)(Sp,"WatchDogManagerPackage",null,[0,1]);class pr{constructor(b){this.LMa=b;this.npi=!1;this.Qpb=void 0}o1o(){this.npi||(this.XFl(),this.Cyl(),this.x1l(),this.Aeo(),this.npi=!0)}n8o(){Ol.UISurfaces.utm().then(b=>{b.renderFloatingHelp(this.Qpb.Kla,{["actionCallback"]:(h,r=2,A=null)=>{y.AFrameworkApplication.va.Qb(h,
r,A)}});return null})}Cyl(){this.Qpb.fgd.appendChild(this.Qpb.Kla)}x1l(){this.LMa.appendChild(this.Qpb.fgd)}XFl(){this.Qpb={fgd:this.D9h(pr.R7n),Kla:this.D9h(pr.z$m)}}D9h(b){const h=document.createElement("div");h.id=b;return h}Aeo(){this.Qpb.fgd.style.position="fixed";this.Qpb.fgd.style.bottom="47px";this.Qpb.fgd.style.right="24px"}}pr.R7n="FloatingHelpOuterContainer";pr.z$m="FloatingHelpInnerHost";Object(u.a)(pr,"FloatingHelpManager",null,[241]);class sq{constructor(){this.container=void 0}get name(){return"WordEditor.FloatingHelp"}wc(b){this.container=
b;const h=Fl.a.hm.kG;this.container.ia("WordEditor.FloatingHelp.FloatingHelpManager",()=>new pr(h)).as("WordEditor.FloatingHelp.IFloatingHelpManager").ha()}init(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FloatingHelpExperiment",!1)&&void 0!==this.container){const b=this.container.resolve("WordEditor.FloatingHelp.IFloatingHelpManager");b.o1o();b.n8o()}}dispose(){}static main(){E.a.instance.Mc(new sq)}}Object(u.a)(sq,"FloatingHelpPackage",null,[0,1]);class Jn{constructor(b,
h){this.id=b;this.altText=h}}Object(u.a)(Jn,"ParagraphBorderPropertiesItem",null,[]);class Mx{constructor(b,h,r,A,L,Z){this.g4d=b;this.gallerySectionId=h;this.tBf=r;this.Egf=A;this.commandId=L;this.queryCommandId=Z}}Object(u.a)(Mx,"ParagraphBorderPropertiesMenuPropsArgs",null,[]);class NA{constructor(b,h,r,A){this.size=b;this.space=h;this.style=r;this.color=A}}Object(u.a)(NA,"ParagraphBorderStyleProperties",null,[]);class Ts{constructor(b,h,r,A,L,Z){this.W5a=b;this.oqd=h;this.width=r;this.oed=A;this.height=
L;this.sbd=Z}}Object(u.a)(Ts,"ParagraphBorderPropertiesDefinition",null,[]);class of{constructor(){this.Hel=[new Jn(of.H0b,WordEditorIntl.WordEditorStrings.L_ParagraphBorderSolidLine),new Jn(of.vNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDashedLine),new Jn(of.WNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDottedLine),new Jn(of.YNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDoubleLine)];this.Rel=[new Jn(of.fLb,"0.25 pt"),new Jn(of.dLb,"0.5 pt"),new Jn(of.iLb,"0.75 pt"),new Jn(of.eLb,
"1 pt"),new Jn(of.cLb,"1.5 pt"),new Jn(of.jLb,"2.25 pt"),new Jn(of.hLb,"3 pt"),new Jn(of.bLb,"4.5 pt"),new Jn(of.gLb,"6 pt")];this.Cel=[new Jn(of.wkf,"0 pt"),new Jn(of.qkf,"1 pt"),new Jn(of.vkf,"2 pt"),new Jn(of.ukf,"3 pt"),new Jn(of.okf,"4 pt"),new Jn(of.mkf,"5 pt"),new Jn(of.skf,"6 pt"),new Jn(of.rkf,"7 pt"),new Jn(of.lkf,"8 pt"),new Jn(of.pkf,"9 pt"),new Jn(of.tkf,"10 pt")]}initialize(){this.L7m();this.Wjd()}L7m(){this.pTd=[new Ts(of.H0b,"","2",1,8,0),new Ts(of.vNb,"5,3","1",1,8,0),new Ts(of.WNb,
"1,1","1",1,8,0),new Ts(of.YNb,"","1",2,8,3)];this.qTd=[new Ts(of.fLb,"","0.25",1,8,0),new Ts(of.dLb,"","0.5",1,8,0),new Ts(of.iLb,"","0.75",1,8,0),new Ts(of.eLb,"","1",1,8,0),new Ts(of.cLb,"","1.5",1,8,0),new Ts(of.jLb,"","2.25",1,8,0),new Ts(of.hLb,"","3",1,8,0),new Ts(of.bLb,"","4.5",1,8,0),new Ts(of.gLb,"","6",1,8,0)]}Wjd(){if(Object(eg.c)()){var b={};for(const h of this.pTd)b[h.W5a]=appChrome.buildBorderStyleIcon(h.oqd,h.width,h.oed,h.height,h.sbd);for(const h of this.qTd)b[h.W5a]=appChrome.buildBorderStyleIcon(h.oqd,
h.width,h.oed,h.height,h.sbd);appChrome.api.registerIconProvider(()=>b)}else v.ULS.sendTraceTag(508339926,306,15,"AppChrome not loaded yet. Skipping registering icons for paragraph border manager.")}UHf(){return new NA(of.bgc,of.Nci,of.agc,of.uYc)}gjc(b){var h=this.Z1c(b);if(0!==h.length){for(const A of h)if(r){if(h=this.Mti(b,A),!this.xSd(r,h))return}else var r=this.Mti(b,A);return r}}Mti(b,h){const r=this.UHf();switch(h){case 0:return{size:Cd.ParagraphReader.Ug(b,De.a.DP,r.size),space:Cd.ParagraphReader.Ug(b,
De.a.jua,r.space),style:Cd.ParagraphReader.Ug(b,De.a.WYa,r.style),color:Cd.ParagraphReader.Ug(b,De.a.VYa,r.color)};case 1:return{size:Cd.ParagraphReader.Ug(b,De.a.XU,r.size),space:Cd.ParagraphReader.Ug(b,De.a.hua,r.space),style:Cd.ParagraphReader.Ug(b,De.a.OYa,r.style),color:Cd.ParagraphReader.Ug(b,De.a.NYa,r.color)};case 2:return{size:Cd.ParagraphReader.Ug(b,De.a.w0,r.size),space:Cd.ParagraphReader.Ug(b,De.a.PCa,r.space),style:Cd.ParagraphReader.Ug(b,De.a.RYa,r.style),color:Cd.ParagraphReader.Ug(b,
De.a.QYa,r.color)};case 3:return{size:Cd.ParagraphReader.Ug(b,De.a.x0,r.size),space:Cd.ParagraphReader.Ug(b,De.a.QCa,r.space),style:Cd.ParagraphReader.Ug(b,De.a.mcb,r.style),color:Cd.ParagraphReader.Ug(b,De.a.IMa,r.color)};case 4:return{size:Cd.ParagraphReader.Ug(b,De.a.hS,r.size),space:Cd.ParagraphReader.Ug(b,De.a.gua,r.space),style:Cd.ParagraphReader.Ug(b,De.a.jcb,r.style),color:Cd.ParagraphReader.Ug(b,De.a.icb,r.color)}}return r}Vjm(b){switch(b){case of.fLb:return of.YTc;case of.dLb:return of.jkf;
case of.iLb:return of.U5a;case of.eLb:return of.Mya;case of.cLb:return of.U$;case of.jLb:return of.bka;case of.hLb:return of.p6;case of.bLb:return of.Lya;case of.gLb:return of.aka;default:return of.bgc}}Sjm(b){switch(b){case of.H0b:return"single";case of.vNb:return"dashed";case of.WNb:return"dotted";case of.YNb:return"double";default:return of.agc}}Pjm(b){switch(b){case of.wkf:return of.BWh;case of.qkf:return of.vWh;case of.vkf:return of.AWh;case of.ukf:return of.zWh;case of.okf:return of.nkf;case of.mkf:return of.tWh;
case of.skf:return of.xWh;case of.rkf:return of.wWh;case of.lkf:return of.sWh;case of.pkf:return of.uWh;case of.tkf:return of.yWh;default:return of.Nci}}Wjm(b){switch(b){case of.YTc:return of.fLb;case of.jkf:return of.dLb;case of.U5a:return of.iLb;case of.Mya:return of.eLb;case of.U$:return of.cLb;case of.bka:return of.jLb;case of.p6:return of.hLb;case of.Lya:return of.bLb;case of.aka:return of.gLb}}Tjm(b){switch(b){case "single":return of.H0b;case "dashed":return of.vNb;case "dotted":return of.WNb;
case "double":return of.YNb}}Qjm(b){switch(b){case of.BWh:return of.wkf;case of.vWh:return of.qkf;case of.AWh:return of.vkf;case of.zWh:return of.ukf;case of.nkf:return of.okf;case of.tWh:return of.mkf;case of.xWh:return of.skf;case of.wWh:return of.rkf;case of.sWh:return of.lkf;case of.uWh:return of.pkf;case of.yWh:return of.tkf}}Z1c(b){const h=[];void 0!==Cd.ParagraphReader.Ug(b,De.a.DP,void 0)&&h.push(0);void 0!==Cd.ParagraphReader.Ug(b,De.a.XU,void 0)&&h.push(1);void 0!==Cd.ParagraphReader.Ug(b,
De.a.w0,void 0)&&h.push(2);void 0!==Cd.ParagraphReader.Ug(b,De.a.x0,void 0)&&h.push(3);void 0!==Cd.ParagraphReader.Ug(b,De.a.hS,void 0)&&h.push(4);return h}dFf(){const b=new Mx("ParagraphBorderLineStyleOptionsGallery","DefaultBorderStyleOptions","ParagraphBorderLineStyleOptionsGallery",this.Hel,Ec.a.G_b,Ec.a.Cre);return this.Uic(b,of.Iel,of.Jel)}eFf(){const b=new Mx("ParagraphBorderLineWeightOptionsGallery","DefaultBorderWeightOptions","ParagraphBorderLineWeightOptionsGallery",this.Rel,Ec.a.H_b,Ec.a.Dre);
return this.Uic(b,of.Sel,of.Tel)}bfm(){const b=new Mx("ParagraphBorderLinePaddingOptionsGallery","DefaultBorderPaddingOptions","ParagraphBorderLinePaddingOptionsGallery",this.Cel,Ec.a.F_b,Ec.a.Bre);return this.Uic(b,"0px","0px")}Uic(b,h="20px",r="50px"){const A=new Ee.a,L=new hh.a,Z=Object.assign(new Oo.a,{Id:b.g4d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.tBf,Type:4,Width:10,GalleryItems:[]});for(const Ba of b.Egf){var oa={};const gb={};gb.width=r;gb.height=h;gb.marginRight="8px";oa.root=
gb;oa=Object.assign(new ms.a,{Id:String.format("{0}_Button",Ba.id),ExternalId:String.format("{0}_ExternalID",Ba.id),Icon:Ba.id,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:Ba.id,t2p:gb,FullIconStyle:oa,LabelText:Ba.altText});Z.GalleryItems.push(oa)}L.ControlList=[];A.MenuSectionList=[];L.ControlList.push(Z);A.MenuSectionList.push(L);A.UpdateDynamically=!0;return A}xSd(b,h){return!b&&!h||b&&h&&b.color===h.color&&b.size===h.size&&b.style===h.style&&b.space===h.space}HTh(b,
h){if(b.length!==h.length)return!1;for(const r of b)if(-1===h.indexOf(r))return!1;return!0}}var kG=of;of.H0b="SolidLineStyle";of.vNb="DashedLineStyle";of.WNb="DottedLineStyle";of.YNb="DoubleLineStyle";of.YTc=2;of.fLb="BorderPointSizeOneQuarter";of.jkf=4;of.dLb="BorderPointSizeOneHalf";of.U5a=6;of.iLb="BorderPointSizeThreeQuarters";of.Mya=8;of.eLb="BorderPointSizeOne";of.U$=12;of.cLb="BorderPointSizeOneAndHalf";of.bka=18;of.jLb="BorderPointSizeTwoAndQuarter";of.p6=24;of.hLb="BorderPointSizeThree";
of.Lya=36;of.bLb="BorderPointSizeFourAndHalf";of.aka=48;of.gLb="BorderPointSizeSix";of.BWh=0;of.wkf="BorderSpaceZero";of.vWh=1;of.qkf="BorderSpaceOne";of.AWh=2;of.vkf="BorderSpaceTwo";of.zWh=3;of.ukf="BorderSpaceThree";of.nkf=4;of.okf="BorderSpaceFour";of.tWh=5;of.mkf="BorderSpaceFive";of.xWh=6;of.skf="BorderSpaceSix";of.wWh=7;of.rkf="BorderSpaceSeven";of.sWh=8;of.lkf="BorderSpaceEight";of.uWh=9;of.pkf="BorderSpaceNine";of.yWh=10;of.tkf="BorderSpaceTen";of.agc="single";of.bgc=of.jkf;of.uYc=0;of.Nci=
kG.nkf;of.Jel="50px";of.Iel="20px";of.Tel="60px";of.Sel="20px";Object(u.a)(of,"ParagraphBorderManager",null,[185]);class Iu{constructor(){this.Ote={size:0,space:0,color:0,style:"none"}}gyb(b,h,r){for(const A of h)this.JSo(b,A,r)}JSo(b,h,r){switch(h){case 0:b.properties.setValue(De.a.jua,r.space);b.properties.setValue(De.a.DP,r.size);b.properties.setValue(De.a.VYa,r.color);b.properties.setValue(De.a.WYa,r.style);break;case 1:b.properties.setValue(De.a.hua,r.space);b.properties.setValue(De.a.XU,r.size);
b.properties.setValue(De.a.NYa,r.color);b.properties.setValue(De.a.OYa,r.style);break;case 2:b.properties.setValue(De.a.PCa,r.space);b.properties.setValue(De.a.w0,r.size);b.properties.setValue(De.a.QYa,r.color);b.properties.setValue(De.a.RYa,r.style);break;case 3:b.properties.setValue(De.a.QCa,r.space);b.properties.setValue(De.a.x0,r.size);b.properties.setValue(De.a.IMa,r.color);b.properties.setValue(De.a.mcb,r.style);break;case 4:b.properties.setValue(De.a.gua,r.space),b.properties.setValue(De.a.hS,
r.size),b.properties.setValue(De.a.icb,r.color),b.properties.setValue(De.a.jcb,r.style)}}wrl(b){var h=[0,1,2,3,4];for(const r of h)this.xrl(b,r)}xrl(b,h){switch(h){case 0:this.nkd(b,Iu.bnp);break;case 1:this.nkd(b,Iu.Uel);break;case 2:this.nkd(b,Iu.Rzn);break;case 3:this.nkd(b,Iu.XJo);break;case 4:this.nkd(b,Iu.Zcl)}}nkd(b,h){const [r,A,L,Z]=h;h=Cd.ParagraphReader.Yb.Cq(b);h.hasProperty(r)?b.properties.setValue(r,this.Ote.space):b.properties.hasProperty(r)&&b.properties.removeProperty(r);h.hasProperty(A)?
b.properties.setValue(A,this.Ote.size):b.properties.hasProperty(A)&&b.properties.removeProperty(A);h.hasProperty(L)?b.properties.setValue(L,this.Ote.color):b.properties.hasProperty(L)&&b.properties.removeProperty(L);h.hasProperty(Z)?b.properties.setValue(Z,this.Ote.style):b.properties.hasProperty(Z)&&b.properties.removeProperty(Z)}}Iu.bnp=[De.a.jua,De.a.DP,De.a.VYa,De.a.WYa];Iu.Uel=[De.a.hua,De.a.XU,De.a.NYa,De.a.OYa];Iu.Rzn=[De.a.PCa,De.a.w0,De.a.QYa,De.a.RYa];Iu.XJo=[De.a.QCa,De.a.x0,De.a.IMa,De.a.mcb];
Iu.Zcl=[De.a.gua,De.a.hS,De.a.icb,De.a.jcb];Object(u.a)(Iu,"ParagraphBorderEditor",null,[184]);class Nx{constructor(b){this.Yb=b}bzg(b,h){b.properties.setValue(Nx.d0b,h.color)}bof(b){this.Yb.Cq(b).hasProperty(Nx.d0b)?b.properties.setValue(Nx.d0b,Ww.CAo):b.properties.hasProperty(Nx.d0b)&&b.properties.removeProperty(Nx.d0b)}}Nx.d0b=cg.a.ku;Object(u.a)(Nx,"ParagraphShadingEditor",null,[183]);class xC{VKm(b){b=Cd.ParagraphReader.Ug(b,xC.d0b,null);return null===b?null:new Ww(b)}}xC.d0b=cg.a.ku;Object(u.a)(xC,
"ParagraphShadingReader",null,[182]);class nE{get name(){return"WordEditor.ParagraphEditor"}wc(b){var h,r;this.container=b;if(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1))this.container.ia("WordEditor.ParagraphEditors.IParagraphBorderEditor",()=>new Iu).ha(),this.container.ia("WordEditor.ParagraphEditors.IParagraphBorderManager",()=>new of).ha();if(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",
!1))this.container.ia("WordEditor.ParagraphEditors.IParagraphShadingEditor",()=>new Nx(this.container.resolve("Box4.Styles.IWACStyleReader"))).ha(),this.container.ia("WordEditor.ParagraphEditors.IParagraphShadingReader",()=>new xC).ha()}init(){var b;(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1))&&this.container.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager").initialize()}dispose(){}static main(){E.a.instance.Mc(new nE)}}
Object(u.a)(nE,"WordEditorParagraphEditorsPackage",null,[0,1]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");
Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");
Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");
Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");
Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");
Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");
Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");N.main();Type.registerNamespace("Common.App.WopiIdentity");
ua.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Dc.main();Object(ee.a)(!1);n.main();wx.main();rb.main();ia.main();La.main();Ej.main();sq.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");ke.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");
Ye.main();Type.registerNamespace("Common.App.WildFire");Ac.main();Type.registerNamespace("Common.App.BrowserInfoLogger");cf.main();Type.registerNamespace("Common.App.HostNotification");Vj.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");hi.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");dg.main();Type.registerNamespace("CNT");li.main();Type.registerNamespace("Common.App.NewAndOpen.Core");
E.a.instance.Mc(new ql);Type.registerNamespace("Common.App.NewAndOpen.UX");E.a.instance.Mc(new mi);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Kk.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");sl.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Ed.main();Type.registerNamespace("Common.App.TaskPaneManager");
Type.registerNamespace("CAUI");Ek.main();Type.registerNamespace("CADWLTR");zi.main();Type.registerNamespace("Common.App.DirectPrint");E.a.instance.Mc(new Cf);Type.registerNamespace("Common.App.SearchOAuthManager");Qc.main();Rf.main();Ve.main();Pe.main();Lf.main();Gh.main();E.a.instance.Mc(new Uj);Xk.main();Lk.main();lm.main();E.a.instance.Mc(new Ul);Type.registerNamespace("Common.App.SaveStatus");E.a.instance.Mc(new Dm);Type.registerNamespace("Common.App.EventsCacheManager");Zn.main();Type.registerNamespace("CUIB");
zs.main();Type.registerNamespace("CommandUI.TaskPane");try{E.a.instance.Mc(new av(ab.StaticActiveAppFrame.za().kb))}catch(b){v.ULS.shipAssertTag(575930383,3016,!1,b.message)}Go.main();Type.registerNamespace("Common.App.Insights");As;E.a.instance.Mc(new Nt);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");
Mq("Begin");E.a.instance.Mc(new Bk);try{E.a.instance.Mc(new hq(zk.a.get_instance(),ab.StaticActiveAppFrame.za().kb,ab.StaticActiveAppFrame.za().Gb))}catch(b){v.ULS.shipAssertTag(575930384,3016,!1,b.message)}oc.main();E.a.instance.Mc(new nf);Ds.main();tw.main();dm.main();Ku.main();ut.main();$w.main();DE.main();FE.main();E.a.instance.Mc(new NG);qB.main();Ru.main();sB.main();JE.main();Oj.main();$m.main();E.a.instance.Mc(new UC);E.a.instance.Mc(new XC);dH.main();ME.main();Qv.main();nE.main();E.a.instance.Mc(new Dr);
E.a.instance.Mc(new uu);rH;KB.main();gF.main();SH.main();lF.main();YH;E.a.instance.Mc(new iy);E.a.instance.Mc(new vv);Zt.main();qF.main();uF.main();E.a.instance.Mc(new zL);E.a.instance.Mc(new ew);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=S;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Gg.main();uk.main();au.main();ED;EK.main();GL;window.MSOJS=$D;TK.main();
iM.main();E.a.instance.Mc(new Qg);E.a.instance.Mc(new Pf);(async()=>{y.AFrameworkApplication.J.$("WPMPackageIsEnabled")&&await d.e(29).then(d.bind(null,2175)).then(b=>{b.initializeOnDemandPackage()})})();Sp.main();Jh.main()},2179:function(I,J,d){I=d(0);var m=d(109),f=d(8),a=d(2),l=d(40),w=d(477),z=d(19);class x{constructor(E,N,O,U){this.o_e=null;this.Azd=U;this.oxa=E;this.pxa=N;this.b1=O;this.JEh=this.qVb.w4o;E=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.rEk=E[0];this.qEk=E[1]}get qVb(){return this.o_e||
(this.o_e=z.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Prb(){return CommonUIStrings.l_OICErrorHelpLink}get Xod(){return this.JEh}get Hbj(){return this.rEk}get Gbj(){return this.qEk}get Fbj(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.JEh?3:2}get E_c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ZWd(){return!!this.pxa}get F_c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Log(E){this.zed(E)}W2f(E){this.zed(E)}zed(E){let N=
10;this.pxa&&1===E&&(this.pxa(this.b1),N=1);this.oxa&&this.oxa(this.b1);this.lS(N)}oWb(){w.Redirect.showHelp("OICFailure");this.lS(2)}mcg(){this.qVb.S5i();this.lS(4)}lS(E){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.Azd,E);a.AFrameworkApplication.hld(l.a.upj,this.Azd,E)}dispose(){this.b1=this.oxa=this.pxa=null}}Object(I.a)(x,"AOICErrorDialog",null,[10]);var u=d(35),v=d(175);class D extends x{constructor(E,N,O,U){super(E,N,O,U);this.tjb=this.EH=
null;E=document.createElement("span");E.id="errorMessageText";E.innerText=this.errorMessage;E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));this.EH=document.createElement("a");this.EH.href="#";this.EH.innerText=this.Prb;E.appendChild(this.EH);u.a.addHandler(this.EH,"click",Object(m.a)(this,this.oWb,"oicErrorHelpLinkHandler"));N=new v.StandardDialog;N.Ig=this.id;this.Xod?(O=document.createElement("span"),U=document.createElement("span"),O.innerText=this.Hbj,
U.innerText=this.Gbj,this.tjb=document.createElement("a"),this.tjb.href="#",this.tjb.innerText=this.Fbj,E.appendChild(document.createElement("br")),E.appendChild(O),E.appendChild(this.tjb),E.appendChild(U),u.a.addHandler(this.tjb,"click",Object(m.a)(this,this.mcg,"oicErrorMacOfferLinkHandler"))):this.ZWd&&(E.appendChild(document.createElement("br")),E.appendChild(document.createElement("br")),O=document.createElement("span"),O.innerText=this.E_c,E.appendChild(O));this.ZWd?(N.Bd=1,N.Ke(1,this.F_c)):
N.Bd=0;N.sw(this.dialogTitle,null,this.icon,Object(m.a)(this,this.W2f,"legacyOICErrorDialogHandler"),E);N.x8("errorMessageText")}dispose(){this.EH&&(u.a.removeHandler(this.EH,"click",Object(m.a)(this,this.oWb,"oicErrorHelpLinkHandler")),this.EH=null);this.tjb&&(u.a.removeHandler(this.tjb,"click",Object(m.a)(this,this.mcg,"oicErrorMacOfferLinkHandler")),this.tjb=null);super.dispose()}}Object(I.a)(D,"OICErrorDialog",x,[]);class y{constructor(E,N,O){this.oxa=N;this.pxa=E;this.b1=O}get id(){return"OICErrorDialogWithDownload"}get Yki(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Prb(){return CommonUIStrings.l_OICErrorHelpLink}get E_c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get F_c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Log(E){this.zed(E)}W2f(E){this.zed(E)}zed(E){let N=
10;1===E&&(this.pxa(this.b1),N=1);this.oxa&&this.oxa(this.b1);this.lS(N)}oWb(){w.Redirect.showHelp("OICFailure");this.lS(2)}lS(E){a.AFrameworkApplication.hld(l.a.vpj,3,E)}dispose(){this.b1=this.pxa=this.oxa=null}}Object(I.a)(y,"AOICErrorDialogWithDownload",null,[10]);class H extends y{constructor(E,N,O){super(E,N,O);this.EH=null;E=document.createElement("span");E.id="errorMessageText";E.innerText=this.Yki;E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));this.EH=
document.createElement("a");this.EH.href="#";this.EH.innerText=this.Prb;E.appendChild(this.EH);u.a.addHandler(this.EH,"click",Object(m.a)(this,this.oWb,"oicErrorHelpLinkHandler"));E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));N=document.createElement("span");N.innerText=this.E_c;E.appendChild(N);N=new v.StandardDialog;N.Ig=this.id;N.Bd=1;N.Ke(1,this.F_c);N.sw(this.dialogTitle,null,this.icon,Object(m.a)(this,this.W2f,"legacyOICErrorDialogHandler"),E);N.x8("errorMessageText")}dispose(){this.EH&&
(u.a.removeHandler(this.EH,"click",Object(m.a)(this,this.oWb,"oicErrorHelpLinkHandler")),this.EH=null);super.dispose()}}Object(I.a)(H,"OICErrorDialogWithDownload",y,[]);var F=d(173);class G extends x{constructor(E,N,O,U){super(E,N,O,U);N={["errorMessage"]:this.errorMessage};N.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Prb,["onExecute"]:X=>{this.oWb(X)}};this.Xod?(N.macOfficePreLinkText=this.Hbj,N.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Fbj,
["onExecute"]:X=>{this.mcg(X)}},N.macOfficePostText=this.Gbj):this.ZWd&&(N.errorFileDownloadOffer=this.E_c);E=new F.a(!1,!1,!0);this.ZWd?(E.Bd=1,E.Ke(1,this.F_c)):E.Bd=0;E.Ig=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};E.Uh(this.dialogTitle,Object(m.a)(this,this.Log,"reactOICErrorDialogHandler"),N)}}Object(I.a)(G,"ReactOICErrorDialog",x,[]);class K extends y{constructor(E,N,O){super(E,N,O);N={["errorMessage"]:this.Yki,["errorFileDownloadOffer"]:this.E_c};N.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Prb,["onExecute"]:U=>{this.oWb(U)}};E=new F.a(!1,!1,!0);E.Bd=1;E.Ke(1,this.F_c);E.Ig=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};E.Uh(this.dialogTitle,Object(m.a)(this,this.Log,"reactOICErrorDialogHandler"),N)}}Object(I.a)(K,"ReactOICErrorDialogWithDownload",y,[]);d.d(J,"a",function(){return R});class R{constructor(){this.nRa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Gb.kH}uIl(E,N,O){this.nRa?new G(E,N,null,O):new D(E,N,null,
O)}vIl(E,N,O){this.nRa?new K(E,N,O):new H(E,N,O)}wIl(E,N,O,U,X){const {ReactOICErrorDialogWithTrial:V}=d(1916),{OICErrorDialogWithTrial:Q}=d(1917);this.nRa?new V(E,N,O,null,U,X):new Q(E,N,O,null,U,X)}static get instance(){return R._instance||(R._instance=new R)}}R._instance=null;Object(I.a)(R,"OICErrorDialogFactoryImpl",null,[1774])},2182:function(I,J,d){I=d(0);var m=d(8),f=d(1582);class a{static get PLn(){return 50}static R7d(w){if(""===w)return"";let z=0,x="";try{const u=f.a.Jqb(w);for(const v of u.ops)if(a.wI(v))z||
(x+=a.Wsm(v.attributes.atmention.fullName)),z+=1;else{const D=v.insert?v.insert:"";" "!==D&&0<D.length&&(z=0,x+=D)}}catch(u){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return x}static Mmm(w){w=a.R7d(w);return 0<w.length&&w.split(" ").length<=a.PLn?w:null}static Wsm(w){let z="";w&&(w=w.split(" "),0<w.length&&(z=w[0]));return z}static wI(w){return!!w.attributes&&!!w.attributes.atmention}}Object(I.a)(a,"BaseCommentSmartReplyHelpers",
null,[]);d.d(J,"a",function(){return l});class l extends a{constructor(){super()}static GPb(w,z,x=!1){if(!w)return null;w=w.text&&0<w.text.length?w.text[0]:"";z=!z||!z.Rf||""===z.Rf;return 0<w.length&&z&&!x?a.Mmm(w):null}}Object(I.a)(l,"CommentSmartReplyHelpers",a,[])},958:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.method=this.api=0}}Object(I.a)(m,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23047711/wdjs/WordEditorDS.box4.dll1.js.map